000100 IDENTIFICATION DIVISION.                                         00010007
000200 PROGRAM-ID.      EPKUT353                                        00020007
000300 AUTHOR.          COGNIZANT.                                      00030029
000400 DATE-WRITTEN.    SEPTEMBER,2013.                                 00040007
000500                                                                  00050007
000600*-----------------------------------------------------------      00060007
000700*              MERCHANDISE EXCLUSIONS IDENTIFIER                  00070029
000800*-----------------------------------------------------------      00080007
000900*-----------------------------------------------------------      00090007
001000* HISTORY LOG:                                                    00100007
001100*-----------------------------------------------------------      00110007
001200* DATE: 09/30/2013                                                00120095
001300* WR/IR#:                                                         00130095
001400* PROGRAMMER: COGNIZANT                                           00140095
001500* THIS PROGRAM IS A MODIFIED VERSION OF EPKUT121.                 00150095
001600* DESCRIPTION: REMOVED THE EMERGENCY FILE EXTRACT PROCESS IN THE  00160095
001700*   NIGHTLY CYCLE. THIS IS DONE TO AVOID SORTING ISSUE FOR PROMO  00170095
001800*   SEND TO STORES.                                               00180095
001900* DATE:                                                           00190007
002000* WR/IR#:                                                         00200007
002100* PROGRAMMER:                                                     00210007
002200* DESCRIPTION:                                                    00220007
002300*                                                                 00230007
002400*----------------------------------------------------------       00240007
002500 ENVIRONMENT DIVISION.                                            00250007
002600*----------------------------------------------------------       00260007
002700 CONFIGURATION SECTION.                                           00270007
002800 SOURCE-COMPUTER.        IBM-3090.                                00280007
002900 OBJECT-COMPUTER.        IBM-3090.                                00290007
003000                                                                  00300007
003100 INPUT-OUTPUT SECTION.                                            00310007
003200                                                                  00320007
003300 FILE-CONTROL.                                                    00330007
003400                                                                  00340007
003500     SELECT CONTROL-CARD-PGM-LAST-RUN-TMST                        00350046
003600       ASSIGN TO INP01.                                           00360068
003700     SELECT CONTROL-CARD-PGM-CURR-TMST                            00370095
003800       ASSIGN TO INP02.                                           00380068
003900     SELECT CONTROL-CARD-CURR-PRICG-DTE                           00390046
004000       ASSIGN TO INP03.                                           00400068
004100     SELECT CONTROL-CARD-FUTRE-CORR-DTE                           00410046
004200       ASSIGN TO INP04.                                           00420068
004300     SELECT CONTROL-CARD-CRIT-EFF-DTE                             00430046
004400       ASSIGN TO INP05.                                           00440068
004500     SELECT PROMO-NIGHT-FILE                                      00450044
004600       ASSIGN TO OUT01.                                           00460068
004700                                                                  00470007
004800 DATA DIVISION.                                                   00480007
004900 FILE SECTION.                                                    00490007
005000                                                                  00500007
005100 FD  CONTROL-CARD-PGM-LAST-RUN-TMST                               00510046
005200     RECORDING MODE F                                             00520007
005300     BLOCK CONTAINS 0 RECORDS                                     00530007
005400     LABEL RECORDS ARE OMITTED                                    00540007
005500     DATA RECORD IS CNTRL-CARD-PGM-LAST-RUN-REC.                  00550046
005600 01  CNTRL-CARD-PGM-LAST-RUN-REC                   PIC  X(080).   00560070
005700                                                                  00570007
005800 FD  CONTROL-CARD-PGM-CURR-TMST                                   00580095
005900     RECORDING MODE F                                             00590007
006000     BLOCK CONTAINS 0 RECORDS                                     00600007
006100     LABEL RECORDS ARE OMITTED                                    00610007
006200     DATA RECORD IS CNTRL-CARD-PGM-CURR-RUN-REC.                  00620046
006300 01  CNTRL-CARD-PGM-CURR-RUN-REC                   PIC  X(080).   00630070
006400                                                                  00640095
006500 FD  CONTROL-CARD-CURR-PRICG-DTE                                  00650046
006600     RECORDING MODE F                                             00660007
006700     BLOCK CONTAINS 0 RECORDS                                     00670007
006800     LABEL RECORDS ARE OMITTED                                    00680007
006900     DATA RECORD IS CNTRL-CARD-CURR-PRICG-DTE-REC.                00690046
007000 01  CNTRL-CARD-CURR-PRICG-DTE-REC                 PIC  X(080).   00700070
007100                                                                  00710007
007200 FD  CONTROL-CARD-FUTRE-CORR-DTE                                  00720046
007300     RECORDING MODE F                                             00730007
007400     BLOCK CONTAINS 0 RECORDS                                     00740007
007500     LABEL RECORDS ARE OMITTED                                    00750007
007600     DATA RECORD IS CNTRL-CARD-FUTRE-CORR-DTE-REC.                00760046
007700 01  CNTRL-CARD-FUTRE-CORR-DTE-REC                 PIC  X(080).   00770070
007800                                                                  00780007
007900 FD  CONTROL-CARD-CRIT-EFF-DTE                                    00790046
008000     RECORDING MODE F                                             00800007
008100     BLOCK CONTAINS 0 RECORDS                                     00810007
008200     LABEL RECORDS ARE OMITTED                                    00820007
008300     DATA RECORD IS CNTRL-CARD-CRIT-EFF-DTE-REC.                  00830046
008400 01  CNTRL-CARD-CRIT-EFF-DTE-REC                   PIC  X(080).   00840070
008500                                                                  00850007
008600 FD  PROMO-NIGHT-FILE                                             00860022
008700     RECORDING MODE F                                             00870007
008800     BLOCK CONTAINS 0 RECORDS                                     00880007
008900     LABEL RECORDS ARE OMITTED                                    00890007
009000     DATA RECORD IS PROMO-NIGHT-ID-RECORD.                        00900022
009100 01  PROMO-NIGHT-RECORD                            PIC  X(200).   00910070
009200                                                                  00920007
009300 WORKING-STORAGE SECTION.                                         00930007
009400*-----------------------------------------------------------      00940007
009500* PS - PROGRAM SWITCHES                                           00950020
009600*-----------------------------------------------------------      00960007
009700 01  PS-PROGRAM-SWITCHES.                                         00970007
009800     05  PS-MDSE-EXCL-CSR-EOF-SW                   PIC  X(001).   00980070
009900       88  PS-MDSE-EXCL-CSR-EOF                      VALUE 'Y'.   00990070
010000       88  PS-MDSE-EXCL-CSR-NOT-EOF                  VALUE 'N'.   01000070
010100     05  PS-MDSE-EXCL-ADHOC-CSR-EOF-SW             PIC  X(001).   01010070
010200       88  PS-MDSE-EXCL-ADHOC-CSR-EOF                VALUE 'Y'.   01020070
010300       88  PS-MDSE-EXCL-ADHOC-CSR-NOT-EOF            VALUE 'N'.   01030070
010400     05  PS-REC-FOUND-SW                           PIC  X(001).   01040070
010500       88  PS-REC-FOUND                              VALUE 'Y'.   01050070
010600       88  PS-NO-REC-FOUND                           VALUE 'N'.   01060070
010700     05  PS-WRITE-PROMO-SW                         PIC  X(001).   01070070
010800       88  PS-WRITE-PROMO                            VALUE 'Y'.   01080070
010900       88  PS-DONT-WRITE-PROMO                       VALUE 'N'.   01090070
011000     05  PS-FILE-STATUS                            PIC  X(002).   01100070
011100       88  PS-SUCCESSFUL-COMPLETION                  VALUE '00'.  01110070
011200       88  PS-END-OF-FILE                            VALUE '10'.  01120070
011300       88  PS-SUCCESSFUL-OPEN                        VALUE '97'.  01130070
011400     05  PS-END-OF-CNTL-CRD-SW                     PIC  X(001).   01140070
011500       88  PS-END-OF-CNTL-CRD-FILE                   VALUE 'Y'.   01150070
011600       88  PS-NOT-END-OF-CNTL-CRD-FILE               VALUE 'N'.   01160070
011700                                                                  01170007
011800*-----------------------------------------------------------      01180007
011900* PROGRAM CONSTANTS                                               01190007
012000*-----------------------------------------------------------      01200007
012100 01  PC-PROGRAM-CONSTANTS.                                        01210007
012200     05  PC-CURRENT-PROGRAM-NAME                   PIC  X(008)    01220070
012300       VALUE 'EPKUT353'.                                          01230065
012400     05  PC-BUSINESS-EVENT-ID                      PIC  X(003)    01240070
012500       VALUE '110'.                                               01250065
012600     05  PC-RMS-PRC-SETUP-IND                      PIC  X(001)    01260070
012700       VALUE 'R'.                                                 01270065
012800     05  PC-ADHOC-PRC-SETUP-IND                    PIC  X(001)    01280070
012900       VALUE 'A'.                                                 01290047
013000     05  PC-ADHOC-STR-GRP-TYP-CDE                  PIC  X(005)    01300074
013100       VALUE '99999'.                                             01310074
013200     05  PC-FILE-ACT-TYPE                          PIC  X(003)    01320070
013300       VALUE 'CHG'.                                               01330047
013400     05  PC-APPLY-NIGHTLY                          PIC  X(001)    01340070
013500       VALUE 'N'.                                                 01350047
013600     05  PC-MDSE-EXCL-STAT-CDE                     PIC  X(001).   01360070
013700       88  PC-SCHEDULED-STATUS                       VALUE 'S'.   01370070
013800       88  PC-DELETE-STATUS                          VALUE 'D'.   01380070
013900       88  PC-CANCEL-STATUS                          VALUE 'C'.   01390070
014000     05  PC-ADD-STAT-CDE                           PIC  X(001)    01400070
014100       VALUE 'A'.                                                 01410047
014200     05  PC-DELETE-STAT-CDE                        PIC  X(001)    01420070
014300       VALUE 'D'.                                                 01430047
014400     05  PC-MDSE-EXCL-IND                          PIC  X(001)    01440070
014500       VALUE 'E'.                                                 01450047
014600                                                                  01460007
014700*-----------------------------------------------------------      01470007
014800* PV- PROGRAM VARIABLES                                           01480007
014900*-----------------------------------------------------------      01490007
015000 01  PV-PROGRAM-VARAIBLES.                                        01500007
015100     05  PV-SQL-SUB                                PIC S9(004)    01510070
015200                                                     VALUE +0     01520070
015300                                                     COMP.        01530070
015400     05  PV-ACTL-STRT-TMST.                                       01540039
015500       10  PV-ACTL-STRT-TMST-DATE                  PIC  X(010)    01550070
015600                                                     VALUE SPACES.01560070
015700       10  FILLER                                  PIC  X(016)    01570070
015800                                                     VALUE SPACES.01580070
015900     05  PV-ACTL-END-TMST                          PIC  X(026)    01590070
016000                                                     VALUE SPACES.01600070
016100     05  PV-SOR-LAST-UPD-TMST                      PIC  X(026)    01610070
016200                                                     VALUE SPACES.01620070
016300     05  PV-EFF-STRT-TMST                          PIC  X(026)    01630070
016400                                                     VALUE SPACES.01640070
016500     05  PV-EFF-END-TMST                           PIC  X(026)    01650070
016600                                                     VALUE SPACES.01660070
016700     05  PV-EFF-END-NULL                           PIC S9(004)    01670070
016800                                                     VALUE ZEROS  01680076
016900                                                     COMP.        01690076
017000     05  PV-ABEND-CODE                             PIC  9999      01700070
017100                                                     VALUE ZEROS  01710070
017200                                                     COMP.        01720070
017300     05  PV-FUL-FILE-STR                           PIC  9(005)    01730070
017400                                                     VALUE ZEROS. 01740070
017500     05  EP111-CC-DATE-PLUS1                       PIC  X(010)    01750070
017600                                                     VALUE SPACES.01760070
017700     05  EP113-CC-CRNT-DTE-MINUS1                  PIC  X(010)    01770070
017800                                                     VALUE SPACES.01780070
017900                                                                  01790068
018000*----------------------------------------------------------       01800007
018100* FULL FILE EXTRACT OUTPUT FILE.                                  01810007
018200*----------------------------------------------------------       01820007
018300     COPY EPRD072.                                                01830007
018400                                                                  01840007
018500*----------------------------------------------------------       01850007
018600* EPCC111 CONTROL CARD LAYOUT - CURRENT PRICING DATE              01860046
018700*----------------------------------------------------------       01870007
018800     COPY EPRD111.                                                01880007
018900                                                                  01890007
019000*----------------------------------------------------------       01900007
019100* EPCC113 CONTROL CARD LAYOUT - FUTURE CORRECTIONS DATE           01910046
019200*----------------------------------------------------------       01920007
019300     COPY EPRD113.                                                01930007
019400                                                                  01940007
019500*----------------------------------------------------------       01950007
019600* EPCC114 CONTROL CARD LAYOUT - PROGRAM LAST RUN DATE             01960046
019700*----------------------------------------------------------       01970007
019800     COPY EPRD400.                                                01980007
019900                                                                  01990007
020000*----------------------------------------------------------       02000095
020100* EPCC400 CONTROL CARD LAYOUT - PROGRAM CURR RUN DATE             02010046
020200*----------------------------------------------------------       02020007
020300     COPY EPRD401.                                                02030007
020400                                                                  02040095
020500*----------------------------------------------------------       02050007
020600* EPCC128 CONTROL CARD LAYOUT - CRITICAL EFFECTIVE DATE           02060046
020700*----------------------------------------------------------       02070007
020800     COPY EPRD128.                                                02080007
020900                                                                  02090007
021000*----------------------------------------------------------       02100007
021100* DATE ROUTINE COPY MEMBERS                                       02110007
021200*----------------------------------------------------------       02120007
021300     COPY DPWS500.                                                02130007
021400                                                                  02140007
021500*-----------------------------------------------------------      02150007
021600* VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         02160007
021700*-----------------------------------------------------------      02170007
021800     COPY DPWS004.                                                02180007
021900                                                                  02190007
022000*-----------------------------------------------------------      02200007
022100* DB2 ABEND COPYBOOK                                              02210007
022200*-----------------------------------------------------------      02220007
022300     COPY DPWS900.                                                02230007
022400                                                                  02240007
022500*-----------------------------------------------------------      02250007
022600* DB2 MESSAGE AREA                                                02260007
022700*-----------------------------------------------------------      02270007
022800     COPY SQLCA2.                                                 02280007
022900                                                                  02290007
023000*-----------------------------------------------------------      02300007
023100* PROGRAM COUNTERS                                                02310007
023200*-----------------------------------------------------------      02320007
023300 01  PC-PROGRAM-COUNTERS.                                         02330007
023400     05  PC-CNT-READ-RECS                          PIC  9(009)    02340070
023500                                                     VALUE 0.     02350070
023600     05  PC-CNT-NIGHT-RECS                         PIC  9(009)    02360070
023700                                                     VALUE 0.     02370070
023800     05  PC-CNT-PROMO-RECS                         PIC  9(009)    02380070
023900                                                     VALUE 0.     02390070
024000     05  PC-CNT-RMS-RECS                           PIC  9(009)    02400070
024100                                                     VALUE 0.     02410070
024200     05  PC-CNT-ADHOC-RECS                         PIC  9(009)    02420070
024300                                                     VALUE 0.     02430070
024400     05  PC-CNT-PMAP-RECS                          PIC  9(009)    02440070
024500                                                     VALUE 0.     02450070
024600     05  PC-CNT-ERROR-RECS                         PIC  9(009)    02460070
024700                                                     VALUE 0.     02470070
024800     05  PC-CNT-ALL-RECS                           PIC  9(009)    02480070
024900                                                     VALUE 0.     02490070
025000     05  PC-CNT-SPACES                             PIC  9(009)    02500070
025100                                                     VALUE 0.     02510070
025200     05  PC-CNT-POS                                PIC  9(009)    02520070
025300                                                     VALUE 0.     02530070
025400     05  PC-CNT-EXCL-CHECK                         PIC  9(009)    02540070
025500                                                     VALUE 0.     02550070
025600     05  PC-MAX-RETRIES                            PIC S9(004)    02560070
025700                                                     VALUE +5     02570070
025800                                                     COMP.        02580070
025900                                                                  02590007
026000*-----------------------------------------------------------      02600007
026100* ERROR HANDLING                                                  02610007
026200*-----------------------------------------------------------      02620007
026300 01  PV-MISC-ABEND-FIELDS.                                        02630007
026400     05  PV-PARAGRAPH-NAME                         PIC  X(030)    02640070
026500                                                     VALUE SPACE. 02650070
026600     05  PV-OPERATION-MSG-1                        PIC  X(040)    02660070
026700                                                     VALUE SPACE. 02670070
026800     05  PV-OPERATION-MSG-2                        PIC  X(040)    02680070
026900                                                     VALUE SPACE. 02690070
027000     05  PV-DB2-OPERATION                          PIC  X(030)    02700070
027100                                                     VALUE SPACE. 02710070
027200 01  ABEND-CODE                                    PIC S9(004)    02720070
027300                                                     VALUE ZEROS  02730070
027400                                                     COMP         02740070
027500                                                     SYNC.        02750070
027600   88  ABEND-4003-CTRL-CARD-ERROR                    VALUE +4003. 02760070
027700   88  ABEND-4013-DB2-ERROR                          VALUE +4013. 02770070
027800   88  ABEND-4019-CAL-SUB-ERROR                      VALUE +4019. 02780070
027900   88  ABEND-4020-MQ-ERROR                           VALUE +4020. 02790070
028000   88  ABEND-4444-FORCED-ABEND                       VALUE +4444. 02800070
028100   88  ABEND-4008                                    VALUE +4008. 02810070
028200                                                                  02820007
028300*-----------------------------------------------------------      02830007
028400* DB2 COMMUNICATIONS AREA                                         02840007
028500*-----------------------------------------------------------      02850007
028600     EXEC SQL                                                     02860007
028700       INCLUDE SQLCA                                              02870048
028800     END-EXEC.                                                    02880007
028900                                                                  02890007
029000*-----------------------------------------------------------      02900007
029100* DB2 TABLE XST00028(XST_MDSE_LNE_SELN) - MERCHANDISE TABLE       02910007
029200*-----------------------------------------------------------      02920007
029300     EXEC SQL                                                     02930007
029400       INCLUDE XST00028                                           02940048
029500     END-EXEC.                                                    02950007
029600                                                                  02960007
029700*-----------------------------------------------------------      02970007
029800* DB2 TABLE XST00029(XST_PROMO_STR_GP) - STORE ZONE PRICING       02980007
029900*                                               TABLE             02990007
030000*-----------------------------------------------------------      03000007
030100     EXEC SQL                                                     03010007
030200       INCLUDE XST00029                                           03020048
030300     END-EXEC.                                                    03030007
030400                                                                  03040007
030500*-----------------------------------------------------------      03050007
030600* DB2 TABLE XST00031(XST_PROMO_ADHC_RLT) ADHOC RELATION           03060007
030700*-----------------------------------------------------------      03070007
030800     EXEC SQL                                                     03080007
030900       INCLUDE XST00031                                           03090048
031000     END-EXEC.                                                    03100007
031100                                                                  03110007
031200*-----------------------------------------------------------      03120007
031300* DB2 TABLE XST00034(XST_EXCL_MDSE) - MERCHANDSE EXCLUSIONS       03130066
031400*-----------------------------------------------------------      03140007
031500     EXEC SQL                                                     03150007
031600       INCLUDE XST00034                                           03160048
031700     END-EXEC.                                                    03170007
031800                                                                  03180007
031900*-----------------------------------------------------------      03190007
032000* MERCHANDISE EXCLUSION CHANGE INTRFCE INCLUDE CURSOR.(RMS)       03200066
032100*-----------------------------------------------------------      03210007
032200     EXEC SQL                                                     03220007
032300       DECLARE MDSE-EXCL-RMS CURSOR FOR                           03230070
032400         SELECT EXMDSE.EXCL_MDSE_ID                               03240070
032500               ,EXMDSE.PROMO_INTFC_SUB_ID                         03250070
032600               ,EXMDSE.STAT_CDE                                   03260070
032700               ,EXMDSE.LAST_UPD_TMST                              03270070
032800               ,EXMDSE.SOR_LAST_UPD_TMST                          03280048
032900               ,STRGP.PROMO_INTFC_ID                              03290048
033000               ,STRGP.MDSE_LNE_ID                                 03300048
033100               ,STRGP.STR_GP_TYP_CDE                              03310048
033200               ,STRGP.STR_GP_ID                                   03320048
033300               ,STRGP.STR_SELN_HIER_CDE                           03330048
033400               ,STRGP.ACTL_STRT_TMST                              03340048
033500               ,STRGP.ACTL_END_TMST                               03350048
033600               ,MDSSEL.PRICG_TYP_CDE                              03360048
033700         FROM XST_EXCL_MDSE      EXMDSE                           03370048
033800             ,XST_PROMO_STR_GP   STRGP                            03380048
033900             ,XST_MDSE_LNE_SELN  MDSSEL                           03390048
034000         WHERE EXMDSE.PROMO_INTFC_ID = MDSSEL.PROMO_INTFC_ID      03400048
034100           AND EXMDSE.MDSE_LNE_ID    = MDSSEL.MDSE_LNE_ID         03410048
034200           AND MDSSEL.PROMO_INTFC_ID = STRGP.PROMO_INTFC_ID       03420048
034300           AND MDSSEL.MDSE_LNE_ID    = STRGP.MDSE_LNE_ID          03430048
034400           AND STRGP.STAT_CDE  IN ('S')                           03440048
034500           AND (EXMDSE.LAST_UPD_TMST                              03450048
034600               BETWEEN :EP400-CC-PREV-RUN-CUTOFF-TMST             03460048
034700                   AND :EP401-CC-CURR-RUN-CUTOFF-TMST)            03470048
034800           AND ((:EP111-CC-CRNT-DTE                               03480048
034900               BETWEEN DATE(STRGP.ACTL_STRT_TMST)                 03490048
035000                   AND DATE(STRGP.ACTL_END_TMST))                 03500048
035100           OR  (DATE(STRGP.ACTL_STRT_TMST)                        03510048
035200               BETWEEN :EP111-CC-DATE-PLUS1                       03520048
035300                   AND :EP113-CC-CRNT-DTE-MINUS1))                03530048
035400         FOR FETCH ONLY                                           03540048
035500         WITH UR                                                  03550048
035600     END-EXEC.                                                    03560007
035700                                                                  03570007
035800*-----------------------------------------------------------      03580007
035900* MERCHANDISE EXCLUSION CHANGE ADHOC CURSOR.                      03590070
036000*-----------------------------------------------------------      03600007
036100     EXEC SQL                                                     03610007
036200       DECLARE MDSE-EXCL-ADHOC CURSOR FOR                         03620024
036300         SELECT EXMDSE.EXCL_MDSE_ID                               03630070
036400               ,EXMDSE.PROMO_INTFC_SUB_ID                         03640070
036500               ,EXMDSE.STAT_CDE                                   03650070
036600               ,EXMDSE.LAST_UPD_TMST                              03660070
036700               ,EXMDSE.SOR_LAST_UPD_TMST                          03670048
036800               ,ADHOC.PROMO_INTFC_ID                              03680048
036900               ,ADHOC.MDSE_LNE_ID                                 03690048
037000               ,ADHOC.ADHC_STR_GP_ID                              03700048
037100               ,ADHOC.STR_SELN_HIER_CDE                           03710048
037200               ,ADHOC.ACTL_STRT_TMST                              03720048
037300               ,ADHOC.ACTL_END_TMST                               03730048
037400               ,MDSSEL.PRICG_TYP_CDE                              03740048
037500         FROM XST_EXCL_MDSE      EXMDSE                           03750048
037600             ,XST_PROMO_ADHC_RLT ADHOC                            03760048
037700             ,XST_MDSE_LNE_SELN  MDSSEL                           03770048
037800         WHERE EXMDSE.PROMO_INTFC_ID = MDSSEL.PROMO_INTFC_ID      03780048
037900           AND EXMDSE.MDSE_LNE_ID    = MDSSEL.MDSE_LNE_ID         03790048
038000           AND ADHOC.PROMO_INTFC_ID  = MDSSEL.PROMO_INTFC_ID      03800048
038100           AND ADHOC.MDSE_LNE_ID     = MDSSEL.MDSE_LNE_ID         03810048
038200           AND ADHOC.STAT_CDE  IN ('S')                           03820048
038300           AND (EXMDSE.LAST_UPD_TMST                              03830048
038400               BETWEEN :EP400-CC-PREV-RUN-CUTOFF-TMST             03840048
038500                   AND :EP401-CC-CURR-RUN-CUTOFF-TMST)            03850048
038600           AND ((:EP111-CC-CRNT-DTE                               03860048
038700               BETWEEN DATE(ADHOC.ACTL_STRT_TMST)                 03870048
038800                   AND DATE(ADHOC.ACTL_END_TMST))                 03880048
038900           OR  (DATE(ADHOC.ACTL_STRT_TMST)                        03890048
039000               BETWEEN :EP111-CC-DATE-PLUS1                       03900048
039100                   AND :EP113-CC-CRNT-DTE-MINUS1))                03910048
039200         FOR FETCH ONLY                                           03920048
039300         WITH UR                                                  03930048
039400     END-EXEC.                                                    03940018
039500                                                                  03950018
039600                                                                  03960018
039700 LINKAGE SECTION.                                                 03970007
039800                                                                  03980007
039900*----------------------------------------------------------       03990007
040000 PROCEDURE DIVISION.                                              04000041
040100*----------------------------------------------------------       04010007
040200 0000-MAINLINE.                                                   04020007
040300                                                                  04030007
040400     PERFORM 1000-INITIALIZATION.                                 04040007
040500                                                                  04050007
040600     PERFORM 2000-PROCESS-MERCH-EXCLUSIONS.                       04060018
040700                                                                  04070018
040800     PERFORM 9999-WRAPUP.                                         04080018
040900                                                                  04090018
041000     GOBACK.                                                      04100018
041100                                                                  04110018
041200*0000-EXIT.                                                       04120007
041300 EJECT.                                                           04130007
041400                                                                  04140007
041500*----------------------------------------------------------       04150007
041600* 1000-INITIALIZATION.                                            04160007
041700*     INITIALIZATION AREA - INITIALIZES ALL VARIABLES, OPENS      04170007
041800*     FILES, READS INPUT FILES, AND PROCESSES ANY INPUT FILE      04180007
041900*     PARAMETERS IT MAY NEED TO USE TO READ THE PROMO             04190007
042000*     INTERFACE ID FILE.                                          04200007
042100*----------------------------------------------------------       04210007
042200 1000-INITIALIZATION.                                             04220007
042300                                                                  04230007
042400     OPEN INPUT  CONTROL-CARD-CURR-PRICG-DTE                      04240046
042500                 CONTROL-CARD-FUTRE-CORR-DTE                      04250046
042600                 CONTROL-CARD-PGM-CURR-TMST                       04260095
042700                 CONTROL-CARD-PGM-LAST-RUN-TMST                   04270046
042800                 CONTROL-CARD-CRIT-EFF-DTE.                       04280046
042900     OPEN OUTPUT PROMO-NIGHT-FILE.                                04290025
043000                                                                  04300007
043100     INITIALIZE EP072-PROMO-INTFC-RECORD.                         04310029
043200                                                                  04320020
043300     PERFORM 1010-READ-PGM-CURR-RUN-CARD.                         04330025
043400     PERFORM 1020-READ-PGM-LAST-RUN-CARD.                         04340046
043500     PERFORM 1030-READ-CURR-PRICG-DTE-CARD.                       04350046
043600     PERFORM 1040-READ-FUTRE-CORR-DTE-CARD.                       04360046
043700     PERFORM 1050-READ-CRIT-EFF-DTE-CARD.                         04370046
043800     PERFORM 6100-DATE-ROUTINE.                                   04380007
043900                                                                  04390007
044000*1000-EXIT.                                                       04400018
044100 EJECT.                                                           04410018
044200                                                                  04420007
044300*----------------------------------------------------------       04430018
044400* 1010-READ-PGM-CURR-RUN-CARD.                                    04440046
044500*     READ CONTROL CARD EPCC401. THIS CONTROL CARD CONTAINS       04450018
044600*     THE CURRENT TIMESTAMP                                       04460018
044700*----------------------------------------------------------       04470018
044800 1010-READ-PGM-CURR-RUN-CARD.                                     04480046
044900                                                                  04490018
045000     READ CONTROL-CARD-PGM-CURR-TMST                              04500046
045100                                INTO EP401-CC-CONTROL-CARD        04510066
045200       AT END                                                     04520049
045300          SET PS-END-OF-CNTL-CRD-FILE TO TRUE.                    04530049
045400                                                                  04540049
045500     IF PS-END-OF-CNTL-CRD-FILE                                   04550049
045600       DISPLAY ' '                                                04560061
045700       DISPLAY '** ABEND     **'                                  04570061
045800       DISPLAY '** PROGRAM   **  = ' PC-CURRENT-PROGRAM-NAME      04580061
045900       DISPLAY '** PARAGRAPH **  = 1010-READ-PGM-CURR-RUN-CARD'   04590061
046000       DISPLAY '** CONTROL FILE IS EMPTY  '                       04600061
046100       DISPLAY ' '                                                04610061
046200       MOVE +4002 TO ABEND-CODE                                   04620061
046300       CALL 'ILBOABN0' USING ABEND-CODE                           04630061
046400     ELSE                                                         04640061
046500       DISPLAY '** PROGRAM LAST RUN CONTROL CARD  **'             04650063
046600       DISPLAY '** EPCC401  *  = ' EP401-CC-CURR-RUN-CUTOFF-TMST  04660066
046700       DISPLAY ' '                                                04670061
046800     END-IF.                                                      04680049
046900                                                                  04690018
047000*1010-EXIT.                                                       04700018
047100 EJECT.                                                           04710018
047200                                                                  04720095
047300*----------------------------------------------------------       04730018
047400* 1020-READ-PGM-LAST-RUN-CARD.                                    04740046
047500*     READ CONTROL CARD EPCC114. THIS CONTROL CARD CONTAINS       04750018
047600*     THE TIMESTAMP FROM THE LAST RUN OF EPKUT353                 04760018
047700*----------------------------------------------------------       04770018
047800 1020-READ-PGM-LAST-RUN-CARD.                                     04780046
047900                                                                  04790018
048000     READ CONTROL-CARD-PGM-LAST-RUN-TMST                          04800046
048100                                INTO EP400-CC-CONTROL-CARD        04810066
048200       AT END                                                     04820049
048300          SET PS-END-OF-CNTL-CRD-FILE TO TRUE.                    04830049
048400                                                                  04840049
048500     IF PS-END-OF-CNTL-CRD-FILE                                   04850049
048600       DISPLAY ' '                                                04860061
048700       DISPLAY '** ABEND     **'                                  04870061
048800       DISPLAY '** PROGRAM   **  = ' PC-CURRENT-PROGRAM-NAME      04880061
048900       DISPLAY '** PARAGRAPH **  = 1020-READ-PGM-LAST-RUN-CARD'   04890061
049000       DISPLAY '** CONTROL FILE IS EMPTY  '                       04900061
049100       DISPLAY ' '                                                04910061
049200       MOVE +4002 TO ABEND-CODE                                   04920061
049300       CALL 'ILBOABN0' USING ABEND-CODE                           04930061
049400     ELSE                                                         04940061
049500       DISPLAY '** PROGRAM LAST RUN CONTROL CARD  **'             04950063
049600       DISPLAY '** EPCC400  *  = ' EP400-CC-PREV-RUN-CUTOFF-TMST  04960066
049700       DISPLAY ' '                                                04970061
049800     END-IF.                                                      04980049
049900                                                                  04990018
050000*1020-EXIT.                                                       05000018
050100 EJECT.                                                           05010018
050200                                                                  05020018
050300*----------------------------------------------------------       05030007
050400* 1030-READ-CURR-PRICG-DTE-CARD.                                  05040046
050500*     READ CONTROL CARD EPCC111. THIS CONTROL CARD CONTAINS       05050016
050600*     THE CURRENT PRICING DATE.                                   05060016
050700*----------------------------------------------------------       05070007
050800 1030-READ-CURR-PRICG-DTE-CARD.                                   05080046
050900                                                                  05090007
051000     READ CONTROL-CARD-CURR-PRICG-DTE                             05100046
051100                               INTO EP111-CC-CONTROL-CARD         05110051
051200       AT END                                                     05120051
051300          SET PS-END-OF-CNTL-CRD-FILE TO TRUE.                    05130051
051400                                                                  05140051
051500     IF PS-END-OF-CNTL-CRD-FILE                                   05150051
051600       DISPLAY ' '                                                05160051
051700       DISPLAY '** ABEND     **'                                  05170051
051800       DISPLAY '** PROGRAM   **  = ' PC-CURRENT-PROGRAM-NAME      05180051
051900       DISPLAY '** PARAGRAPH **  = 1030-READ-CURR-PRICG-DTE-CARD' 05190051
052000       DISPLAY '** CONTROL FILE IS EMPTY  '                       05200051
052100       DISPLAY ' '                                                05210051
052200       MOVE +4002 TO ABEND-CODE                                   05220051
052300       CALL 'ILBOABN0' USING ABEND-CODE                           05230051
052400     ELSE                                                         05240061
052500       DISPLAY '** CURRENT PRICING DATE CONTROL CARD  **'         05250063
052600       DISPLAY '** EPCC111       **  = ' EP111-CC-CRNT-DTE        05260062
052700       DISPLAY ' '                                                05270061
052800     END-IF.                                                      05280051
052900                                                                  05290051
053000                                                                  05300007
053100*1030-EXIT.                                                       05310018
053200 EJECT.                                                           05320007
053300                                                                  05330007
053400*----------------------------------------------------------       05340007
053500* 1040-READ-FUTRE-CORR-DTE-CARD.                                  05350046
053600*     READ CONTROL CARD EPCC113. THIS CONTROL CARD CONTAINS       05360016
053700*     THE NEXT FUTURE CORRECTIONS DATE                            05370016
053800*----------------------------------------------------------       05380007
053900 1040-READ-FUTRE-CORR-DTE-CARD.                                   05390046
054000                                                                  05400007
054100     READ CONTROL-CARD-FUTRE-CORR-DTE                             05410046
054200                               INTO EP113-CC-CONTROL-CARD         05420051
054300       AT END                                                     05430051
054400          SET PS-END-OF-CNTL-CRD-FILE TO TRUE.                    05440051
054500                                                                  05450051
054600     IF PS-END-OF-CNTL-CRD-FILE                                   05460051
054700       DISPLAY ' '                                                05470051
054800       DISPLAY '** ABEND     **'                                  05480051
054900       DISPLAY '** PROGRAM   **  = ' PC-CURRENT-PROGRAM-NAME      05490051
055000       DISPLAY '** PARAGRAPH **  = 1040-READ-FUTRE-CORR-DTE-CARD' 05500051
055100       DISPLAY '** CONTROL FILE IS EMPTY  '                       05510051
055200       DISPLAY ' '                                                05520051
055300       MOVE +4002 TO ABEND-CODE                                   05530051
055400       CALL 'ILBOABN0' USING ABEND-CODE                           05540051
055500     ELSE                                                         05550061
055600       DISPLAY '** FUTURE CORRECTION DATE CONTROL CARD  **'       05560063
055700       DISPLAY '** EPCC113       **  = ' EP113-CC-CRNT-DTE        05570061
055800       DISPLAY ' '                                                05580061
055900     END-IF.                                                      05590051
056000                                                                  05600046
056100*1040-EXIT.                                                       05610046
056200 EJECT.                                                           05620046
056300                                                                  05630046
056400*----------------------------------------------------------       05640046
056500* 1050-READ-CRIT-EFF-DTE-CARD.                                    05650046
056600*     READ CONTROL CARD EPCC128  THIS CONTROL CARD CONTAINS       05660046
056700*     THE CRITICAL EFFECTIVE DATE, WHICH DETERMINES IF CHANGES    05670046
056800*     ARE EMERGENCY OR NIGHTLY.                                   05680046
056900*----------------------------------------------------------       05690046
057000 1050-READ-CRIT-EFF-DTE-CARD.                                     05700046
057100                                                                  05710046
057200     READ CONTROL-CARD-CRIT-EFF-DTE                               05720046
057300                               INTO EP128-CC-CONTROL-CARD         05730051
057400       AT END                                                     05740051
057500          SET PS-END-OF-CNTL-CRD-FILE TO TRUE.                    05750051
057600                                                                  05760051
057700     IF PS-END-OF-CNTL-CRD-FILE                                   05770051
057800       DISPLAY ' '                                                05780051
057900       DISPLAY '** ABEND     **'                                  05790051
058000       DISPLAY '** PROGRAM   **  = ' PC-CURRENT-PROGRAM-NAME      05800051
058100       DISPLAY '** PARAGRAPH **  = 1050-READ-CRIT-EFF-DTE-CARD'   05810051
058200       DISPLAY '** CONTROL FILE IS EMPTY  '                       05820051
058300       DISPLAY ' '                                                05830051
058400       MOVE +4002 TO ABEND-CODE                                   05840051
058500       CALL 'ILBOABN0' USING ABEND-CODE                           05850051
058600     ELSE                                                         05860061
058700       DISPLAY '** CRITICAL EFFECTIVE DATE CONTROL CARD  **'      05870063
058800       DISPLAY '** EPCC128       **  = ' EP128-CC-CRITICAL-DTE    05880062
058900       DISPLAY ' '                                                05890061
059000     END-IF.                                                      05900051
059100                                                                  05910046
059200*1050-EXIT.                                                       05920046
059300 EJECT.                                                           05930046
059400                                                                  05940018
059500*----------------------------------------------------------       05950018
059600* 2000-PROCESS-MERCH-EXCLUSIONS                                   05960018
059700*     MAIN PROCESSING AREA - EXECUTES RMS AND ADHOC QUERY         05970018
059800*     TO IDENTIFY MERCHANDISE EXCLUSIONS AND CREATES OUTPUT       05980018
059900*     FILES TO IDENTIFY WHICH STROE GROUP/PROMO INTERFACE I.D     05990018
060000*     COMBO'S NEED RECORDS CREATED FOR THE STORE SERVER.          06000018
060100*----------------------------------------------------------       06010018
060200 2000-PROCESS-MERCH-EXCLUSIONS.                                   06020018
060300                                                                  06030018
060400     PERFORM 2100-PROCESS-RMS-CURSOR.                             06040022
060500                                                                  06050018
060600     PERFORM 2200-PROCESS-ADHOC-CURSOR.                           06060070
060700                                                                  06070018
060800*2000-EXIT.                                                       06080018
060900 EJECT.                                                           06090018
061000                                                                  06100018
061100*----------------------------------------------------------       06110016
061200* 2100-PROCESS-RMS-CURSOR.                                        06120018
061300*     READ THE RECORD FROM THE MERCHANDISE EXCLUSION TABLE AND    06130016
061400*     CREATE PROMO AND PMAP RECORDS BASED ON THE RECORD READ.     06140016
061500*----------------------------------------------------------       06150016
061600 2100-PROCESS-RMS-CURSOR.                                         06160018
061700                                                                  06170078
061800     PERFORM 2110-OPEN-MDSE-EXCL-RMS.                             06180070
061900     PERFORM 2120-FETCH-MDSE-EXCL-RMS                             06190071
062000       UNTIL PS-MDSE-EXCL-CSR-EOF.                                06200051
062100     PERFORM 2130-CLOSE-MDSE-EXCL-RMS.                            06210070
062200                                                                  06220007
062300*2100-EXIT.                                                       06230070
062400 EJECT.                                                           06240007
062500                                                                  06250018
062600*----------------------------------------------------------       06260007
062700* 2110-OPEN-MDSE-EXCL-RMS.                                        06270070
062800*     OPEN THE MERCHANDISE EXCLUSION CURSOR (RMS).                06280016
062900*----------------------------------------------------------       06290007
063000 2110-OPEN-MDSE-EXCL-RMS.                                         06300070
063100                                                                  06310007
063200     PERFORM                                                      06320007
063300         WITH TEST AFTER                                          06330007
063400         VARYING PV-SQL-SUB                                       06340007
063500         FROM 1 BY 1                                              06350007
063600         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 06360007
063700                   OR  SQLCODE = 0)                               06370007
063800                                                                  06380007
063900         EXEC SQL                                                 06390007
064000           OPEN MDSE-EXCL-RMS                                     06400077
064100         END-EXEC                                                 06410007
064200                                                                  06420007
064300         EVALUATE TRUE                                            06430007
064400           WHEN SQLCODE = -904                                    06440070
064500           WHEN SQLCODE = -911                                    06450070
064600           WHEN SQLCODE = -913                                    06460070
064700             CONTINUE                                             06470070
064800           WHEN SQLCODE = 0                                       06480070
064900             SET PS-MDSE-EXCL-CSR-NOT-EOF TO TRUE                 06490070
065000           WHEN SQLWARN0 NOT EQUAL SPACE                          06500070
065100           WHEN SQLCODE NOT EQUAL ZERO                            06510070
065200             MOVE '2110-OPEN-MDSE-EXCL-RMS'                       06520070
065300                                TO PV-PARAGRAPH-NAME              06530070
065400             MOVE 'ERROR ON OPEN OF MDSE EXCL RMS CURSOR'         06540070
065500                                TO PV-DB2-OPERATION               06550070
065600             PERFORM 9900-SQL-ABEND-ROUTINE                       06560070
065700         END-EVALUATE                                             06570070
065800     END-PERFORM.                                                 06580007
065900                                                                  06590007
066000     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         06600007
066100       MOVE '2110-OPEN-MDSE-EXCL-RMS'                             06610070
066200                            TO  PV-PARAGRAPH-NAME                 06620070
066300       MOVE 'OPEN RETRIES EXCEEDED'                               06630070
066400                             TO  PV-DB2-OPERATION                 06640070
066500       PERFORM 9900-SQL-ABEND-ROUTINE                             06650070
066600     END-IF.                                                      06660007
066700                                                                  06670007
066800*2110-EXIT.                                                       06680018
066900 EJECT.                                                           06690007
067000                                                                  06700007
067100*----------------------------------------------------------       06710007
067200* 2120-FETCH-MDSE-EXCL-RMS.                                       06720070
067300*     FETCH THE MERCHANDISE EXCLUSION CURSOR. (RMS)               06730016
067400*----------------------------------------------------------       06740007
067500 2120-FETCH-MDSE-EXCL-RMS.                                        06750070
067600                                                                  06760007
067700     PERFORM                                                      06770007
067800         WITH TEST AFTER                                          06780007
067900         VARYING PV-SQL-SUB                                       06790007
068000         FROM 1 BY 1                                              06800007
068100         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 06810007
068200                   OR  SQLCODE = 0                                06820007
068300                   OR  SQLCODE = +100)                            06830007
068400                                                                  06840007
068500         EXEC SQL                                                 06850077
068600           FETCH MDSE-EXCL-RMS                                    06860077
068700           INTO  :XST00034-EXCL-MDSE-ID                           06870077
068800                ,:XST00034-PROMO-INTFC-SUB-ID                     06880077
068900                ,:XST00034-STAT-CDE                               06890077
069000                ,:XST00034-LAST-UPD-TMST                          06900077
069100                ,:XST00034-SOR-LAST-UPD-TMST                      06910077
069200                ,:XST00029-PROMO-INTFC-ID                         06920077
069300                ,:XST00029-MDSE-LNE-ID                            06930077
069400                ,:XST00029-STR-GP-TYP-CDE                         06940077
069500                ,:XST00029-STR-GP-ID                              06950077
069600                ,:XST00029-STR-SELN-HIER-CDE                      06960077
069700                ,:XST00029-ACTL-STRT-TMST                         06970077
069800                ,:XST00029-ACTL-END-TMST                          06980077
069900                ,:XST00028-PRICG-TYP-CDE                          06990077
070000         END-EXEC                                                 07000077
070100                                                                  07010007
070200         EVALUATE TRUE                                            07020077
070300           WHEN SQLCODE = -904                                    07030077
070400           WHEN SQLCODE = -911                                    07040077
070500           WHEN SQLCODE = -913                                    07050077
070600             CONTINUE                                             07060077
070700           WHEN SQLCODE = ZERO                                    07070077
070800             PERFORM 3000-FORMAT-RMS-OUTPUT                       07080077
070900             ADD 1 TO PC-CNT-RMS-RECS                             07090077
071000           WHEN SQLCODE = +100                                    07100077
071100             SET PS-MDSE-EXCL-CSR-EOF TO TRUE                     07110077
071200           WHEN SQLWARN0 NOT EQUAL SPACE                          07120077
071300           WHEN SQLCODE NOT EQUAL ZERO                            07130077
071400             MOVE '2120-FETCH-MDSE-EXCL-RMS'                      07140077
071500                                 TO PV-PARAGRAPH-NAME             07150077
071600             MOVE 'ERROR ON FETCHING MDSE RMS CSR'                07160077
071700                                 TO PV-DB2-OPERATION              07170077
071800             PERFORM 9900-SQL-ABEND-ROUTINE                       07180077
071900         END-EVALUATE                                             07190077
072000     END-PERFORM.                                                 07200007
072100                                                                  07210007
072200     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         07220078
072300       MOVE '2120-FETCH-MDSE-EXCL-RMS'                            07230070
072400                             TO  PV-PARAGRAPH-NAME                07240070
072500       MOVE 'FETCH RETRIES EXCEEDED'                              07250070
072600                             TO  PV-DB2-OPERATION                 07260070
072700       PERFORM 9900-SQL-ABEND-ROUTINE                             07270070
072800     END-IF.                                                      07280007
072900                                                                  07290007
073000*2120-EXIT.                                                       07300018
073100 EJECT.                                                           07310007
073200                                                                  07320007
073300*-----------------------------------------------------------      07330007
073400* 2130-CLOSE-MDSE-EXCL-RMS.                                       07340070
073500*-----------------------------------------------------------      07350007
073600 2130-CLOSE-MDSE-EXCL-RMS.                                        07360070
073700                                                                  07370007
073800     PERFORM                                                      07380007
073900         WITH TEST AFTER                                          07390007
074000         VARYING PV-SQL-SUB                                       07400007
074100         FROM 1 BY 1                                              07410007
074200         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 07420007
074300                   OR  SQLCODE = 0)                               07430007
074400                                                                  07440007
074500         EXEC SQL                                                 07450077
074600           CLOSE MDSE-EXCL-RMS                                    07460077
074700         END-EXEC                                                 07470077
074800                                                                  07480007
074900         EVALUATE TRUE                                            07490077
075000           WHEN SQLCODE = -904                                    07500077
075100           WHEN SQLCODE = -911                                    07510077
075200           WHEN SQLCODE = -913                                    07520077
075300           WHEN SQLCODE = 0                                       07530077
075400             CONTINUE                                             07540077
075500           WHEN SQLWARN0 NOT EQUAL SPACE                          07550077
075600           WHEN SQLCODE NOT EQUAL ZERO                            07560077
075700             MOVE '2130-CLOSE-MDSE-EXCL-RMS'                      07570077
075800                                  TO PV-PARAGRAPH-NAME            07580075
075900             MOVE 'ERROR ON CLOSE OF MDSE EXCL RMS CURSOR'        07590077
076000                                   TO PV-DB2-OPERATION            07600070
076100             PERFORM 9900-SQL-ABEND-ROUTINE                       07610077
076200         END-EVALUATE                                             07620077
076300     END-PERFORM.                                                 07630007
076400                                                                  07640007
076500     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         07650007
076600       MOVE '2130-CLOSE-MDSE-EXCL-RMS'                            07660077
076700                               TO  PV-PARAGRAPH-NAME              07670007
076800       MOVE 'CLOSE RETRIES EXCEEDED'                              07680077
076900                               TO  PV-DB2-OPERATION               07690007
077000       PERFORM 9900-SQL-ABEND-ROUTINE                             07700077
077100     END-IF.                                                      07710007
077200                                                                  07720007
077300*2130-EXIT.                                                       07730018
077400 EJECT.                                                           07740007
077500                                                                  07750007
077600*----------------------------------------------------------       07760018
077700* 2200-PROCESS-ADHOC-CURSOR.                                      07770070
077800*     READ THE RECORD FROM THE MERCHANDISE EXCLUSION FILE AND     07780018
077900*     CREATE PROMO AND PMAP RECORDS BASED ON THE RECORD READ.     07790018
078000*----------------------------------------------------------       07800018
078100 2200-PROCESS-ADHOC-CURSOR.                                       07810070
078200                                                                  07820078
078300     PERFORM 2210-OPEN-ADHOC-CURSOR.                              07830070
078400     PERFORM 2220-FETCH-ADHOC-CURSOR                              07840070
078500       UNTIL PS-MDSE-EXCL-ADHOC-CSR-EOF.                          07850070
078600     PERFORM 2230-CLOSE-ADHOC-CURSOR.                             07860070
078700                                                                  07870018
078800*2200-EXIT.                                                       07880018
078900 EJECT.                                                           07890018
079000                                                                  07900018
079100*----------------------------------------------------------       07910007
079200* 2210-OPEN-ADHOC-CURSOR.                                         07920070
079300*     OPEN THE BWP BUY PROMO AND PMAP CURSOR.                     07930007
079400*----------------------------------------------------------       07940007
079500 2210-OPEN-ADHOC-CURSOR.                                          07950070
079600                                                                  07960007
079700     PERFORM                                                      07970007
079800         WITH TEST AFTER                                          07980007
079900         VARYING PV-SQL-SUB                                       07990007
080000         FROM 1 BY 1                                              08000007
080100         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 08010007
080200                   OR  SQLCODE = 0)                               08020007
080300                                                                  08030007
080400         EXEC SQL                                                 08040077
080500           OPEN MDSE-EXCL-ADHOC                                   08050077
080600         END-EXEC                                                 08060077
080700                                                                  08070007
080800         EVALUATE TRUE                                            08080007
080900           WHEN SQLCODE = -904                                    08090075
081000           WHEN SQLCODE = -911                                    08100075
081100           WHEN SQLCODE = -913                                    08110075
081200             CONTINUE                                             08120075
081300           WHEN SQLCODE = 0                                       08130075
081400             SET PS-MDSE-EXCL-ADHOC-CSR-NOT-EOF TO TRUE           08140075
081500           WHEN SQLWARN0 NOT EQUAL SPACE                          08150075
081600           WHEN SQLCODE NOT EQUAL ZERO                            08160075
081700             MOVE '2210-OPEN-ADHOC-CURSOR'                        08170075
081800                                  TO PV-PARAGRAPH-NAME            08180070
081900             MOVE 'ERROR ON OPEN OF MDSE ADHOC CURSOR'            08190075
082000                                  TO PV-DB2-OPERATION             08200070
082100             PERFORM 9900-SQL-ABEND-ROUTINE                       08210075
082200         END-EVALUATE                                             08220007
082300     END-PERFORM.                                                 08230007
082400                                                                  08240007
082500     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         08250007
082600       MOVE '2210-OPEN-ADHOC-CURSOR'                              08260070
082700                            TO  PV-PARAGRAPH-NAME                 08270070
082800       MOVE 'OPEN RETRIES EXCEEDED'                               08280070
082900                             TO  PV-DB2-OPERATION                 08290070
083000       PERFORM 9900-SQL-ABEND-ROUTINE                             08300070
083100     END-IF.                                                      08310007
083200                                                                  08320007
083300*2210-EXIT.                                                       08330018
083400 EJECT.                                                           08340007
083500                                                                  08350007
083600*----------------------------------------------------------       08360007
083700* 2220-FETCH-ADHOC-CURSOR.                                        08370070
083800*     FETCH THE BWP BUY PROMO AND PMAP CURSOR.                    08380007
083900*----------------------------------------------------------       08390007
084000 2220-FETCH-ADHOC-CURSOR.                                         08400070
084100                                                                  08410007
084200     PERFORM                                                      08420007
084300         WITH TEST AFTER                                          08430007
084400         VARYING PV-SQL-SUB                                       08440007
084500         FROM 1 BY 1                                              08450007
084600         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 08460007
084700                   OR  SQLCODE = 0                                08470007
084800                   OR  SQLCODE = +100)                            08480007
084900                                                                  08490007
085000         EXEC SQL                                                 08500077
085100           FETCH MDSE-EXCL-ADHOC                                  08510077
085200           INTO  :XST00034-EXCL-MDSE-ID                           08520077
085300                ,:XST00034-PROMO-INTFC-SUB-ID                     08530077
085400                ,:XST00034-STAT-CDE                               08540077
085500                ,:XST00034-LAST-UPD-TMST                          08550077
085600                ,:XST00034-SOR-LAST-UPD-TMST                      08560077
085700                ,:XST00031-PROMO-INTFC-ID                         08570077
085800                ,:XST00031-MDSE-LNE-ID                            08580077
085900                ,:XST00031-ADHC-STR-GP-ID                         08590077
086000                ,:XST00031-STR-SELN-HIER-CDE                      08600077
086100                ,:XST00031-ACTL-STRT-TMST                         08610077
086200                ,:XST00031-ACTL-END-TMST                          08620077
086300                 ,:XST00028-PRICG-TYP-CDE                         08630077
086400         END-EXEC                                                 08640077
086500                                                                  08650007
086600         EVALUATE TRUE                                            08660077
086700           WHEN SQLCODE = -904                                    08670077
086800           WHEN SQLCODE = -911                                    08680077
086900           WHEN SQLCODE = -913                                    08690077
087000             CONTINUE                                             08700077
087100           WHEN SQLCODE = ZERO                                    08710077
087200             PERFORM 3100-FORMAT-ADHOC-OUTPUT                     08720077
087300             ADD 1 TO PC-CNT-ADHOC-RECS                           08730077
087400           WHEN SQLCODE = +100                                    08740077
087500             SET PS-MDSE-EXCL-ADHOC-CSR-EOF TO TRUE               08750077
087600           WHEN SQLWARN0 NOT EQUAL SPACE                          08760077
087700           WHEN SQLCODE NOT EQUAL ZERO                            08770077
087800             MOVE '2220-FETCH-ADHOC-CURSOR'                       08780077
087900                                TO PV-PARAGRAPH-NAME              08790077
088000             MOVE 'ERROR ON FETCHING MDSE ADHOC CURSOR'           08800077
088100                                 TO PV-DB2-OPERATION              08810077
088200             DISPLAY 'SQLCODE= ' SQLCODE                          08820077
088300             PERFORM 9900-SQL-ABEND-ROUTINE                       08830077
088400         END-EVALUATE                                             08840077
088500     END-PERFORM.                                                 08850007
088600                                                                  08860007
088700     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         08870077
088800       MOVE '2220-FETCH-ADHOC-CURSOR'                             08880075
088900                               TO  PV-PARAGRAPH-NAME              08890007
089000       MOVE 'FETCH RETRIES EXCEEDED'                              08900075
089100                               TO  PV-DB2-OPERATION               08910007
089200       PERFORM 9900-SQL-ABEND-ROUTINE                             08920075
089300     END-IF.                                                      08930007
089400                                                                  08940007
089500*2220-EXIT.                                                       08950018
089600 EJECT.                                                           08960007
089700                                                                  08970007
089800*-----------------------------------------------------------      08980007
089900* 2230-CLOSE-ADHOC-CURSOR.                                        08990070
090000*     CLOSE THE BWP BUY PROMO AND PMAP CURSOR.                    09000007
090100*-----------------------------------------------------------      09010007
090200 2230-CLOSE-ADHOC-CURSOR.                                         09020070
090300                                                                  09030007
090400     PERFORM                                                      09040007
090500         WITH TEST AFTER                                          09050007
090600         VARYING PV-SQL-SUB                                       09060007
090700         FROM 1 BY 1                                              09070007
090800         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 09080007
090900                   OR  SQLCODE = 0)                               09090007
091000                                                                  09100007
091100         EXEC SQL                                                 09110077
091200           CLOSE MDSE-EXCL-ADHOC                                  09120077
091300         END-EXEC                                                 09130077
091400                                                                  09140007
091500         EVALUATE TRUE                                            09150077
091600           WHEN SQLCODE = -904                                    09160077
091700           WHEN SQLCODE = -911                                    09170077
091800           WHEN SQLCODE = -913                                    09180077
091900           WHEN SQLCODE = 0                                       09190077
092000             CONTINUE                                             09200077
092100           WHEN SQLWARN0 NOT EQUAL SPACE                          09210077
092200           WHEN SQLCODE NOT EQUAL ZERO                            09220077
092300             MOVE '2230-CLOSE-ADHOC-CURSOR'                       09230077
092400                                   TO PV-PARAGRAPH-NAME           09240070
092500             MOVE 'ERROR ON CLOSE OF MDSE ADHOC CURSOR'           09250077
092600                                   TO PV-DB2-OPERATION            09260070
092700             PERFORM 9900-SQL-ABEND-ROUTINE                       09270077
092800         END-EVALUATE                                             09280077
092900     END-PERFORM.                                                 09290007
093000                                                                  09300007
093100     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         09310007
093200       MOVE '2230-CLOSE-ADHOC-CURSOR'                             09320070
093300                               TO  PV-PARAGRAPH-NAME              09330007
093400       MOVE 'CLOSE RETRIES EXCEEDED'                              09340070
093500                               TO  PV-DB2-OPERATION               09350007
093600       PERFORM 9900-SQL-ABEND-ROUTINE                             09360070
093700     END-IF.                                                      09370007
093800                                                                  09380007
093900*2230-EXIT.                                                       09390018
094000 EJECT.                                                           09400007
094100                                                                  09410022
094200*-----------------------------------------------------------      09420007
094300* 3000-FORMAT-RMS-OUTPUT.                                         09430029
094400*     POPULATE COPYBOOK EPRD072.                                  09440007
094500*-----------------------------------------------------------      09450007
094600 3000-FORMAT-RMS-OUTPUT.                                          09460029
094700                                                                  09470021
094800     INITIALIZE EP072-PROMO-INTFC-RECORD.                         09480035
094900     MOVE PC-BUSINESS-EVENT-ID                                    09490036
095000                             TO EP072-BUSINESS-EVENT-ID.          09500021
095100     MOVE PC-RMS-PRC-SETUP-IND                                    09510021
095200                             TO EP072-PRC-SETUP-IND.              09520021
095300     MOVE XST00029-STR-GP-TYP-CDE                                 09530021
095400                             TO EP072-SETUP-STR-GRP-TYP-CDE.      09540021
095500     MOVE XST00029-STR-GP-ID                                      09550021
095600                             TO EP072-SETUP-STR-GRP-ID.           09560021
095700     MOVE XST00029-STR-SELN-HIER-CDE                              09570021
095800                             TO EP072-STR-SELN-HIER-CDE.          09580021
095900     MOVE XST00029-STR-GP-TYP-CDE                                 09590021
096000                             TO EP072-DIST-STR-GRP-TYP-CDE.       09600021
096100     MOVE XST00029-STR-GP-ID                                      09610021
096200                             TO EP072-DIST-STR-GRP-ID.            09620021
096300     MOVE PC-FILE-ACT-TYPE   TO EP072-FILE-ACT-TYP.               09630021
096400                                                                  09640021
096500     MOVE XST00029-ACTL-STRT-TMST                                 09650038
096600                             TO PV-ACTL-STRT-TMST.                09660038
096700                                                                  09670038
096800     IF PV-ACTL-STRT-TMST-DATE > EP128-CC-CRITICAL-DTE            09680038
096900       AND PV-ACTL-STRT-TMST-DATE < EP113-CC-CRNT-DTE             09690072
097000         MOVE PC-APPLY-NIGHTLY   TO EP072-APPLY-IND               09700072
097100     END-IF.                                                      09710038
097200                                                                  09720038
097300     MOVE XST00034-STAT-CDE  TO PC-MDSE-EXCL-STAT-CDE             09730038
097400                                                                  09740038
097500     IF PC-SCHEDULED-STATUS                                       09750038
097600       MOVE PC-ADD-STAT-CDE                                       09760038
097700                              TO EP072-RECORD-ACTION              09770072
097800     ELSE                                                         09780038
097900       IF PC-DELETE-STATUS OR PC-CANCEL-STATUS                    09790072
098000         MOVE PC-DELETE-STAT-CDE                                  09800072
098100                              TO EP072-RECORD-ACTION              09810072
098200       END-IF                                                     09820072
098300     END-IF.                                                      09830070
098400                                                                  09840038
098500     MOVE XST00029-PROMO-INTFC-ID                                 09850038
098600                             TO EP072-PROMO-INTFC-ID.             09860038
098700     MOVE XST00034-PROMO-INTFC-SUB-ID                             09870070
098800                             TO EP072-PROMO-INTFC-SUB-ID.         09880070
098900     MOVE XST00029-MDSE-LNE-ID                                    09890070
099000                             TO EP072-MERCH-LNE-ID.               09900070
099100     MOVE XST00034-EXCL-MDSE-ID                                   09910070
099200                             TO EP072-EXCL-MDSE-ID.               09920070
099300     MOVE XST00028-PRICG-TYP-CDE                                  09930070
099400                             TO EP072-PRICG-TYP-CDE.              09940070
099500     MOVE PC-MDSE-EXCL-IND                                        09950070
099600                             TO EP072-MDSE-INC-EXC-IND.           09960070
099700     MOVE XST00029-ACTL-STRT-TMST                                 09970070
099800                             TO EP072-STR-GRP-PROMO-STRT-TMST.    09980070
099900     MOVE XST00029-ACTL-END-TMST                                  09990070
100000                             TO EP072-STR-GRP-PROMO-END-TMST.     10000070
100100     MOVE XST00034-SOR-LAST-UPD-TMST                              10010070
100200                             TO EP072-SOR-LAST-UPD-TMST.          10020070
100300                                                                  10030070
100400     IF EP072-APPLY-NIGHTLY                                       10040070
100500       PERFORM 4000-WRITE-NIGHT-APPLY-RECORD                      10050070
100600     ELSE                                                         10060070
100700       MOVE PC-APPLY-NIGHTLY   TO EP072-APPLY-IND                 10070079
100800       PERFORM 4000-WRITE-NIGHT-APPLY-RECORD                      10080070
100900     END-IF.                                                      10090070
101000                                                                  10100070
101100*3000-EXIT.                                                       10110070
101200 EJECT.                                                           10120070
101300*-----------------------------------------------------------      10130070
101400* 3100-FORMAT-ADHOC-OUTPUT.                                       10140070
101500*     POPULATE COPYBOOK EPRD072.                                  10150038
101600*-----------------------------------------------------------      10160007
101700 3100-FORMAT-ADHOC-OUTPUT.                                        10170029
101800                                                                  10180022
101900     INITIALIZE EP072-PROMO-INTFC-RECORD.                         10190035
102000     MOVE PC-BUSINESS-EVENT-ID                                    10200022
102100                             TO EP072-BUSINESS-EVENT-ID.          10210022
102200     MOVE PC-ADHOC-PRC-SETUP-IND                                  10220027
102300                             TO EP072-PRC-SETUP-IND.              10230022
102400     MOVE PC-ADHOC-STR-GRP-TYP-CDE                                10240022
102500                             TO EP072-SETUP-STR-GRP-TYP-CDE.      10250022
102600     MOVE XST00031-ADHC-STR-GP-ID                                 10260024
102700                             TO EP072-SETUP-STR-GRP-ID.           10270022
102800     MOVE XST00031-STR-SELN-HIER-CDE                              10280022
102900                             TO EP072-STR-SELN-HIER-CDE.          10290022
103000     MOVE PC-ADHOC-STR-GRP-TYP-CDE                                10300022
103100                             TO EP072-DIST-STR-GRP-TYP-CDE.       10310022
103200     MOVE XST00031-ADHC-STR-GP-ID                                 10320024
103300                             TO EP072-DIST-STR-GRP-ID.            10330022
103400     MOVE PC-FILE-ACT-TYPE   TO EP072-FILE-ACT-TYP.               10340022
103500                                                                  10350022
103600     MOVE XST00031-ACTL-STRT-TMST                                 10360038
103700                             TO PV-ACTL-STRT-TMST.                10370038
103800                                                                  10380038
103900     IF PV-ACTL-STRT-TMST-DATE > EP128-CC-CRITICAL-DTE            10390038
104000       AND PV-ACTL-STRT-TMST-DATE < EP113-CC-CRNT-DTE             10400072
104100         MOVE PC-APPLY-NIGHTLY   TO EP072-APPLY-IND               10410072
104200     END-IF.                                                      10420022
104300                                                                  10430022
104400     MOVE XST00034-STAT-CDE  TO PC-MDSE-EXCL-STAT-CDE             10440024
104500                                                                  10450022
104600     IF PC-SCHEDULED-STATUS                                       10460022
104700       MOVE PC-ADD-STAT-CDE                                       10470022
104800                             TO EP072-RECORD-ACTION               10480022
104900     ELSE                                                         10490022
105000       IF PC-DELETE-STATUS OR PC-CANCEL-STATUS                    10500072
105100         MOVE PC-DELETE-STAT-CDE                                  10510072
105200                             TO EP072-RECORD-ACTION               10520070
105300       END-IF                                                     10530072
105400     END-IF.                                                      10540070
105500                                                                  10550022
105600     MOVE XST00031-PROMO-INTFC-ID                                 10560022
105700                             TO EP072-PROMO-INTFC-ID.             10570022
105800     MOVE XST00034-PROMO-INTFC-SUB-ID                             10580070
105900                             TO EP072-PROMO-INTFC-SUB-ID.         10590070
106000     MOVE XST00031-MDSE-LNE-ID                                    10600022
106100                             TO EP072-MERCH-LNE-ID.               10610022
106200     MOVE XST00034-EXCL-MDSE-ID                                   10620070
106300                             TO EP072-EXCL-MDSE-ID.               10630070
106400     MOVE XST00028-PRICG-TYP-CDE                                  10640022
106500                             TO EP072-PRICG-TYP-CDE.              10650022
106600     MOVE PC-MDSE-EXCL-IND                                        10660024
106700                             TO EP072-MDSE-INC-EXC-IND.           10670022
106800     MOVE XST00031-ACTL-STRT-TMST                                 10680080
106900                             TO EP072-STR-GRP-PROMO-STRT-TMST.    10690068
107000     MOVE XST00031-ACTL-END-TMST                                  10700080
107100                             TO EP072-STR-GRP-PROMO-END-TMST.     10710064
107200     MOVE XST00034-SOR-LAST-UPD-TMST                              10720064
107300                             TO EP072-SOR-LAST-UPD-TMST.          10730064
107400                                                                  10740064
107500     IF EP072-APPLY-NIGHTLY                                       10750022
107600       PERFORM 4000-WRITE-NIGHT-APPLY-RECORD                      10760029
107700     ELSE                                                         10770022
107800       MOVE PC-APPLY-NIGHTLY   TO EP072-APPLY-IND                 10780079
107900       PERFORM 4000-WRITE-NIGHT-APPLY-RECORD                      10790079
108000     END-IF.                                                      10800022
108100                                                                  10810022
108200*3100-EXIT.                                                       10820029
108300 EJECT.                                                           10830017
108400                                                                  10840029
108500*----------------------------------------------------------       10850007
108600* 4000-WRITE-NIGHT-APPLY-RECORD.                                  10860029
108700*     WRITES THE PROMO FULL FILE RECORD TO THE FULL FILE          10870007
108800*----------------------------------------------------------       10880007
108900 4000-WRITE-NIGHT-APPLY-RECORD.                                   10890029
109000                                                                  10900007
109100     WRITE PROMO-NIGHT-RECORD FROM EP072-PROMO-INTFC-RECORD.      10910022
109200                                                                  10920022
109300     ADD 1           TO PC-CNT-NIGHT-RECS                         10930025
109400                        PC-CNT-ALL-RECS.                          10940025
109500                                                                  10950022
109600*4000-EXIT.                                                       10960029
109700 EJECT.                                                           10970007
109800                                                                  10980007
109900*----------------------------------------------------------       10990070
110000* DATE ROUTINE TO SET UP THE PROCESS DATE IN                      11000070
110100* CCYYMMDD FORMAT.                                                11010070
110200*----------------------------------------------------------       11020070
110300 6100-DATE-ROUTINE.                                               11030029
110400                                                                  11040029
110500     INITIALIZE DPG51 DPG52 DPG53                                 11050029
110600                DPG54 DPG55 DPG56.                                11060029
110700                                                                  11070029
110800     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      11080029
110900     SET DPG51-INCREMENT-DATE       TO TRUE.                      11090029
111000     SET DPG52-LK-DTE-ISO-FMT       TO TRUE.                      11100029
111100     MOVE 1                         TO DPG51-INCR-DECR-DAYS-9.    11110029
111200     MOVE EP111-CC-CRNT-DTE         TO DPG52-DB2-ISO-DATE-FMT.    11120029
111300                                                                  11130029
111400     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    11140029
111500                                             DPG54 DPG55 DPG56.   11150029
111600                                                                  11160029
111700     IF DPG54-SEVERE-ERROR OR DPG54-DATE-INVALID                  11170029
111800       DISPLAY '** ABEND **'                                      11180070
111900       DISPLAY '** PROGRAM = EPKUT353'                            11190070
112000       DISPLAY 'DATE = ' EP111-CC-CRNT-DTE                        11200070
112100       DISPLAY DPG54-ERROR-MESSAGE                                11210070
112200       MOVE 4019 TO PV-ABEND-CODE                                 11220070
112300       CALL 'ILBOABN0' USING PV-ABEND-CODE                        11230070
112400     END-IF.                                                      11240051
112500                                                                  11250029
112600     MOVE DPG55-DB2-ISO-DATE-FMT     TO EP111-CC-DATE-PLUS1.      11260029
112700                                                                  11270029
112800     INITIALIZE DPG51 DPG52 DPG53                                 11280029
112900                DPG54 DPG55 DPG56.                                11290029
113000                                                                  11300029
113100     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      11310029
113200     SET DPG51-DECREMENT-DATE       TO TRUE.                      11320029
113300     SET DPG52-LK-DTE-ISO-FMT       TO TRUE.                      11330029
113400     MOVE 1                         TO DPG51-INCR-DECR-DAYS-9.    11340029
113500     MOVE EP113-CC-CRNT-DTE         TO DPG52-DB2-ISO-DATE-FMT.    11350029
113600                                                                  11360029
113700     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    11370029
113800                                             DPG54 DPG55 DPG56.   11380029
113900                                                                  11390029
114000     IF DPG54-SEVERE-ERROR OR DPG54-DATE-INVALID                  11400029
114100       DISPLAY '** ABEND **'                                      11410070
114200       DISPLAY '** PROGRAM = EPKUT353'                            11420070
114300       DISPLAY 'DATE = ' EP111-CC-CRNT-DTE                        11430070
114400       DISPLAY DPG54-ERROR-MESSAGE                                11440070
114500       MOVE 4019 TO PV-ABEND-CODE                                 11450070
114600       CALL 'ILBOABN0' USING PV-ABEND-CODE                        11460070
114700     END-IF.                                                      11470051
114800                                                                  11480029
114900     MOVE DPG55-DB2-ISO-DATE-FMT    TO EP113-CC-CRNT-DTE-MINUS1.  11490029
115000                                                                  11500029
115100*6100-EXIT.                                                       11510029
115200 EJECT.                                                           11520029
115300                                                                  11530029
115400*----------------------------------------------------------       11540007
115500* 9900-SQL-ABEND-ROUTINE.                                         11550007
115600*     SQL ABEND ROUTINE.                                          11560007
115700*----------------------------------------------------------       11570007
115800 9900-SQL-ABEND-ROUTINE.                                          11580007
115900                                                                  11590007
116000     DISPLAY '** ABEND     **'.                                   11600007
116100     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        11610007
116200     DISPLAY '** PARAGRAPH ** = '                                 11620052
116300     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               11630007
116400                                                                  11640007
116500     COPY DPPD004.                                                11650007
116600     SET ABEND-4013-DB2-ERROR TO TRUE.                            11660007
116700     CALL 'ILBOABN0' USING ABEND-CODE.                            11670007
116800                                                                  11680007
116900*9900-EXIT.                                                       11690007
117000 EJECT.                                                           11700007
117100                                                                  11710007
117200*----------------------------------------------------------       11720007
117300* 9999-WRAPUP.                                                    11730007
117400*     END OF PROGRAM ROUTINE.  CLOSES ALL FILES AND DISPLAYS      11740007
117500*     ANY DATA FROM THE PROGRAM.                                  11750007
117600*----------------------------------------------------------       11760007
117700 9999-WRAPUP.                                                     11770007
117800                                                                  11780022
117900     CLOSE CONTROL-CARD-CURR-PRICG-DTE                            11790046
118000           CONTROL-CARD-FUTRE-CORR-DTE                            11800046
118100           CONTROL-CARD-PGM-CURR-TMST                             11810095
118200           CONTROL-CARD-PGM-LAST-RUN-TMST                         11820046
118300           CONTROL-CARD-CRIT-EFF-DTE                              11830046
118400           PROMO-NIGHT-FILE.                                      11840022
118500                                                                  11850007
118600     DISPLAY ' '.                                                 11860007
118700     DISPLAY '*********************************************'.     11870007
118800     DISPLAY 'PROGRAM NAME: ' PC-CURRENT-PROGRAM-NAME.            11880007
118900     DISPLAY '*********************************************'.     11890007
119000     DISPLAY 'NUMBER OF NIGHT RECS WRITTEN: ' PC-CNT-NIGHT-RECS.  11900022
119100     DISPLAY 'NUMBER OF RECS FROM RMS QUERY:' PC-CNT-RMS-RECS.    11910032
119200     DISPLAY 'NUMBER OF RECS FROM ADHC QUERY: ' PC-CNT-ADHOC-RECS.11920032
119300     DISPLAY 'ALL RECS WRITTEN: ' PC-CNT-ALL-RECS.                11930007
119400     DISPLAY '*********************************************'.     11940007
119500                                                                  11950007
119600*9999-EXIT.                                                       11960007
119700 EJECT.                                                           11970007
119800                                                                  11980007
