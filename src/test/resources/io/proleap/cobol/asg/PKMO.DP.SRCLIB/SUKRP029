000100***************************************************************** 00010099
******* CHECKED OUT BY DAVID WELLER (TKMA602) ON 12/3/2013              00011099
000200 IDENTIFICATION DIVISION.                                         00020001
000300 TITLE 'DAILY OPERATIONAL AUDIT STATUS REPORT'                    00030020
000400***************************************************************** 00040001
000500                                                                  00050001
000600 PROGRAM-ID.             SUKRP029.                                00060001
000700 AUTHOR.                 LYNN MCADAMS.                            00070001
000800 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00080001
000900 DATE-WRITTEN            JANUARY, 2002.                           00090001
001000 DATE-COMPILED.                                                   00100001
001100***************************************************************** 00110001
001200* THIS PROGRAM CREATES THE 'DAILY OPERATIONAL AUDIT STATUS        00120024
001300* REPORT'.  THIS IS A SCHEDULED DAILY JOB RUN.                    00130036
001400***************************************************************** 00140001
001500 ENVIRONMENT DIVISION.                                            00150001
001600***************************************************************** 00160001
001700                                                                  00170001
001800 CONFIGURATION SECTION.                                           00180001
001900                                                                  00190001
002000 SOURCE-COMPUTER.        IBM-3090.                                00200001
002100 OBJECT-COMPUTER.        IBM-3090.                                00210001
002200                                                                  00220001
002300 INPUT-OUTPUT SECTION.                                            00230001
002400                                                                  00240001
002500 FILE-CONTROL.                                                    00250001
002600*                                                                 00260001
002700     SELECT SU-CARTON-AUDIT-RPT-FILE                              00270001
002800         ASSIGN TO RPT01.                                         00280001
002900*                                                                 00290001
003000***************************************************************** 00300001
003100 DATA DIVISION.                                                   00310001
003200***************************************************************** 00320001
003300*                                                                 00330001
003400 FILE SECTION.                                                    00340001
003500*                                                                 00350001
003600 FD  SU-CARTON-AUDIT-RPT-FILE                                     00360001
003700     RECORDING MODE IS F                                          00370001
003800     BLOCK CONTAINS 0  RECORDS.                                   00380001
003900 01  SU-CARTON-AUDIT-RPT-RECORD      PIC  X(132).                 00390001
004000*                                                                 00400001
004100                                                                  00410001
004200 WORKING-STORAGE SECTION.                                         00420001
004300*                                                                 00430001
004400 01  PROGRAM-SWITCHES.                                            00440001
004500     05  PS-FIRST-TIME-SW                PIC X(01) VALUE 'N'.     00450099
004600         88  PS-FIRST-TIME-YES                     VALUE 'Y'.     00460099
004700         88  PS-FIRST-TIME-NO                      VALUE 'N'.     00470099
004800     05  PS-EOF-AUDIT-CSR-SW         PIC  X(01)    VALUE 'N'.     00480017
004900         88  PS-EOF-AUDIT-CSR-YES                  VALUE 'Y'.     00490017
005000         88  PS-EOF-AUDIT-CSR-NO                   VALUE 'N'.     00500017
005100     05  PS-NEW-PAGE-SW              PIC  X(03)    VALUE 'N'.     00510099
005200         88  PS-NEW-PAGE                           VALUE 'Y'.     00520099
005300         88  PS-NOT-NEW-PAGE                       VALUE 'N'.     00530099
005400*                                                                 00540001
005500 01  PC-CONSTANTS.                                                00550001
005600     05  PC-1                        PIC S9(03)    VALUE +1       00560001
005700                                                   COMP-3.        00570001
005800     05  PC-2                        PIC S9(03)    VALUE +2       00580001
005900                                                   COMP-3.        00590001
006000     05  PC-3                        PIC S9(03)    VALUE +3       00600001
006100                                                   COMP-3.        00610001
006200     05  PC-7                        PIC S9(01)    VALUE +7.      00620001
006300     05  PC-09                       PIC S9(03)    VALUE +09      00630099
006400                                                   COMP-3.        00640099
006500     05  PC-12                       PIC S9(03)    VALUE +12      00650099
006600                                                   COMP-3.        00660001
006700     05  PC-60                       PIC S9(03)    VALUE +60      00670001
006800                                                   COMP-3.        00680001
006900     05  PC-DASH                     PIC  X(01)    VALUE '-'.     00690001
007000     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     00700001
007100     05  PC-00                       PIC  X(02)    VALUE '00'.    00710001
007200     05  PC-BLANK                    PIC  X(02)    VALUE '  '.    00720088
007300     05  PC-LONG-NAME                PIC  X(02)    VALUE '01'.    00730001
007400     05  PC-ACTIVE-STATUS            PIC  X(01)    VALUE 'A'.     00740001
007500     05  PC-SUKRP029                 PIC  X(08)    VALUE          00750005
007600         'SUKRP029'.                                              00760005
007700     05  PC-100-PCT-CHECK            PIC  X(06)    VALUE          00770099
007800         '100%  '.                                                00780099
007900     05  PC-SPOT-CHECK               PIC  X(06)    VALUE          00790099
008000         'SPOT  '.                                                00800099
008100     05  PC-REWORK                   PIC  X(06)    VALUE          00810099
008200         'REWORK'.                                                00820099
008300     05  PC-IN-PROCESS               PIC  X(10)    VALUE          00830001
008400         'IN PROCESS'.                                            00840001
008500     05  PC-COMPLETE                 PIC  X(10)    VALUE          00850001
008600         '  COMPLETE'.                                            00860001
008700     05  PC-UNKNOWN                  PIC  X(10)    VALUE          00870001
008800         'UNKNOWN   '.                                            00880001
008900     05  PC-BLK-CASE                 PIC  X(07)    VALUE          00890083
009000         'BLK/CSE'.                                               00900083
009100     05  PC-PREPACK                  PIC  X(07)    VALUE          00910083
009200         'PREPACK'.                                               00920083
009300     05  PC-PBS                      PIC  X(07)    VALUE          00930083
009400         'PBS    '.                                               00940083
009500     05  PC-DEFAULT-TMST             PIC  X(26)    VALUE          00950001
009600         '9999-09-09-09.09.09.999999'.                            00960001
009700     05  PC-BLANK-LINE               PIC  X(132)   VALUE SPACE.   00970003
009800     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       00980001
009900     05  PC-MAX-REPORT-LINES         PIC S9(04)  VALUE +62        00990001
010000                                                  COMP SYNC.      01000001
010100     05  PC-PROGRAM-NAME             PIC  X(08)    VALUE          01010019
010200         'SUKRP029'.                                              01020019
010300*                                                                 01030001
010400 01  PV-MISC-FIELDS.                                              01040001
010410     05  PV-NAME                     PIC X(30).                   01041099
010500     05  PV-AUDIT-TYPE               PIC X(06) VALUE SPACE.       01050099
010600     05  PV-AUDIT-STATUS             PIC X(10) VALUE SPACE.       01060099
010700     05  PV-PACKAGE-TYPE             PIC X(07) VALUE SPACE.       01070099
010800                                                                  01080099
010900     05  PV-DB2-FUNCTION             PIC X(30) VALUE SPACE.       01090099
011000     05  PV-PARAGRAPH                PIC X(30) VALUE SPACE.       01100019
011100     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     01110001
011200                                                   COMP-3.        01120001
011300     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01130001
011400                                                   COMP-3.        01140001
011500     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01150001
011600                                                   COMP SYNC.     01160001
011700     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACE.   01170003
011800     05  PV-AUDIT-AGE-HOURS          PIC S9(04)    VALUE ZERO     01180049
011900                                                   COMP-3.        01190034
012000     05  PV-PRCT-UNITS-COMPLETE          PIC  9(03)V99.           01200099
012100     05  PV-PERCENT-EDITED.                                       01210099
012200         10  PV-PERCENT                  PIC  Z(03).99.           01220099
012300         10  FILLER                      PIC  X(01) VALUE '%'.    01230099
012400     05  PV-PRCT-CARTS-COMPLETE          PIC  9(03)V99.           01240099
012500     05  PV-DIVIDEND                     PIC  9(03)V9999.         01250099
012600                                                                  01260099
012700********************                                              01270049
012800     05  PV-SOURCE-CDE               PIC  X(03)    VALUE SPACE.   01280040
012900         88  PV-SRC-MANUAL                         VALUE 'MAN'.   01290011
013000         88  PV-SRC-SYSTEM-PRM                     VALUE 'SYS'.   01300027
013100         88  PV-SRC-SYSTEM-OPN                     VALUE 'SYS'.   01310027
013200     05  PV-OPER-UNT-ID              PIC  S9(4) COMP              01320049
013300                                                   VALUE ZERO.    01330049
013400     05  PV-STRT-DATE                PIC  X(10)    VALUE SPACE.   01340056
013500     05  PV-STRT-DATE-R REDEFINES PV-STRT-DATE.                   01350056
013600         10  PV-STRT-DATE-CCYY       PIC  X(04).                  01360099
013700         10  FILLER                  PIC  X(01).                  01370056
013800         10  PV-STRT-DATE-MM         PIC  X(02).                  01380056
013900         10  FILLER                  PIC  X(01).                  01390056
014000         10  PV-STRT-DATE-DD         PIC  X(02).                  01400056
014100     05  PV-STRT-TIME                PIC  X(05)    VALUE SPACE.   01410060
014200     05  PV-STRT-TIME-R REDEFINES PV-STRT-TIME.                   01420056
014300         10  PV-STRT-TIME-HH         PIC  X(02).                  01430056
014400         10  FILLER                  PIC  X(01).                  01440056
014500         10  PV-STRT-TIME-MM         PIC  X(02).                  01450056
014600     05  PV-AUD-CNTL-NBR             PIC  S9(9) COMP              01460049
014700                                                   VALUE ZERO.    01470049
014800     05  PV-AUD-TYP-CDE              PIC  X(02)    VALUE SPACE.   01480049
014900     05  PV-AUD-STAT-CDE             PIC  X(02)    VALUE SPACE.   01490049
015000***                                                               01500091
015100     05  PV-PO-NBR                       PIC S9(09)  COMP         01510099
015200                                                   VALUE ZERO.    01520099
015300     05  PV-PO-NUMBER                    PIC  X(09)  VALUE SPACE. 01530099
015400     05  PV-PO-NUMBER-R REDEFINES PV-PO-NUMBER.                   01540099
015500         10  FILLER                      PIC  9(01).              01550099
015600         10  PV-PO-NUMBER-8POS           PIC  9(08).              01560099
015700***                                                               01570099
015800     05  PV-RCVR-SEQ-NBR                 PIC S9(09)  COMP         01580099
015900                                                   VALUE ZERO.    01590099
016000     05  PV-RCVR-NUMBER                  PIC  X(09)  VALUE SPACE. 01600099
016100     05  PV-RCVR-NUMBER-R REDEFINES PV-RCVR-NUMBER.               01610099
016200         10  FILLER                      PIC  9(06).              01620099
016300         10  PV-RCVR-NUMBER-3POS         PIC  9(03).              01630099
016400***                                                               01640099
016500     05  PV-PO-LNE-NBR                   PIC S9(09) COMP          01650099
016600                                                   VALUE ZERO.    01660099
016700***                                                               01670099
016800     05  PV-PO-PREPK-ID                  PIC S9(04) COMP          01680099
016900                                                   VALUE ZERO.    01690099
017000***                                                               01700099
017100     05  PV-PKGNG-TYP-CDE            PIC  X(02)    VALUE SPACE.   01710084
017200     05  PV-REQ-UNT-QTY              PIC  S9(9) COMP              01720099
017300                                                   VALUE ZERO.    01730049
017400     05  PV-AUD-UNT-QTY              PIC  S9(9) COMP              01740049
017500                                                   VALUE ZERO.    01750049
017600     05  PV-REQ-CART-QTY             PIC  S9(9) COMP              01760099
017700                                                   VALUE ZERO.    01770049
017800     05  PV-AUD-CART-QTY             PIC  S9(9) COMP              01780049
017900                                                   VALUE ZERO.    01790049
018000     05  PV-DFRD-AUD-IND             PIC  X(01)    VALUE SPACE.   01800036
018100     05  PV-AUD-USR-ID               PIC  X(08)    VALUE SPACE.   01810036
018200                                                                  01820036
018300     05  PV-MANUAL-AUDIT-CNT         PIC  9(06)    VALUE ZEROES.  01830099
018400     05  PV-SYSTEM-INPRC-CNT         PIC  9(06)    VALUE ZEROES.  01840099
018500     05  PV-SYSTEM-PROMP-CNT         PIC  9(06)    VALUE ZEROES.  01850099
018600     05  PV-TOTAL-AUDIT-CNT          PIC  9(06)    VALUE ZEROES.  01860099
018700                                                                  01870099
018800********************                                              01880029
018900     05  PV-TODAYS-DATE              PIC X(10)     VALUE SPACES.  01890099
019000     05  PV-TODAYS-DATE-R REDEFINES PV-TODAYS-DATE.               01900099
019100         10  PV-TODAYS-DATE-YY       PIC  9(04).                  01910099
019200         10  FILLER                  PIC  X(01).                  01920099
019300         10  PV-TODAYS-DATE-MM       PIC  9(02).                  01930099
019400         10  FILLER                  PIC  X(01).                  01940099
019500         10  PV-TODAYS-DATE-DD       PIC  9(02).                  01950099
019600                                                                  01960099
019700     05  PV-TODAYS-TIME              PIC  X(08)    VALUE SPACES.  01970099
019800     05  PV-TODAYS-TIME-R REDEFINES PV-TODAYS-TIME.               01980099
019900         10  PV-TODAYS-TIME-HH       PIC  9(02).                  01990099
020000         10  FILLER                  PIC  X(01).                  02000099
020100         10  PV-TODAYS-TIME-MM       PIC  9(02).                  02010099
020200         10  FILLER                  PIC  X(01).                  02020099
020300         10  PV-TODAYS-TIME-SS       PIC  9(02).                  02030099
020400                                                                  02040099
020500     05  PV-DB2-TMST.                                             02050099
020600         10 PV-DB2-TMST-CCYY          PIC  9(04).                 02060099
020700         10 FILLER                    PIC  X(01).                 02070099
020800         10 PV-DB2-TMST-MM            PIC  9(02).                 02080099
020900         10 FILLER                    PIC  X(01).                 02090099
021000         10 PV-DB2-TMST-DD            PIC  9(02).                 02100099
021100         10 FILLER                    PIC  X(01).                 02110099
021200         10 PV-DB2-TMST-HH            PIC  9(02).                 02120099
021300         10 FILLER                    PIC  X(01).                 02130099
021400         10 PV-DB2-TMST-MN            PIC  9(02).                 02140099
021500         10 FILLER                    PIC  X(01).                 02150099
021600         10 PV-DB2-TMST-SS            PIC  9(02).                 02160099
021700         10 FILLER                    PIC  X(07).                 02170099
021800     05  PV-DB2-DATE.                                             02180099
021900         10  PV-DB2-DATE-CCYY        PIC  X(04)    VALUE ZERO.    02190099
022000         10  PV-SLASH1               PIC  X(01)    VALUE '/'.     02200099
022100         10  PV-DB2-DATE-MM          PIC  X(02)    VALUE ZERO.    02210099
022200         10  PV-SLASH2               PIC  X(01)    VALUE '/'.     02220099
022300         10  PV-DB2-DATE-DD          PIC  X(02)    VALUE ZERO.    02230099
022400     05  PV-DB2-TIME.                                             02240059
022500         10 PV-DB2-TIME-HH           PIC  9(02)    VALUE ZERO.    02250059
022600         10 FILLER                   PIC  X(01)    VALUE SPACE.   02260059
022700         10 PV-DB2-TIME-MN           PIC  9(02)    VALUE ZERO.    02270059
022710     05  PV-DISPLAY-NUMBER-5         PIC  9(05)    VALUE ZERO.    02271099
022720     05  PV-DISPLAY-NUMBER-9         PIC  9(09)    VALUE ZERO.    02272099
022800  01  SAVE-FIELDS.                                                02280099
022900     05  SAVE-OPER-UNT-ID              PIC  9(03)    VALUE ZERO.  02290099
023000     05  SAVE-STRT-DATE                PIC  X(10)    VALUE SPACE. 02300099
023100     05  SAVE-STRT-DATE-R REDEFINES SAVE-STRT-DATE.               02310099
023200         10  SAVE-STRT-DATE-CCYY       PIC  X(04).                02320099
023300         10  FILLER                    PIC  X(01).                02330099
023400         10  SAVE-STRT-DATE-MM         PIC  X(02).                02340099
023500         10  FILLER                    PIC  X(01).                02350099
023600         10  SAVE-STRT-DATE-DD         PIC  X(02).                02360099
023700     05  SAVE-AUD-CNTL-NBR             PIC  S9(09) COMP.          02370099
023800*                                                                 02380027
023900******************************************************************02390027
024000* COPY BOOK WITH PRINTEK/CODE V PRINTER CODES                     02400027
024100******************************************************************02410027
024200     COPY DSWS004.                                                02420027
024300                                                                  02430027
024310******************************************************************02431099
024320* TEMP ASSOC INFO  - CALLED MODULE PARAMETERS                     02432099
024330******************************************************************02433099
024340     COPY XLWS067.                                                02434099
024350                                                                  02435099
024360******************************************************************02436099
024370* LOCATION MASTER INFORMATION - CALLED MODULE PARAMETERS          02437099
024380******************************************************************02438099
024390     COPY XLWS071.                                                02439099
024391                                                                  02439199
024400******************************************************************02440027
024500*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02450027
024600******************************************************************02460027
024700     COPY DPWS132.                                                02470099
024800*                                                                 02480027
024900*                                                                 02490027
025000 01  HEADING-LINES.                                               02500027
025100     05  HEADING-LINE-0.                                          02510027
025200         10  FILLER                  PIC  X(48)    VALUE SPACE.   02520099
025300         10  FILLER                  PIC  X(37)    VALUE          02530027
025400             'DAILY OPERATIONAL AUDIT STATUS REPORT'.             02540027
025500         10  FILLER                  PIC  X(47)    VALUE SPACE.   02550099
025600                                                                  02560067
025700     05  HEADING-LINE-1.                                          02570027
025800         10  FILLER                  PIC  X(50)    VALUE SPACE.   02580099
025900         10  FILLER                  PIC  X(33)    VALUE          02590027
026000             'AUDITS OPEN GREATER THAN 24 HOURS'.                 02600027
026100         10  FILLER                  PIC  X(49)    VALUE SPACE.   02610099
026200                                                                  02620058
026300     05  HEADING-LINE-2.                                          02630027
026400         10  FILLER                  PIC  X(03)    VALUE SPACE.   02640027
026500         10  FILLER                  PIC  X(11)    VALUE          02650099
026600             'FACILITY - '.                                       02660099
026700         10  HL2-FACILITY            PIC  X(04)    VALUE SPACE.   02670062
026800         10  FILLER                  PIC  X(03)    VALUE ' - '.   02680027
026900         10  HL2-FACILITY-DESC       PIC  X(25)    VALUE SPACE.   02690027
027000         10  FILLER                  PIC  X(86)    VALUE SPACE.   02700099
027100                                                                  02710027
027200     05  HEADING-LINE-3.                                          02720027
027300         10  FILLER                  PIC  X(03)    VALUE SPACE.   02730027
027400         10  FILLER                  PIC  X(17)    VALUE          02740027
027500             '-- REQ/STARTED --'.                                 02750027
027600         10  FILLER                  PIC  X(02)    VALUE SPACE.   02760099
027700         10  FILLER                  PIC  X(12)    VALUE          02770027
027800             'AUDIT NUMBER'.                                      02780027
027900         10  FILLER                  PIC  X(02)    VALUE SPACE.   02790099
028000         10  FILLER                  PIC  X(05)    VALUE          02800027
028100             'AUDIT'.                                             02810027
028200         10  FILLER                  PIC  X(03)    VALUE SPACE.   02820099
028300         10  FILLER                  PIC  X(07)    VALUE          02830027
028400             'PROCESS'.                                           02840027
028500         10  FILLER                  PIC  X(03)    VALUE SPACE.   02850099
028600         10  FILLER                  PIC  X(03)    VALUE          02860027
028700             'SRC'.                                               02870027
028800         10  FILLER                  PIC  X(02)    VALUE SPACE.   02880099
028900         10  FILLER                  PIC  X(11)    VALUE          02890027
029000             'PO-RECEIVER'.                                       02900027
029100         10  FILLER                  PIC  X(02)    VALUE SPACE.   02910099
029200         10  FILLER                  PIC  X(04)    VALUE          02920027
029300             'LINE'.                                              02930027
029400         10  FILLER                  PIC  X(02)    VALUE SPACE.   02940099
029500         10  FILLER                  PIC  X(04)    VALUE          02950027
029600             'PACK'.                                              02960027
029700         10  FILLER                  PIC  X(03)    VALUE SPACE.   02970099
029800         10  FILLER                  PIC  X(03)    VALUE          02980078
029900             'PKG'.                                               02990078
030000         10  FILLER                  PIC  X(03)    VALUE SPACE.   03000099
030100         10  FILLER                  PIC  X(07)    VALUE          03010078
030200             'PERCENT'.                                           03020078
030300         10  FILLER                  PIC  X(01)    VALUE SPACE.   03030099
030400         10  FILLER                  PIC  X(05)    VALUE          03040027
030500             'DEFER'.                                             03050027
030600         10  FILLER                  PIC  X(09)    VALUE SPACE.   03060099
030700         10  FILLER                  PIC  X(10)    VALUE          03070099
030800             'ASSOCIATE/'.                                        03080099
030900         10  FILLER                  PIC  X(08)    VALUE SPACE.   03090099
031000                                                                  03100027
031100     05  HEADING-LINE-4.                                          03110027
031200         10  FILLER                  PIC  X(06)    VALUE SPACE.   03120027
031300         10  FILLER                  PIC  X(04)    VALUE          03130027
031400             'DATE'.                                              03140027
031500         10  FILLER                  PIC  X(06)    VALUE SPACE.   03150027
031600         10  FILLER                  PIC  X(04)    VALUE          03160027
031700             'TIME'.                                              03170027
031800         10  FILLER                  PIC  X(16)    VALUE SPACE.   03180099
031900         10  FILLER                  PIC  X(04)    VALUE          03190027
032000             'TYPE'.                                              03200027
032100         10  FILLER                  PIC  X(04)    VALUE SPACE.   03210099
032200         10  FILLER                  PIC  X(06)    VALUE          03220027
032300             'STATUS'.                                            03230027
032400         10  FILLER                  PIC  X(11)    VALUE SPACE.   03240099
032500         10  FILLER                  PIC  X(06)    VALUE          03250027
032600             'NUMBER'.                                            03260027
032700         10  FILLER                  PIC  X(06)    VALUE SPACE.   03270099
032800         10  FILLER                  PIC  X(03)    VALUE          03280027
032900             'NBR'.                                               03290027
033000         10  FILLER                  PIC  X(03)    VALUE SPACE.   03300099
033100         10  FILLER                  PIC  X(02)    VALUE          03310027
033200             'ID'.                                                03320027
033300         10  FILLER                  PIC  X(04)    VALUE SPACE.   03330099
033400         10  FILLER                  PIC  X(03)    VALUE          03340078
033500             'TYP'.                                               03350078
033600         10  FILLER                  PIC  X(02)    VALUE SPACE.   03360099
033700         10  FILLER                  PIC  X(08)    VALUE          03370078
033800             'COMPLETE'.                                          03380078
033900         10  FILLER                  PIC  X(02)    VALUE SPACE.   03390099
034000         10  FILLER                  PIC  X(03)    VALUE          03400027
034100             'IND'.                                               03410027
034200         10  FILLER                  PIC  X(14)    VALUE SPACE.   03420099
034300         10  FILLER                  PIC  X(02)    VALUE          03430027
034400             'ID'.                                                03440027
034500         10  FILLER                  PIC  X(13)    VALUE SPACE.   03450099
034600*                                                                 03460027
034700 01  MISCELLANEOUS-LINES.                                         03470027
034800     05  END-OF-REPORT-LINE.                                      03480027
034900         10  FILLER                  PIC  X(02)    VALUE SPACE.   03490027
035000         10  FILLER                  PIC  X(19)    VALUE          03500027
035100             '** END OF REPORT **'.                               03510027
035200         10  FILLER                  PIC  X(112)   VALUE SPACE.   03520027
035300*                                                                 03530027
035400 01  ER-EMPTY-REPORT-LINE.                                        03540027
035500     05  FILLER                      PIC  X(02)  VALUE SPACE.     03550027
035600     05  FILLER                      PIC  X(19)  VALUE            03560027
035700         '**   NO DATA     **'.                                   03570027
035800     05  FILLER                      PIC  X(112) VALUE SPACE.     03580027
035900*                                                                 03590027
036000 01  DETAIL-LINES.                                                03600027
036100     05  DETAIL-LINE1.                                            03610027
036200         10  FILLER                  PIC  X(03)    VALUE SPACE.   03620027
036300         10  DL1-AUD-STRT-DATE.                                   03630037
036400             15  DL1-AUD-STRT-DATE-MM                             03640037
036500                                     PIC  X(02)    VALUE SPACE.   03650027
036600             15  DL1-SLASH1          PIC  X(01)    VALUE '/'.     03660099
036700             15  DL1-AUD-STRT-DATE-DD                             03670037
036800                                     PIC  X(02)    VALUE SPACE.   03680027
036900             15  DL1-SLASH2          PIC  X(01)    VALUE '/'.     03690099
037000             15  DL1-AUD-STRT-DATE-CCYY                           03700037
037100                                     PIC  X(04)    VALUE SPACE.   03710027
037200         10  FILLER                  PIC  X(01)    VALUE SPACE.   03720099
037300         10  DL1-AUD-STRT-TIME.                                   03730037
037400             15  DL1-AUD-STRT-TIME-HH                             03740037
037500                                     PIC  X(02)    VALUE SPACE.   03750027
037600             15  FILLER              PIC  X(01)    VALUE ':'.     03760027
037700             15  DL1-AUD-STRT-TIME-MN                             03770037
037800                                     PIC  X(02)    VALUE SPACE.   03780027
037900         10  FILLER                  PIC  X(02)    VALUE SPACE.   03790099
038000         10  DL1-AUD-CNTL-NBR        PIC  Z(12)    VALUE ZEROES.  03800099
038100         10  FILLER                  PIC  X(02)    VALUE SPACE.   03810099
038200         10  DL1-AUD-TYP-CDE         PIC  X(06)    VALUE SPACE.   03820037
038300         10  FILLER                  PIC  X(01)    VALUE SPACE.   03830099
038400         10  DL1-AUD-STAT-CDE        PIC  X(10)    VALUE SPACE.   03840099
038500         10  FILLER                  PIC  X(01)    VALUE SPACE.   03850099
038600         10  DL1-SOURCE-CDE          PIC  X(03)    VALUE SPACE.   03860040
038700         10  FILLER                  PIC  X(01)    VALUE SPACE.   03870099
038800         10  DL1-PO-RCVR-NBR.                                     03880099
038900             15  DL1-PO-NBR          PIC  Z(09)    VALUE SPACE.   03890099
039000             15  DL1-PO-RCVR-DASH    PIC  X(01)    VALUE '-'.     03900099
039100             15  DL1-RCVR-SEQ-NBR    PIC  X(03)    VALUE SPACE.   03910099
039200         10  FILLER                  PIC  X(01)    VALUE SPACE.   03920099
039300         10  DL1-PO-LNE-NBR          PIC  Z(05)    VALUE ZEROES.  03930099
039400         10  FILLER                  PIC  X(01)    VALUE SPACE.   03940099
039500         10  DL1-PO-PREPK-ID         PIC  Z(05)    VALUE ZEROES.  03950099
039600         10  FILLER                  PIC  X(01)    VALUE SPACE.   03960099
039700         10  DL1-PKG-TYP             PIC  X(07)    VALUE SPACE.   03970080
039800         10  FILLER                  PIC  X(01)    VALUE SPACE.   03980099
039900         10  DL1-PRCT-COMPLETE.                                   03990058
040000             15  DL1-FIRST-THREE     PIC  X(03)    VALUE SPACE.   04000027
040100             15  FILLER              PIC  X(01)    VALUE '.'.     04010027
040200             15  DL1-LAST-TWO        PIC  X(02)    VALUE SPACE.   04020027
040300         10  FILLER                  PIC  X(03)    VALUE SPACE.   04030099
040400         10  DL1-DFRD-AUD-IND        PIC  X(01)    VALUE SPACE.   04040037
040500         10  FILLER                  PIC  X(02)    VALUE SPACE.   04050081
040600         10  DL1-AUD-USR-ID          PIC  X(28)    VALUE SPACE.   04060099
040800*                                                                 04080099
040900*                                                                 04090099
041000 01  TOTAL-LINES.                                                 04100099
041100     05  TOTAL-LINE1.                                             04110099
041200         10  FILLER                  PIC  X(03)    VALUE SPACE.   04120099
041300         10  FILLER                  PIC  X(34)    VALUE          04130099
041400                          'OPEN MANUAL AUDITS  . . . . . . : '.   04140099
041500         10  TL1-MAN-AUDIT-CNT       PIC  Z(06)    VALUE ZEROES.  04150099
041600         10  FILLER                  PIC  X(92)    VALUE SPACES.  04160099
041700*                                                                 04170099
041800     05  TOTAL-LINE2.                                             04180099
041900         10  FILLER                  PIC  X(03)    VALUE SPACE.   04190099
042000         10  FILLER                  PIC  X(34)    VALUE          04200099
042100                          'SYSTEM PROMPTED (NOT STARTED) . : '.   04210099
042200         10  TL2-SYS-PROMP-CNT       PIC  Z(06)    VALUE ZEROES.  04220099
042300         10  FILLER                  PIC  X(92)    VALUE SPACES.  04230099
042400*                                                                 04240099
042500     05  TOTAL-LINE3.                                             04250099
042600         10  FILLER                  PIC  X(03)    VALUE SPACE.   04260099
042700         10  FILLER                  PIC  X(34)    VALUE          04270099
042800                          'SYSTEM PROMPTED (IN PROC/POSTPN): '.   04280099
042900         10  TL3-SYS-INPRC-CNT       PIC  Z(06)    VALUE ZEROES.  04290099
043000         10  FILLER                  PIC  X(92)    VALUE SPACES.  04300099
043100*                                                                 04310099
043200     05  TOTAL-LINE4.                                             04320099
043300         10  FILLER                  PIC  X(03)    VALUE SPACE.   04330099
043400         10  FILLER                  PIC  X(34)    VALUE          04340099
043500                          'TOTAL OPEN AUDITS . . . . . . . : '.   04350099
043600         10  TL4-TOT-AUDIT-CNT       PIC  Z(06)    VALUE ZEROES.  04360099
043700         10  FILLER                  PIC  X(92)    VALUE SPACES.  04370099
043800*                                                                 04380099
043900*                                                                 04390099
044000*  COPY BOOK FOR THE SHIPPING UNIT AUDIT TABLE                    04400027
044100     EXEC SQL                                                     04410027
044200          INCLUDE TSUNAUD                                         04420027
044300     END-EXEC.                                                    04430027
044400                                                                  04440027
044500*  COPY BOOK FOR THE PURCHASE ORDER AUDIT REQUEST TABLE           04450027
044600*  (SUT_PO_AUD_REQ)                                               04460027
044700     EXEC SQL                                                     04470027
044800          INCLUDE SUT00015                                        04480027
044900     END-EXEC.                                                    04490027
045000                                                                  04500027
045100*  COPY BOOK FOR RC-KOHLS TO RETEK PROCESSING PARAMETERS TABLE    04510044
045200     EXEC SQL                                                     04520027
045300          INCLUDE TKRPRPM                                         04530044
045400     END-EXEC.                                                    04540027
045500                                                                  04550027
045600*  COPY BOOK FOR RECEIVER TABLE                                   04560027
045700     EXEC SQL                                                     04570027
045800          INCLUDE TRECEIV                                         04580027
045900     END-EXEC.                                                    04590027
046000                                                                  04600027
046600*  DB2 COMMUNICATION AREA                                         04660027
046700     EXEC SQL                                                     04670027
046800         INCLUDE SQLCA                                            04680027
046900     END-EXEC.                                                    04690027
047000                                                                  04700027
047100*  DB2 COMMUNICATION AREA2                                        04710027
047200     COPY SQLCA2.                                                 04720027
047300                                                                  04730027
047400*CURSOR                                                           04740027
047500     EXEC SQL                                                     04750027
047600         DECLARE AUDIT-CSR CURSOR FOR                             04760027
047700                                                                  04770027
047800     SELECT 'MAN'                                                 04780051
047900          , A.OPER_UNT_ID                                         04790051
048000          , DATE(A.AUD_STRT_TMST)                                 04800053
048100          , TIME(A.AUD_STRT_TMST)                                 04810053
048200          , A.AUD_CNTL_NBR                                        04820027
048300          , CASE                                                  04830027
048400                WHEN A.AUD_TYP_CDE = '01' THEN '100%  '           04840027
048500                WHEN A.AUD_TYP_CDE = '02' THEN 'SPOT  '           04850027
048600                WHEN A.AUD_TYP_CDE = '03' THEN 'REWORK'           04860027
048700                ELSE '      '                                     04870027
048800            END                                                   04880027
048900          , CASE                                                  04890027
049000                WHEN A.AUD_STAT_CDE = 'IP' THEN 'IN PROCESS'      04900099
049100                WHEN A.AUD_STAT_CDE = 'CM' THEN 'COMPLETE  '      04910099
049200                WHEN A.AUD_STAT_CDE = 'PP' THEN 'POSTPONED '      04920099
049300                ELSE '        '                                   04930027
049400            END                                                   04940027
049500          , 0                                                     04950027
049600          , 0                                                     04960027
049700          , 0                                                     04970027
049800          , 0                                                     04980027
049900          , 0                                                     04990027
050000          , 0                                                     05000027
050100          , 0                                                     05010027
050200          , 0                                                     05020027
050300          , ' '                                                   05030027
050400          , ' '                                                   05040099
050500          , ' '                                                   05050076
050600          , A.AUD_USR_ID                                          05060076
050700     FROM TSUNAUD A                                               05070076
050800     WHERE A.AUD_STP_TMST   =  '9999-09-09-09.09.09.999999'       05080076
050900       AND A.AUD_STRT_TMST <>  '9999-09-09-09.09.09.999999'       05090076
051000       AND A.AUD_STRT_TMST <=                                     05100076
051100                  (CURRENT TIMESTAMP  - :PV-AUDIT-AGE-HOURS HOURS)05110099
051200       AND A.AUD_CAT_CDE    =  'C'                                05120076
051300       AND A.AUD_STAT_CDE  <>  'CM'                               05130099
051400       AND A.AUD_CNTL_NBR NOT IN(                                 05140076
051500                        SELECT DISTINCT (B.AUD_CNTL_NBR)          05150076
051600                          FROM SUT_PO_AUD_REQ B)                  05160076
051700     UNION                                                        05170076
051800     SELECT 'SYS'                                                 05180076
051900          , C.OPER_UNT_ID                                         05190076
052000          , DATE(C.CRE_TMST)                                      05200076
052100          , TIME(C.CRE_TMST)                                      05210076
052200          , C.AUD_CNTL_NBR                                        05220076
052300          , CASE                                                  05230099
052400               WHEN D.AUD_TYP_CDE = '01' THEN '100%  '            05240076
052500               WHEN D.AUD_TYP_CDE = '02' THEN 'SPOT  '            05250076
052600               WHEN D.AUD_TYP_CDE = '03' THEN 'REWORK'            05260076
052700               ELSE '      '                                      05270076
052800            END                                                   05280076
052900          , 'PROMPTED  '                                          05290099
053000          , C.PO_NBR                                              05300076
053100          , C.RCVR_SEQ_NBR                                        05310076
053200          , C.PO_LNE_NBR                                          05320076
053300          , C.PO_PREPK_ID                                         05330076
053400          , C.UNT_QTY                                             05340076
053500          , 0                                                     05350076
053600          , C.CART_QTY                                            05360076
053700          , 0                                                     05370076
053800          , C.DFRD_AUD_IND                                        05380076
053900          , C.PKGNG_TYP_CDE                                       05390077
054000          , CASE                                                  05400099
054100               WHEN C.PKGNG_TYP_CDE = 'BC' THEN 'BLK/CSE'         05410099
054200               WHEN C.PKGNG_TYP_CDE = 'PP' THEN 'PREPACK'         05420099
054300               WHEN C.PKGNG_TYP_CDE = 'PS' THEN 'PBS    '         05430099
054300               WHEN C.PKGNG_TYP_CDE = 'RF' THEN 'RFID   '         05431099
054400               ELSE '      '                                      05440099
054500            END                                                   05450099
054600          , D.AUD_USR_ID                                          05460076
054700     FROM SUT_PO_AUD_REQ C                                        05470076
054800         ,TSUNAUD D                                               05480076
054900     WHERE C.CRE_TMST      <=                                     05490076
055000                 (CURRENT TIMESTAMP - :PV-AUDIT-AGE-HOURS HOURS)  05500076
055100       AND C.AUD_STAT_CDE  NOT IN ('P','F','N')                   05510099
055110       AND C.AUD_CNTL_NBR   =  D.AUD_CNTL_NBR                     05511099
055200       AND D.AUD_STRT_TMST  =  '9999-09-09-09.09.09.999999'       05520076
055300       AND D.AUD_STP_TMST   =  '9999-09-09-09.09.09.999999'       05530076
055400       AND D.AUD_CAT_CDE    =  'C'                                05540076
055500     UNION                                                        05550076
055600     SELECT 'SYS'                                                 05560076
055700          , E.OPER_UNT_ID                                         05570076
055800          , DATE(F.AUD_STRT_TMST)                                 05580076
055900          , TIME(F.AUD_STRT_TMST)                                 05590076
056000          , E.AUD_CNTL_NBR                                        05600076
056100         , CASE                                                   05610076
056200               WHEN F.AUD_TYP_CDE = '01' THEN '100%  '            05620076
056300               WHEN F.AUD_TYP_CDE = '02' THEN 'SPOT  '            05630076
056400               WHEN F.AUD_TYP_CDE = '03' THEN 'REWORK'            05640076
056500               ELSE '      '                                      05650076
056600            END                                                   05660076
056700          , CASE                                                  05670076
056800                WHEN F.AUD_STAT_CDE = 'IP' THEN 'IN PROCESS'      05680099
056900                WHEN F.AUD_STAT_CDE = 'CM' THEN 'COMPLETE  '      05690099
057000                WHEN F.AUD_STAT_CDE = 'PP' THEN 'POSTPONED '      05700099
057100                ELSE '        '                                   05710076
057200            END                                                   05720076
057300          , E.PO_NBR                                              05730076
057400          , E.RCVR_SEQ_NBR                                        05740076
057500          , E.PO_LNE_NBR                                          05750076
057600          , E.PO_PREPK_ID                                         05760076
057700          , E.UNT_QTY                                             05770076
057800          , E.AUD_UNT_QTY                                         05780076
057900          , E.CART_QTY                                            05790076
058000          , E.AUD_CART_QTY                                        05800076
058100          , E.DFRD_AUD_IND                                        05810076
058200          , E.PKGNG_TYP_CDE                                       05820077
058300          , CASE                                                  05830099
058400               WHEN E.PKGNG_TYP_CDE = 'BC' THEN 'BLK/CSE'         05840099
058500               WHEN E.PKGNG_TYP_CDE = 'PP' THEN 'PREPACK'         05850099
058600               WHEN E.PKGNG_TYP_CDE = 'PS' THEN 'PBS    '         05860099
058600               WHEN E.PKGNG_TYP_CDE = 'RF' THEN 'RFID   '         05861099
058700               ELSE '      '                                      05870099
058800            END                                                   05880099
058900          , F.AUD_USR_ID                                          05890076
059000     FROM SUT_PO_AUD_REQ E                                        05900076
059100         ,TSUNAUD F                                               05910076
059200     WHERE F.AUD_STRT_TMST  <=                                    05920099
059300                   (CURRENT TIMESTAMP - :PV-AUDIT-AGE-HOURS HOURS)05930076
059400       AND E.AUD_CNTL_NBR   =  F.AUD_CNTL_NBR                     05940076
059410       AND E.AUD_STAT_CDE  NOT IN ('P','F','N')                   05941099
059500       AND F.AUD_STRT_TMST <>  '9999-09-09-09.09.09.999999'       05950076
059600       AND F.AUD_STP_TMST   =  '9999-09-09-09.09.09.999999'       05960076
059700       AND F.AUD_CAT_CDE    =  'C'                                05970076
059800     ORDER BY 2,3,4                                               05980076
059900     END-EXEC.                                                    05990076
060000*                                                                 06000076
060100*                                                                 06010076
060200 PROCEDURE DIVISION.                                              06020076
060300*                                                                 06030076
060400*THIS IS THE MAIN DRIVER FOR THE PROGRAM.                         06040099
060500 0000-MAINLINE-PROCESSING.                                        06050076
060600     OPEN OUTPUT SU-CARTON-AUDIT-RPT-FILE.                        06060076
060700                                                                  06070076
060800     PERFORM 1000-INITIALIZATION.                                 06080076
060900                                                                  06090076
061000     IF PS-EOF-AUDIT-CSR-YES AND                                  06100099
061100        PS-FIRST-TIME-YES                                         06110099
061200         WRITE SU-CARTON-AUDIT-RPT-RECORD                         06120076
061300         FROM  ER-EMPTY-REPORT-LINE                               06130076
061400             AFTER ADVANCING 2 LINES                              06140076
061500     ELSE                                                         06150076
061600         IF PS-FIRST-TIME-YES                                     06160099
061700            PERFORM 8400-WRITE-DETAIL-LINES                       06170099
061800         ELSE                                                     06180099
061900            SET PS-FIRST-TIME-NO TO TRUE                          06190099
062000         END-IF                                                   06200099
062100                                                                  06210099
062200         PERFORM 2000-PROCESS-SU                                  06220099
062300             UNTIL PS-EOF-AUDIT-CSR-YES                           06230099
062400     END-IF.                                                      06240076
062500                                                                  06250076
062510     PERFORM 8500-WRITE-DC-TOTALS                                 06251099
062520                                                                  06252099
062600     WRITE SU-CARTON-AUDIT-RPT-RECORD                             06260099
062700      FROM END-OF-REPORT-LINE                                     06270099
062800     AFTER ADVANCING 2 LINES.                                     06280099
062900                                                                  06290076
063000     CLOSE SU-CARTON-AUDIT-RPT-FILE.                              06300076
063100                                                                  06310076
063200     GOBACK.                                                      06320076
063300*                                                                 06330076
063400*                                                                 06340076
063500* PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.                 06350099
063600 1000-INITIALIZATION.                                             06360076
063700     PERFORM 3000-SELECT-TKRPRPM.                                 06370099
063800                                                                  06380099
063900     MOVE PC-REPORT-NBR      TO DP132-REPORT-NUMBER.              06390099
064000     MOVE PV-TODAYS-DATE-MM  TO DP132-RUN-MONTH.                  06400099
064100     MOVE PV-TODAYS-DATE-DD  TO DP132-RUN-DAY.                    06410099
064200     MOVE PV-TODAYS-DATE-YY  TO DP132-RUN-YEAR.                   06420099
064300                                                                  06430076
064400     MOVE PV-TODAYS-TIME-HH  TO DP132-RUN-HOUR.                   06440099
064500     MOVE PV-TODAYS-TIME-MM  TO DP132-RUN-MINUTE.                 06450099
064600     MOVE PC-SUKRP029        TO DP132-PROGRAM-NAME.               06460099
064700                                                                  06470076
064800     PERFORM 7000-OPEN-AUDIT-CURSOR                               06480076
064900     PERFORM 7010-FETCH-AUDIT-CURSOR                              06490076
065000     SET PS-FIRST-TIME-YES TO TRUE                                06500099
065100                                                                  06510099
065200     IF PS-EOF-AUDIT-CSR-YES                                      06520076
065300        PERFORM 7020-CLOSE-AUDIT-CSR                              06530076
065400     ELSE                                                         06540076
065500        MOVE PV-OPER-UNT-ID     TO SAVE-OPER-UNT-ID               06550099
065600                                                                  06560076
065700        MOVE +0               TO PV-PAGE-CNT                      06570076
065800        PERFORM 1300-SELECT-LOCATION-NAME                         06580099
065900                                                                  06590076
066000        MOVE PV-OPER-UNT-ID       TO HL2-FACILITY                 06600076
066101                                                                  06610199
066110        ADD 1 TO PV-TOTAL-AUDIT-CNT                               06611099
066120        IF PV-SRC-MANUAL                                          06612099
066130            ADD 1 TO PV-MANUAL-AUDIT-CNT                          06613099
066140        ELSE                                                      06614099
066150        IF PV-AUDIT-STATUS = 'PROMPTED'                           06615099
066160            ADD 1 TO PV-SYSTEM-PROMP-CNT                          06616099
066170        ELSE                                                      06617099
066180            ADD 1 TO PV-SYSTEM-INPRC-CNT                          06618099
066190        END-IF                                                    06619099
066200     END-IF.                                                      06620076
066300                                                                  06630076
066400     PERFORM 8000-WRITE-REPORT-HEADERS.                           06640076
066500*                                                                 06650076
066600*                                                                 06660076
066700 1200-CALC-PERCENT-COMPLETE.                                      06670099
066800     EVALUATE PV-PKGNG-TYP-CDE                                    06680085
066900       WHEN 'BC'                                                  06690086
067000       WHEN 'PP'                                                  06700099
             WHEN 'RF'                                                  06701099
067100          IF PV-AUD-UNT-QTY > 0 AND                               06710088
067200             PV-REQ-UNT-QTY > 0                                   06720099
067300             DIVIDE PV-AUD-UNT-QTY     BY PV-REQ-UNT-QTY          06730099
067400                 GIVING PV-DIVIDEND ROUNDED                       06740099
067500             MULTIPLY PV-DIVIDEND BY 100                          06750099
067600                 GIVING PV-PRCT-UNITS-COMPLETE                    06760099
067700          ELSE                                                    06770099
067800             MOVE ZEROES  TO  PV-DIVIDEND                         06780099
067900                              PV-PRCT-UNITS-COMPLETE              06790099
068000          END-IF                                                  06800088
068100                                                                  06810099
068200       WHEN 'PS'                                                  06820085
068300          IF PV-AUD-CART-QTY > 0 AND                              06830088
068400             PV-REQ-CART-QTY > 0                                  06840099
068500             DIVIDE PV-AUD-CART-QTY    BY PV-REQ-CART-QTY         06850099
068600                 GIVING PV-DIVIDEND ROUNDED                       06860099
068700             MULTIPLY PV-DIVIDEND BY 100                          06870099
068800                 GIVING PV-PRCT-CARTS-COMPLETE                    06880099
068900          ELSE                                                    06890088
069000             MOVE ZEROES  TO  PV-DIVIDEND                         06900099
069100                              PV-PRCT-CARTS-COMPLETE              06910099
069200          END-IF                                                  06920088
069300                                                                  06930099
069400       WHEN '  '                                                  06940088
069500          CONTINUE                                                06950088
069600     END-EVALUATE.                                                06960083
069700*                                                                 06970076
069800*                                                                 06980076
069900*SELECT THE FACILITY NAME TO DISPLAY IN THE HEADING OF THE        06990099
070000*REPORT.                                                          07000099
070100 1300-SELECT-LOCATION-NAME.                                       07010099
070110                                                                  07011099
070120     INITIALIZE XL071-COMMAREA-REC.                               07012099
070130     MOVE PV-OPER-UNT-ID     TO XL071-LOCATION-NUMBER.            07013099
070140     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         07014099
070150                                                                  07015099
070160     EVALUATE TRUE                                                07016099
070170         WHEN XL071-NO-ERRORS                                     07017099
070180             MOVE XL071-LOC-NM        TO HL2-FACILITY-DESC        07018099
070190         WHEN XL071-LOC-NOT-FOUND                                 07019099
070191             MOVE 'UNKNOWN LOCATION'  TO HL2-FACILITY-DESC        07019199
070192             MOVE PV-OPER-UNT-ID      TO PV-DISPLAY-NUMBER-5      07019299
070193             DISPLAY '* * * * * * * * * * * * * * * * * * * * *'  07019399
070194             DISPLAY '*** SQLCODE +100, CALL XLKUT071  '          07019499
070195             DISPLAY '*** LOCATION NUMBER :' PV-DISPLAY-NUMBER-5  07019599
070196             DISPLAY '* * * * * * * * * * * * * * * * * * * * *'  07019699
070197         WHEN XL071-BAD-DB2-RETURN                                07019799
070198             MOVE '1300-SELECT-LOCATION-NAME' TO                  07019899
070199                  PV-ABEND-PARAGRAPH                              07019999
070202             PERFORM 9220-XLKUT071-ERROR                          07020299
070203     END-EVALUATE.                                                07020399
072300*                                                                 07230076
072400*                                                                 07240076
072500 1500-GET-PO-INFO.                                                07250076
072600     IF PV-PO-NBR > ZEROS                                         07260093
072700        MOVE PV-PO-NUMBER-8POS     TO DL1-PO-NBR                  07270099
072800        MOVE '-'                   TO DL1-PO-RCVR-DASH            07280099
072900        MOVE PV-RCVR-NUMBER-3POS   TO DL1-RCVR-SEQ-NBR            07290099
073000     ELSE                                                         07300090
073100        MOVE SPACES                TO DL1-PO-RCVR-NBR             07310099
073200        MOVE SPACE                 TO DL1-PO-RCVR-DASH            07320099
073300        MOVE SPACES                TO DL1-PRCT-COMPLETE           07330099
073400     END-IF.                                                      07340096
073500                                                                  07350099
073600     EVALUATE  PV-PKGNG-TYP-CDE                                   07360099
073700         WHEN  'BC'                                               07370099
073800         WHEN  'PS'                                               07380099
               WHEN  'RF'                                               07381099
073900               MOVE PV-PO-LNE-NBR  TO DL1-PO-LNE-NBR              07390099
074000               MOVE ZEROES         TO DL1-PO-PREPK-ID             07400099
074100         WHEN  'PP'                                               07410099
074200               MOVE ZEROES         TO DL1-PO-LNE-NBR              07420099
074300               MOVE PV-PO-PREPK-ID TO DL1-PO-PREPK-ID             07430099
074400     END-EVALUATE.                                                07440099
074500*                                                                 07450091
074600*                                                                 07460091
074700*THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE        07470099
074800*  DAILY OPERATIONAL AUDIT STATUS REPORT.                         07480099
074900 2000-PROCESS-SU.                                                 07490091
075000     PERFORM 7010-FETCH-AUDIT-CURSOR                              07500099
075100     IF  PV-OPER-UNT-ID   =  SAVE-OPER-UNT-ID                     07510099
075200         IF PV-STRT-DATE  =  SAVE-STRT-DATE                       07520099
075300                 MOVE SPACES TO DL1-AUD-STRT-DATE                 07530099
075400                 IF PV-AUD-CNTL-NBR = SAVE-AUD-CNTL-NBR           07540099
075500                    CONTINUE                                      07550099
075600                 ELSE                                             07560099
075700                    PERFORM 8400-WRITE-DETAIL-LINES               07570099
075800                 END-IF                                           07580099
075900                 MOVE ZEROS TO PV-PRCT-UNITS-COMPLETE             07590099
076000                 MOVE ZEROS TO PV-PRCT-CARTS-COMPLETE             07600099
076100         ELSE                                                     07610099
076200                 WRITE SU-CARTON-AUDIT-RPT-RECORD                 07620099
076300                    FROM PC-BLANK-LINE                            07630099
076400                 ADD +1       TO PV-LINE-CNT                      07640099
076500                 IF  PV-LINE-CNT > PC-MAX-REPORT-LINES            07650099
076600                     WRITE SU-CARTON-AUDIT-RPT-RECORD             07660099
076700                      FROM PC-BLANK-LINE                          07670099
076800                           AFTER ADVANCING 1 LINES                07680099
076900                     PERFORM 8000-WRITE-REPORT-HEADERS            07690099
077000                     INITIALIZE  SAVE-STRT-DATE                   07700099
077100                     INITIALIZE  SAVE-AUD-CNTL-NBR                07710099
077200                 END-IF                                           07720099
077300                                                                  07730099
077400                 PERFORM 8400-WRITE-DETAIL-LINES                  07740099
077500                 MOVE PV-STRT-DATE TO SAVE-STRT-DATE              07750099
077600                 MOVE PV-AUD-CNTL-NBR TO SAVE-AUD-CNTL-NBR        07760099
077700         END-IF                                                   07770099
077800                                                                  07780099
077900         INITIALIZE                                               07790099
078000            DL1-AUD-CNTL-NBR                                      07800099
078100            DL1-AUD-TYP-CDE                                       07810099
078200            DL1-AUD-STAT-CDE                                      07820099
078300                                                                  07830099
078400     ELSE                                                         07840099
078500                                                                  07850099
078600            PERFORM 8500-WRITE-DC-TOTALS                          07860099
078700                                                                  07870099
078800            MOVE PV-OPER-UNT-ID TO SAVE-OPER-UNT-ID               07880099
078900            MOVE +0               TO PV-PAGE-CNT                  07890091
079000            PERFORM 1300-SELECT-LOCATION-NAME                     07900099
079100                                                                  07910091
079200            MOVE PV-OPER-UNT-ID       TO HL2-FACILITY             07920091
079400                                                                  07940099
079500            PERFORM 8000-WRITE-REPORT-HEADERS                     07950091
079600            INITIALIZE  SAVE-STRT-DATE                            07960099
079700            INITIALIZE  SAVE-AUD-CNTL-NBR                         07970099
079800            PERFORM 8400-WRITE-DETAIL-LINES                       07980099
079900     END-IF.                                                      07990091
080000                                                                  08000099
080100     ADD  1  TO  PV-TOTAL-AUDIT-CNT.                              08010099
080200     IF  PV-SRC-MANUAL                                            08020099
080300         ADD  1  TO  PV-MANUAL-AUDIT-CNT                          08030099
080400     ELSE                                                         08040099
080500     IF  PV-AUDIT-STATUS  =  'PROMPTED'                           08050099
080600         ADD  1  TO  PV-SYSTEM-PROMP-CNT                          08060099
080700     ELSE                                                         08070099
080800         ADD  1  TO  PV-SYSTEM-INPRC-CNT                          08080099
080900     END-IF.                                                      08090099
081000*                                                                 08100091
081100*                                                                 08110091
081200*GET PV-AUDIT-AGE-HOURS                                           08120099
081300 3000-SELECT-TKRPRPM.                                             08130091
081400     INITIALIZE DCLTKRPRPM.                                       08140099
081500                                                                  08150091
081600     MOVE '3000-SELECT-TKRPRPM'                                   08160091
081700                                 TO PV-ABEND-PARAGRAPH.           08170091
081800                                                                  08180091
081900     EXEC SQL                                                     08190091
082000       SELECT  FUNC_QTY                                           08200099
082100              ,CURRENT_DATE                                       08210099
082200              ,CURRENT_TIME                                       08220099
082300         INTO  :KRPRPM-FUNC-QTY                                   08230091
082400              ,:PV-TODAYS-DATE                                    08240099
082500              ,:PV-TODAYS-TIME                                    08250099
082600         FROM TKRPRPM                                             08260099
082700        WHERE SYS_PRC_FUNC_CDE = 'AUDAGE'                         08270091
082800          AND LOC_ID           = 90                               08280091
082900     END-EXEC.                                                    08290091
083000                                                                  08300091
083100     EVALUATE TRUE                                                08310091
083200       WHEN SQLCODE = ZEROS                                       08320091
083300         MOVE KRPRPM-FUNC-QTY TO PV-AUDIT-AGE-HOURS               08330091
083400       WHEN SQLCODE = +100                                        08340091
083500         CONTINUE                                                 08350091
083600       WHEN OTHER                                                 08360091
083700         DISPLAY PV-ABEND-PARAGRAPH                               08370091
083800         PERFORM 9200-SQL-ERROR                                   08380099
083900     END-EVALUATE.                                                08390091
084000*                                                                 08400091
084100*                                                                 08410091
084200 7000-OPEN-AUDIT-CURSOR.                                          08420091
084300     EXEC SQL                                                     08430091
084400         OPEN AUDIT-CSR                                           08440091
084500     END-EXEC.                                                    08450091
084600                                                                  08460091
084700     EVALUATE TRUE                                                08470091
084800         WHEN SQLCODE = ZERO                                      08480091
084900             CONTINUE                                             08490091
085000         WHEN SQLCODE < ZERO                                      08500091
085100             MOVE '7000-OPEN-AUDIT-CURSOR '                       08510091
085200                                      TO PV-PARAGRAPH             08520091
085300             MOVE 'OPEN'              TO PV-DB2-FUNCTION          08530091
085400             PERFORM 9200-SQL-ERROR                               08540099
085500         WHEN SQLCODE > ZERO                                      08550091
085600         WHEN SQLWARN0 NOT = SPACE                                08560091
085700             MOVE '7000-OPEN-AUDIT-CURSOR '                       08570091
085800                                      TO PV-PARAGRAPH             08580091
085900             MOVE 'OPEN'              TO PV-DB2-FUNCTION          08590091
086000             PERFORM 9300-SQL-WARNING                             08600091
086100     END-EVALUATE.                                                08610091
086200*                                                                 08620091
086300*                                                                 08630091
086400 7010-FETCH-AUDIT-CURSOR.                                         08640091
086500     INITIALIZE DCLSUT00015.                                      08650099
086600     INITIALIZE DCLTSUNAUD.                                       08660099
086700                                                                  08670099
086800     EXEC SQL                                                     08680091
086900     FETCH AUDIT-CSR                                              08690091
087000               INTO :PV-SOURCE-CDE                                08700091
087100                  , :PV-OPER-UNT-ID                               08710091
087200                  , :PV-STRT-DATE                                 08720091
087300                  , :PV-STRT-TIME                                 08730091
087400                  , :PV-AUD-CNTL-NBR                              08740091
087500                  , :PV-AUDIT-TYPE                                08750099
087600                  , :PV-AUDIT-STATUS                              08760099
087700                  , :PV-PO-NBR                                    08770099
087800                  , :PV-RCVR-SEQ-NBR                              08780091
087900                  , :PV-PO-LNE-NBR                                08790091
088000                  , :PV-PO-PREPK-ID                               08800091
088100                  , :PV-REQ-UNT-QTY                               08810099
088200                  , :PV-AUD-UNT-QTY                               08820091
088300                  , :PV-REQ-CART-QTY                              08830099
088400                  , :PV-AUD-CART-QTY                              08840091
088500                  , :PV-DFRD-AUD-IND                              08850091
088600                  , :PV-PKGNG-TYP-CDE                             08860091
088700                  , :PV-PACKAGE-TYPE                              08870099
088800                  , :PV-AUD-USR-ID                                08880091
088900     END-EXEC                                                     08890091
089000                                                                  08900091
089100     EVALUATE TRUE                                                08910091
089200         WHEN SQLCODE = ZERO                                      08920099
089300             MOVE PV-PO-NBR       TO PV-PO-NUMBER                 08930099
089400             MOVE PV-RCVR-SEQ-NBR TO PV-RCVR-NUMBER               08940099
      *CHG0195492                                                       08940199
                   IF PV-AUD-USR-ID NOT = SPACES                        08940299
089410                PERFORM 7100-GET-NAME                             08941099
089420                 IF XL067-KOHLS-NOT-FOUND                         08942099
089430                    MOVE PV-AUD-USR-ID         TO PV-NAME         08943099
089440                 ELSE                                             08944099
089450                    MOVE XL067-COMBINED-NAME-2 TO PV-NAME         08945099
089470                 END-IF                                           08947099
                   ELSE                                                 08947199
089430                    MOVE 'UNKNOWN'             TO PV-NAME         08947299
                   END-IF                                               08948099
      *CHG0195492                                                       08949099
089500         WHEN SQLCODE = +100                                      08950091
089600             SET PS-EOF-AUDIT-CSR-YES TO TRUE                     08960091
089700         WHEN SQLCODE < ZERO                                      08970091
089800             MOVE '7010-FETCH-AUDIT-CURSOR '                      08980091
089900                                      TO PV-PARAGRAPH             08990091
090000             MOVE 'FETCH'             TO PV-DB2-FUNCTION          09000091
090100             PERFORM 9200-SQL-ERROR                               09010099
090200         WHEN SQLCODE > ZERO                                      09020091
090300         WHEN SQLWARN0 NOT = SPACE                                09030091
090400             MOVE '7010-FETCH-AUDIT-CURSOR '                      09040091
090500                                      TO PV-PARAGRAPH             09050091
090600             MOVE 'FETCH'             TO PV-DB2-FUNCTION          09060091
090700             PERFORM 9300-SQL-WARNING                             09070091
090800     END-EVALUATE.                                                09080091
090900*                                                                 09090091
091000*                                                                 09100091
091100 7020-CLOSE-AUDIT-CSR.                                            09110091
091200     EXEC SQL                                                     09120091
091300     CLOSE AUDIT-CSR                                              09130091
091400     END-EXEC                                                     09140091
091500                                                                  09150091
091600     EVALUATE TRUE                                                09160091
091700         WHEN SQLCODE = ZERO                                      09170091
091800             CONTINUE                                             09180091
091900         WHEN SQLCODE < ZERO                                      09190091
092000             MOVE '7020-CLOSE-AUDIT-CURSOR '                      09200091
092100                                      TO PV-PARAGRAPH             09210091
092200             MOVE 'CLOSE'             TO PV-DB2-FUNCTION          09220091
092300             PERFORM 9200-SQL-ERROR                               09230099
092400         WHEN SQLCODE > ZERO                                      09240091
092500         WHEN SQLWARN0 NOT = SPACE                                09250091
092600             MOVE '7020-CLOSE-AUDIT-CURSOR '                      09260091
092700                                      TO PV-PARAGRAPH             09270091
092800             MOVE 'CLOSE'             TO PV-DB2-FUNCTION          09280091
092900             PERFORM 9300-SQL-WARNING                             09290091
093000     END-EVALUATE.                                                09300091
093100*                                                                 09310091
093100*                                                                 09314399
093101 7100-GET-NAME.                                                   09314499
093102                                                                  09314599
093103     INITIALIZE XL067-USER-COMMAREA.                              09314699
093104                                                                  09314799
093105     SET XL067-BY-USER-ID            TO TRUE.                     09314899
093106     SET XL067-SELECT-KOHLS-USER     TO TRUE.                     09314999
093107                                                                  09315099
093114     MOVE PV-AUD-USR-ID         TO XL067-KEY-USER-ID.             09315699
093115                                                                  09315799
093116     CALL XL067-USER-PGM USING XL067-USER-COMMAREA.               09315899
093117                                                                  09315999
093118     EVALUATE TRUE                                                09316099
093119         WHEN XL067-SUCCESSFUL                                    09316199
093120             CONTINUE                                             09316299
093121         WHEN OTHER                                               09316399
093122             DISPLAY '***********************************'        09316499
093123             DISPLAY '****     SUKRP029  ABEND       ****'        09316599
093124             DISPLAY '***********************************'        09316699
093125             DISPLAY '**  PARAGRAPH 7100-GET-NAME      **'        09316799
093126             DISPLAY '**  UNSUCCESSFUL CALL TO XLKUT067**'        09316899
093127             DISPLAY '**  SEE PROD COPYBOOK XLWS067    **'        09316999
093128             DISPLAY '**  XL067-RETURN-CODE:'  XL067-RETURN-CODE  09317099
093129             DISPLAY '***********************************'        09317199
093130             MOVE '7100-GET-NAME'     TO PV-PARAGRAPH             09317299
093131             MOVE 'MODULE'            TO PV-DB2-FUNCTION          09317399
093132             PERFORM 9300-SQL-WARNING                             09317499
093133                                                                  09317599
093134     END-EVALUATE.                                                09318099
093200*                                                                 09320091
093300*PRINT THE HEADING FOR THE REPORT.                                09330099
093400 8000-WRITE-REPORT-HEADERS.                                       09340091
093500     PERFORM 8200-WRITE-TOP-LINE.                                 09350091
093600                                                                  09360091
093700     WRITE SU-CARTON-AUDIT-RPT-RECORD                             09370091
093800       FROM HEADING-LINE-0                                        09380091
093900         AFTER ADVANCING 2 LINES.                                 09390099
094000                                                                  09400091
094100     WRITE SU-CARTON-AUDIT-RPT-RECORD                             09410091
094200       FROM HEADING-LINE-1                                        09420091
094300         AFTER ADVANCING 1 LINE.                                  09430091
094400                                                                  09440091
094500     WRITE SU-CARTON-AUDIT-RPT-RECORD                             09450091
094600       FROM HEADING-LINE-2                                        09460091
094700         AFTER ADVANCING 2 LINES.                                 09470099
094800                                                                  09480091
094900     WRITE SU-CARTON-AUDIT-RPT-RECORD                             09490091
095000       FROM HEADING-LINE-3                                        09500091
095100         AFTER ADVANCING 2 LINES.                                 09510091
095200                                                                  09520091
095300     WRITE SU-CARTON-AUDIT-RPT-RECORD                             09530091
095400       FROM HEADING-LINE-4                                        09540091
095500         AFTER ADVANCING 1 LINES.                                 09550091
095600                                                                  09560099
095700     MOVE PC-09                   TO PV-LINE-CNT.                 09570099
095800*                                                                 09580091
095900*                                                                 09590091
096000*WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS           09600099
096100*NEEDED FOR A DC.                                                 09610099
096200 8200-WRITE-TOP-LINE.                                             09620091
096300     ADD 1                        TO PV-PAGE-CNT.                 09630091
096400                                                                  09640091
096500     MOVE PV-PAGE-CNT             TO DP132-PAGE-NUMBER.           09650099
096600                                                                  09660091
096700     WRITE SU-CARTON-AUDIT-RPT-RECORD                             09670091
096800       FROM DP132-STANDRD-HEADER-132-COLS                         09680099
096900         AFTER ADVANCING PAGE.                                    09690091
097000*                                                                 09700091
097100*                                                                 09710091
097200*WRITES THE DETAIL LINE INFORMATION.                              09720099
097300 8400-WRITE-DETAIL-LINES.                                         09730091
097400     IF PV-STRT-DATE  =  SAVE-STRT-DATE                           09740099
097500        AND PS-NOT-NEW-PAGE                                       09750099
097600        OR  PV-AUD-CNTL-NBR = SAVE-AUD-CNTL-NBR                   09760099
097700        MOVE SPACES                  TO DL1-AUD-STRT-DATE         09770099
097800        MOVE PV-AUD-CNTL-NBR         TO DL1-AUD-CNTL-NBR          09780099
097900        MOVE PV-STRT-TIME            TO PV-DB2-TIME               09790099
098000        MOVE PV-DB2-TIME-HH          TO DL1-AUD-STRT-TIME-HH      09800099
098100        MOVE PV-DB2-TIME-MN          TO DL1-AUD-STRT-TIME-MN      09810099
098200        MOVE PV-AUDIT-TYPE           TO DL1-AUD-TYP-CDE           09820099
098300        MOVE PV-AUDIT-STATUS         TO DL1-AUD-STAT-CDE          09830099
098400        MOVE PV-PACKAGE-TYPE         TO DL1-PKG-TYP               09840099
098500        MOVE PV-SOURCE-CDE           TO DL1-SOURCE-CDE            09850099
098600                                                                  09860099
098700        IF PV-SOURCE-CDE = 'SYS'                                  09870099
098800           PERFORM 1500-GET-PO-INFO                               09880099
098900           PERFORM 1200-CALC-PERCENT-COMPLETE                     09890099
099000        ELSE                                                      09900099
099100           MOVE SPACES      TO  DL1-PO-RCVR-NBR                   09910099
099200                                DL1-PRCT-COMPLETE                 09920099
099300           MOVE ZEROES      TO  DL1-PO-LNE-NBR                    09930099
099400                                DL1-PO-PREPK-ID                   09940099
099500        END-IF                                                    09950099
099600                                                                  09960099
099700        EVALUATE PV-PKGNG-TYP-CDE                                 09970099
099800            WHEN 'BC'                                             09980099
099900            WHEN 'PP'                                             09990099
                  WHEN 'RF'                                             09991099
100000                 MOVE PV-PRCT-UNITS-COMPLETE                      10000099
100100                                     TO PV-PERCENT                10010099
100200                 MOVE PV-PERCENT-EDITED                           10020099
100300                                     TO DL1-PRCT-COMPLETE         10030099
100400            WHEN 'PS'                                             10040099
100500                 MOVE PV-PRCT-CARTS-COMPLETE                      10050099
100600                                     TO PV-PERCENT                10060099
100700                 MOVE PV-PERCENT-EDITED                           10070099
100800                                     TO DL1-PRCT-COMPLETE         10080099
100900        END-EVALUATE                                              10090099
101000                                                                  10100099
101100        MOVE PV-DFRD-AUD-IND         TO DL1-DFRD-AUD-IND          10110099
101200        MOVE PV-NAME                 TO DL1-AUD-USR-ID            10120099
101300     ELSE                                                         10130099
101400        MOVE PV-AUD-CNTL-NBR         TO DL1-AUD-CNTL-NBR          10140099
101500        MOVE PV-STRT-DATE-MM         TO DL1-AUD-STRT-DATE-MM      10150099
101600        MOVE PV-SLASH1               TO DL1-SLASH1                10160099
101700        MOVE PV-STRT-DATE-DD         TO DL1-AUD-STRT-DATE-DD      10170099
101800        MOVE PV-SLASH2               TO DL1-SLASH2                10180099
101900        MOVE PV-STRT-DATE-CCYY       TO DL1-AUD-STRT-DATE-CCYY    10190099
102000        MOVE PV-STRT-TIME            TO PV-DB2-TIME               10200099
102100        MOVE PV-DB2-TIME-HH          TO DL1-AUD-STRT-TIME-HH      10210099
102200        MOVE PV-DB2-TIME-MN          TO DL1-AUD-STRT-TIME-MN      10220099
102300        SET PS-NOT-NEW-PAGE          TO TRUE                      10230099
102400        MOVE PV-STRT-DATE            TO SAVE-STRT-DATE            10240099
102500        MOVE PV-AUD-CNTL-NBR         TO SAVE-AUD-CNTL-NBR         10250099
102600        MOVE PV-AUDIT-TYPE           TO DL1-AUD-TYP-CDE           10260099
102700        MOVE PV-AUDIT-STATUS         TO DL1-AUD-STAT-CDE          10270099
102800        MOVE PV-PACKAGE-TYPE         TO DL1-PKG-TYP               10280099
102900        MOVE PV-SOURCE-CDE           TO DL1-SOURCE-CDE            10290099
103000                                                                  10300099
103100        IF PV-SOURCE-CDE = 'SYS'                                  10310099
103200           PERFORM 1500-GET-PO-INFO                               10320099
103300           PERFORM 1200-CALC-PERCENT-COMPLETE                     10330099
103400        ELSE                                                      10340099
103500           MOVE SPACES               TO  DL1-PO-RCVR-NBR          10350099
103600                                         DL1-PRCT-COMPLETE        10360099
103700           MOVE ZEROES               TO  DL1-PO-LNE-NBR           10370099
103800                                         DL1-PO-PREPK-ID          10380099
103900        END-IF                                                    10390099
104000                                                                  10400099
104100        EVALUATE PV-PKGNG-TYP-CDE                                 10410099
104200            WHEN 'BC'                                             10420099
104300            WHEN 'PP'                                             10430099
                  WHEN 'RF'                                             10431099
104400                 MOVE PV-PRCT-UNITS-COMPLETE                      10440099
104500                                     TO PV-PERCENT                10450099
104600                 MOVE PV-PERCENT-EDITED                           10460099
104700                                     TO DL1-PRCT-COMPLETE         10470099
104800            WHEN 'PS'                                             10480099
104900                 MOVE PV-PRCT-CARTS-COMPLETE                      10490099
105000                                     TO PV-PERCENT                10500099
105100                 MOVE PV-PERCENT-EDITED                           10510099
105200                                     TO DL1-PRCT-COMPLETE         10520099
105300        END-EVALUATE                                              10530099
105400                                                                  10540099
105500        MOVE PV-DFRD-AUD-IND         TO DL1-DFRD-AUD-IND          10550099
105600        MOVE PV-NAME                 TO DL1-AUD-USR-ID            10560099
105700     END-IF.                                                      10570099
105800                                                                  10580099
105900     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10590099
106000      FROM DETAIL-LINE1.                                          10600099
106100                                                                  10610099
106200     ADD +1                          TO PV-LINE-CNT.              10620099
106300                                                                  10630099
106400     IF  PV-LINE-CNT > PC-MAX-REPORT-LINES                        10640099
106500          WRITE SU-CARTON-AUDIT-RPT-RECORD                        10650099
106600               FROM PC-BLANK-LINE                                 10660099
106700                 AFTER ADVANCING 1 LINES                          10670099
106800          PERFORM 8000-WRITE-REPORT-HEADERS                       10680099
106900          INITIALIZE  SAVE-STRT-DATE                              10690099
107000          INITIALIZE  SAVE-AUD-CNTL-NBR                           10700099
107100     END-IF.                                                      10710099
107200*                                                                 10720099
107300*                                                                 10730099
107400 8500-WRITE-DC-TOTALS.                                            10740099
107500     MOVE PV-MANUAL-AUDIT-CNT     TO TL1-MAN-AUDIT-CNT.           10750099
107600     MOVE PV-SYSTEM-PROMP-CNT     TO TL2-SYS-PROMP-CNT.           10760099
107700     MOVE PV-SYSTEM-INPRC-CNT     TO TL3-SYS-INPRC-CNT.           10770099
107800     MOVE PV-TOTAL-AUDIT-CNT      TO TL4-TOT-AUDIT-CNT.           10780099
107900                                                                  10790099
108000     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10800099
108100      FROM TOTAL-LINE1                                            10810099
108200     AFTER ADVANCING 2 LINES.                                     10820099
108300                                                                  10830099
108400     ADD +2                          TO PV-LINE-CNT.              10840099
108500                                                                  10850099
108600     IF  PV-LINE-CNT > PC-MAX-REPORT-LINES                        10860099
108700          WRITE SU-CARTON-AUDIT-RPT-RECORD                        10870099
108800               FROM PC-BLANK-LINE                                 10880099
108900                 AFTER ADVANCING 1 LINES                          10890099
109000          PERFORM 8000-WRITE-REPORT-HEADERS                       10900099
109100          WRITE SU-CARTON-AUDIT-RPT-RECORD                        10910099
109200               FROM PC-BLANK-LINE                                 10920099
109300                 AFTER ADVANCING 1 LINES                          10930099
109400          INITIALIZE  SAVE-STRT-DATE                              10940099
109500          INITIALIZE  SAVE-AUD-CNTL-NBR                           10950099
109600     END-IF.                                                      10960099
109700                                                                  10970099
109800     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10980099
109900      FROM TOTAL-LINE2.                                           10990099
110000                                                                  11000099
110100     ADD +1                          TO PV-LINE-CNT.              11010099
110200                                                                  11020099
110300     IF  PV-LINE-CNT > PC-MAX-REPORT-LINES                        11030099
110400          WRITE SU-CARTON-AUDIT-RPT-RECORD                        11040099
110500               FROM PC-BLANK-LINE                                 11050099
110600                 AFTER ADVANCING 1 LINES                          11060099
110700          PERFORM 8000-WRITE-REPORT-HEADERS                       11070099
110800          WRITE SU-CARTON-AUDIT-RPT-RECORD                        11080099
110900               FROM PC-BLANK-LINE                                 11090099
111000                 AFTER ADVANCING 1 LINES                          11100099
111100          INITIALIZE  SAVE-STRT-DATE                              11110099
111200          INITIALIZE  SAVE-AUD-CNTL-NBR                           11120099
111300     END-IF.                                                      11130099
111400                                                                  11140099
111500     WRITE SU-CARTON-AUDIT-RPT-RECORD                             11150099
111600      FROM TOTAL-LINE3.                                           11160099
111700                                                                  11170099
111800     ADD +1                          TO PV-LINE-CNT.              11180099
111900                                                                  11190099
112000     IF  PV-LINE-CNT > PC-MAX-REPORT-LINES                        11200099
112100          WRITE SU-CARTON-AUDIT-RPT-RECORD                        11210099
112200               FROM PC-BLANK-LINE                                 11220099
112300                 AFTER ADVANCING 1 LINES                          11230099
112400          PERFORM 8000-WRITE-REPORT-HEADERS                       11240099
112500          WRITE SU-CARTON-AUDIT-RPT-RECORD                        11250099
112600               FROM PC-BLANK-LINE                                 11260099
112700                 AFTER ADVANCING 1 LINES                          11270099
112800          INITIALIZE  SAVE-STRT-DATE                              11280099
112900          INITIALIZE  SAVE-AUD-CNTL-NBR                           11290099
113000     END-IF.                                                      11300099
113100                                                                  11310099
113200     WRITE SU-CARTON-AUDIT-RPT-RECORD                             11320099
113300      FROM TOTAL-LINE4.                                           11330099
113400                                                                  11340099
113500     ADD +1                          TO PV-LINE-CNT.              11350099
113600                                                                  11360099
113700     IF  PV-LINE-CNT > PC-MAX-REPORT-LINES                        11370099
113800          WRITE SU-CARTON-AUDIT-RPT-RECORD                        11380099
113900               FROM PC-BLANK-LINE                                 11390099
114000                 AFTER ADVANCING 1 LINES                          11400099
114100          PERFORM 8000-WRITE-REPORT-HEADERS                       11410099
114200          INITIALIZE  SAVE-STRT-DATE                              11420099
114300          INITIALIZE  SAVE-AUD-CNTL-NBR                           11430099
114400     END-IF.                                                      11440099
114500                                                                  11450099
114600     INITIALIZE  PV-MANUAL-AUDIT-CNT                              11460099
114700                 PV-SYSTEM-PROMP-CNT                              11470099
114800                 PV-SYSTEM-INPRC-CNT                              11480099
114900                 PV-TOTAL-AUDIT-CNT.                              11490099
115000*                                                                 11500099
115100*                                                                 11510099
115200*SQL WARNING OR ERROR PROCESSING.                                 11520099
115300 9200-SQL-ERROR.                                                  11530099
115400     MOVE SQLCODE    TO SQLCODE2.                                 11540091
115500     MOVE SQLERRD(3) TO SQLERRD3.                                 11550091
115600     DISPLAY '** ABEND **       ** = SQLERROR'.                   11560091
115700     DISPLAY '** PROGRAM        ** = SUKRP029'.                   11570091
115800     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  11580091
115900     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  11590091
116000     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   11600091
116100     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  11610091
116200     EXEC SQL                                                     11620091
116300         COMMIT                                                   11630091
116400     END-EXEC.                                                    11640091
116500     MOVE +4013 TO PV-ABEND-CODE.                                 11650091
116600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         11660091
116700*                                                                 11670091
116800*                                                                 11680091
116810 9220-XLKUT071-ERROR.                                             11681099
116840     DISPLAY '** ABEND **         ** = XLKUT071'.                 11684099
116850     DISPLAY '** PROGRAM          ** = SUKRP029'.                 11685099
116860     DISPLAY '** PARAGRAPH        ** = ' PV-ABEND-PARAGRAPH.      11686099
116870                                                                  11687099
116880     DISPLAY '** SQLCODE FROM MOD ** = ' XL071-SQLCODE.           11688099
116890     DISPLAY '** TABLE IN ERROR   ** = ' XL071-DB2-TABLE.         11689099
116891     DISPLAY '** XLKUT071 RETURN  ** = ' XL071-RETURN-CODE.       11689199
116894     MOVE +4013 TO PV-ABEND-CODE.                                 11689499
116895     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         11689599
116896*                                                                 11689699
116897*                                                                 11689799
116900 9300-SQL-WARNING.                                                11690091
117000     DISPLAY '9300-SQL-WARNING'.                                  11700091
117100     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                11710091
117200     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   11720091
117300     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                11730091
117400                                                                  11740091
117500     MOVE SQLCODE                     TO SQLCODE2.                11750091
117600     MOVE SQLERRD(3)                  TO SQLERRD3.                11760091
117700     DISPLAY '** ABEND **       ** = SQLWARNING'.                 11770091
117800     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  11780091
117900     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  11790091
118000     DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  11800091
118100     DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  11810091
118200     DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  11820091
118300     DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  11830091
118400     DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  11840091
118500     DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  11850091
118600     DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  11860091
118700     DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  11870091
118800                                                                  11880091
118900     MOVE +4013                       TO PV-ABEND-CODE.           11890091
119000     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         11900091
