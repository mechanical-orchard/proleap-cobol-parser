000100 IDENTIFICATION DIVISION.                                         00010052
000200 PROGRAM-ID.    RCKCS256.                                         00020052
000300 AUTHOR.        LARRY SCHLEICHER - STRATAGEM.                     00030052
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040052
000500 DATE-WRITTEN.  02-20-96.                                         00050052
000600 DATE-COMPILED.                                                   00060052
000700                                                                  00070052
000800*---------------------------------------------------------------* 00080052
000900*    E256 - RECEIVER ITEM ADD LIST PROGRAM                      * 00090052
001000*                                                               * 00100052
001100*    THIS PROGRAM GENERATES A LIST OF PURCHASE ITEMS FOR WHICH  * 00110052
001200*    THERE ARE NO CORRESPONDING RECEIVER ITEMS.                 * 00120052
001300*                                                               * 00130052
001400*---------------------------------------------------------------* 00140052
001500* MAINTENANCE:                                                  * 00150052
001600*---------------------------------------------------------------* 00160052
001610* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00161063
001620* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00162064
001630* MAKING THE CALL DYNAMIC VS STATIC.                              00163064
001640*---------------------------------------------------------------* 00164064
001700/                                                                 00170052
001800 ENVIRONMENT DIVISION.                                            00180052
001900                                                                  00190052
002000 DATA DIVISION.                                                   00200052
002100                                                                  00210052
002200 WORKING-STORAGE SECTION.                                         00220052
002300                                                                  00230052
002400 01  DK-DB2-KEYS.                                                 00240052
002500*    REQUIRED FIELDS                                              00250052
002600     05  DK-ORD-NBR                     PIC S9(09)  COMP.         00260052
002700     05  DK-RCVR-SEQ-NBR                PIC S9(09)  COMP.         00270052
002800     05  DK-LINE-NBR                    PIC S9(04)  COMP.         00280052
002900     05  DK-OPR-ID                      PIC S9(04)  COMP.         00290052
003000     05  DK-FACT                        PIC S9(04)  COMP.         00300052
003100*    OPTIONAL FIELDS                                              00310052
003200     05  DK-STAT-CDE-AP                 PIC  X(02)  VALUE 'AP'.   00320052
003300     05  DK-STAT-CDE-AC                 PIC  X(02)  VALUE 'AC'.   00330052
003400     05  DK-STAT-CDE-CM                 PIC  X(02)  VALUE 'CM'.   00340052
003500     05  DK-STAT-CDE-RV                 PIC  X(02)  VALUE 'RV'.   00350052
003600     05  DK-STAT-CDE-ACTIVE             PIC  X(01)  VALUE 'A'.    00360052
003700     05  DK-STR-NBR-B                   PIC S9(04)  COMP          00370052
003800                                                    VALUE +0.     00380052
003900     05  DK-STR-NBR-E                   PIC S9(04)  COMP          00390052
004000                                                    VALUE +9999.  00400052
004100                                                                  00410052
004200 01  PC-PROGRAM-CONSTANTS.                                        00420052
004300     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00430052
004400                                                    'RC256A  '.   00440052
004500     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00450052
004600                                                    'RCKM256 '.   00460052
004700     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00470052
004800                                                    'RCKCS256'.   00480052
004900     05  PC-APPL-MAP                    PIC S9(04)  VALUE  +1     00490052
005000                                                    COMP.         00500052
005100     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00510052
005200     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00520052
005300     05  PC-INTER-APPL-CODES.                                     00530052
005400         10 PC-INTER-APPL-CRIT-SPEC     PIC  X(01)  VALUE '1'.    00540052
005500         10 PC-INTER-APPL-LIST          PIC  X(01)  VALUE '5'.    00550052
005600         10 PC-INTER-APPL-PKSL-CRIT     PIC  X(01)  VALUE 'C'.    00560052
005700         10 PC-INTER-APPL-PKSL-LIST     PIC  X(01)  VALUE 'P'.    00570052
005800     05  PC-WORK-ORDER-DIST-SHEET       PIC  9(03)  VALUE 001.    00580052
005900     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +9      00590052
006000                                                    COMP SYNC.    00600052
006100     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00610052
006200                                                    COMP SYNC.    00620052
006300     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00630052
006400                                                    +1000000      00640052
006500                                                    COMP-3.       00650052
006600     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +7      00660052
006700                                                    COMP SYNC.    00670052
006800     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE +3      00680052
006900                                                    COMP-3.       00690052
007000     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00700052
007100     05  PC-A                           PIC  X(01)  VALUE 'A'.    00710052
007200     05  PC-X                           PIC  X(01)  VALUE 'X'.    00720052
007300     05  PC-R                           PIC  X(01)  VALUE 'R'.    00730052
007400     05  PC-S                           PIC  X(01)  VALUE 'S'.    00740052
007500     05  PC-T                           PIC  X(01)  VALUE 'T'.    00750052
007600     05  PC-Y                           PIC  X(01)  VALUE 'Y'.    00760052
007700     05  PC-N                           PIC  X(01)  VALUE 'N'.    00770052
007800     05  PC-I                           PIC  X(01)  VALUE 'I'.    00780052
007900     05  PC-ADD                         PIC  X(03)  VALUE 'ADD'.  00790052
008000     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00800052
008100     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00810052
008200     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00820052
008300     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00830052
008400     05  PC-VE                          PIC  X(02)  VALUE 'VE'.   00840052
008500*                                                                 00850052
008600*----------------------------------------------------------------*00860052
008700*                                                    WR # 230ZZ  *00870052
008800* PROGRAM CONSTANTS TO CHECK FOR DUMMY SKU'S                     *00880052
008900*----------------------------------------------------------------*00890052
009000*                                                                 00900052
009100     05  PC-000                         PIC  9(03)  VALUE 000.    00910052
009200     05  PC-999                         PIC  9(03)  VALUE 999.    00920052
009300*                                                                 00930052
009400*----------------------------------------------------------------*00940052
009500* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *00950052
009600*----------------------------------------------------------------*00960052
009700*                                                                 00970052
009800     05  PC-TSYMSG-NUMBERS.                                       00980052
009900         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  00990052
010000         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01000052
010100         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01010052
010200         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01020052
010300         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01030052
010400         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01040052
010500         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01050052
010600         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01060052
010700         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01070052
010800         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01080052
010900         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01090052
011000         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01100052
011100         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01110052
011200         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01120052
011300         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01130052
011400         10  PC-TSYMSG-00883            PIC  9(05)  VALUE 00883.  01140052
011500*  P.O. NUMBER REQUIRED                                           01150052
011600         10  PC-TSYMSG-00736            PIC  9(05)  VALUE 00736.  01160052
011700*  RECEIVER SEQUENCE NBR REQUIRED                                 01170052
011800         10  PC-TSYMSG-00737            PIC  9(05)  VALUE 00737.  01180052
011900*  LINE NUMBER REQUIRED                                           01190052
012000         10  PC-TSYMSG-00738            PIC  9(05)  VALUE 00738.  01200052
012100*  WORK ORDER NUMBER REQUIRED                                     01210052
012200         10  PC-TSYMSG-00739            PIC  9(05)  VALUE 00739.  01220052
012300*  RECEIVER STATUS CODE REQUIRED                                  01230052
012400         10  PC-TSYMSG-00740            PIC  9(05)  VALUE 00740.  01240052
012500                                                                  01250052
012600 01  PS-PROGRAM-SWITCHES.                                         01260052
012700     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01270052
012800         88  PS-NO-ERROR                            VALUE 'Y'.    01280052
012900         88  PS-ERROR                               VALUE 'N'.    01290052
013000     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01300052
013100         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01310052
013200         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01320052
013300     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01330052
013400         88  PS-DONE                                VALUE 'Y'.    01340052
013500         88  PS-NOT-DONE                            VALUE 'N'.    01350052
013600     05  PS-VERIFIED-RECEIVER-SW        PIC  X(01)  VALUE 'N'.    01360052
013700         88  PS-VERIFIED-RECEIVER                   VALUE 'Y'.    01370052
013800                                                                  01380052
013900*----------------------------------------------------------------*01390052
014000*                                               **   WR # 230ZZ  *01400052
014100*  INCLUDED PROGRAM SWITCH FOR XLKUT001           **             *01410052
014200*----------------------------------------------------------------*01420052
014300                                                                  01430052
014400     05  PS-CALL-API-SW               PIC  X    VALUE 'N'.        01440052
014500         88  PS-CALL-API-NO                     VALUE 'N'.        01450052
014600         88  PS-CALL-API-YES                    VALUE 'Y'.        01460052
014700                                                                  01470052
014800*----------------------------------------------------------------*01480052
014900* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *01490052
015000*----------------------------------------------------------------*01500052
015100                                                                  01510052
015200 01  PV-PROGRAM-VARIABLES.                                        01520052
015300     05  PV-SUB                         PIC S9(04)  VALUE +0      01530052
015400                                                    COMP SYNC.    01540052
015500     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01550052
015600                                                    COMP SYNC.    01560052
015700     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01570052
015800                                                    COMP-3.       01580052
015900     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01590052
016000                                                    COMP-3.       01600052
016100     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01610052
016200                                                    COMP-3.       01620052
016300     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01630052
016400                                                    COMP-3.       01640052
016500     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01650052
016600                                                    COMP-3.       01660052
016700     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01670052
016800                                                    COMP-3.       01680052
016900     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01690052
017000                                                    COMP-3.       01700052
017100     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01710052
017200                                                    COMP SYNC.    01720052
017300     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01730052
017400                                                    COMP SYNC.    01740052
017500     05  PV-ITEM                        PIC S9(04)  VALUE +0      01750052
017600                                                    COMP SYNC.    01760052
017700     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01770052
017800                                                    COMP SYNC.    01780052
017900     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01790052
018000                                                    COMP SYNC.    01800052
018100     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01810052
018200                                                    COMP SYNC.    01820052
018300     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01830052
018400                                                    COMP SYNC.    01840052
018500     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01850052
018600                                                    COMP SYNC.    01860052
018700     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01870052
018800                                                    COMP SYNC.    01880052
018900     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01890052
019000                                                    COMP SYNC.    01900052
019100     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01910052
019200                                                    COMP SYNC.    01920052
019300     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01930052
019400                                                    COMP SYNC.    01940052
019500     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01950052
019600                                                    COMP SYNC.    01960052
019700     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01970052
019800                                                    COMP SYNC.    01980052
019900     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0      01990052
020000                                                    COMP-3.       02000052
020100     05  PV-UNRSLVD-TRBL-COUNT          PIC S9(09)  VALUE ZERO    02010052
020200                                                    COMP-3.       02020052
020300     05  PV-RSLVD-TRBL-COUNT            PIC S9(09)  VALUE ZERO    02030052
020400                                                    COMP-3.       02040052
020500     05  PV-VERIFY-ITM-QTY              PIC S9(05)  VALUE +0      02050052
020600                                                    COMP.         02060052
020700     05  PV-ACTL-CART-CNT               PIC S9(09)  VALUE +0      02070052
020800                                                    COMP.         02080052
020900*----------------------------------------------------------------*02090052
021000*                                                    WR # 230ZZ  *02100052
021100* CHANGED THE STRUCTURE OF PV-SKU AND ADDES NEW VARIABLES        *02110052
021200*----------------------------------------------------------------*02120052
021300*                                                                 02130052
022300     05  PV-SKU-DEPT                   PIC X(03).                 02230052
022400     05  PV-SKU-SEQ                    PIC X(08).                 02240052
022500     05  PV-SKU-SEQ-TEMP               PIC S9(8)V COMP-3.         02250052
022600     05  PV-DISP-CL-SKU.                                          02260052
022700         10 PV-DISP-CL                 PIC X(02).                 02270052
022800         10 FILLER                     PIC X(01) VALUE ' '.       02280052
022900         10 PV-DISP-SKU                PIC 9(08).                 02290052
023000*                                                                 02300052
023100*----------------------------------------------------------------*02310052
023200* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *02320052
023300*----------------------------------------------------------------*02330052
023400*                                                                 02340052
023500     05  PV-CRE-TMST.                                             02350052
023600         10  FILLER                     PIC X(02).                02360052
023700         10  PV-CRE-YY                  PIC X(02).                02370052
023800         10  FILLER                     PIC X(01).                02380052
023900         10  PV-CRE-MM                  PIC X(02).                02390052
024000         10  FILLER                     PIC X(01).                02400052
024100         10  PV-CRE-DD                  PIC X(02).                02410052
024200         10  FILLER                     PIC X(01).                02420052
024300         10  PV-CRE-HRS                 PIC X(02).                02430052
024400         10  FILLER                     PIC X(01).                02440052
024500         10  PV-CRE-MIN                 PIC X(02).                02450052
024600         10  FILLER                     PIC X(10).                02460052
024700     05  PV-CREATE-DTE.                                           02470052
024800         10  PV-CREATE-MM               PIC X(02).                02480052
024900         10  FILLER                     PIC X(01) VALUE '/'.      02490052
025000         10  PV-CREATE-DD               PIC X(02).                02500052
025100         10  FILLER                     PIC X(01) VALUE '/'.      02510052
025200         10  PV-CREATE-YY               PIC X(02).                02520052
025300     05  PV-CREATE-TME.                                           02530052
025400         10  PV-CREATE-HRS              PIC X(02).                02540052
025500         10  FILLER                     PIC X(01) VALUE ':'.      02550052
025600         10  PV-CREATE-MIN              PIC X(02).                02560052
025700     05  PV-NUMBER-OF-RV-ITEMS          PIC S9(2) VALUE ZERO.     02570052
025800                                                                  02580052
025900*---------------------------------------------------------------* 02590052
026000*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 02600052
026100*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           * 02610052
026200*   APPLICATION-SPECIFIC COMMAREA.                              * 02620052
026300*---------------------------------------------------------------* 02630052
026400 01  LQW-LIST-QUEUE-WORK-AREA.                                    02640052
026500     05  LQW-BLOCK-MODIFIED             PIC X(01)   VALUE SPACE.  02650052
026600     05  LQW-ITEM-ENTRIES               OCCURS 9 TIMES            02660052
026700                                        INDEXED BY LQW-IDX.       02670052
026800         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02680052
026900         10  LQW-TEMP-SELECTED-SW       PIC X(01).                02690052
027000         10  LQW-SELECTED-SW            PIC X(01).                02700052
027100             88  LQW-SELECT                         VALUE 'S'.    02710052
027200             88  LQW-DESELECT                       VALUE ' '.    02720052
027300         10  LQW-ACTION                 PIC X(3).                 02730052
027400         10  LQW-LINE-NUMBER            PIC 9(4).                 02740052
027500         10  LQW-ENT-ID                 PIC S9(09) COMP.          02750052
027600*                                                                 02760052
027700*----------------------------------------------------------------*02770052
027800*                                                **   WR # 230ZZ *02780052
027900* CHANGE THE STRUCTURE OF LQW TO MATCH WITH ASC STRUCTURE        *02790052
028000*----------------------------------------------------------------*02800052
028100*                                                                 02810052
028200         10  LQW-SKU.                                             02820052
028300             15  LQW-DEPT               PIC X(03).                02830052
028500             15  LQW-CL                 PIC X(02).                02850052
028700             15  LQW-SEQ                PIC S9(08)V COMP-3.       02870052
028800         10  LQW-SKU-DESC               PIC X(25).                02880052
028900         10  LQW-ITM-NBR                PIC S9(15)V               02890052
029000                                            COMP-3.               02900052
029100         10  LQW-VER-NBR                PIC S9(09)                02910052
029200                                            COMP.                 02920052
029300         10  LQW-INNER-PACK             PIC 9(5).                 02930052
029400         10  LQW-CASE-PACK              PIC 9(5).                 02940052
029500         10  LQW-OTR                    PIC 9(5).                 02950052
029600         10  LQW-STATUS-CDE             PIC X(2).                 02960052
029700         10  LQW-PURITM-UNT-QTY         PIC S9(09)                02970052
029800                                            COMP.                 02980052
029900         10  LQW-PURITM-UNT-RTL-PR-AMT  PIC S9(06)V99             02990052
030000                                            COMP-3.               03000052
030100         10  LQW-PURITM-GP-RTL-AMT      PIC S9(05)V99             03010052
030200                                            COMP-3.               03020052
030300         10  LQW-PURITM-GP-QTY          PIC S9(04)                03030052
030400                                            COMP.                 03040052
030500         10  LQW-ITEM-VEND-STYL-NAME    PIC X(08).                03050057
030600         10  LQW-LINE-TRBL-SW           PIC X(01).                03060052
030700                                                                  03070052
030800*----------------------------------------------------------------*03080052
030900*   CHANGES MADE FOR WR # 230ZZ ENDS HERE.                        03090052
031000*----------------------------------------------------------------*03100052
031100/                                                                 03110052
031200*---------------------------------------------------------------* 03120052
031300*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 03130052
031400*---------------------------------------------------------------* 03140052
031500                                                                  03150052
031600     COPY PCWS016.                                                03160052
031700                                                                  03170052
031800*---------------------------------------------------------------* 03180052
031900*  RECORD LAYOUT FOR THE PACKSLIP SELECTION TEMP STORAGE QUEUE. * 03190052
032000*---------------------------------------------------------------* 03200052
032100                                                                  03210052
032200     COPY RCWS013.                                                03220052
032300                                                                  03230052
032400/                                                                 03240052
032500*----------------------------------------------------------------*03250052
032600* COPY BOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE  WR # 230ZZ  *03260052
032700*----------------------------------------------------------------*03270052
032800     COPY XLWS001.                                                03280052
032900                                                                  03290052
033000*----------------------------------------------------------------*03300052
033100* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *03310052
033200*----------------------------------------------------------------*03320052
033300*                                                                 03330052
033400*---------------------------------------------------------------* 03340052
033500*    MAP LAYOUT                                                 * 03350052
033600*---------------------------------------------------------------* 03360052
033700                                                                  03370052
033800     COPY RCKM256.                                                03380052
033900*                                                                 03390052
034000*----------------------------------------------------------------*03400052
034100*                                                    WR # 230ZZ  *03410052
034200* CHANGED THE FILLER OF MR-OCCURS-LAYOUT FROM X(138) TO X(146)   *03420052
034300* AS THE FIELD SIZE FOR SKU WAS INCREASED IN THE MAP RCKM256    * 03430052
034400*----------------------------------------------------------------*03440052
034500*                                                                 03450052
034600/                                                                 03460052
034700 01  MR-OCCURS-LAYOUT                   REDEFINES  RC256AO.       03470052
034800     05  FILLER                         PIC X(146).               03480052
034900     05  MR-SCROLL-AREA                 OCCURS 09 TIMES.          03490052
035000         10  MR-SELECTL                 PIC S9(04) COMP.          03500052
035100         10  MR-SELECTA                 PIC  X(01).               03510052
035200         10  MR-SELECTC                 PIC  X(01).               03520052
035300         10  MR-SELECTH                 PIC  X(01).               03530052
035400         10  MR-SELECT                  PIC  X(01).               03540052
035500                                                                  03550052
035600         10  MR-ACTL                    PIC S9(04) COMP.          03560052
035700         10  MR-ACTA                    PIC  X(01).               03570052
035800         10  MR-ACTC                    PIC  X(01).               03580052
035900         10  MR-ACTH                    PIC  X(01).               03590052
036000         10  MR-ACT                     PIC  X(03).               03600052
036100                                                                  03610052
036200         10  MR-LINEL                   PIC S9(04) COMP.          03620052
036300         10  MR-LINEA                   PIC  X(01).               03630052
036400         10  MR-LINEC                   PIC  X(01).               03640052
036500         10  MR-LINEH                   PIC  X(01).               03650052
036600         10  MR-LINE.                                             03660052
036700             15  MR-LINE-N              PIC  ZZZ9.                03670052
036800                                                                  03680052
036900         10  MR-STATUS-CDEL             PIC S9(04) COMP.          03690052
037000         10  MR-STATUS-CDEA             PIC  X(01).               03700052
037100         10  MR-STATUS-CDEC             PIC  X(01).               03710052
037200         10  MR-STATUS-CDEH             PIC  X(01).               03720052
037300         10  MR-STATUS-CDE              PIC  X(02).               03730052
037400                                                                  03740052
037500         10  MR-SKUL                    PIC S9(04) COMP.          03750052
037600         10  MR-SKUA                    PIC  X(01).               03760052
037700         10  MR-SKUC                    PIC  X(01).               03770052
037800         10  MR-SKUH                    PIC  X(01).               03780052
037900         10  MR-SKU                     PIC  X(11).               03790052
038000                                                                  03800052
038100         10  MR-INNER-PACKL             PIC S9(04) COMP.          03810052
038200         10  MR-INNER-PACKA             PIC  X(01).               03820052
038300         10  MR-INNER-PACKC             PIC  X(01).               03830052
038400         10  MR-INNER-PACKH             PIC  X(01).               03840052
038500         10  MR-INNER-PACK.                                       03850052
038600             15  MR-INNER-PACK-N        PIC  ZZZZ9.               03860052
038700                                                                  03870052
038800         10  MR-CASE-PACKL              PIC S9(04) COMP.          03880052
038900         10  MR-CASE-PACKA              PIC  X(01).               03890052
039000         10  MR-CASE-PACKC              PIC  X(01).               03900052
039100         10  MR-CASE-PACKH              PIC  X(01).               03910052
039200         10  MR-CASE-PACK.                                        03920052
039300             15  MR-CASE-PACK-N         PIC  ZZZZ9.               03930052
039400                                                                  03940052
039500         10  MR-OTRL                    PIC S9(04) COMP.          03950052
039600         10  MR-OTRA                    PIC  X(01).               03960052
039700         10  MR-OTRC                    PIC  X(01).               03970052
039800         10  MR-OTRH                    PIC  X(01).               03980052
039900         10  MR-OTR                     PIC  X(05).               03990052
040000*                                                                 04000052
040100*----------------------------------------------------------------*04010052
040200* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *04020052
040300*----------------------------------------------------------------*04030052
040400*                                                                 04040052
040500                                                                  04050052
040600     EJECT                                                        04060052
040700*---------------------------------------------------------------* 04070052
040800*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04080052
040900*---------------------------------------------------------------* 04090052
041000                                                                  04100052
041100     COPY DPWS015.                                                04110052
041200                                                                  04120052
041300*---------------------------------------------------------------* 04130052
041400*    FUNCTION KEYS COPYBOOK.                                    * 04140052
041500*---------------------------------------------------------------* 04150052
041600                                                                  04160052
041700     COPY DPWS016.                                                04170052
041800                                                                  04180052
041900*---------------------------------------------------------------* 04190052
042000*    NUMERIC EDIT LAYOUT.                                       * 04200052
042100*---------------------------------------------------------------* 04210052
042200                                                                  04220052
042300     COPY DPWS010I.                                               04230052
042400                                                                  04240052
042500/                                                                 04250052
042600******************************************************************04260064
042700** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **04270064
042710** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **04271064
042800******************************************************************04280064
042900                                                                  04290052
043000     COPY DPWS030.                                                04300052
043010     COPY DPWS930.                                                04301064
043100                                                                  04310052
043200/                                                                 04320052
043300*---------------------------------------------------------------* 04330052
043400*    STANDARD COMMAREA.                                         * 04340052
043500*---------------------------------------------------------------* 04350052
043600                                                                  04360052
043700     COPY DPWS020.                                                04370052
043800     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04380052
043900                                                                  04390052
044000*---------------------------------------------------------------* 04400052
044100* INTER-APPLICATION COMMAREA.                                   * 04410052
044200* RCWS012 - INTER-APPLICATION COMMAREA FROM THE PACK SLIP UPDT  * 04420052
044300* RCWS015 - INTER-APPLICATION COMMAREA FROM THE PACK SLIP LIST  * 04430052
044400*---------------------------------------------------------------* 04440052
044500                                                                  04450052
044600         10  INTER-APPL-COMM-AREA       PIC X(200).               04460052
044700     COPY PCWS000.                                                04470052
044800                                                                  04480052
044900     COPY RCWS012.                                                04490052
045000     COPY RCWS015.                                                04500052
045100*---------------------------------------------------------------* 04510052
045200*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04520052
045300*---------------------------------------------------------------* 04530052
045400         10  ASC-SPECIFIC-COMMAREA.                               04540052
045500             15  ASC-LIST-KEYS.                                   04550052
045600                 20  ASC-PO-NBR             PIC 9(08).            04560052
045700                 20  ASC-REC-SEQ-NBR        PIC 9(03).            04570052
045800                 20  ASC-STAT               PIC X(02).            04580052
045900                 20  ASC-OPR-ID             PIC ZZZ9.             04590052
046000                 20  ASC-FACT               PIC ZZZ9.             04600052
046100             15  ASC-OTHER-TOP-OF-SCREEN-DATA.                    04610052
046200                 20  ASC-TRECEIV-DATA.                            04620052
046300                     25  ASC-TRECEIV-EXPTED-CART-CNT  PIC 9(5).   04630052
046400                     25  ASC-TRECEIV-ACTL-CART-CNT    PIC 9(5).   04640052
046500                     25  ASC-TPURITM-SKU.                         04650052
046600                         30  ASC-TPURCHS-DEPT-NBR     PIC X(3).   04660052
046700                         30  ASC-SKU-CLASS-NBR        PIC X(2).   04670054
046800                         30  ASC-TPURITM-SKU-SEQ-NBR  PIC X(8).   04680052
046900                     25  ASC-ITEM-SKU-DESC            PIC X(25).  04690057
047000                     25  ASC-ITM-VND-STYL-NAME        PIC X(20).  04700061
047100             15  ASC-BLOCK-ENTRIES      OCCURS 2 TIMES.           04710052
047200                 20  ASC-BLOCK-MODIFIED-SW                        04720052
047300                                        PIC X(01).                04730052
047400                     88  ASC-BLOCK-NOT-MODIFIED    VALUE 'N'.     04740052
047500                     88  ASC-BLOCK-MODIFIED        VALUE 'Y'.     04750052
047600                                                                  04760052
047700                 20  ASC-ITEM-ARRAY.                              04770052
047800                     25  ASC-ITEM-ENTRIES OCCURS 9 TIMES.         04780052
047900                         30  ASC-LIST-ITEM-NUMBER                 04790052
048000                                        PIC S9(09) COMP-3.        04800052
048100                         30  ASC-TEMP-SELECTED-SW                 04810052
048200                                        PIC X(01).                04820052
048300                             88  ASC-VALID-SELECT  VALUE ' '      04830052
048400                                                         'S'      04840052
048500                                                         'B'      04850052
048600                                                         'E'.     04860052
048700                             88  ASC-TEMP-NO-SELECT               04870052
048800                                                   VALUE ' '.     04880052
048900                             88  ASC-TEMP-SELECT   VALUE 'S'.     04890052
049000                             88  ASC-TEMP-BEGIN    VALUE 'B'.     04900052
049100                             88  ASC-TEMP-END      VALUE 'E'.     04910052
049200                         30  ASC-SELECTED-SW                      04920052
049300                                        PIC X(01).                04930052
049400                             88  ASC-NO-SELECT     VALUE ' '.     04940052
049500                             88  ASC-SELECT        VALUE 'S'.     04950052
049600                             88  ASC-BEGIN         VALUE 'B'.     04960052
049700                             88  ASC-END           VALUE 'E'.     04970052
049800                         30  ASC-ACTION            PIC X(03).     04980052
049900                         30  ASC-LINE-NUMBER       PIC 9(04).     04990052
050000                         30  ASC-ENT-ID            PIC S9(09)     05000052
050100                                                       COMP.      05010052
050200*----------------------------------------------------------------*05020052
050300*                                                **   WR # 230ZZ *05030052
050400* CHANGED THE STRUCTURE OF ASC TO MATCH THE APPL COMMAREA        *05040052
050500*----------------------------------------------------------------*05050052
050600*                                                                 05060052
050700                         30  ASC-SKU.                             05070052
050800                             35  ASC-DEPT          PIC X(03).     05080052
051000                             35  ASC-CL            PIC X(02).     05100052
051200                             35  ASC-SEQ           PIC 9(08)V     05120052
051300                                                     COMP-3.      05130052
051400*----------------------------------------------------------------*05140052
051500*   CHANGES MADE FOR WR # 230ZZ ENDS HERE.                        05150052
051600*----------------------------------------------------------------*05160052
051700                         30  ASC-SKU-DESC          PIC X(25).     05170052
051800                         30  ASC-ITM-NBR           PIC S9(15)V    05180052
051900                                                       COMP-3.    05190052
052000                         30  ASC-VER-NBR           PIC S9(09)     05200052
052100                                                       COMP.      05210052
052200                         30  ASC-INNER-PACK        PIC ZZZZ9.     05220052
052300                         30  ASC-CASE-PACK         PIC ZZZZ9.     05230052
052400                         30  ASC-OTR               PIC X(5).      05240052
052500                         30  ASC-STATUS-CDE        PIC X(2).      05250052
052600                         30  ASC-FIELDS-TO-BE-PASSED.             05260052
052700                             35  ASC-PURITM-UNT-QTY               05270052
052800                                                   PIC S9(09)     05280052
052900                                                       COMP.      05290052
053000                             35  ASC-PURITM-UNT-RTL-PR-AMT        05300052
053100                                                   PIC S9(06)V99  05310052
053200                                                       COMP-3.    05320052
053300                             35  ASC-PURITM-GP-RTL-AMT            05330052
053400                                                   PIC S9(05)V99  05340052
053500                                                       COMP-3.    05350052
053600                             35  ASC-PURITM-GP-QTY PIC S9(04)     05360052
053700                                                       COMP.      05370052
053800                             35  ASC-XLT-VEND-STYL-NAME           05380058
053900                                                   PIC X(08).     05390052
054000                         30  ASC-LINE-TRBL-SW                     05400052
054100                                        PIC X(01).                05410052
054200                             88  ASC-LINE-IN-TROUBLE  VALUE 'Y'.  05420052
054300                             88  ASC-LINE-DISTRO-TRBL VALUE 'D'.  05430052
054400                                                                  05440052
054500             15  ASC-BLK-SUB            PIC S9(04) COMP SYNC.     05450052
054600             15  ASC-ITEM-SUB           PIC S9(04) COMP SYNC.     05460052
054700             15  ASC-SEL-SUB            PIC S9(04) COMP.          05470052
054800             15  ASC-SEL-ITEM           PIC S9(04) COMP.          05480052
054900             15  ASC-NUMBER-OF-ITEMS-READ                         05490052
055000                                        PIC S9(09) COMP-3.        05500052
055100             15  ASC-NUMBER-OF-SELECTED-ITEMS                     05510052
055200                                        PIC S9(09) COMP-3.        05520052
055300             15  ASC-NUMBER-OF-TS-ITEMS PIC S9(05) COMP-3.        05530052
055400             15  ASC-ITEMS-DISPLAYED    PIC S9(03) COMP-3.        05540052
055500             15  ASC-ITEM-AT-TOP-OF-PANEL                         05550052
055600                                        PIC S9(09) COMP-3.        05560052
055700             15  ASC-ITEM-AT-BOT-OF-PANEL                         05570052
055800                                        PIC S9(09) COMP-3.        05580052
055900             15  ASC-HIGHEST-BLOCK-WRITTEN                        05590052
056000                                        PIC S9(04) COMP SYNC.     05600052
056100             15  ASC-START-OF-SELECTED-RANGE                      05610052
056200                                        PIC S9(09) COMP-3.        05620052
056300             15  ASC-END-OF-SELECTED-RANGE                        05630052
056400                                        PIC S9(09) COMP-3.        05640052
056500             15  ASC-ITEMS-LEFT-INDICATOR                         05650052
056600                                        PIC X(01).                05660052
056700                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05670052
056800                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05680052
056900             15  ASC-TEMP-QUEUE-UPDATE-SW                         05690052
057000                                        PIC X(01).                05700052
057100                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05710052
057200                 88  ASC-UPDATE-TSQ2               VALUE '2'.     05720052
057300                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05730052
057400             15  ASC-LIST-QUEUE-NAME.                             05740052
057500                 20  ASC-LIST-TERM-ID   PIC X(04).                05750052
057600                 20  ASC-LIST-TASK-NUMBER                         05760052
057700                                        PIC S9(05) COMP-3.        05770052
057800                 20  ASC-LIST-SEQ       PIC 9(01).                05780052
057900             15  ASC-SEL-QUEUE-NAME-IN   PIC X(08).               05790052
058000             15  ASC-SEL-QUEUE-NAME-OUT.                          05800052
058100                 20  ASC-SEL-TERM-ID-OUT PIC X(04).               05810052
058200                 20  ASC-SEL-TASK-NUMBER-OUT                      05820052
058300                                         PIC S9(05) COMP-3.       05830052
058400                 20  ASC-SEL-SEQ-OUT     PIC 9(01).               05840052
058500                                                                  05850052
058600             15  ASC-START-ITEM-REQUEST.                          05860052
058700                 20  ASC-START-ITEM-REQUEST-N  PIC 9(07).         05870052
058800             15  ASC-USE-SELECTION-QUEUE-IND   PIC X(01).         05880052
058900                 88  ASC-USE-SELECTION-QUEUE   VALUE 'Y'.         05890052
059000             15  ASC-HOLD-INTER-APPL           PIC X(200).        05900052
059100             15  ASC-INTER-APPL-CODE-IND       PIC X(01).         05910052
059200                 88 ASC-INTER-APPL-PKSL-LIST   VALUE 'P'.         05920052
059300/                                                                 05930052
059400*---------------------------------------------------------------* 05940052
059500*    ABEND PROCESSING COPYBOOK.                                 * 05950052
059600*---------------------------------------------------------------* 05960052
059700                                                                  05970052
059800     COPY DPWS013.                                                05980052
059900                                                                  05990052
060000/                                                                 06000052
060100*---------------------------------------------------------------* 06010052
060200*    OPEN TO RECEIVE COPYBOOK.                                  * 06020052
060300*---------------------------------------------------------------* 06030052
060400                                                                  06040052
060500     COPY PCWS020.                                                06050052
060600/                                                                 06060052
060700*---------------------------------------------------------------* 06070052
060800*    DB2 AREA FOR THE WORK ORDER TABLE                          * 06080052
060900*---------------------------------------------------------------* 06090052
061000     EXEC SQL                                                     06100052
061100          INCLUDE TWRKORD                                         06110052
061200     END-EXEC.                                                    06120052
061300                                                                  06130052
061400/                                                                 06140052
061500*---------------------------------------------------------------* 06150052
061600*    DB2 AREA FOR THE RECEIVER                                  * 06160052
061700*---------------------------------------------------------------* 06170052
061800     EXEC SQL                                                     06180052
061900          INCLUDE TRECEIV                                         06190052
062000     END-EXEC.                                                    06200052
062100                                                                  06210052
062200/                                                                 06220052
062300*---------------------------------------------------------------* 06230052
062400*    DB2 AREA FOR THE PURCHASE ORDER TABLE                      * 06240052
062500*---------------------------------------------------------------* 06250052
062600     EXEC SQL                                                     06260052
062700          INCLUDE TPURCHS                                         06270052
062800     END-EXEC.                                                    06280052
062900                                                                  06290052
065300                                                                  06530052
065400/                                                                 06540052
065500*----------------------------------------------------------------*06550052
065600*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                06560052
065700*----------------------------------------------------------------*06570052
065800     EXEC SQL                                                     06580052
065900          INCLUDE TTRBNTF                                         06590052
066000     END-EXEC.                                                    06600052
066100                                                                  06610052
066200/                                                                 06620052
066300*----------------------------------------------------------------*06630052
066400*    DB2 DCLGEN FOR THE TROUBLE REASON TABLE                      06640052
066500*----------------------------------------------------------------*06650052
066600     EXEC SQL                                                     06660052
066700          INCLUDE TTRBRSN                                         06670052
066800     END-EXEC.                                                    06680052
066900                                                                  06690052
067000/                                                                 06700052
067100*---------------------------------------------------------------* 06710052
067200*    DB2 AREA FOR COMMUNICATIONS                                * 06720052
067300*---------------------------------------------------------------* 06730052
067400     EXEC SQL                                                     06740052
067500          INCLUDE SQLCA                                           06750052
067600     END-EXEC.                                                    06760052
067700                                                                  06770052
067800/                                                                 06780052
067900*---------------------------------------------------------------* 06790052
068000*  CURSOR TO LIST TPURITM                                       * 06800052
068100*---------------------------------------------------------------* 06810052
068200                                                                  06820052
068300     EXEC SQL                                                     06830052
068400          DECLARE TPURITM-CSR CURSOR FOR                          06840052
068500           SELECT A.PO_NBR                                        06850052
068600                 ,A.VER_NBR                                       06860052
068700                 ,A.SKU_SEQ_NBR                                   06870052
068800*                ,A.CL_NBR                                        06880055
068900                 ,A.ITM_NBR                                       06890052
069000*                ,A.SKU_DESC                                      06900057
069100                 ,A.APP_PO_LNE_NBR                                06910052
069200*                ,A.VEND_STYL_NAME                                06920057
069300                 ,A.UNT_QTY                                       06930052
069400                 ,A.UNT_RTL_PR_AMT                                06940052
069500                 ,A.GP_RTL_AMT                                    06950052
069600                 ,A.GP_QTY                                        06960052
069700                 ,A.PO_LNE_NBR                                    06970052
069800                 ,A.STATUS_CDE                                    06980052
069810                 ,A.INNR_PK_QTY                                   06981062
069820                 ,A.OUTR_PK_QTY                                   06982062
069900           FROM   TPURITM A                                       06990052
070000           WHERE  A.PO_NBR         = :DK-ORD-NBR                  07000052
070100             AND  (A.STATUS_CDE    = :DK-STAT-CDE-AP              07010052
070200              OR   A.STATUS_CDE    = :DK-STAT-CDE-CM              07020052
070300              OR   A.STATUS_CDE    = :DK-STAT-CDE-AC              07030052
070400              OR   A.STATUS_CDE    = :DK-STAT-CDE-RV)             07040052
070500             AND  A.VER_STATUS_CDE = 'A'                          07050052
070600             AND  A.APP_PO_LNE_NBR NOT IN                         07060052
070700                  (SELECT B.ORD_LNE_NBR                           07070052
070800                   FROM TRECITM B                                 07080052
070900                   WHERE B.ORD_NBR        = A.PO_NBR              07090052
071000                     AND B.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR      07100052
071100                     AND B.VER_STATUS_CDE = 'A')                  07110052
071200         ORDER BY APP_PO_LNE_NBR                                  07120052
071300     END-EXEC.                                                    07130052
071400                                                                  07140052
071500                                                                  07150052
071600     COPY DPWS276.                                                07160052
071700/                                                                 07170052
071800/                                                                 07180052
071900 LINKAGE SECTION.                                                 07190052
072000                                                                  07200052
072100 01  DFHCOMMAREA.                                                 07210052
072200     05  FILLER                         OCCURS  1 TO 4072 TIMES   07220052
072300                                        DEPENDING ON EIBCALEN.    07230052
072400         10  FILLER                     PIC X.                    07240052
072500                                                                  07250052
072600/                                                                 07260052
072700 PROCEDURE DIVISION.                                              07270052
072800*---------------------------------------------------------------* 07280052
072900*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 07290052
073000*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 07300052
073100*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 07310052
073200*---------------------------------------------------------------* 07320052
073300 0000-MAIN-MODULE.                                                07330052
073400                                                                  07340052
073500     INITIALIZE DP030-CICS-API-FIELDS.                            07350052
073600                                                                  07360052
073700     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07370052
073800     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07380052
073900     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07390052
074000                                                                  07400052
074100     SET DP030-RECEIVE-APPL-MAP                                   07410052
074200         DP030-OVERRIDE-APPL-ERROR TO TRUE.                       07420052
074300                                                                  07430052
074400     MOVE LENGTH OF RC256AI        TO DP030-MAP-LENGTH (1).       07440052
074500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07450052
074600                                                                  07460052
074700     PERFORM 0001-CALL-CICS-ARCH-API.                             07470052
074800     PERFORM 1000-CONTROL-PROCESSING                              07480052
074900                                                                  07490052
075000     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07500052
075100     PERFORM 0001-CALL-CICS-ARCH-API.                             07510052
075200                                                                  07520052
075300*---------------------------------------------------------------* 07530052
075400*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 07540052
075500*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 07550052
075600*---------------------------------------------------------------* 07560052
075700 0001-CALL-CICS-ARCH-API.                                         07570052
075810     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07581064
075900                                    DFHCOMMAREA                   07590064
076000                                    DP030-CICS-API-FIELDS         07600064
076100                                    DP020-STANDARD-COMMAREA       07610064
076200                                    RC256AI.                      07620064
076300                                                                  07630052
076400     IF  DP030-RC-CALL-SUCCESSFUL OR                              07640052
076500         DP030-RC-APPL-ERROR                                      07650052
076600         CONTINUE                                                 07660052
076700     ELSE                                                         07670052
076800         SET DP013-NO-ROLLBACK                                    07680052
076900             DP013-XCTL-DISPLAY-RESTART                           07690052
077000             DP013-CICS-ABEND      TO TRUE                        07700052
077100         MOVE '0001-CALL-CICS-ARCH-API'                           07710052
077200                                   TO DP013-PARAGRAPH             07720052
077220         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O07722064
077230-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07723064
077500         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07750052
077600         PERFORM DP013-0000-PROCESS-ABEND                         07760052
077700     END-IF.                                                      07770052
077800                                                                  07780052
077900*----------------------------------------------------------------*07790052
078000* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *07800052
078100* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *07810052
078200*                                                                *07820052
078300* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *07830052
078400*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *07840052
078500*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *07850052
078600*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *07860052
078700*----------------------------------------------------------------*07870052
078800                                                                  07880052
078900 1000-CONTROL-PROCESSING.                                         07890052
079000                                                                  07900052
079100     EVALUATE TRUE                                                07910052
079200         WHEN DP020-NEXT-ACT-INITIAL                              07920052
079300             INITIALIZE ASC-SPECIFIC-COMMAREA                     07930052
079400             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            07940052
079500                                      ASC-SEL-TERM-ID-OUT         07950052
079600             MOVE DP020-SRC-TASK-NUMBER                           07960052
079700                                   TO ASC-LIST-TASK-NUMBER        07970052
079800                                      ASC-SEL-TASK-NUMBER-OUT     07980052
079900             MOVE PC-LIST-QUEUE-SEQ                               07990052
080000                                   TO ASC-LIST-SEQ                08000052
080100             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT             08010052
080200             PERFORM 1100-PROCESS-INTER-APPL-COMM                 08020052
080300             IF  PS-COMMAREA-NOT-VALID                            08030052
080400                 SET DP020-MSG-FATAL                              08040052
080500                     DP020-NEXT-ACT-APPL-ERROR TO TRUE            08050052
080600             ELSE                                                 08060052
080700                 MOVE INTER-APPL-COMM-AREA                        08070052
080800                                   TO ASC-HOLD-INTER-APPL         08080052
080900                 PERFORM 4000-BUILD-INITIAL-PANEL                 08090052
081000             END-IF                                               08100052
081100                                                                  08110052
081200         WHEN DP020-NEXT-ACT-READ-MAP                             08120052
081300             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08130052
081400                                   TO PV-TOP-ITEM                 08140052
081500             PERFORM 2000-PROCESS-PANEL                           08150052
081600                                                                  08160052
081700         WHEN DP020-NEXT-ACT-RETURN                               08170052
081800              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       08180052
081900                                   TO PV-TOP-ITEM                 08190052
082000              MOVE ZERO            TO ASC-ITEM-AT-TOP-OF-PANEL    08200052
082100              MOVE ASC-HOLD-INTER-APPL                            08210052
082200                                TO INTER-APPL-COMM-AREA           08220052
082300              PERFORM 2050-DELETE-LIST-QUEUE                      08230052
082400              PERFORM 4000-BUILD-INITIAL-PANEL                    08240052
082500                                                                  08250052
082600         WHEN OTHER                                               08260052
082700             SET DP013-LOGIC-ABEND TO TRUE                        08270052
082800             SET DP013-NO-ROLLBACK TO TRUE                        08280052
082900             MOVE '1000-CONTROL-PROCESSING'                       08290052
083000                                   TO DP013-PARAGRAPH             08300052
083100             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    08310052
083200                                   TO DP013-MESSAGE-TEXT(1)       08320052
083300             PERFORM DP013-0000-PROCESS-ABEND                     08330052
083400     END-EVALUATE.                                                08340052
083500                                                                  08350052
083600/                                                                 08360052
083700*----------------------------------------------------------------*08370052
083800* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA               *08380052
083900*----------------------------------------------------------------*08390052
084000                                                                  08400052
084100 1100-PROCESS-INTER-APPL-COMM.                                    08410052
084200                                                                  08420052
084300*----------------------------------------------------------------*08430052
084400* NOTE - IT'S "PC" STANDARD TO DENOTE LIST-TO-LIST ENTRY BY A    *08440052
084500*        '5' IN DP020-INT-APPL-FORMAT-IND.                       *08450052
084600*----------------------------------------------------------------*08460052
084700     SET PS-COMMAREA-VALID          TO TRUE.                      08470052
084800     MOVE SPACE                     TO ASC-START-ITEM-REQUEST.    08480052
084900     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INTER-APPL-CODE-IND.   08490052
085000                                                                  08500052
085100     EVALUATE DP020-INT-APPL-FORMAT-IND                           08510052
085200                                                                  08520052
085300         WHEN PC-INTER-APPL-CRIT-SPEC                             08530052
085400                                                                  08540052
085500**           THIS PROGRAM ASSUMES THAT INTER-APPL FIELDS ARE      08550052
085600**           PROPERLY INITIALIZED...                              08560052
085700             IF  PC000-PO-NBR-N      = ZEROES                     08570052
085800                 MOVE PC-TSYMSG-00736  TO DP020-MSG-NUMBER        08580052
085900                 SET PS-ERROR                                     08590052
086000                     PS-COMMAREA-NOT-VALID                        08600052
086100                     DP020-MSG-FATAL   TO TRUE                    08610052
086200             END-IF                                               08620052
086300             IF  PC000-REC-SEQ-NBR-N = ZEROES                     08630052
086400                 MOVE PC-TSYMSG-00737  TO DP020-MSG-NUMBER        08640052
086500                 SET PS-ERROR                                     08650052
086600                     PS-COMMAREA-NOT-VALID                        08660052
086700                     DP020-MSG-FATAL   TO TRUE                    08670052
086800             END-IF                                               08680052
086900             IF  PS-NO-ERROR                                      08690052
087000                 MOVE PC000-PO-NBR-N          TO                  08700052
087100                      ASC-PO-NBR                                  08710052
087200                      DK-ORD-NBR                                  08720052
087300                 MOVE PC000-REC-SEQ-NBR-N     TO                  08730052
087400                      ASC-REC-SEQ-NBR                             08740052
087500                      DK-RCVR-SEQ-NBR                             08750052
087600                 MOVE PC000-OPERATING-UNIT-ID TO                  08760052
087700                      ASC-OPR-ID                                  08770052
087800                      DK-OPR-ID                                   08780052
087900                 MOVE PC000-FACILITY-ID       TO                  08790052
088000                      ASC-FACT                                    08800052
088100                      DK-FACT                                     08810052
088200             END-IF                                               08820052
088300                                                                  08830052
088400         WHEN PC-INTER-APPL-LIST                                  08840052
088500              SET ASC-USE-SELECTION-QUEUE                         08850052
088600                                   TO TRUE                        08860052
088700              MOVE PC000-NUMBER-OF-SELECTED-ITEMS                 08870052
088800                                   TO ASC-NUMBER-OF-SELECTED-ITEMS08880052
088900              MOVE PC000-NUMBER-OF-TS-ITEMS                       08890052
089000                                   TO ASC-NUMBER-OF-TS-ITEMS      08900052
089100              MOVE PC000-SEL-QUEUE-NAME                           08910052
089200                                   TO ASC-SEL-QUEUE-NAME-IN       08920052
089300              PERFORM 1120-PREPARE-LIST-ENTRY                     08930052
089400                                                                  08940052
089500         WHEN PC-INTER-APPL-PKSL-LIST                             08950052
089600              SET ASC-USE-SELECTION-QUEUE                         08960052
089700                                   TO TRUE                        08970052
089800              MOVE RC015-NUMBER-OF-SELECTED-ITEMS                 08980052
089900                                   TO ASC-NUMBER-OF-SELECTED-ITEMS08990052
090000              MOVE RC015-NUMBER-OF-TS-ITEMS                       09000052
090100                                   TO ASC-NUMBER-OF-TS-ITEMS      09010052
090200              MOVE RC015-SEL-QUEUE-NAME                           09020052
090300                                   TO ASC-SEL-QUEUE-NAME-IN       09030052
090400              PERFORM 1130-PREPARE-PKSL-LIST-ENTRY                09040052
090500                                                                  09050052
090600         WHEN PC-INTER-APPL-PKSL-CRIT                             09060052
090700             IF  RC012-REC-SEQ-NBR = ZEROES                       09070052
090800                 MOVE PC-TSYMSG-00737   TO DP020-MSG-NUMBER       09080052
090900                 SET PS-ERROR                                     09090052
091000                     PS-COMMAREA-NOT-VALID                        09100052
091100                     DP020-MSG-FATAL    TO TRUE                   09110052
091200             ELSE                                                 09120052
091300                 MOVE RC012-PO-NBR      TO ASC-PO-NBR             09130052
091400                                           DK-ORD-NBR             09140052
091500                 MOVE RC012-REC-SEQ-NBR TO ASC-REC-SEQ-NBR        09150052
091600                                           DK-RCVR-SEQ-NBR        09160052
091700                 MOVE RC012-OPER-UNT-ID TO ASC-OPR-ID             09170052
091800                                           DK-OPR-ID              09180052
091900                 MOVE RC012-FCLTY-ID    TO ASC-FACT               09190052
092000                                           DK-FACT                09200052
092100             END-IF                                               09210052
092200                                                                  09220052
092300     END-EVALUATE.                                                09230052
092400                                                                  09240052
092500*----------------------------------------------------------------*09250052
092600*  ENTRY IS FROM A LIST. GET THE KEYS FROM THE TEMP STORAGE      *09260052
092700*  QUEUE PASSED FROM THE LIST.                                   *09270052
092800*----------------------------------------------------------------*09280052
092900                                                                  09290052
093000 1120-PREPARE-LIST-ENTRY.                                         09300052
093100      MOVE PC016-MAX-ITEMS         TO ASC-SEL-SUB.                09310052
093200      MOVE ZERO                    TO ASC-SEL-ITEM.               09320052
093300      PERFORM 2300-GET-NEXT-RECORD.                               09330052
093400                                                                  09340052
093500*----------------------------------------------------------------*09350052
093600*  ENTRY IS FROM PACK SLIP LIST. GET THE KEYS FROM THE TEMP      *09360052
093700*  STORAGE QUEUE PASSED FROM THE LIST.                           *09370052
093800*----------------------------------------------------------------*09380052
093900                                                                  09390052
094000 1130-PREPARE-PKSL-LIST-ENTRY.                                    09400052
094100                                                                  09410052
094200      MOVE RC013-MAX-ITEMS         TO ASC-SEL-SUB.                09420052
094300      MOVE ZERO                    TO ASC-SEL-ITEM.               09430052
094400      PERFORM 2400-GET-NEXT-PKSL-RECORD.                          09440052
094500                                                                  09450052
094600/                                                                 09460052
094700*----------------------------------------------------------------*09470052
094800* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *09480052
094900* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *09490052
095000* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *09500052
095100* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *09510052
095200* FUNCTION KEYS CAN GET THIS FAR.                                *09520052
095300*----------------------------------------------------------------*09530052
095400                                                                  09540052
095500 2000-PROCESS-PANEL.                                              09550052
095600     EVALUATE TRUE                                                09560052
095700         WHEN DP020-SRC-AID = DP016-CLEAR                         09570052
095800             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09580052
095900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09590052
096000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09600052
096100                                                                  09610052
096200         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    09620052
096300             PERFORM 2050-DELETE-LIST-QUEUE                       09630052
096400             PERFORM 4000-BUILD-INITIAL-PANEL                     09640052
096500                                                                  09650052
096600         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   09660052
096700             PERFORM 2140-DESELECT-ALL-ITEMS                      09670052
096800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09680052
096900                                                                  09690052
097000         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 09700052
097100              PERFORM 2150-SELECT-ALL-ITEMS                       09710052
097200              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                09720052
097300                                                                  09730052
097400         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             09740052
097500             IF ASC-USE-SELECTION-QUEUE                           09750052
097600                 PERFORM 6200-DEL-LIST-QUEUE                      09760052
097700                 IF ASC-INTER-APPL-PKSL-LIST                      09770052
097800                     PERFORM 2400-GET-NEXT-PKSL-RECORD            09780052
097900                 ELSE                                             09790052
098000                     PERFORM 2300-GET-NEXT-RECORD                 09800052
098100                 END-IF                                           09810052
098200                 PERFORM 4000-BUILD-INITIAL-PANEL                 09820052
098300                 PERFORM 3200-RESET-ATTRIBUTES                    09830052
098400             ELSE                                                 09840052
098500*                --- BOTTOM OF LIST ---                           09850052
098600                 MOVE PC-TSYMSG-00070                             09860052
098700                                   TO DP020-MSG-NUMBER            09870052
098800                 SET DP020-MSG-INFORMATIONAL                      09880052
098900                                   TO TRUE                        09890052
099000             END-IF                                               09900052
099100                                                                  09910052
099200         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             09920052
099300             IF ASC-USE-SELECTION-QUEUE                           09930052
099400                 PERFORM 6200-DEL-LIST-QUEUE                      09940052
099500                 IF ASC-INTER-APPL-PKSL-LIST                      09950052
099600                     PERFORM 2410-GET-PREV-PKSL-RECORD            09960052
099700                 ELSE                                             09970052
099800                     PERFORM 2310-GET-PREV-RECORD                 09980052
099900                 END-IF                                           09990052
100000                 PERFORM 4000-BUILD-INITIAL-PANEL                 10000052
100100                 PERFORM 3200-RESET-ATTRIBUTES                    10010052
100200             ELSE                                                 10020052
100300*                --- TOP OF LIST ---                              10030052
100400                 MOVE PC-TSYMSG-00069                             10040052
100500                                   TO DP020-MSG-NUMBER            10050052
100600                 SET DP020-MSG-INFORMATIONAL                      10060052
100700                                   TO TRUE                        10070052
100800             END-IF                                               10080052
100900         WHEN OTHER                                               10090052
101000             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 10100052
101100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10110052
101200             IF  PS-NO-ERROR                                      10120052
101300                 SET DP030-CONTINUE-GO TO TRUE                    10130052
101400                 PERFORM 2100-CHECK-FUNCTION-KEY                  10140052
101500             ELSE                                                 10150052
101600                 SET DP030-OVERRIDE-GO TO TRUE                    10160052
101700             END-IF                                               10170052
101800     END-EVALUATE.                                                10180052
101900                                                                  10190052
102000/                                                                 10200052
102100*----------------------------------------------------------------*10210052
102200*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *10220052
102300*----------------------------------------------------------------*10230052
102400 2050-DELETE-LIST-QUEUE.                                          10240052
102500                                                                  10250052
102600     EXEC CICS                                                    10260052
102700         DELETEQ TS                                               10270052
102800           QUEUE (ASC-LIST-QUEUE-NAME)                            10280052
102900            RESP (PV-CICS-RESP)                                   10290052
103000     END-EXEC.                                                    10300052
103100                                                                  10310052
103200     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       10320052
103300        (PV-CICS-RESP = DFHRESP(QIDERR))                          10330052
103400         CONTINUE                                                 10340052
103500     ELSE                                                         10350052
103600         SET DP013-CICS-ABEND      TO TRUE                        10360052
103700         SET DP013-NO-ROLLBACK     TO TRUE                        10370052
103800                                                                  10380052
103900         MOVE '2050-DELETE-LIST-QUEUE'                            10390052
104000                                   TO DP013-PARAGRAPH             10400052
104100         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    10410052
104200                                   TO DP013-MESSAGE-TEXT (1)      10420052
104300         PERFORM DP013-0000-PROCESS-ABEND                         10430052
104400     END-IF.                                                      10440052
104500                                                                  10450052
104600     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  10460052
104700                                                                  10470052
104800/                                                                 10480052
104900*----------------------------------------------------------------*10490052
105000* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*10500052
105100* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *10510052
105200* CICS ARCHITECTURE API.                                         *10520052
105300*----------------------------------------------------------------*10530052
105400 2100-CHECK-FUNCTION-KEY.                                         10540052
105500                                                                  10550052
105600     EVALUATE TRUE                                                10560052
105700         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 10570052
105800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              10580052
105900             IF  ASC-NUMBER-OF-SELECTED-ITEMS = 0                 10590052
106000                 SET DP030-OVERRIDE-GO                            10600052
106100                                   TO TRUE                        10610052
106200                 MOVE PC-TSYMSG-00057                             10620052
106300                                   TO DP020-MSG-NUMBER            10630052
106400                 SET DP020-MSG-WARNING                            10640052
106500                                   TO TRUE                        10650052
106600             ELSE                                                 10660052
106700                 PERFORM 5000-PREPARE-SEL-QUEUE                   10670052
106800                 IF  PC000-NUMBER-OF-SELECTED-ITEMS = 0           10680052
106900                     IF PS-VERIFIED-RECEIVER                      10690052
107000                         SET DP030-OVERRIDE-GO                    10700052
107100                                           TO TRUE                10710052
107200                         MOVE PC-TSYMSG-00883                     10720052
107300                                           TO DP020-MSG-NUMBER    10730052
107400                         SET DP020-MSG-WARNING                    10740052
107500                                           TO TRUE                10750052
107600                     ELSE                                         10760052
107700                         SET DP030-OVERRIDE-GO                    10770052
107800                                           TO TRUE                10780052
107900                         MOVE PC-TSYMSG-00883                     10790052
108000                                           TO DP020-MSG-NUMBER    10800052
108100                         SET DP020-MSG-WARNING                    10810052
108200                                           TO TRUE                10820052
108300                 ELSE                                             10830052
108400                     PERFORM 7000-FORMAT-COMMAREA                 10840052
108500                 END-IF                                           10850052
108600             END-IF                                               10860052
108700                                                                  10870052
108800         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  10880052
108900             MOVE +1               TO PV-TOP-ITEM                 10890052
109000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10900052
109100             PERFORM 3200-RESET-ATTRIBUTES                        10910052
109200                                                                  10920052
109300         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   10930052
109400             PERFORM 2110-BROWSE-BACKWARD                         10940052
109500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10950052
109600             PERFORM 3200-RESET-ATTRIBUTES                        10960052
109700                                                                  10970052
109800         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   10980052
109900             PERFORM 2120-BROWSE-FORWARD                          10990052
110000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11000052
110100             PERFORM 3200-RESET-ATTRIBUTES                        11010052
110200                                                                  11020052
110300         WHEN DP020-SRC-AID = DP016-ENTER                         11030052
110400             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   11040052
110500             IF  PS-ERROR                                         11050052
110600                 CONTINUE                                         11060052
110700             ELSE                                                 11070052
110800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11080052
110900             END-IF                                               11090052
111000                                                                  11100052
111100         WHEN OTHER                                               11110052
111200             PERFORM 2050-DELETE-LIST-QUEUE                       11120052
111300             PERFORM 4000-BUILD-INITIAL-PANEL                     11130052
111400             PERFORM 3200-RESET-ATTRIBUTES                        11140052
111500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11150052
112400     END-EVALUATE.                                                11240052
112500                                                                  11250052
112600/                                                                 11260052
112700*----------------------------------------------------------------*11270052
112800*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *11280052
112900*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *11290052
113000*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *11300052
113100*    MESSAGE.                                                    *11310052
113200*----------------------------------------------------------------*11320052
113300                                                                  11330052
113400 2110-BROWSE-BACKWARD.                                            11340052
113500                                                                  11350052
113600     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    11360052
113700         GIVING PV-TOP-ITEM.                                      11370052
113800                                                                  11380052
113900     IF  ((PV-TOP-ITEM < +1)                                      11390052
114000       OR (PV-TOP-ITEM = +1))                                     11400052
114100         MOVE +1                   TO PV-TOP-ITEM                 11410052
114200*        -- TOP OF LIST --                                        11420052
114300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            11430052
114400         SET DP020-MSG-INFORMATIONAL                              11440052
114500                                   TO TRUE                        11450052
114600     END-IF.                                                      11460052
114700                                                                  11470052
114800/                                                                 11480052
114900*----------------------------------------------------------------*11490052
115000*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *11500052
115100*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *11510052
115200*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *11520052
115300*----------------------------------------------------------------*11530052
115400                                                                  11540052
115500 2120-BROWSE-FORWARD.                                             11550052
115600                                                                  11560052
115700     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              11570052
115800         GIVING PV-TOP-ITEM.                                      11580052
115900                                                                  11590052
116000     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   11600052
116100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            11610052
116200                                   TO PV-TOP-ITEM                 11620052
116300*        -- BOTTOM OF LIST --                                     11630052
116400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            11640052
116500         SET DP020-MSG-INFORMATIONAL                              11650052
116600                                   TO TRUE                        11660052
116700     ELSE                                                         11670052
116800         COMPUTE PV-BOTTOM-ITEM =                                 11680052
116900             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 11690052
117000         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            11700052
117100*            -- BOTTOM OF LIST --                                 11710052
117200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            11720052
117300             SET DP020-MSG-INFORMATIONAL                          11730052
117400                                   TO TRUE                        11740052
117500         END-IF                                                   11750052
117600     END-IF.                                                      11760052
117700                                                                  11770052
117800/                                                                 11780052
117900*----------------------------------------------------------------*11790052
118000*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *11800052
118100*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *11810052
118200*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *11820052
118300*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *11830052
118400*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *11840052
118500*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *11850052
118600*----------------------------------------------------------------*11860052
118700                                                                  11870052
118800 2130-CHECK-FOR-JUMP-BROWSE.                                      11880052
118900                                                                  11890052
119000     SET PS-NO-ERROR               TO TRUE.                       11900052
119100     IF (ASC-START-ITEM-REQUEST = SPACE)                          11910052
119200         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            11920052
119300                                   TO PV-TOP-ITEM                 11930052
119400     ELSE                                                         11940052
119500         MOVE ASC-START-ITEM-REQUEST                              11950052
119600                                   TO DP010I-UNEDITED-FIELD       11960052
119700         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       11970052
119800         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     11980052
119900         SET DP010I-NEGATIVE-NOT-ALLOWED                          11990052
120000                                   TO TRUE                        12000052
120100         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12010064
120110              USING DP010I-NUMERIC-EDIT-AREA                      12011064
120200                                                                  12020052
120300         IF  NOT DP010I-ERROR-DETECTED                            12030052
120400             MOVE DP010I-NUMERIC-FIELD                            12040052
120500                                   TO ASC-START-ITEM-REQUEST-N    12050052
120600             IF  ASC-START-ITEM-REQUEST-N > ZERO                  12060052
120700                 IF  ASC-START-ITEM-REQUEST-N >                   12070052
120800                                          ASC-NUMBER-OF-ITEMS-READ12080052
120900                     MOVE SPACE TO ASC-START-ITEM-REQUEST         12090052
121000                     COMPUTE PV-TOP-ITEM =                        12100052
121100                             ASC-NUMBER-OF-ITEMS-READ             12110052
121200                             - PC-ITEMS-PER-PANEL + 1             12120052
121300                     IF  PV-TOP-ITEM < +1                         12130052
121400                         MOVE +1   TO PV-TOP-ITEM                 12140052
121500                         MOVE PC-TSYMSG-00070                     12150052
121600                                   TO DP020-MSG-NUMBER            12160052
121700                         SET DP020-MSG-INFORMATIONAL              12170052
121800                                   TO TRUE                        12180052
121900                     END-IF                                       12190052
122000                 ELSE                                             12200052
122100                     MOVE ASC-START-ITEM-REQUEST-N                12210052
122200                                   TO PV-TOP-ITEM                 12220052
122300                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      12230052
122400                     COMPUTE PV-BOTTOM-ITEM =                     12240052
122500                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     12250052
122600                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ12260052
122700*                        -- BOTTOM OF LIST --                     12270052
122800                         MOVE PC-TSYMSG-00070                     12280052
122900                                   TO DP020-MSG-NUMBER            12290052
123000                         SET DP020-MSG-INFORMATIONAL              12300052
123100                                   TO TRUE                        12310052
123200                     END-IF                                       12320052
123300                 END-IF                                           12330052
123400             ELSE                                                 12340052
123500*                --- VALUE OUT OF RANGE ----                      12350052
123600                 MOVE PC-TSYMSG-00101                             12360052
123700                                   TO DP020-MSG-NUMBER            12370052
123800                 MOVE -1           TO ASTRTITL                    12380052
123900                 SET DP030-SET-CURSOR-APPL-1                      12390052
124000                                   TO TRUE                        12400052
124100                 MOVE DP015-REVERSE                               12410052
124200                                   TO ASTRTITH                    12420052
124300                 MOVE DP015-RED    TO ASTRTITC                    12430052
124400                 MOVE DP015-UNP-NUM-BRT-MDT                       12440052
124500                                   TO ASTRTITA                    12450052
124600                 SET DP020-MSG-FATAL                              12460052
124700                                   TO TRUE                        12470052
124800                 SET PS-ERROR      TO TRUE                        12480052
124900             END-IF                                               12490052
125000                                                                  12500052
125100         ELSE                                                     12510052
125200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            12520052
125300             MOVE -1               TO ASTRTITL                    12530052
125400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12540052
125500             MOVE DP015-REVERSE    TO ASTRTITH                    12550052
125600             MOVE DP015-RED        TO ASTRTITC                    12560052
125700             MOVE DP015-UNP-NUM-BRT-MDT                           12570052
125800                                   TO ASTRTITA                    12580052
125900             SET DP020-MSG-FATAL   TO TRUE                        12590052
126000             SET PS-ERROR          TO TRUE                        12600052
126100         END-IF                                                   12610052
126200     END-IF.                                                      12620052
126300                                                                  12630052
126400/                                                                 12640052
126500*----------------------------------------------------------------*12650052
126600*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *12660052
126700*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *12670052
126800*----------------------------------------------------------------*12680052
126900 2140-DESELECT-ALL-ITEMS.                                         12690052
127000                                                                  12700052
127100     MOVE +1                       TO ASC-BLK-SUB.                12710052
127200                                                                  12720052
127300     PERFORM 2141-CLEAR-SELECTED-INDS                             12730052
127400         VARYING ASC-ITEM-SUB                                     12740052
127500         FROM 1 BY 1                                              12750052
127600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12760052
127700                                                                  12770052
127800     ADD +1                        TO ASC-BLK-SUB.                12780052
127900                                                                  12790052
128000     PERFORM 2141-CLEAR-SELECTED-INDS                             12800052
128100         VARYING ASC-ITEM-SUB                                     12810052
128200         FROM 1 BY 1                                              12820052
128300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12830052
128400                                                                  12840052
128500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               12850052
128600                                   TO PV-LIST-ITEM-NUMBER.        12860052
128700                                                                  12870052
128800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            12880052
128900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    12890052
129000                                                                  12900052
129100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     12910052
129200        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      12920052
129300         MOVE +1                   TO ASC-BLK-SUB                 12930052
129400                                                                  12940052
129500         PERFORM 5100-WRITE-TEMP-STORAGE                          12950052
129600                                                                  12960052
129700         MOVE +1                   TO PV-BLOCK-NUMBER             12970052
129800                                                                  12980052
129900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         12990052
130000             PV-FIRST-BLOCK-IN-ARRAY - 1                          13000052
130100                                                                  13010052
130200         PERFORM                                                  13020052
130300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       13030052
130400                                                                  13040052
130500             PERFORM 4410-READ-TEMP-STORAGE                       13050052
130600                                                                  13060052
130700             PERFORM 2141-CLEAR-SELECTED-INDS                     13070052
130800                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 13080052
130900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13090052
131000                                                                  13100052
131100             PERFORM 5100-WRITE-TEMP-STORAGE                      13110052
131200                                                                  13120052
131300             ADD +1                TO PV-BLOCK-NUMBER             13130052
131400                                                                  13140052
131500         END-PERFORM                                              13150052
131600                                                                  13160052
131700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13170052
131800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     13180052
131900                                                                  13190052
132000         PERFORM                                                  13200052
132100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       13210052
132200                   ASC-HIGHEST-BLOCK-WRITTEN                      13220052
132300                                                                  13230052
132400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          13240052
132500                                   TO PV-BLOCK-NUMBER             13250052
132600                                                                  13260052
132700             PERFORM 4410-READ-TEMP-STORAGE                       13270052
132800                                                                  13280052
132900             PERFORM 2141-CLEAR-SELECTED-INDS                     13290052
133000                 VARYING ASC-ITEM-SUB                             13300052
133100                 FROM 1 BY 1                                      13310052
133200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13320052
133300                                                                  13330052
133400             PERFORM 5100-WRITE-TEMP-STORAGE                      13340052
133500                                                                  13350052
133600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      13360052
133700                                                                  13370052
133800         END-PERFORM                                              13380052
133900                                                                  13390052
134000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             13400052
134100                                   TO PV-BLOCK-NUMBER             13410052
134200                                                                  13420052
134300         PERFORM 4410-READ-TEMP-STORAGE                           13430052
134400     END-IF.                                                      13440052
134500                                                                  13450052
134600                                                                  13460052
134700     MOVE +0                       TO ASC-NUMBER-OF-SELECTED-ITEMS13470052
134800     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.13480052
134900     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  13490052
135000                                                                  13500052
135100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13510052
135200                                                                  13520052
135300/                                                                 13530052
135400*----------------------------------------------------------------*13540052
135500*    MARK EACH ITEM AS BEING NOT SELECTED.                       *13550052
135600*----------------------------------------------------------------*13560052
135700                                                                  13570052
135800 2141-CLEAR-SELECTED-INDS.                                        13580052
135900                                                                  13590052
136000     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          13600052
136100             NOT EQUAL ZERO                                       13610052
136200         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13620052
136300             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13630052
136400                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    13640052
136500                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  13650052
136600                                   TO TRUE                        13660052
136700         END-IF                                                   13670052
136800     END-IF.                                                      13680052
136900                                                                  13690052
137000/                                                                 13700052
137100*----------------------------------------------------------------*13710052
137200*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *13720052
137300*  FOR ALL ITEMS.                                                *13730052
137400*----------------------------------------------------------------*13740052
137500                                                                  13750052
137600 2150-SELECT-ALL-ITEMS.                                           13760052
137700                                                                  13770052
137800     MOVE +1                       TO ASC-BLK-SUB.                13780052
137900                                                                  13790052
138000     PERFORM 2151-SET-SELECTED-INDS                               13800052
138100         VARYING ASC-ITEM-SUB                                     13810052
138200         FROM 1 BY 1                                              13820052
138300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13830052
138400                                                                  13840052
138500     ADD +1                        TO ASC-BLK-SUB.                13850052
138600                                                                  13860052
138700     PERFORM 2151-SET-SELECTED-INDS                               13870052
138800         VARYING ASC-ITEM-SUB                                     13880052
138900         FROM 1 BY 1                                              13890052
139000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13900052
139100                                                                  13910052
139200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               13920052
139300                                   TO PV-LIST-ITEM-NUMBER.        13930052
139400                                                                  13940052
139500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13950052
139600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    13960052
139700                                                                  13970052
139800     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13980052
139900        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    13990052
140000         MOVE +1                   TO ASC-BLK-SUB                 14000052
140100                                                                  14010052
140200         PERFORM 5100-WRITE-TEMP-STORAGE                          14020052
140300                                                                  14030052
140400         MOVE +1                   TO PV-BLOCK-NUMBER             14040052
140500                                                                  14050052
140600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14060052
140700             PV-FIRST-BLOCK-IN-ARRAY - 1                          14070052
140800                                                                  14080052
140900         PERFORM                                                  14090052
141000             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       14100052
141100                                                                  14110052
141200             PERFORM 4410-READ-TEMP-STORAGE                       14120052
141300                                                                  14130052
141400             PERFORM 2151-SET-SELECTED-INDS                       14140052
141500                 VARYING ASC-ITEM-SUB                             14150052
141600                 FROM 1 BY 1                                      14160052
141700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14170052
141800                                                                  14180052
141900             PERFORM 5100-WRITE-TEMP-STORAGE                      14190052
142000                                                                  14200052
142100             ADD +1                TO PV-BLOCK-NUMBER             14210052
142200         END-PERFORM                                              14220052
142300                                                                  14230052
142400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14240052
142500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14250052
142600                                                                  14260052
142700         PERFORM                                                  14270052
142800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14280052
142900                   ASC-HIGHEST-BLOCK-WRITTEN                      14290052
143000                                                                  14300052
143100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14310052
143200                                   TO PV-BLOCK-NUMBER             14320052
143300                                                                  14330052
143400             PERFORM 4410-READ-TEMP-STORAGE                       14340052
143500                                                                  14350052
143600             PERFORM 2151-SET-SELECTED-INDS                       14360052
143700                 VARYING ASC-ITEM-SUB                             14370052
143800                 FROM 1 BY 1                                      14380052
143900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14390052
144000                                                                  14400052
144100             PERFORM 5100-WRITE-TEMP-STORAGE                      14410052
144200                                                                  14420052
144300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14430052
144400         END-PERFORM                                              14440052
144500                                                                  14450052
144600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14460052
144700                                   TO PV-BLOCK-NUMBER             14470052
144800                                                                  14480052
144900         PERFORM 4410-READ-TEMP-STORAGE                           14490052
145000     END-IF.                                                      14500052
145100                                                                  14510052
145200     COMPUTE ASC-NUMBER-OF-SELECTED-ITEMS =                       14520052
145300             ASC-NUMBER-OF-ITEMS-READ - PV-NUMBER-OF-RV-ITEMS.    14530052
145400                                                                  14540052
145500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14550052
145600                                                                  14560052
145700/                                                                 14570052
145800*----------------------------------------------------------------*14580052
145900*    MARK EACH ITEM AS BEING SELECTED.                           *14590052
146000*----------------------------------------------------------------*14600052
146100                                                                  14610052
146200 2151-SET-SELECTED-INDS.                                          14620052
146300                                                                  14630052
146400     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           14640052
146500             NOT EQUAL ZERO                                       14650052
146600         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14660052
146700             IF  ASC-STATUS-CDE(ASC-BLK-SUB ASC-ITEM-SUB)         14670052
146800                                        NOT = DK-STAT-CDE-RV      14680052
146900                 SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)         14690052
147000                     ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)    14700052
147100                     ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              14710052
147200                                        TO TRUE                   14720052
147300             ELSE                                                 14730052
147400               ADD 1 TO PV-NUMBER-OF-RV-ITEMS                     14740052
147500             END-IF                                               14750052
147600         END-IF                                                   14760052
147700     END-IF.                                                      14770052
147800                                                                  14780052
147900/                                                                 14790052
148000*----------------------------------------------------------------*14800052
148100*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *14810052
148200*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *14820052
148300*----------------------------------------------------------------*14830052
148400 2200-MOVE-SCREEN-TO-COMMAREA.                                    14840052
148500                                                                  14850052
148600     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             14860052
148700     MOVE +1                       TO PV-SUB.                     14870052
148800                                                                  14880052
148900     PERFORM 3100-SET-SUBSCRIPTS.                                 14890052
149000                                                                  14900052
149100     IF  ASTRTITL > ZERO                                          14910052
149200         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      14920052
149300     ELSE                                                         14930052
149400         IF  ASTRTITF = DP015-ERASE-EOF                           14940052
149500             INITIALIZE ASC-START-ITEM-REQUEST                    14950052
149600         END-IF                                                   14960052
149700     END-IF.                                                      14970052
149800                                                                  14980052
149900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          14990052
150000         VARYING PV-SUB                                           15000052
150100         FROM 1 BY 1                                              15010052
150200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      15020052
150300                                                                  15030052
150400/                                                                 15040052
150500*----------------------------------------------------------------*15050052
150600*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *15060052
150700*----------------------------------------------------------------*15070052
150800 2210-MOVE-LINES-TO-COMMAREA.                                     15080052
150900                                                                  15090052
151000     IF  MR-SELECTL (PV-SUB) > ZERO                               15100052
151100         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     15110052
151200                                   TO TRUE                        15120052
151300         MOVE MR-SELECT (PV-SUB)   TO ASC-TEMP-SELECTED-SW        15130052
151400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      15140052
151500     ELSE                                                         15150052
151600         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                15160052
151700             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         15170052
151800             MOVE SPACE            TO ASC-TEMP-SELECTED-SW        15180052
151900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      15190052
152000         END-IF                                                   15200052
152100     END-IF.                                                      15210052
152200                                                                  15220052
152300     ADD +1                        TO ASC-ITEM-SUB.               15230052
152400                                                                  15240052
152500     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        15250052
152600         ADD +1                    TO ASC-BLK-SUB                 15260052
152700         MOVE +1                   TO ASC-ITEM-SUB                15270052
152800     END-IF.                                                      15280052
152900                                                                  15290052
153000/                                                                 15300052
153100******************************************************************15310052
153200* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *15320052
153300* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *15330052
153400******************************************************************15340052
153500 2300-GET-NEXT-RECORD.                                            15350052
153600                                                                  15360052
153700     ADD +1                        TO ASC-SEL-SUB.                15370052
153800     IF ASC-SEL-SUB > PC016-MAX-ITEMS                             15380052
153900         ADD +1                    TO ASC-SEL-ITEM                15390052
154000         MOVE +1                   TO ASC-SEL-SUB                 15400052
154100     END-IF.                                                      15410052
154200     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 15420052
154300         PERFORM 9100-READ-SEL-QUEUE                              15430052
154400         IF PC016-ITEM (ASC-SEL-SUB) > ZERO                       15440052
154500             INITIALIZE ASC-LIST-KEYS                             15450052
154600             MOVE PC016-PO-NBR-N(ASC-SEL-SUB)      TO ASC-PO-NBR  15460052
154700                                                      DK-ORD-NBR  15470052
154800             MOVE PC016-REC-SEQ-NBR-N(ASC-SEL-SUB) TO             15480052
154900                  ASC-REC-SEQ-NBR                                 15490052
155000                  DK-RCVR-SEQ-NBR                                 15500052
155100             MOVE PC016-OPER-UNT-ID  (ASC-SEL-SUB) TO             15510052
155200                  ASC-OPR-ID                                      15520052
155300                  DK-OPR-ID                                       15530052
155400             MOVE PC016-FCLTY-ID     (ASC-SEL-SUB) TO             15540052
155500                  ASC-FACT                                        15550052
155600                  DK-FACT                                         15560052
155700             SET PC016-INQ (ASC-SEL-SUB)           TO TRUE        15570052
155800             PERFORM 9200-REWRITE-LIST-QUEUE                      15580052
155900         ELSE                                                     15590052
156000             SUBTRACT +1 FROM ASC-SEL-SUB                         15600052
156100*            --- BOTTOM OF LIST ---                               15610052
156200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            15620052
156300             SET DP020-MSG-INFORMATIONAL                          15630052
156400                                   TO TRUE                        15640052
156500         END-IF                                                   15650052
156600     ELSE                                                         15660052
156700         SUBTRACT +1 FROM ASC-SEL-ITEM                            15670052
156800         MOVE PC016-MAX-ITEMS      TO ASC-SEL-SUB                 15680052
156900         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            15690052
157000         SET DP020-MSG-INFORMATIONAL                              15700052
157100                                   TO TRUE                        15710052
157200     END-IF.                                                      15720052
157300                                                                  15730052
157400/                                                                 15740052
157500******************************************************************15750052
157600* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *15760052
157700* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *15770052
157800******************************************************************15780052
157900 2310-GET-PREV-RECORD.                                            15790052
158000                                                                  15800052
158100     SUBTRACT +1 FROM ASC-SEL-SUB.                                15810052
158200     IF ASC-SEL-SUB < +1                                          15820052
158300         SUBTRACT +1 FROM ASC-SEL-ITEM                            15830052
158400         MOVE PC016-MAX-ITEMS      TO ASC-SEL-SUB                 15840052
158500     END-IF.                                                      15850052
158600                                                                  15860052
158700     IF ASC-SEL-ITEM > ZERO                                       15870052
158800         PERFORM 9100-READ-SEL-QUEUE                              15880052
158900         INITIALIZE ASC-LIST-KEYS                                 15890052
159000         MOVE PC016-PO-NBR-N(ASC-SEL-SUB)      TO ASC-PO-NBR      15900052
159100         MOVE PC016-REC-SEQ-NBR-N(ASC-SEL-SUB) TO                 15910052
159200              ASC-REC-SEQ-NBR                                     15920052
159300         MOVE PC016-OPER-UNT-ID  (ASC-SEL-SUB) TO ASC-OPR-ID      15930052
159400                                                  DK-OPR-ID       15940052
159500         MOVE PC016-FCLTY-ID     (ASC-SEL-SUB) TO ASC-FACT        15950052
159600                                                  DK-FACT         15960052
159700     ELSE                                                         15970052
159800         MOVE +1                   TO ASC-SEL-ITEM                15980052
159900                                      ASC-SEL-SUB                 15990052
160000*        --- TOP OF LIST ---                                      16000052
160100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            16010052
160200         SET DP020-MSG-INFORMATIONAL                              16020052
160300                                   TO TRUE                        16030052
160400     END-IF.                                                      16040052
160500                                                                  16050052
160600/                                                                 16060052
160700******************************************************************16070052
160800* GET THE KEYS OF THE NEXT SELECTED PACKSLIP OBJECT FROM THE     *16080052
160900* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *16090052
161000******************************************************************16100052
161100 2400-GET-NEXT-PKSL-RECORD.                                       16110052
161200                                                                  16120052
161300     ADD +1                        TO ASC-SEL-SUB.                16130052
161400     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             16140052
161500         ADD +1                    TO ASC-SEL-ITEM                16150052
161600         MOVE +1                   TO ASC-SEL-SUB                 16160052
161700     END-IF.                                                      16170052
161800     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 16180052
161900         PERFORM 9300-READ-PKSL-SEL-QUEUE                         16190052
162000         IF RC013-ITEM (ASC-SEL-SUB) > ZERO                       16200052
162100             INITIALIZE ASC-LIST-KEYS                             16210052
162200             MOVE RC015-PO-NBR                     TO ASC-PO-NBR  16220052
162300                                                      DK-ORD-NBR  16230052
162400             MOVE RC013-REC-SEQ-NBR  (ASC-SEL-SUB) TO             16240052
162500                  ASC-REC-SEQ-NBR                                 16250052
162600                  DK-RCVR-SEQ-NBR                                 16260052
162700             MOVE RC015-OPER-UNT-ID                TO             16270052
162800                  ASC-OPR-ID                                      16280052
162900                  DK-OPR-ID                                       16290052
163000             MOVE RC015-FCLTY-ID                   TO             16300052
163100                  ASC-FACT                                        16310052
163200                  DK-FACT                                         16320052
163300             SET RC013-INQ (ASC-SEL-SUB)           TO TRUE        16330052
163400             PERFORM 9400-REWRITE-PKSL-LIST-QUEUE                 16340052
163500         ELSE                                                     16350052
163600             SUBTRACT +1 FROM ASC-SEL-SUB                         16360052
163700*            --- BOTTOM OF LIST ---                               16370052
163800             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            16380052
163900             SET DP020-MSG-INFORMATIONAL                          16390052
164000                                   TO TRUE                        16400052
164100         END-IF                                                   16410052
164200     ELSE                                                         16420052
164300         SUBTRACT +1 FROM ASC-SEL-ITEM                            16430052
164400         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 16440052
164500         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            16450052
164600         SET DP020-MSG-INFORMATIONAL                              16460052
164700                                   TO TRUE                        16470052
164800     END-IF.                                                      16480052
164900                                                                  16490052
165000/                                                                 16500052
165100******************************************************************16510052
165200* GET THE KEYS OF THE PREVIOUS SELECTED PACK SLIP OBJECT FROM THE*16520052
165300* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *16530052
165400******************************************************************16540052
165500 2410-GET-PREV-PKSL-RECORD.                                       16550052
165600                                                                  16560052
165700     SUBTRACT +1 FROM ASC-SEL-SUB.                                16570052
165800     IF ASC-SEL-SUB < +1                                          16580052
165900         SUBTRACT +1 FROM ASC-SEL-ITEM                            16590052
166000         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 16600052
166100     END-IF.                                                      16610052
166200                                                                  16620052
166300     IF ASC-SEL-ITEM > ZERO                                       16630052
166400         PERFORM 9300-READ-PKSL-SEL-QUEUE                         16640052
166500         INITIALIZE ASC-LIST-KEYS                                 16650052
166600         MOVE RC015-PO-NBR                     TO ASC-PO-NBR      16660052
166700         MOVE RC013-REC-SEQ-NBR  (ASC-SEL-SUB) TO                 16670052
166800              ASC-REC-SEQ-NBR                                     16680052
166900         MOVE RC015-OPER-UNT-ID                TO ASC-OPR-ID      16690052
167000                                                  DK-OPR-ID       16700052
167100         MOVE RC015-FCLTY-ID                   TO ASC-FACT        16710052
167200                                                  DK-FACT         16720052
167300     ELSE                                                         16730052
167400         MOVE +1                   TO ASC-SEL-ITEM                16740052
167500                                      ASC-SEL-SUB                 16750052
167600*        --- TOP OF LIST ---                                      16760052
167700         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            16770052
167800         SET DP020-MSG-INFORMATIONAL                              16780052
167900                                   TO TRUE                        16790052
168000     END-IF.                                                      16800052
168100                                                                  16810052
168200/                                                                 16820052
168300*----------------------------------------------------------------*16830052
168400*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *16840052
168500*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *16850052
168600*----------------------------------------------------------------*16860052
168700 3000-EDIT-DATA-IN-COMMAREA.                                      16870052
168800                                                                  16880052
168900     SET PS-NO-ERROR               TO TRUE.                       16890052
169000                                                                  16900052
169100     PERFORM 3200-RESET-ATTRIBUTES.                               16910052
169200                                                                  16920052
169300     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     16930052
169400**                                                                16940052
169500* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              16950052
169600* EDITTING IS DONE FROM THE BOTTOM UP.                            16960052
169700**                                                                16970052
169800     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       16980052
169900         ASC-ITEMS-DISPLAYED - 1.                                 16990052
170000                                                                  17000052
170100     PERFORM 3100-SET-SUBSCRIPTS.                                 17010052
170200     PERFORM 3300-EDIT-SELECTIONS                                 17020052
170300         VARYING PV-SUB                                           17030052
170400         FROM PV-SUB BY -1                                        17040052
170500         UNTIL PV-SUB < +1.                                       17050052
170600                                                                  17060052
170700/                                                                 17070052
170800*----------------------------------------------------------------*17080052
170900*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *17090052
171000*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*17100052
171100*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *17110052
171200*                                                                *17120052
171300*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *17130052
171400*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *17140052
171500*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *17150052
171600*    US IN THE 2ND BLOCK OF THE ARRAY.                           *17160052
171700*----------------------------------------------------------------*17170052
171800                                                                  17180052
171900 3100-SET-SUBSCRIPTS.                                             17190052
172000                                                                  17200052
172100     COMPUTE ASC-ITEM-SUB =                                       17210052
172200         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        17220052
172300                                                                  17230052
172400     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         17240052
172500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            17250052
172600                                                                  17260052
172700         MOVE PC-MAX-BLOCKS-IN-ARRAY                              17270052
172800                                   TO ASC-BLK-SUB                 17280052
172900     ELSE                                                         17290052
173000         MOVE +1                   TO ASC-BLK-SUB                 17300052
173100     END-IF.                                                      17310052
173200                                                                  17320052
173300*----------------------------------------------------------------*17330052
173400*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *17340052
173500*----------------------------------------------------------------*17350052
173600                                                                  17360052
173700 3200-RESET-ATTRIBUTES.                                           17370052
173800                                                                  17380052
173900     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   17390052
174000     MOVE DP015-GREEN              TO ASTRTITC.                   17400052
174100     MOVE DP015-UNDERLINE          TO ASTRTITH.                   17410052
174200                                                                  17420052
174300     IF DP020-NEXT-ACT-RETURN                                     17430052
174400     OR DP020-NEXT-ACT-READ-MAP                                   17440052
174500        PERFORM                                                   17450052
174600            VARYING PV-SUB                                        17460052
174700            FROM 1 BY 1                                           17470052
174800            UNTIL PV-SUB > ASC-ITEMS-DISPLAYED                    17480052
174900            MOVE DP015-UNP-ALP-NOR-OFF                            17490052
175000                                      TO MR-SELECTA (PV-SUB)      17500052
175100            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      17510052
175200            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      17520052
175300        END-PERFORM                                               17530052
175400     ELSE                                                         17540052
175500        PERFORM                                                   17550052
175600            VARYING PV-SUB                                        17560052
175700            FROM 1 BY 1                                           17570052
175800            UNTIL PV-SUB > PC-ITEMS-PER-PANEL                     17580052
175900            MOVE DP015-UNP-ALP-NOR-OFF                            17590052
176000                                      TO MR-SELECTA (PV-SUB)      17600052
176100            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      17610052
176200            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      17620052
176300        END-PERFORM                                               17630052
176400     END-IF.                                                      17640052
176500                                                                  17650052
176600/                                                                 17660052
176700*----------------------------------------------------------------*17670052
176800*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *17680052
176900*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *17690052
177000*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *17700052
177100*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *17710052
177200*----------------------------------------------------------------*17720052
177300 3300-EDIT-SELECTIONS.                                            17730052
177400                                                                  17740052
177500     EVALUATE TRUE                                                17750052
177600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     17760052
177700             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         17770052
177800                 CONTINUE                                         17780052
177900                                                                  17790052
178000         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         17800052
178100             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        17810052
178200                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS17820052
178300                 MOVE ASC-TEMP-SELECTED-SW                        17830052
178400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   17840052
178500                                   TO ASC-SELECTED-SW             17850052
178600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   17860052
178700             END-IF                                               17870052
178800                                                                  17880052
178900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     17890052
179000                 = SPACE                                          17900052
179100             EVALUATE TRUE                                        17910052
179200                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       17920052
179300                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS17930052
179400                     MOVE SPACE    TO ASC-SELECTED-SW             17940052
179500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   17950052
179600                                                                  17960052
179700                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        17970052
179800                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE 17980052
179900                     MOVE SPACE    TO ASC-SELECTED-SW             17990052
180000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18000052
180100                                                                  18010052
180200                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          18020052
180300                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   18030052
180400                     MOVE SPACE    TO ASC-SELECTED-SW             18040052
180500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18050052
180600             END-EVALUATE                                         18060052
180700                                                                  18070052
180800         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           18080052
180900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18090052
181000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18100052
181100             END-IF                                               18110052
181200             PERFORM 3310-EDIT-RANGE                              18120052
181300                                                                  18130052
181400         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             18140052
181500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18150052
181600                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18160052
181700             END-IF                                               18170052
181800             PERFORM 3310-EDIT-RANGE                              18180052
181900                                                                  18190052
182000         WHEN OTHER                                               18200052
182100             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            18210052
182200             SET DP020-MSG-FATAL   TO TRUE                        18220052
182300             MOVE -1               TO MR-SELECTL (PV-SUB)         18230052
182400             SET DP030-SET-CURSOR-APPL-1                          18240052
182500                                   TO TRUE                        18250052
182600             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         18260052
182700             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         18270052
182800             SET PS-ERROR          TO TRUE                        18280052
182900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18290052
183000                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     18300052
183100                 MOVE SPACE        TO ASC-SELECTED-SW             18310052
183200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18320052
183300             END-IF                                               18330052
183400     END-EVALUATE.                                                18340052
183500                                                                  18350052
183600     SUBTRACT +1 FROM PV-ITEM-IN-USE.                             18360052
183700     SUBTRACT +1 FROM ASC-ITEM-SUB.                               18370052
183800                                                                  18380052
183900     IF  ASC-ITEM-SUB < 1                                         18390052
184000         SUBTRACT +1 FROM ASC-BLK-SUB                             18400052
184100         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                18410052
184200     END-IF.                                                      18420052
184300                                                                  18430052
184400*----------------------------------------------------------------*18440052
184500*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *18450052
184600*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *18460052
184700*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *18470052
184800*  THE ENDING.                                                   *18480052
184900*----------------------------------------------------------------*18490052
185000 3310-EDIT-RANGE.                                                 18500052
185100                                                                  18510052
185200     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                18520052
185300         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   18530052
185400             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)18540052
185500                                   TO ASC-SELECTED-SW             18550052
185600                                        (ASC-BLK-SUB ASC-ITEM-SUB)18560052
185700             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 18570052
185800         ELSE                                                     18580052
185900             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     18590052
186000                 CONTINUE                                         18600052
186100             ELSE                                                 18610052
186200*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        18620052
186300                 MOVE PC-TSYMSG-00054                             18630052
186400                                   TO DP020-MSG-NUMBER            18640052
186500                 SET DP020-MSG-FATAL                              18650052
186600                                   TO TRUE                        18660052
186700                 MOVE -1           TO MR-SELECTL (PV-SUB)         18670052
186800                 SET DP030-SET-CURSOR-APPL-1                      18680052
186900                                   TO TRUE                        18690052
187000                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         18700052
187100                 MOVE DP015-UNDERLINE                             18710052
187200                                   TO MR-SELECTH (PV-SUB)         18720052
187300                 SET PS-ERROR      TO TRUE                        18730052
187400             END-IF                                               18740052
187500         END-IF                                                   18750052
187600     ELSE                                                         18760052
187700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     18770052
187800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 18780052
187900                                   TO ASC-SELECTED-SW             18790052
188000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18800052
188100             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   18810052
188200         ELSE                                                     18820052
188300             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       18830052
188400                 CONTINUE                                         18840052
188500             ELSE                                                 18850052
188600*                -- ONLY ONE END-OF-RANGE ALLOWED --              18860052
188700                 MOVE PC-TSYMSG-00055                             18870052
188800                                   TO DP020-MSG-NUMBER            18880052
188900                 SET DP020-MSG-FATAL                              18890052
189000                                   TO TRUE                        18900052
189100                 MOVE -1           TO MR-SELECTL (PV-SUB)         18910052
189200                 SET DP030-SET-CURSOR-APPL-1                      18920052
189300                                   TO TRUE                        18930052
189400                 SET PS-ERROR      TO TRUE                        18940052
189500             END-IF                                               18950052
189600         END-IF                                                   18960052
189700     END-IF.                                                      18970052
189800                                                                  18980052
189900*----------------------------------------------------------------*18990052
190000*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *19000052
190100*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *19010052
190200*----------------------------------------------------------------*19020052
190300 3400-CHECK-RANGE-SEQUENCE.                                       19030052
190400                                                                  19040052
190500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       19050052
190600       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      19060052
190700       AND  ASC-START-OF-SELECTED-RANGE >                         19070052
190800                                         ASC-END-OF-SELECTED-RANGE19080052
190900*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                19090052
191000         MOVE PC-TSYMSG-00052      TO DP020-MSG-NUMBER            19100052
191100         SET DP020-MSG-FATAL       TO TRUE                        19110052
191200         SET PS-ERROR              TO TRUE                        19120052
191300         PERFORM 3410-POSITION-AT-ERROR                           19130052
191400     END-IF.                                                      19140052
191500                                                                  19150052
191600*----------------------------------------------------------------*19160052
191700*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *19170052
191800*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *19180052
191900*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *19190052
192000*----------------------------------------------------------------*19200052
192100 3410-POSITION-AT-ERROR.                                          19210052
192200                                                                  19220052
192300     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       19230052
192400                                                                  19240052
192500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 19250052
192600                    - PV-TOP-ITEM + 1.                            19260052
192700                                                                  19270052
192800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      19280052
192900         CONTINUE                                                 19290052
193000     ELSE                                                         19300052
193100         MOVE -1                   TO MR-SELECTL (PV-SUB)         19310052
193200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         19320052
193300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         19330052
193400     END-IF.                                                      19340052
193500                                                                  19350052
193600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   19360052
193700                    - PV-TOP-ITEM + 1.                            19370052
193800                                                                  19380052
193900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      19390052
194000         CONTINUE                                                 19400052
194100     ELSE                                                         19410052
194200         MOVE -1                   TO MR-SELECTL (PV-SUB)         19420052
194300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         19430052
194400         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         19440052
194500     END-IF.                                                      19450052
194600                                                                  19460052
194700/                                                                 19470052
194800*----------------------------------------------------------------*19480052
194900*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *19490052
195000*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *19500052
195100*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *19510052
195200*----------------------------------------------------------------*19520052
195300                                                                  19530052
195400 3500-MARK-RANGE-AS-SELECTED.                                     19540052
195500                                                                  19550052
195600     MOVE +1                       TO ASC-BLK-SUB.                19560052
195700                                                                  19570052
195800     PERFORM 3510-MARK-SELECTED-INDS                              19580052
195900         VARYING ASC-ITEM-SUB                                     19590052
196000         FROM 1 BY 1                                              19600052
196100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19610052
196200                                                                  19620052
196300     ADD +1                        TO ASC-BLK-SUB.                19630052
196400                                                                  19640052
196500     PERFORM 3510-MARK-SELECTED-INDS                              19650052
196600         VARYING ASC-ITEM-SUB                                     19660052
196700         FROM 1 BY 1                                              19670052
196800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19680052
196900                                                                  19690052
197000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               19700052
197100                                   TO PV-LIST-ITEM-NUMBER.        19710052
197200                                                                  19720052
197300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            19730052
197400         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         19740052
197500               PC-ITEMS-PER-PANEL).                               19750052
197600                                                                  19760052
197700     MOVE ASC-START-OF-SELECTED-RANGE                             19770052
197800                                   TO PV-START-OF-SELECTED-RANGE. 19780052
197900                                                                  19790052
198000     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            19800052
198100         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  19810052
198200               PC-ITEMS-PER-PANEL).                               19820052
198300                                                                  19830052
198400     MOVE ASC-END-OF-SELECTED-RANGE                               19840052
198500                                   TO PV-END-OF-SELECTED-RANGE.   19850052
198600                                                                  19860052
198700     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             19870052
198800         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    19880052
198900               PC-ITEMS-PER-PANEL).                               19890052
199000                                                                  19900052
199100     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             19910052
199200         PV-FIRST-BLOCK-IN-ARRAY + 1.                             19920052
199300                                                                  19930052
199400     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    19940052
199500        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        19950052
199600         MOVE +1                   TO ASC-BLK-SUB                 19960052
199700         PERFORM 5100-WRITE-TEMP-STORAGE                          19970052
199800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         19980052
199900             PV-FIRST-BLOCK-IN-ARRAY - 1                          19990052
200000                                                                  20000052
200100         PERFORM                                                  20010052
200200             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      20020052
200300                   PV-PREV-BLOCK-IN-ARRAY                         20030052
200400             MOVE PV-FIRST-BLOCK-IN-RANGE                         20040052
200500                                   TO PV-BLOCK-NUMBER             20050052
200600             PERFORM 4410-READ-TEMP-STORAGE                       20060052
200700             PERFORM 3510-MARK-SELECTED-INDS                      20070052
200800                 VARYING ASC-ITEM-SUB                             20080052
200900                 FROM 1 BY 1                                      20090052
201000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20100052
201100             PERFORM 5100-WRITE-TEMP-STORAGE                      20110052
201200             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     20120052
201300         END-PERFORM                                              20130052
201400                                                                  20140052
201500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         20150052
201600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     20160052
201700         PERFORM                                                  20170052
201800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       20180052
201900                   PV-LAST-BLOCK-IN-RANGE                         20190052
202000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          20200052
202100                                   TO PV-BLOCK-NUMBER             20210052
202200             PERFORM 4410-READ-TEMP-STORAGE                       20220052
202300             PERFORM 3510-MARK-SELECTED-INDS                      20230052
202400                 VARYING ASC-ITEM-SUB                             20240052
202500                 FROM 1 BY 1                                      20250052
202600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20260052
202700             PERFORM 5100-WRITE-TEMP-STORAGE                      20270052
202800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      20280052
202900         END-PERFORM                                              20290052
203000                                                                  20300052
203100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             20310052
203200                                   TO PV-BLOCK-NUMBER             20320052
203300         PERFORM 4410-READ-TEMP-STORAGE                           20330052
203400     END-IF.                                                      20340052
203500                                                                  20350052
203600     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 20360052
203700                                      ASC-END-OF-SELECTED-RANGE.  20370052
203800                                                                  20380052
203900/                                                                 20390052
204000*----------------------------------------------------------------*20400052
204100* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *20410052
204200*----------------------------------------------------------------*20420052
204300                                                                  20430052
204400 3510-MARK-SELECTED-INDS.                                         20440052
204500                                                                  20450052
204600     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         20460052
204700         ASC-START-OF-SELECTED-RANGE)                             20470052
204800     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         20480052
204900         ASC-START-OF-SELECTED-RANGE)                             20490052
205000                                                                  20500052
205100         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     20510052
205200             ASC-END-OF-SELECTED-RANGE)                           20520052
205300         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     20530052
205400             ASC-END-OF-SELECTED-RANGE)                           20540052
205500                                                                  20550052
205600             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          20560052
205700                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   20570052
205800                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   20580052
205900                                   TO TRUE                        20590052
206000                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              20600052
206100                                   TO TRUE                        20610052
206200                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS20620052
206300             END-IF                                               20630052
206400         END-IF                                                   20640052
206500     END-IF.                                                      20650052
206600                                                                  20660052
206700/                                                                 20670052
206800*----------------------------------------------------------------*20680052
206900*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *20690052
207000*    INITIALIZE ALL COUNTERS AND FLAGS.                          *20700052
207100*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *20710052
207200*    DISPLAY THE PANEL TO USER.                                  *20720052
207300*----------------------------------------------------------------*20730052
207400                                                                  20740052
207500 4000-BUILD-INITIAL-PANEL.                                        20750052
207600                                                                  20760052
207700     INITIALIZE ASC-BLOCK-ENTRIES (1)                             20770052
207800                ASC-BLOCK-ENTRIES (2).                            20780052
207900                                                                  20790052
208000     MOVE +1                       TO ASC-BLK-SUB.                20800052
208100                                                                  20810052
208200     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       20820052
208300                                                                  20830052
208400     MOVE +0                       TO ASC-ITEM-SUB                20840052
208500                                      ASC-NUMBER-OF-ITEMS-READ    20850052
208600                                      ASC-NUMBER-OF-SELECTED-ITEMS20860052
208700                                      ASC-HIGHEST-BLOCK-WRITTEN   20870052
208800                                      ASC-START-OF-SELECTED-RANGE 20880052
208900                                      ASC-END-OF-SELECTED-RANGE   20890052
209000                                      ASC-ITEM-AT-TOP-OF-PANEL.   20900052
209100     PERFORM 4100-PREPARE-CURSOR.                                 20910052
209200     PERFORM 4355-GET-TRECEIV-INFO.                               20920052
209300     EVALUATE TRUE                                                20930052
209400         WHEN SQLCODE = +100                                      20940052
209500              CONTINUE                                            20950052
209600         WHEN SQLCODE = +0                                        20960052
209700              PERFORM 4360-GET-TPURCHS-INFO                       20970052
209800              EVALUATE TRUE                                       20980052
209900                  WHEN SQLCODE = +100                             20990052
210000                       CONTINUE                                   21000052
210100                  WHEN SQLCODE = +0                               21010052
210200                       MOVE RECEIV-STATUS-CDE                     21020052
210300                               TO ASC-STAT                        21030052
210400                       MOVE RECEIV-EXPTED-CART-CNT                21040052
210500                               TO ASC-TRECEIV-EXPTED-CART-CNT     21050052
210600                       MOVE RECEIV-ACTL-CART-CNT                  21060052
210700                               TO ASC-TRECEIV-ACTL-CART-CNT       21070052
210800                       PERFORM 4100-PREPARE-CURSOR                21080052
210900                       PERFORM 4200-CALC-OPEN-TO-REC              21090052
211000                       PERFORM 4010-OPEN-CURSOR                   21100052
211100                       PERFORM 4300-READ-ITEMS-FROM-DB            21110052
211200                       PERFORM 4020-CLOSE-CURSOR                  21120052
211300              END-EVALUATE                                        21130052
211400     END-EVALUATE.                                                21140052
211500                                                                  21150052
211600     MOVE +1                       TO PV-TOP-ITEM.                21160052
211700                                                                  21170052
211800     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          21180052
211900         SET DP020-NEXT-ACT-APPL-ERROR                            21190052
212000                                   TO TRUE                        21200052
212100         SET DP020-MSG-FATAL       TO TRUE                        21210052
212200         MOVE PC-TSYMSG-00050      TO DP020-MSG-NUMBER            21220052
212300     ELSE                                                         21230052
212400         MOVE -1                   TO MR-SELECTL (1)              21240052
212500         SET DP030-SET-CURSOR-APPL-1                              21250052
212600                                   TO TRUE                        21260052
212700         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     21270052
212800     END-IF.                                                      21280052
212900                                                                  21290052
213000/                                                                 21300052
213100*----------------------------------------------------------------*21310052
213200* OPEN THE SHIPMENT CURSOR                                       *21320052
213300*----------------------------------------------------------------*21330052
213400                                                                  21340052
213500 4010-OPEN-CURSOR.                                                21350052
213600                                                                  21360052
213700                                                                  21370052
213800         EXEC SQL                                                 21380052
213900             OPEN TPURITM-CSR                                     21390052
214000         END-EXEC                                                 21400052
214100                                                                  21410052
214200                                                                  21420052
214300         EVALUATE TRUE                                            21430052
214400             WHEN SQLCODE = +0                                    21440052
214500                  CONTINUE                                        21450052
214600             WHEN SQLCODE = -904                                  21460052
214700             WHEN SQLCODE = -911                                  21470052
214800             WHEN SQLCODE = -913                                  21480052
214900                  PERFORM 9900-SOFT-ABORT                         21490052
215000             WHEN SQLWARN0 NOT = SPACE                            21500052
215100             WHEN SQLCODE  NOT = +0                               21510052
215200                  MOVE '4010-OPEN-CURSOR'                         21520052
215300                                   TO DP013-PARAGRAPH             21530052
215400                  MOVE 'OPEN CURSOR'                              21540052
215500                                   TO DP013-MESSAGE-TEXT (1)      21550052
215600                  MOVE SQLCA       TO DP013-SQLCA                 21560052
215700                  MOVE 'TPURITM'   TO DP013-DB2-TABLE-NAME (1)    21570052
215800                  SET DP013-DB2-ABEND                             21580052
215900                                   TO TRUE                        21590052
216000                  PERFORM DP013-0000-PROCESS-ABEND                21600052
216100         END-EVALUATE.                                            21610052
216200/                                                                 21620052
216300*----------------------------------------------------------------*21630052
216400* CLOSE THE SHIPMENT CURSOR                                      *21640052
216500*----------------------------------------------------------------*21650052
216600                                                                  21660052
216700 4020-CLOSE-CURSOR.                                               21670052
216800                                                                  21680052
216900     EXEC SQL                                                     21690052
217000          CLOSE TPURITM-CSR                                       21700052
217100     END-EXEC.                                                    21710052
217200                                                                  21720052
217300     EVALUATE TRUE                                                21730052
217400         WHEN SQLCODE = +0                                        21740052
217500              CONTINUE                                            21750052
217600         WHEN SQLCODE = -904                                      21760052
217700         WHEN SQLCODE = -911                                      21770052
217800         WHEN SQLCODE = -913                                      21780052
217900              PERFORM 9900-SOFT-ABORT                             21790052
218000         WHEN SQLWARN0 NOT = SPACE                                21800052
218100         WHEN SQLCODE  NOT = +0                                   21810052
218200              MOVE '4020-CLOSE-CURSOR'                            21820052
218300                                   TO DP013-PARAGRAPH             21830052
218400              MOVE 'CLOSE CURSOR'  TO DP013-MESSAGE-TEXT (1)      21840052
218500              MOVE SQLCA           TO DP013-SQLCA                 21850052
218600              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (1)    21860052
218700              SET DP013-DB2-ABEND  TO TRUE                        21870052
218800              PERFORM DP013-0000-PROCESS-ABEND                    21880052
218900     END-EVALUATE.                                                21890052
219000                                                                  21900052
219100/                                                                 21910052
219200*----------------------------------------------------------------*21920052
219300*    DEPENDING ON WHAT WAS PASSED IN THE COMMAREA, SETUP THE     *21930052
219400*    DB2 KEYS IN PREPARATION FOR THE OPEN CURSROR.               *21940052
219500*----------------------------------------------------------------*21950052
219600                                                                  21960052
219700 4100-PREPARE-CURSOR.                                             21970052
219800                                                                  21980052
219900     MOVE ASC-PO-NBR       TO DK-ORD-NBR                          21990052
220000     MOVE ASC-REC-SEQ-NBR  TO DK-RCVR-SEQ-NBR.                    22000052
220100     MOVE ASC-OPR-ID       TO DK-OPR-ID                           22010052
220200     MOVE ASC-FACT         TO DK-FACT.                            22020052
220300                                                                  22030052
220400/                                                                 22040052
220500*----------------------------------------------------------------*22050052
220600*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *22060052
220700*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *22070052
220800*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *22080052
220900*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *22090052
221000*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *22100052
221100*                                                                *22110052
221200*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *22120052
221300*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *22130052
221400*    UPON INITIALIZATION.                                        *22140052
221500*----------------------------------------------------------------*22150052
221600                                                                  22160052
221700 4200-CALC-OPEN-TO-REC.                                           22170052
221800                                                                  22180052
221900     SET DP276-LINE-LEVEL-OTR                                     22190052
222000         DP276-RECEIVER-OTR      TO TRUE                          22200052
222100                                                                  22210052
222200     INITIALIZE DP276-KEYS                                        22220052
222300     MOVE DK-ORD-NBR             TO DP276-PO-NBR                  22230052
222400     MOVE PURITM-PO-LNE-NBR      TO DP276-PO-LNE-NBR              22240052
222500     MOVE DK-RCVR-SEQ-NBR        TO DP276-REC-SEQ-NBR             22250052
222600     MOVE DK-OPR-ID              TO DP276-OPER-UNT-ID             22260052
222700     MOVE DK-FACT                TO DP276-FCLTY-ID                22270052
222800                                                                  22280052
222900     COPY DPPD276.                                                22290052
223000                                                                  22300052
223100/                                                                 22310052
223200 4300-READ-ITEMS-FROM-DB.                                         22320052
223300                                                                  22330052
223400     PERFORM                                                      22340052
223500         VARYING PV-READ-COUNT                                    22350052
223600         FROM 1 BY 1                                              22360052
223700         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    22370052
223800            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         22380052
223900                                                                  22390052
224000         PERFORM 4310-FETCH                                       22400052
224100*                                                                 22410052
224200*----------------------------------------------------------------*22420052
224300*                                                **   WR # 230ZZ *22430052
224400* ADDED THE LOGIC TO CHECK FOR THE DUMMY SKU                     *22440052
224500* IF NOT DUMMY SKU CALL LOGISTICS DOMAIN ITEM ACCESS MODULE      *22450052
224600*----------------------------------------------------------------*22460052
224700     INITIALIZE XL001-ITEM-COMMAREA                               22470052
224800                PV-SKU-SEQ-TEMP                                   22480052
224900     IF  PS-CALL-API-YES                  AND                     22490052
225000        (PURITM-SKU-SEQ-NBR NOT = PC-000  AND                     22500052
225100         PURITM-SKU-SEQ-NBR NOT = PC-999)                         22510052
225200                                                                  22520052
225300         PERFORM 4320-CALL-CICS-API-ARCH                          22530052
225400     ELSE                                                         22540052
225500         IF PURITM-SKU-SEQ-NBR = PC-000                           22550052
225600            MOVE 00000000      TO  PV-SKU-SEQ-TEMP                22560052
225700         ELSE                                                     22570052
225800            IF PURITM-SKU-SEQ-NBR = PC-999                        22580052
225900               MOVE 99999999   TO  PV-SKU-SEQ-TEMP                22590052
226000            END-IF                                                22600052
226100         END-IF                                                   22610052
226200     END-IF                                                       22620052
226300*                                                                 22630052
226400*----------------------------------------------------------------*22640052
226500*   CHANGES MADE FOR WR # 230ZZ ENDS HERE.                        22650052
226600*----------------------------------------------------------------*22660052
226700*                                                                 22670052
226800         IF  ASC-ITEMS-LEFT-ON-DB                                 22680052
226900             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                22690052
227000                 ADD +1            TO ASC-ITEM-SUB                22700052
227100             ELSE                                                 22710052
227200                 ADD +1            TO ASC-BLK-SUB                 22720052
227300                 MOVE +1           TO ASC-ITEM-SUB                22730052
227400                                                                  22740052
227500                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         22750052
227600                     MOVE +1       TO ASC-BLK-SUB                 22760052
227700                     SET ASC-BLOCK-MODIFIED (1)                   22770052
227800                                   TO TRUE                        22780052
227900                     PERFORM 5100-WRITE-TEMP-STORAGE              22790052
228000                     MOVE ASC-BLOCK-ENTRIES                       22800052
228100                               (PC-MAX-BLOCKS-IN-ARRAY)           22810052
228200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 22820052
228300                     ADD +1        TO ASC-BLK-SUB                 22830052
228400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   22840052
228500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      22850052
228600                                   TO TRUE                        22860052
228700                 END-IF                                           22870052
228800             END-IF                                               22880052
228900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    22890052
229000             MOVE ASC-NUMBER-OF-ITEMS-READ                        22900052
229100                                   TO ASC-LIST-ITEM-NUMBER        22910052
229200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22920052
229300             MOVE PURCHS-DEPT-NBR       TO PV-SKU-DEPT            22930052
229400*                                                                 22940052
229500*----------------------------------------------------------------*22950052
229600*                                                    WR # 230ZZ  *22960052
229700* ADDED A MOVE INTO ASC-DEPT                                     *22970052
229800*----------------------------------------------------------------*22980052
229900             MOVE PURCHS-DEPT-NBR       TO ASC-DEPT               22990052
230000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23000052
230100*----------------------------------------------------------------*23010052
230200* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *23020052
230300*----------------------------------------------------------------*23030052
230400*                                                                 23040052
230500             MOVE PURCHS-ENT-ID         TO ASC-ENT-ID             23050052
230600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23060052
230800             MOVE DK-LINE-NBR           TO ASC-LINE-NUMBER        23080052
230900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23090052
231000*            MOVE PURITM-CL-NBR         TO ASC-CL                 23100054
231100*                                     (ASC-BLK-SUB ASC-ITEM-SUB)  23110054
231200             MOVE XL001-SUB-CL-NBR-2CH  TO ASC-CL                 23120061
231210                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23121054
231300*            MOVE PURITM-SKU-DESC       TO ASC-SKU-DESC           23130056
231310             MOVE XL001-SKU-DESC        TO ASC-SKU-DESC           23131056
231400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23140052
231500             MOVE PURITM-ITM-NBR        TO ASC-ITM-NBR            23150052
231600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23160052
231700             MOVE PURITM-VER-NBR        TO ASC-VER-NBR            23170052
231800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23180052
231900             MOVE PV-SKU-SEQ-TEMP       TO ASC-SEQ                23190052
232000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23200052
232100*            MOVE PURITM-VEND-STYL-NAME TO                        23210056
232200             MOVE XL001-VS-NBR          TO ASC-XLT-VEND-STYL-NAME 23220061
232210                                    (ASC-BLK-SUB ASC-ITEM-SUB)    23221061
232400             MOVE PURITM-UNT-QTY        TO ASC-PURITM-UNT-QTY     23240052
232500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23250052
232600             MOVE PURITM-UNT-RTL-PR-AMT TO                        23260052
232700                                       ASC-PURITM-UNT-RTL-PR-AMT  23270052
232800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23280052
232900             MOVE PURITM-GP-RTL-AMT     TO ASC-PURITM-GP-RTL-AMT  23290052
233000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23300052
233100             MOVE PURITM-GP-QTY         TO ASC-PURITM-GP-QTY      23310052
233200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23320052
233300             MOVE PURITM-STATUS-CDE     TO ASC-STATUS-CDE         23330052
233400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23340052
233500**GB  3/25/12                                                     23350062
233510                                                                  23351062
233511             MOVE PURITM-INNR-PK-QTY    TO ASC-INNER-PACK         23351162
233512                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23351262
233513             MOVE PURITM-OUTR-PK-QTY    TO ASC-CASE-PACK          23351362
233514                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23351462
233515**GB  3/25/12                                                     23351562
233550                                                                  23355062
233560                                                                  23356062
233600*      GET OPEN TO RECEIVE TOTALS                                 23360052
233700             MOVE DK-LINE-NBR           TO DP276-SEARCH-NBR       23370052
233800             PERFORM 4210-SEARCH-OTR                              23380052
233900             MOVE DP276-OTR-OUT-X TO ASC-OTR                      23390052
234000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     23400052
234100                                                                  23410052
234200                                                                  23420052
234300             IF ASC-STAT NOT = PC-VE                              23430052
234400                 PERFORM 4370-FIND-LINE-TROUBLE                   23440052
234500                 EVALUATE TRUE                                    23450052
234600                     WHEN PV-UNRSLVD-TRBL-COUNT > ZERO            23460052
234700                         SET ASC-LINE-IN-TROUBLE                  23470052
234800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23480052
234900                                   TO TRUE                        23490052
235000                     WHEN PV-RSLVD-TRBL-COUNT > ZERO              23500052
235100                         SET ASC-LINE-DISTRO-TRBL                 23510052
235200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23520052
235300                                   TO TRUE                        23530052
235400                 END-EVALUATE                                     23540052
235500             END-IF                                               23550052
235600         END-IF                                                   23560052
235700     END-PERFORM.                                                 23570052
235800                                                                  23580052
235900     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          23590052
236000         MOVE +1                   TO ASC-BLK-SUB                 23600052
236100         PERFORM 5100-WRITE-TEMP-STORAGE                          23610052
236200         ADD +1                    TO ASC-BLK-SUB                 23620052
236300         PERFORM 5100-WRITE-TEMP-STORAGE                          23630052
236400                                                                  23640052
236500         MOVE 1                    TO ASC-BLK-SUB                 23650052
236600                                      PV-BLOCK-NUMBER             23660052
236700         PERFORM 4410-READ-TEMP-STORAGE                           23670052
236800         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             23680052
236900             MOVE 2                TO ASC-BLK-SUB                 23690052
237000                                      PV-BLOCK-NUMBER             23700052
237100             PERFORM 4410-READ-TEMP-STORAGE                       23710052
237200         END-IF                                                   23720052
237300     END-IF.                                                      23730052
237400                                                                  23740052
237500/                                                                 23750052
237600*----------------------------------------------------------------*23760052
237700*    FETCH A TPURITM ROW                                         *23770052
237800*----------------------------------------------------------------*23780052
237900                                                                  23790052
238000 4310-FETCH.                                                      23800052
238100                                                                  23810052
238200     EXEC SQL                                                     23820052
238300         FETCH TPURITM-CSR                                        23830052
238400            INTO :PURITM-PO-NBR                                   23840052
238500                ,:PURITM-VER-NBR                                  23850052
238600                ,:PURITM-SKU-SEQ-NBR                              23860052
238700*               ,:PURITM-CL-NBR                                   23870054
238800                ,:PURITM-ITM-NBR                                  23880052
238900*               ,:PURITM-SKU-DESC                                 23890057
239000                ,:DK-LINE-NBR                                     23900052
239100*               ,:PURITM-VEND-STYL-NAME                           23910057
239200                ,:PURITM-UNT-QTY                                  23920052
239300                ,:PURITM-UNT-RTL-PR-AMT                           23930052
239400                ,:PURITM-GP-RTL-AMT                               23940052
239500                ,:PURITM-GP-QTY                                   23950052
239600                ,:PURITM-PO-LNE-NBR                               23960052
239700                ,:PURITM-STATUS-CDE                               23970052
239710                ,:PURITM-INNR-PK-QTY                              23971062
239720                ,:PURITM-OUTR-PK-QTY                              23972062
239800     END-EXEC.                                                    23980052
239900                                                                  23990052
240000     EVALUATE TRUE                                                24000052
240100         WHEN SQLCODE = +0                                        24010052
240200              SET PS-CALL-API-YES TO TRUE                         24020052
240300                                                                  24030052
240400         WHEN SQLCODE = +100                                      24040052
240500              SET ASC-NO-ITEMS-LEFT-ON-DB                         24050052
240600                                   TO TRUE                        24060052
240700         WHEN SQLCODE = -904                                      24070052
240800         WHEN SQLCODE = -911                                      24080052
240900         WHEN SQLCODE = -913                                      24090052
241000              PERFORM 9900-SOFT-ABORT                             24100052
241100                                                                  24110052
241200         WHEN SQLWARN0 NOT = SPACE                                24120052
241300         WHEN SQLCODE < +0                                        24130052
241400         WHEN SQLCODE > +0                                        24140052
241500              MOVE '4310-FETCH'                                   24150052
241600                                   TO DP013-PARAGRAPH             24160052
241700              MOVE 'FETCH TPURITM CURSOR'                         24170052
241800                                   TO DP013-MESSAGE-TEXT (1)      24180052
241900              MOVE SQLCA           TO DP013-SQLCA                 24190052
242000              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (1)    24200052
242100              SET DP013-DB2-ABEND  TO TRUE                        24210052
242200              PERFORM DP013-0000-PROCESS-ABEND                    24220052
242300     END-EVALUATE.                                                24230052
242400                                                                  24240052
242500/                                                                 24250052
242600*                                                                 24260052
242700*----------------------------------------------------------------*24270052
242800*                                               **   WR # 230ZZ  *24280052
242900* CALL TO LOGISTICS DOMAIN ITEM ACCESS MODULE                    *24290052
243000*----------------------------------------------------------------*24300052
243100*                                                                 24310052
243200 4320-CALL-CICS-API-ARCH.                                         24320052
243300******************************************************            24330052
243400******************************************************            24340052
243500                                                                  24350052
243600        MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR.               24360052
243700                                                                  24370052
243800        SET  XL001-BY-ITEM                                        24380052
243900             XL001-SELECT-SKU                                     24390054
243910             XL001-SELECT-VND-STYL                                24391054
243920                              TO TRUE.                            24392054
244000                                                                  24400052
244100        CALL XL001-VSM-PGM USING  DFHEIBLK                        24410052
244200                                  XL001-COMMAREA                  24420052
244300                                  XL001-ITEM-COMMAREA.            24430052
244400                                                                  24440052
244500        EVALUATE TRUE                                             24450052
244600                                                                  24460052
244700            WHEN XL001-SUCCESSFUL                                 24470052
244800                 MOVE XL001-SKU-NBR   TO PV-SKU-SEQ-TEMP          24480052
244900                                                                  24490052
245000            WHEN XL001-SKU-SQLCODE = +100                         24500052
245100                 CONTINUE                                         24510052
245200                                                                  24520052
245300            WHEN XL001-SKU-SQLCODE = -904                         24530052
245400            WHEN XL001-SKU-SQLCODE = -911                         24540052
245500            WHEN XL001-SKU-SQLCODE = -913                         24550052
245600                 PERFORM 9900-SOFT-ABORT                          24560052
245700                                                                  24570052
245800            WHEN XL001-INVALID-ACCESS                             24580052
245900              MOVE '4320-CALL-CICS-API-ARCH'                      24590052
246000                                   TO DP013-PARAGRAPH             24600052
246100              MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'           24610052
246200                                   TO DP013-MESSAGE-TEXT (1)      24620052
246300              MOVE SQLCA           TO DP013-SQLCA                 24630052
246400              MOVE 'XLV_SKU'       TO DP013-DB2-TABLE-NAME (1)    24640052
246500              SET DP013-DB2-ABEND  TO TRUE                        24650052
246600              PERFORM DP013-0000-PROCESS-ABEND                    24660052
246700                                                                  24670052
246800            WHEN OTHER                                            24680052
246900              MOVE '4320-CALL-CICS-API-ARCH'                      24690052
247000                                   TO DP013-PARAGRAPH             24700052
247100              MOVE 'FETCH SKU SEQUENCE'                           24710052
247200                                   TO DP013-MESSAGE-TEXT (1)      24720052
247300              MOVE XL001-SKU-SQLCODE                              24730052
247400                                   TO SQLCODE                     24740052
247500              MOVE SQLCA           TO DP013-SQLCA                 24750052
247600              MOVE 'XLV_SKU'       TO DP013-DB2-TABLE-NAME (1)    24760052
247700              SET DP013-DB2-ABEND  TO TRUE                        24770052
247800              PERFORM DP013-0000-PROCESS-ABEND                    24780052
247900            END-EVALUATE.                                         24790052
248000                                                                  24800052
248100*----------------------------------------------------------------*24810052
248200*  CHANGES MADE FOR WR # 230ZZ ENDS HERE.                        *24820052
248300*----------------------------------------------------------------*24830052
248400*                                                                 24840052
248500*----------------------------------------------------------------*24850052
248600*    GET TRECEIV INFO FOR THE TOP OF THE SCREEN                  *24860052
248700*----------------------------------------------------------------*24870052
248800 4355-GET-TRECEIV-INFO.                                           24880052
248900                                                                  24890052
249000         EXEC SQL                                                 24900052
249100              SELECT ORD_NBR                                      24910052
249200                    ,REC_SEQ_NBR                                  24920052
249300                    ,STATUS_CDE                                   24930052
249400                    ,EXPTED_CART_CNT                              24940052
249500                    ,ACTL_CART_CNT                                24950052
249600              INTO   :RECEIV-ORD-NBR                              24960052
249700                    ,:RECEIV-REC-SEQ-NBR                          24970052
249800                    ,:RECEIV-STATUS-CDE                           24980052
249900                    ,:RECEIV-EXPTED-CART-CNT                      24990052
250000                    ,:RECEIV-ACTL-CART-CNT                        25000052
250100                                                                  25010052
250200              FROM  TRECEIV                                       25020052
250300              WHERE ORD_NBR        = :DK-ORD-NBR                  25030052
250400                AND REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR             25040052
250500                AND OPER_UNT_ID    = :DK-OPR-ID                   25050052
250600                AND FCLTY_ID       = :DK-FACT                     25060052
250700                AND VER_STATUS_CDE = 'A'                          25070052
250800         END-EXEC                                                 25080052
250900                                                                  25090052
251000         EVALUATE TRUE                                            25100052
251100             WHEN SQLCODE = +0                                    25110052
251200             WHEN SQLCODE = +100                                  25120052
251300                  CONTINUE                                        25130052
251400             WHEN SQLCODE = -904                                  25140052
251500             WHEN SQLCODE = -911                                  25150052
251600             WHEN SQLCODE = -913                                  25160052
251700                  PERFORM 9900-SOFT-ABORT                         25170052
251800                                                                  25180052
251900             WHEN SQLWARN0 NOT = SPACES                           25190052
252000             WHEN SQLCODE < +0                                    25200052
252100             WHEN SQLCODE > +0                                    25210052
252200                  MOVE '4355-GET-TRECIEV-INFO'                    25220052
252300                                  TO DP013-PARAGRAPH              25230052
252400                  MOVE 'UNSUCCESSFUL SELECT ON TRECEIV'           25240052
252500                                  TO DP013-MESSAGE-TEXT (1)       25250052
252600                  MOVE SQLCA      TO DP013-SQLCA                  25260052
252700                  MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)     25270052
252800                  SET DP013-DB2-ABEND                             25280052
252900                      DP013-XCTL-DISPLAY-RESTART                  25290052
253000                                  TO TRUE                         25300052
253100                  PERFORM DP013-0000-PROCESS-ABEND                25310052
253200         END-EVALUATE.                                            25320052
253300/                                                                 25330052
253400*----------------------------------------------------------------*25340052
253500*    GET TPURCHS INFO FOR THE TOP OF THE SCREEN                  *25350052
253600*----------------------------------------------------------------*25360052
253700 4360-GET-TPURCHS-INFO.                                           25370052
253800                                                                  25380052
253900         EXEC SQL                                                 25390052
254000              SELECT PO_NBR                                       25400052
254100                    ,DEPT_NBR                                     25410052
254200                    ,ENT_ID                                       25420052
254300              INTO   :PURCHS-PO-NBR                               25430052
254400                    ,:PURCHS-DEPT-NBR                             25440052
254500                    ,:PURCHS-ENT-ID                               25450052
254600                                                                  25460052
254700              FROM  TPURCHS                                       25470052
254800              WHERE PO_NBR         = :DK-ORD-NBR                  25480052
254900                AND VER_STATUS_CDE = 'A'                          25490052
255000         END-EXEC                                                 25500052
255100                                                                  25510052
255200         EVALUATE TRUE                                            25520052
255300             WHEN SQLCODE = +0                                    25530052
255400             WHEN SQLCODE = +100                                  25540052
255500                  CONTINUE                                        25550052
255600             WHEN SQLCODE = -904                                  25560052
255700             WHEN SQLCODE = -911                                  25570052
255800             WHEN SQLCODE = -913                                  25580052
255900                  PERFORM 9900-SOFT-ABORT                         25590052
256000                                                                  25600052
256100             WHEN SQLWARN0 NOT = SPACES                           25610052
256200             WHEN SQLCODE < +0                                    25620052
256300             WHEN SQLCODE > +0                                    25630052
256400                  MOVE '4360-GET-TPURCHS-INFO'                    25640052
256500                                  TO DP013-PARAGRAPH              25650052
256600                  MOVE 'UNSUCCESSFUL SELECT ON TPURCHS'           25660052
256700                                  TO DP013-MESSAGE-TEXT (1)       25670052
256800                  MOVE SQLCA      TO DP013-SQLCA                  25680052
256900                  MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)     25690052
257000                  SET DP013-DB2-ABEND                             25700052
257100                      DP013-XCTL-DISPLAY-RESTART                  25710052
257200                                  TO TRUE                         25720052
257300                  PERFORM DP013-0000-PROCESS-ABEND                25730052
257400         END-EVALUATE.                                            25740052
257500/                                                                 25750052
257600 4370-FIND-LINE-TROUBLE.                                          25760052
257700     MOVE ZERO                    TO PV-UNRSLVD-TRBL-COUNT        25770052
257800                                     PV-RSLVD-TRBL-COUNT          25780052
257900     EXEC SQL                                                     25790052
258000         SELECT COUNT(*)                                          25800052
258100         INTO :PV-UNRSLVD-TRBL-COUNT                              25810052
258200         FROM TTRBNTF A                                           25820052
258300         WHERE A.PO_NBR               = :DK-ORD-NBR               25830052
258400               AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR          25840052
258500               AND A.PO_LNE_NBR       = :DK-LINE-NBR              25850052
258600               AND A.RESOLVED_IND IN (:PC-N, :PC-I)               25860052
258700     END-EXEC                                                     25870052
258800                                                                  25880052
258900     EVALUATE TRUE                                                25890052
259000         WHEN SQLCODE = ZERO                                      25900052
259100         WHEN SQLCODE = +100                                      25910052
259200             CONTINUE                                             25920052
259300         WHEN SQLCODE = -904                                      25930052
259400         WHEN SQLCODE = -911                                      25940052
259500         WHEN SQLCODE = -913                                      25950052
259600              PERFORM 9900-SOFT-ABORT                             25960052
259700                                                                  25970052
259800         WHEN SQLWARN0 NOT = SPACE                                25980052
259900         WHEN SQLCODE < ZERO                                      25990052
260000         WHEN SQLCODE > ZERO                                      26000052
260100             MOVE '4370-FIND-LINE-TROUBLE'                        26010052
260200                             TO DP013-PARAGRAPH                   26020052
260300             MOVE 'SELECT ON TTRBNTF'                             26030052
260400                             TO DP013-MESSAGE-TEXT (1)            26040052
260500             MOVE SQLCA          TO DP013-SQLCA                   26050052
260600             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      26060052
260700             SET DP013-DB2-ABEND                                  26070052
260800                             TO TRUE                              26080052
260900             SET DP013-XCTL-DISPLAY-RESTART                       26090052
261000                             TO TRUE                              26100052
261100             PERFORM DP013-0000-PROCESS-ABEND                     26110052
261200     END-EVALUATE.                                                26120052
261300                                                                  26130052
261400     IF PV-UNRSLVD-TRBL-COUNT = ZERO AND SQLCODE = ZERO OR +100   26140052
261500         EXEC SQL                                                 26150052
261600             SELECT COUNT(*)                                      26160052
261700             INTO :PV-RSLVD-TRBL-COUNT                            26170052
261800             FROM TTRBNTF A                                       26180052
261900                , TTRBRSN B                                       26190052
262000             WHERE A.PO_NBR           = :DK-ORD-NBR               26200052
262100                   AND A.REC_SEQ_NBR  = :DK-RCVR-SEQ-NBR          26210052
262200                   AND A.PO_LNE_NBR   = :DK-LINE-NBR              26220052
262300                   AND A.RESOLVED_IND = :PC-R                     26230052
262400                   AND A.TRBL_RSN_CDE = B.TRBL_RSN_CDE            26240052
262500                   AND B.NOTIF_IND    = :PC-T                     26250052
262600         END-EXEC                                                 26260052
262700                                                                  26270052
262800         EVALUATE TRUE                                            26280052
262900             WHEN SQLCODE = ZERO                                  26290052
263000             WHEN SQLCODE = +100                                  26300052
263100                 CONTINUE                                         26310052
263200             WHEN SQLCODE = -904                                  26320052
263300             WHEN SQLCODE = -911                                  26330052
263400             WHEN SQLCODE = -913                                  26340052
263500                  PERFORM 9900-SOFT-ABORT                         26350052
263600                                                                  26360052
263700             WHEN SQLWARN0 NOT = SPACE                            26370052
263800             WHEN SQLCODE < ZERO                                  26380052
263900             WHEN SQLCODE > ZERO                                  26390052
264000                 MOVE '4370-FIND-LINE-TROUBLE'                    26400052
264100                                 TO DP013-PARAGRAPH               26410052
264200                 MOVE 'SELECT ON TTRBNTF - TTRBRSN'               26420052
264300                                 TO DP013-MESSAGE-TEXT (1)        26430052
264400                 MOVE SQLCA      TO DP013-SQLCA                   26440052
264500                 MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME (1)      26450052
264600                 MOVE 'TTRBRSN'  TO DP013-DB2-TABLE-NAME (2)      26460052
264700                 SET DP013-DB2-ABEND                              26470052
264800                                 TO TRUE                          26480052
264900                 SET DP013-XCTL-DISPLAY-RESTART                   26490052
265000                                 TO TRUE                          26500052
265100                 PERFORM DP013-0000-PROCESS-ABEND                 26510052
265200         END-EVALUATE                                             26520052
265300     END-IF.                                                      26530052
265400*----------------------------------------------------------------*26540052
265500* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *26550052
265600*----------------------------------------------------------------*26560052
265700                                                                  26570052
265800 4400-MOVE-COMMAREA-TO-SCREEN.                                    26580052
265900                                                                  26590052
266000     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             26600052
266100         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          26610052
266200         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          26620052
266300             MOVE +1               TO ASC-BLK-SUB                 26630052
266400             PERFORM 5100-WRITE-TEMP-STORAGE                      26640052
266500             ADD +1                TO ASC-BLK-SUB                 26650052
266600             PERFORM 5100-WRITE-TEMP-STORAGE                      26660052
266700             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             26670052
266800                 GIVING PV-BLOCK-NUMBER                           26680052
266900                 REMAINDER PV-REMAINDER                           26690052
267000             IF  PV-REMAINDER > ZERO                              26700052
267100                 ADD +1            TO PV-BLOCK-NUMBER             26710052
267200             END-IF                                               26720052
267300             MOVE +1               TO ASC-BLK-SUB                 26730052
267400             PERFORM 4410-READ-TEMP-STORAGE                       26740052
267500             ADD +1                TO ASC-BLK-SUB                 26750052
267600                                      PV-BLOCK-NUMBER             26760052
267700             PERFORM 4410-READ-TEMP-STORAGE                       26770052
267800     END-IF.                                                      26780052
267900                                                                  26790052
268000     MOVE +1                       TO ASC-BLK-SUB.                26800052
268100                                                                  26810052
268200     COMPUTE ASC-ITEM-SUB =                                       26820052
268300         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              26830052
268400         + PC-ITEMS-PER-PANEL).                                   26840052
268500                                                                  26850052
268600     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        26860052
268700         ADD +1                    TO ASC-BLK-SUB                 26870052
268800         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            26880052
268900     END-IF.                                                      26890052
269000                                                                  26900052
269100     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           26910052
269200         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                26920052
269300                                                                  26930052
269400     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        26940052
269500     PERFORM 4420-FORMAT-LIST-LINES                               26950052
269600         VARYING PV-SUB                                           26960052
269700         FROM PC-ITEMS-PER-PANEL BY -1                            26970052
269800         UNTIL PV-SUB < +1.                                       26980052
269900                                                                  26990052
270000     COMPUTE ASC-ITEMS-DISPLAYED =                                27000052
270100         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          27010052
270200                                                                  27020052
270300     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    27030052
270400                                      ASTRTITO.                   27040052
270500                                                                  27050052
270600     MOVE ASC-PO-NBR                   TO APONBRO.                27060052
270700     MOVE ASC-REC-SEQ-NBR              TO ASEQNBRO.               27070052
270800     MOVE ASC-STAT                     TO ASTATO.                 27080052
270900     MOVE ASC-OPR-ID                   TO AOPUNTO.                27090052
271000     MOVE ASC-FACT                     TO AFACTYO.                27100052
271100*                                                                 27110052
271200*----------------------------------------------------------------*27120052
271300*                                                    WR # 230ZZ  *27130052
271400* ADDED MOVE TO MAP OUTPUT VARIABLE                              *27140052
271500*----------------------------------------------------------------*27150052
271600*                                                                 27160052
271700     MOVE PV-SKU-DEPT                  TO ADEPNBRO.               27170052
271800*                                                                 27180052
271900*----------------------------------------------------------------*27190052
272000* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *27200052
272100*----------------------------------------------------------------*27210052
272200*                                                                 27220052
272300     MOVE ASC-TRECEIV-EXPTED-CART-CNT  TO AEXQTYO.                27230052
272400     MOVE ASC-TRECEIV-ACTL-CART-CNT    TO AACQTYO.                27240052
272500                                                                  27250052
272600                                                                  27260052
272700     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    27270052
272800     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    27280052
272900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            27290052
273000                                   TO ASELITO.                    27300052
273100                                                                  27310052
273200     IF  DP020-MSG-NUMBER-X = SPACE                               27320052
273300         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  27330052
273400*            --- MORE ITEMS TO DISPLAY ----                       27340052
273500             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            27350052
273600             SET DP020-MSG-INFORMATIONAL                          27360052
273700                                   TO TRUE                        27370052
273800         END-IF                                                   27380052
273900     END-IF.                                                      27390052
274000                                                                  27400052
274100*----------------------------------------------------------------*27410052
274200*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *27420052
274300*----------------------------------------------------------------*27430052
274400                                                                  27440052
274500 4410-READ-TEMP-STORAGE.                                          27450052
274600                                                                  27460052
274700     EXEC CICS                                                    27470052
274800         READQ TS                                                 27480052
274900             QUEUE (ASC-LIST-QUEUE-NAME)                          27490052
275000             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               27500052
275100             ITEM  (PV-BLOCK-NUMBER)                              27510052
275200             RESP  (PV-CICS-RESP)                                 27520052
275300     END-EXEC.                                                    27530052
275400                                                                  27540052
275500     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       27550052
275600       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     27560052
275700         CONTINUE                                                 27570052
275800     ELSE                                                         27580052
275900         SET DP013-CICS-ABEND      TO TRUE                        27590052
276000         SET DP013-NO-ROLLBACK     TO TRUE                        27600052
276100         MOVE '4410-READ-TEMP-STORAGE'                            27610052
276200                                   TO DP013-PARAGRAPH             27620052
276300         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      27630052
276400                                   TO DP013-MESSAGE-TEXT(1)       27640052
276500         PERFORM DP013-0000-PROCESS-ABEND                         27650052
276600     END-IF.                                                      27660052
276700                                                                  27670052
276800     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      27680052
276900                                   TO TRUE.                       27690052
277000                                                                  27700052
277100     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         27710052
277200         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               27720052
277300     END-IF.                                                      27730052
277400                                                                  27740052
277500/                                                                 27750052
277600*----------------------------------------------------------------*27760052
277700*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *27770052
277800*----------------------------------------------------------------*27780052
277900                                                                  27790052
278000 4420-FORMAT-LIST-LINES.                                          27800052
278100                                                                  27810052
278200     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      27820052
278300         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                27830052
278400         MOVE DP015-ASK-DRK-OFF    TO MR-SELECTA (PV-SUB)         27840052
278500         MOVE SPACES               TO MR-SELECT  (PV-SUB)         27850052
278600         MOVE SPACES               TO MR-SKU              (PV-SUB)27860052
278700                                      MR-LINE             (PV-SUB)27870052
278800                                      MR-INNER-PACK       (PV-SUB)27880052
278900                                      MR-CASE-PACK        (PV-SUB)27890052
279000                                      MR-OTR              (PV-SUB)27900052
279100                                      MR-STATUS-CDE       (PV-SUB)27910052
279200     ELSE                                                         27920052
279300         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      27930052
279400                                                   > SPACE        27940052
279500             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 27950052
279600                                   TO MR-SELECT (PV-SUB)          27960052
279700         ELSE                                                     27970052
279800             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      27980052
279900                                   TO MR-SELECT (PV-SUB)          27990052
280000         END-IF                                                   28000052
280100                                                                  28010052
280200         IF  DP030-SET-CURSOR-TRAILER                             28020052
280300             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)28030052
280400                 > SPACE)                                         28040052
280500               OR (PV-SUB = 1))                                   28050052
280600                SET DP030-SET-CURSOR-APPL-1 TO TRUE               28060052
280700                MOVE -1            TO MR-SELECTL (PV-SUB)         28070052
280800             END-IF                                               28080052
280900         END-IF                                                   28090052
281000                                                                  28100052
281100         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           28110052
281200             MOVE ASC-LINE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)      28120052
281300                                 TO MR-LINE-N (PV-SUB)            28130052
281600*                                                                 28160052
281700*----------------------------------------------------------------*28170052
281800* MOVE THE ASC-VALUES TO THE DISPLAY VARIABLES       WR # 230ZZ  *28180052
281900*----------------------------------------------------------------*28190052
282000*                                                                 28200052
282100             MOVE ASC-CL        (ASC-BLK-SUB ASC-ITEM-SUB)        28210052
282200                                 TO PV-DISP-CL                    28220052
282300             MOVE ASC-SEQ       (ASC-BLK-SUB ASC-ITEM-SUB)        28230052
282400                                 TO PV-DISP-SKU                   28240052
282500             MOVE PV-DISP-CL-SKU                                  28250052
282600                                 TO MR-SKU (PV-SUB)               28260052
282700*                                                                 28270052
282800*----------------------------------------------------------------*28280052
282900* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *28290052
283000*----------------------------------------------------------------*28300052
283100*                                                                 28310052
283200             MOVE ASC-INNER-PACK  (ASC-BLK-SUB ASC-ITEM-SUB)      28320052
283300                                 TO MR-INNER-PACK-N (PV-SUB)      28330052
283400             MOVE ASC-CASE-PACK   (ASC-BLK-SUB ASC-ITEM-SUB)      28340052
283500                                 TO MR-CASE-PACK-N (PV-SUB)       28350052
283600             MOVE ASC-OTR (ASC-BLK-SUB ASC-ITEM-SUB)              28360052
283700                                 TO MR-OTR (PV-SUB)               28370052
283800             MOVE ASC-STATUS-CDE (ASC-BLK-SUB ASC-ITEM-SUB)       28380052
283900                                 TO MR-STATUS-CDE (PV-SUB)        28390052
284000                                                                  28400052
284100         END-IF                                                   28410052
284200     END-IF.                                                      28420052
284300                                                                  28430052
284400     IF ASC-STATUS-CDE (ASC-BLK-SUB ASC-ITEM-SUB) = DK-STAT-CDE-RV28440052
284500         MOVE DP015-PRO-DRK-MDT TO MR-SELECTA (PV-SUB)            28450052
284600     END-IF.                                                      28460052
284700                                                                  28470052
284800     SUBTRACT +1 FROM ASC-ITEM-SUB.                               28480052
284900                                                                  28490052
285000     IF  ASC-ITEM-SUB < + 1                                       28500052
285100         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                28510052
285200         MOVE +1                   TO ASC-BLK-SUB                 28520052
285300     END-IF.                                                      28530052
285400                                                                  28540052
285500*----------------------------------------------------------------*28550052
285600*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *28560052
285700*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *28570052
285800*  ISSUE A WARNING.                                              *28580052
285900*----------------------------------------------------------------*28590052
286000 4430-CHECK-FOR-BEGIN-AND-END.                                    28600052
286100                                                                  28610052
286200     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       28620052
286300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     28630052
286400*            -- NO END-OF-RANGE SPECFIED ---                      28640052
286500             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            28650052
286600             SET DP020-MSG-WARNING TO TRUE                        28660052
286700             PERFORM 4431-POSITION-AT-WARNING                     28670052
286800         END-IF                                                   28680052
286900     ELSE                                                         28690052
287000         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     28700052
287100*            -- NO BEGINNING-OF-RANGE SPECFIED ---                28710052
287200             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            28720052
287300             SET DP020-MSG-WARNING TO TRUE                        28730052
287400             PERFORM 4431-POSITION-AT-WARNING                     28740052
287500         END-IF                                                   28750052
287600     END-IF.                                                      28760052
287700                                                                  28770052
287800*----------------------------------------------------------------*28780052
287900*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *28790052
288000*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *28800052
288100*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *28810052
288200*  POSITION THE CURSOR THERE.                                    *28820052
288300*----------------------------------------------------------------*28830052
288400 4431-POSITION-AT-WARNING.                                        28840052
288500                                                                  28850052
288600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 28860052
288700                    - PV-TOP-ITEM + 1.                            28870052
288800                                                                  28880052
288900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      28890052
289000         CONTINUE                                                 28900052
289100     ELSE                                                         28910052
289200         SET DP030-SET-CURSOR-APPL-1                              28920052
289300                                   TO TRUE                        28930052
289400         MOVE -1                   TO MR-SELECTL (PV-SUB)         28940052
289500         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         28950052
289600         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         28960052
289700     END-IF.                                                      28970052
289800                                                                  28980052
289900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   28990052
290000                    - PV-TOP-ITEM + 1.                            29000052
290100                                                                  29010052
290200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      29020052
290300         CONTINUE                                                 29030052
290400     ELSE                                                         29040052
290500         SET DP030-SET-CURSOR-APPL-1                              29050052
290600                                   TO TRUE                        29060052
290700         MOVE -1                   TO MR-SELECTL (PV-SUB)         29070052
290800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         29080052
290900         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         29090052
291000     END-IF.                                                      29100052
291100                                                                  29110052
291200/                                                                 29120052
291300*----------------------------------------------------------------*29130052
291400* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *29140052
291500* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *29150052
291600* FOR THE SELECTED ITEMS QUEUE.                                  *29160052
291700*                                                                *29170052
291800* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *29180052
291900* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *29190052
292000* THE ARRAY IS FULL.                                             *29200052
292100*----------------------------------------------------------------*29210052
292200                                                                  29220052
292300 5000-PREPARE-SEL-QUEUE.                                          29230052
292400                                                                  29240052
292500     MOVE +1                       TO ASC-BLK-SUB.                29250052
292600     PERFORM 5100-WRITE-TEMP-STORAGE.                             29260052
292700     ADD +1                        TO ASC-BLK-SUB.                29270052
292800     PERFORM 5100-WRITE-TEMP-STORAGE.                             29280052
292900                                                                  29290052
293000     MOVE ASC-SEL-QUEUE-NAME-OUT   TO PC000-SEL-QUEUE-NAME.       29300052
293100     PERFORM 6010-DELETE-SEL-QUEUE.                               29310052
293200                                                                  29320052
293300                                                                  29330052
293400     SET ASC-UPDATE-TSQ        TO TRUE.                           29340052
293500     SET PC016-IDX             TO 1.                              29350052
293600     MOVE ZERO                 TO PC000-NUMBER-OF-TS-ITEMS        29360052
293700                         PC000-NUMBER-OF-SELECTED-ITEMS.          29370052
293800     INITIALIZE PC016-SELECTED-ITEM-ARRAY.                        29380052
293900                                                                  29390052
294000     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           29400052
294100             VARYING PV-ITEM                                      29410052
294200             FROM 1 BY 1                                          29420052
294300             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     29430052
294400     IF  PC016-IDX > 1                                            29440052
294500         PERFORM 5205-WRITE-SEL-QUEUE                             29450052
294600         ADD +1                TO PC000-NUMBER-OF-TS-ITEMS        29460052
294700     END-IF.                                                      29470052
294800                                                                  29480052
294900/                                                                 29490052
295000*----------------------------------------------------------------*29500052
295100*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *29510052
295200*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *29520052
295300*----------------------------------------------------------------*29530052
295400                                                                  29540052
295500 5100-WRITE-TEMP-STORAGE.                                         29550052
295600                                                                  29560052
295700     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     29570052
295800                                   TO PV-LIST-ITEM-NUMBER.        29580052
295900     COMPUTE PV-BLOCK-NUMBER =                                    29590052
296000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    29600052
296100                                                                  29610052
296200     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             29620052
296300     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             29630052
296400         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      29640052
296500             PERFORM 5105-REWRITE-ASC-LISTQ                       29650052
296600         END-IF                                                   29660052
296700     ELSE                                                         29670052
296800         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       29680052
296900         ASC-HIGHEST-BLOCK-WRITTEN + 1                            29690052
297000         PERFORM 5110-WRITE-ASC-LISTQ                             29700052
297100         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   29710052
297200     END-IF.                                                      29720052
297300                                                                  29730052
297400     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      29740052
297500                                   TO TRUE.                       29750052
297600                                                                  29760052
297700/                                                                 29770052
297800*----------------------------------------------------------------*29780052
297900*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *29790052
298000*  SPECIFIC COMMAREA.                                            *29800052
298100*----------------------------------------------------------------*29810052
298200 5105-REWRITE-ASC-LISTQ.                                          29820052
298300                                                                  29830052
298400     EXEC CICS                                                    29840052
298500         WRITEQ TS                                                29850052
298600             QUEUE (ASC-LIST-QUEUE-NAME)                          29860052
298700             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               29870052
298800             ITEM  (PV-BLOCK-NUMBER)                              29880052
298900             REWRITE                                              29890052
299000             RESP  (PV-CICS-RESP)                                 29900052
299100     END-EXEC.                                                    29910052
299200                                                                  29920052
299300     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           29930052
299400         CONTINUE                                                 29940052
299500     ELSE                                                         29950052
299600         SET DP013-CICS-ABEND      TO TRUE                        29960052
299700         SET DP013-NO-ROLLBACK     TO TRUE                        29970052
299800         MOVE '5105-REWRITE-ASC-LISTQ'                            29980052
299900                                   TO DP013-PARAGRAPH             29990052
300000         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     30000052
300100                                   TO DP013-MESSAGE-TEXT(1)       30010052
300200         PERFORM DP013-0000-PROCESS-ABEND                         30020052
300300     END-IF.                                                      30030052
300400                                                                  30040052
300500/                                                                 30050052
300600*----------------------------------------------------------------*30060052
300700*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *30070052
300800*  SPECIFIC COMMAREA.                                            *30080052
300900*----------------------------------------------------------------*30090052
301000 5110-WRITE-ASC-LISTQ.                                            30100052
301100                                                                  30110052
301200     EXEC CICS                                                    30120052
301300         WRITEQ TS                                                30130052
301400             QUEUE (ASC-LIST-QUEUE-NAME)                          30140052
301500             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               30150052
301600             ITEM  (PV-BLOCK-NUMBER)                              30160052
301700             RESP  (PV-CICS-RESP)                                 30170052
301800     END-EXEC.                                                    30180052
301900                                                                  30190052
302000     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      30200052
302100         SET DP013-CICS-ABEND      TO TRUE                        30210052
302200         SET DP013-NO-ROLLBACK     TO TRUE                        30220052
302300         MOVE '5110-WRITE-ASC-LISTQ'                              30230052
302400                                   TO DP013-PARAGRAPH             30240052
302500         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           30250052
302600                                   TO DP013-MESSAGE-TEXT(1)       30260052
302700         PERFORM DP013-0000-PROCESS-ABEND                         30270052
302800     END-IF.                                                      30280052
302900                                                                  30290052
303000/                                                                 30300052
303100*----------------------------------------------------------------*30310052
303200* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *30320052
303300* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *30330052
303400*----------------------------------------------------------------*30340052
303500                                                                  30350052
303600 5200-FILL-SEL-QUEUE-RECORD.                                      30360052
303700                                                                  30370052
303800     PERFORM 6112-READ-LIST-QUEUE.                                30380052
303900                                                                  30390052
304000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       30400052
304100         PERFORM                                                  30410052
304200         VARYING LQW-IDX                                          30420052
304300         FROM 1 BY 1                                              30430052
304400         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            30440052
304500           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          30450052
304600                                                                  30460052
304700             IF  (LQW-SELECT (LQW-IDX))                           30470052
304800                 ADD +1 TO PC000-NUMBER-OF-SELECTED-ITEMS         30480052
304900                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              30490052
305000                                    TO PC016-ITEM (PC016-IDX)     30500052
305100                 MOVE SPACE         TO PC016-ACTION-SW (PC016-IDX)30510052
305200                 MOVE ASC-OPR-ID    TO PC016-OPER-UNT-ID          30520052
305300                                                       (PC016-IDX)30530052
305400                 MOVE ASC-FACT      TO PC016-FCLTY-ID             30540052
305500                                                       (PC016-IDX)30550052
305600                 MOVE ASC-PO-NBR    TO PC016-PO-NBR-N  (PC016-IDX)30560052
305700                 MOVE ASC-REC-SEQ-NBR                             30570052
305800                                    TO PC016-REC-SEQ-NBR-N        30580052
305900                                                       (PC016-IDX)30590052
306000                 MOVE LQW-LINE-NUMBER (LQW-IDX)                   30600052
306100                                    TO PC016-LINE-NBR-N           30610052
306200                                                       (PC016-IDX)30620052
306300                 MOVE LQW-DEPT        (LQW-IDX)                   30630052
306400                                    TO PC016-DEPT                 30640052
306500                                                       (PC016-IDX)30650052
306600                 MOVE LQW-CL          (LQW-IDX)                   30660052
306700                                    TO PC016-CL                   30670052
306800                                                       (PC016-IDX)30680052
308700                 MOVE LQW-SKU-DESC    (LQW-IDX)                   30870052
308800                                    TO PC016-SKU-DESC             30880052
308900                                                       (PC016-IDX)30890052
309000                 MOVE LQW-ITM-NBR     (LQW-IDX)                   30900052
309100                                    TO PC016-ITM-NBR              30910052
309200                                                       (PC016-IDX)30920052
309300                 MOVE LQW-VER-NBR     (LQW-IDX)                   30930052
309400                                    TO PC016-VER-NBR              30940052
309500                                                       (PC016-IDX)30950052
309600                 MOVE LQW-ITEM-VEND-STYL-NAME          (LQW-IDX)  30960057
309700                                    TO PC016-VEND-STYL-NAME       30970052
309800                                                       (PC016-IDX)30980052
309900                 MOVE LQW-PURITM-UNT-QTY               (LQW-IDX)  30990052
310000                                    TO PC016-UNT-QTY   (PC016-IDX)31000052
310100                 MOVE LQW-PURITM-UNT-RTL-PR-AMT        (LQW-IDX)  31010052
310200                                    TO PC016-UNT-RTL-PR-AMT       31020052
310300                                                       (PC016-IDX)31030052
310400                 MOVE LQW-PURITM-GP-RTL-AMT            (LQW-IDX)  31040052
310500                                    TO PC016-GP-RTL-AMT(PC016-IDX)31050052
310600                 MOVE LQW-PURITM-GP-QTY                (LQW-IDX)  31060052
310700                                    TO PC016-GP-QTY    (PC016-IDX)31070052
310800                 MOVE PC-Y          TO PC016-MRKG-APRON-REQ-IND   31080052
310900                                                       (PC016-IDX)31090052
311000                 SET PC016-IDX UP BY 1                            31100052
311100                 IF  PC016-IDX > PC016-MAX-ITEMS                  31110052
311200                     PERFORM 5205-WRITE-SEL-QUEUE                 31120052
311300                     ADD +1        TO PC000-NUMBER-OF-TS-ITEMS    31130052
311400                     INITIALIZE PC016-SELECTED-ITEM-ARRAY         31140052
311500                     SET PC016-IDX TO 1                           31150052
311600                 END-IF                                           31160052
311700             END-IF                                               31170052
311800         END-PERFORM                                              31180052
311900     END-IF.                                                      31190052
312000                                                                  31200052
312100     MOVE PV-ITEM TO PV-SAVE-ITEM.                                31210052
312200     PERFORM 6111-WRITE-LIST-QUEUE.                               31220052
312300                                                                  31230052
312400*----------------------------------------------------------------*31240052
312500*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *31250052
312600*----------------------------------------------------------------*31260052
312700                                                                  31270052
312800 5205-WRITE-SEL-QUEUE.                                            31280052
312900                                                                  31290052
313000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            31300052
313100                                   TO PC016-SELECTED-ITEMS.       31310052
313200                                                                  31320052
313300     EXEC CICS                                                    31330052
313400          WRITEQ TS                                               31340052
313500              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      31350052
313600              FROM  (PC016-TS-SEL-REC)                            31360052
313700              ITEM  (PV-SEL-QUEUE-ITEM)                           31370052
313800              RESP  (PV-CICS-RESP)                                31380052
313900     END-EXEC.                                                    31390052
314000                                                                  31400052
314100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          31410052
314200         CONTINUE                                                 31420052
314300     ELSE                                                         31430052
314400         SET DP013-CICS-ABEND      TO TRUE                        31440052
314500         SET DP013-NO-ROLLBACK     TO TRUE                        31450052
314600         MOVE '5205-WRITE-SEL-QUEUE'                              31460052
314700                                   TO DP013-PARAGRAPH             31470052
314800         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          31480052
314900                                   TO DP013-MESSAGE-TEXT(1)       31490052
315000         PERFORM DP013-0000-PROCESS-ABEND                         31500052
315100     END-IF.                                                      31510052
315200/                                                                 31520052
315300*----------------------------------------------------------------*31530052
315400*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *31540052
315500*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *31550052
315600*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *31560052
315700*  THE USER.                                                     *31570052
315800*----------------------------------------------------------------*31580052
315900                                                                  31590052
316000 6000-REFRESH-PANEL-FROM-TEMP.                                    31600052
316100                                                                  31610052
316200     IF (ASC-UPDATE-TSQ                                           31620052
316300     OR  ASC-UPDATE-TSQ2)                                         31630052
316400         MOVE ZERO                 TO PV-SAVE-ITEM                31640052
316500                                      PV-SEL-QUEUE-ITEM           31650052
316600         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        31660052
316700                                   TO PV-HOLD-SELECTED-ITEMS      31670052
316800         IF  ASC-UPDATE-TSQ                                       31680052
316900             PERFORM 6100-UPDATE-TSQ                              31690052
317000                 UNTIL PV-ITEMS-PROCESSED >                       31700052
317100                                     ASC-NUMBER-OF-SELECTED-ITEMS 31710052
317200         ELSE                                                     31720052
317300             PERFORM 6101-UPDATE-TSQ2                             31730052
317400                 UNTIL PV-ITEMS-PROCESSED >                       31740052
317500                                     ASC-NUMBER-OF-SELECTED-ITEMS 31750052
317600         END-IF                                                   31760052
317700                                                                  31770052
317800         PERFORM 6010-DELETE-SEL-QUEUE                            31780052
317900         SET ASC-NO-TSQ-UPDATE TO TRUE                            31790052
318000         INITIALIZE ASC-BLOCK-ENTRIES (1)                         31800052
318100                    ASC-BLOCK-ENTRIES (2)                         31810052
318200                                                                  31820052
318300         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 31830052
318400                GIVING PV-BLOCK-NUMBER                            31840052
318500                REMAINDER PV-REMAINDER                            31850052
318600         IF  PV-REMAINDER > ZERO                                  31860052
318700             ADD +1     TO PV-BLOCK-NUMBER                        31870052
318800         END-IF                                                   31880052
318900         MOVE +1        TO ASC-BLK-SUB                            31890052
319000         PERFORM 4410-READ-TEMP-STORAGE                           31900052
319100         ADD +1         TO ASC-BLK-SUB                            31910052
319200                           PV-BLOCK-NUMBER                        31920052
319300         PERFORM 4410-READ-TEMP-STORAGE                           31930052
319400     END-IF.                                                      31940052
319500/                                                                 31950052
319600*----------------------------------------------------------------*31960052
319700*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *31970052
319800*----------------------------------------------------------------*31980052
319900 6010-DELETE-SEL-QUEUE.                                           31990052
320000                                                                  32000052
320100     EXEC CICS                                                    32010052
320200         DELETEQ TS                                               32020052
320300             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       32030052
320400             RESP  (PV-CICS-RESP)                                 32040052
320500     END-EXEC.                                                    32050052
320600                                                                  32060052
320700     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      32070052
320800         (PV-CICS-RESP = DFHRESP(QIDERR)))                        32080052
320900         CONTINUE                                                 32090052
321000     ELSE                                                         32100052
321100         SET DP013-CICS-ABEND      TO TRUE                        32110052
321200         SET DP013-NO-ROLLBACK     TO TRUE                        32120052
321300         MOVE '6010-DELETE-SEL-QUEUE'                             32130052
321400                                   TO DP013-PARAGRAPH             32140052
321500         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         32150052
321600                                   TO DP013-MESSAGE-TEXT (1)      32160052
321700         PERFORM DP013-0000-PROCESS-ABEND                         32170052
321800     END-IF.                                                      32180052
321900/                                                                 32190052
322000*----------------------------------------------------------------*32200052
322100*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *32210052
322200*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *32220052
322300*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *32230052
322400*    THE TEMP QUEUE.                                             *32240052
322500*----------------------------------------------------------------*32250052
322600                                                                  32260052
322700 6100-UPDATE-TSQ.                                                 32270052
322800                                                                  32280052
322900     ADD 1                         TO PV-SEL-QUEUE-ITEM.          32290052
323000     PERFORM 6105-READ-SEL-QUEUE.                                 32300052
323100                                                                  32310052
323200     PERFORM                                                      32320052
323300         VARYING PC016-IDX                                        32330052
323400         FROM 1 BY 1                                              32340052
323500         UNTIL ((PV-ITEMS-PROCESSED >                             32350052
323600                              PV-HOLD-SELECTED-ITEMS)             32360052
323700         OR (PC016-IDX GREATER THAN PC016-MAX-ITEMS))             32370052
323800         IF  PC016-ACTION-SW (PC016-IDX) > SPACE                  32380052
323900             PERFORM 6110-PROCESS-ITEMS                           32390052
324000         END-IF                                                   32400052
324100         ADD +1                    TO PV-ITEMS-PROCESSED          32410052
324200     END-PERFORM.                                                 32420052
324300                                                                  32430052
324400     PERFORM 6111-WRITE-LIST-QUEUE.                               32440052
324500/                                                                 32450052
324600*----------------------------------------------------------------*32460052
324700*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *32470052
324800*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *32480052
324900*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *32490052
325000*    THE TEMP QUEUE.                                             *32500052
325100*----------------------------------------------------------------*32510052
325200                                                                  32520052
325300 6101-UPDATE-TSQ2.                                                32530052
325400                                                                  32540052
325500     ADD 1                         TO PV-SEL-QUEUE-ITEM.          32550052
325600     PERFORM 6106-READ-SEL-QUEUE2.                                32560052
325700                                                                  32570052
325800     PERFORM                                                      32580052
325900         VARYING RC013-IDX                                        32590052
326000         FROM 1 BY 1                                              32600052
326100         UNTIL ((PV-ITEMS-PROCESSED >                             32610052
326200                              PV-HOLD-SELECTED-ITEMS)             32620052
326300         OR (RC013-IDX GREATER THAN RC013-MAX-ITEMS))             32630052
326400             IF  RC013-ACTION-SW (PC016-IDX) > SPACE              32640052
326500                 PERFORM 6109-PROCESS-ITEMS2                      32650052
326600             END-IF                                               32660052
326700         ADD +1                    TO PV-ITEMS-PROCESSED          32670052
326800     END-PERFORM.                                                 32680052
326900                                                                  32690052
327000     PERFORM 6111-WRITE-LIST-QUEUE.                               32700052
327100/                                                                 32710052
327200*----------------------------------------------------------------*32720052
327300*    READ THE LIST QUEUE RECORD.                                 *32730052
327400*----------------------------------------------------------------*32740052
327500                                                                  32750052
327600 6105-READ-SEL-QUEUE.                                             32760052
327700                                                                  32770052
327800     EXEC CICS                                                    32780052
327900          READQ TS                                                32790052
328000              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      32800052
328100              INTO  (PC016-TS-SEL-REC)                            32810052
328200              ITEM  (PV-SEL-QUEUE-ITEM)                           32820052
328300              RESP  (PV-CICS-RESP)                                32830052
328400     END-EXEC.                                                    32840052
328500                                                                  32850052
328600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          32860052
328700         CONTINUE                                                 32870052
328800     ELSE                                                         32880052
328900         SET DP013-CICS-ABEND      TO TRUE                        32890052
329000         SET DP013-NO-ROLLBACK     TO TRUE                        32900052
329100         MOVE '6105-READ-SEL-QUEUE'                               32910052
329200                                   TO DP013-PARAGRAPH             32920052
329300         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           32930052
329400                                   TO DP013-MESSAGE-TEXT(1)       32940052
329500         PERFORM DP013-0000-PROCESS-ABEND                         32950052
329600     END-IF.                                                      32960052
329700                                                                  32970052
329800/                                                                 32980052
329900*----------------------------------------------------------------*32990052
330000*    READ THE LIST QUEUE RECORD.                                 *33000052
330100*----------------------------------------------------------------*33010052
330200                                                                  33020052
330300 6106-READ-SEL-QUEUE2.                                            33030052
330400                                                                  33040052
330500     EXEC CICS                                                    33050052
330600          READQ TS                                                33060052
330700              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      33070052
330800              INTO  (RC013-DC-SELECT-RECORD)                      33080052
330900              ITEM  (PV-SEL-QUEUE-ITEM)                           33090052
331000              RESP  (PV-CICS-RESP)                                33100052
331100     END-EXEC.                                                    33110052
331200                                                                  33120052
331300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          33130052
331400         CONTINUE                                                 33140052
331500     ELSE                                                         33150052
331600         SET DP013-CICS-ABEND      TO TRUE                        33160052
331700         SET DP013-NO-ROLLBACK     TO TRUE                        33170052
331800         MOVE '6106-READ-SEL-QUEUE2'                              33180052
331900                                   TO DP013-PARAGRAPH             33190052
332000         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           33200052
332100                                   TO DP013-MESSAGE-TEXT(1)       33210052
332200         PERFORM DP013-0000-PROCESS-ABEND                         33220052
332300     END-IF.                                                      33230052
332400/                                                                 33240052
332500*----------------------------------------------------------------*33250052
332600*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*33260052
332700*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*33270052
332800*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *33280052
332900*----------------------------------------------------------------*33290052
333000                                                                  33300052
333100 6109-PROCESS-ITEMS2.                                             33310052
333200                                                                  33320052
333300     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          33330052
333400                     / PC-ITEMS-PER-PANEL).                       33340052
333500                                                                  33350052
333600     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           33360052
333700         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          33370052
333800             PERFORM 6111-WRITE-LIST-QUEUE                        33380052
333900         END-IF                                                   33390052
334000         MOVE PV-ITEM              TO PV-SAVE-ITEM                33400052
334100                                                                  33410052
334200         PERFORM 6112-READ-LIST-QUEUE                             33420052
334300         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               33430052
334400             CONTINUE                                             33440052
334500         END-IF                                                   33450052
334600     END-IF.                                                      33460052
334700                                                                  33470052
334800     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX)                     33480052
334900                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              33490052
335000                                                                  33500052
335100     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       33510052
335200     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        33520052
335300                                     (PV-SUB).                    33530052
335400     EVALUATE TRUE                                                33540052
335500         WHEN RC013-INQ (RC013-IDX)                               33550052
335600              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             33560052
335700                                                                  33570052
335800         WHEN RC013-UPD (RC013-IDX)                               33580052
335900              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             33590052
336000                                                                  33600052
336100         WHEN RC013-DEL (RC013-IDX)                               33610052
336200              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             33620052
336300                                                                  33630052
336400         WHEN RC013-ERR (RC013-IDX)                               33640052
336500              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             33650052
336600     END-EVALUATE.                                                33660052
336700                                                                  33670052
336800     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                33680052
336900/                                                                 33690052
337000*----------------------------------------------------------------*33700052
337100*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*33710052
337200*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*33720052
337300*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *33730052
337400*----------------------------------------------------------------*33740052
337500                                                                  33750052
337600 6110-PROCESS-ITEMS.                                              33760052
337700                                                                  33770052
337800     COMPUTE PV-ITEM = 1 + ((PC016-ITEM (PC016-IDX) - 1)          33780052
337900                     / PC-ITEMS-PER-PANEL).                       33790052
338000                                                                  33800052
338100     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           33810052
338200         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          33820052
338300             PERFORM 6111-WRITE-LIST-QUEUE                        33830052
338400         END-IF                                                   33840052
338500         MOVE PV-ITEM              TO PV-SAVE-ITEM                33850052
338600                                                                  33860052
338700         PERFORM 6112-READ-LIST-QUEUE                             33870052
338800         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               33880052
338900             CONTINUE                                             33890052
339000         END-IF                                                   33900052
339100     END-IF.                                                      33910052
339200                                                                  33920052
339300     COMPUTE PV-SUB = (PC016-ITEM (PC016-IDX)                     33930052
339400                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              33940052
339500                                                                  33950052
339600     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       33960052
339700     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        33970052
339800                                     (PV-SUB).                    33980052
339900     EVALUATE TRUE                                                33990052
340000         WHEN PC016-INQ (PC016-IDX)                               34000052
340100              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             34010052
340200                                                                  34020052
340300         WHEN PC016-UPD (PC016-IDX)                               34030052
340400              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             34040052
340500                                                                  34050052
340600         WHEN PC016-DEL (PC016-IDX)                               34060052
340700              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             34070052
340800                                                                  34080052
340900         WHEN PC016-ERR (PC016-IDX)                               34090052
341000              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             34100052
341100     END-EVALUATE.                                                34110052
341200                                                                  34120052
341300     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                34130052
341400/                                                                 34140052
341500*----------------------------------------------------------------*34150052
341600*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *34160052
341700*----------------------------------------------------------------*34170052
341800                                                                  34180052
341900 6111-WRITE-LIST-QUEUE.                                           34190052
342000                                                                  34200052
342100     EXEC CICS                                                    34210052
342200         WRITEQ TS                                                34220052
342300             QUEUE (ASC-LIST-QUEUE-NAME)                          34230052
342400             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     34240052
342500             ITEM  (PV-SAVE-ITEM)                                 34250052
342600             REWRITE                                              34260052
342700             RESP  (PV-CICS-RESP)                                 34270052
342800     END-EXEC.                                                    34280052
342900                                                                  34290052
343000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          34300052
343100         CONTINUE                                                 34310052
343200     ELSE                                                         34320052
343300         SET DP013-CICS-ABEND      TO TRUE                        34330052
343400         SET DP013-NO-ROLLBACK     TO TRUE                        34340052
343500         MOVE '6111-WRITE-LIST-QUEUE'                             34350052
343600                                   TO DP013-PARAGRAPH             34360052
343700         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  34370052
343800                                   TO DP013-MESSAGE-TEXT(1)       34380052
343900         PERFORM DP013-0000-PROCESS-ABEND                         34390052
344000     END-IF.                                                      34400052
344100                                                                  34410052
344200/                                                                 34420052
344300*----------------------------------------------------------------*34430052
344400*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*34440052
344500*----------------------------------------------------------------*34450052
344600                                                                  34460052
344700 6112-READ-LIST-QUEUE.                                            34470052
344800                                                                  34480052
344900     EXEC CICS                                                    34490052
345000         READQ TS                                                 34500052
345100             QUEUE (ASC-LIST-QUEUE-NAME)                          34510052
345200             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     34520052
345300             ITEM  (PV-ITEM)                                      34530052
345400             RESP  (PV-CICS-RESP)                                 34540052
345500     END-EXEC.                                                    34550052
345600                                                                  34560052
345700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          34570052
345800         CONTINUE                                                 34580052
345900     ELSE                                                         34590052
346000         SET DP013-CICS-ABEND      TO TRUE                        34600052
346100         SET DP013-NO-ROLLBACK     TO TRUE                        34610052
346200         MOVE '6112-READ-LIST-QUEUE'                              34620052
346300                                   TO DP013-PARAGRAPH             34630052
346400         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    34640052
346500                                   TO DP013-MESSAGE-TEXT(1)       34650052
346600         PERFORM DP013-0000-PROCESS-ABEND                         34660052
346700     END-IF.                                                      34670052
346800                                                                  34680052
346900/                                                                 34690052
347000******************************************************************34700052
347100* DELETE THE LIST QUEUE WHEN PREV-SEL OR NEXT-SEL WAS ENTERED.   *34710052
347200******************************************************************34720052
347300 6200-DEL-LIST-QUEUE.                                             34730052
347400                                                                  34740052
347500     EXEC CICS                                                    34750052
347600         DELETEQ TS                                               34760052
347700             QUEUE (ASC-LIST-QUEUE-NAME)                          34770052
347800             RESP  (PV-CICS-RESP)                                 34780052
347900     END-EXEC.                                                    34790052
348000                                                                  34800052
348100     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      34810052
348200        (PV-CICS-RESP = DFHRESP(QIDERR)))                         34820052
348300         CONTINUE                                                 34830052
348400     ELSE                                                         34840052
348500        SET DP013-CICS-ABEND       TO TRUE                        34850052
348600        SET DP013-NO-ROLLBACK      TO TRUE                        34860052
348700        MOVE '6200-DEL-LIST-QUEUE' TO DP013-PARAGRAPH             34870052
348800        MOVE 'ERROR TRYING TO DELETE LIST TS QUEUE'               34880052
348900                                   TO DP013-MESSAGE-TEXT (1)      34890052
349000        PERFORM DP013-0000-PROCESS-ABEND                          34900052
349100     END-IF.                                                      34910052
349200                                                                  34920052
349300/                                                                 34930052
349400 7000-FORMAT-COMMAREA.                                            34940052
349500                                                                  34950052
349700     MOVE 1                      TO PV-BLOCK-NUMBER.              34970053
350100                                                                  35010052
350200     MOVE ASC-OPR-ID             TO PC000-OPERATING-UNIT-ID.      35020052
350300     MOVE ASC-FACT               TO PC000-FACILITY-ID.            35030052
350400     MOVE ASC-PO-NBR             TO PC000-PO-NBR-N.               35040052
350500     MOVE ASC-REC-SEQ-NBR        TO PC000-REC-SEQ-NBR-N.          35050052
350600     MOVE PC-WORK-ORDER-DIST-SHEET                                35060052
350700                                 TO PC000-REPORT-ID.              35070052
350800                                                                  35080052
350900     PERFORM VARYING PV-SUB FROM 1 BY 1                           35090052
351000             UNTIL PV-SUB > PC-ITEMS-PER-PANEL                    35100052
351100         IF ASC-SELECTED-SW  (PV-BLOCK-NUMBER PV-SUB) = 'S'       35110052
351200            MOVE ASC-LINE-NUMBER       (PV-BLOCK-NUMBER PV-SUB)   35120052
351300                                 TO PC000-LINE-NBR-N              35130052
351400            MOVE ASC-DEPT              (PV-BLOCK-NUMBER PV-SUB)   35140052
351500                                 TO PC000-DEPT-NBR                35150052
351600            MOVE ASC-ENT-ID            (PV-BLOCK-NUMBER PV-SUB)   35160052
351700                                 TO PC000-ENT-ID                  35170052
351800**-->       ** UPON THE 1ST HIT, END THE LOOP BY BUMPING UP PV-SUB35180052
351900            COMPUTE PV-SUB = PC-ITEMS-PER-PANEL + 1               35190052
352000         END-IF                                                   35200052
352100     END-PERFORM.                                                 35210052
352200                                                                  35220052
352300/                                                                 35230052
352400******************************************************************35240052
352500* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *35250052
352600******************************************************************35260052
352700 9100-READ-SEL-QUEUE.                                             35270052
352800     EXEC CICS                                                    35280052
352900         READQ TS                                                 35290052
353000             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        35300052
353100             INTO  (PC016-TS-SEL-REC)                             35310052
353200             ITEM  (ASC-SEL-ITEM)                                 35320052
353300             RESP  (PV-CICS-RESP)                                 35330052
353400     END-EXEC.                                                    35340052
353500                                                                  35350052
353600     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        35360052
353700         CONTINUE                                                 35370052
353800     ELSE                                                         35380052
353900         SET DP013-LOGIC-ABEND                                    35390052
354000             DP013-NO-ROLLBACK     TO TRUE                        35400052
354100         MOVE '9100-READ-SEL-QUEUE'                               35410052
354200                                   TO DP013-PARAGRAPH             35420052
354300         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    35430052
354400                                   TO DP013-MESSAGE-TEXT (1)      35440052
354500         PERFORM DP013-0000-PROCESS-ABEND                         35450052
354600     END-IF.                                                      35460052
354700                                                                  35470052
354800/                                                                 35480052
354900******************************************************************35490052
355000* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *35500052
355100******************************************************************35510052
355200 9200-REWRITE-LIST-QUEUE.                                         35520052
355300     EXEC CICS                                                    35530052
355400          WRITEQ TS                                               35540052
355500              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     35550052
355600              FROM    (PC016-TS-SEL-REC)                          35560052
355700              ITEM    (ASC-SEL-ITEM)                              35570052
355800              RESP    (PV-CICS-RESP)                              35580052
355900              REWRITE                                             35590052
356000     END-EXEC.                                                    35600052
356100                                                                  35610052
356200     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    35620052
356300         SET DP013-CICS-ABEND                                     35630052
356400             DP013-NO-ROLLBACK     TO TRUE                        35640052
356500         MOVE '9200-REWRITE-LIST-QUEUE'                           35650052
356600                                   TO DP013-PARAGRAPH             35660052
356700         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   35670052
356800                                   TO DP013-MESSAGE-TEXT (1)      35680052
356900         PERFORM DP013-0000-PROCESS-ABEND                         35690052
357000     END-IF.                                                      35700052
357100                                                                  35710052
357200/                                                                 35720052
357300******************************************************************35730052
357400* READ AN ITEM FROM THE INPUT SELECTED PACK SLIP ITEMS           *35740052
357500* TEMP STORAGE QUEUE.                                            *35750052
357600******************************************************************35760052
357700 9300-READ-PKSL-SEL-QUEUE.                                        35770052
357800                                                                  35780052
357900     EXEC CICS                                                    35790052
358000         READQ TS                                                 35800052
358100             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        35810052
358200             INTO  (RC013-DC-SELECT-RECORD)                       35820052
358300             ITEM  (ASC-SEL-ITEM)                                 35830052
358400             RESP  (PV-CICS-RESP)                                 35840052
358500     END-EXEC.                                                    35850052
358600                                                                  35860052
358700     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        35870052
358800         CONTINUE                                                 35880052
358900     ELSE                                                         35890052
359000         SET DP013-LOGIC-ABEND                                    35900052
359100             DP013-NO-ROLLBACK     TO TRUE                        35910052
359200         MOVE '9300-READ-PKSL-SEL-QUEUE'                          35920052
359300                                   TO DP013-PARAGRAPH             35930052
359400         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    35940052
359500                                   TO DP013-MESSAGE-TEXT (1)      35950052
359600         PERFORM DP013-0000-PROCESS-ABEND                         35960052
359700     END-IF.                                                      35970052
359800                                                                  35980052
359900/                                                                 35990052
360000******************************************************************36000052
360100* UPDATE AN ITEM IN THE INPUT SELECTED PACK SLIP ITEMS           *36010052
360200* TEMP STORAGE QUEUE.                                            *36020052
360300******************************************************************36030052
360400 9400-REWRITE-PKSL-LIST-QUEUE.                                    36040052
360500                                                                  36050052
360600     EXEC CICS                                                    36060052
360700          WRITEQ TS                                               36070052
360800              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     36080052
360900              FROM    (RC013-DC-SELECT-RECORD)                    36090052
361000              ITEM    (ASC-SEL-ITEM)                              36100052
361100              RESP    (PV-CICS-RESP)                              36110052
361200              REWRITE                                             36120052
361300     END-EXEC.                                                    36130052
361400                                                                  36140052
361500     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    36150052
361600         SET DP013-CICS-ABEND                                     36160052
361700             DP013-NO-ROLLBACK     TO TRUE                        36170052
361800         MOVE '9400-REWRITE-PKSL-LIST-QUEUE'                      36180052
361900                                   TO DP013-PARAGRAPH             36190052
362000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   36200052
362100                                   TO DP013-MESSAGE-TEXT (1)      36210052
362200         PERFORM DP013-0000-PROCESS-ABEND                         36220052
362300     END-IF.                                                      36230052
362400                                                                  36240052
362500/                                                                 36250052
362600*----------------------------------------------------------------*36260052
362700*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *36270052
362800*    AND THE ERROR SWITCHES.                                     *36280052
362900*----------------------------------------------------------------*36290052
363000 9900-SOFT-ABORT.                                                 36300052
363100     SET PS-ERROR         TO TRUE.                                36310052
363200     SET DP020-MSG-FATAL  TO TRUE.                                36320052
363300     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    36330052
363400     SET  DP020-NEXT-ACT-APPL-ERROR TO TRUE.                      36340052
363500     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       36350052
363600     PERFORM 0001-CALL-CICS-ARCH-API.                             36360052
363700                                                                  36370052
363800*----------------------------------------------------------------*36380052
363900*    ABEND PROCESSOR MODULE                                      *36390052
364000*----------------------------------------------------------------*36400052
364100                                                                  36410052
364200     COPY DPPD013.                                                36420052
