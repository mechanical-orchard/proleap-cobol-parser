       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.    MLKUP021.                                         00020000
       AUTHOR.        MARC BLAZICH - GREENBRIER & RUSSEL.               00030000
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
       DATE-WRITTEN.  11/01/93.                                         00050000
       DATE-COMPILED.                                                   00060000
      ******************************************************************00070000
      *  MERCHANDISE LEDGER EDIT MODULE                                 00080000
      ******************************************************************00090000
      *  !!! THIS PROGRAM IS EXECUTED IN JOBS MLK140 AND MWK178 !!!     00100000
      ******************************************************************00110000
      * 07/05/96 -- S. WERNER  :  PREVIOUS STORE LIMIT OF 200 WAS      *00120000
      *                           CHANGED TO ALLOW FOR UP TO 999       *00130000
      *                           STORES.                              *00140000
      ******************************************************************00150000
      *  CHANGES:                                                       00160000
      *    TOM MEDREK 2/97 - FAST SYSTEM CHANGES                        00170000
      *    ADDED LOGIC TO IDENTIFY FAST STORE TRANSFERS ON REPORTS AND  00180000
      *    ON DD OUT06 TO BE PRINTED IN THE FOLLOWING REPORT: MLKRP053. 00190000
      *    ALSO ADDED STORE NUMBER AND SEQUENCE NUMBER TO THE TRANSFER  00200000
      *    DOCUMENT NUMBER FOR FAST TRANSFERS WRITTEN TO DD OUT05       00210000
      *    (EDIT SPLIT REPORT FILE).                                    00220000
      ******************************************************************00230000
      *    10/27/97 - KARI SUTTON - WR# 5408 (MARKDOWN/UP REPORT)       00240000
      *       MODIFIED G130-WRITE-OUTPUT-FILES TO MOVE ONE NEW FIELD    00250000
      *       THAT WAS ADDED TO MLRD020 TO MLRD023.  THE FIELD IS       00260000
      *       ML020-PC-MKDN-MKUP-RSN-CDE.                               00270000
      ******************************************************************00280000
      *    12/04/97 - DMH - WR# 5830                                    00290000
      *       MODIFIED E130-WRITE-OUTPUT-FILES TO MOVE ONE NEW FIELD    00300000
      *       THAT WAS ADDED TO MLRD020 TO MLRD022.  THE FIELD IS       00310000
      *       ML020-SALE-TYPE-2.                                        00320000
      ******************************************************************00330000
      *    06/09/99 - PAUL KEBER - WR# 10764                            00340000
      *       MODIFIED E130-WRITE-OUTPUT-FILES TO MOVE NEW FIELD        00350000
      *       ML020-SALE-CORR-CDE TO NEW FIELD ML022-SALE-CORR-CDE.     00360000
1099RM******************************************************************00370000
1099RM*    10/15/99 - BOB MCASEY 10587                                  00380000
1099RM*       ADDED CODE TO MOVE THE IN-HOUSE NUMBER FROM THE PRICE     00390000
1099RM*       CHANGE INPUT RECORD TO THE COMPOSITE RECORD. THIS IS DONE 00400000
1099RM*       FOR VENDOR ANALYSIS VENDOR ALLOWANCE TRANSACTIONS TRAN    00410000
1099RM*       CODE '999'. (THE IN-HOUSE NUMBER FIELD ON MLRD017 IS NEW. 00420000
1099RM*       THE DATA WAS ALWAYS THERE. THE FIELD WAS JUST DEFINED.    00430000
1099RM******************************************************************00440000
      *    12/07/99 - AMY LAWSON                                        00450000
      *       REMOVED THE PRICE CHANGE EDIT THAT REQUIRED THE MARKDOWN  00460000
      *       TO BE LESS THAN $100,000.  THE MARKUP EDIT HAS NOT CHANGED00470000
1099RM******************************************************************00480000
1099RM*    12/28/99 - BOB MCASEY 20698                                  00490000
1099RM*       ADDED CODE TO MOVE THE PO-TYPE CODE FROM THE PURCHASE     00500000
1099RM*       INPUT FILE TO THE COMPOSITE RECORD.                       00510000
1099RM******************************************************************00520000
0300RM*    03/07/2000 - BOB MCASEY                                      00530000
0300RM*       ADDED CODE TO EDIT THE ML020-ADJ-DTE AGAINST THE          00540000
0300RM*       OPEN FISCAL MONTH END DATE.                               00550000
0300RM******************************************************************00560000
0600RB*    06/05/2000 - AMY LAWSON                                      00570000
0600RB*       ADDED LOGIC TO PREVENT LEDGER TRANSACTIONS FOR STORES     00580000
0600RB*       THAT ARE DOING AN ESTIMATED INVENTORY FROM BEING PASSED   00590000
0600RB*       THROUGH TO INVENTORY LEDGER.                              00600000
      *                                                                *00610000
      ******************** HISTORY OF CHANGES **************************00620000
      *                                                                *00630000
      * WR/PROJ  DATE        DESCRIPTION OF CHANGES                    *00640000
      * -------  ----------  ----------------------------------------  *00650000
      * 0201     02/20/2001  SCOTT JACKSON                              00660000
      *                      WHEN CONTROL-CARD IS SET UP AS             00670000
      *                      'INV ONLY/NO DATE-CHECKING' LOGIC IS NEEDED00680000
      *                      TO PREVENT TRANSACTION FOR ESTIMATED STRS  00690000
      *                      BEING PASSED THRU TO INVENTORY LEDGER.     00700000
      * 21015    02/27/2001  ROD JANSSEN                               *00710000
      *                      EDIT SPLIT REPORT MODS. BREAK PURCHASES   *00720000
      *                      OUT AS ADJUSTMENTS AND RECEIPTS.          *00730000
RB0401* 21591    02/28/2001  RONNA BUTZ                                *00740000
RB0401*                      (LOOK FOR RB0401 OR 21591 TO IDENTIFY)    *00750000
RB0401*                      CHANGES ARE TO HANDLE STORES THAT ARE     *00760000
RB0401*                      DOING MANIFESTING.                        *00770000
RB0401*                      IF A STORE IS DOING MANIFESTING,          *00780000
RB0401*                      THEN USE THE STORE'S PLANNED INVENTORY    *00790000
RB0401*                      DATE INSTEAD OF THE DC CUTOFF DATE.       *00800000
RB0401*                                                                *00810000
      *                      ADDITIONAL CHANGE TO PROCESS IN-TRANSIT   *00820000
      *                      REVERSAL TRANSACTION TO INVENTORY LEDGER  *00830000
      *                                                                *00840000
W21731* 21731    04/02/2002  SCOTT JACKSON       NEWSKU                *00850000
W21731*                      ALL COPYBOOKS HAVE BEEN CHANGED TO        *00860000
W21731*                      POPULATE NEW SKU ATTRIBUTES COMING FROM   *00870000
W21731*                      MLKUP020. CHANGES ALSO MADE TO ACCOMODATE  00880000
W21731*                      NEW FIELD NAMES. 'SKU' IS NOW AN 8-BYTE   *00890000
W21731*                                                                 00900000
      ******************************************************************00910000
W04252*    04/25/2002 - ROD JANSSEN      CHANGE ID: 22055               00920000
W04252*       EXPAND THE STORE TABLE TO 999.                            00930000
W26603* W26603  03-08-2004 ROD JANSSEN MERCH LEDGER STORE EXPANSION     00940008
R26603* W26603  06-08-2004 ROD JANSSEN ADJUSTMENT RECORD TRUNCATION     00950008
W27261******************************************************************00960000
W27261* 27261    07-19-2004 J.M. DRAWS - CHANGES TO ALLOW DAILY         00970000
W27261*          PROCESSING OF SALES AND MARKDOWNS. DURING CUTOFF WEEK  00980000
W27261*          A DATE OVER-RIDE IS REQUIRED. AN INDICATOR IS BROUGHT I00990000
W27261*          VIA THE EXISTING CONTROL CARD. IT DIRECTS THE USE OF AN01000000
W27261*          ALTERNATE DATE DURING DATE RANGE CHECKING IN E120-     01010000
W27261******************************************************************01020000
R27261* 27261    07-26-2004 R. MCDONALD - FIX TO CHANGES FOR W27261.    01030000
R27261*          THE NEW FIELDS IN THE CONTROL CARD ARE                 01040008
R27261*          CC-DAILY-CUTOFF-IND AND CC-DGM-RUN-IND.  THIS FIX WILL 01050008
R27261*          ALLOW BOTH OF THESE FIELDS TO BE BLANKS.               01060008
R27261*          IF BOTH FIELDS ARE NOT BLANKS THEN PERFORM THE EDITS   01070008
R27261*          ON THE NEW FIELDS AND PROCESS ACCORDINGLY.             01080008
R27261******************************************************************01090000
679223*P00679223 08-06-2004 R.JANSSEN                                   01100000
679223*          S07C ABEND IN MLKRP053.... (8/6/2004)                  01110008
W20445******************************************************************01120000
      * W26006   09-20-2004 V. LEE YANG                                 01130000
      *          ADD CHECK TO DROP ERRED OUT TRANSACTIONS FOR           01140008
      *          FINANCIALLY CLOSED STORES/LOCATIONS.                   01150008
W20445* W20445   09-01-2004 R. JANSSEN DETAILED INVNENTORY ADJUSTMENT   01160008
W26006* W26006   05-26-2005 R. JANSSEN TRANSFER EXCEPTION REPORT TRUNC  01170008
W26006*                                ISSUE.                           01180008
26006R* 26006    07-20-2005 R. JANSSEN ISSUE WITH TRANSFER GOING TO     01190008
26006R*                                UNKNOWN VENDOR.                  01200008
26006R* 26006    07-20-2005 R. JANSSEN ISSUE WITH TRANSFER GOING TO     01210008
26006R*                                UNKNOWN VENDOR.                  01220008
W29145*W29145    10-12-2005 S. JACKSON ADD OUT07 AND COPYBOOK MLRD033   01230008
W29145*                                FOR DATA WAREHOUSE PRICE CHGS    01240008
R29145*          10-27-2005 RONNA M.   FIX BUG WHERE THE                01250008
R29145*                                ML033-PC-TYP-CDE IS NOT GETTING  01260008
R29145*                                SET.  IT IS SET IN THE MKDWN     01270008
R29145*                                AND MKUP EDITS.                  01280008
S29145*S29145    11-20-2005 S. JACKSON ADDITIONAL FIELDS REQ'D FOR DW   01290008
W28582*W28582    11-22-2005 C.MCCAMMON ADD OUT08 & 09, DATAMAP FIELDS.  01300008
W26606*W28582    01-24-2006 J. SELWITSCHKA                              01310008
W26606*                                PRICE CHANGE COPYBOOKS EXPANSION.01320008
W26606*                                MODIFIED PRC-CHG-FILE LRECL.     01330008
W26606*                                PICK-UP MLRD033 CHANGES.         01340008
W28545*W28545    06-12-2006 S. JACKSON INCORPORATE CYCLE INVENTORY PARM 01350008
S28545*S28545    08-29-2006 S. JACKSON FOR TRANSACTIONS AFTER FIN BOOK  01360008
W32898*W32898    10-15-2007 J. SELWITSCHKA - BRAND VENDOR PHASE II      01370008
W32898*                                ASSIGN ML030-PURCH-LBL-SEQ-NBR.  01380008
W31475* W31475   04-24-2009 COGNIZANT - ML BATCH PERFORMANCE TUNING     01390008
W31475*                                  CHANGES FOR REDUCING BATCH     01400008
W31475*                                  WINDOW                         01410008
W33304*W33304    05-23-2008 J. LIN     HOLDING INVENTORY LEDGER OPEN    01420008
W33304*                                ACROSS PERIODS                   01430008
P49345*P49345    01-23-2015 COGNIZANT  MODIFIED THE CODE TO ERROR THE   01440008
P49345*                                PURCHASE/TRANSFER ADJUSTMENT     01450008
P49345*                                TRANSACTIONS WHICH HAS THE       01460008
P49345*                                EXTENDED RETAIL AMOUNT GREATER   01470008
P49345*                                THAN 9,999,999.99 TO AVOID THE   01480008
P49345*                                TRUNCATION DOWN THE LINE.        01490008
      *          04-10-2022 B. MCASEY  CHANGED COST/RETAIL FIELDS TO    01500018
      *                                ALLOW FOR 99B. CURRENTLY FIELDS  01510020
      *                                WERE BEING TRUNCATED. EXPANDED   01511018
      *                                BOTH REPORTS TO 150 BYES WIDE.   01512023
      *                                FIXED PAGING OF EXCEPTION REPORT 01513023
      ******************************************************************01520000
                                                                        01530000
       ENVIRONMENT DIVISION.                                            01540000
       CONFIGURATION SECTION.                                           01550000
       INPUT-OUTPUT SECTION.                                            01560000
       FILE-CONTROL.                                                    01570000
                                                                        01580000
           SELECT COMPOSITE-FILE                                        01590000
               ASSIGN TO INP01.                                         01600000
                                                                        01610000
           SELECT CONTROL-CARD-FILE                                     01620000
               ASSIGN TO INP02.                                         01630000
                                                                        01640000
           SELECT PURCH-FILE                                            01650000
               ASSIGN TO OUT01.                                         01660000
                                                                        01670000
           SELECT SALE-FILE                                             01680000
               ASSIGN TO OUT02.                                         01690000
                                                                        01700000
           SELECT PRC-CHG-FILE                                          01710000
               ASSIGN TO OUT03.                                         01720000
                                                                        01730000
           SELECT ADJUSTMENT-FILE                                       01740000
               ASSIGN TO OUT04.                                         01750000
                                                                        01760000
           SELECT REPORT-FILE                                           01770000
               ASSIGN TO OUT05.                                         01780000
                                                                        01790000
           SELECT ERROR-FILE                                            01800000
               ASSIGN TO OUT06.                                         01810000
                                                                        01820000
W29145     SELECT DW-PRC-CHG-FILE                                       01830000
W29145         ASSIGN TO OUT07.                                         01840000
W28582                                                                  01850000
W28582     SELECT BV-PURCH-FILE                                         01860000
W28582         ASSIGN TO OUT08.                                         01870000
W28582                                                                  01880000
W28582     SELECT BV-PRC-CHG-FILE                                       01890000
W28582         ASSIGN TO OUT09.                                         01900000
                                                                        01910000
           SELECT AUDIT-REPORT-FILE                                     01920000
               ASSIGN TO RPT01.                                         01930000
                                                                        01940000
           SELECT EXCEPTIONS-REPORT-FILE                                01950000
               ASSIGN TO RPT02.                                         01960000
                                                                        01970000
       DATA DIVISION.                                                   01980000
       FILE SECTION.                                                    01990000
                                                                        02000000
       FD  COMPOSITE-FILE                                               02010000
           RECORDING  MODE IS F.                                        02020000
W26603 01  COMPOSITE-REC                    PIC X(175).                 02030000
                                                                        02040000
       FD  CONTROL-CARD-FILE                                            02050000
           RECORDING  MODE IS F.                                        02060000
       01  CONTROL-CARD-REC                 PIC X(80).                  02070000
                                                                        02080000
       FD  PURCH-FILE                                                   02090000
           RECORDING  MODE IS F                                         02100000
           BLOCK CONTAINS 0 RECORDS.                                    02110000
       01  PURCH-REC                        PIC X(150).                 02120000
                                                                        02130000
       FD  SALE-FILE                                                    02140000
           RECORDING  MODE IS F                                         02150000
           BLOCK CONTAINS 0 RECORDS.                                    02160000
       01  SALE-REC                         PIC X(80).                  02170000
                                                                        02180000
       FD  PRC-CHG-FILE                                                 02190000
           RECORDING  MODE IS F                                         02200000
           BLOCK CONTAINS 0 RECORDS.                                    02210000
W26606 01  PRC-CHG-REC                      PIC X(130).                 02220000
                                                                        02230000
       FD  ADJUSTMENT-FILE                                              02240000
           RECORDING  MODE IS F                                         02250000
           BLOCK CONTAINS 0 RECORDS.                                    02260000
       01  ADJUSTMENT-REC                   PIC X(90).                  02270000
                                                                        02280000
       FD  ERROR-FILE                                                   02290000
           RECORDING  MODE IS F                                         02300000
           BLOCK CONTAINS 0 RECORDS.                                    02310000
R26603 01  ERROR-REC                        PIC X(260).                 02320000
                                                                        02330000
       FD  DW-PRC-CHG-FILE                                              02340000
           RECORDING  MODE IS F                                         02350000
           BLOCK CONTAINS 0 RECORDS.                                    02360000
       01  DW-PRC-CHG-REC                   PIC X(150).                 02370000
                                                                        02380000
       FD  REPORT-FILE                                                  02390000
           RECORDING  MODE IS F                                         02400000
           BLOCK CONTAINS 0 RECORDS.                                    02410000
       01  REPORT-REC                       PIC X(80).                  02420000
                                                                        02430000
W28582 FD  BV-PRC-CHG-FILE                                              02440000
W28582     RECORDING  MODE IS F                                         02450000
W28582     BLOCK CONTAINS 0 RECORDS.                                    02460000
W28582 01  BV-PRC-CHG-REC                   PIC X(200).                 02470000
W28582                                                                  02480000
W28582 FD  BV-PURCH-FILE                                                02490000
W28582     RECORDING  MODE IS F                                         02500000
W28582     BLOCK CONTAINS 0 RECORDS.                                    02510000
W28582 01  BV-PURCH-REC                     PIC X(200).                 02520000
W28582                                                                  02530000
       FD  AUDIT-REPORT-FILE                                            02540000
           LABEL RECORDS ARE OMITTED                                    02550000
0422RM*    RECORD CONTAINS 133 CHARACTERS                               02560008
0422RM     RECORD CONTAINS 151 CHARACTERS                               02570008
           RECORDING  MODE IS F                                         02580000
           DATA RECORD IS AUDIT-LINE.                                   02590000
       01  AUDIT-LINE.                                                  02600000
           05  AUDIT-LINE-CC     PIC X(001).                            02610000
0422RM*    05  AUDIT-LINE-DATA   PIC X(132).                            02620008
0422RM     05  AUDIT-LINE-DATA   PIC X(150).                            02630024
           05  FILLER REDEFINES  AUDIT-LINE-DATA.                       02640000
0422RM*        10  FILLER        PIC X(131).                            02650008
0422RM         10  FILLER        PIC X(149).                            02660024
               10  AUDIT-HEADER-FONT-INDICATOR                          02670000
                                 PIC X(001).                            02680000
                                                                        02690000
                                                                        02700024
       FD  EXCEPTIONS-REPORT-FILE                                       02701024
           LABEL RECORDS ARE OMITTED                                    02710000
0422RM*    RECORD CONTAINS 133 CHARACTERS                               02720008
0422RM     RECORD CONTAINS 151 CHARACTERS                               02730008
           RECORDING  MODE IS F                                         02740000
           DATA RECORD IS EXCEPTIONS-LINE.                              02750000
       01  EXCEPTIONS-LINE.                                             02760000
           05  EXCEPTIONS-LINE-CC   PIC X(001).                         02770000
0422RM*    05  EXCEPTIONS-LINE-DATA PIC X(132).                         02780008
0422RM     05  EXCEPTIONS-LINE-DATA PIC X(150).                         02790019
           05  FILLER REDEFINES  EXCEPTIONS-LINE-DATA.                  02800000
0422RM*        10  FILLER        PIC X(131).                            02810008
0422RM         10  FILLER        PIC X(149).                            02820024
               10  EX-HEADER-FONT-INDICATOR                             02830000
                                 PIC X(001).                            02840000
       EJECT                                                            02850000
       WORKING-STORAGE SECTION.                                         02860000
                                                                        02870000
       01  CC-CONTROL-CARD.                                             02880000
W27261     05  CC-CALENDAR-TYPE                PIC X(02).               02890000
W27261     05  FILLER                          PIC X(01).               02900000
W27261*================================================================*02910008
W27261* FOR THE DAILY GROSS MARGIN RUNS CC-DGM-DATE-BEING-PROCESSED IS  02920008
W27261* THE ACTUAL DATE OF THE DATA BEING PROCESSED. DAILY GROSS MARGIN 02930008
W27261* RUNS USING JOBS MLK040 AND MKL041.                              02940008
W27261*================================================================*02950008
W27261     05  CC-DGM-DATE-BEING-PROCESSED     PIC X(10).               02960000
W27261     05  FILLER                          PIC X(01).               02970000
W27261     05  CC-PROCESSING-MODE              PIC X(04).               02980000
               88  CC-PROCESSING-MODE-VALID    VALUE 'ML'  'INV' 'BOTH'.02990000
               88  CC-PROCESSING-MODE-ML       VALUE 'ML'  'BOTH'.      03000000
               88  CC-PROCESSING-MODE-ML-ONLY  VALUE 'ML'.              03010000
               88  CC-PROCESSING-MODE-INV      VALUE 'INV' 'BOTH'.      03020000
               88  CC-PROCESSING-MODE-INV-ONLY VALUE 'INV'.             03030000
           05  FILLER                          PIC X.                   03040000
           05  CC-CHECK-INV-DATES-SW           PIC X.                   03050000
               88  CC-CHECK-INV-DATES-SW-VALID VALUE 'Y' 'N'.           03060000
               88  CC-CHECK-INV-DATES          VALUE 'Y'.               03070000
               88  CC-DONT-CHECK-INV-DATES     VALUE 'N'.               03080000
W27261     05  FILLER                          PIC X(01).               03090000
W27261*================================================================*03100000
W27261* CC-DAILY-CUTOFF-IND IS USED ONLY FOR THE DAILY GROSS MARGIN RUNS03110000
W27261* DURING CUTOFF WEEK.                                             03120008
W27261*================================================================*03130000
W27261     05  CC-DAILY-CUTOFF-IND             PIC X(01).               03140000
W27261         88  CC-DAILY-CUTOFF-IND-IS-VALID VALUE 'Y' 'N'.          03150000
W27261     05  FILLER                          PIC X(01).               03160000
W27261*================================================================*03170000
W27261* CC-DGM-RUN-IND IS USED TO REQUEST A DAILY GROSS MARGIN RUN. WHEN03180000
W27261* SET TO 'Y' CC-DGM-PROCESSING-DATE MUST BE PROVIDED.             03190008
W27261*================================================================*03200000
W27261     05  CC-DGM-RUN-IND                  PIC X(01).               03210000
W27261     05  FILLER                          PIC X(01).               03220000
W27261     05  FILLER                          PIC X(56).               03230000
                                                                        03240000
      ***************************************************************** 03250000
      *  INPUT COMPOSITE RECORD                                         03260000
      ***************************************************************** 03270000
           COPY MLRD020.                                                03280000
                                                                        03290000
      ***************************************************************** 03300000
      *  PURCHASES                                                      03310000
      ***************************************************************** 03320000
           COPY MLRD021.                                                03330000
                                                                        03340000
      ***************************************************************** 03350000
      *  SALES                                                          03360000
      ***************************************************************** 03370000
           COPY MLRD022.                                                03380000
                                                                        03390000
      ***************************************************************** 03400000
      *  PRICE CHANGES                                                  03410000
      ***************************************************************** 03420000
           COPY MLRD023.                                                03430000
                                                                        03440000
W28582***************************************************************** 03450000
W28582*  BV PRICE CHANGES                                               03460000
W28582***************************************************************** 03470000
W28582     COPY MLRD029.                                                03480000
W28582                                                                  03490000
W28582***************************************************************** 03500000
W28582*  BV PURCHASES                                                   03510000
W28582***************************************************************** 03520000
W28582     COPY MLRD030.                                                03530000
W28582                                                                  03540000
      ***************************************************************** 03550000
      *  PRICE CHANGES FOR DATA WAREHOUSE (ORIG-CLR-DTE / MKDN-CDE)     03560000
      ***************************************************************** 03570000
           COPY MLRD033.                                                03580000
                                                                        03590000
      ***************************************************************** 03600000
      *  ADJUSTMENTS                                                    03610000
      ***************************************************************** 03620000
           COPY MLRD024.                                                03630000
                                                                        03640000
      ***************************************************************** 03650000
      *  EDIT/SPLIT REPORT                                              03660000
      ***************************************************************** 03670000
           COPY MLRD025.                                                03680000
                                                                        03690000
      ***************************************************************** 03700000
      *  ERROR FILE                                                     03710000
      ***************************************************************** 03720000
           COPY MLRD026.                                                03730000
                                                                        03740000
      ***************************************************************** 03750000
      *  ERROR CODES                                                    03760000
      ***************************************************************** 03770000
           COPY MLRD027.                                                03780000
                                                                        03790000
      ***************************************************************** 03800000
      *  STANDARD 133 BYTE REPORT HEADINGS                             *03810000
      ***************************************************************** 03820000
           COPY DPWS133O.                                               03830000
                                                                        03840000
0422RM***************************************************************** 03850008
0422RM*  STANDARD 150 BYTE REPORT HEADINGS                            * 03860008
0422RM***************************************************************** 03870008
0422RM     COPY DPWS150O.                                               03880008
                                                                        03890000
       01  PS-PROGRAM-SWITCHES.                                         03900000
           05  COMPOSITE-FILE-SW             PIC X       VALUE 'N'.     03910000
               88  END-OF-COMPOSITE-FILE                 VALUE 'Y'.     03920000
W26603     05  END-OF-XMTLOC-CURSOR-SW       PIC X       VALUE 'N'.     03930000
W26603         88  END-OF-XMTLOC-CURSOR                  VALUE 'Y'.     03940000
           05  PS-DATE-ERROR-SW            PIC X(01) VALUE 'N'.         03950000
               88  PS-NO-DATE-ERROR                  VALUE 'N'.         03960000
               88  PS-DATE-ERROR                     VALUE 'Y'.         03970000
                                                                        03980000
       01  PC-PROGRAM-CONSTANTS.                                        03990000
W26603     05  PC-MAX-STORES       PIC  S9(4)  COMP VALUE 9999.         04000000
W04252     05  PC-MAX-DEPT-CLASS   PIC  S9(5)  COMP-3 VALUE 35000.      04010000
           05  PC-END-OF-REPORT    PIC  X(133) VALUE                    04020000
              '-***  END OF REPORT ***'.                                04030000
           05  PC-AP-TRANS-CDE-XFER-TO                                  04040000
                                   PIC  X(2)   VALUE '55'.              04050000
           05  PC-INVENTORY-ONLY-MODE                                   04060000
                                   PIC  X(20)  VALUE '(INVENTORY ONLY)'.04070000
           05  PC-PIVOT-YEAR       PIC  9(02)  VALUE 80.                04080000
           05  PC-LEAP-MMDD        PIC  X(04)  VALUE '0229'.            04090000
                                                                        04100000
       01  CPU-DATE.                                                    04110000
           05  CPU-YEAR                    PIC X(02)     VALUE SPACES.  04120000
           05  CPU-MONTH                   PIC X(02)     VALUE SPACES.  04130000
           05  CPU-DAY                     PIC X(02)     VALUE SPACES.  04140000
                                                                        04150000
       01  CPU-TIME.                                                    04160000
           05  CPU-HOUR                    PIC X(02)     VALUE SPACES.  04170000
           05  CPU-MINUTE                  PIC X(02)     VALUE SPACES.  04180000
           05  FILLER                      PIC X(02)     VALUE SPACES.  04190000
                                                                        04200000
       01  PV-PROGRAM-VARIABLES.                                        04210008
W26603     05  PV-LOC-NBR                  PIC 9(05)  VALUE ZEROS.      04220000
W26603     05  PV-LOC-NBR-ALPHA REDEFINES                               04230000
W26603         PV-LOC-NBR                  PIC X(05).                   04240000
W26603     05  PV-EDIT-ENT-ID              PIC 9(05)  VALUE ZEROS.      04250000
W26603     05  PV-EDIT-ENT-ID-ALPHA REDEFINES                           04260000
W26603         PV-EDIT-ENT-ID              PIC X(05).                   04270000
           05  PV-NULL-IND                 PIC S9(04) COMP VALUE ZERO.  04280000
           05  PV-AVG-COST-WHOLE           PIC S9(7).                   04290000
           05  PV-AVG-FRGT-WHOLE           PIC S9(7).                   04300000
           05  PV-NET-COST-AMT             PIC S9(9)V99  COMP-3.        04310000
           05  PV-EX-TOT-TRAN-COUNT        PIC S9(9)     COMP-3         04320000
                                                     VALUE +0.          04330000
           05  PV-EX-TOT-RETAIL            PIC S9(11)V99 COMP-3         04340000
                                                     VALUE +0.          04350000
           05  PV-DB2-OPER-ATTEMPTED       PIC X(30).                   04360000
           05  PV-DEPT-CLASS.                                           04370000
               10  DEPT-CLASS-DEPT         PIC X(3).                    04380000
               10  DEPT-CLASS-CLASS        PIC X(2).                    04390000
           05  PV-DEPT-CLASS-COUNT         PIC S9(4) COMP.              04400000
           05  PV-SAVE-ST-IDX              PIC S9(4) COMP.              04410000
           05  PV-DETAIL-ERR-SW            PIC X VALUE 'N'.             04420000
               88  PV-NO-DTL-ERROR         VALUE 'N'.                   04430000
               88  PV-DTL-ERROR            VALUE 'Y'.                   04440000
           05  PV-HIGH-LEVEL-ERR-IND       PIC X.                       04450000
               88  PV-NO-HIGH-LEVEL-ERROR  VALUE 'N'.                   04460000
               88  PV-STORE-LEVEL-ERROR    VALUE 'S'.                   04470000
23711          88  PV-DEPT-LEVEL-ERROR     VALUE 'D'.                   04480000
23711          88  PV-SKU-LEVEL-ERROR      VALUE 'K'.                   04490000
               88  PV-HIGH-LEVEL-ERROR     VALUE 'D' 'S' 'K'.           04500000
           05  PV-INV-IND                  PIC X.                       04510000
               88  PV-INV-IND-NO           VALUE 'N'.                   04520000
               88  PV-INV-IND-YES          VALUE 'Y'.                   04530000
           05  PV-ML-IND                   PIC X.                       04540000
               88  PV-ML-IND-NO            VALUE 'N'.                   04550000
               88  PV-ML-IND-YES           VALUE 'Y'.                   04560000
           05  PV-LINE-COUNT               PIC 9(2).                    04570000
           05  PV-NBR-OF-CLASSES-IN-DEPT   PIC 9(03).                   04580000
           05  PV-NET-CHANGE-IN-COST       PIC S9(13)V99 COMP-3.        04590000
           05  PV-NET-CHANGE-IN-RETAIL     PIC S9(13)V99 COMP-3.        04600000
           05  PV-PAGE-COUNT               PIC 9(5).                    04610000
           05  PV-PARA                     PIC X(30).                   04620000
           05  PV-PRICE-CHANGE             PIC S9(9)V99 COMP-3.         04630000
           05  PV-SPLIT-FREIGHT-SW         PIC X.                       04640000
               88  PV-NOT-SPLIT-FREIGHT    VALUE 'N'.                   04650000
               88  PV-SPLIT-FREIGHT        VALUE 'Y'.                   04660000
W26603     05  PV-STORE-NBR                PIC X(5).                    04670000
W27261     05  PV-DGM-DATE-BEING-PROCESSED PIC X(10) VALUE SPACES.      04680000
W27261         88  DATE-BEING-PROCESSED-IS-BLANK VALUE SPACES.          04690008
W27261     05  FILLER REDEFINES PV-DGM-DATE-BEING-PROCESSED.            04700008
W27261         10  PV-DG-FWED-CCYY         PIC 9(04).                   04710008
W27261         10  FILLER                  PIC X(01).                   04720008
W27261         10  PV-DG-FWED-MM           PIC 9(02).                   04730008
W27261         10  FILLER                  PIC X(01).                   04740008
W27261         10  PV-DG-FWED-DD           PIC 9(02).                   04750008
W27261     05  PV-DAILY-CUTOFF-IND         PIC X(01) VALUE SPACES.      04760000
W27261         88  ITS-A-DAILY-CUTOFF-RUN  VALUE 'Y'.                   04770000
W27261         88  NOT-A-DAILY-CUTOFF-RUN  VALUE 'N'.                   04780000
W27261     05  PV-DAILY-GROSS-MARGIN-RUN-IND   PIC X(01) VALUE 'N'.     04790008
W27261         88  DAILY-GROSS-MARGIN-RUN      VALUE 'Y'.               04800008
      ******************************************************************04810000
      * THE FOLLOWING FIELDS CONTAIN THE DATE-RELATED INFORMATION       04820000
      * THAT WAS RETRIEVED FROM TDTATTR FOR THE MLCNTL DATES.           04830000
      ******************************************************************04840000
           05  PV-OPN-FSCL-YR-NBR          PIC X(04).                   04850000
           05  PV-NEXT-FSCL-YR-NBR         PIC X(04).                   04860000
           05  PV-NEXT-FSCL-MN-NBR         PIC X(02).                   04870000
           05  PV-FSCL-MN-BEG-DTE          PIC X(10).                   04880000
W27261     05  PV-FSCL-MN-END-DTE          PIC X(10).                   04890000
           05  PV-PSTG-FSCL-YR-NBR         PIC X(04).                   04900000
0300RM     05  PV-ADJ-DTE                  PIC X(06).                   04910000
0300RM     05  PV-ISO-ADJ-DTE              PIC X(10).                   04920000
      ******************************************************************04930000
                                                                        04940000
           05  PV-ISO-DTE.                                              04950000
               10 PV-ISO-CCYY              PIC X(04).                   04960000
               10  FILLER                  REDEFINES                    04970000
                   PV-ISO-CCYY.                                         04980000
                   15  PV-ISO-CC           PIC X(02).                   04990000
                   15  PV-ISO-YY           PIC X(02).                   05000000
               10  FILLER                  PIC X(01) VALUE '-'.         05010000
               10  PV-ISO-MM               PIC X(02).                   05020000
               10  FILLER                  PIC X(01) VALUE '-'.         05030000
               10  PV-ISO-DD               PIC X(02).                   05040000
                                                                        05050000
           05  PV-EDIT-DTE.                                             05060000
               10  PV-EDIT-MM              PIC X(02).                   05070000
               10  PV-EDIT-DD              PIC X(02).                   05080000
               10  PV-EDIT-YY              PIC X(02).                   05090000
                                                                        05100000
           05  PV-LAST-EDIT-DTE            PIC X(06) VALUE SPACE.       05110000
                                                                        05120000
           05  PV-FIN-LIAB-DTE             PIC X(10).                   05130000
           05  PV-DB2-DTE                  PIC X(10).                   05140000
           05  PV-DB2-CCYY                 PIC S9(09) COMP.             05150000
           05  PV-DB2-MM                   PIC S9(09) COMP.             05160000
           05  PV-DB2-DD                   PIC S9(09) COMP.             05170000
           05  PV-PROC-GREG-FMT-DTE        PIC X(08).                   05180000
W31475     05  PV-DEPT-CLASS-HLD-GROUP.                                 05190008
W31475         10  PV-DEPT-HLD             PIC X(3) VALUE SPACES.       05200008
W31475         10  PV-DEPT-CLASS-HLD       PIC X(2) VALUE SPACES.       05210008
W27261*                                                                 05220008
W27261 01  PV-RUN-MESSAGES.                                             05230000
W27261     05  PV-DGM-CUTOFF-MSG       PIC X(50) VALUE                  05240000
W27261         '>> THIS IS A DAILY GROSS MARGIN CUTOFF WEEK RUN <<'.    05250000
W27261     05  PV-DGM-RUN-MSG          PIC X(45) VALUE                  05260000
W27261         '>> THIS IS A NORMAL DAILY GROSS MARGIN RUN <<'.         05270000
W27261     05  PV-NORMAL-WEEKLY-ML-MSG PIC X(52) VALUE                  05280008
W27261         '>> THIS IS A NORMAL WEEKLY MERCHANDISE LEDGER RUN <<'.  05290000
                                                                        05300000
      *    THE FOLLOWING TABLE CONTAINS ALL TRANSACTION DATES THAT      05310000
      *    HAVE BEEN EDITED.                                            05320000
                                                                        05330000
       01  EDT-MAX                          PIC S9(4) COMP VALUE +1000. 05340000
       01  EDT-EDIT-DTE-TBL.                                            05350000
           05  EDT-ENTRY                    OCCURS 1000 TIMES           05360000
                                            INDEXED BY EDT-IDX.         05370000
               10  EDT-EDIT-DTE             PIC X(06).                  05380000
               10  EDT-ISO-DTE              PIC X(10).                  05390000
               10  EDT-FSCL-YR-NBR          PIC X(04).                  05400000
               10  EDT-FSCL-MN-NBR          PIC X(02).                  05410000
               10  EDT-FSCL-WK-NBR          PIC X(02).                  05420000
               10  EDT-WK-IN-MN-NBR         PIC X.                      05430000
               10  EDT-DAY-OF-WK-NBR        PIC X.                      05440000
               10  EDT-VALID-DTE-IND        PIC X.                      05450000
                                                                        05460000
       01  STORE-TABLE.                                                 05470000
W26603     05  STORE-ENTRIES OCCURS 9999 TIMES                          05480000
W31475         ASCENDING KEY IS ST-STORE-NMBR                           05490008
               INDEXED BY ST-IDX.                                       05500000
W26603         10  ST-STORE-NMBR               PIC X(05).               05510000
W28545         10  ST-INV-ID                   PIC S9(9) COMP.          05520008
               10  ST-PLND-INV-DTE             PIC X(10).               05530000
               10  ST-ACTL-DC-CTOFF-DTE        PIC X(10).               05540000
W33304         10  ST-SCHD-INV-CDE             PIC X(02).               05550000
0600RB         10  ST-SCAN-INV-CDE             PIC X(01).               05560000
RB0401         10  ST-MFSTNG-IND               PIC X(01).               05570000
W33304         10  ST-FINCL-BK-STAT            PIC X(02).               05580000
                                                                        05590000
       01  DEPARTMENT-CLASS-TABLE.                                      05600000
W04252     05  DEPT-CLASS-ENTRIES OCCURS 35000 TIMES                    05610000
W31475         ASCENDING KEY IS DC-DEPT-CLASS                           05620008
               INDEXED BY DC-IDX                                        05630000
                          DC-IDX2.                                      05640000
               10  DC-DEPT-CLASS.                                       05650000
                   15  DC-DEPT-NBR               PIC X(03).             05660000
                   15  DC-CLASS-NBR              PIC X(02).             05670000
               10  DC-NBR-OF-CLASSES-IN-DEPT     PIC 9(03).             05680000
                                                                        05690000
       01  TR-MAX                              PIC S9(4) COMP VALUE +8. 05700000
       01  TRANS-ACCUMS-TABLE.                                          05710000
           05  TRAN-COUNTS OCCURS 8  TIMES                              05720000
               INDEXED BY TR-IDX.                                       05730000
               10  TR-TRANS-CDE                PIC X(02).               05740000
               10  TR-TRANS-CDE-DESC           PIC X(06).               05750000
               10  TR-TRANS-IN                 PIC S9(11)    COMP-3.    05760000
               10  TR-TRANS-RTL-IN             PIC S9(11)V99 COMP-3.    05770000
               10  TR-TRANS-COST-IN            PIC S9(11)V99 COMP-3.    05780000
               10  TR-TRANS-ERR                PIC S9(11)    COMP-3.    05790000
               10  TR-TRANS-RTL-ERR            PIC S9(11)V99 COMP-3.    05800000
               10  TR-TRANS-COST-ERR           PIC S9(11)V99 COMP-3.    05810000
               10  TR-TRANS-OK                 PIC S9(11)    COMP-3.    05820000
               10  TR-TRANS-RTL-OK             PIC S9(11)V99 COMP-3.    05830000
               10  TR-TRANS-COST-OK            PIC S9(11)V99 COMP-3.    05840000
                                                                        05850000
                                                                        05860000
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 05870000
      *                 A U D I T    R E P O R T   L I N E S          * 05880000
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 05890000
       01  AD-HDG1.                                                     05900000
0422RM*    05  FILLER                  PIC  X(50)    VALUE SPACES.      05910009
0422RM     05  FILLER                  PIC  X(60)    VALUE SPACES.      05920009
           05  FILLER                  PIC  X(26)    VALUE              05930000
                               'INVENTORY EDIT TOTALS FOR '.            05940000
           05  AD-HDG1-DTE             PIC  X(08).                      05950000
           05  FILLER                  PIC  X        VALUE SPACE.       05960000
           05  AD-HDG1-PROCESSING-MODE PIC  X(20)    VALUE SPACE.       05970000
                                                                        05980000
       01  AD-HDG2.                                                     05990000
           05  FILLER                  PIC  X(01)    VALUE '0'.         06000000
0422RM*    05  FILLER                  PIC  X(25)    VALUE SPACES.      06010014
0422RM     05  FILLER                  PIC  X(28)    VALUE SPACES.      06011014
           05  FILLER                  PIC  X(09)    VALUE 'I N P U T'. 06020000
0422RM*    05  FILLER                  PIC  X(32)    VALUE SPACES.      06030011
0422RM     05  FILLER                  PIC  X(34)    VALUE SPACES.      06040015
           05  FILLER                  PIC  X(09)    VALUE 'E R R O R'. 06050000
0422RM*    05  FILLER                  PIC  X(30)    VALUE SPACES.      06060014
0422RM     05  FILLER                  PIC  X(34)    VALUE SPACES.      06061015
           05  FILLER                  PIC  X(11)    VALUE              06070000
                                                          'O U T P U T'.06080000
                                                                        06090000
       01  AD-HDG3.                                                     06100000
           05  FILLER                  PIC  X(01)    VALUE SPACES.      06110000
           05  FILLER                  PIC  X(08)    VALUE              06120000
                                                     'CDE DESC'.        06130000
           05  FILLER                  PIC  X(05)    VALUE SPACES.      06140000
0422RM*    05  FILLER                  PIC  X(05)    VALUE 'TRANS'.     06150011
0422RM     05  FILLER                  PIC  X(08)    VALUE 'TRANS'.     06160011
           05  FILLER                  PIC  X(09)    VALUE SPACES.      06170000
           05  FILLER                  PIC  X(06)    VALUE 'RETAIL'.    06180000
0422RM*    05  FILLER                  PIC  X(09)    VALUE SPACES.      06190011
0422RM     05  FILLER                  PIC  X(15)    VALUE SPACES.      06200012
           05  FILLER                  PIC  X(04)    VALUE 'COST'.      06210000
           05  FILLER                  PIC  X(07)    VALUE SPACES.      06220000
           05  FILLER                  PIC  X(05)    VALUE 'TRANS'.     06230000
           05  FILLER                  PIC  X(06)    VALUE SPACES.      06240011
           05  FILLER                  PIC  X(06)    VALUE 'RETAIL'.    06250000
           05  FILLER                  PIC  X(09)    VALUE SPACES.      06260011
           05  FILLER                  PIC  X(04)    VALUE 'COST'.      06270000
           05  FILLER                  PIC  X(07)    VALUE SPACES.      06280000
           05  FILLER                  PIC  X(05)    VALUE 'TRANS'.     06290000
0422RM*    05  FILLER                  PIC  X(09)    VALUE SPACES.      06300013
0422RM     05  FILLER                  PIC  X(12)    VALUE SPACES.      06310013
           05  FILLER                  PIC  X(06)    VALUE 'RETAIL'.    06320000
0422RM*    05  FILLER                  PIC  X(12)    VALUE SPACES.      06330013
0422RM     05  FILLER                  PIC  X(15)    VALUE SPACES.      06340013
           05  FILLER                  PIC  X(04)    VALUE 'COST'.      06350000
                                                                        06360000
                                                                        06370000
       01  AUDIT-DETAIL-LINE.                                           06380000
           05  FILLER                  PIC  X(01) VALUE '0'.            06390000
           05  AD-TRANS-CDE            PIC  X(02).                      06400000
           05  FILLER                  PIC  X(01) VALUE SPACES.         06410000
           05  AD-TRANS-CDE-DESC       PIC  X(06).                      06420000
           05  FILLER                  PIC  X(01) VALUE SPACES.         06430000
           05  AD-TRANS-IN             PIC  ZZ,ZZZ,ZZZ.                 06440000
           05  FILLER                  PIC  X(01) VALUE SPACES.         06450000
0422RM*    05  AD-TRANS-RTL-IN         PIC  ZZZ,ZZZ,ZZZ.99-.            06460008
0422RM     05  AD-TRANS-RTL-IN         PIC  ZZ,ZZZ,ZZZ,ZZZ.99-.         06470008
           05  FILLER                  PIC  X(01) VALUE SPACES.         06480000
0422RM*    05  AD-TRANS-COST-IN        PIC  ZZZ,ZZZ,ZZZ.99-.            06490008
0422RM     05  AD-TRANS-COST-IN        PIC  ZZ,ZZZ,ZZZ,ZZZ.99-.         06500008
           05  FILLER                  PIC  X(01) VALUE SPACES.         06510000
           05  AD-TRANS-ERR            PIC  Z,ZZZ,ZZZ.                  06520000
           05  FILLER                  PIC  X(01) VALUE SPACES.         06530000
           05  AD-TRANS-RTL-ERR        PIC  ZZZZZ,ZZZ.99-.              06540000
           05  AD-TRANS-COST-ERR       PIC  ZZZZZ,ZZZ.99-.              06550000
           05  FILLER                  PIC  X(01) VALUE SPACES.         06560000
           05  AD-TRANS-OK             PIC  ZZ,ZZZ,ZZZ.                 06570000
           05  FILLER                  PIC  X(01) VALUE SPACES.         06580000
0422RM*    05  AD-TRANS-RTL-OK         PIC  ZZZ,ZZZ,ZZZ.99-.            06590008
0422RM     05  AD-TRANS-RTL-OK         PIC  ZZ,ZZZ,ZZZ,ZZZ.99-.         06600008
           05  FILLER                  PIC  X(01) VALUE SPACES.         06610000
0422RM*    05  AD-TRANS-COST-OK        PIC  ZZZ,ZZZ,ZZZ.99-.            06620008
0422RM     05  AD-TRANS-COST-OK        PIC  ZZ,ZZZ,ZZZ,ZZZ.99-.         06630008
                                                                        06640000
                                                                        06650000
       01  NET-CHANGE-IN-INVENTORY-LINE.                                06660000
           05  FILLER                  PIC  X(01)  VALUE '0'.           06670000
0422RM*    05  FILLER                  PIC  X(101) VALUE                06680008
0422RM     05  FILLER                  PIC  X(107) VALUE                06690008
               'NET CHANGE IN INVENTORY AS A RESULT OF THIS JOB: '.     06700000
0422RM*    05  NC-RETAIL-AMT           PIC  ZZZ,ZZZ,ZZZ.99-.            06710008
0422RM     05  NC-RETAIL-AMT           PIC  ZZ,ZZZ,ZZZ,ZZZ.99-.         06720008
           05  FILLER                  PIC  X(01) VALUE SPACES.         06730000
0422RM*    05  NC-COST-AMT             PIC  ZZZ,ZZZ,ZZZ.99-.            06740008
0422RM     05  NC-COST-AMT             PIC  ZZ,ZZZ,ZZZ,ZZZ.99-.         06750008
                                                                        06760000
                                                                        06770000
       01  EX-HDG1.                                                     06780000
0422RM*    05  FILLER                  PIC  X(45)    VALUE SPACES.      06790009
0422RM     05  FILLER                  PIC  X(54)    VALUE SPACES.      06800009
           05  FILLER                  PIC  X(19)    VALUE              06810009
                                                  'INVENTORY TRANSFER '.06820000
           05  FILLER                  PIC  X(15)    VALUE              06830000
                                                      'EXCEPTIONS FOR '.06840000
           05  EX-HDG1-DTE             PIC  X(08).                      06850000
           05  FILLER                  PIC  X        VALUE SPACE.       06860000
           05  EX-HDG1-PROCESSING-MODE PIC  X(20)    VALUE SPACE.       06870000
                                                                        06880000
       01  EX-HDG2.                                                     06890000
           05  FILLER                  PIC  X(10)    VALUE SPACES.      06900000
           05  FILLER                  PIC  X(04)    VALUE 'FROM'.      06910000
           05  FILLER                  PIC  X(06)    VALUE SPACES.      06920000
           05  FILLER                  PIC  X(02)    VALUE 'TO'.        06930000
           05  FILLER                  PIC  X(13)    VALUE SPACES.      06940000
                                                                        06950000
       01  EX-HDG3.                                                     06960000
           05  FILLER                  PIC  X(03)    VALUE SPACES.      06970000
           05  FILLER                  PIC  X(04)    VALUE 'CODE'.      06980000
           05  FILLER                  PIC  X(03)    VALUE SPACES.      06990000
           05  FILLER                  PIC  X(05)    VALUE 'STORE'.     07000000
           05  FILLER                  PIC  X(04)    VALUE SPACES.      07010000
           05  FILLER                  PIC  X(05)    VALUE 'STORE'.     07020000
           05  FILLER                  PIC  X(03)    VALUE SPACES.      07030000
           05  FILLER                  PIC  X(05)    VALUE 'BATCH'.     07040000
           05  FILLER                  PIC  X(03)    VALUE SPACES.      07050000
           05  FILLER                  PIC  X(06)    VALUE 'SOURCE'.    07060000
      ***  05  FILLER                  PIC  X(05)    VALUE 'DOCNO'.     07070000
           05  FILLER                  PIC  X(03)    VALUE SPACES.      07080000
           05  FILLER                  PIC  X(05)    VALUE 'DOCNO'.     07090000
           05  FILLER                  PIC  X(04)    VALUE SPACES.      07100000
           05  FILLER                  PIC  X(05)    VALUE SPACES.      07110000
           05  FILLER                  PIC  X(04)    VALUE 'DATE'.      07120000
           05  FILLER                  PIC  X(01)    VALUE SPACES.      07130000
           05  FILLER                  PIC  X(03)    VALUE SPACES.      07140000
           05  FILLER                  PIC  X(02)    VALUE 'KM'.        07150000
           05  FILLER                  PIC  X(02)    VALUE SPACES.      07160000
           05  FILLER                  PIC  X(05)    VALUE 'CLASS'.     07170000
W26006     05  FILLER                  PIC  X(06)    VALUE SPACES.      07180000
           05  FILLER                  PIC  X(05)    VALUE 'UNITS'.     07190000
W26006     05  FILLER                  PIC  X(09)    VALUE SPACES.      07200000
           05  FILLER                  PIC  X(05)    VALUE 'PRICE'.     07210000
W26006     05  FILLER                  PIC  X(07)    VALUE SPACES.      07220000
           05  FILLER                  PIC  X(10)    VALUE 'RETAIL AMT'.07230000
W26006***  05  FILLER                  PIC  X(28)    VALUE SPACES.      07240000
           EJECT                                                        07250000
       01  EX-DETAIL-LINE.                                              07260000
           05  FILLER                  PIC  X(01)    VALUE SPACE.       07270000
           05  FILLER                  PIC  X(04).                      07280000
           05  EX-TRANS-CDE            PIC  X(02).                      07290000
W26603     05  FILLER                  PIC  X(03).                      07300000
W26603     05  EX-STORE-NBR            PIC  X(05).                      07310000
W26603     05  FILLER                  PIC  X(04).                      07320000
W26603     05  EX-REL-STORE-NBR        PIC  X(05).                      07330000
           05  FILLER                  PIC  X(04).                      07340000
           05  EX-BATCH-NBR            PIC  X(04).                      07350000
           05  FILLER                  PIC  X(04).                      07360000
           05  EX-SOURCE-NBR           PIC  X(05).                      07370000
      ***  05  FILLER                  PIC  X(05).                      07380000
      ***  05  EX-SCAN-DOC-NBR         PIC  X(05).                      07390000
           05  FILLER                  PIC  X(03).                      07400000
           05  EX-DOC-NBR-11           PIC  X(11).                      07410000
      ***  05  EX-DOC-NBR-5            PIC  X(05).                      07420000
           05  FILLER                  PIC  X(03).                      07430000
           05  EX-LIAB-MMDD            PIC  X(05).                      07440000
           05  FILLER                  PIC  X(03).                      07450000
           05  EX-KOHLS-MM             PIC  X(02).                      07460000
           05  FILLER                  PIC  X(02).                      07470000
           05  EX-DEPT-CLASS           PIC  X(05).                      07480000
           05  FILLER                  PIC  X(04).                      07490000
W26006     05  EX-QTY                  PIC  ZZZ,ZZ9.                    07500000
           05  FILLER                  PIC  X(02).                      07510000
W26006     05  EX-PRICE                PIC  Z,ZZZ,ZZZ.99.               07520000
           05  FILLER                  PIC  X(03).                      07530000
0422RM*    05  EX-RETAIL               PIC  ZZZ,ZZZ,ZZZ.99.             07540008
0422RM     05  EX-RETAIL               PIC  ZZ,ZZZ,ZZZ,ZZZ.99.          07550008
W26006***  05  FILLER                  PIC  X(28).                      07560000
                                                                        07570000
       01  EX-TOTAL-LINE.                                               07580000
           05  FILLER                  PIC X(28) VALUE                  07590000
                                         'TOTAL NUMBER OF EXCEPTIONS: '.07600000
           05  EX-TOT-TRAN-COUNT       PIC ZZZ,ZZZ,ZZ9.                 07610000
0422RM*    05  FILLER                  PIC X(23) VALUE SPACE.           07620016
0422RM     05  FILLER                  PIC X(25) VALUE SPACE.           07621016
           05  FILLER                  PIC X(18) VALUE                  07630000
                                                   'TOTAL RETAIL AMT: '.07640000
           05  EX-TOT-RETAIL           PIC ZZ,ZZZ,ZZZ,ZZZ.99.           07650000
      ***************************************************************** 07660000
      *  ABEND ROUTINE WORKING STORAGE                                  07670000
      ***************************************************************** 07680000
                                                                        07690000
           COPY DPWS004.                                                07700000
                                                                        07710000
       01  ABEND-CODE                          PIC S9(04)  VALUE +0     07720000
                                                           COMP SYNC.   07730000
           88  ABEND-4003                                  VALUE +4003. 07740000
                                                                        07750000
       EJECT                                                            07760000
           EXEC SQL                                                     07770000
               INCLUDE SQLCA                                            07780000
           END-EXEC                                                     07790000
                                                                        07800000
           EXEC SQL                                                     07810000
W26603         INCLUDE XMT00001                                         07820000
           END-EXEC                                                     07830000
                                                                        07840000
           EXEC SQL                                                     07850000
               INCLUDE TINVPAR                                          07860000
           END-EXEC                                                     07870000
                                                                        07880000
W28545     EXEC SQL                                                     07890008
W28545         INCLUDE TINCNTL                                          07900008
W28545     END-EXEC                                                     07910008
                                                                        07920008
           EXEC SQL                                                     07930000
               INCLUDE TMDSEAR                                          07940000
           END-EXEC                                                     07950000
                                                                        07960000
           EXEC SQL                                                     07970000
               INCLUDE TAPLAVL                                          07980000
           END-EXEC                                                     07990000
                                                                        08000000
           EXEC SQL                                                     08010000
               INCLUDE TDTATTR                                          08020000
           END-EXEC                                                     08030000
                                                                        08040000
           EXEC SQL                                                     08050000
               INCLUDE TMLCNTL                                          08060000
           END-EXEC                                                     08070000
                                                                        08080000
           EXEC SQL                                                     08090000
W26603         DECLARE XMTLOC_CURSOR   CURSOR FOR                       08100000
W31475          SELECT DISTINCT(LOC_NBR)                                08110000
W26603          FROM XMT_LOC                                            08120000
W26603          WHERE LOC_TYP_CDE IN ('DC','DS','RV','CS','DA')         08130000
W26006            AND (FINCL_CLO_DTE > :MLCNTL-PSTG-FSCL-WK-DTE OR      08140008
W26006                 FINCL_CLO_DTE IS NULL)                           08150008
W26603          ORDER BY LOC_NBR                                        08160000
W26603          WITH UR                                                 08170000
           END-EXEC.                                                    08180000
                                                                        08190000
           EJECT                                                        08200000
                                                                        08210000
      **   THIS UNIONIZED CURSOR RETURNS THE FOLLOWING:                 08220000
      **                                                                08230000
      **   1.  ALL DEPT/SUB_CL COMBO'S FOR ACTIVE 'ML' DEPARTMENTS      08240000
      **   2.  A COUNT, BY DEPARTMENT, OF THE TOTAL NUMBER OF CLASSES   08250000
      **       IN EACH DEPARTMENT.                                      08260000
      **                                                                08270000
      **                                                                08280000
      **    ---------+---------+---------+---------+---------+---------+08290000
      **    DEPT_NBR  SUB_CL_NBR              ** COMMENTS BELOW: **     08300000
      **    ---------+---------+---------+---------+---------+---------+08310000
      **    011       TOT                  45 ** DPT 11 HAS 45 SUB_CL'S 08320000
      **    011       010                   0                           08330000
      **    011       011                   0                           08340000
      **    .         .                     .                           08350000
      **    .         .                     .                           08360000
      **    012       TOT                  78 ** DPT 12 HAS 78 SUB_CL'S 08370000
      **    012       010                   0                           08380000
      **    .         .                     .                           08390000
      **    .         .                     .                           08400000
           EXEC SQL DECLARE TMDSEAR_CURSOR CURSOR FOR                   08410000
             SELECT  A.DEPT_NBR                                         08420000
                    ,'TOT'                                              08430000
                    ,COUNT(*)                                           08440000
               FROM  TMDSEAR A                                          08450000
                    ,TAPLAVL B                                          08460000
              WHERE  A.OPERCO_NBR      = '03'                           08470000
                AND  A.MDSELV_CDE      = 'SCL'                          08480000
                AND  :MLCNTL-PSTG-FSCL-WK-DTE                           08490000
                                        BETWEEN A.STRT_DTE              08500000
                                            AND A.END_DTE               08510000
                AND  A.MDSEAR_DKEY     = B.MDSEAR_DKEY                  08520000
                AND  :MLCNTL-PSTG-FSCL-WK-DTE                           08530000
                                        BETWEEN B.MDSEAR_STRT_DTE       08540000
                                            AND B.MDSEAR_END_DTE        08550000
                AND  B.APLSYS_CDE      = 'ML'                           08560000
              GROUP BY A.DEPT_NBR                                       08570000
                                                                        08580000
              UNION ALL                                                 08590000
                                                                        08600000
             SELECT  A.DEPT_NBR                                         08610000
                    ,A.SUB_CL_NBR                                       08620000
                    ,+0                                                 08630000
               FROM  TMDSEAR A                                          08640000
                    ,TAPLAVL B                                          08650000
              WHERE  A.OPERCO_NBR      = '03'                           08660000
                AND  A.MDSELV_CDE      = 'SCL'                          08670000
                AND  :MLCNTL-PSTG-FSCL-WK-DTE                           08680000
                                        BETWEEN A.STRT_DTE              08690000
                                            AND A.END_DTE               08700000
                AND  A.MDSEAR_DKEY     = B.MDSEAR_DKEY                  08710000
                AND  :MLCNTL-PSTG-FSCL-WK-DTE                           08720000
                                        BETWEEN B.MDSEAR_STRT_DTE       08730000
                                            AND B.MDSEAR_END_DTE        08740000
                AND  B.APLSYS_CDE      = 'ML'                           08750000
                                                                        08760000
              ORDER BY 1,2                                              08770000
W26603        WITH UR                                                   08780000
           END-EXEC.                                                    08790000
                                                                        08800000
       EJECT                                                            08810000
       LINKAGE SECTION.                                                 08820000
                                                                        08830000
                                                                        08840000
       PROCEDURE DIVISION.                                              08850000
                                                                        08860000
                                                                        08870000
      ******************************************************************08880000
      *                                                                 08890000
      *    THE BASIC FLOW OF THE PROGRAM IS AS FOLLOWS:                 08900000
      *                                                                 08910000
      *    B1XX - HOUSEKEEPING LOGIC, INITIAL READ OF INPUT COMPOSITE   08920000
      *           FILE.  BUILD WORKING STORAGE TABLES FOR THE FOLLOWING:08930000
      *           -  FISCAL PERIOD DATE INFO                            08940000
W26603*           -  XMTLOC/TINVPAR DATES                               08950000
      *           -  VALID "ML" DEPT/CLASSES                            08960000
      *                                                                 08970000
      *    C100 - PROCESS ALL STORES                                    08980000
      *                                                                 08990000
W26603*         - DOES THE STORE EXISTS IN THE XMTLOC/TINVPAR JOIN?     09000000
      *           EVEN IF IT DOESN'T, CONTINUE W/ EDITS.                09010000
      *                                                                 09020000
      *           C110  PROCESS ALL DEPARTMENTS IN THE STORE            09030000
      *                 - IS THE DEPT/CLASS VALID FOR "ML" ?  EVEN IF   09040000
      *                   IT'S NOT, CONTINUE WITH THE EDITS.            09050000
      *                                                                 09060000
      *                 C150  BASED ON TRAN TYPE, COMPLETE THE EDITS.   09070000
      *                       **  NOTE - FOR EACH RECORD TYPE:          09080000
      *                            IF NO ERRORS FOUND,                  09090000
      *                                -  WRITE OUT THE CORRESPONDING   09100000
      *                                   OUTPUT RECORD                 09110000
      *                                -  WRITE A RPT1 EDIT/SPLIT       09120000
      *                                   REPORT RECORD                 09130000
      *                            ELSE                                 09140000
      *                                -  WRITE A RPT2 ERROR RECORD     09150000
      *                                                                 09160000
      *                       EVALUATE ML020-TRANS-CDE:                 09170000
      *                           WHEN ML020-PURCHASE                   09180000
      *                               PERFORM D100-PROCESS-PURCHASE     09190000
      *                           WHEN ML020-SALE                       09200000
      *                               PERFORM E100-PROCESS-SALE         09210000
      *                           WHEN ML020-STORE-TRANSFER             09220000
      *                               PERFORM F100-PROCESS-TRANSFER     09230000
      *                           WHEN ML020-PRICE-CHANGE               09240000
      *                               PERFORM G100-PROCESS-PRICE-CHANGE 09250000
      *                           WHEN ML020-ADJUSTMENT                 09260000
      *                               PERFORM H100-PROCESS-ADJUSTMENTS  09270000
      *                           WHEN OTHER                            09280000
      *                               ABEND                             09290000
      *                                                                 09300000
      *                      READ THE NEXT COMPOSITE RECORD             09310000
      ******************************************************************09320000
           PERFORM B100-HOUSEKEEPING.                                   09330000
                                                                        09340000
           PERFORM C100-PROCESS-STORES                                  09350000
               UNTIL END-OF-COMPOSITE-FILE                              09360000
                                                                        09370000
           PERFORM B300-EOJ.                                            09380000
                                                                        09390000
           STOP RUN.                                                    09400000
                                                                        09410000
                                                                        09420000
       B100-HOUSEKEEPING.                                               09430000
                                                                        09440000
           PERFORM B110-OPEN-FILES.                                     09450000
           PERFORM B120-PROCESS-CONTROL-CARD.                           09460000
W27261     IF PV-DAILY-GROSS-MARGIN-RUN-IND = 'Y'                       09470008
W27261         PERFORM Z710-ESTABLISH-DATES-FOR-DGM THRU Z710-EXIT      09480008
W27261     ELSE                                                         09490008
W27261         PERFORM B125-ESTABLISH-DATES.                            09500000
           PERFORM B130-TABLE-STORE-INFO.                               09510000
           PERFORM B140-TABLE-DEPT-CLASS-INFO.                          09520000
           PERFORM B150-INIT-TRANS-ACCUM-TABLE.                         09530000
           PERFORM B160-WRITE-RPT-FILE-HEADERS.                         09540000
           PERFORM B170-GET-SYSTEM-DATE-TIME.                           09550000
                                                                        09560000
      **   PUT OUT THE HEADINGS FOR THE TRANSFER EXCEPTIONS REPORT      09570000
                                                                        09580000
           PERFORM F200-HEADINGS.                                       09590000
                                                                        09600000
           INITIALIZE EDT-EDIT-DTE-TBL.                                 09610000
                                                                        09620000
           PERFORM Z100-READ-COMPOSITE-FILE.                            09630000
                                                                        09640000
                                                                        09650000
       B110-OPEN-FILES.                                                 09660000
                                                                        09670000
           OPEN  INPUT COMPOSITE-FILE                                   09680000
                       CONTROL-CARD-FILE                                09690000
                OUTPUT PURCH-FILE                                       09700000
                       SALE-FILE                                        09710000
                       PRC-CHG-FILE                                     09720000
                       ADJUSTMENT-FILE                                  09730000
                       REPORT-FILE                                      09740000
                       ERROR-FILE                                       09750000
W29145                 DW-PRC-CHG-FILE                                  09760000
W28582                 BV-PRC-CHG-FILE                                  09770000
W28582                 BV-PURCH-FILE                                    09780000
                       AUDIT-REPORT-FILE                                09790000
                       EXCEPTIONS-REPORT-FILE.                          09800000
                                                                        09810000
                                                                        09820000
       B120-PROCESS-CONTROL-CARD.                                       09830000
                                                                        09840000
           MOVE 'B120-PROCESS-CONTROL-CARD' TO PV-PARA.                 09850000
                                                                        09860000
           MOVE 'N'   TO   COMPOSITE-FILE-SW.                           09870000
                                                                        09880000
           READ CONTROL-CARD-FILE INTO CC-CONTROL-CARD                  09890000
               AT END                                                   09900000
                   DISPLAY '** PROGRAM ABEND **'                        09910000
                   DISPLAY 'MLKUP021  - CONTROL CARD EMPTY'             09920000
                   MOVE +4003              TO ABEND-CODE                09930000
                   PERFORM Z999-ABEND.                                  09940000
                                                                        09950000
           DISPLAY '** MLKUP021 CONTROL CARD:' CC-CONTROL-CARD.         09960000
                                                                        09970000
           IF NOT CC-PROCESSING-MODE-VALID                              09980000
               DISPLAY '** ABEND **'                                    09990000
               DISPLAY '** PROGRAM MLKUP021 **'                         10000000
               DISPLAY '** PARAGRAPH ' PV-PARA                          10010000
               IF CC-PROCESSING-MODE = SPACE                            10020000
                   DISPLAY '** PROCESSING MODE ON CONTROL CARD IS BLANK'10030000
               ELSE                                                     10040000
                   DISPLAY '** INVALID PROCESSING MODE ON CONTROL CARD:'10050000
                            CC-PROCESSING-MODE                          10060000
               END-IF                                                   10070000
               MOVE +4003 TO ABEND-CODE                                 10080000
               PERFORM Z999-ABEND.                                      10090000
                                                                        10100000
           IF NOT CC-CHECK-INV-DATES-SW-VALID                           10110000
               DISPLAY '** ABEND **'                                    10120000
               DISPLAY '** PROGRAM MLKUP021 **'                         10130000
               DISPLAY '** PARAGRAPH ' PV-PARA                          10140000
               IF CC-CHECK-INV-DATES-SW = SPACE                         10150000
                   DISPLAY '** CHECK-INV-DATES-SWITCH ON CONTROL CARD IS10160000
      -                    ' BLANK'                                     10170000
               ELSE                                                     10180000
                   DISPLAY '** INVALID CHECK-INV-DATES-SWITCH ON CONTROL10190000
      -                    ' CARD:' CC-CHECK-INV-DATES-SW               10200000
               END-IF                                                   10210000
               MOVE +4003 TO ABEND-CODE                                 10220000
               PERFORM Z999-ABEND.                                      10230000
R27261                                                                  10240008
R27261                                                                  10250008
R27261     EVALUATE TRUE                                                10260008
R27261                                                                  10270008
R27261        WHEN (CC-DAILY-CUTOFF-IND   = SPACE    AND                10280008
R27261              CC-DGM-RUN-IND        = SPACE)                      10290008
R27261           DISPLAY PV-NORMAL-WEEKLY-ML-MSG                        10300008
R27261                                                                  10310008
R27261        WHEN (CC-DAILY-CUTOFF-IND NOT = SPACE    AND              10320008
R27261              CC-DGM-RUN-IND          = SPACE)                    10330008
R27261                                                                  10340008
R27261           DISPLAY '** ABEND **'                                  10350000
R27261           DISPLAY '** PROGRAM MLKUP021 **'                       10360000
R27261           DISPLAY '** PARAGRAPH ' PV-PARA                        10370000
R27261           DISPLAY '** DAILY-CUTOFF-IND ON CONTROL CARD IS '      10380008
R27261                    CC-DAILY-CUTOFF-IND                           10390000
R27261           DISPLAY '** DAILY-DGM-RUN-IND IS BLANK'                10400008
R27261           DISPLAY '** BOTH MUST EITHER BE BLANK OR FILLED IN'    10410008
R27261           MOVE +4003 TO ABEND-CODE                               10420000
R27261           PERFORM Z999-ABEND                                     10430000
R27261                                                                  10440008
R27261        WHEN (CC-DAILY-CUTOFF-IND     = SPACE    AND              10450008
R27261              CC-DGM-RUN-IND      NOT = SPACE)                    10460008
R27261                                                                  10470008
R27261           DISPLAY '** ABEND **'                                  10480000
R27261           DISPLAY '** PROGRAM MLKUP021 **'                       10490000
R27261           DISPLAY '** PARAGRAPH ' PV-PARA                        10500000
R27261           DISPLAY '** DAILY-CUTOFF-IND ON CONTROL CARD IS BLANK' 10510008
R27261           DISPLAY '** DAILY-DGM-RUN-IND IS ' CC-DGM-RUN-IND      10520008
R27261           DISPLAY '** BOTH MUST EITHER BE BLANK OR FILLED IN'    10530008
R27261           MOVE +4003 TO ABEND-CODE                               10540000
R27261           PERFORM Z999-ABEND                                     10550000
R27261                                                                  10560008
R27261        WHEN OTHER                                                10570008
W27261                                                                  10580008
W27261           MOVE CC-DGM-DATE-BEING-PROCESSED TO                    10590000
W27261               PV-DGM-DATE-BEING-PROCESSED                        10600000
W27261           PERFORM Z700-VALIDATE-DGM-DATE THRU Z700-EXIT          10610008
                                                                        10620000
W27261           IF CC-DAILY-CUTOFF-IND-IS-VALID                        10630000
W27261               MOVE CC-DAILY-CUTOFF-IND TO PV-DAILY-CUTOFF-IND    10640000
W27261           ELSE                                                   10650000
W27261               DISPLAY '** ABEND **'                              10660000
W27261               DISPLAY '** PROGRAM MLKUP021 **'                   10670000
W27261               DISPLAY '** PARAGRAPH ' PV-PARA                    10680000
W27261               DISPLAY '** DAILY-CUTOFF-IND ON CONTROL CARD IN COL10690000
W27261-                      'UMN 2 IS INVALID = ' CC-DAILY-CUTOFF-IND  10700000
W27261               MOVE +4003 TO ABEND-CODE                           10710000
W27261               PERFORM Z999-ABEND                                 10720000
W27261           END-IF                                                 10730000
R27261                                                                  10740000
W27261           IF PV-DAILY-GROSS-MARGIN-RUN-IND = 'Y'                 10750008
W27261               IF PV-DAILY-CUTOFF-IND = 'Y'                       10760008
W27261                   DISPLAY PV-DGM-CUTOFF-MSG                      10770000
W27261               ELSE                                               10780000
W27261                   DISPLAY PV-DGM-RUN-MSG                         10790000
W27261               END-IF                                             10800008
W27261           END-IF                                                 10810008
R27261                                                                  10820008
R27261     END-EVALUATE.                                                10830008
W27261                                                                  10840008
                                                                        10850000
       B125-ESTABLISH-DATES.                                            10860000
                                                                        10870000
           PERFORM Z600-GET-MLCNTL-DTES.                                10880000
                                                                        10890000
           DISPLAY ' MLCNTL-OPN-FSCL-MN-DTE:  '                         10900000
                     MLCNTL-OPN-FSCL-MN-DTE                             10910000
                   ' MLCNTL-OPN-FSCL-MN-NBR:  '                         10920000
                     MLCNTL-OPN-FSCL-MN-NBR                             10930000
           DISPLAY ' MLCNTL-PSTG-FSCL-WK-DTE: '                         10940000
                     MLCNTL-PSTG-FSCL-WK-DTE                            10950000
                   ' MLCNTL-PSTG-FSCL-WK-NBR: '                         10960000
                     MLCNTL-PSTG-FSCL-WK-NBR.                           10970000
           DISPLAY ' MLCNTL-PSTG-FSCL-MN-DTE: '                         10980000
                     MLCNTL-PSTG-FSCL-MN-DTE                            10990000
                   ' MLCNTL-PSTG-FSCL-MN-NBR: '                         11000000
                     MLCNTL-PSTG-FSCL-MN-NBR.                           11010000
           DISPLAY ' '.                                                 11020000
                                                                        11030000
           MOVE MLCNTL-PSTG-FSCL-WK-DTE TO DTATTR-KY-DTE.               11040000
           PERFORM Z610-GET-DTE-ATTRIBUTES.                             11050000
           MOVE DTATTR-FSCL-YR-NBR      TO PV-PSTG-FSCL-YR-NBR.         11060000
           MOVE DTATTR-FSCL-MN-BEG-DTE  TO PV-FSCL-MN-BEG-DTE.          11070000
W27261     MOVE DTATTR-FSCL-MN-END-DTE  TO PV-FSCL-MN-END-DTE.          11080000
W27261     DISPLAY '--> PV-FSCL-MN-BEG-DTE = '                          11090000
W27261         PV-FSCL-MN-BEG-DTE.                                      11100000
W27261     DISPLAY '--> ALTERNATE END DATE FOR CUTOFF WEEK = '          11110000
W27261         PV-FSCL-MN-END-DTE.                                      11120000
           MOVE MLCNTL-PSTG-FSCL-WK-DTE TO PV-ISO-DTE.                  11130000
           STRING PV-ISO-MM        DELIMITED BY SIZE                    11140000
                 '/'               DELIMITED BY SIZE                    11150000
                  PV-ISO-DD        DELIMITED BY SIZE                    11160000
                 '/'               DELIMITED BY SIZE                    11170000
                  PV-ISO-YY        DELIMITED BY SIZE                    11180000
                                       INTO PV-PROC-GREG-FMT-DTE.       11190000
                                                                        11200000
                                                                        11210000
           MOVE MLCNTL-OPN-FSCL-MN-DTE  TO DTATTR-KY-DTE.               11220000
           PERFORM Z610-GET-DTE-ATTRIBUTES.                             11230000
           MOVE DTATTR-FSCL-YR-NBR      TO PV-OPN-FSCL-YR-NBR.          11240000
                                                                        11250000
           MOVE DTATTR-NFM-END-DTE      TO DTATTR-KY-DTE.               11260000
           PERFORM Z610-GET-DTE-ATTRIBUTES.                             11270000
           MOVE DTATTR-FSCL-YR-NBR      TO PV-NEXT-FSCL-YR-NBR.         11280000
           MOVE DTATTR-FSCL-MN-NBR      TO PV-NEXT-FSCL-MN-NBR.         11290000
                                                                        11300000
                                                                        11310000
       B130-TABLE-STORE-INFO.                                           11320000
                                                                        11330000
           MOVE 'B130-TABLE-STORE-INFO' TO PV-PARA.                     11340000
                                                                        11350000
           EXEC SQL                                                     11360000
W26603         OPEN XMTLOC_CURSOR                                       11370000
           END-EXEC                                                     11380000
                                                                        11390000
           IF SQLCODE NOT = +0                                          11400000
W26603         MOVE 'OPEN XMTLOC CURSOR'    TO PV-DB2-OPER-ATTEMPTED    11410000
               PERFORM Z900-SQL-ABEND                                   11420000
           END-IF                                                       11430000
                                                                        11440000
W31475*    INITIALIZE STORE-TABLE                                       11450000
W31475     MOVE HIGH-VALUES TO STORE-TABLE                              11460000
                                                                        11470000
           PERFORM VARYING ST-IDX FROM 1 BY 1                           11480000
W26603       UNTIL END-OF-XMTLOC-CURSOR                                 11490000
                OR ST-IDX > PC-MAX-STORES                               11500000
               EXEC SQL                                                 11510000
W26603             FETCH XMTLOC_CURSOR                                  11520000
W26603              INTO :XMT00001-LOC-NBR                              11530000
               END-EXEC                                                 11540000
               EVALUATE TRUE                                            11550000
                   WHEN SQLCODE = +0                                    11560000
W26603                 MOVE XMT00001-LOC-NBR TO PV-LOC-NBR              11570000
W26603                 MOVE PV-LOC-NBR-ALPHA TO ST-STORE-NMBR(ST-IDX)   11580000
W26603                 MOVE XMT00001-LOC-NBR TO INVPAR-LOC-NBR          11590000
                       EXEC SQL                                         11600000
W33304                     SELECT  A.INV_ID                             11610000
W33304                           , PLND_INV_DTE                         11620000
W33304                           , ACTL_DC_CTOFF_DTE                    11630000
W33304                           , SCHD_PHY_CNT_CDE                     11640000
RB0401                           , MFSTNG_IND                           11650000
W33304                           , FINCL_INV_STAT_CDE                   11660008
W28545                     INTO    :INVPAR-INV-ID                       11670000
                                 , :INVPAR-PLND-INV-DTE                 11680000
                                 , :INVPAR-ACTL-DC-CTOFF-DTE            11690000
W33304                           , :INVPAR-SCHD-PHY-CNT-CDE             11700000
RB0401                           , :INVPAR-MFSTNG-IND                   11710000
W33304                           , :INVPAR-FINCL-INV-STAT-CDE           11720008
                           FROM    TINVPAR A                            11730000
W28545                           , TINCNTL B                            11740000
W26603                     WHERE   LOC_NBR = :INVPAR-LOC-NBR            11750000
                             AND   ACTL_FIN_BK_DTE = '9999-09-09'       11760000
W33304                       AND   LOC_INV_STAT_CDE = 'IN'              11770008
W33304                       AND   A.ACTL_LDG_CTOF_TMST                 11780008
W33304                               <> '9999-12-31-23.59.59.999999'    11790008
W28545                       AND   A.INV_ID = B.INV_ID                  11800008
W28545                       AND   B.ACTV_IND = 'Y'                     11810008
W26603                     WITH UR                                      11820000
                       END-EXEC                                         11830000
                       EVALUATE TRUE                                    11840000
                           WHEN SQLCODE = +0                            11850000
W28545                         MOVE INVPAR-INV-ID TO                    11860008
W28545                              ST-INV-ID(ST-IDX)                   11870008
                               MOVE INVPAR-PLND-INV-DTE TO              11880000
                                    ST-PLND-INV-DTE(ST-IDX)             11890000
                               MOVE INVPAR-ACTL-DC-CTOFF-DTE TO         11900000
                                    ST-ACTL-DC-CTOFF-DTE(ST-IDX)        11910000
W33304                         MOVE INVPAR-SCHD-PHY-CNT-CDE TO          11920000
0600RB                              ST-SCHD-INV-CDE(ST-IDX)             11930000
RB0401                         MOVE INVPAR-MFSTNG-IND TO                11940000
RB0401                              ST-MFSTNG-IND(ST-IDX)               11950000
W33304                         MOVE INVPAR-FINCL-INV-STAT-CDE TO        11960008
W33304                              ST-FINCL-BK-STAT(ST-IDX)            11970008
                           WHEN SQLCODE = +100                          11980000
W31475                     INITIALIZE ST-INV-ID(ST-IDX)                 11990008
W31475                     INITIALIZE ST-PLND-INV-DTE(ST-IDX)           12000008
W31475                     INITIALIZE ST-ACTL-DC-CTOFF-DTE(ST-IDX)      12010008
W31475                     INITIALIZE ST-SCHD-INV-CDE(ST-IDX)           12020008
W31475                     INITIALIZE ST-MFSTNG-IND(ST-IDX)             12030008
                               CONTINUE                                 12040000
                           WHEN OTHER                                   12050000
W26006                         DISPLAY ' LOCATION: ' INVPAR-LOC-NBR     12060008
                               MOVE 'TINVPAR SELECT'                    12070000
                                             TO  PV-DB2-OPER-ATTEMPTED  12080000
                               PERFORM Z900-SQL-ABEND                   12090000
                       END-EVALUATE                                     12100000
                   WHEN SQLCODE = +100                                  12110000
W26603                 SET END-OF-XMTLOC-CURSOR TO TRUE                 12120000
                   WHEN OTHER                                           12130000
W26603                 MOVE 'XMTLOC FETCH'                              12140000
                                     TO  PV-DB2-OPER-ATTEMPTED          12150000
                       PERFORM Z900-SQL-ABEND                           12160000
               END-EVALUATE                                             12170000
           END-PERFORM                                                  12180000
                                                                        12190000
           EXEC SQL                                                     12200000
W26603        CLOSE XMTLOC_CURSOR                                       12210000
           END-EXEC                                                     12220000
                                                                        12230000
           IF ST-IDX > PC-MAX-STORES                                    12240000
               DISPLAY '** PROGRAM ABEND **'                            12250000
W26603         DISPLAY 'MLKUP021  - MORE THAN 9999 STORES'              12260000
               MOVE +4003              TO ABEND-CODE                    12270000
               PERFORM Z999-ABEND                                       12280000
           END-IF.                                                      12290000
                                                                        12300000
       B140-TABLE-DEPT-CLASS-INFO.                                      12310000
                                                                        12320000
           MOVE 'B140-TABLE-DEPT-CLASS-INFO' TO PV-PARA.                12330000
                                                                        12340000
           EXEC SQL                                                     12350000
               OPEN TMDSEAR_CURSOR                                      12360000
           END-EXEC                                                     12370000
                                                                        12380000
           IF SQLCODE NOT = +0                                          12390000
               MOVE 'OPEN TMDSEAR/TAPLAVL CURSOR' TO                    12400000
                     PV-DB2-OPER-ATTEMPTED                              12410000
               PERFORM Z900-SQL-ABEND                                   12420000
           END-IF                                                       12430000
                                                                        12440000
      **    ---------+---------+---------+---------+---------+---------+12450000
      **    DEPT_NBR  SUB_CL_NBR              ** COMMENTS BELOW: **     12460000
      **    ---------+---------+---------+---------+---------+---------+12470000
      **    011       TOT                  45 ** DPT 11 HAS 45 SUB_CL'S 12480000
      **    011       010                   0                           12490000
      **    011       011                   0                           12500000
      **    .         .                     .                           12510000
      **    .         .                     .                           12520000
      **    012       TOT                  78 ** DPT 12 HAS 78 SUB_CL'S 12530000
      **    012       010                   0                           12540000
      **    .         .                     .                           12550000
      **    .         .                     .                           12560000
W31475*    INITIALIZE DEPARTMENT-CLASS-TABLE                            12570000
W31475     MOVE HIGH-VALUES TO DEPARTMENT-CLASS-TABLE                   12580000
                                                                        12590000
           SET DC-IDX TO +1                                             12600000
      *--> ** DON'T DO A "PERFORM VARYING" HERE.  RATHER, INCREMENT     12610000
      *--> ** DC-IDX WHEN YOU KNOW YOU'RE DEALING WITH "REAL" CLASSES   12620000
      *--> ** (AS OPPOSED TO THE 'TOT' CLASS)                           12630000
                                                                        12640000
           PERFORM                                                      12650000
             UNTIL SQLCODE NOT = +0                                     12660000
                OR DC-IDX > PC-MAX-DEPT-CLASS                           12670000
               EXEC SQL                                                 12680000
                   FETCH TMDSEAR_CURSOR                                 12690000
                    INTO :MDSEAR-DEPT-NBR                               12700000
                        ,:MDSEAR-SUB-CL-NBR                             12710000
                        ,:PV-DEPT-CLASS-COUNT                           12720000
               END-EXEC                                                 12730000
               EVALUATE TRUE                                            12740000
                   WHEN SQLCODE = +0                                    12750000
      *-->             ** WHEN FETCHING A DEPT FOR THE 1ST TIME,        12760000
      *-->             ** (THE "'TOT'" ROW) KEEP IT'S CLASS COUNT AND   12770000
      *-->             ** APPLY THIS VALUE TO ALL DEPT/CLASS COMBO'S    12780000
      *-->             ** FOR THE CURRENT DEPT.                         12790000
                       IF MDSEAR-SUB-CL-NBR = 'TOT'                     12800000
                           MOVE PV-DEPT-CLASS-COUNT       TO            12810000
                                PV-NBR-OF-CLASSES-IN-DEPT               12820000
                       ELSE                                             12830000
W31475                  IF PV-DEPT-HLD NOT =  MDSEAR-DEPT-NBR           12840008
W31475                    OR   PV-DEPT-CLASS-HLD NOT =                  12850008
W31475                          MDSEAR-SUB-CL-NBR(2:2)                  12860008
                           MOVE MDSEAR-DEPT-NBR           TO            12870000
                                DC-DEPT-NBR(DC-IDX)                     12880000
W31475                          PV-DEPT-HLD                             12890008
      *-->                 ** ONLY STORE THE RIGHTMOST 2 CHARS OF CLASS 12900000
                           MOVE MDSEAR-SUB-CL-NBR(2:2)    TO            12910000
                                DC-CLASS-NBR(DC-IDX)                    12920000
W31475                          PV-DEPT-CLASS-HLD                       12930008
                           MOVE PV-NBR-OF-CLASSES-IN-DEPT TO            12940000
                                DC-NBR-OF-CLASSES-IN-DEPT(DC-IDX)       12950000
                           SET DC-IDX UP BY 1                           12960000
                        END-IF                                          12970000
                       END-IF                                           12980000
                   WHEN SQLCODE = +100                                  12990000
                       CONTINUE                                         13000000
                   WHEN OTHER                                           13010000
                       MOVE 'TMDSEAR/TMAPAVL FETCH'                     13020000
                                     TO  PV-DB2-OPER-ATTEMPTED          13030000
                       PERFORM Z900-SQL-ABEND                           13040000
               END-EVALUATE                                             13050000
           END-PERFORM.                                                 13060000
                                                                        13070000
           EXEC SQL                                                     13080000
              CLOSE TMDSEAR_CURSOR                                      13090000
           END-EXEC.                                                    13100000
                                                                        13110000
           IF DC-IDX > PC-MAX-DEPT-CLASS                                13120000
               DISPLAY '** PROGRAM ABEND **'                            13130000
               DISPLAY 'MLKUP021  - MAX # OF DEPT/CLASSES EXCEEDED'     13140000
               MOVE +4004              TO ABEND-CODE                    13150000
               PERFORM Z999-ABEND                                       13160000
           END-IF.                                                      13170000
                                                                        13180000
                                                                        13190000
       B150-INIT-TRANS-ACCUM-TABLE.                                     13200000
                                                                        13210000
           INITIALIZE TRANS-ACCUMS-TABLE.                               13220000
                                                                        13230000
           MOVE '10'                    TO TR-TRANS-CDE      (1)        13240000
           MOVE 'PURCH'                 TO TR-TRANS-CDE-DESC (1)        13250000
                                                                        13260000
           MOVE '20'                    TO TR-TRANS-CDE      (2)        13270000
           MOVE 'SALES'                 TO TR-TRANS-CDE-DESC (2)        13280000
                                                                        13290000
           MOVE '30'                    TO TR-TRANS-CDE      (3)        13300000
           MOVE 'XFR FM'                TO TR-TRANS-CDE-DESC (3)        13310000
                                                                        13320000
           MOVE '31'                    TO TR-TRANS-CDE      (4)        13330000
           MOVE 'XFR TO'                TO TR-TRANS-CDE-DESC (4)        13340000
                                                                        13350000
           MOVE '40'                    TO TR-TRANS-CDE      (5)        13360000
           MOVE 'MKDWN'                 TO TR-TRANS-CDE-DESC (5)        13370000
                                                                        13380000
           MOVE '50'                    TO TR-TRANS-CDE      (6)        13390000
           MOVE 'MARKUP'                TO TR-TRANS-CDE-DESC (6)        13400000
                                                                        13410000
           MOVE '80'                    TO TR-TRANS-CDE      (7)        13420000
           MOVE 'ADJST'                 TO TR-TRANS-CDE-DESC (7).       13430000
                                                                        13440000
           MOVE '  '                    TO TR-TRANS-CDE      (8)        13450000
           MOVE 'TOTAL'                 TO TR-TRANS-CDE-DESC (8).       13460000
                                                                        13470000
                                                                        13480000
       B160-WRITE-RPT-FILE-HEADERS.                                     13490000
                                                                        13500000
           SET ML025-RPT1-CNTL-CARD-HDR-REC                             13510000
               ML026-RPT2-CNTL-CARD-HDR-REC TO TRUE.                    13520000
                                                                        13530000
           MOVE MLCNTL-PSTG-FSCL-WK-DTE                                 13540000
                                       TO ML025-RPT1-EDIT-DTE           13550000
                                          ML026-RPT2-EDIT-DTE.          13560000
                                                                        13570000
           MOVE PV-OPN-FSCL-YR-NBR     TO ML025-RPT1-CURR-FSCL-YR-CDE.  13580000
           MOVE MLCNTL-OPN-FSCL-MN-NBR TO ML025-RPT1-CURR-FSCL-PER-CDE. 13590000
           MOVE PV-NEXT-FSCL-YR-NBR    TO ML025-RPT1-NEXT-FSCL-YR-CDE.  13600000
           MOVE PV-NEXT-FSCL-MN-NBR    TO ML025-RPT1-NEXT-FSCL-PER-CDE. 13610000
                                                                        13620000
           MOVE CC-PROCESSING-MODE     TO ML025-RPT1-PROCESSING-MODE    13630000
                                          ML026-RPT2-PROCESSING-MODE.   13640000
                                                                        13650000
           PERFORM Z998-WRITE-ERROR-FILE.                               13660000
           PERFORM Z400-WRITE-RPT1-REC.                                 13670000
                                                                        13680000
      **   SUBSEQUENT RPTX RECS WILL BE DETAILS...                      13690000
           SET ML025-RPT1-DETAIL-REC                                    13700000
               ML026-RPT2-DETAIL-ERR-REC    TO TRUE.                    13710000
                                                                        13720000
                                                                        13730000
       B170-GET-SYSTEM-DATE-TIME.                                       13740000
                                                                        13750000
           ACCEPT CPU-DATE FROM DATE.                                   13760000
0422RM*    MOVE CPU-YEAR   TO DP133O-RUN-YEAR                           13770008
0422RM     MOVE CPU-YEAR   TO DP150O-RUN-YEAR.                          13780017
0422RM*    MOVE CPU-MONTH  TO DP133O-RUN-MONTH                          13790008
0422RM     MOVE CPU-MONTH  TO DP150O-RUN-MONTH.                         13800017
0422RM*    MOVE CPU-DAY    TO DP133O-RUN-DAY                            13810008
0422RM     MOVE CPU-DAY    TO DP150O-RUN-DAY.                           13820017
                                                                        13830000
           ACCEPT CPU-TIME FROM TIME.                                   13840000
0422RM*    MOVE CPU-HOUR   TO DP133O-RUN-HOUR.                          13850008
0422RM     MOVE CPU-HOUR   TO DP150O-RUN-HOUR.                          13860008
0422RM*    MOVE CPU-MINUTE TO DP133O-RUN-MINUTE.                        13870008
0422RM     MOVE CPU-MINUTE TO DP150O-RUN-MINUTE.                        13880008
0422RM*    MOVE 'MLKUP021' TO DP133O-PROGRAM-NAME.                      13890008
0422RM     MOVE 'MLKUP021' TO DP150O-PROGRAM-NAME.                      13900008
                                                                        13910000
                                                                        13920000
       B300-EOJ.                                                        13930000
                                                                        13940000
           IF PV-LINE-COUNT > +57                                       13950000
               PERFORM F200-HEADINGS                                    13960000
           END-IF.                                                      13970000
                                                                        13980000
           MOVE SPACE                TO EXCEPTIONS-LINE.                13990000
           MOVE PV-EX-TOT-TRAN-COUNT TO EX-TOT-TRAN-COUNT.              14000000
           MOVE PV-EX-TOT-RETAIL     TO EX-TOT-RETAIL.                  14010000
           MOVE EX-TOTAL-LINE        TO EXCEPTIONS-LINE-DATA.           14020000
           MOVE '0'                  TO EXCEPTIONS-LINE-CC.             14030000
           PERFORM F900-WRITE-EXCEPTION-REPORT.                         14040000
                                                                        14050000
           IF PV-LINE-COUNT > +57                                       14060000
               PERFORM F200-HEADINGS                                    14070000
           END-IF.                                                      14080000
                                                                        14090000
           MOVE PC-END-OF-REPORT TO EXCEPTIONS-LINE.                    14100000
           MOVE '-'              TO EXCEPTIONS-LINE-CC.                 14110000
           PERFORM F900-WRITE-EXCEPTION-REPORT.                         14120000
                                                                        14130000
           PERFORM B310-WRITE-AUDIT-REPORT.                             14140000
           PERFORM B399-CLOSE-FILES.                                    14150000
                                                                        14160008
       B310-WRITE-AUDIT-REPORT.                                         14170000
                                                                        14180000
0422RM*    MOVE 1             TO DP133O-PAGE-NUMBER.                    14190008
0422RM     MOVE 1             TO DP150O-PAGE-NUMBER.                    14200008
0422RM*    MOVE 2             TO DP133O-REPORT-NUMBER.                  14210008
0422RM     MOVE 2             TO DP150O-REPORT-NUMBER.                  14220008
0422RM*    MOVE DP133O-STANDRD-HEADER-133-COLS TO AUDIT-LINE.           14230008
0422RM     MOVE DP150O-STANDRD-HEADER-150-COLS TO AUDIT-LINE.           14240008
           MOVE '1'           TO AUDIT-LINE-CC                          14250000
           MOVE ' '           TO AUDIT-HEADER-FONT-INDICATOR            14260000
                                                                        14270000
           PERFORM B390-WRITE-AUDIT-LINE.                               14280000
                                                                        14290000
           MOVE PV-PROC-GREG-FMT-DTE   TO AD-HDG1-DTE                   14300000
           IF CC-PROCESSING-MODE-INV-ONLY                               14310000
               MOVE PC-INVENTORY-ONLY-MODE TO AD-HDG1-PROCESSING-MODE   14320000
           END-IF.                                                      14330000
                                                                        14340000
           MOVE AD-HDG1    TO AUDIT-LINE.                               14350000
           PERFORM B390-WRITE-AUDIT-LINE.                               14360000
           MOVE AD-HDG2    TO AUDIT-LINE.                               14370000
           PERFORM B390-WRITE-AUDIT-LINE.                               14380000
           MOVE AD-HDG3    TO AUDIT-LINE.                               14390000
           PERFORM B390-WRITE-AUDIT-LINE.                               14400000
                                                                        14410000
           PERFORM VARYING TR-IDX FROM 1 BY 1                           14420000
               UNTIL TR-IDX > TR-MAX                                    14430000
                                                                        14440000
               INITIALIZE AUDIT-DETAIL-LINE                             14450000
                                                                        14460000
               MOVE TR-TRANS-CDE      (TR-IDX) TO                       14470000
                    AD-TRANS-CDE                                        14480000
               MOVE TR-TRANS-CDE-DESC (TR-IDX) TO                       14490000
                    AD-TRANS-CDE-DESC                                   14500000
               MOVE TR-TRANS-IN       (TR-IDX) TO                       14510000
                    AD-TRANS-IN                                         14520000
               MOVE TR-TRANS-RTL-IN   (TR-IDX) TO                       14530000
                    AD-TRANS-RTL-IN                                     14540000
               MOVE TR-TRANS-COST-IN  (TR-IDX) TO                       14550000
                    AD-TRANS-COST-IN                                    14560000
               MOVE TR-TRANS-ERR      (TR-IDX) TO                       14570000
                    AD-TRANS-ERR                                        14580000
               MOVE TR-TRANS-RTL-ERR  (TR-IDX) TO                       14590000
                    AD-TRANS-RTL-ERR                                    14600000
               MOVE TR-TRANS-COST-ERR (TR-IDX) TO                       14610000
                    AD-TRANS-COST-ERR                                   14620000
               MOVE TR-TRANS-OK       (TR-IDX) TO                       14630000
                    AD-TRANS-OK                                         14640000
               MOVE TR-TRANS-RTL-OK   (TR-IDX) TO                       14650000
                    AD-TRANS-RTL-OK                                     14660000
               MOVE TR-TRANS-COST-OK  (TR-IDX) TO                       14670000
                    AD-TRANS-COST-OK                                    14680000
               MOVE AUDIT-DETAIL-LINE          TO AUDIT-LINE            14690000
               PERFORM B390-WRITE-AUDIT-LINE                            14700000
      **       ACCUM GRAND TOTALS                                       14710000
               IF TR-IDX < TR-MAX                                       14720000
                   ADD  TR-TRANS-IN       (TR-IDX) TO                   14730000
                        TR-TRANS-IN       (TR-MAX)                      14740000
                   ADD  TR-TRANS-RTL-IN   (TR-IDX) TO                   14750000
                        TR-TRANS-RTL-IN   (TR-MAX)                      14760000
                   ADD  TR-TRANS-COST-IN  (TR-IDX) TO                   14770000
                        TR-TRANS-COST-IN  (TR-MAX)                      14780000
                   ADD  TR-TRANS-ERR      (TR-IDX) TO                   14790000
                        TR-TRANS-ERR      (TR-MAX)                      14800000
                   ADD  TR-TRANS-RTL-ERR  (TR-IDX) TO                   14810000
                        TR-TRANS-RTL-ERR  (TR-MAX)                      14820000
                   ADD  TR-TRANS-COST-ERR (TR-IDX) TO                   14830000
                        TR-TRANS-COST-ERR (TR-MAX)                      14840000
                   ADD  TR-TRANS-OK       (TR-IDX) TO                   14850000
                        TR-TRANS-OK       (TR-MAX)                      14860000
                   ADD  TR-TRANS-RTL-OK   (TR-IDX) TO                   14870000
                        TR-TRANS-RTL-OK   (TR-MAX)                      14880000
                   ADD  TR-TRANS-COST-OK  (TR-IDX) TO                   14890000
                        TR-TRANS-COST-OK  (TR-MAX)                      14900000
               END-IF                                                   14910000
           END-PERFORM.                                                 14920000
                                                                        14930000
      **   THE NET CHANGE IN INVENTORY AS A RESULT OF THIS RUN IS:      14940000
                                                                        14950000
      **      INCREASES INVENTORY:         REDUCES INVENTORY:           14960000
                                                                        14970000
      **          PURCHASES                     SALES                   14980000
      **          MARKUPS                       MARKDOWNS               14990000
      **          TRANSFER TO'S                 TRANSFER FROM'S         15000000
      **                                        ADJUSTMENTS             15010000
                                                                        15020000
           COMPUTE  PV-NET-CHANGE-IN-RETAIL    =                        15030000
               TR-TRANS-RTL-OK (1) - TR-TRANS-RTL-OK (2)                15040000
             - TR-TRANS-RTL-OK (3) + TR-TRANS-RTL-OK (4)                15050000
             - TR-TRANS-RTL-OK (5) + TR-TRANS-RTL-OK (6)                15060000
             - TR-TRANS-RTL-OK (7)                                      15070000
                                                                        15080000
           COMPUTE  PV-NET-CHANGE-IN-COST      =                        15090000
               TR-TRANS-COST-OK (1) - TR-TRANS-COST-OK (2)              15100000
             - TR-TRANS-COST-OK (3) + TR-TRANS-COST-OK (4)              15110000
             - TR-TRANS-COST-OK (5) + TR-TRANS-COST-OK (6)              15120000
             - TR-TRANS-COST-OK (7)                                     15130000
                                                                        15140000
           MOVE PV-NET-CHANGE-IN-RETAIL    TO                           15150000
                NC-RETAIL-AMT                                           15160000
           MOVE PV-NET-CHANGE-IN-COST      TO                           15170000
                NC-COST-AMT                                             15180000
                                                                        15190000
           MOVE NET-CHANGE-IN-INVENTORY-LINE TO AUDIT-LINE.             15200000
           PERFORM B390-WRITE-AUDIT-LINE.                               15210000
                                                                        15220000
           MOVE PC-END-OF-REPORT TO AUDIT-LINE                          15230000
           PERFORM B390-WRITE-AUDIT-LINE.                               15240000
                                                                        15250000
                                                                        15260000
       B390-WRITE-AUDIT-LINE.                                           15270000
                                                                        15280000
           WRITE  AUDIT-LINE.                                           15290000
                                                                        15300000
                                                                        15310000
       B399-CLOSE-FILES.                                                15320000
                                                                        15330000
           CLOSE       COMPOSITE-FILE                                   15340000
                       CONTROL-CARD-FILE                                15350000
                       PURCH-FILE                                       15360000
                       SALE-FILE                                        15370000
                       PRC-CHG-FILE                                     15380000
                       ADJUSTMENT-FILE                                  15390000
                       REPORT-FILE                                      15400000
                       ERROR-FILE                                       15410000
W29145                 DW-PRC-CHG-FILE                                  15420000
W28582                 BV-PRC-CHG-FILE                                  15430000
W28582                 BV-PURCH-FILE                                    15440000
                       AUDIT-REPORT-FILE                                15450000
                       EXCEPTIONS-REPORT-FILE.                          15460000
                                                                        15470000
                                                                        15480000
       C100-PROCESS-STORES.                                             15490000
                                                                        15500000
           INITIALIZE ML026-RPT2-ERR-RECORD                             15510000
                                                                        15520000
           SET PV-NO-HIGH-LEVEL-ERROR TO TRUE                           15530000
                                                                        15540000
           MOVE ML020-STORE-NBR TO PV-STORE-NBR                         15550000
                                                                        15560000
      **   EVEN IF THE STORE NUMBER IS INVALID, SPIN THRU THE ENTIRE    15570000
      **   RECORD TO FIND ALL OTHER ERRORS                              15580000
                                                                        15590000
           SET ST-IDX TO 1                                              15600000
W31475     SEARCH ALL STORE-ENTRIES                                     15610000
               AT END                                                   15620000
                   SET ML027-ERR-NOT-FOUND   TO TRUE                    15630000
                   MOVE ML027-ERR-CDE        TO ML026-RPT2-STORE-NBR-ERR15640000
                   SET PV-STORE-LEVEL-ERROR  TO TRUE                    15650000
               WHEN                                                     15660000
                   ST-STORE-NMBR (ST-IDX) = ML020-STORE-NBR             15670000
                       NEXT SENTENCE                                    15680000
                                                                        15690000
           END-SEARCH.                                                  15700000
                                                                        15710000
           PERFORM C110-PROCESS-DEPTS-IN-STORE                          15720000
               UNTIL ML020-STORE-NBR NOT = PV-STORE-NBR OR              15730000
                     END-OF-COMPOSITE-FILE.                             15740000
                                                                        15750000
                                                                        15760000
       C110-PROCESS-DEPTS-IN-STORE.                                     15770000
                                                                        15780000
           MOVE SPACES              TO ML026-RPT2-DEPT-CLASS-ERR        15790000
           MOVE ML020-DEPT-CLASS    TO PV-DEPT-CLASS                    15800000
           SET PV-NOT-SPLIT-FREIGHT TO TRUE                             15810000
                                                                        15820000
      **   IF THE STORE IS BAD, EVERYTHING W/IN THIS STORE MUST BE      15830000
      **   REJECTED.  OTHERWISE, RESET THE HIGH LEVEL ERROR INDICATOR.  15840000
                                                                        15850000
           IF PV-STORE-LEVEL-ERROR                                      15860000
               CONTINUE                                                 15870000
           ELSE                                                         15880000
               SET PV-NO-HIGH-LEVEL-ERROR TO TRUE                       15890000
               INITIALIZE ML026-RPT2-ERR-RECORD                         15900000
           END-IF                                                       15910000
                                                                        15920000
           IF ML020-DEPT-CLASS NUMERIC                                  15930000
W21731       IF ML020-DEPT-CLASS NOT EQUAL '00000'                      15940000
               IF ML020-CLASS-NBR = '00'                                15950000
                   IF ML020-PURCHASE                                    15960000
                       IF ML020-PURCH-DR-CR-CDE = '07' OR '08'          15970000
      *-->                 ** SPLIT FREIGHT DR/CR IS OK **              15980000
                           SET PV-SPLIT-FREIGHT TO TRUE                 15990000
                       ELSE                                             16000000
                           SET ML027-ERR-INVALID-VALUE    TO TRUE       16010000
                           MOVE ML027-ERR-CDE             TO            16020000
                                ML026-RPT2-DEPT-CLASS-ERR               16030000
                           SET PV-DEPT-LEVEL-ERROR   TO TRUE            16040000
                       END-IF                                           16050000
                   ELSE                                                 16060000
                       SET ML027-ERR-INVALID-VALUE    TO TRUE           16070000
                       MOVE ML027-ERR-CDE             TO                16080000
                            ML026-RPT2-DEPT-CLASS-ERR                   16090000
                       SET PV-DEPT-LEVEL-ERROR   TO TRUE                16100000
                   END-IF                                               16110000
               END-IF                                                   16120000
W21731       ELSE                                                       16130000
W21731          SET ML027-ERR-SKU-NOT-FOUND TO TRUE                     16140000
W21731          MOVE ML027-ERR-CDE          TO ML026-RPT2-SKU-ERR       16150000
W21731          SET PV-SKU-LEVEL-ERROR     TO TRUE                      16160000
           ELSE                                                         16170000
               SET ML027-ERR-NON-NUMERIC   TO TRUE                      16180000
               MOVE ML027-ERR-CDE          TO ML026-RPT2-DEPT-CLASS-ERR 16190000
               SET PV-DEPT-LEVEL-ERROR     TO TRUE                      16200000
           END-IF                                                       16210000
                                                                        16220000
      **   EVEN IF THE DEPT/CLASS IS INVALID, SPIN THRU THE ENTIRE      16230000
      **   RECORD TO FIND ALL OTHER ERRORS                              16240000
                                                                        16250000
           IF ML020-CLASS-NBR = '00'                                    16260000
               MOVE ML020-DEPT-CLASS TO PV-DEPT-CLASS                   16270000
           ELSE                                                         16280000
               SET DC-IDX TO 1                                          16290000
                                                                        16300000
W31475         SEARCH ALL DEPT-CLASS-ENTRIES                            16310000
                   AT END                                               16320000
                       SET ML027-ERR-NOT-FOUND        TO TRUE           16330000
                       MOVE ML027-ERR-CDE             TO                16340000
                            ML026-RPT2-DEPT-CLASS-ERR                   16350000
                       SET PV-DEPT-LEVEL-ERROR        TO TRUE           16360000
                                                                        16370000
                   WHEN DC-DEPT-CLASS (DC-IDX) = ML020-DEPT-CLASS       16380000
W31475*             OR  DC-DEPT-CLASS (DC-IDX) = (SPACES OR LOW-VALUES) 16390000
                       NEXT SENTENCE                                    16400000
                                                                        16410000
               END-SEARCH                                               16420000
           END-IF.                                                      16430000
                                                                        16440000
           IF DC-DEPT-CLASS (DC-IDX) = (SPACES OR LOW-VALUES)           16450000
               SET ML027-ERR-NOT-FOUND        TO TRUE                   16460000
               MOVE ML027-ERR-CDE             TO                        16470000
                    ML026-RPT2-DEPT-CLASS-ERR                           16480000
               SET PV-DEPT-LEVEL-ERROR        TO TRUE                   16490000
           END-IF.                                                      16500000
                                                                        16510000
           PERFORM C150-PROCESS-DEPT-CLASS-ACTVTY                       16520000
               UNTIL ML020-DEPT-CLASS NOT = PV-DEPT-CLASS OR            16530000
                     ML020-STORE-NBR  NOT = PV-STORE-NBR  OR            16540000
                     END-OF-COMPOSITE-FILE.                             16550000
                                                                        16560000
                                                                        16570000
       C150-PROCESS-DEPT-CLASS-ACTVTY.                                  16580000
                                                                        16590000
      **   IF THERE'S A HIGH LEVEL ERROR, (BAD STORE OR DEPT/CLASS),    16600000
      **   PROCESS THIS DETAIL, BUT DON'T WRITE OUT A "GOOD" RECORD.    16610000
      **   ALL THE DETAILS FOR THIS CONTROL-BREAK MUST BE REJECTED.     16620000
                                                                        16630000
      **   IF THERE ISN'T A HIGH LEVEL ERROR, RESET THE DETAIL ERROR SW 16640000
                                                                        16650000
           IF PV-HIGH-LEVEL-ERROR                                       16660000
      **-->    ** A STORE NBR OR DEPT/CLASS ERROR EXISTS FOR THIS REC,  16670000
      **-->    ** BUT INITIALIZE ANY OTHER ERROR FIELDS.                16680000
               SET PV-DTL-ERROR    TO TRUE                              16690000
               INITIALIZE ML026-RPT2-DETAIL-DATA-AREA                   16700000
           ELSE                                                         16710000
               SET PV-NO-DTL-ERROR TO TRUE                              16720000
               INITIALIZE ML026-RPT2-ERR-RECORD                         16730000
           END-IF                                                       16740000
                                                                        16750000
           EVALUATE TRUE                                                16760000
               WHEN ML020-PURCHASE                                      16770000
                   PERFORM D100-PROCESS-PURCHASE                        16780000
               WHEN ML020-SALE                                          16790000
                   PERFORM E100-PROCESS-SALE                            16800000
               WHEN ML020-STORE-TRANSFER                                16810000
                   PERFORM F100-PROCESS-TRANSFER                        16820000
               WHEN ML020-PRICE-CHANGE                                  16830000
                   PERFORM G100-PROCESS-PRICE-CHANGE                    16840000
               WHEN ML020-ADJUSTMENT                                    16850000
                   PERFORM H100-PROCESS-ADJUSTMENTS                     16860000
               WHEN OTHER                                               16870000
                   DISPLAY 'INVALID TRANSACTION CODE: '                 16880000
                       ML020-TRANS-CDE                                  16890000
                   PERFORM Z999-INVALID-PRESET-VALUE-ABND               16900000
           END-EVALUATE.                                                16910000
                                                                        16920000
           PERFORM Z100-READ-COMPOSITE-FILE.                            16930000
                                                                        16940000
                                                                        16950000
       D100-PROCESS-PURCHASE.                                           16960000
                                                                        16970000
           ADD 1                                  TO TR-TRANS-IN (1)    16980000
                                                                        16990000
           IF ML020-PURCH-EXTD-RTL-AMT  NUMERIC                         17000000
               IF ML020-PURCH-CR                                        17010000
                  ADD ML020-PURCH-EXTD-RTL-AMT      TO                  17020000
                      TR-TRANS-RTL-IN (1)                               17030000
               ELSE                                                     17040000
                  SUBTRACT ML020-PURCH-EXTD-RTL-AMT FROM                17050000
                      TR-TRANS-RTL-IN (1)                               17060000
               END-IF                                                   17070000
           END-IF                                                       17080000
                                                                        17090000
           IF ML020-PURCH-EXTD-NET-COST-AMT  NUMERIC                    17100000
               IF ML020-PURCH-CR                                        17110000
                   ADD ML020-PURCH-EXTD-NET-COST-AMT       TO           17120000
                       TR-TRANS-COST-IN (1)                             17130000
               ELSE                                                     17140000
                   SUBTRACT ML020-PURCH-EXTD-NET-COST-AMT  FROM         17150000
                       TR-TRANS-COST-IN (1)                             17160000
               END-IF                                                   17170000
           END-IF.                                                      17180000
                                                                        17190000
           PERFORM D110-EDIT-ML020.                                     17200000
                                                                        17210000
           IF PV-NO-DTL-ERROR                                           17220000
               PERFORM D130-WRITE-OUTPUT-FILES                          17230000
           ELSE                                                         17240000
               PERFORM D180-FORMAT-ERROR-REC                            17250000
               PERFORM Z998-WRITE-ERROR-FILE                            17260000
           END-IF.                                                      17270000
                                                                        17280000
                                                                        17290000
       D110-EDIT-ML020.                                                 17300000
                                                                        17310000
           INITIALIZE ML021-PURCH-RECORD                                17320000
W28582                ML030-PURCH-RECORD                                17330000
                      ML025-RPT1-DETAIL-RECORD                          17340000
                                                                        17350000
           IF ML020-DEPT-CLASS = '09910'                                17360000
               SET ML027-ERR-INVALID-VALUE   TO TRUE                    17370000
               MOVE ML027-ERR-CDE            TO                         17380000
                    ML026-RPT2-DEPT-CLASS-ERR                           17390000
               SET PV-DTL-ERROR TO TRUE                                 17400000
           END-IF                                                       17410000
                                                                        17420000
           IF NOT ML020-PURCH-VALID-DR-CR                               17430000
               SET ML027-ERR-INVALID-VALUE   TO TRUE                    17440000
               MOVE ML027-ERR-CDE            TO                         17450000
                    ML026-RPT2-DR-CR-CDE-ERR                            17460000
               SET PV-DTL-ERROR TO TRUE                                 17470000
           END-IF                                                       17480000
                                                                        17490000
           IF NOT ML020-PURCH-VALID-TYP-CDE                             17500000
               DISPLAY 'INVALID PURCH TYP CDE ' ML020-PURCH-TYP-CDE     17510000
               PERFORM Z999-INVALID-PRESET-VALUE-ABND                   17520000
           END-IF                                                       17530000
                                                                        17540000
           IF NOT ML020-PURCH-VALID-JRNL-IND                            17550000
               DISPLAY 'INVALID PURCH JRNL IND ' ML020-PURCH-JRNL-IND   17560000
               PERFORM Z999-INVALID-PRESET-VALUE-ABND                   17570000
           END-IF                                                       17580000
                                                                        17590000
           IF ML020-PURCH-DOC-5-NBR NOT NUMERIC                         17600000
               SET ML027-ERR-NON-NUMERIC     TO TRUE                    17610000
               MOVE ML027-ERR-CDE            TO                         17620000
                    ML026-RPT2-DOC-5-NBR-ERR                            17630000
               SET PV-DTL-ERROR TO TRUE                                 17640000
           END-IF                                                       17650000
                                                                        17660000
           IF ML020-PURCH-PO-NBR    NOT NUMERIC                         17670000
               SET ML027-ERR-NON-NUMERIC     TO TRUE                    17680000
               MOVE ML027-ERR-CDE            TO                         17690000
                    ML026-RPT2-PO-NBR-ERR                               17700000
               SET PV-DTL-ERROR TO TRUE                                 17710000
           END-IF                                                       17720000
                                                                        17730000
           IF ML020-PURCH-VEND-NBR  NOT NUMERIC                         17740000
               SET ML027-ERR-NON-NUMERIC     TO TRUE                    17750000
               MOVE ML027-ERR-CDE            TO                         17760000
                    ML026-RPT2-VEND-NBR-ERR                             17770000
               SET PV-DTL-ERROR TO TRUE                                 17780000
           END-IF                                                       17790000
                                                                        17800000
           IF ML020-ACCOUNTS-PAYABLE OR                                 17810000
              ML020-RECEIPT          OR                                 17820000
21591         ML020-PHYSICAL-INVENTORY OR                               17830000
              ML020-DATA-ENTRY                                          17840000
               CONTINUE                                                 17850000
           ELSE                                                         17860000
               DISPLAY 'INVALID SYST-ORIG-CDE ON A PURCHASE TRAN: '     17870000
                        ML020-SYST-ORIG-CDE                             17880000
               PERFORM Z999-INVALID-PRESET-VALUE-ABND                   17890000
           END-IF                                                       17900000
                                                                        17910000
           IF ML020-PURCH-EXTD-GRO-COST-AMT NOT NUMERIC                 17920000
               SET ML027-ERR-NON-NUMERIC TO TRUE                        17930000
               MOVE ML027-ERR-CDE TO                                    17940000
                    ML026-RPT2-AMT-ERR                                  17950000
               SET PV-DTL-ERROR TO TRUE                                 17960000
           END-IF.                                                      17970000
                                                                        17980000
           IF ML020-PURCH-FRGT-AMT NOT NUMERIC                          17990000
               SET ML027-ERR-NON-NUMERIC TO TRUE                        18000000
               MOVE ML027-ERR-CDE TO                                    18010000
                    ML026-RPT2-FRGT-AMT-ERR                             18020000
               SET PV-DTL-ERROR TO TRUE                                 18030000
           END-IF.                                                      18040000
                                                                        18050000
           IF ML020-PURCH-DISC-AMT NOT NUMERIC                          18060000
               SET ML027-ERR-NON-NUMERIC TO TRUE                        18070000
               MOVE ML027-ERR-CDE TO                                    18080000
                    ML026-RPT2-DISC-AMT-ERR                             18090000
               SET PV-DTL-ERROR TO TRUE                                 18100000
           END-IF.                                                      18110000
                                                                        18120000
           IF ML020-PURCH-EXTD-NET-COST-AMT NOT NUMERIC                 18130000
               SET ML027-ERR-NON-NUMERIC TO TRUE                        18140000
               MOVE ML027-ERR-CDE TO                                    18150000
                    ML026-RPT2-NET-COST-AMT-ERR                         18160000
               SET PV-DTL-ERROR TO TRUE                                 18170000
           END-IF.                                                      18180000
                                                                        18190000
           IF ML020-PURCH-EXTD-RTL-AMT NOT NUMERIC                      18200000
               SET ML027-ERR-NON-NUMERIC TO TRUE                        18210000
               MOVE ML027-ERR-CDE TO                                    18220000
                    ML026-RPT2-RETAIL-AMT-ERR                           18230000
               SET PV-DTL-ERROR TO TRUE                                 18240000
           END-IF.                                                      18250000
                                                                        18260000
           IF  ML020-PURCH-EXTD-GRO-COST-AMT NUMERIC                    18270000
           AND ML020-PURCH-FRGT-AMT          NUMERIC                    18280000
           AND ML020-PURCH-DISC-AMT          NUMERIC                    18290000
           AND ML020-PURCH-EXTD-NET-COST-AMT NUMERIC                    18300000
               COMPUTE PV-NET-COST-AMT                                  18310000
                     = ML020-PURCH-EXTD-GRO-COST-AMT                    18320000
                     + ML020-PURCH-FRGT-AMT                             18330000
                     - ML020-PURCH-DISC-AMT                             18340000
               IF PV-NET-COST-AMT NOT = ML020-PURCH-EXTD-NET-COST-AMT   18350000
                   SET ML027-ERR-INVALID-VALUE TO TRUE                  18360000
                   MOVE ML027-ERR-CDE TO                                18370000
                        ML026-RPT2-NET-COST-AMT-ERR                     18380000
                   SET PV-DTL-ERROR TO TRUE                             18390000
               END-IF                                                   18400000
           END-IF.                                                      18410000
                                                                        18420000
           PERFORM D120-DATE-EDITS.                                     18430000
P49345                                                                  18440008
P49345     IF ML020-PURCH-EXTD-RTL-AMT > 9999999.99                     18450000
P49345         SET ML027-ERR-EXTDAMT-OUT-OF-RANGE TO TRUE               18460000
P49345         MOVE ML027-ERR-CDE TO                                    18470000
P49345              ML026-RPT2-AMT-ERR                                  18480000
P49345         SET PV-DTL-ERROR TO TRUE                                 18490000
P49345     END-IF.                                                      18500000
                                                                        18510000
                                                                        18520000
       D120-DATE-EDITS.                                                 18530000
                                                                        18540000
      ****************************************************************  18550000
      * SET THE FINANCIAL LIABILITY DATE AND DOC DATE ON THE OUTPUT     18560000
      * RECORD AS FOLLOWS:                                              18570000
      *                                                                 18580000
      * FINANCIAL LIABILITY DATE:                                       18590000
      *   IF THERE IS A PURCH-DATE, EDIT IT.  IF IT IS VALID, USE IT    18600000
      *   FOR THE FINANCIAL LIABILITY DATE. IF NOT, ERROR THE RECORD    18610000
      *   OUT.                                                          18620000
      *   IF THERE IS NO PURCH-DATE, EDIT THE DOC-DATE.  IF IT IS VALID,18630000
      *   USE IF FOR THE FINANCIAL LIABILITY DATE.  IF NOT, ERROR THE   18640000
      *   RECORD OUT.                                                   18650000
      *                                                                 18660000
      * DOC DATE:                                                       18670000
      *  IF THE DOC-DATE ON THE INPUT RECORD IS VALID, USE IT.          18680000
      *  IF NOT, LEAVE THE DOC-DATE BLANK.                              18690000
      ****************************************************************  18700000
                                                                        18710000
           SET PS-NO-DATE-ERROR TO TRUE.                                18720000
                                                                        18730000
           IF  ML020-PURCH-DTE NUMERIC                                  18740000
           AND ML020-PURCH-DTE > ZEROS                                  18750000
                                                                        18760000
      *        THERE IS A PURCH-DATE, SO EDIT IT. IF IT IS VALID, USE IT18770000
      *        FOR THE FINANCIAL LIABILITY DATE ON THE OUTPUT RECORD.   18780000
                                                                        18790000
               MOVE ML020-PURCH-DTE TO PV-EDIT-DTE                      18800000
               PERFORM Z200-EDIT-DTE                                    18810000
               IF PS-DATE-ERROR                                         18820000
                   SET ML027-ERR-INVALID-DATE                           18830000
                       PV-DTL-ERROR   TO TRUE                           18840000
                   MOVE ML027-ERR-CDE TO ML026-RPT2-FIN-LIAB-DTE-ERR    18850000
               ELSE                                                     18860000
                   MOVE EDT-ISO-DTE       (EDT-IDX)                     18870000
                                    TO ML021-PURCH-FIN-LIAB-DTE         18880000
W28582                                 ML030-PURCH-FIN-LIAB-DTE         18890000
                                       ML025-RPT1-FIN-LIAB-DTE          18900000
                   MOVE EDT-FSCL-YR-NBR     (EDT-IDX)                   18910000
W28582                              TO ML021-PURCH-FSCL-YR              18920000
W28582                                 ML030-PURCH-FSCL-YR              18930000
                   MOVE EDT-FSCL-MN-NBR   (EDT-IDX)                     18940000
W28582                              TO ML021-PURCH-FSCL-PER             18950000
W28582                                 ML030-PURCH-FSCL-PER             18960000
                   MOVE EDT-WK-IN-MN-NBR  (EDT-IDX)                     18970000
W28582                              TO ML021-PURCH-FSCL-WK              18980000
W28582                                 ML030-PURCH-FSCL-WK              18990000
                   MOVE EDT-DAY-OF-WK-NBR (EDT-IDX)                     19000000
W28582                              TO ML021-PURCH-FSCL-DAY             19010000
W28582                                 ML030-PURCH-FSCL-DAY             19020000
                                                                        19030000
                   MOVE ML021-PURCH-FIN-LIAB-DTE TO PV-FIN-LIAB-DTE     19040000
                   PERFORM Z300-SET-ML-AND-INV-INDS                     19050000
                                                                        19060000
      *            EDIT THE DOC DATE. IF IT IS VALID, USE IT FOR THE    19070000
      *            DOC DATE ON THE OUTPUT RECORD.                       19080000
                                                                        19090000
                   IF  ML020-PURCH-DOC-DTE NUMERIC                      19100000
                   AND ML020-PURCH-DOC-DTE > ZEROS                      19110000
                       MOVE ML020-PURCH-DOC-MM TO PV-EDIT-MM            19120000
                       MOVE ML020-PURCH-DOC-DD TO PV-EDIT-DD            19130000
                       MOVE SPACE              TO PV-EDIT-YY            19140000
                       PERFORM Z200-EDIT-DTE                            19150000
                       IF PS-NO-DATE-ERROR                              19160000
                           MOVE EDT-ISO-DTE (EDT-IDX)                   19170000
                                                  TO ML021-PURCH-DOC-DTE19180000
W28582                                               ML030-PURCH-DOC-DTE19190000
                       END-IF                                           19200000
                   END-IF                                               19210000
               END-IF                                                   19220000
           ELSE                                                         19230000
      *        THERE IS NO PURCH-DATE, SO EDIT THE DOC-DATE. IF IT IS   19240000
      *        VALID, USE IT FOR BOTH THE FINANCIAL LIABILITY DATE AND  19250000
      *        THE DOC DATE ON THE OUTPUT RECORD.                       19260000
                                                                        19270000
               IF  ML020-PURCH-DOC-DTE NUMERIC                          19280000
               AND ML020-PURCH-DOC-DTE > ZEROS                          19290000
                   MOVE ML020-PURCH-DOC-MM TO PV-EDIT-MM                19300000
                   MOVE ML020-PURCH-DOC-DD TO PV-EDIT-DD                19310000
                   MOVE SPACE              TO PV-EDIT-YY                19320000
                   PERFORM Z200-EDIT-DTE                                19330000
                   IF PS-DATE-ERROR                                     19340000
                       SET ML027-ERR-INVALID-DATE                       19350000
                           PV-DTL-ERROR   TO TRUE                       19360000
                       MOVE ML027-ERR-CDE TO ML026-RPT2-FIN-LIAB-DTE-ERR19370000
                   ELSE                                                 19380000
                       MOVE EDT-ISO-DTE       (EDT-IDX)                 19390000
                                        TO ML021-PURCH-FIN-LIAB-DTE     19400000
W28582                                     ML030-PURCH-FIN-LIAB-DTE     19410000
                                           ML025-RPT1-FIN-LIAB-DTE      19420000
                       MOVE EDT-FSCL-YR-NBR   (EDT-IDX)                 19430000
                                        TO ML021-PURCH-FSCL-YR          19440000
W28582                                     ML030-PURCH-FSCL-YR          19450000
                       MOVE EDT-FSCL-MN-NBR   (EDT-IDX)                 19460000
                                        TO ML021-PURCH-FSCL-PER         19470000
W28582                                     ML030-PURCH-FSCL-PER         19480000
                       MOVE EDT-WK-IN-MN-NBR  (EDT-IDX)                 19490000
                                        TO ML021-PURCH-FSCL-WK          19500000
W28582                                     ML030-PURCH-FSCL-WK          19510000
                       MOVE EDT-DAY-OF-WK-NBR (EDT-IDX)                 19520000
                                        TO ML021-PURCH-FSCL-DAY         19530000
W28582                                     ML030-PURCH-FSCL-DAY         19540000
                                                                        19550000
                       MOVE ML021-PURCH-FIN-LIAB-DTE TO PV-FIN-LIAB-DTE 19560000
                       PERFORM Z300-SET-ML-AND-INV-INDS                 19570000
                       MOVE EDT-ISO-DTE (EDT-IDX) TO ML021-PURCH-DOC-DTE19580000
W28582                                               ML030-PURCH-DOC-DTE19590000
                   END-IF                                               19600000
               ELSE                                                     19610000
                   SET ML027-ERR-INVALID-DATE                           19620000
                       PV-DTL-ERROR   TO TRUE                           19630000
                   MOVE ML027-ERR-CDE TO ML026-RPT2-FIN-LIAB-DTE-ERR    19640000
               END-IF                                                   19650000
           END-IF.                                                      19660000
                                                                        19670000
                                                                        19680000
       D130-WRITE-OUTPUT-FILES.                                         19690000
                                                                        19700000
           ADD 1  TO TR-TRANS-OK (1)                                    19710000
                                                                        19720000
           IF ML020-PURCH-EXTD-RTL-AMT  NUMERIC                         19730000
               IF ML020-PURCH-CR                                        19740000
                  ADD ML020-PURCH-EXTD-RTL-AMT      TO                  19750000
                      TR-TRANS-RTL-OK (1)                               19760000
               ELSE                                                     19770000
                  SUBTRACT ML020-PURCH-EXTD-RTL-AMT FROM                19780000
                      TR-TRANS-RTL-OK (1)                               19790000
               END-IF                                                   19800000
           END-IF                                                       19810000
                                                                        19820000
           IF ML020-PURCH-EXTD-NET-COST-AMT  NUMERIC                    19830000
               IF ML020-PURCH-CR                                        19840000
                   ADD ML020-PURCH-EXTD-NET-COST-AMT       TO           19850000
                       TR-TRANS-COST-OK (1)                             19860000
               ELSE                                                     19870000
                   SUBTRACT ML020-PURCH-EXTD-NET-COST-AMT  FROM         19880000
                       TR-TRANS-COST-OK (1)                             19890000
               END-IF                                                   19900000
           END-IF                                                       19910000
                                                                        19920000
           MOVE PV-PSTG-FSCL-YR-NBR     TO ML025-RPT1-FSCL-YR-CDE.      19930000
           MOVE MLCNTL-PSTG-FSCL-MN-NBR TO ML025-RPT1-FSCL-PER-CDE.     19940000
                                                                        19950000
           MOVE ML020-STORE-NBR         TO ML021-PURCH-STORE-NBR        19960000
W28582                                     ML030-PURCH-STORE-NBR        19970000
                                           ML025-RPT1-STORE-NBR         19980000
           MOVE ML020-SKU               TO ML021-PURCH-SKU              19990000
W28582                                     ML030-PURCH-SKU              20000000
                                           ML025-RPT1-SKU               20010000
                                                                        20020000
W21731     MOVE ML020-DEPT-CLASS        TO ML021-PURCH-DEPT-CLASS       20030000
W28582                                     ML030-PURCH-DEPT-CLASS       20040000
W21731                                     ML025-RPT1-DEPT-CLASS        20050000
W21731                                                                  20060000
           MOVE ML020-SYST-ORIG-CDE     TO ML021-PURCH-SYST-ORIG-CDE    20070000
W28582                                     ML030-PURCH-SYST-ORIG-CDE    20080000
21015      IF ML021-PURCH-RECEIPT                                       20090000
21015          MOVE ML020-SYST-ORIG-CDE TO ML025-RPT1-SYST-ORIG-CDE     20100000
21015      ELSE                                                         20110000
21015          MOVE SPACES              TO ML025-RPT1-SYST-ORIG-CDE     20120000
21015      END-IF.                                                      20130000
21015                                                                   20140000
           MOVE ML020-TRANS-CDE         TO ML021-PURCH-TRANS-CDE        20150000
W28582                                     ML030-PURCH-TRANS-CDE        20160000
                                           ML025-RPT1-TRANS-CDE         20170000
                                                                        20180000
           MOVE ML020-PURCH-EXTD-GRO-COST-AMT TO                        20190000
                ML021-PURCH-EXTD-GRO-COST-AMT                           20200000
W28582          ML030-PURCH-EXTD-GRO-COST-AMT                           20210000
                                                                        20220000
           MOVE ML020-PURCH-FRGT-AMT          TO                        20230000
                ML021-PURCH-FRGT-AMT                                    20240000
W28582          ML030-PURCH-FRGT-AMT                                    20250000
           MOVE ML020-PURCH-DISC-AMT          TO                        20260000
                ML021-PURCH-DISC-AMT                                    20270000
W29582          ML030-PURCH-DISC-AMT                                    20280000
                                                                        20290000
      **   THE SIGN ON THE AMOUNT FIELD FOR CREDITS IS REVERSED ON THE  20300000
      **   EDIT SPLIT FILE SO THAT THE EDIT SPLIT PROGRAM (MLKRP054)    20310000
      **   DOES NOT HAVE TO DIFFERENTIATE BETWEEN DEBITS AND CREDITS.   20320000
      **   IF THE SIGN WAS NOT REVERSED, MLKRP054 WOULD HAVE TO ADD     20330000
      **   DEBITS AND SUBTRACT CREDITS WHEN ACCUMULATING TOTALS.        20340000
                                                                        20350000
           MOVE ML020-PURCH-EXTD-NET-COST-AMT  TO                       20360000
                ML021-PURCH-EXTD-NET-COST-AMT                           20370000
W28582          ML030-PURCH-EXTD-NET-COST-AMT                           20380000
                ML025-RPT1-EXTD-COST-AMT                                20390000
           IF ML020-PURCH-DR                                            20400000
                MULTIPLY -1 BY ML025-RPT1-EXTD-COST-AMT                 20410000
           END-IF                                                       20420000
                                                                        20430000
           MOVE ML020-PURCH-EXTD-RTL-AMT       TO                       20440000
                ML021-PURCH-EXTD-RTL-AMT                                20450000
W28582          ML030-PURCH-EXTD-RTL-AMT                                20460000
                ML025-RPT1-EXTD-RTL-AMT                                 20470000
           IF ML020-PURCH-DR                                            20480000
               MULTIPLY -1 BY ML025-RPT1-EXTD-RTL-AMT                   20490000
           END-IF                                                       20500000
                                                                        20510000
           MOVE ML020-PURCH-DR-CR-CDE          TO                       20520000
                ML021-PURCH-DR-CR-CDE                                   20530000
W28582          ML030-PURCH-DR-CR-CDE                                   20540000
           MOVE ML020-PURCH-AP-TRANS-CDE       TO                       20550000
                ML021-PURCH-AP-TRANS-CDE                                20560000
W28582          ML030-PURCH-AP-TRANS-CDE                                20570000
           MOVE ML020-PURCH-TYP-CDE            TO                       20580000
                ML021-PURCH-TYP-CDE                                     20590000
W28582          ML030-PURCH-TYP-CDE                                     20600000
                                                                        20610000
1299RM* WR 20698                                                        20620000
1299RM     MOVE ML020-PURCH-PO-TYP-CDE         TO                       20630000
W28582          ML021-PURCH-PO-TYP-CDE                                  20640000
W28582          ML030-PURCH-PO-TYP-CDE.                                 20650000
                                                                        20660000
           MOVE ML020-PURCH-JRNL-IND    TO ML021-PURCH-JRNL-IND         20670000
W28582                                     ML030-PURCH-JRNL-IND         20680000
                                                                        20690000
           MOVE MLCNTL-PSTG-FSCL-WK-DTE TO ML021-PURCH-EDIT-DTE         20700000
W28582                                     ML030-PURCH-EDIT-DTE         20710000
                                                                        20720000
           MOVE ML020-PURCH-DOC-5-NBRX  TO ML021-PURCH-DOC-5-NBR        20730000
W28582                                     ML030-PURCH-DOC-5-NBR        20740008
                                           ML025-RPT1-DOC-5-NBR         20750000
           MOVE ML020-PURCH-BATCH-NBR   TO ML021-PURCH-BATCH-NBR        20760000
W28582                                     ML030-PURCH-BATCH-NBR        20770008
                                           ML025-RPT1-BATCH-NBR         20780000
           MOVE ML020-PURCH-PO-NBR      TO ML021-PURCH-PO-NBR           20790000
W28582                                     ML030-PURCH-PO-NBR           20800008
           MOVE ML020-PURCH-VEND-NBR    TO ML021-PURCH-VEND-NBR         20810000
W28582                                     ML030-PURCH-VEND-NBR         20820008
W26603     MOVE ML020-PURCH-ENT-ID      TO ML021-PURCH-ENT-ID           20830000
W28582                                     ML030-PURCH-ENT-ID           20840008
           MOVE ML020-PURCH-KOHLS-MM    TO ML021-PURCH-KOHLS-MM         20850000
W28582                                     ML030-PURCH-KOHLS-MM         20860008
                                                                        20870000
           MOVE PV-ML-IND               TO ML021-PURCH-ML-IND           20880000
W28582                                     ML030-PURCH-ML-IND           20890008
                                           ML025-RPT1-ML-IND            20900000
           MOVE PV-INV-IND              TO ML021-PURCH-INV-IND          20910000
W28582                                     ML030-PURCH-INV-IND          20920000
                                           ML025-RPT1-INV-IND           20930000
                                                                        20940000
W28582     MOVE ML020-PURCH-DOC-16-NBR  TO ML030-PURCH-DOC-16-NBR.      20950000
W28582     MOVE ML020-PURCH-PO-9-NBR    TO ML030-PURCH-PO-9-NBR.        20960000
W32898     MOVE ML020-PURCH-LBL-SEQ-NBR TO ML030-PURCH-LBL-SEQ-NBR.     20970000
W28582     MOVE ML020-PURCH-ML-LWST-ID  TO ML030-PURCH-ML-LWST-ID.      20980000
W28582                                                                  20990000
      **   SPLIT FREIGHT PURCHASES MUST HAVE THEIR NET COST AND FREIGHT 21000000
      **   COSTS SPREAD OUT EVENLY THROUGH EACH CLASS IN THE DEPARTMENT.21010000
      **   THE FIRST CLASS GETS THE PENNIES APPLIED TO IT'S ML021       21020000
      **   FIELDS.  ALL OTHER CLASS ML021 RECORDS WILL CONTAIN WHOLE    21030000
      **   NUMBERS.                                                     21040000
                                                                        21050000
           IF PV-NOT-SPLIT-FREIGHT                                      21060000
               WRITE PURCH-REC            FROM ML021-PURCH-RECORD       21070000
W28582         WRITE BV-PURCH-REC         FROM ML030-PURCH-RECORD       21080000
               PERFORM Z400-WRITE-RPT1-REC                              21090000
                                                                        21100000
           ELSE                                                         21110000
                                                                        21120000
               COMPUTE ML021-PURCH-EXTD-NET-COST-AMT ROUNDED =          21130000
                   ML020-PURCH-EXTD-NET-COST-AMT /                      21140000
                   DC-NBR-OF-CLASSES-IN-DEPT(DC-IDX)                    21150000
                                                                        21160000
W28582         COMPUTE ML030-PURCH-EXTD-NET-COST-AMT ROUNDED =          21170000
W28582             ML020-PURCH-EXTD-NET-COST-AMT /                      21180000
W28582             DC-NBR-OF-CLASSES-IN-DEPT(DC-IDX)                    21190000
W28582                                                                  21200000
               COMPUTE ML021-PURCH-FRGT-AMT ROUNDED =                   21210000
                   ML020-PURCH-FRGT-AMT  /                              21220000
                   DC-NBR-OF-CLASSES-IN-DEPT(DC-IDX)                    21230000
                                                                        21240000
W28582         COMPUTE ML030-PURCH-FRGT-AMT ROUNDED =                   21250000
W28582             ML020-PURCH-FRGT-AMT  /                              21260000
W28582             DC-NBR-OF-CLASSES-IN-DEPT(DC-IDX)                    21270000
W28582                                                                  21280000
               MOVE ML021-PURCH-EXTD-NET-COST-AMT TO                    21290000
                    PV-AVG-COST-WHOLE                                   21300000
               MOVE ML021-PURCH-FRGT-AMT          TO                    21310000
                    PV-AVG-FRGT-WHOLE                                   21320000
                                                                        21330000
      **-->    ** POSITION BACK TO THE FIRST CLASS IN THIS DEPARTMENT   21340000
               PERFORM VARYING DC-IDX2 FROM 1 BY 1                      21350000
                   UNTIL ML020-DEPT-NBR =                               21360000
                         DC-DEPT-NBR (DC-IDX2)                          21370000
               END-PERFORM                                              21380000
                                                                        21390000
      **-->    ** WRITE THE 1ST CLASS W/ THE DECIMAL VALUES             21400000
                                                                        21410000
               PERFORM D160-WRITE-SPLIT-FREIGHT-RECS                    21420000
                                                                        21430000
      **-->    ** NOW APPLY WHOLE NUMBER VALUES TO THE REMAINING CLASSES21440000
      **-->    ** IN THE DEPARTMENT UNTIL THE TABLED DEPT-NBR CHANGES.  21450000
                                                                        21460000
               SET DC-IDX2 UP BY +1                                     21470000
                                                                        21480000
               PERFORM D150-APPLY-WHOLE-NBRS                            21490000
                   VARYING DC-IDX2 FROM DC-IDX2 BY 1                    21500000
                       UNTIL DC-DEPT-NBR (DC-IDX2) NOT = ML020-DEPT-NBR 21510000
           END-IF.                                                      21520000
                                                                        21530000
       D150-APPLY-WHOLE-NBRS.                                           21540000
                                                                        21550000
           MOVE PV-AVG-COST-WHOLE     TO                                21560000
                ML021-PURCH-EXTD-NET-COST-AMT                           21570000
W28582          ML030-PURCH-EXTD-NET-COST-AMT                           21580000
                                                                        21590000
           MOVE PV-AVG-FRGT-WHOLE     TO                                21600000
                ML021-PURCH-FRGT-AMT                                    21610000
W28582          ML030-PURCH-FRGT-AMT                                    21620000
                                                                        21630000
           PERFORM D160-WRITE-SPLIT-FREIGHT-RECS.                       21640000
                                                                        21650000
       D160-WRITE-SPLIT-FREIGHT-RECS.                                   21660000
                                                                        21670000
           MOVE ML021-PURCH-EXTD-NET-COST-AMT  TO                       21680000
                ML025-RPT1-EXTD-COST-AMT                                21690000
           IF ML020-PURCH-DR                                            21700000
                MULTIPLY -1 BY ML025-RPT1-EXTD-COST-AMT                 21710000
           END-IF                                                       21720000
                                                                        21730000
           MOVE DC-CLASS-NBR(DC-IDX2) TO   ML021-PURCH-CLASS-NBR        21740000
W28582                                     ML030-PURCH-CLASS-NBR        21750000
           WRITE PURCH-REC            FROM ML021-PURCH-RECORD           21760000
W28582     WRITE BV-PURCH-REC         FROM ML030-PURCH-RECORD           21770000
           PERFORM Z400-WRITE-RPT1-REC.                                 21780000
                                                                        21790000
                                                                        21800000
       D180-FORMAT-ERROR-REC.                                           21810000
                                                                        21820000
           MOVE ML020-STORE-NBR         TO ML026-RPT2-STORE-NBR         21830000
W21731     MOVE ML020-SKU               TO ML026-RPT2-SKU               21840000
W21731     MOVE ML020-DEPT-CLASS        TO ML026-RPT2-DEPT-CLASS        21850000
           MOVE ML020-TRANS-CDE         TO ML026-RPT2-TRANS-CDE         21860000
                                                                        21870000
           MOVE SPACES                  TO ML026-RPT2-REL-STORE-NBR     21880000
                                                                        21890000
           IF ML020-PURCH-DTE NUMERIC                                   21900000
           AND ML020-PURCH-DTE > ZERO                                   21910000
               MOVE ML020-PURCH-DTE-MM      TO ML026-RPT2-FIN-LIAB-MM   21920000
               MOVE '/'                     TO ML026-RPT2-FIN-SLASH1    21930000
               MOVE ML020-PURCH-DTE-DD      TO ML026-RPT2-FIN-LIAB-DD   21940000
               MOVE '/'                     TO ML026-RPT2-FIN-SLASH2    21950000
               MOVE ML020-PURCH-DTE-YY      TO ML026-RPT2-FIN-LIAB-YY   21960000
           ELSE                                                         21970000
               IF ML020-PURCH-DOC-DTE NUMERIC                           21980000
               AND ML020-PURCH-DOC-DTE > ZERO                           21990000
                   MOVE ML020-PURCH-DOC-MM  TO ML026-RPT2-FIN-LIAB-MM   22000000
                   MOVE '/'                 TO ML026-RPT2-FIN-SLASH1    22010000
                   MOVE ML020-PURCH-DOC-DD  TO ML026-RPT2-FIN-LIAB-DD   22020000
               ELSE                                                     22030000
                   MOVE ML020-PURCH-DTE-MM  TO ML026-RPT2-FIN-LIAB-MM   22040000
                   MOVE '/'                 TO ML026-RPT2-FIN-SLASH1    22050000
                   MOVE ML020-PURCH-DTE-DD  TO ML026-RPT2-FIN-LIAB-DD   22060000
                   MOVE '/'                 TO ML026-RPT2-FIN-SLASH2    22070000
                   MOVE ML020-PURCH-DTE-YY  TO ML026-RPT2-FIN-LIAB-YY   22080000
               END-IF                                                   22090000
           END-IF.                                                      22100000
                                                                        22110000
           MOVE SPACES                  TO ML026-RPT2-KOHLS-MM          22120000
                                                                        22130000
           MOVE ZEROS                   TO ML026-RPT2-QTYX              22140000
           MOVE ML020-PURCH-DOC-5-NBRX  TO ML026-RPT2-DOC-5-NBR         22150000
                                                                        22160000
679223     IF ML020-PURCH-EXTD-GRO-COST-AMT NOT NUMERIC                 22170000
               MOVE ML020-PURCH-EXTD-GRO-COST-AMTX                      22180000
                                        TO ML026-RPT2-AMTX              22190000
679223     ELSE                                                         22200008
679223         MOVE ML020-PURCH-EXTD-GRO-COST-AMT                       22210000
679223                                  TO ML026-RPT2-AMT               22220000
679223     END-IF.                                                      22230008
                                                                        22240000
           MOVE ZEROS                   TO ML026-RPT2-OLD-PR-AMTX.      22250000
           MOVE ZEROS                   TO ML026-RPT2-NEW-PR-AMTX.      22260000
                                                                        22270000
           MOVE ML020-PURCH-PO-NBRX     TO ML026-RPT2-PO-NBRX.          22280000
           MOVE ML020-PURCH-RSN-CDE     TO ML026-RPT2-RSN-CDE           22290000
           MOVE ML020-PURCH-BATCH-NBR   TO ML026-RPT2-BATCH-NBR         22300000
           MOVE ML020-PURCH-VEND-NBR    TO ML026-RPT2-VEND-NBR          22310000
W26603     MOVE ML020-PURCH-ENT-ID      TO ML026-RPT2-ENT-ID            22320000
679223                                                                  22330008
679223     IF ML020-PURCH-DISC-AMT NOT NUMERIC                          22340000
               MOVE ML020-PURCH-DISC-AMTX  TO ML026-RPT2-DISC-AMTX      22350000
679223     ELSE                                                         22360008
679223         MOVE ML020-PURCH-DISC-AMT   TO ML026-RPT2-DISC-AMT       22370000
679223     END-IF.                                                      22380008
679223                                                                  22390008
679223     IF ML020-PURCH-FRGT-AMT NOT NUMERIC                          22400000
               MOVE ML020-PURCH-FRGT-AMTX   TO ML026-RPT2-FRGT-AMTX     22410000
679223     ELSE                                                         22420008
679223         MOVE ML020-PURCH-FRGT-AMT    TO ML026-RPT2-FRGT-AMT      22430000
679223     END-IF.                                                      22440008
679223                                                                  22450008
679223     IF ML020-PURCH-EXTD-NET-COST-AMT NOT NUMERIC                 22460000
               MOVE ML020-PURCH-EXTD-NET-COST-AMTX                      22470000
                                        TO ML026-RPT2-NET-COST-AMT      22480000
679223     ELSE                                                         22490008
679223         MOVE ML020-PURCH-EXTD-NET-COST-AMT                       22500000
679223                                  TO ML026-RPT2-NET-COST-AMT      22510000
679223     END-IF.                                                      22520008
679223                                                                  22530008
679223     IF ML020-PURCH-EXTD-RTL-AMT NOT NUMERIC                      22540000
               MOVE ML020-PURCH-EXTD-RTL-AMTX                           22550000
                                        TO ML026-RPT2-RETAIL-AMTX       22560000
679223     ELSE                                                         22570008
679223         MOVE ML020-PURCH-EXTD-RTL-AMT                            22580000
679223                                  TO ML026-RPT2-RETAIL-AMT        22590000
679223     END-IF.                                                      22600008
679223                                                                  22610008
           MOVE ML020-PURCH-DR-CR-CDE   TO ML026-RPT2-DR-CR-CDE.        22620000
                                                                        22630000
           ADD 1                                  TO TR-TRANS-ERR (1)   22640000
                                                                        22650000
           IF ML020-PURCH-EXTD-RTL-AMT  NUMERIC                         22660000
               IF ML020-PURCH-CR                                        22670000
                  ADD ML020-PURCH-EXTD-RTL-AMT      TO                  22680000
                      TR-TRANS-RTL-ERR (1)                              22690000
               ELSE                                                     22700000
                  SUBTRACT ML020-PURCH-EXTD-RTL-AMT FROM                22710000
                      TR-TRANS-RTL-ERR (1)                              22720000
               END-IF                                                   22730000
           END-IF.                                                      22740000
                                                                        22750000
           IF ML020-PURCH-EXTD-NET-COST-AMT  NUMERIC                    22760000
               IF ML020-PURCH-CR                                        22770000
                   ADD ML020-PURCH-EXTD-NET-COST-AMT       TO           22780000
                       TR-TRANS-COST-ERR (1)                            22790000
               ELSE                                                     22800000
                   SUBTRACT ML020-PURCH-EXTD-NET-COST-AMT  FROM         22810000
                       TR-TRANS-COST-ERR (1)                            22820000
               END-IF                                                   22830000
           END-IF.                                                      22840000
                                                                        22850000
           EJECT                                                        22860000
       E100-PROCESS-SALE.                                               22870000
                                                                        22880000
           ADD 1                                  TO TR-TRANS-IN (2)    22890000
                                                                        22900000
           IF ML020-SALE-EXTD-RTL-AMT  NUMERIC                          22910000
              ADD ML020-SALE-EXTD-RTL-AMT         TO                    22920000
              TR-TRANS-RTL-IN (2)                                       22930000
           END-IF                                                       22940000
                                                                        22950000
           PERFORM E110-EDIT-ML020.                                     22960000
                                                                        22970000
           IF PV-NO-DTL-ERROR                                           22980000
               PERFORM E130-WRITE-OUTPUT-FILES                          22990000
           ELSE                                                         23000000
               PERFORM E140-FORMAT-ERROR-REC                            23010000
               PERFORM Z998-WRITE-ERROR-FILE                            23020000
           END-IF.                                                      23030000
                                                                        23040000
                                                                        23050000
       E110-EDIT-ML020.                                                 23060000
                                                                        23070000
           INITIALIZE ML022-SALE-RECORD                                 23080000
                      ML025-RPT1-DETAIL-RECORD                          23090000
                                                                        23100000
           IF ML020-POS              OR                                 23110000
              ML020-DATA-ENTRY                                          23120000
               CONTINUE                                                 23130000
           ELSE                                                         23140000
               DISPLAY 'INVALID SYST-ORIG-CDE ON A SALE TRAN: '         23150000
                        ML020-SYST-ORIG-CDE                             23160000
               PERFORM Z999-INVALID-PRESET-VALUE-ABND                   23170000
           END-IF                                                       23180000
                                                                        23190000
           PERFORM E120-DATE-EDITS.                                     23200000
                                                                        23210000
                                                                        23220000
       E120-DATE-EDITS.                                                 23230000
                                                                        23240000
           SET PS-NO-DATE-ERROR TO TRUE.                                23250000
                                                                        23260000
           IF  ML020-SALE-DTE NUMERIC                                   23270000
           AND ML020-SALE-DTE > ZERO                                    23280000
               MOVE ML020-SALE-DTE TO PV-EDIT-DTE                       23290000
               PERFORM Z200-EDIT-DTE                                    23300000
               IF PS-DATE-ERROR                                         23310000
                   SET ML027-ERR-INVALID-VALUE TO TRUE                  23320000
                   MOVE ML027-ERR-CDE TO                                23330000
                        ML026-RPT2-FIN-LIAB-DTE-ERR                     23340000
                   SET PV-DTL-ERROR TO TRUE                             23350000
               ELSE                                                     23360000
                   MOVE EDT-ISO-DTE (EDT-IDX) TO ML022-SALE-FIN-LIAB-DTE23370000
                                                 ML025-RPT1-FIN-LIAB-DTE23380000
      **-->            ** FOR SALES, THE LIAB DTE MUST BE W/IN THE      23390000
      **-->            ** PROCESSING DATE'S FISCAL RANGE.               23400000
W27261             PERFORM E125-DATE-RANGE-CHECK THRU E125-EXIT         23410000
W27261             EVALUATE ML027-ERR-OUT-OF-RANGE                      23420000
W27261               WHEN TRUE                                          23430000
W27261                 MOVE ML027-ERR-CDE TO ML026-RPT2-FIN-LIAB-DTE-ERR23440000
W27261                 SET PV-DTL-ERROR   TO TRUE                       23450000
W27261                 MOVE SPACES TO ML027-ERR-CDE                     23460000
W27261               WHEN OTHER                                         23470008
W27261                 MOVE ML022-SALE-FIN-LIAB-DTE TO PV-FIN-LIAB-DTE  23480000
W27261                 PERFORM Z300-SET-ML-AND-INV-INDS                 23490000
W27261             END-EVALUATE                                         23500000
               END-IF                                                   23510000
           ELSE                                                         23520000
               SET ML027-ERR-NON-NUMERIC                                23530000
                   PV-DTL-ERROR   TO TRUE                               23540000
               MOVE ML027-ERR-CDE TO ML026-RPT2-FIN-LIAB-DTE-ERR        23550000
           END-IF.                                                      23560000
                                                                        23570000
W27261 E125-DATE-RANGE-CHECK.                                           23580000
W27261******************************************************************23590000
W27261* DURING THE NEW DAILY PROCESSING CYCLE FOR SALES & MARKDOWNS WE  23600000
W27261* MUST KNOW IF WE ARE RUNNING DURING A CUTOFF WEEK. IF IT IS, THE 23610000
W27261* DATE RANGE BEING COMPARED AGAINST MUST TAKE THAT INTO ACCOUNT   23620000
W27261* THEREFORE WE USE PV-FSCL-MN-END-DTE INSTEAD OF                  23630000
W27261*                                     MLCNTL-PSTG-FSCL-MN-DTE.    23640000
W27261* N O T E:                                                        23650000
W27261* IN THIS ROUTINE ML027-ERR-OUT-OF-RANGE = TRUE SETS              23660000
W27261* ML027-ERR-CDE TO THE VALUE '008'.                               23670000
W27261******************************************************************23680000
W27261     IF ITS-A-DAILY-CUTOFF-RUN                                    23690000
W27261       IF (ML022-SALE-FIN-LIAB-DTE < PV-FSCL-MN-BEG-DTE           23700000
W27261         OR                                                       23710000
W27261          ML022-SALE-FIN-LIAB-DTE > PV-FSCL-MN-END-DTE)           23720000
W27261            SET ML027-ERR-OUT-OF-RANGE  TO TRUE                   23730000
W27261       END-IF                                                     23740000
W27261     ELSE                                                         23750000
W27261       IF (ML022-SALE-FIN-LIAB-DTE < PV-FSCL-MN-BEG-DTE           23760000
W27261         OR                                                       23770000
W27261          ML022-SALE-FIN-LIAB-DTE > MLCNTL-PSTG-FSCL-MN-DTE)      23780000
W27261            SET ML027-ERR-OUT-OF-RANGE  TO TRUE                   23790000
W27261       END-IF                                                     23800000
W27261     END-IF.                                                      23810000
W27261 E125-EXIT.                                                       23820000
W27261      EXIT.                                                       23830000
                                                                        23840000
       E130-WRITE-OUTPUT-FILES.                                         23850000
                                                                        23860000
           MOVE ML020-STORE-NBR         TO ML022-SALE-STORE-NBR         23870000
                                           ML025-RPT1-STORE-NBR         23880000
           MOVE ML020-SKU               TO ML022-SALE-SKU               23890000
                                           ML025-RPT1-SKU               23900000
W21731     MOVE ML020-DEPT-CLASS        TO ML022-SALE-DEPT-CLASS        23910000
W21731                                     ML025-RPT1-DEPT-CLASS        23920000
           MOVE ML020-SYST-ORIG-CDE     TO ML022-SALE-SYST-ORIG-CDE     23930000
           MOVE ML020-TRANS-CDE         TO ML022-SALE-TRANS-CDE         23940000
                                           ML025-RPT1-TRANS-CDE         23950000
                                                                        23960000
           MOVE EDT-FSCL-YR-NBR   (EDT-IDX) TO ML022-SALE-FSCL-YR       23970000
                                               ML025-RPT1-FSCL-YR-CDE   23980000
           MOVE EDT-FSCL-MN-NBR   (EDT-IDX) TO ML022-SALE-FSCL-PER      23990000
                                               ML025-RPT1-FSCL-PER-CDE  24000000
           MOVE EDT-WK-IN-MN-NBR  (EDT-IDX) TO ML022-SALE-FSCL-WK.      24010000
           MOVE EDT-DAY-OF-WK-NBR (EDT-IDX) TO ML022-SALE-FSCL-DAY.     24020000
           MOVE EDT-FSCL-WK-NBR   (EDT-IDX) TO ML022-SALE-FSCL-WK-NBR.  24030000
                                                                        24040000
           MOVE ML020-SALE-EXTD-RTL-AMT TO                              24050000
                ML022-SALE-EXTD-RTL-AMT                                 24060000
                ML025-RPT1-EXTD-RTL-AMT.                                24070000
                                                                        24080000
           MOVE MLCNTL-PSTG-FSCL-MN-NBR TO ML022-SALE-KOHLS-MM.         24090000
           MOVE MLCNTL-PSTG-FSCL-WK-DTE TO ML022-SALE-EDIT-DTE.         24100000
                                                                        24110000
           MOVE PV-ML-IND               TO ML022-SALE-ML-IND            24120000
                                           ML025-RPT1-ML-IND.           24130000
           MOVE PV-INV-IND              TO ML022-SALE-INV-IND           24140000
                                           ML025-RPT1-INV-IND.          24150000
           MOVE ML020-SALE-TYPE-2       TO ML022-SALE-TYPE-2.           24160000
           MOVE ML020-SALE-CORR-CDE     TO ML022-SALE-CORR-CDE.         24170000
                                                                        24180000
           WRITE SALE-REC             FROM ML022-SALE-RECORD.           24190000
                                                                        24200000
           ADD 1                                  TO TR-TRANS-OK (2).   24210000
                                                                        24220000
           ADD ML020-SALE-EXTD-RTL-AMT            TO                    24230000
               TR-TRANS-RTL-OK (2).                                     24240000
                                                                        24250000
           PERFORM Z400-WRITE-RPT1-REC.                                 24260000
                                                                        24270000
                                                                        24280000
       E140-FORMAT-ERROR-REC.                                           24290000
                                                                        24300000
           MOVE ML020-STORE-NBR         TO ML026-RPT2-STORE-NBR         24310000
           MOVE ML020-SKU               TO ML026-RPT2-SKU               24320000
W21731     MOVE ML020-DEPT-CLASS        TO ML026-RPT2-DEPT-CLASS        24330000
           MOVE ML020-TRANS-CDE         TO ML026-RPT2-TRANS-CDE         24340000
                                                                        24350000
           MOVE SPACES                  TO ML026-RPT2-REL-STORE-NBR     24360000
                                                                        24370000
           MOVE ML020-SALE-DTE-MM       TO ML026-RPT2-FIN-LIAB-MM       24380000
           MOVE '/'                     TO ML026-RPT2-FIN-SLASH1        24390000
           MOVE ML020-SALE-DTE-DD       TO ML026-RPT2-FIN-LIAB-DD       24400000
           MOVE '/'                     TO ML026-RPT2-FIN-SLASH2        24410000
           MOVE ML020-SALE-DTE-YY       TO ML026-RPT2-FIN-LIAB-YY       24420000
                                                                        24430000
           MOVE SPACES                  TO ML026-RPT2-KOHLS-MM          24440000
679223                                                                  24450000
679223     IF ML020-SALE-EXTD-RTL-AMT NOT NUMERIC                       24460000
               MOVE ML020-SALE-EXTD-RTL-AMTX                            24470000
                                        TO ML026-RPT2-AMTX              24480000
679223     ELSE                                                         24490008
679223         MOVE ML020-SALE-EXTD-RTL-AMT                             24500000
679223                                  TO ML026-RPT2-AMT               24510000
679223     END-IF.                                                      24520008
679223                                                                  24530000
           MOVE ZEROS                   TO ML026-RPT2-OLD-PR-AMTX.      24540000
           MOVE ZEROS                   TO ML026-RPT2-NEW-PR-AMTX.      24550000
           MOVE ZEROS                   TO ML026-RPT2-PO-NBRX.          24560000
           MOVE ML020-SALE-RSN-CDE      TO ML026-RPT2-RSN-CDE           24570000
           MOVE SPACES                  TO ML026-RPT2-BATCH-NBR         24580000
           MOVE SPACES                  TO ML026-RPT2-VEND-NBR          24590000
W26603     MOVE ZEROS                   TO ML026-RPT2-ENT-ID            24600000
           MOVE ZEROS                   TO ML026-RPT2-DISC-AMTX.        24610000
           MOVE ZEROS                   TO ML026-RPT2-FRGT-AMTX.        24620000
           MOVE ZEROS                   TO ML026-RPT2-NET-COST-AMTX     24630000
           MOVE SPACES                  TO ML026-RPT2-DR-CR-CDE.        24640000
                                                                        24650000
           ADD 1                                  TO TR-TRANS-ERR(2)    24660000
                                                                        24670000
           IF ML020-SALE-EXTD-RTL-AMT  NUMERIC                          24680000
              ADD ML020-SALE-EXTD-RTL-AMT         TO                    24690000
              TR-TRANS-RTL-ERR (2)                                      24700000
           END-IF.                                                      24710000
                                                                        24720000
                                                                        24730000
       F100-PROCESS-TRANSFER.                                           24740000
                                                                        24750000
           ADD 1                                  TO TR-TRANS-IN (3)    24760000
                                                     TR-TRANS-IN (4)    24770000
                                                                        24780000
      **   THE ST-IDX VALUE FOR THE "FROM" STORE IS SAVED HERE          24790000
      **   BECAUSE IT WILL BE ALTERED IN F110-EDIT-ML020 WHEN THE "TO"  24800000
      **   STORE IS LOOKED UP IN THE STORE TABLE. THE "FROM" STORE'S    24810000
      **   ST-IDX VALUE IS RESTORED AT THE END OF THIS PARAGRAPH.       24820000
                                                                        24830000
           SET PV-SAVE-ST-IDX TO ST-IDX.                                24840000
                                                                        24850000
           PERFORM F110-EDIT-ML020.                                     24860000
                                                                        24870000
      **   TWO RECORDS ARE WRITTEN FOR TRANSFERS. ONE FOR THE "FROM"    24880000
      **   STORE, AND THE OTHER FOR THE "TO".                           24890000
                                                                        24900000
           IF PV-NO-DTL-ERROR                                           24910000
               PERFORM F130-WRITE-OUTPUT-FILES                          24920000
               PERFORM F140-WRITE-ML021-TO-STORE                        24930000
           ELSE                                                         24940000
               PERFORM F150-FORMAT-ERROR-REC                            24950000
               PERFORM Z998-WRITE-ERROR-FILE                            24960000
           END-IF.                                                      24970000
                                                                        24980000
           SET ST-IDX TO PV-SAVE-ST-IDX.                                24990000
                                                                        25000000
                                                                        25010000
       F110-EDIT-ML020.                                                 25020000
                                                                        25030000
           INITIALIZE ML021-PURCH-RECORD                                25040000
W28582                ML030-PURCH-RECORD                                25050000
                      ML025-RPT1-DETAIL-RECORD                          25060000
                                                                        25070000
           IF ML020-DEPT-CLASS = '09910'                                25080000
               SET ML027-ERR-INVALID-VALUE   TO TRUE                    25090000
               MOVE ML027-ERR-CDE            TO                         25100000
                    ML026-RPT2-DEPT-CLASS-ERR                           25110000
               SET PV-DTL-ERROR TO TRUE                                 25120000
           END-IF                                                       25130000
                                                                        25140000
           IF ML020-DATA-ENTRY                                          25150000
               CONTINUE                                                 25160000
           ELSE                                                         25170000
               DISPLAY 'INVALID SYST-ORIG-CDE ON A TRANSFER TRAN: '     25180000
                        ML020-SYST-ORIG-CDE                             25190000
               PERFORM Z999-INVALID-PRESET-VALUE-ABND                   25200000
           END-IF                                                       25210000
                                                                        25220000
           IF NOT ML020-XFER-VALID-TYP-CDE                              25230000
               DISPLAY 'INVALID XFER TYP CDE '                          25240000
                        ML020-XFER-TYP-CDE                              25250000
               PERFORM Z999-INVALID-PRESET-VALUE-ABND                   25260000
           END-IF                                                       25270000
                                                                        25280000
           IF ML020-XFER-BATCH-NBR NUMERIC                              25290000
               CONTINUE                                                 25300000
           ELSE                                                         25310000
               MOVE ZEROS TO ML020-XFER-BATCH-NBR                       25320000
           END-IF                                                       25330000
                                                                        25340000
           IF  ML020-XFER-NBR NUMERIC                                   25350000
               CONTINUE                                                 25360000
           ELSE                                                         25370000
               IF  ML020-XFER-NBR = 'FAST '                             25380000
                   MOVE ML020-XFER-NBR           TO                     25390000
                        EX-SOURCE-NBR                                   25400000
               ELSE                                                     25410000
                   SET ML027-ERR-NON-NUMERIC     TO TRUE                25420000
                   MOVE ML027-ERR-CDE            TO                     25430000
                        ML026-RPT2-DOC-5-NBR-ERR                        25440000
                   SET PV-DTL-ERROR TO TRUE                             25450000
               END-IF                                                   25460000
           END-IF                                                       25470000
                                                                        25480000
           IF ML020-XFER-QTY  NUMERIC                                   25490000
               IF ML020-XFER-QTY > +0                                   25500000
                   CONTINUE                                             25510000
               ELSE                                                     25520000
                   SET ML027-ERR-LESS-THAN-OR-EQ-ZERO TO TRUE           25530000
                   MOVE ML027-ERR-CDE                 TO                25540000
                        ML026-RPT2-QTY-ERR                              25550000
                   SET PV-DTL-ERROR TO TRUE                             25560000
               END-IF                                                   25570000
           ELSE                                                         25580000
               SET ML027-ERR-NON-NUMERIC      TO TRUE                   25590000
               MOVE ML027-ERR-CDE             TO ML026-RPT2-QTY-ERR     25600000
               SET PV-DTL-ERROR TO TRUE                                 25610000
           END-IF                                                       25620000
                                                                        25630000
           IF ML020-XFER-PER-UNT-RTL-AMT  NUMERIC                       25640000
               IF ML020-XFER-PER-UNT-RTL-AMT > +0                       25650000
                   CONTINUE                                             25660000
               ELSE                                                     25670000
                   SET ML027-ERR-LESS-THAN-OR-EQ-ZERO TO TRUE           25680000
                   MOVE ML027-ERR-CDE                 TO                25690000
                        ML026-RPT2-OLD-PR-AMT-ERR                       25700000
                   SET PV-DTL-ERROR TO TRUE                             25710000
               END-IF                                                   25720000
           ELSE                                                         25730000
               SET ML027-ERR-NON-NUMERIC      TO TRUE                   25740000
               MOVE ML027-ERR-CDE             TO                        25750000
                    ML026-RPT2-OLD-PR-AMT-ERR                           25760000
               SET PV-DTL-ERROR TO TRUE                                 25770000
           END-IF                                                       25780000
                                                                        25790000
           MOVE ZERO TO ML020-XFER-EXTD-RTL-AMT.                        25800000
                                                                        25810000
           IF ML020-XFER-QTY              NUMERIC   AND                 25820000
              ML020-XFER-PER-UNT-RTL-AMT  NUMERIC                       25830000
                                                                        25840000
               COMPUTE ML020-XFER-EXTD-RTL-AMT =                        25850000
                       ML020-XFER-QTY * ML020-XFER-PER-UNT-RTL-AMT      25860000
               ADD ML020-XFER-EXTD-RTL-AMT TO TR-TRANS-RTL-IN (3)       25870000
                                              TR-TRANS-RTL-IN (4)       25880000
                                                                        25890000
           END-IF.                                                      25900000
                                                                        25910008
P49345     IF ML020-XFER-EXTD-RTL-AMT > 9999999.99                      25920000
P49345         SET ML027-ERR-EXTDAMT-OUT-OF-RANGE TO TRUE               25930000
P49345         MOVE ML027-ERR-CDE            TO                         25940000
P49345              ML026-RPT2-AMT-ERR                                  25950000
P49345         SET PV-DTL-ERROR TO TRUE                                 25960000
P49345     END-IF                                                       25970000
                                                                        25980000
           PERFORM F120-DATE-EDITS                                      25990000
                                                                        26000000
      **   NOTE:  KEEP THIS "TO" STORE TEST <<AFTER>> THE F120-DATE     26010000
      **          PERFORM.  F120-DATE-EDITS SETS PV-INV-IND WHICH MUST  26020000
      **          APPLY TO THE "FROM" STORE.  THE SEARCH (BELOW) CHANGES26030000
      **          THE ST-IDX VALUE.  F140-WRITE-ML021-TO-STORE TAKES THE26040000
      **          "TO" STORE'S PLND_INV_DTE INTO ACCOUNT SEPARATELY.    26050000
      **          THE ST-IDX VALUE FOR THE "FROM" STORE WAS SAVED       26060000
      **          EARLIER, AND WILL BE RESTORED AFTER THE "TO" STORE    26070000
      **          RECORD HAS BEEN WRITTEN.                              26080000
                                                                        26090000
           IF ML020-XFER-TO-STORE-NBR = ML020-STORE-NBR                 26100000
               SET ML027-ERR-OLD-EQUAL-NEW        TO TRUE               26110000
               MOVE ML027-ERR-CDE                 TO                    26120000
                    ML026-RPT2-STORE-NBR-ERR                            26130000
                    ML026-RPT2-REL-STORE-NBR-ERR                        26140000
                    SET PV-DTL-ERROR TO TRUE                            26150000
           ELSE                                                         26160000
               SET ST-IDX TO 1                                          26170000
                                                                        26180000
W31475         SEARCH ALL STORE-ENTRIES                                 26190000
                   AT END                                               26200000
                       SET ML027-ERR-NOT-FOUND            TO TRUE       26210000
                       MOVE ML027-ERR-CDE                 TO            26220000
                            ML026-RPT2-REL-STORE-NBR-ERR                26230000
                       SET PV-DTL-ERROR TO TRUE                         26240000
                   WHEN                                                 26250000
                       ST-STORE-NMBR (ST-IDX) =                         26260000
                       ML020-XFER-TO-STORE-NBR                          26270000
                           NEXT SENTENCE                                26280000
               END-SEARCH                                               26290000
           END-IF.                                                      26300000
                                                                        26310000
                                                                        26320000
       F120-DATE-EDITS.                                                 26330000
                                                                        26340000
           SET PS-NO-DATE-ERROR TO TRUE.                                26350000
                                                                        26360000
           IF  ML020-XFER-DTE NUMERIC                                   26370000
           AND ML020-XFER-DTE > ZERO                                    26380000
               MOVE ML020-XFER-MM TO PV-EDIT-MM                         26390000
               MOVE ML020-XFER-DD TO PV-EDIT-DD                         26400000
               MOVE SPACE         TO PV-EDIT-YY                         26410000
                                                                        26420000
               PERFORM Z200-EDIT-DTE                                    26430000
                                                                        26440000
               IF PS-DATE-ERROR                                         26450000
                   SET ML027-ERR-INVALID-VALUE                          26460000
                       PV-DTL-ERROR       TO TRUE                       26470000
                   MOVE ML027-ERR-CDE     TO ML026-RPT2-FIN-LIAB-DTE-ERR26480000
               ELSE                                                     26490000
                   MOVE EDT-ISO-DTE (EDT-IDX)                           26500000
                                          TO ML021-PURCH-FIN-LIAB-DTE   26510000
W28582                                       ML030-PURCH-FIN-LIAB-DTE   26520000
                                             ML021-PURCH-DOC-DTE        26530000
W28582                                       ML030-PURCH-DOC-DTE        26540000
                                             ML025-RPT1-FIN-LIAB-DTE    26550000
                   MOVE ML021-PURCH-FIN-LIAB-DTE                        26560000
                                          TO PV-FIN-LIAB-DTE            26570000
                   PERFORM Z300-SET-ML-AND-INV-INDS                     26580000
               END-IF                                                   26590000
           ELSE                                                         26600000
               SET ML027-ERR-INVALID-VALUE                              26610000
                   PV-DTL-ERROR           TO TRUE                       26620000
               MOVE ML027-ERR-CDE         TO ML026-RPT2-FIN-LIAB-DTE-ERR26630000
           END-IF.                                                      26640000
                                                                        26650000
           IF ML020-XFER-KOHLS-MM NOT NUMERIC                           26660000
               SET ML027-ERR-INVALID-DATE TO TRUE                       26670000
               MOVE ML027-ERR-CDE    TO ML026-RPT2-KOHLS-MM-ERR         26680000
               SET PV-DTL-ERROR      TO TRUE                            26690000
           END-IF.                                                      26700000
                                                                        26710000
                                                                        26720000
       F130-WRITE-OUTPUT-FILES.                                         26730000
                                                                        26740000
           MOVE ML020-STORE-NBR             TO ML021-PURCH-STORE-NBR    26750000
W28582                                         ML030-PURCH-STORE-NBR    26760008
                                               ML025-RPT1-STORE-NBR     26770000
           MOVE ML020-SKU                   TO ML021-PURCH-SKU          26780000
W28582                                         ML030-PURCH-SKU          26790008
                                               ML025-RPT1-SKU           26800000
W21731     MOVE ML020-DEPT-CLASS            TO ML021-PURCH-DEPT-CLASS   26810000
W28582                                         ML030-PURCH-DEPT-CLASS   26820008
W21731                                         ML025-RPT1-DEPT-CLASS    26830000
21015                                                                   26840000
           MOVE ML020-SYST-ORIG-CDE         TO ML021-PURCH-SYST-ORIG-CDE26850000
W28582                                         ML030-PURCH-SYST-ORIG-CDE26860000
21015      IF ML021-PURCH-RECEIPT                                       26870000
21015          MOVE ML020-SYST-ORIG-CDE  TO ML025-RPT1-SYST-ORIG-CDE    26880000
21015      ELSE                                                         26890000
21015          MOVE SPACES               TO ML025-RPT1-SYST-ORIG-CDE    26900000
21015      END-IF.                                                      26910000
21015                                                                   26920000
           MOVE ML020-TRANS-CDE             TO ML021-PURCH-TRANS-CDE    26930000
W28582                                         ML030-PURCH-TRANS-CDE    26940008
                                               ML025-RPT1-TRANS-CDE     26950000
                                                                        26960000
           MOVE PV-PSTG-FSCL-YR-NBR         TO ML025-RPT1-FSCL-YR-CDE.  26970000
           MOVE MLCNTL-PSTG-FSCL-MN-NBR     TO ML025-RPT1-FSCL-PER-CDE. 26980000
                                                                        26990000
           MOVE EDT-FSCL-YR-NBR   (EDT-IDX) TO ML021-PURCH-FSCL-YR      27000000
W28582                                         ML030-PURCH-FSCL-YR.     27010000
           MOVE EDT-FSCL-MN-NBR   (EDT-IDX) TO ML021-PURCH-FSCL-PER     27020000
W28582                                         ML030-PURCH-FSCL-PER.    27030000
           MOVE EDT-WK-IN-MN-NBR  (EDT-IDX) TO ML021-PURCH-FSCL-WK      27040000
W28582                                         ML030-PURCH-FSCL-WK.     27050000
           MOVE EDT-DAY-OF-WK-NBR (EDT-IDX) TO ML021-PURCH-FSCL-DAY     27060000
W28582                                         ML030-PURCH-FSCL-DAY.    27070000
                                                                        27080000
           MOVE MLCNTL-PSTG-FSCL-WK-DTE     TO ML021-PURCH-EDIT-DTE     27090000
W28582                                         ML030-PURCH-EDIT-DTE     27100000
                                                                        27110000
           MOVE PV-ML-IND               TO ML021-PURCH-ML-IND           27120000
W28582                                     ML030-PURCH-ML-IND           27130008
                                           ML025-RPT1-ML-IND            27140000
           MOVE PV-INV-IND              TO ML021-PURCH-INV-IND          27150000
W28582                                     ML030-PURCH-INV-IND          27160008
                                           ML025-RPT1-INV-IND           27170000
                                                                        27180000
           MOVE ML020-XFER-AP-TRANS-CDE TO ML021-PURCH-AP-TRANS-CDE     27190000
W28582                                     ML030-PURCH-AP-TRANS-CDE     27200000
           MOVE ML020-XFER-TYP-CDE      TO ML021-PURCH-TYP-CDE          27210000
W28582                                     ML030-PURCH-TYP-CDE          27220000
                                                                        27230000
           MOVE ML020-XFER-NBR          TO ML021-PURCH-DOC-5-NBR        27240000
W28582                                     ML030-PURCH-DOC-5-NBR        27250008
                                           ML025-RPT1-DOC-5-NBRX        27260000
                                                                        27270000
           MOVE ML020-XFER-BATCH-NBR    TO ML021-PURCH-BATCH-NBR        27280000
W28582                                     ML030-PURCH-BATCH-NBR        27290008
                                           ML025-RPT1-BATCH-NBR         27300000
           MOVE ML020-XFER-TO-STORE-NBR TO ML021-PURCH-REL-STORE-NBR    27310000
W28582                                     ML030-PURCH-REL-STORE-NBR    27320000
                                                                        27330000
           MOVE ML020-XFER-QTY          TO ML021-PURCH-QTY              27340000
W28582                                     ML030-PURCH-QTY              27350000
           MOVE ML020-XFER-PER-UNT-RTL-AMT                              27360000
                                        TO ML021-PURCH-PER-UNT-RTL-AMT  27370000
W28582                                     ML030-PURCH-PER-UNT-RTL-AMT  27380000
           MOVE MLCNTL-PSTG-FSCL-MN-NBR TO ML021-PURCH-KOHLS-MM         27390000
W28582                                     ML030-PURCH-KOHLS-MM         27400000
                                                                        27410000
           MOVE ML020-XFER-EXTD-RTL-AMT TO ML021-PURCH-EXTD-RTL-AMT     27420000
W28582                                     ML030-PURCH-EXTD-RTL-AMT     27430000
                                           ML025-RPT1-EXTD-RTL-AMT      27440000
                                                                        27450000
           ADD 1                        TO TR-TRANS-OK (3)              27460000
           ADD ML020-XFER-EXTD-RTL-AMT  TO TR-TRANS-RTL-OK (3)          27470000
26006R     MOVE ML020-XFER-ENT-ID       TO ML021-PURCH-ENT-ID           27480000
W28582                                     ML030-PURCH-ENT-ID           27490000
                                                                        27500000
           MOVE ZERO                   TO ML021-PURCH-EXTD-NET-COST-AMT 27510000
W28582                                    ML030-PURCH-EXTD-NET-COST-AMT 27520000
                                          ML025-RPT1-EXTD-COST-AMT      27530000
                                                                        27540000
           IF  ML020-XFER-NBR = 'FAST '                                 27550000
               MOVE SPACES TO ML025-RPT1-XFER-DOC-NBR                   27560000
               IF  ML020-XFER-DOC-STORE NUMERIC AND                     27570000
                   ML020-XFER-DOC-SEQ   NUMERIC                         27580000
                   MOVE ML020-XFER-DOC-STORE     TO                     27590000
                        ML025-RPT1-XFER-DOC-STORE                       27600000
                   MOVE ML020-XFER-DOC-SEQ       TO                     27610000
                        ML025-RPT1-XFER-DOC-SEQ                         27620000
               ELSE                                                     27630000
                   MOVE ML020-XFER-DOC-NBR (1:4) TO                     27640000
                        ML025-RPT1-XFER-DOC-NBR (1:4)                   27650000
                   MOVE ML020-XFER-DOC-NBR (5:6) TO                     27660000
                        ML025-RPT1-XFER-DOC-NBR (5:6)                   27670000
               END-IF                                                   27680000
           ELSE                                                         27690000
               MOVE SPACES                       TO                     27700000
                    ML025-RPT1-XFER-DOC-NBR                             27710000
           END-IF                                                       27720000
                                                                        27730000
           WRITE PURCH-REC           FROM ML021-PURCH-RECORD.           27740000
W28582     WRITE BV-PURCH-REC        FROM ML030-PURCH-RECORD            27750000
                                                                        27760000
           PERFORM Z400-WRITE-RPT1-REC.                                 27770000
                                                                        27780000
           IF ML021-PURCH-EXTD-RTL-AMT > 999.99                         27790000
               PERFORM F160-WRITE-EXCEPTION-REPORT                      27800000
           END-IF.                                                      27810000
                                                                        27820000
                                                                        27830000
       F140-WRITE-ML021-TO-STORE.                                       27840000
                                                                        27850000
      **   FOR THE MOST PART, USE THE "FROM" STORE'S ML021 VALUES.      27860000
      **   THIS RECORD IS THE "TO" STORE COUNTERPART.                   27870000
                                                                        27880000
           MOVE ML020-XFER-TO-STORE-NBR                                 27890000
                                        TO ML021-PURCH-STORE-NBR        27900000
W28582                                     ML030-PURCH-STORE-NBR        27910000
                                           ML025-RPT1-STORE-NBR         27920000
                                                                        27930000
           MOVE '31'                    TO ML021-PURCH-TRANS-CDE        27940000
W28582                                     ML030-PURCH-TRANS-CDE        27950000
                                           ML025-RPT1-TRANS-CDE         27960000
                                                                        27970000
           MOVE PC-AP-TRANS-CDE-XFER-TO TO ML021-PURCH-AP-TRANS-CDE     27980000
W28582                                     ML030-PURCH-AP-TRANS-CDE.    27990000
                                                                        28000000
                                                                        28010000
           MOVE ML021-PURCH-FIN-LIAB-DTE TO PV-FIN-LIAB-DTE.            28020000
           PERFORM Z300-SET-ML-AND-INV-INDS.                            28030000
           MOVE PV-ML-IND               TO ML021-PURCH-ML-IND           28040000
W28582                                     ML030-PURCH-ML-IND           28050000
                                           ML025-RPT1-ML-IND            28060000
           MOVE PV-INV-IND              TO ML021-PURCH-INV-IND          28070000
W28582                                     ML030-PURCH-INV-IND          28080000
                                           ML025-RPT1-INV-IND           28090000
                                                                        28100000
      **   THIS IS THE "FROM" STORE.                                    28110000
           MOVE ML020-STORE-NBR         TO ML021-PURCH-REL-STORE-NBR    28120000
W28582                                     ML030-PURCH-REL-STORE-NBR    28130000
                                                                        28140000
           ADD 1                                  TO TR-TRANS-OK (4)    28150000
           ADD ML020-XFER-EXTD-RTL-AMT            TO                    28160000
               TR-TRANS-RTL-OK (4)                                      28170000
                                                                        28180000
           WRITE PURCH-REC            FROM ML021-PURCH-RECORD.          28190000
W28582     WRITE BV-PURCH-REC         FROM ML030-PURCH-RECORD.          28200000
                                                                        28210000
           PERFORM Z400-WRITE-RPT1-REC.                                 28220000
                                                                        28230000
                                                                        28240000
       F150-FORMAT-ERROR-REC.                                           28250000
                                                                        28260000
      **   A SINGLE ERROR (RPT2) RECORD IS WRITTEN FOR 30/31'S.         28270000
                                                                        28280000
           MOVE ML020-STORE-NBR         TO ML026-RPT2-STORE-NBR         28290000
                                                                        28300000
W21731     MOVE ML020-SKU               TO ML026-RPT2-SKU               28310000
W21731     MOVE ML020-DEPT-CLASS        TO ML026-RPT2-DEPT-CLASS        28320000
           MOVE ML020-TRANS-CDE         TO ML026-RPT2-TRANS-CDE         28330000
                                                                        28340000
           MOVE ML020-XFER-TO-STORE-NBR                                 28350000
                                        TO ML026-RPT2-REL-STORE-NBR     28360000
                                                                        28370000
           MOVE ML020-XFER-MM           TO ML026-RPT2-FIN-LIAB-MM.      28380000
           MOVE '/'                     TO ML026-RPT2-FIN-SLASH1.       28390000
           MOVE ML020-XFER-DD           TO ML026-RPT2-FIN-LIAB-DD.      28400000
                                                                        28410000
           MOVE ML020-XFER-KOHLS-MM     TO ML026-RPT2-KOHLS-MM          28420000
           MOVE ML020-XFER-QTYX         TO ML026-RPT2-QTYX.             28430000
679223                                                                  28440008
679223     IF ML020-XFER-EXTD-RTL-AMT NOT NUMERIC                       28450000
               MOVE ML020-XFER-EXTD-RTL-AMTX                            28460000
                                        TO ML026-RPT2-AMTX              28470000
679223     ELSE                                                         28480008
679223         MOVE ML020-XFER-EXTD-RTL-AMT                             28490000
679223                                  TO ML026-RPT2-AMT               28500000
679223     END-IF.                                                      28510008
                                                                        28520008
           IF ML020-XFER-PER-UNT-RTL-AMT NUMERIC                        28530000
               MOVE ML020-XFER-PER-UNT-RTL-AMT                          28540000
                                        TO ML026-RPT2-OLD-PR-AMT        28550000
           ELSE                                                         28560000
               MOVE ML020-XFER-PER-UNT-RTL-AMTX                         28570000
                                        TO ML026-RPT2-OLD-PR-AMTX       28580000
           END-IF.                                                      28590000
                                                                        28600008
           MOVE ZEROS                   TO ML026-RPT2-NEW-PR-AMTX.      28610000
           MOVE ZEROS                   TO ML026-RPT2-PO-NBRX.          28620000
           MOVE ML020-XFER-RSN-CDE      TO ML026-RPT2-RSN-CDE           28630000
           MOVE ML020-XFER-NBR          TO ML026-RPT2-DOC-5-NBR         28640000
           MOVE ML020-XFER-BATCH-NBR    TO ML026-RPT2-BATCH-NBR         28650000
           MOVE SPACES                  TO ML026-RPT2-VEND-NBR          28660000
26006R     MOVE ML020-XFER-ENT-ID       TO ML026-RPT2-ENT-ID            28670000
           MOVE ZEROS                   TO ML026-RPT2-DISC-AMTX.        28680000
           MOVE ZEROS                   TO ML026-RPT2-FRGT-AMTX.        28690000
           MOVE ZEROS                   TO ML026-RPT2-NET-COST-AMTX     28700000
           MOVE ZEROS                   TO ML026-RPT2-RETAIL-AMTX.      28710000
           MOVE ZEROS                   TO ML026-RPT2-DR-CR-CDE.        28720000
                                                                        28730000
           IF  ML020-XFER-NBR = 'FAST '                                 28740000
               IF  ML020-XFER-DOC-STORE NUMERIC AND                     28750000
                   ML020-XFER-DOC-SEQ   NUMERIC                         28760000
                   MOVE ML020-XFER-DOC-STORE     TO                     28770000
                        ML026-RPT2-XFER-DOC-STORE                       28780000
                   MOVE ML020-XFER-DOC-SEQ       TO                     28790000
                        ML026-RPT2-XFER-DOC-SEQ                         28800000
               ELSE                                                     28810000
                   MOVE ML020-XFER-DOC-NBR (1:4) TO                     28820000
                        ML026-RPT2-XFER-DOC-NBR (1:4)                   28830000
                   MOVE ML020-XFER-DOC-NBR (5:6) TO                     28840000
                        ML026-RPT2-XFER-DOC-NBR (5:6)                   28850000
               END-IF                                                   28860000
           ELSE                                                         28870000
               MOVE ML020-XFER-NBR               TO                     28880000
                    ML026-RPT2-XFER-DOC-NBR                             28890000
           END-IF                                                       28900000
                                                                        28910000
           ADD 1                                  TO TR-TRANS-ERR(3)    28920000
                                                     TR-TRANS-ERR(4)    28930000
                                                                        28940000
           IF ML020-XFER-EXTD-RTL-AMT  NUMERIC                          28950000
               ADD ML020-XFER-EXTD-RTL-AMT        TO                    28960000
                   TR-TRANS-RTL-ERR (3)                                 28970000
                   TR-TRANS-RTL-ERR (4)                                 28980000
           END-IF.                                                      28990000
                                                                        29000000
                                                                        29010000
       F160-WRITE-EXCEPTION-REPORT.                                     29020000
                                                                        29030000
           MOVE SPACES                  TO EX-DETAIL-LINE               29040000
                                                                        29050000
           MOVE ML020-STORE-NBR         TO EX-STORE-NBR                 29060000
                                                                        29070000
           MOVE ML020-DEPT-CLASS        TO EX-DEPT-CLASS                29080000
           MOVE ML020-TRANS-CDE         TO EX-TRANS-CDE                 29090000
                                                                        29100000
           MOVE ML020-XFER-TO-STORE-NBR TO EX-REL-STORE-NBR             29110000
                                                                        29120000
           MOVE ML020-XFER-BATCH-NBR    TO EX-BATCH-NBR                 29130000
           MOVE ML020-XFER-KOHLS-MM     TO EX-KOHLS-MM                  29140000
                                                                        29150000
           IF  ML020-XFER-NBR NUMERIC                                   29160000
               CONTINUE                                                 29170000
           ELSE                                                         29180000
               IF  ML020-XFER-NBR = 'FAST '                             29190000
                   MOVE ML020-XFER-NBR           TO                     29200000
                        EX-SOURCE-NBR                                   29210000
               ELSE                                                     29220000
                   SET ML027-ERR-NON-NUMERIC     TO TRUE                29230000
                   MOVE ML027-ERR-CDE            TO                     29240000
                        ML026-RPT2-DOC-5-NBR-ERR                        29250000
                   SET PV-DTL-ERROR TO TRUE                             29260000
               END-IF                                                   29270000
           END-IF                                                       29280000
                                                                        29290000
           IF  ML020-XFER-NBR = 'FAST '                                 29300000
               IF  ML020-XFER-DOC-STORE NUMERIC AND                     29310000
                   ML020-XFER-DOC-SEQ    NUMERIC                        29320000
                   MOVE ML020-XFER-DOC-STORE     TO                     29330000
                        EX-DOC-NBR-11 (1:4)                             29340000
                   MOVE '-'                      TO                     29350000
                        EX-DOC-NBR-11 (5:1)                             29360000
                   MOVE ML020-XFER-DOC-SEQ       TO                     29370000
                        EX-DOC-NBR-11 (6:6)                             29380000
               ELSE                                                     29390000
                   MOVE ML020-XFER-DOC-NBR (1:4) TO                     29400000
                        EX-DOC-NBR-11 (1:4)                             29410000
                   MOVE '-'                      TO                     29420000
                        EX-DOC-NBR-11 (5:1)                             29430000
                   MOVE ML020-XFER-DOC-NBR (5:6) TO                     29440000
                        EX-DOC-NBR-11 (6:6)                             29450000
               END-IF                                                   29460000
           ELSE                                                         29470000
               MOVE ML020-XFER-NBR          TO EX-DOC-NBR-11            29480000
           END-IF                                                       29490000
                                                                        29500000
           STRING ML020-XFER-MM         DELIMITED BY SIZE               29510000
                  '/'                   DELIMITED BY SIZE               29520000
                  ML020-XFER-DD         DELIMITED BY SIZE               29530000
                                        INTO EX-LIAB-MMDD.              29540000
                                                                        29550000
           MOVE ML020-XFER-QTY          TO EX-QTY.                      29560000
           MOVE ML020-XFER-PER-UNT-RTL-AMT                              29570000
                                        TO EX-PRICE                     29580000
           MOVE ML020-XFER-EXTD-RTL-AMT                                 29590000
                                        TO EX-RETAIL.                   29600000
                                                                        29610000
           IF PV-LINE-COUNT > +59                                       29620000
               PERFORM F200-HEADINGS                                    29630000
           END-IF.                                                      29640000
           MOVE EX-DETAIL-LINE          TO EXCEPTIONS-LINE.             29650000
           PERFORM F900-WRITE-EXCEPTION-REPORT.                         29660000
                                                                        29670000
           ADD +1                      TO PV-EX-TOT-TRAN-COUNT.         29680000
           ADD ML020-XFER-EXTD-RTL-AMT TO PV-EX-TOT-RETAIL.             29690000
                                                                        29700000
                                                                        29710000
       F200-HEADINGS.                                                   29720000
                                                                        29730000
           ADD 1              TO PV-PAGE-COUNT                          29740000
                                                                        29750000
0422RM*    MOVE PV-PAGE-COUNT TO DP133O-PAGE-NUMBER.                    29760008
0422RM     MOVE PV-PAGE-COUNT TO DP150O-PAGE-NUMBER.                    29770008
0422RM*    MOVE 1             TO DP133O-REPORT-NUMBER.                  29780008
0422RM     MOVE 1             TO DP150O-REPORT-NUMBER.                  29790008
0422RM*    MOVE DP133O-STANDRD-HEADER-133-COLS TO EXCEPTIONS-LINE.      29800008
0422RM     MOVE DP150O-STANDRD-HEADER-150-COLS TO EXCEPTIONS-LINE.      29810008
           MOVE '1'           TO EXCEPTIONS-LINE-CC                     29820000
           MOVE ' '           TO EX-HEADER-FONT-INDICATOR               29830000
                                                                        29840000
           PERFORM F900-WRITE-EXCEPTION-REPORT.                         29850000
                                                                        29860000
           MOVE SPACES     TO EXCEPTIONS-LINE.                          29870000
           PERFORM F900-WRITE-EXCEPTION-REPORT.                         29880000
                                                                        29890000
           MOVE PV-PROC-GREG-FMT-DTE   TO EX-HDG1-DTE                   29900000
           IF CC-PROCESSING-MODE-INV-ONLY                               29910000
               MOVE PC-INVENTORY-ONLY-MODE TO EX-HDG1-PROCESSING-MODE   29920000
           END-IF.                                                      29930000
                                                                        29940000
           MOVE EX-HDG1    TO EXCEPTIONS-LINE.                          29950000
           PERFORM F900-WRITE-EXCEPTION-REPORT.                         29960000
           MOVE EX-HDG2    TO EXCEPTIONS-LINE.                          29970000
           PERFORM F900-WRITE-EXCEPTION-REPORT.                         29980000
           MOVE EX-HDG3    TO EXCEPTIONS-LINE.                          29990000
           PERFORM F900-WRITE-EXCEPTION-REPORT.                         30000000
                                                                        30010000
           MOVE SPACES     TO EXCEPTIONS-LINE.                          30020000
           PERFORM F900-WRITE-EXCEPTION-REPORT.                         30030000
                                                                        30040000
           MOVE 6 TO PV-LINE-COUNT.                                     30050000
                                                                        30060000
                                                                        30070000
       F900-WRITE-EXCEPTION-REPORT.                                     30080000
           WRITE EXCEPTIONS-LINE.                                       30100000
0422RM** REPORT WAS NOT PAGING PROPERLY CORRECTED WITH LOGIC BELOW      30101023
0422RM     ADD 1 TO PV-LINE-COUNT.                                      30110023
0422RM*    EVALUATE TRUE                                                30120023
0422RM*        WHEN EXCEPTIONS-LINE-CC = ' '                            30130023
0422RM*            ADD  1 TO  PV-LINE-COUNT                             30140023
0422RM*        WHEN EXCEPTIONS-LINE-CC = '0'                            30150023
0422RM*            ADD  2 TO  PV-LINE-COUNT                             30160023
0422RM*        WHEN EXCEPTIONS-LINE-CC = '-'                            30170023
0422RM*            ADD  3 TO  PV-LINE-COUNT                             30180023
0422RM*    END-EVALUATE.                                                30190023
                                                                        30210000
       G100-PROCESS-PRICE-CHANGE.                                       30220000
                                                                        30230000
           PERFORM G110-EDIT-ML020.                                     30240000
                                                                        30250000
           IF PV-NO-DTL-ERROR                                           30260000
               PERFORM G130-WRITE-OUTPUT-FILES                          30270000
           ELSE                                                         30280000
               PERFORM G160-FORMAT-ERROR-REC                            30290000
               PERFORM Z998-WRITE-ERROR-FILE                            30300000
           END-IF.                                                      30310000
                                                                        30320000
                                                                        30330000
       G110-EDIT-ML020.                                                 30340000
                                                                        30350000
           INITIALIZE ML023-PC-RECORD                                   30360000
                      ML029-PC-RECORD                                   30370000
                      ML033-DW-PC-RECORD                                30380000
                      ML025-RPT1-DETAIL-RECORD                          30390000
                                                                        30400000
           IF ML020-PERM             OR                                 30410000
              ML020-PROMO            OR                                 30420000
              ML020-DATA-ENTRY                                          30430000
               CONTINUE                                                 30440000
           ELSE                                                         30450000
               DISPLAY 'INVALID SYST-ORIG-CDE ON A PRICE CHANGE TRAN: ' 30460000
                        ML020-SYST-ORIG-CDE                             30470000
               PERFORM Z999-INVALID-PRESET-VALUE-ABND                   30480000
           END-IF                                                       30490000
                                                                        30500000
           IF ML020-PC-DOC-5-NBR NOT NUMERIC                            30510000
               SET PV-DTL-ERROR TO TRUE                                 30520000
               SET ML027-ERR-NON-NUMERIC     TO TRUE                    30530000
               MOVE ML027-ERR-CDE            TO                         30540000
                    ML026-RPT2-DOC-5-NBR-ERR                            30550000
           END-IF                                                       30560000
                                                                        30570000
           IF ML020-PC-QTY NUMERIC                                      30580000
               CONTINUE                                                 30590000
           ELSE                                                         30600000
               SET PV-DTL-ERROR TO TRUE                                 30610000
               SET ML027-ERR-NON-NUMERIC     TO TRUE                    30620000
               MOVE ML027-ERR-CDE            TO                         30630000
                    ML026-RPT2-QTY-ERR                                  30640000
           END-IF                                                       30650000
                                                                        30660000
           IF ML020-PC-OLD-PR-AMT NOT NUMERIC                           30670000
               SET ML027-ERR-NON-NUMERIC     TO TRUE                    30680000
               MOVE ML027-ERR-CDE            TO                         30690000
                    ML026-RPT2-AMT-ERR                                  30700000
                    ML026-RPT2-OLD-PR-AMT-ERR                           30710000
               SET PV-DTL-ERROR TO TRUE                                 30720000
           END-IF                                                       30730000
                                                                        30740000
           IF ML020-PC-NEW-PR-AMT NOT NUMERIC                           30750000
               SET ML027-ERR-NON-NUMERIC     TO TRUE                    30760000
               MOVE ML027-ERR-CDE            TO                         30770000
                    ML026-RPT2-AMT-ERR                                  30780000
                    ML026-RPT2-NEW-PR-AMT-ERR                           30790000
               SET PV-DTL-ERROR TO TRUE                                 30800000
           END-IF                                                       30810000
                                                                        30820000
           MOVE ZERO TO PV-PRICE-CHANGE                                 30830000
                        ML026-RPT2-AMT                                  30840000
                                                                        30850000
           IF ML020-PC-NEW-PR-AMT NUMERIC AND                           30860000
              ML020-PC-OLD-PR-AMT NUMERIC                               30870000
               IF ML020-PC-NEW-PR-AMT = ML020-PC-OLD-PR-AMT             30880000
                   SET ML027-ERR-OLD-EQUAL-NEW        TO TRUE           30890000
                   MOVE ML027-ERR-CDE                 TO                30900000
                        ML026-RPT2-OLD-PR-AMT-ERR                       30910000
                        ML026-RPT2-NEW-PR-AMT-ERR                       30920000
                   SET PV-DTL-ERROR TO TRUE                             30930000
               ELSE                                                     30940000
                   IF ML020-MKDOWN                                      30950000
                       PERFORM G140-MKDOWN-EDITS                        30960000
                   ELSE                                                 30970000
                       PERFORM G150-MKUP-EDITS                          30980000
                   END-IF                                               30990000
               END-IF                                                   31000000
           END-IF                                                       31010000
                                                                        31020000
           IF ML020-PC-QTY    NUMERIC AND                               31030000
              PV-PRICE-CHANGE NUMERIC                                   31040000
               COMPUTE ML023-PC-EXTD-RTL-AMT =                          31050000
                       ML020-PC-QTY * PV-PRICE-CHANGE                   31060000
               MOVE ML023-PC-EXTD-RTL-AMT TO                            31070000
W28582              ML029-PC-EXTD-RTL-AMT                               31080000
                    ML025-RPT1-EXTD-RTL-AMT                             31090000
                    ML026-RPT2-AMT                                      31100000
                                                                        31110000
               IF ML020-MKUP                                            31120000
                   IF ML023-PC-EXTD-RTL-AMT > +1000000                  31130000
                       SET ML027-ERR-OUT-OF-RANGE   TO TRUE             31140000
                       MOVE ML027-ERR-CDE           TO                  31150000
                            ML026-RPT2-AMT-ERR                          31160000
                       SET PV-DTL-ERROR TO TRUE                         31170000
                   END-IF                                               31180000
               END-IF                                                   31190000
           END-IF                                                       31200000
                                                                        31210000
W29145     MOVE ML023-PC-EXTD-RTL-AMT TO ML033-PC-EXTD-RTL-AMT          31220000
                                                                        31230000
      *AML     ELSE                                                     31240000
      *AML         IF ML023-PC-EXTD-RTL-AMT > +100000                   31250000
      *AML             SET ML027-ERR-OUT-OF-RANGE   TO TRUE             31260000
      *AML             MOVE ML027-ERR-CDE           TO                  31270000
      *AML                  ML026-RPT2-AMT-ERR                          31280000
      *AML             SET PV-DTL-ERROR TO TRUE                         31290000
      *AML         END-IF                                               31300000
      *AML     END-IF                                                   31310000
      *AML END-IF                                                       31320000
                                                                        31330000
           PERFORM G120-DATE-EDITS                                      31340000
                                                                        31350000
           IF ML020-MKDOWN                                              31360000
               ADD 1 TO TR-TRANS-IN(5)                                  31370000
               IF ML023-PC-EXTD-RTL-AMT NUMERIC                         31380000
                   ADD ML023-PC-EXTD-RTL-AMT TO                         31390000
                       TR-TRANS-RTL-IN (5)                              31400000
               END-IF                                                   31410000
               IF PV-NO-DTL-ERROR                                       31420000
                   ADD 1 TO TR-TRANS-OK (5)                             31430000
                   ADD ML023-PC-EXTD-RTL-AMT TO                         31440000
                       TR-TRANS-RTL-OK (5)                              31450000
               ELSE                                                     31460000
                   ADD 1 TO TR-TRANS-ERR(5)                             31470000
                   ADD ML023-PC-EXTD-RTL-AMT TO                         31480000
                       TR-TRANS-RTL-ERR (5)                             31490000
               END-IF                                                   31500000
           ELSE                                                         31510000
               ADD 1 TO TR-TRANS-IN(6)                                  31520000
               IF ML023-PC-EXTD-RTL-AMT NUMERIC                         31530000
                   ADD ML023-PC-EXTD-RTL-AMT TO                         31540000
                       TR-TRANS-RTL-IN (6)                              31550000
               END-IF                                                   31560000
               IF PV-NO-DTL-ERROR                                       31570000
                   ADD 1 TO TR-TRANS-OK(6)                              31580000
                   ADD ML023-PC-EXTD-RTL-AMT TO                         31590000
                       TR-TRANS-RTL-OK (6)                              31600000
               ELSE                                                     31610000
                   ADD 1 TO TR-TRANS-ERR(6)                             31620000
                   IF ML023-PC-EXTD-RTL-AMT NUMERIC                     31630000
                       ADD ML023-PC-EXTD-RTL-AMT TO                     31640000
                           TR-TRANS-RTL-ERR (6)                         31650000
                   END-IF                                               31660000
               END-IF                                                   31670000
           END-IF.                                                      31680000
                                                                        31690000
                                                                        31700000
       G120-DATE-EDITS.                                                 31710000
                                                                        31720000
           SET PS-NO-DATE-ERROR TO TRUE.                                31730000
                                                                        31740000
           IF  ML020-PC-DTE NUMERIC                                     31750000
           AND ML020-PC-DTE > ZERO                                      31760000
               MOVE ML020-PC-DTE-MM TO PV-EDIT-MM                       31770000
               MOVE ML020-PC-DTE-DD TO PV-EDIT-DD                       31780000
               MOVE SPACE           TO PV-EDIT-YY                       31790000
           ELSE                                                         31800000
               MOVE MLCNTL-PSTG-FSCL-WK-DTE (6:2) TO PV-EDIT-MM         31810000
               MOVE MLCNTL-PSTG-FSCL-WK-DTE (9:2) TO PV-EDIT-DD         31820000
               MOVE MLCNTL-PSTG-FSCL-WK-DTE (3:2) TO PV-EDIT-YY         31830000
           END-IF.                                                      31840000
                                                                        31850000
           PERFORM Z200-EDIT-DTE.                                       31860000
                                                                        31870000
           IF PS-DATE-ERROR                                             31880000
               SET ML027-ERR-INVALID-VALUE                              31890000
                   PV-DTL-ERROR           TO TRUE                       31900000
               MOVE ML027-ERR-CDE         TO ML026-RPT2-FIN-LIAB-DTE-ERR31910000
           ELSE                                                         31920000
               MOVE EDT-ISO-DTE (EDT-IDX) TO ML023-PC-FIN-LIAB-DTE      31930000
W28582                                       ML029-PC-FIN-LIAB-DTE      31940000
W29145                                       ML033-PC-FIN-LIAB-DTE      31950000
                                             ML025-RPT1-FIN-LIAB-DTE    31960000
               MOVE ML023-PC-FIN-LIAB-DTE TO PV-FIN-LIAB-DTE            31970000
               PERFORM Z300-SET-ML-AND-INV-INDS                         31980000
           END-IF.                                                      31990000
                                                                        32000000
           IF ML020-PC-KOHLS-MM NOT NUMERIC                             32010000
               SET ML027-ERR-INVALID-DATE TO TRUE                       32020000
               MOVE ML027-ERR-CDE    TO ML026-RPT2-KOHLS-MM-ERR         32030000
               SET PV-DTL-ERROR      TO TRUE                            32040000
           END-IF.                                                      32050000
                                                                        32060000
                                                                        32070000
       G130-WRITE-OUTPUT-FILES.                                         32080000
                                                                        32090000
           MOVE ML020-STORE-NBR         TO ML023-PC-STORE-NBR           32100000
W28582                                     ML029-PC-STORE-NBR           32110000
W29145                                     ML033-PC-STORE-NBR           32120000
                                           ML025-RPT1-STORE-NBR         32130000
           MOVE ML020-SKU               TO ML023-PC-SKU                 32140000
W28582                                     ML029-PC-SKU                 32150000
W29145                                     ML033-PC-SKU                 32160000
                                           ML025-RPT1-SKU               32170000
W21731     MOVE ML020-DEPT-CLASS        TO ML023-PC-DEPT-CLASS          32180000
W28582                                     ML029-PC-DEPT-CLASS          32190000
W29145                                     ML033-PC-DEPT-CLASS          32200000
W21731                                     ML025-RPT1-DEPT-CLASS        32210000
           MOVE ML020-SYST-ORIG-CDE     TO ML023-PC-SYST-ORIG-CDE       32220000
W28582                                     ML029-PC-SYST-ORIG-CDE       32230000
W29145                                     ML033-PC-SYST-ORIG-CDE       32240000
           MOVE ML020-TRANS-CDE         TO ML023-PC-TRANS-CDE           32250000
W28582                                     ML029-PC-TRANS-CDE           32260000
W29145                                     ML033-PC-TRANS-CDE           32270000
                                           ML025-RPT1-TRANS-CDE         32280000
                                                                        32290000
           MOVE PV-PSTG-FSCL-YR-NBR         TO ML025-RPT1-FSCL-YR-CDE.  32300000
           MOVE MLCNTL-PSTG-FSCL-MN-NBR     TO ML025-RPT1-FSCL-PER-CDE. 32310000
                                                                        32320000
           MOVE EDT-FSCL-YR-NBR   (EDT-IDX) TO ML023-PC-FSCL-YR         32330000
W28582                                         ML029-PC-FSCL-YR         32340000
W29145                                         ML033-PC-FSCL-YR.        32350000
           MOVE EDT-FSCL-MN-NBR   (EDT-IDX) TO ML023-PC-FSCL-PER        32360000
W28582                                         ML029-PC-FSCL-PER        32370000
W29145                                         ML033-PC-FSCL-PER.       32380000
           MOVE EDT-WK-IN-MN-NBR  (EDT-IDX) TO ML023-PC-FSCL-WK         32390000
W28582                                         ML029-PC-FSCL-WK         32400000
W29145                                         ML033-PC-FSCL-WK.        32410000
           MOVE EDT-DAY-OF-WK-NBR (EDT-IDX) TO ML023-PC-FSCL-DAY        32420000
W28582                                         ML029-PC-FSCL-DAY        32430000
W29145                                         ML033-PC-FSCL-DAY.       32440000
                                                                        32450000
           MOVE MLCNTL-PSTG-FSCL-WK-DTE TO ML023-PC-EDIT-DTE            32460000
W28582                                     ML029-PC-EDIT-DTE            32470000
W29145                                     ML033-PC-EDIT-DTE            32480000
           MOVE ML020-PC-OLD-PR-AMT     TO ML023-PC-OLD-PR-AMT          32490000
W28582                                     ML029-PC-OLD-PR-AMT          32500000
W29145                                     ML033-PC-OLD-PR-AMT          32510000
           MOVE ML020-PC-NEW-PR-AMT     TO ML023-PC-NEW-PR-AMT          32520000
W28582                                     ML029-PC-NEW-PR-AMT          32530000
W29145                                     ML033-PC-NEW-PR-AMT          32540000
           MOVE ML020-PC-QTY            TO ML023-PC-QTY                 32550000
W28582                                     ML029-PC-QTY                 32560000
W29145                                     ML033-PC-QTY                 32570000
           MOVE ML020-PC-OLD-RSN-CDE    TO ML023-PC-OLD-RSN-CDE         32580000
W28582                                     ML029-PC-OLD-RSN-CDE         32590000
W29145                                     ML033-PC-OLD-RSN-CDE         32600000
           MOVE ML020-PC-DOC-5-NBR      TO ML023-PC-DOC-5-NBR           32610000
W28582                                     ML029-PC-DOC-5-NBR           32620000
W29145                                     ML033-PC-DOC-5-NBR           32630000
                                           ML025-RPT1-DOC-5-NBR         32640000
           MOVE ML020-PC-DOC-7-NBR      TO ML023-PC-DOC-7-NBR           32650000
W28582                                     ML029-PC-DOC-7-NBR           32660000
W29145                                     ML033-PC-DOC-7-NBR           32670000
           MOVE ML020-PC-BATCH-NBR      TO ML023-PC-BATCH-NBR           32680000
W28582                                     ML029-PC-BATCH-NBR           32690000
W29145                                     ML033-PC-BATCH-NBR           32700000
                                           ML025-RPT1-BATCH-NBR         32710000
           MOVE ML020-PC-CATEG-CDE      TO ML023-PC-CATEGORY            32720000
W28582                                     ML029-PC-CATEGORY            32730000
W29145                                     ML033-PC-CATEGORY            32740000
           MOVE MLCNTL-PSTG-FSCL-MN-NBR TO ML023-PC-KOHLS-MM            32750000
W28582                                     ML029-PC-KOHLS-MM            32760000
W29145                                     ML033-PC-KOHLS-MM.           32770000
                                                                        32780000
           MOVE PV-ML-IND               TO ML023-PC-ML-IND              32790000
W28582                                     ML029-PC-ML-IND              32800000
W29145                                     ML033-PC-ML-IND              32810000
                                           ML025-RPT1-ML-IND            32820000
           MOVE PV-INV-IND              TO ML023-PC-INV-IND             32830000
W28582                                     ML029-PC-INV-IND             32840000
W29145                                     ML033-PC-INV-IND             32850000
                                           ML025-RPT1-INV-IND           32860000
                                                                        32870000
           MOVE ML020-PC-MKDN-MKUP-RSN-CDE                              32880000
                                        TO ML023-PC-MKDN-MKUP-RSN-CDE   32890000
W28582                                     ML029-PC-MKDN-MKUP-RSN-CDE   32900000
W29145                                     ML033-PC-MKDN-MKUP-RSN-CDE   32910000
                                                                        32920000
1099RM     MOVE ML020-PC-VENDOR-INHSE-NMBR                              32930000
1099RM                                  TO ML023-PC-VENDOR-INHSE-NMBR   32940000
W28582                                     ML029-PC-VENDOR-INHSE-NMBR   32950000
W29145                                     ML033-PC-VENDOR-INHSE-NMBR.  32960000
W26603     MOVE ML020-PC-ENT-ID         TO ML023-PC-ENT-ID              32970000
W28582                                     ML029-PC-ENT-ID              32980000
W29145                                     ML033-PC-ENT-ID.             32990000
R29145     IF ML020-PC-ORIG-CLR-DTE = LOW-VALUES                        33000008
R29145        MOVE SPACES                TO ML033-PC-ORIG-CLR-DTE       33010008
R29145     ELSE                                                         33020008
W29145        MOVE ML020-PC-ORIG-CLR-DTE TO ML033-PC-ORIG-CLR-DTE.      33030000
R29145                                                                  33040008
R29145     IF ML020-PC-MKDN-CDE     = LOW-VALUES                        33050008
R29145        MOVE SPACES                TO ML033-PC-MKDN-CDE           33060008
R29145     ELSE                                                         33070008
W29145        MOVE ML020-PC-MKDN-CDE     TO ML033-PC-MKDN-CDE           33080000
S29145     END-IF.                                                      33090000
S29145                                                                  33100000
S29145     IF ML020-PC-ORIG-RTL-NONGRP NUMERIC                          33110000
S29145         IF ML020-PC-ORIG-RTL-NONGRP = ZEROES                     33120000
S29145             MOVE ZEROES TO ML033-PC-ORIG-RTL-NONGRP              33130000
S29145         ELSE                                                     33140000
S29145             MOVE ML020-PC-ORIG-RTL-NONGRP TO                     33150000
S29145                                          ML033-PC-ORIG-RTL-NONGRP33160000
S29145         END-IF                                                   33170000
S29145     ELSE                                                         33180000
S29145         MOVE ZEROES TO ML033-PC-ORIG-RTL-NONGRP                  33190000
S29145     END-IF.                                                      33200000
                                                                        33210000
W28582     MOVE ML020-PC-DOC-16-NBR      TO ML029-PC-DOC-16-NBR.        33220000
W28582     MOVE ML020-PC-AP-TRANS-CDE    TO ML029-PC-AP-TRANS-CDE.      33230000
W28582                                                                  33240000
           WRITE PRC-CHG-REC          FROM ML023-PC-RECORD.             33250000
W28582     WRITE BV-PRC-CHG-REC       FROM ML029-PC-RECORD.             33260000
           WRITE DW-PRC-CHG-REC       FROM ML033-DW-PC-RECORD.          33270000
                                                                        33280000
           PERFORM Z400-WRITE-RPT1-REC.                                 33290000
                                                                        33300000
                                                                        33310000
       G140-MKDOWN-EDITS.                                               33320000
                                                                        33330000
           IF ML020-PC-OLD-RSN-CDE =                                    33340000
               '1' OR '2' OR '3' OR '4' OR '5'                          33350000
               CONTINUE                                                 33360000
           ELSE                                                         33370000
               SET ML027-ERR-INVALID-VALUE    TO TRUE                   33380000
               MOVE ML027-ERR-CDE             TO                        33390000
                    ML026-RPT2-RSN-CDE-ERR                              33400000
               SET PV-DTL-ERROR TO TRUE                                 33410000
           END-IF                                                       33420000
                                                                        33430000
           COMPUTE PV-PRICE-CHANGE = ML020-PC-OLD-PR-AMT -              33440000
                                     ML020-PC-NEW-PR-AMT                33450000
                                                                        33460000
           IF ML020-PC-OLD-PR-AMT < +0                                  33470000
               SET ML027-ERR-LESS-THAN-ZERO   TO TRUE                   33480000
               MOVE ML027-ERR-CDE             TO                        33490000
                    ML026-RPT2-OLD-PR-AMT-ERR                           33500000
                    SET PV-DTL-ERROR TO TRUE                            33510000
           ELSE                                                         33520000
               IF PV-PRICE-CHANGE > +0                                  33530000
                   SET ML023-PC-MKDOWN        TO TRUE                   33540000
W28582             SET ML029-PC-MKDOWN        TO TRUE                   33550000
R29145             SET ML033-PC-MKDOWN        TO TRUE                   33560000
               ELSE                                                     33570000
                   SET ML023-PC-MKDOWN-CANCEL TO TRUE                   33580000
W28582             SET ML029-PC-MKDOWN-CANCEL TO TRUE                   33590000
R29145             SET ML033-PC-MKDOWN-CANCEL TO TRUE                   33600000
               END-IF                                                   33610000
           END-IF.                                                      33620000
                                                                        33630000
                                                                        33640000
       G150-MKUP-EDITS.                                                 33650000
                                                                        33660000
           IF ML020-PC-OLD-RSN-CDE =                                    33670000
               '1' OR '2' OR '3' OR '4' OR '5' OR '6'                   33680000
               CONTINUE                                                 33690000
           ELSE                                                         33700000
               SET PV-DTL-ERROR TO TRUE                                 33710000
               SET ML027-ERR-INVALID-VALUE    TO TRUE                   33720000
               MOVE ML027-ERR-CDE TO ML026-RPT2-RSN-CDE-ERR             33730000
           END-IF                                                       33740000
                                                                        33750000
           COMPUTE PV-PRICE-CHANGE = ML020-PC-NEW-PR-AMT -              33760000
                                     ML020-PC-OLD-PR-AMT                33770000
                                                                        33780000
           IF ML020-PC-NEW-PR-AMT > +0                                  33790000
               IF PV-PRICE-CHANGE > +0                                  33800000
                   SET ML023-PC-MKUP          TO TRUE                   33810000
W28582             SET ML029-PC-MKUP          TO TRUE                   33820000
R29145             SET ML033-PC-MKUP          TO TRUE                   33830000
               ELSE                                                     33840000
                   SET ML023-PC-MKUP-CANCEL   TO TRUE                   33850000
W28582             SET ML029-PC-MKUP-CANCEL   TO TRUE                   33860000
R29145             SET ML033-PC-MKUP-CANCEL   TO TRUE                   33870000
               END-IF                                                   33880000
           ELSE                                                         33890000
               SET ML027-ERR-INVALID-VALUE    TO TRUE                   33900000
               MOVE ML027-ERR-CDE TO ML026-RPT2-NEW-PR-AMT-ERR          33910000
               SET PV-DTL-ERROR TO TRUE                                 33920000
           END-IF.                                                      33930000
                                                                        33940000
                                                                        33950000
       G160-FORMAT-ERROR-REC.                                           33960000
                                                                        33970000
           MOVE ML020-STORE-NBR         TO ML026-RPT2-STORE-NBR         33980000
           MOVE ML020-SKU               TO ML026-RPT2-SKU               33990000
W21731     MOVE ML020-DEPT-CLASS        TO ML026-RPT2-DEPT-CLASS        34000000
           MOVE ML020-TRANS-CDE         TO ML026-RPT2-TRANS-CDE         34010000
           MOVE SPACES                  TO ML026-RPT2-REL-STORE-NBR     34020000
                                                                        34030000
           MOVE ML020-PC-DTE-MM         TO ML026-RPT2-FIN-LIAB-MM.      34040000
           MOVE '/'                     TO ML026-RPT2-FIN-SLASH1.       34050000
           MOVE ML020-PC-DTE-DD         TO ML026-RPT2-FIN-LIAB-DD.      34060000
                                                                        34070000
           MOVE ML020-PC-KOHLS-MM       TO ML026-RPT2-KOHLS-MM          34080000
           MOVE ML020-PC-QTYX           TO ML026-RPT2-QTYX.             34090000
679223                                                                  34100008
679223     IF ML020-PC-OLD-PR-AMT NOT NUMERIC                           34110008
             MOVE ML020-PC-OLD-PR-AMTX    TO ML026-RPT2-OLD-PR-AMTX     34120000
679223     ELSE                                                         34130008
679223       MOVE ML020-PC-OLD-PR-AMT     TO ML026-RPT2-OLD-PR-AMT      34140000
679223     END-IF.                                                      34150008
679223                                                                  34160008
679223     IF ML020-PC-NEW-PR-AMT NOT NUMERIC                           34170008
             MOVE ML020-PC-NEW-PR-AMTX  TO ML026-RPT2-NEW-PR-AMTX       34180000
679223     ELSE                                                         34190008
679223       MOVE ML020-PC-NEW-PR-AMT   TO ML026-RPT2-NEW-PR-AMT        34200000
679223     END-IF.                                                      34210008
679223                                                                  34220008
           MOVE ZEROS                   TO ML026-RPT2-PO-NBRX.          34230000
           MOVE ML020-PC-OLD-RSN-CDE    TO ML026-RPT2-RSN-CDE           34240000
           MOVE ML020-PC-BATCH-NBR      TO ML026-RPT2-BATCH-NBR         34250000
                                                                        34260000
           IF ML020-PC-DOC-7-NBR NUMERIC                                34270000
               MOVE ML020-PC-DOC-7-NBR  TO ML026-RPT2-DOC-7-NBR         34280000
           ELSE                                                         34290000
               MOVE ML020-PC-DOC-5-NBR  TO ML026-RPT2-DOC-5-NBR         34300000
           END-IF                                                       34310000
           MOVE SPACES                  TO ML026-RPT2-VEND-NBR          34320000
           MOVE ZEROS                   TO ML026-RPT2-ENT-ID            34330000
           MOVE ZEROS                   TO ML026-RPT2-DISC-AMTX.        34340000
           MOVE ZEROS                   TO ML026-RPT2-FRGT-AMTX.        34350000
           MOVE ZEROS                   TO ML026-RPT2-NET-COST-AMTX     34360000
           MOVE ZEROS                   TO ML026-RPT2-RETAIL-AMTX.      34370000
           MOVE SPACES                  TO ML026-RPT2-DR-CR-CDE.        34380000
                                                                        34390000
                                                                        34400000
       H100-PROCESS-ADJUSTMENTS.                                        34410000
                                                                        34420000
W33304     MOVE ML020-STORE-NBR TO PV-STORE-NBR.                        34430000
W33304     SET ST-IDX TO 1                                              34440000
W33304     SEARCH ALL STORE-ENTRIES                                     34450000
W33304         AT END                                                   34460000
W33304             SET ML027-ERR-NOT-FOUND TO TRUE                      34470000
W33304             MOVE ML027-ERR-CDE      TO ML026-RPT2-STORE-NBR-ERR  34480000
W33304             SET PV-STORE-LEVEL-ERROR TO TRUE                     34490000
W33304         WHEN                                                     34500000
W33304             ST-STORE-NMBR (ST-IDX) = ML020-STORE-NBR             34510000
W33304                 NEXT SENTENCE                                    34520000
W33304     END-SEARCH.                                                  34530000
W33304                                                                  34540008
W33304     IF ST-FINCL-BK-STAT (ST-IDX) = 'TC'                          34550008
W33304         ADD 1 TO TR-TRANS-IN (7)                                 34560000
W33304         IF ML020-ADJ-AT-RTL-AMT  NUMERIC                         34570000
W33304             ADD ML020-ADJ-AT-RTL-AMT                             34580000
W33304                 TO TR-TRANS-RTL-IN (7)                           34590000
W33304         END-IF                                                   34600000
W33304         IF ML020-ADJ-AT-COST-AMT  NUMERIC                        34610000
W33304             ADD ML020-ADJ-AT-COST-AMT                            34620000
W33304                 TO TR-TRANS-COST-IN (7)                          34630000
W33304         END-IF                                                   34640000
W33304     END-IF.                                                      34650000
                                                                        34660000
           PERFORM H110-EDIT-ML020.                                     34670000
                                                                        34680000
           IF PV-NO-DTL-ERROR                                           34690000
               PERFORM H130-WRITE-OUTPUT-FILES                          34700000
           ELSE                                                         34710000
               PERFORM H140-FORMAT-ERROR-REC                            34720000
               PERFORM Z998-WRITE-ERROR-FILE                            34730000
           END-IF.                                                      34740000
                                                                        34750000
       H110-EDIT-ML020.                                                 34760000
                                                                        34770000
           INITIALIZE ML024-ADJ-RECORD                                  34780000
                      ML025-RPT1-DETAIL-RECORD                          34790000
                                                                        34800000
           IF ML020-PHYSICAL-INVENTORY OR                               34810000
              ML020-MERCHANDISE-LEDGER                                  34820000
               CONTINUE                                                 34830000
           ELSE                                                         34840000
               DISPLAY 'INVALID SYST-ORIG-CDE ON AN ADJUSTMENT TRAN: '  34850000
                        ML020-SYST-ORIG-CDE                             34860000
               PERFORM Z999-INVALID-PRESET-VALUE-ABND                   34870000
           END-IF                                                       34880000
                                                                        34890000
           IF ML020-ADJ-AT-RTL-AMT NUMERIC                              34900000
               IF ML020-ADJ-AT-RTL-AMT = +0                             34910000
                   SET ML027-ERR-EQUAL-ZERO      TO TRUE                34920000
                   MOVE ML027-ERR-CDE            TO                     34930000
                        ML026-RPT2-RETAIL-AMT-ERR                       34940000
                   SET PV-DTL-ERROR TO TRUE                             34950000
               END-IF                                                   34960000
           ELSE                                                         34970000
               SET ML027-ERR-NON-NUMERIC     TO TRUE                    34980000
               MOVE ML027-ERR-CDE            TO                         34990000
                    ML026-RPT2-RETAIL-AMT-ERR                           35000000
               SET PV-DTL-ERROR TO TRUE                                 35010000
           END-IF                                                       35020000
                                                                        35030000
           IF ML020-ADJ-DOC-5-NBR NOT NUMERIC                           35040000
               SET ML027-ERR-NON-NUMERIC     TO TRUE                    35050000
               MOVE ML027-ERR-CDE            TO                         35060000
                    ML026-RPT2-DOC-5-NBR-ERR                            35070000
               SET PV-DTL-ERROR TO TRUE                                 35080000
           END-IF                                                       35090000
                                                                        35100000
           IF ML020-ADJ-AT-COST-AMT NOT NUMERIC                         35110000
               MOVE +0                       TO ML020-ADJ-AT-COST-AMT   35120000
           END-IF                                                       35130000
                                                                        35140000
           PERFORM H120-DATE-EDITS.                                     35150000
                                                                        35160000
       H120-DATE-EDITS.                                                 35170000
                                                                        35180000
           SET PS-NO-DATE-ERROR TO TRUE.                                35190000
                                                                        35200000
           IF  ML020-ADJ-DTE NUMERIC                                    35210000
           AND ML020-ADJ-DTE > ZERO                                     35220000
               MOVE ML020-ADJ-DTE TO PV-EDIT-DTE                        35230000
               PERFORM Z200-EDIT-DTE                                    35240000
               IF PS-DATE-ERROR                                         35250000
                   SET ML027-ERR-INVALID-VALUE                          35260000
                       PV-DTL-ERROR   TO TRUE                           35270000
                   MOVE ML027-ERR-CDE TO ML026-RPT2-FIN-LIAB-DTE-ERR    35280000
               ELSE                                                     35290000
                   MOVE EDT-ISO-DTE (EDT-IDX) TO ML024-ADJ-FIN-LIAB-DTE 35300000
                                                 ML025-RPT1-FIN-LIAB-DTE35310000
                   MOVE ML024-ADJ-FIN-LIAB-DTE                          35320000
                                              TO PV-FIN-LIAB-DTE        35330000
                   PERFORM Z300-SET-ML-AND-INV-INDS                     35340000
               END-IF                                                   35350000
           ELSE                                                         35360000
               SET ML027-ERR-INVALID-VALUE                              35370000
                   PV-DTL-ERROR   TO TRUE                               35380000
               MOVE ML027-ERR-CDE TO ML026-RPT2-FIN-LIAB-DTE-ERR        35390000
           END-IF.                                                      35400000
                                                                        35410000
           IF ML020-ADJ-KOHLS-MM NOT NUMERIC                            35420000
               SET ML027-ERR-INVALID-DATE TO TRUE                       35430000
               MOVE ML027-ERR-CDE    TO ML026-RPT2-KOHLS-MM-ERR         35440000
               SET PV-DTL-ERROR      TO TRUE                            35450000
           END-IF.                                                      35460000
                                                                        35470000
0300RM***-- PREVENT INVENTORY TRANSACTIONS FROM BEING LOADED INTO       35480000
0300RM***-- THE INCORRECT MONTH                                         35490000
0300RM     IF EDT-ISO-DTE (EDT-IDX) = MLCNTL-OPN-FSCL-MN-DTE            35500000
0300RM         CONTINUE                                                 35510000
0300RM     ELSE                                                         35520000
0300RM         SET ML027-ERR-INVALID-VALUE TO TRUE                      35530000
0300RM         MOVE ML027-ERR-CDE TO ML026-RPT2-FIN-LIAB-DTE-ERR        35540000
0300RM         SET PV-DTL-ERROR           TO TRUE                       35550000
0300RM     END-IF.                                                      35560000
                                                                        35570000
       H130-WRITE-OUTPUT-FILES.                                         35580000
                                                                        35590000
           MOVE ML020-STORE-NBR         TO ML024-ADJ-STORE-NBR          35600000
                                           ML025-RPT1-STORE-NBR         35610000
           MOVE ML020-SKU               TO ML024-ADJ-SKU                35620000
                                           ML025-RPT1-SKU               35630000
W21731     MOVE ML020-DEPT-CLASS        TO ML024-ADJ-DEPT-CLASS         35640000
W21731                                     ML025-RPT1-DEPT-CLASS        35650000
           MOVE ML020-SYST-ORIG-CDE     TO ML024-ADJ-SYST-ORIG-CDE      35660000
           MOVE ML020-TRANS-CDE         TO ML024-ADJ-TRANS-CDE          35670000
                                           ML025-RPT1-TRANS-CDE         35680000
                                                                        35690000
           MOVE PV-PSTG-FSCL-YR-NBR         TO ML025-RPT1-FSCL-YR-CDE.  35700000
           MOVE MLCNTL-PSTG-FSCL-MN-NBR     TO ML025-RPT1-FSCL-PER-CDE. 35710000
                                                                        35720000
           MOVE EDT-FSCL-YR-NBR   (EDT-IDX) TO ML024-ADJ-FSCL-YR.       35730000
           MOVE EDT-FSCL-MN-NBR   (EDT-IDX) TO ML024-ADJ-FSCL-PER.      35740000
           MOVE EDT-WK-IN-MN-NBR  (EDT-IDX) TO ML024-ADJ-FSCL-WK.       35750000
           MOVE EDT-DAY-OF-WK-NBR (EDT-IDX) TO ML024-ADJ-FSCL-DAY.      35760000
                                                                        35770000
           MOVE MLCNTL-PSTG-FSCL-WK-DTE TO ML024-ADJ-EDIT-DTE           35780000
                                                                        35790000
           MOVE ML020-ADJ-AT-RTL-AMT    TO ML024-ADJ-AT-RTL-AMT         35800000
                                           ML025-RPT1-EXTD-RTL-AMT      35810000
           MOVE ML020-ADJ-AT-COST-AMT   TO ML024-ADJ-AT-COST-AMT        35820000
                                           ML025-RPT1-EXTD-COST-AMT     35830000
           MOVE ML020-ADJ-DOC-5-NBR     TO ML024-ADJ-DOC-5-NBR          35840000
           MOVE ML020-ADJ-DOC-5-NBRX    TO ML025-RPT1-DOC-5-NBR         35850000
           MOVE MLCNTL-PSTG-FSCL-MN-NBR TO ML024-ADJ-KOHLS-MM           35860000
                                                                        35870000
           MOVE PV-ML-IND               TO ML024-ADJ-ML-IND             35880000
                                           ML025-RPT1-ML-IND            35890000
           MOVE PV-INV-IND              TO ML024-ADJ-INV-IND            35900000
                                           ML025-RPT1-INV-IND           35910000
                                                                        35920000
W20445     MOVE ML020-ADJ-ENT-ID        TO ML024-ADJ-ENT-ID             35930008
W20445                                                                  35940000
W28582     MOVE ML020-ADJ-ML-LWST-ID    TO ML024-ADJ-ML-LWST-ID         35950008
W28582                                                                  35960000
           ADD 1                        TO TR-TRANS-OK (7)              35970000
                                                                        35980000
           IF ML020-ADJ-AT-RTL-AMT  NUMERIC                             35990000
              ADD ML020-ADJ-AT-RTL-AMT            TO                    36000000
              TR-TRANS-RTL-OK (7)                                       36010000
           END-IF                                                       36020000
                                                                        36030000
           IF ML020-ADJ-AT-COST-AMT  NUMERIC                            36040000
              ADD ML020-ADJ-AT-COST-AMT           TO                    36050000
              TR-TRANS-COST-OK (7)                                      36060000
           END-IF.                                                      36070000
                                                                        36080000
           WRITE ADJUSTMENT-REC       FROM ML024-ADJ-RECORD.            36090000
                                                                        36100000
           PERFORM Z400-WRITE-RPT1-REC.                                 36110000
                                                                        36120000
       H140-FORMAT-ERROR-REC.                                           36130000
                                                                        36140000
           MOVE ML020-STORE-NBR         TO ML026-RPT2-STORE-NBR         36150000
                                                                        36160000
           MOVE ML020-SKU               TO ML026-RPT2-SKU               36170000
W21731     MOVE ML020-DEPT-CLASS        TO ML026-RPT2-DEPT-CLASS        36180000
           MOVE ML020-TRANS-CDE         TO ML026-RPT2-TRANS-CDE         36190000
                                                                        36200000
           MOVE SPACES                  TO ML026-RPT2-REL-STORE-NBR     36210000
                                                                        36220000
           MOVE ML020-ADJ-DTE-MM        TO ML026-RPT2-FIN-LIAB-MM       36230000
           MOVE '/'                     TO ML026-RPT2-FIN-SLASH1        36240000
           MOVE ML020-ADJ-DTE-DD        TO ML026-RPT2-FIN-LIAB-DD       36250000
           MOVE '/'                     TO ML026-RPT2-FIN-SLASH2        36260000
           MOVE ML020-ADJ-DTE-YY        TO ML026-RPT2-FIN-LIAB-YY       36270000
                                                                        36280000
           MOVE ML020-ADJ-KOHLS-MM      TO ML026-RPT2-KOHLS-MM          36290000
                                                                        36300000
           MOVE ZEROS                   TO ML026-RPT2-QTY.              36310000
                                                                        36320000
           MOVE ZEROS                   TO ML026-RPT2-AMT.              36330000
                                                                        36340000
           MOVE ZEROS                   TO ML026-RPT2-OLD-PR-AMT.       36350000
           MOVE ZEROS                   TO ML026-RPT2-NEW-PR-AMT.       36360000
           MOVE ZEROS                   TO ML026-RPT2-PO-NBRX.          36370000
           MOVE ML020-ADJ-RSN-CDE       TO ML026-RPT2-RSN-CDE           36380000
           MOVE SPACES                  TO ML026-RPT2-BATCH-NBR         36390000
                                                                        36400000
           MOVE ML020-ADJ-DOC-5-NBRX    TO ML026-RPT2-DOC-5-NBR         36410000
           MOVE SPACES                  TO ML026-RPT2-VEND-NBR          36420000
W20445     MOVE ML020-ADJ-ENT-ID        TO ML026-RPT2-ENT-ID            36430000
           MOVE ZEROS                   TO ML026-RPT2-DISC-AMT.         36440000
           MOVE ZEROS                   TO ML026-RPT2-FRGT-AMT.         36450000
                                                                        36460008
679223     IF ML020-ADJ-AT-COST-AMT NOT NUMERIC                         36470000
             MOVE ML020-ADJ-AT-COST-AMTX  TO ML026-RPT2-NET-COST-AMTX   36480000
679223     ELSE                                                         36490008
679223       MOVE ML020-ADJ-AT-COST-AMT   TO ML026-RPT2-NET-COST-AMT    36500000
679223     END-IF.                                                      36510008
679223                                                                  36520008
679223     IF ML020-ADJ-AT-RTL-AMT NOT NUMERIC                          36530000
             MOVE ML020-ADJ-AT-RTL-AMTX   TO ML026-RPT2-RETAIL-AMTX     36540000
679223     ELSE                                                         36550008
679223       MOVE ML020-ADJ-AT-RTL-AMT    TO ML026-RPT2-RETAIL-AMT      36560000
679223     END-IF.                                                      36570008
679223                                                                  36580008
           MOVE SPACES                  TO ML026-RPT2-DR-CR-CDE.        36590000
                                                                        36600000
           ADD 1                                  TO TR-TRANS-ERR(7)    36610000
                                                                        36620000
           IF ML020-ADJ-AT-RTL-AMT  NUMERIC                             36630000
              ADD ML020-ADJ-AT-RTL-AMT            TO                    36640000
              TR-TRANS-RTL-ERR (7)                                      36650000
           END-IF                                                       36660000
                                                                        36670000
           IF ML020-ADJ-AT-COST-AMT  NUMERIC                            36680000
              ADD ML020-ADJ-AT-COST-AMT           TO                    36690000
              TR-TRANS-COST-ERR(7)                                      36700000
           END-IF.                                                      36710000
                                                                        36720000
                                                                        36730000
       Z100-READ-COMPOSITE-FILE.                                        36740000
                                                                        36750000
           READ COMPOSITE-FILE             INTO ML020-COMPOSITE-RECORD  36760000
              AT END                                                    36770000
                   SET END-OF-COMPOSITE-FILE          TO TRUE.          36780000
                                                                        36790000
       Z200-EDIT-DTE.                                                   36800000
                                                                        36810000
           IF PV-EDIT-DTE = PV-LAST-EDIT-DTE                            36820000
      *        THE DATE BEING EDITED IS THE SAME AS THE LAST ONE THAT   36830000
      *        WAS EDITED.  WE ARE STILL POINTING TO THE DATE TABLE     36840000
      *        ENTRY FOR THAT DATE, SO THERE IS NO NEED TO LOOK IT UP.  36850000
      *        JUST SET THE DATE ERROR SWITCH IF NECESSARY.             36860000
               IF EDT-VALID-DTE-IND (EDT-IDX) = 'N'                     36870000
                   SET PS-DATE-ERROR TO TRUE                            36880000
               END-IF                                                   36890000
           ELSE                                                         36900000
               MOVE PV-EDIT-DTE     TO PV-LAST-EDIT-DTE                 36910000
               PERFORM Z210-LOOKUP-EDIT-DTE                             36920000
           END-IF.                                                      36930000
                                                                        36940000
                                                                        36950000
       Z210-LOOKUP-EDIT-DTE.                                            36960000
                                                                        36970000
      ***************************************************************** 36980000
      * EACH UNIQUE DATE IS TABLED IN WORKING STORAGE AS IT IS EDITED.  36990000
      * THIS MINIMIZES THE NUMBER OF CALLS TO TDTATTR. A CALL TO        37000000
      * TDTATTR IS ONLY DONE THE FIRST TIME A UNIQUE DATE IS            37010000
      * ENCOUNTERED. EACH TIME AFTER THAT, IT IS RETRIEVED FROM THE     37020000
      * WORKING STORAGE TABLE.                                          37030000
      ***************************************************************** 37040000
                                                                        37050000
           PERFORM VARYING EDT-IDX FROM +1 BY +1                        37060000
               UNTIL EDT-IDX > EDT-MAX                                  37070000
                  OR EDT-EDIT-DTE (EDT-IDX) = PV-EDIT-DTE               37080000
                  OR EDT-EDIT-DTE (EDT-IDX) = SPACES                    37090000
           END-PERFORM.                                                 37100000
                                                                        37110000
           IF EDT-IDX > EDT-MAX                                         37120000
               DISPLAY '**  ABEND     **'                               37130000
               DISPLAY '**  PROGRAM   **  =  MLKUP021'                  37140000
               DISPLAY '**  PARAGRAPH **  =  Z210-LOOKUP-EDIT-DTE'      37150000
               DISPLAY 'TABLE OVERFLOW OCCURRED ON EDT-EDIT-DTE-TBL.'   37160000
               MOVE +4004         TO ABEND-CODE                         37170000
               CALL 'ILBOABN0' USING ABEND-CODE                         37180000
           END-IF.                                                      37190000
                                                                        37200000
           IF EDT-EDIT-DTE (EDT-IDX) = PV-EDIT-DTE                      37210000
               IF EDT-VALID-DTE-IND (EDT-IDX) = 'N'                     37220000
                   SET PS-DATE-ERROR TO TRUE                            37230000
               END-IF                                                   37240000
           ELSE                                                         37250000
               MOVE PV-EDIT-DTE   TO EDT-EDIT-DTE (EDT-IDX)             37260000
                                                                        37270000
               PERFORM Z220-DETERMINE-ISO-DTE                           37280000
                                                                        37290000
               IF PS-NO-DATE-ERROR                                      37300000
                   MOVE PV-ISO-CCYY   TO PV-DB2-CCYY                    37310000
                   MOVE PV-ISO-MM     TO PV-DB2-MM                      37320000
                   MOVE PV-ISO-DD     TO PV-DB2-DD                      37330000
                   PERFORM Z630-GET-EDIT-DTE-ATTRS                      37340000
                   IF PS-NO-DATE-ERROR                                  37350000
                       MOVE PV-ISO-DTE    TO EDT-ISO-DTE       (EDT-IDX)37360000
                       MOVE DTATTR-FSCL-YR-NBR                          37370000
                                          TO EDT-FSCL-YR-NBR   (EDT-IDX)37380000
                       MOVE DTATTR-FSCL-MN-NBR                          37390000
                                          TO EDT-FSCL-MN-NBR   (EDT-IDX)37400000
                       MOVE DTATTR-FSCL-WK-NBR                          37410000
                                          TO EDT-FSCL-WK-NBR   (EDT-IDX)37420000
                       MOVE DTATTR-WK-IN-MN-NBR                         37430000
                                          TO EDT-WK-IN-MN-NBR  (EDT-IDX)37440000
                       MOVE DTATTR-DAY-OF-WK-NBR                        37450000
                                          TO EDT-DAY-OF-WK-NBR (EDT-IDX)37460000
                       MOVE 'Y'           TO EDT-VALID-DTE-IND (EDT-IDX)37470000
                   ELSE                                                 37480000
                       MOVE 'N'           TO EDT-VALID-DTE-IND (EDT-IDX)37490000
                   END-IF                                               37500000
               ELSE                                                     37510000
                   MOVE 'N'               TO EDT-VALID-DTE-IND (EDT-IDX)37520000
               END-IF                                                   37530000
           END-IF.                                                      37540000
                                                                        37550000
       Z220-DETERMINE-ISO-DTE.                                          37560000
                                                                        37570000
      ***************************************************************** 37580000
      * THE DATE BEING EDITED IS EITHER IN MMDD OR MMDDYY FORMAT.       37590000
      * ASSIGN A CENTURY AND, IF NECESSARY, A YEAR TO THE DATE TO COME  37600000
      * UP WITH THE ISO VERSION OF THE DATE.                            37610000
      ***************************************************************** 37620000
                                                                        37630000
           IF PV-EDIT-YY = SPACE                                        37640000
      *        THE DATE BEING EDITED IS AN MMDD DATE. DETERMINE THE     37650000
      *        CCYY THAT SHOULD BE ASSIGNED TO IT.                      37660000
                                                                        37670000
               IF PV-EDIT-MM = MLCNTL-PSTG-FSCL-WK-DTE (6:2)            37680000
                                                                        37690000
      *            THE MONTH OF THE DATE BEING EDITED IS THE SAME AS    37700000
      *            THE MONTH OF THE POSTING DATE. ASSUME THAT THE CCYY  37710000
      *            SHOULD ALSO BE THE SAME AS THE CCYY OF THE POSTING   37720000
      *            DATE.                                                37730000
                                                                        37740000
                   MOVE MLCNTL-PSTG-FSCL-WK-DTE (1:4) TO PV-ISO-CCYY    37750000
                   MOVE PV-EDIT-MM                    TO PV-ISO-MM      37760000
                   MOVE PV-EDIT-DD                    TO PV-ISO-DD      37770000
               ELSE                                                     37780000
      *            THE MONTH OF THE DATE BEING EDITED IS NOT THE SAME   37790000
      *            AS THE MONTH OF THE POSTING DATE. FIND THE MOST      37800000
      *            RECENT DATE, PRIOR TO THE POSTING DATE, THAT IS      37810000
      *            VALID FOR THE MONTH AND DAY BEING EDITED. ASSIGN     37820000
      *            THE CCYY FROM THAT DATE TO THE MMDD DATE.            37830000
                                                                        37840000
                   MOVE PV-EDIT-MM     TO PV-DB2-MM                     37850000
                   MOVE PV-EDIT-DD     TO PV-DB2-DD                     37860000
                   PERFORM Z620-GET-ISO-DTE-FOR-MMDD                    37870000
                   IF PS-NO-DATE-ERROR                                  37880000
                       MOVE PV-DB2-DTE TO PV-ISO-DTE                    37890000
                   END-IF                                               37900000
               END-IF                                                   37910000
           ELSE                                                         37920000
      *        THE DATE BEING EDITED IS AN MMDDYY DATE.                 37930000
               IF   PV-EDIT-YY > PC-PIVOT-YEAR                          37940000
                   MOVE '19'   TO PV-ISO-CC                             37950000
               ELSE                                                     37960000
                   MOVE '20'   TO PV-ISO-CC                             37970000
               END-IF                                                   37980000
               MOVE PV-EDIT-YY TO PV-ISO-YY                             37990000
               MOVE PV-EDIT-MM TO PV-ISO-MM                             38000000
               MOVE PV-EDIT-DD TO PV-ISO-DD                             38010000
           END-IF.                                                      38020000
                                                                        38030000
                                                                        38040000
       Z300-SET-ML-AND-INV-INDS.                                        38050000
                                                                        38060000
           IF CC-PROCESSING-MODE-ML                                     38070000
               SET PV-ML-IND-YES TO TRUE                                38080000
           ELSE                                                         38090000
               SET PV-ML-IND-NO  TO TRUE                                38100000
           END-IF.                                                      38110000
                                                                        38120000
           IF CC-PROCESSING-MODE-INV                                    38130000
               IF CC-CHECK-INV-DATES                                    38140000
W33304             IF ST-SCHD-INV-CDE(ST-IDX) = 'EI'                    38150000
0600RB                 SET PV-INV-IND-NO TO TRUE                        38160000
0600RB             ELSE                                                 38170000
                       IF ML020-PURCHASE                                38180000
                           IF ML020-PURCH-TYP-RECEIPT                   38190000
RB0401                         IF (ST-MFSTNG-IND (ST-IDX) = 'N' OR      38200000
RB0401                             ST-MFSTNG-IND (ST-IDX) = ' ') AND    38210000
                                   PV-FIN-LIAB-DTE >                    38220000
                                          ST-ACTL-DC-CTOFF-DTE (ST-IDX) 38230000
                                   SET PV-INV-IND-NO  TO TRUE           38240000
                               ELSE                                     38250000
RB0401                             IF ST-MFSTNG-IND (ST-IDX) = 'Y' AND  38260000
RB0401                                PV-FIN-LIAB-DTE >                 38270000
RB0401                                        ST-PLND-INV-DTE (ST-IDX)  38280000
RB0401                                 SET PV-INV-IND-NO  TO TRUE       38290000
                                   ELSE                                 38300000
                                       SET PV-INV-IND-YES TO TRUE       38310000
RB0401                             END-IF                               38320000
                               END-IF                                   38330000
                           ELSE                                         38340000
                               IF PV-FIN-LIAB-DTE >                     38350000
                                  ST-PLND-INV-DTE (ST-IDX)              38360000
                                   SET PV-INV-IND-NO  TO TRUE           38370000
                               ELSE                                     38380000
                                   SET PV-INV-IND-YES TO TRUE           38390000
                               END-IF                                   38400000
                           END-IF                                       38410000
                       ELSE                                             38420000
                           IF PV-FIN-LIAB-DTE >                         38430000
                              ST-PLND-INV-DTE (ST-IDX)                  38440000
                               SET PV-INV-IND-NO  TO TRUE               38450000
                           ELSE                                         38460000
                               SET PV-INV-IND-YES TO TRUE               38470000
                           END-IF                                       38480000
                       END-IF                                           38490000
0600RB             END-IF                                               38500000
               ELSE                                                     38510000
      *        IF DATE CHECKING NOT USED, EST INV STRS MUST BE BYPASSED 38520000
0201               IF CC-DONT-CHECK-INV-DATES                           38530000
W33304                 IF ST-SCHD-INV-CDE(ST-IDX) = 'EI'                38540000
0201                      SET PV-INV-IND-NO TO TRUE                     38550000
0201                   ELSE                                             38560000
                          SET PV-INV-IND-YES TO TRUE                    38570000
0201                   END-IF                                           38580000
0201               END-IF                                               38590000
               END-IF                                                   38600000
           ELSE                                                         38610000
               SET PV-INV-IND-NO TO TRUE                                38620000
           END-IF.                                                      38630000
                                                                        38640000
                                                                        38650000
       Z400-WRITE-RPT1-REC.                                             38660000
                                                                        38670000
           MOVE '*Z400-WRITE-RPT1-REC.            *' TO PV-PARA         38680000
                                                                        38690000
           WRITE REPORT-REC           FROM ML025-RPT1-RECORD.           38700000
                                                                        38710000
                                                                        38720000
       Z998-WRITE-ERROR-FILE.                                           38730000
                                                                        38740000
           MOVE '*Z998-WRITE-ERROR-FILE.          *' TO PV-PARA         38750000
                                                                        38760000
           WRITE ERROR-REC            FROM ML026-RPT2-RECORD.           38770000
W27261     MOVE 'N' TO PV-DETAIL-ERR-SW.                                38780008
                                                                        38790000
                                                                        38800000
       Z600-GET-MLCNTL-DTES.                                            38810000
                                                                        38820000
           EXEC SQL                                                     38830000
                SELECT                                                  38840000
                    OPN_FSCL_MN_DTE                                     38850000
                   ,OPN_FSCL_MN_NBR                                     38860000
                   ,PSTG_FSCL_WK_DTE                                    38870000
                   ,PSTG_FSCL_WK_NBR                                    38880000
                   ,PSTG_FSCL_MN_DTE                                    38890000
                   ,PSTG_FSCL_MN_NBR                                    38900000
                INTO                                                    38910000
                    :MLCNTL-OPN-FSCL-MN-DTE                             38920000
                   ,:MLCNTL-OPN-FSCL-MN-NBR                             38930000
                   ,:MLCNTL-PSTG-FSCL-WK-DTE                            38940000
                   ,:MLCNTL-PSTG-FSCL-WK-NBR                            38950000
                   ,:MLCNTL-PSTG-FSCL-MN-DTE                            38960000
                   ,:MLCNTL-PSTG-FSCL-MN-NBR                            38970000
                FROM TMLCNTL                                            38980000
W26603          WITH UR                                                 38990000
           END-EXEC.                                                    39000000
                                                                        39010000
           EVALUATE TRUE                                                39020000
               WHEN SQLCODE = ZERO                                      39030000
                   CONTINUE                                             39040000
               WHEN OTHER                                               39050000
                   MOVE 'Z600-GET-MLCNTL-DTE'   TO PV-PARA              39060000
                   MOVE 'SELECT ROW FROM TMLCNTL'                       39070000
                                                TO PV-DB2-OPER-ATTEMPTED39080000
                   PERFORM Z900-SQL-ABEND                               39090000
           END-EVALUATE.                                                39100000
                                                                        39110000
                                                                        39120000
       Z610-GET-DTE-ATTRIBUTES.                                         39130000
                                                                        39140000
           EXEC SQL                                                     39150000
                SELECT                                                  39160000
                    FSCL_YR_NBR                                         39170000
                   ,FSCL_MN_NBR                                         39180000
W27261             ,FSCL_WK_NBR                                         39190000
                   ,FSCL_MN_BEG_DTE                                     39200000
W27261             ,FSCL_MN_END_DTE                                     39210000
                   ,NFM_END_DTE                                         39220000
                INTO                                                    39230000
                    :DTATTR-FSCL-YR-NBR                                 39240000
                   ,:DTATTR-FSCL-MN-NBR                                 39250000
W27261             ,:DTATTR-FSCL-WK-NBR                                 39260000
                   ,:DTATTR-FSCL-MN-BEG-DTE                             39270000
W27261             ,:DTATTR-FSCL-MN-END-DTE                             39280000
                   ,:DTATTR-NFM-END-DTE                                 39290000
                FROM                                                    39300000
                    TDTATTR                                             39310000
                WHERE                                                   39320000
                    KY_DTE = :DTATTR-KY-DTE                             39330000
W26603          WITH UR                                                 39340000
           END-EXEC.                                                    39350000
                                                                        39360000
           EVALUATE TRUE                                                39370000
               WHEN SQLCODE = ZERO                                      39380000
                   CONTINUE                                             39390000
               WHEN OTHER                                               39400000
                   DISPLAY 'DTATTR-KY-DTE: ' DTATTR-KY-DTE              39410000
                   MOVE    'Z610-GET-DTE-ATTRIBUTES'                    39420000
                                                TO PV-PARA              39430000
                   MOVE    'SELECT ROW FROM TDTATTR'                    39440000
                                                TO PV-DB2-OPER-ATTEMPTED39450000
                   PERFORM Z900-SQL-ABEND                               39460000
           END-EVALUATE.                                                39470000
                                                                        39480000
                                                                        39490000
       Z620-GET-ISO-DTE-FOR-MMDD.                                       39500000
                                                                        39510000
           EXEC SQL                                                     39520000
                SELECT                                                  39530000
                    MAX (KY_DTE)                                        39540000
                INTO                                                    39550000
                    :PV-DB2-DTE :PV-NULL-IND                            39560000
                FROM                                                    39570000
                    TDTATTR                                             39580000
                WHERE DAY   (KY_DTE)  = :PV-DB2-DD                      39590000
                  AND MONTH (KY_DTE)  = :PV-DB2-MM                      39600000
                  AND KY_DTE         <= :MLCNTL-PSTG-FSCL-WK-DTE        39610000
W26603          WITH UR                                                 39620000
           END-EXEC.                                                    39630000
                                                                        39640000
           EVALUATE TRUE                                                39650000
               WHEN SQLCODE = ZERO                                      39660000
                   IF PV-NULL-IND < 0                                   39670000
                       SET PS-DATE-ERROR TO TRUE                        39680000
                   END-IF                                               39690000
               WHEN OTHER                                               39700000
                   MOVE 'Z620-GET-ISO-DTE-FOR-MMDD'                     39710000
                                                TO PV-PARA              39720000
                   MOVE 'SELECT ROW FROM TDTATTR'                       39730000
                                                TO PV-DB2-OPER-ATTEMPTED39740000
                   PERFORM Z900-SQL-ABEND                               39750000
           END-EVALUATE.                                                39760000
                                                                        39770000
                                                                        39780000
       Z630-GET-EDIT-DTE-ATTRS.                                         39790000
                                                                        39800000
      *    LOOK FOR THE DATE BEING EDITED ON THE DATE ATTRIBUTE TABLE.  39810000
      *    THE DATE BEING EDITED MAY NOT BE A VALID DATE, SO THE WHERE  39820000
      *    CLAUSE CANNOT COMPARE IT TO A DATE COLUMN.  INSTEAD, IT      39830000
      *    MUST COMPARE THE INDIVIDUAL PIECES OF THE DATE.              39840000
                                                                        39850000
           EXEC SQL                                                     39860000
                SELECT                                                  39870000
                    KY_DTE                                              39880000
                   ,FSCL_YR_NBR                                         39890000
                   ,FSCL_MN_NBR                                         39900000
                   ,FSCL_WK_NBR                                         39910000
                   ,WK_IN_MN_NBR                                        39920000
                   ,DAY_OF_WK_NBR                                       39930000
                INTO                                                    39940000
                    :DTATTR-KY-DTE                                      39950000
                   ,:DTATTR-FSCL-YR-NBR                                 39960000
                   ,:DTATTR-FSCL-MN-NBR                                 39970000
                   ,:DTATTR-FSCL-WK-NBR                                 39980000
                   ,:DTATTR-WK-IN-MN-NBR                                39990000
                   ,:DTATTR-DAY-OF-WK-NBR                               40000000
                FROM                                                    40010000
                    TDTATTR                                             40020000
                WHERE DAY   (KY_DTE) = :PV-DB2-DD                       40030000
                  AND MONTH (KY_DTE) = :PV-DB2-MM                       40040000
                  AND YEAR  (KY_DTE) = :PV-DB2-CCYY                     40050000
                  AND KY_DTE        <= :MLCNTL-PSTG-FSCL-WK-DTE         40060000
W26603          WITH UR                                                 40070000
           END-EXEC.                                                    40080000
                                                                        40090000
           EVALUATE TRUE                                                40100000
               WHEN SQLCODE = ZERO                                      40110000
                   CONTINUE                                             40120000
               WHEN SQLCODE = +100                                      40130000
                   SET PS-DATE-ERROR TO TRUE                            40140000
               WHEN OTHER                                               40150000
                   MOVE 'Z630-GET-EDIT-DTE-ATTRS'                       40160000
                                                TO PV-PARA              40170000
                   MOVE 'SELECT ROW FROM TDTATTR'                       40180000
                                                TO PV-DB2-OPER-ATTEMPTED40190000
                   PERFORM Z900-SQL-ABEND                               40200000
           END-EVALUATE.                                                40210000
                                                                        40220000
W27261 Z700-VALIDATE-DGM-DATE.                                          40230008
W27261     MOVE 'Z700-VALIDATE-DGM-DATE' TO PV-PARA.                    40240008
W27261     IF DATE-BEING-PROCESSED-IS-BLANK                             40250008
W27261         AND CC-DGM-RUN-IND = 'Y'                                 40260008
W27261         DISPLAY '** ABEND **'                                    40270000
W27261         DISPLAY '** PROGRAM MLKUP021 **'                         40280000
W27261         DISPLAY '** PARAGRAPH ' PV-PARA                          40290000
W27261         DISPLAY '** DGM RUN REQUESTED BUT DGM-DATE IS BLANK **'  40300000
W27261         MOVE +4003 TO ABEND-CODE                                 40310000
W27261         PERFORM Z999-ABEND                                       40320000
W27261     END-IF.                                                      40330000
W27261                                                                  40340000
W27261     IF DATE-BEING-PROCESSED-IS-BLANK                             40350008
W27261*        AND CC-DGM-RUN-IND = 'N'                                 40360008
R27261         AND (CC-DGM-RUN-IND = 'N'                                40370008
R27261         OR   CC-DGM-RUN-IND = ' ')                               40380008
W27261         GO TO Z700-EXIT                                          40390008
W27261     END-IF.                                                      40400008
W27261                                                                  40410008
W27261     IF PV-DG-FWED-MM < 01 OR PV-DG-FWED-MM > 12                  40420000
W27261         DISPLAY '** ABEND **'                                    40430000
W27261         DISPLAY '** PROGRAM MLKUP021 **'                         40440000
W27261         DISPLAY '** PARAGRAPH ' PV-PARA                          40450000
W27261         DISPLAY '** INVALID MONTH IN DGM-DATE DETECTED **'       40460000
W27261         MOVE +4003 TO ABEND-CODE                                 40470000
W27261         PERFORM Z999-ABEND                                       40480000
W27261     END-IF.                                                      40490008
W27261                                                                  40500008
W27261     IF PV-DG-FWED-DD < 01 OR PV-DG-FWED-DD > 31                  40510000
W27261         DISPLAY '** ABEND **'                                    40520000
W27261         DISPLAY '** PROGRAM MLKUP021 **'                         40530000
W27261         DISPLAY '** PARAGRAPH ' PV-PARA                          40540000
W27261         DISPLAY '** INVALID DAY IN DGM-DATE DETECTED **'         40550000
W27261         MOVE +4003 TO ABEND-CODE                                 40560000
W27261         PERFORM Z999-ABEND                                       40570000
W27261     END-IF.                                                      40580008
W27261     MOVE 'Y' TO PV-DAILY-GROSS-MARGIN-RUN-IND.                   40590008
W27261                                                                  40600000
W27261 Z700-EXIT.                                                       40610008
W27261     EXIT.                                                        40620008
                                                                        40630000
W27261*=================================================================40640008
W27261* WHEN MKLUP021 RUNS FOR DAILY GROSS MARGINS IT MUST RETRIEVE THE 40650008
W27261* DATES FROM THE TDTATTR FOR THE DATE SUPPLIED ON THE CONTROL CARD40660008
W27261* RATHER THAN THE CURRENT TLCNTL DATE. THIS IS NECESSARY BECAUSE  40670008
W27261* THE TLCNTL DATES ARE NOT ROLLED FORWARD UNTIL AFTER THE WEEKLY  40680008
W27261* MLKUP021 RUN ON SATURDAY.                                       40690008
W27261*=================================================================40700008
W27261 Z710-ESTABLISH-DATES-FOR-DGM.                                    40710008
W27261     MOVE PV-DGM-DATE-BEING-PROCESSED TO DTATTR-KY-DTE.           40720008
W27261     PERFORM Z610-GET-DTE-ATTRIBUTES.                             40730000
W27261     MOVE DTATTR-FSCL-MN-NBR      TO MLCNTL-OPN-FSCL-MN-NBR       40740000
W27261                                     MLCNTL-PSTG-FSCL-MN-NBR.     40750000
W27261     MOVE DTATTR-FSCL-MN-END-DTE  TO MLCNTL-OPN-FSCL-MN-DTE       40760000
W27261                                     MLCNTL-PSTG-FSCL-MN-DTE.     40770000
W27261     MOVE DTATTR-KY-DTE           TO MLCNTL-PSTG-FSCL-WK-DTE.     40780000
W27261     MOVE DTATTR-FSCL-WK-NBR      TO MLCNTL-PSTG-FSCL-WK-NBR      40790000
W27261     MOVE DTATTR-FSCL-YR-NBR      TO PV-PSTG-FSCL-YR-NBR.         40800000
W27261     MOVE DTATTR-FSCL-MN-BEG-DTE  TO PV-FSCL-MN-BEG-DTE.          40810000
W27261     MOVE DTATTR-FSCL-MN-END-DTE  TO PV-FSCL-MN-END-DTE.          40820000
W27261                                                                  40830008
W27261     MOVE MLCNTL-PSTG-FSCL-WK-DTE TO PV-ISO-DTE.                  40840000
W27261     STRING PV-ISO-MM        DELIMITED BY SIZE                    40850000
W27261           '/'               DELIMITED BY SIZE                    40860000
W27261            PV-ISO-DD        DELIMITED BY SIZE                    40870000
W27261           '/'               DELIMITED BY SIZE                    40880000
W27261            PV-ISO-YY        DELIMITED BY SIZE                    40890000
W27261                                 INTO PV-PROC-GREG-FMT-DTE.       40900000
W27261     MOVE MLCNTL-OPN-FSCL-MN-DTE TO DTATTR-KY-DTE.                40910000
W27261     PERFORM Z610-GET-DTE-ATTRIBUTES.                             40920008
W27261     MOVE DTATTR-FSCL-YR-NBR      TO PV-OPN-FSCL-YR-NBR.          40930000
W27261     MOVE DTATTR-NFM-END-DTE      TO DTATTR-KY-DTE.               40940000
W27261     PERFORM Z610-GET-DTE-ATTRIBUTES.                             40950008
W27261     MOVE DTATTR-FSCL-YR-NBR      TO PV-NEXT-FSCL-YR-NBR.         40960000
W27261     MOVE DTATTR-FSCL-MN-NBR      TO PV-NEXT-FSCL-MN-NBR.         40970000
W27261     DISPLAY '--> PV-FSCL-MN-BEG-DTE = '                          40980000
W27261         PV-FSCL-MN-BEG-DTE.                                      40990000
W27261     DISPLAY '--> ALTERNATE END DATE FOR CUTOFF WEEK = '          41000000
W27261         PV-FSCL-MN-END-DTE.                                      41010000
W27261     DISPLAY ' MLCNTL-OPN-FSCL-MN-DTE:  '                         41020000
W27261               MLCNTL-OPN-FSCL-MN-DTE                             41030000
W27261             ' MLCNTL-OPN-FSCL-MN-NBR:  '                         41040000
W27261               MLCNTL-OPN-FSCL-MN-NBR                             41050000
W27261     DISPLAY ' MLCNTL-PSTG-FSCL-WK-DTE: '                         41060000
W27261               MLCNTL-PSTG-FSCL-WK-DTE                            41070000
W27261             ' MLCNTL-PSTG-FSCL-WK-NBR: '                         41080000
W27261               MLCNTL-PSTG-FSCL-WK-NBR.                           41090000
W27261     DISPLAY ' MLCNTL-PSTG-FSCL-MN-DTE: '                         41100000
W27261               MLCNTL-PSTG-FSCL-MN-DTE                            41110000
W27261             ' MLCNTL-PSTG-FSCL-MN-NBR: '                         41120000
W27261               MLCNTL-PSTG-FSCL-MN-NBR.                           41130000
W27261     DISPLAY ' '.                                                 41140000
W27261                                                                  41150000
W27261     MOVE MLCNTL-PSTG-FSCL-WK-DTE TO DTATTR-KY-DTE.               41160000
W27261 Z710-EXIT.                                                       41170008
W27261      EXIT.                                                       41180008
                                                                        41190008
       Z900-SQL-ABEND.                                                  41200000
                                                                        41210000
           MOVE +4013                 TO ABEND-CODE.                    41220000
           DISPLAY '**  ABEND     **'.                                  41230000
           DISPLAY '**  PROGRAM   **  =  MLKUP021'.                     41240000
           DISPLAY '**  PARAGRAPH **  = ' PV-PARA.                      41250000
           DISPLAY '**  OPERATION **  = ' PV-DB2-OPER-ATTEMPTED.        41260000
                                                                        41270000
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         41280000
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        41290000
                                                                        41300000
           COPY DPPD004.                                                41310000
                                                                        41320000
           PERFORM Z999-ABEND.                                          41330000
                                                                        41340000
                                                                        41350000
       Z999-INVALID-PRESET-VALUE-ABND.                                  41360000
                                                                        41370000
      **   THIS VALUE IS PRESET BY MLKUP020 (THE PRE-EDIT).  AN INVALID 41380000
      **   CONDITION SHOULD RESULT IN AN ABEND.  IN THE FUTURE, INTER-  41390000
      **   FACING SYSTEMS WILL SUPPLY A VALUE RATHER THAN HAVING THE    41400000
      **   PRE-EDIT SET ONE.  AT THAT TIME, THE ERROR S/B REPORTED      41410000
      **   (VIA ML026-RPT2 RECORDS) RATHER THAN ABENDING.               41420000
                                                                        41430000
           MOVE +4008 TO ABEND-CODE.                                    41440000
           DISPLAY '**  ABEND     **'.                                  41450000
           DISPLAY '**  PROGRAM   **  =  MLKUP021'.                     41460000
           DISPLAY '**  PARAGRAPH **  = ' PV-PARA.                      41470000
                                                                        41480000
           PERFORM Z999-ABEND.                                          41490000
                                                                        41500000
                                                                        41510000
       Z999-ABEND.                                                      41520000
                                                                        41530000
           CALL 'ILBOABN0'             USING ABEND-CODE.                41540000
                                                                        41550000
