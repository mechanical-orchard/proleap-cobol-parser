000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             TCKRP012.                                00050001
000600 AUTHOR.                 J MYERS.                                 00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            05/2002.                                 00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100***************************************************************** 00110000
001200*  PURPOSE:                                                       00120000
001300*  CREATE DAILY CREDIT SETTLEMENT REPORTING                       00130000
001100***************************************************************** 00130100
001300*  CHANGE LOG:                                                    00131000
001300*  09/03/2015    MADHURA PETHE                                    00132000
001300*  ADDED TRN-TYP-CDE OF '02' FOR HANDLING ASSOCIATE SALE FOR      00133000
001300*  3RD PARTY CARDS                                                00134000
125703***************************************************************** 00134100
125703*  10/20/2015    COGNIZANT                                        00135000
125703*  ADDED TRN-TYP-CDE OF '25' FOR HANDLING                         00136000
125703*  ASSOCIATE PRICE ADJUSTMENT FOR 3RD PARTY CARDS WITH CHG125703  00137000
001400***************************************************************** 00140000
POA   *  03/07/2017    BARB SCHULTZ                                     00142000
POA   *  ADDED TRN-TYP-CDE OF '30' FOR HANDLING POA TRANSACTIONS        00143000
052523***************************************************************** 00145000
052523*  05/17/23      DAN PAYNTER          CHG0289014                  00146000
052523*  CLONED TCKRP006 AND MODIFIED IT TO DISPLAY COBRAND PAYMENTS    00147003
052523*  REPORTING                                                      00148000
062223***************************************************************** 00148100
062223*  06/22/23      DAN PAYNTER          CHG0290003                  00148200
062223*  PROPERLY DISPLAY APPLE PAY TOKENS WITH CORRECT AMOUNT OF X'S   00148300
001400***************************************************************** 00148401
092223*  09/22/23      DAN PAYNTER          CHG0293030                  00148502
092223*  CLONED TCKRP006 AND MODIFIED IT TO DISPLAY COBRAND PAYMENTS    00148602
092223*  REPORTING                                                      00148702
092223*  OUTPUT THE 'PROCESSED' TRAILING TRANSACTIONS TO OUTPUT FILE    00148802
001400***************************************************************** 00148901
001400***************************************************************** 00149000
001500 ENVIRONMENT DIVISION.                                            00150000
001600***************************************************************** 00160000
001700                                                                  00170000
001800 CONFIGURATION SECTION.                                           00180000
001900                                                                  00190000
002000 SOURCE-COMPUTER.        IBM-3090.                                00200000
002100                                                                  00210000
002200 OBJECT-COMPUTER.        IBM-3090.                                00220000
002300                                                                  00230000
002400 INPUT-OUTPUT SECTION.                                            00240000
002500                                                                  00250000
002600 FILE-CONTROL.                                                    00260000
002700                                                                  00270000
002800     SELECT CONTROL-DATE-FILE                                     00280000
002900         ASSIGN TO INP01.                                         00290000
003000                                                                  00300000
003100     SELECT CREDIT-REPORT-FILE                                    00310000
003200         ASSIGN TO INP02.                                         00320000
003300                                                                  00330000
003400     SELECT AUDIT-REPORT                                          00340000
003500         ASSIGN TO RPT01.                                         00350000
003600                                                                  00360000
003700     SELECT TOTALS-REPORT                                         00370000
003800         ASSIGN TO RPT02.                                         00380000
003900                                                                  00390000
092223     SELECT TRAN-PRCD-FILE                                        00392002
092223         ASSIGN TO OUT01.                                         00393002
092223                                                                  00394002
004000******************************************************************00400000
004100 DATA DIVISION.                                                   00410000
004200******************************************************************00420000
004300                                                                  00430000
004400 FILE SECTION.                                                    00440000
004500                                                                  00450000
004600 FD  CONTROL-DATE-FILE                                            00460000
004700     RECORDING MODE IS F                                          00470000
004800     BLOCK CONTAINS 0 RECORDS                                     00480000
004900     LABEL RECORDS ARE OMITTED.                                   00490000
005000                                                                  00500000
005100 01  CONTROL-DATE-RECORD         PIC X(80).                       00510000
005200                                                                  00520000
005300 FD  CREDIT-REPORT-FILE                                           00530000
005400     RECORDING MODE IS F                                          00540000
005500     BLOCK CONTAINS 0 RECORDS.                                    00550000
005600                                                                  00560000
052523 01  CREDIT-REPORT-REC           PIC X(100).                      00570000
005800                                                                  00580000
005900                                                                  00590000
006000 FD  AUDIT-REPORT                                                 00600000
006100     RECORDING MODE IS F                                          00610000
006200     BLOCK CONTAINS 0 RECORDS.                                    00620000
006300                                                                  00630000
006400 01  AUDIT-REPORT-REC               PIC X(132).                   00640000
006500                                                                  00650000
006600 FD  TOTALS-REPORT                                                00660000
006700     RECORDING MODE IS F                                          00670000
006800     BLOCK CONTAINS 0 RECORDS.                                    00680000
006900                                                                  00690000
007000 01  TOTALS-REPORT-REC              PIC X(132).                   00700000
007100                                                                  00710000
092223 FD  TRAN-PRCD-FILE                                               00711002
092223     RECORDING MODE IS F                                          00712002
092223     LABEL RECORDS ARE STANDARD                                   00713002
092223     BLOCK CONTAINS 0 RECORDS                                     00714002
092223     RECORD CONTAINS 100 CHARACTERS                               00715002
092223     DATA RECORD IS TRAN-PRCD-RECORD.                             00716002
092223                                                                  00717002
092223 01  TRAN-PRCD-RECORD                PIC X(100).                  00718002
092223                                                                  00719002
007200******************************************************************00720000
007300 WORKING-STORAGE SECTION.                                         00730000
007400******************************************************************00740000
007500 01  FILLER                            PIC X(50)  VALUE           00750000
007600     ' *** WORKING STORAGE STARTS HERE FOR TCKRP012 *** '.        00760001
007700                                                                  00770000
007800******************************************************************00780000
007900* RECORD LAYOUT FOR INPUT DATE CARD (POS DATE)                   *00790000
008000******************************************************************00800000
008100 01  CC-CONTROL-CARD.                                             00810000
008200     05  CC-CONTROL-CARD-DISPLAY.                                 00820000
008300         10  CC-CONTROL-NAME     PIC X(14)    VALUE SPACE.        00830000
008400             88  CC-VALID-CONTROL-NAME        VALUE               00840000
008500                'P.O.S. DATE = '.                                 00850000
008600         10  CC-POS-DATE-MMDDYY  PIC 9(6)     VALUE ZERO.         00860000
008700    05  FILLER                  PIC X(60)    VALUE SPACE.         00870000
008800                                                                  00880000
008900******************************************************************00890000
009000*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)            *00900000
009100******************************************************************00910000
009200     COPY DPWS500.                                                00920000
009300                                                                  00930000
009400 01  AC-ABEND-CODE                      PIC S9(04) VALUE ZERO     00940000
009500                                                  COMP SYNC.      00950000
009600     88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    00960000
009700     88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.    00970000
009800                                                                  00980000
009900  01  PS-PROGRAM-SWITCHES.                                        00990000
010000     05  PS-END-OF-CONTROL-FILE-SW     PIC X(01)  VALUE 'N'.      01000000
010100         88  PS-END-OF-CONTROL-FILE               VALUE 'Y'.      01010000
010200     05  PS-END-OF-CREDIT-SW           PIC X(01)  VALUE 'N'.      01020000
010300         88  PS-NOT-END-OF-CREDIT-FILE            VALUE 'N'.      01030000
010400         88  PS-END-OF-CREDIT-FILE                VALUE 'Y'.      01040000
010500     05  PS-INPUT-TODAY-SW             PIC X(01)  VALUE 'N'.      01050000
010600         88  NO-INPUT-TODAY                       VALUE 'N'.      01060000
010700         88  INPUT-TODAY                          VALUE 'Y'.      01070000
010800     05  PS-RGST-1ST-LINE-SW           PIC X(01)  VALUE '1'.      01080000
010900         88  PS-RGST-1ST-LINE                     VALUE '1'.      01090000
011000         88  PS-NOT-RGST-1ST-LINE                 VALUE '9'.      01100000
011100     05  PS-STR-1ST-LINE-SW            PIC X(01)  VALUE '1'.      01110000
011200         88  PS-STR-1ST-LINE                      VALUE '1'.      01120000
011300         88  PS-NOT-STR-1ST-LINE                  VALUE '9'.      01130000
011400******************************************************************01140000
011500*   PROGRAM CONSTANTS                                            *01150000
011600******************************************************************01160000
011700 01  PC-CONSTANTS.                                                01170000
011800     05  PC-LINE-LIMIT                 PIC S9(04) VALUE +60.      01180000
011900     05  PC-PROGRAM-NAME               PIC  X(08) VALUE           01190000
012000                                                 'TCKRP012'.      01200001
012100     05  PC-REPORT-NBR-1             PIC 9(01).                   01210000
012200     05  PC-REPORT-NBR-2             PIC 9(01).                   01220000
012300     05  PC-VAR-KOHLS                PIC X(12)    VALUE           01230000
012400                                                 'KOHLS CHARGE'.  01240000
012500     05  PC-VAR-BANKCARD             PIC X(12)    VALUE           01250000
012600                                                 '  BANKCARD  '.  01260000
012700     05  PC-VAR-DISCOVER             PIC X(12)    VALUE           01270000
012800                                                 '  DISCOVER  '.  01280000
012900     05  PC-VAR-AMEX                 PIC X(12)    VALUE           01290000
013000                                                 '    AMEX    '.  01300000
052523     05  PC-VAR-COBRAND              PIC X(12)    VALUE           01301000
052523                                                 '  COBRAND   '.  01302000
052523     05  PC-VAR-TRAILNG              PIC X(12)    VALUE           01303000
052523                                                 '  TRAILING  '.  01304000
013100                                                                  01310000
013200 01  PV-PROGRAM-VARIABLES.                                        01320000
013300     05  PV-MISC-COUNT-FIELDS                         COMP-3.     01330000
013400          10  PV-R1-LINE-CNT           PIC S9(05) VALUE ZERO.     01340000
013500          10  PV-R1-PAGE-CNT           PIC S9(05) VALUE ZERO.     01350000
013600          10  PV-R2-LINE-CNT           PIC S9(05) VALUE ZERO.     01360000
013700          10  PV-R2-PAGE-CNT           PIC S9(05) VALUE ZERO.     01370000
013800     05  PV-PARAGRAPH-NAME             PIC  X(30) VALUE SPACE.    01380000
013900     05  PV-OPERATION-MSG-1            PIC  X(40) VALUE SPACE.    01390000
014000     05  PV-OPERATION-MSG-2            PIC  X(40) VALUE SPACE.    01400000
014100     05  PV-POS-CCYY-MM-DD             PIC  X(10).                01410000
014200     05  PV-SV-TRN-DTE                 PIC  X(10).                01420000
014300     05  PV-SV-STR-NBR                 PIC  S9(04)  COMP.         01430000
014300     05  PV-ORG-STR-NBR                PIC  X(04).                01431000
014400     05  PV-SV-RGST-ID                 PIC  S9(04)  COMP.         01432000
014500     05  PV-SV-RPT-DATE                PIC X(08)  VALUE SPACES.   01433000
POA        05  PV-DISPLAYS.                                             01433200
POA            10  PV-PARTN-NBR              PIC  9(4)  VALUE ZEROES.   01433300
POA            10  PV-STR-NBR                PIC  9(4)  VALUE ZEROES.   01433400
POA            10  PV-RGST-ID                PIC  9(4)  VALUE ZEROES.   01433500
POA            10  PV-TRN-NBR                PIC  9(4)  VALUE ZEROES.   01433600
POA            10  PV-TNDR-AMT               PIC  S9(7)V99 VALUE ZEROES.01433700
052523     05  PV-ACCT-LN                    PIC 9(07) VALUE ZEROS.     01433800
052523     05  PV-TRL-CARD-NUMBER.                                      01434000
052523         10  PV-SPACE-TRL-CARD-NUMBER  PIC  X(08)                 01435000
052523                                            VALUE 'XXXXXXXX'.     01436000
052523         10  PV-TRL-CARD-NBR           PIC  X(04) VALUE SPACE.    01437000
052523         10  PV-TRL-EMPTY              PIC  X(04) VALUE SPACE.    01437100
052523     05  PV-TRL-AP-CARD-NUMBER.                                   01437200
052523         10  PV-SPACE-TRL-AP-CRD-NBR   PIC  X(14)                 01437300
052523                                       VALUE 'XXXXXXXXXXXXXX'.    01437400
052523         10  PV-TRL-AP-CARD-NBR        PIC  X(04) VALUE SPACE.    01437500
014500     05  PV-CARD-NUMBER.                                          01437700
014500         10  PV-SPACE-CARD-NUMBER      PIC  X(12)                 01437800
014500                                            VALUE 'XXXXXXXXXXXX'. 01437900
014500         10  PV-CARD-NBR               PIC  X(04) VALUE SPACE.    01438000
014500     05  PV-CARD-NUMBER-A.                                        01438100
014500         10  PV-SPACE-CARD-NBR-A       PIC  X(11)                 01439000
014500                                            VALUE 'XXXXXXXXXXX'.  01440000
014500         10  PV-CARD-NBR-A             PIC  X(04) VALUE SPACE.    01450000
014600     05  PV-SV-MERCHANT-NBR.                                      01460000
014600         10  PV-SV-MERCHANT-NBR-2      PIC X(02)  VALUE ZEROES.   01470000
014600         10  PV-SV-MERCHANT-NBR-13     PIC X(13)  VALUE ZEROES.   01480000
014700     05  PV-AMEX-MERCHANT-NBR.                                    01490000
               10  FILLER                    PIC X(02)  VALUE SPACES.   01491000
014900         10  PV-MERCHANT-NBR-A         PIC X(10)  VALUE ZEROES.   01492000
               10  FILLER                    PIC X(03)  VALUE SPACES.   01493000
015000     05  PV-WRK-TOTALS.                                           01494000
015100         10  PV-WRK-PROC-SALES         PIC  S9(09)V99 COMP-3.     01495000
015200         10  PV-WRK-UNPROC-SALES       PIC  S9(09)V99 COMP-3.     01496000
015300         10  PV-WRK-PROC-RETURNS       PIC  S9(09)V99 COMP-3.     01497000
015400         10  PV-WRK-UNPROC-RETURNS     PIC  S9(09)V99 COMP-3.     01498000
POA            10  PV-OTHER                  PIC  S9(09)V99 COMP-3.     01498100
015500                                                                  01499000
015600     05  PV-REG-TOTALS.                                           01500000
015700         10  PV-REG-PROC-SALES         PIC  S9(09)V99 COMP-3.     01510000
015800         10  PV-REG-UNPROC-SALES       PIC  S9(09)V99 COMP-3.     01520000
015900         10  PV-REG-PROC-RETURNS       PIC  S9(09)V99 COMP-3.     01530000
016000         10  PV-REG-UNPROC-RETURNS     PIC  S9(09)V99 COMP-3.     01540000
016100                                                                  01550000
016200     05  PV-STR-TOTALS.                                           01560000
016300         10  PV-STR-PROC-SALES         PIC  S9(09)V99 COMP-3.     01570000
016400         10  PV-STR-UNPROC-SALES       PIC  S9(09)V99 COMP-3.     01580000
016500         10  PV-STR-PROC-RETURNS       PIC  S9(09)V99 COMP-3.     01590000
016600         10  PV-STR-UNPROC-RETURNS     PIC  S9(09)V99 COMP-3.     01600000
016700                                                                  01610000
016800     05  PV-DTE-TOTALS.                                           01620000
016900         10  PV-DTE-PROC-SALES         PIC  S9(09)V99 COMP-3.     01630000
017000         10  PV-DTE-UNPROC-SALES       PIC  S9(09)V99 COMP-3.     01640000
017100         10  PV-DTE-PROC-RETURNS       PIC  S9(09)V99 COMP-3.     01650000
017200         10  PV-DTE-UNPROC-RETURNS     PIC  S9(09)V99 COMP-3.     01660000
017300                                                                  01670000
017400     05  PV-NET-TOTALS.                                           01680000
017500         10 PV-NET-PROC                PIC  S9(12)V99 COMP-3.     01690000
017600         10 PV-NET-UNPROC              PIC  S9(12)V99 COMP-3.     01700000
017700         10 PV-NET-TOTAL               PIC  S9(12)V99 COMP-3.     01710000
017800                                                                  01720000
017900     05  PV-GRND-TOTALS.                                          01730000
018000         10 PV-GRND-PROC-SALES         PIC  S9(11)V99 COMP-3.     01740000
018100         10 PV-GRND-UNPROC-SALES       PIC  S9(11)V99 COMP-3.     01750000
018200         10 PV-GRND-PROC-RETURNS       PIC  S9(11)V99 COMP-3.     01760000
018300         10 PV-GRND-UNPROC-RETURNS     PIC  S9(11)V99 COMP-3.     01770000
018400                                                                  01780000
018500 01  PV-T1-TOT-VARIBLES.                                          01790000
018600     05  PV-T1-TOT-RGST                PIC  X(30) VALUE           01800000
018700         'REGISTER TOTALS               '.                        01810000
018800                                                                  01820000
018900     05  PV-T1-TOT-STORE.                                         01830000
019000         10  FILLER                    PIC X(06)  VALUE 'STORE '. 01840000
019100         10  PV-T1-TOT-STORE-NBR       PIC X(04).                 01850000
019200         10  FILLER                    PIC X(12)  VALUE           01860000
019300             ' TOTALS FOR '.                                      01870000
019400         10  PV-T1-TOT-DATE            PIC X(08).                 01880000
019500                                                                  01890000
019600     05  PV-T1-TOT-ALL-STORE.                                     01900000
019700         10  FILLER                    PIC X(21)  VALUE           01910000
019800             'ALL STORE TOTALS FOR '.                             01920000
019900         10  PV-T1-TOT-ALL-DATE        PIC X(08).                 01930000
020000         10  FILLER                    PIC X(01)  VALUE SPACES.   01940000
020100                                                                  01950000
020200 01  PV-T2-TOT-VARIBLES.                                          01960000
020300                                                                  01970000
020400     05  PV-T2-TOT-ALL-STORE.                                     01980000
020500         10  FILLER                    PIC X(13)  VALUE           01990000
020600             'ALL STORES - '.                                     02000000
020700         10  PV-T2-TOT-DATE            PIC X(08).                 02010000
020700         10  FILLER                    PIC X(15)  VALUE SPACES.   02020000
020800                                                                  02030000
020900     05  PV-T2-TOT-GRAND.                                         02040000
020900         10  PV-TOT-GRAND              PIC X(11)  VALUE           02050000
021000             'GRAND TOTAL'.                                       02060000
020900         10  FILLER                    PIC X(15)  VALUE SPACES.   02070000
021100                                                                  02080000
021200******************************************************************02090000
021300*   DATE AND TIME FIELDS.                                        *02100000
021400******************************************************************02110000
021500 01  PV-DATE-AND-TIME-FIELDS.                                     02120000
021600     05  PV-MMDDYY-DATE.                                          02130000
021700         10  PV-MMDDYY-MM            PIC X(02).                   02140000
021800         10  PV-MMDDYY-DD            PIC X(02).                   02150000
021900         10  PV-MMDDYY-YY            PIC X(02).                   02160000
022000     05  PV-CURR-DATE-CCYYMMDD.                                   02170000
022100         10  PV-CURR-DATE-CCYY       PIC  9(04).                  02180000
022200         10  PV-CURR-DATE-MM         PIC  9(02).                  02190000
022300         10  PV-CURR-DATE-DD         PIC  9(02).                  02200000
022400     05  PV-CURR-TIME.                                            02210000
022500         10  PV-CURR-TIME-HH         PIC  9(02)    VALUE ZERO.    02220000
022600         10  PV-CURR-TIME-MM         PIC  9(02)    VALUE ZERO.    02230000
022700         10  PV-CURR-TIME-SS         PIC  9(02)    VALUE ZERO.    02240000
022800     05  PV-FMT-DATE.                                             02250000
022900         10  PV-FMT-MM               PIC  9(02)    VALUE ZERO.    02260000
023000         10  PV-SLASH-1              PIC  X(01)    VALUE '/'.     02270000
023100         10  PV-FMT-DD               PIC  9(02)    VALUE ZERO.    02280000
023200         10  PV-SLASH-2              PIC  X(01)    VALUE '/'.     02290000
023300         10  PV-FMT-YY               PIC  9(02)    VALUE ZERO.    02300000
023400                                                                  02310000
023500     05  PV-RPT-DATE.                                             02320000
023600         10  PV-RPT-MM               PIC  9(02)    VALUE ZERO.    02330000
023700         10  PV-RPT-SLASH-1          PIC  X(01)    VALUE '/'.     02340000
023800         10  PV-RPT-DD               PIC  9(02)    VALUE ZERO.    02350000
023900         10  PV-RPT-SLASH-2          PIC  X(01)    VALUE '/'.     02360000
024000         10  PV-RPT-YY               PIC  9(02)    VALUE ZERO.    02370000
024100                                                                  02380000
024200     05  PV-TRN-DTE-CCYYMMDD.                                     02390000
024300         10  PV-TRN-CCYY             PIC  9(02)    VALUE ZERO.    02400000
024400         10  PV-TRN-YY               PIC  9(02)    VALUE ZERO.    02410000
024500         10  PV-TRN-DASH1            PIC  X(01)    VALUE '-'.     02420000
024600         10  PV-TRN-MM               PIC  9(02)    VALUE ZERO.    02430000
024700         10  PV-TRN-DASH2            PIC  X(01)    VALUE '-'.     02440000
024800         10  PV-TRN-DD               PIC  9(02)    VALUE ZERO.    02450000
024900                                                                  02460000
025000 01  SUBSCRIPTS.                                                  02470000
025100     05  SUB                     PIC S9(04)  COMP.                02480000
025200                                                                  02490000
025300***************************************************************** 02500000
025400*  PROCESS TABLE DESIGN TO HAVE THE RECORD TYPE AND START REPORT  02510000
025500*  NUMBER.  THERE ARE TWO REPORTS ONE AUDIT (1) AND TOTALS (2)    02520000
025600*  RECORD TYPE 5,6 GO ON SAME REPORT TITLE (BANKCARD)             02530000
025700*  TABLE IS SETUP TO HAVE 5 EXPANSION SLOTS EXP1-EXP5 THESE ARE   02540000
025800*  FOR FUTURE REPORTING NEEDS                                     02550000
025900******************************************************************02560000
026000 01  PROCESS-TABLE.                                               02570000
026100     05  PT-REPORT-PROCESSOR.                                     02580000
026200         10  PT-BANKCARD-5       PIC X(04)       VALUE '0501'.    02590000
026300         10  PT-BANKCARD-6       PIC X(04)       VALUE '0601'.    02600000
026400         10  PT-AMEX             PIC X(04)       VALUE '0803'.    02610000
026500         10  PT-DISCOVER         PIC X(04)       VALUE '0705'.    02620000
026600         10  PT-KOHLS            PIC X(04)       VALUE '0407'.    02630000
052523         10  PT-COBRAND          PIC X(04)       VALUE '2405'.    02640000
052523         10  PT-TRAILING         PIC X(04)       VALUE '2507'.    02650000
026900         10  PT-EXP3             PIC X(04)       VALUE '0000'.    02660000
027000         10  PT-EXP4             PIC X(04)       VALUE '0000'.    02670000
027100         10  PT-EXP5             PIC X(04)       VALUE '0000'.    02680000
027200                                                                  02690000
027300     05  PT-REPORT-PROCESSOR-R REDEFINES PT-REPORT-PROCESSOR.     02700000
027400         10  PT-REPORT-TBL OCCURS 10 TIMES.                       02710000
027500             15  PT-TRN-TYP-CDE  PIC X(02).                       02720000
027600             15  PT-RPT-NBR-START                                 02730000
027700                                 PIC 9(02).                       02740000
027800                                                                  02750000
027900******************************************************************02760000
028000*  TOP OF PAGE HEADING LINE FOR PRINTING A 132 CHARACTER REPORT. *02770000
028100******************************************************************02780000
028200     COPY DPWS132.                                                02790000
028300                                                                  02800000
028400***************************************************************** 02810000
028500*  CREDIT REPORT INPUT FILE                                       02820000
028600******************************************************************02830000
028700     COPY TCRD008.                                                02840000
028800                                                                  02850000
092223***************************************************************** 02851002
092223*  CREDIT REPORT OUTPUT FILE                                      02852002
092223******************************************************************02853002
092223     COPY TCRD008 REPLACING 'TC008-' BY 'WK008-'.                 02854002
092223                                                                  02855002
028900******************************************************************02860000
029000*  T1 TITLE FOR REPORT 1                                         *02870000
029100******************************************************************02880000
029200 01  T1-TITLE-LINE-1.                                             02890000
029300     05  FILLER                      PIC  X(46)    VALUE SPACES.  02900000
029400     05  T1-TITLE.                                                02910000
029500         10  FILLER                  PIC  X(06)    VALUE          02920000
029600         'DAILY '.                                                02930000
029700         10  T1-VAR-TITLE            PIC  X(12).                  02940000
029800         10  FILLER                  PIC  X(13)    VALUE          02950000
029900             ' AUDIT  FOR  '.                                     02960000
030000     05  T1-PROCESS-DTE              PIC  X(08)    VALUE SPACES.  02970000
030100     05  FILLER                      PIC  X(49)    VALUE SPACES.  02980000
030200                                                                  02990000
030300******************************************************************03000000
030400*  H1 COLUMN HEADINGS REPORT 1                                   *03010000
030500******************************************************************03020000
030600 01  H1-AUDIT-HEADING.                                            03030000
030700     05  FILLER                      PIC  X(05)    VALUE SPACES.  03040000
030700     05  FILLER                      PIC  X(04)    VALUE 'ORIG'.  03050000
030700     05  FILLER                      PIC  X(50)    VALUE SPACES.  03060000
030800     05  FILLER                      PIC  X(09)    VALUE          03070000
030900         'PROCESSED'.                                             03080000
031000     05  FILLER                      PIC  X(05)    VALUE SPACES.  03090000
031100     05  FILLER                      PIC  X(11)    VALUE          03100000
031200         'UNPROCESSED'.                                           03110000
031300     05  FILLER                      PIC  X(07)    VALUE SPACES.  03120000
031400     05  FILLER                      PIC  X(09)    VALUE          03130000
031500         'PROCESSED'.                                             03140000
031600     05  FILLER                      PIC  X(05)    VALUE SPACES.  03150000
031700     05  FILLER                      PIC  X(11)    VALUE          03160000
031800         'UNPROCESSED'.                                           03170000
031900     05  FILLER                      PIC  X(17)    VALUE SPACES.  03180000
032000******************************************************************03190000
032100*  H2 COLUMN HEADINGS REPORT 1                                   *03200000
032200******************************************************************03210000
032300 01  H2-AUDIT-HEADING.                                            03220000
032400     05  FILLER                      PIC  X(05)    VALUE          03230000
032500         ' STR '.                                                 03240000
032600     05  FILLER                      PIC  X(01)    VALUE SPACES.  03250000
032400     05  FILLER                      PIC  X(04)    VALUE          03260000
032500         'STR '.                                                  03261000
032600     05  FILLER                      PIC  X(03)    VALUE SPACES.  03262000
032700     05  FILLER                      PIC  X(08)    VALUE          03263000
032800         'MERCHANT'.                                              03264000
032900     05  FILLER                      PIC  X(06)    VALUE SPACES.  03265000
033000     05  FILLER                      PIC  X(03)    VALUE          03266000
033100         'REG'.                                                   03267000
033200     05  FILLER                      PIC  X(01)    VALUE SPACES.  03268000
033300     05  FILLER                      PIC  X(04)    VALUE          03269000
033400         'TRAN'.                                                  03270000
033500     05  FILLER                      PIC  X(07)    VALUE SPACES.  03280000
033600     05  FILLER                      PIC  X(04)    VALUE          03290000
033700         'ACCT'.                                                  03300000
033800     05  FILLER                      PIC  X(16)    VALUE SPACES.  03310000
033900     05  FILLER                      PIC  X(05)    VALUE          03320000
034000         'SALES'.                                                 03330000
034100     05  FILLER                      PIC  X(10)    VALUE SPACES.  03340000
034200     05  FILLER                      PIC  X(05)    VALUE          03350000
034300         'SALES'.                                                 03360000
034400     05  FILLER                      PIC  X(11)    VALUE SPACES.  03370000
034500     05  FILLER                      PIC  X(07)    VALUE          03380000
034600         'RETURNS'.                                               03390000
034700     05  FILLER                      PIC  X(08)    VALUE SPACES.  03400000
034800     05  FILLER                      PIC  X(07)    VALUE          03410000
034900         'RETURNS'.                                               03420000
035000     05  FILLER                      PIC  X(19)    VALUE SPACES.  03430000
035100******************************************************************03440000
035200*  DETAIL LINE FOR REPORT 1                                       03450000
035300******************************************************************03460000
035400 01  D1-DETAIL-LINE-1.                                            03470000
035500     05  D1-STORE-NBR                PIC  X(04).                  03480000
036000     05  FILLER                      PIC  X(01)    VALUE SPACES.  03490000
035500     05  D1-ORG-STR-NBR              PIC  X(04).                  03500000
035600     05  FILLER                      PIC  X(01)    VALUE SPACES.  03510000
035700     05  D1-MERCHANT-NBR             PIC  X(15).                  03520000
035800     05  FILLER                      PIC  X(01)    VALUE SPACES.  03530000
035900     05  D1-RGST-ID                  PIC  X(04).                  03540000
036000     05  FILLER                      PIC  X(01)    VALUE SPACES.  03550000
036000*    05  FILLER                      PIC  X(02)    VALUE SPACES.  03560000
036100     05  D1-TRAN-NBR                 PIC  X(04).                  03570000
036200     05  FILLER                      PIC  X(01)    VALUE SPACES.  03580000
036200*    05  FILLER                      PIC  X(05)    VALUE SPACES.  03590000
052523     05  D1-ACCT-NBR                 PIC  X(18).                  03600000
052523     05  FILLER                      PIC  X(01)    VALUE SPACES.  03610000
036500     05  D1-PROCESSED-SALES          PIC  ZZ,ZZZ,ZZZ.99-.         03620000
036600     05  FILLER                      PIC  X(02)    VALUE SPACES.  03630000
036700     05  D1-UNPROCESSED-SALES        PIC  ZZ,ZZZ,ZZZ.99-.         03640000
036800     05  FILLER                      PIC  X(02)    VALUE SPACES.  03650000
036900     05  D1-PROCESSED-RETURNS        PIC  ZZ,ZZZ,ZZZ.99-.         03660000
037000     05  FILLER                      PIC  X(02)    VALUE SPACES.  03670000
037100     05  D1-UNPROCESSED-RETURNS      PIC  ZZ,ZZZ,ZZZ.99-.         03680000
037200                                                                  03690000
037300******************************************************************03700000
037400*  T1 TOTALS LINE REPORT 1                                       *03710000
037500******************************************************************03720000
037600 01  T1-TOTALS-LINE.                                              03730000
037700     05  T1-VAR-TOTAL-LINE           PIC  X(30).                  03740000
037800     05  FILLER                      PIC  X(22)    VALUE SPACES.  03750000
037900     05  T1-TOT-PROC-SALES           PIC  ZZZZZ,ZZZ,ZZZ.99-.      03760000
038000*    05  FILLER                      PIC  X(02)    VALUE SPACES.  03770000
038100     05  T1-TOT-UNPROC-SALES         PIC  ZZZZ,ZZZ,ZZZ.99-.       03780000
038200     05  FILLER                      PIC  X(02)    VALUE SPACES.  03790000
038300     05  T1-TOT-PROC-RETURNS         PIC  ZZ,ZZZ,ZZZ.99-.         03800000
038400     05  FILLER                      PIC  X(02)    VALUE SPACES.  03810000
038500     05  T1-TOT-UNPROC-RETURNS       PIC  ZZ,ZZZ,ZZZ.99-.         03820000
038600     05  FILLER                      PIC  X(16)    VALUE SPACES.  03830000
038700******************************************************************03840000
038800*  T2 TITLE FOR REPORT 2                                         *03850000
038900******************************************************************03860000
039000 01  T2-TITLE-LINE-1.                                             03870000
039100     05  FILLER                      PIC  X(46)    VALUE SPACES.  03880000
039200     05  T2-TITLE.                                                03890000
039300         10  FILLER                  PIC  X(06)    VALUE          03900000
039400         'DAILY '.                                                03910000
039500         10  T2-VAR-TITLE            PIC  X(12).                  03920000
039600         10  FILLER                  PIC  X(14)    VALUE          03930000
039700             ' TOTALS  FOR  '.                                    03940000
039800     05  T2-PROCESS-DTE              PIC  X(08)    VALUE SPACES.  03950000
039900     05  FILLER                      PIC  X(46)    VALUE SPACES.  03960000
040000                                                                  03970000
040100******************************************************************03980000
040200*  H1 COLUMN HEADINGS REPORT 2                                   *03990000
040300******************************************************************04000000
040400 01  H1-TOTALS-HEADING.                                           04010000
040500     05  FILLER                      PIC  X(33)    VALUE SPACES.  04020000
040600     05  FILLER                      PIC  X(09)    VALUE          04030000
040700         'PROCESSED'.                                             04040000
040800     05  FILLER                      PIC  X(03)    VALUE SPACES.  04050000
040900     05  FILLER                      PIC  X(11)    VALUE          04060000
041000         'UNPROCESSED'.                                           04070000
041100     05  FILLER                      PIC  X(04)    VALUE SPACES.  04080000
041200     05  FILLER                      PIC  X(09)    VALUE          04090000
041300         'PROCESSED'.                                             04100000
041400     05  FILLER                      PIC  X(02)    VALUE SPACES.  04110000
041500     05  FILLER                      PIC  X(11)    VALUE          04120000
041600         'UNPROCESSED'.                                           04130000
041700     05  FILLER                      PIC  X(06)    VALUE SPACES.  04140000
041800     05  FILLER                      PIC  X(09)    VALUE          04150000
041900         'PROCESSED'.                                             04160000
042000     05  FILLER                      PIC  X(05)    VALUE SPACES.  04170000
042100     05  FILLER                      PIC  X(11)    VALUE          04180000
042200         'UNPROCESSED'.                                           04190000
042300     05  FILLER                      PIC  X(13)    VALUE SPACES.  04200000
042400     05  FILLER                      PIC  X(03)    VALUE          04210000
042500         'NET'.                                                   04220000
042600     05  FILLER                      PIC  X(02)    VALUE SPACES.  04230000
042700******************************************************************04240000
042800*  H2 COLUMN HEADINGS REPORT 2                                   *04250000
042900******************************************************************04260000
043000 01  H2-TOTALS-HEADING.                                           04270000
043100     05  FILLER                      PIC  X(02)    VALUE SPACES.  04280000
043200     05  FILLER                      PIC  X(04)    VALUE          04290000
043300         'DATE'.                                                  04300000
043400     05  FILLER                      PIC  X(03)    VALUE SPACES.  04310000
043500     05  FILLER                      PIC  X(05)    VALUE          04320000
043600         'STORE'.                                                 04330000
043700     05  FILLER                      PIC  X(03)    VALUE SPACES.  04340000
043800     05  FILLER                      PIC  X(08)    VALUE          04350000
043900         'MERCHANT'.                                              04360000
044000     05  FILLER                      PIC  X(11)    VALUE SPACES.  04370000
044100     05  FILLER                      PIC  X(05)    VALUE          04380000
044200         'SALES'.                                                 04390000
044300     05  FILLER                      PIC  X(08)    VALUE SPACES.  04400000
044400     05  FILLER                      PIC  X(05)    VALUE          04410000
044500         'SALES'.                                                 04420000
044600     05  FILLER                      PIC  X(07)    VALUE SPACES.  04430000
044700     05  FILLER                      PIC  X(07)    VALUE          04440000
044800         'RETURNS'.                                               04450000
044900     05  FILLER                      PIC  X(05)    VALUE SPACES.  04460000
045000     05  FILLER                      PIC  X(07)    VALUE          04470000
045100         'RETURNS'.                                               04480000
045200     05  FILLER                      PIC  X(08)    VALUE SPACES.  04490000
045300     05  FILLER                      PIC  X(10)    VALUE          04500000
045400         'NET TOTALS'.                                            04510000
045500     05  FILLER                      PIC  X(05)    VALUE SPACES.  04520000
045600     05  FILLER                      PIC  X(10)    VALUE          04530000
045700         'NET TOTALS'.                                            04540000
045800     05  FILLER                      PIC  X(012)   VALUE SPACES.  04550000
045900     05  FILLER                      PIC  X(06)    VALUE          04560000
046000         'TOTALS'.                                                04570000
046100******************************************************************04580000
046200*  D2 DETAIL LINE FOR REPORT 2                                    04590000
046300******************************************************************04600000
046400 01  D2-DETAIL-LINE-1.                                            04610000
046500     05  D2-DATE                     PIC  X(08).                  04620000
046600     05  FILLER                      PIC  X(01)    VALUE SPACES.  04630000
046700     05  D2-STORE-NBR                PIC  X(04).                  04640000
046800     05  FILLER                      PIC  X(01)    VALUE SPACES.  04650000
046900     05  D2-MERCHANT-NBR             PIC  X(15).                  04660000
047000*    05  FILLER                      PIC  X(01)    VALUE SPACES.  04670000
047100     05  D2-PROCESSED-SALES          PIC  ZZ,ZZZ,ZZZ.99-.         04680000
047200*    05  FILLER                      PIC  X(01)    VALUE SPACES.  04690000
047300     05  D2-UNPROCESSED-SALES        PIC  ZZ,ZZZ,ZZZ.99-.         04700000
047400     05  FILLER                      PIC  X(02)    VALUE SPACES.  04710000
047500     05  D2-PROCESSED-RETURNS        PIC  ZZZ,ZZZ.99-.            04720000
047600     05  FILLER                      PIC  X(01)    VALUE SPACES.  04730000
047700     05  D2-UNPROCESSED-RETURNS      PIC  ZZZ,ZZZ.99-.            04740000
047800     05  FILLER                      PIC  X(01)    VALUE SPACES.  04750000
047900     05  D2-PROC-NET-TOTALS          PIC  ZZZ,ZZZ,ZZZ.99-.        04760000
048000     05  FILLER                      PIC  X(02)    VALUE SPACES.  04770000
048100     05  D2-UNPROC-NET-TOTALS        PIC  ZZ,ZZZ,ZZZ.99-.         04780000
048200     05  FILLER                      PIC  X(01)    VALUE SPACES.  04790000
048300     05  D2-NET-TOTALS               PIC  Z,ZZZ,ZZZ,ZZZ.99-.      04800000
048400                                                                  04810000
048500******************************************************************04820000
048600*  T2 DETAIL LINE FOR REPORT 2                                    04830000
048700******************************************************************04840000
048800 01  T2-TOTALS-LINE-1.                                            04850000
048900     05  T2-VAR-TOTAL-LINE           PIC  X(26).                  04860000
049000     05  T2-PROCESSED-SALES          PIC  ZZZZZ,ZZZ,ZZZ.99-.      04870000
049100*    05  FILLER                      PIC  X(01)    VALUE SPACES.  04880000
049200     05  T2-UNPROCESSED-SALES        PIC  ZZZZZZ,ZZZ.99-.         04890000
049300*    05  FILLER                      PIC  X(01)    VALUE SPACES.  04900000
049400     05  T2-PROCESSED-RETURNS        PIC  ZZZZZ,ZZZ.99-.          04910000
049500*    05  FILLER                      PIC  X(01)    VALUE SPACES.  04920000
049600     05  T2-UNPROCESSED-RETURNS      PIC  ZZZZ,ZZZ.99-.           04930000
049700*    05  FILLER                      PIC  X(01)    VALUE SPACES.  04940000
049800     05  T2-PROC-NET-TOTALS          PIC  ZZZZ,ZZZ,ZZZ.99-.       04950000
049900*    05  FILLER                      PIC  X(01)    VALUE SPACES.  04960000
050000     05  T2-UNPROC-NET-TOTALS        PIC  ZZZZ,ZZZ,ZZZ.99-.       04970000
050100*    05  FILLER                      PIC  X(01)    VALUE SPACES.  04980000
050200     05  T2-NET-TOTALS               PIC  ZZ,ZZZ,ZZZ,ZZZ.99-.     04990000
050300                                                                  05000000
050400 01  P1-PROCESS-DATE-LINE.                                        05010000
050500     05  FILLER                      PIC  X(16)   VALUE           05020000
050600         'PROCESSING FOR  '.                                      05030000
050700     05  P1-DATE                     PIC  X(08).                  05040000
050800     05  FILLER                      PIC  X(108)   VALUE SPACES.  05050000
050900                                                                  05060000
051000 01  SPACE-REPORT-LINE.                                           05070000
051100     05  FILLER                      PIC  X(132)   VALUE SPACES.  05080000
051200                                                                  05090000
051300 01  NO-INPUT-LINE.                                               05100000
051400     05  FILLER                      PIC  X(27)    VALUE          05110000
051500         'NO SETTLEMENT RECORDS TODAY'.                           05120000
051600     05  FILLER                      PIC  X(105)   VALUE SPACES.  05130000
051700                                                                  05140000
051800 PROCEDURE DIVISION.                                              05150000
051900                                                                  05160000
052000******************************************************************05170000
052100* 0000-MAINLINE-PARAGRAPH                                         05180000
052200******************************************************************05190000
052300 0000-MAINLINE-PARAGRAPH.                                         05200000
052400                                                                  05210000
052500     PERFORM 1000-INITIALIZE-PROGRAM.                             05220000
052600                                                                  05230000
052700     IF PS-END-OF-CREDIT-FILE                                     05240000
052800         SET NO-INPUT-TODAY      TO TRUE                          05250000
052900     ELSE                                                         05260000
053000         MOVE TC008-RGST-ID      TO PV-SV-RGST-ID                 05270000
053100         MOVE TC008-STR-NBR      TO PV-SV-STR-NBR                 05280000
053100         MOVE TC008-ORG-STR-NBR  TO PV-ORG-STR-NBR                05290000
053200         MOVE TC008-TRN-DTE      TO PV-SV-TRN-DTE                 05300000
053300         PERFORM 2000-PROCESS                                     05310000
053400             UNTIL PS-END-OF-CREDIT-FILE                          05320000
053500     END-IF.                                                      05330000
053600                                                                  05340000
053700     IF NO-INPUT-TODAY                                            05350000
053800         WRITE AUDIT-REPORT-REC                                   05360000
053900         FROM NO-INPUT-LINE                                       05370000
054000         AFTER ADVANCING 2 LINE                                   05380000
054100         WRITE TOTALS-REPORT-REC                                  05390000
054200         FROM NO-INPUT-LINE                                       05400000
054300         AFTER ADVANCING 2 LINE                                   05410000
054400     ELSE                                                         05420000
054500         PERFORM 3000-WRITE-FINAL-LINES                           05430000
054600     END-IF.                                                      05440000
054700                                                                  05450000
054800     CLOSE CONTROL-DATE-FILE                                      05460000
054900           CREDIT-REPORT-FILE                                     05470000
055000           AUDIT-REPORT                                           05480000
092223           TOTALS-REPORT                                          05491002
092223           TRAN-PRCD-FILE.                                        05492002
055200                                                                  05500000
055300     GOBACK.                                                      05510000
055400                                                                  05520000
055500******************************************************************05530000
055600* 1000-INITIALIZE-PROGRAM                                         05540000
055700*     OPEN FILES, PROCESS CONTROL CARD                            05550000
055800******************************************************************05560000
055900 1000-INITIALIZE-PROGRAM.                                         05570000
056000                                                                  05580000
056100     OPEN INPUT  CONTROL-DATE-FILE                                05590000
056200                 CREDIT-REPORT-FILE                               05600000
056300          OUTPUT AUDIT-REPORT                                     05610000
092223                 TOTALS-REPORT                                    05621002
092223                 TRAN-PRCD-FILE.                                  05622002
056500                                                                  05630000
056600     READ CONTROL-DATE-FILE INTO CC-CONTROL-CARD                  05640000
056700        AT END                                                    05650000
056800           SET PS-END-OF-CONTROL-FILE TO TRUE.                    05660000
056900                                                                  05670000
057000     IF PS-END-OF-CONTROL-FILE                                    05680000
057100        DISPLAY 'DATE CARD MISSING '                              05690000
057200        MOVE '1000-INITIALIZE-PROGRAM ' TO PV-PARAGRAPH-NAME      05700000
057300        SET AC-CONTROL-CARD-ERROR TO TRUE                         05710000
057400        PERFORM 9999-ABEND                                        05720000
057500     ELSE                                                         05730000
057600        DISPLAY PC-PROGRAM-NAME ' CONTROL DATE:  '                05740000
057700             CC-POS-DATE-MMDDYY                                   05750000
057800        MOVE CC-POS-DATE-MMDDYY TO PV-MMDDYY-DATE                 05760000
057900        MOVE PV-MMDDYY-YY    TO PV-FMT-YY                         05770000
058000        MOVE PV-MMDDYY-MM    TO PV-FMT-MM                         05780000
058100        MOVE PV-MMDDYY-DD    TO PV-FMT-DD                         05790000
058200        MOVE PV-FMT-DATE     TO T1-PROCESS-DTE                    05800000
058300        MOVE PV-FMT-DATE     TO T2-PROCESS-DTE                    05810000
058400     END-IF.                                                      05820000
058500                                                                  05830000
058600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              05840000
058700                                                                  05850000
058800     SET  DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                   05860000
058900     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                   05870000
059000     SET  DPG52-LK-DTE-GREG            TO TRUE.                   05880000
059100     MOVE CC-POS-DATE-MMDDYY           TO DPG52-LK-DATE-INPUT.    05890000
059200     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    05900000
059300                                             DPG54 DPG55 DPG56.   05910000
059400     EVALUATE TRUE                                                05920000
059500         WHEN DPG54-SEVERE-ERROR                                  05930000
059600         WHEN DPG54-DATE-INVALID                                  05940000
059700             MOVE '1000-PROCESS-DATE-CARD'                        05950000
059800                                           TO PV-PARAGRAPH-NAME   05960000
059900             MOVE 'ERROR CONVERTING INPUT CARD DATE'              05970000
060000                                           TO PV-OPERATION-MSG-1  05980000
060100             SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                05990000
060200             MOVE DPG54-ERROR-MESSAGE      TO PV-OPERATION-MSG-2  06000000
060300             PERFORM 9999-ABEND                                   06010000
060400     END-EVALUATE.                                                06020000
060500                                                                  06030000
060600     MOVE DPG55-DB2-ISO-DATE-FMT       TO PV-POS-CCYY-MM-DD.      06040000
060700                                                                  06050000
060800******************************************************************06060000
060900* PRIMING READ NEEDED HERE TO IDENTIFY THE REPORT NUMBER AND      06070000
061000*     REPORT HEAADINGS FOR THE REPORTS.                           06080000
061100******************************************************************06090000
061200     PERFORM 8000-READ-CREDIT-FILE.                               06100000
061300                                                                  06110000
061400     PERFORM 7000-FORMAT-HEADINGS.                                06120000
061500                                                                  06130000
061600     INITIALIZE PV-WRK-TOTALS                                     06140000
061700                PV-REG-TOTALS                                     06150000
061800                PV-DTE-TOTALS                                     06160000
061900                PV-STR-TOTALS                                     06170000
062000                PV-NET-TOTALS                                     06180000
062100                PV-GRND-TOTALS.                                   06190000
062200                                                                  06200000
062300     SET INPUT-TODAY             TO TRUE.                         06210000
062400     SET PS-RGST-1ST-LINE        TO TRUE.                         06220000
062500     SET PS-STR-1ST-LINE         TO TRUE.                         06230000
062600***************************************************************** 06240000
062700* 2000-PROCESS                                                    06250000
062800*        PROCESS THROUGH THE CREDIT REPORT RECORDS WITH           06260000
062900* CONTROL BREAKS ON DATE.                                         06270000
063000* NO DETAIL LINES ARE CREATED ONLY TOTALS OF TYPES 110/111/112    06280000
063100* AND THE TOTAL COMBINE OF ALL REC TYPES                          06290000
063200***************************************************************** 06300000
063300 2000-PROCESS.                                                    06310000
063400                                                                  06320000
063500     IF TC008-TRN-DTE         =  PV-SV-TRN-DTE                    06330000
063600         IF TC008-STR-NBR     =  PV-SV-STR-NBR                    06340000
063700             IF TC008-RGST-ID =  PV-SV-RGST-ID                    06350000
063800                 PERFORM 6100-CREATE-AUDIT-DETAIL-LINE            06360000
063900             ELSE                                                 06370000
064000                 SET PS-RGST-1ST-LINE                             06380000
064100                                 TO TRUE                          06390000
064200                 PERFORM 6200-CREATE-AUDIT-REG-TOTAL              06400000
064300                 PERFORM 6300-ADD-TO-STORE-TOTALS                 06410000
064400                 MOVE TC008-RGST-ID                               06420000
064500                                 TO PV-SV-RGST-ID                 06430000
064500                 MOVE TC008-ORG-STR-NBR TO PV-ORG-STR-NBR         06440000
064600                 PERFORM 6400-NEW-REGISTER                        06450000
064700             END-IF                                               06460000
064800         ELSE                                                     06470000
064900             SET PS-RGST-1ST-LINE                                 06480000
065000                                 TO TRUE                          06490000
065100             PERFORM 6200-CREATE-AUDIT-REG-TOTAL                  06500000
065200             PERFORM 6300-ADD-TO-STORE-TOTALS                     06510000
065300             PERFORM 6500-CREATE-STORE-TOTALS                     06520000
065400             PERFORM 6600-ADD-TO-DATE-TOTALS                      06530000
065500             PERFORM 5000-CREATE-RPT2-STR-TOTALS                  06540000
065600             MOVE TC008-STR-NBR  TO PV-SV-STR-NBR                 06550000
067100             MOVE TC008-ORG-STR-NBR  TO PV-ORG-STR-NBR            06560000
065700             MOVE TC008-RGST-ID  TO PV-SV-RGST-ID                 06570000
065800             PERFORM 6700-NEW-STORE                               06580000
065900         END-IF                                                   06590000
066000     ELSE                                                         06600000
066100         SET PS-RGST-1ST-LINE    TO TRUE                          06610000
066200         PERFORM 6200-CREATE-AUDIT-REG-TOTAL                      06620000
066300         PERFORM 6300-ADD-TO-STORE-TOTALS                         06630000
066400         PERFORM 6500-CREATE-STORE-TOTALS                         06640000
066500         PERFORM 6600-ADD-TO-DATE-TOTALS                          06650000
066600         PERFORM 5000-CREATE-RPT2-STR-TOTALS                      06660000
066700         PERFORM 6900-CREATE-DATE-TOTALS                          06670000
066800         PERFORM 5100-CREATE-RPT2-DATE-TOTALS                     06680000
066900         PERFORM 6800-ADD-TO-GRAND-TOTALS                         06690000
067000         MOVE TC008-TRN-DTE      TO PV-SV-TRN-DTE                 06700000
067100         MOVE TC008-STR-NBR      TO PV-SV-STR-NBR                 06710000
067100         MOVE TC008-ORG-STR-NBR  TO PV-ORG-STR-NBR                06711000
067200         MOVE TC008-RGST-ID      TO PV-SV-RGST-ID                 06712000
067300***************************************************************** 06713000
067400* PAGE BREAK FOR NEW DATE                                         06714000
067500***************************************************************** 06715000
067600         PERFORM 7010-WRITE-REPORT1-HEADING                       06716000
067700         PERFORM 4000-NEW-DATE                                    06717000
067800     END-IF.                                                      06718000
067900                                                                  06719000
068000     PERFORM 8000-READ-CREDIT-FILE.                               06720000
068100                                                                  06730000
068200***************************************************************** 06740000
068300*  3000-WRITE-FINAL-LINES.                                        06750000
068400*        MOVE AND WRITE THE FINAL REPORT LINES FOR EOF OF INPUT   06760000
068500***************************************************************** 06770000
068600 3000-WRITE-FINAL-LINES.                                          06780000
068700                                                                  06790000
068800     PERFORM 6200-CREATE-AUDIT-REG-TOTAL.                         06800000
068900     PERFORM 6300-ADD-TO-STORE-TOTALS                             06810000
069000     PERFORM 6500-CREATE-STORE-TOTALS.                            06820000
069100     PERFORM 6600-ADD-TO-DATE-TOTALS                              06830000
069200     PERFORM 6900-CREATE-DATE-TOTALS.                             06840000
069300     PERFORM 5000-CREATE-RPT2-STR-TOTALS.                         06850000
069400     PERFORM 5100-CREATE-RPT2-DATE-TOTALS.                        06860000
069500     PERFORM 6800-ADD-TO-GRAND-TOTALS.                            06870000
069600     PERFORM 3100-CREATE-GRAND-TOTALS.                            06880000
069700                                                                  06890000
069800***************************************************************** 06900000
069900*  3100-CREATE-GRAND-TOTALS                                       06910000
070000*        MOVE THE GRAND TOTAL TO TOTALS REPORT LINE               06920000
070100***************************************************************** 06930000
070200 3100-CREATE-GRAND-TOTALS.                                        06940000
070300                                                                  06950000
070400     MOVE PV-T2-TOT-GRAND        TO T2-VAR-TOTAL-LINE.            06960000
070500     MOVE PV-GRND-PROC-SALES     TO T2-PROCESSED-SALES.           06970000
070600     MOVE PV-GRND-UNPROC-SALES   TO T2-UNPROCESSED-SALES.         06980000
070700     MOVE PV-GRND-PROC-RETURNS   TO T2-PROCESSED-RETURNS.         06990000
070800     MOVE PV-GRND-UNPROC-RETURNS TO T2-UNPROCESSED-RETURNS.       07000000
070900                                                                  07010000
071000     COMPUTE  PV-NET-PROC  =                                      07020000
071100         (PV-GRND-PROC-SALES  - PV-GRND-PROC-RETURNS).            07030000
071200                                                                  07040000
071300     COMPUTE  PV-NET-UNPROC  =                                    07050000
071400         (PV-GRND-UNPROC-SALES  -  PV-GRND-UNPROC-RETURNS).       07060000
071500     COMPUTE PV-NET-TOTAL   =                                     07070000
071600         (PV-NET-PROC  +  PV-NET-UNPROC).                         07080000
071700                                                                  07090000
071800     MOVE PV-NET-PROC            TO T2-PROC-NET-TOTALS.           07100000
071900     MOVE PV-NET-UNPROC          TO T2-UNPROC-NET-TOTALS.         07110000
072000     MOVE PV-NET-TOTAL           TO T2-NET-TOTALS.                07120000
072100                                                                  07130000
072200     PERFORM 3120-WRITE-GRAND-TOTALS.                             07140000
072300                                                                  07150000
072400***************************************************************** 07160000
072500*  3120-WRITE-GRAND-TOTALS.                                       07170000
072600*        WRITE GRAND TOTALS LINE ON TOTALS REPORT                 07180000
072700***************************************************************** 07190000
072800 3120-WRITE-GRAND-TOTALS.                                         07200000
072900                                                                  07210000
073000      IF PV-R2-LINE-CNT   >  60                                   07220000
073100          PERFORM 7020-WRITE-REPORT2-HEADING                      07230000
073200      END-IF.                                                     07240000
073300                                                                  07250000
073400      WRITE TOTALS-REPORT-REC                                     07260000
073500       FROM  T2-TOTALS-LINE-1                                     07270000
073600       AFTER ADVANCING 2 LINE.                                    07280000
073700                                                                  07290000
073800      ADD  +2                    TO PV-R2-LINE-CNT.               07300000
073900                                                                  07310000
074000***************************************************************** 07320000
074100*  4000-NEW-DATE.                                                 07330000
074200*        CONTROL BREAK ON TRAN DATE                               07340000
074300***************************************************************** 07350000
074400 4000-NEW-DATE.                                                   07360000
074500                                                                  07370000
074600     INITIALIZE PV-REG-TOTALS                                     07380000
074700                PV-STR-TOTALS                                     07390000
074800                PV-DTE-TOTALS.                                    07400000
074900                                                                  07410000
075000     PERFORM 6100-CREATE-AUDIT-DETAIL-LINE.                       07420000
075100                                                                  07430000
075200***************************************************************** 07440000
075300*  5000-CREATE-RPT2-STR-TOTALS.                                   07450000
075400*        MOVE OF STORE TOTAL CONTROL BREAK TO TOTALS REPORT       07460000
075500***************************************************************** 07470000
075600 5000-CREATE-RPT2-STR-TOTALS.                                     07480000
075700                                                                  07490000
075800     IF PS-STR-1ST-LINE                                           07500000
075900         MOVE PV-SV-RPT-DATE     TO  D2-DATE                      07510000
076000         SET PS-NOT-STR-1ST-LINE TO TRUE                          07520000
076100     ELSE                                                         07530000
076200         MOVE SPACES             TO  D2-DATE                      07540000
076300     END-IF.                                                      07550000
076400                                                                  07560000
076500     MOVE PV-SV-STR-NBR          TO D2-STORE-NBR.                 07570000
           IF PV-SV-MERCHANT-NBR-2 = ZEROES                             07580000
086900         MOVE PV-SV-MERCHANT-NBR-13  TO D2-MERCHANT-NBR           07590000
           ELSE                                                         07600000
076600         MOVE PV-SV-MERCHANT-NBR     TO D2-MERCHANT-NBR           07610000
           END-IF.                                                      07620000
076700     MOVE PV-STR-PROC-SALES      TO D2-PROCESSED-SALES.           07630000
076800     MOVE PV-STR-UNPROC-SALES    TO D2-UNPROCESSED-SALES.         07640000
076900     MOVE PV-STR-PROC-RETURNS    TO D2-PROCESSED-RETURNS.         07650000
077000     MOVE PV-STR-UNPROC-RETURNS  TO D2-UNPROCESSED-RETURNS.       07660000
077100                                                                  07670000
077200     COMPUTE  PV-NET-PROC  =                                      07680000
077300         (PV-STR-PROC-SALES  - PV-STR-PROC-RETURNS).              07690000
077400                                                                  07700000
077500     COMPUTE  PV-NET-UNPROC  =                                    07710000
077600         (PV-STR-UNPROC-SALES   - PV-STR-UNPROC-RETURNS).         07720000
077700     COMPUTE PV-NET-TOTAL   =                                     07730000
077800         (PV-NET-PROC  +  PV-NET-UNPROC).                         07740000
077900                                                                  07750000
078000     MOVE PV-NET-PROC            TO D2-PROC-NET-TOTALS.           07760000
078100     MOVE PV-NET-UNPROC          TO D2-UNPROC-NET-TOTALS.         07770000
078200     MOVE PV-NET-TOTAL           TO D2-NET-TOTALS.                07780000
078300                                                                  07790000
078400     PERFORM 5020-WRITE-TOTALS-DETAIL-LINE.                       07800000
078500                                                                  07810000
078600***************************************************************** 07820000
078700*  5020-WRITE-TOTALS-DETAIL-LINE.                                 07830000
078800*        MOVE DETAIL LINE ON TOTALS REPORT                        07840000
078900***************************************************************** 07850000
079000 5020-WRITE-TOTALS-DETAIL-LINE.                                   07860000
079100                                                                  07870000
079200      IF PV-R2-LINE-CNT   >  60                                   07880000
079300          PERFORM 7020-WRITE-REPORT2-HEADING                      07890000
079400          MOVE PV-SV-RPT-DATE     TO  D2-DATE                     07900000
079500      END-IF.                                                     07910000
079600                                                                  07920000
079700      WRITE TOTALS-REPORT-REC                                     07930000
079800       FROM  D2-DETAIL-LINE-1                                     07940000
079900       AFTER ADVANCING 1 LINE.                                    07950000
080000                                                                  07960000
080100      ADD  +1                    TO PV-R2-LINE-CNT.               07970000
080200                                                                  07980000
080300***************************************************************** 07990000
080400*  5100-CREATE-RPT2-DATE-TOTALS.                                  08000000
080500*        MOVE DATE CONTROL BREAK TOTALS TO TOTALS REPORT          08010000
080600***************************************************************** 08020000
080700 5100-CREATE-RPT2-DATE-TOTALS.                                    08030000
080800                                                                  08040000
080900     MOVE PV-SV-RPT-DATE         TO PV-T2-TOT-DATE.               08050000
081000     MOVE PV-T2-TOT-ALL-STORE    TO T2-VAR-TOTAL-LINE.            08060000
081100     MOVE PV-DTE-PROC-SALES      TO T2-PROCESSED-SALES.           08070000
081200     MOVE PV-DTE-UNPROC-SALES    TO T2-UNPROCESSED-SALES.         08080000
081300     MOVE PV-DTE-PROC-RETURNS    TO T2-PROCESSED-RETURNS.         08090000
081400     MOVE PV-DTE-UNPROC-RETURNS  TO T2-UNPROCESSED-RETURNS.       08100000
081500                                                                  08110000
081600     COMPUTE  PV-NET-PROC  =                                      08120000
081700         (PV-DTE-PROC-SALES  - PV-DTE-PROC-RETURNS).              08130000
081800                                                                  08140000
081900     COMPUTE  PV-NET-UNPROC  =                                    08150000
082000         (PV-DTE-UNPROC-SALES   - PV-DTE-UNPROC-RETURNS).         08160000
082100     COMPUTE PV-NET-TOTAL   =                                     08170000
082200         (PV-NET-PROC  +  PV-NET-UNPROC).                         08180000
082300                                                                  08190000
082400     MOVE PV-NET-PROC            TO T2-PROC-NET-TOTALS.           08200000
082500     MOVE PV-NET-UNPROC          TO T2-UNPROC-NET-TOTALS.         08210000
082600     MOVE PV-NET-TOTAL           TO T2-NET-TOTALS.                08220000
082700                                                                  08230000
082800     PERFORM 5120-WRITE-TOTALS-STORE-LINE.                        08240000
082900                                                                  08250000
083000     SET PS-STR-1ST-LINE         TO TRUE.                         08260000
083100                                                                  08270000
083200***************************************************************** 08280000
083300*  5120-WRITE-TOTALS-STORE-LINE.                                  08290000
083400*        WRITE DATE CONTROL BREAK TOTALS TO TOTALS REPORT         08300000
083500***************************************************************** 08310000
083600 5120-WRITE-TOTALS-STORE-LINE.                                    08320000
083700                                                                  08330000
083800      IF PV-R2-LINE-CNT   >  60                                   08340000
083900          PERFORM 7020-WRITE-REPORT2-HEADING                      08350000
084000      END-IF.                                                     08360000
084100                                                                  08370000
084200      WRITE TOTALS-REPORT-REC                                     08380000
084300       FROM  SPACE-REPORT-LINE                                    08390000
084400       AFTER ADVANCING 1 LINE.                                    08400000
084500                                                                  08410000
084600      WRITE TOTALS-REPORT-REC                                     08420000
084700       FROM  T2-TOTALS-LINE-1                                     08430000
084800       AFTER ADVANCING 1 LINE.                                    08440000
084900                                                                  08450000
085000      WRITE TOTALS-REPORT-REC                                     08460000
085100       FROM  SPACE-REPORT-LINE                                    08470000
085200       AFTER ADVANCING 1 LINE.                                    08480000
085300                                                                  08490000
085400      ADD  +3                    TO PV-R2-LINE-CNT.               08500000
085500                                                                  08510000
085600***************************************************************** 08520000
085700* 6100-CREATE-AUDIT-DETAIL-LINE                                   08530000
085800*        FILL DETAIL FIELDS FOR AUDIT REPORT TO PRINT ON REPORT   08540000
085900*                                                                 08550000
086000* 1ST LINE SWITCH SETUP TO MOVE SPACES TO FIELDS WHEN NOT NEEDED  08560000
086100***************************************************************** 08570000
086200 6100-CREATE-AUDIT-DETAIL-LINE.                                   08580000
086300                                                                  08590000
086400     IF PS-RGST-1ST-LINE                                          08600000
086500         MOVE PV-SV-STR-NBR      TO  D1-STORE-NBR                 08610000
035500         MOVE PV-ORG-STR-NBR     TO  D1-ORG-STR-NBR               08620000
               EVALUATE TC008-TNDR-TYP-CDE                              08630000
                 WHEN '05'                                              08640000
086700              MOVE TC008-MERCHANT-NBR TO  PV-SV-MERCHANT-NBR      08650000
                    IF PV-SV-MERCHANT-NBR-2 = ZEROES                    08650100
086900                MOVE PV-SV-MERCHANT-NBR-13 TO  D1-MERCHANT-NBR    08650200
                    END-IF                                              08650300
                 WHEN '06'                                              08650400
086700              MOVE TC008-MERCHANT-NBR TO  PV-SV-MERCHANT-NBR      08650500
                    IF PV-SV-MERCHANT-NBR-2 = ZEROES                    08650600
086900                MOVE PV-SV-MERCHANT-NBR-13 TO  D1-MERCHANT-NBR    08650700
                    END-IF                                              08650800
                 WHEN '08'                                              08650900
                    MOVE TC008-MERCHANT-NBR   TO PV-MERCHANT-NBR-A      08651000
                    MOVE PV-AMEX-MERCHANT-NBR TO D1-MERCHANT-NBR        08652000
                    MOVE TC008-MERCHANT-NBR   TO PV-SV-MERCHANT-NBR     08653000
                 WHEN '07'                                              08654000
                    MOVE TC008-MERCHANT-NBR TO D1-MERCHANT-NBR          08655000
                                               PV-SV-MERCHANT-NBR       08656000
052523           WHEN '24'                                              08656100
052523              MOVE TC008-MERCHANT-NBR TO D1-MERCHANT-NBR          08656200
052523                                         PV-SV-MERCHANT-NBR       08656300
052523           WHEN '25'                                              08656400
052523              MOVE TC008-MERCHANT-NBR TO D1-MERCHANT-NBR          08656500
052523                                         PV-SV-MERCHANT-NBR       08656600
                 WHEN OTHER                                             08657000
                    MOVE TC008-MERCHANT-NBR TO D1-MERCHANT-NBR          08658000
                                               PV-SV-MERCHANT-NBR       08659000
               END-EVALUATE                                             08660000
087200         MOVE TC008-RGST-ID      TO  D1-RGST-ID                   08670000
087300         SET PS-NOT-RGST-1ST-LINE                                 08680000
087400                                 TO TRUE                          08690000
087500     ELSE                                                         08700000
087600         MOVE SPACES             TO  D1-STORE-NBR                 08710000
087700         MOVE SPACES             TO  D1-MERCHANT-NBR              08720000
087800         MOVE SPACES             TO  D1-RGST-ID                   08730000
087900     END-IF.                                                      08740000
088000                                                                  08750000
           EVALUATE TC008-TNDR-TYP-CDE                                  08760000
              WHEN '05'                                                 08770000
088200           MOVE TC008-ACCT-NBR       TO  PV-CARD-NUMBER           08780000
088200           MOVE 'XXXXXXXXXXXX'       TO  PV-SPACE-CARD-NUMBER     08790000
088200           MOVE PV-CARD-NUMBER       TO  D1-ACCT-NBR              08800000
              WHEN '06'                                                 08801000
088200           MOVE TC008-ACCT-NBR       TO  PV-CARD-NUMBER           08802000
088200           MOVE 'XXXXXXXXXXXX'       TO  PV-SPACE-CARD-NUMBER     08803000
088200           MOVE PV-CARD-NUMBER       TO  D1-ACCT-NBR              08804000
              WHEN '07'                                                 08805000
088200           MOVE TC008-ACCT-NBR       TO  PV-CARD-NUMBER           08806000
088233           MOVE 'XXXXXXXXXXXX'       TO  PV-SPACE-CARD-NUMBER     08807000
088200           MOVE PV-CARD-NUMBER       TO  D1-ACCT-NBR              08808000
              WHEN '08'                                                 08809000
088200           MOVE TC008-ACCT-NBR       TO  PV-CARD-NUMBER-A         08809100
088200           MOVE 'XXXXXXXXXXX'        TO  PV-SPACE-CARD-NBR-A      08809200
088200           MOVE PV-CARD-NUMBER-A     TO  D1-ACCT-NBR              08809300
052523        WHEN '24'                                                 08809400
052523           MOVE TC008-ACCT-NBR       TO  PV-CARD-NUMBER           08809500
052523           MOVE 'XXXXXXXXXXXX'       TO  PV-SPACE-CARD-NUMBER     08809600
052523           MOVE PV-CARD-NUMBER       TO  D1-ACCT-NBR              08809700
052523        WHEN '25'                                                 08811200
052523               MOVE TC008-ACCT-NBR   TO  PV-TRL-CARD-NUMBER       08812300
052523               MOVE 'XXXXXXXX'       TO  PV-SPACE-TRL-CARD-NUMBER 08812400
052523               MOVE SPACES           TO  PV-TRL-EMPTY             08812500
052523               MOVE PV-TRL-CARD-NUMBER                            08812600
052523                                     TO  D1-ACCT-NBR              08812700
              WHEN OTHER                                                08812900
088200           MOVE TC008-ACCT-NBR       TO  PV-CARD-NUMBER           08813000
088200           MOVE 'XXXXXXXXXXXX'       TO  PV-SPACE-CARD-NUMBER     08813100
088200           MOVE PV-CARD-NUMBER       TO  D1-ACCT-NBR              08813200
           END-EVALUATE.                                                08813300
088400                                                                  08813400
088100     MOVE TC008-TRN-NBR          TO  D1-TRAN-NBR.                 08814000
088100     MOVE TC008-ORG-STR-NBR      TO  D1-ORG-STR-NBR.              08820000
088300     INITIALIZE     PV-WRK-TOTALS.                                08830000
088400                                                                  08840000
      * SIGN IN SETTLE RECORD IS SET IN TCKUT010 FOR VOIDS TO HAVE      08841000
      * CORRECT VALUE WHEN SENDING TO THE BANK                          08842000
088500     IF TC008-SETTLED                                             08843000
088600         IF TC008-VOID-ABRT-CDE  = 'V'                            08844000
088700             EVALUATE TC008-TRN-TYP-CDE                           08845000
088800                 WHEN '01'                                        08846000
088900                     MOVE TC008-TNDR-AMT                          08847000
088900                                 TO PV-WRK-PROC-SALES             08848000
088800                 WHEN '02'                                        08848100
088900                     MOVE TC008-TNDR-AMT                          08848200
088900                                 TO PV-WRK-PROC-SALES             08848300
089100                 WHEN '11'                                        08849000
089200                     COMPUTE PV-WRK-PROC-RETURNS  =               08850000
089000                                     (TC008-TNDR-AMT * -1)        08860000
089100                 WHEN '12'                                        08870000
089200                     COMPUTE PV-WRK-PROC-RETURNS  =               08880000
089000                                     (TC008-TNDR-AMT * -1)        08890000
089300                 WHEN '23'                                        08900000
089400                 WHEN '24'                                        08910000
125703                 WHEN '25'                                        08911000
089500                     IF TC008-TNDR-AMT > 0                        08920000
090000                         COMPUTE PV-WRK-PROC-RETURNS =            08930000
089000                                     (TC008-TNDR-AMT * -1)        08940000
089800                     ELSE                                         08950000
089700                         MOVE TC008-TNDR-AMT                      08960000
089600                                         TO PV-WRK-PROC-SALES     08970000
090100                     END-IF                                       08980000
POA                    WHEN '30'                                        08981000
POA                        MOVE TC008-TNDR-AMT                          08982000
POA                                    TO PV-WRK-PROC-SALES             08983000
POA                    WHEN OTHER                                       08984000
POA                        MOVE TC008-TNDR-AMT                          08985000
POA                                    TO PV-OTHER                      08986000
POA                        DISPLAY 'PV-OTHER - SETTLED VOID '           08987000
POA                        DISPLAY 'TC008-TRN-TYP-CDE '                 08987100
POA                                 TC008-TRN-TYP-CDE                   08987200
POA                        MOVE TC008-PARTN-NBR TO PV-PARTN-NBR         08987300
POA                        MOVE TC008-STR-NBR   TO PV-STR-NBR           08987400
POA                        MOVE TC008-RGST-ID   TO PV-RGST-ID           08987500
POA                        MOVE TC008-TRN-NBR   TO PV-TRN-NBR           08987600
POA                        MOVE TC008-TNDR-AMT  TO PV-TNDR-AMT          08987700
POA                        DISPLAY 'PV-PARTN-NBR ' PV-PARTN-NBR         08987800
POA                        DISPLAY 'PV-STR-NBR ' PV-STR-NBR             08987900
POA                        DISPLAY 'PV-RGST-ID  ' PV-RGST-ID            08988000
POA                        DISPLAY 'PV-TRN-NBR ' PV-TRN-NBR             08988100
POA                        DISPLAY 'PV-TNDR-AMT ' PV-TNDR-AMT           08988800
POA                        MOVE '6100-CREATE-AUDIT-DETAIL-LINE'         08989000
POA                                              TO PV-PARAGRAPH-NAME   08989100
POA                        MOVE 'TC008-TRN-TYP-CDE INVALID'             08989200
POA                                              TO PV-OPERATION-MSG-1  08989300
POA                        PERFORM 9999-ABEND                           08989400
090200             END-EVALUATE                                         08990000
090300         ELSE                                                     09000000
090400             EVALUATE TC008-TRN-TYP-CDE                           09010000
090500                 WHEN '01'                                        09020000
090600                     MOVE TC008-TNDR-AMT TO  PV-WRK-PROC-SALES    09030000
090500                 WHEN '02'                                        09031000
090600                     MOVE TC008-TNDR-AMT TO  PV-WRK-PROC-SALES    09032000
090700                 WHEN '11'                                        09040000
090800                     COMPUTE PV-WRK-PROC-RETURNS =                09050000
090900                                             (TC008-TNDR-AMT * -1)09060000
090700                 WHEN '12'                                        09070000
090800                     COMPUTE PV-WRK-PROC-RETURNS =                09080000
090900                                             (TC008-TNDR-AMT * -1)09090000
091000                 WHEN '23'                                        09100000
091100                 WHEN '24'                                        09110000
125703                 WHEN '25'                                        09111000
091200                     IF TC008-TNDR-AMT > 0                        09120000
091300                         MOVE TC008-TNDR-AMT                      09130000
091400                                     TO PV-WRK-PROC-SALES         09140000
091500                     ELSE                                         09150000
091600                         COMPUTE PV-WRK-PROC-RETURNS =            09160000
091700                             (TC008-TNDR-AMT * -1)                09170000
091800                     END-IF                                       09180000
POA                    WHEN '30'                                        09181000
POA                        MOVE TC008-TNDR-AMT                          09182000
POA                                    TO PV-WRK-PROC-SALES             09183000
POA                    WHEN OTHER                                       09184000
POA                        MOVE TC008-TNDR-AMT                          09185000
POA                                    TO PV-OTHER                      09186000
POA                        DISPLAY 'PV-OTHER - SETTLED NOT VOID'        09187000
POA                        DISPLAY 'TC008-TRN-TYP-CDE '                 09189100
POA                                 TC008-TRN-TYP-CDE                   09189200
POA                        MOVE TC008-PARTN-NBR TO PV-PARTN-NBR         09189300
POA                        MOVE TC008-STR-NBR   TO PV-STR-NBR           09189400
POA                        MOVE TC008-RGST-ID   TO PV-RGST-ID           09189500
POA                        MOVE TC008-TRN-NBR   TO PV-TRN-NBR           09189600
POA                        MOVE TC008-TNDR-AMT  TO PV-TNDR-AMT          09189700
POA                        DISPLAY 'PV-PARTN-NBR ' PV-PARTN-NBR         09189800
POA                        DISPLAY 'PV-STR-NBR ' PV-STR-NBR             09189900
POA                        DISPLAY 'PV-RGST-ID ' PV-RGST-ID             09190000
POA                        DISPLAY 'PV-TRN-NBR ' PV-TRN-NBR             09190100
POA                        DISPLAY 'PV-TNDR-AMT ' PV-TNDR-AMT           09190200
POA                        MOVE '6100-CREATE-AUDIT-DETAIL-LINE'         09190300
POA                                              TO PV-PARAGRAPH-NAME   09190400
POA                        MOVE 'TC008-TRN-TYP-CDE INVALID'             09190500
POA                                              TO PV-OPERATION-MSG-1  09190600
POA                        PERFORM 9999-ABEND                           09190700
091900             END-EVALUATE                                         09191000
092000         END-IF                                                   09200000
092100     ELSE                                                         09210000
092200         IF TC008-VOID-ABRT-CDE  = 'V'                            09220000
092300             EVALUATE TC008-TRN-TYP-CDE                           09230000
092400                 WHEN '01'                                        09240000
092500                     MOVE TC008-TNDR-AMT TO  PV-WRK-PROC-SALES    09250000
092600                     COMPUTE PV-WRK-UNPROC-SALES =                09260000
092700                                     (TC008-TNDR-AMT * -1)        09270000
092400                 WHEN '02'                                        09271000
092500                     MOVE TC008-TNDR-AMT TO  PV-WRK-PROC-SALES    09272000
092600                     COMPUTE PV-WRK-UNPROC-SALES =                09273000
092700                                     (TC008-TNDR-AMT * -1)        09274000
092800                 WHEN '11'                                        09280000
092900                     COMPUTE PV-WRK-PROC-RETURNS =                09290000
093000                                     (TC008-TNDR-AMT * -1)        09300000
093100                     MOVE TC008-TNDR-AMT TO PV-WRK-UNPROC-RETURNS 09310000
092800                 WHEN '12'                                        09311000
092900                     COMPUTE PV-WRK-PROC-RETURNS =                09312000
093000                                     (TC008-TNDR-AMT * -1)        09313000
093100                     MOVE TC008-TNDR-AMT TO PV-WRK-UNPROC-RETURNS 09314000
093200                 WHEN '23'                                        09315000
093300                 WHEN '24'                                        09316000
125703                 WHEN '25'                                        09316100
093400                     IF TC008-TNDR-AMT > 0                        09317000
093500                         MOVE TC008-TNDR-AMT TO  PV-WRK-PROC-SALES09318000
093600                         COMPUTE PV-WRK-UNPROC-SALES =            09319000
093700                                     (TC008-TNDR-AMT * -1)        09320000
093800                     ELSE                                         09330000
093900                         COMPUTE PV-WRK-PROC-RETURNS =            09340000
094000                                     (TC008-TNDR-AMT * -1)        09350000
094100                         MOVE TC008-TNDR-AMT                      09360000
094200                                          TO PV-WRK-UNPROC-RETURNS09370000
094300                     END-IF                                       09380000
POA                    WHEN '30'                                        09381000
POA                        MOVE TC008-TNDR-AMT TO  PV-WRK-PROC-SALES    09381100
POA                        COMPUTE PV-WRK-UNPROC-SALES =                09383100
POA                                        (TC008-TNDR-AMT * -1)        09383200
POA                    WHEN OTHER                                       09384000
POA                        MOVE TC008-TNDR-AMT                          09385000
POA                                    TO PV-OTHER                      09386000
POA                        DISPLAY 'OTHER UNPROC VOID SALES '           09387000
POA                        DISPLAY 'TC008-TRN-TYP-CDE '                 09387200
POA                                 TC008-TRN-TYP-CDE                   09387300
POA                        MOVE TC008-PARTN-NBR TO PV-PARTN-NBR         09387400
POA                        MOVE TC008-STR-NBR   TO PV-STR-NBR           09387500
POA                        MOVE TC008-RGST-ID   TO PV-RGST-ID           09387600
POA                        MOVE TC008-TRN-NBR   TO PV-TRN-NBR           09387700
POA                        MOVE TC008-TNDR-AMT  TO PV-TNDR-AMT          09387800
POA                        DISPLAY 'PV-PARTN-NBR ' PV-PARTN-NBR         09387900
POA                        DISPLAY 'PV-STR-NBR ' PV-STR-NBR             09388000
POA                        DISPLAY 'PV-RGST-ID ' PV-RGST-ID             09388100
POA                        DISPLAY 'PV-TRN-NBR ' PV-TRN-NBR             09388200
POA                        DISPLAY 'PV-TNDR-AMT ' PV-TNDR-AMT           09388300
POA                        MOVE '6100-CREATE-AUDIT-DETAIL-LINE'         09388400
POA                                              TO PV-PARAGRAPH-NAME   09388500
POA                        MOVE 'TC008-TRN-TYP-CDE INVALID'             09388600
POA                                              TO PV-OPERATION-MSG-1  09388700
POA                        PERFORM 9999-ABEND                           09388800
094400             END-EVALUATE                                         09390000
094500         ELSE                                                     09400000
094600             EVALUATE TC008-TRN-TYP-CDE                           09410000
094700                 WHEN '01'                                        09420000
094800                     MOVE TC008-TNDR-AMT TO  PV-WRK-UNPROC-SALES  09430000
094700                 WHEN '02'                                        09431000
094800                     MOVE TC008-TNDR-AMT TO  PV-WRK-UNPROC-SALES  09432000
094900                 WHEN '11'                                        09440000
095000                     COMPUTE PV-WRK-UNPROC-RETURNS =              09450000
095100                                             (TC008-TNDR-AMT * -1)09460000
094900                 WHEN '12'                                        09470000
095000                     COMPUTE PV-WRK-UNPROC-RETURNS =              09480000
095100                                             (TC008-TNDR-AMT * -1)09490000
095200                 WHEN '23'                                        09500000
095300                 WHEN '24'                                        09510000
125703                 WHEN '25'                                        09511000
095400                     IF TC008-TNDR-AMT > 0                        09520000
095500                         MOVE TC008-TNDR-AMT                      09530000
095600                                     TO PV-WRK-UNPROC-SALES       09540000
095700                     ELSE                                         09550000
095800                         COMPUTE PV-WRK-UNPROC-RETURNS =          09560000
095900                             (TC008-TNDR-AMT * -1)                09570000
096000                     END-IF                                       09580000
POA                    WHEN '30'                                        09581000
POA                        MOVE TC008-TNDR-AMT TO  PV-WRK-UNPROC-SALES  09582000
POA                    WHEN OTHER                                       09583000
POA                        MOVE TC008-TNDR-AMT TO  PV-OTHER             09584000
POA                        DISPLAY 'OTHER UNPROC SALES '                09585000
POA                        DISPLAY 'TC008-TRN-TYP-CDE '                 09587000
POA                                 TC008-TRN-TYP-CDE                   09588000
POA                        MOVE TC008-PARTN-NBR TO PV-PARTN-NBR         09589000
POA                        MOVE TC008-STR-NBR   TO PV-STR-NBR           09589100
POA                        MOVE TC008-RGST-ID   TO PV-RGST-ID           09589200
POA                        MOVE TC008-TRN-NBR   TO PV-TRN-NBR           09589300
POA                        MOVE TC008-TNDR-AMT  TO PV-TNDR-AMT          09589400
POA                        DISPLAY 'PV-PARTN-NBR ' PV-PARTN-NBR         09589500
POA                        DISPLAY 'PV-STR-NBR ' PV-STR-NBR             09589600
POA                        DISPLAY 'PV-RGST-ID ' PV-RGST-ID             09589700
POA                        DISPLAY 'PV-TRN-NBR ' PV-TRN-NBR             09589800
POA                        DISPLAY 'PV-TNDR-AMT ' PV-TNDR-AMT           09589900
POA                        MOVE '6100-CREATE-AUDIT-DETAIL-LINE'         09590000
POA                                              TO PV-PARAGRAPH-NAME   09590100
POA                        MOVE 'TC008-TRN-TYP-CDE INVALID'             09590200
POA                                              TO PV-OPERATION-MSG-1  09590300
POA                        PERFORM 9999-ABEND                           09590400
096100             END-EVALUATE                                         09591000
096200         END-IF                                                   09600000
096300     END-IF.                                                      09610000
096400                                                                  09620000
096500     MOVE PV-WRK-PROC-SALES      TO D1-PROCESSED-SALES.           09630000
096600     MOVE PV-WRK-UNPROC-SALES    TO D1-UNPROCESSED-SALES.         09640000
096700     MOVE PV-WRK-PROC-RETURNS    TO D1-PROCESSED-RETURNS.         09650000
096800     MOVE PV-WRK-UNPROC-RETURNS  TO D1-UNPROCESSED-RETURNS.       09660000
096900                                                                  09670000
092223     IF PV-WRK-PROC-SALES NOT EQUAL ZEROES OR                     09671002
092223        PV-WRK-PROC-RETURNS NOT EQUAL ZEROES                      09671102
092223         PERFORM 8500-WRITE-UPDT-RECORD                           09673002
092223     END-IF.                                                      09676002
097000     PERFORM 6120-WRITE-AUDIT-DETAIL-LINE.                        09680000
097100                                                                  09690000
097200     PERFORM 6150-ADD-TO-REGISTER-TOTAL.                          09700000
097300                                                                  09710000
097400***************************************************************** 09720000
097500*  6120-WRITE-AUDIT-DETAIL-LINE                                   09730000
097600*        WRITE AUDIT REPORT DETAIL LINE                           09740000
097700***************************************************************** 09750000
097800 6120-WRITE-AUDIT-DETAIL-LINE.                                    09760000
097900                                                                  09770000
098000      IF PV-R1-LINE-CNT   >  58                                   09780000
098100          PERFORM 7010-WRITE-REPORT1-HEADING                      09790000
098200          MOVE PV-SV-STR-NBR      TO  D1-STORE-NBR                09800000
098200          MOVE TC008-ORG-STR-NBR  TO  D1-ORG-STR-NBR              09810000
                EVALUATE TC008-TNDR-TYP-CDE                             09820000
                  WHEN '05'                                             09821000
086700              MOVE TC008-MERCHANT-NBR TO  PV-SV-MERCHANT-NBR      09822000
                    IF PV-SV-MERCHANT-NBR-2 = ZEROES                    09823000
086900                MOVE PV-SV-MERCHANT-NBR-13 TO  D1-MERCHANT-NBR    09824000
                    END-IF                                              09825000
                  WHEN '06'                                             09826000
086700              MOVE TC008-MERCHANT-NBR TO  PV-SV-MERCHANT-NBR      09827000
                    IF PV-SV-MERCHANT-NBR-2 = ZEROES                    09828000
086900                MOVE PV-SV-MERCHANT-NBR-13 TO  D1-MERCHANT-NBR    09829000
                    END-IF                                              09830000
                  WHEN '07'                                             09840000
098400              MOVE TC008-MERCHANT-NBR TO  D1-MERCHANT-NBR         09850000
098400                                          PV-SV-MERCHANT-NBR      09860000
                  WHEN '08'                                             09870000
098400              MOVE TC008-MERCHANT-NBR   TO  D1-MERCHANT-NBR       09880000
098400                                            PV-SV-MERCHANT-NBR    09890000
052523            WHEN '24'                                             09890100
052523              MOVE TC008-MERCHANT-NBR   TO  D1-MERCHANT-NBR       09890200
052523                                            PV-SV-MERCHANT-NBR    09890300
052523            WHEN '25'                                             09890400
052523              MOVE TC008-MERCHANT-NBR   TO  D1-MERCHANT-NBR       09890500
052523                                            PV-SV-MERCHANT-NBR    09890600
                  WHEN OTHER                                            09891000
098400              MOVE TC008-MERCHANT-NBR   TO  D1-MERCHANT-NBR       09892000
098400                                            PV-SV-MERCHANT-NBR    09893000
                END-EVALUATE                                            09894000
099000      END-IF.                                                     09895000
099100                                                                  09896000
099200      WRITE AUDIT-REPORT-REC                                      09897000
099300       FROM D1-DETAIL-LINE-1                                      09898000
099400       AFTER ADVANCING 1 LINE.                                    09899000
099500                                                                  09900000
099600      ADD  +1                    TO PV-R1-LINE-CNT.               09910000
099700                                                                  09920000
099800***************************************************************** 09930000
099900*  6150-ADD-TO-REGISTER-TOTAL                                     09940000
100000*        ADD DETAIL INFO TO THE REGISTER ACCUMULATORS             09950000
100100***************************************************************** 09960000
100200 6150-ADD-TO-REGISTER-TOTAL.                                      09970000
100300                                                                  09980000
100400     ADD  PV-WRK-PROC-SALES      TO  PV-REG-PROC-SALES.           09990000
100500     ADD  PV-WRK-UNPROC-SALES    TO  PV-REG-UNPROC-SALES.         10000000
100600     ADD  PV-WRK-PROC-RETURNS    TO  PV-REG-PROC-RETURNS.         10010000
100700     ADD  PV-WRK-UNPROC-RETURNS  TO  PV-REG-UNPROC-RETURNS.       10020000
100800                                                                  10030000
100900***************************************************************** 10040000
101000*  6200-CREATE-AUDIT-REG-TOTAL                                    10050000
101100*        MOVE FIELDS FOR REGISTER BREAK ON AUDIT REPORT           10060000
101200***************************************************************** 10070000
101300 6200-CREATE-AUDIT-REG-TOTAL.                                     10080000
101400                                                                  10090000
101500     MOVE PV-T1-TOT-RGST         TO T1-VAR-TOTAL-LINE             10100000
101600     MOVE PV-REG-PROC-SALES      TO T1-TOT-PROC-SALES.            10110000
101700     MOVE PV-REG-UNPROC-SALES    TO T1-TOT-UNPROC-SALES.          10120000
101800     MOVE PV-REG-PROC-RETURNS    TO T1-TOT-PROC-RETURNS.          10130000
101900     MOVE PV-REG-UNPROC-RETURNS  TO T1-TOT-UNPROC-RETURNS.        10140000
102000                                                                  10150000
102100     PERFORM 6220-WRITE-AUDIT-REG-TOTAL.                          10160000
102200                                                                  10170000
102300***************************************************************** 10180000
102400*  6220-WRITE-AUDIT-REG-TOTAL                                     10190000
102500*        WRITE OUT REGISTER CONTROL BREAK LINE ON  AUDIT REPORT   10200000
102600***************************************************************** 10210000
102700 6220-WRITE-AUDIT-REG-TOTAL.                                      10220000
102800                                                                  10230000
102900      IF PV-R1-LINE-CNT   >  60                                   10240000
103000          PERFORM 7010-WRITE-REPORT1-HEADING                      10250000
103100      END-IF.                                                     10260000
103200                                                                  10270000
103300      WRITE AUDIT-REPORT-REC                                      10280000
103400       FROM  T1-TOTALS-LINE                                       10290000
103500       AFTER ADVANCING 2 LINE.                                    10300000
103600                                                                  10310000
103700      WRITE AUDIT-REPORT-REC                                      10320000
103800       FROM  SPACE-REPORT-LINE                                    10330000
103900       AFTER ADVANCING 1 LINE.                                    10340000
104000                                                                  10350000
104100      ADD  +3                    TO PV-R1-LINE-CNT.               10360000
104200                                                                  10370000
104300***************************************************************** 10380000
104400*  6300-ADD-TO-STORE-TOTALS                                       10390000
104500*        ADD REGISTER TOTALS TO STORE TOTAL ACCUMULATORS          10400000
104600***************************************************************** 10410000
104700 6300-ADD-TO-STORE-TOTALS.                                        10420000
104800                                                                  10430000
104900     ADD  PV-REG-PROC-SALES      TO  PV-STR-PROC-SALES.           10440000
105000     ADD  PV-REG-UNPROC-SALES    TO  PV-STR-UNPROC-SALES.         10450000
105100     ADD  PV-REG-PROC-RETURNS    TO  PV-STR-PROC-RETURNS.         10460000
105200     ADD  PV-REG-UNPROC-RETURNS  TO  PV-STR-UNPROC-RETURNS.       10470000
105300                                                                  10480000
105400***************************************************************** 10490000
105500*  6400-NEW-REGISTER                                              10500000
105600*        PROCESS NEW REGISTER INFO                                10510000
105700***************************************************************** 10520000
105800 6400-NEW-REGISTER.                                               10530000
105900                                                                  10540000
106000     INITIALIZE PV-REG-TOTALS.                                    10550000
106100                                                                  10560000
106200     PERFORM 6100-CREATE-AUDIT-DETAIL-LINE.                       10570000
106300                                                                  10580000
106400***************************************************************** 10590000
106500*  6500-CREATE-STORE-TOTALS.                                      10600000
106600*        MOVE STORE BREAK TOTALS TO AUDIT REPORT LINE             10610000
106700***************************************************************** 10620000
106800 6500-CREATE-STORE-TOTALS.                                        10630000
106900                                                                  10640000
107000     MOVE PV-SV-STR-NBR          TO PV-T1-TOT-STORE-NBR.          10650000
107100     MOVE PV-SV-RPT-DATE         TO PV-T1-TOT-DATE.               10660000
107200     MOVE PV-T1-TOT-STORE        TO T1-VAR-TOTAL-LINE.            10670000
107300     MOVE PV-STR-PROC-SALES      TO T1-TOT-PROC-SALES.            10680000
107400     MOVE PV-STR-UNPROC-SALES    TO T1-TOT-UNPROC-SALES.          10690000
107500     MOVE PV-STR-PROC-RETURNS    TO T1-TOT-PROC-RETURNS.          10700000
107600     MOVE PV-STR-UNPROC-RETURNS  TO T1-TOT-UNPROC-RETURNS.        10710000
107700                                                                  10720000
107800     PERFORM 6520-WRITE-STORE-TOTALS.                             10730000
107900                                                                  10740000
108000***************************************************************** 10750000
108100*  6520-WRITE-STORE-TOTALS.                                       10760000
108200*        WRITE CONTROL BREAK ON STORE TO AUDIT REPORT             10770000
108300***************************************************************** 10780000
108400 6520-WRITE-STORE-TOTALS.                                         10790000
108500                                                                  10800000
108600      IF PV-R1-LINE-CNT   >  60                                   10810000
108700          PERFORM 7010-WRITE-REPORT1-HEADING                      10820000
108800      END-IF.                                                     10830000
108900                                                                  10840000
109000      WRITE AUDIT-REPORT-REC                                      10850000
109100       FROM  T1-TOTALS-LINE                                       10860000
109200       AFTER ADVANCING 1 LINE.                                    10870000
109300                                                                  10880000
109400      WRITE AUDIT-REPORT-REC                                      10890000
109500       FROM  SPACE-REPORT-LINE                                    10900000
109600       AFTER ADVANCING 1 LINE.                                    10910000
109700                                                                  10920000
109800      ADD  +2                    TO PV-R1-LINE-CNT.               10930000
109900                                                                  10940000
110000***************************************************************** 10950000
110100*  6600-ADD-TO-DATE-TOTALS.                                       10960000
110200*        ADD STORE TOTALS TO DATE ACCUMULATORS                    10970000
110300***************************************************************** 10980000
110400 6600-ADD-TO-DATE-TOTALS.                                         10990000
110500                                                                  11000000
110600     ADD  PV-STR-PROC-SALES      TO  PV-DTE-PROC-SALES.           11010000
110700     ADD  PV-STR-UNPROC-SALES    TO  PV-DTE-UNPROC-SALES.         11020000
110800     ADD  PV-STR-PROC-RETURNS    TO  PV-DTE-PROC-RETURNS.         11030000
110900     ADD  PV-STR-UNPROC-RETURNS  TO  PV-DTE-UNPROC-RETURNS.       11040000
111000                                                                  11050000
111100***************************************************************** 11060000
111200*  6700-NEW-STORE.                                                11070000
111300*        CONTROL BREAK ON STORE                                   11080000
111400***************************************************************** 11090000
111500 6700-NEW-STORE.                                                  11100000
111600                                                                  11110000
111700     INITIALIZE PV-REG-TOTALS.                                    11120000
111800     INITIALIZE PV-STR-TOTALS.                                    11130000
111900                                                                  11140000
112000     PERFORM 6100-CREATE-AUDIT-DETAIL-LINE.                       11150000
112100                                                                  11160000
112200***************************************************************** 11170000
112300*  6800-ADD-TO-GRAND-TOTALS.                                      11180000
112400*        ADD DATE TOTALS TO GRAND TOTAL ACCUMULATORS              11190000
112500***************************************************************** 11200000
112600 6800-ADD-TO-GRAND-TOTALS.                                        11210000
112700                                                                  11220000
112800     ADD  PV-DTE-PROC-SALES      TO  PV-GRND-PROC-SALES.          11230000
112900     ADD  PV-DTE-UNPROC-SALES    TO  PV-GRND-UNPROC-SALES.        11240000
113000     ADD  PV-DTE-PROC-RETURNS    TO  PV-GRND-PROC-RETURNS.        11250000
113100     ADD  PV-DTE-UNPROC-RETURNS  TO  PV-GRND-UNPROC-RETURNS.      11260000
113200                                                                  11270000
113300***************************************************************** 11280000
113400*  6900-CREATE-DATE-TOTALS.                                       11290000
113500*        MOVE DATE TOTALS TO AUDIT REPORT LINE                    11300000
113600***************************************************************** 11310000
113700 6900-CREATE-DATE-TOTALS.                                         11320000
113800                                                                  11330000
113900     MOVE PV-SV-RPT-DATE         TO PV-T1-TOT-ALL-DATE.           11340000
114000     MOVE PV-T1-TOT-ALL-STORE    TO T1-VAR-TOTAL-LINE.            11350000
114100     MOVE PV-DTE-PROC-SALES      TO T1-TOT-PROC-SALES.            11360000
114200     MOVE PV-DTE-UNPROC-SALES    TO T1-TOT-UNPROC-SALES.          11370000
114300     MOVE PV-DTE-PROC-RETURNS    TO T1-TOT-PROC-RETURNS.          11380000
114400     MOVE PV-DTE-UNPROC-RETURNS  TO T1-TOT-UNPROC-RETURNS.        11390000
114500                                                                  11400000
114600     PERFORM 6920-WRITE-STORE-TOTALS.                             11410000
114700                                                                  11420000
114800***************************************************************** 11430000
114900*  6920-WRITE-STORE-TOTALS.                                       11440000
115000*        WRITE STORE BREAK TOTALS ON AUDIT REPORT                 11450000
115100***************************************************************** 11460000
115200 6920-WRITE-STORE-TOTALS.                                         11470000
115300                                                                  11480000
115400      IF PV-R1-LINE-CNT   >  60                                   11490000
115500          PERFORM 7010-WRITE-REPORT1-HEADING                      11500000
115600      END-IF.                                                     11510000
115700                                                                  11520000
115800      WRITE AUDIT-REPORT-REC                                      11530000
115900       FROM  T1-TOTALS-LINE                                       11540000
116000       AFTER ADVANCING 1 LINE.                                    11550000
116100                                                                  11560000
116200      WRITE AUDIT-REPORT-REC                                      11570000
116300       FROM  SPACE-REPORT-LINE                                    11580000
116400       AFTER ADVANCING 1 LINE.                                    11590000
116500                                                                  11600000
116600      ADD  +2                    TO PV-R1-LINE-CNT.               11610000
116700                                                                  11620000
116800******************************************************************11630000
116900* 7000-FORMAT-HEADINGS                                            11640000
117000*     GET CURRENT DATE AND TIME FROM SYSTEM.                      11650000
117100*     FORMAT REPORT FIELDS IN THE TOP PAGE HEADING LINE.          11660000
117200*     FORMAT HEADING LINE 2 WITH CONVERTED POS DATE.              11670000
117300******************************************************************11680000
117400 7000-FORMAT-HEADINGS.                                            11690000
117500                                                                  11700000
117600     MOVE FUNCTION CURRENT-DATE (1:8) TO PV-CURR-DATE-CCYYMMDD.   11710000
117700     ACCEPT PV-CURR-TIME FROM TIME.                               11720000
117800                                                                  11730000
117900     MOVE PV-CURR-DATE-MM             TO DP132-RUN-MONTH.         11740000
118000     MOVE PV-CURR-DATE-DD             TO DP132-RUN-DAY.           11750000
118100     MOVE PV-CURR-DATE-CCYY           TO DP132-RUN-YEAR.          11760000
118200                                                                  11770000
118300     MOVE PV-CURR-TIME-HH             TO DP132-RUN-HOUR.          11780000
118400     MOVE PV-CURR-TIME-MM             TO DP132-RUN-MINUTE.        11790000
118500     MOVE PC-PROGRAM-NAME             TO DP132-PROGRAM-NAME.      11800000
118600                                                                  11810000
118700     PERFORM 7005-DETERMINE-REPORT-HEADINGS.                      11820000
118800     PERFORM 7010-WRITE-REPORT1-HEADING.                          11830000
118900     PERFORM 7020-WRITE-REPORT2-HEADING.                          11840000
119000                                                                  11850000
119100******************************************************************11860000
119200* 7005-DETERMINE-REPORT-HEADINGS                                  11870000
119300*     READ THROUGH TABLE TO IDENTIFY THE CORRECT REPORT NUMBER    11880000
119400*     AND REPORT TITLE.                                           11890000
119500******************************************************************11900000
119600 7005-DETERMINE-REPORT-HEADINGS.                                  11910000
119700                                                                  11920000
119800     IF TC008-KOHLS                                               11930000
119900             MOVE PC-VAR-KOHLS   TO T1-VAR-TITLE                  11940000
120000             MOVE PC-VAR-KOHLS   TO T2-VAR-TITLE                  11950000
120100     ELSE                                                         11960000
120200         IF TC008-VISA                                            11970000
120300             MOVE PC-VAR-BANKCARD TO T1-VAR-TITLE                 11980000
120400             MOVE PC-VAR-BANKCARD TO T2-VAR-TITLE                 11990000
120500         ELSE                                                     12000000
120600             IF TC008-MASTERCARD                                  12010000
120700                 MOVE PC-VAR-BANKCARD                             12020000
120800                                  TO T1-VAR-TITLE                 12030000
120900                 MOVE PC-VAR-BANKCARD                             12040000
121000                                  TO T2-VAR-TITLE                 12050000
121100             ELSE                                                 12060000
121200                 IF TC008-DISCOVER                                12070000
121300                     MOVE PC-VAR-DISCOVER                         12080000
121400                                  TO T1-VAR-TITLE                 12090000
121500                     MOVE PC-VAR-DISCOVER                         12100000
121600                                  TO T2-VAR-TITLE                 12110000
121700                 ELSE                                             12120000
121800                     IF TC008-AMEX                                12130000
121900                         MOVE PC-VAR-AMEX                         12140000
122000                                 TO T1-VAR-TITLE                  12150000
122100                         MOVE PC-VAR-AMEX                         12160000
122200                                 TO T2-VAR-TITLE                  12170000
052523                     ELSE                                         12181000
052523                         IF TC008-COBRAND-VISA                    12182000
052523                             MOVE PC-VAR-COBRAND                  12183000
052523                                     TO T1-VAR-TITLE              12184000
052523                             MOVE PC-VAR-COBRAND                  12185000
052523                                     TO T2-VAR-TITLE              12186000
052523                         ELSE                                     12187100
052523                             IF TC008-TRAILNG-TRAN                12187200
052523                                 MOVE PC-VAR-TRAILNG              12187300
052523                                         TO T1-VAR-TITLE          12187400
052523                                 MOVE PC-VAR-TRAILNG              12187500
052523                                         TO T2-VAR-TITLE          12187600
052523                             END-IF                               12187700
122300                         END-IF                                   12188000
122300                     END-IF                                       12189000
122400                 END-IF                                           12190000
122500             END-IF                                               12200000
122600         END-IF                                                   12210000
122700     END-IF.                                                      12220000
122800                                                                  12230000
122900     MOVE 1                      TO SUB.                          12240000
123000                                                                  12250000
123100     PERFORM UNTIL SUB > 10                                       12260000
123200         IF TC008-TNDR-TYP-CDE = PT-TRN-TYP-CDE (SUB)             12270000
123300             MOVE PT-RPT-NBR-START (SUB)                          12280000
123400                                 TO PC-REPORT-NBR-1               12290000
123500             ADD 1               TO PT-RPT-NBR-START (SUB)        12300000
123600             MOVE PT-RPT-NBR-START (SUB)                          12310000
123700                                 TO PC-REPORT-NBR-2               12320000
123800         END-IF                                                   12330000
123900         ADD +1                  TO SUB                           12340000
124000     END-PERFORM.                                                 12350000
124100                                                                  12360000
124200******************************************************************12370000
124300* 7010-WRITE-REPORT1-HEADING.                                     12380000
124400*     WRITE THE REPORT HEADINGS FOR REPORT ONE                    12390000
124500* TITLE = 'DAILY XXXXXXXXXXXX AUDIT FOR  '                        12400000
124600*       XXXXXXXXXXXX  =  VARIBLE DETERMINED FROM PROCESS-TABLE    12410000
124700*                        BASED ON TYPE OF RECORD.                 12420000
124800******************************************************************12430000
124900 7010-WRITE-REPORT1-HEADING.                                      12440000
125000                                                                  12450000
125100     MOVE +8 TO PV-R1-LINE-CNT.                                   12460000
125200     ADD  +1 TO PV-R1-PAGE-CNT.                                   12470000
125300                                                                  12480000
125400     MOVE PC-REPORT-NBR-1        TO DP132-REPORT-NUMBER.          12490000
125500     MOVE PV-R1-PAGE-CNT         TO DP132-PAGE-NUMBER.            12500000
125600                                                                  12510000
125700      WRITE AUDIT-REPORT-REC                                      12520000
125800       FROM DP132-STANDRD-HEADER-132-COLS                         12530000
125900       AFTER ADVANCING PAGE.                                      12540000
126000                                                                  12550000
126100      WRITE AUDIT-REPORT-REC                                      12560000
126200       FROM T1-TITLE-LINE-1                                       12570000
126300       AFTER ADVANCING 1 LINE.                                    12580000
126400                                                                  12590000
126500******************************************************************12600000
126600*   GET TRN DTE FOR PROCESSING FOR MM/DD/YY                       12610000
126700*   WRITE THE PROCESSING LINE.                                    12620000
126800******************************************************************12630000
126900      PERFORM 9000-CREATE-PROC-DATE-LINE.                         12640000
127000                                                                  12650000
127100      WRITE AUDIT-REPORT-REC                                      12660000
127200       FROM  H1-AUDIT-HEADING                                     12670000
127300       AFTER ADVANCING 2 LINE.                                    12680000
127400                                                                  12690000
127500      WRITE AUDIT-REPORT-REC                                      12700000
127600       FROM  H2-AUDIT-HEADING                                     12710000
127700       AFTER ADVANCING 2 LINE.                                    12720000
127800                                                                  12730000
127900      WRITE AUDIT-REPORT-REC                                      12740000
128000       FROM  SPACE-REPORT-LINE                                    12750000
128100       AFTER ADVANCING 1 LINE.                                    12760000
128200                                                                  12770000
128300******************************************************************12780000
128400* 7020 WRITE-REPORT2-HEADING.                                     12790000
128500*     WRITE THE REPORT HEADINGS FOR REPORT TWO                    12800000
128600* TITLE = 'DAILY XXXXXXXXXXXX TOTALS FOR  '                       12810000
128700*       XXXXXXXXXXXX  =  VARIBLE DETERMINED FROM PROCESS-TABLE    12820000
128800*                        BASED ON TYPE OF RECORD.                 12830000
128900******************************************************************12840000
129000 7020-WRITE-REPORT2-HEADING.                                      12850000
129100                                                                  12860000
129200     MOVE +5 TO PV-R2-LINE-CNT.                                   12870000
129300     ADD  +1 TO PV-R2-PAGE-CNT.                                   12880000
129400                                                                  12890000
129500     MOVE PC-REPORT-NBR-2        TO DP132-REPORT-NUMBER.          12900000
129600     MOVE PV-R2-PAGE-CNT         TO DP132-PAGE-NUMBER.            12910000
129700                                                                  12920000
129800      WRITE TOTALS-REPORT-REC                                     12930000
129900       FROM DP132-STANDRD-HEADER-132-COLS                         12940000
130000       AFTER ADVANCING PAGE.                                      12950000
130100                                                                  12960000
130200      WRITE TOTALS-REPORT-REC                                     12970000
130300       FROM T2-TITLE-LINE-1                                       12980000
130400       AFTER ADVANCING 1 LINE.                                    12990000
130500                                                                  13000000
130600      WRITE TOTALS-REPORT-REC                                     13010000
130700       FROM  H1-TOTALS-HEADING                                    13020000
130800       AFTER ADVANCING 2 LINE.                                    13030000
130900                                                                  13040000
131000      WRITE TOTALS-REPORT-REC                                     13050000
131100       FROM  H2-TOTALS-HEADING                                    13060000
131200       AFTER ADVANCING 1 LINE.                                    13070000
131300                                                                  13080000
131400      WRITE TOTALS-REPORT-REC                                     13090000
131500       FROM  SPACE-REPORT-LINE                                    13100000
131600       AFTER ADVANCING 1 LINE.                                    13110000
131700                                                                  13120000
131800******************************************************************13130000
131900* 8000-READ-INPUT-FILE                                            13140000
132000*     READ THE ADJUSTMENT INPUT FILE                              13150000
132100******************************************************************13160000
132200 8000-READ-CREDIT-FILE.                                           13170000
132300                                                                  13180000
132400     READ CREDIT-REPORT-FILE INTO TC008-EXTRACT-RECORD            13190000
132500         AT END                                                   13200000
132600             SET PS-END-OF-CREDIT-FILE TO TRUE                    13210000
132700     END-READ.                                                    13220000
052523     IF TC008-COBRAND-VISA AND                                    13221000
052523        TC008-TRLING-TRN-IND = 'Y'                                13222000
052523         SET TC008-TRAILNG-TRAN TO TRUE                           13223000
052523     END-IF.                                                      13224000
092223     MOVE TC008-EXTRACT-RECORD TO WK008-EXTRACT-RECORD.           13225002
132800                                                                  13230000
092223***************************************************************** 13231002
092223* 8500-WRITE-PRCD-RECORD                                          13232002
092223*     WRITE THE PROCESSED RECORD.                                 13233002
092223***************************************************************** 13234002
092223 8500-WRITE-UPDT-RECORD.                                          13235002
092223                                                                  13236002
092223     WRITE TRAN-PRCD-RECORD                                       13237002
092223         FROM WK008-EXTRACT-RECORD.                               13238002
092223                                                                  13239002
132900***************************************************************** 13240000
133000*  9000-CREATE-PROC-DATE-LINE.                                    13250000
133100*        WRITE SPECIAL PROCESSING DATE LINE ON AUDIT REPORT       13260000
133200***************************************************************** 13270000
133300 9000-CREATE-PROC-DATE-LINE.                                      13280000
133400                                                                  13290000
133500     MOVE TC008-TRN-DTE          TO PV-TRN-DTE-CCYYMMDD.          13300000
133600     MOVE  PV-TRN-MM             TO  PV-RPT-MM.                   13310000
133700     MOVE  '/'                   TO  PV-RPT-SLASH-1.              13320000
133800     MOVE  PV-TRN-DD             TO  PV-RPT-DD.                   13330000
133900     MOVE  '/'                   TO  PV-RPT-SLASH-2.              13340000
134000     MOVE  PV-TRN-YY             TO  PV-RPT-YY.                   13350000
134100     MOVE  PV-RPT-DATE           TO  P1-DATE.                     13360000
134200     MOVE  PV-RPT-DATE           TO  PV-SV-RPT-DATE.              13370000
134300                                                                  13380000
134400     WRITE AUDIT-REPORT-REC                                       13390000
134500      FROM P1-PROCESS-DATE-LINE                                   13400000
134600      AFTER ADVANCING 2 LINE.                                     13410000
134700                                                                  13420000
134800******************************************************************13430000
134900* 9999-ABEND                                                      13440000
135000*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  13450000
135100******************************************************************13460000
135200 9999-ABEND.                                                      13470000
135300     DISPLAY '** ABEND           **'.                             13480000
135400     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          13490000
135500     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        13500000
135600     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       13510000
135700     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       13520000
135800     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         13530000
