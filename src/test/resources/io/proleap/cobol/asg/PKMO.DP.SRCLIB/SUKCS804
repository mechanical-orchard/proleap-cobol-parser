       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.    SUKCS804.                                         00020000
       AUTHOR.        Cognizant.                                        00030000
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
       DATE-WRITTEN.  MAY 2016.                                         00050000
       DATE-COMPILED.                                                   00060000
      *---------------------------------------------------------------  00070000
      *    S804 - getManifestDetails  WEBSERVICE TRANSACTION            00080000
      *---------------------------------------------------------------  00090000
                                                                        00100000
       ENVIRONMENT DIVISION.                                            00110000
                                                                        00120000
       DATA DIVISION.                                                   00130000
                                                                        00140000
       WORKING-STORAGE SECTION.                                         00150000
         01  DK-DB2-KEYS.                                               00160000
             15  DK-OTBND-TRIP-ID          PIC S9(09)  COMP.            00161000
             15  DK-PO-NBR                 PIC S9(09)  COMP.            00161101
             15  DK-SHIPT-UNT-ID           PIC S9(18)V COMP-3.          00162000
             15  DK-CHLD-MSTR-SHIPT-ID     PIC S9(18)V COMP-3.          00163000
             15  DK-UPC-NBR                PIC S9(15)V COMP-3.          00164000
             15  DK-SML-TIMESTAMP          PIC  X(26).                  00165000
         01  PS-PROGRAM-SWITCHES.                                       00166000
           05  PS-EO-CARTONS-CSR-SW        PIC  X(01) VALUE 'N'.        00167000
               88 PS-EO-CARTONS-CSR                   VALUE 'Y'.        00168000
               88 PS-NO-EO-CARTONS-CSR                VALUE 'N'.        00169000
           05  PS-EO-CTN-CONTENTS-CSR-SW   PIC  X(01) VALUE 'N'.        00170000
               88 PS-EO-CTN-CONTENTS-CSR              VALUE 'Y'.        00170100
               88 PS-NO-EO-CTN-CONTENTS-CSR           VALUE 'N'.        00170200
           05  PS-FIRST-READ-SW            PIC  X(01) VALUE 'N'.        00170300
               88 PS-FIRST-READ                       VALUE 'Y'.        00170400
               88 PS-NO-FIRST-READ                    VALUE 'N'.        00170500
           05  PS-NO-MORE-MSTR-SW          PIC  X(01) VALUE 'N'.        00170600
               88 PS-NO-MORE-MSTR                     VALUE 'Y'.        00170700
               88 PS-MORE-MSTR                        VALUE 'N'.        00170800
         01  PC-PROGRAM-CONSTANTS.                                      00170900
      ******************************************************************00171000
      * 1044.  RESPONSE SUCCESSFUL                                      00172000
      * 1570.  A SYSTEM ERROR HAS OCCURRED - CONTACT HELP DESK          00173000
      * 3053.  OUTBOUND TRIP ID NOT FOUND                               00173100
      * 3778.  OUTBOUND TRIP ID REQUIRED                                00173200
      * 3785.  MORE CARTONS/UPC AVAILABLE                               00173300
      * 3787.  FUNCTION IS CURRENTLY UNAVAILABLE                        00173400
      * 3790.  TRAILER STATUS IS NOT YET SHIPPED FROM DC, PLEASE CONTACT00173500
      *        DC                                                       00173600
      ******************************************************************00173700
           05  PC-TSYMSG-NUMBERS.                                       00173800
               10  PC-TSYMSG-01044         PIC  9(05) VALUE  01044.     00173900
               10  PC-TSYMSG-01570         PIC  9(05) VALUE  01570.     00174000
               10  PC-TSYMSG-03053         PIC  9(05) VALUE  03053.     00174100
               10  PC-TSYMSG-03778         PIC  9(05) VALUE  03778.     00174200
               10  PC-TSYMSG-03785         PIC  9(05) VALUE  03785.     00174300
               10  PC-TSYMSG-03787         PIC  9(05) VALUE  03787.     00174400
               10  PC-TSYMSG-03790         PIC  9(05) VALUE  03790.     00174500
           05  PC-MAX-ITEMS                PIC S9(05)  VALUE +10000     00174600
                                                           COMP SYNC.   00174700
         01  PV-PROGRAM-VARIABLES.                                      00174800
           05  PV-TSYMSG-NUMBER            PIC  9(05) VALUE  0.         00174900
           05  PV-CARTON-DISP              PIC  9(20) VALUE  0.         00175000
           05  PV-SHIPT-UNT-ID             PIC S9(18)V COMP-3 VALUE +0. 00176000
           05  PV-PRNT-CART-ID             PIC S9(18)V COMP-3 VALUE +0. 00177000
           05  PV-SAVE-CART-ID             PIC S9(18)V COMP-3 VALUE +0. 00178000
           05  PV-SAVE-PRNT-CTN            PIC S9(18)V COMP-3 VALUE +0. 00179000
           05  PV-SAVE-RCVD-FLAG           PIC  X(01) VALUE SPACE.      00180000
           05  PV-SAVE-CRE-TMST            PIC  X(19) VALUE SPACES.     00180100
           05  PV-SAVE-TRLR-TMST           PIC  X(19) VALUE SPACES.     00180200
           05  PV-SAVE-TRN-NBR2            PIC S9(09) COMP VALUE 0.     00180301
           05  PV-SAVE-OPC-SET-IND         PIC  X(01) VALUE SPACE.      00180401
           05  PV-UPC-DISP                 PIC  9(15) VALUE  0.         00180501
           05  PV-TMST.                                                 00180601
               10 PV-TMST-DATE             PIC  X(10).                  00180701
               10 PV-TMST-T                PIC  X(01) VALUE 'T'.        00180801
               10 PV-TMST-TIME             PIC  X(08).                  00180901
           05  PV-TRLR-TMST.                                            00181001
               10 PV-TRLR-DATE             PIC  X(10).                  00181101
               10 PV-TRLR-FIL1             PIC  X(01).                  00181201
               10 PV-TRLR-TIME             PIC  X(08).                  00182000
               10 PV-TRLR-DOT              PIC  X(01).                  00183000
               10 PV-TRLR-MS               PIC  X(06).                  00184000
           05  PV-CURR-TIMESTAMP           PIC  X(26).                  00185000
           05  PV-CURR-TMST-DATE-HHMM   REDEFINES                       00186000
               PV-CURR-TIMESTAMP.                                       00187000
               10  PV-CURR-YEAR            PIC X(04).                   00188000
               10  FILLER                  PIC X(01).                   00189000
               10  PV-CURR-MONTH           PIC X(02).                   00190000
               10  FILLER                  PIC X(01).                   00190100
               10  PV-CURR-DAY             PIC X(02).                   00190200
               10  FILLER                  PIC X(01).                   00190300
               10  PV-CURR-HOUR            PIC X(02).                   00190400
               10  FILLER                  PIC X(01).                   00190500
               10  PV-CURR-MIN             PIC X(02).                   00190600
               10  FILLER                  PIC X(01).                   00190700
               10  PV-CURR-SEC             PIC X(02).                   00190800
               10  FILLER                  PIC X(07).                   00190900
           05  PV-CSSL-TMST.                                            00191000
               10  PV-CSSL-MONTH           PIC X(02).                   00191100
               10  FILLER                  PIC X(01) VALUE '-'.         00191200
               10  PV-CSSL-DAY             PIC X(02).                   00191300
               10  FILLER                  PIC X(01) VALUE SPACE.       00191400
               10  PV-CSSL-HOUR            PIC X(02).                   00191500
               10  FILLER                  PIC X(01) VALUE ':'.         00191600
               10  PV-CSSL-MIN             PIC X(02).                   00191700
               10  FILLER                  PIC X(01) VALUE ':'.         00191800
               10  PV-CSSL-SEC             PIC X(02).                   00191900
               10  FILLER                  PIC X(01) VALUE SPACE.       00192000
           05  PV-SQLCODE                  PIC  9(09) VALUE  0.         00192100
           05  PV-CICS-MSG-AREA.                                        00192200
               10 PV-PROGRAM-NAME          PIC  X(10) VALUE             00192300
                                                        ' SUKCS804 '.   00192400
               10 PV-LOG-TIME              PIC  X(15) VALUE SPACES.     00192500
               10 PV-PARA-NAME             PIC  X(25) VALUE SPACES.     00192600
               10 PV-ERROR-MSG             PIC  X(78) VALUE SPACES.     00192700
           05  PV-COMMAREA-LENGTH          PIC S9(04)  VALUE +0         00192800
                                                           COMP SYNC.   00192900
           05  PV-CICS-RESPONSE            PIC S9(08)  VALUE ZEROS      00193000
                                                        COMP SYNC.      00193100
           05  PV-RESP-DISP                PIC  9(08)  VALUE ZEROS.     00193200
           05  PV-STYLID-DISP              PIC  9(09)  VALUE ZEROS.     00193300
           05  PV-PO-DISP                  PIC  9(09)  VALUE ZEROS.     00193402
           05  PV-ITEM-IDX                 PIC S9(04)  VALUE ZEROS      00193502
                                                           COMP SYNC.   00193602
           05  PV-READ-COUNT               PIC S9(04)  VALUE +0         00193702
                                                           COMP SYNC.   00193802
           05  PV-READ-COUNT1              PIC S9(04)  VALUE +0         00193902
                                                           COMP SYNC.   00194002
                                                                        00194102
      *INPUT                                                            00195000
            COPY SURD124.                                               00196000
      *OUTPUT                                                           00197000
            COPY SURD125.                                               00198000
                                                                        00199000
            COPY DPRD507I.                                              00200000
                                                                        00210000
           EXEC SQL                                                     00220000
               INCLUDE SQLCA                                            00230000
           END-EXEC.                                                    00240000
                                                                        00250000
           EXEC SQL                                                     00260000
                INCLUDE TKRPRPM                                         00270000
           END-EXEC.                                                    00280000
                                                                        00290000
           EXEC SQL                                                     00300000
                INCLUDE XLV00000                                        00310000
           END-EXEC.                                                    00320000
                                                                        00330000
           EXEC SQL                                                     00340000
                INCLUDE XLT00006                                        00350000
           END-EXEC.                                                    00360000
                                                                        00370000
           EXEC SQL                                                     00380000
                INCLUDE TSUOBTS                                         00390000
           END-EXEC.                                                    00400000
                                                                        00410000
           EXEC SQL                                                     00420000
                INCLUDE TSUOBTR                                         00430000
           END-EXEC.                                                    00440000
                                                                        00450000
           EXEC SQL                                                     00460000
                INCLUDE TCNTRID                                         00470000
           END-EXEC.                                                    00480000
                                                                        00490000
           EXEC SQL                                                     00500000
                INCLUDE TSUCRDV                                         00510000
           END-EXEC.                                                    00520000
                                                                        00530000
           EXEC SQL                                                     00540000
                INCLUDE SUT00024                                        00550000
           END-EXEC.                                                    00560000
                                                                        00570000
           EXEC SQL                                                     00580000
                INCLUDE SUT00027                                        00590000
           END-EXEC.                                                    00600000
                                                                        00610000
           EXEC SQL                                                     00620000
                INCLUDE SUT00028                                        00630000
           END-EXEC.                                                    00640000
                                                                        00650000
           EXEC SQL                                                     00660000
                INCLUDE SUT00099                                        00670000
           END-EXEC.                                                    00680000
                                                                        00690000
           EXEC SQL                                                     00700000
                INCLUDE SUT00121                                        00710000
           END-EXEC.                                                    00720000
                                                                        00730000
           EXEC SQL                                                     00740000
                INCLUDE TMDARVS                                         00750000
           END-EXEC.                                                    00760000
                                                                        00770000
008500     EXEC SQL                                                     00771001
008600          INCLUDE TPURCHS                                         00772001
008700     END-EXEC.                                                    00773001
008800                                                                  00774001
008900     EXEC SQL                                                     00775001
009000          INCLUDE TSEASET                                         00776001
009100     END-EXEC.                                                    00777001
009200                                                                  00778001
008900     EXEC SQL                                                     00779001
009000          INCLUDE WST00008                                        00779101
009100     END-EXEC.                                                    00779201
009200                                                                  00779301
008900     EXEC SQL                                                     00779401
009000          INCLUDE WST00009                                        00779501
009100     END-EXEC.                                                    00779601
009200                                                                  00779701
008900     EXEC SQL                                                     00779801
009000          INCLUDE WST00010                                        00779901
009100     END-EXEC.                                                    00780001
009200                                                                  00780101
           EXEC SQL                                                     00781000
               DECLARE CARTONS-CSR  CURSOR FOR                          00790000
                 SELECT C.DIVERT_TMST                                   00800000
                      , A.SHIPT_UNT_ID                                  00810000
                      , B.UPC_NBR                                       00820000
                      , B.TRN_NBR                                       00821001
      *CHANGES START                                                    00830000
                      , A.CART_SRC_CDE                                  00840000
                      , A.CRE_DTE                                       00850000
                      , A.CRE_TM                                        00860000
                      , A.ORIG_CART_ID                                  00861006
                      , SUM(B.SHPD_UNT_QTY)                             00870000
                   FROM SUT_OTBND_CART A                                00880000
                      , SUT_OTBND_UPC B                                 00890000
                      , TSUCRDV C                                       00900000
                  WHERE A.OTBND_TRIP_ID  = :DK-OTBND-TRIP-ID            00910000
                    AND A.SHIPT_UNT_ID   =  B.SHIPT_UNT_ID              00920000
                    AND A.SHIPT_UNT_ID   =  C.SHIPT_UNT_ID              00930000
                    AND C.ACTV_CDE       = 'A'                          00940000
                    AND C.DIVERT_TMST    < :DK-SML-TIMESTAMP            00950000
                  GROUP BY C.DIVERT_TMST                                00960000
                         , A.SHIPT_UNT_ID                               00970000
                         , B.UPC_NBR                                    00980000
                         , B.TRN_NBR                                    00981001
                         , A.CART_SRC_CDE                               00990000
                         , A.CRE_DTE                                    01000000
                         , A.CRE_TM                                     01010000
                         , A.ORIG_CART_ID                               01011006
                  UNION                                                 01020000
                  SELECT CC.CRE_TMST                                    01030000
                       , AA.SHIPT_UNT_ID                                01040000
                       , BB.UPC_NBR                                     01050000
                       , BB.TRN_NBR                                     01051001
                       , AA.CART_SRC_CDE                                01060000
                       , AA.CRE_DTE                                     01070000
                       , AA.CRE_TM                                      01080000
                       , AA.ORIG_CART_ID                                01081006
                   , SUM(BB.SHPD_UNT_QTY)                               01090000
                  FROM SUT_OTBND_CART AA                                01100000
                     , SUT_OTBND_UPC BB                                 01110000
                     , SUT_OTBND_LOC CC                                 01120000
                  WHERE AA.OTBND_TRIP_ID  = :DK-OTBND-TRIP-ID           01130000
                    AND AA.SHIPT_UNT_ID   =  BB.SHIPT_UNT_ID            01140000
                    AND AA.SHIPT_UNT_ID   =  CC.SHIPT_UNT_ID            01150000
                    AND CC.SCN_CDE        = 'SHON'                      01160000
                    AND CC.ACTV_CDE       = 'A'                         01170000
                    AND CC.CRE_TMST       < :DK-SML-TIMESTAMP           01180000
                  GROUP BY CC.CRE_TMST                                  01190000
                      , AA.SHIPT_UNT_ID                                 01200000
                      , BB.UPC_NBR                                      01210000
                      , BB.TRN_NBR                                      01211001
                      , AA.CART_SRC_CDE                                 01220000
                      , AA.CRE_DTE                                      01230000
                      , AA.CRE_TM                                       01240000
                      , AA.ORIG_CART_ID                                 01241006
                  ORDER BY 1 DESC                                       01250000
                         , 2 ASC                                        01260000
                         , 3 ASC                                        01270000
                       WITH UR                                          01280000
           END-EXEC.                                                    01290000
                                                                        01300000
           EXEC SQL                                                     01310000
               DECLARE CTN-CONTENTS-CSR CURSOR FOR                      01320000
                       SELECT  A.UPC_NBR                                01330000
                            ,  A.TRN_NBR                                01340001
                            ,  B.CART_SRC_CDE                           01341001
                            ,  B.CRE_DTE                                01350000
                            ,  B.CRE_TM                                 01360000
                            ,  B.ORIG_CART_ID                           01361006
                          ,SUM(A.SHPD_UNT_QTY)                          01370000
                          FROM   SUT_OTBND_UPC A                        01380000
                              ,  SUT_OTBND_CART B                       01390000
                          WHERE A.SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID     01400000
                            AND A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID     01410000
                            AND A.UPC_NBR        > :DK-UPC-NBR          01420000
                       GROUP BY A.UPC_NBR                               01430000
                             ,  A.TRN_NBR                               01440001
                             ,  B.CART_SRC_CDE                          01441001
                             ,  B.CRE_DTE                               01450000
                             ,  B.CRE_TM                                01460000
                             ,  B.ORIG_CART_ID                          01461006
                       ORDER BY 1                                       01470000
           END-EXEC.                                                    01480000
                                                                        01490000
      *----------------------------------------------------------------*01500000
       LINKAGE SECTION.                                                 01510000
                                                                        01520000
       01  DFHCOMMAREA.                                                 01530000
           05  FILLER                         OCCURS  1 TO 5072 TIMES   01540000
                                              DEPENDING ON EIBCALEN.    01550000
               10  FILLER                     PIC X.                    01560000
                                                                        01570000
       PROCEDURE DIVISION.                                              01580000
      ***************************************************************** 01590000
      ** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 01600000
      ** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 01610000
      ** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 01620000
      **                                                             ** 01630000
      ** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 01640000
      ** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 01650000
      ***************************************************************** 01660000
       0000-MAIN-MODULE.                                                01670000
                                                                        01680000
           PERFORM 1000-INITIALIZE.                                     01690000
           PERFORM 1200-GET-CONTAINER.                                  01700000
                                                                        01710000
      *CHANGE - CICS LOG FOR START OF THE PROGRAM                       01720000
           MOVE SPACES         TO PV-PARA-NAME                          01730000
                                  PV-ERROR-MSG                          01740000
           STRING ' START SUKCS804 FOR TRIP ID: '                       01750000
           SU124-OUTBOUND-TRIP-ID                                       01760000
           DELIMITED BY SIZE INTO PV-ERROR-MSG                          01770000
                                                                        01780000
           PERFORM 9990-CSSL-LOG.                                       01790000
      *CHANGE - CICS LOG FOR START OF THE PROGRAM                       01800000
                                                                        01810000
           PERFORM 1100-CHECK-WEBSERV-AVAIL.                            01820000
                                                                        01830000
                                                                        01840000
           IF SU124-OUTBOUND-TRIP-ID GREATER THAN ZEROES                01850000
                                                                        01860000
              PERFORM 1500-CHECK-SHIPPED-FROM-DC                        01870000
              PERFORM 2000-GET-CARTON-IDS                               01880000
                                                                        01890000
           ELSE                                                         01900000
                                                                        01910000
                 MOVE PC-TSYMSG-03778              TO PV-TSYMSG-NUMBER  01920000
                 MOVE 'OUTBOUND TRIP ID REQUIRED ' TO PV-ERROR-MSG      01930000
                 MOVE '0000-MAIN-MODULE         '  TO PV-PARA-NAME      01940000
                 PERFORM 9995-CSSL-LOG-RETURN                           01950000
                                                                        01960000
           END-IF.                                                      01970000
                                                                        01980000
           PERFORM 9000-RETURN-TRAN                                     01990000
              .                                                         02000000
      *----------------------------------------------------------------*02010000
      *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02020000
      *    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02030000
      *----------------------------------------------------------------*02040000
                                                                        02050000
       1000-INITIALIZE.                                                 02060000
           INITIALIZE SU124-GET-MANIFEST-DETAILS                        02070000
                      SU125-OUT-MANIFEST-DETAILS.                       02080000
                                                                        02090000
           PERFORM 1050-GET-CURRENT-TIMESTAMP.                          02100000
                                                                        02110000
       1050-GET-CURRENT-TIMESTAMP.                                      02120000
                                                                        02130000
            EXEC SQL                                                    02140000
               SELECT                                                   02150000
                     CURRENT TIMESTAMP                                  02160000
               INTO                                                     02170000
                     :PV-CURR-TIMESTAMP                                 02180000
               FROM SYSIBM.SYSDUMMY1                                    02190000
            END-EXEC.                                                   02200000
                                                                        02210000
                                                                        02220000
           EVALUATE TRUE                                                02230000
                                                                        02240000
               WHEN SQLCODE = ZERO                                      02250000
                                                                        02260000
                  MOVE  PV-CURR-MONTH    TO PV-CSSL-MONTH               02270000
                  MOVE  PV-CURR-DAY      TO PV-CSSL-DAY                 02280000
                  MOVE  PV-CURR-HOUR     TO PV-CSSL-HOUR                02290000
                  MOVE  PV-CURR-MIN      TO PV-CSSL-MIN                 02300000
                  MOVE  PV-CURR-SEC      TO PV-CSSL-SEC                 02310000
                  MOVE  PV-CSSL-TMST     TO PV-LOG-TIME                 02320000
                                                                        02330000
               WHEN SQLCODE NOT = ZERO                                  02340000
                                                                        02350000
                  MOVE PC-TSYMSG-01570              TO PV-TSYMSG-NUMBER 02360000
                  MOVE SQLCODE                      TO PV-SQLCODE       02370000
                  MOVE '1050-GET-CURRENT-TIMESTAMP' TO PV-PARA-NAME     02380000
                                                                        02390000
                  STRING 'DB2 IS NOT ACTIVE, SQLCODE:'                  02400000
                  PV-SQLCODE DELIMITED BY SIZE INTO  PV-ERROR-MSG       02410000
                                                                        02420000
                  PERFORM 9995-CSSL-LOG-RETURN                          02421000
                                                                        02422000
           END-EVALUATE.                                                02423000
       1100-CHECK-WEBSERV-AVAIL.                                        02424000
                                                                        02425000
            EXEC SQL                                                    02426000
              SELECT FUNC_TXT                                           02426100
                INTO :KRPRPM-FUNC-TXT                                   02426200
                FROM TKRPRPM                                            02426300
              WHERE LOC_ID            = 90                              02426400
                AND INTFC_SYS_CDE     = 'KHL'                           02426500
                AND SYS_PRC_FUNC_CDE  = 'STWEB4'                        02426600
                AND FUNC_PRC_STAT_CDE = 'AC'                            02426700
                AND FUNC_BEG_TMST    <=  CURRENT TIMESTAMP              02426800
                AND FUNC_END_TMST    >=  CURRENT TIMESTAMP              02426900
                AND FUNC_TXT          = 'Y'                             02427000
              WITH UR                                                   02427100
            END-EXEC.                                                   02427200
                                                                        02427300
           EVALUATE TRUE                                                02427400
               WHEN SQLCODE = ZERO                                      02427500
                                                                        02427600
                        CONTINUE                                        02427700
                                                                        02427800
               WHEN SQLCODE = +100                                      02427900
                                                                        02428000
                    MOVE PC-TSYMSG-03787           TO PV-TSYMSG-NUMBER  02428100
                    MOVE 'WEB SERVICE getManifestDetails NOT AVAILABLE' 02428200
                                                     TO PV-ERROR-MSG    02428300
                    MOVE '1100-CHECK-WEBSERV-AVAIL ' TO PV-PARA-NAME    02428400
                    PERFORM 9995-CSSL-LOG-RETURN                        02428500
                                                                        02428600
               WHEN SQLCODE NOT = ZERO                                  02428700
                                                                        02428800
                    MOVE PC-TSYMSG-01570            TO PV-TSYMSG-NUMBER 02428900
                    MOVE SQLCODE                    TO PV-SQLCODE       02429000
                    MOVE '1100-CHECK-WEBSERV-AVAIL' TO PV-PARA-NAME     02429100
                    STRING 'SELECT TKRPRPM FAILED WITH SQLCODE:'        02429200
                    PV-SQLCODE DELIMITED BY SIZE INTO  PV-ERROR-MSG     02429300
                    PERFORM 9995-CSSL-LOG-RETURN                        02429400
                                                                        02429500
           END-EVALUATE.                                                02429600
                                                                        02429700
       1200-GET-CONTAINER.                                              02429800
                                                                        02429900
            EXEC CICS                                                   02430000
              GET CONTAINER('DFHWS-DATA')                               02430100
              INTO(SU124-GET-MANIFEST-DETAILS)                          02430200
              RESP(PV-CICS-RESPONSE)                                    02430300
            END-EXEC.                                                   02430400
                                                                        02430500
            EVALUATE PV-CICS-RESPONSE                                   02430600
                                                                        02430700
               WHEN DFHRESP(NORMAL)                                     02430800
                                                                        02430900
                  CONTINUE                                              02431000
                                                                        02431100
               WHEN OTHER                                               02431200
                                                                        02431300
                  MOVE PV-CICS-RESPONSE TO  PV-RESP-DISP                02431400
                                                                        02431500
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02431600
                  STRING 'GET CONTAINER FAILED CICS RESP CODE:'         02431700
                   PV-RESP-DISP DELIMITED BY SIZE INTO PV-ERROR-MSG     02431800
                                                                        02431900
                  MOVE '1200-GET-CONTAINER   '      TO PV-PARA-NAME     02432000
                  PERFORM 9995-CSSL-LOG-RETURN                          02432100
                                                                        02432200
            END-EVALUATE.                                               02432300
                                                                        02432400
       1500-CHECK-SHIPPED-FROM-DC.                                      02432500
                                                                        02432600
            MOVE SU124-OUTBOUND-TRIP-ID TO  DK-OTBND-TRIP-ID            02432700
                                                                        02432800
            EXEC SQL                                                    02432900
              SELECT  OBTS.TRLR_SEAL_ID                                 02433000
                     ,OBTR.ORGN_OPER_UNT_ID                             02433100
                     ,OBTR.TRLR_SRL_NBR                                 02433200
                     ,TRID.SCAC_CDE                                     02433300
                     ,TRID.TRLR_ID                                      02433400
                INTO                                                    02433500
                     :SUOBTS-TRLR-SEAL-ID                               02433600
                    ,:SUOBTR-ORGN-OPER-UNT-ID                           02433700
                    ,:SUOBTR-TRLR-SRL-NBR                               02433800
                    ,:CNTRID-SCAC-CDE                                   02433900
                    ,:CNTRID-TRLR-ID                                    02434000
                FROM                                                    02434100
                      TSUOBTS OBTS                                      02434200
                    , TSUOBTR OBTR                                      02434300
                    , TCNTRID TRID                                      02434400
                WHERE                                                   02434500
                       OBTS.OTBND_TRIP_ID = :DK-OTBND-TRIP-ID           02434600
                   AND OBTS.OTBND_TRIP_ID = OBTR.OTBND_TRIP_ID          02434700
                   AND OBTR.TRIP_ACTV_CDE = 'A'                         02434800
                   AND OBTS.TRIP_STAT_CDE = 'DS'                        02434900
                   AND OBTR.TRLR_SRL_NBR  = TRID.TRLR_SRL_NBR           02435000
                WITH UR                                                 02435100
            END-EXEC.                                                   02435200
                                                                        02435300
            EVALUATE TRUE                                               02435400
               WHEN SQLCODE = ZERO                                      02435500
                                                                        02435600
                  MOVE SUOBTS-TRLR-SEAL-ID     TO SU125-TRLR-SEAL-ID    02435700
                  MOVE SUOBTR-ORGN-OPER-UNT-ID TO SU125-SHIP-NODE       02435800
                  MOVE SUOBTR-TRLR-SRL-NBR     TO SU125-TRLR-SRL-NBR    02435900
                  MOVE CNTRID-SCAC-CDE         TO SU125-TRLR-SCAC-CDE   02436000
                  MOVE CNTRID-TRLR-ID          TO SU125-TRAILER-ID      02436100
                                                                        02436200
               WHEN SQLCODE = 100                                       02436300
                                                                        02436400
                  MOVE PC-TSYMSG-03790           TO PV-TSYMSG-NUMBER    02436500
                  STRING 'TRAILER IS NOT SHIPPED FROM DC, TRIP ID:'     02436600
                   SU124-OUTBOUND-TRIP-ID                               02436700
                             DELIMITED BY SIZE INTO PV-ERROR-MSG        02436800
                                                                        02436900
                  MOVE '1500-CHECK-SHIPPED-FROM-DC' TO PV-PARA-NAME     02437000
                  PERFORM 9995-CSSL-LOG-RETURN                          02437100
                                                                        02437200
               WHEN SQLCODE NOT = ZERO                                  02437300
                                                                        02437400
                  MOVE SQLCODE    TO PV-SQLCODE                         02437500
                                                                        02437600
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02437700
                  STRING 'SELECT TSUOBTS FAILED WITH SQLCODE:'          02437800
                   PV-SQLCODE ' TRIP ID:' SU124-OUTBOUND-TRIP-ID        02437900
                              DELIMITED BY SIZE INTO PV-ERROR-MSG       02438000
                                                                        02438100
                  MOVE '1500-CHECK-SHIPPED-FROM-DC' TO PV-PARA-NAME     02438200
                  PERFORM 9995-CSSL-LOG-RETURN                          02438300
                                                                        02438400
            END-EVALUATE                                                02438500
            .                                                           02438600
       2000-GET-CARTON-IDS.                                             02438700
                                                                        02438800
            MOVE SU124-LAST-CARTON-ID   TO  DK-SHIPT-UNT-ID             02438900
            MOVE SU124-LAST-UPC-NBR     TO  DK-UPC-NBR                  02439000
                                                                        02440000
            MOVE +1                     TO  PV-ITEM-IDX                 02450000
            SET PS-FIRST-READ           TO  TRUE                        02460000
                                                                        02470000
            IF DK-SHIPT-UNT-ID GREATER THAN ZERO                        02480000
                                                                        02490000
               PERFORM 2500-FIND-LAST-SML-TMST                          02500000
               PERFORM 2600-OPEN-CTN-CONTENTS-CSR                       02510000
               PERFORM 2700-FETCH-UPC-FROM-DB                           02520000
               PERFORM 2800-CLOSE-CTN-CONTENTS-CSR                      02530000
                                                                        02540000
               ADD -1                   TO  PV-ITEM-IDX                 02550000
                                                                        02560000
            ELSE                                                        02570000
                                                                        02580000
               MOVE PV-CURR-TIMESTAMP   TO DK-SML-TIMESTAMP             02590000
                                                                        02600000
            END-IF.                                                     02610000
                                                                        02620000
               PERFORM 2100-OPEN-CARTONS-CSR.                           02630000
               PERFORM 2200-FETCH-CARTONS-FROM-DB.                      02640000
               PERFORM 2400-CLOSE-CARTONS-CSR.                          02650000
                                                                        02660000
       2500-FIND-LAST-SML-TMST.                                         02670000
                                                                        02680000
            EXEC SQL                                                    02690000
              SELECT A.DIVERT_TMST                                      02700000
                INTO                                                    02710000
                    :SUCRDV-DIVERT-TMST                                 02720000
                FROM                                                    02730000
                    TSUCRDV A                                           02731000
                WHERE                                                   02732000
                       A.SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID              02733000
                   AND A.ACTV_CDE       = 'A'                           02734000
                WITH UR                                                 02735000
            END-EXEC.                                                   02736000
                                                                        02736100
            EVALUATE TRUE                                               02736200
               WHEN SQLCODE = ZERO                                      02736300
                                                                        02736400
                  MOVE SUCRDV-DIVERT-TMST TO DK-SML-TIMESTAMP           02736500
                                                                        02736600
               WHEN SQLCODE = 100                                       02736700
                                                                        02736800
                  PERFORM 2550-FIND-LAST-SML-TMST2                      02736900
                                                                        02737000
               WHEN SQLCODE NOT = ZERO                                  02737100
                                                                        02737200
                  MOVE SQLCODE    TO PV-SQLCODE                         02737300
                                                                        02737400
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02737500
                  STRING 'SELECT TSUCRDV FAILED WITH SQLCODE:'          02737600
                   PV-SQLCODE ' CARTON#' PV-CARTON-DISP                 02737700
                              DELIMITED BY SIZE INTO PV-ERROR-MSG       02737800
                                                                        02737900
                  MOVE '2500-FIND-LAST-SML-TMST' TO PV-PARA-NAME        02738000
                  PERFORM 9995-CSSL-LOG-RETURN                          02738100
                                                                        02738200
            END-EVALUATE                                                02738300
            .                                                           02738400
       2550-FIND-LAST-SML-TMST2.                                        02738500
                                                                        02738600
            EXEC SQL                                                    02738700
                                                                        02738800
              SELECT B.CRE_TMST                                         02738900
                INTO                                                    02739000
                    :SUT00027-CRE-TMST                                  02739100
                FROM                                                    02739200
                    SUT_OTBND_LOC B                                     02739300
                WHERE                                                   02739400
                       B.SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID              02739500
                   AND B.SCN_CDE        = 'SHON'                        02739600
                   AND B.ACTV_CDE       = 'A'                           02739700
            END-EXEC.                                                   02739800
                                                                        02739900
            EVALUATE TRUE                                               02740000
               WHEN SQLCODE = ZERO                                      02740100
                                                                        02740200
                  MOVE SUT00027-CRE-TMST TO DK-SML-TIMESTAMP            02740300
                                                                        02740400
               WHEN SQLCODE NOT = ZERO                                  02740500
                                                                        02740600
                  MOVE SQLCODE    TO PV-SQLCODE                         02740700
                                                                        02740800
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02740900
                  STRING 'SELECT SUT_OTBND_LOC FAILED WITH SQLCODE:'    02741000
                   PV-SQLCODE ' CARTON#' PV-CARTON-DISP                 02741100
                              DELIMITED BY SIZE INTO PV-ERROR-MSG       02741200
                                                                        02741300
                  MOVE '2550-FIND-LAST-SML-TMST2' TO PV-PARA-NAME       02741400
                  PERFORM 9995-CSSL-LOG-RETURN                          02741500
                                                                        02741600
            END-EVALUATE                                                02741700
            .                                                           02741800
       2600-OPEN-CTN-CONTENTS-CSR.                                      02741900
                                                                        02742000
               EXEC SQL                                                 02742100
                  OPEN CTN-CONTENTS-CSR                                 02742200
               END-EXEC.                                                02742300
                                                                        02742400
            EVALUATE TRUE                                               02742500
               WHEN SQLCODE = ZERO                                      02742600
                                                                        02742700
                  CONTINUE                                              02742800
                                                                        02742900
               WHEN SQLCODE NOT = ZERO                                  02743000
                                                                        02743100
                  MOVE SQLCODE    TO PV-SQLCODE                         02743200
                                                                        02743300
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02743400
                  STRING 'OPEN CTN-CONTENTS-CSR FAILED WITH SQLCODE:'   02743500
                   PV-SQLCODE DELIMITED BY SIZE INTO PV-ERROR-MSG       02743600
                                                                        02743700
                  MOVE '2600-OPEN-CTN-CONTENTS-CSR' TO PV-PARA-NAME     02743800
                  PERFORM 9995-CSSL-LOG-RETURN                          02743900
                                                                        02744000
            END-EVALUATE                                                02744100
            .                                                           02744200
       2700-FETCH-UPC-FROM-DB.                                          02744300
                                                                        02744400
            SET PS-NO-EO-CTN-CONTENTS-CSR TO TRUE                       02744500
                                                                        02744600
             PERFORM                                                    02744700
                 VARYING PV-READ-COUNT                                  02744800
                 FROM 1 BY 1                                            02744900
                 UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                  02745000
                    OR (PS-EO-CTN-CONTENTS-CSR))                        02746000
                                                                        02746100
                 PERFORM 2750-FETCH-CTN-CONTENTS-CSR                    02746200
                 ADD +1                   TO PV-ITEM-IDX                02746300
                                                                        02746400
             END-PERFORM.                                               02746500
                                                                        02746600
       2750-FETCH-CTN-CONTENTS-CSR.                                     02746700
                                                                        02746800
               EXEC SQL                                                 02746900
                 FETCH CTN-CONTENTS-CSR                                 02747000
                  INTO  :SUT00028-UPC-NBR                               02747100
                       ,:SUT00028-TRN-NBR                               02747201
                       ,:SUT00024-CART-SRC-CDE                          02747301
                       ,:SUT00024-CRE-DTE                               02747401
                       ,:SUT00024-CRE-TM                                02747501
                       ,:SUT00024-ORIG-CART-ID                          02747606
                       ,:SUT00028-SHPD-UNT-QTY                          02747706
               END-EXEC.                                                02747806
                                                                        02747906
            EVALUATE TRUE                                               02748006
               WHEN SQLCODE = ZERO                                      02748106
                                                                        02748206
                  SET PS-NO-FIRST-READ  TO TRUE                         02748306
                  MOVE DK-SHIPT-UNT-ID  TO SU125-CARTON-ID(PV-ITEM-IDX) 02748406
                  MOVE SUT00028-UPC-NBR TO SU125-UPC-NBR(PV-ITEM-IDX)   02748506
                  MOVE SUT00028-TRN-NBR TO DK-PO-NBR                    02748606
                  MOVE SUT00028-SHPD-UNT-QTY TO                         02748706
                                      SU125-UPC-QUANTITY(PV-ITEM-IDX)   02748806
                                                                        02748906
                  PERFORM 2450-FIND-SKU                                 02749006
                                                                        02749106
      *CHANGES START                                                    02749206
                  MOVE SUT00024-CART-SRC-CDE TO                         02749306
                                     SU125-SML-TYPE(PV-ITEM-IDX)        02749406
                  MOVE SUT00024-ORIG-CART-ID TO                         02749506
                               SU125-VENDOR-CART-ID(PV-ITEM-IDX)        02749606
                                                                        02749706
                  IF PV-SAVE-CART-ID = DK-SHIPT-UNT-ID                  02749806
                                                                        02749906
                     MOVE PV-SAVE-PRNT-CTN   TO                         02750006
                                     SU125-PARENT-SML(PV-ITEM-IDX)      02750106
                     MOVE PV-SAVE-RCVD-FLAG  TO                         02750206
                                     SU125-CARTON-RECEIVED(PV-ITEM-IDX) 02750306
                     MOVE PV-SAVE-CRE-TMST   TO                         02750406
                                     SU125-SML-CRE-TMST(PV-ITEM-IDX)    02750506
                     MOVE PV-SAVE-TRLR-TMST  TO                         02750606
                                     SU125-SML-TRLR-TMST(PV-ITEM-IDX)   02750706
                                                                        02750806
                  ELSE                                                  02750906
                                                                        02751006
                     MOVE DK-SHIPT-UNT-ID    TO PV-SAVE-CART-ID         02751106
                                                                        02751206
                     PERFORM 4000-FIND-PARENT-CARTON                    02751306
                                                                        02751406
                     MOVE PV-PRNT-CART-ID    TO                         02751506
                                        SU125-PARENT-SML(PV-ITEM-IDX)   02751606
                     PERFORM 4400-CHECK-CARTON-RECEIVED                 02751706
                                                                        02751806
                     MOVE SUT00024-CRE-DTE   TO PV-TMST-DATE            02751906
                     MOVE SUT00024-CRE-TM    TO PV-TMST-TIME            02752006
                     MOVE PV-TMST            TO                         02752106
                                        SU125-SML-CRE-TMST(PV-ITEM-IDX) 02752206
                                        PV-SAVE-CRE-TMST                02752306
                     MOVE DK-SML-TIMESTAMP   TO PV-TRLR-TMST            02752406
                     MOVE PV-TRLR-DATE       TO PV-TMST-DATE            02752506
                     MOVE PV-TRLR-TIME       TO PV-TMST-TIME            02752606
                     MOVE PV-TMST            TO                         02752706
                                       SU125-SML-TRLR-TMST(PV-ITEM-IDX) 02752806
                                       PV-SAVE-TRLR-TMST                02752906
                                                                        02753006
                  END-IF                                                02753106
                  IF DK-PO-NBR = PV-SAVE-TRN-NBR2                       02753206
                                                                        02753306
                      MOVE PV-SAVE-OPC-SET-IND TO                       02753406
                                       SU125-OPC-SET-IND(PV-ITEM-IDX)   02753506
                                                                        02753606
                  ELSE                                                  02753706
                      MOVE DK-PO-NBR           TO PV-SAVE-TRN-NBR2      02753806
109400                PERFORM 5280-GET-OPC-SET-CDE                      02753906
                                                                        02754006
                  END-IF                                                02754106
      *CHANGES END                                                      02754206
                                                                        02754306
                  MOVE PC-TSYMSG-01044  TO PV-TSYMSG-NUMBER             02754406
                                                                        02754506
                  ADD +1                TO SU125-CARTON-UPC-COUNT       02754606
                                                                        02754706
               WHEN SQLCODE = 100                                       02754806
                                                                        02754906
                  SET PS-EO-CTN-CONTENTS-CSR   TO TRUE                  02755006
                                                                        02755106
               WHEN SQLCODE NOT = ZERO                                  02755206
                                                                        02755306
                  MOVE SQLCODE    TO PV-SQLCODE                         02755406
                                                                        02755506
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02755606
                  STRING 'FETCH CTN-CONTENTS-CSR FAILED WITH SQLCODE:'  02755706
                   PV-SQLCODE ' SML#' PV-CARTON-DISP                    02755806
                              DELIMITED BY SIZE INTO PV-ERROR-MSG       02755906
                                                                        02756006
                  MOVE '2750-FETCH-CTN-CONTENTS-CSR' TO PV-PARA-NAME    02756106
                  PERFORM 9995-CSSL-LOG-RETURN                          02756206
                                                                        02756306
            END-EVALUATE                                                02756406
            .                                                           02756506
       2800-CLOSE-CTN-CONTENTS-CSR.                                     02756606
                                                                        02756706
               EXEC SQL                                                 02756806
                 CLOSE CTN-CONTENTS-CSR                                 02756906
               END-EXEC.                                                02757006
                                                                        02757106
            EVALUATE TRUE                                               02757206
               WHEN SQLCODE = ZERO                                      02757306
                                                                        02757406
                  CONTINUE                                              02757506
                                                                        02757606
               WHEN SQLCODE NOT = ZERO                                  02757706
                                                                        02757806
                  MOVE SQLCODE    TO PV-SQLCODE                         02757906
                                                                        02758006
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02758106
                  STRING 'CLOSE CTN-CONTENTS-CSR FAILED WITH SQLCODE:'  02758206
                   PV-SQLCODE DELIMITED BY SIZE INTO PV-ERROR-MSG       02758306
                                                                        02758406
                  MOVE '2800-CLOSE-CTN-CONTENTS-CSR' TO PV-PARA-NAME    02758506
                  PERFORM 9995-CSSL-LOG-RETURN                          02758606
                                                                        02758706
            END-EVALUATE                                                02758806
            .                                                           02758906
       2100-OPEN-CARTONS-CSR.                                           02759006
                                                                        02759106
               EXEC SQL                                                 02759206
                  OPEN CARTONS-CSR                                      02759306
               END-EXEC                                                 02759406
                                                                        02759506
            EVALUATE TRUE                                               02759606
               WHEN SQLCODE = ZERO                                      02759706
                                                                        02759806
                  CONTINUE                                              02759906
                                                                        02760006
               WHEN SQLCODE NOT = ZERO                                  02760106
                                                                        02760206
                  MOVE SQLCODE    TO PV-SQLCODE                         02760306
                                                                        02760406
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02760506
                  STRING 'OPEN CARTONS-CSR FAILED WITH SQLCODE:'        02760606
                   PV-SQLCODE DELIMITED BY SIZE INTO PV-ERROR-MSG       02760706
                                                                        02760806
                  MOVE '2100-OPEN-CARTONS-CSR'      TO PV-PARA-NAME     02760906
                  PERFORM 9995-CSSL-LOG-RETURN                          02761006
                                                                        02761106
            END-EVALUATE                                                02761206
            .                                                           02761306
       2200-FETCH-CARTONS-FROM-DB.                                      02761406
                                                                        02761506
            SET PS-NO-EO-CARTONS-CSR      TO TRUE                       02761606
             PERFORM                                                    02761706
                 VARYING PV-READ-COUNT1                                 02761806
                 FROM 1 BY 1                                            02761906
                 UNTIL ((PV-ITEM-IDX   > PC-MAX-ITEMS)                  02762006
                    OR (PS-EO-CARTONS-CSR))                             02762106
                                                                        02762206
                 PERFORM 2300-FETCH-CARTONS-CSR                         02762306
                 ADD +1                   TO PV-ITEM-IDX                02762406
                                                                        02762506
             END-PERFORM.                                               02762606
                                                                        02762706
             IF PS-NO-EO-CARTONS-CSR                                    02762806
                                                                        02762906
                MOVE PC-TSYMSG-03785      TO PV-TSYMSG-NUMBER           02763006
                                                                        02763106
             END-IF.                                                    02763206
                                                                        02763306
       2300-FETCH-CARTONS-CSR.                                          02763406
                                                                        02763506
               EXEC SQL                                                 02763606
                 FETCH CARTONS-CSR                                      02763706
                  INTO  :SUCRDV-DIVERT-TMST                             02763806
                       ,:SUT00024-SHIPT-UNT-ID                          02763906
                       ,:SUT00028-UPC-NBR                               02764006
                       ,:SUT00028-TRN-NBR                               02764106
                       ,:SUT00024-CART-SRC-CDE                          02764206
                       ,:SUT00024-CRE-DTE                               02764306
                       ,:SUT00024-CRE-TM                                02764406
                       ,:SUT00024-ORIG-CART-ID                          02764506
                       ,:SUT00028-SHPD-UNT-QTY                          02764606
               END-EXEC.                                                02764706
                                                                        02764806
            EVALUATE TRUE                                               02764906
               WHEN SQLCODE = ZERO                                      02765006
                                                                        02765106
                  SET PS-NO-FIRST-READ  TO TRUE                         02765206
                  MOVE SUT00024-SHIPT-UNT-ID                            02765306
                                  TO SU125-CARTON-ID(PV-ITEM-IDX)       02765406
                  MOVE SUT00028-UPC-NBR TO SU125-UPC-NBR(PV-ITEM-IDX)   02765506
                  MOVE SUT00028-TRN-NBR TO DK-PO-NBR                    02765606
                  MOVE SUT00028-SHPD-UNT-QTY                            02765706
                                  TO SU125-UPC-QUANTITY(PV-ITEM-IDX)    02765806
                  MOVE PC-TSYMSG-01044  TO PV-TSYMSG-NUMBER             02765906
                                                                        02766006
                  PERFORM 2450-FIND-SKU                                 02766106
                  ADD +1                TO SU125-CARTON-UPC-COUNT       02766206
      *CHANGES START                                                    02766306
                  MOVE SUT00024-CART-SRC-CDE TO                         02766406
                                     SU125-SML-TYPE(PV-ITEM-IDX)        02766506
                  MOVE SUT00024-ORIG-CART-ID TO                         02766606
                               SU125-VENDOR-CART-ID(PV-ITEM-IDX)        02766706
                                                                        02766806
                  IF PV-SAVE-CART-ID = SUT00024-SHIPT-UNT-ID            02766906
                                                                        02767006
                     MOVE PV-SAVE-PRNT-CTN   TO                         02767106
                                     SU125-PARENT-SML(PV-ITEM-IDX)      02767206
                     MOVE PV-SAVE-RCVD-FLAG  TO                         02767306
                                     SU125-CARTON-RECEIVED(PV-ITEM-IDX) 02767406
                     MOVE PV-SAVE-CRE-TMST   TO                         02767506
                                     SU125-SML-CRE-TMST(PV-ITEM-IDX)    02767606
                     MOVE PV-SAVE-TRLR-TMST  TO                         02767706
                                     SU125-SML-TRLR-TMST(PV-ITEM-IDX)   02767806
                  ELSE                                                  02767906
                                                                        02768006
                     MOVE SUT00024-SHIPT-UNT-ID TO PV-SAVE-CART-ID      02768106
                                                   DK-SHIPT-UNT-ID      02768206
                     PERFORM 4000-FIND-PARENT-CARTON                    02768306
                                                                        02768406
                     MOVE PV-PRNT-CART-ID    TO                         02768506
                                        SU125-PARENT-SML(PV-ITEM-IDX)   02768606
                                        PV-SAVE-PRNT-CTN                02768706
                     PERFORM 4400-CHECK-CARTON-RECEIVED                 02768806
                     MOVE SUT00024-CRE-DTE   TO PV-TMST-DATE            02768906
                     MOVE SUT00024-CRE-TM    TO PV-TMST-TIME            02769006
                     MOVE PV-TMST            TO                         02769106
                                        SU125-SML-CRE-TMST(PV-ITEM-IDX) 02769206
                                        PV-SAVE-CRE-TMST                02769306
                     MOVE SUCRDV-DIVERT-TMST TO PV-TRLR-TMST            02769406
                     MOVE PV-TRLR-DATE       TO PV-TMST-DATE            02769506
                     MOVE PV-TRLR-TIME       TO PV-TMST-TIME            02769606
                     MOVE PV-TMST            TO                         02769706
                                       SU125-SML-TRLR-TMST(PV-ITEM-IDX) 02769806
                                       PV-SAVE-TRLR-TMST                02769906
                                                                        02770006
                  END-IF                                                02770106
                  IF DK-PO-NBR = PV-SAVE-TRN-NBR2                       02770206
                                                                        02770306
                      MOVE PV-SAVE-OPC-SET-IND TO                       02770406
                                       SU125-OPC-SET-IND(PV-ITEM-IDX)   02770506
                                                                        02770606
                  ELSE                                                  02770706
                      MOVE DK-PO-NBR           TO PV-SAVE-TRN-NBR2      02770806
109400                PERFORM 5280-GET-OPC-SET-CDE                      02770906
                                                                        02771006
                  END-IF                                                02771106
      *CHANGES END                                                      02771206
                                                                        02771306
               WHEN SQLCODE = 100                                       02771406
                                                                        02771506
                  IF PS-FIRST-READ                                      02771606
                                                                        02771706
                     MOVE PC-TSYMSG-03053      TO PV-TSYMSG-NUMBER      02771806
                    STRING 'OUTBOUND TRIP ID NOT FOUND,OUTBOUND TRIP#:' 02771906
                     SU124-OUTBOUND-TRIP-ID  DELIMITED BY SIZE INTO     02772006
                                                  PV-ERROR-MSG          02772106
                     MOVE ' 2300-FETCH-CARTONS-CSR'                     02772206
                                               TO PV-PARA-NAME          02772306
                     PERFORM 2400-CLOSE-CARTONS-CSR                     02772406
                     PERFORM 9995-CSSL-LOG-RETURN                       02772506
                                                                        02772606
                  END-IF                                                02772706
                                                                        02772806
                  SET PS-EO-CARTONS-CSR   TO TRUE                       02772906
                                                                        02773006
               WHEN SQLCODE NOT = ZERO                                  02773106
                                                                        02773206
                  MOVE SQLCODE    TO PV-SQLCODE                         02773306
                                                                        02773406
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02773506
                  STRING 'FETCH CARTONS-CSR FAILED WITH SQLCODE:'       02773606
                   PV-SQLCODE 'OUTBOUND TRIP#' SU124-OUTBOUND-TRIP-ID   02773706
                              DELIMITED BY SIZE INTO PV-ERROR-MSG       02773806
                                                                        02773906
                  MOVE '2300-FETCH-CARTONS-CSR' TO PV-PARA-NAME         02774006
                  PERFORM 9995-CSSL-LOG-RETURN                          02774106
                                                                        02774206
            END-EVALUATE                                                02774306
            .                                                           02774406
       2400-CLOSE-CARTONS-CSR.                                          02774506
                                                                        02774606
               EXEC SQL                                                 02774706
                 CLOSE CARTONS-CSR                                      02774806
               END-EXEC.                                                02774906
                                                                        02775006
                                                                        02775106
            EVALUATE TRUE                                               02775206
               WHEN SQLCODE = ZERO                                      02775306
                                                                        02775406
                  CONTINUE                                              02775506
                                                                        02775606
               WHEN SQLCODE NOT = ZERO                                  02775706
                                                                        02775806
                  MOVE SQLCODE    TO PV-SQLCODE                         02775906
                                                                        02776006
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02776106
                  STRING 'CLOSE CARTONS-CSR FAILED WITH SQLCODE:'       02776206
                   PV-SQLCODE DELIMITED BY SIZE INTO PV-ERROR-MSG       02776306
                                                                        02776406
                  MOVE '2400-CLOSE-CARTONS-CSR'   TO PV-PARA-NAME       02776506
                  PERFORM 9995-CSSL-LOG-RETURN                          02776606
                                                                        02776706
            END-EVALUATE                                                02776806
            .                                                           02776906
       2450-FIND-SKU.                                                   02777006
                                                                        02777106
            EXEC SQL                                                    02777206
               SELECT                                                   02777306
                   XSKU.SKU_NBR                                         02777406
                 , XSKU.STYL_ID                                         02777506
                INTO                                                    02777606
                   :XLV00000-SKU-NBR                                    02777706
                 , :XLV00000-STYL-ID                                    02777806
                FROM                                                    02777906
                      XLT_UPC       XUPC                                02778006
                     ,XLV_SKU       XSKU                                02778106
                WHERE                                                   02778206
                     XUPC.UPC_NBR          = :SUT00028-UPC-NBR          02778306
                 AND XUPC.INTR_UPC_ID      = XSKU.INTR_UPC_ID           02778406
                 AND NOT XSKU.SKU_STAT_CDE IN ('00', '98')              02778506
                 WITH UR                                                02778606
            END-EXEC.                                                   02778706
                                                                        02778806
            EVALUATE TRUE                                               02778906
               WHEN SQLCODE = ZERO                                      02779006
                                                                        02779106
                  MOVE XLV00000-SKU-NBR TO SU125-SKU-NBR (PV-ITEM-IDX)  02779206
                  MOVE XLV00000-STYL-ID TO SU125-STYL-ID (PV-ITEM-IDX)  02779306
                                                                        02779406
                  PERFORM 2860-FIND-STYL-CTG                            02779506
                                                                        02779606
               WHEN SQLCODE = +100                                      02779706
                                                                        02779806
                  MOVE 0                TO SU125-SKU-NBR (PV-ITEM-IDX)  02779906
                                           SU125-STYL-ID (PV-ITEM-IDX)  02780006
                                       SU125-CTG-SEQ-NBR (PV-ITEM-IDX)  02780106
                                                                        02780206
               WHEN SQLCODE NOT = ZERO                                  02780306
                                                                        02780406
                  MOVE SQLCODE                  TO PV-SQLCODE           02780506
                  MOVE SUT00028-UPC-NBR         TO PV-UPC-DISP          02780606
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02780706
                                                                        02780806
                  STRING 'SELECT XLT_UPC FAILED WITH SQLCODE:'          02780906
                   PV-SQLCODE ' UPC:' PV-UPC-DISP                       02781006
                            DELIMITED BY SIZE INTO PV-ERROR-MSG         02781106
                                                                        02781206
                  MOVE '2450-FIND-SKU'          TO PV-PARA-NAME         02781306
                  PERFORM 2400-CLOSE-CARTONS-CSR                        02781406
                  PERFORM 9995-CSSL-LOG-RETURN                          02781506
                                                                        02781606
            END-EVALUATE                                                02781706
            .                                                           02781806
       2860-FIND-STYL-CTG.                                              02781906
                                                                        02782006
            EXEC SQL                                                    02782106
               SELECT DISTINCT                                          02782206
                   A.RMS_STYL_ID                                        02782306
                 , A.CTG_SEQ_NBR                                        02782406
                INTO                                                    02782506
                   :MDARVS-RMS-STYL-ID                                  02782606
                 , :MDARVS-CTG-SEQ-NBR                                  02782706
                FROM                                                    02782806
                      TMDARVS A                                         02782906
                WHERE                                                   02783006
                     A.RMS_STYL_ID   = :XLV00000-STYL-ID                02783106
                 AND A.ACTV_IND      = 'Y'                              02783206
                 WITH UR                                                02783306
            END-EXEC.                                                   02783406
                                                                        02783506
            EVALUATE TRUE                                               02783606
               WHEN SQLCODE = ZERO                                      02783706
                                                                        02783806
                  MOVE MDARVS-CTG-SEQ-NBR TO                            02783906
                                       SU125-CTG-SEQ-NBR (PV-ITEM-IDX)  02784006
                                                                        02784106
               WHEN SQLCODE = 100                                       02784206
                                                                        02784306
                  MOVE 0            TO SU125-CTG-SEQ-NBR (PV-ITEM-IDX)  02784406
                                                                        02784506
               WHEN SQLCODE NOT = ZERO                                  02784606
                                                                        02784706
                  MOVE SQLCODE                  TO PV-SQLCODE           02784806
                  MOVE XLV00000-STYL-ID         TO PV-STYLID-DISP       02784906
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02785006
                                                                        02785106
                  STRING 'SELECT TMDARVS FAILED WITH SQLCODE:'          02785206
                   PV-SQLCODE ' STYL ID:' PV-STYLID-DISP                02785306
                            DELIMITED BY SIZE INTO PV-ERROR-MSG         02785406
                                                                        02785506
                  MOVE '2860-FIND-STYL-CTG' TO PV-PARA-NAME             02785606
                  PERFORM 9995-CSSL-LOG-RETURN                          02785706
                                                                        02785806
            END-EVALUATE                                                02785906
            .                                                           02786006
       4000-FIND-PARENT-CARTON.                                         02786106
                                                                        02786206
            EXEC SQL                                                    02786306
               SELECT                                                   02786406
                   A.MSTR_SHIPT_UNT_ID                                  02786506
                 , A.ACTN_TYP_CDE                                       02786606
                INTO                                                    02786706
                    :SUT00099-MSTR-SHIPT-UNT-ID                         02786806
                  , :SUT00099-ACTN-TYP-CDE                              02786906
                FROM                                                    02787006
                      SUT_MSTR_SHIPT_CNT A                              02787106
                WHERE                                                   02787206
                     A.CHLD_SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID           02787306
                 AND A.CRE_TMST IN                                      02787406
                   (SELECT MAX(B.CRE_TMST)                              02787506
                    FROM SUT_MSTR_SHIPT_CNT B                           02787606
                    WHERE                                               02787706
                          A.CHLD_SHIPT_UNT_ID = B.CHLD_SHIPT_UNT_ID)    02787806
                 WITH UR                                                02787906
            END-EXEC.                                                   02788006
                                                                        02788106
            EVALUATE TRUE                                               02788206
               WHEN SQLCODE = ZERO                                      02788306
                                                                        02788406
                  IF SUT00099-ACTN-TYP-CDE = 'ACM' OR 'RTM'             02788506
                                                                        02788606
                     MOVE SUT00099-MSTR-SHIPT-UNT-ID TO                 02788706
                                               DK-CHLD-MSTR-SHIPT-ID    02788806
                                               PV-PRNT-CART-ID          02788906
                     MOVE 'N'                   TO PS-NO-MORE-MSTR-SW   02789006
                                                                        02789106
                     PERFORM 4100-FIND-PRNT-CART-ID UNTIL               02789206
                                                   PS-NO-MORE-MSTR      02789306
                                                                        02789406
                  ELSE                                                  02789506
                                                                        02789606
                     MOVE DK-SHIPT-UNT-ID TO PV-PRNT-CART-ID            02789706
                                                                        02789806
                  END-IF                                                02789906
                                                                        02790006
               WHEN SQLCODE = +100                                      02790106
                                                                        02790206
                  MOVE DK-SHIPT-UNT-ID TO PV-PRNT-CART-ID               02790306
                                                                        02790406
               WHEN SQLCODE NOT = ZERO                                  02790506
                                                                        02790606
                  MOVE SQLCODE                  TO PV-SQLCODE           02790706
                  MOVE DK-SHIPT-UNT-ID          TO PV-CARTON-DISP       02790806
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02790906
                                                                        02791006
                  STRING                                                02791106
                  'SELECT SUT_MSTR_SHIPT_CNT FAILED WITH SQLCODE:'      02791206
                   PV-SQLCODE ' CARTON:' PV-CARTON-DISP                 02791306
                            DELIMITED BY SIZE INTO PV-ERROR-MSG         02791406
                                                                        02791506
                  MOVE '4100-FIND-PRNT-CART-ID' TO PV-PARA-NAME         02791606
                  PERFORM 9995-CSSL-LOG-RETURN                          02791706
                                                                        02791806
            END-EVALUATE                                                02791906
            .                                                           02792006
                                                                        02792106
       4100-FIND-PRNT-CART-ID.                                          02792206
                                                                        02792306
            EXEC SQL                                                    02792406
               SELECT                                                   02792506
                   A.MSTR_SHIPT_UNT_ID                                  02792606
                 , A.ACTN_TYP_CDE                                       02792706
                INTO                                                    02792806
                    :SUT00099-MSTR-SHIPT-UNT-ID                         02792906
                  , :SUT00099-ACTN-TYP-CDE                              02793006
                FROM                                                    02793106
                      SUT_MSTR_SHIPT_CNT A                              02793206
                WHERE                                                   02793306
                     A.CHLD_MSTR_SHIPT_ID  = :DK-CHLD-MSTR-SHIPT-ID     02793406
                 AND A.CRE_TMST IN                                      02793506
                   (SELECT MAX(B.CRE_TMST)                              02793606
                    FROM SUT_MSTR_SHIPT_CNT B                           02793706
                    WHERE                                               02793806
                         A.CHLD_MSTR_SHIPT_ID = B.CHLD_MSTR_SHIPT_ID)   02793906
                 WITH UR                                                02794006
            END-EXEC.                                                   02794106
                                                                        02794206
            EVALUATE TRUE                                               02794306
               WHEN SQLCODE = ZERO                                      02794406
                                                                        02794506
                  IF SUT00099-ACTN-TYP-CDE = 'AMM'                      02794606
                                                                        02794706
                     MOVE SUT00099-MSTR-SHIPT-UNT-ID TO                 02794806
                                               DK-CHLD-MSTR-SHIPT-ID    02794906
                                               PV-PRNT-CART-ID          02795006
                                                                        02795106
                  ELSE                                                  02795206
                                                                        02795306
                     SET PS-NO-MORE-MSTR TO TRUE                        02795406
                                                                        02795506
                  END-IF                                                02795606
                                                                        02795706
               WHEN SQLCODE = +100                                      02795806
                                                                        02795906
                  SET PS-NO-MORE-MSTR TO TRUE                           02796006
                                                                        02796106
               WHEN SQLCODE NOT = ZERO                                  02796206
                                                                        02796306
                  MOVE SQLCODE                  TO PV-SQLCODE           02796406
                  MOVE DK-CHLD-MSTR-SHIPT-ID    TO PV-CARTON-DISP       02796506
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02796606
                                                                        02796706
                  STRING                                                02796806
                  'SELECT SUT_MSTR_SHIPT_CNT FAILED WITH SQLCODE:'      02796906
                   PV-SQLCODE ' CARTON:' PV-CARTON-DISP                 02797006
                            DELIMITED BY SIZE INTO PV-ERROR-MSG         02797106
                                                                        02797206
                  MOVE '4100-FIND-PRNT-CART-ID' TO PV-PARA-NAME         02797306
                  PERFORM 9995-CSSL-LOG-RETURN                          02797406
                                                                        02797506
            END-EVALUATE                                                02797606
            .                                                           02797706
       4400-CHECK-CARTON-RECEIVED.                                      02797806
                                                                        02797906
            EXEC SQL                                                    02798006
                SELECT                                                  02798106
                        A.SHIPT_UNT_ID                                  02798206
                  INTO                                                  02798306
                        :SUT00121-SHIPT-UNT-ID                          02798406
                  FROM  SUT_OTBND_STR_SCN A                             02798506
                 WHERE  A.SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID              02798606
                   AND  A.ACTV_IND      = 'Y'                           02798706
                WITH UR                                                 02798806
            END-EXEC.                                                   02798906
                                                                        02799006
            EVALUATE TRUE                                               02799106
               WHEN SQLCODE = ZERO                                      02799206
                                                                        02799306
                  MOVE 'Y'        TO SU125-CARTON-RECEIVED(PV-ITEM-IDX) 02799406
                                     PV-SAVE-RCVD-FLAG                  02799506
               WHEN SQLCODE = 100                                       02799606
                                                                        02799706
                  MOVE 'N'        TO SU125-CARTON-RECEIVED(PV-ITEM-IDX) 02799806
                                     PV-SAVE-RCVD-FLAG                  02799906
               WHEN SQLCODE = -811                                      02800006
                                                                        02800106
                  MOVE 'Y'        TO SU125-CARTON-RECEIVED(PV-ITEM-IDX) 02800206
                                     PV-SAVE-RCVD-FLAG                  02800306
               WHEN SQLCODE NOT = ZERO                                  02800406
                                                                        02800506
                  MOVE SQLCODE    TO PV-SQLCODE                         02800606
                  MOVE PC-TSYMSG-01570         TO PV-TSYMSG-NUMBER      02800706
                  STRING                                                02800806
                   'SELECT SUT_OTBND_STR_SCAN FAILED WITH SQLCODE:'     02800906
                         PV-SQLCODE ' SML#' PV-CARTON-DISP              02801006
                       DELIMITED BY SIZE INTO       PV-ERROR-MSG        02801106
                                                                        02801206
                  MOVE '4400-CHECK-CARTON-RECEIVED' TO PV-PARA-NAME     02801306
                  PERFORM 9995-CSSL-LOG-RETURN                          02801406
                                                                        02801506
            END-EVALUATE                                                02801606
            .                                                           02801706
113700 5280-GET-OPC-SET-CDE.                                            02801806
113800                                                                  02801906
113900     EXEC SQL                                                     02802006
114000         SELECT G.SEASET_SHRT_NM                                  02802106
114100           INTO :SEASET-SEASET-SHRT-NM                            02802206
114200           FROM  WST_INTGRTN_TYP  A                               02802306
114300                ,WST_ATTR_DEFN    B                               02802406
114400                ,WST_ATTR_ELEM    C                               02802506
114500                ,WST_ATTR_ELEM    D                               02802606
114600                ,WST_ATTR_ELEM    E                               02802706
114700                ,WST_ATTR_ELEM    F                               02802806
114800                ,TSEASET          G                               02802906
114900                ,TPURCHS          H                               02803006
115000            WHERE A.INTGRTN_TYP_CDE   = 'OPCMFST'                 02803106
                    AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         02803206
                    AND B.ATTR_DEFN_SEQ_NBR = 1                         02803306
                    AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         02803406
                    AND C.ATTR_DEFN_SEQ_NBR = 1                         02803506
                    AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         02803606
                    AND D.ATTR_DEFN_SEQ_NBR = 2                         02803706
                    AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         02803806
                    AND E.ATTR_DEFN_SEQ_NBR = 3                         02803906
                    AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE         02804006
                    AND F.ATTR_DEFN_SEQ_NBR = 4                         02804106
                    AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       02804206
                    AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       02804306
                    AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR       02804406
                    AND C.ATTR_ELEM_TXT     = G.SEASET_TYP_CDE          02804506
                    AND D.ATTR_ELEM_TXT     = 'ACTIVE'                  02804606
                    AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP         02804706
                    AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP         02804806
                    AND G.SEASET_SHRT_NM    = H.SEASET_SHRT_NM          02804906
                    AND G.SEASET_YR         = H.SEASET_YR               02805006
                    AND H.PO_NBR            = :DK-PO-NBR                02805106
                    AND H.VER_STATUS_CDE    = 'A'                       02805206
115100     END-EXEC.                                                    02805306
115200                                                                  02805406
115300     EVALUATE TRUE                                                02805506
115400         WHEN SQLCODE = ZERO                                      02805606
115500         WHEN SQLCODE = -811                                      02805706
115600             MOVE 'Y'       TO SU125-OPC-SET-IND(PV-ITEM-IDX)     02805806
                                     PV-SAVE-OPC-SET-IND                02805906
115800                                                                  02806006
115900         WHEN SQLCODE = +100                                      02806106
116000             MOVE 'N'       TO SU125-OPC-SET-IND(PV-ITEM-IDX)     02806206
                                     PV-SAVE-OPC-SET-IND                02806306
116200                                                                  02806406
116300         WHEN SQLWARN0 NOT = SPACES                               02806506
116400         WHEN SQLCODE < ZERO                                      02806606
116500         WHEN SQLCODE > ZERO                                      02806706
028452            MOVE SQLCODE    TO PV-SQLCODE                         02806806
028452            MOVE DK-PO-NBR  TO PV-PO-DISP                         02806906
028453            MOVE PC-TSYMSG-01570         TO PV-TSYMSG-NUMBER      02807006
028454            STRING                                                02807106
028455             'SELECT OPC SET CODE FAILED WITH SQLCODE:'           02807206
028456                   PV-SQLCODE ' PO#' PV-PO-DISP                   02807306
028457                 DELIMITED BY SIZE INTO       PV-ERROR-MSG        02807406
028458                                                                  02807506
028459            MOVE '5280-GET-OPC-SET-CDE'    TO PV-PARA-NAME        02807606
028460            PERFORM 9995-CSSL-LOG-RETURN                          02807706
028461                                                                  02807806
117200     END-EVALUATE.                                                02807906
117300                                                                  02808006
       9990-CSSL-LOG.                                                   02808106
                                                                        02808206
            MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.     02808306
                                                                        02808406
            EXEC CICS                                                   02808506
                 WRITEQ TD                                              02808606
                  QUEUE   ('CSSL')                                      02808706
                   FROM   (PV-CICS-MSG-AREA)                            02808806
                 LENGTH   (PV-COMMAREA-LENGTH)                          02808906
                   RESP   (PV-CICS-RESPONSE)                            02809006
            END-EXEC.                                                   02809106
                                                                        02809206
           .                                                            02809306
       9995-CSSL-LOG-RETURN.                                            02809406
                                                                        02809506
           PERFORM 9990-CSSL-LOG.                                       02809606
                                                                        02809706
           PERFORM 9000-RETURN-TRAN.                                    02809806
                                                                        02809906
       9000-RETURN-TRAN.                                                02810006
                                                                        02810106
           MOVE PV-TSYMSG-NUMBER         TO DP507I-MSG-NUMBER           02810206
                                            SU125-MSG-ID.               02810306
                                                                        02810406
           PERFORM 9010-READ-SYSTEM-MESSAGE.                            02810506
           MOVE DP507I-MSG-TEXT          TO SU125-MSG-TEXT              02810606
                                                                        02810706
           PERFORM 9999-PUT-CONTAINER                                   02810806
                                                                        02810906
      *CHANGE - CICS LOG FOR END OF THE PROGRAM                         02811006
           PERFORM 1050-GET-CURRENT-TIMESTAMP                           02811106
                                                                        02811206
           MOVE SPACES         TO PV-PARA-NAME                          02811306
                                  PV-ERROR-MSG                          02811406
                                                                        02811506
           STRING ' END SUKCS804 FOR TRIP ID: '                         02811606
           SU124-OUTBOUND-TRIP-ID                                       02811706
           DELIMITED BY SIZE INTO PV-ERROR-MSG                          02811806
                                                                        02811906
           PERFORM 9990-CSSL-LOG.                                       02812006
      *CHANGE - CICS LOG FOR END OF THE PROGRAM                         02812106
                                                                        02812206
           EXEC CICS RETURN END-EXEC                                    02812306
           .                                                            02812406
       9010-READ-SYSTEM-MESSAGE.                                        02812506
           EXEC CICS READ                                               02812606
                     DATASET ('DPSYSMSG')                               02812706
                     RIDFLD  (DP507I-MSG-NUMBER)                        02812806
                     INTO    (DP507I-MESSAGES-INPUT-RECORD)             02812906
                     RESP    (PV-CICS-RESPONSE)                         02813001
           END-EXEC.                                                    02820000
      *                                                                 02830000
           IF  PV-CICS-RESPONSE NOT = 0                                 02840000
               MOVE ' ** ABEND **   UNABLE TO TRANSLATE MESSAGE NUMBER' 02850000
                                      TO DP507I-MSG-TEXT                02860000
           END-IF.                                                      02870000
                                                                        02880000
       9999-PUT-CONTAINER.                                              02890000
                                                                        02900000
            EXEC CICS                                                   02910000
              PUT CONTAINER('DFHWS-DATA')                               02920000
              FROM(SU125-OUT-MANIFEST-DETAILS)                          02930000
              RESP(PV-CICS-RESPONSE)                                    02940000
            END-EXEC.                                                   02950000
                                                                        02960000
            EVALUATE PV-CICS-RESPONSE                                   02970000
                                                                        02980000
               WHEN DFHRESP(NORMAL)                                     02990000
                                                                        03000000
                  CONTINUE                                              03010000
                                                                        03020000
               WHEN OTHER                                               03030000
                                                                        03040000
                  MOVE PV-CICS-RESPONSE TO  PV-RESP-DISP                03050000
                                                                        03060000
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     03070000
                  STRING 'PUT CONTAINER FAILED CICS RESP CODE:'         03080000
                   PV-RESP-DISP DELIMITED BY SIZE INTO PV-ERROR-MSG     03090000
                                                                        03100000
                  MOVE '9999-PUT-CONTAINER   '      TO PV-PARA-NAME     03110000
                  PERFORM 9995-CSSL-LOG-RETURN                          03120000
                                                                        03130000
            END-EVALUATE.                                               03140000
                                                                        03150000
