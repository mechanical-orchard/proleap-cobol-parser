000100*----------------------------*                                    00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*----------------------------*                                    00030000
000400 PROGRAM-ID.    RCKUP821.                                         00040099
000500 AUTHOR.        JOHN HUTCHINSON.                                  00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  FEBRUARY, 2003.                                   00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090099
001000* -------------------------------------------------------------- *00100000
001100*    BATCH TRANSCRIBE/TROUBLE CONTROLLER CONVERTED FROM RCKCS821  00110099
001200*    IF EITHER THIS PROGRAM OR RCKCS821 CHANGE, THE OTHER SHOULD  00120099
001300*    BE CHECKED TO SEE IF THE SAME CHANGE SHOULD BE MADE          00130099
001400*                                                                 00140000
001500*    CALLED FROM TMKUP520 USING TMWS500 COMMAREA.                 00150099
001600*                                                                 00160000
001700*    MODULE (FOR BULK / PREPACK PROCESSES).                       00170099
001800*    ALL THE DB2 DATA NEEDED TO SUPPORT TROUBLE                   00180099
001900*    AND PRORATION WILL BE GATHERED IN THIS CONTROLLER, THEN      00190000
002000*    TABLEIZED INTO A COBOL DATA STRUCTURE AND PASSED BETWEEN     00200000
002100*    THE SUB-MODULES TO COMPLETE THE TROUBLE, PRORATION AND       00210000
002200*    ALLOCATION.  THE MAIN CONTROLLER WILL CALL A NEW OTR (OPEN   00220000
002300*    TO RECEIVE) ROUTINE TO SATISFY ALL OPEN TO RECEIVE CALCU-    00230000
002400*    LATIONS. UPON GATHERING ALL OF THE DATA ELEMENTS, THE MAIN   00240000
002500*    MODULE CALLS A NEW TROUBLE MODULE, THEN THE NEW PRORATION    00250000
002600*    MODULE, AND FINALLY THE ALLOCATION MODULE. THE ALLOCATION    00260000
002700*    MODULE DISTRIBUTES THE UNITS TO RECDIS.                      00270000
002800* -------------------------------------------------------------- *00280000
002900*----------------------------*                                    00290000
003000 ENVIRONMENT DIVISION.                                            00300000
003100*----------------------------*                                    00310000
003200 CONFIGURATION SECTION.                                           00320000
003300 SOURCE-COMPUTER.        IBM-3090.                                00330000
003400 OBJECT-COMPUTER.        IBM-3090.                                00340000
003500 DATA DIVISION.                                                   00350000
003600*----------------------------*                                    00360000
003700 WORKING-STORAGE SECTION.                                         00370000
003800*----------------------------*                                    00380000
003900 01  PS-PROGRAM-SWITCHES.                                         00390000
004000                                                                  00400000
004100     05  PS-DONE-SW              PIC  X(01)  VALUE 'N'.           00410000
004200         88  PS-DONE-YES                     VALUE 'Y'.           00420002
004300         88  PS-DONE-NO                      VALUE 'N'.           00430003
004400                                                                  00440000
004500     05  PS-END-OF-PO-BULK-SW    PIC  X(01)  VALUE 'N'.           00450000
004600         88  PS-PO-BULK-CSR-EOF              VALUE 'Y'.           00460000
004700         88  PS-PO-BULK-CSR-START            VALUE 'N'.           00470000
004800                                                                  00480000
004900     05  PS-END-OF-PO-PACK-SW    PIC  X(01)  VALUE 'N'.           00490000
005000         88  PS-PO-PACK-CSR-EOF              VALUE 'Y'.           00500000
005100         88  PS-PO-PACK-CSR-START            VALUE 'N'.           00510000
005200                                                                  00520000
005300     05  PS-END-OF-RC-BULK-SW    PIC  X(01)  VALUE 'N'.           00530000
005400         88  PS-RC-BULK-CSR-EOF              VALUE 'Y'.           00540000
005500         88  PS-RC-BULK-CSR-START            VALUE 'N'.           00550000
005600                                                                  00560000
005700     05  PS-END-OF-RC-PACK-SW    PIC  X(01)  VALUE 'N'.           00570000
005800         88  PS-RC-PACK-CSR-EOF              VALUE 'Y'.           00580000
005900         88  PS-RC-PACK-CSR-START            VALUE 'N'.           00590000
006000                                                                  00600000
006100     05  PS-UPDATE-RECITM-SW     PIC  X(01)  VALUE 'N'.           00610000
006200         88  PS-UPDATE-RECITM-YES            VALUE 'Y'.           00620000
006300         88  PS-UPDATE-RECITM-NO             VALUE 'N'.           00630000
006400                                                                  00640000
006500     05  PS-DRIVER-FOUND-SW      PIC  X(01)  VALUE 'N'.           00650000
006600         88  PS-DRIVER-FOUND-YES             VALUE 'Y'.           00660000
006700         88  PS-DRIVER-FOUND-NO              VALUE 'N'.           00670000
006800                                                                  00680000
006900     05  PS-DRIVER-LINE-SW       PIC  X(01)  VALUE 'Y'.           00690000
007000         88  PS-SAME-DRIVER-LINE-YES         VALUE 'Y'.           00700000
007100         88  PS-SAME-DRIVER-LINE-NO          VALUE 'N'.           00710000
007200                                                                  00720000
007300     05  PS-PACKAGE-CODE         PIC  X(01)  VALUE SPACE.         00730000
007400         88  PS-BULK                         VALUE 'B' 'C' 'S'.   00740000
007500         88  PS-PREPACK                      VALUE 'I' 'M'.       00750000
007600                                                                  00760000
007700 01  PC-PROGRAM-CONSTANTS.                                        00770000
007800     05  PC-CURRENT-PROGRAM-NAME PIC  X(08)  VALUE 'RCKUP821'.    00780099
007900     05  PC-RCKUP811             PIC  X(08)  VALUE 'RCKUP811'.    00790099
008000     05  PC-RCKUP822             PIC  X(08)  VALUE 'RCKUP822'.    00800099
008100     05  PC-RCKUP823             PIC  X(08)  VALUE 'RCKUP823'.    00810099
008200     05  PC-RCKUP824             PIC  X(08)  VALUE 'RCKUP824'.    00820099
008300     05  PC-RCKUT806             PIC  X(08)  VALUE 'RCKUT806'.    00830099
008400     05  PC-SPACE                PIC  X(01)  VALUE SPACE.         00840000
008500     05  PC-ZERO                 PIC  X(01)  VALUE '0'.           00850000
008600     05  PC-ONE                  PIC  X(01)  VALUE '1'.           00860000
008700     05  PC-A                    PIC  X(01)  VALUE 'A'.           00870000
008800     05  PC-B                    PIC  X(01)  VALUE 'B'.           00880000
008900     05  PC-C                    PIC  X(01)  VALUE 'C'.           00890000
009000     05  PC-I                    PIC  X(01)  VALUE 'I'.           00900000
009100     05  PC-K                    PIC  X(01)  VALUE 'K'.           00910000
009200     05  PC-M                    PIC  X(01)  VALUE 'M'.           00920000
009300     05  PC-N                    PIC  X(01)  VALUE 'N'.           00930000
009400     05  PC-O                    PIC  X(01)  VALUE 'O'.           00940000
009500     05  PC-P                    PIC  X(01)  VALUE 'P'.           00950000
009600     05  PC-R                    PIC  X(01)  VALUE 'R'.           00960000
009700     05  PC-S                    PIC  X(01)  VALUE 'S'.           00970000
009800     05  PC-X                    PIC  X(01)  VALUE 'X'.           00980000
009900     05  PC-U                    PIC  X(01)  VALUE 'U'.           00990000
010000     05  PC-Y                    PIC  X(01)  VALUE 'Y'.           01000000
010100     05  PC-AC                   PIC  X(02)  VALUE 'AC'.          01010000
010200     05  PC-AP                   PIC  X(02)  VALUE 'AP'.          01020000
010300     05  PC-CS                   PIC  X(02)  VALUE 'CS'.          01030000
010400     05  PC-DS                   PIC  X(02)  VALUE 'DS'.          01040000
010500     05  PC-DC                   PIC  X(02)  VALUE 'DC'.          01050000
010600     05  PC-IP                   PIC  X(02)  VALUE 'IP'.          01060000
010700     05  PC-IE                   PIC  X(02)  VALUE 'IE'.          01070000
010800     05  PC-IF                   PIC  X(02)  VALUE 'IF'.          01080000
010900     05  PC-IM                   PIC  X(02)  VALUE 'IM'.          01090000
011000     05  PC-RV                   PIC  X(02)  VALUE 'RV'.          01100000
011100     05  PC-03                   PIC  X(02)  VALUE '03'.          01110000
011200     05  PC-10                   PIC  X(03)  VALUE '010'.         01120000
011300     05  PC-11                   PIC  X(03)  VALUE '011'.         01130000
011400     05  PC-21                   PIC  X(03)  VALUE '021'.         01140000
011500     05  PC-26                   PIC  X(03)  VALUE '026'.         01150000
011600     05  PC-27                   PIC  X(03)  VALUE '027'.         01160000
011700     05  PC-28                   PIC  X(03)  VALUE '028'.         01170000
011800     05  PC-29                   PIC  X(03)  VALUE '029'.         01180000
011900     05  PC-30                   PIC  X(03)  VALUE '030'.         01190000
012000     05  PC-31                   PIC  X(03)  VALUE '031'.         01200000
012100     05  PC-32                   PIC  X(03)  VALUE '032'.         01210000
012200     05  PC-33                   PIC  X(03)  VALUE '033'.         01220000
012300     05  PC-34                   PIC  X(03)  VALUE '034'.         01230000
012400     05  PC-090                  PIC  X(03)  VALUE '090'.         01240000
012500     05  PC-267                  PIC S9(04)  VALUE +267 COMP.     01250000
012600     05  PC-570                  PIC S9(04)  VALUE +570 COMP.     01260000
012700     05  PC-9999                 PIC S9(04)  VALUE +9999 COMP.    01270051
012800                                                                  01280000
012900 01  DK-DATABASE-KEYS.                                            01290000
013000     05  DK-PREPK-RATO-QTY       PIC S9(04)  VALUE +0   COMP.     01300003
013100     05  DK-STR-NBR              PIC S9(04)  VALUE +0   COMP.     01310003
013200     05  DK-LOC-STR-NBR          PIC S9(04)  VALUE +0   COMP.     01320099
013300     05  DK-DC-NMBR              PIC S9(04)  VALUE +0   COMP.     01330099
013400     05  DK-LOC-NBR              PIC S9(04)  VALUE +090 COMP.     01340003
013500     05  DK-RCT-LOC-NBR          PIC S9(04)  VALUE +0   COMP.     01350003
013600     05  DK-DEPT-NBR             PIC S9(04)V VALUE +0   COMP-3.   01360003
013700     05  DK-MAJ-CL-NBR           PIC S9(04)V VALUE +0   COMP-3.   01370003
013800     05  DK-SUB-CL-NBR           PIC S9(04)V VALUE +0   COMP-3.   01380003
013900     05  DK-ITM-NBR              PIC S9(15)V VALUE +0   COMP-3.   01390003
014000     05  DK-PRORATE-IND          PIC  X(01)  VALUE SPACES.        01400000
014100     05  DK-ALLOC-IND            PIC  X(01)  VALUE SPACES.        01410000
014200     05  DK-PKGNG-CDE            PIC  X(01)  VALUE SPACES.        01420000
014300     05  DK-MERCH-TYPE-CDE       PIC  X(01)  VALUE SPACES.        01430000
014400     05  DK-TRB-LVL-CDE          PIC  X(01)  VALUE SPACES.        01440000
014500     05  DK-NEW-STORE-IND        PIC  X(01)  VALUE SPACES.        01450000
014600                                                                  01460003
014700 01  PV-PROGRAM-VARIABLES.                                        01470003
014800     05  PV-PARAGRAPH            PIC  X(30)  VALUE SPACES.        01480099
014900     05  PV-ABEND-CODE           PIC S9(04)  VALUE +0 COMP.       01490003
015000     05  PV-PO-RECEIV-CNT        PIC S9(09)  VALUE +0 COMP.       01500003
015100     05  PV-BULK-CNT             PIC S9(09)  VALUE +0 COMP.       01510003
015200     05  PV-PREPACK-CNT          PIC S9(09)  VALUE +0 COMP.       01520003
015300     05  PV-STORE-CNT            PIC S9(09)  VALUE +0 COMP.       01530060
015400     05  PV-SUM-STORE-PLAN-QTY   PIC S9(09)  VALUE +0 COMP.       01540003
015500     05  PV-ITEM                 PIC S9(04)  VALUE +0 COMP.       01550003
015600     05  PV-STORE-IDX            PIC S9(04)  VALUE +0 COMP.       01560099
015700     05  PV-ITEM-IDX             PIC S9(04)  VALUE +0 COMP.       01570099
015800     05  PV-SUB                  PIC S9(04)  VALUE +0 COMP.       01580003
015900     05  PV-HOLD-STR-COUNT       PIC S9(04)  VALUE +0 COMP.       01590003
016000     05  PV-HOLD-ITM-COUNT       PIC S9(04)  VALUE +0 COMP.       01600003
016100     05  PV-RANK-SEQ-NBR         PIC S9(04)  VALUE +0 COMP.       01610003
016200     05  PV-DISPLY-QTY           PIC  Z(09)9-.                    01620099
016300     05  PV-DISPLY-AMT           PIC  Z(07).99-.                  01630099
016400                                                                  01640003
016500 01  PV-DATE-FIELDS.                                              01650003
016600     05  PV-CURRENT-DATE           PIC  X(10) VALUE SPACES.       01660003
016700     05  PV-DB2-START-DATE         PIC  X(10) VALUE SPACES.       01670003
016800     05  PV-DB2-END-DATE           PIC  X(10) VALUE SPACES.       01680003
016900     05  PV-STR-ADJUSTED-OPEN-DATE PIC  X(10) VALUE SPACES.       01690003
017000     05  PV-EIBDATE.                                              01700003
017100         10  PV-EIBDATE-N          PIC  9(05).                    01710003
017200         10  FILLER                PIC  X(05).                    01720003
017300     05  PV-CPU-DATE.                                             01730003
017400         10  PV-YEAR               PIC  9(02).                    01740003
017500         10  PV-MONTH              PIC  9(02).                    01750003
017600         10  PV-DAY                PIC  9(02).                    01760003
017700                                                                  01770003
017800 01  PV-PO-RECEIVER-CONTENTS.                                     01780099
017900     05  PV-ORD-NBR                   PIC S9(09) COMP.            01790099
018000     05  PV-OPER-UNT-ID               PIC S9(04) COMP.            01800099
018100     05  PV-CRE-OPER-UNT-ID           PIC S9(04)  COMP.           01810099
018200     05  PV-CURR-OPER-UNT-ID          PIC S9(04)  COMP.           01820099
018300     05  PV-FCLTY-ID                  PIC S9(04) COMP.            01830099
018400     05  PV-REC-SEQ-NBR               PIC S9(09) COMP.            01840099
018500     05  PV-IMPRT-PO-IND              PIC  X(01).                 01850099
018600     05  PV-NEW-STR-IND               PIC  X(01).                 01860099
018700     05  PV-REC-COUNT                 PIC S9(09) COMP.            01870099
018800     05  PV-REC-TROUBLE-SHORT-CNT     PIC S9(04) COMP.            01880099
018900     05  PV-REC-TROUBLE-DCPACK-CNT    PIC S9(04) COMP.            01890099
019000     05  PV-RMS-PO-IND                PIC  X(01).                 01900099
019100     05  PV-DEPT-NBR                  PIC S9(04) COMP.            01910099
019200     05  PV-PKGNG-CDE                 PIC  X(01).                 01920099
019300     05  PV-PO-PKGNG-CDE              PIC  X(01).                 01930099
019400     05  PV-PACK-BY-STORE-IND         PIC  X(01).                 01940099
019500     05  PV-OTR-SCOPE-IND             PIC  X(01).                 01950099
019600     05  PV-PO-TYP-CDE                PIC  X(02).                 01960099
019700     05  PV-PLAN-NBR                  PIC S9(04) COMP.            01970099
019800     05  PV-CURR-SPLIT-QTY            PIC S9(09) COMP.            01980099
019900     05  PV-PK-SIZE-RND-CDE           PIC  X(01).                 01990099
020000     05  PV-ALLOC-OUTR-PK-QTY         PIC S9(09) COMP.            02000099
020100     05  PV-SUM-STR-PLAN-QTY          PIC S9(09) COMP.            02010099
020200     05  PV-SUM-STR-OTR-QTY           PIC S9(09) COMP.            02020099
020300     05  PV-SUM-STR-DISTRO-OTR-QTY    PIC S9(09) COMP.            02030099
020400     05  PV-SUM-STR-PLAN-PK           PIC S9(09) COMP.            02040099
020500     05  PV-SUM-STR-OTR-PK            PIC S9(09) COMP.            02050099
020600     05  PV-SUM-STR-DISTRO-OTR-PK     PIC S9(09) COMP.            02060099
020700     05  PV-VALID-DISTRO-IND          PIC  X(01).                 02070099
020800     05  PV-NO-TALLPLN-DISTRO-IND     PIC  X(01).                 02080099
020900     05  PV-NO-TMESTDS-DISTRO-IND     PIC  X(01).                 02090099
021000     05  PV-BAD-PACK-DISTRO-IND       PIC  X(01).                 02100099
021100     05  PV-OVER-PRORATE-CDE          PIC  X(01).                 02110099
021200     05  PV-SHORT-PRORATE-CDE         PIC  X(01).                 02120099
021300     05  PV-SHORT-USE-EX-RULES-IND    PIC  X(01).                 02130099
021400     05  PV-OVER-SHORT-CDE            PIC  X(01).                 02140099
021500     05  PV-TYPE-CODE                 PIC  X(02).                 02150099
021600     05  PV-DC-NMBR                   PIC  9(04).                 02160099
021700     05  PV-DC-RCT-STA-DTE            PIC  X(10).                 02170099
021800     05  PV-DC-RCT-STO-DTE            PIC  X(10).                 02180099
021900     05  PV-STR-COUNT                 PIC S9(04)    COMP.         02190099
022000     05  PV-ITEM-COUNT                PIC S9(04)    COMP.         02200099
022100     05  PV-MAX-STR-COUNT             PIC S9(04)    COMP.         02210099
022200     05  PV-MAX-ITEM-COUNT            PIC S9(04)    COMP.         02220099
022300     05  PV-LNE-ODU-TOL-QTY           PIC S9(09)    COMP.         02230099
022400     05  PV-LNE-ODU-TOL-AMT           PIC S9(05)V99 COMP-3.       02240099
022500     05  PV-PREPK-ODU-TOL-QTY         PIC S9(09)    COMP.         02250099
022600     05  PV-PREPK-ODU-TOL-AMT         PIC S9(05)V99 COMP-3.       02260099
022700     05  PV-DAYS-PR-CHG-NBR           PIC S9(02)V   COMP-3.       02270099
022800 01  PV-STORE-DETAIL.                                             02280099
022900     05  PV-STR-NBR                   PIC S9(04)    COMP.         02290099
023000     05  PV-ALLOC-LNE-NBR             PIC S9(04)    COMP.         02300099
023100     05  PV-OPENED-DATE               PIC  X(10).                 02310099
023200     05  PV-CLOSED-DATE               PIC  X(10).                 02320099
023300     05  PV-EXISTING-STORE-CDE        PIC  X(01).                 02330099
023400     05  PV-ST-TYPE-CODE              PIC  X(02).                 02340099
023500     05  PV-ST-DC1-NMBR               PIC  X(03).                 02350099
023600     05  PV-ST-DC1-RCT-STA-DTE        PIC  X(10).                 02360099
023700     05  PV-ST-DC1-RCT-STO-DTE        PIC  X(10).                 02370099
023800     05  PV-ST-DC2-NMBR               PIC  X(03).                 02380099
023900     05  PV-ST-DC2-RCT-STA-DTE        PIC  X(10).                 02390099
024000     05  PV-ST-DC2-RCT-STO-DTE        PIC  X(10).                 02400099
024100     05  PV-STR-VAL-OOR-IND           PIC  X(01).                 02410099
024200     05  PV-STR-GOOD-PLAN-IND         PIC  X(01).                 02420099
024300     05  PV-STR-DIST-QTY              PIC S9(09)    COMP.         02430099
024400     05  PV-STR-DIST-QTY-X            PIC  X(05).                 02440099
024500     05  PV-STR-DIST-PK               PIC S9(09)    COMP.         02450099
024600     05  PV-STR-DIST-OTR-QTY          PIC S9(09)    COMP.         02460099
024700     05  PV-STR-DIST-OTR-QTY-X        PIC  X(05).                 02470099
024800     05  PV-STR-DIST-OTR-PK           PIC S9(09)    COMP.         02480099
024900     05  PV-STR-OTR-PK                PIC S9(09)    COMP.         02490099
025000     05  PV-STR-OTR-QTY               PIC S9(09)    COMP.         02500099
025100     05  PV-STR-OTR-QTY-X             PIC  X(05).                 02510099
025200     05  PV-RNK-SEQ-NBR               PIC S9(04)    COMP.         02520099
025300 01  PV-REC-COMPONENTS.                                           02530099
025400     05  PV-REC-LNE-NBR               PIC S9(09)    COMP.         02540099
025500     05  PV-REC-ITEM-UPC-NBR          PIC S9(15)V   COMP-3.       02550099
025600     05  PV-REC-ITEM-UPC-INTR-ID      PIC S9(09)    COMP.         02560099
025700     05  PV-REC-ITEM-UPC-ID           PIC S9(09)    COMP.         02570099
025800     05  PV-REC-SKU-NBR               PIC S9(08)V   COMP-3.       02580099
025900     05  PV-REC-CLASS                 PIC S9(04)    COMP-3.       02590099
026000     05  PV-REC-SUBCLASS              PIC S9(04)    COMP-3.       02600099
026100     05  PV-WEB-ITEM-IND              PIC  X(01).                 02610099
026200     05  PV-REC-ITEM-NBR              PIC S9(15)V   COMP-3.       02620099
026300     05  PV-REC-CASE-PACK-QTY         PIC S9(04)    COMP.         02630099
026400     05  PV-REC-PACK-RATO-QTY         PIC S9(04)    COMP.         02640099
026500     05  PV-REC-INNER-PACK-QTY        PIC S9(04)    COMP.         02650099
026600     05  PV-SKU-INNER-PACK-QTY        PIC S9(04)    COMP.         02660099
026700     05  PV-ODD-UNIT-QTY              PIC S9(04)    COMP.         02670099
026800     05  PV-PKSL-ITM-QTY              PIC S9(09)    COMP.         02680099
026900     05  PV-DTL-CK-ITM-QTY            PIC S9(09)    COMP.         02690099
027000     05  PV-BEST-CASE-UNITS           PIC S9(09)    COMP.         02700099
027100     05  PV-DRV-LNE-CDE               PIC  X(01).                 02710099
027200     05  PV-SK-UNT-RTL-PR-AMT         PIC S9(07)V99 COMP-3.       02720099
027300     05  PV-SK-GP-RTL-AMT             PIC S9(07)V99 COMP-3.       02730099
027400     05  PV-SK-GP-QTY                 PIC S9(09)    COMP.         02740099
027500     05  PV-ITEM-DISTRO-QTY           PIC S9(09)    COMP.         02750099
027600     05  PV-ITEM-DISTRO-OTR-QTY       PIC S9(09)    COMP.         02760099
027700     05  PV-ITEM-OTR-QTY              PIC S9(09)    COMP.         02770099
027800 01  PV-PO-COMPONENTS.                                            02780099
027900     05  PV-PO-LNE-NBR                PIC S9(09)    COMP.         02790099
028000     05  PV-APP-PO-LNE-NBR            PIC S9(09)    COMP.         02800099
028100     05  PV-PO-SKU-NBR                PIC S9(08)V   COMP-3.       02810099
028200     05  PV-PO-CLASS                  PIC S9(04)V   COMP-3.       02820099
028300     05  PV-PO-SUBCLASS               PIC S9(04)V   COMP-3.       02830099
028400     05  PV-PO-ITEM-NBR               PIC S9(15)V   COMP-3.       02840099
028500     05  PV-PO-UNIT-QTY               PIC S9(09)    COMP.         02850099
028600     05  PV-PO-LNE-STATUS-CDE         PIC  X(02).                 02860099
028700     05  PV-PO-PACK-RATO-QTY          PIC S9(04)    COMP.         02870099
028800     05  PV-PO-UNT-RTL-PR-AMT         PIC S9(06)V99 COMP-3.       02880099
028900     05  PV-PO-GP-RTL-AMT             PIC S9(05)V99 COMP-3.       02890099
029000     05  PV-PO-GP-QTY                 PIC S9(04)    COMP.         02900099
029100     05  PV-DUMMY-SKU-IND             PIC  X(01).                 02910099
029200* -------------------------------------------------------------- *02920099
029300*    OUTPUT FORMAT FOR DISPLAY LINE                              *02930099
029400* -------------------------------------------------------------- *02940018
029500 01  RC001-WORK-FIELDS.                                           02950099
029600     05  RC001-LOG-LINE               PIC X(80) VALUE SPACES.     02960099
029700     05  RC001-SAVE-SQLCODE           PIC S9(8) COMP VALUE ZERO.  02970099
029800                                                                  02980018
029900 01  RC001-ERROR-MESSAGE-LINES.                                   02990018
030000     05  RC001-LINE-00.                                           03000099
030100         10  FILLER                   PIC X(27) VALUE             03010099
030200             '**********   PREPACK ERROR '.                       03020099
030300         10  RC001-PREPACK-PGM-NBR    PIC 9(03) VALUE ZERO.       03030099
030400         10  FILLER                   PIC X(01) VALUE '-'.        03040099
030500         10  RC001-PREPACK-ERROR-NBR  PIC 9(03) VALUE ZERO.       03050099
030600         10  FILLER                   PIC X(02) VALUE SPACES.     03060099
030700         10  FILLER                   PIC X(09)  VALUE            03070099
030800             ' USERID= '.                                         03080099
030900         10  RC001-USERID             PIC X(07) VALUE SPACES.     03090099
031000         10  FILLER                   PIC X(02) VALUE SPACES.     03100099
031100         10  FILLER                   PIC X(12) VALUE             03110099
031200             '  **********'.                                      03120099
031300     05  RC001-LINE-01.                                           03130018
031400         10  FILLER                   PIC X(44) VALUE             03140018
031500             '****** RCKUP821 - ALLOCATIONS ERROR ******  '.      03150099
031600         10  FILLER                   PIC X(03) VALUE SPACES.     03160018
031700         10  FILLER                   PIC X(08) VALUE             03170018
031800                                                'USERID= '.       03180018
031900         10  RC001-USERID             PIC X(07) VALUE SPACES.     03190018
032000         10  FILLER                   PIC X(18) VALUE SPACES.     03200018
032100     05  RC001-LINE-02.                                           03210018
032200         10  RC001-DATE               PIC X(10) VALUE SPACES.     03220018
032300         10  FILLER                   PIC X(02) VALUE SPACES.     03230018
032400         10  RC001-TIME               PIC X(08) VALUE SPACES.     03240018
032500         10  FILLER                   PIC X(02) VALUE SPACES.     03250018
032600         10  FILLER                   PIC X(11) VALUE             03260018
032700                                                'PARAGRAPH= '.    03270018
032800         10  RC001-PARAGRAPH          PIC X(30) VALUE ZEROES.     03280018
032900         10  FILLER                   PIC X(02) VALUE SPACES.     03290018
033000         10  FILLER                   PIC X(10) VALUE             03300018
033100                                                ' SQLCODE= '.     03310018
033200         10  RC001-SQLCODE            PIC -999.                   03320018
033300         10  FILLER                   PIC X(01) VALUE SPACES.     03330018
033400     05  RC001-LINE-03.                                           03340018
033500         10  FILLER                   PIC X(14) VALUE             03350018
033600                                                'PO/RCVR/LINE= '. 03360018
033700         10  RC001-PO.                                            03370018
033800             15  RC001-PO-NBR         PIC 9(08) VALUE ZEROES.     03380018
033900         10  FILLER                   PIC X(01) VALUE '/'.        03390018
034000         10  RC001-RCVR.                                          03400018
034100             15  RC001-REC-SEQ-NBR    PIC 9(03) VALUE ZEROES.     03410018
034200         10  FILLER                   PIC X(01) VALUE '/'.        03420018
034300         10  RC001-LINE.                                          03430018
034400             15 RC001-PO-LNE-NBR      PIC 9(03) VALUE ZEROES.     03440018
034500         10  FILLER                   PIC X(03) VALUE SPACES.     03450018
034600         10  FILLER                   PIC X(12) VALUE             03460018
034700                                                'OPER/FCLTY= '.   03470018
034800         10  RC001-OP.                                            03480018
034900             15 RC001-OPER-UNT-ID     PIC 9(04) VALUE ZEROES.     03490097
035000         10  FILLER                   PIC X(01) VALUE '/'.        03500018
035100         10  RC001-FCLTY.                                         03510018
035200             15  RC001-FCLTY-ID       PIC 9(01) VALUE ZEROES.     03520018
035300         10  FILLER                   PIC X(03) VALUE SPACES.     03530018
035400         10  FILLER                   PIC X(06) VALUE             03540018
035500                                                'PACK= '.         03550018
035600         10  RC001-PREPK-ID           PIC 9(04) VALUE ZEROES.     03560018
035700         10  FILLER                   PIC X(03) VALUE SPACES.     03570018
035800         10  FILLER                   PIC X(07) VALUE             03580018
035900                                                'STORE= '.        03590018
036000         10  RC001-STORE-NBR.                                     03600018
036100             15  RC001-STORE-NBR-N    PIC 9(04) VALUE ZEROES.     03610018
036200         10  FILLER                   PIC X(02) VALUE SPACES.     03620097
036300     05  RC001-LINE-04.                                           03630018
036400         10  RC001-SPECIAL-1          PIC X(40) VALUE SPACES.     03640099
036500         10  RC001-SPECIAL-2          PIC X(40) VALUE SPACES.     03650018
036600     05  RC001-LINE-05.                                           03660018
036700         10  FILLER                   PIC X(44) VALUE             03670018
036800             '****** RCKUP821 - ALLOCATIONS ERROR ******  '.      03680099
036900         10  FILLER                   PIC X(36) VALUE SPACES.     03690018
037000                                                                  03700003
037100 01  PRV-PROGRAM-RETURN-VARIABLES.                                03710099
037200     05  PRV-00                  PIC  X(42)  VALUE                03720099
037300                                '00PROGRAM CALL WAS SUCCESSFUL'.  03730099
037400     05  PRV-61                  PIC  X(42)  VALUE                03740099
037500                                '61RECEIVER IS NOT PRE-PACK'.     03750099
037600     05  PRV-62                  PIC  X(42)  VALUE                03760099
037700                                '62DRIVER LINE MISSING'.          03770099
037800     05  PRV-63                  PIC  X(42)  VALUE                03780099
037900                                '63INVALID KEY FIELDS'.           03790099
038000     05  PRV-64                  PIC  X(42)  VALUE                03800099
038100                                '64DB2 TIMEOUT ERROR'.            03810099
038200     05  PRV-65                  PIC  X(42)  VALUE                03820099
038300                                '65DB2 SQL ERROR'.                03830099
038400     05  PRV-66                  PIC  X(42)  VALUE                03840099
038500                                '66UNRECOVERABLE ERROR'.          03850099
038600* -------------------------------------------------------------- *03860003
038700*    COPYBOOK AREAS                                              *03870003
038800* -------------------------------------------------------------- *03880003
038900                                                                  03890003
039000* -------------------------------------------------------------- *03900099
039100*    INPUT PASSED FROM TMKCS520                                  *03910099
039200* -------------------------------------------------------------- *03920099
039300                                                                  03930099
039400     COPY TMWS500.                                                03940099
039500                                                                  03950003
039600     COPY TMWS501.                                                03960003
039700                                                                  03970003
039800* ERROR DATA PASSED BACK UPSTREAM.                                03980099
039900     COPY TMRD007.                                                03990099
040000                                                                  04000003
040100* -------------------------------------------------------------- *04010003
040200*    OUTPUT/INTERFACE DATA                                       *04020003
040300* -------------------------------------------------------------- *04030003
040400                                                                  04040003
040500* -------------------------------------------------------------- *04050003
040600*    COMMAREA DATA FOR ALLOCATION / PRORATION / TROUBLE *         04060099
040700* -------------------------------------------------------------- *04070003
040800                                                                  04080003
040900     COPY RCWS821.                                                04090099
041000                                                                  04100003
041100* -------------------------------------------------------------- *04110003
041200*    OPEN TO RECEIVE (OTR) COMMAREA                              *04120003
041300* -------------------------------------------------------------- *04130003
041400                                                                  04140003
041500     COPY RCWS822.                                                04150099
041600                                                                  04160003
041700* -------------------------------------------------------------- *04170003
041800*    TROUBLE COMMAREA                                            *04180003
041900* -------------------------------------------------------------- *04190003
042000                                                                  04200003
042100     COPY RCWS823.                                                04210099
042200                                                                  04220003
042300* -------------------------------------------------------------- *04230003
042400*    PRORATION COMMAREA                                          *04240003
042500* -------------------------------------------------------------- *04250003
042600                                                                  04260003
042700     COPY RCWS824.                                                04270099
042800                                                                  04280003
042900                                                                  04290003
043000* -------------------------------------------------------------- *04300003
043100*    PREPACK VALIDATION AREA                                     *04310003
043200* -------------------------------------------------------------- *04320003
043300                                                                  04330003
043400     COPY RCWS806.                                                04340003
043500                                                                  04350003
043600                                                                  04360003
043700* -------------------------------------------------------------- *04370003
043800*    RECDIS ROUTINE AREA                                         *04380003
043900* -------------------------------------------------------------- *04390003
044000                                                                  04400003
044100     COPY RCWS811.                                                04410003
044200                                                                  04420003
044300                                                                  04430003
044400* -------------------------------------------------------------- *04440003
044500*    CALENDAR VARIABLES                                          *04450003
044600* -------------------------------------------------------------- *04460003
044700                                                                  04470003
044800     COPY DPWS500.                                                04480052
044900                                                                  04490003
045000                                                                  04500003
045100* -------------------------------------------------------------- *04510003
045200*    LAYOUT FOR LOGISTICS DOMAIN ITEM ACCESS MODULE              *04520003
045300* -------------------------------------------------------------- *04530003
045400                                                                  04540003
045500     COPY XLWS001.                                                04550003
045600                                                                  04560003
045700*----------------------------------------------------------------*04570083
045800*  COPYBOOK FOR LOCATION CALL MODULE                              04580083
045900*-----------------------------------------------------------------04590083
046000     COPY XLWS071.                                                04600083
046100                                                                  04610083
046200                                                                  04620003
046300* -------------------------------------------------------------- *04630003
046400*    GLOBAL COMMAREA                                             *04640003
046500* -------------------------------------------------------------- *04650003
046600                                                                  04660003
046700     COPY DPWS020.                                                04670003
046800                                                                  04680099
046900* -------------------------------------------------------------- *04690003
047000*    DB2 SQL COMMUNICATION AREA                                  *04700003
047100* -------------------------------------------------------------- *04710003
047200                                                                  04720003
047300     EXEC SQL                                                     04730003
047400         INCLUDE SQLCA                                            04740003
047500     END-EXEC.                                                    04750003
047600                                                                  04760003
047700*XLT_DC_LOC_ASGMT                                                 04770099
047800     EXEC SQL                                                     04780099
047900         INCLUDE XLT00014                                         04790099
048000     END-EXEC.                                                    04800099
048100                                                                  04810099
048200                                                                  04820003
048300* -------------------------------------------------------------- *04830003
048400*    DB2 DCLGEN FOR TROUBLE RULES TABLE                          *04840003
048500* -------------------------------------------------------------- *04850003
048600                                                                  04860003
048700     EXEC SQL                                                     04870003
048800         INCLUDE RCT00000                                         04880003
048900     END-EXEC.                                                    04890003
049000                                                                  04900003
049100                                                                  04910003
049200* -------------------------------------------------------------- *04920003
049300*    DB2 DCLGEN FOR DEPARTMENT RANKING TABLE                     *04930003
049400* -------------------------------------------------------------- *04940003
049500                                                                  04950003
049600     EXEC SQL                                                     04960003
049700         INCLUDE RCT00005                                         04970003
049800     END-EXEC.                                                    04980003
049900                                                                  04990003
050000                                                                  05000003
050100* -------------------------------------------------------------- *05010003
050200*    DB2 DCLGEN FOR DEPARTMENT/MAJ CLASS RANKING TABLE           *05020003
050300* -------------------------------------------------------------- *05030003
050400                                                                  05040003
050500     EXEC SQL                                                     05050003
050600         INCLUDE RCT00006                                         05060003
050700     END-EXEC.                                                    05070003
050800                                                                  05080003
050900                                                                  05090003
051000* -------------------------------------------------------------- *05100003
051100*    DB2 DCLGEN FOR DEPARTMENT/MAJ/SUB CLASS RANKING TABLE       *05110003
051200* -------------------------------------------------------------- *05120003
051300                                                                  05130003
051400     EXEC SQL                                                     05140003
051500         INCLUDE RCT00007                                         05150003
051600     END-EXEC.                                                    05160003
051700                                                                  05170003
051800                                                                  05180003
051900* -------------------------------------------------------------- *05190003
052000*    DB2 DCLGEN FOR COMPANY WIDE RANKING TABLE                  * 05200003
052100* -------------------------------------------------------------- *05210003
052200                                                                  05220003
052300     EXEC SQL                                                     05230003
052400         INCLUDE RCT00008                                         05240003
052500     END-EXEC.                                                    05250003
052600                                                                  05260003
052700                                                                  05270003
052800* -------------------------------------------------------------- *05280003
052900*    DB2 DCLGEN FOR RCT_PRCG_CNTL TABLE                          *05290003
053000* -------------------------------------------------------------- *05300003
053100                                                                  05310003
053200     EXEC SQL                                                     05320003
053300         INCLUDE RCT00011                                         05330003
053400     END-EXEC.                                                    05340003
053500                                                                  05350003
053600                                                                  05360003
053700* -------------------------------------------------------------- *05370003
053800*    DB2 DCLGEN FOR PURCHASE ORDERS                              *05380003
053900* -------------------------------------------------------------- *05390003
054000                                                                  05400003
054100     EXEC SQL                                                     05410003
054200         INCLUDE TPURCHS                                          05420003
054300     END-EXEC.                                                    05430003
054400                                                                  05440003
054500                                                                  05450003
054600* -------------------------------------------------------------- *05460003
054700*    DB2 DCLGEN FOR PO PURCHASE ITEM TABLE (PO LINE ITEMS)       *05470003
054800* -------------------------------------------------------------- *05480003
054900                                                                  05490003
055000     EXEC SQL                                                     05500003
055100         INCLUDE TPURITM                                          05510003
055200     END-EXEC.                                                    05520003
055300                                                                  05530003
055400                                                                  05540003
055500* -------------------------------------------------------------- *05550003
055600*    DB2 DCLGEN FOR RECEIVER TABLE                               *05560003
055700* -------------------------------------------------------------- *05570003
055800                                                                  05580003
055900     EXEC SQL                                                     05590003
056000         INCLUDE TRECEIV                                          05600003
056100     END-EXEC.                                                    05610003
056200                                                                  05620003
056300                                                                  05630003
056400* -------------------------------------------------------------- *05640003
056500*    DB2 DCLGEN FOR RECEIVER ITEM                                *05650003
056600* -------------------------------------------------------------- *05660003
056700                                                                  05670003
056800     EXEC SQL                                                     05680003
056900         INCLUDE TRECITM                                          05690003
057000     END-EXEC.                                                    05700003
057100                                                                  05710003
057200* -------------------------------------------------------------- *05720003
057300*    DB2 DCLGEN FOR MERCHANDISE STORE ALLOCATION PLAN TABLE      *05730003
057400* -------------------------------------------------------------- *05740003
057500                                                                  05750003
057600     EXEC SQL                                                     05760003
057700         INCLUDE TALLPLN                                          05770003
057800     END-EXEC.                                                    05780003
057900                                                                  05790003
058000                                                                  05800003
058100* -------------------------------------------------------------- *05810003
058200*    DB2 DCLGEN FOR MERCHANDISE STORE DISTRIBUTION PLAN TABLE    *05820003
058300* -------------------------------------------------------------- *05830003
058400                                                                  05840003
058500     EXEC SQL                                                     05850003
058600         INCLUDE TMESTDS                                          05860003
058700     END-EXEC.                                                    05870003
058800                                                                  05880003
058900                                                                  05890003
059000     EXEC SQL                                                     05900003
059100         INCLUDE TPOPRPK                                          05910003
059200     END-EXEC.                                                    05920003
059300                                                                  05930003
059400                                                                  05940003
059500     EXEC SQL                                                     05950003
059600         INCLUDE TTRBNTF                                          05960003
059700     END-EXEC.                                                    05970003
059800                                                                  05980003
059900                                                                  05990003
060000     EXEC SQL                                                     06000003
060100         INCLUDE TCOCNTL                                          06010003
060200     END-EXEC.                                                    06020003
060300                                                                  06030003
060400     EXEC SQL                                                     06040003
060500         INCLUDE XLT00004                                         06050003
060600     END-EXEC.                                                    06060003
060700                                                                  06070074
060800                                                                  06080003
060900     EXEC SQL                                                     06090003
061000         INCLUDE TKRPRPM                                          06100003
061100     END-EXEC.                                                    06110003
061200                                                                  06120003
061300                                                                  06130003
061400* -------------------------------------------------------------- *06140003
061500*    PO CURSORS                                                  *06150003
061600*                                                                *06160003
061700*    BULK                                                        *06170003
061800* -------------------------------------------------------------- *06180003
061900                                                                  06190003
062000     EXEC SQL                                                     06200003
062100                                                                  06210003
062200         DECLARE PO-BULK-CSR CURSOR FOR                           06220003
062300                                                                  06230003
062400           SELECT A.DEPT_NBR                                      06240003
062500                , A.NEW_STR_PO_IND                                06250003
062600                , A.PO_TYP_CDE                                    06260003
062700                , A.IMPRT_PO_IND                                  06270003
062800                , A.PKGNG_CDE                                     06280065
062900                , A.PO_IN_RMS_IND                                 06290003
063000                , B.PO_LNE_NBR                                    06300003
063100                , B.APP_PO_LNE_NBR                                06310003
063200                , B.SKU_SEQ_NBR                                   06320003
063300                , B.STATUS_CDE                                    06330003
063400                , B.UNT_QTY                                       06340003
063500                , B.UNT_RTL_PR_AMT                                06350003
063600                , B.GP_RTL_AMT                                    06360003
063700                , B.GP_QTY                                        06370003
063800                , B.PIC_ITM_IND                                   06380003
063900                , B.ITM_NBR                                       06390003
064000                                                                  06400003
064100           FROM TPURCHS A                                         06410003
064200              , TPURITM B                                         06420003
064300                                                                  06430003
064400          WHERE A.PO_NBR          =  :RC821-ORD-NBR               06440099
064500            AND A.PO_NBR          =   B.PO_NBR                    06450003
064600            AND A.VER_STATUS_CDE  =  :PC-A                        06460003
064700            AND A.VER_STATUS_CDE  =   B.VER_STATUS_CDE            06470003
064800            AND B.APP_PO_LNE_NBR  =  :RC821-REC-DRV-LNE-NBR       06480099
064900                                                                  06490003
065000          WITH UR                                                 06500003
065100                                                                  06510003
065200     END-EXEC.                                                    06520003
065300                                                                  06530003
065400                                                                  06540003
065500* -------------------------------------------------------------- *06550003
065600*    PREPACK                                                     *06560003
065700* -------------------------------------------------------------- *06570003
065800                                                                  06580003
065900     EXEC SQL                                                     06590003
066000                                                                  06600003
066100       DECLARE PO-PACK-CSR CURSOR FOR                             06610003
066200                                                                  06620003
066300         SELECT A.DEPT_NBR                                        06630003
066400              , A.NEW_STR_PO_IND                                  06640003
066500              , A.PO_TYP_CDE                                      06650003
066600              , A.IMPRT_PO_IND                                    06660003
066700              , A.PKGNG_CDE                                       06670066
066800              , A.PO_IN_RMS_IND                                   06680003
066900              , B.PO_LNE_NBR                                      06690003
067000              , B.APP_PO_LNE_NBR                                  06700003
067100              , B.SKU_SEQ_NBR                                     06710003
067200              , B.STATUS_CDE                                      06720003
067300              , B.UNT_QTY                                         06730003
067400              , B.UNT_RTL_PR_AMT                                  06740003
067500              , B.GP_RTL_AMT                                      06750003
067600              , B.GP_QTY                                          06760003
067700              , B.PIC_ITM_IND                                     06770003
067800              , B.ITM_NBR                                         06780003
067900              , B.PREPK_RATO_QTY                                  06790003
068000              , C.PREPK_TYP_CDE                                   06800003
068100              , C.PREPK_STAT_CDE                                  06810003
068200              , C.PREPK_UPC_NBR                                   06820003
068300              , C.INPK_UNT_QTY                                    06830003
068400              , C.OTPK_UNT_QTY                                    06840003
068500              , C.PK_SKU_NBR                                      06850003
068600                                                                  06860003
068700             FROM TPURCHS A                                       06870003
068800                , TPURITM B                                       06880003
068900                , TPOPRPK C                                       06890003
069000                                                                  06900003
069100         WHERE A.PO_NBR          =  :RC821-ORD-NBR                06910099
069200           AND A.PO_NBR          =   B.PO_NBR                     06920003
069300           AND A.PO_NBR          =   C.PO_NBR                     06930003
069400           AND A.VER_STATUS_CDE  =  :PC-A                         06940003
069500           AND A.VER_STATUS_CDE  =   B.VER_STATUS_CDE             06950003
069600           AND B.PO_PREPK_ID     =  :RC821-PREPK-ID               06960099
069700           AND B.PO_PREPK_ID     =   C.PO_PREPK_ID                06970003
069800                                                                  06980003
069900         ORDER BY B.APP_PO_LNE_NBR                                06990003
070000                                                                  07000003
070100          WITH UR                                                 07010003
070200                                                                  07020003
070300     END-EXEC.                                                    07030003
070400                                                                  07040003
070500                                                                  07050003
070600* -------------------------------------------------------------- *07060053
070700*    RMS PACK '99' CURSOR                                        *07070053
070800* -------------------------------------------------------------- *07080053
070900                                                                  07090053
071000     EXEC SQL                                                     07100053
071100                                                                  07110053
071200       DECLARE PO-PACK-99-CSR CURSOR FOR                          07120053
071300                                                                  07130053
071400         SELECT A.DEPT_NBR                                        07140053
071500              , A.NEW_STR_PO_IND                                  07150053
071600              , A.PO_TYP_CDE                                      07160053
071700              , A.IMPRT_PO_IND                                    07170053
071800              , A.PKGNG_CDE                                       07180067
071900              , A.PO_IN_RMS_IND                                   07190053
072000              , B.PO_LNE_NBR                                      07200053
072100              , B.APP_PO_LNE_NBR                                  07210053
072200              , B.SKU_SEQ_NBR                                     07220053
072300              , B.STATUS_CDE                                      07230053
072400              , B.UNT_QTY                                         07240053
072500              , B.UNT_RTL_PR_AMT                                  07250053
072600              , B.GP_RTL_AMT                                      07260053
072700              , B.GP_QTY                                          07270053
072800              , B.PIC_ITM_IND                                     07280053
072900              , B.ITM_NBR                                         07290053
073000              , B.PREPK_RATO_QTY                                  07300053
073100                                                                  07310053
073200           FROM TPURCHS A                                         07320053
073300              , TPURITM B                                         07330053
073400              , TRECITM C                                         07340053
073500                                                                  07350053
073600          WHERE A.PO_NBR          =  :RC821-ORD-NBR               07360099
073700            AND A.PO_NBR          =   B.PO_NBR                    07370053
073800            AND A.PO_NBR          =   B.PO_NBR                    07380053
073900            AND A.VER_STATUS_CDE  =  :PC-A                        07390053
074000            AND A.VER_STATUS_CDE  =   B.VER_STATUS_CDE            07400053
074100            AND A.PO_NBR          =   C.ORD_NBR                   07410053
074200            AND B.APP_PO_LNE_NBR  =   C.ORD_LNE_NBR               07420053
074300            AND C.REC_SEQ_NBR     =  :RC821-REC-SEQ-NBR           07430099
074400            AND C.OPER_UNT_ID     =  :RC821-OPER-UNT-ID           07440099
074500            AND C.FCLTY_ID        =  :RC821-FCLTY-ID              07450099
074600            AND C.VER_STATUS_CDE  =  :PC-A                        07460053
074700       ORDER BY B.APP_PO_LNE_NBR                                  07470053
074800                                                                  07480053
074900        WITH UR                                                   07490053
075000                                                                  07500053
075100     END-EXEC.                                                    07510053
075200                                                                  07520053
075300* -------------------------------------------------------------- *07530053
075400*    RC CURSORS                                                  *07540003
075500*                                                                *07550003
075600*    BULK                                                        *07560003
075700* -------------------------------------------------------------- *07570003
075800                                                                  07580003
075900     EXEC SQL                                                     07590003
076000                                                                  07600003
076100       DECLARE RC-BULK-CSR CURSOR FOR                             07610003
076200                                                                  07620003
076300         SELECT CRE_TMST                                          07630003
076400              , STATUS_CDE                                        07640003
076500              , ORD_LNE_NBR                                       07650003
076600              , PKSL_ITM_QTY                                      07660003
076700              , DTL_CK_ITM_QTY                                    07670003
076800              , PREPK_RATO_QTY                                    07680003
076900              , CASE_PACK_QTY                                     07690003
077000              , CASE                                              07700003
077100                    INNR_PACK_QTY                                 07710003
077200                      WHEN 0                                      07720003
077300                      THEN 1                                      07730003
077400                ELSE                                              07740003
077500                    INNR_PACK_QTY                                 07750003
077600                END                                               07760003
077700                                                                  07770003
077800              , PREPK_ODD_UNT_QTY                                 07780003
077900              , PREPK_DRV_LNE_CDE                                 07790003
078000              , ITM_NBR                                           07800003
078100                                                                  07810003
078200            FROM TRECITM                                          07820003
078300                                                                  07830003
078400         WHERE ORD_NBR         =  :RC821-ORD-NBR                  07840099
078500           AND ORD_LNE_NBR     =  :RC821-REC-DRV-LNE-NBR          07850099
078600           AND REC_SEQ_NBR     =  :RC821-REC-SEQ-NBR              07860099
078700           AND OPER_UNT_ID     =  :RC821-OPER-UNT-ID              07870099
078800           AND FCLTY_ID        =  :RC821-FCLTY-ID                 07880099
078900           AND VER_STATUS_CDE  =  :PC-A                           07890003
079000                                                                  07900003
079100          WITH UR                                                 07910003
079200                                                                  07920003
079300     END-EXEC.                                                    07930003
079400                                                                  07940003
079500                                                                  07950003
079600* -------------------------------------------------------------- *07960003
079700*    PREPACK                                                     *07970003
079800* -------------------------------------------------------------- *07980003
079900                                                                  07990003
080000     EXEC SQL                                                     08000003
080100                                                                  08010003
080200       DECLARE RC-PACK-CSR CURSOR FOR                             08020003
080300                                                                  08030003
080400         SELECT CRE_TMST                                          08040003
080500              , STATUS_CDE                                        08050003
080600              , ORD_LNE_NBR                                       08060003
080700              , PKSL_ITM_QTY                                      08070003
080800              , DTL_CK_ITM_QTY                                    08080003
080900              , PREPK_RATO_QTY                                    08090003
081000              , CASE_PACK_QTY                                     08100003
081100                                                                  08110003
081200              , CASE                                              08120003
081300                    INNR_PACK_QTY                                 08130003
081400                      WHEN 0                                      08140003
081500                      THEN 1                                      08150003
081600                ELSE                                              08160003
081700                    INNR_PACK_QTY                                 08170003
081800                END                                               08180003
081900                                                                  08190003
082000              , PREPK_ODD_UNT_QTY                                 08200003
082100              , PREPK_DRV_LNE_CDE                                 08210003
082200              , ITM_NBR                                           08220003
082300                                                                  08230003
082400           FROM TRECITM                                           08240003
082500                                                                  08250003
082600         WHERE ORD_NBR         =  :RC821-ORD-NBR                  08260099
082700           AND PREPK_ID        =  :RC821-PREPK-ID                 08270099
082800           AND REC_SEQ_NBR     =  :RC821-REC-SEQ-NBR              08280099
082900           AND OPER_UNT_ID     =  :RC821-OPER-UNT-ID              08290099
083000           AND FCLTY_ID        =  :RC821-FCLTY-ID                 08300099
083100           AND VER_STATUS_CDE  =  :PC-A                           08310003
083200           AND PREPK_RATO_QTY  >  0                               08320003
083300                                                                  08330003
083400          WITH UR                                                 08340003
083500                                                                  08350003
083600     END-EXEC.                                                    08360003
083700                                                                  08370003
083800                                                                  08380003
083900*----------------------------*                                    08390003
084000 LINKAGE SECTION.                                                 08400003
084100*----------------------------*                                    08410003
084200 01  TM500-COMMAREA              PIC X(600).                      08420099
084300 01  LINK-TMRD007                PIC X(800).                      08430099
084400                                                                  08440003
084500*----------------------------*                                    08450003
084600 PROCEDURE DIVISION USING TM500-COMMAREA                          08460099
084700                          LINK-TMRD007.                           08470099
084800*----------------------------*                                    08480003
084900                                                                  08490003
085000 0000-MAIN-MODULE.                                                08500003
085100                                                                  08510003
085200     PERFORM 1000-INITIALIZE.                                     08520003
085300                                                                  08530099
085400     MOVE TM500-PO-NBR            TO  RC821-ORD-NBR.              08540099
085500     MOVE TM500-OPER-UNT-ID       TO  RC821-OPER-UNT-ID.          08550099
085600     MOVE TM500-FCLTY-ID          TO  RC821-FCLTY-ID.             08560099
085700     MOVE TM500-REC-SEQ-NBR       TO  RC821-REC-SEQ-NBR.          08570099
085800     MOVE TM500-NEW-STR-PO-IND    TO  RC821-NEW-STR-IND.          08580099
085900     MOVE TM500-PKGNG-CDE         TO  RC821-PKGNG-CDE.            08590099
086000     MOVE TM500-PO-LNE-NBR        TO  RC821-REC-DRV-LNE-NBR.      08600099
086100     MOVE TM500-PREPK-ID          TO  RC821-PREPK-ID.             08610099
086200     MOVE PC-N                    TO  RC821-BAD-PACK-DISTRO-IND.  08620099
086300     MOVE PC-Y                    TO  RC821-VALID-DISTRO-IND.     08630099
086400     MOVE PC-U                    TO  RC821-OVER-SHORT-CDE.       08640099
086500     MOVE PRV-00                  TO  TM500-RETURN-DATA.          08650099
086600                                                                  08660099
086700     PERFORM 4080-GET-REC-CONTROL-INFO.                           08670003
086800                                                                  08680003
086900     IF PS-DONE-NO                                                08690003
087000         IF PS-PREPACK  AND  RC821-PREPK-ID > 0                   08700099
087100             IF    NOT TM500-PREPACK-EDIT-ONLY                    08710042
087200               AND NOT TM500-RESOLVE-AUTO                         08720025
087300                 PERFORM 1100-CHECK-RECDIS-ALLOC                  08730003
087400             END-IF                                               08740003
087500         END-IF                                                   08750003
087600     END-IF.                                                      08760003
087700                                                                  08770003
087800     IF PS-DONE-NO                                                08780003
087900         PERFORM 2000-GET-PO-DATA                                 08790003
088000     END-IF.                                                      08800003
088100                                                                  08810003
088200     IF PS-DONE-NO                                                08820003
088300         PERFORM 3000-GET-RC-DATA                                 08830003
088400     END-IF.                                                      08840003
088500                                                                  08850003
088600     IF PS-DONE-NO                                                08860003
088700         PERFORM 4000-GET-MISC-DATA                               08870003
088800     END-IF.                                                      08880003
088900                                                                  08890003
089000     IF PS-DONE-NO                                                08900003
089100         IF PS-PREPACK  AND  RC821-PREPK-ID > 0                   08910099
089200             PERFORM 4120-VERIFY-PACK                             08920003
089300         END-IF                                                   08930003
089400     END-IF.                                                      08940003
089500                                                                  08950003
089600                                                                  08960003
089700*    --------------------------------------------------------    *08970003
089800*         CALL RCKUP822 - OPEN TO RECEIVE (OTR) ROUTINE           08980099
089900*    --------------------------------------------------------    *08990003
090000                                                                  09000003
090100     IF PS-DONE-NO                                                09010003
090200         IF RC821-NO-TALLPLN-DISTRO-IND  EQUAL PC-N AND           09020099
090300            RC821-NO-TMESTDS-DISTRO-IND  EQUAL PC-N               09030099
090400             PERFORM 5000-CALL-OTR                                09040099
090500         ELSE                                                     09050099
090600             PERFORM 0001-DISPLAY-ATTENTION-MESSAGE               09060099
090700         END-IF                                                   09070099
090800     ELSE                                                         09080099
090900         PERFORM 0005-DISPLAY-ATTENTION-MESSAGE                   09090099
091000     END-IF.                                                      09100003
091100                                                                  09110003
091200*    --------------------------------------------------------    *09120003
091300*               CALL RCKUP823 - TROUBLE ROUTINE                   09130099
091400*    --------------------------------------------------------    *09140003
091500                                                                  09150003
091600     IF PS-DONE-NO                                                09160003
091700         PERFORM 6000-CALL-TROUBLE-ROUTINE                        09170003
091800     END-IF.                                                      09180003
091900                                                                  09190003
092000*    --------------------------------------------------------    *09200003
092100*                CALL RCKUP824 - PRORATION ROUTINE                09210099
092200*    --------------------------------------------------------    *09220003
092300                                                                  09230003
092400     IF PS-DONE-NO                                                09240058
092500         PERFORM 7000-CALL-PRORATION-ROUTINE                      09250003
092600     END-IF.                                                      09260003
092700                                                                  09270003
092800     IF PS-DONE-NO                                                09280058
092900         IF PS-PREPACK  AND  RC821-PREPK-ID > 0                   09290099
093000             PERFORM 1200-RC811-DISTRO-ROUTINE                    09300003
093100         END-IF                                                   09310003
093200     END-IF.                                                      09320003
093300                                                                  09330003
093400     PERFORM 9020-PO-RECEIVER-CONTENTS.                           09340099
093500                                                                  09350099
093600     PERFORM 9040-REC-PACK.                                       09360099
093700                                                                  09370099
093800     PERFORM 9050-STORE-COMPONENTS                                09380099
093900       VARYING RC821-STORE-IDX FROM 1 BY 1                        09390099
094000         UNTIL RC821-STR-NBR (RC821-STORE-IDX) EQUAL ZERO         09400099
094100           OR  RC821-STORE-IDX > RC821-MAX-STR-COUNT.             09410099
094200                                                                  09420099
094300     PERFORM 9060-ITEM-COMPONENTS                                 09430099
094400       VARYING RC821-ITEM-IDX FROM 1 BY 1                         09440099
094500         UNTIL RC821-REC-LNE-NBR (RC821-ITEM-IDX) EQUAL ZERO      09450099
094600           OR  RC821-ITEM-IDX > RC821-MAX-ITEM-COUNT.             09460099
094700                                                                  09470099
094800     PERFORM 9070-PO-COMPONENTS                                   09480099
094900       VARYING RC821-ITEM-IDX FROM 1 BY 1                         09490099
095000         UNTIL RC821-PO-LNE-NBR (RC821-ITEM-IDX) EQUAL ZERO       09500099
095100           OR  RC821-ITEM-IDX > RC821-MAX-ITEM-COUNT.             09510099
095200                                                                  09520003
095300*    --------------------------                                   09530003
095400*    RETURN TO CALLING PROGRAM.                                   09540003
095500*    --------------------------                                   09550003
095600     PERFORM 9999-GOBACK.                                         09560099
095700                                                                  09570099
095800 0001-DISPLAY-ATTENTION-MESSAGE.                                  09580099
095900                                                                  09590099
096000     DISPLAY '---------------------------------------'            09600099
096100     DISPLAY '  ATTENTION    ATTENTION    ATTENTION  '            09610099
096200     DISPLAY '                                       '            09620099
096300     DISPLAY ' TALLPLN DISTRO IND  : '                            09630099
096400               RC821-NO-TALLPLN-DISTRO-IND                        09640099
096500     DISPLAY ' TMESTDS DISTRO IND  : '                            09650099
096600               RC821-NO-TMESTDS-DISTRO-IND                        09660099
096700     DISPLAY '                                       '            09670099
096800     DISPLAY '-------------------------------------- '            09680099
096900     DISPLAY '***  OTR ROUTINE WAS NOT EXECUTED  *** '            09690099
097000     DISPLAY '-------------------------------------- '            09700099
097100     DISPLAY '                                       '            09710099
097200     DISPLAY '  ATTENTION    ATTENTION    ATTENTION  '            09720099
097300     DISPLAY '---------------------------------------'.           09730099
097400                                                                  09740099
097500                                                                  09750099
097600 0002-DISPLAY-ATTENTION-MESSAGE.                                  09760099
097700                                                                  09770099
097800     DISPLAY '------------------------------------------'         09780099
097900     DISPLAY '    ATTENTION    ATTENTION    ATTENTION   '         09790099
098000     DISPLAY '                                          '         09800099
098100     DISPLAY '------------------------------------------'         09810099
098200     DISPLAY '***  TROUBLE ROUTINE WAS NOT EXECUTED  ***'         09820099
098300     DISPLAY '------------------------------------------'         09830099
098400     DISPLAY '                                          '         09840099
098500     DISPLAY '    ATTENTION    ATTENTION    ATTENTION   '         09850099
098600     DISPLAY '------------------------------------------'.        09860099
098700                                                                  09870099
098800                                                                  09880099
098900 0003-DISPLAY-ATTENTION-MESSAGE.                                  09890099
099000                                                                  09900099
099100     DISPLAY '--------------------------------------------'       09910099
099200     DISPLAY '    ATTENTION    ATTENTION    ATTENTION     '       09920099
099300     DISPLAY '                                            '       09930099
099400     DISPLAY '--------------------------------------------'       09940099
099500     DISPLAY '***  PRORATION ROUTINE WAS NOT EXECUTED  ***'       09950099
099600     DISPLAY '--------------------------------------------'       09960099
099700     DISPLAY '                                            '       09970099
099800     DISPLAY '    ATTENTION    ATTENTION    ATTENTION     '       09980099
099900     DISPLAY '--------------------------------------------'.      09990099
100000                                                                  10000099
100100                                                                  10010099
100200 0005-DISPLAY-ATTENTION-MESSAGE.                                  10020099
100300                                                                  10030099
100400     DISPLAY '---------------------------------------'            10040099
100500     DISPLAY '  ATTENTION    ATTENTION    ATTENTION  '            10050099
100600     DISPLAY '                                       '            10060099
100700     DISPLAY '---------------------------------------'            10070099
100800     DISPLAY '***  OTR ROUTINE WAS NOT EXECUTED  *** '            10080099
100900     DISPLAY '---------------------------------------'            10090099
101000     DISPLAY '                                       '            10100099
101100     DISPLAY '  ATTENTION    ATTENTION    ATTENTION  '            10110099
101200     DISPLAY '---------------------------------------'.           10120099
101300                                                                  10130099
101400* -------------------------------------------------------------- *10140003
101500* -------------------------------------------------------------- *10150003
101600*               I N I T I A L I Z A T I O N                      *10160003
101700* -------------------------------------------------------------- *10170003
101800* -------------------------------------------------------------- *10180003
101900                                                                  10190003
102000 1000-INITIALIZE.                                                 10200003
102100                                                                  10210003
102200     MOVE '1000-INITIALIZE    ' TO RC001-PARAGRAPH.               10220033
102300                                                                  10230003
102400     MOVE RC821-MAX-STR-COUNT   TO  PV-HOLD-STR-COUNT.            10240099
102500     MOVE RC821-MAX-ITEM-COUNT  TO  PV-HOLD-ITM-COUNT.            10250099
102600                                                                  10260003
102700     INITIALIZE RC821-DATA-FIELDS                                 10270099
102800                RC822-COMMAREA                                    10280099
102900                RC823-COMMAREA                                    10290099
103000                RC824-COMMAREA                                    10300099
103100                TM500-FIELDS.                                     10310003
103200                                                                  10320003
103300     MOVE ZEROES             TO  PV-ITEM.                         10330003
103400     MOVE PV-HOLD-STR-COUNT  TO  RC821-MAX-STR-COUNT.             10340099
103500     MOVE PV-HOLD-ITM-COUNT  TO  RC821-MAX-ITEM-COUNT.            10350099
103600                                                                  10360003
103700     MOVE TM500-COMMAREA  TO  TM500-FIELDS.                       10370099
103800     MOVE LINK-TMRD007    TO TM007-COMMUNICATIONS-AREA.           10380099
103900     MOVE PC-CURRENT-PROGRAM-NAME                                 10390099
104000                          TO TM007-CALLED-MODULE                  10400099
104100     SET PS-DONE-NO TO TRUE.                                      10410003
104200                                                                  10420003
104300     SET TM500-CALL-SUCCESSFUL TO TRUE.                           10430003
104400                                                                  10440003
104500     MOVE '821'                TO  TM500-PREPACK-PGM-NBR          10450099
104600     MOVE SPACES               TO  RC823-REC-TERM-ID              10460099
104700                                   RC823-ITM-TERM-ID              10470099
104800                                   RC823-STR-TERM-ID              10480099
104900     MOVE ZERO                 TO  RC823-REC-TASK-NUMBER          10490099
105000                                   RC823-STR-TASK-NUMBER          10500099
105100                                   RC823-ITM-TASK-NUMBER          10510099
105200     MOVE 1                    TO  RC823-REC-SEQ                  10520099
105300     MOVE 2                    TO  RC823-STR-SEQ                  10530099
105400     MOVE 3                    TO  RC823-ITM-SEQ                  10540099
105500     MOVE SPACES               TO  RC824-REC-TERM-ID              10550099
105600                                   RC824-ITM-TERM-ID              10560099
105700                                   RC824-STR-TERM-ID              10570099
105800     MOVE ZERO                 TO  RC824-REC-TASK-NUMBER          10580099
105900                                   RC824-STR-TASK-NUMBER          10590099
106000                                   RC824-ITM-TASK-NUMBER          10600099
106100     MOVE 1                    TO  RC824-REC-SEQ                  10610099
106200     MOVE 2                    TO  RC824-STR-SEQ                  10620099
106300     MOVE 3                    TO  RC824-ITM-SEQ                  10630099
106400     MOVE TM500-PKGNG-CDE      TO  PS-PACKAGE-CODE                10640099
106500     MOVE TM500-PO-NBR         TO  RC821-ORD-NBR                  10650099
106600     MOVE TM500-OPER-UNT-ID    TO  RC821-OPER-UNT-ID              10660099
106700     MOVE TM500-FCLTY-ID       TO  RC821-FCLTY-ID                 10670099
106800     MOVE TM500-REC-SEQ-NBR    TO  RC821-REC-SEQ-NBR              10680099
106900     MOVE TM500-NEW-STR-PO-IND TO  RC821-NEW-STR-IND              10690099
107000     MOVE TM500-PKGNG-CDE      TO  RC821-PKGNG-CDE                10700099
107100     MOVE TM500-PO-LNE-NBR     TO  RC821-REC-DRV-LNE-NBR          10710099
107200     MOVE TM500-PREPK-ID       TO  RC821-PREPK-ID                 10720099
107300     MOVE PC-N                 TO  RC821-BAD-PACK-DISTRO-IND      10730099
107400     MOVE PC-Y                 TO  RC821-VALID-DISTRO-IND         10740099
107500     MOVE PC-U                 TO  RC821-OVER-SHORT-CDE           10750099
107600                                                                  10760003
107700                                                                  10770003
107800     IF PS-DONE-NO                                                10780003
107900         PERFORM 1010-SELECT-FUNCTION-QTY                         10790003
108000         ACCEPT PV-CPU-DATE FROM DATE                             10800003
108100         STRING '20' PV-YEAR '-' PV-MONTH '-' PV-DAY              10810003
108200           DELIMITED BY SIZE INTO PV-CURRENT-DATE                 10820003
108300     END-IF.                                                      10830003
108400                                                                  10840003
108500     IF PS-DONE-NO                                                10850042
108600         IF (NOT PS-BULK)      AND                                10860045
108700            (NOT PS-PREPACK)                                      10870045
108800             PERFORM 1020-GET-PKGNG-CDE                           10880042
108900*11/04/03 - DEFAULT PKGNG-CDE TO 'B'(BULK) IF NOT FOUND.          10890060
109000             IF RECEIV-PKGNG-CDE NOT > SPACES                     10900060
109100                 MOVE 'B' TO RC821-PKGNG-CDE                      10910099
109200                             PS-PACKAGE-CODE                      10920060
109300                             TM500-PKGNG-CDE                      10930060
109400             END-IF                                               10940060
109500         END-IF                                                   10950060
109600     END-IF.                                                      10960042
109700                                                                  10970003
109800     IF PS-DONE-NO                                                10980044
109900         IF (PS-PREPACK AND TM500-PREPK-ID > 0)     AND           10990044
110000             TM500-PO-LNE-NBR = 0                   AND           11000044
110100             TM500-RESOLVE-AUTO                                   11010044
110200            PERFORM 1030-FETCH-DRIVER-LINE                        11020044
110300         END-IF                                                   11030044
110400     END-IF.                                                      11040044
110500                                                                  11050044
110600                                                                  11060044
110700                                                                  11070044
110800                                                                  11080044
110900* -------------------------------------------------------------- *11090003
111000* -------------------------------------------------------------- *11100003
111100                                                                  11110003
111200 1010-SELECT-FUNCTION-QTY.                                        11120003
111300                                                                  11130003
111400     MOVE '1010-SELECT-FUNCTION-QTY' TO RC001-PARAGRAPH.          11140033
111500                                                                  11150003
111600     EXEC SQL                                                     11160003
111700                                                                  11170003
111800         SELECT FUNC_QTY                                          11180003
111900                                                                  11190003
112000           INTO :KRPRPM-FUNC-QTY                                  11200003
112100                                                                  11210003
112200             FROM TKRPRPM                                         11220003
112300                                                                  11230003
112400           WHERE INTFC_SYS_CDE      =  'PRO'                      11240003
112500             AND SYS_PRC_FUNC_CDE   =  'RCDAYS'                   11250003
112600             AND FUNC_PRC_STAT_CDE  =  'AC'                       11260003
112700             AND (CURRENT DATE BETWEEN DATE(FUNC_BEG_TMST)        11270003
112800             AND                       DATE(FUNC_END_TMST))       11280003
112900                                                                  11290003
113000         WITH UR                                                  11300003
113100                                                                  11310003
113200     END-EXEC.                                                    11320003
113300                                                                  11330003
113400                                                                  11340003
113500     EVALUATE SQLCODE                                             11350003
113600                                                                  11360003
113700       WHEN +0                                                    11370003
113800           CONTINUE                                               11380003
113900                                                                  11390003
114000       WHEN OTHER                                                 11400003
114100           MOVE SQLCA       TO TM500-SQLCA                        11410003
114200                               TM007-SQLCA                        11420099
114300           MOVE SQLCODE     TO TM500-SQLCODE                      11430003
114400                               TM007-SQLCODE                      11440099
114500           MOVE SQLCODE     TO RC001-SAVE-SQLCODE                 11450003
114600           MOVE SPACES      TO TM501-TM500-RETURN-MSG             11460099
114700           MOVE '821'       TO TM501-PGM                          11470099
114800           MOVE '1010'      TO TM501-PARA                         11480003
114900                               TM007-RETURNED-PARA                11490099
115000           MOVE 'TKRPRPM'   TO TM501-TBL                          11500003
115100           MOVE 02          TO TM501-PRORATION-ERROR-NBR          11510003
115200           PERFORM TM501-SET-TM500-RETURN-MSG                     11520003
115300           MOVE TM500-RETURN-DATA                                 11530099
115400                            TO TM007-RETURN-DATA                  11540099
115500           PERFORM RC001-RETURN-MSG                               11550003
115600                                                                  11560003
115700     END-EVALUATE.                                                11570003
115800                                                                  11580003
115900                                                                  11590003
116000* -------------------------------------------------------------- *11600003
116100* -------------------------------------------------------------- *11610003
116200                                                                  11620003
116300 1020-GET-PKGNG-CDE.                                              11630003
116400                                                                  11640003
116500     MOVE '1020-GET-PKGNG-CDE' TO RC001-PARAGRAPH.                11650033
116600                                                                  11660003
116700     EXEC SQL                                                     11670003
116800                                                                  11680003
116900         SELECT PKGNG_CDE                                         11690003
117000                                                                  11700003
117100           INTO :RECEIV-PKGNG-CDE                                 11710003
117200                                                                  11720003
117300             FROM TRECEIV                                         11730003
117400                                                                  11740003
117500           WHERE ORD_NBR         =  :RC821-ORD-NBR                11750099
117600             AND REC_SEQ_NBR     =  :RC821-REC-SEQ-NBR            11760099
117700             AND VER_STATUS_CDE  =  :PC-A                         11770003
117800                                                                  11780003
117900     END-EXEC.                                                    11790003
118000                                                                  11800003
118100                                                                  11810003
118200     EVALUATE SQLCODE                                             11820003
118300                                                                  11830003
118400       WHEN +0                                                    11840003
118500           MOVE RECEIV-PKGNG-CDE   TO RC821-PKGNG-CDE             11850099
118600                                      PS-PACKAGE-CODE             11860005
118700                                      TM500-PKGNG-CDE             11870005
118800       WHEN OTHER                                                 11880005
118900           MOVE SQLCA       TO TM500-SQLCA                        11890005
119000                               TM007-SQLCA                        11900099
119100           MOVE SQLCODE     TO TM500-SQLCODE                      11910005
119200                               TM007-SQLCODE                      11920099
119300           MOVE SQLCODE     TO RC001-SAVE-SQLCODE                 11930005
119400           MOVE SPACES      TO TM501-TM500-RETURN-MSG             11940005
119500           MOVE '821'       TO TM501-PGM                          11950099
119600           MOVE '1020'      TO TM501-PARA                         11960005
119700                               TM007-RETURNED-PARA                11970099
119800           MOVE 'TRECEIV'   TO TM501-TBL                          11980005
119900           MOVE 92          TO TM501-PRORATION-ERROR-NBR          11990005
120000           PERFORM TM501-SET-TM500-RETURN-MSG                     12000005
120100           MOVE TM500-RETURN-DATA                                 12010099
120200                            TO TM007-RETURN-DATA                  12020099
120300           PERFORM RC001-RETURN-MSG                               12030005
120400                                                                  12040005
120500     END-EVALUATE.                                                12050005
120600                                                                  12060044
120700                                                                  12070044
120800* -------------------------------------------------------------- *12080044
120900* -------------------------------------------------------------- *12090044
121000                                                                  12100044
121100 1030-FETCH-DRIVER-LINE.                                          12110044
121200                                                                  12120044
121300     MOVE '1030-FETCH-DRIVER-LINE' TO RC001-PARAGRAPH.            12130044
121400                                                                  12140044
121500     EXEC SQL                                                     12150044
121600                                                                  12160044
121700         SELECT ORD_LNE_NBR                                       12170044
121800                                                                  12180044
121900           INTO :RECITM-ORD-LNE-NBR                               12190044
122000                                                                  12200044
122100         FROM TRECITM                                             12210044
122200                                                                  12220044
122300         WHERE ORD_NBR            =  :TM500-PO-NBR                12230044
122400           AND REC_SEQ_NBR        =  :TM500-REC-SEQ-NBR           12240044
122500           AND OPER_UNT_ID        =  :TM500-OPER-UNT-ID           12250044
122600           AND PREPK_ID           =  :TM500-PREPK-ID              12260044
122700           AND PREPK_DRV_LNE_CDE  =  :PC-A                        12270044
122800                                                                  12280044
122900     END-EXEC.                                                    12290044
123000                                                                  12300044
123100                                                                  12310044
123200     EVALUATE SQLCODE                                             12320044
123300                                                                  12330044
123400       WHEN +0                                                    12340044
123500           MOVE RECITM-ORD-LNE-NBR TO TM500-PO-LNE-NBR            12350044
123600                                      RC821-REC-DRV-LNE-NBR       12360099
123700                                                                  12370044
123800       WHEN +100                                                  12380044
123900           SET PS-DONE-YES TO TRUE                                12390044
124000           MOVE SQLCODE   TO RC001-SAVE-SQLCODE                   12400044
124100           MOVE SQLCODE   TO TM500-SQLCODE                        12410044
124200                             TM007-SQLCODE                        12420099
124300           MOVE SQLCA     TO TM500-SQLCA                          12430044
124400                             TM007-SQLCA                          12440099
124500           MOVE SPACES    TO TM501-TM500-RETURN-MSG               12450044
124600           MOVE '821'     TO TM501-PGM                            12460099
124700           MOVE '1030'    TO TM501-PARA                           12470044
124800                             TM007-RETURNED-PARA                  12480099
124900           MOVE 'TRECITM' TO TM501-TBL                            12490044
125000           MOVE 103       TO TM501-PRORATION-ERROR-NBR            12500044
125100           PERFORM TM501-SET-TM500-RETURN-MSG                     12510044
125200           MOVE TM500-RETURN-DATA                                 12520099
125300                          TO TM007-RETURN-DATA                    12530099
125400           PERFORM RC001-RETURN-MSG                               12540044
125500                                                                  12550044
125600       WHEN OTHER                                                 12560044
125700           SET PS-DONE-YES TO TRUE                                12570044
125800           MOVE SQLCODE   TO RC001-SAVE-SQLCODE                   12580044
125900           MOVE SQLCODE   TO TM500-SQLCODE                        12590044
126000                             TM007-SQLCODE                        12600099
126100           MOVE SQLCA     TO TM500-SQLCA                          12610044
126200                             TM007-SQLCA                          12620099
126300           MOVE SPACES    TO TM501-TM500-RETURN-MSG               12630044
126400           MOVE '821'     TO TM501-PGM                            12640099
126500           MOVE '1030'    TO TM501-PARA                           12650044
126600                             TM007-RETURNED-PARA                  12660099
126700           MOVE 'TRECITM' TO TM501-TBL                            12670044
126800           MOVE 104       TO TM501-PRORATION-ERROR-NBR            12680044
126900           PERFORM TM501-SET-TM500-RETURN-MSG                     12690044
127000           MOVE TM500-RETURN-DATA                                 12700099
127100                          TO TM007-RETURN-DATA                    12710099
127200           PERFORM RC001-RETURN-MSG                               12720044
127300                                                                  12730044
127400     END-EVALUATE.                                                12740044
127500                                                                  12750044
127600                                                                  12760005
127700* -------------------------------------------------------------- *12770005
127800* -------------------------------------------------------------- *12780005
127900                                                                  12790005
128000 1100-CHECK-RECDIS-ALLOC.                                         12800005
128100                                                                  12810005
128200     MOVE '1100-CHECK-RECDIS-ALLOC' TO RC001-PARAGRAPH.           12820033
128300                                                                  12830005
128400     INITIALIZE RC811-RETURN-DATA.                                12840037
128500                                                                  12850032
128600     SET RC811-DELETE-A-DISTRO-PACK TO TRUE.                      12860005
128700                                                                  12870005
128800     MOVE RC821-ORD-NBR      TO  RC811-PO-NBR.                    12880099
128900     MOVE RC821-REC-SEQ-NBR  TO  RC811-REC-SEQ-NBR.               12890099
129000     MOVE RC821-OPER-UNT-ID  TO  RC811-OPER-UNIT-ID.              12900099
129100     MOVE RC821-FCLTY-ID     TO  RC811-FACILITY-ID.               12910099
129200     MOVE RC821-PREPK-ID     TO  RC811-PREPK-ID.                  12920099
129300                                                                  12930000
129400     CALL PC-RCKUP811 USING RC811-STORE-RECDIS-PROCESSING         12940099
129500                            TM007-COMMUNICATIONS-AREA.            12950099
129600                                                                  12960000
129700     EVALUATE TRUE                                                12970000
129800                                                                  12980000
129900       WHEN RC811-SUCCESSFUL-PACK-DELETE                          12990000
130000       WHEN RC811-PACK-IN-RECDIS-NOT-FOUND                        13000000
130100           CONTINUE                                               13010000
130200                                                                  13020000
130300       WHEN OTHER                                                 13030000
130400           STRING '==> BAD RETURN CODE FROM RCKUP811 - '          13040099
130500                                     DELIMITED BY SIZE            13050018
130600                  RC811-RETURN-CODE  DELIMITED BY SIZE            13060018
130700                                     INTO RC001-SPECIAL-1         13070018
130800           STRING '  SEVERITY = '    DELIMITED BY SIZE            13080018
130900                  RC811-SEVERITY-IND DELIMITED BY SIZE            13090018
131000                  '   MSG NBR = '    DELIMITED BY SIZE            13100018
131100                  RC811-MSG-NUMBER   DELIMITED BY SIZE            13110018
131200                                     INTO RC001-SPECIAL-2         13120018
131300           SET PS-DONE-YES TO TRUE                                13130018
131400           MOVE SPACES     TO TM501-TM500-RETURN-MSG              13140018
131500           MOVE '821'      TO TM501-PGM                           13150099
131600           MOVE '1100'     TO TM501-PARA                          13160018
131700                              TM007-RETURNED-PARA                 13170099
131800           MOVE 03         TO TM501-PRORATION-ERROR-NBR           13180018
131900           PERFORM TM501-SET-TM500-RETURN-MSG                     13190003
132000           MOVE TM500-RETURN-DATA                                 13200099
132100                           TO TM007-RETURN-DATA                   13210099
132200           PERFORM RC001-RETURN-MSG                               13220003
132300                                                                  13230003
132400     END-EVALUATE.                                                13240003
132500                                                                  13250003
132600                                                                  13260003
132700* -------------------------------------------------------------- *13270003
132800* -------------------------------------------------------------- *13280003
132900                                                                  13290003
133000 1200-RC811-DISTRO-ROUTINE.                                       13300003
133100                                                                  13310003
133200     MOVE '1200-RC811-DISTRO-ROUTINE' TO RC001-PARAGRAPH.         13320033
133300                                                                  13330003
133400     PERFORM                                                      13340003
133500       VARYING RC821-ITEM-IDX FROM 1 BY 1                         13350099
133600         UNTIL RC821-ITEM-IDX > RC821-MAX-ITEM-COUNT              13360099
133700           OR  RC821-REC-LNE-NBR (RC821-ITEM-IDX) EQUAL +0        13370099
133800                                                                  13380003
133900         INITIALIZE RC811-RETURN-DATA                             13390032
134000                                                                  13400032
134100         SET RC811-ADD-A-DISTRO-LINE TO TRUE                      13410003
134200                                                                  13420003
134300         MOVE RC821-ORD-NBR      TO  RC811-PO-NBR                 13430099
134400         MOVE RC821-REC-SEQ-NBR  TO  RC811-REC-SEQ-NBR            13440099
134500         MOVE RC821-OPER-UNT-ID  TO  RC811-OPER-UNIT-ID           13450099
134600         MOVE RC821-FCLTY-ID     TO  RC811-FACILITY-ID            13460099
134700         MOVE RC821-PREPK-ID     TO  RC811-PREPK-ID               13470099
134800                                                                  13480003
134900         IF RC821-REC-LNE-NBR (RC821-ITEM-IDX) NOT EQUAL          13490099
135000            RC821-REC-DRV-LNE-NBR                                 13500099
135100             PERFORM 1300-ADD-A-DISTRO-LINE                       13510003
135200         END-IF                                                   13520003
135300     END-PERFORM.                                                 13530003
135400                                                                  13540003
135500                                                                  13550003
135600* -------------------------------------------------------------- *13560003
135700* -------------------------------------------------------------- *13570003
135800                                                                  13580003
135900 1300-ADD-A-DISTRO-LINE.                                          13590003
136000                                                                  13600003
136100     MOVE '1300-ADD-A-DISTRO-LINE' TO RC001-PARAGRAPH.            13610033
136200                                                                  13620003
136300     MOVE RC821-REC-DRV-LNE-NBR                                   13630099
136400       TO RC811-CLONE-LINE-NBR.                                   13640030
136500                                                                  13650029
136600     MOVE RC821-REC-LNE-NBR (RC821-ITEM-IDX)                      13660099
136700       TO RC811-MODIFY-LINE-NBR.                                  13670030
136800                                                                  13680003
136900     CALL PC-RCKUP811 USING RC811-STORE-RECDIS-PROCESSING         13690099
137000                            TM007-COMMUNICATIONS-AREA.            13700099
137100                                                                  13710003
137200     EVALUATE TRUE                                                13720003
137300                                                                  13730003
137400       WHEN RC811-RETURN-CODE = +0                                13740035
137500           CONTINUE                                               13750003
137600                                                                  13760003
137700       WHEN OTHER                                                 13770003
137800           STRING '==> BAD RETURN CODE FROM RCKUP811 - '          13780099
137900                                     DELIMITED BY SIZE            13790018
138000                  RC811-RETURN-CODE  DELIMITED BY SIZE            13800018
138100                                     INTO RC001-SPECIAL-1         13810018
138200           STRING '  SEVERITY = '    DELIMITED BY SIZE            13820018
138300                  RC811-SEVERITY-IND DELIMITED BY SIZE            13830018
138400                  '   MSG NBR = '    DELIMITED BY SIZE            13840018
138500                  RC811-MSG-NUMBER   DELIMITED BY SIZE            13850018
138600                                     INTO RC001-SPECIAL-2         13860018
138700           SET PS-DONE-YES TO TRUE                                13870018
138800           MOVE SPACES     TO TM501-TM500-RETURN-MSG              13880018
138900           MOVE '821'      TO TM501-PGM                           13890099
139000           MOVE '1300'     TO TM501-PARA                          13900018
139100                              TM007-RETURNED-PARA                 13910099
139200           MOVE 04         TO TM501-PRORATION-ERROR-NBR           13920018
139300           PERFORM TM501-SET-TM500-RETURN-MSG                     13930003
139400           MOVE TM500-RETURN-DATA                                 13940099
139500                           TO TM007-RETURN-DATA                   13950099
139600           PERFORM RC001-RETURN-MSG                               13960003
139700                                                                  13970003
139800     END-EVALUATE.                                                13980003
139900                                                                  13990003
140000                                                                  14000003
140100                                                                  14010003
140200* -------------------------------------------------------------- *14020003
140300* -------------------------------------------------------------- *14030000
140400*             R E T R I E V E   P O   D A T A                    *14040000
140500* -------------------------------------------------------------- *14050003
140600*                                                                *14060003
140700*    LOAD DATA BASED ON PACKAGING OF THE PO:                     *14070003
140800*                                                                *14080003
140900*    B, C, S = BULK                                              *14090003
141000*    I, M    = PREPACK                                           *14100003
141100*                                                                *14110003
141200* -------------------------------------------------------------- *14120003
141300* -------------------------------------------------------------- *14130003
141400                                                                  14140003
141500 2000-GET-PO-DATA.                                                14150003
141600                                                                  14160003
141700     MOVE '2000-GET-PO-DATA      ' TO RC001-PARAGRAPH.            14170033
141800                                                                  14180003
141900     SET RC821-ITEM-IDX TO +1.                                    14190099
142000                                                                  14200003
142100     IF PS-BULK  OR  RC821-PREPK-ID = 0                           14210099
142200         PERFORM 2010-OPEN-PO-BULK-CSR                            14220003
142300                                                                  14230003
142400         PERFORM 2020-FETCH-PO-BULK-CSR                           14240003
142500           UNTIL PS-PO-BULK-CSR-EOF                               14250003
142600                                                                  14260003
142700         PERFORM 2060-CLOSE-PO-BULK-CSR                           14270003
142800                                                                  14280003
142900         PERFORM 2050-TABLE-PO-DATA                               14290003
143000     END-IF.                                                      14300003
143100                                                                  14310003
143200     IF PS-PREPACK AND RC821-PREPK-ID > 0                         14320099
143300         IF RC821-PREPK-ID = 99                                   14330099
143400             PERFORM 2115-OPEN-PO-PACK-99-CSR                     14340053
143500                                                                  14350053
143600             PERFORM 2117-LOOP-PO-PACK-99-CSR                     14360053
143700               UNTIL PS-PO-PACK-CSR-EOF                           14370053
143800                                                                  14380053
143900             PERFORM 2119-CLOSE-PO-PACK-99-CSR                    14390053
144000         ELSE                                                     14400053
144100             PERFORM 2100-OPEN-PO-PACK-CSR                        14410053
144200                                                                  14420003
144300             PERFORM 2110-LOOP-PO-PACK-CSR                        14430053
144400               UNTIL PS-PO-PACK-CSR-EOF                           14440053
144500                                                                  14450003
144600             PERFORM 2140-CLOSE-PO-PACK-CSR                       14460053
144700         END-IF                                                   14470053
144800                                                                  14480053
144900         PERFORM 2050-TABLE-PO-DATA                               14490003
145000     END-IF.                                                      14500003
145100                                                                  14510003
145200     IF TM500-REDISTRO-YES                                        14520003
145300         MOVE PC-R  TO  RC821-OTR-SCOPE-IND                       14530099
145400     ELSE                                                         14540003
145500         MOVE PC-P  TO  RC821-OTR-SCOPE-IND                       14550099
145600     END-IF.                                                      14560003
145700                                                                  14570003
145800                                                                  14580003
145900* -------------------------------------------------------------- *14590003
146000* -------------------------------------------------------------- *14600003
146100                                                                  14610003
146200 2010-OPEN-PO-BULK-CSR.                                           14620003
146300                                                                  14630003
146400     MOVE '2010-OPEN-PO-BULK-CSR' TO RC001-PARAGRAPH.             14640033
146500                                                                  14650003
146600     EXEC SQL                                                     14660003
146700         OPEN PO-BULK-CSR                                         14670003
146800     END-EXEC.                                                    14680003
146900                                                                  14690003
147000                                                                  14700003
147100     EVALUATE SQLCODE                                             14710003
147200                                                                  14720003
147300       WHEN +0                                                    14730003
147400           SET PS-PO-BULK-CSR-START TO TRUE                       14740003
147500                                                                  14750003
147600       WHEN OTHER                                                 14760003
147700           SET PS-DONE-YES                                        14770003
147800               PS-PO-BULK-CSR-EOF   TO TRUE                       14780003
147900           MOVE SQLCODE   TO RC001-SAVE-SQLCODE                   14790003
148000           MOVE SQLCODE   TO TM500-SQLCODE                        14800003
148100                             TM007-SQLCODE                        14810099
148200           MOVE SQLCA     TO TM500-SQLCA                          14820003
148300                             TM007-SQLCA                          14830099
148400           MOVE SPACES    TO TM501-TM500-RETURN-MSG               14840003
148500           MOVE '821'     TO TM501-PGM                            14850099
148600           MOVE '2010'    TO TM501-PARA                           14860003
148700                             TM007-RETURNED-PARA                  14870099
148800           MOVE 'TPURCHS' TO TM501-TBL                            14880003
148900           MOVE 05        TO TM501-PRORATION-ERROR-NBR            14890003
149000           PERFORM TM501-SET-TM500-RETURN-MSG                     14900003
149100           MOVE TM500-RETURN-DATA                                 14910099
149200                          TO TM007-RETURN-DATA                    14920099
149300           PERFORM RC001-RETURN-MSG                               14930003
149400                                                                  14940003
149500     END-EVALUATE.                                                14950003
149600                                                                  14960003
149700                                                                  14970003
149800* -------------------------------------------------------------- *14980003
149900*    ONE ROW IS ALWAYS FETCHED FROM THIS TABLE IF PACKAGING      *14990003
150000*    IS BULK.                                                    *15000003
150100* -------------------------------------------------------------- *15010003
150200                                                                  15020003
150300 2020-FETCH-PO-BULK-CSR.                                          15030003
150400                                                                  15040003
150500     MOVE '2020-FETCH-PO-BULK-CSR' TO RC001-PARAGRAPH.            15050033
150600                                                                  15060003
150700     EXEC SQL                                                     15070003
150800                                                                  15080003
150900         FETCH PO-BULK-CSR                                        15090003
151000                                                                  15100003
151100          INTO :PURCHS-DEPT-NBR                                   15110003
151200             , :PURCHS-NEW-STR-PO-IND                             15120003
151300             , :PURCHS-PO-TYP-CDE                                 15130003
151400             , :PURCHS-IMPRT-PO-IND                               15140003
151500             , :PURCHS-PKGNG-CDE                                  15150065
151600             , :PURCHS-PO-IN-RMS-IND                              15160003
151700             , :PURITM-PO-LNE-NBR                                 15170003
151800             , :PURITM-APP-PO-LNE-NBR                             15180003
151900             , :PURITM-SKU-SEQ-NBR                                15190003
152000             , :PURITM-STATUS-CDE                                 15200003
152100             , :PURITM-UNT-QTY                                    15210003
152200             , :PURITM-UNT-RTL-PR-AMT                             15220003
152300             , :PURITM-GP-RTL-AMT                                 15230003
152400             , :PURITM-GP-QTY                                     15240003
152500             , :PURITM-PIC-ITM-IND                                15250003
152600             , :PURITM-ITM-NBR                                    15260003
152700                                                                  15270003
152800     END-EXEC.                                                    15280003
152900                                                                  15290003
153000                                                                  15300003
153100     EVALUATE SQLCODE                                             15310003
153200                                                                  15320003
153300       WHEN +0                                                    15330003
153400           PERFORM 2030-MOVE-PURITM-BULK-DATA                     15340003
153500           SET RC821-ITEM-IDX UP BY +1                            15350099
153600                                                                  15360003
153700       WHEN +100                                                  15370003
153800           SET PS-PO-BULK-CSR-EOF TO TRUE                         15380003
153900                                                                  15390003
154000       WHEN OTHER                                                 15400003
154100           SET PS-DONE-YES                                        15410003
154200               PS-PO-BULK-CSR-EOF TO TRUE                         15420003
154300           MOVE SQLCODE   TO RC001-SAVE-SQLCODE                   15430004
154400           MOVE SQLCODE   TO TM500-SQLCODE                        15440004
154500                             TM007-SQLCODE                        15450099
154600           MOVE SQLCA     TO TM500-SQLCA                          15460004
154700                             TM007-SQLCA                          15470099
154800           MOVE SPACES    TO TM501-TM500-RETURN-MSG               15480004
154900           MOVE '821'     TO TM501-PGM                            15490099
155000           MOVE '2020'    TO TM501-PARA                           15500004
155100                             TM007-RETURNED-PARA                  15510099
155200           MOVE 'TPURCHS' TO TM501-TBL                            15520004
155300           MOVE 06        TO TM501-PRORATION-ERROR-NBR            15530004
155400           PERFORM TM501-SET-TM500-RETURN-MSG                     15540003
155500           MOVE TM500-RETURN-DATA                                 15550099
155600                          TO TM007-RETURN-DATA                    15560099
155700           PERFORM RC001-RETURN-MSG                               15570003
155800                                                                  15580003
155900     END-EVALUATE.                                                15590003
156000                                                                  15600003
156100                                                                  15610003
156200* -------------------------------------------------------------- *15620003
156300* -------------------------------------------------------------- *15630003
156400                                                                  15640003
156500 2030-MOVE-PURITM-BULK-DATA.                                      15650003
156600                                                                  15660003
156700     MOVE '2030-MOVE-PURITM-BULK-DATA' TO RC001-PARAGRAPH.        15670033
156800                                                                  15680003
156900     MOVE PURITM-PO-LNE-NBR                                       15690003
157000       TO RC821-PO-LNE-NBR        (RC821-ITEM-IDX).               15700099
157100                                                                  15710003
157200     MOVE PURITM-APP-PO-LNE-NBR                                   15720003
157300       TO RC821-APP-PO-LNE-NBR    (RC821-ITEM-IDX).               15730099
157400                                                                  15740003
157500     MOVE PURITM-STATUS-CDE                                       15750003
157600       TO RC821-PO-LNE-STATUS-CDE (RC821-ITEM-IDX).               15760099
157700                                                                  15770003
157800     MOVE PURITM-UNT-QTY                                          15780003
157900       TO RC821-PO-UNIT-QTY       (RC821-ITEM-IDX).               15790099
158000                                                                  15800003
158100     MOVE PURITM-UNT-RTL-PR-AMT                                   15810003
158200       TO RC821-PO-UNT-RTL-PR-AMT (RC821-ITEM-IDX).               15820099
158300                                                                  15830003
158400     MOVE PURITM-GP-RTL-AMT                                       15840003
158500       TO RC821-PO-GP-RTL-AMT     (RC821-ITEM-IDX).               15850099
158600                                                                  15860003
158700     MOVE PURITM-GP-QTY                                           15870003
158800       TO RC821-PO-GP-QTY         (RC821-ITEM-IDX).               15880099
158900                                                                  15890003
159000     ADD 1 TO RC821-ITEM-COUNT.                                   15900099
159100                                                                  15910003
159200*    -------------------------------------------------------      15920003
159300*    THIS IS A LEGACY PO INDICATOR AND IT DOES NOT APPLY          15930003
159400*    TO RMS SOURCED PO'S.                                         15940003
159500*    -------------------------------------------------------      15950003
159600                                                                  15960003
159700     IF PURITM-SKU-SEQ-NBR EQUAL '000' OR '999'                   15970003
159800         MOVE PC-Y TO RC821-DUMMY-SKU-IND (RC821-ITEM-IDX)        15980099
159900     ELSE                                                         15990003
160000         MOVE PC-N TO RC821-DUMMY-SKU-IND (RC821-ITEM-IDX)        16000099
160100     END-IF.                                                      16010003
160200                                                                  16020003
160300     MOVE PURCHS-PO-IN-RMS-IND  TO RC821-RMS-PO-IND.              16030099
160400     MOVE PURCHS-NEW-STR-PO-IND TO TM500-NEW-STR-PO-IND           16040003
160500                                   RC821-NEW-STR-IND.             16050099
160600                                                                  16060003
160700     IF PURCHS-PO-TYP-CDE EQUAL (PC-IE  OR                        16070003
160800                                 PC-IF  OR                        16080003
160900                                 PC-IM)                           16090003
161000         MOVE PC-Y TO TM500-IMPORT-PO-IND                         16100003
161100                      RC821-IMPRT-PO-IND                          16110099
161200     ELSE                                                         16120003
161300         MOVE PC-N TO TM500-IMPORT-PO-IND                         16130003
161400                      RC821-IMPRT-PO-IND                          16140099
161500     END-IF.                                                      16150003
161600                                                                  16160003
161700     MOVE PURITM-PIC-ITM-IND TO TM500-AD-ITM-IND.                 16170003
161800                                                                  16180003
161900*    PERFORM 4090-GET-DATE-RANGE.                                 16190062
162000                                                                  16200003
162100     MOVE PURITM-ITM-NBR TO DK-ITM-NBR.                           16210003
162200                                                                  16220003
162300     PERFORM 2130-SELECT-XL-ITEM.                                 16230010
162400                                                                  16240003
162500     SET RC822-PACK-IDX TO RC821-ITEM-IDX.                        16250099
162600                                                                  16260003
162700     MOVE RC821-PO-LNE-NBR       (RC821-ITEM-IDX)                 16270099
162800       TO RC822-PO-LINE-NBR      (RC822-PACK-IDX).                16280099
162900                                                                  16290003
163000     MOVE RC821-APP-PO-LNE-NBR   (RC821-ITEM-IDX)                 16300099
163100       TO RC822-APP-PO-LINE-NBR  (RC822-PACK-IDX).                16310099
163200                                                                  16320003
163300     MOVE RC821-PO-SKU-NBR       (RC821-ITEM-IDX)                 16330099
163400       TO RC822-PO-SKU-NBR       (RC822-PACK-IDX).                16340099
163500                                                                  16350003
163600     MOVE RC821-PO-PACK-RATO-QTY (RC821-ITEM-IDX)                 16360099
163700       TO RC822-PO-PACK-RATO-QTY (RC822-PACK-IDX).                16370099
163800                                                                  16380003
163900                                                                  16390003
164000* -------------------------------------------------------------- *16400003
164100* -------------------------------------------------------------- *16410003
164200                                                                  16420003
164300 2040-SELECT-XL-ITEM.                                             16430003
164400                                                                  16440003
164500     MOVE '2040-SELECT-XL-ITEM' TO RC001-PARAGRAPH.               16450033
164600                                                                  16460003
164700     INITIALIZE XL001-ITEM-COMMAREA.                              16470003
164800                                                                  16480003
164900     MOVE DK-ITM-NBR  TO  XL001-KEY-ITM-NBR.                      16490003
165000                                                                  16500003
165100     SET XL001-BY-ITEM                                            16510003
165200         XL001-SELECT-SKU                                         16520003
165300         XL001-SELECT-UPC                                         16530003
165400         XL001-SELECT-SKU-STR                                     16540003
165500         XL001-SELECT-WEB-SKU TO TRUE.                            16550003
165600                                                                  16560003
165700     CALL XL001-VSM-PGM USING XL001-ITEM-COMMAREA.                16570099
165800                                                                  16580003
165900     EVALUATE XL001-SKU-SQLCODE                                   16590003
166000                                                                  16600003
166100       WHEN +0                                                    16610003
166200           PERFORM 4100-SELECT-VND-STYL                           16620003
166300           PERFORM 3150-MOVE-XL001-DATA                           16630003
166400                                                                  16640003
166500       WHEN +100                                                  16650003
166600           SET PS-DONE-YES TO TRUE                                16660003
166700           MOVE XL001-SKU-SQLCODE TO RC001-SAVE-SQLCODE           16670003
166800                                     TM500-SQLCODE                16680099
166900                                     TM007-SQLCODE                16690099
167000           MOVE XL001-SQLCA       TO TM500-SQLCA                  16700099
167100                                     TM007-SQLCA                  16710099
167200           MOVE SPACES            TO TM501-TM500-RETURN-MSG       16720003
167300           MOVE '821'             TO TM501-PGM                    16730099
167400           MOVE '2040'            TO TM501-PARA                   16740004
167500                                     TM007-RETURNED-PARA          16750099
167600           MOVE 07                TO TM501-PRORATION-ERROR-NBR    16760003
167700           PERFORM TM501-SET-TM500-RETURN-MSG                     16770003
167800           MOVE TM500-RETURN-DATA TO TM007-RETURN-DATA            16780099
167900           PERFORM RC001-RETURN-MSG                               16790000
168000                                                                  16800000
168100       WHEN -904                                                  16810000
168200       WHEN -911                                                  16820000
168300       WHEN -913                                                  16830000
168400           SET PS-DONE-YES  TO TRUE                               16840000
168500           MOVE XL001-SKU-SQLCODE TO RC001-SAVE-SQLCODE           16850000
168600                                     TM500-SQLCODE                16860099
168700                                     TM007-SQLCODE                16870099
168800           MOVE XL001-SQLCA       TO TM500-SQLCA                  16880099
168900                                     TM007-SQLCA                  16890099
169000           MOVE SPACES            TO TM501-TM500-RETURN-MSG       16900000
169100           MOVE '821'             TO TM501-PGM                    16910099
169200           MOVE '2040'            TO TM501-PARA                   16920004
169300                                     TM007-RETURNED-PARA          16930099
169400           MOVE 08                TO TM501-PRORATION-ERROR-NBR    16940003
169500           PERFORM TM501-SET-TM500-RETURN-MSG                     16950003
169600           MOVE TM500-RETURN-DATA TO TM007-RETURN-DATA            16960099
169700           PERFORM RC001-RETURN-MSG                               16970003
169800                                                                  16980003
169900       WHEN OTHER                                                 16990003
170000           SET PS-DONE-YES  TO TRUE                               17000003
170100           MOVE XL001-SKU-SQLCODE TO RC001-SAVE-SQLCODE           17010003
170200                                     TM500-SQLCODE                17020099
170300                                     TM007-SQLCODE                17030099
170400           MOVE XL001-SQLCA       TO TM500-SQLCA                  17040099
170500                                     TM007-SQLCA                  17050099
170600           MOVE SPACES            TO TM501-TM500-RETURN-MSG       17060003
170700           MOVE '821'             TO TM501-PGM                    17070099
170800           MOVE '2040'            TO TM501-PARA                   17080004
170900                                     TM007-RETURNED-PARA          17090099
171000           MOVE 09                TO TM501-PRORATION-ERROR-NBR    17100003
171100           PERFORM TM501-SET-TM500-RETURN-MSG                     17110003
171200           MOVE TM500-RETURN-DATA TO TM007-RETURN-DATA            17120099
171300           PERFORM RC001-RETURN-MSG                               17130003
171400                                                                  17140003
171500     END-EVALUATE.                                                17150003
171600                                                                  17160003
171700                                                                  17170003
171800* -------------------------------------------------------------- *17180003
171900* -------------------------------------------------------------- *17190003
172000                                                                  17200003
172100 2050-TABLE-PO-DATA.                                              17210003
172200                                                                  17220003
172300     MOVE '2050-TABLE-PO-DATA  ' TO RC001-PARAGRAPH.              17230033
172400                                                                  17240003
172500     MOVE PURCHS-DEPT-NBR    TO RC821-DEPT-NBR.                   17250099
172600     MOVE PURCHS-PO-TYP-CDE  TO RC821-PO-TYP-CDE.                 17260099
172700     MOVE PURCHS-PKGNG-CDE   TO RC821-PO-PKGNG-CDE.               17270099
172800                                                                  17280003
172900     PERFORM 4050-GET-PLAN-INFO.                                  17290003
173000                                                                  17300003
173100     PERFORM 4060-GET-DISTRO-QTY.                                 17310003
173200                                                                  17320003
173300     PERFORM 4070-GET-TYPE-CODE-INFO.                             17330003
173400                                                                  17340003
173500                                                                  17350003
173600* -------------------------------------------------------------- *17360003
173700* -------------------------------------------------------------- *17370003
173800                                                                  17380003
173900 2060-CLOSE-PO-BULK-CSR.                                          17390003
174000                                                                  17400003
174100     MOVE '2060-CLOSE-PO-BULK-CSR' TO RC001-PARAGRAPH.            17410033
174200                                                                  17420003
174300     EXEC SQL                                                     17430003
174400         CLOSE PO-BULK-CSR                                        17440003
174500     END-EXEC.                                                    17450003
174600                                                                  17460003
174700                                                                  17470003
174800     EVALUATE SQLCODE                                             17480003
174900                                                                  17490003
175000       WHEN +0                                                    17500003
175100           SET PS-PO-BULK-CSR-EOF TO TRUE                         17510003
175200                                                                  17520003
175300       WHEN OTHER                                                 17530003
175400           SET PS-DONE-YES                                        17540003
175500               PS-PO-BULK-CSR-EOF TO TRUE                         17550003
175600           MOVE SQLCODE   TO RC001-SAVE-SQLCODE                   17560003
175700           MOVE SQLCODE   TO TM500-SQLCODE                        17570003
175800                             TM007-SQLCODE                        17580099
175900           MOVE SQLCA     TO TM500-SQLCA                          17590003
176000                             TM007-SQLCA                          17600099
176100           MOVE SPACES    TO TM501-TM500-RETURN-MSG               17610003
176200           MOVE '821'     TO TM501-PGM                            17620099
176300           MOVE '2060'    TO TM501-PARA                           17630003
176400                             TM007-RETURNED-PARA                  17640099
176500           MOVE 'TPURCHS' TO TM501-TBL                            17650003
176600           MOVE 10        TO TM501-PRORATION-ERROR-NBR            17660003
176700           PERFORM TM501-SET-TM500-RETURN-MSG                     17670003
176800           MOVE TM500-RETURN-DATA                                 17680099
176900                          TO TM007-RETURN-DATA                    17690099
177000           PERFORM RC001-RETURN-MSG                               17700000
177100                                                                  17710003
177200     END-EVALUATE.                                                17720003
177300                                                                  17730003
177400                                                                  17740003
177500* -------------------------------------------------------------- *17750003
177600* -------------------------------------------------------------- *17760003
177700                                                                  17770003
177800 2100-OPEN-PO-PACK-CSR.                                           17780003
177900                                                                  17790003
178000     MOVE '2100-OPEN-PO-PACK-CSR' TO RC001-PARAGRAPH.             17800033
178100                                                                  17810003
178200     EXEC SQL                                                     17820003
178300         OPEN PO-PACK-CSR                                         17830003
178400     END-EXEC.                                                    17840003
178500                                                                  17850003
178600                                                                  17860003
178700     EVALUATE SQLCODE                                             17870003
178800                                                                  17880003
178900       WHEN +0                                                    17890003
179000           SET PS-PO-PACK-CSR-START TO TRUE                       17900003
179100                                                                  17910003
179200       WHEN OTHER                                                 17920003
179300           SET PS-DONE-YES                                        17930003
179400               PS-PO-PACK-CSR-EOF TO TRUE                         17940003
179500           MOVE SQLCODE   TO RC001-SAVE-SQLCODE                   17950003
179600           MOVE SQLCODE   TO TM500-SQLCODE                        17960003
179700                             TM007-SQLCODE                        17970099
179800           MOVE SQLCA     TO TM500-SQLCA                          17980003
179900                             TM007-SQLCA                          17990099
180000           MOVE SPACES    TO TM501-TM500-RETURN-MSG               18000003
180100           MOVE '821'     TO TM501-PGM                            18010099
180200           MOVE '2100'    TO TM501-PARA                           18020003
180300                             TM007-RETURNED-PARA                  18030099
180400           MOVE 'TPURCHS' TO TM501-TBL                            18040003
180500           MOVE 11        TO TM501-PRORATION-ERROR-NBR            18050003
180600           PERFORM TM501-SET-TM500-RETURN-MSG                     18060003
180700           MOVE TM500-RETURN-DATA                                 18070099
180800                          TO TM007-RETURN-DATA                    18080099
180900           PERFORM RC001-RETURN-MSG                               18090003
181000                                                                  18100003
181100     END-EVALUATE.                                                18110003
181200                                                                  18120003
181300                                                                  18130003
181400* -------------------------------------------------------------- *18140003
181500*    MULTIPLE ROWS ARE ALWAYS FETCHED FROM THIS TABLE IF         *18150003
181600*    PACKAGING IS PREPACK.                                       *18160003
181700* -------------------------------------------------------------- *18170003
181800                                                                  18180003
181900 2110-LOOP-PO-PACK-CSR.                                           18190003
182000                                                                  18200003
182100     MOVE '2110-LOOP-PO-PACK-CSR' TO RC001-PARAGRAPH.             18210033
182200                                                                  18220003
182300     EXEC SQL                                                     18230003
182400                                                                  18240003
182500         FETCH PO-PACK-CSR                                        18250003
182600                                                                  18260003
182700          INTO :PURCHS-DEPT-NBR                                   18270003
182800             , :PURCHS-NEW-STR-PO-IND                             18280003
182900             , :PURCHS-PO-TYP-CDE                                 18290003
183000             , :PURCHS-IMPRT-PO-IND                               18300003
183100             , :PURCHS-PKGNG-CDE                                  18310066
183200             , :PURCHS-PO-IN-RMS-IND                              18320003
183300             , :PURITM-PO-LNE-NBR                                 18330003
183400             , :PURITM-APP-PO-LNE-NBR                             18340003
183500             , :PURITM-SKU-SEQ-NBR                                18350003
183600             , :PURITM-STATUS-CDE                                 18360003
183700             , :PURITM-UNT-QTY                                    18370003
183800             , :PURITM-UNT-RTL-PR-AMT                             18380003
183900             , :PURITM-GP-RTL-AMT                                 18390003
184000             , :PURITM-GP-QTY                                     18400003
184100             , :PURITM-PIC-ITM-IND                                18410003
184200             , :PURITM-ITM-NBR                                    18420003
184300             , :PURITM-PREPK-RATO-QTY                             18430003
184400             , :POPRPK-PREPK-TYP-CDE                              18440003
184500             , :POPRPK-PREPK-STAT-CDE                             18450003
184600             , :POPRPK-PREPK-UPC-NBR                              18460003
184700             , :POPRPK-INPK-UNT-QTY                               18470003
184800             , :POPRPK-OTPK-UNT-QTY                               18480003
184900             , :POPRPK-PK-SKU-NBR                                 18490003
185000                                                                  18500003
185100     END-EXEC.                                                    18510003
185200                                                                  18520003
185300                                                                  18530003
185400     EVALUATE SQLCODE                                             18540003
185500                                                                  18550003
185600       WHEN +0                                                    18560003
185700           PERFORM 2120-MOVE-PO-PACK-DATA                         18570010
185800           SET RC821-ITEM-IDX UP BY +1                            18580099
185900                                                                  18590003
186000       WHEN +100                                                  18600003
186100           SET PS-PO-PACK-CSR-EOF TO TRUE                         18610003
186200                                                                  18620003
186300       WHEN OTHER                                                 18630003
186400           SET PS-DONE-YES                                        18640003
186500               PS-PO-PACK-CSR-EOF TO TRUE                         18650003
186600           MOVE SQLCODE   TO RC001-SAVE-SQLCODE                   18660004
186700           MOVE SQLCODE   TO TM500-SQLCODE                        18670004
186800                             TM007-SQLCODE                        18680099
186900           MOVE SQLCA     TO TM500-SQLCA                          18690004
187000                             TM007-SQLCA                          18700099
187100           MOVE SPACES    TO TM501-TM500-RETURN-MSG               18710004
187200           MOVE '821'     TO TM501-PGM                            18720099
187300           MOVE '2110'    TO TM501-PARA                           18730004
187400                             TM007-RETURNED-PARA                  18740099
187500           MOVE 'TPURCHS' TO TM501-TBL                            18750004
187600           MOVE 12        TO TM501-PRORATION-ERROR-NBR            18760004
187700           PERFORM TM501-SET-TM500-RETURN-MSG                     18770003
187800           MOVE TM500-RETURN-DATA                                 18780099
187900                          TO TM007-RETURN-DATA                    18790099
188000           PERFORM RC001-RETURN-MSG                               18800003
188100                                                                  18810003
188200     END-EVALUATE.                                                18820003
188300                                                                  18830003
188400                                                                  18840003
188500* -------------------------------------------------------------- *18850053
188600* -------------------------------------------------------------- *18860053
188700 2115-OPEN-PO-PACK-99-CSR.                                        18870053
188800     MOVE '2115-OPEN-PO-PACK-99-CSR' TO RC001-PARAGRAPH.          18880053
188900                                                                  18890053
189000     EXEC SQL                                                     18900053
189100         OPEN PO-PACK-99-CSR                                      18910053
189200     END-EXEC.                                                    18920053
189300                                                                  18930053
189400     EVALUATE SQLCODE                                             18940053
189500       WHEN +0                                                    18950053
189600           SET PS-PO-PACK-CSR-START TO TRUE                       18960053
189700                                                                  18970053
189800       WHEN OTHER                                                 18980053
189900           SET PS-DONE-YES                                        18990053
190000               PS-PO-PACK-CSR-EOF TO TRUE                         19000053
190100           MOVE SQLCODE   TO RC001-SAVE-SQLCODE                   19010053
190200           MOVE SQLCODE   TO TM500-SQLCODE                        19020053
190300                             TM007-SQLCODE                        19030099
190400           MOVE SQLCA     TO TM500-SQLCA                          19040053
190500                             TM007-SQLCA                          19050099
190600           MOVE SPACES    TO TM501-TM500-RETURN-MSG               19060053
190700           MOVE '821'     TO TM501-PGM                            19070099
190800           MOVE '2115'    TO TM501-PARA                           19080053
190900                             TM007-RETURNED-PARA                  19090099
191000           MOVE 'TPURCHS' TO TM501-TBL                            19100053
191100           MOVE 11        TO TM501-PRORATION-ERROR-NBR            19110053
191200           PERFORM TM501-SET-TM500-RETURN-MSG                     19120053
191300           MOVE TM500-RETURN-DATA                                 19130099
191400                          TO TM007-RETURN-DATA                    19140099
191500           PERFORM RC001-RETURN-MSG                               19150053
191600     END-EVALUATE.                                                19160053
191700                                                                  19170053
191800* -------------------------------------------------------------- *19180053
191900*    MULTIPLE ROWS ARE ALWAYS FETCHED FROM THIS TABLE IF         *19190053
192000*    PACKAGING IS PREPACK.                                       *19200053
192100* -------------------------------------------------------------- *19210053
192200 2117-LOOP-PO-PACK-99-CSR.                                        19220053
192300     MOVE '2117-LOOP-PO-PACK-99-CSR' TO RC001-PARAGRAPH.          19230053
192400                                                                  19240053
192500     EXEC SQL                                                     19250053
192600         FETCH PO-PACK-99-CSR                                     19260053
192700          INTO :PURCHS-DEPT-NBR                                   19270053
192800             , :PURCHS-NEW-STR-PO-IND                             19280053
192900             , :PURCHS-PO-TYP-CDE                                 19290053
193000             , :PURCHS-IMPRT-PO-IND                               19300053
193100             , :PURCHS-PKGNG-CDE                                  19310067
193200             , :PURCHS-PO-IN-RMS-IND                              19320053
193300             , :PURITM-PO-LNE-NBR                                 19330053
193400             , :PURITM-APP-PO-LNE-NBR                             19340053
193500             , :PURITM-SKU-SEQ-NBR                                19350053
193600             , :PURITM-STATUS-CDE                                 19360053
193700             , :PURITM-UNT-QTY                                    19370053
193800             , :PURITM-UNT-RTL-PR-AMT                             19380053
193900             , :PURITM-GP-RTL-AMT                                 19390053
194000             , :PURITM-GP-QTY                                     19400053
194100             , :PURITM-PIC-ITM-IND                                19410053
194200             , :PURITM-ITM-NBR                                    19420053
194300             , :PURITM-PREPK-RATO-QTY                             19430053
194400     END-EXEC.                                                    19440053
194500                                                                  19450053
194600     EVALUATE SQLCODE                                             19460053
194700       WHEN +0                                                    19470053
194800           MOVE SPACES TO POPRPK-PREPK-TYP-CDE                    19480053
194900                          POPRPK-PREPK-STAT-CDE                   19490053
195000           MOVE ZEROES TO POPRPK-PREPK-UPC-NBR                    19500053
195100                          POPRPK-INPK-UNT-QTY                     19510053
195200                          POPRPK-OTPK-UNT-QTY                     19520053
195300                          POPRPK-PK-SKU-NBR                       19530053
195400           PERFORM 2120-MOVE-PO-PACK-DATA                         19540053
195500           SET RC821-ITEM-IDX UP BY +1                            19550099
195600                                                                  19560053
195700       WHEN +100                                                  19570053
195800           SET PS-PO-PACK-CSR-EOF TO TRUE                         19580053
195900                                                                  19590053
196000       WHEN OTHER                                                 19600053
196100           SET PS-DONE-YES                                        19610053
196200               PS-PO-PACK-CSR-EOF TO TRUE                         19620053
196300           MOVE SQLCODE   TO RC001-SAVE-SQLCODE                   19630053
196400           MOVE SQLCODE   TO TM500-SQLCODE                        19640053
196500                             TM007-SQLCODE                        19650099
196600           MOVE SQLCA     TO TM500-SQLCA                          19660053
196700                             TM007-SQLCA                          19670099
196800           MOVE SPACES    TO TM501-TM500-RETURN-MSG               19680053
196900           MOVE '821'     TO TM501-PGM                            19690099
197000           MOVE '2117'    TO TM501-PARA                           19700053
197100                             TM007-RETURNED-PARA                  19710099
197200           MOVE 'TPURCHS' TO TM501-TBL                            19720053
197300           MOVE 12        TO TM501-PRORATION-ERROR-NBR            19730053
197400           PERFORM TM501-SET-TM500-RETURN-MSG                     19740053
197500           MOVE TM500-RETURN-DATA                                 19750099
197600                          TO TM007-RETURN-DATA                    19760099
197700           PERFORM RC001-RETURN-MSG                               19770053
197800     END-EVALUATE.                                                19780053
197900                                                                  19790053
198000* -------------------------------------------------------------- *19800053
198100* -------------------------------------------------------------- *19810053
198200 2119-CLOSE-PO-PACK-99-CSR.                                       19820053
198300     MOVE '2119-CLOSE-PO-PACK-99-CSR' TO RC001-PARAGRAPH.         19830053
198400                                                                  19840053
198500     EXEC SQL                                                     19850053
198600         CLOSE PO-PACK-99-CSR                                     19860053
198700     END-EXEC.                                                    19870053
198800                                                                  19880053
198900     EVALUATE SQLCODE                                             19890053
199000       WHEN +0                                                    19900053
199100           SET PS-PO-PACK-CSR-EOF TO TRUE                         19910053
199200                                                                  19920053
199300       WHEN OTHER                                                 19930053
199400           SET PS-DONE-YES                                        19940053
199500               PS-PO-PACK-CSR-EOF TO TRUE                         19950053
199600           MOVE SQLCA     TO TM500-SQLCA                          19960053
199700                             TM007-SQLCA                          19970099
199800           MOVE SQLCODE   TO TM500-SQLCODE                        19980053
199900                             TM007-SQLCODE                        19990099
200000           MOVE SQLCODE   TO RC001-SAVE-SQLCODE                   20000053
200100           MOVE SPACES    TO TM501-TM500-RETURN-MSG               20010053
200200           MOVE '821'     TO TM501-PGM                            20020099
200300           MOVE '2119'    TO TM501-PARA                           20030053
200400                             TM007-RETURNED-PARA                  20040099
200500           MOVE 'TPURCHS' TO TM501-TBL                            20050053
200600           MOVE 16        TO TM501-PRORATION-ERROR-NBR            20060053
200700           PERFORM TM501-SET-TM500-RETURN-MSG                     20070053
200800           MOVE TM500-RETURN-DATA                                 20080099
200900                          TO TM007-RETURN-DATA                    20090099
201000           PERFORM RC001-RETURN-MSG                               20100053
201100     END-EVALUATE.                                                20110053
201200                                                                  20120053
201300* -------------------------------------------------------------- *20130053
201400* -------------------------------------------------------------- *20140003
201500                                                                  20150003
201600 2120-MOVE-PO-PACK-DATA.                                          20160010
201700                                                                  20170003
201800     MOVE '2120-MOVE-PO-PACK-DATA    ' TO RC001-PARAGRAPH.        20180033
201900                                                                  20190003
202000     MOVE PURITM-PO-LNE-NBR                                       20200003
202100       TO RC821-PO-LNE-NBR        (RC821-ITEM-IDX).               20210099
202200                                                                  20220003
202300     MOVE PURITM-APP-PO-LNE-NBR                                   20230003
202400       TO RC821-APP-PO-LNE-NBR    (RC821-ITEM-IDX).               20240099
202500                                                                  20250003
202600     MOVE PURITM-STATUS-CDE                                       20260003
202700       TO RC821-PO-LNE-STATUS-CDE (RC821-ITEM-IDX).               20270099
202800                                                                  20280003
202900     MOVE PURITM-UNT-QTY                                          20290003
203000       TO RC821-PO-UNIT-QTY       (RC821-ITEM-IDX).               20300099
203100                                                                  20310003
203200     MOVE PURITM-UNT-RTL-PR-AMT                                   20320003
203300       TO RC821-PO-UNT-RTL-PR-AMT (RC821-ITEM-IDX).               20330099
203400                                                                  20340003
203500     MOVE PURITM-GP-RTL-AMT                                       20350003
203600       TO RC821-PO-GP-RTL-AMT     (RC821-ITEM-IDX).               20360099
203700                                                                  20370003
203800     MOVE PURITM-GP-QTY                                           20380003
203900       TO RC821-PO-GP-QTY         (RC821-ITEM-IDX).               20390099
204000                                                                  20400003
204100     MOVE PURITM-PREPK-RATO-QTY                                   20410003
204200       TO RC821-PO-PACK-RATO-QTY  (RC821-ITEM-IDX).               20420099
204300                                                                  20430003
204400     MOVE POPRPK-PREPK-TYP-CDE  TO  RC821-PREPK-TYPE-CDE.         20440099
204500     MOVE POPRPK-PREPK-UPC-NBR  TO  RC821-PACK-UPC-NBR.           20450099
204600     MOVE POPRPK-INPK-UNT-QTY   TO  RC821-INPK-UNT-QTY.           20460099
204700     MOVE POPRPK-OTPK-UNT-QTY   TO  RC821-OTPK-UNT-QTY.           20470099
204800     MOVE POPRPK-PK-SKU-NBR     TO  RC821-PACK-SKU-NBR.           20480099
204900                                                                  20490003
205000     ADD 1 TO RC821-ITEM-COUNT.                                   20500099
205100                                                                  20510003
205200*    -------------------------------------------------------      20520003
205300*    THIS IS A LEGACY PO INDICATOR AND IT DOES NOT APPLY          20530003
205400*    TO RMS SOURCED PO'S.                                         20540003
205500*    -------------------------------------------------------      20550003
205600                                                                  20560003
205700     IF PURITM-SKU-SEQ-NBR EQUAL '000' OR '999'                   20570003
205800         MOVE PC-Y TO RC821-DUMMY-SKU-IND (RC821-ITEM-IDX)        20580099
205900     ELSE                                                         20590003
206000         MOVE PC-N TO RC821-DUMMY-SKU-IND (RC821-ITEM-IDX)        20600099
206100     END-IF.                                                      20610003
206200                                                                  20620003
206300     IF PURCHS-PO-TYP-CDE EQUAL PC-IE  OR                         20630003
206400                                PC-IF  OR                         20640003
206500                                PC-IM                             20650003
206600         MOVE PC-Y TO TM500-IMPORT-PO-IND                         20660003
206700                      RC821-IMPRT-PO-IND                          20670099
206800     ELSE                                                         20680003
206900         MOVE PC-N TO TM500-IMPORT-PO-IND                         20690003
207000                      RC821-IMPRT-PO-IND                          20700099
207100     END-IF.                                                      20710003
207200                                                                  20720003
207300     IF PURITM-PREPK-RATO-QTY > +0                                20730003
207400         MOVE PC-N TO RC821-BAD-PACK-DISTRO-IND                   20740099
207500     ELSE                                                         20750003
207600         MOVE PC-Y TO RC821-BAD-PACK-DISTRO-IND                   20760099
207700     END-IF.                                                      20770003
207800                                                                  20780003
207900     MOVE PURITM-PIC-ITM-IND    TO TM500-AD-ITM-IND.              20790003
208000     MOVE PURCHS-PO-IN-RMS-IND  TO RC821-RMS-PO-IND.              20800099
208100     MOVE PURCHS-IMPRT-PO-IND   TO RC821-IMPRT-PO-IND.            20810099
208200     MOVE PURCHS-NEW-STR-PO-IND TO TM500-NEW-STR-PO-IND           20820003
208300                                   RC821-NEW-STR-IND.             20830099
208400                                                                  20840003
208500*    PERFORM 4090-GET-DATE-RANGE.                                 20850062
208600                                                                  20860003
208700     MOVE PURITM-ITM-NBR  TO DK-ITM-NBR.                          20870003
208800                                                                  20880003
208900     PERFORM 2130-SELECT-XL-ITEM.                                 20890010
209000                                                                  20900003
209100     SET RC822-PACK-IDX TO RC821-ITEM-IDX.                        20910099
209200                                                                  20920003
209300     MOVE RC821-PO-LNE-NBR       (RC821-ITEM-IDX)                 20930099
209400       TO RC822-PO-LINE-NBR      (RC822-PACK-IDX).                20940099
209500                                                                  20950003
209600     MOVE RC821-PO-SKU-NBR       (RC821-ITEM-IDX)                 20960099
209700       TO RC822-PO-SKU-NBR       (RC822-PACK-IDX).                20970099
209800                                                                  20980003
209900     MOVE RC821-PO-PACK-RATO-QTY (RC821-ITEM-IDX)                 20990099
210000       TO RC822-PO-PACK-RATO-QTY (RC822-PACK-IDX).                21000099
210100                                                                  21010003
210200                                                                  21020003
210300* -------------------------------------------------------------- *21030003
210400* -------------------------------------------------------------- *21040003
210500                                                                  21050003
210600 2130-SELECT-XL-ITEM.                                             21060010
210700                                                                  21070003
210800     MOVE '2130-SELECT-XL-ITEM  ' TO RC001-PARAGRAPH.             21080033
210900                                                                  21090003
211000     INITIALIZE XL001-ITEM-COMMAREA.                              21100003
211100                                                                  21110003
211200     MOVE DK-ITM-NBR TO XL001-KEY-ITM-NBR.                        21120003
211300                                                                  21130003
211400     SET XL001-BY-ITEM                                            21140003
211500         XL001-SELECT-SKU                                         21150003
211600         XL001-SELECT-UPC                                         21160003
211700         XL001-SELECT-SKU-STR                                     21170003
211800         XL001-SELECT-WEB-SKU TO TRUE.                            21180003
211900                                                                  21190003
212000     CALL XL001-VSM-PGM USING XL001-ITEM-COMMAREA                 21200099
212100                                                                  21210003
212200     EVALUATE XL001-SKU-SQLCODE                                   21220003
212300                                                                  21230003
212400       WHEN +0                                                    21240003
212500           PERFORM 4100-SELECT-VND-STYL                           21250003
212600           PERFORM 3150-MOVE-XL001-DATA                           21260003
212700                                                                  21270003
212800       WHEN +100                                                  21280003
212900           SET PS-DONE-YES                                        21290003
213000               TM500-SKU-NOT-FOUND-FOR-LINE TO TRUE               21300003
213100           MOVE XL001-SKU-SQLCODE  TO RC001-SAVE-SQLCODE          21310003
213200                                      TM500-SQLCODE               21320099
213300                                      TM007-SQLCODE               21330099
213400           MOVE XL001-SQLCA        TO TM500-SQLCA                 21340099
213500                                      TM007-SQLCA                 21350099
213600           MOVE SPACES             TO TM501-TM500-RETURN-MSG      21360003
213700           MOVE '821'              TO TM501-PGM                   21370099
213800           MOVE '2130'             TO TM501-PARA                  21380010
213900                                      TM007-RETURNED-PARA         21390099
214000           MOVE 13                 TO TM501-PRORATION-ERROR-NBR   21400003
214100           PERFORM TM501-SET-TM500-RETURN-MSG                     21410003
214200           MOVE TM500-RETURN-DATA  TO TM007-RETURN-DATA           21420099
214300           PERFORM RC001-RETURN-MSG                               21430003
214400                                                                  21440003
214500       WHEN -904                                                  21450003
214600       WHEN -911                                                  21460003
214700       WHEN -913                                                  21470003
214800           SET PS-DONE-YES TO TRUE                                21480003
214900           MOVE XL001-SKU-SQLCODE  TO RC001-SAVE-SQLCODE          21490003
215000                                      TM500-SQLCODE               21500099
215100                                      TM007-SQLCODE               21510099
215200           MOVE XL001-SQLCA        TO TM500-SQLCA                 21520099
215300                                      TM007-SQLCA                 21530099
215400           MOVE SPACES             TO TM501-TM500-RETURN-MSG      21540003
215500           MOVE '821'              TO TM501-PGM                   21550099
215600           MOVE '2130'             TO TM501-PARA                  21560010
215700                                      TM007-RETURNED-PARA         21570099
215800           MOVE 14                 TO TM501-PRORATION-ERROR-NBR   21580003
215900           PERFORM TM501-SET-TM500-RETURN-MSG                     21590003
216000           MOVE TM500-RETURN-DATA  TO TM007-RETURN-DATA           21600099
216100           PERFORM RC001-RETURN-MSG                               21610003
216200                                                                  21620003
216300       WHEN OTHER                                                 21630000
216400           SET PS-DONE-YES TO TRUE                                21640000
216500           MOVE XL001-SKU-SQLCODE  TO RC001-SAVE-SQLCODE          21650000
216600                                      TM500-SQLCODE               21660099
216700                                      TM007-SQLCODE               21670099
216800           MOVE XL001-SQLCA        TO TM500-SQLCA                 21680099
216900                                      TM007-SQLCA                 21690099
217000           MOVE SPACES             TO TM501-TM500-RETURN-MSG      21700003
217100           MOVE '821'              TO TM501-PGM                   21710099
217200           MOVE '2130'             TO TM501-PARA                  21720010
217300                                      TM007-RETURNED-PARA         21730099
217400           MOVE 15                 TO TM501-PRORATION-ERROR-NBR   21740003
217500           PERFORM TM501-SET-TM500-RETURN-MSG                     21750003
217600           MOVE TM500-RETURN-DATA  TO TM007-RETURN-DATA           21760099
217700           PERFORM RC001-RETURN-MSG                               21770003
217800                                                                  21780003
217900     END-EVALUATE.                                                21790003
218000                                                                  21800003
218100* -------------------------------------------------------------- *21810003
218200* -------------------------------------------------------------- *21820003
218300                                                                  21830003
218400 2140-CLOSE-PO-PACK-CSR.                                          21840010
218500                                                                  21850003
218600     MOVE '2140-CLOSE-PO-PACK-CSR ' TO RC001-PARAGRAPH.           21860033
218700                                                                  21870003
218800     EXEC SQL                                                     21880003
218900         CLOSE PO-PACK-CSR                                        21890003
219000     END-EXEC.                                                    21900003
219100                                                                  21910003
219200     EVALUATE SQLCODE                                             21920003
219300                                                                  21930003
219400       WHEN +0                                                    21940003
219500           SET PS-PO-PACK-CSR-EOF TO TRUE                         21950003
219600                                                                  21960003
219700       WHEN OTHER                                                 21970003
219800           SET PS-DONE-YES                                        21980003
219900               PS-PO-PACK-CSR-EOF TO TRUE                         21990003
220000           MOVE SQLCA     TO TM500-SQLCA                          22000003
220100                             TM007-SQLCA                          22010099
220200           MOVE SQLCODE   TO TM500-SQLCODE                        22020003
220300                             TM007-SQLCODE                        22030099
220400           MOVE SQLCODE   TO RC001-SAVE-SQLCODE                   22040003
220500           MOVE SPACES    TO TM501-TM500-RETURN-MSG               22050003
220600           MOVE '821'     TO TM501-PGM                            22060099
220700           MOVE '2140'    TO TM501-PARA                           22070010
220800                             TM007-RETURNED-PARA                  22080099
220900           MOVE 'TPURCHS' TO TM501-TBL                            22090003
221000           MOVE 16        TO TM501-PRORATION-ERROR-NBR            22100000
221100           PERFORM TM501-SET-TM500-RETURN-MSG                     22110000
221200           MOVE TM500-RETURN-DATA                                 22120099
221300                          TO TM007-RETURN-DATA                    22130099
221400           PERFORM RC001-RETURN-MSG                               22140003
221500                                                                  22150003
221600     END-EVALUATE.                                                22160003
221700                                                                  22170003
221800                                                                  22180003
221900* -------------------------------------------------------------- *22190003
222000* -------------------------------------------------------------- *22200003
222100*             R E T R I E V E   R C   D A T A                    *22210003
222200*                                                                *22220003
222300* -------------------------------------------------------------- *22230003
222400*    LOAD DATA BASED ON PACKAGING OF THE PO:                     *22240003
222500*    B, C, S = BULK                                              *22250003
222600*    I, M    = PREPACK                                           *22260003
222700* -------------------------------------------------------------- *22270003
222800* -------------------------------------------------------------- *22280003
222900                                                                  22290003
223000 3000-GET-RC-DATA.                                                22300003
223100                                                                  22310003
223200     MOVE '3000-GET-RC-DATA          ' TO RC001-PARAGRAPH.        22320033
223300                                                                  22330003
223400     SET RC821-ITEM-IDX TO +1.                                    22340099
223500                                                                  22350003
223600     IF PS-BULK  OR  RC821-PREPK-ID = 0                           22360099
223700         PERFORM 3010-OPEN-RC-BULK-CSR                            22370003
223800                                                                  22380003
223900         PERFORM 3020-FETCH-RC-BULK-CSR                           22390003
224000           UNTIL PS-RC-BULK-CSR-EOF                               22400003
224100                                                                  22410003
224200         PERFORM 3040-CLOSE-RC-BULK-CSR                           22420003
224300     END-IF.                                                      22430003
224400                                                                  22440003
224500     IF PS-PREPACK  AND  RC821-PREPK-ID > 0                       22450099
224600         PERFORM 3100-OPEN-RC-PACK-CSR                            22460003
224700                                                                  22470003
224800         PERFORM 3110-LOOP-RC-PACK-CSR                            22480003
224900           UNTIL PS-RC-PACK-CSR-EOF                               22490003
225000                                                                  22500003
225100         PERFORM 3140-CLOSE-RC-PACK-CSR                           22510003
225200     END-IF.                                                      22520003
225300                                                                  22530003
225400                                                                  22540003
225500* -------------------------------------------------------------- *22550003
225600* -------------------------------------------------------------- *22560003
225700                                                                  22570003
225800 3010-OPEN-RC-BULK-CSR.                                           22580003
225900                                                                  22590003
226000     MOVE '3010-OPEN-RC-BULK-CSR ' TO RC001-PARAGRAPH.            22600033
226100                                                                  22610003
226200     EXEC SQL                                                     22620003
226300         OPEN RC-BULK-CSR                                         22630003
226400     END-EXEC.                                                    22640003
226500                                                                  22650003
226600     EVALUATE SQLCODE                                             22660003
226700                                                                  22670003
226800       WHEN +0                                                    22680003
226900           SET PS-RC-BULK-CSR-START TO TRUE                       22690003
227000                                                                  22700003
227100       WHEN OTHER                                                 22710003
227200           SET PS-DONE-YES                                        22720003
227300               PS-RC-BULK-CSR-EOF TO TRUE                         22730003
227400           MOVE SQLCA      TO TM500-SQLCA                         22740003
227500                              TM007-SQLCA                         22750099
227600           MOVE SQLCODE    TO TM500-SQLCODE                       22760003
227700                              TM007-SQLCODE                       22770099
227800           MOVE SQLCODE    TO RC001-SAVE-SQLCODE                  22780003
227900           MOVE SPACES     TO TM501-TM500-RETURN-MSG              22790003
228000           MOVE '821'      TO TM501-PGM                           22800099
228100           MOVE '3010'     TO TM501-PARA                          22810003
228200                              TM007-RETURNED-PARA                 22820099
228300           MOVE 'TRECITM'  TO TM501-TBL                           22830003
228400           MOVE 17         TO TM501-PRORATION-ERROR-NBR           22840003
228500           PERFORM TM501-SET-TM500-RETURN-MSG                     22850003
228600           MOVE TM500-RETURN-DATA                                 22860099
228700                           TO TM007-RETURN-DATA                   22870099
228800           PERFORM RC001-RETURN-MSG                               22880003
228900                                                                  22890003
229000     END-EVALUATE.                                                22900003
229100                                                                  22910003
229200                                                                  22920003
229300* -------------------------------------------------------------- *22930003
229400*    ONE ROW IS ALWAYS FETCHED FROM THIS TABLE IF PACKAGING      *22940003
229500*    IS BULK.                                                    *22950003
229600* -------------------------------------------------------------- *22960003
229700                                                                  22970003
229800 3020-FETCH-RC-BULK-CSR.                                          22980003
229900                                                                  22990003
230000     MOVE '3020-FETCH-RC-BULK-CSR ' TO RC001-PARAGRAPH.           23000033
230100                                                                  23010003
230200     EXEC SQL                                                     23020003
230300                                                                  23030003
230400         FETCH RC-BULK-CSR                                        23040003
230500                                                                  23050003
230600          INTO :RECITM-CRE-TMST                                   23060003
230700             , :RECITM-STATUS-CDE                                 23070003
230800             , :RECITM-ORD-LNE-NBR                                23080003
230900             , :RECITM-PKSL-ITM-QTY                               23090003
231000             , :RECITM-DTL-CK-ITM-QTY                             23100003
231100             , :RECITM-PREPK-RATO-QTY                             23110003
231200             , :RECITM-CASE-PACK-QTY                              23120003
231300             , :RECITM-INNR-PACK-QTY                              23130003
231400             , :RECITM-PREPK-ODD-UNT-QTY                          23140003
231500             , :RECITM-PREPK-DRV-LNE-CDE                          23150003
231600             , :RECITM-ITM-NBR                                    23160003
231700                                                                  23170003
231800     END-EXEC.                                                    23180003
231900                                                                  23190003
232000     EVALUATE SQLCODE                                             23200003
232100                                                                  23210003
232200       WHEN +0                                                    23220003
232300           MOVE RECITM-ITM-NBR TO DK-ITM-NBR                      23230003
232400           PERFORM 2040-SELECT-XL-ITEM                            23240003
232500           PERFORM 3030-MOVE-RECITM-BULK-DATA                     23250003
232600           SET RC821-ITEM-IDX UP BY +1                            23260099
232700                                                                  23270003
232800       WHEN +100                                                  23280003
232900           SET PS-RC-BULK-CSR-EOF TO TRUE                         23290003
233000                                                                  23300003
233100       WHEN OTHER                                                 23310003
233200           SET PS-DONE-YES                                        23320003
233300               PS-RC-BULK-CSR-EOF TO TRUE                         23330003
233400           MOVE SQLCA     TO TM500-SQLCA                          23340003
233500                             TM007-SQLCA                          23350099
233600           MOVE SQLCODE   TO TM500-SQLCODE                        23360003
233700                             TM007-SQLCODE                        23370099
233800           MOVE SQLCODE   TO RC001-SAVE-SQLCODE                   23380003
233900           MOVE SPACES    TO TM501-TM500-RETURN-MSG               23390003
234000           MOVE '821'     TO TM501-PGM                            23400099
234100           MOVE '3020'    TO TM501-PARA                           23410004
234200                             TM007-RETURNED-PARA                  23420099
234300           MOVE 'TRECITM' TO TM501-TBL                            23430004
234400           MOVE 18        TO TM501-PRORATION-ERROR-NBR            23440003
234500           PERFORM TM501-SET-TM500-RETURN-MSG                     23450003
234600           MOVE TM500-RETURN-DATA                                 23460099
234700                          TO TM007-RETURN-DATA                    23470099
234800           PERFORM RC001-RETURN-MSG                               23480003
234900                                                                  23490003
235000     END-EVALUATE.                                                23500003
235100                                                                  23510003
235200                                                                  23520003
235300* -------------------------------------------------------------- *23530003
235400* -------------------------------------------------------------- *23540003
235500                                                                  23550003
235600 3030-MOVE-RECITM-BULK-DATA.                                      23560003
235700                                                                  23570003
235800     MOVE '3030-MOVE-RECITM-BULK-DATA' TO RC001-PARAGRAPH.        23580033
235900                                                                  23590003
236000     MOVE RECITM-ITM-NBR TO DK-ITM-NBR.                           23600003
236100                                                                  23610003
236200     MOVE RECITM-INNR-PACK-QTY                                    23620003
236300       TO RC821-REC-INNER-PACK-QTY (RC821-ITEM-IDX).              23630099
236400                                                                  23640003
236500     MOVE RECITM-ORD-LNE-NBR                                      23650003
236600       TO RC821-REC-LNE-NBR        (RC821-ITEM-IDX).              23660099
236700                                                                  23670003
236800     MOVE RECITM-ITM-NBR                                          23680003
236900       TO RC821-REC-ITEM-NBR       (RC821-ITEM-IDX).              23690099
237000                                                                  23700003
237100     MOVE RECITM-PKSL-ITM-QTY                                     23710003
237200       TO RC821-PKSL-ITM-QTY       (RC821-ITEM-IDX).              23720099
237300                                                                  23730003
237400     MOVE RECITM-DTL-CK-ITM-QTY                                   23740003
237500       TO RC821-DTL-CK-ITM-QTY     (RC821-ITEM-IDX).              23750099
237600                                                                  23760003
237700     MOVE RECITM-CASE-PACK-QTY                                    23770003
237800       TO RC821-REC-CASE-PACK-QTY  (RC821-ITEM-IDX).              23780099
237900                                                                  23790003
238000     MOVE ZEROS TO RC821-ODD-UNIT-QTY  (RC821-ITEM-IDX)           23800099
238100                   RC821-TOTAL-ODD-UNITS.                         23810099
238200                                                                  23820003
238300     MOVE PC-N  TO  RC821-BAD-PACK-DISTRO-IND.                    23830099
238400                                                                  23840003
238500*    PERFORM 4090-GET-DATE-RANGE.                                 23850062
238600                                                                  23860003
238700* -------------------------------------------------------------- *23870003
238800* -------------------------------------------------------------- *23880003
238900                                                                  23890003
239000 3040-CLOSE-RC-BULK-CSR.                                          23900003
239100                                                                  23910003
239200     MOVE '3040-CLOSE-RC-BULK-CSR ' TO RC001-PARAGRAPH.           23920033
239300                                                                  23930003
239400     EXEC SQL                                                     23940003
239500         CLOSE RC-BULK-CSR                                        23950003
239600     END-EXEC.                                                    23960003
239700                                                                  23970003
239800     EVALUATE SQLCODE                                             23980003
239900                                                                  23990003
240000       WHEN +0                                                    24000003
240100           SET PS-RC-BULK-CSR-EOF TO TRUE                         24010003
240200                                                                  24020003
240300       WHEN OTHER                                                 24030003
240400           SET PS-DONE-YES                                        24040003
240500               PS-RC-BULK-CSR-EOF TO TRUE                         24050003
240600           MOVE SQLCA      TO TM500-SQLCA                         24060003
240700                              TM007-SQLCA                         24070099
240800           MOVE SQLCODE    TO TM500-SQLCODE                       24080003
240900                              TM007-SQLCODE                       24090099
241000           MOVE SQLCODE    TO RC001-SAVE-SQLCODE                  24100003
241100           MOVE SPACES     TO TM501-TM500-RETURN-MSG              24110003
241200           MOVE '821'      TO TM501-PGM                           24120099
241300           MOVE '3040'     TO TM501-PARA                          24130003
241400                              TM007-RETURNED-PARA                 24140099
241500           MOVE 'TRECITM'  TO TM501-TBL                           24150003
241600           MOVE 19         TO TM501-PRORATION-ERROR-NBR           24160003
241700           PERFORM TM501-SET-TM500-RETURN-MSG                     24170003
241800           MOVE TM500-RETURN-DATA                                 24180099
241900                           TO TM007-RETURN-DATA                   24190099
242000           PERFORM RC001-RETURN-MSG                               24200003
242100                                                                  24210003
242200     END-EVALUATE.                                                24220003
242300                                                                  24230003
242400                                                                  24240003
242500* -------------------------------------------------------------- *24250003
242600* -------------------------------------------------------------- *24260003
242700                                                                  24270003
242800 3100-OPEN-RC-PACK-CSR.                                           24280003
242900                                                                  24290003
243000     MOVE '3100-OPEN-RC-PACK-CSR ' TO RC001-PARAGRAPH.            24300033
243100                                                                  24310003
243200     EXEC SQL                                                     24320003
243300         OPEN RC-PACK-CSR                                         24330003
243400     END-EXEC.                                                    24340003
243500                                                                  24350003
243600     EVALUATE SQLCODE                                             24360003
243700                                                                  24370003
243800       WHEN +0                                                    24380003
243900           SET PS-RC-PACK-CSR-START TO TRUE                       24390003
244000                                                                  24400003
244100       WHEN OTHER                                                 24410003
244200           SET PS-DONE-YES                                        24420003
244300               PS-RC-PACK-CSR-EOF TO TRUE                         24430003
244400           MOVE SQLCA      TO TM500-SQLCA                         24440003
244500                              TM007-SQLCA                         24450099
244600           MOVE SQLCODE    TO TM500-SQLCODE                       24460003
244700                              TM007-SQLCODE                       24470099
244800           MOVE SQLCODE    TO RC001-SAVE-SQLCODE                  24480003
244900           MOVE SPACES     TO TM501-TM500-RETURN-MSG              24490003
245000           MOVE '821'      TO TM501-PGM                           24500099
245100           MOVE '3100'     TO TM501-PARA                          24510003
245200                              TM007-RETURNED-PARA                 24520099
245300           MOVE 'TRECITM'  TO TM501-TBL                           24530003
245400           MOVE 20         TO TM501-PRORATION-ERROR-NBR           24540003
245500           PERFORM TM501-SET-TM500-RETURN-MSG                     24550003
245600           MOVE TM500-RETURN-DATA                                 24560099
245700                           TO TM007-RETURN-DATA                   24570099
245800           PERFORM RC001-RETURN-MSG                               24580003
245900                                                                  24590003
246000     END-EVALUATE.                                                24600003
246100                                                                  24610003
246200                                                                  24620003
246300* -------------------------------------------------------------- *24630003
246400*    MULTIPLE ROWS ARE ALWAYS FETCHED FROM THIS TABLE IF         *24640003
246500*    PACKAGING IS PREPACK.                                       *24650003
246600* -------------------------------------------------------------- *24660003
246700                                                                  24670003
246800 3110-LOOP-RC-PACK-CSR.                                           24680003
246900                                                                  24690003
247000     MOVE '3110-LOOP-RC-PACK-CSR ' TO RC001-PARAGRAPH.            24700033
247100                                                                  24710003
247200     EXEC SQL                                                     24720003
247300                                                                  24730003
247400         FETCH RC-PACK-CSR                                        24740003
247500                                                                  24750003
247600          INTO :RECITM-CRE-TMST                                   24760003
247700             , :RECITM-STATUS-CDE                                 24770003
247800             , :RECITM-ORD-LNE-NBR                                24780003
247900             , :RECITM-PKSL-ITM-QTY                               24790003
248000             , :RECITM-DTL-CK-ITM-QTY                             24800003
248100             , :RECITM-PREPK-RATO-QTY                             24810003
248200             , :RECITM-CASE-PACK-QTY                              24820003
248300             , :RECITM-INNR-PACK-QTY                              24830003
248400             , :RECITM-PREPK-ODD-UNT-QTY                          24840003
248500             , :RECITM-PREPK-DRV-LNE-CDE                          24850003
248600             , :RECITM-ITM-NBR                                    24860003
248700                                                                  24870003
248800     END-EXEC.                                                    24880003
248900                                                                  24890003
249000     EVALUATE SQLCODE                                             24900003
249100                                                                  24910003
249200       WHEN +0                                                    24920003
249300           MOVE RECITM-ITM-NBR TO DK-ITM-NBR                      24930003
249400           PERFORM 2040-SELECT-XL-ITEM                            24940003
249500           PERFORM 3120-LOAD-RC-DATA-TO-RC821                     24950013
249600                                                                  24960003
249700           SET RC821-ITEM-IDX UP BY +1                            24970099
249800                                                                  24980003
249900       WHEN +100                                                  24990003
250000           SET PS-RC-PACK-CSR-EOF TO TRUE                         25000003
250100                                                                  25010003
250200       WHEN OTHER                                                 25020003
250300           SET PS-DONE-YES                                        25030003
250400               PS-RC-PACK-CSR-EOF TO TRUE                         25040003
250500           MOVE SQLCA     TO TM500-SQLCA                          25050018
250600                             TM007-SQLCA                          25060099
250700           MOVE SQLCODE   TO TM500-SQLCODE                        25070018
250800                             TM007-SQLCODE                        25080099
250900           MOVE SQLCODE   TO RC001-SAVE-SQLCODE                   25090018
251000           MOVE SPACES    TO TM501-TM500-RETURN-MSG               25100018
251100           MOVE '821'     TO TM501-PGM                            25110099
251200           MOVE '3110'    TO TM501-PARA                           25120018
251300                             TM007-RETURNED-PARA                  25130099
251400           MOVE 'TRECITM' TO TM501-TBL                            25140018
251500           MOVE 21        TO TM501-PRORATION-ERROR-NBR            25150018
251600           PERFORM TM501-SET-TM500-RETURN-MSG                     25160003
251700           MOVE TM500-RETURN-DATA                                 25170099
251800                          TO TM007-RETURN-DATA                    25180099
251900           PERFORM RC001-RETURN-MSG                               25190003
252000                                                                  25200003
252100     END-EVALUATE.                                                25210003
252200                                                                  25220003
252300                                                                  25230003
252400* -------------------------------------------------------------- *25240003
252500* -------------------------------------------------------------- *25250003
252600                                                                  25260003
252700 3120-LOAD-RC-DATA-TO-RC821.                                      25270013
252800                                                                  25280003
252900     MOVE '3120-LOAD-RC-DATA-TO-RC821' TO RC001-PARAGRAPH.        25290033
253000                                                                  25300003
253100     MOVE RECITM-ORD-LNE-NBR                                      25310003
253200       TO RC821-REC-LNE-NBR        (RC821-ITEM-IDX).              25320099
253300                                                                  25330003
253400     MOVE RECITM-ITM-NBR                                          25340003
253500       TO RC821-REC-ITEM-NBR       (RC821-ITEM-IDX).              25350099
253600                                                                  25360003
253700     MOVE RECITM-PKSL-ITM-QTY                                     25370003
253800       TO RC821-PKSL-ITM-QTY       (RC821-ITEM-IDX).              25380099
253900                                                                  25390003
254000     MOVE RECITM-DTL-CK-ITM-QTY                                   25400003
254100       TO RC821-DTL-CK-ITM-QTY     (RC821-ITEM-IDX).              25410099
254200                                                                  25420003
254300     MOVE RECITM-INNR-PACK-QTY                                    25430003
254400       TO RC821-REC-INNER-PACK-QTY (RC821-ITEM-IDX).              25440099
254500                                                                  25450003
254600     MOVE RECITM-CASE-PACK-QTY                                    25460003
254700       TO RC821-REC-CASE-PACK-QTY  (RC821-ITEM-IDX).              25470099
254800                                                                  25480003
254900     MOVE RECITM-PREPK-RATO-QTY                                   25490003
255000       TO RC821-REC-PACK-RATO-QTY  (RC821-ITEM-IDX).              25500099
255100                                                                  25510003
255200     MOVE RECITM-PREPK-DRV-LNE-CDE                                25520003
255300       TO RC821-DRV-LNE-CDE        (RC821-ITEM-IDX).              25530099
255400                                                                  25540003
255500     MOVE RECITM-PREPK-ODD-UNT-QTY                                25550003
255600       TO RC821-ODD-UNIT-QTY       (RC821-ITEM-IDX).              25560099
255700                                                                  25570003
255800     ADD  RECITM-PREPK-ODD-UNT-QTY TO RC821-TOTAL-ODD-UNITS.      25580099
255900                                                                  25590003
256000*    PERFORM 4090-GET-DATE-RANGE.                                 25600062
256100                                                                  25610003
256200 3140-CLOSE-RC-PACK-CSR.                                          25620003
256300                                                                  25630003
256400     MOVE '3140-CLOSE-RC-PACK-CSR ' TO RC001-PARAGRAPH.           25640033
256500                                                                  25650003
256600     EXEC SQL                                                     25660003
256700         CLOSE RC-PACK-CSR                                        25670003
256800     END-EXEC.                                                    25680003
256900                                                                  25690003
257000     EVALUATE SQLCODE                                             25700003
257100                                                                  25710003
257200       WHEN +0                                                    25720003
257300           SET PS-RC-PACK-CSR-EOF TO TRUE                         25730003
257400                                                                  25740003
257500       WHEN OTHER                                                 25750003
257600           SET PS-DONE-YES                                        25760003
257700               PS-RC-PACK-CSR-EOF TO TRUE                         25770003
257800           MOVE SQLCA     TO TM500-SQLCA                          25780003
257900                             TM007-SQLCA                          25790099
258000           MOVE SQLCODE   TO TM500-SQLCODE                        25800003
258100                             TM007-SQLCODE                        25810099
258200           MOVE SQLCODE   TO RC001-SAVE-SQLCODE                   25820003
258300           MOVE SPACES    TO TM501-TM500-RETURN-MSG               25830003
258400           MOVE '821'     TO TM501-PGM                            25840099
258500           MOVE '3140'    TO TM501-PARA                           25850003
258600                             TM007-RETURNED-PARA                  25860099
258700           MOVE 'TRECITM' TO TM501-TBL                            25870003
258800           MOVE 22        TO TM501-PRORATION-ERROR-NBR            25880003
258900           PERFORM TM501-SET-TM500-RETURN-MSG                     25890003
259000           MOVE TM500-RETURN-DATA                                 25900099
259100                          TO TM007-RETURN-DATA                    25910099
259200           PERFORM RC001-RETURN-MSG                               25920003
259300                                                                  25930003
259400     END-EVALUATE.                                                25940003
259500                                                                  25950003
259600                                                                  25960003
259700* -------------------------------------------------------------- *25970003
259800* -------------------------------------------------------------- *25980003
259900                                                                  25990003
260000 3150-MOVE-XL001-DATA.                                            26000003
260100                                                                  26010003
260200     MOVE '3150-MOVE-XL001-DATA      ' TO RC001-PARAGRAPH.        26020033
260300                                                                  26030003
260400     IF XL001-WEB-SKU-SQLCODE EQUAL +0                            26040003
260500         MOVE PC-Y TO RC821-WEB-ITEM-IND (RC821-ITEM-IDX)         26050099
260600     ELSE                                                         26060003
260700         MOVE PC-N TO RC821-WEB-ITEM-IND (RC821-ITEM-IDX)         26070099
260800     END-IF.                                                      26080003
260900                                                                  26090003
261000     MOVE XL001-UPC-ID                                            26100003
261100       TO RC821-REC-ITEM-UPC-ID      (RC821-ITEM-IDX).            26110099
261200                                                                  26120003
261300     MOVE XL001-SKU-NBR                                           26130003
261400       TO RC821-REC-SKU-NBR          (RC821-ITEM-IDX)             26140099
261500          RC821-PO-SKU-NBR           (RC821-ITEM-IDX).            26150099
261600                                                                  26160003
261700     MOVE XL001-GP-AMT                                            26170003
261800       TO RC821-SK-GP-RTL-AMT        (RC821-ITEM-IDX).            26180099
261900                                                                  26190003
262000     MOVE XL001-GP-QTY                                            26200003
262100       TO RC821-SK-GP-QTY            (RC821-ITEM-IDX).            26210099
262200                                                                  26220003
262300     MOVE XL001-UNT-RTL-AMT                                       26230003
262400       TO RC821-SK-UNT-RTL-PR-AMT    (RC821-ITEM-IDX).            26240099
262500                                                                  26250003
262600     MOVE XL001-UPC-NBR                                           26260003
262700       TO RC821-REC-ITEM-UPC-NBR     (RC821-ITEM-IDX).            26270099
262800                                                                  26280003
262900     MOVE XL001-INTR-UPC-ID                                       26290003
263000       TO RC821-REC-ITEM-UPC-INTR-ID (RC821-ITEM-IDX).            26300099
263100                                                                  26310003
263200     MOVE XL001-ITM-NBR                                           26320003
263300       TO RC821-PO-ITEM-NBR          (RC821-ITEM-IDX).            26330099
263400                                                                  26340003
263500     MOVE XL001-INNR-PACK-QTY                                     26350070
263600       TO RC821-SKU-INNER-PACK-QTY   (RC821-ITEM-IDX).            26360099
263700                                                                  26370003
263800* -------------------------------------------------------------- *26380003
263900* -------------------------------------------------------------- *26390003
264000*           R E T R I E V E   M I S C   D A T A                  *26400003
264100* -------------------------------------------------------------- *26410003
264200* -------------------------------------------------------------- *26420003
264300                                                                  26430003
264400 4000-GET-MISC-DATA.                                              26440003
264500                                                                  26450003
264600     MOVE '4000-GET-MISC-DATA        ' TO RC001-PARAGRAPH.        26460033
264700                                                                  26470003
264800     PERFORM 4010-GET-STORE-TROUBLE-CNT.                          26480003
264900                                                                  26490003
265000     IF PS-BULK  OR  RC821-PREPK-ID = 0                           26500099
265100         PERFORM 4020-GET-BULK-TROUBLE-CNT                        26510003
265200     END-IF.                                                      26520003
265300                                                                  26530003
265400     IF PS-PREPACK  AND  RC821-PREPK-ID > 0                       26540099
265500         PERFORM 4030-GET-PREPACK-TROUBLE-CNT                     26550003
265600     END-IF.                                                      26560003
265700                                                                  26570003
265800     PERFORM 4040-GET-MISC-TRECEIV-DATA.                          26580063
265900                                                                  26590003
266000                                                                  26600003
266100* -------------------------------------------------------------- *26610003
266200* -------------------------------------------------------------- *26620003
266300                                                                  26630003
266400 4010-GET-STORE-TROUBLE-CNT.                                      26640003
266500                                                                  26650003
266600     MOVE '4010-GET-STORE-TROUBLE-CNT ' TO RC001-PARAGRAPH.       26660033
266700                                                                  26670003
266800     EXEC SQL                                                     26680003
266900                                                                  26690003
267000         SELECT COUNT(*)                                          26700003
267100                                                                  26710003
267200           INTO :PV-PO-RECEIV-CNT                                 26720003
267300                                                                  26730003
267400           FROM TRECEIV                                           26740003
267500                                                                  26750003
267600         WHERE ORD_NBR         =  :RC821-ORD-NBR                  26760099
267700           AND VER_STATUS_CDE  =  :PC-A                           26770003
267800                                                                  26780003
267900     END-EXEC.                                                    26790003
268000                                                                  26800003
268100     EVALUATE SQLCODE                                             26810003
268200                                                                  26820003
268300       WHEN +0                                                    26830003
268400           MOVE PV-PO-RECEIV-CNT TO RC821-REC-COUNT               26840099
268500                                                                  26850003
268600       WHEN OTHER                                                 26860003
268700           MOVE SQLCA       TO TM500-SQLCA                        26870003
268800                               TM007-SQLCA                        26880099
268900           MOVE SQLCODE     TO TM500-SQLCODE                      26890003
269000                               TM007-SQLCODE                      26900099
269100           MOVE SQLCODE     TO RC001-SAVE-SQLCODE                 26910003
269200           MOVE SPACES      TO TM501-TM500-RETURN-MSG             26920003
269300           MOVE '821'       TO TM501-PGM                          26930099
269400           MOVE '4010'      TO TM501-PARA                         26940003
269500                               TM007-RETURNED-PARA                26950099
269600           MOVE 'TRECEIV'   TO TM501-TBL                          26960003
269700           MOVE 23          TO TM501-PRORATION-ERROR-NBR          26970003
269800           PERFORM TM501-SET-TM500-RETURN-MSG                     26980003
269900           MOVE TM500-RETURN-DATA                                 26990099
270000                            TO TM007-RETURN-DATA                  27000099
270100           PERFORM RC001-RETURN-MSG                               27010003
270200                                                                  27020003
270300     END-EVALUATE.                                                27030003
270400                                                                  27040003
270500                                                                  27050003
270600* -------------------------------------------------------------- *27060003
270700* -------------------------------------------------------------- *27070003
270800                                                                  27080003
270900 4020-GET-BULK-TROUBLE-CNT.                                       27090003
271000                                                                  27100003
271100     MOVE '4020-GET-BULK-TROUBLE-CNT ' TO RC001-PARAGRAPH.        27110033
271200                                                                  27120003
271300     EXEC SQL                                                     27130003
271400                                                                  27140003
271500         SELECT COUNT(*)                                          27150003
271600                                                                  27160003
271700           INTO :PV-BULK-CNT                                      27170003
271800                                                                  27180003
271900           FROM TTRBNTF                                           27190003
272000                                                                  27200003
272100         WHERE PO_NBR        =  :RC821-ORD-NBR                    27210099
272200           AND PO_LNE_NBR    =  :RC821-REC-DRV-LNE-NBR            27220099
272300           AND TRBL_RSN_CDE  =  :PC-570                           27230003
272400           AND PRORATE_IND   =  :PC-Y                             27240003
272500           AND REC_SEQ_NBR   =  :RC821-REC-SEQ-NBR                27250099
272600                                                                  27260003
272700     END-EXEC.                                                    27270003
272800                                                                  27280003
272900     EVALUATE SQLCODE                                             27290003
273000                                                                  27300003
273100       WHEN +0                                                    27310003
273200           MOVE PV-BULK-CNT TO RC821-REC-TROUBLE-SHORT-CNT        27320099
273300                                                                  27330003
273400       WHEN OTHER                                                 27340003
273500           MOVE SQLCA        TO TM500-SQLCA                       27350003
273600                                TM007-SQLCA                       27360099
273700           MOVE SQLCODE      TO TM500-SQLCODE                     27370003
273800                                TM007-SQLCODE                     27380099
273900           MOVE SQLCODE      TO RC001-SAVE-SQLCODE                27390003
274000           MOVE SPACES       TO TM501-TM500-RETURN-MSG            27400003
274100           MOVE '821'        TO TM501-PGM                         27410099
274200           MOVE '4020'       TO TM501-PARA                        27420003
274300                                TM007-RETURNED-PARA               27430099
274400           MOVE 'TTRBNTF'    TO TM501-TBL                         27440003
274500           MOVE 24           TO TM501-PRORATION-ERROR-NBR         27450003
274600           PERFORM TM501-SET-TM500-RETURN-MSG                     27460003
274700           MOVE TM500-RETURN-DATA                                 27470099
274800                             TO TM007-RETURN-DATA                 27480099
274900           PERFORM RC001-RETURN-MSG                               27490003
275000                                                                  27500003
275100     END-EVALUATE.                                                27510003
275200                                                                  27520003
275300                                                                  27530003
275400* -------------------------------------------------------------- *27540003
275500* -------------------------------------------------------------- *27550003
275600                                                                  27560003
275700 4030-GET-PREPACK-TROUBLE-CNT.                                    27570003
275800                                                                  27580003
275900     MOVE '4030-GET-PREPACK-TROUBLE-CNT ' TO RC001-PARAGRAPH.     27590033
276000                                                                  27600003
276100     EXEC SQL                                                     27610003
276200                                                                  27620003
276300         SELECT COUNT(*)                                          27630003
276400                                                                  27640003
276500           INTO :PV-PREPACK-CNT                                   27650003
276600                                                                  27660003
276700           FROM TTRBNTF                                           27670003
276800                                                                  27680003
276900         WHERE PO_NBR        =  :RC821-ORD-NBR                    27690099
277000           AND PREPK_ID      =  :RC821-PREPK-ID                   27700099
277100           AND TRBL_RSN_CDE  =  :PC-570                           27710003
277200           AND PRORATE_IND   =  :PC-Y                             27720003
277300           AND REC_SEQ_NBR   =  :RC821-REC-SEQ-NBR                27730099
277400                                                                  27740003
277500     END-EXEC.                                                    27750003
277600                                                                  27760003
277700     EVALUATE SQLCODE                                             27770003
277800                                                                  27780003
277900       WHEN +0                                                    27790003
278000           ADD PV-PREPACK-CNT TO RC821-REC-TROUBLE-SHORT-CNT      27800099
278100                                                                  27810003
278200       WHEN OTHER                                                 27820003
278300           MOVE SQLCA        TO TM500-SQLCA                       27830003
278400                                TM007-SQLCA                       27840099
278500           MOVE SQLCODE      TO TM500-SQLCODE                     27850003
278600                                TM007-SQLCODE                     27860099
278700           MOVE SQLCODE      TO RC001-SAVE-SQLCODE                27870003
278800           MOVE SPACES       TO TM501-TM500-RETURN-MSG            27880003
278900           MOVE '821'        TO TM501-PGM                         27890099
279000           MOVE '4030'       TO TM501-PARA                        27900004
279100                                TM007-RETURNED-PARA               27910099
279200           MOVE 'TTRBNTF'    TO TM501-TBL                         27920003
279300           MOVE 25           TO TM501-PRORATION-ERROR-NBR         27930003
279400           PERFORM TM501-SET-TM500-RETURN-MSG                     27940003
279500           MOVE TM500-RETURN-DATA                                 27950099
279600                             TO TM007-RETURN-DATA                 27960099
279700           PERFORM RC001-RETURN-MSG                               27970003
279800                                                                  27980003
279900     END-EVALUATE.                                                27990003
280000                                                                  28000003
280100                                                                  28010003
280200     EXEC SQL                                                     28020003
280300                                                                  28030003
280400         SELECT COUNT(*)                                          28040003
280500                                                                  28050003
280600           INTO :PV-PREPACK-CNT                                   28060003
280700                                                                  28070003
280800           FROM TTRBNTF                                           28080003
280900                                                                  28090003
281000         WHERE PO_NBR        =  :RC821-ORD-NBR                    28100099
281100           AND PREPK_ID      =  :RC821-PREPK-ID                   28110099
281200           AND TRBL_RSN_CDE  =  :PC-267                           28120003
281300           AND PRORATE_IND   =  :PC-Y                             28130003
281400           AND REC_SEQ_NBR   =  :RC821-REC-SEQ-NBR                28140099
281500                                                                  28150003
281600     END-EXEC.                                                    28160003
281700                                                                  28170003
281800                                                                  28180003
281900     EVALUATE SQLCODE                                             28190003
282000                                                                  28200003
282100       WHEN +0                                                    28210003
282200           MOVE PV-PREPACK-CNT TO RC821-REC-TROUBLE-DCPACK-CNT    28220099
282300                                                                  28230003
282400       WHEN OTHER                                                 28240003
282500           MOVE SQLCA        TO TM500-SQLCA                       28250003
282600                                TM007-SQLCA                       28260099
282700           MOVE SQLCODE      TO TM500-SQLCODE                     28270003
282800                                TM007-SQLCODE                     28280099
282900           MOVE SQLCODE      TO RC001-SAVE-SQLCODE                28290003
283000           MOVE SPACES       TO TM501-TM500-RETURN-MSG            28300003
283100           MOVE '821'        TO TM501-PGM                         28310099
283200           MOVE '4030'       TO TM501-PARA                        28320004
283300                                TM007-RETURNED-PARA               28330099
283400           MOVE 'TTRBNTF'    TO TM501-TBL                         28340003
283500           MOVE 25           TO TM501-PRORATION-ERROR-NBR         28350003
283600           PERFORM TM501-SET-TM500-RETURN-MSG                     28360003
283700           MOVE TM500-RETURN-DATA                                 28370099
283800                             TO TM007-RETURN-DATA                 28380099
283900           PERFORM RC001-RETURN-MSG                               28390003
284000                                                                  28400003
284100     END-EVALUATE.                                                28410003
284200                                                                  28420003
284300* -------------------------------------------------------------- *28430003
284400* -------------------------------------------------------------- *28440003
284500                                                                  28450003
284600 4040-GET-MISC-TRECEIV-DATA.                                      28460063
284700                                                                  28470003
284800     MOVE '4040-GET-MISC-TRECEIV-DATA ' TO RC001-PARAGRAPH.       28480063
284900                                                                  28490003
285000     EXEC SQL                                                     28500003
285100                                                                  28510003
285200         SELECT PACK_BY_ST_IND                                    28520003
285300               ,CRE_OPER_UNT_ID                                   28530064
285400               ,CURR_OPER_UNT_ID                                  28540064
285500                                                                  28550003
285600           INTO :RECEIV-PACK-BY-ST-IND                            28560003
285700               ,:RECEIV-CRE-OPER-UNT-ID                           28570064
285800               ,:RECEIV-CURR-OPER-UNT-ID                          28580064
285900                                                                  28590003
286000           FROM TRECEIV                                           28600003
286100                                                                  28610003
286200         WHERE ORD_NBR         =  :RC821-ORD-NBR                  28620099
286300           AND REC_SEQ_NBR     =  :RC821-REC-SEQ-NBR              28630099
286400           AND VER_STATUS_CDE  =  :PC-A                           28640003
286500                                                                  28650003
286600     END-EXEC.                                                    28660003
286700                                                                  28670003
286800                                                                  28680003
286900     EVALUATE SQLCODE                                             28690003
287000                                                                  28700003
287100       WHEN +0                                                    28710003
287200           MOVE RECEIV-PACK-BY-ST-IND TO RC821-PACK-BY-STORE-IND  28720099
287300           MOVE RECEIV-CRE-OPER-UNT-ID                            28730064
287400                                      TO RC821-CRE-OPER-UNT-ID    28740099
287500           MOVE RECEIV-CURR-OPER-UNT-ID                           28750064
287600                                      TO RC821-CURR-OPER-UNT-ID   28760099
287700                                                                  28770003
287800       WHEN OTHER                                                 28780003
287900           MOVE SQLCA        TO TM500-SQLCA                       28790003
288000                                TM007-SQLCA                       28800099
288100           MOVE SQLCODE      TO TM500-SQLCODE                     28810003
288200                                TM007-SQLCODE                     28820099
288300           MOVE SQLCODE      TO RC001-SAVE-SQLCODE                28830003
288400           MOVE SPACES       TO TM501-TM500-RETURN-MSG            28840003
288500           MOVE '821'        TO TM501-PGM                         28850099
288600           MOVE '4040'       TO TM501-PARA                        28860004
288700                                TM007-RETURNED-PARA               28870099
288800           MOVE 'TRECEIV'    TO TM501-TBL                         28880003
288900           MOVE 26           TO TM501-PRORATION-ERROR-NBR         28890003
289000           PERFORM TM501-SET-TM500-RETURN-MSG                     28900003
289100           MOVE TM500-RETURN-DATA                                 28910099
289200                             TO TM007-RETURN-DATA                 28920099
289300           PERFORM RC001-RETURN-MSG                               28930003
289400                                                                  28940003
289500     END-EVALUATE.                                                28950003
289600                                                                  28960003
289700                                                                  28970003
289800* -------------------------------------------------------------- *28980003
289900* -------------------------------------------------------------- *28990003
290000                                                                  29000003
290100 4050-GET-PLAN-INFO.                                              29010003
290200                                                                  29020003
290300     MOVE '4050-GET-PLAN-INFO  ' TO RC001-PARAGRAPH.              29030033
290400                                                                  29040003
290500     EXEC SQL                                                     29050003
290600                                                                  29060003
290700         SELECT PLAN_NBR                                          29070003
290800              , CURR_SPLIT_QTY                                    29080003
290900              , ALLOC_OUTR_PK_QTY                                 29090003
291000              , PK_SIZE_RND_CDE                                   29100003
291100              , SHTG_PRRT_OPT_CDE                                 29110003
291200              , OVRG_PRRT_OPT_CDE                                 29120003
291300              , EXST_SHTG_THRS_IND                                29130003
291400                                                                  29140003
291500           INTO :ALLPLN-PLAN-NBR                                  29150003
291600              , :ALLPLN-CURR-SPLIT-QTY                            29160003
291700              , :ALLPLN-ALLOC-OUTR-PK-QTY                         29170003
291800              , :ALLPLN-PK-SIZE-RND-CDE                           29180003
291900              , :ALLPLN-SHTG-PRRT-OPT-CDE                         29190003
292000              , :ALLPLN-OVRG-PRRT-OPT-CDE                         29200003
292100              , :ALLPLN-EXST-SHTG-THRS-IND                        29210003
292200                                                                  29220003
292300           FROM TALLPLN                                           29230003
292400                                                                  29240003
292500         WHERE PO_NBR       =  :RC821-ORD-NBR                     29250099
292600           AND PO_LNE_NBR   =  :PURITM-PO-LNE-NBR                 29260003
292700           AND DEST_NBR     =  :RC821-OPER-UNT-ID                 29270099
292800           AND STATUS_CDE   =  :PC-AC                             29280003
292900                                                                  29290003
293000     END-EXEC.                                                    29300003
293100                                                                  29310003
293200                                                                  29320003
293300     EVALUATE SQLCODE                                             29330003
293400                                                                  29340003
293500       WHEN +0                                                    29350003
293600                                                                  29360010
293700           MOVE ALLPLN-PLAN-NBR                                   29370010
293800             TO RC821-PLAN-NBR                                    29380099
293900                                                                  29390010
294000           MOVE ALLPLN-CURR-SPLIT-QTY                             29400010
294100             TO RC821-CURR-SPLIT-QTY                              29410099
294200                                                                  29420010
294300           MOVE ALLPLN-ALLOC-OUTR-PK-QTY                          29430010
294400             TO RC821-ALLOC-OUTR-PK-QTY                           29440099
294500                                                                  29450010
294600           MOVE ALLPLN-PK-SIZE-RND-CDE                            29460010
294700             TO RC821-PK-SIZE-RND-CDE                             29470099
294800                                                                  29480010
294900           MOVE ALLPLN-SHTG-PRRT-OPT-CDE                          29490010
295000             TO RC821-SHORT-PRORATE-CDE                           29500099
295100                                                                  29510010
295200           MOVE ALLPLN-OVRG-PRRT-OPT-CDE                          29520010
295300             TO RC821-OVER-PRORATE-CDE                            29530099
295400                                                                  29540010
295500           MOVE ALLPLN-EXST-SHTG-THRS-IND                         29550010
295600             TO RC821-SHORT-USE-EX-RULES-IND                      29560099
295700                                                                  29570010
295800           MOVE PC-N  TO  RC821-NO-TALLPLN-DISTRO-IND             29580099
295900                                                                  29590010
296000           IF ALLPLN-CURR-SPLIT-QTY EQUAL ZERO                    29600010
296100               MOVE PC-N TO RC821-VALID-DISTRO-IND                29610099
296200               MOVE PC-Y TO RC821-NO-TALLPLN-DISTRO-IND           29620099
296300           END-IF                                                 29630010
296400                                                                  29640003
296500       WHEN +100                                                  29650003
296600           MOVE PC-Y  TO  RC821-NO-TALLPLN-DISTRO-IND             29660099
296700                                                                  29670003
296800       WHEN OTHER                                                 29680003
296900           MOVE SQLCA        TO TM500-SQLCA                       29690003
297000                                TM007-SQLCA                       29700099
297100           MOVE SQLCODE      TO TM500-SQLCODE                     29710003
297200                                TM007-SQLCODE                     29720099
297300           MOVE SQLCODE      TO RC001-SAVE-SQLCODE                29730003
297400           MOVE SPACES       TO TM501-TM500-RETURN-MSG            29740003
297500           MOVE '821'        TO TM501-PGM                         29750099
297600           MOVE '4050'       TO TM501-PARA                        29760004
297700                                TM007-RETURNED-PARA               29770099
297800           MOVE 'TALLPLN'    TO TM501-TBL                         29780003
297900           MOVE 27           TO TM501-PRORATION-ERROR-NBR         29790003
298000           PERFORM TM501-SET-TM500-RETURN-MSG                     29800003
298100           MOVE TM500-RETURN-DATA                                 29810099
298200                             TO TM007-RETURN-DATA                 29820099
298300           PERFORM RC001-RETURN-MSG                               29830003
298400                                                                  29840003
298500     END-EVALUATE.                                                29850003
298600                                                                  29860003
298700                                                                  29870003
298800* -------------------------------------------------------------- *29880003
298900* -------------------------------------------------------------- *29890003
299000                                                                  29900003
299100 4060-GET-DISTRO-QTY.                                             29910003
299200                                                                  29920003
299300     MOVE '4060-GET-DISTRO-QTY  ' TO RC001-PARAGRAPH.             29930033
299400                                                                  29940003
299500     EXEC SQL                                                     29950003
299600                                                                  29960003
299700         SELECT COUNT(*)                                          29970003
299800                                                                  29980003
299900           INTO :PV-SUM-STORE-PLAN-QTY                            29990003
300000                                                                  30000003
300100           FROM TMESTDS                                           30010003
300200                                                                  30020003
300300         WHERE PO_NBR       =  :RC821-ORD-NBR                     30030099
300400           AND PO_LNE_NBR   =  :PURITM-PO-LNE-NBR                 30040003
300500           AND PLAN_NBR     =  :ALLPLN-PLAN-NBR                   30050003
300600                                                                  30060003
300700     END-EXEC.                                                    30070003
300800                                                                  30080003
300900                                                                  30090003
301000     EVALUATE SQLCODE                                             30100003
301100                                                                  30110003
301200       WHEN +0                                                    30120003
301300                                                                  30130003
301400           IF PV-SUM-STORE-PLAN-QTY EQUAL ZERO                    30140003
301500               MOVE PC-N TO RC821-VALID-DISTRO-IND                30150099
301600               MOVE PC-Y TO RC821-NO-TMESTDS-DISTRO-IND           30160099
301700           ELSE                                                   30170003
301800               MOVE PC-N TO RC821-NO-TMESTDS-DISTRO-IND           30180099
301900           END-IF                                                 30190003
302000                                                                  30200003
302100           MOVE PV-SUM-STORE-PLAN-QTY TO RC821-SUM-STR-PLAN-QTY   30210099
302200                                                                  30220003
302300       WHEN +100                                                  30230003
302400           MOVE PC-Y  TO  RC821-NO-TMESTDS-DISTRO-IND             30240099
302500                                                                  30250003
302600       WHEN OTHER                                                 30260003
302700           MOVE SQLCA        TO TM500-SQLCA                       30270003
302800                                TM007-SQLCA                       30280099
302900           MOVE SQLCODE      TO TM500-SQLCODE                     30290003
303000                                TM007-SQLCODE                     30300099
303100           MOVE SQLCODE      TO RC001-SAVE-SQLCODE                30310003
303200           MOVE SPACES       TO TM501-TM500-RETURN-MSG            30320003
303300           MOVE '821'        TO TM501-PGM                         30330099
303400           MOVE '4060'       TO TM501-PARA                        30340004
303500                                TM007-RETURNED-PARA               30350099
303600           MOVE 'TMESTDS'    TO TM501-TBL                         30360003
303700           MOVE 28           TO TM501-PRORATION-ERROR-NBR         30370003
303800           PERFORM TM501-SET-TM500-RETURN-MSG                     30380003
303900           MOVE TM500-RETURN-DATA                                 30390099
304000                             TO TM007-RETURN-DATA                 30400099
304100           PERFORM RC001-RETURN-MSG                               30410000
304200                                                                  30420003
304300     END-EVALUATE.                                                30430003
304400                                                                  30440003
304500                                                                  30450003
304600* -------------------------------------------------------------- *30460003
304700* -------------------------------------------------------------- *30470003
304800                                                                  30480003
304900 4070-GET-TYPE-CODE-INFO.                                         30490003
305000                                                                  30500003
305100     MOVE '4070-GET-TYPE-CODE-INFO  ' TO RC001-PARAGRAPH.         30510033
305200                                                                  30520003
305300     INITIALIZE XL071-COMMAREA-REC.                               30530081
305400     MOVE RC821-OPER-UNT-ID           TO XL071-LOCATION-NUMBER.   30540099
305500                                                                  30550081
305600     CALL XL071-LOCATION-MODULE  USING  XL071-COMMAREA-REC.       30560099
305700                                                                  30570081
305800     EVALUATE TRUE                                                30580081
305900       WHEN XL071-NO-ERRORS                                       30590083
306000          MOVE XL071-LOC-TYP-CDE       TO RC821-TYPE-CODE         30600099
306100          MOVE XL071-ASGMT-DC-NBR      TO RC821-DC-NMBR           30610099
306200          MOVE XL071-ASGMT-EFF-BEG-DTE TO RC821-DC-RCT-STA-DTE    30620099
306300          MOVE XL071-ASGMT-EFF-STP-DTE TO RC821-DC-RCT-STO-DTE    30630099
306400                                                                  30640080
306500       WHEN OTHER                                                 30650003
306600           MOVE XL071-SQLCA     TO TM500-SQLCA                    30660099
306700                                   TM007-SQLCA                    30670099
306800           MOVE XL071-SQLCODE-N TO TM500-SQLCODE                  30680099
306900                                   TM007-SQLCODE                  30690099
307000           MOVE XL071-SQLCODE-N TO RC001-SAVE-SQLCODE             30700099
307100           MOVE SPACES          TO TM501-TM500-RETURN-MSG         30710099
307200           MOVE '821'           TO TM501-PGM                      30720099
307300           MOVE '4070'          TO TM501-PARA                     30730099
307400                                   TM007-RETURNED-PARA            30740099
307500           MOVE 'XLT_LOC'       TO TM501-TBL                      30750099
307600           MOVE 29              TO TM501-PRORATION-ERROR-NBR      30760099
307700           PERFORM TM501-SET-TM500-RETURN-MSG                     30770003
307800           MOVE TM500-RETURN-DATA                                 30780099
307900                                TO TM007-RETURN-DATA              30790099
308000           PERFORM RC001-RETURN-MSG                               30800000
308100                                                                  30810003
308200     END-EVALUATE.                                                30820003
308300                                                                  30830003
308400                                                                  30840003
308500* -------------------------------------------------------------- *30850003
308600* -------------------------------------------------------------- *30860003
308700                                                                  30870003
308800 4080-GET-REC-CONTROL-INFO.                                       30880003
308900                                                                  30890003
309000     MOVE '4080-GET-REC-CONTROL-INFO' TO RC001-PARAGRAPH.         30900033
309100                                                                  30910003
309200     EXEC SQL                                                     30920003
309300                                                                  30930003
309400         SELECT  DAYS_PR_CHG_NBR                                  30940003
309500               , LNE_ODU_TOL_QTY                                  30950003
309600               , LNE_ODU_TOL_AMT                                  30960003
309700               , PREPK_ODU_TOL_QTY                                30970003
309800               , PREPK_ODU_TOL_AMT                                30980003
309900                                                                  30990003
310000           INTO  :COCNTL-DAYS-PR-CHG-NBR                          31000003
310100               , :COCNTL-LNE-ODU-TOL-QTY                          31010003
310200               , :COCNTL-LNE-ODU-TOL-AMT                          31020003
310300               , :COCNTL-PREPK-ODU-TOL-QTY                        31030003
310400               , :COCNTL-PREPK-ODU-TOL-AMT                        31040003
310500                                                                  31050003
310600           FROM TCOCNTL                                           31060003
310700                                                                  31070003
310800         WHERE OPER_UNT_ID  =  :RC821-OPER-UNT-ID                 31080099
310900           AND FCLTY_ID     =  :RC821-FCLTY-ID                    31090099
311000                                                                  31100003
311100     END-EXEC.                                                    31110003
311200                                                                  31120003
311300     EVALUATE SQLCODE                                             31130003
311400                                                                  31140003
311500       WHEN +0                                                    31150003
311600          MOVE COCNTL-DAYS-PR-CHG-NBR   TO RC821-DAYS-PR-CHG-NBR  31160099
311700          MOVE COCNTL-LNE-ODU-TOL-QTY   TO RC821-LNE-ODU-TOL-QTY  31170099
311800          MOVE COCNTL-LNE-ODU-TOL-AMT   TO RC821-LNE-ODU-TOL-AMT  31180099
311900          MOVE COCNTL-PREPK-ODU-TOL-QTY TO RC821-PREPK-ODU-TOL-QTY31190099
312000          MOVE COCNTL-PREPK-ODU-TOL-AMT TO RC821-PREPK-ODU-TOL-AMT31200099
312100                                                                  31210003
312200       WHEN OTHER                                                 31220003
312300           MOVE SQLCA      TO TM500-SQLCA                         31230004
312400                              TM007-SQLCA                         31240099
312500           MOVE SQLCODE    TO TM500-SQLCODE                       31250004
312600                              TM007-SQLCODE                       31260099
312700           MOVE SQLCODE    TO RC001-SAVE-SQLCODE                  31270004
312800           MOVE SPACES     TO TM501-TM500-RETURN-MSG              31280004
312900           MOVE '821'      TO TM501-PGM                           31290099
313000           MOVE '4080'     TO TM501-PARA                          31300004
313100                              TM007-RETURNED-PARA                 31310099
313200           MOVE 'TCOCNTL'  TO TM501-TBL                           31320004
313300           MOVE 30         TO TM501-PRORATION-ERROR-NBR           31330004
313400           PERFORM TM501-SET-TM500-RETURN-MSG                     31340003
313500           MOVE TM500-RETURN-DATA                                 31350099
313600                           TO TM007-RETURN-DATA                   31360099
313700           PERFORM RC001-RETURN-MSG                               31370000
313800                                                                  31380003
313900     END-EVALUATE.                                                31390003
314000                                                                  31400003
314100                                                                  31410003
314200* -------------------------------------------------------------- *31420003
314300*    THIS PARAGRAPH CALCULATES THE END DATE FROM TODAYS DATE      31430003
314400*    USING DAYS-PR-CHG-NBR OF COCNTL TABLE.  THIS END DATE ALONG  31440003
314500*    WITH TODAY'S DATE (BEGIN DATE) WILL BE USED TO RETRIEVE      31450003
314600*    THE PRICE CHANGE THAT FALLS BETWEEN THESE DATES.             31460003
314700* -------------------------------------------------------------- *31470003
314800                                                                  31480003
314900*4090-GET-DATE-RANGE.                                             31490062
315000*                                                                 31500062
315100*    MOVE '4090-GET-DATE-RANGE ' TO RC001-PARAGRAPH.              31510062
315200*                                                                 31520062
315300*    INITIALIZE DPG51                                             31530062
315400*               DPG52                                             31540062
315500*               DPG53                                             31550062
315600*               DPG54                                             31560062
315700*               DPG55                                             31570062
315800*               DPG56.                                            31580062
315900*                                                                 31590062
316000*    MOVE EIBDATE     TO PV-EIBDATE-N.                            31600062
316100*    MOVE PV-EIBDATE  TO DPG52-LK-DATE-INPUT.                     31610062
316200*                                                                 31620062
316300*    SET DPG51-DO-NOT-INCR-DECR-DATE                              31630062
316400*        DPG51-ACTUAL-CALENDAR-ONLY                               31640062
316500*        DPG52-LK-DTE-JULIAN       TO TRUE.                       31650062
316600*                                                                 31660062
316700*    CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                31670062
316800*                                            DPG52                31680062
316900*                                            DPG53                31690062
317000*                                            DPG54                31700062
317100*                                            DPG55                31710062
317200*                                            DPG56.               31720062
317300*                                                                 31730062
317400*    MOVE DPG55-DB2-ISO-DATE-FMT  TO  PV-DB2-START-DATE.          31740062
317500*                                                                 31750062
317600*    INITIALIZE DPG51                                             31760062
317700*               DPG52                                             31770062
317800*               DPG53                                             31780062
317900*               DPG54                                             31790062
318000*               DPG55                                             31800062
318100*               DPG56.                                            31810062
318200*                                                                 31820062
318300*    MOVE PV-EIBDATE  TO  DPG52-LK-DATE-INPUT.                    31830062
318400*                                                                 31840062
318500*    SET DPG51-INCREMENT-DATE                                     31850062
318600*        DPG51-ACTUAL-CALENDAR-ONLY                               31860062
318700*        DPG52-LK-DTE-JULIAN       TO TRUE.                       31870062
318800*                                                                 31880062
318900*    MOVE COCNTL-DAYS-PR-CHG-NBR   TO  DPG51-INCR-DECR-DAYS-9.    31890062
319000*                                                                 31900062
319100*    CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                31910062
319200*                                            DPG52                31920062
319300*                                            DPG53                31930062
319400*                                            DPG54                31940062
319500*                                            DPG55                31950062
319600*                                            DPG56.               31960062
319700*                                                                 31970062
319800*    MOVE DPG55-DB2-ISO-DATE-FMT  TO  PV-DB2-END-DATE.            31980062
319900*                                                                 31990062
320000*                                                                 32000062
320100* -------------------------------------------------------------- *32010003
320200* -------------------------------------------------------------- *32020003
320300                                                                  32030003
320400 4100-SELECT-VND-STYL.                                            32040003
320500                                                                  32050003
320600     MOVE '4100-SELECT-VND-STYL' TO RC001-PARAGRAPH.              32060033
320700                                                                  32070003
320800     EXEC SQL                                                     32080003
320900                                                                  32090003
321000         SELECT  MAJ_CL_NBR                                       32100003
321100               , SUB_CL_NBR                                       32110003
321200                                                                  32120003
321300           INTO  :XLT00004-MAJ-CL-NBR                             32130003
321400               , :XLT00004-SUB-CL-NBR                             32140003
321500                                                                  32150003
321600           FROM XLT_VND_STYL                                      32160003
321700                                                                  32170003
321800         WHERE STYL_ID  =  :XL001-STYL-ID                         32180003
321900                                                                  32190003
322000     END-EXEC.                                                    32200003
322100                                                                  32210003
322200                                                                  32220003
322300     EVALUATE SQLCODE                                             32230003
322400                                                                  32240003
322500       WHEN +0                                                    32250003
322600           MOVE XLT00004-MAJ-CL-NBR                               32260003
322700             TO RC821-REC-CLASS    (RC821-ITEM-IDX)               32270099
322800                RC821-PO-CLASS     (RC821-ITEM-IDX)               32280099
322900                                                                  32290003
323000           MOVE XLT00004-SUB-CL-NBR                               32300003
323100             TO RC821-REC-SUBCLASS (RC821-ITEM-IDX)               32310099
323200                RC821-PO-SUBCLASS  (RC821-ITEM-IDX)               32320099
323300                                                                  32330003
323400       WHEN OTHER                                                 32340003
323500           MOVE SQLCA      TO TM500-SQLCA                         32350003
323600                              TM007-SQLCA                         32360099
323700           MOVE SQLCODE    TO TM500-SQLCODE                       32370003
323800                              TM007-SQLCODE                       32380099
323900           MOVE SQLCODE    TO RC001-SAVE-SQLCODE                  32390003
324000           MOVE SPACES     TO TM501-TM500-RETURN-MSG              32400003
324100           MOVE '821'      TO TM501-PGM                           32410099
324200           MOVE '4100'     TO TM501-PARA                          32420004
324300                              TM007-RETURNED-PARA                 32430099
324400           MOVE 'XLT_VND'  TO TM501-TBL                           32440003
324500           MOVE 31         TO TM501-PRORATION-ERROR-NBR           32450003
324600           PERFORM TM501-SET-TM500-RETURN-MSG                     32460003
324700           MOVE TM500-RETURN-DATA                                 32470099
324800                           TO TM007-RETURN-DATA                   32480099
324900           PERFORM RC001-RETURN-MSG                               32490003
325000                                                                  32500003
325100     END-EVALUATE.                                                32510003
325200                                                                  32520003
325300                                                                  32530003
325400* -------------------------------------------------------------- *32540003
325500* -------------------------------------------------------------- *32550003
325600                                                                  32560003
325700 4110-UPDATE-RECITM.                                              32570003
325800                                                                  32580003
325900     MOVE '4110-UPDATE-RECITM  ' TO RC001-PARAGRAPH.              32590033
326000                                                                  32600003
326100     EXEC SQL                                                     32610003
326200                                                                  32620003
326300         UPDATE TRECITM                                           32630003
326400                                                                  32640003
326500           SET PREPK_ODD_UNT_QTY = :RECITM-PREPK-ODD-UNT-QTY      32650003
326600                                                                  32660003
326700         WHERE ORD_NBR         =  :RC821-ORD-NBR                  32670099
326800           AND ORD_LNE_NBR     =  :RECITM-ORD-LNE-NBR             32680003
326900           AND REC_SEQ_NBR     =  :RC821-REC-SEQ-NBR              32690099
327000           AND OPER_UNT_ID     =  :RC821-OPER-UNT-ID              32700099
327100           AND FCLTY_ID        =  :RC821-FCLTY-ID                 32710099
327200           AND VER_STATUS_CDE  =  :PC-A                           32720003
327300                                                                  32730003
327400     END-EXEC.                                                    32740003
327500                                                                  32750003
327600                                                                  32760003
327700     EVALUATE SQLCODE                                             32770003
327800                                                                  32780003
327900       WHEN +0                                                    32790003
328000           CONTINUE                                               32800003
328100                                                                  32810003
328200       WHEN +100                                                  32820003
328300           SET PS-DONE-YES TO TRUE                                32830003
328400           MOVE RECITM-ORD-LNE-NBR   TO RC001-PO-LNE-NBR          32840003
328500           MOVE SQLCA                TO TM500-SQLCA               32850003
328600                                        TM007-SQLCA               32860099
328700           MOVE SQLCODE              TO TM500-SQLCODE             32870003
328800                                        TM007-SQLCODE             32880099
328900           MOVE SQLCODE              TO RC001-SAVE-SQLCODE        32890003
329000           MOVE SPACES               TO TM501-TM500-RETURN-MSG    32900003
329100           MOVE '821'                TO TM501-PGM                 32910099
329200           MOVE '4110'               TO TM501-PARA                32920004
329300                                        TM007-RETURNED-PARA       32930099
329400           MOVE 'TRECITM'            TO TM501-TBL                 32940003
329500           MOVE 32                   TO TM501-PRORATION-ERROR-NBR 32950003
329600           PERFORM TM501-SET-TM500-RETURN-MSG                     32960003
329700           MOVE TM500-RETURN-DATA    TO TM007-RETURN-DATA         32970099
329800           PERFORM RC001-RETURN-MSG                               32980003
329900                                                                  32990003
330000       WHEN -904                                                  33000003
330100       WHEN -911                                                  33010003
330200       WHEN -913                                                  33020003
330300           SET PS-DONE-YES                                        33030003
330400               TM500-PREPACK-DB2-TIMEOUT TO TRUE                  33040003
330500           MOVE RC821-REC-DRV-LNE-NBR TO RC001-PO-LNE-NBR         33050099
330600           MOVE SQLCA                 TO TM500-SQLCA              33060003
330700                                         TM007-SQLCA              33070099
330800           MOVE SQLCODE               TO TM500-SQLCODE            33080003
330900                                         TM007-SQLCODE            33090099
331000           MOVE SQLCODE               TO RC001-SAVE-SQLCODE       33100003
331100           MOVE SPACES                TO TM501-TM500-RETURN-MSG   33110003
331200           MOVE '821'                 TO TM501-PGM                33120099
331300           MOVE '4110'                TO TM501-PARA               33130003
331400                                         TM007-RETURNED-PARA      33140099
331500           MOVE 'TRECITM'             TO TM501-TBL                33150003
331600           MOVE 33                    TO TM501-PRORATION-ERROR-NBR33160003
331700           PERFORM TM501-SET-TM500-RETURN-MSG                     33170003
331800           MOVE TM500-RETURN-DATA     TO TM007-RETURN-DATA        33180099
331900           PERFORM RC001-RETURN-MSG                               33190003
332000                                                                  33200003
332100       WHEN OTHER                                                 33210003
332200           SET PS-DONE-YES TO TRUE                                33220003
332300           MOVE RECITM-ORD-LNE-NBR   TO RC001-PO-LNE-NBR          33230003
332400           MOVE SQLCA                TO TM500-SQLCA               33240003
332500                                        TM007-SQLCA               33250099
332600           MOVE SQLCODE              TO TM500-SQLCODE             33260003
332700                                        TM007-SQLCODE             33270099
332800           MOVE SQLCODE              TO RC001-SAVE-SQLCODE        33280003
332900           MOVE SPACES               TO TM501-TM500-RETURN-MSG    33290003
333000           MOVE '821'                TO TM501-PGM                 33300099
333100           MOVE '4110'               TO TM501-PARA                33310004
333200                                        TM007-RETURNED-PARA       33320099
333300           MOVE 'TRECITM'            TO TM501-TBL                 33330004
333400           MOVE 34                   TO TM501-PRORATION-ERROR-NBR 33340003
333500           PERFORM TM501-SET-TM500-RETURN-MSG                     33350003
333600           MOVE TM500-RETURN-DATA    TO TM007-RETURN-DATA         33360099
333700           PERFORM RC001-RETURN-MSG                               33370003
333800                                                                  33380003
333900     END-EVALUATE.                                                33390003
334000                                                                  33400003
334100                                                                  33410003
334200* -------------------------------------------------------------- *33420003
334300*    WE CANNOT HAVE MORE THAN ONE DRIVER LINE PER PACK.  SOMETIMES33430003
334400*    A NEW DRIVER LINE WILL BE ASSIGNED IN ADDITION TO THE        33440003
334500*    EXISTING ONE. THIS PARAGRAPH WILL DETECT THOSE DIFFERENCES   33450003
334600*    AND FIX THEM.                                                33460003
334700* -------------------------------------------------------------- *33470003
334800                                                                  33480003
334900 4120-VERIFY-PACK.                                                33490003
335000                                                                  33500003
335100     MOVE '4120-VERIFY-PACK       ' TO RC001-PARAGRAPH.           33510033
335200                                                                  33520003
335300     INITIALIZE RC806-PRODUCT-PACK-VALIDATION.                    33530003
335400                                                                  33540003
335500     SET RC806-CALC-BEST-CASE TO TRUE.                            33550003
335600                                                                  33560003
335700     PERFORM 4130-LOAD-RC806-FROM-RC821                           33570013
335800       VARYING RC821-ITEM-IDX FROM 1 BY 1                         33580099
335900         UNTIL RC821-REC-LNE-NBR (RC821-ITEM-IDX) EQUAL ZERO      33590099
336000            OR RC821-ITEM-IDX > RC821-MAX-ITEM-COUNT.             33600099
336100                                                                  33610003
336200     PERFORM 4170-VALIDATION-MODULE.                              33620003
336300                                                                  33630003
336400     SET PS-UPDATE-RECITM-NO                                      33640003
336500         PS-SAME-DRIVER-LINE-YES  TO TRUE                         33650003
336600                                                                  33660003
336700     IF RC806-NO-ERRORS                                           33670003
336800         PERFORM 4140-COMPARE-LINES                               33680003
336900           VARYING RC821-ITEM-IDX FROM 1 BY 1                     33690099
337000             UNTIL RC821-REC-LNE-NBR (RC821-ITEM-IDX) EQUAL ZERO  33700099
337100                OR RC821-ITEM-IDX > RC821-MAX-ITEM-COUNT          33710099
337200         IF PS-UPDATE-RECITM-YES                                  33720049
337300             MOVE ZEROS TO RC821-TOTAL-ODD-UNITS                  33730099
337400             PERFORM                                              33740049
337500               VARYING RC821-ITEM-IDX FROM 1 BY 1                 33750099
337600                 UNTIL RC821-REC-LNE-NBR (RC821-ITEM-IDX) EQUAL 0 33760099
337700                   OR  RC821-ITEM-IDX > RC821-MAX-ITEM-COUNT      33770099
337800                 ADD RC821-ODD-UNIT-QTY (RC821-ITEM-IDX)          33780099
337900                  TO RC821-TOTAL-ODD-UNITS                        33790099
338000             END-PERFORM                                          33800049
338100         END-IF                                                   33810049
338200     END-IF.                                                      33820049
338300                                                                  33830003
338400*    ---------------------------------------------                33840003
338500*    CLEAR OUT THE DRIVER LINE CODES FOR ALL LINES                33850003
338600*    IN THE PACK                                                  33860003
338700*    ---------------------------------------------                33870003
338800                                                                  33880003
338900     IF PS-SAME-DRIVER-LINE-NO                                    33890003
339000                                                                  33900003
339100         PERFORM 4150-REMOVE-RECITM-DRIVER-LINE                   33910003
339200         MOVE RC806-PKSL-LNE-NBR (RC806-DRIVER-LNE-SUB)           33920003
339300           TO RECITM-ORD-LNE-NBR                                  33930003
339400         PERFORM 4160-NEW-RECITM-DRIVER-LINE                      33940003
339500     END-IF.                                                      33950003
339600                                                                  33960003
339700     MOVE RC806-PKSL-LNE-NBR (RC806-DRIVER-LNE-SUB)               33970003
339800       TO RECITM-ORD-LNE-NBR.                                     33980003
339900                                                                  33990003
340000     SET RC821-ITEM-IDX TO RC806-DRIVER-LNE-SUB.                  34000099
340100                                                                  34010003
340200     MOVE RC821-BEST-CASE-UNITS (RC821-ITEM-IDX)                  34020099
340300       TO TM500-UNITS-TO-ALLOC.                                   34030003
340400                                                                  34040003
340500                                                                  34050003
340600*-----------------------------------------------------------------34060003
340700*-----------------------------------------------------------------34070003
340800                                                                  34080003
340900 4130-LOAD-RC806-FROM-RC821.                                      34090013
341000                                                                  34100003
341100     MOVE '4130-LOAD-RC806-FROM-RC821' TO RC001-PARAGRAPH.        34110033
341200                                                                  34120000
341300     ADD 1  TO RC806-NBR-OF-LINES.                                34130000
341400                                                                  34140000
341500     SET RC806-LINE-IDX TO RC821-ITEM-IDX.                        34150099
341600                                                                  34160000
341700     MOVE RC821-REC-LNE-NBR        (RC821-ITEM-IDX)               34170099
341800       TO RC806-PKSL-LNE-NBR       (RC806-LINE-IDX).              34180000
341900                                                                  34190000
342000     MOVE RC821-REC-INNER-PACK-QTY (RC821-ITEM-IDX)               34200099
342100       TO RC806-INNER-PACK-QTY.                                   34210000
342200                                                                  34220000
342300     MOVE RC821-REC-PACK-RATO-QTY  (RC821-ITEM-IDX)               34230099
342400       TO RC806-PO-RATIO           (RC806-LINE-IDX)               34240000
342500          RC806-RC-RATIO           (RC806-LINE-IDX).              34250000
342600                                                                  34260000
342700     IF RC821-DTL-CK-ITM-QTY (RC821-ITEM-IDX) > ZERO              34270099
342800         MOVE RC821-DTL-CK-ITM-QTY (RC821-ITEM-IDX)               34280099
342900           TO RC806-UNIT-QTY       (RC806-LINE-IDX)               34290000
343000              RC806-RCVG-QTY       (RC806-LINE-IDX)               34300000
343100     ELSE                                                         34310000
343200         MOVE RC821-PKSL-ITM-QTY   (RC821-ITEM-IDX)               34320099
343300           TO RC806-UNIT-QTY       (RC806-LINE-IDX)               34330000
343400              RC806-RCVG-QTY       (RC806-LINE-IDX)               34340000
343500     END-IF.                                                      34350000
343600                                                                  34360000
343700                                                                  34370000
343800*-----------------------------------------------------------------34380000
343900*-----------------------------------------------------------------34390000
344000                                                                  34400000
344100 4140-COMPARE-LINES.                                              34410000
344200                                                                  34420000
344300     MOVE '4140-COMPARE-LINES        ' TO RC001-PARAGRAPH.        34430033
344400                                                                  34440003
344500     SET PS-UPDATE-RECITM-NO  TO TRUE.                            34450003
344600                                                                  34460003
344700     SET RC806-LINE-IDX       TO RC821-ITEM-IDX.                  34470099
344800                                                                  34480003
344900     IF RC821-BEST-CASE-UNITS (RC821-ITEM-IDX) NOT EQUAL          34490099
345000        RC806-BEST-CASE-UNITS (RC806-LINE-IDX)                    34500003
345100         MOVE RC806-BEST-CASE-UNITS (RC806-LINE-IDX)              34510003
345200           TO RC821-BEST-CASE-UNITS (RC821-ITEM-IDX)              34520099
345300     END-IF                                                       34530003
345400                                                                  34540003
345500     IF RC821-ODD-UNIT-QTY (RC821-ITEM-IDX) NOT EQUAL             34550099
345600        RC806-ODD-UNITS    (RC806-LINE-IDX)                       34560003
345700         MOVE RC806-ODD-UNITS    (RC806-LINE-IDX)                 34570003
345800           TO RC821-ODD-UNIT-QTY (RC821-ITEM-IDX)                 34580099
345900         SET PS-UPDATE-RECITM-YES TO TRUE                         34590003
346000     END-IF                                                       34600003
346100                                                                  34610003
346200     IF RC821-DRV-LNE-CDE (RC821-ITEM-IDX) EQUAL PC-A             34620099
346300         IF RC821-ITEM-IDX EQUAL RC806-DRIVER-LNE-SUB             34630099
346400*            ----------------------                               34640003
346500*            DRIVER LINE IS CORRECT                               34650003
346600*            ----------------------                               34660003
346700             MOVE RC821-BEST-CASE-UNITS (RC821-ITEM-IDX)          34670099
346800               TO TM500-UNITS-TO-ALLOC                            34680003
346900         ELSE                                                     34690003
347000*            ---------------------------------------------------  34700003
347100*            THERE CAN ONLY BE ONE DRIVER LINE AND THIS ISN'T IT  34710003
347200*            ---------------------------------------------------  34720003
347300             SET PS-SAME-DRIVER-LINE-NO TO TRUE                   34730061
347400         END-IF                                                   34740003
347500     ELSE                                                         34750003
347600         IF RC821-ITEM-IDX EQUAL RC806-DRIVER-LNE-SUB             34760099
347700*            -------------------------------                      34770003
347800*            THE DRIVER IS ON THE WRONG LINE                      34780003
347900*            -------------------------------                      34790003
348000             SET PS-SAME-DRIVER-LINE-NO TO TRUE                   34800061
348100         END-IF                                                   34810003
348200     END-IF                                                       34820003
348300                                                                  34830003
348400     IF PS-UPDATE-RECITM-YES                                      34840003
348500         MOVE RC821-REC-LNE-NBR  (RC821-ITEM-IDX)                 34850099
348600           TO RECITM-ORD-LNE-NBR                                  34860003
348700                                                                  34870003
348800         MOVE RC821-ODD-UNIT-QTY (RC821-ITEM-IDX)                 34880099
348900           TO RECITM-PREPK-ODD-UNT-QTY                            34890003
349000                                                                  34900003
349100         PERFORM 4110-UPDATE-RECITM                               34910003
349200     END-IF.                                                      34920003
349300                                                                  34930003
349400                                                                  34940003
349500*-----------------------------------------------------------------34950003
349600*-----------------------------------------------------------------34960003
349700                                                                  34970003
349800 4150-REMOVE-RECITM-DRIVER-LINE.                                  34980003
349900                                                                  34990003
350000     MOVE '4150-REMOVE-RECITM-DRIVER-LINE ' TO RC001-PARAGRAPH.   35000033
350100                                                                  35010003
350200     EXEC SQL                                                     35020003
350300                                                                  35030003
350400         UPDATE TRECITM                                           35040003
350500                                                                  35050003
350600           SET PREPK_DRV_LNE_CDE = :PC-SPACE                      35060003
350700                                                                  35070003
350800         WHERE ORD_NBR         =  :RC821-ORD-NBR                  35080099
350900           AND REC_SEQ_NBR     =  :RC821-REC-SEQ-NBR              35090099
351000           AND OPER_UNT_ID     =  :RC821-OPER-UNT-ID              35100099
351100           AND FCLTY_ID        =  :RC821-FCLTY-ID                 35110099
351200           AND PREPK_ID        =  :RC821-PREPK-ID                 35120099
351300           AND VER_STATUS_CDE  =  :PC-A                           35130003
351400                                                                  35140003
351500     END-EXEC.                                                    35150003
351600                                                                  35160003
351700     EVALUATE SQLCODE                                             35170003
351800                                                                  35180003
351900       WHEN +0                                                    35190003
352000           CONTINUE                                               35200003
352100                                                                  35210003
352200       WHEN +100                                                  35220003
352300           SET PS-DONE-YES TO TRUE                                35230003
352400           MOVE RECITM-ORD-LNE-NBR   TO RC001-PO-LNE-NBR          35240003
352500           MOVE SQLCA                TO TM500-SQLCA               35250003
352600                                        TM007-SQLCA               35260099
352700           MOVE SQLCODE              TO TM500-SQLCODE             35270003
352800                                        TM007-SQLCODE             35280099
352900           MOVE SQLCODE              TO RC001-SAVE-SQLCODE        35290003
353000           MOVE SPACES               TO TM501-TM500-RETURN-MSG    35300003
353100           MOVE '821'                TO TM501-PGM                 35310099
353200           MOVE '4150'               TO TM501-PARA                35320003
353300                                        TM007-RETURNED-PARA       35330099
353400           MOVE 'TRECITM'            TO TM501-TBL                 35340003
353500           MOVE 35                   TO TM501-PRORATION-ERROR-NBR 35350003
353600           PERFORM TM501-SET-TM500-RETURN-MSG                     35360003
353700           MOVE TM500-RETURN-DATA    TO TM007-RETURN-DATA         35370099
353800           PERFORM RC001-RETURN-MSG                               35380003
353900                                                                  35390003
354000       WHEN -904                                                  35400003
354100       WHEN -911                                                  35410003
354200       WHEN -913                                                  35420003
354300           SET PS-DONE-YES                                        35430003
354400               TM500-PREPACK-DB2-TIMEOUT TO TRUE                  35440003
354500           MOVE RC821-REC-DRV-LNE-NBR TO RC001-PO-LNE-NBR         35450099
354600           MOVE SQLCA                TO TM500-SQLCA               35460003
354700                                        TM007-SQLCA               35470099
354800           MOVE SQLCODE              TO TM500-SQLCODE             35480003
354900                                        TM007-SQLCODE             35490099
355000           MOVE SQLCODE               TO RC001-SAVE-SQLCODE       35500003
355100           MOVE SPACES                TO TM501-TM500-RETURN-MSG   35510003
355200           MOVE '821'                 TO TM501-PGM                35520099
355300           MOVE '4150'                TO TM501-PARA               35530003
355400                                         TM007-RETURNED-PARA      35540099
355500           MOVE 'TRECITM'             TO TM501-TBL                35550003
355600           MOVE 36                    TO TM501-PRORATION-ERROR-NBR35560003
355700           PERFORM TM501-SET-TM500-RETURN-MSG                     35570003
355800           MOVE TM500-RETURN-DATA     TO TM007-RETURN-DATA        35580099
355900           PERFORM RC001-RETURN-MSG                               35590003
356000                                                                  35600003
356100       WHEN OTHER                                                 35610003
356200           SET PS-DONE-YES  TO TRUE                               35620003
356300           MOVE RECITM-ORD-LNE-NBR   TO RC001-PO-LNE-NBR          35630003
356400           MOVE SQLCA                TO TM500-SQLCA               35640003
356500                                        TM007-SQLCA               35650099
356600           MOVE SQLCODE              TO TM500-SQLCODE             35660003
356700                                        TM007-SQLCODE             35670099
356800           MOVE SQLCODE              TO RC001-SAVE-SQLCODE        35680003
356900           MOVE SPACES               TO TM501-TM500-RETURN-MSG    35690003
357000           MOVE '821'                TO TM501-PGM                 35700099
357100           MOVE '4150'               TO TM501-PARA                35710003
357200                                        TM007-RETURNED-PARA       35720099
357300           MOVE 'TRECITM'            TO TM501-TBL                 35730003
357400           MOVE 37                   TO TM501-PRORATION-ERROR-NBR 35740003
357500           PERFORM TM501-SET-TM500-RETURN-MSG                     35750003
357600           MOVE TM500-RETURN-DATA    TO TM007-RETURN-DATA         35760099
357700           PERFORM RC001-RETURN-MSG                               35770003
357800                                                                  35780003
357900     END-EVALUATE.                                                35790003
358000                                                                  35800003
358100                                                                  35810003
358200*-----------------------------------------------------------------35820003
358300*-----------------------------------------------------------------35830003
358400                                                                  35840003
358500 4160-NEW-RECITM-DRIVER-LINE.                                     35850003
358600                                                                  35860003
358700     MOVE '4160-NEW-RECITM-DRIVER-LINE ' TO RC001-PARAGRAPH.      35870033
358800                                                                  35880003
358900     EXEC SQL                                                     35890003
359000                                                                  35900003
359100         UPDATE TRECITM                                           35910003
359200                                                                  35920003
359300           SET PREPK_DRV_LNE_CDE = :PC-A                          35930003
359400                                                                  35940003
359500         WHERE ORD_NBR         =  :RC821-ORD-NBR                  35950099
359600           AND ORD_LNE_NBR     =  :RECITM-ORD-LNE-NBR             35960003
359700           AND REC_SEQ_NBR     =  :RC821-REC-SEQ-NBR              35970099
359800           AND OPER_UNT_ID     =  :RC821-OPER-UNT-ID              35980099
359900           AND FCLTY_ID        =  :RC821-FCLTY-ID                 35990099
360000           AND PREPK_ID        =  :RC821-PREPK-ID                 36000099
360100           AND VER_STATUS_CDE  =  :PC-A                           36010003
360200                                                                  36020003
360300     END-EXEC.                                                    36030003
360400                                                                  36040003
360500     EVALUATE SQLCODE                                             36050003
360600                                                                  36060003
360700       WHEN +0                                                    36070003
360800           IF PS-PREPACK  AND  RC821-PREPK-ID > 0                 36080099
360900               MOVE RECITM-ORD-LNE-NBR TO RC821-REC-DRV-LNE-NBR   36090099
361000                                          TM500-PO-LNE-NBR        36100044
361100           END-IF                                                 36110003
361200                                                                  36120003
361300       WHEN +100                                                  36130003
361400           SET PS-DONE-YES  TO TRUE                               36140003
361500           MOVE RECITM-ORD-LNE-NBR   TO RC001-PO-LNE-NBR          36150003
361600           MOVE SQLCODE              TO RC001-SAVE-SQLCODE        36160003
361700           MOVE SQLCA                TO TM500-SQLCA               36170003
361800                                        TM007-SQLCA               36180099
361900           MOVE SQLCODE              TO TM500-SQLCODE             36190003
362000                                        TM007-SQLCODE             36200099
362100           MOVE SPACES               TO TM501-TM500-RETURN-MSG    36210003
362200           MOVE '821'                TO TM501-PGM                 36220099
362300           MOVE '4160'               TO TM501-PARA                36230003
362400                                        TM007-RETURNED-PARA       36240099
362500           MOVE 'TRECITM'            TO TM501-TBL                 36250003
362600           MOVE 38                   TO TM501-PRORATION-ERROR-NBR 36260003
362700           PERFORM TM501-SET-TM500-RETURN-MSG                     36270003
362800           MOVE TM500-RETURN-DATA    TO TM007-RETURN-DATA         36280099
362900           PERFORM RC001-RETURN-MSG                               36290003
363000                                                                  36300003
363100       WHEN -904                                                  36310003
363200       WHEN -911                                                  36320003
363300       WHEN -913                                                  36330003
363400           SET PS-DONE-YES                                        36340003
363500               TM500-PREPACK-DB2-TIMEOUT TO TRUE                  36350003
363600           MOVE RC821-REC-DRV-LNE-NBR TO RC001-PO-LNE-NBR         36360099
363700           MOVE SQLCA                 TO TM500-SQLCA              36370003
363800                                         TM007-SQLCA              36380099
363900           MOVE SQLCODE               TO TM500-SQLCODE            36390003
364000                                         TM007-SQLCODE            36400099
364100           MOVE SQLCODE               TO RC001-SAVE-SQLCODE       36410003
364200           MOVE SPACES                TO TM501-TM500-RETURN-MSG   36420003
364300           MOVE '821'                 TO TM501-PGM                36430099
364400           MOVE '4160'                TO TM501-PARA               36440003
364500                                         TM007-RETURNED-PARA      36450099
364600           MOVE 'TRECITM'             TO TM501-TBL                36460003
364700           MOVE 39                    TO TM501-PRORATION-ERROR-NBR36470003
364800           PERFORM TM501-SET-TM500-RETURN-MSG                     36480003
364900           MOVE TM500-RETURN-DATA     TO TM007-RETURN-DATA        36490099
365000           PERFORM RC001-RETURN-MSG                               36500003
365100                                                                  36510003
365200       WHEN OTHER                                                 36520003
365300           SET PS-DONE-YES  TO TRUE                               36530003
365400           MOVE RECITM-ORD-LNE-NBR TO RC001-PO-LNE-NBR            36540003
365500           MOVE SQLCA              TO TM500-SQLCA                 36550003
365600                                      TM007-SQLCA                 36560099
365700           MOVE SQLCODE            TO TM500-SQLCODE               36570003
365800                                      TM007-SQLCODE               36580099
365900           MOVE SQLCODE            TO RC001-SAVE-SQLCODE          36590003
366000           MOVE SPACES             TO TM501-TM500-RETURN-MSG      36600003
366100           MOVE '821'              TO TM501-PGM                   36610099
366200           MOVE '4160'             TO TM501-PARA                  36620003
366300                                      TM007-RETURNED-PARA         36630099
366400           MOVE 'TRECITM'          TO TM501-TBL                   36640003
366500           MOVE 40                 TO TM501-PRORATION-ERROR-NBR   36650003
366600           PERFORM TM501-SET-TM500-RETURN-MSG                     36660003
366700           MOVE TM500-RETURN-DATA  TO TM007-RETURN-DATA           36670099
366800           PERFORM RC001-RETURN-MSG                               36680003
366900                                                                  36690003
367000     END-EVALUATE.                                                36700003
367100                                                                  36710003
367200                                                                  36720003
367300*-----------------------------------------------------------------36730003
367400*-----------------------------------------------------------------36740003
367500                                                                  36750003
367600 4170-VALIDATION-MODULE.                                          36760003
367700                                                                  36770003
367800     MOVE '4170-VALIDATION-MODULE ' TO RC001-PARAGRAPH.           36780033
367900                                                                  36790003
368000                                                                  36800003
368100     CALL PC-RCKUT806 USING RC806-PRODUCT-PACK-VALIDATION.        36810099
368200                                                                  36820003
368300     INITIALIZE PV-ITEM.                                          36830003
368400                                                                  36840003
368500                                                                  36850003
368600* -------------------------------------------------------------- *36860003
368700*    STORE / LINE OTR REQUEST PROCESSING.                         36870003
368800* -------------------------------------------------------------- *36880003
368900                                                                  36890003
369000 5000-CALL-OTR.                                                   36900003
369100                                                                  36910003
369200     MOVE '5000-CALL-OTR  ' TO RC001-PARAGRAPH.                   36920033
369300                                                                  36930003
369400     INITIALIZE RC822-COMMAREA.                                   36940099
369500                                                                  36950003
369600     PERFORM 5060-SETUP-RC822-COMMAREA.                           36960099
369700                                                                  36970003
369800     PERFORM                                                      36980003
369900       VARYING RC821-ITEM-IDX FROM 1 BY 1                         36990099
370000         UNTIL RC821-ITEM-IDX > RC821-MAX-ITEM-COUNT              37000099
370100          OR   RC821-PO-LNE-NBR (RC821-ITEM-IDX) EQUAL ZERO       37010099
370200                                                                  37020003
370300         SET  RC822-PACK-IDX TO RC821-ITEM-IDX                    37030099
370400                                                                  37040003
370500         MOVE RC821-PO-LNE-NBR       (RC821-ITEM-IDX)             37050099
370600           TO RC822-PO-LINE-NBR      (RC822-PACK-IDX)             37060099
370700                                                                  37070003
370800         MOVE RC821-PO-SKU-NBR       (RC821-ITEM-IDX)             37080099
370900           TO RC822-PO-SKU-NBR       (RC822-PACK-IDX)             37090099
371000                                                                  37100003
371100         MOVE RC821-PO-PACK-RATO-QTY (RC821-ITEM-IDX)             37110099
371200           TO RC822-PO-PACK-RATO-QTY (RC822-PACK-IDX)             37120099
371300     END-PERFORM.                                                 37130003
371400                                                                  37140003
371500     EXEC SQL                                                     37150003
371600                                                                  37160003
371700         SELECT MAX(PRCG_NBR)                                     37170003
371800                                                                  37180003
371900           INTO :RCT00011-PRCG-NBR                                37190003
372000                                                                  37200003
372100         FROM RCT_PRCG_CNTL                                       37210003
372200                                                                  37220003
372300         WHERE CURRENT TIMESTAMP >= PRCG_BEG_TMST                 37230003
372400           AND CURRENT TIMESTAMP <= PRCG_END_TMST                 37240003
372500                                                                  37250003
372600     END-EXEC.                                                    37260003
372700                                                                  37270003
372800     EVALUATE SQLCODE                                             37280003
372900                                                                  37290003
373000       WHEN +0                                                    37300003
373100           CONTINUE                                               37310003
373200                                                                  37320003
373300       WHEN OTHER                                                 37330003
373400           MOVE +0 TO RCT00011-PRCG-NBR                           37340003
373500                                                                  37350003
373600     END-EVALUATE.                                                37360003
373700                                                                  37370003
373800                                                                  37380003
373900     SET RC822-STORE-LEVEL-OTR TO TRUE.                           37390099
374000                                                                  37400003
374100     CALL PC-RCKUP822 USING RC822-COMMAREA                        37410099
374200                            TM007-COMMUNICATIONS-AREA             37420099
374300                                                                  37430003
374400*    ----------------------                                       37440003
374500*    CHECK RETURN CODE                                            37450099
374600*    ----------------------                                       37460003
374700                                                                  37470003
374800     EVALUATE TRUE                                                37480003
374900                                                                  37490003
375000       WHEN RC822-RETURN-CODE = ZEROS                             37500099
375100           CONTINUE                                               37510099
375200                                                                  37520003
375300       WHEN OTHER                                                 37530003
375400                                                                  37540003
375500           EVALUATE TRUE                                          37550003
375600                                                                  37560003
375700             WHEN RC822-SOFT-ABORT                                37570099
375800                 SET PS-DONE-YES TO TRUE                          37580003
375900                 MOVE RC822-APP-PO-LNE-NBR TO RC001-PO-LNE-NBR    37590099
376000                 MOVE SPACES TO TM501-TM500-RETURN-MSG            37600003
376100                 MOVE '821'  TO TM501-PGM                         37610099
376200                 MOVE '5000' TO TM501-PARA                        37620004
376300                 MOVE 42     TO TM501-PRORATION-ERROR-NBR         37630003
376400                 PERFORM TM501-SET-TM500-RETURN-MSG               37640003
376500                 PERFORM RC001-RETURN-MSG                         37650003
376600                                                                  37660003
376700             WHEN RC822-NO-DISTRO                                 37670099
376800                 CONTINUE                                         37680003
376900                                                                  37690003
377000             WHEN OTHER                                           37700003
377100                 SET PS-DONE-YES TO TRUE                          37710003
377200                 MOVE RC822-APP-PO-LNE-NBR TO RC001-PO-LNE-NBR    37720099
377300                 MOVE SPACES TO TM501-TM500-RETURN-MSG            37730003
377400                 MOVE '821'  TO TM501-PGM                         37740099
377500                 MOVE '5000' TO TM501-PARA                        37750004
377600                 MOVE 43     TO TM501-PRORATION-ERROR-NBR         37760003
377700                 PERFORM TM501-SET-TM500-RETURN-MSG               37770003
377800                 PERFORM RC001-RETURN-MSG                         37780003
377900                                                                  37790003
378000           END-EVALUATE                                           37800003
378100                                                                  37810003
378200     END-EVALUATE.                                                37820003
378300                                                                  37830003
378400     PERFORM 5010-MOVE-RC822-STORE-DATA.                          37840099
378500                                                                  37850003
378600     IF RC822-INVALID-DISTRO                                      37860099
378700         MOVE PC-N TO RC821-VALID-DISTRO-IND                      37870099
378800     END-IF.                                                      37880003
378900                                                                  37890003
379000                                                                  37900003
379100*    ---------------------------                                  37910003
379200*    LINE OTR REQUEST PROCESSING                                  37920003
379300*    ---------------------------                                  37930003
379400                                                                  37940003
379500     PERFORM 5060-SETUP-RC822-COMMAREA.                           37950099
379600                                                                  37960003
379700     SET RC822-LINE-LEVEL-OTR TO TRUE.                            37970099
379800     CALL PC-RCKUP822 USING RC822-COMMAREA                        37980099
379900                            TM007-COMMUNICATIONS-AREA             37990099
380000                                                                  38000003
380100*    ----------------------                                       38010003
380200*    CHECK RETURN CODE                                            38020099
380300*    ----------------------                                       38030003
380400                                                                  38040003
380500     EVALUATE TRUE                                                38050003
380600                                                                  38060003
380700       WHEN RC822-RETURN-CODE = ZEROS                             38070099
380800           CONTINUE                                               38080003
380900                                                                  38090003
381000       WHEN OTHER                                                 38100003
381100                                                                  38110003
381200           EVALUATE TRUE                                          38120003
381300                                                                  38130003
381400             WHEN RC822-SOFT-ABORT                                38140099
381500                 SET PS-DONE-YES TO TRUE                          38150003
381600                 MOVE RC822-APP-PO-LNE-NBR TO RC001-PO-LNE-NBR    38160099
381700                 MOVE SPACES TO TM501-TM500-RETURN-MSG            38170003
381800                 MOVE '821'  TO TM501-PGM                         38180099
381900                 MOVE '5000' TO TM501-PARA                        38190004
382000                 MOVE 45     TO TM501-PRORATION-ERROR-NBR         38200003
382100                 PERFORM TM501-SET-TM500-RETURN-MSG               38210003
382200                 PERFORM RC001-RETURN-MSG                         38220003
382300                                                                  38230003
382400             WHEN RC822-NO-DISTRO                                 38240099
382500                 CONTINUE                                         38250003
382600                                                                  38260003
382700             WHEN OTHER                                           38270003
382800                 SET PS-DONE-YES TO TRUE                          38280003
382900                 MOVE RC822-APP-PO-LNE-NBR TO RC001-PO-LNE-NBR    38290099
383000                 MOVE SPACES TO TM501-TM500-RETURN-MSG            38300003
383100                 MOVE '821'  TO TM501-PGM                         38310099
383200                 MOVE '5000' TO TM501-PARA                        38320004
383300                 MOVE 46     TO TM501-PRORATION-ERROR-NBR         38330003
383400                 PERFORM TM501-SET-TM500-RETURN-MSG               38340003
383500                 PERFORM RC001-RETURN-MSG                         38350003
383600                                                                  38360003
383700           END-EVALUATE                                           38370003
383800                                                                  38380003
383900     END-EVALUATE.                                                38390003
384000                                                                  38400003
384100     PERFORM 5020-MOVE-RC822-LINE-DATA.                           38410099
384200                                                                  38420003
384300     IF RC822-INVALID-DISTRO                                      38430099
384400         MOVE PC-N TO RC821-VALID-DISTRO-IND                      38440099
384500     END-IF.                                                      38450003
384600                                                                  38460003
384700                                                                  38470003
384800* -------------------------------------------------------------- *38480003
384900* -------------------------------------------------------------- *38490003
385000                                                                  38500003
385100 5010-MOVE-RC822-STORE-DATA.                                      38510099
385200                                                                  38520003
385300     MOVE '5010-MOVE-RC822-STORE-DATA' TO RC001-PARAGRAPH.        38530099
385400                                                                  38540003
385500     MOVE RC822-PLAN-NBR          TO RC821-PLAN-NBR.              38550099
385600     MOVE RC822-CURR-SPLIT-QTY    TO RC821-CURR-SPLIT-QTY.        38560099
385700     MOVE RC822-PK-SIZE-RND-CDE   TO RC821-PK-SIZE-RND-CDE.       38570099
385800     MOVE RC822-ALLOC-OUTR-PK-QTY TO RC821-ALLOC-OUTR-PK-QTY.     38580099
385900     MOVE RC822-OVER-PRORATE-CDE  TO RC821-OVER-PRORATE-CDE.      38590099
386000     MOVE RC822-SHORT-PRORATE-CDE TO RC821-SHORT-PRORATE-CDE.     38600099
386100     MOVE RC822-USE-EX-RULES-IND  TO RC821-SHORT-USE-EX-RULES-IND.38610099
386200     MOVE RC822-SUM-STR-OTR-QTY   TO RC821-SUM-STR-DISTRO-OTR-QTY 38620099
386300                                     RC821-SUM-STR-OTR-QTY        38630099
386400     MOVE RC822-SUM-STR-PLAN-QTY  TO RC821-SUM-STR-PLAN-QTY.      38640099
386500     MOVE RC822-SUM-STR-PLAN-PK   TO RC821-SUM-STR-PLAN-PK.       38650099
386600                                                                  38660003
386700     IF RC822-SUM-STR-OTR-QTY < 0                                 38670099
386800         MOVE ZEROS TO RC821-SUM-STR-OTR-QTY                      38680099
386900     END-IF.                                                      38690003
387000                                                                  38700003
387100     IF PS-PREPACK  AND  RC821-PREPK-ID > 0                       38710099
387200         MOVE RC822-SUM-STR-OTR-PK TO RC821-SUM-STR-DISTRO-OTR-PK 38720099
387300     END-IF.                                                      38730003
387400                                                                  38740003
387500     IF RC822-SUM-STR-OTR-PK < 0                                  38750099
387600         MOVE ZEROS TO RC821-SUM-STR-OTR-PK                       38760099
387700     ELSE                                                         38770003
387800         MOVE RC822-SUM-STR-OTR-PK TO RC821-SUM-STR-OTR-PK        38780099
387900     END-IF.                                                      38790003
388000                                                                  38800003
388100     MOVE PC-M TO RC821-OVER-SHORT-CDE.                           38810099
388200                                                                  38820003
388300     IF RC821-SUM-STR-OTR-QTY > TM500-UNITS-TO-ALLOC              38830099
388400         MOVE PC-S TO RC821-OVER-SHORT-CDE                        38840099
388500     ELSE                                                         38850003
388600         IF RC821-SUM-STR-OTR-QTY < TM500-UNITS-TO-ALLOC          38860099
388700             MOVE PC-O TO RC821-OVER-SHORT-CDE                    38870099
388800         END-IF.                                                  38880003
388900                                                                  38890003
389000     PERFORM                                                      38900003
389100       VARYING RC822-STORE-IDX FROM 1 BY 1                        38910099
389200         UNTIL RC822-STORE-NBR (RC822-STORE-IDX) EQUAL ZERO       38920099
389300           OR  RC822-STORE-IDX > RC821-MAX-STR-COUNT              38930099
389400                                                                  38940003
389500         SET  RC821-STORE-IDX TO RC822-STORE-IDX                  38950099
389600                                                                  38960003
389700         PERFORM 5030-GET-STORE-INFO                              38970003
389800                                                                  38980003
389900         MOVE RC822-STORE-NBR            (RC822-STORE-IDX)        38990099
390000           TO RC821-STR-NBR              (RC821-STORE-IDX)        39000099
390100                                                                  39010003
390200         MOVE RC821-REC-DRV-LNE-NBR                               39020099
390300           TO RC821-ALLOC-LNE-NBR        (RC821-STORE-IDX)        39030099
390400                                                                  39040003
390500         MOVE RC822-STORE-DISTRO-QTY     (RC822-STORE-IDX)        39050099
390600           TO RC821-STR-DISTRO-QTY       (RC821-STORE-IDX)        39060099
390700                                                                  39070003
390800         MOVE RC822-STORE-DISTRO-QTY-X   (RC822-STORE-IDX)        39080099
390900           TO RC821-STR-DISTRO-QTY-X     (RC821-STORE-IDX)        39090099
391000                                                                  39100003
391100         MOVE RC822-STORE-DISTRO-PK      (RC822-STORE-IDX)        39110099
391200           TO RC821-STR-DISTRO-PK        (RC821-STORE-IDX)        39120099
391300                                                                  39130003
391400         MOVE RC822-STORE-DISTRO-OTR-PK  (RC822-STORE-IDX)        39140099
391500           TO RC821-STR-DISTRO-OTR-PK    (RC821-STORE-IDX)        39150099
391600                                                                  39160003
391700         MOVE RC822-STORE-DISTRO-OTR     (RC822-STORE-IDX)        39170099
391800           TO RC821-STR-DISTRO-OTR-QTY   (RC821-STORE-IDX)        39180099
391900                                                                  39190003
392000         MOVE RC822-STORE-DISTRO-OTR-X   (RC822-STORE-IDX)        39200099
392100           TO RC821-STR-DISTRO-OTR-QTY-X (RC821-STORE-IDX)        39210099
392200                                                                  39220003
392300         MOVE RC822-STORE-OTR-QTY        (RC822-STORE-IDX)        39230099
392400           TO RC821-STR-OTR-QTY          (RC821-STORE-IDX)        39240099
392500                                                                  39250003
392600         MOVE RC822-STORE-OTR-QTY-X      (RC822-STORE-IDX)        39260099
392700           TO RC821-STR-OTR-QTY-X        (RC821-STORE-IDX)        39270099
392800                                                                  39280003
392900         MOVE RC822-STORE-OTR-PK         (RC822-STORE-IDX)        39290099
393000           TO RC821-STR-OTR-PK           (RC821-STORE-IDX)        39300099
393100                                                                  39310003
393200         IF RC822-STORE-RNK-SEQ-NBR (RC822-STORE-IDX) > 0  OR     39320099
393300            RCT00011-PRCG-NBR = 0                                 39330003
393400             MOVE RC822-STORE-RNK-SEQ-NBR (RC822-STORE-IDX)       39340099
393500               TO RC821-RNK-SEQ-NBR       (RC821-STORE-IDX)       39350099
393600         ELSE                                                     39360003
393700             PERFORM 5070-RETREIVE-RANKING-DATA                   39370003
393800             MOVE PV-RANK-SEQ-NBR                                 39380003
393900               TO RC821-RNK-SEQ-NBR (RC821-STORE-IDX)             39390099
394000         END-IF                                                   39400003
394100                                                                  39410003
394200         ADD 1 TO RC821-STR-COUNT                                 39420099
394300                                                                  39430003
394400     END-PERFORM.                                                 39440003
394500                                                                  39450003
394600                                                                  39460003
394700* -------------------------------------------------------------- *39470003
394800* -------------------------------------------------------------- *39480003
394900                                                                  39490003
395000 5020-MOVE-RC822-LINE-DATA.                                       39500099
395100                                                                  39510003
395200     MOVE '5020-MOVE-RC822-LINE-DATA' TO RC001-PARAGRAPH.         39520099
395300                                                                  39530003
395400     PERFORM                                                      39540003
395500       VARYING RC822-ITEM-IDX FROM 1 BY 1                         39550099
395600         UNTIL RC822-LINE-NBR (RC822-ITEM-IDX) EQUAL ZERO         39560099
395700           OR  RC822-ITEM-IDX > RC821-MAX-ITEM-COUNT              39570099
395800                                                                  39580003
395900         SET RC821-ITEM-IDX TO RC822-ITEM-IDX                     39590099
396000                                                                  39600003
396100         MOVE RC822-LINE-DISTRO-QTY     (RC822-ITEM-IDX)          39610099
396200           TO RC821-ITEM-DISTRO-QTY     (RC821-ITEM-IDX)          39620099
396300                                                                  39630003
396400         MOVE RC822-LINE-OTR-QTY        (RC822-ITEM-IDX)          39640099
396500           TO RC821-ITEM-OTR-QTY        (RC821-ITEM-IDX)          39650099
396600                                                                  39660003
396700         MOVE RC822-LINE-DISTRO-OTR     (RC822-ITEM-IDX)          39670099
396800           TO RC821-ITEM-DISTRO-OTR-QTY (RC821-ITEM-IDX)          39680099
396900                                                                  39690003
397000     END-PERFORM.                                                 39700003
397100                                                                  39710003
397200     PERFORM                                                      39720003
397300       VARYING RC821-STORE-IDX FROM 1 BY 1                        39730099
397400         UNTIL RC821-STR-NBR (RC821-STORE-IDX) EQUAL ZERO         39740099
397500           OR  RC821-STORE-IDX > RC821-MAX-STR-COUNT              39750099
397600                                                                  39760003
397700         IF PS-BULK  OR  RC821-PREPK-ID = 0                       39770099
397800             MOVE PC-Y TO RC821-STR-VAL-OOR-IND  (RC821-STORE-IDX)39780099
397900                          RC821-STR-GOOD-PLAN-IND(RC821-STORE-IDX)39790099
398000         ELSE                                                     39800003
398100             MOVE RC822-STORE-VAL-OOR-IND                         39810099
398200               TO RC821-STR-VAL-OOR-IND     (RC821-STORE-IDX)     39820099
398300                                                                  39830003
398400             MOVE RC822-STORE-GOOD-PLAN-IND                       39840099
398500               TO RC821-STR-GOOD-PLAN-IND   (RC821-STORE-IDX)     39850099
398600                                                                  39860003
398700             IF RC822-STORE-VAL-OOR-IND EQUAL PC-N                39870099
398800                 MOVE PC-N TO RC821-VALID-DISTRO-IND              39880099
398900             END-IF                                               39890003
399000         END-IF                                                   39900003
399100                                                                  39910003
399200     END-PERFORM.                                                 39920003
399300                                                                  39930003
399400                                                                  39940003
399500* -------------------------------------------------------------- *39950003
399600* -------------------------------------------------------------- *39960003
399700                                                                  39970003
399800 5030-GET-STORE-INFO.                                             39980003
399900                                                                  39990003
400000     MOVE '5030-GET-STORE-INFO' TO RC001-PARAGRAPH.               40000033
400100                                                                  40010003
400200     INITIALIZE XL071-COMMAREA-REC.                               40020084
400300     MOVE RC822-STORE-NBR (RC822-STORE-IDX)                       40030099
400400                                      TO XL071-LOCATION-NUMBER.   40040084
400500                                                                  40050084
400600     CALL XL071-LOCATION-MODULE  USING  XL071-COMMAREA-REC.       40060099
400700     EVALUATE TRUE                                                40070084
400800       WHEN XL071-DC-ASGMT-NOT-FND                                40080099
400900           PERFORM 5035-SELECT-DC-LOC                             40090099
401000                                                                  40100099
401100       WHEN XL071-NO-ERRORS                                       40110084
401200           AND (XL071-LOC-TYP-CDE = PC-DS                         40120099
401300                                 OR PC-DC                         40130099
401400                                 OR PC-CS                         40140099
401500                                 OR PC-RV)                        40150099
401600               PERFORM 5040-MOVE-LOC-DAT-TO-RC821                 40160095
401700                                                                  40170095
401800       WHEN OTHER                                                 40180003
401900           SET PS-DONE-YES      TO TRUE                           40190099
402000           MOVE XL071-SQLCA     TO TM500-SQLCA                    40200099
402100                                   TM007-SQLCA                    40210099
402200           MOVE XL071-SQLCODE-N TO TM500-SQLCODE                  40220099
402300                                   TM007-SQLCODE                  40230099
402400           MOVE XL071-SQLCODE-N TO RC001-SAVE-SQLCODE             40240099
402500           MOVE SPACES          TO TM501-TM500-RETURN-MSG         40250099
402600           MOVE '821'           TO TM501-PGM                      40260099
402700           MOVE '5030'          TO TM501-PARA                     40270099
402800                                   TM007-RETURNED-PARA            40280099
402900           MOVE 'XLT_LOC'       TO TM501-TBL                      40290099
403000           MOVE 47              TO TM501-PRORATION-ERROR-NBR      40300099
403100           PERFORM TM501-SET-TM500-RETURN-MSG                     40310003
403200           MOVE TM500-RETURN-DATA                                 40320099
403300                                TO TM007-RETURN-DATA              40330099
403400           PERFORM RC001-RETURN-MSG                               40340003
403500                                                                  40350003
403600     END-EVALUATE.                                                40360003
403700                                                                  40370003
403800 5035-SELECT-DC-LOC.                                              40380099
403900                                                                  40390099
404000     MOVE XL071-LOCATION-NUMBER     TO DK-LOC-STR-NBR             40400099
404100                                                                  40410099
404200     EXEC SQL                                                     40420099
404300         SELECT A.EFF_BEG_DTE                                     40430099
404400              , A.DC_NBR                                          40440099
404500           INTO :XL071-ASGMT-EFF-BEG-DTE                          40450099
404600              , :DK-DC-NMBR                                       40460099
404700           FROM XLT_DC_LOC_ASGMT A                                40470099
404800          WHERE A.LOC_NBR     = :DK-LOC-STR-NBR                   40480099
404900            AND A.EFF_BEG_DTE =                                   40490099
405000                (SELECT MAX(EFF_BEG_DTE)                          40500099
405100                   FROM XLT_DC_LOC_ASGMT B                        40510099
405200                  WHERE B.LOC_NBR = :DK-LOC-STR-NBR               40520099
026000                    AND EFF_BEG_DTE <= CURRENT DATE)              40522099
405400     END-EXEC.                                                    40540099
405500                                                                  40550099
405600     EVALUATE SQLCODE                                             40560099
405700                                                                  40570099
405800       WHEN +0                                                    40580099
405900          MOVE XL071-LOC-TYP-CDE       TO RC821-TYPE-CODE         40590099
406000          MOVE DK-DC-NMBR              TO RC821-DC-NMBR           40600099
406100          MOVE XL071-ASGMT-EFF-BEG-DTE TO RC821-DC-RCT-STA-DTE    40610099
406200          IF XL071-CLO-DTE < '9999-09-09'                         40620099
406300              MOVE XL071-CLO-DTE TO XL071-ASGMT-EFF-STP-DTE       40630099
406400          ELSE                                                    40640099
406500              CONTINUE                                            40650099
406600          END-IF                                                  40660099
406700          MOVE XL071-ASGMT-EFF-STP-DTE TO RC821-DC-RCT-STO-DTE    40670099
406800                                                                  40680099
406900       WHEN OTHER                                                 40690099
407000           SET PS-DONE-YES      TO TRUE                           40700099
407100           MOVE XL071-SQLCA     TO TM500-SQLCA                    40710099
407200                                   TM007-SQLCA                    40720099
407300           MOVE XL071-SQLCODE-N TO TM500-SQLCODE                  40730099
407400                                   TM007-SQLCODE                  40740099
407500           MOVE XL071-SQLCODE-N TO RC001-SAVE-SQLCODE             40750099
407600           MOVE SPACES          TO TM501-TM500-RETURN-MSG         40760099
407700           MOVE '821'           TO TM501-PGM                      40770099
407800           MOVE '5035'          TO TM501-PARA                     40780099
407900                                   TM007-RETURNED-PARA            40790099
408000           MOVE 'XLT_LOC'       TO TM501-TBL                      40800099
408100           MOVE 47              TO TM501-PRORATION-ERROR-NBR      40810099
408200           PERFORM TM501-SET-TM500-RETURN-MSG                     40820099
408300           MOVE TM500-RETURN-DATA                                 40830099
408400                                TO TM007-RETURN-DATA              40840099
408500           PERFORM RC001-RETURN-MSG                               40850099
408600                                                                  40860099
408700                                                                  40870099
408800     END-EVALUATE.                                                40880099
408900                                                                  40890003
409000* -------------------------------------------------------------- *40900003
409100* -------------------------------------------------------------- *40910003
409200                                                                  40920003
409300 5040-MOVE-LOC-DAT-TO-RC821.                                      40930094
409400                                                                  40940003
409500     MOVE '5040-MOVE-LOC-DAT-TO-RC821' TO RC001-PARAGRAPH.        40950094
409600                                                                  40960003
409700     MOVE XL071-LOC-TYP-CDE          TO RC821-ST-TYPE-CODE        40970099
409800                                       (RC821-STORE-IDX).         40980099
409900                                                                  40990003
410000     MOVE XL071-ASGMT-DC-NBR         TO RC821-ST-DC-NMBR          41000099
410100                                       (RC821-STORE-IDX).         41010099
410200                                                                  41020003
410300     MOVE XL071-ASGMT-EFF-BEG-DTE    TO RC821-ST-DC-RCT-STA-DTE   41030099
410400                                       (RC821-STORE-IDX).         41040099
410500                                                                  41050003
410600     MOVE XL071-ASGMT-EFF-STP-DTE    TO RC821-ST-DC-RCT-STO-DTE   41060099
410700                                       (RC821-STORE-IDX).         41070099
410800                                                                  41080003
410900     MOVE XL071-OPN-DTE              TO RC821-OPENED-DATE         41090099
411000                                       (RC821-STORE-IDX).         41100099
411100                                                                  41110003
411200     MOVE XL071-CLO-DTE              TO RC821-CLOSED-DATE         41120099
411300                                       (RC821-STORE-IDX).         41130099
411400                                                                  41140003
411500     IF RC821-NEW-STR-IND EQUAL PC-Y                              41150099
411600         PERFORM 5050-NEW-STORE-DETERMINATION                     41160003
411700     ELSE                                                         41170003
411800         MOVE PC-ONE TO RC821-EXISTING-STORE-CDE                  41180099
411900                       (RC821-STORE-IDX)                          41190099
412000     END-IF.                                                      41200003
412100                                                                  41210003
412200                                                                  41220003
412300* -------------------------------------------------------------- *41230003
412400* -------------------------------------------------------------- *41240003
412500                                                                  41250003
412600 5050-NEW-STORE-DETERMINATION.                                    41260003
412700                                                                  41270003
412800     MOVE '5050-NEW-STORE-DETERMINATION' TO RC001-PARAGRAPH.      41280033
412900                                                                  41290000
413000     INITIALIZE DPG51                                             41300000
413100                DPG52                                             41310000
413200                DPG53                                             41320000
413300                DPG54                                             41330000
413400                DPG55                                             41340000
413500                DPG56.                                            41350000
413600                                                                  41360000
413700     SET DPG51-INCREMENT-DATE                                     41370000
413800         DPG51-ACTUAL-CALENDAR-ONLY                               41380000
413900         DPG52-LK-DTE-ISO-FMT      TO TRUE.                       41390000
414000                                                                  41400000
414100     MOVE XL071-OPN-DTE            TO DPG52-LK-DATE-INPUT.        41410096
414200     MOVE KRPRPM-FUNC-QTY          TO DPG51-INCR-DECR-DAYS-9.     41420000
414300                                                                  41430000
414400     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                41440000
414500                                             DPG52                41450000
414600                                             DPG53                41460000
414700                                             DPG54                41470000
414800                                             DPG55                41480000
414900                                             DPG56.               41490000
415000                                                                  41500000
415100     MOVE DPG55-DB2-ISO-DATE-FMT TO PV-STR-ADJUSTED-OPEN-DATE.    41510000
415200                                                                  41520000
415300                                                                  41530000
415400     IF PV-CURRENT-DATE > PV-STR-ADJUSTED-OPEN-DATE               41540000
415500         MOVE PC-ONE  TO RC821-EXISTING-STORE-CDE                 41550099
415600                        (RC821-STORE-IDX)                         41560099
415700     ELSE                                                         41570000
415800         MOVE PC-ZERO TO RC821-EXISTING-STORE-CDE                 41580099
415900                        (RC821-STORE-IDX)                         41590099
416000     END-IF.                                                      41600000
416100                                                                  41610000
416200                                                                  41620000
416300* -------------------------------------------------------------- *41630000
416400* -------------------------------------------------------------- *41640000
416500                                                                  41650000
416600 5060-SETUP-RC822-COMMAREA.                                       41660099
416700                                                                  41670000
416800     MOVE '5060-SETUP-RC822-COMMAREA ' TO RC001-PARAGRAPH.        41680099
416900                                                                  41690000
417000     MOVE RC821-ORD-NBR         TO  RC822-PO-NBR.                 41700099
417100     MOVE RC821-REC-DRV-LNE-NBR TO  RC822-APP-PO-LNE-NBR.         41710099
417200     MOVE RC821-REC-SEQ-NBR     TO  RC822-REC-SEQ-NBR.            41720099
417300     MOVE RC821-PREPK-ID        TO  RC822-PO-PREPK-ID.            41730099
417400     MOVE RC821-OPER-UNT-ID     TO  RC822-OPER-UNT-ID.            41740099
417500     MOVE RC821-FCLTY-ID        TO  RC822-FCLTY-ID.               41750099
417600     MOVE RC821-PKGNG-CDE       TO  RC822-PKGNG-CDE.              41760099
417700                                                                  41770000
417800     MOVE ZEROS TO RC822-STR-NBR.                                 41780099
417900                                                                  41790000
418000     IF TM500-REDISTRO-YES                                        41800000
418100         SET RC822-RECEIVER-OTR TO TRUE                           41810099
418200     ELSE                                                         41820003
418300         SET RC822-PO-OTR       TO TRUE                           41830099
418400     END-IF.                                                      41840003
418500                                                                  41850003
418600                                                                  41860003
418700* -------------------------------------------------------------- *41870003
418800* -------------------------------------------------------------- *41880003
418900                                                                  41890003
419000 5070-RETREIVE-RANKING-DATA.                                      41900003
419100                                                                  41910003
419200     MOVE '5070-RETREIVE-RANKING-DATA  ' TO RC001-PARAGRAPH.      41920033
419300                                                                  41930003
419400     SET PS-DRIVER-FOUND-NO TO TRUE.                              41940003
419500                                                                  41950003
419600     PERFORM 5080-FIND-DRIVER-LINE                                41960010
419700       VARYING RC821-ITEM-IDX FROM 1 BY 1                         41970099
419800         UNTIL PS-DRIVER-FOUND-YES                                41980003
419900           OR  RC821-ITEM-IDX > RC821-MAX-ITEM-COUNT.             41990099
420000                                                                  42000003
420100     MOVE RC821-DEPT-NBR                  TO  DK-DEPT-NBR.        42010099
420200     MOVE RC821-STR-NBR (RC821-STORE-IDX) TO  DK-RCT-LOC-NBR.     42020099
420300                                                                  42030003
420400     PERFORM 5090-SELECT-SUB-RNK.                                 42040010
420500                                                                  42050003
420600                                                                  42060003
420700* -------------------------------------------------------------- *42070003
420800* -------------------------------------------------------------- *42080003
420900                                                                  42090003
421000 5080-FIND-DRIVER-LINE.                                           42100010
421100                                                                  42110003
421200     MOVE '5080-FIND-DRIVER-LINE     ' TO RC001-PARAGRAPH.        42120033
421300                                                                  42130003
421400     IF RC821-DRV-LNE-CDE (RC821-ITEM-IDX) = PC-A                 42140099
421500         SET PS-DRIVER-FOUND-YES TO TRUE                          42150003
421600         MOVE RC821-REC-CLASS    (RC821-ITEM-IDX)                 42160099
421700           TO DK-MAJ-CL-NBR                                       42170003
421800         MOVE RC821-REC-SUBCLASS (RC821-ITEM-IDX)                 42180099
421900           TO DK-SUB-CL-NBR                                       42190003
422000     END-IF.                                                      42200003
422100                                                                  42210003
422200                                                                  42220003
422300* -------------------------------------------------------------- *42230003
422400* -------------------------------------------------------------- *42240003
422500                                                                  42250003
422600 5090-SELECT-SUB-RNK.                                             42260010
422700                                                                  42270003
422800     MOVE '5090-SELECT-SUB-RNK    ' TO RC001-PARAGRAPH.           42280033
422900                                                                  42290003
423000     EXEC SQL                                                     42300003
423100                                                                  42310003
423200         SELECT RNK_NBR                                           42320003
423300                                                                  42330003
423400           INTO :RCT00007-RNK-NBR                                 42340003
423500                                                                  42350003
423600         FROM RCT_LOC_SUB_RNK                                     42360003
423700                                                                  42370003
423800         WHERE PRCG_NBR    =  :RCT00011-PRCG-NBR                  42380003
423900           AND LOC_NBR     =  :DK-RCT-LOC-NBR                     42390003
424000           AND DEPT_NBR    =  :DK-DEPT-NBR                        42400003
424100           AND MAJ_CL_NBR  =  :DK-MAJ-CL-NBR                      42410003
424200           AND SUB_CL_NBR  =  :DK-SUB-CL-NBR                      42420003
424300                                                                  42430003
424400     END-EXEC.                                                    42440003
424500                                                                  42450003
424600     EVALUATE SQLCODE                                             42460003
424700                                                                  42470003
424800       WHEN +0                                                    42480003
424900           MOVE RCT00007-RNK-NBR  TO  PV-RANK-SEQ-NBR             42490003
425000                                                                  42500003
425100       WHEN +100                                                  42510003
425200           PERFORM 5100-SELECT-MAJ-RNK                            42520010
425300                                                                  42530003
425400       WHEN OTHER                                                 42540003
425500           MOVE SQLCODE    TO RC001-SAVE-SQLCODE                  42550003
425600           MOVE SQLCA      TO TM500-SQLCA                         42560003
425700                              TM007-SQLCA                         42570099
425800           MOVE SQLCODE    TO TM500-SQLCODE                       42580003
425900                              TM007-SQLCODE                       42590099
426000           MOVE SPACES     TO TM501-TM500-RETURN-MSG              42600003
426100           MOVE '821'      TO TM501-PGM                           42610099
426200           MOVE '5090'     TO TM501-PARA                          42620010
426300                              TM007-RETURNED-PARA                 42630099
426400           MOVE 'RCT0007'  TO TM501-TBL                           42640004
426500           MOVE 48         TO TM501-PRORATION-ERROR-NBR           42650004
426600           PERFORM TM501-SET-TM500-RETURN-MSG                     42660004
426700           MOVE TM500-RETURN-DATA                                 42670099
426800                           TO TM007-RETURN-DATA                   42680099
426900           PERFORM RC001-RETURN-MSG                               42690004
427000                                                                  42700004
427100     END-EVALUATE.                                                42710004
427200                                                                  42720004
427300                                                                  42730004
427400* -------------------------------------------------------------- *42740004
427500* -------------------------------------------------------------- *42750004
427600                                                                  42760004
427700 5100-SELECT-MAJ-RNK.                                             42770010
427800                                                                  42780004
427900     MOVE '5100-SELECT-MAJ-RNK    ' TO RC001-PARAGRAPH.           42790033
428000                                                                  42800004
428100     EXEC SQL                                                     42810004
428200                                                                  42820004
428300         SELECT RNK_NBR                                           42830004
428400                                                                  42840004
428500           INTO :RCT00006-RNK-NBR                                 42850004
428600                                                                  42860004
428700         FROM RCT_LOC_MAJ_RNK                                     42870004
428800                                                                  42880004
428900         WHERE PRCG_NBR    =  :RCT00011-PRCG-NBR                  42890004
429000           AND LOC_NBR     =  :DK-RCT-LOC-NBR                     42900004
429100           AND DEPT_NBR    =  :DK-DEPT-NBR                        42910004
429200           AND MAJ_CL_NBR  =  :DK-MAJ-CL-NBR                      42920004
429300                                                                  42930004
429400     END-EXEC.                                                    42940004
429500                                                                  42950004
429600     EVALUATE SQLCODE                                             42960004
429700                                                                  42970004
429800       WHEN +0                                                    42980004
429900           MOVE RCT00006-RNK-NBR  TO  PV-RANK-SEQ-NBR             42990004
430000                                                                  43000004
430100       WHEN +100                                                  43010004
430200           PERFORM 5110-SELECT-DEPT-RNK                           43020010
430300                                                                  43030004
430400       WHEN OTHER                                                 43040004
430500           MOVE SQLCA     TO TM500-SQLCA                          43050000
430600                             TM007-SQLCA                          43060099
430700           MOVE SQLCODE   TO TM500-SQLCODE                        43070000
430800                             TM007-SQLCODE                        43080099
430900           MOVE SQLCODE   TO RC001-SAVE-SQLCODE                   43090000
431000           MOVE SPACES    TO TM501-TM500-RETURN-MSG               43100000
431100           MOVE '821'     TO TM501-PGM                            43110099
431200           MOVE '5100'    TO TM501-PARA                           43120010
431300                             TM007-RETURNED-PARA                  43130099
431400           MOVE 'RCT0006' TO TM501-TBL                            43140004
431500           MOVE 49        TO TM501-PRORATION-ERROR-NBR            43150000
431600           PERFORM TM501-SET-TM500-RETURN-MSG                     43160000
431700           MOVE TM500-RETURN-DATA                                 43170099
431800                          TO TM007-RETURN-DATA                    43180099
431900           PERFORM RC001-RETURN-MSG                               43190000
432000                                                                  43200000
432100     END-EVALUATE.                                                43210000
432200                                                                  43220000
432300                                                                  43230000
432400* -------------------------------------------------------------- *43240000
432500* -------------------------------------------------------------- *43250000
432600                                                                  43260000
432700 5110-SELECT-DEPT-RNK.                                            43270010
432800                                                                  43280000
432900     MOVE '5110-SELECT-DEPT-RNK    ' TO RC001-PARAGRAPH.          43290033
433000                                                                  43300000
433100     EXEC SQL                                                     43310000
433200                                                                  43320000
433300         SELECT RNK_NBR                                           43330000
433400                                                                  43340000
433500           INTO :RCT00005-RNK-NBR                                 43350000
433600                                                                  43360000
433700         FROM RCT_LOC_DEPT_RNK                                    43370000
433800                                                                  43380000
433900         WHERE PRCG_NBR    =  :RCT00011-PRCG-NBR                  43390000
434000           AND LOC_NBR     =  :DK-RCT-LOC-NBR                     43400000
434100           AND DEPT_NBR    =  :DK-DEPT-NBR                        43410000
434200                                                                  43420000
434300     END-EXEC.                                                    43430000
434400                                                                  43440000
434500     EVALUATE SQLCODE                                             43450000
434600                                                                  43460000
434700       WHEN +0                                                    43470000
434800           MOVE RCT00005-RNK-NBR  TO  PV-RANK-SEQ-NBR             43480000
434900                                                                  43490000
435000       WHEN +100                                                  43500000
435100           PERFORM 5120-SELECT-LOC-RNK                            43510010
435200                                                                  43520000
435300       WHEN OTHER                                                 43530000
435400           MOVE SQLCA     TO TM500-SQLCA                          43540000
435500                             TM007-SQLCA                          43550099
435600           MOVE SQLCODE   TO TM500-SQLCODE                        43560000
435700                             TM007-SQLCODE                        43570099
435800           MOVE SQLCODE   TO RC001-SAVE-SQLCODE                   43580000
435900           MOVE SPACES    TO TM501-TM500-RETURN-MSG               43590000
436000           MOVE '821'     TO TM501-PGM                            43600099
436100           MOVE '5110'    TO TM501-PARA                           43610010
436200                             TM007-RETURNED-PARA                  43620099
436300           MOVE 'RCT0005' TO TM501-TBL                            43630004
436400           MOVE 50        TO TM501-PRORATION-ERROR-NBR            43640004
436500           PERFORM TM501-SET-TM500-RETURN-MSG                     43650004
436600           MOVE TM500-RETURN-DATA                                 43660099
436700                          TO TM007-RETURN-DATA                    43670099
436800           PERFORM RC001-RETURN-MSG                               43680004
436900                                                                  43690004
437000     END-EVALUATE.                                                43700004
437100                                                                  43710004
437200                                                                  43720004
437300* -------------------------------------------------------------- *43730004
437400* -------------------------------------------------------------- *43740004
437500                                                                  43750004
437600 5120-SELECT-LOC-RNK.                                             43760010
437700                                                                  43770004
437800     MOVE '5120-SELECT-LOC-RNK    ' TO RC001-PARAGRAPH.           43780033
437900                                                                  43790004
438000     EXEC SQL                                                     43800004
438100                                                                  43810004
438200         SELECT RNK_NBR                                           43820004
438300                                                                  43830004
438400           INTO :RCT00008-RNK-NBR                                 43840004
438500                                                                  43850004
438600         FROM RCT_LOC_RNK                                         43860052
438700                                                                  43870004
438800         WHERE PRCG_NBR    =  :RCT00011-PRCG-NBR                  43880004
438900           AND LOC_NBR     =  :DK-RCT-LOC-NBR                     43890004
439000                                                                  43900004
439100     END-EXEC.                                                    43910004
439200                                                                  43920004
439300     EVALUATE SQLCODE                                             43930004
439400                                                                  43940004
439500       WHEN +0                                                    43950004
439600           MOVE RCT00008-RNK-NBR  TO  PV-RANK-SEQ-NBR             43960004
439700                                                                  43970004
439800       WHEN +100                                                  43980004
439900           MOVE PC-9999 TO PV-RANK-SEQ-NBR                        43990051
440000                                                                  44000004
440100       WHEN OTHER                                                 44010004
440200           MOVE SQLCA     TO TM500-SQLCA                          44020004
440300                             TM007-SQLCA                          44030099
440400           MOVE SQLCODE   TO TM500-SQLCODE                        44040004
440500                             TM007-SQLCODE                        44050099
440600           MOVE SQLCODE   TO RC001-SAVE-SQLCODE                   44060004
440700           MOVE SPACES    TO TM501-TM500-RETURN-MSG               44070004
440800           MOVE '821'     TO TM501-PGM                            44080099
440900           MOVE '5120'    TO TM501-PARA                           44090010
441000                             TM007-RETURNED-PARA                  44100099
441100           MOVE 'RCT0008' TO TM501-TBL                            44110004
441200           MOVE 51        TO TM501-PRORATION-ERROR-NBR            44120004
441300           PERFORM TM501-SET-TM500-RETURN-MSG                     44130004
441400           MOVE TM500-RETURN-DATA                                 44140099
441500                          TO TM007-RETURN-DATA                    44150099
441600           PERFORM RC001-RETURN-MSG                               44160004
441700                                                                  44170004
441800     END-EVALUATE.                                                44180004
441900                                                                  44190004
442000                                                                  44200004
442100* -------------------------------------------------------------- *44210004
442200* -------------------------------------------------------------- *44220004
442300                                                                  44230004
442400 6000-CALL-TROUBLE-ROUTINE.                                       44240004
442500                                                                  44250004
442600     MOVE '6000-CALL-TROUBLE-ROUTINE' TO RC001-PARAGRAPH.         44260034
442700                                                                  44270004
442800     INITIALIZE RC823-TROUBLE-RULES-COMPONENTS.                   44280099
442900                                                                  44290004
443000     IF PS-PREPACK  AND  RC821-PREPK-ID > 0                       44300099
443100                                                                  44310004
443200         PERFORM 6010-PREPACK-LINE-TROUBLE                        44320004
443300         IF   RC821-PREPK-ID NOT = 99                             44330099
443400             PERFORM 6020-PREPACK-PACK-TROUBLE                    44340054
443500         END-IF                                                   44350054
443600                                                                  44360004
443700         IF NOT TM500-RESOLVE-AUTO                                44370004
443800             PERFORM 6050-PREPACK-STORE-TROUBLE                   44380010
443900             PERFORM 6030-PREPACK-OVR-SHT-TROUBLE                 44390058
444000         END-IF                                                   44400056
444100     END-IF.                                                      44410004
444200                                                                  44420004
444300     IF PS-BULK  OR  RC821-PREPK-ID = 0                           44430099
444400                                                                  44440004
444500         PERFORM 6060-BULK-LINE-TROUBLE                           44450010
444600                                                                  44460004
444700         IF NOT TM500-RESOLVE-AUTO                                44470004
444800             PERFORM 6090-BULK-STORE-TROUBLE                      44480010
444900             PERFORM 6070-BULK-OVR-SHT-TROUBLE                    44490058
445000         END-IF                                                   44500004
445100     END-IF.                                                      44510004
445200                                                                  44520004
445300     MOVE TM500-FIELDS  TO RC823-TM500-FIELDS.                    44530099
445400                                                                  44540004
445500     CALL PC-RCKUP823 USING RC823-COMMAREA                        44550099
445600                            RC821-PO-RECEIVER-CONTENTS            44560099
445700                            RC821-STORE-COMPONENTS                44570099
445800                            RC821-ITEM-ARRAY-ALL                  44580099
445900                            TM007-COMMUNICATIONS-AREA.            44590099
446000                                                                  44600003
446100*    ----------------------                                       44610003
446200*    CHECK RETURN CODE                                            44620099
446300*    ----------------------                                       44630003
446400                                                                  44640003
446500     MOVE RC823-TM500-FIELDS TO TM500-FIELDS.                     44650099
446600                                                                  44660003
446700     EVALUATE TRUE                                                44670003
446800                                                                  44680003
446900       WHEN TM500-CALL-SUCCESSFUL                                 44690003
447000       WHEN TM500-DUPLICATE-TROUBLE                               44700003
447100       WHEN TM500-TTRBNTF-UPDATE-NOT-FND                          44710003
447200           CONTINUE                                               44720003
447300                                                                  44730003
447400       WHEN OTHER                                                 44740003
447500           SET PS-DONE-YES TO TRUE                                44750003
447600                                                                  44760003
447700     END-EVALUATE.                                                44770003
447800                                                                  44780003
447900                                                                  44790003
448000     IF RC823-DO-ALLOCATION-YES  AND  TM500-CREATE-AUTO           44800099
448100         CONTINUE                                                 44810003
448200     ELSE                                                         44820003
448300         SET PS-DONE-YES TO TRUE                                  44830003
448400     END-IF.                                                      44840003
448500                                                                  44850003
448600                                                                  44860003
448700* -------------------------------------------------------------- *44870003
448800* -------------------------------------------------------------- *44880003
448900                                                                  44890003
449000 6010-PREPACK-LINE-TROUBLE.                                       44900003
449100                                                                  44910003
449200     MOVE '6010-PREPACK-LINE-TROUBLE ' TO RC001-PARAGRAPH.        44920034
449300                                                                  44930003
449400     SET RC823-RULE-IDX TO +1.                                    44940099
449500                                                                  44950003
449600     MOVE PC-N  TO  RC823-PRORATE-IND    (RC823-RULE-IDX)         44960099
449700                    DK-PRORATE-IND.                               44970003
449800                                                                  44980003
449900     MOVE PC-N  TO  RC823-MERCH-TYPE-CDE (RC823-RULE-IDX)         44990099
450000                    DK-MERCH-TYPE-CDE.                            45000003
450100                                                                  45010003
450200     MOVE PC-S  TO  RC823-ALLOC-IND      (RC823-RULE-IDX)         45020099
450300                    DK-ALLOC-IND.                                 45030003
450400                                                                  45040003
450500     MOVE PC-K  TO  RC823-TRB-LVL-CDE    (RC823-RULE-IDX)         45050099
450600                    DK-TRB-LVL-CDE.                               45060003
450700                                                                  45070003
450800     MOVE RC821-PKGNG-CDE                                         45080099
450900       TO RC823-PKGNG-CDE     (RC823-RULE-IDX)                    45090099
451000          DK-PKGNG-CDE.                                           45100003
451100                                                                  45110003
451200     MOVE RC821-NEW-STR-IND                                       45120099
451300       TO RC823-NEW-STORE-IND (RC823-RULE-IDX)                    45130099
451400          DK-NEW-STORE-IND.                                       45140003
451500                                                                  45150003
451600     PERFORM 6100-SELECT-RULE-KEY.                                45160010
451700                                                                  45170003
451800                                                                  45180003
451900* -------------------------------------------------------------- *45190003
452000* -------------------------------------------------------------- *45200003
452100                                                                  45210003
452200 6020-PREPACK-PACK-TROUBLE.                                       45220003
452300                                                                  45230003
452400     MOVE '6020-PREPACK-PACK-TROUBLE ' TO RC001-PARAGRAPH.        45240034
452500                                                                  45250003
452600     SET RC823-RULE-IDX UP BY +1.                                 45260099
452700                                                                  45270003
452800     MOVE PC-N  TO  RC823-PRORATE-IND    (RC823-RULE-IDX)         45280099
452900                    DK-PRORATE-IND.                               45290003
453000                                                                  45300003
453100     MOVE PC-N  TO  RC823-MERCH-TYPE-CDE (RC823-RULE-IDX)         45310099
453200                    DK-MERCH-TYPE-CDE.                            45320003
453300                                                                  45330003
453400     MOVE PC-S  TO  RC823-ALLOC-IND      (RC823-RULE-IDX)         45340099
453500                    DK-ALLOC-IND.                                 45350003
453600                                                                  45360003
453700     MOVE PC-P  TO  RC823-TRB-LVL-CDE    (RC823-RULE-IDX)         45370099
453800                    DK-TRB-LVL-CDE.                               45380003
453900                                                                  45390003
454000     MOVE RC821-PKGNG-CDE                                         45400099
454100       TO RC823-PKGNG-CDE     (RC823-RULE-IDX)                    45410099
454200          DK-PKGNG-CDE.                                           45420003
454300                                                                  45430003
454400     MOVE RC821-NEW-STR-IND                                       45440099
454500       TO RC823-NEW-STORE-IND (RC823-RULE-IDX)                    45450099
454600          DK-NEW-STORE-IND.                                       45460003
454700                                                                  45470003
454800     PERFORM 6100-SELECT-RULE-KEY.                                45480010
454900                                                                  45490003
455000                                                                  45500003
455100* -------------------------------------------------------------- *45510003
455200* -------------------------------------------------------------- *45520003
455300                                                                  45530003
455400 6030-PREPACK-OVR-SHT-TROUBLE.                                    45540003
455500                                                                  45550003
455600     MOVE '6030-PREPACK-OVR-SHT-TROUBLE' TO RC001-PARAGRAPH.      45560034
455700                                                                  45570003
455800     IF RC821-OVER-SHORT-CDE EQUAL PC-O                           45580099
455900         MOVE RC821-OVER-PRORATE-CDE TO DK-ALLOC-IND              45590099
456000         MOVE PC-O                   TO DK-PRORATE-IND            45600024
456100         PERFORM 6040-OVER-SHORT-ROUTINE                          45610024
456200         MOVE RC821-OVER-PRORATE-CDE                              45620099
456300           TO RC823-ALLOC-IND   (RC823-RULE-IDX)                  45630099
456400         MOVE PC-O                                                45640024
456500           TO RC823-PRORATE-IND (RC823-RULE-IDX)                  45650099
456600     END-IF.                                                      45660003
456700                                                                  45670003
456800     IF RC821-OVER-SHORT-CDE EQUAL PC-S                           45680099
456900         MOVE RC821-SHORT-PRORATE-CDE TO DK-ALLOC-IND             45690099
457000         MOVE PC-S                    TO DK-PRORATE-IND           45700024
457100         PERFORM 6040-OVER-SHORT-ROUTINE                          45710024
457200         MOVE RC821-SHORT-PRORATE-CDE                             45720099
457300           TO RC823-ALLOC-IND   (RC823-RULE-IDX)                  45730099
457400         MOVE PC-S                                                45740024
457500           TO RC823-PRORATE-IND (RC823-RULE-IDX)                  45750099
457600     END-IF.                                                      45760003
457700                                                                  45770003
457800* -------------------------------------------------------------- *45780003
457900* -------------------------------------------------------------- *45790003
458000                                                                  45800003
458100 6040-OVER-SHORT-ROUTINE.                                         45810010
458200                                                                  45820003
458300     MOVE '6030-OVER-SHORT-ROUTINE     ' TO RC001-PARAGRAPH.      45830034
458400                                                                  45840003
458500     SET RC823-RULE-IDX UP BY +1.                                 45850099
458600                                                                  45860003
458700     MOVE PC-N  TO  RC823-MERCH-TYPE-CDE (RC823-RULE-IDX)         45870099
458800                    DK-MERCH-TYPE-CDE.                            45880003
458900                                                                  45890003
459000     MOVE PC-P  TO  RC823-TRB-LVL-CDE    (RC823-RULE-IDX)         45900099
459100                    DK-TRB-LVL-CDE.                               45910003
459200                                                                  45920003
459300     MOVE RC821-PKGNG-CDE                                         45930099
459400       TO RC823-PKGNG-CDE     (RC823-RULE-IDX)                    45940099
459500          DK-PKGNG-CDE.                                           45950003
459600                                                                  45960003
459700     MOVE RC821-NEW-STR-IND                                       45970099
459800       TO RC823-NEW-STORE-IND (RC823-RULE-IDX)                    45980099
459900          DK-NEW-STORE-IND.                                       45990003
460000                                                                  46000003
460100     PERFORM 6100-SELECT-RULE-KEY.                                46010010
460200                                                                  46020003
460300                                                                  46030003
460400* -------------------------------------------------------------- *46040003
460500* -------------------------------------------------------------- *46050003
460600                                                                  46060003
460700 6050-PREPACK-STORE-TROUBLE.                                      46070010
460800                                                                  46080003
460900     MOVE '6050-PREPACK-STORE-TROUBLE  ' TO RC001-PARAGRAPH.      46090034
461000                                                                  46100003
461100     SET RC823-RULE-IDX UP BY +1.                                 46110099
461200                                                                  46120003
461300     MOVE PC-N  TO  RC823-PRORATE-IND    (RC823-RULE-IDX)         46130099
461400                    DK-PRORATE-IND.                               46140003
461500                                                                  46150003
461600     MOVE PC-N  TO  RC823-MERCH-TYPE-CDE (RC823-RULE-IDX)         46160099
461700                    DK-MERCH-TYPE-CDE.                            46170003
461800                                                                  46180003
461900     MOVE PC-S  TO  RC823-ALLOC-IND      (RC823-RULE-IDX)         46190099
462000                    DK-ALLOC-IND.                                 46200003
462100                                                                  46210003
462200     MOVE PC-S  TO  RC823-TRB-LVL-CDE    (RC823-RULE-IDX)         46220099
462300                    DK-TRB-LVL-CDE.                               46230003
462400                                                                  46240003
462500     MOVE RC821-PKGNG-CDE                                         46250099
462600       TO RC823-PKGNG-CDE     (RC823-RULE-IDX)                    46260099
462700          DK-PKGNG-CDE.                                           46270003
462800                                                                  46280003
462900     MOVE RC821-NEW-STR-IND                                       46290099
463000       TO RC823-NEW-STORE-IND (RC823-RULE-IDX)                    46300099
463100          DK-NEW-STORE-IND.                                       46310003
463200                                                                  46320003
463300     PERFORM 6100-SELECT-RULE-KEY.                                46330010
463400                                                                  46340003
463500                                                                  46350003
463600* -------------------------------------------------------------- *46360003
463700* -------------------------------------------------------------- *46370003
463800                                                                  46380003
463900 6060-BULK-LINE-TROUBLE.                                          46390010
464000                                                                  46400003
464100     MOVE '6060-BULK-LINE-TROUBLE      ' TO RC001-PARAGRAPH.      46410034
464200                                                                  46420003
464300     SET RC823-RULE-IDX TO +1.                                    46430099
464400                                                                  46440003
464500     MOVE PC-N  TO  RC823-PRORATE-IND    (RC823-RULE-IDX)         46450099
464600                    DK-PRORATE-IND.                               46460003
464700                                                                  46470003
464800     MOVE PC-N  TO  RC823-MERCH-TYPE-CDE (RC823-RULE-IDX)         46480099
464900                    DK-MERCH-TYPE-CDE.                            46490003
465000                                                                  46500003
465100     MOVE PC-S  TO  RC823-ALLOC-IND      (RC823-RULE-IDX)         46510099
465200                    DK-ALLOC-IND.                                 46520003
465300                                                                  46530003
465400     MOVE PC-K  TO  RC823-TRB-LVL-CDE    (RC823-RULE-IDX)         46540099
465500                    DK-TRB-LVL-CDE.                               46550003
465600                                                                  46560003
465700     MOVE RC821-PKGNG-CDE                                         46570099
465800       TO RC823-PKGNG-CDE     (RC823-RULE-IDX)                    46580099
465900          DK-PKGNG-CDE.                                           46590003
466000                                                                  46600003
466100     MOVE RC821-NEW-STR-IND                                       46610099
466200       TO RC823-NEW-STORE-IND (RC823-RULE-IDX)                    46620099
466300          DK-NEW-STORE-IND.                                       46630003
466400                                                                  46640003
466500     PERFORM 6100-SELECT-RULE-KEY.                                46650010
466600                                                                  46660003
466700                                                                  46670003
466800* -------------------------------------------------------------- *46680003
466900* -------------------------------------------------------------- *46690003
467000                                                                  46700003
467100 6070-BULK-OVR-SHT-TROUBLE.                                       46710010
467200                                                                  46720003
467300     MOVE '6070-BULK-OVR-SHT-TROUBLE   ' TO RC001-PARAGRAPH.      46730034
467400                                                                  46740003
467500     IF RC821-OVER-SHORT-CDE EQUAL PC-O                           46750099
467600         MOVE RC821-OVER-PRORATE-CDE TO DK-ALLOC-IND              46760099
467700         MOVE PC-O                   TO DK-PRORATE-IND            46770024
467800         PERFORM 6080-OVER-SHORT-ROUTINE                          46780024
467900         MOVE RC821-OVER-PRORATE-CDE                              46790099
468000           TO RC823-ALLOC-IND   (RC823-RULE-IDX)                  46800099
468100         MOVE PC-O                                                46810024
468200           TO RC823-PRORATE-IND (RC823-RULE-IDX)                  46820099
468300     END-IF.                                                      46830003
468400                                                                  46840003
468500     IF RC821-OVER-SHORT-CDE EQUAL PC-S                           46850099
468600         MOVE RC821-SHORT-PRORATE-CDE TO DK-ALLOC-IND             46860099
468700         MOVE PC-S                    TO DK-PRORATE-IND           46870024
468800         PERFORM 6080-OVER-SHORT-ROUTINE                          46880024
468900         MOVE RC821-SHORT-PRORATE-CDE                             46890099
469000           TO RC823-ALLOC-IND   (RC823-RULE-IDX)                  46900099
469100         MOVE PC-S                                                46910024
469200           TO RC823-PRORATE-IND (RC823-RULE-IDX)                  46920099
469300     END-IF.                                                      46930003
469400                                                                  46940003
469500                                                                  46950003
469600* -------------------------------------------------------------- *46960003
469700* -------------------------------------------------------------- *46970003
469800                                                                  46980003
469900 6080-OVER-SHORT-ROUTINE.                                         46990010
470000                                                                  47000000
470100     MOVE '6080-OVER-SHORT-ROUTINE     ' TO RC001-PARAGRAPH.      47010034
470200                                                                  47020000
470300     SET RC823-RULE-IDX UP BY +1.                                 47030099
470400                                                                  47040000
470500     MOVE PC-N  TO  RC823-MERCH-TYPE-CDE (RC823-RULE-IDX)         47050099
470600                    DK-MERCH-TYPE-CDE.                            47060000
470700                                                                  47070000
470800     MOVE PC-K  TO  RC823-TRB-LVL-CDE    (RC823-RULE-IDX)         47080099
470900                    DK-TRB-LVL-CDE.                               47090000
471000                                                                  47100000
471100     MOVE RC821-PKGNG-CDE                                         47110099
471200       TO RC823-PKGNG-CDE     (RC823-RULE-IDX)                    47120099
471300          DK-PKGNG-CDE.                                           47130000
471400                                                                  47140000
471500     MOVE RC821-NEW-STR-IND                                       47150099
471600       TO RC823-NEW-STORE-IND (RC823-RULE-IDX)                    47160099
471700          DK-NEW-STORE-IND.                                       47170000
471800                                                                  47180000
471900     PERFORM 6100-SELECT-RULE-KEY.                                47190010
472000                                                                  47200000
472100                                                                  47210000
472200* -------------------------------------------------------------- *47220000
472300* -------------------------------------------------------------- *47230000
472400                                                                  47240000
472500 6090-BULK-STORE-TROUBLE.                                         47250010
472600                                                                  47260000
472700     MOVE '6080-BULK-STORE-TROUBLE     ' TO RC001-PARAGRAPH.      47270034
472800                                                                  47280000
472900     SET RC823-RULE-IDX UP BY +1.                                 47290099
473000                                                                  47300000
473100     MOVE PC-N  TO  RC823-PRORATE-IND    (RC823-RULE-IDX)         47310099
473200                    DK-PRORATE-IND.                               47320000
473300                                                                  47330000
473400     MOVE PC-N  TO  RC823-MERCH-TYPE-CDE (RC823-RULE-IDX)         47340099
473500                    DK-MERCH-TYPE-CDE.                            47350000
473600                                                                  47360000
473700     MOVE PC-S  TO  RC823-ALLOC-IND      (RC823-RULE-IDX)         47370099
473800                    DK-ALLOC-IND.                                 47380000
473900                                                                  47390000
474000     MOVE PC-S  TO  RC823-TRB-LVL-CDE    (RC823-RULE-IDX)         47400099
474100                    DK-TRB-LVL-CDE.                               47410000
474200                                                                  47420000
474300     MOVE RC821-PKGNG-CDE                                         47430099
474400       TO RC823-PKGNG-CDE     (RC823-RULE-IDX)                    47440099
474500          DK-PKGNG-CDE.                                           47450000
474600                                                                  47460000
474700     MOVE RC821-NEW-STR-IND                                       47470099
474800       TO RC823-NEW-STORE-IND (RC823-RULE-IDX)                    47480099
474900          DK-NEW-STORE-IND.                                       47490000
475000                                                                  47500000
475100     PERFORM 6100-SELECT-RULE-KEY.                                47510010
475200                                                                  47520003
475300                                                                  47530003
475400* -------------------------------------------------------------- *47540003
475500* -------------------------------------------------------------- *47550003
475600                                                                  47560003
475700 6100-SELECT-RULE-KEY.                                            47570010
475800                                                                  47580003
475900     MOVE '6100-SELECT-RULE-KEY     ' TO RC001-PARAGRAPH.         47590034
476000                                                                  47600003
476100                                                                  47610003
476200     EXEC SQL                                                     47620003
476300                                                                  47630003
476400         SELECT  PRRTN_RUL_ID                                     47640003
476500                                                                  47650003
476600           INTO  :RCT00000-PRRTN-RUL-ID                           47660003
476700                                                                  47670003
476800           FROM  RCT_PRRTN_RUL                                    47680003
476900                                                                  47690003
477000         WHERE PRRTN_TYP_CDE    =  :DK-PRORATE-IND                47700003
477100           AND PRRTN_MTHD_CDE   =  :DK-ALLOC-IND                  47710003
477200           AND PRRTN_LVL_CDE    =  :DK-TRB-LVL-CDE                47720003
477300           AND PKG_TYP_CDE      =  :DK-PKGNG-CDE                  47730003
477400           AND PO_NW_STR_IND    =  :DK-NEW-STORE-IND              47740003
477500           AND MDSE_TYP_CDE     =  :DK-MERCH-TYPE-CDE             47750003
477600           AND ACTV_IND         =  :PC-Y                          47760003
477700           AND LOC_NBR          =  :DK-LOC-NBR                    47770003
477800                                                                  47780003
477900                                                                  47790003
478000     END-EXEC.                                                    47800003
478100                                                                  47810003
478200     EVALUATE SQLCODE                                             47820003
478300                                                                  47830003
478400       WHEN +0                                                    47840003
478500           MOVE RCT00000-PRRTN-RUL-ID                             47850003
478600             TO RC823-RULE-KEY (RC823-RULE-IDX)                   47860099
478700                                                                  47870003
478800       WHEN OTHER                                                 47880003
478900           SET PS-DONE-YES TO TRUE                                47890003
479000           MOVE SQLCA      TO TM500-SQLCA                         47900003
479100                              TM007-SQLCA                         47910099
479200           MOVE SQLCODE    TO TM500-SQLCODE                       47920003
479300                              TM007-SQLCODE                       47930099
479400           MOVE SQLCODE    TO RC001-SAVE-SQLCODE                  47940003
479500           MOVE SPACES     TO TM501-TM500-RETURN-MSG              47950003
479600           MOVE '821'      TO TM501-PGM                           47960099
479700           MOVE '6100'     TO TM501-PARA                          47970010
479800                              TM007-RETURNED-PARA                 47980099
479900           MOVE 'RCT0000'  TO TM501-TBL                           47990004
480000           MOVE 53         TO TM501-PRORATION-ERROR-NBR           48000004
480100           PERFORM TM501-SET-TM500-RETURN-MSG                     48010004
480200           MOVE TM500-RETURN-DATA                                 48020099
480300                           TO TM007-RETURN-DATA                   48030099
480400           PERFORM RC001-RETURN-MSG                               48040004
480500                                                                  48050004
480600     END-EVALUATE.                                                48060004
480700                                                                  48070004
480800                                                                  48080004
480900* -------------------------------------------------------------- *48090004
481000* -------------------------------------------------------------- *48100004
481100                                                                  48110004
481200 7000-CALL-PRORATION-ROUTINE.                                     48120004
481300                                                                  48130004
481400     MOVE '7000-CALL-PRORATION-ROUTINE' TO RC001-PARAGRAPH.       48140034
481500                                                                  48150004
481600     MOVE TM500-FIELDS TO RC824-TM500-FIELDS.                     48160099
481700                                                                  48170004
481800     CALL PC-RCKUP824 USING RC824-COMMAREA                        48180099
481900                            RC821-PO-RECEIVER-CONTENTS            48190099
482000                            RC821-STORE-COMPONENTS                48200099
482100                            RC821-ITEM-ARRAY-ALL                  48210099
482200                            TM007-COMMUNICATIONS-AREA.            48220099
482300                                                                  48230004
482400                                                                  48240004
482500     MOVE RC824-TM500-FIELDS TO TM500-FIELDS.                     48250099
482600                                                                  48260003
482700*    ----------------------                                       48270003
482800*    CHECK RETURN CODE                                            48280099
482900*    ----------------------                                       48290003
483000                                                                  48300000
483100     EVALUATE TRUE                                                48310000
483200                                                                  48320000
483300       WHEN TM500-CALL-SUCCESSFUL                                 48330000
483400       WHEN TM500-DUPLICATE-TROUBLE                               48340036
483500       WHEN TM500-TTRBNTF-UPDATE-NOT-FND                          48350036
483600           CONTINUE                                               48360000
483700                                                                  48370003
483800       WHEN OTHER                                                 48380003
483900           SET PS-DONE-YES TO TRUE                                48390003
484000                                                                  48400003
484100     END-EVALUATE.                                                48410003
484200                                                                  48420003
484300* -------------------------------------------------------------- *48430099
484400 9020-PO-RECEIVER-CONTENTS.                                       48440099
484500                                                                  48450099
484600     INITIALIZE PV-PO-RECEIVER-CONTENTS.                          48460099
484700                                                                  48470099
484800     MOVE RC821-PO-RECEIVER-CONTENTS TO PV-PO-RECEIVER-CONTENTS.  48480099
484900                                                                  48490099
485000*    DISPLAY ' '                                                  48500099
485100*    DISPLAY ' '                                                  48510099
485200*    DISPLAY '------------------------------------------------'   48520099
485300*    DISPLAY '         START OF RCWS821 DISPLAY FIELDS        '   48530099
485400*    DISPLAY ' '                                                  48540099
485500*    DISPLAY '              PO RECEIVER CONTENTS      '           48550099
485600*    DISPLAY '------------------------------------------------'   48560099
485700*    DISPLAY ' '                                                  48570099
485800*    DISPLAY 'ORD NBR               : ' PV-ORD-NBR.               48580099
485900*    DISPLAY 'OPER UNT ID           : ' PV-OPER-UNT-ID.           48590099
486000*    DISPLAY 'FCLTY ID              : ' PV-FCLTY-ID.              48600099
486100*    DISPLAY 'REC SEQ NBR           : ' PV-REC-SEQ-NBR.           48610099
486200*    DISPLAY 'IMPRT PO IND          : ' PV-IMPRT-PO-IND.          48620099
486300*    DISPLAY 'NEW STR IND           : ' PV-NEW-STR-IND.           48630099
486400*    DISPLAY 'REC COUNT             : ' PV-REC-COUNT.             48640099
486500*    DISPLAY 'TROUBLE SHORT CNT     : ' PV-REC-TROUBLE-SHORT-CNT. 48650099
486600*    DISPLAY 'TROUBLE DCPACK CNT    : ' PV-REC-TROUBLE-DCPACK-CNT.48660099
486700*    DISPLAY 'RMS PO IND            : ' PV-RMS-PO-IND.            48670099
486800*    DISPLAY 'DEPT NBR              : ' PV-DEPT-NBR.              48680099
486900*    DISPLAY 'PKGNG CDE             : ' PV-PKGNG-CDE.             48690099
487000*    DISPLAY 'PACK BY STORE IND     : ' PV-PACK-BY-STORE-IND.     48700099
487100*    DISPLAY 'OTR SCOPE IND         : ' PV-OTR-SCOPE-IND.         48710099
487200*    DISPLAY 'PO TYP CDE            : ' PV-PO-TYP-CDE.            48720099
487300*    DISPLAY 'PLAN NBR              : ' PV-PLAN-NBR.              48730099
487400                                                                  48740099
487500     MOVE PV-CURR-SPLIT-QTY          TO PV-DISPLY-QTY.            48750099
487600*    DISPLAY 'CURR SPLIT QTY        : ' PV-DISPLY-QTY.            48760099
487700                                                                  48770099
487800*    DISPLAY 'PK SIZE RND CDE       : ' PV-PK-SIZE-RND-CDE.       48780099
487900                                                                  48790099
488000     MOVE PV-ALLOC-OUTR-PK-QTY       TO PV-DISPLY-QTY.            48800099
488100*    DISPLAY 'ALLOC OUTR PK QTY     : ' PV-DISPLY-QTY.            48810099
488200*    DISPLAY ' '.                                                 48820099
488300                                                                  48830099
488400     MOVE PV-SUM-STR-PLAN-QTY            TO PV-DISPLY-QTY.        48840099
488500*    DISPLAY 'SUM STR PLAN QTY      : '     PV-DISPLY-QTY.        48850099
488600                                                                  48860099
488700     MOVE PV-SUM-STR-OTR-QTY             TO PV-DISPLY-QTY.        48870099
488800*    DISPLAY 'SUM STR OTR QTY       : '     PV-DISPLY-QTY.        48880099
488900                                                                  48890099
489000     MOVE PV-SUM-STR-DISTRO-OTR-QTY      TO PV-DISPLY-QTY.        48900099
489100*    DISPLAY 'SUM STR DISTRO OTR QTY: '     PV-DISPLY-QTY.        48910099
489200                                                                  48920099
489300     MOVE PV-SUM-STR-PLAN-PK             TO PV-DISPLY-QTY.        48930099
489400*    DISPLAY 'SUM STR PLAN PK       : '     PV-DISPLY-QTY.        48940099
489500                                                                  48950099
489600     MOVE PV-SUM-STR-OTR-PK              TO PV-DISPLY-QTY.        48960099
489700*    DISPLAY 'SUM STR OTR PK        : '     PV-DISPLY-QTY.        48970099
489800                                                                  48980099
489900     MOVE PV-SUM-STR-DISTRO-OTR-PK       TO PV-DISPLY-QTY.        48990099
490000*    DISPLAY 'SUM STR DISTRO OTR PK : '     PV-DISPLY-QTY.        49000099
490100                                                                  49010099
490200*    DISPLAY ' '.                                                 49020099
490300*    DISPLAY 'VALID DISTRO IND      : ' PV-VALID-DISTRO-IND.      49030099
490400*    DISPLAY 'NO TALLPLN DISTRO IND : ' PV-NO-TALLPLN-DISTRO-IND. 49040099
490500*    DISPLAY 'NO TMESTDS DISTRO IND : ' PV-NO-TMESTDS-DISTRO-IND. 49050099
490600*    DISPLAY 'BAD PACK DISTRO IND   : ' PV-BAD-PACK-DISTRO-IND.   49060099
490700*    DISPLAY 'OVER PRORATE CDE      : ' PV-OVER-PRORATE-CDE.      49070099
490800*    DISPLAY 'SHORT PRORATE CDE     : ' PV-SHORT-PRORATE-CDE.     49080099
490900*    DISPLAY 'SHORT USE EX RULE IND : ' PV-SHORT-USE-EX-RULES-IND.49090099
491000*    DISPLAY 'OVER SHORT CDE        : ' PV-OVER-SHORT-CDE.        49100099
491100*    DISPLAY 'TYPE CODE             : ' PV-TYPE-CODE.             49110099
491200*    DISPLAY 'DC NMBR               : ' PV-DC-NMBR.               49120099
491300*    DISPLAY 'DC RCT STA DTE        : ' PV-DC-RCT-STA-DTE.        49130099
491400*    DISPLAY 'DC RCT STO DTE        : ' PV-DC-RCT-STO-DTE.        49140099
491500*    DISPLAY 'STR COUNT             : ' PV-STR-COUNT.             49150099
491600*    DISPLAY 'ITEM COUNT            : ' PV-ITEM-COUNT.            49160099
491700                                                                  49170099
491800     MOVE RC821-LNE-ODU-TOL-QTY         TO PV-DISPLY-QTY          49180099
491900*    DISPLAY 'LNE ODU TOL QTY       : ' PV-DISPLY-QTY.            49190099
492000                                                                  49200099
492100     MOVE RC821-LNE-ODU-TOL-AMT         TO PV-DISPLY-AMT          49210099
492200*    DISPLAY 'LNE ODU TOL AMT       : ' PV-DISPLY-AMT.            49220099
492300                                                                  49230099
492400     MOVE RC821-PREPK-ODU-TOL-QTY       TO PV-DISPLY-QTY          49240099
492500*    DISPLAY 'PREPK ODU TOL QTY     : ' PV-DISPLY-QTY.            49250099
492600                                                                  49260099
492700     MOVE RC821-PREPK-ODU-TOL-AMT       TO PV-DISPLY-AMT.         49270099
492800*    DISPLAY 'PREPK ODU TOL AMT     : ' PV-DISPLY-AMT.            49280099
492900                                                                  49290099
493000*    DISPLAY 'DAYS PR CHG NBR       : ' PV-DAYS-PR-CHG-NBR.       49300099
493100                                                                  49310099
493200* -------------------------------------------------------------- *49320099
493300* -------------------------------------------------------------- *49330099
493400 9040-REC-PACK.                                                   49340099
493500                                                                  49350099
493600*    DISPLAY ' '                                                  49360099
493700*    DISPLAY ' '                                                  49370099
493800*    DISPLAY '------------------------------------------------'   49380099
493900*    DISPLAY '                    REC PACK                    '   49390099
494000*    DISPLAY '------------------------------------------------'   49400099
494100*    DISPLAY ' '                                                  49410099
494200*    DISPLAY 'PACK UPC NBR          : '   RC821-PACK-UPC-NBR.     49420099
494300*    DISPLAY 'PACK SKU NBR          : '   RC821-PACK-SKU-NBR.     49430099
494400*    DISPLAY 'PREPK ID              : '   RC821-PREPK-ID.         49440099
494500*    DISPLAY 'PREPK TYPE CDE        : '   RC821-PREPK-TYPE-CDE.   49450099
494600                                                                  49460099
494700     MOVE RC821-INPK-UNT-QTY           TO PV-DISPLY-QTY.          49470099
494800*    DISPLAY 'INPK UNT QTY          : '   PV-DISPLY-QTY.          49480099
494900                                                                  49490099
495000     MOVE RC821-OTPK-UNT-QTY           TO PV-DISPLY-QTY.          49500099
495100*    DISPLAY 'OTPK UNT QTY          : '   PV-DISPLY-QTY.          49510099
495200                                                                  49520099
495300*    DISPLAY 'REC DRV LNE NBR       : '   RC821-REC-DRV-LNE-NBR.  49530099
495400                                                                  49540099
495500     MOVE RC821-TOTAL-ODD-UNITS        TO PV-DISPLY-QTY.          49550099
495600*    DISPLAY 'TOTAL ODD UNITS       : '   PV-DISPLY-QTY.          49560099
495700                                                                  49570099
495800                                                                  49580099
495900* -------------------------------------------------------------- *49590099
496000* -------------------------------------------------------------- *49600099
496100                                                                  49610099
496200 9050-STORE-COMPONENTS.                                           49620099
496300                                                                  49630099
496400     SET PV-STORE-IDX TO RC821-STORE-IDX.                         49640099
496500                                                                  49650099
496600     INITIALIZE PV-STORE-DETAIL.                                  49660099
496700                                                                  49670099
496800     MOVE RC821-STORE-ARRAY (RC821-STORE-IDX) TO PV-STORE-DETAIL. 49680099
496900                                                                  49690099
497000*    DISPLAY ' '                                                  49700099
497100*    DISPLAY ' '                                                  49710099
497200*    DISPLAY '------------------------------------------------'   49720099
497300*    DISPLAY '                STORE COMPONENTS                '   49730099
497400*    DISPLAY '------------------------------------------------'   49740099
497500*    DISPLAY ' '                                                  49750099
497600*    DISPLAY 'STORE INDEX           : ' PV-STORE-IDX.             49760099
497700*    DISPLAY ' '                                                  49770099
497800*    DISPLAY 'STR NBR               : ' PV-STR-NBR.               49780099
497900*    DISPLAY 'ALLOC LNE NBR         : ' PV-ALLOC-LNE-NBR.         49790099
498000*    DISPLAY 'OPENED DATE           : ' PV-OPENED-DATE.           49800099
498100*    DISPLAY 'CLOSED DATE           : ' PV-CLOSED-DATE.           49810099
498200*    DISPLAY 'EXISTING STORE CODE   : ' PV-EXISTING-STORE-CDE.    49820099
498300*    DISPLAY 'ST TYPE CODE          : ' PV-ST-TYPE-CODE.          49830099
498400*    DISPLAY 'ST DC1 NMBR           : ' PV-ST-DC1-NMBR.           49840099
498500*    DISPLAY 'ST DC1 RCT STA DTE    : ' PV-ST-DC1-RCT-STA-DTE.    49850099
498600*    DISPLAY 'ST DC1 RCT STO DTE    : ' PV-ST-DC1-RCT-STO-DTE.    49860099
498700*    DISPLAY 'ST DC2 NMBR           : ' PV-ST-DC2-NMBR.           49870099
498800*    DISPLAY 'ST DC2 RCT STA DTE    : ' PV-ST-DC2-RCT-STA-DTE.    49880099
498900*    DISPLAY 'ST DC2 RCT STO DTE    : ' PV-ST-DC2-RCT-STO-DTE.    49890099
499000*    DISPLAY 'STR VAL OOR IND       : ' PV-STR-VAL-OOR-IND.       49900099
499100*    DISPLAY 'STR GOOD PLAN IND     : ' PV-STR-GOOD-PLAN-IND.     49910099
499200*    DISPLAY 'RNK SEQ NBR           : ' PV-RNK-SEQ-NBR.           49920099
499300*    DISPLAY ' '                                                  49930099
499400                                                                  49940099
499500     MOVE PV-STR-OTR-QTY                TO PV-DISPLY-QTY.         49950099
499600*    DISPLAY 'STR OTR QTY           : '    PV-DISPLY-QTY.         49960099
499700                                                                  49970099
499800     MOVE PV-STR-DIST-QTY               TO PV-DISPLY-QTY.         49980099
499900*    DISPLAY 'STR DISTRO QTY        : '    PV-DISPLY-QTY.         49990099
500000                                                                  50000099
500100     MOVE PV-STR-DIST-OTR-QTY           TO PV-DISPLY-QTY.         50010099
500200*    DISPLAY 'STR DISTRO OTR QTY    : '    PV-DISPLY-QTY.         50020099
500300                                                                  50030099
500400*    DISPLAY 'STR OTR QTY-X         : '    PV-STR-OTR-QTY-X.      50040099
500500*    DISPLAY 'STR DISTRO QTY-X      : '    PV-STR-DIST-QTY-X.     50050099
500600*    DISPLAY 'STR DISTRO OTR QTY-X  : '    PV-STR-DIST-OTR-QTY-X  50060099
500700                                                                  50070099
500800     MOVE PV-STR-OTR-PK                 TO PV-DISPLY-QTY.         50080099
500900*    DISPLAY 'STR OTR PK            : '    PV-DISPLY-QTY.         50090099
501000                                                                  50100099
501100     MOVE PV-STR-DIST-PK                TO PV-DISPLY-QTY.         50110099
501200*    DISPLAY 'STR DISTRO PK         : '    PV-DISPLY-QTY.         50120099
501300                                                                  50130099
501400     MOVE PV-STR-DIST-OTR-PK            TO PV-DISPLY-QTY.         50140099
501500*    DISPLAY 'STR DISTRO OTR PK     : '    PV-DISPLY-QTY.         50150099
501600                                                                  50160099
501700                                                                  50170099
501800* -------------------------------------------------------------- *50180099
501900* -------------------------------------------------------------- *50190099
502000                                                                  50200099
502100 9060-ITEM-COMPONENTS.                                            50210099
502200                                                                  50220099
502300     SET PV-ITEM-IDX TO RC821-ITEM-IDX.                           50230099
502400                                                                  50240099
502500     INITIALIZE PV-REC-COMPONENTS.                                50250099
502600                                                                  50260099
502700     MOVE RC821-REC-COMPONENTS (RC821-ITEM-IDX)                   50270099
502800       TO PV-REC-COMPONENTS.                                      50280099
502900                                                                  50290099
503000*    DISPLAY ' '                                                  50300099
503100*    DISPLAY ' '                                                  50310099
503200*    DISPLAY '------------------------------------------------'   50320099
503300*    DISPLAY '                 REC COMPONENTS                 '   50330099
503400*    DISPLAY '------------------------------------------------'   50340099
503500*    DISPLAY ' '                                                  50350099
503600*    DISPLAY 'ITEM INDEX            : ' PV-ITEM-IDX.              50360099
503700*    DISPLAY ' '                                                  50370099
503800*    DISPLAY 'REC LNE NBR           : ' PV-REC-LNE-NBR.           50380099
503900*    DISPLAY 'REC ITEM UPC NBR      : ' PV-REC-ITEM-UPC-NBR.      50390099
504000*    DISPLAY 'REC ITEM UPC INTR ID  : ' PV-REC-ITEM-UPC-INTR-ID   50400099
504100*    DISPLAY 'REC ITEM UPC ID       : ' PV-REC-ITEM-UPC-ID.       50410099
504200*    DISPLAY 'REC SKU NBR           : ' PV-REC-SKU-NBR.           50420099
504300*    DISPLAY 'REC CLASS             : ' PV-REC-CLASS.             50430099
504400*    DISPLAY 'REC SUBCLASS          : ' PV-REC-SUBCLASS.          50440099
504500*    DISPLAY 'WEB ITEM IND          : ' PV-WEB-ITEM-IND.          50450099
504600*    DISPLAY 'REC ITEM NBR          : ' PV-REC-ITEM-NBR.          50460099
504700                                                                  50470099
504800     MOVE PV-REC-CASE-PACK-QTY       TO PV-DISPLY-QTY.            50480099
504900*    DISPLAY 'REC CASE PACK QTY     : ' PV-DISPLY-QTY.            50490099
505000                                                                  50500099
505100     MOVE PV-REC-PACK-RATO-QTY       TO PV-DISPLY-QTY.            50510099
505200*    DISPLAY 'REC PACK RATO QTY     : ' PV-DISPLY-QTY.            50520099
505300                                                                  50530099
505400     MOVE PV-REC-INNER-PACK-QTY      TO PV-DISPLY-QTY.            50540099
505500*    DISPLAY 'REC INNER PACK QTY    : ' PV-DISPLY-QTY.            50550099
505600                                                                  50560099
505700     MOVE PV-SKU-INNER-PACK-QTY      TO PV-DISPLY-QTY.            50570099
505800*    DISPLAY 'SKU INNER PACK QTY    : ' PV-DISPLY-QTY.            50580099
505900                                                                  50590099
506000     MOVE PV-ODD-UNIT-QTY            TO PV-DISPLY-QTY.            50600099
506100*    DISPLAY 'ODD UNIT QTY          : ' PV-DISPLY-QTY.            50610099
506200                                                                  50620099
506300     MOVE PV-PKSL-ITM-QTY            TO PV-DISPLY-QTY.            50630099
506400*    DISPLAY 'PKSL ITM QTY          : ' PV-DISPLY-QTY.            50640099
506500                                                                  50650099
506600     MOVE PV-DTL-CK-ITM-QTY          TO PV-DISPLY-QTY.            50660099
506700*    DISPLAY 'DTL CK ITM QTY        : ' PV-DISPLY-QTY.            50670099
506800                                                                  50680099
506900     MOVE PV-BEST-CASE-UNITS         TO PV-DISPLY-QTY.            50690099
507000*    DISPLAY 'BEST CASE UNITS       : ' PV-DISPLY-QTY.            50700099
507100                                                                  50710099
507200*    DISPLAY 'DRV LNE CDE           : ' PV-DRV-LNE-CDE.           50720099
507300                                                                  50730099
507400     MOVE PV-SK-UNT-RTL-PR-AMT       TO PV-DISPLY-AMT.            50740099
507500*    DISPLAY 'SK UNT RTL PR AMT     : ' PV-DISPLY-AMT.            50750099
507600                                                                  50760099
507700     MOVE PV-SK-GP-RTL-AMT           TO PV-DISPLY-AMT.            50770099
507800*    DISPLAY 'SK GP RTL AMT         : ' PV-DISPLY-AMT.            50780099
507900                                                                  50790099
508000     MOVE PV-SK-GP-QTY               TO PV-DISPLY-QTY.            50800099
508100*    DISPLAY 'SK GP RTL QTY         : ' PV-DISPLY-QTY.            50810099
508200                                                                  50820099
508300     MOVE PV-ITEM-DISTRO-QTY         TO PV-DISPLY-QTY.            50830099
508400*    DISPLAY 'ITEM DISTRO QTY       : ' PV-DISPLY-QTY.            50840099
508500                                                                  50850099
508600     MOVE PV-ITEM-DISTRO-OTR-QTY     TO PV-DISPLY-QTY.            50860099
508700*    DISPLAY 'ITEM DISTRO OTR QTY   : ' PV-DISPLY-QTY.            50870099
508800                                                                  50880099
508900     MOVE PV-ITEM-OTR-QTY            TO PV-DISPLY-QTY.            50890099
509000*    DISPLAY 'ITEM OTR QTY          : ' PV-DISPLY-QTY.            50900099
509100                                                                  50910099
509200                                                                  50920099
509300* -------------------------------------------------------------- *50930099
509400* -------------------------------------------------------------- *50940099
509500                                                                  50950099
509600 9070-PO-COMPONENTS.                                              50960099
509700                                                                  50970099
509800     SET PV-ITEM-IDX TO RC821-ITEM-IDX.                           50980099
509900                                                                  50990099
510000     INITIALIZE PV-PO-COMPONENTS.                                 51000099
510100                                                                  51010099
510200     MOVE RC821-PO-COMPONENTS (RC821-ITEM-IDX)                    51020099
510300       TO PV-PO-COMPONENTS.                                       51030099
510400                                                                  51040099
510500*    DISPLAY ' '                                                  51050099
510600*    DISPLAY ' '                                                  51060099
510700*    DISPLAY '------------------------------------------------'   51070099
510800*    DISPLAY '                 PO COMPONENTS                  '   51080099
510900*    DISPLAY '------------------------------------------------'   51090099
511000*    DISPLAY ' '                                                  51100099
511100*    DISPLAY 'ITEM INDEX            : ' PV-ITEM-IDX.              51110099
511200*    DISPLAY ' '                                                  51120099
511300*    DISPLAY 'PO LNE NBR            : ' PV-PO-LNE-NBR.            51130099
511400*    DISPLAY 'PO APP LNE NBR        : ' PV-APP-PO-LNE-NBR.        51140099
511500*    DISPLAY 'PO SKU NBR            : ' PV-PO-SKU-NBR.            51150099
511600*    DISPLAY 'PO CLASS              : ' PV-PO-CLASS.              51160099
511700*    DISPLAY 'PO SUBCLASS           : ' PV-PO-SUBCLASS.           51170099
511800*    DISPLAY 'PO ITEM NBR           : ' PV-PO-ITEM-NBR.           51180099
511900                                                                  51190099
512000     MOVE PV-PO-UNIT-QTY             TO PV-DISPLY-QTY.            51200099
512100*    DISPLAY 'PO UNIT QTY           : ' PV-DISPLY-QTY.            51210099
512200                                                                  51220099
512300*    DISPLAY 'PO LNE STATUS CDE     : ' PV-PO-LNE-STATUS-CDE.     51230099
512400                                                                  51240099
512500     MOVE PV-PO-PACK-RATO-QTY        TO PV-DISPLY-QTY.            51250099
512600*    DISPLAY 'PO PACK RATO QTY      : ' PV-DISPLY-QTY.            51260099
512700                                                                  51270099
512800     MOVE PV-PO-UNT-RTL-PR-AMT       TO PV-DISPLY-AMT.            51280099
512900*    DISPLAY 'PO UNT RTL PR AMT     : ' PV-DISPLY-AMT.            51290099
513000                                                                  51300099
513100     MOVE PV-PO-GP-RTL-AMT           TO PV-DISPLY-AMT.            51310099
513200*    DISPLAY 'PO GP RTL AMT         : ' PV-DISPLY-AMT.            51320099
513300                                                                  51330099
513400     MOVE PV-PO-GP-QTY               TO PV-DISPLY-QTY.            51340099
513500*    DISPLAY 'PO GP QTY             : ' PV-DISPLY-QTY.            51350099
513600                                                                  51360099
513700*    DISPLAY 'DUMMY SKU IND         : ' PV-DUMMY-SKU-IND.         51370099
513800                                                                  51380099
513900* -------------------------------------------------------------- *51390003
514000                                                                  51400003
514100******************************************************************51410018
514200*                                                                *51420018
514300*        D I S P L A Y  A B E N D  I N F O                        51430099
514400*                                                                *51440018
514500******************************************************************51450018
514600* -------------------                                             51460018
514700*    COPY RCPD001.                                                51470018
514800* -------------------                                             51480018
514900 RC001-RETURN-MSG.                                                51490018
515000                                                                  51500018
515100     MOVE SQLCODE TO RC001-SAVE-SQLCODE.                          51510018
515200                                                                  51520018
515300     EXEC SQL                                                     51530099
515400         SELECT CURRENT_DATE                                      51540099
515500              , CURRENT_TIME                                      51550099
515600         INTO  :RC001-DATE                                        51560099
515700             , :RC001-TIME                                        51570099
515800         FROM TCOCNTL                                             51580099
515900     END-EXEC.                                                    51590099
516000                                                                  51600018
516100     DISPLAY PC-CURRENT-PROGRAM-NAME                              51610099
516200     DISPLAY PV-PARAGRAPH                                         51620099
516300     MOVE PC-CURRENT-PROGRAM-NAME  TO  RC001-PREPACK-PGM-NBR.     51630099
516400     MOVE TM500-PREPACK-ERROR-NBR  TO  RC001-PREPACK-ERROR-NBR.   51640099
516500     MOVE RC821-OPER-UNT-ID        TO  RC001-OPER-UNT-ID.         51650099
516600     MOVE RC821-FCLTY-ID           TO  RC001-FCLTY-ID.            51660099
516700     MOVE RC821-ORD-NBR            TO  RC001-PO-NBR.              51670099
516800     MOVE RC821-REC-SEQ-NBR        TO  RC001-REC-SEQ-NBR.         51680099
516900     MOVE RC001-SAVE-SQLCODE       TO  RC001-SQLCODE.             51690099
517000*    -----------------------------------------                    51700099
517100*    HOST PROGRAM MOVES LINE AND STORE NUMBERS                    51710099
517200*    -----------------------------------------                    51720099
517300                                                                  51730099
517400     MOVE SPACES          TO RC001-LOG-LINE.                      51740099
517500                                                                  51750099
517600     PERFORM RC001-WRITE-DISPLAY.                                 51760099
517700                                                                  51770099
517800     MOVE PV-PARAGRAPH    TO RC001-LOG-LINE.                      51780099
517900                                                                  51790099
518000     PERFORM RC001-WRITE-DISPLAY.                                 51800099
518100                                                                  51810099
518200     MOVE RC001-LINE-00   TO RC001-LOG-LINE.                      51820099
518300                                                                  51830099
518400     PERFORM RC001-WRITE-DISPLAY.                                 51840099
518500                                                                  51850099
518600     MOVE RC001-LINE-01   TO RC001-LOG-LINE.                      51860099
518700                                                                  51870099
518800     PERFORM RC001-WRITE-DISPLAY.                                 51880099
518900                                                                  51890099
519000     MOVE RC001-LINE-02   TO RC001-LOG-LINE.                      51900099
519100                                                                  51910099
519200     PERFORM RC001-WRITE-DISPLAY.                                 51920099
519300                                                                  51930099
519400     MOVE RC001-LINE-03   TO RC001-LOG-LINE.                      51940099
519500                                                                  51950099
519600     PERFORM RC001-WRITE-DISPLAY.                                 51960099
519700                                                                  51970099
519800     MOVE RC001-LINE-04   TO RC001-LOG-LINE.                      51980099
519900                                                                  51990099
520000     PERFORM RC001-WRITE-DISPLAY.                                 52000099
520100                                                                  52010099
520200     MOVE RC001-LINE-05   TO RC001-LOG-LINE.                      52020099
520300                                                                  52030099
520400     PERFORM RC001-WRITE-DISPLAY.                                 52040099
520500*RETURN TO CALLING PROGRAM                                        52050018
520600     PERFORM 9999-GOBACK.                                         52060099
520700                                                                  52070018
520800******************************************************************52080018
520900 RC001-WRITE-DISPLAY.                                             52090099
521000                                                                  52100018
521100     DISPLAY RC001-LOG-LINE.                                      52110099
521200                                                                  52120099
521300******************************************************************52130018
521400     COPY TMPD501.                                                52140018
521500******************************************************************52150018
521600 9999-GOBACK.                                                     52160099
521700     MOVE TM500-FIELDS              TO TM500-COMMAREA             52170099
521800     MOVE TM007-COMMUNICATIONS-AREA TO LINK-TMRD007.              52180099
521900     GOBACK.                                                      52190099
