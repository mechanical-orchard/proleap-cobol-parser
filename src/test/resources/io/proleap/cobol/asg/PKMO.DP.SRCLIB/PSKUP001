000100*                                                                 01/26/88
000200*                                                                 PSKUP001
000300*                                                                    LV009
000400 IDENTIFICATION DIVISION.                                         PSKUP001
000500                                                                  PSKUP001
000600 PROGRAM-ID.          PSKUP001.                                      CL**3
000700 AUTHOR.              D FRANKLIN.                                 PSKUP001
000800 INSTALLATION.        KOHLS DEPARTMENT STORES.                    PSKUP001
000900 DATE-WRITTEN.        01/06/88.                                   PSKUP001
001000 DATE-COMPILED.                                                   PSKUP001
001100                                                                  PSKUP001
001200***************************************************************   PSKUP001
001300*       UPDATE GIFT CERTIFICATE MASTER FILE                   *   PSKUP001
001400*                                                             *   PSKUP001
001500*     THIS PROGRAM WILL ADD RECORDS TO THE END OF THE         *   PSKUP001
001600*     GIFT CERTIFICATE MASTER FILE.  THE RECORDS ADDED        *   PSKUP001
001700*     COME FROM THE GIFT CERTIFICATE FILE.  THE GIFT FILE     *   PSKUP001
001800*     WILL HAVE BOTH GIFT CERTIFICATES AND GIFT CARDS.  THE   *   PSKUP001
001900*     GIFT CARDS WILL NOT BE ADDED TO THE MASTER FILE.        *   PSKUP001
002000*     BEFORE ADDING THE RECORDS, THEY ARE REFORMATED.         *   PSKUP001
002100*                                                             *   PSKUP001
002200***************************************************************   PSKUP001
002210*  01/22/02  MICHELE RINDFLEISCH   WR#: WR23176               *           
002210*  MULTI-CHANNEL GIFT CARD CHANGES.                           *           
002220***************************************************************           
002300*                                                                 PSKUP001
002400*                                                                 PSKUP001
002500*                                                                 PSKUP001
002600 ENVIRONMENT DIVISION.                                            PSKUP001
002700*                                                                 PSKUP001
002800*                                                                 PSKUP001
002900 CONFIGURATION SECTION.                                           PSKUP001
003000                                                                  PSKUP001
003100 SOURCE-COMPUTER.     IBM-3090.                                   PSKUP001
003200 OBJECT-COMPUTER.     IBM-3090.                                   PSKUP001
003300*                                                                 PSKUP001
003400*                                                                 PSKUP001
003500 INPUT-OUTPUT SECTION.                                            PSKUP001
003600 FILE-CONTROL.                                                    PSKUP001
003700                                                                  PSKUP001
003800     SELECT GIFT-FILE                                             PSKUP001
003900         ASSIGN TO INP01.                                         PSKUP001
004000     SELECT MASTER-GIFT-FILE                                      PSKUP001
004100         ASSIGN TO UPD01.                                         PSKUP001
004200 EJECT                                                            PSKUP001
004300*                                                                 PSKUP001
004400*                                                                 PSKUP001
004500*                                                                 PSKUP001
004600 DATA DIVISION.                                                   PSKUP001
004700*                                                                 PSKUP001
004800*                                                                 PSKUP001
004900 FILE SECTION.                                                    PSKUP001
005000                                                                  PSKUP001
005100 FD  GIFT-FILE                                                    PSKUP001
005200     RECORDING MODE IS F                                          PSKUP001
005300     LABEL RECORDS ARE STANDARD                                   PSKUP001
005400     BLOCK CONTAINS 0 RECORDS                                     PSKUP001
005500     RECORD CONTAINS 50 CHARACTERS                                PSKUP001
005600     DATA RECORD IS GR-GIFT-RECORD.                               PSKUP001
005700                                                                  PSKUP001
005800 01  GR-GIFT-RECORD              PIC X(50).                       PSKUP001
005900                                                                  PSKUP001
006000 FD  MASTER-GIFT-FILE                                             PSKUP001
006100     RECORDING MODE IS F                                          PSKUP001
006200     LABEL RECORDS ARE STANDARD                                   PSKUP001
006300     BLOCK CONTAINS 0 RECORDS                                     PSKUP001
006400     RECORD CONTAINS 56 CHARACTERS                                PSKUP001
006500     DATA RECORD IS MR-MSTGIFT-RECORD.                            PSKUP001
006600                                                                  PSKUP001
006700 01  MR-MSTGIFT-RECORD           PIC X(56).                       PSKUP001
006800 EJECT                                                            PSKUP001
006900*                                                                 PSKUP001
007000*                                                                 PSKUP001
007100 WORKING-STORAGE SECTION.                                         PSKUP001
007200                                                                  PSKUP001
007300     COPY PSRD003.                                                   CL**9
007400                                                                  PSKUP001
007500     COPY PSRD002O.                                                  CL**9
007600                                                                  PSKUP001
007700 01  PS-PROGRAM-SWITCHES.                                         PSKUP001
007800     05  PS-EOF                  PIC X(1)   VALUE 'N'.            PSKUP001
007900         88  PS-END-OF-FILE                 VALUE 'Y'.            PSKUP001
008000                                                                  PSKUP001
008100 EJECT                                                            PSKUP001
008200*                                                                 PSKUP001
008300*                                                                 PSKUP001
008400*                                                                 PSKUP001
008500 PROCEDURE DIVISION.                                              PSKUP001
008600                                                                  PSKUP001
008700 A100-MAIN-MODULE.                                                PSKUP001
008800                                                                  PSKUP001
008900******************************************************************PSKUP001
009000*    OPEN ALL FILES.                                              PSKUP001
009100*    READ THE FIRST GIFT CERTIFICATE/CARD RECORD.                    CL**6
009200*    FORMAT IT AND ADD TO THE END OF THE MASTER GIFT CERTIFICATE  PSKUP001
009300*    FILE.                                                        PSKUP001
009400*    CONTINUE THIS UNTIL END OF FILE.                             PSKUP001
009500*    CLOSE FILES.                                                 PSKUP001
009600******************************************************************PSKUP001
009700                                                                  PSKUP001
009800     OPEN INPUT  GIFT-FILE.                                       PSKUP001
009900     OPEN OUTPUT MASTER-GIFT-FILE.                                PSKUP001
010000                                                                  PSKUP001
010100     PERFORM Z100-READ-GIFT-FILE.                                 PSKUP001
010200                                                                  PSKUP001
010300     PERFORM B100-FORMAT-RECORD                                      CL**6
010400         UNTIL PS-END-OF-FILE.                                       CL**6
010500                                                                  PSKUP001
010600     CLOSE GIFT-FILE                                              PSKUP001
010700           MASTER-GIFT-FILE.                                      PSKUP001
010800                                                                  PSKUP001
010900     STOP RUN.                                                    PSKUP001
011000 EJECT                                                            PSKUP001
011100 B100-FORMAT-RECORD.                                              PSKUP001
011200                                                                  PSKUP001
011300******************************************************************PSKUP001
011400*    FORMAT THE NEW MASTER GIFT CERTIFICATE RECORD AND ADD        PSKUP001
011500*    GIFT CERTIFICATES ONLY TO THE END OF THE FILE.               PSKUP001
011600*                                                                 PSKUP001
011700*    PERFORMED BY A100-MAIN-MODULE.                               PSKUP001
011800******************************************************************PSKUP001
011900                                                                  PSKUP001
012000     IF PS003-GIFT-CERT-TYPE                                      PSKUP001
012100         INITIALIZE PS002O-GIFT-RECORD                               CL**6
012200                                                                  PSKUP001
012300         MOVE PS003-GIFT-CERT-NBR                                    CL**6
012400                                 TO PS002O-GIFT-NO                   CL**6
012500         MOVE PS003-STORE-NBR    TO PS002O-STORE-NO                  CL**6
012600         MOVE PS003-OPERATOR     TO PS002O-OPERATOR                  CL**6
012700         MOVE PS003-TRANSACTION  TO PS002O-TRANSACTION               CL**6
012800         MOVE PS003-GIFT-DATE    TO PS002O-GIFT-DATE                 CL**6
012900         MOVE PS003-GIFT-TIME    TO PS002O-GIFT-TIME                 CL**6
013000         MOVE PS003-TRAN-TYPE    TO PS002O-GIFT-TYPE                 CL**8
013100         MOVE PS003-AMOUNT       TO PS002O-AMOUNT                    CL**6
013200                                                                     CL**4
013300         PERFORM Z200-WRITE-GIFT                                     CL**4
013400     END-IF.                                                      PSKUP001
013500                                                                     CL**4
013600     PERFORM Z100-READ-GIFT-FILE.                                 PSKUP001
013700                                                                  PSKUP001
013800 EJECT                                                            PSKUP001
013900 Z100-READ-GIFT-FILE.                                             PSKUP001
014000                                                                  PSKUP001
014100******************************************************************PSKUP001
014200*    READ THE GIFT CERTIFICATE/CARD FILE                          PSKUP001
014300*                                                                 PSKUP001
014400*    PERFORMED BY A100-MAIN-MODULE.                               PSKUP001
014500*    PERFORMED BY B100-FORMAT-RECORD.                             PSKUP001
014600******************************************************************PSKUP001
014700                                                                  PSKUP001
014800     READ GIFT-FILE                                               PSKUP001
014900         INTO PS003-GIFT-RECORD                                      CL**6
015000         AT END                                                   PSKUP001
015100             SET PS-END-OF-FILE TO TRUE.                          PSKUP001
015200                                                                  PSKUP001
015300 Z200-WRITE-GIFT.                                                 PSKUP001
015400                                                                  PSKUP001
015500******************************************************************PSKUP001
015600*    ADD A NEW GIFT CERTIFICATE RECORD TO THE END OF THE          PSKUP001
015700*    MASTER FILE.                                                 PSKUP001
015800*                                                                 PSKUP001
015900*    PERFORMED BY B100-FORMAT-RECORD.                             PSKUP001
016000******************************************************************PSKUP001
016100                                                                  PSKUP001
016200     WRITE MR-MSTGIFT-RECORD                                      PSKUP001
016300         FROM PS002O-GIFT-RECORD.                                    CL**6
016400 EJECT                                                            PSKUP001
