000100*-----------------------*                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300*-----------------------*                                         00030099
000400 PROGRAM-ID.    TRKCS192.                                         00040099
000500 AUTHOR.        AL PETERS.                                        00050099
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060099
000700 DATE-WRITTEN.  06/00.                                            00070099
000800 DATE-COMPILED.                                                   00080099
000900                                                                  00090099
001000*---------------------------------------------------------------* 00100099
001100*    Y192 - CONTAINER CUSTOMS LINK PROGRAM.                     * 00110099
001200*                                                               * 00120099
001300*    THIS PROGRAM GENERATES A LIST OF A PURCHASE ORDER IN A     * 00130099
001400*    CONTAINER FOR A SELECTED VOYAGE WITH THE RESPECTIVE        * 00140099
001500*    CUSTOM ENTRY ID NUMBER AND ENTRY TYPE DESCRIPTION.         * 00150099
001700*                                                               * 00170099
001800*---------------------------------------------------------------* 00180099
001801*  11/07/2003 TKMA643 - VISWA KARUTURI                          * 00182099
001802*     REMOVED LOGIC THAT PERTAINS TO COLUMNS FRGT_CHRG_AMT AND  * 00183099
001803*     CONSLR_CHRG_AMT AND ADDED MOM_POL_CDE AND MOM_POR_CDE.    * 00184099
001804*---------------------------------------------------------------* 00185099
C94517*  CHANGED 10/28/2014    BY COGNIZANT       WR: CHG0094517                
C94517*                                                                         
C94517* EXTENDED PO# FROM 7 TO 8 DIGITS WHERE NEEDED.                           
C94517*-----------------------------------------------------------------        
263697*---------------------------------------------------------------*         
263697* CHANGED 11/08/2021    BY JIM HUNTER      WR: CHG0263697                 
263697* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE             
263697* MAKING THE CALL DYNAMIC VS STATIC.                                      
263697*---------------------------------------------------------------*         
CICS  * CHANGED  1/16/2023    BY JIM HUNTER      WR: CHG0278495                 
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL                
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.               
CICS  *-----------------------------------------------------------------        
001900                                                                  00190099
002000 ENVIRONMENT DIVISION.                                            00200099
002100                                                                  00210099
002200 DATA DIVISION.                                                   00220099
002300                                                                  00230099
002400 WORKING-STORAGE SECTION.                                         00240099
002500                                                                  00250099
002600 01  DK-DB2-KEYS.                                                 00260099
002700     15  DK-CONTNR-NO                   PIC  X(12)  VALUE SPACE.  00270099
002800     15  DK-CONTNR-SEQ-NO               PIC S9(04) COMP.          00280099
002810     15  DK-CSTM-ENTRY-ID               PIC  X(12)  VALUE SPACE.  00281099
002900                                                                  00290099
003000 01  PC-PROGRAM-CONSTANTS.                                        00300099
003100     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00310099
003200                                                    'TR192A  '.   00320099
003300     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00330099
003400                                                    'TRKM192 '.   00340099
003500     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00350099
003600                                                    'TRKCS192'.   00360099
003700     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00370099
003800     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00380099
003900     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '3'.    00390099
004000     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +9      00400099
004100                                                    COMP SYNC.    00410099
004200     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00420099
004300                                                    COMP SYNC.    00430099
004400     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00440099
004500                                                    +1000000      00450099
004600                                                    COMP-3.       00460099
004700     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00470099
004800                                                    COMP SYNC.    00480099
004900     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00490099
005000                                                    COMP-3.       00500099
005100     05  PC-INIT-DATE                   PIC  X(10)  VALUE         00510099
005200                                                    '0001-01-01'. 00520099
005300     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00530099
005310     05  PC-POL                         PIC  X(03)  VALUE 'POL'.          
005320     05  PC-POR                         PIC  X(03)  VALUE 'POR'.          
005330     05  PC-A                           PIC  X(01)  VALUE 'A'.            
005340     05  PC-O                           PIC  X(01)  VALUE 'O'.            
005400                                                                  00540099
005500     05  PC-TSYMSG-NUMBERS.                                       00550099
005600         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00560099
005700         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00570099
005800         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  00580099
005900         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00590099
006000         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00600099
006100         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00610099
006200         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00620099
006300         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00630099
006400         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00640099
006500         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00650099
006600         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00660099
006700         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00670099
006800         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00680099
006900         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00690099
007000                                                                  00700099
007100 01  PS-PROGRAM-SWITCHES.                                         00710099
007200     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    00720099
007300         88  PS-NO-ERROR                            VALUE 'Y'.    00730099
007400         88  PS-ERROR                               VALUE 'N'.    00740099
007500     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    00750099
007600         88  PS-COMMAREA-VALID                      VALUE 'Y'.    00760099
007700         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    00770099
007800                                                                  00780099
007900 01  PV-PROGRAM-VARIABLES.                                        00790099
007910     05  PV-DESC                        PIC X(12)   VALUE SPACE.  00791099
008000     05  PV-SUB                         PIC S9(04)  VALUE +0      00800099
008100                                                    COMP SYNC.    00810099
008200     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      00820099
008300                                                    COMP SYNC.    00830099
008400     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      00840099
008500                                                    COMP-3.       00850099
008600     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      00860099
008700                                                    COMP-3.       00870099
008800     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      00880099
008900                                                    COMP-3.       00890099
009000     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      00900099
009100                                                    COMP-3.       00910099
009200     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      00920099
009300                                                    COMP-3.       00930099
009400     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      00940099
009500                                                    COMP-3.       00950099
009600     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      00960099
009700                                                    COMP-3.       00970099
009800     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      00980099
009900                                                    COMP SYNC.    00990099
010000     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01000099
010100                                                    COMP SYNC.    01010099
010200     05  PV-ITEM                        PIC S9(04)  VALUE +0      01020099
010300                                                    COMP SYNC.    01030099
010400     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01040099
010500                                                    COMP SYNC.    01050099
010600     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01060099
010700                                                    COMP SYNC.    01070099
010800     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01080099
010900                                                    COMP SYNC.    01090099
011000     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01100099
011100                                                    COMP SYNC.    01110099
011200     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01120099
011300                                                    COMP SYNC.    01130099
011400     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01140099
011500                                                    COMP SYNC.    01150099
011600     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01160099
011700                                                    COMP SYNC.    01170099
011800     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01180099
011900                                                    COMP SYNC.    01190099
012000     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01200099
012100                                                    COMP SYNC.    01210099
012200     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01220099
012300                                                    COMP SYNC.    01230099
012400     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01240099
012500                                                    COMP SYNC.    01250099
012600     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      01260099
012700                                                    COMP SYNC.    01270099
012800     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01280099
012900                                                    COMP SYNC.    01290099
013000     05  PV-TAUCNTK-CNT                 PIC S9(04)  VALUE +0      01300099
013100                                                    COMP SYNC.    01310099
013200     05  PV-TIMCNTK-CNT                 PIC S9(04)  VALUE +0      01320099
013300                                                    COMP SYNC.    01330099
013400     05  PV-TRN-CNT                     PIC S9(04)  VALUE +0      01340099
013500                                                    COMP SYNC.    01350099
013510     05  PV-PO-NBR                      PIC S9(09)  COMP.         01351099
013520                                                                  01352099
013530     05  PV-HOLD-ORGN-CDE               PIC X(05)   VALUE SPACES.         
013540     05  PV-HOLD-ORGN-TYP-CDE           PIC X(03)   VALUE SPACES.         
013550     05  PV-HOLD-TRIP-TYP-CDE           PIC X(01)   VALUE SPACES.         
013560                                                                          
013600     05  PV-SHPMT-TYPE.                                           01360099
013700         10 PV-SHPMT-FROM-CDE           PIC  X(03).               01370099
013800         10 FILLER                      PIC  X(03) VALUE ' - '.   01380099
013900         10 PV-SHPMT-TO-CDE             PIC  X(03).               01390099
014000                                                                  01400099
014100     05  PV-DATE-BREAK.                                           01410099
014200         10 FILLER                      PIC  X(02).               01420099
014300         10 PV-DB-YY                    PIC  X(02).               01430099
014400         10 FILLER                      PIC  X(01).               01440099
014500         10 PV-DB-MM                    PIC  X(02).               01450099
014600         10 FILLER                      PIC  X(01).               01460099
014700         10 PV-DB-DD                    PIC  X(02).               01470099
014800                                                                  01480099
014900     05 PV-DATE-DISPLAY.                                          01490099
015000         10 PV-DD-MM                    PIC  X(02).               01500099
015100         10 FILLER                      PIC  X(01)  VALUE '/'.    01510099
015200         10 PV-DD-DD                    PIC  X(02).               01520099
015300         10 FILLER                      PIC  X(01)  VALUE '/'.    01530099
015400         10 PV-DD-YY                    PIC  X(02).               01540099
015500                                                                  01550099
015600*----------------------------------------------------------------*01560099
015700*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.    *01570099
015800*   THIS MUST BE THE EXACT SAME FORMAT AS THE BLOCK IN THE       *01580099
015900*   APPLICATION-SPECIFIC COMMAREA.                               *01590099
016000*----------------------------------------------------------------*01600099
016100 01  LQW-LIST-QUEUE-WORK-AREA.                                    01610099
016200     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  01620099
016300     05  LQW-ITEM-ENTRIES               OCCURS  9 TIMES           01630099
016400                                        INDEXED BY LQW-IDX.       01640099
016500         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       01650099
016600         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               01660099
016700         10  LQW-SELECTED-SW            PIC  X(01).               01670099
016800             88  LQW-SELECT                         VALUE 'S'.    01680099
016900             88  LQW-DESELECT                       VALUE ' '.    01690099
017000         10  LQW-ACTION                 PIC  X(03).               01700099
017100         10  LQW-PO-NBR                 PIC S9(09) COMP.          01710099
018000                                                                  01800099
018100     EJECT                                                        01810099
018200*---------------------------------------------------------------* 01820099
018300*  RECORD LAYOUT FOR THE PO SELECTION TEMP STORAGE QUEUE.       * 01830099
018400*---------------------------------------------------------------* 01840099
018500                                                                  01850099
018600     COPY TRWS101.                                                01860099
018700                                                                  01870099
018800     EJECT                                                        01880099
018900*---------------------------------------------------------------* 01890099
019000*    MAP LAYOUT                                                 * 01900099
019100*---------------------------------------------------------------* 01910099
019200                                                                  01920099
019300     COPY TRKM192.                                                01930099
019400                                                                  01940099
019500 01  MR-OCCURS-LAYOUT                   REDEFINES  TR192AO.       01950099
019610     05  FILLER                         PIC X(330).               01960099
019700                                                                  01970099
019800     05  MR-SCROLL-AREA                 OCCURS  9 TIMES.          01980099
019900         10  MR-SELECTL                 PIC S9(04) COMP.          01990099
020000         10  MR-SELECTA                 PIC  X(01).               02000099
020100         10  MR-SELECTC                 PIC  X(01).               02010099
020200         10  MR-SELECTH                 PIC  X(01).               02020099
020300         10  MR-SELECTI                 PIC  X(01).               02030099
020400                                                                  02040099
020500         10  MR-ACTIONL                 PIC S9(04) COMP.          02050099
020600         10  MR-ACTIONA                 PIC  X(01).               02060099
020700         10  MR-ACTIONC                 PIC  X(01).               02070099
020800         10  MR-ACTIONH                 PIC  X(01).               02080099
020900         10  MR-ACTION                  PIC  X(03).               02090099
021000                                                                  02100099
021100         10  MR-PO-NBRL                 PIC S9(04) COMP.          02110099
021200         10  MR-PO-NBRA                 PIC  X(01).               02120099
021300         10  MR-PO-NBRC                 PIC  X(01).               02130099
021400         10  MR-PO-NBRH                 PIC  X(01).               02140099
C94517         10  MR-PO-NBR                  PIC  ZZZZZZZZ.            02150099
021600                                                                  02160099
021700         10  MR-PO-ENTRYL               PIC S9(04) COMP.          02170099
021800         10  MR-PO-ENTRYA               PIC  X(01).               02180099
021900         10  MR-PO-ENTRYC               PIC  X(01).               02190099
022000         10  MR-PO-ENTRYH               PIC  X(01).               02200099
022100         10  MR-PO-ENTRY                PIC  X(12).               02210099
022200                                                                  02220099
022300         10  MR-PO-DESCL                PIC S9(04) COMP.          02230099
022400         10  MR-PO-DESCA                PIC  X(01).               02240099
022500         10  MR-PO-DESCC                PIC  X(01).               02250099
022600         10  MR-PO-DESCH                PIC  X(01).               02260099
022700         10  MR-PO-DESC                 PIC  X(30).               02270099
026400                                                                  02640099
026500     05  FILLER                         PIC  X(417).              02650099
026600                                                                  02660099
026700     EJECT                                                        02670099
026800*---------------------------------------------------------------* 02680099
026900*    ATTRIBUTE SETTINGS COPYBOOK.                               * 02690099
027000*---------------------------------------------------------------* 02700099
027100                                                                  02710099
027200     COPY DPWS015.                                                02720099
027300                                                                  02730099
027400*---------------------------------------------------------------* 02740099
027500*    FUNCTION KEYS COPYBOOK.                                    * 02750099
027600*---------------------------------------------------------------* 02760099
027700                                                                  02770099
027800     COPY DPWS016.                                                02780099
027900                                                                  02790099
028000*---------------------------------------------------------------* 02800099
028100*    NUMERIC EDIT LAYOUT.                                       * 02810099
028200*---------------------------------------------------------------* 02820099
028300                                                                  02830099
028400     COPY DPWS010I.                                               02840099
028500                                                                  02850099
028600*---------------------------------------------------------------* 02860099
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 02870099
028800*---------------------------------------------------------------* 02880099
028900                                                                  02890099
029000     COPY DPWS030.                                                02900099
CICS       COPY DPWS930.                                                02910099
029200 EJECT                                                            02920099
029300*---------------------------------------------------------------* 02930099
029400*    STANDARD COMMAREA.                                         * 02940099
029500*---------------------------------------------------------------* 02950099
029600                                                                  02960099
029700     COPY DPWS020.                                                02970099
029800     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02980099
029900                                                                  02990099
030000*---------------------------------------------------------------* 03000099
030100* INTER-APPLICATION COMMAREA.                                   * 03010099
030200*   TRWS102 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 03020099
030300*             SPEC SCREEN.                                      * 03030099
030310*                                                               * 03031099
030400*   TRWS102   ARE THE OUTPUT LAYOUTS THAT WILL BE PASSED FROM   * 03040099
030500*   TRWS104   THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 03050099
030510*   TRWS113                                                     * 03051099
030600*---------------------------------------------------------------* 03060099
030700                                                                  03070099
030800         10  INTER-APPL-COMM-AREA       PIC X(200).               03080099
030900     COPY TRWS102.                                                03090099
031000     COPY TRWS104.                                                03100099
031010     COPY TRWS113.                                                03101099
031030     COPY TRWS105.                                                03103099
031100                                                                  03110099
031200*---------------------------------------------------------------* 03120099
031300*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 03130099
031400*---------------------------------------------------------------* 03140099
031500         10  ASC-SPECIFIC-COMMAREA.                               03150099
031600             15  ASC-LIST-KEYS.                                   03160099
031700                 20  ASC-KEY-CONTNR-NO               PIC  X(12).  03170099
031800                 20  ASC-KEY-CONTNR-SEQ-NO           PIC S9(04)   03180099
031900                                                          COMP.   03180199
032000                 20  ASC-KEY-PO-NBR                  PIC S9(09)   03180299
032100                                                          COMP.   03180399
032200                 20  ASC-KEY-CSTM-ENTRY-ID           PIC  X(12).  03181099
032300                 20  ASC-KEY-VSL-NAME                PIC  X(25).  03182099
032301                 20  ASC-KEY-VOY-NBR                 PIC  X(10).  03183099
032302             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                03220099
032303                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  03230099
032400                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   03240099
032500                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   03250099
032600                                                                  03260099
032700                 20  ASC-ITEM-ARRAY.                              03270099
032800                     25  ASC-ITEM-ENTRIES OCCURS  9 TIMES.        03280099
032900                         30  ASC-LIST-ITEM-NUMBER                 03290099
033000                                                     PIC S9(09)   03300099
033100                                                     COMP-3.      03310099
033200                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  03320099
033300                             88  ASC-VALID-SELECT    VALUE ' '    03330099
033400                                                           'S'    03340099
033500                                                           'B'    03350099
033600                                                           'E'.   03360099
033700                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   03370099
033800                             88  ASC-TEMP-SELECT     VALUE 'S'.   03380099
033900                             88  ASC-TEMP-BEGIN      VALUE 'B'.   03390099
034000                             88  ASC-TEMP-END        VALUE 'E'.   03400099
034100                         30  ASC-SELECTED-SW         PIC  X(01).  03410099
034200                             88  ASC-NO-SELECT       VALUE ' '.   03420099
034300                             88  ASC-SELECT          VALUE 'S'.   03430099
034400                             88  ASC-BEGIN           VALUE 'B'.   03440099
034500                             88  ASC-END             VALUE 'E'.   03450099
034600                         30  ASC-ACTION            PIC  X(03).    03460099
034700                         30  ASC-PO-NBR            PIC S9(09)     03470099
034800                                                        COMP.     03480099
034900             15  ASC-ENTRY-ID                        PIC X(12).   03631099
035000             15  ASC-ENTRY-DESC                      PIC X(30).   03633099
035100                                                                  03634099
036400             15  ASC-BLK-SUB                         PIC S9(04)   03640099
036500                                                          COMP    03650099
036600                                                          SYNC.   03660099
036700             15  ASC-ITEM-SUB                        PIC S9(04)   03670099
036800                                                          COMP    03680099
036900                                                          SYNC.   03690099
037000             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   03700099
037100                                                          COMP-3. 03710099
037200             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   03720099
037300                                                          COMP-3. 03730099
037400             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   03740099
037500                                                          COMP-3. 03750099
037600             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   03760099
037700                                                          COMP-3. 03770099
037800             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   03780099
037900                                                          COMP-3. 03790099
038000             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   03800099
038100                                                          COMP    03810099
038200                                                          SYNC.   03820099
038300             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   03830099
038400                                                          COMP-3. 03840099
038500             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   03850099
038600                                                          COMP-3. 03860099
038700             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  03870099
038800                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   03880099
038900                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   03890099
039000             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  03900099
039100                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   03910099
039200                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   03920099
039300             15  ASC-LIST-QUEUE-NAME.                             03930099
039400                 20  ASC-LIST-TERM-ID                PIC  X(04).  03940099
039500                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   03950099
039600                                                          COMP-3. 03960099
039700                 20  ASC-LIST-SEQ                    PIC  9(01).  03970099
039800             15  ASC-SEL-QUEUE-NAME.                              03980099
039900                 20  ASC-SEL-TERM-ID                 PIC  X(04).  03990099
040000                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   04000099
040100                                                          COMP-3. 04010099
040200                 20  ASC-SEL-SEQ                     PIC  9(01).  04020099
040300             15  ASC-START-ITEM-REQUEST.                          04030099
040400                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  04040099
040724                                                                  04072499
040800                                                                  04080099
040900     EJECT                                                        04090099
041000*---------------------------------------------------------------* 04100099
041100*    ABEND PROCESSING COPYBOOK.                                 * 04110099
041200*---------------------------------------------------------------* 04120099
041300                                                                  04130099
041400     COPY DPWS013.                                                04140099
041500                                                                  04150099
041600 EJECT                                                            04160099
041700*---------------------------------------------------------------* 04170099
041800*    DB2 AREA FOR TIMCNTK                                       * 04180099
041900*---------------------------------------------------------------* 04190099
042000     EXEC SQL                                                     04200099
042100          INCLUDE TIMCNTK                                         04210099
042200     END-EXEC.                                                    04220099
042300*---------------------------------------------------------------* 04230099
042400*    DB2 AREA FOR TIMCNPO                                       * 04240099
042500*---------------------------------------------------------------* 04250099
042600     EXEC SQL                                                     04260099
042700          INCLUDE TIMCNPO                                         04270099
042800     END-EXEC.                                                    04280099
042900*---------------------------------------------------------------* 04290099
043000*    DB2 AREA FOR TIMFOB                                        * 04300099
043100*---------------------------------------------------------------* 04310099
043200     EXEC SQL                                                     04320099
043300          INCLUDE TIMFOB                                          04330099
043400     END-EXEC.                                                    04340099
043500*---------------------------------------------------------------* 04350099
043600*    DB2 AREA FOR TIMPOE                                        * 04360099
043700*---------------------------------------------------------------* 04370099
043800     EXEC SQL                                                     04380099
043900          INCLUDE TIMPOE                                          04390099
044000     END-EXEC.                                                    04400099
044100*---------------------------------------------------------------* 04410099
044200*    DB2 AREA FOR TAUCNTK                                       * 04420099
044300*---------------------------------------------------------------* 04430099
044400     EXEC SQL                                                     04440099
044500          INCLUDE TAUCNTK                                         04450099
044600     END-EXEC.                                                    04460099
044601*---------------------------------------------------------------* 04461099
044602*    DB2 AREA FOR TICDVAL                                       * 04462099
044603*---------------------------------------------------------------* 04463099
044604     EXEC SQL                                                     04464099
044605          INCLUDE TICDVAL                                         04465099
044606     END-EXEC.                                                    04466099
044607*---------------------------------------------------------------* 04467099
044608*    DB2 AREA FOR TIMCSEN                                       * 04468099
044609*---------------------------------------------------------------* 04469099
044610     EXEC SQL                                                     04469199
044611          INCLUDE TIMCSEN                                         04469299
044612     END-EXEC.                                                    04469399
044613*---------------------------------------------------------------*         
044614*    DB2 AREA FOR TRT_IMPRT_ORGN                                *         
044615*---------------------------------------------------------------*         
044616     EXEC SQL                                                             
044617          INCLUDE TRT00010                                                
044618     END-EXEC.                                                            
044700*---------------------------------------------------------------* 04470099
044800*    DB2 AREA FOR COMMUNICATIONS                                * 04480099
044900*---------------------------------------------------------------* 04490099
045000     EXEC SQL                                                     04500099
045100          INCLUDE SQLCA                                           04510099
045200     END-EXEC.                                                    04520099
045300*---------------------------------------------------------------* 04530099
045400*    CURSOR WHEN PO'S IN A CONTAINER FOR A SELECTED VOYAGE.     * 04540099
045500*---------------------------------------------------------------* 04550099
045600                                                                  04560099
045700     EXEC SQL                                                     04570099
045800          DECLARE PO-CSR CURSOR                                   04580099
045900          FOR SELECT                                              04590099
046000                PO_NBR                                            04600099
046100              , PO_RCVD_DELY_TMST                                 04610099
046200              , PO_UNT_QTY                                        04620099
046300              , PO_CART_CNT                                       04630099
046400              , PO_CBMT_QTY                                       04640099
046500              , PO_WT_KGRM_QTY                                    04650099
046600              , PO_C_O_PROD_CDE                                   04660099
046900          FROM                                                    04690099
047000                TIMCNPO                                           04700099
047100          WHERE                                                   04710099
047200                CONTNR_ID      = :DK-CONTNR-NO AND                04720099
047300                CONTNR_SEQ_NBR = :DK-CONTNR-SEQ-NO                04730099
047400          ORDER BY                                                04740099
047500                PO_NBR                                            04750099
047600     END-EXEC.                                                    04760099
047700                                                                  04770099
047800 EJECT                                                            04780099
047801                                                                  04780199
047802*---------------------------------------------------------------* 04780299
047803*    CURSOR DECLARATION FOR SELECTING POE CODE.                 * 04780399
047804*---------------------------------------------------------------* 04780499
047805                                                                  04780599
047806     EXEC SQL                                                     04780699
047807          DECLARE  POE-CSR CURSOR                                 04780799
047808              FOR  SELECT DISTINCT                                04780899
047809                   POE_CDE                                        04780999
047810             FROM  TIMPOE                                         04781099
047811            WHERE  POE_STD_EDI_CDE = :IMCNTK-MOM-DEST-POE-CDE     04781199
047812              AND  STAT_CDE        = 'A'                          04781299
047813         ORDER BY  POE_CDE                                        04781399
047814     END-EXEC.                                                    04781499
047815                                                                  04781599
047820 EJECT                                                            04782099
047900*----------------------------------------------------------------*04790099
048000 LINKAGE SECTION.                                                 04800099
048100                                                                  04810099
048200 01  DFHCOMMAREA.                                                 04820099
048300     05  FILLER                         OCCURS  1 TO 4072 TIMES   04830099
048400                                        DEPENDING ON EIBCALEN.    04840099
048500         10  FILLER                     PIC X.                    04850099
048600                                                                  04860099
048700 EJECT                                                            04870099
048800*----------------------------------------------------------------*04880099
048900 PROCEDURE DIVISION.                                              04890099
049000*----------------------------------------------------------------*04900099
049100*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM.  *04910099
049200*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM   *04920099
049300*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT.  *04930099
049400*----------------------------------------------------------------*04940099
049500 0000-MAIN-MODULE.                                                04950099
049600                                                                  04960099
049700     INITIALIZE DP030-CICS-API-FIELDS.                            04970099
049800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04980099
049900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04990099
050000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         05000099
050100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       05010099
050200     MOVE LENGTH OF TR192AI        TO DP030-MAP-LENGTH (1).       05020099
050300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     05030099
050400     PERFORM 0001-CALL-CICS-ARCH-API.                             05040099
050500*                                                                 05050099
050600     PERFORM 1000-CONTROL-PROCESSING                              05060099
050700*                                                                 05070099
050800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     05080099
050900     PERFORM 0001-CALL-CICS-ARCH-API.                             05090099
051000                                                                  05100099
051100*----------------------------------------------------------------*05110099
051200*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *05120099
051300*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *05130099
051400*----------------------------------------------------------------*05140099
051500 0001-CALL-CICS-ARCH-API.                                         05150099
051600                                                                  05160099
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05170099
051800                                    DFHCOMMAREA                           
051900                                    DP030-CICS-API-FIELDS                 
052000                                    DP020-STANDARD-COMMAREA               
052100                                    TR192AI.                              
052200*                                                                 05220099
052300     IF  DP030-RC-CALL-SUCCESSFUL                                 05230099
052400         CONTINUE                                                 05240099
052500     ELSE                                                         05250099
052600         SET DP013-NO-ROLLBACK                                    05260099
052700             DP013-XCTL-DISPLAY-RESTART                           05270099
052800             DP013-CICS-ABEND      TO TRUE                        05280099
052900         MOVE '0001-CALL-CICS-ARCH-API'                           05290099
053000                                   TO DP013-PARAGRAPH             05300099
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05310099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05320099
053300         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      05330099
053400         PERFORM DP013-0000-PROCESS-ABEND                         05340099
053500     END-IF.                                                      05350099
053600                                                                  05360099
053700 EJECT                                                            05370099
053800*----------------------------------------------------------------*05380099
053900* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *05390099
054000* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *05400099
054100*                                                                *05410099
054200* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *05420099
054300*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *05430099
054400*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *05440099
054500*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *05450099
054600*----------------------------------------------------------------*05460099
054700 1000-CONTROL-PROCESSING.                                         05470099
054800                                                                  05480099
054900     EVALUATE TRUE                                                05490099
055000         WHEN DP020-NEXT-ACT-INITIAL                              05500099
055100             INITIALIZE ASC-SPECIFIC-COMMAREA                     05510099
055200             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            05520099
055300                                      ASC-SEL-TERM-ID             05530099
055400             MOVE DP020-SRC-TASK-NUMBER                           05540099
055500                                   TO ASC-LIST-TASK-NUMBER        05550099
055600                                      ASC-SEL-TASK-NUMBER         05560099
055700             MOVE PC-LIST-QUEUE-SEQ                               05570099
055800                                   TO ASC-LIST-SEQ                05580099
055900             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 05590099
056000             PERFORM 1100-PROCESS-INTER-APPL-COMM                 05600099
056100*-------$TEMPLATE NOTE$------------------------------------------*05610099
056200* IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,* 05620099
056300* SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO *  05630099
056400* TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.* 05640099
056500*----------------------------------------------------------------*05650099
056600             IF  PS-COMMAREA-NOT-VALID                            05660099
056700                 SET DP020-NEXT-ACT-APPL-ERROR                    05670099
056800                                   TO TRUE                        05680099
056900             ELSE                                                 05690099
057000                 PERFORM 4000-BUILD-INITIAL-PANEL                 05700099
057100             END-IF                                               05710099
057200                                                                  05720099
057300         WHEN DP020-NEXT-ACT-READ-MAP                             05730099
057400             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        05740099
057500                                   TO PV-TOP-ITEM                 05750099
057600             PERFORM 2000-PROCESS-PANEL                           05760099
057700                                                                  05770099
057800         WHEN DP020-NEXT-ACT-RETURN                               05780099
057900             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        05790099
058000                                   TO PV-TOP-ITEM                 05800099
058100             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    05810099
058200             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 05820099
058300             MOVE ASC-KEY-CONTNR-NO                               05830099
058400                                   TO DK-CONTNR-NO                05840099
058500             MOVE ASC-KEY-CONTNR-SEQ-NO                           05850099
058600                                   TO DK-CONTNR-SEQ-NO            05860099
058700             MOVE ASC-KEY-CSTM-ENTRY-ID                           05861099
058800                                   TO DK-CSTM-ENTRY-ID            05862099
058801             MOVE PC-INQ           TO MR-ACTION (1)               05863099
058802             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05870099
058803             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05880099
058900                                                                  05890099
059000         WHEN OTHER                                               05900099
059100             SET DP013-LOGIC-ABEND TO TRUE                        05910099
059200             SET DP013-NO-ROLLBACK TO TRUE                        05920099
059300             MOVE '1000-CONTROL-PROCESSING'                       05930099
059400                                   TO DP013-PARAGRAPH             05940099
059500             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    05950099
059600                                   TO DP013-MESSAGE-TEXT(1)       05960099
059700             PERFORM DP013-0000-PROCESS-ABEND                     05970099
059800     END-EVALUATE.                                                05980099
059900                                                                  05990099
060000 EJECT                                                            06000099
060100*----------------------------------------------------------------*06010099
060200* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *06020099
060300* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *06030099
060400*----------------------------------------------------------------*06040099
060500 1100-PROCESS-INTER-APPL-COMM.                                    06050099
060600                                                                  06060099
060700     SET PS-COMMAREA-VALID         TO TRUE.                       06070099
060800     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     06080099
060900     IF  DP020-INT-APPL-FORMAT-IND = PC-LIST-FORMAT               06090099
061000         MOVE TR102-CONTNR-NO                                     06100099
061100                                   TO ASC-KEY-CONTNR-NO           06110099
061200                                      DK-CONTNR-NO                06120099
061300         MOVE TR102-CONTNR-SEQ-NO                                 06130099
061400                                   TO ASC-KEY-CONTNR-SEQ-NO       06140099
061500                                      DK-CONTNR-SEQ-NO            06150099
061600         MOVE TR102-CSTM-ENTRY-ID                                 06151099
061700                                   TO ASC-KEY-CSTM-ENTRY-ID       06152099
061800                                      DK-CSTM-ENTRY-ID            06153099
061801         MOVE TR102-PO-NBR         TO ASC-KEY-PO-NBR              06154099
061802     END-IF.                                                      06160099
061803                                                                  06170099
061804 EJECT                                                            06180099
061900*----------------------------------------------------------------*06190099
062000* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *06200099
062100* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *06210099
062200* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *06220099
062300* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *06230099
062400* FUNCTION KEYS CAN GET THIS FAR.                                *06240099
062500*----------------------------------------------------------------*06250099
062600 2000-PROCESS-PANEL.                                              06260099
062700                                                                  06270099
062800     EVALUATE TRUE                                                06280099
062900         WHEN DP020-SRC-AID = DP016-CLEAR                         06290099
063000             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    06300099
063100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06310099
063200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06320099
063300                                                                  06330099
063400         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    06340099
063500             MOVE ASC-KEY-CONTNR-NO                               06350099
063600                                   TO DK-CONTNR-NO                06360099
063700             MOVE ASC-KEY-CONTNR-SEQ-NO                           06370099
063800                                   TO DK-CONTNR-SEQ-NO            06380099
063900             MOVE ASC-KEY-CSTM-ENTRY-ID                           06381099
063901                                   TO DK-CSTM-ENTRY-ID            06382099
063902             PERFORM 2050-DELETE-LIST-QUEUE                       06390099
064000             PERFORM 4000-BUILD-INITIAL-PANEL                     06400099
064100                                                                  06410099
064200         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    06420099
064300             PERFORM 2140-DESELECT-ALL-ITEMS                      06430099
064400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06440099
064500                                                                  06450099
064600         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  06460099
064700             PERFORM 2150-SELECT-ALL-ITEMS                        06470099
064800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06480099
064900                                                                  06490099
065000         WHEN OTHER                                               06500099
065100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06510099
065200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06520099
065300             IF  PS-NO-ERROR                                      06530099
065400                 SET DP030-CONTINUE-GO                            06540099
065500                                 TO TRUE                          06550099
065600                 PERFORM 2100-CHECK-FUNCTION-KEY                  06560099
065700             ELSE                                                 06570099
065800                 SET DP030-OVERRIDE-GO                            06580099
065900                                 TO TRUE                          06590099
066000             END-IF                                               06600099
066100     END-EVALUATE.                                                06610099
066200                                                                  06620099
066300 EJECT                                                            06630099
066400*----------------------------------------------------------------*06640099
066500*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *06650099
066600*----------------------------------------------------------------*06660099
066700 2050-DELETE-LIST-QUEUE.                                          06670099
066800                                                                  06680099
066900     EXEC CICS                                                    06690099
067000         DELETEQ TS                                               06700099
067100             QUEUE (ASC-LIST-QUEUE-NAME)                          06710099
067200             RESP  (PV-CICS-RESP)                                 06720099
067300     END-EXEC.                                                    06730099
067400                                                                  06740099
067500     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       06750099
067600        (PV-CICS-RESP = DFHRESP(QIDERR))                          06760099
067700         CONTINUE                                                 06770099
067800     ELSE                                                         06780099
067900         SET DP013-CICS-ABEND      TO TRUE                        06790099
068000         SET DP013-NO-ROLLBACK     TO TRUE                        06800099
068100                                                                  06810099
068200         MOVE '2050-DELETE-LIST-QUEUE'                            06820099
068300                                   TO DP013-PARAGRAPH             06830099
068400         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    06840099
068500                                   TO DP013-MESSAGE-TEXT (1)      06850099
068600         PERFORM DP013-0000-PROCESS-ABEND                         06860099
068700     END-IF.                                                      06870099
068800                                                                  06880099
068900     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  06890099
069000                                                                  06900099
069100 EJECT                                                            06910099
069200*----------------------------------------------------------------*06920099
069300* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*06930099
069400* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *06940099
069500* CICS ARCHITECTURE API.                                         *06950099
069600*----------------------------------------------------------------*06960099
069700 2100-CHECK-FUNCTION-KEY.                                         06970099
069800                                                                  06980099
069900     EVALUATE TRUE                                                06990099
074399                                                                  07439999
074400         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               07440099
074500             IF ASC-NUMBER-OF-SELECTED-ITEMS = 1                  07440199
074600                 PERFORM 2107-PREPARE-INTER-APPL-COMM             07440399
074700             ELSE                                                 07440499
074800                 IF ASC-NUMBER-OF-SELECTED-ITEMS > 1              07440599
074900                     PERFORM 2105-SELECTION-ERROR-1               07440699
075000                 ELSE                                             07440799
075100                     IF ASC-NUMBER-OF-SELECTED-ITEMS = 0          07440899
075200                         PERFORM 2106-SELECTION-ERROR-2           07440999
075300                     END-IF                                       07441099
075400                 END-IF                                           07441199
075500             END-IF                                               07441299
075501                                                                  07441399
075502         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  07441499
075503             MOVE +1               TO PV-TOP-ITEM                 07442099
075504             MOVE ASC-KEY-CONTNR-NO                               07450099
075505                                   TO DK-CONTNR-NO                07460099
075506             MOVE ASC-KEY-CONTNR-SEQ-NO                           07470099
075507                                   TO DK-CONTNR-SEQ-NO            07480099
075508             MOVE ASC-KEY-CSTM-ENTRY-ID                           07481099
075509                                   TO DK-CSTM-ENTRY-ID            07482099
075510             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07490099
075511             PERFORM 3200-RESET-ATTRIBUTES                        07500099
075512                                                                  07511099
075513         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   07520099
075514             PERFORM 2110-BROWSE-BACKWARD                         07530099
075515             MOVE ASC-KEY-CONTNR-NO                               07540099
075516                                   TO DK-CONTNR-NO                07550099
075600             MOVE ASC-KEY-CONTNR-SEQ-NO                           07560099
075700                                   TO DK-CONTNR-SEQ-NO            07570099
075800             MOVE ASC-KEY-CSTM-ENTRY-ID                           07571099
075801                                   TO DK-CSTM-ENTRY-ID            07572099
075802             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07580099
075900             PERFORM 3200-RESET-ATTRIBUTES                        07590099
076000                                                                  07600099
076100         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   07610099
076200             PERFORM 2120-BROWSE-FORWARD                          07620099
076300             MOVE ASC-KEY-CONTNR-NO                               07630099
076400                                   TO DK-CONTNR-NO                07640099
076500             MOVE ASC-KEY-CONTNR-SEQ-NO                           07650099
076600                                   TO DK-CONTNR-SEQ-NO            07660099
076700             MOVE ASC-KEY-CSTM-ENTRY-ID                           07661099
076701                                   TO DK-CSTM-ENTRY-ID            07662099
076702             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07670099
076800                                                                  07680099
076900         WHEN DP020-SRC-AID = DP016-ENTER                         07690099
077000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   07700099
077100             IF  PS-ERROR                                         07710099
077200                 CONTINUE                                         07720099
077300             ELSE                                                 07730099
077400                 MOVE ASC-KEY-CONTNR-NO                           07740099
077500                                   TO DK-CONTNR-NO                07750099
077600                 MOVE ASC-KEY-CONTNR-SEQ-NO                       07760099
077700                                   TO DK-CONTNR-SEQ-NO            07770099
077800                 MOVE ASC-KEY-CSTM-ENTRY-ID                       07771099
077801                                   TO DK-CSTM-ENTRY-ID            07772099
077802                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07780099
077900             END-IF                                               07790099
078000                                                                  07800099
078100         WHEN OTHER                                               07810099
078200             SET DP013-NO-ROLLBACK                                07820099
078300                 DP013-XCTL-DISPLAY-RESTART                       07830099
078400                 DP013-CICS-ABEND  TO TRUE                        07840099
078500             MOVE '2100-CHECK-FUNCTION-KEY'                       07850099
078600                                   TO DP013-PARAGRAPH             07860099
078700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      07870099
078800                                   TO DP013-MESSAGE-TEXT (1)      07880099
078900             PERFORM DP013-0000-PROCESS-ABEND                     07890099
079000     END-EVALUATE.                                                07900099
079100                                                                  07910099
079200 EJECT                                                            07920099
079300*----------------------------------------------------------------*07930099
079400*  RETURN ERROR MESSAGES WHEN MORE THAN ONE ITEM WAS SELECTED.   *07940099
079500*----------------------------------------------------------------*07950099
079600 2105-SELECTION-ERROR-1.                                          07960099
079700                                                                  07970099
079800     SET DP030-OVERRIDE-GO     TO TRUE.                           07980099
079900     MOVE PC-TSYMSG-00047      TO DP020-MSG-NUMBER.               07990099
080000     SET DP020-MSG-WARNING     TO TRUE.                           08000099
080100                                                                  08010099
080200 EJECT                                                            08020099
080300*----------------------------------------------------------------*08030099
080400*  RETURN ERROR MESSAGES WHEN NO ITEM WAS SELECTED.              *08040099
080500*----------------------------------------------------------------*08050099
080600 2106-SELECTION-ERROR-2.                                          08060099
080700                                                                  08070099
080800     SET DP030-OVERRIDE-GO TO TRUE.                               08080099
080900     MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER.                   08090099
081000     SET DP020-MSG-WARNING TO TRUE.                               08100099
081100                                                                  08110099
081200*----------------------------------------------------------------*08110199
081300*  MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE    *08110299
081400*  INTER-APPLICATION COMMAREA.                                   *08110399
081500*----------------------------------------------------------------*08110499
081600 2107-PREPARE-INTER-APPL-COMM.                                    08110599
081700                                                                  08110699
081800***  INITIALIZE TR105-INTER-APPL-COMMAREA                         08110799
081900     MOVE LOW-VALUES TO TR105-INTER-APPL-COMMAREA                 08110899
082000     MOVE ASC-KEY-PO-NBR           TO TR105-PO-NBR.               08110999
082001                                                                  08111099
082002 EJECT                                                            08120099
082003*----------------------------------------------------------------*08130099
082004*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *08140099
082005*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *08150099
082006*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *08160099
082007*    MESSAGE.                                                    *08170099
082008*----------------------------------------------------------------*08180099
082009 2110-BROWSE-BACKWARD.                                            08190099
082010                                                                  08200099
082100     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    08210099
082200         GIVING PV-TOP-ITEM.                                      08220099
082300*                                                                 08230099
082400     IF  ((PV-TOP-ITEM < +1)                                      08240099
082500       OR (PV-TOP-ITEM = +1))                                     08250099
082600         MOVE +1                   TO PV-TOP-ITEM                 08260099
082700*---------- TOP OF LIST -----                                     08270099
082800         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            08280099
082900         SET DP020-MSG-INFORMATIONAL TO TRUE                      08290099
083000     END-IF.                                                      08300099
083100                                                                  08310099
083200 EJECT                                                            08320099
083300*----------------------------------------------------------------*08330099
083400*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *08340099
083500*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *08350099
083600*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *08360099
083700*----------------------------------------------------------------*08370099
083800 2120-BROWSE-FORWARD.                                             08380099
083900                                                                  08390099
084000     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              08400099
084100         GIVING PV-TOP-ITEM.                                      08410099
084200     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   08420099
084300         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            08430099
084400                                   TO PV-TOP-ITEM                 08440099
084500*---------- BOTTOM OF LIST ----------                             08450099
084600         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            08460099
084700         SET DP020-MSG-INFORMATIONAL                              08470099
084800                                   TO TRUE                        08480099
084900     ELSE                                                         08490099
085000         COMPUTE PV-BOTTOM-ITEM =                                 08500099
085100             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 08510099
085200         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            08520099
085300*------------BOTTOM OF LIST ---------                             08530099
085400             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            08540099
085500             SET DP020-MSG-INFORMATIONAL                          08550099
085600                                   TO TRUE                        08560099
085700         END-IF                                                   08570099
085800     END-IF.                                                      08580099
085900                                                                  08590099
086000 EJECT                                                            08600099
086100*----------------------------------------------------------------*08610099
086200*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *08620099
086300*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *08630099
086400*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *08640099
086500*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *08650099
086600*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *08660099
086700*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *08670099
086800*----------------------------------------------------------------*08680099
086900 2130-CHECK-FOR-JUMP-BROWSE.                                      08690099
087000                                                                  08700099
087100     SET PS-NO-ERROR               TO TRUE.                       08710099
087200     IF (ASC-START-ITEM-REQUEST = SPACE)                          08720099
087300         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            08730099
087400                                   TO PV-TOP-ITEM                 08740099
087500     ELSE                                                         08750099
087600         MOVE ASC-START-ITEM-REQUEST                              08760099
087700                                   TO DP010I-UNEDITED-FIELD       08770099
087800         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       08780099
087900         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     08790099
088000         SET DP010I-NEGATIVE-NOT-ALLOWED                          08800099
088100                                   TO TRUE                        08810099
263697         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
263697              USING DP010I-NUMERIC-EDIT-AREA                              
088300                                                                  08830099
088400         IF  NOT DP010I-ERROR-DETECTED                            08840099
088500             MOVE DP010I-NUMERIC-FIELD                            08850099
088600                                   TO  ASC-START-ITEM-REQUEST-N   08860099
088700             IF  ASC-START-ITEM-REQUEST-N > ZERO                  08870099
088800                 IF  ASC-START-ITEM-REQUEST-N >                   08880099
088900                                          ASC-NUMBER-OF-ITEMS-READ08890099
089000                     MOVE SPACE TO ASC-START-ITEM-REQUEST         08900099
089100                     COMPUTE PV-TOP-ITEM =                        08910099
089200                             ASC-NUMBER-OF-ITEMS-READ             08920099
089300                             - PC-ITEMS-PER-PANEL + 1             08930099
089400                     IF  PV-TOP-ITEM < +1                         08940099
089500                         MOVE +1   TO PV-TOP-ITEM                 08950099
089600                         MOVE PC-TSYMSG-00070                     08960099
089700                                   TO DP020-MSG-NUMBER            08970099
089800                         SET DP020-MSG-INFORMATIONAL              08980099
089900                                   TO TRUE                        08990099
090000                     END-IF                                       09000099
090100                 ELSE                                             09010099
090200                     MOVE ASC-START-ITEM-REQUEST-N                09020099
090300                                   TO PV-TOP-ITEM                 09030099
090400                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      09040099
090500                     COMPUTE PV-BOTTOM-ITEM =                     09050099
090600                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     09060099
090700                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ09070099
090800*------------------------BOTTOM OF LIST --------------            09080099
090900                         MOVE PC-TSYMSG-00070                     09090099
091000                                   TO DP020-MSG-NUMBER            09100099
091100                         SET DP020-MSG-INFORMATIONAL              09110099
091200                                   TO TRUE                        09120099
091300                     END-IF                                       09130099
091400                 END-IF                                           09140099
091500             ELSE                                                 09150099
091600*----------------VALUE OUT OF RANGE ------------------            09160099
091700                 MOVE PC-TSYMSG-00101                             09170099
091800                                   TO DP020-MSG-NUMBER            09180099
091900                 MOVE -1           TO ASTRTITL                    09190099
092000                 SET DP030-SET-CURSOR-APPL-1                      09200099
092100                                   TO TRUE                        09210099
092200                 MOVE DP015-REVERSE                               09220099
092300                                   TO ASTRTITH                    09230099
092400                 MOVE DP015-RED    TO ASTRTITC                    09240099
092500                 MOVE DP015-UNP-NUM-BRT-MDT                       09250099
092600                                   TO ASTRTITA                    09260099
092700                 SET DP020-MSG-FATAL                              09270099
092800                                   TO TRUE                        09280099
092900                 SET PS-ERROR      TO TRUE                        09290099
093000             END-IF                                               09300099
093100                                                                  09310099
093200         ELSE                                                     09320099
093300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            09330099
093400             MOVE -1               TO ASTRTITL                    09340099
093500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09350099
093600             MOVE DP015-REVERSE    TO ASTRTITH                    09360099
093700             MOVE DP015-RED        TO ASTRTITC                    09370099
093800             MOVE DP015-UNP-NUM-BRT-MDT                           09380099
093900                                   TO ASTRTITA                    09390099
094000             SET DP020-MSG-FATAL   TO TRUE                        09400099
094100             SET PS-ERROR          TO TRUE                        09410099
094200         END-IF                                                   09420099
094300     END-IF.                                                      09430099
094400                                                                  09440099
094500 EJECT                                                            09450099
094600*----------------------------------------------------------------*09460099
094700*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *09470099
094800*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *09480099
094900*----------------------------------------------------------------*09490099
095000 2140-DESELECT-ALL-ITEMS.                                         09500099
095100                                                                  09510099
095200     MOVE +1                       TO ASC-BLK-SUB.                09520099
095300                                                                  09530099
095400     PERFORM 2141-CLEAR-SELECTED-INDS                             09540099
095500         VARYING ASC-ITEM-SUB                                     09550099
095600         FROM 1 BY 1                                              09560099
095700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 09570099
095800                                                                  09580099
095900     ADD +1                        TO ASC-BLK-SUB.                09590099
096000                                                                  09600099
096100     PERFORM 2141-CLEAR-SELECTED-INDS                             09610099
096200         VARYING ASC-ITEM-SUB                                     09620099
096300         FROM 1 BY 1                                              09630099
096400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 09640099
096500                                                                  09650099
096600     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               09660099
096700                                   TO PV-LIST-ITEM-NUMBER.        09670099
096800                                                                  09680099
096900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            09690099
097000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    09700099
097100                                                                  09710099
097200     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     09720099
097300        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      09730099
097400         MOVE +1                   TO ASC-BLK-SUB                 09740099
097500                                                                  09750099
097600         PERFORM 5100-WRITE-TEMP-STORAGE                          09760099
097700                                                                  09770099
097800         MOVE +1                   TO PV-BLOCK-NUMBER             09780099
097900                                                                  09790099
098000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         09800099
098100             PV-FIRST-BLOCK-IN-ARRAY - 1                          09810099
098200                                                                  09820099
098300         PERFORM                                                  09830099
098400             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       09840099
098500                                                                  09850099
098600             PERFORM 4410-READ-TEMP-STORAGE                       09860099
098700                                                                  09870099
098800             PERFORM 2141-CLEAR-SELECTED-INDS                     09880099
098900                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 09890099
099000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          09900099
099100                                                                  09910099
099200             PERFORM 5100-WRITE-TEMP-STORAGE                      09920099
099300                                                                  09930099
099400             ADD +1                TO PV-BLOCK-NUMBER             09940099
099500                                                                  09950099
099600         END-PERFORM                                              09960099
099700                                                                  09970099
099800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         09980099
099900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     09990099
100000                                                                  10000099
100100         PERFORM                                                  10010099
100200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       10020099
100300                   ASC-HIGHEST-BLOCK-WRITTEN                      10030099
100400                                                                  10040099
100500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          10050099
100600                                   TO PV-BLOCK-NUMBER             10060099
100700                                                                  10070099
100800             PERFORM 4410-READ-TEMP-STORAGE                       10080099
100900                                                                  10090099
101000             PERFORM 2141-CLEAR-SELECTED-INDS                     10100099
101100                 VARYING ASC-ITEM-SUB                             10110099
101200                 FROM 1 BY 1                                      10120099
101300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          10130099
101400                                                                  10140099
101500             PERFORM 5100-WRITE-TEMP-STORAGE                      10150099
101600                                                                  10160099
101700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      10170099
101800                                                                  10180099
101900         END-PERFORM                                              10190099
102000                                                                  10200099
102100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             10210099
102200                                   TO PV-BLOCK-NUMBER             10220099
102300                                                                  10230099
102400         PERFORM 4410-READ-TEMP-STORAGE                           10240099
102500     END-IF.                                                      10250099
102600                                                                  10260099
102700     MOVE +0                    TO ASC-NUMBER-OF-SELECTED-ITEMS.  10270099
102800     MOVE +0                    TO ASC-START-OF-SELECTED-RANGE.   10280099
102900     MOVE +0                    TO ASC-END-OF-SELECTED-RANGE.     10290099
103000                                                                  10300099
103100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        10310099
103200                                                                  10320099
103300 EJECT                                                            10330099
103400*----------------------------------------------------------------*10340099
103500*    MARK EACH ITEM AS BEING NOT SELECTED.                       *10350099
103600*----------------------------------------------------------------*10360099
103700 2141-CLEAR-SELECTED-INDS.                                        10370099
103800                                                                  10380099
103900     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           10390099
104000             NOT EQUAL ZERO                                       10400099
104100         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          10410099
104200             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          10420099
104300                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    10430099
104400                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  10440099
104500                                   TO TRUE                        10450099
104600         END-IF                                                   10460099
104700     END-IF.                                                      10470099
104800                                                                  10480099
104900 EJECT                                                            10490099
105000*----------------------------------------------------------------*10500099
105100*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *10510099
105200*  FOR ALL ITEMS.                                                *10520099
105300*----------------------------------------------------------------*10530099
105400 2150-SELECT-ALL-ITEMS.                                           10540099
105500                                                                  10550099
105600     MOVE +1                       TO ASC-BLK-SUB.                10560099
105700                                                                  10570099
105800     PERFORM 2151-SET-SELECTED-INDS                               10580099
105900         VARYING ASC-ITEM-SUB                                     10590099
106000         FROM 1 BY 1                                              10600099
106100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 10610099
106200                                                                  10620099
106300     ADD +1                        TO ASC-BLK-SUB.                10630099
106400                                                                  10640099
106500     PERFORM 2151-SET-SELECTED-INDS                               10650099
106600         VARYING ASC-ITEM-SUB                                     10660099
106700         FROM 1 BY 1                                              10670099
106800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 10680099
106900                                                                  10690099
107000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               10700099
107100                                   TO PV-LIST-ITEM-NUMBER.        10710099
107200                                                                  10720099
107300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            10730099
107400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    10740099
107500                                                                  10750099
107600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     10760099
107700        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    10770099
107800         MOVE +1                   TO ASC-BLK-SUB                 10780099
107900                                                                  10790099
108000         PERFORM 5100-WRITE-TEMP-STORAGE                          10800099
108100                                                                  10810099
108200         MOVE +1                   TO PV-BLOCK-NUMBER             10820099
108300                                                                  10830099
108400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         10840099
108500             PV-FIRST-BLOCK-IN-ARRAY - 1                          10850099
108600                                                                  10860099
108700         PERFORM                                                  10870099
108800             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       10880099
108900                                                                  10890099
109000             PERFORM 4410-READ-TEMP-STORAGE                       10900099
109100                                                                  10910099
109200             PERFORM 2151-SET-SELECTED-INDS                       10920099
109300                 VARYING ASC-ITEM-SUB                             10930099
109400                 FROM 1 BY 1                                      10940099
109500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          10950099
109600                                                                  10960099
109700             PERFORM 5100-WRITE-TEMP-STORAGE                      10970099
109800                                                                  10980099
109900             ADD +1                TO PV-BLOCK-NUMBER             10990099
110000                                                                  11000099
110100         END-PERFORM                                              11010099
110200                                                                  11020099
110300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         11030099
110400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     11040099
110500                                                                  11050099
110600         PERFORM                                                  11060099
110700             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       11070099
110800                   ASC-HIGHEST-BLOCK-WRITTEN                      11080099
110900                                                                  11090099
111000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          11100099
111100                                   TO PV-BLOCK-NUMBER             11110099
111200                                                                  11120099
111300             PERFORM 4410-READ-TEMP-STORAGE                       11130099
111400                                                                  11140099
111500             PERFORM 2151-SET-SELECTED-INDS                       11150099
111600                 VARYING ASC-ITEM-SUB                             11160099
111700                 FROM 1 BY 1                                      11170099
111800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          11180099
111900                                                                  11190099
112000             PERFORM 5100-WRITE-TEMP-STORAGE                      11200099
112100                                                                  11210099
112200             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      11220099
112300                                                                  11230099
112400         END-PERFORM                                              11240099
112500                                                                  11250099
112600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             11260099
112700                                   TO PV-BLOCK-NUMBER             11270099
112800                                                                  11280099
112900         PERFORM 4410-READ-TEMP-STORAGE                           11290099
113000     END-IF.                                                      11300099
113100                                                                  11310099
113200                                                                  11320099
113300     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             11330099
113400                       ASC-NUMBER-OF-SELECTED-ITEMS.              11340099
113500                                                                  11350099
113600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        11360099
113700                                                                  11370099
113800 EJECT                                                            11380099
113900*----------------------------------------------------------------*11390099
114000*    MARK EACH ITEM AS BEING SELECTED.                           *11400099
114100*----------------------------------------------------------------*11410099
114200 2151-SET-SELECTED-INDS.                                          11420099
114300                                                                  11430099
114400     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           11440099
114500             NOT EQUAL ZERO                                       11450099
114600         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             11460099
114700             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             11470099
114800                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        11480099
114900                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  11490099
115000                               TO  TRUE                           11500099
115100         END-IF                                                   11510099
115200     END-IF.                                                      11520099
115300                                                                  11530099
115400 EJECT                                                            11540099
115500*----------------------------------------------------------------*11550099
115600*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *11560099
115700*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *11570099
115800*----------------------------------------------------------------*11580099
115900 2200-MOVE-SCREEN-TO-COMMAREA.                                    11590099
116000                                                                  11600099
116100     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             11610099
116200     MOVE +1                       TO PV-SUB.                     11620099
116300*                                                                 11630099
116400     PERFORM 3100-SET-SUBSCRIPTS.                                 11640099
116500     IF  ASTRTITL > ZERO                                          11650099
116600         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          11660099
116700     ELSE                                                         11670099
116800         IF  ASTRTITF = DP015-ERASE-EOF                           11680099
116900             INITIALIZE ASC-START-ITEM-REQUEST                    11690099
117000         END-IF                                                   11700099
117100     END-IF.                                                      11710099
117200     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          11720099
117300         VARYING PV-SUB                                           11730099
117400         FROM 1 BY 1                                              11740099
117500         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      11750099
117600                                                                  11760099
117700 EJECT                                                            11770099
117800*----------------------------------------------------------------*11780099
117900*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *11790099
118000*----------------------------------------------------------------*11800099
118100 2210-MOVE-LINES-TO-COMMAREA.                                     11810099
118200                                                                  11820099
118300     IF  MR-SELECTL (PV-SUB) > ZERO                               11830099
118400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             11840099
118500         MOVE MR-SELECTI (PV-SUB)                                 11850099
118600                                   TO ASC-TEMP-SELECTED-SW        11860099
118700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      11870099
118800     ELSE                                                         11880099
118900         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                11890099
119000                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     11900099
119100                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        11910099
119200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      11920099
119300         END-IF                                                   11930099
119400     END-IF.                                                      11940099
119500     ADD +1                        TO ASC-ITEM-SUB.               11950099
119600     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        11960099
119700         ADD +1                    TO ASC-BLK-SUB                 11970099
119800         MOVE +1                   TO ASC-ITEM-SUB                11980099
119900     END-IF.                                                      11990099
120000                                                                  12000099
120100 EJECT                                                            12010099
120200*----------------------------------------------------------------*12020099
120300*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *12030099
120400*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *12040099
120500*----------------------------------------------------------------*12050099
120600 3000-EDIT-DATA-IN-COMMAREA.                                      12060099
120700                                                                  12070099
120800     SET PS-NO-ERROR               TO TRUE.                       12080099
120900     PERFORM 3200-RESET-ATTRIBUTES.                               12090099
121000     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     12100099
121100*----------------------------------------------------------------*12110099
121200* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED. *            12120099
121300* EDITTING IS DONE FROM THE BOTTOM UP. *                          12130099
121400*----------------------------------------------------------------*12140099
121500     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       12150099
121600         ASC-ITEMS-DISPLAYED - 1.                                 12160099
121700     PERFORM 3100-SET-SUBSCRIPTS.                                 12170099
121800     PERFORM 3300-EDIT-SELECTIONS                                 12180099
121900         VARYING PV-SUB                                           12190099
122000         FROM PV-SUB BY -1                                        12200099
122100         UNTIL PV-SUB < +1                                        12210099
122200*                                                                 12220099
122300     IF  PS-NO-ERROR                                              12230099
122400         PERFORM 3400-CHECK-RANGE-SEQUENCE                        12240099
122500     END-IF.                                                      12250099
122600*                                                                 12260099
122700     IF  ((PS-NO-ERROR)                                           12270099
122800       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   12280099
122900       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    12290099
123000             PERFORM 3500-MARK-RANGE-AS-SELECTED                  12300099
123100     END-IF.                                                      12310099
123200                                                                  12320099
123300 EJECT                                                            12330099
123400*----------------------------------------------------------------*12340099
123500*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *12350099
123600*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*12360099
123700*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *12370099
123800*                                                                *12380099
123900*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *12390099
124000*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *12400099
124100*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *12410099
124200*    US IN THE 2ND BLOCK OF THE ARRAY.                           *12420099
124300*----------------------------------------------------------------*12430099
124400 3100-SET-SUBSCRIPTS.                                             12440099
124500                                                                  12450099
124600     COMPUTE ASC-ITEM-SUB =                                       12460099
124700         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        12470099
124800                                                                  12480099
124900     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         12490099
125000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            12500099
125100                                                                  12510099
125200         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               12520099
125300     ELSE                                                         12530099
125400         MOVE +1                     TO ASC-BLK-SUB               12540099
125500     END-IF.                                                      12550099
125600                                                                  12560099
125700 EJECT                                                            12570099
125800*----------------------------------------------------------------*12580099
125900*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *12590099
126000*----------------------------------------------------------------*12600099
126100 3200-RESET-ATTRIBUTES.                                           12610099
126200                                                                  12620099
126300     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   12630099
126400     MOVE DP015-GREEN              TO ASTRTITC.                   12640099
126500     MOVE DP015-UNDERLINE          TO ASTRTITH.                   12650099
126600*                                                                 12660099
126700     PERFORM                                                      12670099
126800         VARYING PV-SUB                                           12680099
126900         FROM 1 BY 1                                              12690099
127000         UNTIL PV-SUB > (PC-ITEMS-PER-PANEL  OR                   12700099
127100                         ASC-ITEMS-DISPLAYED)                     12710099
127200         MOVE DP015-UNP-ALP-NOR-OFF                               12720099
127300                                   TO MR-SELECTA (PV-SUB)         12730099
127400         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         12740099
127500         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         12751099
127600     END-PERFORM.                                                 12760099
127700                                                                  12770099
127800 EJECT                                                            12780099
127900*----------------------------------------------------------------*12790099
128000*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *12800099
128100*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *12810099
128200*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *12820099
128300*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *12830099
128400*----------------------------------------------------------------*12840099
128500 3300-EDIT-SELECTIONS.                                            12850099
128600                                                                  12860099
128700     EVALUATE TRUE                                                12870099
128800         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     12880099
128900             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         12890099
129000                 CONTINUE                                         12900099
129100         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         12910099
129200             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        12920099
129300                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   12930099
129400                 MOVE ASC-TEMP-SELECTED-SW                        12940099
129500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12950099
129600                                TO ASC-SELECTED-SW                12960099
129700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12970099
129800             END-IF                                               12980099
129900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     12990099
130000                 = SPACE                                          13000099
130100             EVALUATE TRUE                                        13010099
130200                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       13020099
130300                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS13030099
130400                     MOVE SPACE TO ASC-SELECTED-SW                13040099
130500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  13050099
130600                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        13060099
130700                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    13070099
130800                     MOVE SPACE TO ASC-SELECTED-SW                13080099
130900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  13090099
131000                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          13100099
131100                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      13110099
131200                     MOVE SPACE TO ASC-SELECTED-SW                13120099
131300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  13130099
131400             END-EVALUATE                                         13140099
131500         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           13150099
131600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            13160099
131700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    13170099
131800             END-IF                                               13180099
131900             PERFORM 3310-EDIT-RANGE                              13190099
132000         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             13200099
132100             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            13210099
132200                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    13220099
132300             END-IF                                               13230099
132400             PERFORM 3310-EDIT-RANGE                              13240099
132500         WHEN OTHER                                               13250099
132600             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           13260099
132700             SET DP020-MSG-FATAL    TO TRUE                       13270099
132800             MOVE -1                TO MR-SELECTL (PV-SUB)        13280099
132900             SET DP030-SET-CURSOR-APPL-1                          13290099
133000                                    TO TRUE                       13300099
133100             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        13310099
133200             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        13320099
133300             SET PS-ERROR TO TRUE                                 13330099
133400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            13340099
133500                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     13350099
133600                 MOVE SPACE         TO ASC-SELECTED-SW            13360099
133700                                        (ASC-BLK-SUB ASC-ITEM-SUB)13370099
133800             END-IF                                               13380099
133900     END-EVALUATE.                                                13390099
134000                                                                  13400099
134100     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 13410099
134200     SUBTRACT +1 FROM ASC-ITEM-SUB.                               13420099
134300     IF  ASC-ITEM-SUB < 1                                         13430099
134400         SUBTRACT +1 FROM ASC-BLK-SUB                             13440099
134500         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                13450099
134600     END-IF.                                                      13460099
134700                                                                  13470099
134800 EJECT                                                            13480099
134900*----------------------------------------------------------------*13490099
135000*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *13500099
135100*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *13510099
135200*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *13520099
135300*  THE ENDING.                                                   *13530099
135400*----------------------------------------------------------------*13540099
135500 3310-EDIT-RANGE.                                                 13550099
135600                                                                  13560099
135700     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                13570099
135800         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   13580099
135900             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)13590099
136000                                   TO ASC-SELECTED-SW             13600099
136100                                        (ASC-BLK-SUB ASC-ITEM-SUB)13610099
136200             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 13620099
136300         ELSE                                                     13630099
136400             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     13640099
136500                 CONTINUE                                         13650099
136600             ELSE                                                 13660099
136700*----------------ONLY ONE BEGINNING-OF-RANGE-ALLOWED ---          13670099
136800                 MOVE PC-TSYMSG-00054                             13680099
136900                                   TO DP020-MSG-NUMBER            13690099
137000                 SET DP020-MSG-FATAL                              13700099
137100                                   TO TRUE                        13710099
137200                 MOVE -1           TO MR-SELECTL (PV-SUB)         13720099
137300                 SET DP030-SET-CURSOR-APPL-1                      13730099
137400                                   TO TRUE                        13740099
137500                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         13750099
137600                 MOVE DP015-UNDERLINE                             13760099
137700                                   TO MR-SELECTH (PV-SUB)         13770099
137800                 SET PS-ERROR      TO TRUE                        13780099
137900             END-IF                                               13790099
138000         END-IF                                                   13800099
138100     ELSE                                                         13810099
138200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     13820099
138300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 13830099
138400                                   TO ASC-SELECTED-SW             13840099
138500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   13850099
138600             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   13860099
138700         ELSE                                                     13870099
138800             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       13880099
138900                 CONTINUE                                         13890099
139000             ELSE                                                 13900099
139100*----------------ONLY ONE END-OF-RANGE ALLOWED -------            13910099
139200                 MOVE PC-TSYMSG-00055                             13920099
139300                                   TO DP020-MSG-NUMBER            13930099
139400                 SET DP020-MSG-FATAL                              13940099
139500                                   TO TRUE                        13950099
139600                 MOVE -1           TO MR-SELECTL (PV-SUB)         13960099
139700                 SET DP030-SET-CURSOR-APPL-1                      13970099
139800                                   TO TRUE                        13980099
139900                 SET PS-ERROR      TO TRUE                        13990099
140000             END-IF                                               14000099
140100         END-IF                                                   14010099
140200     END-IF.                                                      14020099
140300                                                                  14030099
140400 EJECT                                                            14040099
140500*----------------------------------------------------------------*14050099
140600*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *14060099
140700*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *14070099
140800*----------------------------------------------------------------*14080099
140900 3400-CHECK-RANGE-SEQUENCE.                                       14090099
141000                                                                  14100099
141100     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       14110099
141200       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      14120099
141300       AND  ASC-START-OF-SELECTED-RANGE >                         14130099
141400                                         ASC-END-OF-SELECTED-RANGE14140099
141500*---------- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                14150099
141600         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 14160099
141700         SET DP020-MSG-FATAL TO TRUE                              14170099
141800         SET PS-ERROR TO TRUE                                     14180099
141900         PERFORM 3410-POSITION-AT-ERROR                           14190099
142000     END-IF.                                                      14200099
142100                                                                  14210099
142200 EJECT                                                            14220099
142300*----------------------------------------------------------------*14230099
142400*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *14240099
142500*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *14250099
142600*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *14260099
142700*----------------------------------------------------------------*14270099
142800 3410-POSITION-AT-ERROR.                                          14280099
142900                                                                  14290099
143000     SET DP030-SET-CURSOR-APPL-1                                  14300099
143100                                   TO TRUE.                       14310099
143200     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 14320099
143300                    - PV-TOP-ITEM + 1.                            14330099
143400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      14340099
143500         CONTINUE                                                 14350099
143600     ELSE                                                         14360099
143700         MOVE -1                   TO MR-SELECTL (PV-SUB)         14370099
143800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         14380099
143900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         14390099
144000     END-IF.                                                      14400099
144100*                                                                 14410099
144200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   14420099
144300                    - PV-TOP-ITEM + 1.                            14430099
144400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      14440099
144500         CONTINUE                                                 14450099
144600     ELSE                                                         14460099
144700         MOVE -1                   TO MR-SELECTL (PV-SUB)         14470099
144800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         14480099
144900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         14490099
145000     END-IF.                                                      14500099
145100                                                                  14510099
145200 EJECT                                                            14520099
145300*----------------------------------------------------------------*14530099
145400*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *14540099
145500*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *14550099
145600*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *14560099
145700*----------------------------------------------------------------*14570099
145800 3500-MARK-RANGE-AS-SELECTED.                                     14580099
145900                                                                  14590099
146000     MOVE +1                       TO  ASC-BLK-SUB.               14600099
146100     PERFORM 3510-MARK-SELECTED-INDS                              14610099
146200         VARYING ASC-ITEM-SUB                                     14620099
146300         FROM 1 BY 1                                              14630099
146400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14640099
146500                                                                  14650099
146600     ADD +1                        TO ASC-BLK-SUB.                14660099
146700     PERFORM 3510-MARK-SELECTED-INDS                              14670099
146800         VARYING ASC-ITEM-SUB                                     14680099
146900         FROM 1 BY 1                                              14690099
147000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14700099
147100                                                                  14710099
147200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14720099
147300                                   TO  PV-LIST-ITEM-NUMBER.       14730099
147400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14740099
147500         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         14750099
147600               PC-ITEMS-PER-PANEL).                               14760099
147700                                                                  14770099
147800     MOVE ASC-START-OF-SELECTED-RANGE                             14780099
147900                                   TO PV-START-OF-SELECTED-RANGE. 14790099
148000     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            14800099
148100         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  14810099
148200               PC-ITEMS-PER-PANEL).                               14820099
148300                                                                  14830099
148400     MOVE ASC-END-OF-SELECTED-RANGE                               14840099
148500                                   TO  PV-END-OF-SELECTED-RANGE.  14850099
148600     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             14860099
148700         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    14870099
148800               PC-ITEMS-PER-PANEL).                               14880099
148900     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             14890099
149000         PV-FIRST-BLOCK-IN-ARRAY + 1.                             14900099
149100                                                                  14910099
149200     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    14920099
149300        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        14930099
149400         MOVE +1                   TO ASC-BLK-SUB                 14940099
149500         PERFORM 5100-WRITE-TEMP-STORAGE                          14950099
149600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14960099
149700             PV-FIRST-BLOCK-IN-ARRAY - 1                          14970099
149800                                                                  14980099
149900         PERFORM                                                  14990099
150000             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      15000099
150100                   PV-PREV-BLOCK-IN-ARRAY                         15010099
150200             MOVE PV-FIRST-BLOCK-IN-RANGE                         15020099
150300                                   TO PV-BLOCK-NUMBER             15030099
150400             PERFORM 4410-READ-TEMP-STORAGE                       15040099
150500             PERFORM 3510-MARK-SELECTED-INDS                      15050099
150600                 VARYING ASC-ITEM-SUB                             15060099
150700                 FROM 1 BY 1                                      15070099
150800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15080099
150900             PERFORM 5100-WRITE-TEMP-STORAGE                      15090099
151000             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     15100099
151100         END-PERFORM                                              15110099
151200                                                                  15120099
151300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15130099
151400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15140099
151500         PERFORM                                                  15150099
151600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15160099
151700                   PV-LAST-BLOCK-IN-RANGE                         15170099
151800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          15180099
151900                                   TO PV-BLOCK-NUMBER             15190099
152000             PERFORM 4410-READ-TEMP-STORAGE                       15200099
152100             PERFORM 3510-MARK-SELECTED-INDS                      15210099
152200                 VARYING ASC-ITEM-SUB                             15220099
152300                 FROM 1 BY 1                                      15230099
152400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15240099
152500             PERFORM 5100-WRITE-TEMP-STORAGE                      15250099
152600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15260099
152700         END-PERFORM                                              15270099
152800                                                                  15280099
152900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15290099
153000                                   TO PV-BLOCK-NUMBER             15300099
153100         PERFORM 4410-READ-TEMP-STORAGE                           15310099
153200     END-IF.                                                      15320099
153300                                                                  15330099
153400     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 15340099
153500                                      ASC-END-OF-SELECTED-RANGE.  15350099
153600                                                                  15360099
153700 EJECT                                                            15370099
153800*----------------------------------------------------------------*15380099
153900* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *15390099
154000*----------------------------------------------------------------*15400099
154100 3510-MARK-SELECTED-INDS.                                         15410099
154200                                                                  15420099
154300     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         15430099
154400                                ASC-ITEM-SUB) >                   15440099
154500         ASC-START-OF-SELECTED-RANGE)                             15450099
154600     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         15460099
154700                                ASC-ITEM-SUB) =                   15470099
154800         ASC-START-OF-SELECTED-RANGE)                             15480099
154900                                                                  15490099
155000         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     15500099
155100                                    ASC-ITEM-SUB) <               15510099
155200             ASC-END-OF-SELECTED-RANGE)                           15520099
155300         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     15530099
155400                                    ASC-ITEM-SUB) =               15540099
155500             ASC-END-OF-SELECTED-RANGE)                           15550099
155600                                                                  15560099
155700             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          15570099
155800                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   15580099
155900                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   15590099
156000                               TO TRUE                            15600099
156100                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              15610099
156200                               TO TRUE                            15620099
156300                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    15630099
156400             END-IF                                               15640099
156500         END-IF                                                   15650099
156600     END-IF.                                                      15660099
156700                                                                  15670099
156800 EJECT                                                            15680099
156900*----------------------------------------------------------------*15690099
157000*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *15700099
157100*    INITIALIZE ALL COUNTERS AND FLAGS.                          *15710099
157200*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *15720099
157300*    DISPLAY THE PANEL TO USER.                                  *15730099
157400*----------------------------------------------------------------*15740099
157500 4000-BUILD-INITIAL-PANEL.                                        15750099
157600                                                                  15760099
157700     INITIALIZE                 ASC-BLOCK-ENTRIES (1)             15770099
157800                                ASC-BLOCK-ENTRIES (2)             15780099
157850                                                                  15785099
157900     MOVE +1                 TO ASC-BLK-SUB.                      15790099
158000     SET ASC-ITEMS-LEFT-ON-DB                                     15800099
158100                             TO TRUE.                             15810099
158200                                                                  15820099
158300     MOVE +0                 TO ASC-ITEM-SUB                      15830099
158400                                ASC-NUMBER-OF-ITEMS-READ          15840099
158500                                ASC-NUMBER-OF-SELECTED-ITEMS      15850099
158600                                ASC-HIGHEST-BLOCK-WRITTEN         15860099
158700                                ASC-START-OF-SELECTED-RANGE       15870099
158800                                ASC-END-OF-SELECTED-RANGE         15880099
158900                                ASC-ITEM-AT-TOP-OF-PANEL.         15890099
159000     PERFORM 4010-OPEN-CURSOR.                                    15900099
159100                                                                  15910099
159200     PERFORM 4300-READ-ITEMS-FROM-DB.                             15920099
159300                                                                  15930099
159400     PERFORM 4020-CLOSE-CURSOR.                                   15940099
159500                                                                  15950099
159600     PERFORM 4330-SELECT-ENTID-DESC.                              15951099
159601                                                                  15952099
159602     MOVE +1                   TO  PV-TOP-ITEM.                   15960099
159700     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          15970099
159800         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    15980099
159900         SET DP020-MSG-FATAL   TO  TRUE                           15990099
160000         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               16000099
160100     ELSE                                                         16010099
160200         MOVE -1               TO MR-SELECTL (1)                  16020099
160300         SET DP030-SET-CURSOR-APPL-1                              16030099
160400                               TO TRUE                            16040099
160500         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     16050099
160600     END-IF.                                                      16060099
160700                                                                  16070099
160800 EJECT                                                            16080099
160900*----------------------------------------------------------------*16090099
161000*   OPEN THE PO CURSOR                                           *16100099
161100*----------------------------------------------------------------*16110099
161200 4010-OPEN-CURSOR.                                                16120099
161300                                                                  16130099
162300         EXEC SQL                                                 16230099
162400              OPEN PO-CSR                                         16240099
162500         END-EXEC                                                 16250099
162600*                                                                 16260099
162700         EVALUATE TRUE                                            16270099
162800             WHEN SQLCODE = ZERO                                  16280099
162810                 CONTINUE                                         16281099
162900             WHEN SQLCODE = -904                                  16290099
162910             WHEN SQLCODE = -911                                  16291099
163000             WHEN SQLCODE = -913                                  16300099
164800         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             16301099
164900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   16302099
165000                                   TO DP013-MESSAGE-TEXT (1)      16303099
165100         MOVE SQLCA                TO DP013-SQLCA                 16304099
165200         MOVE 'TSYMSG  '           TO DP013-DB2-TABLE-NAME (1)    16305099
165300         SET DP013-DB2-ABEND                                      16306099
165400             DP013-XCTL-DISPLAY-RESTART                           16307099
165500                                   TO TRUE                        16308099
165600         PERFORM DP013-0000-PROCESS-ABEND                         16309099
165601             WHEN SQLWARN0 NOT = SPACES                           16320099
165602             WHEN SQLCODE < ZERO                                  16330099
165603             WHEN SQLCODE > ZERO                                  16340099
165604                 MOVE '4010-OPEN-CURSOR'                          16350099
165605                                   TO DP013-PARAGRAPH             16360099
165606                 MOVE 'OPEN PO CURSOR - '                         16370099
165607                                   TO DP013-MESSAGE-TEXT (1)      16380099
165608                 MOVE SQLCA        TO DP013-SQLCA                 16390099
165609                 MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)    16400099
165610                 SET DP013-DB2-ABEND                              16410099
165611                     DP013-XCTL-DISPLAY-RESTART TO TRUE           16420099
165612                 PERFORM DP013-0000-PROCESS-ABEND                 16430099
165613         END-EVALUATE.                                            16440099
165614*                                                                 16460099
165800                                                                  16580099
165900 EJECT                                                            16590099
166000*----------------------------------------------------------------*16600099
166100*   CLOSE THE PO CURSOR                                          *16610099
166200*----------------------------------------------------------------*16620099
166300 4020-CLOSE-CURSOR.                                               16630099
166400                                                                  16640099
166500     EXEC SQL                                                     16650099
166600          CLOSE PO-CSR                                            16660099
166700     END-EXEC.                                                    16670099
166800*                                                                 16680099
166900     EVALUATE TRUE                                                16690099
167000         WHEN SQLCODE = ZERO                                      16700099
167100             CONTINUE                                             16710099
167200         WHEN SQLWARN0 NOT = SPACES                               16720099
167300         WHEN SQLCODE < ZERO                                      16730099
167400         WHEN SQLCODE > ZERO                                      16740099
167500             MOVE '4020-CLOSE-CURSOR'                             16750099
167600                               TO DP013-PARAGRAPH                 16760099
167700             MOVE 'CLOSE PO CURSOR '                              16770099
167800                               TO DP013-MESSAGE-TEXT (1)          16780099
167900             MOVE SQLCA        TO DP013-SQLCA                     16790099
168000             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        16800099
168100             SET DP013-DB2-ABEND                                  16810099
168200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16820099
168300             PERFORM DP013-0000-PROCESS-ABEND                     16830099
168400     END-EVALUATE.                                                16840099
168500                                                                  16850099
168600 EJECT                                                            16860099
168700*----------------------------------------------------------------*16870099
168800*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *16880099
168900*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *16890099
169000*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *16900099
169100*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *16910099
169200*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *16920099
169300*                                                                *16930099
169400*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *16940099
169500*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *16950099
169600*    UPON INITIALIZATION.                                        *16960099
169700*----------------------------------------------------------------*16970099
169800 4300-READ-ITEMS-FROM-DB.                                         16980099
169900                                                                  16990099
170000     PERFORM                                                      17000099
170100         VARYING PV-READ-COUNT                                    17010099
170200         FROM 1 BY 1                                              17020099
170300         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    17030099
170400            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         17040099
170500                                                                  17050099
170600         PERFORM 4310-FETCH                                       17060099
170700                                                                  17070099
170800         IF  ASC-ITEMS-LEFT-ON-DB                                 17080099
170900             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                17090099
171000                 ADD +1            TO ASC-ITEM-SUB                17100099
171100             ELSE                                                 17110099
171200                 ADD +1            TO ASC-BLK-SUB                 17120099
171300                 MOVE +1           TO ASC-ITEM-SUB                17130099
171400                                                                  17140099
171500                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         17150099
171600                     MOVE +1       TO ASC-BLK-SUB                 17160099
171700                     SET ASC-BLOCK-MODIFIED (1)                   17170099
171800                                   TO TRUE                        17180099
171900                     PERFORM 5100-WRITE-TEMP-STORAGE              17190099
172000                     MOVE ASC-BLOCK-ENTRIES                       17200099
172100                               (PC-MAX-BLOCKS-IN-ARRAY)           17210099
172200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 17220099
172300                     ADD +1        TO ASC-BLK-SUB                 17230099
172400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   17240099
172500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      17250099
172600                                   TO  TRUE                       17260099
172700                 END-IF                                           17270099
172800             END-IF                                               17280099
172900             ADD +1                TO  ASC-NUMBER-OF-ITEMS-READ   17290099
173000             MOVE ASC-NUMBER-OF-ITEMS-READ                        17300099
173100                                   TO  ASC-LIST-ITEM-NUMBER       17310099
173200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 17320099
173300*            MOVE IMCNPO-PO-NBR    TO  ASC-PO-NBR                 17330099
173400*                                      (ASC-BLK-SUB ASC-ITEM-SUB) 17340099
173500*                                      PV-PO-NBR                  17341099
175600*                                                                 17560099
176800         END-IF                                                   17680099
176900     END-PERFORM.                                                 17690099
177000                                                                  17700099
177100     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          17710099
177200         MOVE +1               TO ASC-BLK-SUB                     17720099
177300         PERFORM 5100-WRITE-TEMP-STORAGE                          17730099
177400         ADD +1                TO ASC-BLK-SUB                     17740099
177500         PERFORM 5100-WRITE-TEMP-STORAGE                          17750099
177600                                                                  17760099
177700         MOVE 1                TO ASC-BLK-SUB                     17770099
177800                                  PV-BLOCK-NUMBER                 17780099
177900         PERFORM 4410-READ-TEMP-STORAGE                           17790099
178000         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             17800099
178100             MOVE 2            TO ASC-BLK-SUB                     17810099
178200                                  PV-BLOCK-NUMBER                 17820099
178300             PERFORM 4410-READ-TEMP-STORAGE                       17830099
178400         END-IF                                                   17840099
178500     END-IF.                                                      17850099
178600                                                                  17860099
178700 EJECT                                                            17870099
178800**--------------------------------------------------------------**17880099
178900**   FETCH THE PO CURSOR.                                       **17890099
179000**--------------------------------------------------------------**17900099
179100 4310-FETCH.                                                      17910099
179200                                                                  17920099
179300     EXEC SQL                                                     17930099
179400          FETCH PO-CSR                                            17940099
179500          INTO  :IMCNPO-PO-NBR                                    17950099
179600              , :IMCNPO-PO-RCVD-DELY-TMST                         17960099
179700              , :IMCNPO-PO-UNT-QTY                                17970099
179800              , :IMCNPO-PO-CART-CNT                               17980099
179900              , :IMCNPO-PO-CBMT-QTY                               17990099
180000              , :IMCNPO-PO-WT-KGRM-QTY                            18000099
180100              , :IMCNPO-PO-C-O-PROD-CDE                           18010099
180400     END-EXEC.                                                    18040099
180500                                                                  18050099
180600     EVALUATE TRUE                                                18060099
180700         WHEN SQLCODE = ZERO                                      18070099
180800         WHEN SQLCODE = +100                                      18080099
180900              CONTINUE                                            18090099
181000         WHEN SQLWARN0 NOT = SPACE                                18100099
181100         WHEN SQLCODE NOT = ZERO                                  18110099
181200              MOVE '4310-FETCH-CURSOR'                            18120099
181300                               TO DP013-PARAGRAPH                 18130099
181400              MOVE 'FETCH PO CURSOR'                              18140099
181500                               TO DP013-MESSAGE-TEXT (1)          18150099
181600              MOVE SQLCA       TO DP013-SQLCA                     18160099
181700              SET DP013-DB2-ABEND                                 18170099
181800                               TO TRUE                            18180099
181900              PERFORM DP013-0000-PROCESS-ABEND                    18190099
182000     END-EVALUATE.                                                18200099
182100                                                                  18210099
182200     IF  SQLCODE EQUAL +100                                       18220099
182300         SET ASC-NO-ITEMS-LEFT-ON-DB                              18230099
182400                                   TO TRUE                        18240099
182500     END-IF.                                                      18250099
182600                                                                  18260099
182700 EJECT                                                            18270099
182800*----------------------------------------------------------------*18280099
182900*        FORMAT THE DB2 DATE TO MM/DD/YY.                        *18290099
183000*----------------------------------------------------------------*18300099
183100 4320-FORMAT-DATE.                                                18310099
183200                                                                  18320099
183300     MOVE PV-DB-MM          TO  PV-DD-MM.                         18330099
183400     MOVE PV-DB-DD          TO  PV-DD-DD.                         18340099
183500     MOVE PV-DB-YY          TO  PV-DD-YY.                         18350099
183600                                                                  18360099
183700 EJECT                                                            18370099
183800*----------------------------------------------------------------*18371099
183900*        SELECT THE ENTRY ID AND DESCRIPTION.                     18372099
184000*----------------------------------------------------------------*18373099
184100 4330-SELECT-ENTID-DESC.                                          18374099
184200                                                                  18375099
184300     EXEC SQL                                                     18380099
184400         SELECT    A.CDVL_DESC                                    18380199
184500                  ,B.CSTM_ENTR_ID                                 18380299
184600         INTO      :ICDVAL-CDVL-DESC                              18380399
184700                  ,:IMCNPO-CSTM-ENTR-ID                           18380499
184800         FROM      TICDVAL A                                      18380599
184900                  ,TIMCNPO B                                      18380699
185000                  ,TIMCSEN C                                      18380799
185100         WHERE    B.PO_NBR       = :ASC-KEY-PO-NBR                18380899
185200           AND    B.CONTNR_ID    = :DK-CONTNR-NO                  18380999
185300           AND    B.CSTM_ENTR_ID = C.CSTM_ENTR_ID                 18381099
185400           AND    A.CDVL_CDE     = C.ENTR_TYP_CDE                 18381199
185500           AND    A.CDE_ID       = 900                            18381299
185600     END-EXEC.                                                    18381399
185700                                                                  18381499
185800     EVALUATE TRUE                                                18381599
185900         WHEN SQLCODE  = ZERO                                     18381699
186000             MOVE ICDVAL-CDVL-DESC  TO ASC-ENTRY-DESC             18381799
186100             MOVE IMCNPO-CSTM-ENTR-ID                             18381899
186200                                    TO ASC-ENTRY-ID               18381999
186300         WHEN SQLCODE  = +100                                     18382099
186400         WHEN SQLCODE  = -811                                     18382199
186500             MOVE SPACES TO ASC-ENTRY-DESC                        18382299
186600             MOVE SPACES TO ASC-ENTRY-ID                          18382499
186700         WHEN SQLWARN0 NOT = SPACE                                18382699
186800         WHEN SQLCODE NOT = ZERO                                  18382799
186900             MOVE '4330-SELECT-ENTID-DESC'                        18382899
187000                             TO DP013-PARAGRAPH                   18382999
187100             MOVE 'SQL ERROR SELECTING ENTID DESC'                18383099
187200                             TO DP013-MESSAGE-TEXT (1)            18383199
187300             MOVE SQLCA      TO DP013-SQLCA                       18383299
187400             SET DP013-DB2-ABEND                                  18383399
187500                             TO TRUE                              18383499
187600             PERFORM DP013-0000-PROCESS-ABEND                     18383599
187700     END-EVALUATE.                                                18383699
187701                                                                  18383799
187702 EJECT                                                            18383899
187703*----------------------------------------------------------------*18384099
187704* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *18390099
187705*----------------------------------------------------------------*18400099
187706 4400-MOVE-COMMAREA-TO-SCREEN.                                    18410099
187707                                                                  18420099
187708     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             18430099
187709         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          18440099
187710         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          18450099
187711             MOVE +1    TO ASC-BLK-SUB                            18460099
187712             PERFORM 5100-WRITE-TEMP-STORAGE                      18470099
187713             ADD +1     TO ASC-BLK-SUB                            18480099
187714             PERFORM 5100-WRITE-TEMP-STORAGE                      18490099
187715             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             18500099
187716                 GIVING PV-BLOCK-NUMBER                           18510099
187717                 REMAINDER PV-REMAINDER                           18520099
187718             IF  PV-REMAINDER > ZERO                              18530099
187719                 ADD +1 TO PV-BLOCK-NUMBER                        18540099
187720             END-IF                                               18550099
187721             MOVE +1    TO ASC-BLK-SUB                            18560099
187722             PERFORM 4410-READ-TEMP-STORAGE                       18570099
187723             ADD +1     TO ASC-BLK-SUB                            18580099
187724                           PV-BLOCK-NUMBER                        18590099
187725             PERFORM 4410-READ-TEMP-STORAGE                       18600099
187726     END-IF.                                                      18610099
187727     MOVE +1            TO ASC-BLK-SUB.                           18620099
187728     COMPUTE ASC-ITEM-SUB =                                       18630099
187729         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              18640099
187730         + PC-ITEMS-PER-PANEL).                                   18650099
187731*                                                                 18660099
187732     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        18670099
187733         ADD +1         TO ASC-BLK-SUB                            18680099
187734         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            18690099
187735     END-IF.                                                      18700099
187736*                                                                 18710099
187737     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           18720099
187738         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                18730099
187739     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        18740099
187740*    PERFORM 4420-FORMAT-LIST-LINES                               18750099
187741*        VARYING PV-SUB                                           18760099
187742*        FROM PC-ITEMS-PER-PANEL BY -1                            18770099
187800*        UNTIL PV-SUB < +1.                                       18780099
187900                                                                  18790099
188000     PERFORM 4421-MOVE-DESC-LINES.                                18791099
188001                                                                  18792099
188002     COMPUTE ASC-ITEMS-DISPLAYED =                                18800099
188100         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          18810099
188200     PERFORM 4401-SELECT-CONTAINER-DETAILS.                       18820099
188300     PERFORM 4402-MOVE-CONTNR-DTLS-TO-SCR.                        18830099
188400*                                                                 18840099
188500     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    18850099
188600                                      ASTRTITO.                   18860099
188700*    MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    18870099
188710     MOVE +1                       TO AENDITO.                    18871099
188800*    MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    18880099
188810     MOVE +1                       TO ATOTITO.                    18881099
188900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            18890099
189000                                   TO ASELITO.                    18900099
189100*                                                                 18910099
189200     IF  DP020-MSG-NUMBER-X = SPACE                               18920099
189300         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  18930099
189400*--------------- MORE ITEMS TO DISPLAY ----                       18940099
189500             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            18950099
189600             SET DP020-MSG-INFORMATIONAL TO TRUE                  18960099
189700         END-IF                                                   18970099
189800     END-IF.                                                      18980099
189900                                                                  18990099
190000 EJECT                                                            19000099
190100*----------------------------------------------------------------*19010099
190200*    SELECT CONTAINER DETAILS FROM TIMCNTK                       *19020099
190300*----------------------------------------------------------------*19030099
190400 4401-SELECT-CONTAINER-DETAILS.                                   19040099
190500                                                                  19050099
190600     EXEC SQL                                                     19060099
190700        SELECT  A.CONTNR_ID                                       19070099
190800              , A.SIZE_CDE                                        19080099
190900              , A.ORGN_SHPD_FR_CDE                                19090099
191000              , A.ORGN_SHPD_TO_CDE                                19100099
191100              , A.MOM_IMPRT_VEH_NM                                19110099
191200              , A.MOM_CARR_SCAC_ID                                19120099
191300              , A.CONSLR_SCAC_ID                                  19130099
191400              , A.MOM_IMPRT_TRIP_ID                               19140099
191500              , A.MOM_TRIP_TYP_CDE                                19150099
191600              , A.FDR_TRIP_TYP_CDE                                19160099
191700              , A.FDR_FOB_CDE                                     19170099
191800              , A.MOM_FOB_CDE                                     19180099
191900              , A.FDR_DPRTR_TMST                                  19190099
192000              , A.MOM_DPRTR_TMST                                  19200099
192100              , A.CART_CNT                                        19210099
192200              , A.CBMT_QTY                                        19220099
192300              , A.MOM_DEST_POE_CDE                                19230099
192400*---ATA DATA WILL COME FROM CUSTOMS LOAD -------                  19240099
192500              , A.WT_KGRM_QTY                                     19250099
192700              , A.MOM_POE_DELY_TMST                               19270099
192800              , A.UNT_QTY                                         19280099
193000              , A.EST_LBD_NM                                      19300099
193100              , A.EST_LBD_TMST                                    19310099
193200              , A.LAST_UPD_TMST                                   19320099
193210              , A.ACTL_POE_DELY_TMST                              19321099
193240              , A.MOM_POL_CDE                                             
193250              , A.FDR_POL_CDE                                             
193260              , A.MOM_POR_CDE                                             
193270              , A.FDR_POR_CDE                                             
193300        INTO  :IMCNTK-CONTNR-ID                                   19330099
193400            , :IMCNTK-SIZE-CDE                                    19340099
193500            , :IMCNTK-ORGN-SHPD-FR-CDE                            19350099
193600            , :IMCNTK-ORGN-SHPD-TO-CDE                            19360099
193700            , :IMCNTK-MOM-IMPRT-VEH-NM                            19370099
193800            , :IMCNTK-MOM-CARR-SCAC-ID                            19380099
193900            , :IMCNTK-CONSLR-SCAC-ID                              19390099
194000            , :IMCNTK-MOM-IMPRT-TRIP-ID                           19400099
194100            , :IMCNTK-MOM-TRIP-TYP-CDE                            19410099
194200            , :IMCNTK-FDR-TRIP-TYP-CDE                            19420099
194300            , :IMCNTK-FDR-FOB-CDE                                 19430099
194400            , :IMCNTK-MOM-FOB-CDE                                 19440099
194500            , :IMCNTK-FDR-DPRTR-TMST                              19450099
194600            , :IMCNTK-MOM-DPRTR-TMST                              19460099
194700            , :IMCNTK-CART-CNT                                    19470099
194800            , :IMCNTK-CBMT-QTY                                    19480099
194900            , :IMCNTK-MOM-DEST-POE-CDE                            19490099
195000*---PROVISION FOR ATA DATA -----------                            19500099
195100            , :IMCNTK-WT-KGRM-QTY                                 19510099
195300            , :IMCNTK-MOM-POE-DELY-TMST                           19530099
195400            , :IMCNTK-UNT-QTY                                     19540099
195600            , :IMCNTK-EST-LBD-NM                                  19560099
195700            , :IMCNTK-EST-LBD-TMST                                19570099
195800            , :IMCNTK-LAST-UPD-TMST                               19580099
195810            , :IMCNTK-ACTL-POE-DELY-TMST                          19581099
195840            , :IMCNTK-MOM-POL-CDE                                         
195850            , :IMCNTK-FDR-POL-CDE                                         
195860            , :IMCNTK-MOM-POR-CDE                                         
195870            , :IMCNTK-FDR-POR-CDE                                         
195900         FROM  TIMCNTK A                                          19590099
196000         WHERE CONTNR_ID      = :DK-CONTNR-NO                     19600099
196100           AND CONTNR_SEQ_NBR = :DK-CONTNR-SEQ-NO                 19610099
196200     END-EXEC.                                                    19620099
196300                                                                  19630099
196400     EVALUATE TRUE                                                19640099
196500         WHEN SQLCODE = ZERO                                      19650099
196600         WHEN SQLCODE = +100                                      19660099
196700              CONTINUE                                            19670099
196800         WHEN SQLWARN0 NOT = SPACE                                19680099
196900         WHEN SQLCODE NOT = ZERO                                  19690099
197000              MOVE '4401-SELECT-CONTAINER-DETAILS'                19700099
197100                               TO DP013-PARAGRAPH                 19710099
197200              MOVE 'SQL ERROR SELECTING CONTAINER DETAILS'        19720099
197300                               TO DP013-MESSAGE-TEXT (1)          19730099
197400              MOVE SQLCA       TO DP013-SQLCA                     19740099
197500              SET DP013-DB2-ABEND                                 19750099
197600                               TO TRUE                            19760099
197700              PERFORM DP013-0000-PROCESS-ABEND                    19770099
197800     END-EVALUATE.                                                19780099
197900                                                                  19790099
198000 EJECT                                                            19800099
198100*----------------------------------------------------------------*19810099
198200*    MOVE CONTAINER DETAILS TO SCREEN.                           *19820099
198300*----------------------------------------------------------------*19830099
198400 4402-MOVE-CONTNR-DTLS-TO-SCR.                                    19840099
198500                                                                  19850099
198600     MOVE IMCNTK-CONTNR-ID         TO ACNTRNOO.                   19860099
198700     MOVE IMCNTK-SIZE-CDE          TO ASIZEO.                     19870099
198800     MOVE IMCNTK-MOM-IMPRT-VEH-NM  TO ASC-KEY-VSL-NAME            19880099
198900                                      AVSNMO.                     19890099
199000     MOVE IMCNTK-MOM-CARR-SCAC-ID  TO ACRSCACO.                   19900099
199100     MOVE IMCNTK-CONSLR-SCAC-ID    TO ACNSCACO.                   19910099
199200     MOVE IMCNTK-MOM-IMPRT-TRIP-ID TO ASC-KEY-VOY-NBR             19920099
199300                                      AVYNOO.                     19930099
199400     MOVE IMCNTK-CART-CNT          TO ACTNO.                      19940099
199500     MOVE IMCNTK-CBMT-QTY          TO ACBMO.                      19950099
199600     MOVE IMCNTK-WT-KGRM-QTY       TO AKGSO.                      19960099
199800     PERFORM 4408-SELECT-TAUCNTK-CNT.                             19980099
199900     PERFORM 4409-SELECT-TIMCNTK-CNT.                             19990099
200000     ADD  PV-TAUCNTK-CNT PV-TIMCNTK-CNT                           20000099
200100     GIVING  PV-TRN-CNT.                                          20010099
200200     MOVE PV-TRN-CNT               TO ATRNCNTO.                   20020099
200300     MOVE IMCNTK-UNT-QTY           TO AUNITSO.                    20030099
200500     MOVE IMCNTK-ORGN-SHPD-FR-CDE  TO PV-SHPMT-FROM-CDE.          20050099
200600     MOVE IMCNTK-ORGN-SHPD-TO-CDE  TO PV-SHPMT-TO-CDE.            20060099
200700     MOVE PV-SHPMT-TYPE            TO ASHPTYPO.                   20070099
200800     MOVE IMCNTK-EST-LBD-NM (1:18) TO ALBDNMO.                    20080099
200900                                                                  20090099
201000     PERFORM 4403-FOB-CDE-CHECK.                                  20100099
201100                                                                  20110099
201200     PERFORM 4406-POE-CDE-CHECK.                                  20120099
201201                                                                          
201210     IF IMCNTK-FDR-TRIP-TYP-CDE = SPACES                                  
201220         MOVE IMCNTK-MOM-TRIP-TYP-CDE TO PV-HOLD-TRIP-TYP-CDE             
201230         MOVE IMCNTK-MOM-POR-CDE TO PV-HOLD-ORGN-CDE                      
201240         MOVE PC-POR TO PV-HOLD-ORGN-TYP-CDE                              
201250         PERFORM 4440-EDIT-ORGN-CDE                                       
201260         MOVE TRT00010-IMPRT-ORGN-CDE TO AMPORO                           
201270         MOVE IMCNTK-MOM-POL-CDE TO PV-HOLD-ORGN-CDE                      
201280         MOVE PC-POL TO PV-HOLD-ORGN-TYP-CDE                              
201290         PERFORM 4440-EDIT-ORGN-CDE                                       
201291         MOVE TRT00010-IMPRT-ORGN-CDE TO AMPOLO                           
201292     ELSE                                                                 
201293         MOVE IMCNTK-FDR-TRIP-TYP-CDE TO PV-HOLD-TRIP-TYP-CDE             
201294         MOVE IMCNTK-FDR-POR-CDE TO PV-HOLD-ORGN-CDE                      
201295         MOVE PC-POR TO PV-HOLD-ORGN-TYP-CDE                              
201296         PERFORM 4440-EDIT-ORGN-CDE                                       
201297         MOVE TRT00010-IMPRT-ORGN-CDE TO AMPORO                           
201298         MOVE IMCNTK-FDR-POL-CDE TO PV-HOLD-ORGN-CDE                      
201299         MOVE PC-POL TO PV-HOLD-ORGN-TYP-CDE                              
201300         PERFORM 4440-EDIT-ORGN-CDE                                       
201301         MOVE TRT00010-IMPRT-ORGN-CDE TO AMPOLO                           
201302     END-IF.                                                              
201310*                                                                 20130099
201400     MOVE IMCNTK-EST-LBD-TMST (1:10)                              20140099
201500                                   TO  PV-DATE-BREAK.             20150099
201600     IF PV-DATE-BREAK = SPACES OR PC-INIT-DATE                    20160099
201700          MOVE SPACES              TO AELDO                       20170099
201800     ELSE                                                         20180099
201900          PERFORM 4320-FORMAT-DATE                                20190099
202000          MOVE PV-DATE-DISPLAY     TO AELDO                       20200099
202100     END-IF.                                                      20210099
202200*                                                                 20220099
202300     IF IMCNTK-FDR-DPRTR-TMST (1:10)                              20230099
202400                                   = SPACES OR PC-INIT-DATE       20240099
202500          MOVE IMCNTK-MOM-DPRTR-TMST (1:10)                       20250099
202600                                   TO  PV-DATE-BREAK              20260099
202700     ELSE                                                         20270099
202800          MOVE IMCNTK-FDR-DPRTR-TMST (1:10)                       20280099
202900                                   TO  PV-DATE-BREAK              20290099
203000     END-IF.                                                      20300099
203100     IF PV-DATE-BREAK              = SPACES OR PC-INIT-DATE       20310099
203200        MOVE SPACES                   TO AATDO                    20320099
203300     ELSE                                                         20330099
203400        PERFORM 4320-FORMAT-DATE                                  20340099
203500        MOVE PV-DATE-DISPLAY          TO AATDO                    20350099
203600     END-IF.                                                      20360099
203700*                                                                 20370099
203800     MOVE IMCNTK-MOM-POE-DELY-TMST (1:10)                         20380099
203900                                   TO  PV-DATE-BREAK.             20390099
204000     IF PV-DATE-BREAK = SPACES OR PC-INIT-DATE                    20400099
204100        MOVE SPACES                TO AETAO                       20410099
204200     ELSE                                                         20420099
204300        PERFORM 4320-FORMAT-DATE                                  20430099
204400        MOVE PV-DATE-DISPLAY       TO AETAO                       20440099
204500     END-IF.                                                      20450099
204510*                                                                 20451099
204511     MOVE IMCNTK-ACTL-POE-DELY-TMST (1:10)                        20451199
204530                                   TO  PV-DATE-BREAK.             20453099
204540     IF PV-DATE-BREAK = SPACES OR PC-INIT-DATE                    20454099
204550        MOVE SPACES                TO AATAO                       20455099
204560     ELSE                                                         20456099
204570        PERFORM 4320-FORMAT-DATE                                  20457099
204580        MOVE PV-DATE-DISPLAY       TO AATAO                       20458099
204590     END-IF.                                                      20459099
204800*                                                                 20480099
204900     IF  IMCNTK-LAST-UPD-TMST (1:10)                              20490099
205000                                   = SPACES OR PC-INIT-DATE       20500099
205100         MOVE SPACES               TO ALSTTRNO                    20510099
205200     ELSE                                                         20520099
205300         STRING  IMCNTK-LAST-UPD-TMST(6:2) '/'                    20530099
205400                 IMCNTK-LAST-UPD-TMST(9:2)                        20540099
205500                 DELIMITED BY SIZE                                20550099
205600                           INTO ALSTTRNO                          20560099
205700     END-IF.                                                      20570099
205800                                                                  20580099
205900 EJECT                                                            20590099
206000*----------------------------------------------------------------*20600099
206100*    CHECK FOR TRIP-TYP-CODE AND PROCESS FOB-CODE FOR DISPLAY    *20610099
206200*----------------------------------------------------------------*20620099
206300 4403-FOB-CDE-CHECK.                                              20630099
206400                                                                  20640099
206500     EVALUATE TRUE                                                20650099
206600        WHEN  (IMCNTK-FDR-TRIP-TYP-CDE = 'A') OR                  20660099
206700              (IMCNTK-MOM-TRIP-TYP-CDE = 'A')                     20670099
206800              IF IMCNTK-FDR-FOB-CDE = SPACES                      20680099
206900                 MOVE IMCNTK-MOM-FOB-CDE TO AFOBO                 20690099
207000              ELSE                                                20700099
207100                 MOVE IMCNTK-FDR-FOB-CDE TO AFOBO                 20710099
207200              END-IF                                              20720099
207300                                                                  20730099
207400        WHEN  (IMCNTK-FDR-TRIP-TYP-CDE = 'O' OR 'M') OR           20740099
207500              (IMCNTK-MOM-TRIP-TYP-CDE = 'O' OR 'M')              20750099
207600              IF IMCNTK-FDR-FOB-CDE = SPACES                      20760099
207700                 PERFORM 4404-SELECT-MOM-FOB-CDE                  20770099
207800              ELSE                                                20780099
207900                 PERFORM 4405-SELECT-FDR-FOB-CDE                  20790099
208000              END-IF                                              20800099
208100                                                                  20810099
208200        WHEN  OTHER                                               20820099
208300              MOVE SPACES             TO AFOBO                    20830099
208400     END-EVALUATE.                                                20840099
208500                                                                  20850099
208600 EJECT                                                            20860099
208700*----------------------------------------------------------------*20870099
208800*    SELECT MOM FOB CODE FROM TIMFOB.                            *20880099
208900*----------------------------------------------------------------*20890099
209000 4404-SELECT-MOM-FOB-CDE.                                         20900099
209100                                                                  20910099
209200     EXEC SQL                                                     20920099
209300         SELECT DISTINCT                                          20930099
209400               A.FOB_CDE                                          20940099
209500         INTO   :IMFOB-FOB-CDE                                    20950099
209600         FROM   TIMFOB A                                          20960099
209700         WHERE  A.FOB_STD_EDI_CDE = :IMCNTK-MOM-FOB-CDE           20970099
209800            AND A.STAT_CDE = 'A'                                  20980099
209900     END-EXEC.                                                    20990099
210000                                                                  21000099
210100     EVALUATE TRUE                                                21010099
210200         WHEN SQLCODE = ZERO                                      21020099
210300              MOVE IMFOB-FOB-CDE   TO AFOBO                       21030099
210400         WHEN SQLCODE = +100                                      21040099
210500         WHEN SQLCODE = -811                                      21050099
210600              MOVE SPACES          TO AFOBO                       21060099
210700         WHEN SQLWARN0 NOT = SPACE                                21070099
210800         WHEN SQLCODE NOT = ZERO                                  21080099
210900              MOVE '4404-SELECT-MOM-FOB-CDE'                      21090099
211000                               TO DP013-PARAGRAPH                 21100099
211100              MOVE 'SQL ERROR SELECTING MOM FOB CODE'             21110099
211200                               TO DP013-MESSAGE-TEXT (1)          21120099
211300              MOVE SQLCA       TO DP013-SQLCA                     21130099
211400              SET DP013-DB2-ABEND                                 21140099
211500                               TO TRUE                            21150099
211600              PERFORM DP013-0000-PROCESS-ABEND                    21160099
211700     END-EVALUATE.                                                21170099
211800                                                                  21180099
211900 EJECT                                                            21190099
212000*----------------------------------------------------------------*21200099
212100*    SELECT FDR FOB CODE FROM TIMFOB.                            *21210099
212200*----------------------------------------------------------------*21220099
212300 4405-SELECT-FDR-FOB-CDE.                                         21230099
212400                                                                  21240099
212500     EXEC SQL                                                     21250099
212600         SELECT DISTINCT                                          21260099
212700               A.FOB_CDE                                          21270099
212800         INTO   :IMFOB-FOB-CDE                                    21280099
212900         FROM   TIMFOB A                                          21290099
213000         WHERE  A.FOB_STD_EDI_CDE = :IMCNTK-FDR-FOB-CDE           21300099
213100            AND A.STAT_CDE = 'A'                                  21310099
213200     END-EXEC.                                                    21320099
213300                                                                  21330099
213400     EVALUATE TRUE                                                21340099
213500         WHEN SQLCODE = ZERO                                      21350099
213600              MOVE IMFOB-FOB-CDE   TO AFOBO                       21360099
213700         WHEN SQLCODE = +100                                      21370099
213800         WHEN SQLCODE = -811                                      21380099
213900              MOVE SPACES          TO AFOBO                       21390099
214000         WHEN SQLWARN0 NOT = SPACE                                21400099
214100         WHEN SQLCODE NOT = ZERO                                  21410099
214200              MOVE '4405-SELECT-FDR-FOB-CDE'                      21420099
214300                               TO DP013-PARAGRAPH                 21430099
214400              MOVE 'SQL ERROR SELECTING FDR FOB CODE'             21440099
214500                               TO DP013-MESSAGE-TEXT (1)          21450099
214600              MOVE SQLCA       TO DP013-SQLCA                     21460099
214700              SET DP013-DB2-ABEND                                 21470099
214800                               TO TRUE                            21480099
214900              PERFORM DP013-0000-PROCESS-ABEND                    21490099
215000     END-EVALUATE.                                                21500099
215100                                                                  21510099
215200 EJECT                                                            21520099
215300*----------------------------------------------------------------*21530099
215400*    CHECK FOR TRIP-TYP-CODE AND PROCESS POE-CODE FOR DISPLAY    *21540099
215500*----------------------------------------------------------------*21550099
215600 4406-POE-CDE-CHECK.                                              21560099
215700                                                                  21570099
215800     EVALUATE TRUE                                                21580099
216200        WHEN  IMCNTK-MOM-TRIP-TYP-CDE = 'O' OR 'M' OR 'A'         21620099
216301              PERFORM 4500-OPEN-POE-CURSOR                        21630199
216302              PERFORM 4510-FETCH-POE-CURSOR                       21630299
216310              PERFORM 4505-CLOSE-POE-CURSOR                       21631099
216400              MOVE IMPOE-POE-CDE           TO APOEO               21640099
216500                                                                  21650099
216600        WHEN  OTHER                                               21660099
216700              MOVE SPACES                  TO APOEO               21670099
216800     END-EVALUATE.                                                21680099
216900                                                                  21690099
217000 EJECT                                                            21700099
220200*----------------------------------------------------------------*22020099
220300*    SELECT COUNT FROM TAUCNTK                                   *22030099
220400*----------------------------------------------------------------*22040099
220500 4408-SELECT-TAUCNTK-CNT.                                         22050099
220600                                                                  22060099
220700     EXEC SQL                                                     22070099
220800         SELECT                                                   22080099
220900               COUNT (*)                                          22090099
221000         INTO   :PV-TAUCNTK-CNT                                   22100099
221100         FROM   TAUCNTK                                           22110099
221200         WHERE  CONTNR_ID      = :DK-CONTNR-NO                    22120099
221300           AND  CONTNR_SEQ_NBR = :DK-CONTNR-SEQ-NO                22130099
221400     END-EXEC.                                                    22140099
221500                                                                  22150099
221600     EVALUATE TRUE                                                22160099
221700         WHEN SQLCODE = ZERO                                      22170099
221800         WHEN SQLCODE = +100                                      22180099
221900              CONTINUE                                            22190099
222000         WHEN SQLWARN0 NOT = SPACE                                22200099
222100         WHEN SQLCODE NOT = ZERO                                  22210099
222200              MOVE '4408-SELECT-TAUCNTK-CNT'                      22220099
222300                               TO DP013-PARAGRAPH                 22230099
222400              MOVE 'SQL ERROR SELECTING COUNT FROM TAUCNTK'       22240099
222500                               TO DP013-MESSAGE-TEXT (1)          22250099
222600              MOVE SQLCA       TO DP013-SQLCA                     22260099
222700              SET DP013-DB2-ABEND                                 22270099
222800                               TO TRUE                            22280099
222900              PERFORM DP013-0000-PROCESS-ABEND                    22290099
223000     END-EVALUATE.                                                22300099
223100                                                                  22310099
223200 EJECT                                                            22320099
223300*----------------------------------------------------------------*22330099
223400*    SELECT COUNT FROM TIMCNTK                                   *22340099
223500*----------------------------------------------------------------*22350099
223600 4409-SELECT-TIMCNTK-CNT.                                         22360099
223700                                                                  22370099
223800     EXEC SQL                                                     22380099
223900         SELECT                                                   22390099
224000               COUNT (*)                                          22400099
224100         INTO   :PV-TIMCNTK-CNT                                   22410099
224200         FROM   TIMCNTK                                           22420099
224300         WHERE  CONTNR_ID      = :DK-CONTNR-NO                    22430099
224400           AND  CONTNR_SEQ_NBR = :DK-CONTNR-SEQ-NO                22440099
224500     END-EXEC.                                                    22450099
224600                                                                  22460099
224700     EVALUATE TRUE                                                22470099
224800         WHEN SQLCODE = ZERO                                      22480099
224900         WHEN SQLCODE = +100                                      22490099
225000              CONTINUE                                            22500099
225100         WHEN SQLWARN0 NOT = SPACE                                22510099
225200         WHEN SQLCODE NOT = ZERO                                  22520099
225300              MOVE '4409-SELECT-TIMCNTK-CNT'                      22530099
225400                               TO DP013-PARAGRAPH                 22540099
225500              MOVE 'SQL ERROR SELECTING COUNT FROM TIMCNTK'       22550099
225600                               TO DP013-MESSAGE-TEXT (1)          22560099
225700              MOVE SQLCA       TO DP013-SQLCA                     22570099
225800              SET DP013-DB2-ABEND                                 22580099
225900                               TO TRUE                            22590099
226000              PERFORM DP013-0000-PROCESS-ABEND                    22600099
226100     END-EVALUATE.                                                22610099
226200                                                                  22620099
226300 EJECT                                                            22630099
226400*----------------------------------------------------------------*22640099
226500*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *22650099
226600*----------------------------------------------------------------*22660099
226700 4410-READ-TEMP-STORAGE.                                          22670099
226800                                                                  22680099
226900     EXEC CICS                                                    22690099
227000         READQ TS                                                 22700099
227100             QUEUE (ASC-LIST-QUEUE-NAME)                          22710099
227200             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               22720099
227300             ITEM  (PV-BLOCK-NUMBER)                              22730099
227400             RESP  (PV-CICS-RESP)                                 22740099
227500     END-EXEC.                                                    22750099
227600                                                                  22760099
227700     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       22770099
227800       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     22780099
227900         CONTINUE                                                 22790099
228000     ELSE                                                         22800099
228100         SET DP013-CICS-ABEND     TO TRUE                         22810099
228200         SET DP013-NO-ROLLBACK    TO TRUE                         22820099
228300         MOVE '4410-READ-TEMP-STORAGE'                            22830099
228400                                  TO DP013-PARAGRAPH              22840099
228500         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      22850099
228600                                  TO DP013-MESSAGE-TEXT(1)        22860099
228700         PERFORM DP013-0000-PROCESS-ABEND                         22870099
228800     END-IF.                                                      22880099
228900                                                                  22890099
229000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             22900099
229100*                                                                 22910099
229200     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         22920099
229300         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               22930099
229400     END-IF.                                                      22940099
229500                                                                  22950099
229600 EJECT                                                            22960099
229700*----------------------------------------------------------------*22970099
229800*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *22980099
229900*----------------------------------------------------------------*22990099
230000 4420-FORMAT-LIST-LINES.                                          23000099
230100                                                                  23010099
230200     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      23020099
230300         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                23030099
230400         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA    (PV-SUB)        23040099
230500         MOVE DP015-HL-OFF       TO MR-SELECTH    (PV-SUB)        23050099
230600         MOVE SPACES             TO MR-SELECTI    (PV-SUB)        23060099
230700                                    MR-ACTION     (PV-SUB)        23070099
230800                                    MR-PO-ENTRY   (PV-SUB)        23080099
230900                                    MR-PO-DESC    (PV-SUB)        23090099
231000                                                                  23100099
231100         MOVE ZEROS              TO MR-PO-NBR   (PV-SUB)          23110099
231800     ELSE                                                         23180099
231900         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      23190099
232000                                                   > SPACE        23200099
232100             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 23210099
232200                                 TO MR-SELECTI (PV-SUB)           23220099
232300         ELSE                                                     23230099
232400             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      23240099
232500                                 TO MR-SELECTI (PV-SUB)           23250099
232600         END-IF                                                   23260099
232700*                                                                 23270099
232800         IF  DP030-SET-CURSOR-TRAILER                             23280099
232900             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)23290099
233000                 > SPACE)                                         23300099
233100               OR (PV-SUB = 1))                                   23310099
233200                SET DP030-SET-CURSOR-APPL-1 TO TRUE               23320099
233300                MOVE -1          TO MR-SELECTL (PV-SUB)           23330099
233400             END-IF                                               23340099
233500         END-IF                                                   23350099
233600*                                                                 23360099
233700         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           23370099
233800             MOVE ASC-ACTION   (ASC-BLK-SUB ASC-ITEM-SUB)         23380099
233900                               TO MR-ACTION (PV-SUB)              23390099
234000             MOVE ASC-KEY-PO-NBR                                  23400099
234100                               TO MR-PO-NBR (PV-SUB)              23410099
234200             MOVE ASC-ENTRY-ID TO MR-PO-ENTRY (PV-SUB)            23420099
234400             MOVE ASC-ENTRY-DESC                                  23440099
234500                               TO MR-PO-DESC (PV-SUB)             23450099
235800         END-IF                                                   23580099
235900     END-IF.                                                      23590099
236000     SUBTRACT +1 FROM ASC-ITEM-SUB                                23600099
236100     IF  ASC-ITEM-SUB < + 1                                       23610099
236200         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  23620099
236300         MOVE +1                 TO ASC-BLK-SUB                   23630099
236400     END-IF.                                                      23640099
236500                                                                  23650099
236600*----------------------------------------------------------------*23651099
236700 4421-MOVE-DESC-LINES.                                            23652099
236800                                                                  23653099
236801     MOVE ASC-KEY-PO-NBR                                          23653199
236802                       TO MR-PO-NBR (1).                          23653299
236803     MOVE ASC-ENTRY-ID TO MR-PO-ENTRY (1).                        23653399
236804     MOVE ASC-ENTRY-DESC                                          23653499
236805                       TO MR-PO-DESC (1).                         23653599
236806*----------------------------------------------------------------*23654099
236807 EJECT                                                            23660099
236808**--------------------------------------------------------------**23670099
236809** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **23680099
236900** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **23690099
237000** ISSUE A WARNING.                                             **23700099
237100**--------------------------------------------------------------**23710099
237200 4430-CHECK-FOR-BEGIN-AND-END.                                    23720099
237300                                                                  23730099
237400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       23740099
237500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     23750099
237600*-------------- NO END-OF-RANGE SPECFIED ---                      23760099
237700             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            23770099
237800             SET DP020-MSG-WARNING TO TRUE                        23780099
237900             PERFORM 4431-POSITION-AT-WARNING                     23790099
238000         END-IF                                                   23800099
238100     ELSE                                                         23810099
238200         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     23820099
238300*-------------- NO BEGINNING-OF-RANGE SPECFIED ---                23830099
238400             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            23840099
238500             SET DP020-MSG-WARNING TO TRUE                        23850099
238600             PERFORM 4431-POSITION-AT-WARNING                     23860099
238700         END-IF                                                   23870099
238800     END-IF.                                                      23880099
238900                                                                  23890099
239000 EJECT                                                            23900099
239100**--------------------------------------------------------------**23910099
239200** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **23920099
239300** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **23930099
239400** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **23940099
239500** POSITION THE CURSOR THERE.                                   **23950099
239600**--------------------------------------------------------------**23960099
239700 4431-POSITION-AT-WARNING.                                        23970099
239800                                                                  23980099
239900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 23990099
240000                    - PV-TOP-ITEM + 1.                            24000099
240100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      24010099
240200         CONTINUE                                                 24020099
240300     ELSE                                                         24030099
240400         SET DP030-SET-CURSOR-APPL-1                              24040099
240500                                   TO TRUE                        24050099
240600         MOVE -1                   TO MR-SELECTL (PV-SUB)         24060099
240700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         24070099
240800         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         24080099
240900     END-IF.                                                      24090099
241000*                                                                 24100099
241100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   24110099
241200                    - PV-TOP-ITEM + 1.                            24120099
241300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      24130099
241400         CONTINUE                                                 24140099
241500     ELSE                                                         24150099
241600         SET DP030-SET-CURSOR-APPL-1                              24160099
241700                                   TO TRUE                        24170099
241800         MOVE -1                   TO MR-SELECTL (PV-SUB)         24180099
241900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         24190099
242000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         24200099
242100     END-IF.                                                      24210099
242200                                                                  24220099
242300 EJECT                                                            24230099
242301******************************************************************        
242302* EDIT THE POL AND POR ORIGIN CODES.                             *        
242303******************************************************************        
242304 4440-EDIT-ORGN-CDE.                                                      
242305                                                                          
242306     IF PV-HOLD-ORGN-CDE = SPACES                                         
242307         CONTINUE                                                         
242308     ELSE                                                                 
242309         EVALUATE TRUE                                                    
242310             WHEN PV-HOLD-TRIP-TYP-CDE = PC-A                             
242311                 PERFORM 4442-SELECT-ORGN-AIR                             
242312                                                                          
242313             WHEN PV-HOLD-TRIP-TYP-CDE = PC-O                             
242314                 PERFORM 4444-SELECT-ORGN-OCEAN                           
242315                                                                          
242316             WHEN OTHER                                                   
242317                 MOVE SPACES TO TRT00010-IMPRT-ORGN-CDE                   
242318         END-EVALUATE                                                     
242319     END-IF.                                                              
242320                                                                          
242321******************************************************************        
242322* SELECT POL AND POR CODES FOR AIR.                              *        
242323******************************************************************        
242324 4442-SELECT-ORGN-AIR.                                                    
242325                                                                          
242326     EXEC SQL                                                             
242327         SELECT A.IMPRT_ORGN_CDE                                          
242328           INTO  :TRT00010-IMPRT-ORGN-CDE                                 
242329           FROM TRT_IMPRT_ORGN  A                                         
242330          WHERE A.IMPRT_ORGN_CDE = :PV-HOLD-ORGN-CDE                      
242331            AND A.STAT_CDE    =   'A'                                     
242332            AND A.IMPRT_ORGN_TYP_CDE = :PV-HOLD-ORGN-TYP-CDE              
242333     END-EXEC.                                                            
242334                                                                          
242335     EVALUATE TRUE                                                DPKCS036
242336         WHEN SQLCODE = ZERO                                      DPKCS036
242337              CONTINUE                                            DPKCS036
242338         WHEN SQLCODE = +100                                      DPKCS036
242339         WHEN SQLCODE = -811                                      DPKCS036
242340              MOVE  SPACES TO TRT00010-IMPRT-ORGN-CDE                     
242341         WHEN SQLWARN0 NOT = SPACE                                DPKCS036
242342         WHEN SQLCODE NOT = ZERO                                  DPKCS036
242343              MOVE '4442-SELECT-ORGN-AIR'                         DPKCS036
242344                               TO DP013-PARAGRAPH                 DPKCS036
242345              MOVE 'SQL ERROR SELECTING ORIGIN CODE'              DPKCS036
242346                               TO DP013-MESSAGE-TEXT (1)          DPKCS036
242347              MOVE SQLCA       TO DP013-SQLCA                     DPKCS036
242348              SET DP013-DB2-ABEND                                 DPKCS036
242349                               TO TRUE                            DPKCS036
242350              PERFORM DP013-0000-PROCESS-ABEND                    DPKCS036
242351     END-EVALUATE.                                                DPKCS036
242352                                                                  DPKCS036
242353 EJECT                                                                    
242354******************************************************************        
242355* SELECT POL AND POR CODES FOR OCEAN.                            *        
242356******************************************************************        
242357 4444-SELECT-ORGN-OCEAN.                                                  
242358                                                                          
242359     EXEC SQL                                                             
242360         SELECT A.IMPRT_ORGN_CDE                                          
242361          INTO :TRT00010-IMPRT-ORGN-CDE                                   
242362           FROM TRT_IMPRT_ORGN  A                                         
242363          WHERE A.STD_EDI_CDE  = :PV-HOLD-ORGN-CDE                        
242364            AND A.STAT_CDE     = 'A'                                      
242365            AND A.IMPRT_ORGN_TYP_CDE = :PV-HOLD-ORGN-TYP-CDE              
242366     END-EXEC.                                                            
242367                                                                          
242368     EVALUATE TRUE                                                DPKCS036
242369         WHEN SQLCODE = ZERO                                      DPKCS036
242370              CONTINUE                                            DPKCS036
242371         WHEN SQLCODE = +100                                      DPKCS036
242372         WHEN SQLCODE = -811                                      DPKCS036
242373              MOVE  SPACES TO TRT00010-IMPRT-ORGN-CDE                     
242374         WHEN SQLWARN0 NOT = SPACE                                DPKCS036
242375         WHEN SQLCODE NOT = ZERO                                  DPKCS036
242376              MOVE '4444-SELECT-ORGN-OCEAN'                       DPKCS036
242377                               TO DP013-PARAGRAPH                 DPKCS036
242378              MOVE 'SQL ERROR SELECTING ORIGIN CODE'              DPKCS036
242379                               TO DP013-MESSAGE-TEXT (1)          DPKCS036
242380              MOVE SQLCA       TO DP013-SQLCA                     DPKCS036
242381              SET DP013-DB2-ABEND                                 DPKCS036
242382                               TO TRUE                            DPKCS036
242383              PERFORM DP013-0000-PROCESS-ABEND                    DPKCS036
242384     END-EVALUATE.                                                DPKCS036
242385                                                                  DPKCS036
242386 EJECT                                                                    
242387*----------------------------------------------------------------*24230199
242388*   OPEN THE POE CODE CURSOR                                     *24230299
242389*----------------------------------------------------------------*24230399
242390 4500-OPEN-POE-CURSOR.                                            24230499
242391                                                                  24230599
242392         EXEC SQL                                                 24231599
242393              OPEN POE-CSR                                        24231699
242394         END-EXEC                                                 24231799
242395                                                                  24231899
242396         EVALUATE TRUE                                            24231999
242397             WHEN SQLCODE = ZERO                                  24232099
242398                 CONTINUE                                         24232199
242399             WHEN SQLCODE = -904                                  24232299
242400             WHEN SQLCODE = -911                                  24232399
242401             WHEN SQLCODE = -913                                  24232499
242402         MOVE '4382-OPEN-POE-CURSOR' TO DP013-PARAGRAPH           24232599
242403         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   24232699
242404                                   TO DP013-MESSAGE-TEXT (1)      24232799
242405         MOVE SQLCA                TO DP013-SQLCA                 24232899
242406         MOVE 'TIMPOE  '           TO DP013-DB2-TABLE-NAME (1)    24232999
242407         SET DP013-DB2-ABEND                                      24233099
242408             DP013-XCTL-DISPLAY-RESTART                           24233199
242409                                   TO TRUE                        24233299
242410         PERFORM DP013-0000-PROCESS-ABEND                         24233399
242411                                                                  24233499
242412             WHEN SQLWARN0 NOT = SPACES                           24233599
242413             WHEN SQLCODE < ZERO                                  24233699
242414             WHEN SQLCODE > ZERO                                  24233799
242415                 MOVE '4500-OPEN-POE-CURSOR'                      24233899
242416                                   TO DP013-PARAGRAPH             24233999
242417                 MOVE 'OPEN POE CURSOR - '                        24234099
242418                                   TO DP013-MESSAGE-TEXT (1)      24234199
242419                 MOVE SQLCA        TO DP013-SQLCA                 24234299
242420                 MOVE 'TIMPOE  '   TO DP013-DB2-TABLE-NAME (1)    24234399
242421                 SET DP013-DB2-ABEND                              24234499
242422                     DP013-XCTL-DISPLAY-RESTART TO TRUE           24234599
242423                 PERFORM DP013-0000-PROCESS-ABEND                 24234699
242424         END-EVALUATE.                                            24234799
242425*                                                                 24234999
242426                                                                  24235299
242427 EJECT                                                            24235399
242428*----------------------------------------------------------------*24235499
242429*   CLOSE THE POE CODE CURSOR                                    *24235599
242430*----------------------------------------------------------------*24235699
242431 4505-CLOSE-POE-CURSOR.                                           24235799
242432                                                                  24235899
242433     EXEC SQL                                                     24235999
242434          CLOSE POE-CSR                                           24236099
242435     END-EXEC.                                                    24236199
242436                                                                  24236299
242437     EVALUATE TRUE                                                24236399
242438         WHEN SQLCODE = ZERO                                      24236499
242439             CONTINUE                                             24236599
242440         WHEN SQLWARN0 NOT = SPACES                               24236699
242441         WHEN SQLCODE < ZERO                                      24236799
242442         WHEN SQLCODE > ZERO                                      24236899
242443             MOVE '4505-CLOSE-POE-CURSOR'                         24236999
242444                               TO DP013-PARAGRAPH                 24237099
242445             MOVE 'CLOSE POE CURSOR '                             24237199
242446                               TO DP013-MESSAGE-TEXT (1)          24237299
242447             MOVE SQLCA        TO DP013-SQLCA                     24237399
242448             MOVE 'TIMPOE  '   TO DP013-DB2-TABLE-NAME (1)        24237499
242449             SET DP013-DB2-ABEND                                  24237599
242450                 DP013-XCTL-DISPLAY-RESTART TO TRUE               24237699
242451             PERFORM DP013-0000-PROCESS-ABEND                     24237799
242452     END-EVALUATE.                                                24237899
242453                                                                  24237999
242454 EJECT                                                            24238099
242455*----------------------------------------------------------------*24238199
242456*    FETCH THE POE CODE CURSOR                                   *24238299
242457*----------------------------------------------------------------*24238399
242458 4510-FETCH-POE-CURSOR.                                           24238499
242459                                                                  24238599
242460     EXEC SQL                                                     24238699
242461          FETCH POE-CSR                                           24238799
242462          INTO  :IMPOE-POE-CDE                                    24238899
242463     END-EXEC.                                                    24238999
242464                                                                  24239099
242465     EVALUATE TRUE                                                24239199
242466         WHEN SQLCODE = ZERO                                      24239299
242467         WHEN SQLCODE = -811                                      24239399
242468              CONTINUE                                            24239499
242469         WHEN SQLCODE = +100                                      24239599
242470              MOVE SPACES TO IMPOE-POE-CDE                        24239699
242471         WHEN SQLWARN0 NOT = SPACE                                24239799
242472         WHEN SQLCODE NOT = ZERO                                  24239899
242473              MOVE '4510-FETCH-POE-CURSOR'                        24239999
242474                               TO DP013-PARAGRAPH                 24240099
242475              MOVE 'FETCH POE CURSOR'                             24240199
242476                               TO DP013-MESSAGE-TEXT (1)          24240299
242477              MOVE SQLCA       TO DP013-SQLCA                     24240399
242478              SET DP013-DB2-ABEND                                 24240499
242479                               TO TRUE                            24240599
242480              PERFORM DP013-0000-PROCESS-ABEND                    24240699
242481     END-EVALUATE.                                                24240799
242482                                                                  24240899
242483 EJECT                                                            24240999
242490*----------------------------------------------------------------*24241099
242500* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *24250099
242600* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *24260099
242700* FOR THE SELECTED ITEMS QUEUE.                                  *24270099
242800*                                                                *24280099
242900* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *24290099
243000* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *24300099
243100* THE ARRAY IS FULL.                                             *24310099
243200*----------------------------------------------------------------*24320099
243300 5000-PREPARE-SEL-QUEUE.                                          24330099
243400                                                                  24340099
243500     MOVE +1                   TO  ASC-BLK-SUB.                   24350099
243600     PERFORM 5100-WRITE-TEMP-STORAGE.                             24360099
243700     ADD +1                    TO  ASC-BLK-SUB.                   24370099
243800     PERFORM 5100-WRITE-TEMP-STORAGE.                             24380099
244600     PERFORM 6010-DELETE-SEL-QUEUE.                               24460099
244700                                                                  24470099
244800     SET ASC-UPDATE-TSQ        TO  TRUE.                          24480099
244900                                                                  24490099
245000     SET TR101-IDX             TO  1.                             24500099
245800     INITIALIZE TR101-SELECTED-ITEM-ARRAY.                        24580099
245900                                                                  24590099
246000     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           24600099
246100             VARYING PV-ITEM                                      24610099
246200             FROM 1 BY 1                                          24620099
246300             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     24630099
246400                                                                  24640099
246500     IF  TR101-IDX > 1                                            24650099
246600         PERFORM 5205-WRITE-SEL-QUEUE                             24660099
247400     END-IF.                                                      24740099
247500                                                                  24750099
247600 EJECT                                                            24760099
247700*----------------------------------------------------------------*24770099
247800*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *24780099
247900*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *24790099
248000*----------------------------------------------------------------*24800099
248100 5100-WRITE-TEMP-STORAGE.                                         24810099
248200                                                                  24820099
248300     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     24830099
248400                                   TO PV-LIST-ITEM-NUMBER.        24840099
248500     COMPUTE PV-BLOCK-NUMBER =                                    24850099
248600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    24860099
248700                                                                  24870099
248800     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             24880099
248900     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             24890099
249000         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      24900099
249100             PERFORM 5105-REWRITE-ASC-LISTQ                       24910099
249200         END-IF                                                   24920099
249300     ELSE                                                         24930099
249400         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       24940099
249500         ASC-HIGHEST-BLOCK-WRITTEN + 1                            24950099
249600         PERFORM 5110-WRITE-ASC-LISTQ                             24960099
249700         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   24970099
249800     END-IF.                                                      24980099
249900                                                                  24990099
250000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             25000099
250100                                                                  25010099
250200 EJECT                                                            25020099
250300**--------------------------------------------------------------**25030099
250400** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **25040099
250500** SPECIFIC COMMAREA.                                           **25050099
250600**--------------------------------------------------------------**25060099
250700 5105-REWRITE-ASC-LISTQ.                                          25070099
250800                                                                  25080099
250900     EXEC CICS                                                    25090099
251000         WRITEQ TS                                                25100099
251100             QUEUE (ASC-LIST-QUEUE-NAME)                          25110099
251200             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               25120099
251300             ITEM  (PV-BLOCK-NUMBER)                              25130099
251400             REWRITE                                              25140099
251500             RESP  (PV-CICS-RESP)                                 25150099
251600     END-EXEC.                                                    25160099
251700                                                                  25170099
251800     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           25180099
251900         CONTINUE                                                 25190099
252000     ELSE                                                         25200099
252100         SET DP013-CICS-ABEND            TO TRUE                  25210099
252200         SET DP013-NO-ROLLBACK           TO TRUE                  25220099
252300         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       25230099
252400         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     25240099
252500                                         TO DP013-MESSAGE-TEXT(1) 25250099
252600         PERFORM DP013-0000-PROCESS-ABEND                         25260099
252700     END-IF.                                                      25270099
252800                                                                  25280099
252900 EJECT                                                            25290099
253000**--------------------------------------------------------------**25300099
253100** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **25310099
253200** SPECIFIC COMMAREA.                                           **25320099
253300**--------------------------------------------------------------**25330099
253400 5110-WRITE-ASC-LISTQ.                                            25340099
253500                                                                  25350099
253600     EXEC CICS                                                    25360099
253700         WRITEQ TS                                                25370099
253800             QUEUE (ASC-LIST-QUEUE-NAME)                          25380099
253900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               25390099
254000             ITEM  (PV-BLOCK-NUMBER)                              25400099
254100             RESP  (PV-CICS-RESP)                                 25410099
254200     END-EXEC.                                                    25420099
254300     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      25430099
254400         SET DP013-CICS-ABEND      TO TRUE                        25440099
254500         SET DP013-NO-ROLLBACK     TO TRUE                        25450099
254600         MOVE '5110-WRITE-ASC-LISTQ'                              25460099
254700                                   TO DP013-PARAGRAPH             25470099
254800         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           25480099
254900                                   TO DP013-MESSAGE-TEXT(1)       25490099
255000         PERFORM DP013-0000-PROCESS-ABEND                         25500099
255100     END-IF.                                                      25510099
255200                                                                  25520099
255300 EJECT                                                            25530099
255400*----------------------------------------------------------------*25540099
255500* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *25550099
255600* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *25560099
255700*----------------------------------------------------------------*25570099
255800 5200-FILL-SEL-QUEUE-RECORD.                                      25580099
255900                                                                  25590099
256000     PERFORM 6112-READ-LIST-QUEUE.                                25600099
256100                                                                  25610099
256200     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       25620099
256300         PERFORM                                                  25630099
256400         VARYING LQW-IDX                                          25640099
256500         FROM 1 BY 1                                              25650099
256600         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            25660099
256700           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          25670099
256800                                                                  25680099
256900             IF  LQW-SELECT (LQW-IDX)                             25690099
257000                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              25700099
257100                                   TO TR101-ITEM (TR101-IDX)      25710099
257200                 MOVE ASC-KEY-CONTNR-NO                           25720099
257300                                   TO TR101-CONTNR-NO             25730099
257400                                        (TR101-IDX)               25740099
257500                 MOVE ASC-KEY-CONTNR-SEQ-NO                       25750099
257600                                   TO TR101-CONTNR-SEQ-NO         25760099
257700                                        (TR101-IDX)               25770099
258000                 MOVE 'I'          TO TR101-ACTION-SW (TR101-IDX) 25800099
258100                 SET TR101-IDX UP BY 1                            25810099
258200                 IF  TR101-IDX > TR101-MAX-ITEMS                  25820099
258300                     PERFORM 5205-WRITE-SEL-QUEUE                 25830099
259100                     INITIALIZE TR101-SELECTED-ITEM-ARRAY         25910099
259200                     SET TR101-IDX TO  1                          25920099
259300                 END-IF                                           25930099
259400             END-IF                                               25940099
259500         END-PERFORM                                              25950099
259600     END-IF.                                                      25960099
259700                                                                  25970099
259800 EJECT                                                            25980099
259900*----------------------------------------------------------------*25990099
260000*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *26000099
260100*----------------------------------------------------------------*26010099
260200 5205-WRITE-SEL-QUEUE.                                            26020099
260300                                                                  26030099
260400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            26040099
260500                                   TO TR101-SELECTED-ITEMS.       26050099
260600                                                                  26060099
260700     EXEC CICS                                                    26070099
260800          WRITEQ TS                                               26080099
260900             QUEUE (ASC-SEL-QUEUE-NAME)                           26090099
261000             FROM  (TR101-VOYAGE-SEL-REC)                         26100099
261100             ITEM  (PV-SEL-QUEUE-ITEM)                            26110099
261200             RESP  (PV-CICS-RESP)                                 26120099
261300     END-EXEC.                                                    26130099
261400                                                                  26140099
261500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          26150099
261600         CONTINUE                                                 26160099
261700     ELSE                                                         26170099
261800         SET DP013-CICS-ABEND      TO TRUE                        26180099
261900         SET DP013-NO-ROLLBACK     TO TRUE                        26190099
262000         MOVE '5205-WRITE-SEL-QUEUE'                              26200099
262100                                   TO DP013-PARAGRAPH             26210099
262200         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          26220099
262300                                   TO DP013-MESSAGE-TEXT(1)       26230099
262400         PERFORM DP013-0000-PROCESS-ABEND                         26240099
262500     END-IF.                                                      26250099
262600                                                                  26260099
262700 EJECT                                                            26270099
262800*----------------------------------------------------------------*26280099
262900*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *26290099
263000*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *26300099
263100*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *26310099
263200*  THE USER.                                                     *26320099
263300*----------------------------------------------------------------*26330099
263400 6000-REFRESH-PANEL-FROM-TEMP.                                    26340099
263500                                                                  26350099
263600     IF  ASC-UPDATE-TSQ                                           26360099
263700         SET ASC-NO-TSQ-UPDATE TO TRUE                            26370099
263800         MOVE ZERO                 TO PV-SAVE-ITEM                26380099
263900                                      PV-SEL-QUEUE-ITEM           26390099
264000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        26400099
264100                                   TO PV-HOLD-SELECTED-ITEMS      26410099
264200         MOVE +1                   TO PV-ITEMS-PROCESSED          26420099
264300         PERFORM 6100-UPDATE-TSQ                                  26430099
264400             UNTIL PV-ITEMS-PROCESSED >                           26440099
264500                                     PV-HOLD-SELECTED-ITEMS       26450099
264600         PERFORM 6010-DELETE-SEL-QUEUE                            26460099
264700         INITIALIZE ASC-BLOCK-ENTRIES (1)                         26470099
264800                    ASC-BLOCK-ENTRIES (2)                         26480099
264900     END-IF.                                                      26490099
265000                                                                  26500099
265100 EJECT                                                            26510099
265200*----------------------------------------------------------------*26520099
265300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *26530099
265400*----------------------------------------------------------------*26540099
265500 6010-DELETE-SEL-QUEUE.                                           26550099
265600                                                                  26560099
265700     EXEC CICS                                                    26570099
265800         DELETEQ TS                                               26580099
265900             QUEUE (ASC-SEL-QUEUE-NAME)                           26590099
266000             RESP  (PV-CICS-RESP)                                 26600099
266100     END-EXEC.                                                    26610099
266200*                                                                 26620099
266300     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      26630099
266400        (PV-CICS-RESP = DFHRESP(QIDERR)))                         26640099
266500         CONTINUE                                                 26650099
266600     ELSE                                                         26660099
266700         SET DP013-CICS-ABEND TO TRUE                             26670099
266800         SET DP013-NO-ROLLBACK TO TRUE                            26680099
266900         MOVE '6010-DELETE-SEL-QUEUE'                             26690099
267000                        TO DP013-PARAGRAPH                        26700099
267100         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         26710099
267200                        TO DP013-MESSAGE-TEXT (1)                 26720099
267300         PERFORM DP013-0000-PROCESS-ABEND                         26730099
267400     END-IF.                                                      26740099
267500                                                                  26750099
267600 EJECT                                                            26760099
267700*----------------------------------------------------------------*26770099
267800*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *26780099
267900*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *26790099
268000*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *26800099
268100*    THE TEMP QUEUE.                                             *26810099
268200*----------------------------------------------------------------*26820099
268300 6100-UPDATE-TSQ.                                                 26830099
268400                                                                  26840099
268500     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             26850099
268600     PERFORM 6105-READ-SEL-QUEUE.                                 26860099
268700     PERFORM                                                      26870099
268800         VARYING TR101-IDX                                        26880099
268900         FROM 1 BY 1                                              26890099
269000         UNTIL ((PV-ITEMS-PROCESSED >                             26900099
269100                              PV-HOLD-SELECTED-ITEMS)             26910099
269200         OR (TR101-IDX GREATER THAN TR101-MAX-ITEMS))             26920099
269300         IF  TR101-ACTION-SW (TR101-IDX) > SPACE                  26930099
269400             PERFORM 6110-PROCESS-ITEMS                           26940099
269500         END-IF                                                   26950099
269600         ADD +1                TO PV-ITEMS-PROCESSED              26960099
269700     END-PERFORM.                                                 26970099
269800     PERFORM 6111-WRITE-LIST-QUEUE.                               26980099
269900                                                                  26990099
270000 EJECT                                                            27000099
270100*----------------------------------------------------------------*27010099
270200*    READ THE LIST QUEUE RECORD.                                 *27020099
270300*----------------------------------------------------------------*27030099
270400 6105-READ-SEL-QUEUE.                                             27040099
270500                                                                  27050099
270600     EXEC CICS                                                    27060099
270700          READQ TS                                                27070099
270800             QUEUE (ASC-SEL-QUEUE-NAME)                           27080099
270900             INTO  (TR101-VOYAGE-SEL-REC)                         27090099
271000             ITEM  (PV-SEL-QUEUE-ITEM)                            27100099
271100             RESP  (PV-CICS-RESP)                                 27110099
271200     END-EXEC.                                                    27120099
271300*                                                                 27130099
271400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27140099
271500         CONTINUE                                                 27150099
271600     ELSE                                                         27160099
271700         SET DP013-CICS-ABEND      TO  TRUE                       27170099
271800         SET DP013-NO-ROLLBACK     TO  TRUE                       27180099
271900         MOVE '6105-READ-SEL-QUEUE'                               27190099
272000                                   TO  DP013-PARAGRAPH            27200099
272100         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           27210099
272200                                   TO  DP013-MESSAGE-TEXT(1)      27220099
272300         PERFORM DP013-0000-PROCESS-ABEND                         27230099
272400     END-IF.                                                      27240099
272500                                                                  27250099
272600 EJECT                                                            27260099
272700*----------------------------------------------------------------*27270099
272800*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*27280099
272900*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*27290099
273000*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *27300099
273100*----------------------------------------------------------------*27310099
273200 6110-PROCESS-ITEMS.                                              27320099
273300                                                                  27330099
273400     COMPUTE PV-ITEM = 1 + ((TR101-ITEM (TR101-IDX) - 1)          27340099
273500                     / PC-ITEMS-PER-PANEL).                       27350099
273600                                                                  27360099
273700     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           27370099
273800         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          27380099
273900             PERFORM 6111-WRITE-LIST-QUEUE                        27390099
274000         END-IF                                                   27400099
274100         MOVE PV-ITEM          TO PV-SAVE-ITEM                    27410099
274200                                                                  27420099
274300         PERFORM 6112-READ-LIST-QUEUE                             27430099
274400         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               27440099
274500             CONTINUE                                             27450099
274600         END-IF                                                   27460099
274700     END-IF.                                                      27470099
274800                                                                  27480099
274900     COMPUTE PV-SUB = (TR101-ITEM (TR101-IDX)                     27490099
275000                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              27500099
275100     SET LQW-DESELECT (PV-SUB) TO    TRUE.                        27510099
275200     MOVE LQW-SELECTED-SW (PV-SUB)                                27520099
275300                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  27530099
275400                                                                  27540099
275500     IF TR101-INQ (TR101-IDX)                                     27550099
275600        MOVE PC-INQ            TO LQW-ACTION (PV-SUB)             27560099
275700     END-IF.                                                      27570099
275800                                                                  27580099
275900     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                27590099
276000                                                                  27600099
276100 EJECT                                                            27610099
276200*----------------------------------------------------------------*27620099
276300*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *27630099
276400*----------------------------------------------------------------*27640099
276500 6111-WRITE-LIST-QUEUE.                                           27650099
276600                                                                  27660099
276700     EXEC CICS                                                    27670099
276800         WRITEQ TS                                                27680099
276900             QUEUE (ASC-LIST-QUEUE-NAME)                          27690099
277000             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     27700099
277100             ITEM  (PV-SAVE-ITEM)                                 27710099
277200             REWRITE                                              27720099
277300             RESP  (PV-CICS-RESP)                                 27730099
277400     END-EXEC.                                                    27740099
277500*                                                                 27750099
277600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27760099
277700         CONTINUE                                                 27770099
277800     ELSE                                                         27780099
277900         SET DP013-CICS-ABEND  TO  TRUE                           27790099
278000         SET DP013-NO-ROLLBACK TO  TRUE                           27800099
278100         MOVE '6111-WRITE-LIST-QUEUE'                             27810099
278200                               TO  DP013-PARAGRAPH                27820099
278300         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  27830099
278400                               TO  DP013-MESSAGE-TEXT(1)          27840099
278500         PERFORM DP013-0000-PROCESS-ABEND                         27850099
278600     END-IF.                                                      27860099
278700                                                                  27870099
278800 EJECT                                                            27880099
278900*----------------------------------------------------------------*27890099
279000*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*27900099
279100*----------------------------------------------------------------*27910099
279200 6112-READ-LIST-QUEUE.                                            27920099
279300                                                                  27930099
279400     EXEC CICS                                                    27940099
279500         READQ TS                                                 27950099
279600             QUEUE (ASC-LIST-QUEUE-NAME)                          27960099
279700             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     27970099
279800             ITEM  (PV-ITEM)                                      27980099
279900             RESP  (PV-CICS-RESP)                                 27990099
280000     END-EXEC.                                                    28000099
280100*                                                                 28010099
280200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28020099
280300         CONTINUE                                                 28030099
280400     ELSE                                                         28040099
280500         SET DP013-CICS-ABEND        TO TRUE                      28050099
280600         SET DP013-NO-ROLLBACK       TO TRUE                      28060099
280700         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           28070099
280800         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    28080099
280900                                     TO DP013-MESSAGE-TEXT(1)     28090099
281000         PERFORM DP013-0000-PROCESS-ABEND                         28100099
281100     END-IF.                                                      28110099
281200                                                                  28120099
281300 EJECT                                                            28130099
281400*----------------------------------------------------------------*28140099
281500*    ABEND PROCESSOR MODULE                                      *28150099
281600*----------------------------------------------------------------*28160099
281700                                                                  28170099
281800     COPY DPPD013.                                                28180099
