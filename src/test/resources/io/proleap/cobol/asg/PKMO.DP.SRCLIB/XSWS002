000100******************************************************************00010053
000200*        WORKING STORAGE FOR THE REAL-TIME PDE SQL PROGRAMS       00020053
000300*                 XSKUT035 (CALLED FROM BATCH)                    00030053
000400*                 XSKUT061 (CALLED FROM CICS TRANSACTION X001)    00040053
000400*                 XSKUT062 (CALLED FROM STORED PROCEDURE)         00041072
000500*                                                                 00050053
000600******************************************************************00060053
000700******************************************************************00070053
000800* PROGRAM SWITCHES                                                00080053
000900******************************************************************00090053
001000 01  PS-PROGRAM-SWITCHES.                                         00100053
001100   05  PS-ERROR-FOUND-SW             PIC  X(01)  VALUE 'N'.       00110053
001200     88  PS-ERROR-FOUND                          VALUE 'Y'.       00120053
001300     88  PS-NO-ERROR-FOUND                       VALUE 'N'.       00130053
001400   05  PS-PROMO-PRICG-FOUND-SW       PIC  X(01)  VALUE 'N'.       00140053
001500     88  PS-PROMO-PRICG-FOUND                    VALUE 'Y'.       00150053
001600     88  PS-NO-PROMO-PRICG-FOUND                 VALUE 'N'.       00160053
001700* USED TO DETERMINE IF REGIONAL CLEARANCE IS FOUND OR NOT         00170053
001800   05  PS-REG-CLEAR-FOUND-SW         PIC  X(01)  VALUE 'Y'.       00180053
001900     88  PS-REG-CLEAR-FOUND                      VALUE 'Y'.       00190053
002000     88  PS-REG-CLEAR-NOT-FOUND                  VALUE 'N'.       00200053
002100* USED TO DETERMINE IF SIMPLE PRICE WAS FOUND                     00210053
002200   05  PS-SIMPLE-PRICE-SW            PIC  X(01)  VALUE 'Y'.       00220053
002300     88  PS-SIMPLE-PRICE-FOUND                   VALUE 'Y'.       00230053
002400     88  PS-SIMPLE-PRICE-NOT-FOUND               VALUE 'N'.       00240053
002500* USED TO DETERMINE IF GROUP PRICE WAS FOUND                      00250053
002600   05  PS-GROUP-PRICE-SW             PIC  X(01)  VALUE 'Y'.       00260053
002700     88  PS-GROUP-PRICE-FOUND                    VALUE 'Y'.       00270053
002800     88  PS-GROUP-PRICE-NOT-FOUND                VALUE 'N'.       00280053
002900* USED TO DETERMINE IF FETCHING NEXT BASE RECORD IS NEEDED        00290053
003000   05  PS-FETCH-NEXT-SW              PIC  X(01)  VALUE 'Y'.       00300053
003100     88  PS-FETCH-NEXT                           VALUE 'Y'.       00310053
003200     88  PS-DONT-FETCH-NEXT                      VALUE 'N'.       00320053
003300* USED TO DETERMINE IF AN EXCLUSION IS FOUND                      00330053
003400   05  PS-EXCL-FOUND-SW              PIC  X(01)  VALUE 'Y'.       00340053
003500     88  PS-EXCL-FOUND                           VALUE 'Y'.       00350053
003600     88  PS-NO-EXCL-FOUND                        VALUE 'N'.       00360053
003700* USED TO DETERMINE IF AN EXCLUSION EXISTS                        00370053
003800   05  PS-EXCL-EXIST-SW              PIC  X(01)  VALUE 'Y'.       00380053
003900     88  PS-EXCL-EXISTS                          VALUE 'Y'.       00390053
004000     88  PS-NO-EXCL-EXISTS                       VALUE 'N'.       00400053
004100* USED TO DETERMINE IF A STORE IS FOUND                           00410053
004200   05  PS-STORE-FOUND-SW             PIC  X(01)  VALUE 'Y'.       00420053
004300     88  PS-STORE-FOUND                          VALUE 'Y'.       00430053
004400     88  PS-NO-STORE-FOUND                       VALUE 'N'.       00440053
004500* PROMO HIERARCY CODES...                                         00450053
004600   05  PS-MDSE-HIER-CDE              PIC  X(03)  VALUE '   '.     00460053
004700     88  PS-HIER-DPT-CDE                         VALUE 'DPT'.     00470053
004800     88  PS-HIER-MCL-CDE                         VALUE 'MCL'.     00480053
004900     88  PS-HIER-SCL-CDE                         VALUE 'SCL'.     00490053
005000     88  PS-HIER-STY-CDE                         VALUE 'STY'.     00500053
005100     88  PS-HIER-SKU-CDE                         VALUE 'SKU'.     00510053
005200* END OF HIERARCHY CURSORS                                        00520053
005300   05  PS-END-OF-CURSOR-SW           PIC  X(01)  VALUE 'Y'.       00530053
005400     88  PS-END-OF-CSR                           VALUE 'N'.       00540053
005500     88  PS-NOT-END-OF-CSR                       VALUE 'Y'.       00550053
           05  PS-END-OF-CONCLR-CSR-SW     PIC  X(01)  VALUE 'Y'.       00554075
               88  PS-END-OF-CONCLR-CSR                VALUE 'N'.       00555075
               88  PS-NOT-END-OF-CONCLR-CSR            VALUE 'Y'.       00556075
           05  PS-FUT-RED-EVNT-FOUND-SW    PIC  X(01)  VALUE 'N'.       00557075
               88  PS-FUT-RED-EVNT-FOUND               VALUE 'Y'.       00558075
               88  PS-FUT-RED-EVNT-NOT-FOUND           VALUE 'N'.       00559075
           05  PS-FUT-PERM-EVNT-FOUND-SW   PIC  X(01)  VALUE 'N'.       00559175
               88  PS-FUT-PERM-EVNT-FOUND              VALUE 'Y'.       00559275
               88  PS-FUT-PERM-EVNT-NOT-FOUND          VALUE 'N'.       00559375
005600   05  PS-END-OF-TIER-CSR-SW         PIC  X(01)  VALUE 'Y'.       00560053
005700     88  PS-NOT-END-OF-TIER-CSR                  VALUE 'Y'.       00570053
005800     88  PS-END-OF-TIER-CSR                      VALUE 'N'.       00580053
005900   05  PS-FIRST-TIER-ROW-SW          PIC  X(01)  VALUE 'Y'.       00590053
006000     88  PS-FIRST-TIER-ROW                       VALUE 'Y'.       00600053
006100     88  PS-NOT-FIRST-TIER-ROW                   VALUE 'N'.       00610053
      * USED TO DETERMINE THE TICKET COLOR OF AN ITEM BEFORE LOOKING    00720174
      * FOR FUTURE PRICE OR STATUS CHANGES                              00720274
           05  PS-ITEM-TKT-CLOR-CDE-SW     PIC  X(01)  VALUE ' '.       00720374
               88  PS-WHITE-TKT-ITEM                   VALUE 'W'.       00720474
               88  PS-YELLOW-TKT-ITEM                  VALUE 'Y'.       00720574
               88  PS-RED-TKT-ITEM                     VALUE 'R'.       00720674
      * USED TO DETERMINE IF A FUTURE PRICE CHANGE HAS BEEN APPLIED     00720774
           05  PS-ITEM-TKT-CLOR-CDE-SW     PIC  X(01)  VALUE ' '.       00721074
               88  PS-NO-PRICE-CHG-APPLIED             VALUE ' '.       00722074
               88  PS-WHITE-TKT-APPLIED                VALUE 'W'.       00723074
               88  PS-YELLOW-TKT-APPLIED               VALUE 'Y'.       00724074
               88  PS-RED-TKT-APPLIED                  VALUE 'R'.       00725074
007300* USED TO DETERMINE IF THE FUTURE PERM CHANGE SHOULD BE APPLIED   00730053
007400   05  PS-VALID-FUT-TKT-EVNT-SW      PIC  X(01)  VALUE SPACES.    00740053
007500     88  PS-VALID-FUT-TKT-EVNT                   VALUE 'Y'.       00750053
007600     88  PS-INVALID-FUT-TKT-EVNT                 VALUE 'N'.       00760053
007700                                                                  00770053
007800******************************************************************00780053
007900* TIMESTAMP VARIABLES                                             00790053
008000******************************************************************00800053
008100 01  TS-TIMESTAMP                    PIC  X(26)  VALUE SPACES.    00810053
008200 01  FILLER REDEFINES TS-TIMESTAMP.                               00820053
008300   05  TS-DATE                       PIC  X(10).                  00830053
008400   05  FILLER                        PIC  X(01).                  00840053
008500   05  TS-HOUR                       PIC  X(02).                  00850053
008600   05  FILLER                        PIC  X(01).                  00860053
008700   05  TS-MINUTE                     PIC  X(02).                  00870053
008800   05  FILLER                        PIC  X(01).                  00880053
008900   05  TS-SECOND                     PIC  X(02).                  00890053
009000   05  FILLER                        PIC  X(01).                  00900053
009100   05  TS-MICROSEC                   PIC  X(06).                  00910053
009200                                                                  00920053
009300******************************************************************00930053
009400* PROGRAM CONSTANTS                                               00940053
009500******************************************************************00950053
009600 01  PC-PROGRAM-CONSTANTS.                                        00960053
009700   05  PC-BUS-RULE-ENGINE            PIC  X(08)  VALUE 'XSKUT036'.00970053
009800   05  PC-BUS-RULE-ENGINE-BATCH      PIC  X(08)  VALUE 'XSKUT037'.00980053
009900   05  PC-ALL-TICKET                 PIC  X(01)  VALUE 'A'.       00990053
010000   05  PC-YELLOW-TICKET              PIC  X(01)  VALUE 'F'.       01000053
010100   05  PC-RED-TICKET                 PIC  X(01)  VALUE 'C'.       01010053
010200   05  PC-ZERO-TIME                  PIC  X(08)  VALUE '00.00.00'.01020053
010300   05  PC-NBR-OF-TIERS               PIC S9(04)  VALUE +10        01030053
010400                                                  COMP SYNC.      01040053
010500                                                                  01050053
010600******************************************************************01060053
010700* PROGRAM VARIBLES                                                01070053
010800******************************************************************01080053
010900 01  PV-PROGRAM-VARIBLES.                                         01090053
011000   05  PV-ADV-CDE-NULL-IND           PIC S9(04)  VALUE +0         01100053
011100                                                  COMP SYNC.      01110053
011200   05  PV-GP-RTL-QTY-NULL-IND        PIC S9(04)  VALUE +0         01120053
011300                                                  COMP SYNC.      01130053
011400   05  PV-GP-RTL-AMT-NULL-IND        PIC S9(04)  VALUE +0         01140053
011500                                                  COMP SYNC.      01150053
011510   05  PV-UNT-RTL-AMT-NULL-IND       PIC S9(04)  VALUE +0         01151058
011520                                                  COMP SYNC.      01152058
011600   05  PV-INDEX                      PIC  9(04)  VALUE ZEROES.    01160053
011700   05  PV-SUB                        PIC  9(04)  VALUE ZEROES     01170053
011800                                                  COMP SYNC.      01180053
011900   05  PV-STR                        PIC S9(04)  VALUE 0          01190053
012000                                                  COMP.           01200053
012100   05  PV-DT                         PIC  X(10)  VALUE SPACES.    01210053
012200   05  PV-DATE REDEFINES PV-DT.                                   01220053
012300     10  PV-DATE-CC                  PIC  X(02).                  01230053
012400     10  PV-DATE-YY                  PIC  X(02).                  01240053
012500     10  PV-DATE-HY1                 PIC  X(01).                  01250053
012600     10  PV-DATE-MM                  PIC  X(02).                  01260053
012700     10  PV-DATE-HY2                 PIC  X(01).                  01270053
012800     10  PV-DATE-DD                  PIC  X(02).                  01280053
012900   05  PV-TM                         PIC  X(08)  VALUE SPACES.    01290053
013000   05  PV-TIME REDEFINES PV-TM.                                   01300053
013100     10  PV-TIME-HH                  PIC  X(02).                  01310053
013200     10  PV-TIME-CO1                 PIC  X(01).                  01320053
013300     10  PV-TIME-MM                  PIC  X(02).                  01330053
013400     10  PV-TIME-CO2                 PIC  X(01).                  01340053
013500     10  PV-TIME-SS                  PIC  X(02).                  01350053
                                                                        01351084
      ******************************************************************01352084
      *    PV-HOST-VAR-DTE CREATED ON RECOMMENDATION OF DBA TO OBTAIN   01353084
      *    AN ACCEPTABLE ACCESS PATH                                    01354084
           05  PV-HOST-VAR-DTE             PIC  X(10)  VALUE            01355084
               '0001-01-01'.                                            01356084
      ******************************************************************01357084
                                                                        01358084
013600   05  PV-PROMO-ID                   PIC S9(10)V VALUE 0          01360053
013700                                                  COMP-3.         01370053
013800   05  PV-PROMO-INTFC-SUB-ID         PIC S9(10)V VALUE 0          01380053
013900                                                  COMP-3.         01390053
014000   05  PV-INTR-UPC-ID                PIC S9(09)  VALUE 0          01400053
014100                                                  COMP.           01410053
014200   05  PV-INTR-UPC-ID-10             PIC S9(10)  VALUE 0          01420053
014300                                                  COMP.           01430053
014400   05  PV-SKU                        PIC S9(08)  VALUE 0          01440053
014500                                                  COMP-3.         01450053
014600   05  PV-UPC                        PIC S9(15)  VALUE 0          01460053
014700                                                  COMP-3.         01470053
014800   05  PV-UPC-16                     PIC S9(16)  VALUE 0          01480053
014900                                                  COMP-3.         01490053
015000   05  PV-DISC-GP-QTY                PIC S9(04)  VALUE 0          01500053
015100                                                  COMP.           01510053
015200   05  PV-DISC-PRCG-AMT              PIC S9(07)V9(03)             01520053
015300                                                 VALUE ZEROES     01530053
015400                                                  COMP-3.         01540053
015500   05  PV-EXCL-EXISTS                PIC S9(04)  VALUE ZEROES     01550053
015600                                                  COMP SYNC.      01560053
015700   05  PV-FUT-PERM-STATUS-CDE        PIC  X(02)  VALUE SPACES.    01570053
016000   05  PV-PROMO-STRT-TMST            PIC  X(26)  VALUE SPACES.    01600053
016100   05  PV-STRT-TMST REDEFINES PV-PROMO-STRT-TMST.                 01610053
016200     10  PV-STRT-DT                  PIC  X(10).                  01620053
016300     10  FILLER                      PIC  X(01).                  01630053
016400     10  PV-STRT-TM.                                              01640053
016500       15  PV-STRT-TM-HM             PIC  X(05).                  01650053
016600       15  FILLER                    PIC  X(01).                  01660053
016700       15  PV-STRT-TM-SC             PIC  X(02).                  01670053
016800     10  FILLER                      PIC  X(01).                  01680053
016900     10  PV-STRT-SS                  PIC  X(06).                  01690053
017000                                                                  01700053
017100   05  PV-PROMO-END-TMST             PIC  X(26)  VALUE SPACES.    01710053
017200   05  PV-END-TMST REDEFINES PV-PROMO-END-TMST.                   01720053
017300     10  PV-END-DT                   PIC  X(10).                  01730053
017400     10  FILLER                      PIC  X(01).                  01740053
017500     10  PV-END-TM.                                               01750053
017600       15  PV-END-TM-HM              PIC  X(05).                  01760053
017700       15  FILLER                    PIC  X(01).                  01770053
017800       15  PV-END-TM-SC              PIC  X(02).                  01780053
017900     10  FILLER                      PIC  X(01).                  01790053
018000     10  PV-END-SS                   PIC  X(06).                  01800053
018100                                                                  01810053
018200   05  PV-FULL-TMST                  PIC  X(26)  VALUE SPACES.    01820053
018300   05  PV-TMST  REDEFINES PV-FULL-TMST.                           01830053
018400     10  PV-TMST-DATE                PIC  X(10).                  01840053
018500     10  PV-TMST-HYPHEN1             PIC  X(01).                  01850053
018600     10  PV-TMST-TIME                PIC  X(08).                  01860053
018700     10  PV-TMST-DOT1                PIC  X(01).                  01870053
018800     10  PV-TMST-SUBS                PIC  X(06).                  01880053
         05  PV-CONTCLR-PRCHG-EFF-DTE      PIC  X(10)  VALUE SPACES.    01881078
018900                                                                  01890053
019000 01  HV-PGM-HOLD-VARIBLES.                                        01900053
019100   05  HV-UNT-RTL-AMT                PIC S9(07)V9(02)             01910065
019110                                                 COMP-3           01911065
019200                                                 VALUE ZEROES.    01920053
019300   05  HV-GP-RTL-QTY                 PIC  9(05)  VALUE ZEROES.    01930053
019400   05  HV-GP-RTL-AMT                 PIC  9(07)V9(02)             01940053
019500                                                 VALUE ZEROES.    01950053
019600   05  HV-LOC-SKU-STAT-CDE           PIC  X(02)  VALUE SPACES.    01960053
019700   05  HV-UNT-RTL-CHG-DTE            PIC  X(10)  VALUE SPACES.    01970053
019800   05  HV-UPC-STAT-CHG-DTE           PIC  X(10)  VALUE SPACES.    01980053
019900                                                                  01990053
020000******************************************************************02000053
020100* COPYBOOKS                                                       02010053
020200******************************************************************02020053
020300                                                                  02030053
020400***BUSISNESS RULE LAYOUT COPYBOOK                                 02040053
020500     COPY XSRD045.                                                02050053
020600                                                                  02060053
020700***VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004        02070053
020800     COPY DPWS004.                                                02080053
020900                                                                  02090053
021000***DB2 MESSAGE AREA                                               02100053
021100     COPY SQLCA2.                                                 02110053
021200                                                                  02120053
021300******************************************************************02130053
021400* TABLE INCLUSIONS                                                02140053
021500******************************************************************02150053
021600     EXEC SQL INCLUDE SQLCA    END-EXEC.                          02160053
021700                                                                  02170053
021800*  XST_MDSE_LNE_SELN L                                            02180053
021900     EXEC SQL INCLUDE XST00028 END-EXEC.                          02190053
022000                                                                  02200053
022100*  XST_PROMO P                                                    02210053
022200     EXEC SQL INCLUDE XST00026 END-EXEC.                          02220053
022300                                                                  02230053
022400*  XST_SKU S                                                      02240053
022500     EXEC SQL INCLUDE XST00010 END-EXEC.                          02250053
022600                                                                  02260053
022700*  XST_SKU_LOC L                                                  02270053
022800     EXEC SQL INCLUDE XST00008 END-EXEC.                          02280053
022900                                                                  02290053
023000*  XST_UPC U                                                      02300053
023100     EXEC SQL INCLUDE XST00012 END-EXEC.                          02310053
023200                                                                  02320053
023300*  XST_VND_STYL Y                                                 02330053
023400     EXEC SQL INCLUDE XST00013 END-EXEC.                          02340053
023500                                                                  02350053
023600*  XST_TIER_PRICG                                                 02360053
023700     EXEC SQL INCLUDE XST00035 END-EXEC.                          02370053
023800                                                                  02380053
023900*  XST_SMP_PRICG                                                  02390053
024000     EXEC SQL INCLUDE XST00030 END-EXEC.                          02400053
024100                                                                  02410053
024200*  XST_EXCL_MDSE E                                                02420053
024300     EXEC SQL INCLUDE XST00034 END-EXEC.                          02430053
024400                                                                  02440053
024500*  XST_PROMO_ADHC_RLT A                                           02450053
024600     EXEC SQL INCLUDE XST00031 END-EXEC.                          02460053
024700                                                                  02470053
024800*  XST_ADHC_STR_GP G                                              02480053
024900     EXEC SQL INCLUDE XST00036 END-EXEC.                          02490053
025000                                                                  02500053
025100*  XST_PROMO_ADHC_STR S                                           02510053
025200     EXEC SQL INCLUDE XST00033 END-EXEC.                          02520053
025300                                                                  02530053
025400* XST_PRCHG  PRCHG                                                02540053
025500     EXEC SQL INCLUDE XST00063 END-EXEC.                          02550053
025600                                                                  02560053
025700* XST_STR_GP_PRCHG  STRGP                                         02570053
025800     EXEC SQL INCLUDE XST00064 END-EXEC.                          02580053
025900                                                                  02590053
026000* XST_PRCHG_MDSE  MDSE                                            02600053
026100     EXEC SQL INCLUDE XST00065 END-EXEC.                          02610053
026200                                                                  02620053
026600* XST_PRICG_GRID_DTL  GRIDDTL                                     02660064
026700     EXEC SQL INCLUDE XST00085 END-EXEC.                          02670064
026800                                                                  02680053
026900* XST_STR_GP_MBSHP M                                              02690053
027000     EXEC SQL INCLUDE XST00023 END-EXEC.                          02700053
027100                                                                  02710053
027200* XST_PROMO_STR_GP G                                              02720053
027300     EXEC SQL INCLUDE XST00029 END-EXEC.                          02730053
027400                                                                  02740053
027500******************************************************************02750053
027600* GET CLEARANCE PRICE - PRICED AT SKU LEVEL W/NO PROMO ID         02760053
027700******************************************************************02770053
027800     EXEC SQL                                                     02780053
027900          DECLARE SKU-CLR-NOID-CSR CURSOR FOR                     02790053
028000           SELECT L.PROMO_INTFC_ID                                02800053
028100                , L.MDSE_LNE_ID                                   02810053
028200                , L.PRICG_TYP_CDE                                 02820053
028300                , L.ADV_CDE                                       02830053
028400                , L.PROMO_ID                                      02840053
028500                , L.TKT_CLOR_CDE                                  02850053
028600             FROM XST_PROMO P                                     02860053
028700                , XST_MDSE_LNE_SELN L                             02870053
028800            WHERE P.PROMO_TYP_CDE      = 'C'                      02880053
028900              AND P.STAT_CDE           = 'S'                      02890053
029000              AND (P.DFLT_STRT_TMST - 3 DAYS) <= :PV-FULL-TMST    02900053
029100              AND (P.DFLT_END_TMST + 3 DAYS)  >= :PV-FULL-TMST    02910053
029200              AND L.PROMO_ID           = P.PROMO_ID               02920053
029300              AND L.STAT_CDE           = P.STAT_CDE               02930053
029400              AND L.SKU_NBR            = :XST00010-SKU-NBR        02940053
029500              AND L.MDSE_HIER_CDE      = 'SKU'                    02950053
029600             WITH UR                                              02960053
029700     END-EXEC.                                                    02970053
029800                                                                  02980053
029900******************************************************************02990053
030000* GET CLEARANCE PRICE - PRICED AT STYLE LEVEL W/NO PROMO ID       03000053
030100******************************************************************03010053
030200     EXEC SQL                                                     03020053
030300          DECLARE STY-CLR-NOID-CSR CURSOR FOR                     03030053
030400           SELECT L.PROMO_INTFC_ID                                03040053
030500                , L.MDSE_LNE_ID                                   03050053
030600                , L.PRICG_TYP_CDE                                 03060053
030700                , L.ADV_CDE                                       03070053
030800                , L.PROMO_ID                                      03080053
030900                , L.TKT_CLOR_CDE                                  03090053
031000             FROM XST_PROMO P                                     03100053
031100                , XST_MDSE_LNE_SELN L                             03110053
031300            WHERE P.PROMO_TYP_CDE      = 'C'                      03130053
031400              AND P.STAT_CDE           = 'S'                      03140053
031500              AND (P.DFLT_STRT_TMST - 3 DAYS) <= :PV-FULL-TMST    03150053
031600              AND (P.DFLT_END_TMST + 3 DAYS)  >= :PV-FULL-TMST    03160053
031700              AND L.PROMO_ID           = P.PROMO_ID               03170053
031800              AND L.STAT_CDE           = P.STAT_CDE               03180053
032300              AND L.MDSE_HIER_CDE      = 'STY'                    03230053
032400              AND L.STYL_ID            = :XST00010-STYL-ID        03240085
032500           WITH UR                                                03250053
032600     END-EXEC.                                                    03260053
032700                                                                  03270053
032800******************************************************************03280053
032900* GET CLEARANCE PRICE - PRICED AT SCL LEVEL W/NO PROMO ID         03290053
033000******************************************************************03300053
033100     EXEC SQL                                                     03310053
033200          DECLARE SCL-CLR-NOID-CSR CURSOR FOR                     03320053
033300           SELECT L.PROMO_INTFC_ID                                03330053
033400                , L.MDSE_LNE_ID                                   03340053
033500                , L.PRICG_TYP_CDE                                 03350053
033600                , L.ADV_CDE                                       03360053
033700                , L.PROMO_ID                                      03370053
033800                , L.TKT_CLOR_CDE                                  03380053
033900                , Y.MAJ_CL_NBR                                    03390053
034000                , Y.SUB_CL_NBR                                    03400053
034100             FROM XST_PROMO P                                     03410053
034200                , XST_MDSE_LNE_SELN L                             03420053
034300                , XST_VND_STYL Y                                  03430053
034400            WHERE P.PROMO_TYP_CDE      = 'C'                      03440053
034500              AND P.STAT_CDE           = 'S'                      03450053
034600              AND (P.DFLT_STRT_TMST - 3 DAYS) <= :PV-FULL-TMST    03460053
034700              AND (P.DFLT_END_TMST + 3 DAYS)  >= :PV-FULL-TMST    03470053
034800              AND L.PROMO_ID           = P.PROMO_ID               03480053
034900              AND L.STAT_CDE           = P.STAT_CDE               03490053
035000              AND L.DEPT_NBR           = Y.DEPT_NBR               03500053
035100              AND L.MAJ_CL_NBR         = Y.MAJ_CL_NBR             03510053
035200              AND L.SUB_CL_NBR         = Y.SUB_CL_NBR             03520053
035300              AND L.MDSE_HIER_CDE      = 'SCL'                    03530053
035400              AND Y.STYL_ID            = :XST00010-STYL-ID        03540053
035500             WITH UR                                              03550053
035600     END-EXEC.                                                    03560053
035700                                                                  03570053
035800******************************************************************03580053
035900* GET CLEARANCE PRICE - PRICED AT MCL LEVEL W/NO PROMO ID         03590053
036000******************************************************************03600053
036100     EXEC SQL                                                     03610053
036200          DECLARE MCL-CLR-NOID-CSR CURSOR FOR                     03620053
036300           SELECT L.PROMO_INTFC_ID                                03630053
036400                , L.MDSE_LNE_ID                                   03640053
036500                , L.PRICG_TYP_CDE                                 03650053
036600                , L.ADV_CDE                                       03660053
036700                , L.PROMO_ID                                      03670053
036800                , L.TKT_CLOR_CDE                                  03680053
036900                , Y.MAJ_CL_NBR                                    03690053
037000                , Y.SUB_CL_NBR                                    03700053
037100             FROM XST_PROMO P                                     03710053
037200                , XST_MDSE_LNE_SELN L                             03720053
037300                , XST_VND_STYL Y                                  03730053
037400            WHERE P.PROMO_TYP_CDE      = 'C'                      03740053
037500              AND P.STAT_CDE           = 'S'                      03750053
037600              AND (P.DFLT_STRT_TMST - 3 DAYS) <= :PV-FULL-TMST    03760053
037700              AND (P.DFLT_END_TMST + 3 DAYS)  >= :PV-FULL-TMST    03770053
037800              AND L.PROMO_ID           = P.PROMO_ID               03780053
037900              AND L.STAT_CDE           = P.STAT_CDE               03790053
038000              AND L.DEPT_NBR           = Y.DEPT_NBR               03800053
038100              AND L.MAJ_CL_NBR         = Y.MAJ_CL_NBR             03810053
038200              AND L.MDSE_HIER_CDE      = 'MCL'                    03820053
038300              AND Y.STYL_ID            = :XST00010-STYL-ID        03830053
038400             WITH UR                                              03840053
038500     END-EXEC.                                                    03850053
038600                                                                  03860053
038700******************************************************************03870053
038800* GET CLEARANCE PRICE - PRICED AT DPT LEVEL W/NO PROMO ID         03880053
038900******************************************************************03890053
039000     EXEC SQL                                                     03900053
039100          DECLARE DPT-CLR-NOID-CSR CURSOR FOR                     03910053
039200           SELECT L.PROMO_INTFC_ID                                03920053
039300                , L.MDSE_LNE_ID                                   03930053
039400                , L.PRICG_TYP_CDE                                 03940053
039500                , L.ADV_CDE                                       03950053
039600                , L.PROMO_ID                                      03960053
039700                , L.TKT_CLOR_CDE                                  03970053
039800                , Y.MAJ_CL_NBR                                    03980053
039900                , Y.SUB_CL_NBR                                    03990053
040000             FROM XST_PROMO P                                     04000053
040100                , XST_MDSE_LNE_SELN L                             04010053
040200                , XST_VND_STYL Y                                  04020053
040300            WHERE P.PROMO_TYP_CDE      = 'C'                      04030053
040400              AND P.STAT_CDE           = 'S'                      04040053
040500              AND (P.DFLT_STRT_TMST - 3 DAYS) <= :PV-FULL-TMST    04050053
040600              AND (P.DFLT_END_TMST + 3 DAYS)  >= :PV-FULL-TMST    04060053
040700              AND L.PROMO_ID           = P.PROMO_ID               04070053
040800              AND L.STAT_CDE           = P.STAT_CDE               04080053
040900              AND L.DEPT_NBR           = Y.DEPT_NBR               04090053
041000              AND L.MDSE_HIER_CDE      = 'DPT'                    04100053
041100              AND Y.STYL_ID            = :XST00010-STYL-ID        04110053
041200           WITH UR                                                04120053
041300     END-EXEC.                                                    04130053
041400                                                                  04140053
041500******************************************************************04150053
041600* GET CLEARANCE PRICE - PRICED AT SKU LEVEL W/ PROMO ID           04160053
041700******************************************************************04170053
041800     EXEC SQL                                                     04180053
041900          DECLARE SKU-CLR-WID-CSR CURSOR FOR                      04190053
042000           SELECT L.PROMO_INTFC_ID                                04200053
042100                , L.MDSE_LNE_ID                                   04210053
042200                , L.PRICG_TYP_CDE                                 04220053
042300                , L.ADV_CDE                                       04230053
042400                , L.PROMO_ID                                      04240053
042500                , L.TKT_CLOR_CDE                                  04250053
042600             FROM XST_PROMO P                                     04260053
042700                , XST_MDSE_LNE_SELN L                             04270053
042800            WHERE P.PROMO_TYP_CDE = 'C'                           04280053
042900              AND P.STAT_CDE      = 'S'                           04290053
043000              AND P.AD_EVNT_ID   IS NULL                          04300053
043100              AND P.PROMO_ID      = :PV-PROMO-ID                  04310053
043200              AND L.PROMO_ID      = P.PROMO_ID                    04320053
043300              AND L.STAT_CDE      = P.STAT_CDE                    04330053
043400              AND L.SKU_NBR       = :XST00010-SKU-NBR             04340053
043500              AND L.MDSE_HIER_CDE = 'SKU'                         04350053
043600             WITH UR                                              04360053
043700     END-EXEC.                                                    04370053
043800                                                                  04380053
043900******************************************************************04390053
044000* GET CLEARANCE PRICE - PRICED AT STYLE LEVEL W/ PROMO ID         04400053
044100******************************************************************04410053
044200     EXEC SQL                                                     04420053
044300          DECLARE STY-CLR-WID-CSR CURSOR FOR                      04430053
044400           SELECT L.PROMO_INTFC_ID                                04440053
044500                , L.MDSE_LNE_ID                                   04450053
044600                , L.PRICG_TYP_CDE                                 04460053
044700                , L.ADV_CDE                                       04470053
044800                , L.PROMO_ID                                      04480053
044900                , L.TKT_CLOR_CDE                                  04490053
045000             FROM XST_PROMO P                                     04500053
045100                , XST_MDSE_LNE_SELN L                             04510053
045300            WHERE P.PROMO_TYP_CDE = 'C'                           04530053
045400              AND P.STAT_CDE      = 'S'                           04540053
045500              AND P.AD_EVNT_ID   IS NULL                          04550053
045600              AND P.PROMO_ID      = :PV-PROMO-ID                  04560053
045700              AND L.PROMO_ID      = P.PROMO_ID                    04570053
045800              AND L.STAT_CDE      = P.STAT_CDE                    04580053
046300              AND L.MDSE_HIER_CDE = 'STY'                         04630053
046400              AND L.STYL_ID       = :XST00010-STYL-ID             04640085
046500           WITH UR                                                04650053
046600     END-EXEC.                                                    04660053
046700                                                                  04670053
046800******************************************************************04680053
046900* GET CLEARANCE PRICE - PRICED AT SCL LEVEL W/ PROMO ID           04690053
047000******************************************************************04700053
047100     EXEC SQL                                                     04710053
047200          DECLARE SCL-CLR-WID-CSR CURSOR FOR                      04720053
047300           SELECT L.PROMO_INTFC_ID                                04730053
047400                , L.MDSE_LNE_ID                                   04740053
047500                , L.PRICG_TYP_CDE                                 04750053
047600                , L.ADV_CDE                                       04760053
047700                , L.PROMO_ID                                      04770053
047800                , L.TKT_CLOR_CDE                                  04780053
047900                , Y.MAJ_CL_NBR                                    04790053
048000                , Y.SUB_CL_NBR                                    04800053
048100             FROM XST_PROMO P                                     04810053
048200                , XST_MDSE_LNE_SELN L                             04820053
048300                , XST_VND_STYL Y                                  04830053
048400            WHERE P.PROMO_TYP_CDE = 'C'                           04840053
048500              AND P.STAT_CDE      = 'S'                           04850053
048600              AND P.AD_EVNT_ID   IS NULL                          04860053
048700              AND P.PROMO_ID      = :PV-PROMO-ID                  04870053
048800              AND L.PROMO_ID      = P.PROMO_ID                    04880053
048900              AND L.STAT_CDE      = P.STAT_CDE                    04890053
049000              AND L.DEPT_NBR      = Y.DEPT_NBR                    04900053
049100              AND L.MAJ_CL_NBR    = Y.MAJ_CL_NBR                  04910053
049200              AND L.SUB_CL_NBR    = Y.SUB_CL_NBR                  04920053
049300              AND L.MDSE_HIER_CDE = 'SCL'                         04930053
049400              AND Y.STYL_ID       = :XST00010-STYL-ID             04940053
049500           WITH UR                                                04950053
049600     END-EXEC.                                                    04960053
049700                                                                  04970053
049800******************************************************************04980053
049900* GET CLEARANCE PRICE - PRICED AT MCL LEVEL W/ PROMO ID           04990053
050000******************************************************************05000053
050100     EXEC SQL                                                     05010053
050200          DECLARE MCL-CLR-WID-CSR CURSOR FOR                      05020053
050300           SELECT L.PROMO_INTFC_ID                                05030053
050400                , L.MDSE_LNE_ID                                   05040053
050500                , L.PRICG_TYP_CDE                                 05050053
050600                , L.TKT_CLOR_CDE                                  05060053
050700                , Y.MAJ_CL_NBR                                    05070053
050800                , Y.SUB_CL_NBR                                    05080053
050900                , L.ADV_CDE                                       05090053
051000                , L.PROMO_ID                                      05100053
051100             FROM XST_PROMO P                                     05110053
051200                , XST_MDSE_LNE_SELN L                             05120053
051300                , XST_VND_STYL Y                                  05130053
051400            WHERE P.PROMO_TYP_CDE = 'C'                           05140053
051500              AND P.STAT_CDE      = 'S'                           05150053
051600              AND P.AD_EVNT_ID   IS NULL                          05160053
051700              AND P.PROMO_ID      = :PV-PROMO-ID                  05170053
051800              AND L.PROMO_ID      = P.PROMO_ID                    05180053
051900              AND L.STAT_CDE      = P.STAT_CDE                    05190053
052000              AND L.DEPT_NBR      = Y.DEPT_NBR                    05200053
052100              AND L.MAJ_CL_NBR    = Y.MAJ_CL_NBR                  05210053
052200              AND L.MDSE_HIER_CDE = 'MCL'                         05220053
052300              AND Y.STYL_ID       = :XST00010-STYL-ID             05230053
052400             WITH UR                                              05240053
052500     END-EXEC.                                                    05250053
052600                                                                  05260053
052700******************************************************************05270053
052800* GET CLEARANCE PRICE - PRICED AT DPT LEVEL W/ PROMO ID           05280053
052900******************************************************************05290053
053000     EXEC SQL                                                     05300053
053100          DECLARE DPT-CLR-WID-CSR CURSOR FOR                      05310053
053200           SELECT L.PROMO_INTFC_ID                                05320053
053300                , L.MDSE_LNE_ID                                   05330053
053400                , L.PRICG_TYP_CDE                                 05340053
053500                , L.ADV_CDE                                       05350053
053600                , L.PROMO_ID                                      05360053
053700                , L.TKT_CLOR_CDE                                  05370053
053800                , Y.MAJ_CL_NBR                                    05380053
053900                , Y.SUB_CL_NBR                                    05390053
054000             FROM XST_PROMO P                                     05400053
054100                , XST_MDSE_LNE_SELN L                             05410053
054200                , XST_VND_STYL Y                                  05420053
054300            WHERE P.PROMO_TYP_CDE = 'C'                           05430053
054400              AND P.STAT_CDE      = 'S'                           05440053
054500              AND P.AD_EVNT_ID   IS NULL                          05450053
054600              AND P.PROMO_ID      = :PV-PROMO-ID                  05460053
054700              AND L.PROMO_ID      = P.PROMO_ID                    05470053
054800              AND L.STAT_CDE      = P.STAT_CDE                    05480053
054900              AND L.DEPT_NBR      = Y.DEPT_NBR                    05490053
055000              AND L.MDSE_HIER_CDE = 'DPT'                         05500053
055100              AND Y.STYL_ID       = :XST00010-STYL-ID             05510053
055200             WITH UR                                              05520053
055300     END-EXEC.                                                    05530053
055400                                                                  05540053
055500******************************************************************05550053
055600* GET PROMO PRICE - PRICED AT SKU LEVEL W/NO PROMO ID             05560053
055700******************************************************************05570053
055800     EXEC SQL                                                     05580053
055900          DECLARE SKU-PROMO-NOID-CSR CURSOR FOR                   05590053
056000           SELECT L.PROMO_INTFC_ID                                05600053
056100                , L.MDSE_LNE_ID                                   05610053
056200                , L.PRICG_TYP_CDE                                 05620053
056300                , L.ADV_CDE                                       05630053
056400                , L.PROMO_ID                                      05640053
056500                , P.REG_PROMO_TYP_CDE                             05650053
056600             FROM XST_PROMO P                                     05660053
056700                , XST_MDSE_LNE_SELN L                             05670053
056800            WHERE P.PROMO_TYP_CDE      = 'R'                      05680053
056900              AND P.STAT_CDE           = 'S'                      05690053
057000              AND (P.DFLT_STRT_TMST - 3 DAYS) <= :PV-FULL-TMST    05700053
057100              AND (P.DFLT_END_TMST + 3 DAYS)  >= :PV-FULL-TMST    05710053
057200              AND L.PROMO_ID           = P.PROMO_ID               05720053
057300              AND L.STAT_CDE           = P.STAT_CDE               05730053
057400              AND L.SKU_NBR            = :XST00010-SKU-NBR        05740053
057500              AND L.MDSE_HIER_CDE      = 'SKU'                    05750053
057600             WITH UR                                              05760053
057700     END-EXEC.                                                    05770053
057800                                                                  05780053
057900******************************************************************05790053
058000* GET PROMO PRICE - PRICED AT STYLE LEVEL W/NO PROMO ID           05800053
058100******************************************************************05810053
058200     EXEC SQL                                                     05820053
058300          DECLARE STY-PROMO-NOID-CSR CURSOR FOR                   05830053
058400           SELECT L.PROMO_INTFC_ID                                05840053
058500                , L.MDSE_LNE_ID                                   05850053
058600                , L.PRICG_TYP_CDE                                 05860053
058700                , L.ADV_CDE                                       05870053
058800                , L.PROMO_ID                                      05880053
058900                , P.REG_PROMO_TYP_CDE                             05890053
059000             FROM XST_PROMO P                                     05900053
059100                , XST_MDSE_LNE_SELN L                             05910053
059300            WHERE P.PROMO_TYP_CDE      = 'R'                      05930053
059400              AND P.STAT_CDE           = 'S'                      05940053
059500              AND (P.DFLT_STRT_TMST - 3 DAYS) <= :PV-FULL-TMST    05950053
059600              AND (P.DFLT_END_TMST + 3 DAYS)  >= :PV-FULL-TMST    05960053
059700              AND L.PROMO_ID           = P.PROMO_ID               05970053
059800              AND L.STAT_CDE           = P.STAT_CDE               05980053
060300              AND L.MDSE_HIER_CDE      = 'STY'                    06030053
060400              AND L.STYL_ID            = :XST00010-STYL-ID        06040085
060500             WITH UR                                              06050053
060600     END-EXEC.                                                    06060053
060700                                                                  06070053
060800******************************************************************06080053
060900* GET PROMO PRICE - PRICED AT SCL LEVEL W/NO PROMO ID             06090053
061000******************************************************************06100053
061100     EXEC SQL                                                     06110053
061200          DECLARE SCL-PROMO-NOID-CSR CURSOR FOR                   06120053
061300           SELECT L.PROMO_INTFC_ID                                06130053
061400                , L.MDSE_LNE_ID                                   06140053
061500                , L.PRICG_TYP_CDE                                 06150053
061600                , L.ADV_CDE                                       06160053
061700                , L.PROMO_ID                                      06170053
061800                , P.REG_PROMO_TYP_CDE                             06180053
061900                , Y.MAJ_CL_NBR                                    06190053
062000                , Y.SUB_CL_NBR                                    06200053
062100             FROM XST_PROMO P                                     06210053
062200                , XST_MDSE_LNE_SELN L                             06220053
062300                , XST_VND_STYL Y                                  06230053
062400            WHERE P.PROMO_TYP_CDE      = 'R'                      06240053
062500              AND P.STAT_CDE           = 'S'                      06250053
062600              AND (P.DFLT_STRT_TMST - 3 DAYS) <= :PV-FULL-TMST    06260053
062700              AND (P.DFLT_END_TMST + 3 DAYS)  >= :PV-FULL-TMST    06270053
062800              AND L.PROMO_ID           = P.PROMO_ID               06280053
062900              AND L.STAT_CDE           = P.STAT_CDE               06290053
063000              AND L.DEPT_NBR           = Y.DEPT_NBR               06300053
063100              AND L.MAJ_CL_NBR         = Y.MAJ_CL_NBR             06310053
063200              AND L.SUB_CL_NBR         = Y.SUB_CL_NBR             06320053
063300              AND L.MDSE_HIER_CDE      = 'SCL'                    06330053
063400              AND Y.STYL_ID            = :XST00010-STYL-ID        06340053
063500           WITH UR                                                06350053
063600     END-EXEC.                                                    06360053
063700                                                                  06370053
063800******************************************************************06380053
063900* GET PROMO PRICE - PRICED AT MCL LEVEL W/NO PROMO ID             06390053
064000******************************************************************06400053
064100     EXEC SQL                                                     06410053
064200          DECLARE MCL-PROMO-NOID-CSR CURSOR FOR                   06420053
064300           SELECT L.PROMO_INTFC_ID                                06430053
064400                , L.MDSE_LNE_ID                                   06440053
064500                , L.PRICG_TYP_CDE                                 06450053
064600                , L.ADV_CDE                                       06460053
064700                , L.PROMO_ID                                      06470053
064800                , Y.MAJ_CL_NBR                                    06480053
064900                , Y.SUB_CL_NBR                                    06490053
065000                , P.REG_PROMO_TYP_CDE                             06500053
065100             FROM XST_PROMO P                                     06510053
065200                , XST_MDSE_LNE_SELN L                             06520053
065300                , XST_VND_STYL Y                                  06530053
065400            WHERE P.PROMO_TYP_CDE      = 'R'                      06540053
065500              AND P.STAT_CDE           = 'S'                      06550053
065600              AND (P.DFLT_STRT_TMST - 3 DAYS) <= :PV-FULL-TMST    06560053
065700              AND (P.DFLT_END_TMST + 3 DAYS)  >= :PV-FULL-TMST    06570053
065800              AND L.PROMO_ID           = P.PROMO_ID               06580053
065900              AND L.STAT_CDE           = P.STAT_CDE               06590053
066000              AND L.DEPT_NBR           = Y.DEPT_NBR               06600053
066100              AND L.MAJ_CL_NBR         = Y.MAJ_CL_NBR             06610053
066200              AND L.MDSE_HIER_CDE      = 'MCL'                    06620053
066300              AND Y.STYL_ID            = :XST00010-STYL-ID        06630053
066400             WITH UR                                              06640053
066500     END-EXEC.                                                    06650053
066600                                                                  06660053
066700******************************************************************06670053
066800* GET PROMO PRICE - PRICED AT DPT LEVEL W/NO PROMO ID             06680053
066900******************************************************************06690053
067000     EXEC SQL                                                     06700053
067100          DECLARE DPT-PROMO-NOID-CSR CURSOR FOR                   06710053
067200           SELECT L.PROMO_INTFC_ID                                06720053
067300                , L.MDSE_LNE_ID                                   06730053
067400                , L.PRICG_TYP_CDE                                 06740053
067500                , L.ADV_CDE                                       06750053
067600                , L.PROMO_ID                                      06760053
067700                , Y.MAJ_CL_NBR                                    06770053
067800                , Y.SUB_CL_NBR                                    06780053
067900                , P.REG_PROMO_TYP_CDE                             06790053
068000             FROM XST_PROMO P                                     06800053
068100                , XST_MDSE_LNE_SELN L                             06810053
068200                , XST_VND_STYL Y                                  06820053
068300            WHERE P.PROMO_TYP_CDE      = 'R'                      06830053
068400              AND P.STAT_CDE           = 'S'                      06840053
068500              AND (P.DFLT_STRT_TMST - 3 DAYS) <= :PV-FULL-TMST    06850053
068600              AND (P.DFLT_END_TMST + 3 DAYS)  >= :PV-FULL-TMST    06860053
068700              AND L.PROMO_ID           = P.PROMO_ID               06870053
068800              AND L.STAT_CDE           = P.STAT_CDE               06880053
068900              AND L.DEPT_NBR           = Y.DEPT_NBR               06890053
069000              AND L.MDSE_HIER_CDE      = 'DPT'                    06900053
069100              AND Y.STYL_ID            = :XST00010-STYL-ID        06910053
069200             WITH UR                                              06920053
069300     END-EXEC.                                                    06930053
069400                                                                  06940053
069500******************************************************************06950053
069600* GET PROMO PRICE - PRICED AT SKU LEVEL W/ PROMO ID               06960053
069700******************************************************************06970053
069800     EXEC SQL                                                     06980053
069900          DECLARE SKU-PROMO-WID-CSR CURSOR FOR                    06990053
070000           SELECT L.PROMO_INTFC_ID                                07000053
070100                , L.MDSE_LNE_ID                                   07010053
070200                , L.PRICG_TYP_CDE                                 07020053
070300                , L.ADV_CDE                                       07030053
070400                , L.PROMO_ID                                      07040053
070500                , P.REG_PROMO_TYP_CDE                             07050053
070600             FROM XST_PROMO P                                     07060053
070700                , XST_MDSE_LNE_SELN L                             07070053
070800            WHERE P.PROMO_TYP_CDE = 'R'                           07080053
070900              AND P.STAT_CDE      = 'S'                           07090053
071000              AND P.AD_EVNT_ID    > 0                             07100053
071100              AND P.PROMO_ID      = :PV-PROMO-ID                  07110053
071200              AND L.PROMO_ID      = P.PROMO_ID                    07120053
071300              AND L.STAT_CDE      = P.STAT_CDE                    07130053
071400              AND L.SKU_NBR       = :XST00010-SKU-NBR             07140053
071500              AND L.MDSE_HIER_CDE = 'SKU'                         07150053
071600             WITH UR                                              07160053
071700     END-EXEC.                                                    07170053
071800                                                                  07180053
071900******************************************************************07190053
072000* GET PROMO PRICE - PRICED AT STYLE LEVEL W/ PROMO ID             07200053
072100******************************************************************07210053
072200     EXEC SQL                                                     07220053
072300          DECLARE STY-PROMO-WID-CSR CURSOR FOR                    07230053
072400           SELECT L.PROMO_INTFC_ID                                07240053
072500                , L.MDSE_LNE_ID                                   07250053
072600                , L.PRICG_TYP_CDE                                 07260053
072700                , L.ADV_CDE                                       07270053
072800                , L.PROMO_ID                                      07280053
072900                , P.REG_PROMO_TYP_CDE                             07290053
073000             FROM XST_PROMO P                                     07300053
073100                , XST_MDSE_LNE_SELN L                             07310053
073300            WHERE P.PROMO_TYP_CDE = 'R'                           07330053
073400              AND P.STAT_CDE      = 'S'                           07340053
073500              AND P.AD_EVNT_ID    > 0                             07350053
073600              AND P.PROMO_ID      = :PV-PROMO-ID                  07360053
073700              AND L.PROMO_ID      = P.PROMO_ID                    07370053
073800              AND L.STAT_CDE      = P.STAT_CDE                    07380053
074300              AND L.MDSE_HIER_CDE = 'STY'                         07430053
074400              AND L.STYL_ID       = :XST00010-STYL-ID             07440085
074500             WITH UR                                              07450053
074600     END-EXEC.                                                    07460053
074700                                                                  07470053
074800******************************************************************07480053
074900* GET PROMO PRICE - PRICED AT SCL LEVEL W/ PROMO ID               07490053
075000******************************************************************07500053
075100     EXEC SQL                                                     07510053
075200          DECLARE SCL-PROMO-WID-CSR CURSOR FOR                    07520053
075300           SELECT L.PROMO_INTFC_ID                                07530053
075400                , L.MDSE_LNE_ID                                   07540053
075500                , L.PRICG_TYP_CDE                                 07550053
075600                , L.ADV_CDE                                       07560053
075700                , L.PROMO_ID                                      07570053
075800                , P.REG_PROMO_TYP_CDE                             07580053
075900                , Y.MAJ_CL_NBR                                    07590053
076000                , Y.SUB_CL_NBR                                    07600053
076100             FROM XST_PROMO P                                     07610053
076200                , XST_MDSE_LNE_SELN L                             07620053
076300                , XST_VND_STYL Y                                  07630053
076400            WHERE P.PROMO_TYP_CDE = 'R'                           07640053
076500              AND P.STAT_CDE      = 'S'                           07650053
076600              AND P.AD_EVNT_ID    > 0                             07660053
076700              AND P.PROMO_ID      = :PV-PROMO-ID                  07670053
076800              AND L.PROMO_ID      = P.PROMO_ID                    07680053
076900              AND L.STAT_CDE      = P.STAT_CDE                    07690053
077000              AND L.DEPT_NBR      = Y.DEPT_NBR                    07700053
077100              AND L.MAJ_CL_NBR    = Y.MAJ_CL_NBR                  07710053
077200              AND L.SUB_CL_NBR    = Y.SUB_CL_NBR                  07720053
077300              AND L.MDSE_HIER_CDE = 'SCL'                         07730053
077400              AND Y.STYL_ID       = :XST00010-STYL-ID             07740053
077500             WITH UR                                              07750053
077600     END-EXEC.                                                    07760053
077700                                                                  07770053
077800******************************************************************07780053
077900* GET PROMO PRICE - PRICED AT MCL LEVEL W/ PROMO ID               07790053
078000******************************************************************07800053
078100     EXEC SQL                                                     07810053
078200          DECLARE MCL-PROMO-WID-CSR CURSOR FOR                    07820053
078300           SELECT L.PROMO_INTFC_ID                                07830053
078400                , L.MDSE_LNE_ID                                   07840053
078500                , L.PRICG_TYP_CDE                                 07850053
078600                , L.ADV_CDE                                       07860053
078700                , L.PROMO_ID                                      07870053
078800                , Y.MAJ_CL_NBR                                    07880053
078900                , Y.SUB_CL_NBR                                    07890053
079000                , P.REG_PROMO_TYP_CDE                             07900053
079100             FROM XST_PROMO P                                     07910053
079200                , XST_MDSE_LNE_SELN L                             07920053
079300                , XST_VND_STYL Y                                  07930053
079400            WHERE P.PROMO_TYP_CDE = 'R'                           07940053
079500              AND P.STAT_CDE      = 'S'                           07950053
079600              AND P.AD_EVNT_ID    > 0                             07960053
079700              AND P.PROMO_ID      = :PV-PROMO-ID                  07970053
079800              AND L.PROMO_ID      = P.PROMO_ID                    07980053
079900              AND L.STAT_CDE      = P.STAT_CDE                    07990053
080000              AND L.DEPT_NBR      = Y.DEPT_NBR                    08000053
080100              AND L.MAJ_CL_NBR    = Y.MAJ_CL_NBR                  08010053
080200              AND L.MDSE_HIER_CDE = 'MCL'                         08020053
080300              AND Y.STYL_ID       = :XST00010-STYL-ID             08030053
080400             WITH UR                                              08040053
080500     END-EXEC.                                                    08050053
080600                                                                  08060053
080700******************************************************************08070053
080800* GET PROMO PRICE - PRICED AT DPT LEVEL W/ PROMO ID               08080053
080900******************************************************************08090053
081000     EXEC SQL                                                     08100053
081100          DECLARE DPT-PROMO-WID-CSR CURSOR FOR                    08110053
081200           SELECT L.PROMO_INTFC_ID                                08120053
081300                , L.MDSE_LNE_ID                                   08130053
081400                , L.PRICG_TYP_CDE                                 08140053
081500                , L.ADV_CDE                                       08150053
081600                , L.PROMO_ID                                      08160053
081700                , Y.MAJ_CL_NBR                                    08170053
081800                , Y.SUB_CL_NBR                                    08180053
081900                , P.REG_PROMO_TYP_CDE                             08190053
082000             FROM XST_PROMO P                                     08200053
082100                , XST_MDSE_LNE_SELN L                             08210053
082200                , XST_VND_STYL Y                                  08220053
082300            WHERE P.PROMO_TYP_CDE = 'R'                           08230053
082400              AND P.STAT_CDE      = 'S'                           08240053
082500              AND P.AD_EVNT_ID    > 0                             08250053
082600              AND P.PROMO_ID      = :PV-PROMO-ID                  08260053
082700              AND L.PROMO_ID      = P.PROMO_ID                    08270053
082800              AND L.STAT_CDE      = P.STAT_CDE                    08280053
082900              AND L.DEPT_NBR      = Y.DEPT_NBR                    08290053
083000              AND L.MDSE_HIER_CDE = 'DPT'                         08300053
083100              AND Y.STYL_ID       = :XST00010-STYL-ID             08310053
083200             WITH UR                                              08320053
083300     END-EXEC.                                                    08330053
083400                                                                  08340053
083500******************************************************************08350053
083600* GET STANDARD STORE GROUP CURSOR                                 08360053
083700******************************************************************08370053
083800     EXEC SQL                                                     08380053
083900          DECLARE STD-STORE-GRP-CSR CURSOR FOR                    08390053
084000           SELECT G.PROMO_STRT_TMST                               08400053
084100                , G.PROMO_END_TMST                                08410053
084200                , G.STR_SELN_HIER_CDE                             08420053
084300             FROM XST_PROMO_STR_GP G                              08430053
084400                , XST_STR_GP_MBSHP M                              08440053
084500            WHERE G.PROMO_INTFC_ID   = :XST00028-PROMO-INTFC-ID   08450053
084600              AND G.MDSE_LNE_ID      = :XST00028-MDSE-LNE-ID      08460053
084700              AND G.STAT_CDE         = 'S'                        08470053
084800              AND G.PROMO_STRT_TMST <= :PV-FULL-TMST              08480053
084900              AND G.PROMO_END_TMST  >= :PV-FULL-TMST              08490053
085000              AND M.STR_GP_TYP_CDE   = G.STR_GP_TYP_CDE           08500053
085100              AND M.STR_GP_ID        = G.STR_GP_ID                08510053
085200              AND M.STR_NBR          = :PV-STR                    08520053
085300              AND M.EFF_BEG_DTE     <= :PV-DT                     08530053
085400              AND (M.EFF_END_DTE    >= :PV-DT                     08540053
085500               OR M.EFF_END_DTE     IS NULL)                      08550053
085600            ORDER BY G.STR_SELN_HIER_CDE DESC                     08560053
085700             WITH UR                                              08570053
085800      END-EXEC.                                                   08580053
085900                                                                  08590053
086000******************************************************************08600053
086100* GET AD-HOC STORE GROUP CURSOR                                   08610053
086200******************************************************************08620053
086300     EXEC SQL                                                     08630053
086400          DECLARE AD-HOC-STR-GRP-CSR CURSOR FOR                   08640053
086500           SELECT A.PROMO_STRT_TMST                               08650053
086600                , A.PROMO_END_TMST                                08660053
086700                , A.STR_SELN_HIER_CDE                             08670053
086800             FROM XST_PROMO_ADHC_RLT A                            08680053
086900                , XST_ADHC_STR_GP G                               08690053
087000                , XST_PROMO_ADHC_STR S                            08700053
087100            WHERE A.PROMO_INTFC_ID   = :XST00028-PROMO-INTFC-ID   08710053
087200              AND A.MDSE_LNE_ID      = :XST00028-MDSE-LNE-ID      08720053
087300              AND A.STAT_CDE         = 'S'                        08730053
087400              AND G.STAT_CDE         = A.STAT_CDE                 08740053
087500              AND S.STAT_CDE         = G.STAT_CDE                 08750053
087600              AND A.PROMO_STRT_TMST <= :PV-FULL-TMST              08760053
087700              AND A.PROMO_END_TMST  >= :PV-FULL-TMST              08770053
087800              AND G.ADHC_STR_GP_ID   = A.ADHC_STR_GP_ID           08780053
087900              AND S.ADHC_STR_GP_ID   = G.ADHC_STR_GP_ID           08790053
088000              AND S.STR_NBR          = :PV-STR                    08800053
088100              AND S.EFF_STRT_TMST   <= :PV-FULL-TMST              08810053
088200              AND (S.EFF_END_TMST   >= :PV-FULL-TMST              08820053
088300               OR S.EFF_END_TMST    IS NULL)                      08830053
088400            ORDER BY A.STR_SELN_HIER_CDE DESC                     08840053
088500             WITH UR                                              08850053
088600     END-EXEC.                                                    08860053
088700                                                                  08870053
088800******************************************************************08880053
088900* GET TIER (TAP) PRICING CURSOR                                   08890053
089000******************************************************************08900053
089100     EXEC SQL                                                     08910053
089200          DECLARE TAP-TIER-CSR CURSOR FOR                         08920053
089300           SELECT PROMO_INTFC_SUB_ID                              08930053
089400                , THRS_AMT                                        08940053
089500                , DISC_PCT                                        08950053
089600             FROM XST_TIER_PRICG                                  08960053
089700            WHERE PROMO_INTFC_ID = :XST00028-PROMO-INTFC-ID       08970053
089800              AND MDSE_LNE_ID    = :XST00028-MDSE-LNE-ID          08980053
089900              AND STAT_CDE       = 'S'                            08990053
090000            ORDER BY THRS_AMT                                     09000053
090100             WITH UR                                              09010053
090200     END-EXEC.                                                    09020053
090300                                                                  09030053
090400******************************************************************09040053
090500* GET TIER (TQP) PRICING CURSOR                                   09050053
090600******************************************************************09060053
090700     EXEC SQL                                                     09070053
090800          DECLARE TQP-TIER-CSR CURSOR FOR                         09080053
090900           SELECT PROMO_INTFC_SUB_ID                              09090053
091000                , THRS_QTY                                        09100053
091100                , DISC_PCT                                        09110053
091200             FROM XST_TIER_PRICG                                  09120053
091300            WHERE PROMO_INTFC_ID = :XST00028-PROMO-INTFC-ID       09130053
091400              AND MDSE_LNE_ID    = :XST00028-MDSE-LNE-ID          09140053
091500              AND STAT_CDE       = 'S'                            09150053
091600            ORDER BY THRS_QTY                                     09160053
091700             WITH UR                                              09170053
091800     END-EXEC.                                                    09180053
091900                                                                  09190053
      ******************************************************************10472073
      * GET FUTURE RED TICKET PERM EVENTS SET UP AT THE DEPT LEVEL      10473073
      * (CONTINUED CLEARANCE)                                           10474073
      ******************************************************************10475073
           EXEC SQL                                                     10476073
             DECLARE FUT-CNTCLR-DPT-CSR CURSOR FOR                      10477073
              SELECT STRGP.PRCHG_EFF_DTE                                10478073
                   , MDSE.CLR_TYP_CDE                                   10479073
                   , MDSE.PRICG_GRID_ID                                 10479173
                                                                        10479273
              FROM XST_STR_GP_PRCHG  STRGP                              10479373
                 , XST_STR_GP_MBSHP  MBSHP                              10479473
                 , XST_PRCHG_MDSE    MDSE                               10479573
                 , XST_PRCHG         PRCHG                              10479673
                                                                        10479773
              WHERE STRGP.PRCHG_EFF_DTE   <= :PV-DT                     10479873
                AND STRGP.PRCHG_EFF_DTE    > CURRENT DATE               10479986
                                                                        10480073
                AND MBSHP.STR_NBR          = :PV-STR                    10480173
                AND MBSHP.EFF_BEG_DTE     <= :PV-DT                     10480273
                AND (MBSHP.EFF_END_DTE    >= :PV-DT                     10480373
                     OR MBSHP.EFF_END_DTE IS NULL)                      10480473
                                                                        10480573
                AND MBSHP.STR_GP_TYP_CDE   = STRGP.STR_GP_TYP_CDE       10480673
                AND MBSHP.STR_GP_ID        = STRGP.STR_GP_ID            10480773
                                                                        10480873
                AND MDSE.STR_GP_TYP_CDE    = MBSHP.STR_GP_TYP_CDE       10480973
                AND MDSE.STR_GP_ID         = MBSHP.STR_GP_ID            10481073
                                                                        10481173
                AND STRGP.PRCHG_ID         = MDSE.PRCHG_ID              10481273
                AND PRCHG.PRCHG_ID         = STRGP.PRCHG_ID             10481373
                                                                        10481473
                AND MDSE.MDSE_HIER_CDE     = 'DPT'                      10481573
                AND MDSE.DEPT_NBR          = :XST00013-DEPT-NBR         10481673
                AND MDSE.MAJ_CL_NBR       IS NULL                       10481780
                AND MDSE.SUB_CL_NBR       IS NULL                       10481880
                                                                        10481980
                AND PRCHG.EVNT_CTG_CDE     = 'CON'                      10482080
                AND PRCHG.PRCHG_TYP_CDE    = 'CON'                      10482180
                AND PRCHG.PRCHG_ST_CDE     = 'APR'                      10482280
                AND PRCHG.LAST_ACTN_CDE   <> 'D'                        10482380
                AND STRGP.LAST_ACTN_CDE   <> 'D'                        10482480
                AND MDSE.LAST_ACTN_CDE    <> 'D'                        10482580
                                                                        10482680
              ORDER BY STRGP.PRCHG_EFF_DTE DESC                         10482780
              WITH UR                                                   10482880
           END-EXEC.                                                    10482980
                                                                        10483080
      ******************************************************************10483180
      * GET FUTURE RED TICKET PERM EVENTS SET UP AT THE MAJOR CLASS LVL 10483280
      * (CONTINUED CLEARANCE)                                           10483380
      ******************************************************************10483480
           EXEC SQL                                                     10483580
             DECLARE FUT-CNTCLR-MCL-CSR CURSOR FOR                      10483680
              SELECT STRGP.PRCHG_EFF_DTE                                10483780
                   , MDSE.CLR_TYP_CDE                                   10483880
                   , MDSE.PRICG_GRID_ID                                 10483980
                                                                        10484080
              FROM XST_STR_GP_PRCHG  STRGP                              10484180
                 , XST_STR_GP_MBSHP  MBSHP                              10484280
                 , XST_PRCHG_MDSE    MDSE                               10484380
                 , XST_PRCHG         PRCHG                              10484480
                                                                        10484580
              WHERE STRGP.PRCHG_EFF_DTE   <= :PV-DT                     10484680
                AND STRGP.PRCHG_EFF_DTE    > CURRENT DATE               10484786
                                                                        10484880
                AND MBSHP.STR_NBR          = :PV-STR                    10484980
                AND MBSHP.EFF_BEG_DTE     <= :PV-DT                     10485080
                AND (MBSHP.EFF_END_DTE    >= :PV-DT                     10485180
                     OR MBSHP.EFF_END_DTE IS NULL)                      10485280
                                                                        10485380
                AND MBSHP.STR_GP_TYP_CDE   = STRGP.STR_GP_TYP_CDE       10485480
                AND MBSHP.STR_GP_ID        = STRGP.STR_GP_ID            10485580
                                                                        10485680
                AND MDSE.STR_GP_TYP_CDE    = MBSHP.STR_GP_TYP_CDE       10485780
                AND MDSE.STR_GP_ID         = MBSHP.STR_GP_ID            10485880
                                                                        10485980
                AND STRGP.PRCHG_ID         = MDSE.PRCHG_ID              10486181
                AND PRCHG.PRCHG_ID         = STRGP.PRCHG_ID             10486281
                                                                        10486381
                AND MDSE.MDSE_HIER_CDE     = 'MCL'                      10486481
                AND MDSE.DEPT_NBR          = :XST00013-DEPT-NBR         10486581
                AND MDSE.MAJ_CL_NBR        = :XST00013-MAJ-CL-NBR       10486681
                AND MDSE.SUB_CL_NBR       IS NULL                       10486781
                                                                        10486881
                AND PRCHG.EVNT_CTG_CDE     = 'CON'                      10486981
                AND PRCHG.PRCHG_TYP_CDE    = 'CON'                      10487081
                AND PRCHG.PRCHG_ST_CDE     = 'APR'                      10487181
                AND PRCHG.LAST_ACTN_CDE   <> 'D'                        10487281
                AND STRGP.LAST_ACTN_CDE   <> 'D'                        10487381
                AND MDSE.LAST_ACTN_CDE    <> 'D'                        10487481
                                                                        10487581
              ORDER BY STRGP.PRCHG_EFF_DTE DESC                         10487681
              WITH UR                                                   10487781
           END-EXEC.                                                    10487881
                                                                        10487981
      ******************************************************************10488081
      * GET FUTURE RED TICKET PERM EVENTS SET UP AT THE SUB CLASS LEVEL 10488181
      * (CONTINUED CLEARANCE)                                           10488281
      ******************************************************************10488381
           EXEC SQL                                                     10488481
             DECLARE FUT-CNTCLR-SCL-CSR CURSOR FOR                      10488581
              SELECT STRGP.PRCHG_EFF_DTE                                10488681
                   , MDSE.CLR_TYP_CDE                                   10488781
                   , MDSE.PRICG_GRID_ID                                 10488881
                                                                        10488981
              FROM XST_STR_GP_PRCHG  STRGP                              10489081
                 , XST_STR_GP_MBSHP  MBSHP                              10489181
                 , XST_PRCHG_MDSE    MDSE                               10489281
                 , XST_PRCHG         PRCHG                              10489381
                                                                        10489481
              WHERE STRGP.PRCHG_EFF_DTE   <= :PV-DT                     10489581
                AND STRGP.PRCHG_EFF_DTE    > CURRENT DATE               10489686
                                                                        10489781
                AND MBSHP.STR_NBR          = :PV-STR                    10489881
                AND MBSHP.EFF_BEG_DTE     <= :PV-DT                     10489981
                AND (MBSHP.EFF_END_DTE    >= :PV-DT                     10490081
                     OR MBSHP.EFF_END_DTE IS NULL)                      10490181
                                                                        10490281
                AND MBSHP.STR_GP_TYP_CDE   = STRGP.STR_GP_TYP_CDE       10490381
                AND MBSHP.STR_GP_ID        = STRGP.STR_GP_ID            10490481
                                                                        10490581
                AND MDSE.STR_GP_TYP_CDE    = MBSHP.STR_GP_TYP_CDE       10490681
                AND MDSE.STR_GP_ID         = MBSHP.STR_GP_ID            10490781
                                                                        10490881
                AND STRGP.PRCHG_ID         = MDSE.PRCHG_ID              10490981
                AND PRCHG.PRCHG_ID         = STRGP.PRCHG_ID             10491081
                                                                        10491181
                AND MDSE.MDSE_HIER_CDE     = 'SCL'                      10491281
                AND MDSE.DEPT_NBR          = :XST00013-DEPT-NBR         10491381
                AND MDSE.MAJ_CL_NBR        = :XST00013-MAJ-CL-NBR       10491481
                AND MDSE.SUB_CL_NBR        = :XST00013-SUB-CL-NBR       10491581
                                                                        10491681
                AND PRCHG.EVNT_CTG_CDE     = 'CON'                      10491781
                AND PRCHG.PRCHG_TYP_CDE    = 'CON'                      10491881
                AND PRCHG.PRCHG_ST_CDE     = 'APR'                      10491981
                AND PRCHG.LAST_ACTN_CDE   <> 'D'                        10492081
                AND STRGP.LAST_ACTN_CDE   <> 'D'                        10492181
                AND MDSE.LAST_ACTN_CDE    <> 'D'                        10492281
                                                                        10492381
              ORDER BY STRGP.PRCHG_EFF_DTE DESC                         10492481
              WITH UR                                                   10492581
           END-EXEC.                                                    10492681
                                                                        10492781
      ******************************************************************10492881
      * GET FUTURE RED TICKET PERM EVENTS SET UP AT THE STYLE LEVEL     10492981
      * (CONTINUED CLEARANCE)                                           10493081
      ******************************************************************10493181
           EXEC SQL                                                     10493281
             DECLARE FUT-CNTCLR-STY-CSR CURSOR FOR                      10493381
              SELECT STRGP.PRCHG_EFF_DTE                                10493481
                   , MDSE.CLR_TYP_CDE                                   10493581
                   , MDSE.PRICG_GRID_ID                                 10493681
                                                                        10493781
              FROM XST_STR_GP_PRCHG  STRGP                              10493881
                 , XST_STR_GP_MBSHP  MBSHP                              10493981
                 , XST_PRCHG_MDSE    MDSE                               10494081
                 , XST_PRCHG         PRCHG                              10494181
                                                                        10494281
              WHERE STRGP.PRCHG_EFF_DTE   <= :PV-DT                     10494381
                AND STRGP.PRCHG_EFF_DTE    > CURRENT DATE               10494486
                                                                        10494581
                AND MBSHP.STR_NBR          = :PV-STR                    10494681
                AND MBSHP.EFF_BEG_DTE     <= :PV-DT                     10494781
                AND (MBSHP.EFF_END_DTE    >= :PV-DT                     10494881
                     OR MBSHP.EFF_END_DTE IS NULL)                      10494981
                                                                        10495081
                AND MBSHP.STR_GP_TYP_CDE   = STRGP.STR_GP_TYP_CDE       10495181
                AND MBSHP.STR_GP_ID        = STRGP.STR_GP_ID            10495281
                                                                        10495381
                AND MDSE.STR_GP_TYP_CDE    = MBSHP.STR_GP_TYP_CDE       10495481
                AND MDSE.STR_GP_ID         = MBSHP.STR_GP_ID            10495581
                                                                        10495681
                AND STRGP.PRCHG_ID         = MDSE.PRCHG_ID              10495781
                AND PRCHG.PRCHG_ID         = STRGP.PRCHG_ID             10495881
                                                                        10495981
                AND MDSE.MDSE_HIER_CDE     = 'STY'                      10496081
                AND MDSE.STYL_ID           = :XST00010-STYL-ID          10496181
                                                                        10496281
                AND PRCHG.EVNT_CTG_CDE     = 'CON'                      10496381
                AND PRCHG.PRCHG_TYP_CDE    = 'CON'                      10496481
                AND PRCHG.PRCHG_ST_CDE     = 'APR'                      10496581
                AND PRCHG.LAST_ACTN_CDE   <> 'D'                        10496681
                AND STRGP.LAST_ACTN_CDE   <> 'D'                        10496781
                AND MDSE.LAST_ACTN_CDE    <> 'D'                        10496881
                                                                        10496981
              ORDER BY STRGP.PRCHG_EFF_DTE DESC                         10497081
              WITH UR                                                   10497181
           END-EXEC.                                                    10497281
                                                                        10497381
      ******************************************************************10497481
      * GET FUTURE RED TICKET PERM EVENTS SET UP AT THE SKU LEVEL       10497581
      * (CONTINUED CLEARANCE)                                           10497681
      ******************************************************************10497781
           EXEC SQL                                                     10497881
             DECLARE FUT-CNTCLR-SKU-CSR CURSOR FOR                      10497981
              SELECT STRGP.PRCHG_EFF_DTE                                10498081
                   , MDSE.CLR_TYP_CDE                                   10498181
                   , MDSE.PRICG_GRID_ID                                 10498281
                                                                        10498381
              FROM XST_STR_GP_PRCHG  STRGP                              10498481
                 , XST_STR_GP_MBSHP  MBSHP                              10498581
                 , XST_PRCHG_MDSE    MDSE                               10498681
                 , XST_PRCHG         PRCHG                              10498781
                                                                        10498881
              WHERE STRGP.PRCHG_EFF_DTE   <= :PV-DT                     10498981
                AND STRGP.PRCHG_EFF_DTE    > CURRENT DATE               10499086
                                                                        10499181
                AND MBSHP.STR_NBR          = :PV-STR                    10499281
                AND MBSHP.EFF_BEG_DTE     <= :PV-DT                     10499381
                AND (MBSHP.EFF_END_DTE    >= :PV-DT                     10499481
                     OR MBSHP.EFF_END_DTE IS NULL)                      10499581
                                                                        10499681
                AND MBSHP.STR_GP_TYP_CDE   = STRGP.STR_GP_TYP_CDE       10499781
                AND MBSHP.STR_GP_ID        = STRGP.STR_GP_ID            10499881
                                                                        10499981
                AND MDSE.STR_GP_TYP_CDE    = MBSHP.STR_GP_TYP_CDE       10500081
                AND MDSE.STR_GP_ID         = MBSHP.STR_GP_ID            10500181
                                                                        10500281
                AND STRGP.PRCHG_ID         = MDSE.PRCHG_ID              10500381
                AND PRCHG.PRCHG_ID         = STRGP.PRCHG_ID             10500481
                                                                        10500581
                AND MDSE.MDSE_HIER_CDE     = 'SKU'                      10500681
                AND MDSE.SKU_NBR           = :XST00010-SKU-NBR          10500781
                                                                        10500881
                AND PRCHG.EVNT_CTG_CDE     = 'CON'                      10500981
                AND PRCHG.PRCHG_TYP_CDE    = 'CON'                      10501081
                AND PRCHG.PRCHG_ST_CDE     = 'APR'                      10501181
                AND PRCHG.LAST_ACTN_CDE   <> 'D'                        10501281
                AND STRGP.LAST_ACTN_CDE   <> 'D'                        10501381
                AND MDSE.LAST_ACTN_CDE    <> 'D'                        10501481
                                                                        10501581
              ORDER BY STRGP.PRCHG_EFF_DTE DESC                         10501681
              WITH UR                                                   10501781
           END-EXEC.                                                    10501881
                                                                        10501981
104800******************************************************************10502081
104900* GET THE RED TICKET GRID DETAIL RECORD                           10502181
105000******************************************************************10503060
105100     EXEC SQL                                                     10510060
105200       DECLARE RED-TKT-GRID-CSR CURSOR FOR                        10520060
105300        SELECT NEW_UNT_RTL_AMT                                    10530060
108200        FROM XST_PRICG_GRID_DTL                                   10820060
108700        WHERE PRICG_GRID_ID   = :XST00065-PRICG-GRID-ID           10870060
108701          AND LAST_ACTN_CDE  <> 'D'                               10870160
108710          AND MIN_UNT_RTL_AMT <= :HV-UNT-RTL-AMT                  10871073
108710          AND MAX_UNT_RTL_AMT >= :HV-UNT-RTL-AMT                  10871173
112500        WITH UR                                                   11250060
112600     END-EXEC.                                                    11260060
