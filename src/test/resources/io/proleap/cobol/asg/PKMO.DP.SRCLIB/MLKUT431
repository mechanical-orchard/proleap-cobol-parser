000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    MLKUT431.                                         00020033
000300 AUTHOR.        BARBARA HULL.                                     00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  07-23-98.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800*                                                                 00080000
000900* MLKUT431 -                                                      00090033
001000*                                                                 00100000
001100* THIS PROGRAM WILL COMPARE TWO DATA INTEGRITY EXTRACT FILES AND  00110000
001200* CREATE A REPORT FILE OF THE DIFFERENCES.                        00120000
001300*                                                                 00130000
001400* ONE EXTRACT FILE WILL BE DESIGNATED AS THE 'LOW' EXTRACT FILE,  00140000
001500* AND THE OTHER WILL BE DESIGNATED AS THE 'HIGH' EXTRACT FILE.    00150000
001600* THE 'LOW' EXTRACT FILE CORRESPONDS TO THE LOWER-LEVEL TABLE OF  00160000
001700* THE TWO TABLES BEING COMPARED.                                  00170000
001800*                                                                 00180000
001900* BECAUSE THIS SAME PROGRAM IS USED TO COMPARE ANY TWO OF THE DATA00190000
002000* INTEGRITY EXTRACT FILES, A CONTROL CARD IS READ TO INDICATE     00200000
002100* WHICH TWO ARE BEING COMPARED IN A GIVEN RUN.  THIS IS NECESSARY 00210000
002200* BECAUSE THERE ARE SOME MINOR DIFFERENCES IN PROCESSING, DEPEND- 00220000
002300* ING UPON WHICH TWO TABLES ARE BEING COMPARED.                   00230000
002400*                                                                 00240000
002500* THE SAME CONTROL CARD WILL BE READ BY THE REPORT PROGRAM SO THAT00250000
002600* IT CAN PUT THE APPROPRIATE TABLE NAMES ON THE REPORT.           00260000
002700*                                                                 00270000
002800******************************************************************00280000
002900*                                                                *00290000
003000* PC-SHNK-RTL-DIFF-LIMIT     : THIS CONSTANT ALLOWS A CERTAIN    *00300000
003100* **********************       LEVEL OF VARIANCE.                *00310000
003200*                                                                *00320000
003300******************************************************************00330000
003400*    12/18/98 - BOB MCASEY  WR5701 - LEDGER REWRITE               00340000
003500*       ELIMINATED SHRINK DIFFERENCES DUE TO A CHANGE IN THE WAY  00350000
003600*       SHRINK IS CALCUTATED.  THE CALCULATED SHRINK AMOUNT       00360000
003700*       FROM TMNSCLS IS NOW BEING USED IN THE RECALC PROGRAMS     00370000
003800*       FOR TMNSCL, TMNMCL AND TMNDPT.  IF SHRINK IS NOT EQUAL    00380000
003900*       BETWEEN TABLES, REPORT IT!.                               00390000
004000******************************************************************00400000
004100*    04/12/99 - PAUL KEBER  WR10587 - DATA INTEGRITY REPORTS      00410000
004200*       HANDLE A NEW TVAMCL REPORT TABLE TYPE.                    00420000
004300******************************************************************00430000
004400*    05/28/99 - PAUL KEBER  WR10587 - DATA INTEGRITY REPORTS      00440000
004500*       HANDLE A NEW TVADPT REPORT TABLE TYPE.                    00450000
004600******************************************************************00460000
004700*    12/16/99 - DAVE METZGER WR20399 - DATA INTEGRITY REPORTS     00470000
004800*       HANDLE NEW TMNDPTS AND TMNMCLS REPORT TABLE TYPES.        00480000
004900******************************************************************00490000
005000*    12/16/99 - BOB MCASEY  WR20698 - DATA INTEGRITY REPORTS      00500000
005100*       HANDLE NEW TWKPOSS AND TMNSCL REPORT TABLE TYPES.         00510000
005200******************************************************************00520000
005300*    03/10/00 - DAVE METZGER WR20698 - DATA INTEGRITY REPORTS     00530000
005400*       CHANGED TO SKIP INVENTORY ADJUSTMENTS FOR TVADPT & TVAMCL 00540000
005500******************************************************************00550000
005600*    03/15/00 - SCOTT JACKSON WR20442 - DATA INTEGRITY REPORTS TO 00560000
005700*       HANDLE NEW TWKMCL AND TMNMCL REPORT TABLE TYPES.          00570000
005800******************************************************************00580000
005900*    05/16/00 - RONNA BUTZ    WR21132 - DATA INTEGRITY REPORTS TO 00590000
006000*       HANDLE NEW TWKMCLS AND TMNMCLS REPORT TABLE TYPES.        00600000
006100******************************************************************00610000
006200******************************************************************00620000
006300*    08/03/2000 - BOB MCASEY  WR21355 - DATA INTEGRITY REPORTS TO 00630000
006400*       HANDLE NEW TWKDPTS AND TMNDPTS REPORT TABLE TYPES.        00640000
006500******************************************************************00650000
006600******************************************************************00660000
006700*    09/01/2000 - ROD JANSSEN WR31355 - DATA INTEGRITY REPORTS TO 00670000
006800*       HANDLE NEW TWKDPTC, TMNDPTC, TWKMCLC, AND TMNMCLC TABLES. 00680000
006900******************************************************************00690000
007000******************************************************************00700000
007100*    12/15/2000 - BOB MCASEY  WR21394 - ADDED CHECK FOR INV ADJ   00710000
007200*       AGAINST TMNMCL-TVAMCL & TMNDPT-TVADPT.                    00720000
007300******************************************************************00730000
007400* CHG ID   DATE        DESCRIPTION                               *00740000
007500* ------   ----------  ----------------------------------------- *00750000
007600* W26603   03-18-2004  STORE EXPANSION.  EXPANDED LRECL OF       *00760000
007700*                      INP01, INP02, OUT01 FILE BECAUSE OF       *00770000
007800*                      CHANGES TO MLRD111, MLRD112.              *00780000
007900*                      - RONNA MCDONALD                          *00790000
008000******************************************************************00800000
007400* CHG ID   DATE        DESCRIPTION                               *00801000
007500* ------   ----------  ----------------------------------------- *00802000
007600* WR28582  01-24-2007  CHANGED PGM TO HANDLE COMPARISONS AT      *00803000
007700*                      A DATALESS KEY LEVEL (DKEY_NBR) DUE       *00804000
007800*                      TO THE BRAND VENDOR PROJECT.              *00805000
007900*                      - CINDY HANSEN                            *00806000
008000******************************************************************00807000
008000******************************************************************00808000
007400* CHG ID   DATE        DESCRIPTION                               *00809000
007500* ------   ----------  ----------------------------------------- *00809100
B28582* WR28582  07-23-2007  FIX INITIALIZATION FOR THOSE TABLES THAT  *00809200
B28582*  B28582              DO NOT HAVE DATALESS KEY (DKEY_NBR)        00809300
B28582*                      BRAND VENDOR PROJECT.                      00809400
B28582*                      - B. GRAHAM - STRATAGEM                    00809500
X28582* 28582    02-08-2007 ROD JANSSEN VENDOR LEVEL DETAIL LEDGER MOD. 00809600
W34517* WR34517  08-26-2008 PAUL KEBER - HANDLE NEW DATA INTEGRITY      00809700
W34517*                     REPORT FOR MLT_MNLY_VND/TMNSCLS AND FOR     00809800
W34517*                     MLT_WKLY_VND/MLT_MNLY_VND.                  00809900
008000***************************************************************** 00810000
008100 ENVIRONMENT DIVISION.                                            00810400
008300*                                                                 00810500
008400 CONFIGURATION SECTION.                                           00811000
008500*                                                                 00820000
008600 SOURCE-COMPUTER.        IBM-3090.                                00830000
008700 OBJECT-COMPUTER.        IBM-3090.                                00840000
008800*                                                                 00850000
008900 INPUT-OUTPUT SECTION.                                            00860000
009000 FILE-CONTROL.                                                    00870000
009100                                                                  00880000
009200     SELECT COMPARE-TABLES-CTL-FILE                               00890000
009300         ASSIGN TO INP01.                                         00900000
009400                                                                  00910000
009500     SELECT L-DATA-INTEGRITY-EXTR-FILE                            00920000
009600         ASSIGN TO INP02.                                         00930000
009700                                                                  00940000
009800     SELECT H-DATA-INTEGRITY-EXTR-FILE                            00950000
009900         ASSIGN TO INP03.                                         00960000
010000                                                                  00970000
010100     SELECT DATA-INTEGRITY-DIFF-FILE                              00980000
010200         ASSIGN TO OUT01.                                         00990000
010300                                                                  01000000
JAS        SELECT WKLYSUM-ACTLS-UPDT-FILE                               01001009
JAS            ASSIGN TO OUT02.                                         01002009
JAS                                                                     01003005
JAS        SELECT WKLYSUM-CALCD-UPDT-FILE                               01003109
JAS            ASSIGN TO OUT03.                                         01003209
JAS                                                                     01003309
JAS        SELECT MNLYSUM-ACTLS-UPDT-FILE                               01004009
JAS            ASSIGN TO OUT04.                                         01005009
JAS                                                                     01006005
JAS        SELECT MNLYSUM-CALCD-UPDT-FILE                               01007009
JAS            ASSIGN TO OUT05.                                         01008009
JAS                                                                     01009009
010400******************************************************************01010000
010500 DATA DIVISION.                                                   01020000
010600******************************************************************01030000
010700                                                                  01040000
010800 FILE SECTION.                                                    01050000
010900                                                                  01060000
011000 FD  COMPARE-TABLES-CTL-FILE                                      01070000
011100     LABEL RECORDS ARE STANDARD                                   01080000
011200     RECORDING MODE IS F                                          01090000
011300     BLOCK CONTAINS 0 RECORDS.                                    01100000
011400 01  COMPARE-TABLES-CTL-REC      PIC X(80).                       01110000
011500                                                                  01120000
011600 FD  L-DATA-INTEGRITY-EXTR-FILE                                   01130000
011700     LABEL RECORDS ARE STANDARD                                   01140000
011800     RECORDING MODE IS F                                          01150000
011900     BLOCK CONTAINS 0 RECORDS.                                    01160000
012000*01  L-DATA-INTEGRITY-EXTR-REC   PIC X(110).                      01170000
012100 01  L-DATA-INTEGRITY-EXTR-REC   PIC X(120).                      01180000
012200                                                                  01190000
012300 FD  H-DATA-INTEGRITY-EXTR-FILE                                   01200000
012400     LABEL RECORDS ARE STANDARD                                   01210000
012500     RECORDING MODE IS F                                          01220000
012600     BLOCK CONTAINS 0 RECORDS.                                    01230000
012700*01  H-DATA-INTEGRITY-EXTR-REC   PIC X(110).                      01240000
012800 01  H-DATA-INTEGRITY-EXTR-REC   PIC X(120).                      01250000
012900                                                                  01260000
013000 FD  DATA-INTEGRITY-DIFF-FILE                                     01270000
013100     RECORDING MODE IS F                                          01280000
013200     LABEL RECORDS ARE STANDARD                                   01290000
013300     BLOCK CONTAINS 0 RECORDS.                                    01300000
013400                                                                  01310000
013500*01  DATA-INTEGRITY-DIFF-REC     PIC X(35).                       01320000
013600 01  DATA-INTEGRITY-DIFF-REC     PIC X(80).                       01330000
013700                                                                  01340000
JAS    FD  WKLYSUM-CALCD-UPDT-FILE                                      01341005
JAS        RECORDING MODE IS F                                          01342005
JAS        LABEL RECORDS ARE STANDARD                                   01343005
JAS        BLOCK CONTAINS 0 RECORDS.                                    01344005
JAS                                                                     01345005
JAS    01  WKLYSUM-CALCD-UPDT-REC      PIC X(400).                      01347005
JAS                                                                     01348005
JAS    FD  WKLYSUM-ACTLS-UPDT-FILE                                      01348109
JAS        RECORDING MODE IS F                                          01348209
JAS        LABEL RECORDS ARE STANDARD                                   01348309
JAS        BLOCK CONTAINS 0 RECORDS.                                    01348409
JAS                                                                     01348509
JAS    01  WKLYSUM-ACTLS-UPDT-REC      PIC X(400).                      01348609
JAS                                                                     01348709
JAS    FD  MNLYSUM-CALCD-UPDT-FILE                                      01349005
JAS        RECORDING MODE IS F                                          01349105
JAS        LABEL RECORDS ARE STANDARD                                   01349205
JAS        BLOCK CONTAINS 0 RECORDS.                                    01349305
JAS                                                                     01349405
JAS    01  MNLYSUM-CALCD-UPDT-REC      PIC X(400).                      01349505
JAS                                                                     01349605
JAS    FD  MNLYSUM-ACTLS-UPDT-FILE                                      01349709
JAS        RECORDING MODE IS F                                          01349809
JAS        LABEL RECORDS ARE STANDARD                                   01349909
JAS        BLOCK CONTAINS 0 RECORDS.                                    01350009
JAS                                                                     01350109
JAS    01  MNLYSUM-ACTLS-UPDT-REC      PIC X(400).                      01350209
JAS                                                                     01350309
013800*                                                                 01351000
013900******************************************************************01360000
014000 WORKING-STORAGE SECTION.                                         01370000
014100******************************************************************01380000
014200                                                                  01390000
014300 01  PS-PROGRAM-SWITCHES.                                         01400000
014400     05  PS-MORE-LOW-EXTR-RECS-SW                                 01410000
014500                                 PIC X       VALUE 'Y'.           01420000
014600         88  PS-MORE-LOW-EXTR-RECS           VALUE 'Y'.           01430000
014700         88  PS-NO-MORE-LOW-EXTR-RECS        VALUE 'N'.           01440000
014800     05  PS-MORE-HIGH-EXTR-RECS-SW                                01450000
014900                                 PIC X       VALUE 'Y'.           01460000
015000         88  PS-MORE-HIGH-EXTR-RECS          VALUE 'Y'.           01470000
015100         88  PS-NO-MORE-HIGH-EXTR-RECS       VALUE 'N'.           01480000
015200     05  PS-BYPASS-0-DOLLARS-SW  PIC X.                           01490000
015300         88  PS-BYPASS-0-DOLLARS             VALUE 'Y'.           01500000
015400         88  PS-NO-BYPASS-DOLLARS            VALUE 'N'.           01510000
JAS        05  PS-ACTLS-DIFF-FND-SW    PIC X       VALUE 'N'.           01511009
JAS            88  PS-ACTLS-DIFF-FND               VALUE 'Y'.           01512009
JAS            88  PS-ACTLS-DIFF-NOTFND            VALUE 'N'.           01513009
JAS        05  PS-CALCD-DIFF-FND-SW    PIC X       VALUE 'N'.           01514002
JAS            88  PS-CALCD-DIFF-FND               VALUE 'Y'.           01515002
JAS            88  PS-CALCD-DIFF-NOTFND            VALUE 'N'.           01516002
JAS        05  PS-CORR-EIR-FND-SW      PIC X       VALUE 'N'.           01517032
JAS            88  PS-CORR-EIR-FND                 VALUE 'Y'.           01518032
JAS            88  PS-CORR-EIR-NOTFND              VALUE 'N'.           01519032
015500                                                                  01520000
015600 01  PA-PROGRAM-ACCUMULATORS                 COMP-3.              01530000
015700     05  PA-LOW-RECS-READ        PIC S9(13)  VALUE ZERO.          01540000
015800     05  PA-HIGH-RECS-READ       PIC S9(13)  VALUE ZERO.          01550000
015900     05  PA-KEY-MATCHES          PIC S9(13)  VALUE ZERO.          01560000
016000     05  PA-REPORT-RECS-WRITTEN  PIC S9(13)  VALUE ZERO.          01570000
JAS        05  PA-WKLYSUM-ACTLS-WRITTEN PIC S9(13)  VALUE ZERO.         01571009
JAS        05  PA-WKLYSUM-CALCD-WRITTEN PIC S9(13)  VALUE ZERO.         01571109
JAS        05  PA-MNLYSUM-ACTLS-WRITTEN PIC S9(13)  VALUE ZERO.         01572009
JAS        05  PA-MNLYSUM-CALCD-WRITTEN PIC S9(13)  VALUE ZERO.         01573009
016100                                                                  01580000
016200 01  CD-COUNTER-DISPLAY.                                          01590000
016300     05  CD-COUNT-HOLD1          PIC Z,ZZZ,ZZZ,ZZZ,ZZ9.           01600000
016400                                                                  01610000
016500*** ELIMINATED DIFFERENCES DUE TO A CHANGE IN THE WAY             01620000
016600*** SHRINK IS CALCUTATED.  THE CALCULATED SHRINK AMOUNT           01630000
016700*** FROM TMNSCLS IS NOW BEING USED IN THE RECALC PROGRAMS         01640000
016800*** FOR TMNSCL, TMNMCL AND TMNDPT.                                01650000
016900 01  PC-PROGRAM-CONSTANTS.                                        01660000
017000*    05  PC-SHNK-MAX-MNSCLS-MNSCL                                 01670000
017100*                                PIC S9(11)V99 COMP-3             01680000
017200*                                VALUE 2.00 .                     01690000
017300*    05  PC-SHNK-MAX-MNSCL-MNMCL                                  01700000
017400*                                PIC S9(11)V99 COMP-3             01710000
017500*                                VALUE 2.00 .                     01720000
017600*    05  PC-SHNK-MAX-MNMCL-MNDPT                                  01730000
017700*                                PIC S9(11)V99 COMP-3             01740000
017800*                                VALUE .05 .                      01750000
017900     05  PC-LOW-TABLE-TWKPOSS    PIC X(07) VALUE 'TWKPOSS'.       01760000
018000     05  PC-HIGH-TABLE-TWKSCLS   PIC X(07) VALUE 'TWKSCLS'.       01770000
018100     05  PC-LOW-TABLE-TVADPT     PIC X(07) VALUE 'TVADPT '.       01780000
018200     05  PC-LOW-TABLE-TVAMCL     PIC X(07) VALUE 'TVAMCL '.       01790000
018300     05  PC-LOW-TABLE-TWKDPTS    PIC X(07) VALUE 'TWKDPTS'.       01800000
018400     05  PC-LOW-TABLE-TWKDPTC    PIC X(07) VALUE 'TWKDPTC'.       01810000
018500     05  PC-LOW-TABLE-TMNDPTC    PIC X(07) VALUE 'TMNDPTC'.       01820000
018600     05  PC-LOW-TABLE-TMNMCLC    PIC X(07) VALUE 'TMNMCLC'.       01830000
018700     05  PC-LOW-TABLE-TWKMCLC    PIC X(07) VALUE 'TWKMCLC'.       01840000
018710     05  PC-LOW-TABLE-WKLYSUM    PIC X(07) VALUE 'WKLYSUM'.       01850000
018720     05  PC-LOW-TABLE-MNLYSUM    PIC X(07) VALUE 'MNLYSUM'.       01860000
X28582     05  PC-LOW-TABLE-WKLYVND    PIC X(07) VALUE 'WKLYVND'.       01861000
W34517     05  PC-LOW-TABLE-MNLYVND    PIC X(07) VALUE 'MNLYVND'.       01862000
018710     05  PC-HIGH-TABLE-WKLYSUM   PIC X(07) VALUE 'WKLYSUM'.       01870000
018720     05  PC-HIGH-TABLE-MNLYSUM   PIC X(07) VALUE 'MNLYSUM'.       01871000
018800                                                                  01872000
018900 01  PV-PROGRAM-VARIABLES.                                        01873000
019000     05  PV-LOW-FILE-KEY.                                         01874000
019100         10  PV-LOW-FK-FSCL-MN-END-DTE                            01875000
019200                                 PIC X(10).                       01876000
019300         10  PV-LOW-FK-FSCL-MN-NBR                                01877000
019400                                 PIC X(02).                       01878000
019500         10  PV-LOW-FK-DEPT-NBR  PIC X(03).                       01879000
019600         10  PV-LOW-FK-MAJ-CL-NBR                                 01880000
019700                                 PIC X(02).                       01890000
019800         10  PV-LOW-FK-SUB-CL-NBR                                 01900000
019900                                 PIC X(02).                       01910000
020000         10  PV-LOW-FK-STR-NBR   PIC S9(4) COMP.                  01920000
020000         10  PV-LOW-FK-DKEY-NBR  PIC X(15).                       01930000
020100     05  PV-HIGH-FILE-KEY.                                        01940000
020200         10  PV-HIGH-FK-FSCL-MN-END-DTE                           01950000
020300                                 PIC X(10).                       01960000
020400         10  PV-HIGH-FK-FSCL-MN-NBR                               01970000
020500                                 PIC X(02).                       01980000
020600         10  PV-HIGH-FK-DEPT-NBR PIC X(03).                       01990000
020700         10  PV-HIGH-FK-MAJ-CL-NBR                                02000000
020800                                 PIC X(02).                       02010000
020900         10  PV-HIGH-FK-SUB-CL-NBR                                02020000
021000                                 PIC X(02).                       02030000
021100         10  PV-HIGH-FK-STR-NBR  PIC S9(4) COMP.                  02040000
               10  PV-HIGH-FK-DKEY-NBR PIC X(15).                       02050000
021200                                                                  02060000
021300     05  PV-DIFF-SHNK-RTL-AMT    PIC S9(11)V99 COMP-3.            02070000
JAS   *    05  PV-SLS-RTL-AMT          PIC S9(11)V99 COMP-3.            02071012
JAS        05  PV-MKDN-RTL-AMT         PIC S9(11)V99 COMP-3.            02071111
JAS        05  PV-MKUP-RTL-AMT         PIC S9(11)V99 COMP-3.            02071211
JAS        05  PV-XFER-IN-RTL-AMT      PIC S9(11)V99 COMP-3.            02071311
JAS        05  PV-XFER-OUT-RTL-AMT     PIC S9(11)V99 COMP-3.            02071411
JAS        05  PV-RCPT-RTL-AMT         PIC S9(11)V99 COMP-3.            02071511
JAS        05  PV-RCPT-NET-COST-AMT    PIC S9(11)V99 COMP-3.            02071611
JAS        05  PV-PADJ-RTL-AMT         PIC S9(11)V99 COMP-3.            02071711
JAS        05  PV-PADJ-NET-COST-AMT    PIC S9(11)V99 COMP-3.            02071811
JAS        05  PV-INV-ADJ-RTL-AMT      PIC S9(11)V99 COMP-3.            02072011
JAS        05  PV-SHNK-RTL-AMT         PIC S9(11)V99 COMP-3.            02072111
JAS        05  PV-END-INV-RTL-AMT      PIC S9(11)V99 COMP-3.            02072211
JAS        05  PV-DEPT-NBR             PIC  9(03)  VALUE ZERO.          02073011
JAS        05  PV-END-INV-RTL-AMT-DISP PIC -----------.99.              02074024
JAS        05  PV-STR-NBR              PIC  9(04)  VALUE ZERO.          02075024
021400                                                                  02080000
021500 01 ABEND-AREAS.                                                  02090000
021600     05 ABEND-CODE               PIC S9(04)  VALUE ZERO           02100000
021700                                             COMP SYNC.           02110000
021800         88  AC-BAD-DATA                     VALUE +4003.         02120000
021900         88  AC-DB2-ERROR                    VALUE +4013.         02130000
022000     05  AA-ABEND-LIT            PIC X(40)   VALUE                02140000
022100           '*****       ABEND'.                                   02150000
022200     05  AA-PROGRAM-LIT          PIC X(40)   VALUE                02160000
022300             '*****   PROGRAM: MLKJS419'.                         02170030
022400     05  AA-PARAGRAPH-LIT.                                        02180000
022500         10  FILLER              PIC X(17)   VALUE                02190000
022600             '***** PARAGRAPH: '.                                 02200000
022700         10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.        02210000
022800     05  AA-MESSAGE-LINE.                                         02220000
022900         10  FILLER              PIC X(06)   VALUE '*****'.       02230000
023000         10  AA-MESSAGE          PIC X(127)  VALUE SPACES.        02240000
023100     05  AA-DB2-ERROR-LIT        PIC X(40)   VALUE                02250000
023200             '*****    DB2 ERROR'.                                02260000
023300     05  AA-DB2-OPERATION-LIT.                                    02270000
023400         10  FILLER              PIC X(17)   VALUE                02280000
023500             '***** OPERATION: '.                                 02290000
023600         10  AA-DB2-OPERATION.                                    02300000
023700             15  AA-DB2-OP-1     PIC X(25)   VALUE SPACES.        02310000
023800             15  AA-DB2-OP-2     PIC X(25)   VALUE SPACES.        02320000
023900     05  AA-DB2-TABLE-1          PIC X(08)   VALUE SPACES.        02330000
024000     05  AA-DB2-TABLE-2          PIC X(08)   VALUE SPACES.        02340000
024100     05  AA-DB2-TABLE-3          PIC X(08)   VALUE SPACES.        02350000
024200     05  AA-DB2-TABLE-4          PIC X(08)   VALUE SPACES.        02360000
024300                                                                  02370000
024400 EJECT                                                            02380000
024500                                                                  02390000
024600*** DATA INTEGRITY COMPARE TABLES CONTROL CARD                    02400000
024700 01  CC-CONTROL-CARD-REC.                                         02410000
024800     05  CC-LOW-TABLE            PIC X(7).                        02420000
024900     05  FILLER                  PIC X.                           02430000
025000     05  CC-HIGH-TABLE           PIC X(7).                        02440000
025100     05  FILLER                  PIC X(65).                       02450000
025200                                                                  02460000
025300                                                                  02470000
025400*** L O W                                                         02480000
025500*** DATA INTEGRITY EXTRACT FILE                                   02490000
025600     COPY MLRD111 REPLACING ML111 BY LLLOW.                       02500000
025700                                                                  02510000
025800                                                                  02520000
025900*** H I G H                                                       02530000
026000*** DATA INTEGRITY EXTRACT FILE                                   02540000
026100     COPY MLRD111 REPLACING ML111 BY HHIGH.                       02550000
026200                                                                  02560000
026300                                                                  02570000
026400*** DATA INTEGRITY DIFFERENCE REPORT FILE                         02580000
026500     COPY MLRD112.                                                02590000
026600                                                                  02600000
JAS   *** WKLYSUM UPDATE LAYOUT                                         02601009
JAS        COPY MLRD155.                                                02602009
JAS                                                                     02603008
JAS   *** MNLYSUM UPDATE LAYOUT                                         02603109
JAS        COPY MLRD156.                                                02603209
JAS                                                                     02603309
JAS   *** RECALC UPDATE LAYOUT                                          02604009
JAS        COPY MLRD070.                                                02605009
JAS                                                                     02606009
026700 EJECT                                                            02610000
026800                                                                  02620000
JAS   ******************************************************************02621006
JAS   *  DB2 COMMUNICATION AREA                                         02622006
JAS   ******************************************************************02623006
JAS        EXEC SQL                                                     02624006
JAS             INCLUDE SQLCA                                           02625006
JAS        END-EXEC.                                                    02626006
JAS                                                                     02627006
JAS   ******************************************************************02628006
JAS   *  DB2 ERROR MESSAGES FORMAT AREA.                                02629006
JAS   ******************************************************************02629106
JAS        COPY DPWS004.                                                02629206
JAS                                                                     02629306
JAS   ******************************************************************02629406
JAS   *  DB2 MLV_BRND_VND                                               02629507
JAS   ******************************************************************02629606
JAS        EXEC SQL                                                     02629706
JAS             INCLUDE MLV00000                                        02629807
JAS        END-EXEC.                                                    02629906
JAS                                                                     02630006
JAS   ******************************************************************02630107
JAS   *  DB2 MLT_PARTN_BAL                                              02630207
JAS   ******************************************************************02630307
JAS        EXEC SQL                                                     02630407
JAS             INCLUDE MLT00002                                        02630507
JAS        END-EXEC.                                                    02630607
JAS                                                                     02630707
JAS   ******************************************************************02630807
JAS   *  DB2 MLT_PARTN_CNTL                                             02630907
JAS   ******************************************************************02631007
JAS        EXEC SQL                                                     02631107
JAS             INCLUDE MLT00003                                        02631207
JAS        END-EXEC.                                                    02631307
JAS                                                                     02631407
026900                                                                  02632007
027000 PROCEDURE DIVISION.                                              02640000
027100******************************************************************02650000
027200                                                                  02660000
027300******************************************************************02670000
027400 0000-MAINLINE-MLKJS419.                                          02680030
027500******************************************************************02690000
027600*                                                                 02700000
027700     PERFORM 1000-INITIALIZATION.                                 02710000
027800                                                                  02720000
027900     PERFORM 2000-MAIN-PROCESS.                                   02730000
028000                                                                  02740000
028100     PERFORM 8000-EOJ.                                            02750000
028200                                                                  02760000
028300     STOP RUN.                                                    02770000
028400                                                                  02780000
028500 EJECT                                                            02790000
028600                                                                  02800000
028700******************************************************************02810000
028800 1000-INITIALIZATION.                                             02820000
028900******************************************************************02830000
029000*                                                                 02840000
029100     OPEN INPUT  COMPARE-TABLES-CTL-FILE                          02850000
029200                 L-DATA-INTEGRITY-EXTR-FILE                       02860000
029300                 H-DATA-INTEGRITY-EXTR-FILE.                      02870008
029400     OPEN OUTPUT DATA-INTEGRITY-DIFF-FILE                         02880008
JAS                    WKLYSUM-ACTLS-UPDT-FILE                          02881009
JAS                    WKLYSUM-CALCD-UPDT-FILE                          02881109
JAS                    MNLYSUM-ACTLS-UPDT-FILE                          02882009
JAS                    MNLYSUM-CALCD-UPDT-FILE.                         02883009
029500                                                                  02890000
029600     PERFORM 4000-READ-CONTROL-CARD.                              02900000
029700                                                                  02910000
029800     DISPLAY ' '.                                                 02920000
029900     DISPLAY '*** MLKJS419 INPUT CONTROL CARD VALUES ***'         02930030
030000     DISPLAY CC-CONTROL-CARD-REC.                                 02940000
030100                                                                  02950000
030200     INITIALIZE PA-PROGRAM-ACCUMULATORS.                          02960000
030300     INITIALIZE PV-PROGRAM-VARIABLES.                             02970000
030400                                                                  02980000
030500 EJECT                                                            02990000
030600                                                                  03000000
030700******************************************************************03010000
030800 2000-MAIN-PROCESS.                                               03020000
030900******************************************************************03030000
031000*                                                                 03040000
031100     PERFORM 4100-READ-LOW-EXTRACT-FILE.                          03050000
031200                                                                  03060000
031300     IF PS-NO-MORE-LOW-EXTR-RECS                                  03070000
031400         MOVE '2000-MAIN-PROCESS'                                 03080000
031500                                 TO AA-PARAGRAPH-NAME             03090000
031600         MOVE 'EMPTY LOW EXTRACT FILE'                            03100000
031700                                 TO AA-MESSAGE                    03110000
031800         MOVE +4002              TO ABEND-CODE                    03120000
031900         PERFORM 9900-COMMON-ABEND-ROUTINE                        03130000
032000     END-IF.                                                      03140000
032100                                                                  03150000
032200     PERFORM 4200-READ-HIGH-EXTRACT-FILE.                         03160000
032300                                                                  03170000
032400     IF PS-NO-MORE-HIGH-EXTR-RECS                                 03180000
032500         MOVE '2000-MAIN-PROCESS'                                 03190000
032600                                 TO AA-PARAGRAPH-NAME             03200000
032700         MOVE 'EMPTY HIGH EXTRACT FILE'                           03210000
032800                                 TO AA-MESSAGE                    03220000
032900         MOVE +4003              TO ABEND-CODE                    03230000
033000         PERFORM 9900-COMMON-ABEND-ROUTINE                        03240000
033100     END-IF.                                                      03250000
033200                                                                  03260000
033300     PERFORM                                                      03270000
033400       UNTIL PS-NO-MORE-LOW-EXTR-RECS                             03280000
033500         AND PS-NO-MORE-HIGH-EXTR-RECS                            03290000
033600         PERFORM 2100-COMPARE-FILES                               03300000
033700     END-PERFORM.                                                 03310000
033800                                                                  03320000
033900 EJECT                                                            03330000
034000                                                                  03340000
034100******************************************************************03350000
034200 2100-COMPARE-FILES.                                              03360000
034300******************************************************************03370000
034400*                                                                 03380000
034500     PERFORM 3000-BUILD-FILE-KEYS.                                03390000
034600                                                                  03400000
034700     IF PV-LOW-FILE-KEY = PV-HIGH-FILE-KEY                        03410000
034800         ADD 1                   TO PA-KEY-MATCHES                03420000
034900         IF CC-LOW-TABLE = PC-LOW-TABLE-TWKPOSS                   03430000
035000            AND                                                   03440000
035100            CC-HIGH-TABLE = PC-HIGH-TABLE-TWKSCLS                 03450000
035200             PERFORM 5400-COMPARE-BOTH-FILE-AMTS                  03460000
035300         ELSE                                                     03470000
035400             PERFORM 5100-COMPARE-BOTH-FILE-AMTS                  03480000
035500         END-IF                                                   03490000
035600         PERFORM 4100-READ-LOW-EXTRACT-FILE                       03500000
035700         PERFORM 4200-READ-HIGH-EXTRACT-FILE                      03510000
035800     ELSE                                                         03520000
035900         IF PV-LOW-FILE-KEY < PV-HIGH-FILE-KEY                    03530000
036000             PERFORM 5200-PROCESS-ONLY-LOW-FILE                   03540000
036100             PERFORM 4100-READ-LOW-EXTRACT-FILE                   03550000
036200         ELSE                                                     03560000
036300             PERFORM 5300-PROCESS-ONLY-HIGH-FILE                  03570000
036400             PERFORM 4200-READ-HIGH-EXTRACT-FILE                  03580000
036500         END-IF                                                   03590000
036600     END-IF.                                                      03600000
036700                                                                  03610000
036800 EJECT                                                            03620000
036900                                                                  03630000
037000******************************************************************03640000
037100 3000-BUILD-FILE-KEYS.                                            03650000
037200******************************************************************03660000
037300*                                                                 03670000
037400     INITIALIZE PV-LOW-FILE-KEY.                                  03680000
037500     INITIALIZE PV-HIGH-FILE-KEY.                                 03690000
037600                                                                  03700000
037700     IF LLLOW-DATA-INTEGRITY-EXTR-REC = HIGH-VALUES               03710000
037800         MOVE HIGH-VALUES        TO PV-LOW-FILE-KEY               03720000
037900     ELSE                                                         03730000
038000         MOVE LLLOW-FSCL-MN-END-DTE                               03740000
038100                                 TO PV-LOW-FK-FSCL-MN-END-DTE     03750000
038200         MOVE LLLOW-FSCL-MN-NBR  TO PV-LOW-FK-FSCL-MN-NBR         03760000
038300         MOVE LLLOW-DEPT-NBR     TO PV-LOW-FK-DEPT-NBR            03770000
038400         EVALUATE TRUE                                            03780000
038500             WHEN CC-LOW-TABLE = 'TWKDPT'                         03790000
038600                 MOVE '00'       TO PV-LOW-FK-MAJ-CL-NBR          03800000
038700                                    PV-LOW-FK-SUB-CL-NBR          03810000
038800                 MOVE 0          TO PV-LOW-FK-STR-NBR             03820000
                       MOVE SPACES     TO PV-LOW-FK-DKEY-NBR            03830000
038900             WHEN CC-LOW-TABLE = PC-LOW-TABLE-TVADPT              03840000
039000                 MOVE '00'       TO PV-LOW-FK-MAJ-CL-NBR          03850000
039100                                    PV-LOW-FK-SUB-CL-NBR          03860000
039200                 MOVE 0          TO PV-LOW-FK-STR-NBR             03870000
                       MOVE SPACES     TO PV-LOW-FK-DKEY-NBR            03880000
039300             WHEN CC-LOW-TABLE = 'TMNMCL'                         03890000
039400                 MOVE '00'       TO PV-LOW-FK-MAJ-CL-NBR          03900000
039500                                    PV-LOW-FK-SUB-CL-NBR          03910000
039600                 MOVE 0          TO PV-LOW-FK-STR-NBR             03920000
                       MOVE SPACES     TO PV-LOW-FK-DKEY-NBR            03930000
039700             WHEN CC-LOW-TABLE = 'TMNSCL'                         03940000
039800                 MOVE LLLOW-MAJ-CL-NBR                            03950000
039900                                 TO PV-LOW-FK-MAJ-CL-NBR          03960000
040000                 MOVE '00'       TO PV-LOW-FK-SUB-CL-NBR          03970000
040100                 MOVE 0          TO PV-LOW-FK-STR-NBR             03980000
                       MOVE SPACES     TO PV-LOW-FK-DKEY-NBR            03990000
040200             WHEN CC-LOW-TABLE = PC-LOW-TABLE-TVAMCL              04000000
040300                 MOVE LLLOW-MAJ-CL-NBR                            04010000
040400                                 TO PV-LOW-FK-MAJ-CL-NBR          04020000
040500                 MOVE '00'       TO PV-LOW-FK-SUB-CL-NBR          04030000
040600                 MOVE 0          TO PV-LOW-FK-STR-NBR             04040000
                       MOVE SPACES     TO PV-LOW-FK-DKEY-NBR            04050000
040700             WHEN CC-LOW-TABLE = 'TMNDPTS'                        04060000
040800                 MOVE '00'       TO PV-LOW-FK-MAJ-CL-NBR          04070000
040900                                    PV-LOW-FK-SUB-CL-NBR          04080000
041000                 MOVE 0          TO PV-LOW-FK-STR-NBR             04090000
                       MOVE SPACES     TO PV-LOW-FK-DKEY-NBR            04100000
041100             WHEN CC-LOW-TABLE = 'TMNMCLS'                        04110000
041200                 MOVE LLLOW-MAJ-CL-NBR                            04120000
041300                                 TO PV-LOW-FK-MAJ-CL-NBR          04130000
041400                 MOVE '00'       TO PV-LOW-FK-SUB-CL-NBR          04140000
041500                 MOVE 0          TO PV-LOW-FK-STR-NBR             04150000
                       MOVE SPACES     TO PV-LOW-FK-DKEY-NBR            04151000
041600             WHEN CC-LOW-TABLE = 'TMNSCLS'                        04152000
041700                 MOVE LLLOW-MAJ-CL-NBR                            04153000
041800                                 TO PV-LOW-FK-MAJ-CL-NBR          04154000
041900                 MOVE LLLOW-SUB-CL-NBR                            04155000
042000                                 TO PV-LOW-FK-SUB-CL-NBR          04156000
042100                 MOVE 0          TO PV-LOW-FK-STR-NBR             04157000
                       MOVE SPACES     TO PV-LOW-FK-DKEY-NBR            04158000
042200             WHEN CC-LOW-TABLE = 'TWKSCLS'                        04159000
042300                 MOVE LLLOW-MAJ-CL-NBR                            04160000
042400                                 TO PV-LOW-FK-MAJ-CL-NBR          04170000
042500                 MOVE LLLOW-SUB-CL-NBR                            04180000
042600                                 TO PV-LOW-FK-SUB-CL-NBR          04190000
042700                 MOVE LLLOW-STR-NBR                               04200000
042800                                 TO PV-LOW-FK-STR-NBR             04210000
                       MOVE SPACES     TO PV-LOW-FK-DKEY-NBR            04220000
042900*** WR 20698                                                      04230000
043000             WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKPOSS             04240000
043100                 MOVE LLLOW-MAJ-CL-NBR                            04250000
043200                                 TO PV-LOW-FK-MAJ-CL-NBR          04260000
043300                 MOVE LLLOW-SUB-CL-NBR                            04270000
043400                                 TO PV-LOW-FK-SUB-CL-NBR          04280000
043500                 MOVE LLLOW-STR-NBR                               04290000
043600                                 TO PV-LOW-FK-STR-NBR             04300000
                       MOVE SPACES     TO PV-LOW-FK-DKEY-NBR            04310000
043700             WHEN CC-LOW-TABLE = 'TWKMCL'                         04320000
043800                 MOVE LLLOW-MAJ-CL-NBR                            04330000
043900                                 TO PV-LOW-FK-MAJ-CL-NBR          04340000
044000                 MOVE '00'       TO PV-LOW-FK-SUB-CL-NBR          04350000
044100                 MOVE 0          TO PV-LOW-FK-STR-NBR             04360000
                       MOVE SPACES     TO PV-LOW-FK-DKEY-NBR            04370000
044200             WHEN CC-LOW-TABLE = 'TWKMCLS'                        04380000
044300                 MOVE LLLOW-MAJ-CL-NBR                            04390000
044400                                 TO PV-LOW-FK-MAJ-CL-NBR          04400000
044500                 MOVE '00'       TO PV-LOW-FK-SUB-CL-NBR          04410000
044600                 MOVE LLLOW-STR-NBR                               04420000
044700                                 TO PV-LOW-FK-STR-NBR             04430000
                       MOVE SPACES     TO PV-LOW-FK-DKEY-NBR            04440000
044800*** WR 21355                                                      04450000
044900             WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKDPTS             04460000
045000                 MOVE '00'       TO PV-LOW-FK-MAJ-CL-NBR          04470000
045100                                    PV-LOW-FK-SUB-CL-NBR          04480000
045200                 MOVE 0          TO PV-LOW-FK-STR-NBR             04490000
                       MOVE SPACES     TO PV-LOW-FK-DKEY-NBR            04500000
045300             WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKDPTC             04510000
045400                 MOVE '00'       TO PV-LOW-FK-MAJ-CL-NBR          04520000
045500                                    PV-LOW-FK-SUB-CL-NBR          04530000
045600                 MOVE 0          TO PV-LOW-FK-STR-NBR             04540000
                       MOVE SPACES     TO PV-LOW-FK-DKEY-NBR            04550000
045700             WHEN CC-LOW-TABLE = PC-LOW-TABLE-TMNDPTC             04560000
045800                 MOVE '00'       TO PV-LOW-FK-MAJ-CL-NBR          04570000
045900                                    PV-LOW-FK-SUB-CL-NBR          04580000
046000                 MOVE 0          TO PV-LOW-FK-STR-NBR             04590000
                       MOVE SPACES     TO PV-LOW-FK-DKEY-NBR            04600000
046100             WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKMCLC             04610000
046200                 MOVE LLLOW-MAJ-CL-NBR                            04620000
046300                                 TO PV-LOW-FK-MAJ-CL-NBR          04630000
046400                 MOVE '00'       TO PV-LOW-FK-SUB-CL-NBR          04640000
046500                 MOVE 0          TO PV-LOW-FK-STR-NBR             04650000
                       MOVE SPACES     TO PV-LOW-FK-DKEY-NBR            04651000
046600             WHEN CC-LOW-TABLE = PC-LOW-TABLE-TMNMCLC             04652000
046700                 MOVE LLLOW-MAJ-CL-NBR                            04653000
046800                                 TO PV-LOW-FK-MAJ-CL-NBR          04654000
046900                 MOVE '00'       TO PV-LOW-FK-SUB-CL-NBR          04655000
047000                 MOVE 0          TO PV-LOW-FK-STR-NBR             04656000
                       MOVE SPACES     TO PV-LOW-FK-DKEY-NBR            04657000
X28582             WHEN CC-LOW-TABLE = PC-LOW-TABLE-WKLYVND             04658000
X28582                 MOVE LLLOW-MAJ-CL-NBR                            04659000
X28582                                 TO PV-LOW-FK-MAJ-CL-NBR          04660000
X28582                 MOVE LLLOW-SUB-CL-NBR                            04670000
X28582                                 TO PV-LOW-FK-SUB-CL-NBR          04680000
X28582                 MOVE LLLOW-STR-NBR                               04690000
X28582                                 TO PV-LOW-FK-STR-NBR             04700000
X28582                 MOVE SPACES     TO PV-LOW-FK-DKEY-NBR            04701100
047010             WHEN CC-LOW-TABLE = PC-LOW-TABLE-WKLYSUM             04701200
047012                 MOVE LLLOW-MAJ-CL-NBR                            04701300
047013                                 TO PV-LOW-FK-MAJ-CL-NBR          04701400
047014                 MOVE LLLOW-SUB-CL-NBR                            04701500
047015                                 TO PV-LOW-FK-SUB-CL-NBR          04701600
047016                 MOVE LLLOW-STR-NBR                               04701700
047017                                 TO PV-LOW-FK-STR-NBR             04701800
                       MOVE LLLOW-DKEY-NBR                              04701900
                                       TO PV-LOW-FK-DKEY-NBR            04702000
047018             WHEN CC-LOW-TABLE = PC-LOW-TABLE-MNLYSUM             04702100
047019                 MOVE LLLOW-MAJ-CL-NBR                            04702200
047020                                 TO PV-LOW-FK-MAJ-CL-NBR          04702300
047030                 MOVE LLLOW-SUB-CL-NBR                            04702400
047040                                 TO PV-LOW-FK-SUB-CL-NBR          04702500
047050                 MOVE LLLOW-STR-NBR                               04702600
047060                                 TO PV-LOW-FK-STR-NBR             04702700
                       MOVE LLLOW-DKEY-NBR                              04702800
                                       TO PV-LOW-FK-DKEY-NBR            04702900
W34517             WHEN CC-LOW-TABLE = PC-LOW-TABLE-MNLYVND             04703000
W34517                 MOVE LLLOW-MAJ-CL-NBR                            04703100
W34517                                 TO PV-LOW-FK-MAJ-CL-NBR          04703200
W34517                 MOVE LLLOW-SUB-CL-NBR                            04703300
W34517                                 TO PV-LOW-FK-SUB-CL-NBR          04703400
W34517                 MOVE LLLOW-STR-NBR                               04703500
W34517                                 TO PV-LOW-FK-STR-NBR             04703600
W34517                 MOVE LLLOW-DKEY-NBR                              04703700
W34517                                 TO PV-LOW-FK-DKEY-NBR            04703800
047100         END-EVALUATE                                             04703900
047200     END-IF.                                                      04704000
047300                                                                  04705000
047400     IF HHIGH-DATA-INTEGRITY-EXTR-REC = HIGH-VALUES               04706000
047500         MOVE HIGH-VALUES        TO PV-HIGH-FILE-KEY              04707000
047600     ELSE                                                         04708000
047700         MOVE HHIGH-FSCL-MN-END-DTE                               04709000
047800                                 TO PV-HIGH-FK-FSCL-MN-END-DTE    04710000
047900         MOVE HHIGH-FSCL-MN-NBR  TO PV-HIGH-FK-FSCL-MN-NBR        04720000
048000         MOVE HHIGH-DEPT-NBR     TO PV-HIGH-FK-DEPT-NBR           04730000
048100         MOVE HHIGH-MAJ-CL-NBR   TO PV-HIGH-FK-MAJ-CL-NBR         04740000
048200         MOVE HHIGH-SUB-CL-NBR   TO PV-HIGH-FK-SUB-CL-NBR         04750000
048300         MOVE HHIGH-STR-NBR      TO PV-HIGH-FK-STR-NBR            04760000
B28582         IF CC-HIGH-TABLE = PC-HIGH-TABLE-WKLYSUM OR              04770000
B28582                            PC-HIGH-TABLE-MNLYSUM                 04780000
B28582             MOVE HHIGH-DKEY-NBR TO PV-HIGH-FK-DKEY-NBR           04790000
B28582         ELSE                                                     04800000
B28582             MOVE SPACES         TO PV-HIGH-FK-DKEY-NBR           04810000
B28582         END-IF                                                   04820000
048400     END-IF.                                                      04830000
048500                                                                  04840000
048600 EJECT                                                            04850000
048700                                                                  04860000
048800******************************************************************04870000
048900 4000-READ-CONTROL-CARD.                                          04880000
049000******************************************************************04890000
049100*                                                                 04900000
049200     READ COMPARE-TABLES-CTL-FILE                                 04910000
049300       INTO CC-CONTROL-CARD-REC                                   04920000
049400         AT END                                                   04930000
049500             MOVE '4000-READ-CONTROL-CARD'                        04940000
049600                                 TO AA-PARAGRAPH-NAME             04950000
049700             MOVE 'CONTROL CARD IS MISSING'                       04960000
049800                                 TO AA-MESSAGE                    04970000
049900             MOVE +4001          TO ABEND-CODE                    04980000
050000             PERFORM 9900-COMMON-ABEND-ROUTINE                    04990000
050100     END-READ.                                                    05000000
050200                                                                  05010000
050300 EJECT                                                            05020000
050400                                                                  05030000
050500******************************************************************05040000
050600 4100-READ-LOW-EXTRACT-FILE.                                      05050000
050700******************************************************************05060000
050800*                                                                 05070000
050900     IF PS-MORE-LOW-EXTR-RECS                                     05080000
051000         READ L-DATA-INTEGRITY-EXTR-FILE                          05090000
051100           INTO LLLOW-DATA-INTEGRITY-EXTR-REC                     05100000
051200             AT END                                               05110000
051300                 SET PS-NO-MORE-LOW-EXTR-RECS                     05120000
051400                                 TO TRUE                          05130000
051500                 MOVE HIGH-VALUES                                 05140000
051600                                 TO LLLOW-DATA-INTEGRITY-EXTR-REC 05150000
051700         END-READ                                                 05160000
051800     END-IF.                                                      05170000
051900                                                                  05180000
052000     IF PS-MORE-LOW-EXTR-RECS                                     05190000
052100         ADD 1                   TO PA-LOW-RECS-READ              05200000
052200     END-IF.                                                      05210000
052300                                                                  05220000
052400 EJECT                                                            05230000
052500                                                                  05240000
052600******************************************************************05250000
052700 4200-READ-HIGH-EXTRACT-FILE.                                     05260000
052800******************************************************************05270000
052900*                                                                 05280000
053000     IF PS-MORE-HIGH-EXTR-RECS                                    05290000
053100         READ H-DATA-INTEGRITY-EXTR-FILE                          05300000
053200           INTO HHIGH-DATA-INTEGRITY-EXTR-REC                     05310000
053300             AT END                                               05320000
053400                 SET PS-NO-MORE-HIGH-EXTR-RECS                    05330000
053500                                 TO TRUE                          05340000
053600                 MOVE HIGH-VALUES                                 05350000
053700                                 TO HHIGH-DATA-INTEGRITY-EXTR-REC 05360000
053800         END-READ                                                 05370000
053900     END-IF.                                                      05380000
054000                                                                  05390000
054100     IF PS-MORE-HIGH-EXTR-RECS                                    05400000
054200         ADD 1                   TO PA-HIGH-RECS-READ             05410000
054300     END-IF.                                                      05420000
054400                                                                  05430000
054500 EJECT                                                            05440000
054600                                                                  05450000
054700******************************************************************05460000
054800 5100-COMPARE-BOTH-FILE-AMTS.                                     05470000
054900******************************************************************05480000
055000*                                                                 05490000
JAS        SET PS-ACTLS-DIFF-NOTFND                                     05490109
JAS            PS-CALCD-DIFF-NOTFND    TO TRUE.                         05490203
JAS   *    MOVE ZERO                   TO PV-SLS-RTL-AMT                05490312
JAS        MOVE ZERO                   TO PV-MKDN-RTL-AMT               05490412
JAS                                       PV-MKUP-RTL-AMT               05490511
JAS                                       PV-XFER-IN-RTL-AMT            05490611
JAS                                       PV-XFER-OUT-RTL-AMT           05490711
JAS                                       PV-RCPT-RTL-AMT               05490811
JAS                                       PV-RCPT-NET-COST-AMT          05490911
JAS                                       PV-PADJ-RTL-AMT               05491011
JAS                                       PV-PADJ-NET-COST-AMT          05491111
JAS                                       PV-INV-ADJ-RTL-AMT            05491311
JAS                                       PV-SHNK-RTL-AMT               05491411
JAS                                       PV-END-INV-RTL-AMT.           05492011
055100     MOVE HHIGH-FSCL-MN-END-DTE  TO ML112-FSCL-MN-END-DTE.        05500000
055200     MOVE HHIGH-FSCL-MN-NBR      TO ML112-FSCL-MN-NBR.            05510000
055300     MOVE HHIGH-DEPT-NBR         TO ML112-DEPT-NBR.               05520000
055400     MOVE HHIGH-MAJ-CL-NBR       TO ML112-MAJ-CL-NBR.             05530000
055500     MOVE HHIGH-SUB-CL-NBR       TO ML112-SUB-CL-NBR.             05540000
055600     MOVE HHIGH-STR-NBR          TO ML112-STR-NBR.                05550000
B28582     MOVE SPACES                 TO ML112-DKEY-NBR.               05560000
B28582     IF CC-HIGH-TABLE = PC-HIGH-TABLE-WKLYSUM OR                  05560100
X28582                        PC-HIGH-TABLE-MNLYSUM                     05560200
B28582         MOVE HHIGH-DKEY-NBR     TO ML112-DKEY-NBR                05560400
B28582     END-IF.                                                      05560500
B28582     IF CC-LOW-TABLE = PC-LOW-TABLE-WKLYSUM OR                    05560600
W34517                       PC-LOW-TABLE-MNLYSUM OR                    05560700
W34517                       PC-LOW-TABLE-MNLYVND                       05560800
B28582         MOVE LLLOW-DKEY-NBR     TO ML112-DKEY-NBR                05560900
B28582     END-IF.                                                      05561000
055700                                                                  05561100
055800     IF LLLOW-SLS-RTL-AMT NOT = HHIGH-SLS-RTL-AMT                 05561200
055900         MOVE LLLOW-SLS-RTL-AMT  TO ML112-LOW-TBL-AMT             05562000
056000         MOVE HHIGH-SLS-RTL-AMT  TO ML112-HIGH-TBL-AMT            05563000
056100         MOVE 3                  TO ML112-ERR-MSG-NBR             05564000
056200         WRITE DATA-INTEGRITY-DIFF-REC                            05565000
056300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   05566000
056400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05567000
JAS   *        SET PS-ACTLS-DIFF-FND   TO TRUE                          05567112
JAS   *        COMPUTE PV-SLS-RTL-AMT = HHIGH-SLS-RTL-AMT               05567317
JAS   *                               - LLLOW-SLS-RTL-AMT               05567417
056500     END-IF.                                                      05568000
056600                                                                  05569000
056700     IF LLLOW-MKDN-RTL-AMT NOT = HHIGH-MKDN-RTL-AMT               05570000
056800         MOVE LLLOW-MKDN-RTL-AMT TO ML112-LOW-TBL-AMT             05580000
056900         MOVE HHIGH-MKDN-RTL-AMT TO ML112-HIGH-TBL-AMT            05590000
057000         MOVE 4                  TO ML112-ERR-MSG-NBR             05600000
057100         WRITE DATA-INTEGRITY-DIFF-REC                            05610000
057200             FROM ML112-DATA-INTEGRITY-DIFF-REC                   05620000
057300         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05630000
JAS            SET PS-ACTLS-DIFF-FND   TO TRUE                          05631010
JAS            COMPUTE PV-MKDN-RTL-AMT = HHIGH-MKDN-RTL-AMT             05633017
JAS                                    - LLLOW-MKDN-RTL-AMT             05634017
057400     END-IF.                                                      05640000
057500                                                                  05650000
057600     IF LLLOW-MKUP-RTL-AMT NOT = HHIGH-MKUP-RTL-AMT               05660000
057700         MOVE LLLOW-MKUP-RTL-AMT TO ML112-LOW-TBL-AMT             05670000
057800         MOVE HHIGH-MKUP-RTL-AMT TO ML112-HIGH-TBL-AMT            05680000
057900         MOVE 5                  TO ML112-ERR-MSG-NBR             05690000
058000         WRITE DATA-INTEGRITY-DIFF-REC                            05700000
058100             FROM ML112-DATA-INTEGRITY-DIFF-REC                   05710000
058200         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05720000
JAS            SET PS-ACTLS-DIFF-FND   TO TRUE                          05721010
JAS            COMPUTE PV-MKUP-RTL-AMT = HHIGH-MKUP-RTL-AMT             05723017
JAS                                    - LLLOW-MKUP-RTL-AMT             05724017
058300     END-IF.                                                      05730000
058400                                                                  05740000
058500     IF LLLOW-XFER-IN-RTL-AMT NOT = HHIGH-XFER-IN-RTL-AMT         05750000
058600         MOVE LLLOW-XFER-IN-RTL-AMT                               05760000
058700                                 TO ML112-LOW-TBL-AMT             05770000
058800         MOVE HHIGH-XFER-IN-RTL-AMT                               05780000
058900                                 TO ML112-HIGH-TBL-AMT            05790000
059000         MOVE 6                  TO ML112-ERR-MSG-NBR             05800000
059100         WRITE DATA-INTEGRITY-DIFF-REC                            05810000
059200             FROM ML112-DATA-INTEGRITY-DIFF-REC                   05820000
059300         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05830000
JAS            SET PS-ACTLS-DIFF-FND   TO TRUE                          05831010
JAS            COMPUTE PV-XFER-IN-RTL-AMT = HHIGH-XFER-IN-RTL-AMT       05833017
JAS                                       - LLLOW-XFER-IN-RTL-AMT       05834017
059400     END-IF.                                                      05840000
059500                                                                  05850000
059600     IF LLLOW-XFER-OUT-RTL-AMT NOT = HHIGH-XFER-OUT-RTL-AMT       05860000
059700         MOVE LLLOW-XFER-OUT-RTL-AMT                              05870000
059800                                 TO ML112-LOW-TBL-AMT             05880000
059900         MOVE HHIGH-XFER-OUT-RTL-AMT                              05890000
060000                                 TO ML112-HIGH-TBL-AMT            05900000
060100         MOVE 7                  TO ML112-ERR-MSG-NBR             05910000
060200         WRITE DATA-INTEGRITY-DIFF-REC                            05920000
060300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   05930000
060400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05940000
JAS            SET PS-ACTLS-DIFF-FND   TO TRUE                          05941010
JAS            COMPUTE PV-XFER-OUT-RTL-AMT = HHIGH-XFER-OUT-RTL-AMT     05943017
JAS                                        - LLLOW-XFER-OUT-RTL-AMT     05944017
060500     END-IF.                                                      05950000
060600                                                                  05960000
060700     IF LLLOW-RCPT-RTL-AMT NOT = HHIGH-RCPT-RTL-AMT               05970000
060800         MOVE LLLOW-RCPT-RTL-AMT TO ML112-LOW-TBL-AMT             05980000
060900         MOVE HHIGH-RCPT-RTL-AMT TO ML112-HIGH-TBL-AMT            05990000
061000         MOVE 8                  TO ML112-ERR-MSG-NBR             06000000
061100         WRITE DATA-INTEGRITY-DIFF-REC                            06010000
061200             FROM ML112-DATA-INTEGRITY-DIFF-REC                   06020000
061300         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06030000
JAS            SET PS-ACTLS-DIFF-FND   TO TRUE                          06031010
JAS            COMPUTE PV-RCPT-RTL-AMT = HHIGH-RCPT-RTL-AMT             06033017
JAS                                    - LLLOW-RCPT-RTL-AMT             06034017
061400     END-IF.                                                      06040000
061500                                                                  06050000
061600     IF LLLOW-RCPT-NET-COST-AMT NOT = HHIGH-RCPT-NET-COST-AMT     06060000
061700         MOVE LLLOW-RCPT-NET-COST-AMT                             06070000
061800                                 TO ML112-LOW-TBL-AMT             06080000
061900         MOVE HHIGH-RCPT-NET-COST-AMT                             06090000
062000                                 TO ML112-HIGH-TBL-AMT            06100000
062100         MOVE 9                  TO ML112-ERR-MSG-NBR             06110000
062200         WRITE DATA-INTEGRITY-DIFF-REC                            06120000
062300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   06130000
062400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06140000
JAS            SET PS-ACTLS-DIFF-FND   TO TRUE                          06141010
JAS            COMPUTE PV-RCPT-NET-COST-AMT = HHIGH-RCPT-NET-COST-AMT   06141117
JAS                                         - LLLOW-RCPT-NET-COST-AMT   06142017
062500     END-IF.                                                      06150000
062600                                                                  06160000
062700     IF LLLOW-PADJ-RTL-AMT NOT = HHIGH-PADJ-RTL-AMT               06170000
062800         MOVE LLLOW-PADJ-RTL-AMT TO ML112-LOW-TBL-AMT             06180000
062900         MOVE HHIGH-PADJ-RTL-AMT TO ML112-HIGH-TBL-AMT            06190000
063000         MOVE 10                 TO ML112-ERR-MSG-NBR             06200000
063100         WRITE DATA-INTEGRITY-DIFF-REC                            06210000
063200             FROM ML112-DATA-INTEGRITY-DIFF-REC                   06220000
063300         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06230000
JAS            SET PS-ACTLS-DIFF-FND   TO TRUE                          06231010
JAS            COMPUTE PV-PADJ-RTL-AMT = HHIGH-PADJ-RTL-AMT             06231117
JAS                                    - LLLOW-PADJ-RTL-AMT             06232017
063400     END-IF.                                                      06240000
063500                                                                  06250000
063600     IF LLLOW-PADJ-NET-COST-AMT NOT = HHIGH-PADJ-NET-COST-AMT     06260000
063700         MOVE LLLOW-PADJ-NET-COST-AMT                             06270000
063800                                 TO ML112-LOW-TBL-AMT             06280000
063900         MOVE HHIGH-PADJ-NET-COST-AMT                             06290000
064000                                 TO ML112-HIGH-TBL-AMT            06300000
064100         MOVE 11                 TO ML112-ERR-MSG-NBR             06310000
064200         WRITE DATA-INTEGRITY-DIFF-REC                            06320000
064300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   06330000
064400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06340000
JAS            SET PS-ACTLS-DIFF-FND   TO TRUE                          06341010
JAS            COMPUTE PV-PADJ-NET-COST-AMT = HHIGH-PADJ-NET-COST-AMT   06341117
JAS                                         - LLLOW-PADJ-NET-COST-AMT   06342017
064500     END-IF.                                                      06350000
064600**WR21394 COMMENTED OUT OUTER IF TEST                             06360000
064700*    IF CC-LOW-TABLE NOT = PC-LOW-TABLE-TVADPT AND                06370000
064800*       CC-LOW-TABLE NOT = PC-LOW-TABLE-TVAMCL                    06380000
064900     IF LLLOW-INV-ADJ-RTL-AMT NOT = HHIGH-INV-ADJ-RTL-AMT         06390000
065000        MOVE LLLOW-INV-ADJ-RTL-AMT                                06400000
065100                             TO ML112-LOW-TBL-AMT                 06410000
065200        MOVE HHIGH-INV-ADJ-RTL-AMT                                06420000
065300                             TO ML112-HIGH-TBL-AMT                06430000
065400        MOVE 12                  TO ML112-ERR-MSG-NBR             06440000
065500        WRITE DATA-INTEGRITY-DIFF-REC                             06450000
065600            FROM ML112-DATA-INTEGRITY-DIFF-REC                    06460000
065700        ADD 1                    TO PA-REPORT-RECS-WRITTEN        06470000
JAS           SET PS-ACTLS-DIFF-FND    TO TRUE                          06471010
JAS           COMPUTE PV-INV-ADJ-RTL-AMT = HHIGH-INV-ADJ-RTL-AMT        06473017
JAS                                      - LLLOW-INV-ADJ-RTL-AMT        06474017
065800     END-IF.                                                      06480000
065900*    END-IF.                                                      06490000
066000                                                                  06500000
066100*** ELIMINTATE SHRINK TOLERANCE LEVELS                            06510000
066200     IF CC-LOW-TABLE NOT = 'TWKSCLS'                              06520000
066300*        PERFORM 5110-SHRINK-COMPARISONS.                         06530000
066400         IF LLLOW-SHNK-RTL-AMT = HHIGH-SHNK-RTL-AMT               06540000
066500             NEXT SENTENCE                                        06550000
066600         ELSE                                                     06560000
066700             MOVE LLLOW-SHNK-RTL-AMT                              06570000
066800                                 TO ML112-LOW-TBL-AMT             06580000
066900             MOVE HHIGH-SHNK-RTL-AMT                              06590000
067000                                 TO ML112-HIGH-TBL-AMT            06600000
067100             MOVE 13             TO ML112-ERR-MSG-NBR             06610000
067200             WRITE DATA-INTEGRITY-DIFF-REC                        06620000
067300                 FROM ML112-DATA-INTEGRITY-DIFF-REC               06630000
067400             ADD 1               TO PA-REPORT-RECS-WRITTEN        06640000
JAS                SET PS-CALCD-DIFF-FND TO TRUE                        06641009
JAS                COMPUTE PV-SHNK-RTL-AMT = HHIGH-SHNK-RTL-AMT         06643017
JAS                                        - LLLOW-SHNK-RTL-AMT         06644017
067500         END-IF                                                   06650000
067600     END-IF.                                                      06660000
067700                                                                  06670000
067800     IF CC-LOW-TABLE NOT = 'TWKSCLS'                              06680000
067900         IF LLLOW-END-INV-RTL-AMT NOT = HHIGH-END-INV-RTL-AMT     06690000
068000             MOVE LLLOW-END-INV-RTL-AMT                           06700000
068100                                 TO ML112-LOW-TBL-AMT             06710000
068200             MOVE HHIGH-END-INV-RTL-AMT                           06720000
068300                                 TO ML112-HIGH-TBL-AMT            06730000
068400             MOVE 14             TO ML112-ERR-MSG-NBR             06740000
068500             WRITE DATA-INTEGRITY-DIFF-REC                        06750000
068600                 FROM ML112-DATA-INTEGRITY-DIFF-REC               06760000
068700             ADD 1               TO PA-REPORT-RECS-WRITTEN        06770000
JAS                SET PS-CALCD-DIFF-FND TO TRUE                        06770215
JAS                COMPUTE PV-END-INV-RTL-AMT = HHIGH-END-INV-RTL-AMT   06770317
JAS                                           - LLLOW-END-INV-RTL-AMT   06771017
068800         END-IF                                                   06780000
068900     END-IF.                                                      06790000
JAS                                                                     06790102
JAS        IF PS-ACTLS-DIFF-FND OR                                      06790209
JAS           PS-CALCD-DIFF-FND                                         06790302
JAS            MOVE HHIGH-DEPT-NBR          TO PV-DEPT-NBR              06791002
JAS            MOVE PV-DEPT-NBR             TO MLV00000-DEPT-NBR        06792002
JAS            MOVE 5161                    TO MLV00000-ENT-ID          06793002
JAS            MOVE 2230                    TO MLV00000-LBL-SEQ-NBR     06794002
JAS            PERFORM 5101-GET-DKEY                                    06795002
JAS        END-IF.                                                      06801909
069000                                                                  06802009
JAS        IF CC-LOW-TABLE = PC-LOW-TABLE-WKLYSUM                       06802317
JAS            MOVE 'W'                     TO MLT00002-TBL-TM-LVL-CDE  06802418
JAS            MOVE PV-DEPT-NBR             TO MLT00002-DEPT-NBR        06802518
JAS            MOVE HHIGH-FSCL-MN-END-DTE   TO MLT00003-FSCL-DTE        06802618
JAS            PERFORM 5102-GET-PARTN                                   06802718
JAS            IF PS-ACTLS-DIFF-FND                                     06802816
JAS                PERFORM 5103-WRITE-WKLYSUM-ACTLS                     06802916
JAS            END-IF                                                   06803016
JAS            IF PS-CALCD-DIFF-FND                                     06803116
JAS                PERFORM 5104-WRITE-WKLYSUM-CALCD                     06803216
JAS            END-IF                                                   06803316
JAS        END-IF.                                                      06803416
JAS                                                                     06803516
JAS        IF CC-LOW-TABLE = PC-LOW-TABLE-MNLYSUM                       06803617
JAS            MOVE 'M'                     TO MLT00002-TBL-TM-LVL-CDE  06803718
JAS            MOVE PV-DEPT-NBR             TO MLT00002-DEPT-NBR        06803818
JAS            MOVE HHIGH-FSCL-MN-END-DTE   TO MLT00003-FSCL-DTE        06803918
JAS            PERFORM 5102-GET-PARTN                                   06804018
JAS            IF PS-ACTLS-DIFF-FND                                     06804116
JAS                PERFORM 5105-WRITE-MNLYSUM-ACTLS                     06804216
JAS            END-IF                                                   06804316
JAS            IF PS-CALCD-DIFF-FND                                     06804416
JAS                PERFORM 5106-WRITE-MNLYSUM-CALCD                     06804516
JAS            END-IF                                                   06804616
JAS        END-IF.                                                      06804716
JAS                                                                     06805005
069100 EJECT                                                            06810000
JAS   ******************************************************************06811001
JAS   * GET RELATIONSHIP INFORMATION FOR A DEPT/BRAND/VENDOR            06812001
JAS   ******************************************************************06813001
JAS    5101-GET-DKEY.                                                   06814001
JAS                                                                     06815002
JAS        EXEC SQL                                                     06815102
JAS           SELECT ML_LO_MDSE_LVL_ID                                  06816001
JAS                 ,DEPT_NBR                                           06817001
JAS                 ,LBL_SEQ_NBR                                        06818001
JAS                 ,ENT_ID                                             06819001
JAS            INTO :MLV00000-ML-LO-MDSE-LVL-ID                         06819101
JAS                ,:MLV00000-DEPT-NBR                                  06819201
JAS                ,:MLV00000-LBL-SEQ-NBR                               06819301
JAS                ,:MLV00000-ENT-ID                                    06819401
JAS            FROM MLV_BRND_VND                                        06819501
JAS           WHERE ENT_ID        = :MLV00000-ENT-ID                    06819601
JAS             AND LBL_SEQ_NBR   = :MLV00000-LBL-SEQ-NBR               06819701
JAS             AND EFF_BEG_DTE  <= :HHIGH-FSCL-MN-END-DTE              06819802
JAS             AND (EFF_END_DTE IS NULL OR                             06819901
JAS                  EFF_END_DTE >= :HHIGH-FSCL-MN-END-DTE)             06820002
JAS             AND DEPT_NBR      = :MLV00000-DEPT-NBR                  06820101
JAS           WITH UR                                                   06820201
JAS        END-EXEC                                                     06820301
JAS                                                                     06820401
JAS        EVALUATE TRUE                                                06820501
JAS           WHEN SQLCODE = 0                                          06820601
JAS                CONTINUE                                             06820701
JAS           WHEN SQLCODE = +100                                       06820801
JAS                DISPLAY 'RELATIONSHIP WAS NOT FOUND '                06821001
JAS   *                                         DELIMITED BY SIZE       06821101
JAS   *              INTO BV001-PV-RETURN-MSG-1                         06821201
JAS   *            PERFORM BV001-LOOKUP-PAST-RLTNSHP                    06821301
JAS                DISPLAY 'MLV00000-ENT-ID       ' MLV00000-ENT-ID     06821401
JAS                DISPLAY 'MLV00000-LBL-SEQ-NBR  ' MLV00000-LBL-SEQ-NBR06821501
JAS                DISPLAY 'MLV00000-DEPT-NBR     ' MLV00000-DEPT-NBR   06821901
JAS           WHEN OTHER                                                06822001
JAS   *            SET BV001-PV-SQL-ERROR TO TRUE                       06822101
JAS   *            SET BV001-WORK-ERROR-BV-DPT TO TRUE                  06822201
JAS   *            PERFORM BV001-SET-ERROR-MSG2                         06822301
JAS   *            MOVE SQLCODE TO BV001-PV-SQLCODE-OUT                 06822401
JAS   *                            BV001-PV-WORK-SQL-CODE               06822501
JAS   *            STRING 'FAIL RELATIONSHIP LOOKUP' DELIMITED BY SIZE  06822601
JAS   *                   ' IN BV001-LOOKUP-RLTNSHP' DELIMITED BY SIZE  06822701
JAS   *              INTO BV001-PV-RETURN-MSG-1                         06822801
JAS                DISPLAY 'FAIL RELATIONSHIP LOOKUP'                   06822901
JAS                DISPLAY 'MLV00000-ENT-ID       ' MLV00000-ENT-ID     06823001
JAS                DISPLAY 'MLV00000-LBL-SEQ-NBR  ' MLV00000-LBL-SEQ-NBR06823101
JAS                DISPLAY 'MLV00000-DEPT-NBR     ' MLV00000-DEPT-NBR   06823201
JAS                DISPLAY 'SQLCODE ' SQLCODE                           06823301
JAS        END-EVALUATE.                                                06823401
JAS                                                                     06823501
JAS   ******************************************************************06823601
JAS   * GET PARTITION NUMBER                                            06823701
JAS   ******************************************************************06823801
JAS    5102-GET-PARTN.                                                  06823901
JAS                                                                     06824002
JAS        EXEC SQL                                                     06824102
JAS           SELECT PARTN_NBR                                          06824202
JAS                 ,A.DEPT_GP_CDE                                      06824305
JAS            INTO :MLT00003-PARTN-NBR                                 06824405
JAS                ,:MLT00003-DEPT-GP-CDE                               06824505
JAS            FROM MLT_PARTN_CNTL A                                    06824605
JAS                ,MLT_PARTN_BAL  B                                    06824705
JAS           WHERE A.TBL_TM_LVL_CDE = :MLT00002-TBL-TM-LVL-CDE         06824805
JAS             AND A.DEPT_GP_CDE    = B.DEPT_GP_CDE                    06824905
JAS             AND A.TBL_TM_LVL_CDE = B.TBL_TM_LVL_CDE                 06825005
JAS             AND A.FSCL_DTE       = :MLT00003-FSCL-DTE               06825105
JAS             AND EFF_BEG_DTE  <= :HHIGH-FSCL-MN-END-DTE              06825205
JAS             AND (EFF_END_DTE IS NULL OR                             06825305
JAS                  EFF_END_DTE >= :HHIGH-FSCL-MN-END-DTE)             06825405
JAS             AND DEPT_NBR      = :MLT00002-DEPT-NBR                  06825505
JAS           WITH UR                                                   06825605
JAS        END-EXEC.                                                    06825705
JAS                                                                     06825805
JAS        EVALUATE TRUE                                                06825905
JAS           WHEN SQLCODE = 0                                          06826005
JAS                CONTINUE                                             06826105
JAS           WHEN SQLCODE = +100                                       06826205
JAS                DISPLAY 'PARTITION WAS NOT FOUND '                   06826305
JAS           WHEN OTHER                                                06826401
JAS                DISPLAY 'FAIL RELATIONSHIP LOOKUP'                   06827301
JAS                DISPLAY 'SQLCODE ' SQLCODE                           06827401
JAS        END-EVALUATE.                                                06827501
JAS                                                                     06827601
JAS   ******************************************************************06827705
JAS    5103-WRITE-WKLYSUM-ACTLS.                                        06827809
JAS   ******************************************************************06827905
JAS                                                                     06828005
JAS        INITIALIZE ML155-UPDATE-REC.                                 06829009
JAS        MOVE MLV00000-ML-LO-MDSE-LVL-ID TO ML155-ML-LWST-ID.         06830009
JAS        MOVE HHIGH-FSCL-MN-END-DTE      TO ML155-FSCL-WK-END-DTE.    06840009
JAS        MOVE HHIGH-FSCL-MN-NBR          TO ML155-FSCL-WK-NBR.        06841009
JAS        MOVE MLT00003-PARTN-NBR         TO ML155-WK-PARTN-NBR.       06842009
JAS        MOVE MLT00002-DEPT-NBR          TO ML155-DEPT-NBR.           06843009
JAS        MOVE 10                         TO ML155-MAJ-CL-NBR.         06843122
JAS        MOVE 10                         TO ML155-SUB-CL-NBR.         06843222
JAS        MOVE HHIGH-STR-NBR              TO ML155-LOC-NBR.            06843622
JAS   *    MOVE PV-SLS-RTL-AMT             TO ML155-SLS-RTL-AMT.        06843812
JAS        MOVE PV-MKDN-RTL-AMT            TO ML155-MKDN-RTL-AMT.       06843911
JAS        MOVE PV-MKUP-RTL-AMT            TO ML155-MKUP-RTL-AMT.       06844011
JAS        MOVE PV-XFER-IN-RTL-AMT         TO ML155-XFER-IN-RTL-AMT.    06844111
JAS        MOVE PV-XFER-OUT-RTL-AMT        TO ML155-XFER-OUT-RTL-AMT.   06844211
JAS        MOVE PV-RCPT-RTL-AMT            TO ML155-RCPT-RTL-AMT.       06844311
JAS        MOVE PV-RCPT-NET-COST-AMT       TO ML155-RCPT-NET-COST-AMT.  06844411
JAS        MOVE PV-PADJ-RTL-AMT            TO ML155-PADJ-RTL-AMT.       06844511
JAS        MOVE PV-PADJ-NET-COST-AMT       TO ML155-PADJ-NET-COST-AMT.  06844611
JAS        MOVE PV-INV-ADJ-RTL-AMT         TO ML155-INV-ADJ-RTL-AMT.    06844711
JAS                                                                     06844811
JAS        WRITE WKLYSUM-ACTLS-UPDT-REC                                 06844911
JAS            FROM ML155-UPDATE-REC.                                   06845011
JAS                                                                     06845111
JAS        ADD 1                       TO PA-WKLYSUM-ACTLS-WRITTEN.     06845211
JAS                                                                     06845311
JAS    EJECT                                                            06845411
JAS                                                                     06845511
JAS   ******************************************************************06845611
JAS    5104-WRITE-WKLYSUM-CALCD.                                        06845711
JAS   ******************************************************************06845811
JAS                                                                     06845911
JAS        INITIALIZE ML070-COMMON-RECALC-EXTRACT                       06846011
JAS        MOVE 2                          TO ML070-TYPE.               06846123
JAS        MOVE MLV00000-ML-LO-MDSE-LVL-ID TO ML070-ML-LWST-ID.         06846211
JAS        MOVE HHIGH-FSCL-MN-END-DTE      TO ML070-FSCL-END-DTE.       06846311
JAS        MOVE HHIGH-FSCL-MN-NBR          TO ML070-FSCL-PERIOD.        06846411
JAS        MOVE MLT00003-PARTN-NBR         TO ML070-PARTN-NBR.          06846511
JAS        MOVE MLT00002-DEPT-NBR          TO ML070-DEPT-NBR.           06846611
JAS        MOVE 10                         TO ML070-MAJ-CL-NBR.         06846722
JAS        MOVE 10                         TO ML070-SUB-CL-NBR.         06846822
JAS        MOVE MLT00003-DEPT-GP-CDE       TO ML070-PARTN-GROUP.        06846911
JAS        MOVE MLV00000-LBL-SEQ-NBR       TO ML070-LBL-SEQ-NBR.        06847011
JAS        MOVE MLV00000-ENT-ID            TO ML070-ENT-ID.             06847111
JAS        MOVE HHIGH-STR-NBR              TO ML070-LOC-NBR.            06847211
JAS        MOVE PV-SHNK-RTL-AMT            TO ML070-CURR-SHNK-RTL-AMT.  06847314
JAS        MOVE PV-END-INV-RTL-AMT         TO ML070-CURR-END-INV-RTL-AMT06847412
JAS                                                                     06847511
JAS        WRITE WKLYSUM-CALCD-UPDT-REC                                 06847611
JAS            FROM ML070-COMMON-RECALC-EXTRACT.                        06847711
JAS                                                                     06847811
JAS        ADD 1                       TO PA-WKLYSUM-CALCD-WRITTEN.     06847911
JAS                                                                     06848011
JAS    EJECT                                                            06848111
JAS                                                                     06848211
JAS   ******************************************************************06848311
JAS    5105-WRITE-MNLYSUM-ACTLS.                                        06848411
JAS   ******************************************************************06848511
JAS                                                                     06848611
JAS        INITIALIZE ML156-RECORD.                                     06848711
JAS        MOVE MLV00000-ML-LO-MDSE-LVL-ID TO ML156-ML-LWST-ID.         06848811
JAS        MOVE HHIGH-FSCL-MN-END-DTE      TO ML156-FSCL-MN-END-DTE.    06848911
JAS        MOVE HHIGH-FSCL-MN-NBR          TO ML156-FSCL-MN-NBR.        06849011
JAS        MOVE MLT00003-PARTN-NBR         TO ML156-MTH-PARTN-NBR.      06849111
JAS        MOVE MLT00002-DEPT-NBR          TO ML156-DEPT-NBR.           06849211
JAS        MOVE HHIGH-MAJ-CL-NBR           TO ML156-MAJ-CL-NBR.         06849320
JAS        MOVE HHIGH-SUB-CL-NBR           TO ML156-SUB-CL-NBR.         06849420
JAS        MOVE HHIGH-STR-NBR              TO ML156-LOC-NBR.            06849511
JAS   *    MOVE PV-SLS-RTL-AMT             TO ML156-SLS-RTL-AMT.        06849612
JAS        MOVE PV-MKDN-RTL-AMT            TO ML156-MKDN-RTL-AMT.       06849711
JAS        MOVE PV-MKUP-RTL-AMT            TO ML156-MKUP-RTL-AMT.       06849811
JAS        MOVE PV-XFER-IN-RTL-AMT         TO ML156-XFER-IN-RTL-AMT.    06849911
JAS        MOVE PV-XFER-OUT-RTL-AMT        TO ML156-XFER-OUT-RTL-AMT.   06850011
JAS        MOVE PV-RCPT-RTL-AMT            TO ML156-RCPT-RTL-AMT.       06850111
JAS        MOVE PV-RCPT-NET-COST-AMT       TO ML156-RCPT-NET-COST-AMT.  06850211
JAS        MOVE PV-PADJ-RTL-AMT            TO ML156-PADJ-RTL-AMT.       06850311
JAS        MOVE PV-PADJ-NET-COST-AMT       TO ML156-PADJ-NET-COST-AMT.  06850411
JAS        MOVE PV-INV-ADJ-RTL-AMT         TO ML156-INV-ADJ-RTL-AMT.    06850511
JAS                                                                     06850611
JAS        WRITE MNLYSUM-ACTLS-UPDT-REC                                 06850711
JAS            FROM ML156-RECORD.                                       06850811
JAS                                                                     06850911
JAS        ADD 1                       TO PA-MNLYSUM-ACTLS-WRITTEN.     06851011
JAS                                                                     06851111
JAS    EJECT                                                            06851211
JAS                                                                     06851311
JAS   ******************************************************************06851411
JAS    5106-WRITE-MNLYSUM-CALCD.                                        06851511
JAS   ******************************************************************06851611
JAS                                                                     06851711
JAS        INITIALIZE ML070-COMMON-RECALC-EXTRACT                       06851823
JAS        MOVE 2                          TO ML070-TYPE.               06851923
JAS        MOVE MLV00000-ML-LO-MDSE-LVL-ID TO ML070-ML-LWST-ID.         06852011
JAS        MOVE HHIGH-FSCL-MN-END-DTE      TO ML070-FSCL-END-DTE.       06852111
JAS        MOVE HHIGH-FSCL-MN-NBR          TO ML070-FSCL-PERIOD.        06852211
JAS        MOVE MLT00003-PARTN-NBR         TO ML070-PARTN-NBR.          06852311
JAS        MOVE MLT00002-DEPT-NBR          TO ML070-DEPT-NBR.           06852411
JAS        MOVE HHIGH-MAJ-CL-NBR           TO ML070-MAJ-CL-NBR.         06852520
JAS        MOVE HHIGH-SUB-CL-NBR           TO ML070-SUB-CL-NBR.         06852620
JAS        MOVE MLT00003-DEPT-GP-CDE       TO ML070-PARTN-GROUP.        06852711
JAS        MOVE MLV00000-LBL-SEQ-NBR       TO ML070-LBL-SEQ-NBR.        06852811
JAS        MOVE MLV00000-ENT-ID            TO ML070-ENT-ID.             06852911
JAS        MOVE HHIGH-STR-NBR              TO ML070-LOC-NBR.            06853011
JAS        MOVE PV-SHNK-RTL-AMT            TO ML070-CURR-SHNK-RTL-AMT.  06853114
JAS        MOVE PV-END-INV-RTL-AMT         TO ML070-CURR-END-INV-RTL-AMT06853213
JAS                                                                     06853311
JAS        WRITE MNLYSUM-CALCD-UPDT-REC                                 06853411
JAS            FROM ML070-COMMON-RECALC-EXTRACT.                        06853511
JAS                                                                     06853611
JAS        ADD 1                       TO PA-MNLYSUM-CALCD-WRITTEN.     06853711
JAS                                                                     06853811
JAS    EJECT                                                            06853911
JAS                                                                     06854011
JAS   ******************************************************************06854132
JAS    5107-WRITE-MNLYSUM-CALCD.                                        06854232
JAS   ******************************************************************06854332
JAS                                                                     06854432
JAS        INITIALIZE ML070-COMMON-RECALC-EXTRACT                       06854532
JAS        MOVE 2                          TO ML070-TYPE.               06854632
JAS        MOVE MLV00000-ML-LO-MDSE-LVL-ID TO ML070-ML-LWST-ID.         06854732
JAS        MOVE LLLOW-FSCL-MN-END-DTE      TO ML070-FSCL-END-DTE.       06854832
JAS        MOVE LLLOW-FSCL-MN-NBR          TO ML070-FSCL-PERIOD.        06854932
JAS        MOVE MLT00003-PARTN-NBR         TO ML070-PARTN-NBR.          06855032
JAS        MOVE MLT00002-DEPT-NBR          TO ML070-DEPT-NBR.           06855132
JAS        MOVE LLLOW-MAJ-CL-NBR           TO ML070-MAJ-CL-NBR.         06855232
JAS        MOVE LLLOW-SUB-CL-NBR           TO ML070-SUB-CL-NBR.         06855332
JAS        MOVE MLT00003-DEPT-GP-CDE       TO ML070-PARTN-GROUP.        06855432
JAS        MOVE MLV00000-LBL-SEQ-NBR       TO ML070-LBL-SEQ-NBR.        06855532
JAS        MOVE MLV00000-ENT-ID            TO ML070-ENT-ID.             06855632
JAS        MOVE LLLOW-STR-NBR              TO ML070-LOC-NBR.            06855732
JAS        MOVE PV-SHNK-RTL-AMT            TO ML070-CURR-SHNK-RTL-AMT.  06855832
JAS        MOVE PV-END-INV-RTL-AMT         TO ML070-CURR-END-INV-RTL-AMT06855932
JAS                                                                     06856032
JAS        WRITE MNLYSUM-CALCD-UPDT-REC                                 06856132
JAS            FROM ML070-COMMON-RECALC-EXTRACT.                        06856232
JAS                                                                     06856332
JAS        ADD 1                       TO PA-MNLYSUM-CALCD-WRITTEN.     06856432
JAS                                                                     06856532
JAS    EJECT                                                            06856632
JAS                                                                     06856732
069200*** COMMENTED OUT PARAGRAPH                                       06856832
069300******************************************************************06856932
069400*5110-SHRINK-COMPARISONS.                                         06857032
069500******************************************************************06858032
069600*                                                                 06860000
069700*    COMPUTE PV-DIFF-SHNK-RTL-AMT =                               06870000
069800*        LLLOW-SHNK-RTL-AMT - HHIGH-SHNK-RTL-AMT.                 06880000
069900*                                                                 06890000
070000*    IF PV-DIFF-SHNK-RTL-AMT NEGATIVE                             06900000
070100*        COMPUTE PV-DIFF-SHNK-RTL-AMT = PV-DIFF-SHNK-RTL-AMT * -1.06910000
070200*                                                                 06920000
070300*                                                                 06930000
070400* CHANGE EQUATION TO ALLOW A CERTAIN AMOUNT OF VARIANCE           06940000
070500*                                                                 06950000
070600*    IF CC-LOW-TABLE = 'TMNSCLS'                                  06960000
070700*        IF PV-DIFF-SHNK-RTL-AMT > PC-SHNK-MAX-MNSCLS-MNSCL       06970000
070800*            MOVE LLLOW-SHNK-RTL-AMT                              06980000
070900*                                TO ML112-LOW-TBL-AMT             06990000
071000*            MOVE HHIGH-SHNK-RTL-AMT                              07000000
071100*                                TO ML112-HIGH-TBL-AMT            07010000
071200*            MOVE 13             TO ML112-ERR-MSG-NBR             07020000
071300*            WRITE DATA-INTEGRITY-DIFF-REC                        07030000
071400*                FROM ML112-DATA-INTEGRITY-DIFF-REC               07040000
071500*            ADD 1               TO PA-REPORT-RECS-WRITTEN        07050000
071600*        END-IF                                                   07060000
071700*    END-IF.                                                      07070000
071800*                                                                 07080000
071900*    IF CC-LOW-TABLE = 'TMNSCL'                                   07090000
072000*        IF PV-DIFF-SHNK-RTL-AMT > PC-SHNK-MAX-MNSCL-MNMCL        07100000
072100*            MOVE LLLOW-SHNK-RTL-AMT                              07110000
072200*                                TO ML112-LOW-TBL-AMT             07120000
072300*            MOVE HHIGH-SHNK-RTL-AMT                              07130000
072400*                                TO ML112-HIGH-TBL-AMT            07140000
072500*            MOVE 13             TO ML112-ERR-MSG-NBR             07150000
072600*            WRITE DATA-INTEGRITY-DIFF-REC                        07160000
072700*                FROM ML112-DATA-INTEGRITY-DIFF-REC               07170000
072800*            ADD 1               TO PA-REPORT-RECS-WRITTEN        07180000
072900*        END-IF                                                   07190000
073000*    END-IF.                                                      07200000
073100*                                                                 07210000
073200*    IF CC-LOW-TABLE = 'TMNMCL'                                   07220000
073300*        IF PV-DIFF-SHNK-RTL-AMT > PC-SHNK-MAX-MNMCL-MNDPT        07230000
073400*            MOVE LLLOW-SHNK-RTL-AMT                              07240000
073500*                                TO ML112-LOW-TBL-AMT             07250000
073600*            MOVE HHIGH-SHNK-RTL-AMT                              07260000
073700*                                TO ML112-HIGH-TBL-AMT            07270000
073800*                                                                 07280000
073900*            WRITE DATA-INTEGRITY-DIFF-REC                        07290000
074000*                FROM ML112-DATA-INTEGRITY-DIFF-REC               07300000
074100*            ADD 1               TO PA-REPORT-RECS-WRITTEN        07310000
074200*        END-IF                                                   07320000
074300*    END-IF.                                                      07330000
074400                                                                  07340000
074500                                                                  07350000
074600******************************************************************07360000
074700 5200-PROCESS-ONLY-LOW-FILE.                                      07370000
074800******************************************************************07380000
074900*                                                                 07390000
075000     PERFORM 5210-BYPASS-LLLOW-0-DLRS-CHK.                        07400000
075100                                                                  07410000
075200     IF PS-BYPASS-0-DOLLARS                                       07420000
075300         CONTINUE                                                 07430000
075400     ELSE                                                         07440000
075500         PERFORM 5220-PROCESS-NO-HIGH-RECD-ERR                    07450000
075600     END-IF.                                                      07460000
075700                                                                  07470000
075800 EJECT                                                            07480000
075900                                                                  07490000
076000******************************************************************07500000
076100 5210-BYPASS-LLLOW-0-DLRS-CHK.                                    07510000
076200******************************************************************07520000
076300*                                                                 07530000
JAS        SET PS-CORR-EIR-NOTFND TO TRUE.                              07531032
JAS                                                                     07532032
076400     IF (LLLOW-SLS-RTL-AMT = 0)                                   07540000
076500       AND (LLLOW-MKDN-RTL-AMT = 0)                               07550000
076600       AND (LLLOW-MKUP-RTL-AMT = 0)                               07560000
076700       AND (LLLOW-XFER-IN-RTL-AMT = 0)                            07570000
076800       AND (LLLOW-XFER-OUT-RTL-AMT = 0)                           07580000
076900       AND (LLLOW-RCPT-RTL-AMT = 0)                               07590000
077000       AND (LLLOW-RCPT-NET-COST-AMT = 0)                          07600000
077100       AND (LLLOW-PADJ-RTL-AMT = 0)                               07610000
077200       AND (LLLOW-PADJ-NET-COST-AMT = 0)                          07620000
077300       AND (LLLOW-INV-ADJ-RTL-AMT = 0)                            07630000
077400       AND (LLLOW-SHNK-RTL-AMT = 0)                               07640000
JAS          AND (LLLOW-END-INV-RTL-AMT = 0)                            07641024
077500         SET PS-BYPASS-0-DOLLARS TO TRUE                          07650000
077600     ELSE                                                         07660000
JAS            MOVE LLLOW-END-INV-RTL-AMT TO PV-END-INV-RTL-AMT-DISP    07661024
JAS            DISPLAY 'END-INV-RTL-AMT 1     '                         07662027
JAS                     PV-END-INV-RTL-AMT-DISP                         07663027
077700         SET PS-NO-BYPASS-DOLLARS TO TRUE                         07670000
JAS            IF (LLLOW-SLS-RTL-AMT = 0)                               07671032
JAS              AND (LLLOW-MKDN-RTL-AMT = 0)                           07672032
JAS              AND (LLLOW-MKUP-RTL-AMT = 0)                           07673032
JAS              AND (LLLOW-XFER-IN-RTL-AMT = 0)                        07674032
JAS              AND (LLLOW-XFER-OUT-RTL-AMT = 0)                       07675032
JAS              AND (LLLOW-RCPT-RTL-AMT = 0)                           07676032
JAS              AND (LLLOW-RCPT-NET-COST-AMT = 0)                      07677032
JAS              AND (LLLOW-PADJ-RTL-AMT = 0)                           07678032
JAS              AND (LLLOW-PADJ-NET-COST-AMT = 0)                      07679032
JAS              AND (LLLOW-INV-ADJ-RTL-AMT = 0)                        07679132
JAS              AND (LLLOW-SHNK-RTL-AMT = 0)                           07679232
JAS              AND (LLLOW-END-INV-RTL-AMT NOT = 0)                    07679332
JAS                SET PS-CORR-EIR-FND    TO TRUE                       07679432
JAS            ELSE                                                     07679532
JAS                SET PS-CORR-EIR-NOTFND TO TRUE                       07679632
JAS            END-IF                                                   07680032
077800     END-IF.                                                      07681032
077900                                                                  07690000
078000 EJECT                                                            07700000
078100                                                                  07710000
078200******************************************************************07720000
078300 5220-PROCESS-NO-HIGH-RECD-ERR.                                   07730000
078400******************************************************************07740000
078500*                                                                 07750000
078600     MOVE LLLOW-FSCL-MN-END-DTE  TO ML112-FSCL-MN-END-DTE.        07760000
078700     MOVE LLLOW-FSCL-MN-NBR      TO ML112-FSCL-MN-NBR.            07770000
078800     MOVE LLLOW-DEPT-NBR         TO ML112-DEPT-NBR.               07780000
078900     EVALUATE TRUE                                                07790000
079000         WHEN CC-LOW-TABLE = 'TWKDPT'                             07800000
079100             MOVE '00'           TO ML112-MAJ-CL-NBR              07810000
079200                                    ML112-SUB-CL-NBR              07820000
079300             MOVE 0              TO ML112-STR-NBR                 07830000
                   MOVE SPACES         TO ML112-DKEY-NBR                07840000
079400         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TVADPT                  07850000
079500             MOVE '00'           TO ML112-MAJ-CL-NBR              07860000
079600                                    ML112-SUB-CL-NBR              07870000
079700             MOVE 0              TO ML112-STR-NBR                 07880000
                   MOVE SPACES         TO ML112-DKEY-NBR                07890000
079800         WHEN CC-LOW-TABLE = 'TMNMCL'                             07900000
079900             MOVE '00'           TO ML112-MAJ-CL-NBR              07910000
080000                                    ML112-SUB-CL-NBR              07920000
080100             MOVE 0              TO ML112-STR-NBR                 07930000
                   MOVE SPACES         TO ML112-DKEY-NBR                07940000
080200         WHEN CC-LOW-TABLE = 'TMNSCL'                             07950000
080300             MOVE LLLOW-MAJ-CL-NBR                                07960000
080400                                 TO ML112-MAJ-CL-NBR              07970000
080500             MOVE '00'           TO ML112-SUB-CL-NBR              07980000
080600             MOVE 0              TO ML112-STR-NBR                 07990000
                   MOVE SPACES         TO ML112-DKEY-NBR                08000000
080700         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TVAMCL                  08010000
080800             MOVE LLLOW-MAJ-CL-NBR                                08020000
080900                                 TO ML112-MAJ-CL-NBR              08030000
081000             MOVE '00'           TO ML112-SUB-CL-NBR              08040000
081100             MOVE 0              TO ML112-STR-NBR                 08050000
                   MOVE SPACES         TO ML112-DKEY-NBR                08060000
081200         WHEN CC-LOW-TABLE = 'TMNDPTS'                            08070000
081300             MOVE '00'           TO ML112-MAJ-CL-NBR              08080000
081400                                    ML112-SUB-CL-NBR              08090000
081500             MOVE 0              TO ML112-STR-NBR                 08100000
                   MOVE SPACES         TO ML112-DKEY-NBR                08110000
081600         WHEN CC-LOW-TABLE = 'TMNMCLS'                            08120000
081700             MOVE LLLOW-MAJ-CL-NBR                                08130000
081800                                 TO ML112-MAJ-CL-NBR              08140000
081900             MOVE '00'           TO ML112-SUB-CL-NBR              08150000
082000             MOVE 0              TO ML112-STR-NBR                 08160000
                   MOVE SPACES         TO ML112-DKEY-NBR                08170000
082100         WHEN CC-LOW-TABLE = 'TMNSCLS'                            08180000
082200             MOVE LLLOW-MAJ-CL-NBR                                08190000
082300                                 TO ML112-MAJ-CL-NBR              08200000
082400             MOVE LLLOW-SUB-CL-NBR                                08210000
082500                                 TO ML112-SUB-CL-NBR              08220000
082600             MOVE 0              TO ML112-STR-NBR                 08230000
                   MOVE SPACES         TO ML112-DKEY-NBR                08240000
082700         WHEN CC-LOW-TABLE = 'TWKSCLS'                            08250000
082800             MOVE LLLOW-MAJ-CL-NBR                                08260000
082900                                 TO ML112-MAJ-CL-NBR              08270000
083000             MOVE LLLOW-SUB-CL-NBR                                08280000
083100                                 TO ML112-SUB-CL-NBR              08290000
083200             MOVE LLLOW-STR-NBR  TO ML112-STR-NBR                 08300000
                   MOVE SPACES         TO ML112-DKEY-NBR                08310000
083300         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKPOSS                 08320000
083400             MOVE LLLOW-MAJ-CL-NBR                                08330000
083500                                 TO ML112-MAJ-CL-NBR              08340000
083600             MOVE LLLOW-SUB-CL-NBR                                08350000
083700                                 TO ML112-SUB-CL-NBR              08360000
083800             MOVE LLLOW-STR-NBR  TO ML112-STR-NBR                 08370000
                   MOVE SPACES         TO ML112-DKEY-NBR                08380000
083900         WHEN CC-LOW-TABLE = 'TWKMCL'                             08390000
084000             MOVE LLLOW-MAJ-CL-NBR                                08400000
084100                                 TO ML112-MAJ-CL-NBR              08410000
084200             MOVE '00'           TO ML112-SUB-CL-NBR              08420000
084300             MOVE 0              TO ML112-STR-NBR                 08430000
                   MOVE SPACES         TO ML112-DKEY-NBR                08431000
084400***- WR 21355                                                     08432000
084500         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKDPTS                 08433000
084600             MOVE '00'           TO ML112-MAJ-CL-NBR              08434000
084700                                    ML112-SUB-CL-NBR              08435000
084800             MOVE LLLOW-STR-NBR  TO ML112-STR-NBR                 08436000
                   MOVE SPACES         TO ML112-DKEY-NBR                08437000
084900         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKDPTC                 08438000
085000             MOVE '00'           TO ML112-MAJ-CL-NBR              08439000
085100                                    ML112-SUB-CL-NBR              08440000
085200             MOVE 0              TO ML112-STR-NBR                 08450000
                   MOVE SPACES         TO ML112-DKEY-NBR                08460000
085300         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TMNDPTC                 08470000
085400             MOVE '00'           TO ML112-MAJ-CL-NBR              08480000
085500                                    ML112-SUB-CL-NBR              08490000
085600             MOVE 0              TO ML112-STR-NBR                 08500000
                   MOVE SPACES         TO ML112-DKEY-NBR                08510000
085700         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKMCLC                 08520000
085800             MOVE '00'           TO ML112-MAJ-CL-NBR              08530000
085900                                    ML112-SUB-CL-NBR              08540000
086000             MOVE 0              TO ML112-STR-NBR                 08550000
                   MOVE SPACES         TO ML112-DKEY-NBR                08560000
086100         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TMNMCLC                 08570000
086200             MOVE '00'           TO ML112-MAJ-CL-NBR              08580000
086300                                    ML112-SUB-CL-NBR              08590000
086400             MOVE 0              TO ML112-STR-NBR                 08600000
                   MOVE SPACES         TO ML112-DKEY-NBR                08610000
X28582         WHEN CC-LOW-TABLE = PC-LOW-TABLE-WKLYVND                 08620000
X28582             MOVE LLLOW-MAJ-CL-NBR                                08630000
X28582                                 TO ML112-MAJ-CL-NBR              08640000
X28582             MOVE LLLOW-SUB-CL-NBR                                08641000
X28582                                 TO ML112-SUB-CL-NBR              08642000
X28582             MOVE LLLOW-STR-NBR  TO ML112-STR-NBR                 08643000
X28582             MOVE SPACES         TO ML112-DKEY-NBR                08644000
086410         WHEN CC-LOW-TABLE = PC-LOW-TABLE-WKLYSUM                 08644100
086420             MOVE LLLOW-MAJ-CL-NBR                                08644200
086430                                 TO ML112-MAJ-CL-NBR              08644300
086440             MOVE LLLOW-SUB-CL-NBR                                08644400
086450                                 TO ML112-SUB-CL-NBR              08644500
086460             MOVE LLLOW-STR-NBR  TO ML112-STR-NBR                 08644600
                   MOVE LLLOW-DKEY-NBR TO ML112-DKEY-NBR                08644700
086470         WHEN CC-LOW-TABLE = PC-LOW-TABLE-MNLYSUM                 08645000
086480             MOVE LLLOW-MAJ-CL-NBR                                08646000
086490                                 TO ML112-MAJ-CL-NBR              08647000
086491             MOVE LLLOW-SUB-CL-NBR                                08648000
086492                                 TO ML112-SUB-CL-NBR              08649000
086493             MOVE LLLOW-STR-NBR  TO ML112-STR-NBR                 08649100
                   MOVE LLLOW-DKEY-NBR TO ML112-DKEY-NBR                08649200
JAS               DISPLAY 'ML112-FSCL-MN-END-DTE ' ML112-FSCL-MN-END-DTE08649325
JAS                DISPLAY 'ML112-FSCL-MN-NBR     ' ML112-FSCL-MN-NBR   08649524
JAS                DISPLAY 'ML112-DEPT-NBR        ' ML112-DEPT-NBR      08649624
JAS                DISPLAY 'ML112-MAJ-CL-NBR      ' ML112-MAJ-CL-NBR    08649724
JAS                DISPLAY 'ML112-SUB-CL-NBR      ' ML112-SUB-CL-NBR    08649824
JAS                MOVE ML112-STR-NBR  TO PV-STR-NBR                    08649924
JAS                DISPLAY 'ML112-STR-NBR         ' PV-STR-NBR          08650024
JAS                DISPLAY 'END-INV-RTL-AMT 2     '                     08650127
JAS                         PV-END-INV-RTL-AMT-DISP                     08650224
JAS                IF PS-CORR-EIR-FND                                   08650431
JAS                    MOVE LLLOW-END-INV-RTL-AMT                       08650531
JAS                                    TO ML112-LOW-TBL-AMT             08650631
JAS                    MOVE 0          TO ML112-HIGH-TBL-AMT            08650731
JAS                END-IF                                               08650831
W34517         WHEN CC-LOW-TABLE = PC-LOW-TABLE-MNLYVND                 08650931
W34517             MOVE LLLOW-MAJ-CL-NBR                                08651031
W34517                                 TO ML112-MAJ-CL-NBR              08651131
W34517             MOVE LLLOW-SUB-CL-NBR                                08651231
W34517                                 TO ML112-SUB-CL-NBR              08651331
W34517             MOVE LLLOW-STR-NBR  TO ML112-STR-NBR                 08651431
W34517             MOVE LLLOW-DKEY-NBR TO ML112-DKEY-NBR                08651531
086500     END-EVALUATE.                                                08651631
086600                                                                  08651731
JAS   *    MOVE 0                      TO ML112-LOW-TBL-AMT             08651831
JAS   *                                   ML112-HIGH-TBL-AMT.           08651931
JAS        IF PS-CORR-EIR-NOTFND OR                                     08652031
JAS           CC-LOW-TABLE NOT = PC-LOW-TABLE-MNLYSUM                   08652131
JAS            MOVE 0                     TO ML112-LOW-TBL-AMT          08652231
JAS                                          ML112-HIGH-TBL-AMT         08652331
JAS        END-IF.                                                      08652431
JAS        DISPLAY 'ML112-LOW-TBL-AMT ' ML112-LOW-TBL-AMT               08652531
JAS        DISPLAY 'ML112-HIGH-TBL-AMT' ML112-HIGH-TBL-AMT              08652631
086900     MOVE 1                      TO ML112-ERR-MSG-NBR.            08652731
087000                                                                  08652831
087100     WRITE DATA-INTEGRITY-DIFF-REC                                08652931
087200         FROM ML112-DATA-INTEGRITY-DIFF-REC.                      08653024
087300                                                                  08660000
087400     ADD 1                       TO PA-REPORT-RECS-WRITTEN.       08670000
JAS                                                                     08671031
JAS        IF PS-CORR-EIR-FND AND                                       08672031
JAS           CC-LOW-TABLE = PC-LOW-TABLE-MNLYSUM                       08672131
JAS            MOVE ZERO                    TO PV-SHNK-RTL-AMT          08672232
JAS            COMPUTE PV-END-INV-RTL-AMT = ML112-HIGH-TBL-AMT          08672332
JAS                                       - ML112-LOW-TBL-AMT           08672432
JAS            MOVE LLLOW-DEPT-NBR          TO PV-DEPT-NBR              08672632
JAS            MOVE PV-DEPT-NBR             TO MLV00000-DEPT-NBR        08672732
JAS            MOVE 5161                    TO MLV00000-ENT-ID          08672832
JAS            MOVE 2230                    TO MLV00000-LBL-SEQ-NBR     08672932
JAS            PERFORM 5101-GET-DKEY                                    08673032
JAS            MOVE 'M'                     TO MLT00002-TBL-TM-LVL-CDE  08673132
JAS            MOVE PV-DEPT-NBR             TO MLT00002-DEPT-NBR        08673232
JAS            MOVE LLLOW-FSCL-MN-END-DTE   TO MLT00003-FSCL-DTE        08673332
JAS            PERFORM 5102-GET-PARTN                                   08673432
JAS            PERFORM 5107-WRITE-MNLYSUM-CALCD                         08673532
JAS        END-IF.                                                      08674031
087500                                                                  08680000
087600 EJECT                                                            08690000
087700                                                                  08700000
087800******************************************************************08710000
087900 5300-PROCESS-ONLY-HIGH-FILE.                                     08720000
088000******************************************************************08730000
088100*                                                                 08740000
088200     PERFORM 5310-BYPASS-HHIGH-0-DLRS-CHK.                        08750000
088300                                                                  08760000
088400     IF PS-BYPASS-0-DOLLARS                                       08770000
088500         CONTINUE                                                 08780000
088600     ELSE                                                         08790000
088700         PERFORM 5320-PROCESS-NO-LOW-RECD-ERR                     08800000
088800     END-IF.                                                      08810000
088900                                                                  08820000
089000 EJECT                                                            08830000
089100                                                                  08840000
089200******************************************************************08850000
089300 5310-BYPASS-HHIGH-0-DLRS-CHK.                                    08860000
089400******************************************************************08870000
089500*                                                                 08880000
JAS        SET PS-CORR-EIR-NOTFND TO TRUE.                              08881032
JAS                                                                     08882032
089600     IF (HHIGH-SLS-RTL-AMT = 0)                                   08890000
089700       AND (HHIGH-MKDN-RTL-AMT = 0)                               08900000
089800       AND (HHIGH-MKUP-RTL-AMT = 0)                               08910000
089900       AND (HHIGH-XFER-IN-RTL-AMT = 0)                            08920000
090000       AND (HHIGH-XFER-OUT-RTL-AMT = 0)                           08930000
090100       AND (HHIGH-RCPT-RTL-AMT = 0)                               08940000
090200       AND (HHIGH-RCPT-NET-COST-AMT = 0)                          08950000
090300       AND (HHIGH-PADJ-RTL-AMT = 0)                               08960000
090400       AND (HHIGH-PADJ-NET-COST-AMT = 0)                          08970000
090500       AND (HHIGH-INV-ADJ-RTL-AMT = 0)                            08980000
090600       AND (HHIGH-SHNK-RTL-AMT = 0)                               08990000
JAS          AND (HHIGH-END-INV-RTL-AMT = 0)                            08991026
090700         SET PS-BYPASS-0-DOLLARS TO TRUE                          09000000
090800     ELSE                                                         09010000
090900         SET PS-NO-BYPASS-DOLLARS TO TRUE                         09020000
JAS            MOVE HHIGH-END-INV-RTL-AMT TO PV-END-INV-RTL-AMT-DISP    09021028
JAS            DISPLAY 'END-INV-RTL-AMT 3     '                         09022028
JAS                     PV-END-INV-RTL-AMT-DISP                         09023028
JAS            IF (HHIGH-SLS-RTL-AMT = 0)                               09024032
JAS              AND (HHIGH-MKDN-RTL-AMT = 0)                           09025032
JAS              AND (HHIGH-MKUP-RTL-AMT = 0)                           09026032
JAS              AND (HHIGH-XFER-IN-RTL-AMT = 0)                        09027032
JAS              AND (HHIGH-XFER-OUT-RTL-AMT = 0)                       09028032
JAS              AND (HHIGH-RCPT-RTL-AMT = 0)                           09029032
JAS              AND (HHIGH-RCPT-NET-COST-AMT = 0)                      09029132
JAS              AND (HHIGH-PADJ-RTL-AMT = 0)                           09029232
JAS              AND (HHIGH-PADJ-NET-COST-AMT = 0)                      09029332
JAS              AND (HHIGH-INV-ADJ-RTL-AMT = 0)                        09029432
JAS              AND (HHIGH-SHNK-RTL-AMT = 0)                           09029532
JAS              AND (HHIGH-END-INV-RTL-AMT NOT = 0)                    09029632
JAS                SET PS-CORR-EIR-FND    TO TRUE                       09029732
JAS            ELSE                                                     09029832
JAS                SET PS-CORR-EIR-NOTFND TO TRUE                       09029932
JAS            END-IF                                                   09030032
091000     END-IF.                                                      09031000
091100                                                                  09040000
091200 EJECT                                                            09050000
091300                                                                  09060000
091400******************************************************************09070000
091500 5320-PROCESS-NO-LOW-RECD-ERR.                                    09080000
091600******************************************************************09090000
091700*                                                                 09100000
091800     MOVE HHIGH-FSCL-MN-END-DTE  TO ML112-FSCL-MN-END-DTE.        09110000
091900     MOVE HHIGH-FSCL-MN-NBR      TO ML112-FSCL-MN-NBR.            09120000
092000     MOVE HHIGH-DEPT-NBR         TO ML112-DEPT-NBR.               09130000
092100     MOVE HHIGH-MAJ-CL-NBR       TO ML112-MAJ-CL-NBR.             09140000
092200     MOVE HHIGH-SUB-CL-NBR       TO ML112-SUB-CL-NBR.             09150000
092300     MOVE HHIGH-STR-NBR          TO ML112-STR-NBR.                09160000
B28582     IF CC-HIGH-TABLE = PC-HIGH-TABLE-WKLYSUM OR                  09170000
X28582                        PC-HIGH-TABLE-MNLYSUM                     09180000
B28582         MOVE HHIGH-DKEY-NBR TO ML112-DKEY-NBR                    09190000
B28582     ELSE                                                         09200000
B28582         MOVE SPACES         TO ML112-DKEY-NBR                    09210000
B28582     END-IF.                                                      09220000
JAS        DISPLAY 'ML112-FSCL-MN-END-DTE ' ML112-FSCL-MN-END-DTE       09221028
JAS        DISPLAY 'ML112-FSCL-MN-NBR     ' ML112-FSCL-MN-NBR           09222028
JAS        DISPLAY 'ML112-DEPT-NBR        ' ML112-DEPT-NBR              09223028
JAS        DISPLAY 'ML112-MAJ-CL-NBR      ' ML112-MAJ-CL-NBR            09224028
JAS        DISPLAY 'ML112-SUB-CL-NBR      ' ML112-SUB-CL-NBR            09225028
JAS        MOVE ML112-STR-NBR          TO PV-STR-NBR                    09226028
JAS        DISPLAY 'ML112-STR-NBR         ' PV-STR-NBR                  09227028
JAS        DISPLAY 'END-INV-RTL-AMT 4     '                             09228028
JAS                 PV-END-INV-RTL-AMT-DISP                             09229028
JAS   *    MOVE 0                      TO ML112-LOW-TBL-AMT             09230029
JAS   *                                   ML112-HIGH-TBL-AMT.           09240029
JAS        IF PS-CORR-EIR-FND AND                                       09240132
JAS           CC-LOW-TABLE = PC-LOW-TABLE-MNLYSUM                       09241032
JAS            MOVE 0              TO ML112-LOW-TBL-AMT                 09242029
JAS            MOVE HHIGH-END-INV-RTL-AMT                               09243029
JAS                                    TO ML112-HIGH-TBL-AMT            09244029
JAS        ELSE                                                         09245029
JAS            MOVE 0                  TO ML112-LOW-TBL-AMT             09246029
JAS                                       ML112-HIGH-TBL-AMT            09247029
JAS        END-IF.                                                      09248029
JAS        DISPLAY 'ML112-LOW-TBL-AMT 2  ' ML112-LOW-TBL-AMT            09249029
JAS        DISPLAY 'ML112-HIGH-TBL-AMT 2 ' ML112-HIGH-TBL-AMT           09249129
092600     MOVE 2                      TO ML112-ERR-MSG-NBR.            09250000
092700                                                                  09260000
092800     WRITE DATA-INTEGRITY-DIFF-REC                                09270000
092900         FROM ML112-DATA-INTEGRITY-DIFF-REC.                      09280000
093000                                                                  09290000
093100     ADD 1                       TO PA-REPORT-RECS-WRITTEN.       09300000
093200                                                                  09310000
JAS        IF PS-CORR-EIR-FND AND                                       09312032
JAS           CC-LOW-TABLE = PC-LOW-TABLE-MNLYSUM                       09313032
JAS            MOVE ZERO                    TO PV-SHNK-RTL-AMT          09313132
JAS            COMPUTE PV-END-INV-RTL-AMT = ML112-HIGH-TBL-AMT          09313232
JAS                                       - ML112-LOW-TBL-AMT           09313332
JAS            MOVE HHIGH-DEPT-NBR          TO PV-DEPT-NBR              09314032
JAS            MOVE PV-DEPT-NBR             TO MLV00000-DEPT-NBR        09315032
JAS            MOVE 5161                    TO MLV00000-ENT-ID          09316032
JAS            MOVE 2230                    TO MLV00000-LBL-SEQ-NBR     09317032
JAS            PERFORM 5101-GET-DKEY                                    09318032
JAS            MOVE 'M'                     TO MLT00002-TBL-TM-LVL-CDE  09319032
JAS            MOVE PV-DEPT-NBR             TO MLT00002-DEPT-NBR        09319132
JAS            MOVE HHIGH-FSCL-MN-END-DTE   TO MLT00003-FSCL-DTE        09319232
JAS            PERFORM 5102-GET-PARTN                                   09319332
JAS            PERFORM 5106-WRITE-MNLYSUM-CALCD                         09319432
JAS        END-IF.                                                      09319532
JAS                                                                     09319632
093300******************************************************************09320000
093400 5400-COMPARE-BOTH-FILE-AMTS.                                     09330000
093500******************************************************************09340000
093600     MOVE HHIGH-FSCL-MN-END-DTE  TO ML112-FSCL-MN-END-DTE.        09350000
093700     MOVE HHIGH-FSCL-MN-NBR      TO ML112-FSCL-MN-NBR.            09360000
093800     MOVE HHIGH-DEPT-NBR         TO ML112-DEPT-NBR.               09370000
093900     MOVE HHIGH-MAJ-CL-NBR       TO ML112-MAJ-CL-NBR.             09380000
094000     MOVE HHIGH-SUB-CL-NBR       TO ML112-SUB-CL-NBR.             09390000
094100     MOVE HHIGH-STR-NBR          TO ML112-STR-NBR.                09400000
           MOVE HHIGH-DKEY-NBR         TO ML112-DKEY-NBR.               09410000
094200                                                                  09420000
094300     IF LLLOW-RCPT-RTL-AMT NOT = HHIGH-RCPT-RTL-AMT               09430000
094400         MOVE LLLOW-RCPT-RTL-AMT TO ML112-LOW-TBL-AMT             09440000
094500         MOVE HHIGH-RCPT-RTL-AMT TO ML112-HIGH-TBL-AMT            09450000
094600         MOVE 8                  TO ML112-ERR-MSG-NBR             09460000
094700         WRITE DATA-INTEGRITY-DIFF-REC                            09470000
094800             FROM ML112-DATA-INTEGRITY-DIFF-REC                   09480000
094900         ADD 1                   TO PA-REPORT-RECS-WRITTEN        09490000
095000     END-IF.                                                      09500000
095100                                                                  09510000
095200     IF LLLOW-RCPT-NET-COST-AMT NOT = HHIGH-RCPT-NET-COST-AMT     09520000
095300         MOVE LLLOW-RCPT-NET-COST-AMT                             09530000
095400                                 TO ML112-LOW-TBL-AMT             09540000
095500         MOVE HHIGH-RCPT-NET-COST-AMT                             09550000
095600                                 TO ML112-HIGH-TBL-AMT            09560000
095700         MOVE 9                  TO ML112-ERR-MSG-NBR             09570000
095800         WRITE DATA-INTEGRITY-DIFF-REC                            09580000
095900             FROM ML112-DATA-INTEGRITY-DIFF-REC                   09590000
096000         ADD 1                   TO PA-REPORT-RECS-WRITTEN        09600000
096100     END-IF.                                                      09610000
096200                                                                  09620000
096300 EJECT                                                            09630000
096400                                                                  09640000
096500******************************************************************09650000
096600 8000-EOJ.                                                        09660000
096700******************************************************************09670000
096800*                                                                 09680000
096900     DISPLAY ' '.                                                 09690000
097000     DISPLAY '  PROGRAM MLKJS419 PROCESSING SUMMARY'.             09700030
097100     DISPLAY '  -----------------------------------'.             09710000
097200     DISPLAY ' '.                                                 09720000
097300*                                                                 09730000
097400     MOVE PA-LOW-RECS-READ       TO CD-COUNT-HOLD1.               09740000
097500     DISPLAY 'LOW RECORDS READ =       ' CD-COUNT-HOLD1.          09750000
097600*                                                                 09760000
097700     MOVE PA-HIGH-RECS-READ      TO CD-COUNT-HOLD1.               09770000
097800     DISPLAY 'HIGH RECORDS READ =      ' CD-COUNT-HOLD1.          09780000
097900*                                                                 09790000
098000     MOVE PA-KEY-MATCHES         TO CD-COUNT-HOLD1.               09800000
098100     DISPLAY 'KEY MATCHES =            ' CD-COUNT-HOLD1.          09810000
098200*                                                                 09820000
098300     MOVE PA-REPORT-RECS-WRITTEN TO CD-COUNT-HOLD1.               09830000
098400     DISPLAY 'REPORT RECORDS WRITTEN = ' CD-COUNT-HOLD1.          09840000
098200*                                                                 09840115
JAS        MOVE PA-WKLYSUM-ACTLS-WRITTEN TO CD-COUNT-HOLD1.             09840215
JAS        DISPLAY 'WKLYSUM ACTLS WRITTEN = ' CD-COUNT-HOLD1.           09840315
JAS   *                                                                 09840415
JAS        MOVE PA-WKLYSUM-CALCD-WRITTEN TO CD-COUNT-HOLD1.             09840515
JAS        DISPLAY 'WKLYSUM CALCD WRITTEN = ' CD-COUNT-HOLD1.           09840615
JAS   *                                                                 09840715
JAS        MOVE PA-MNLYSUM-ACTLS-WRITTEN TO CD-COUNT-HOLD1.             09840815
JAS        DISPLAY 'MNLYSUM ACTLS WRITTEN = ' CD-COUNT-HOLD1.           09840915
JAS   *                                                                 09841015
JAS        MOVE PA-MNLYSUM-CALCD-WRITTEN TO CD-COUNT-HOLD1.             09841115
JAS        DISPLAY 'MNLYSUM CALCD WRITTEN = ' CD-COUNT-HOLD1.           09841215
JAS   *                                                                 09850015
098600     DISPLAY ' '.                                                 09860000
098700                                                                  09870000
098800     CLOSE COMPARE-TABLES-CTL-FILE.                               09880000
098900     CLOSE L-DATA-INTEGRITY-EXTR-FILE.                            09890000
099000     CLOSE H-DATA-INTEGRITY-EXTR-FILE.                            09900000
099100     CLOSE DATA-INTEGRITY-DIFF-FILE.                              09910000
JAS        CLOSE WKLYSUM-ACTLS-UPDT-FILE.                               09911015
JAS        CLOSE WKLYSUM-CALCD-UPDT-FILE.                               09911115
JAS        CLOSE MNLYSUM-ACTLS-UPDT-FILE.                               09912015
JAS        CLOSE MNLYSUM-CALCD-UPDT-FILE.                               09914015
099200                                                                  09920000
099300 EJECT                                                            09930000
099400                                                                  09940000
099500******************************************************************09950000
099600 9900-COMMON-ABEND-ROUTINE.                                       09960000
099700******************************************************************09970000
099800*                                                                 09980000
099900     DISPLAY AA-ABEND-LIT.                                        09990000
100000     DISPLAY AA-PROGRAM-LIT.                                      10000000
100100     DISPLAY AA-PARAGRAPH-LIT.                                    10010000
100200     DISPLAY AA-MESSAGE-LINE.                                     10020000
100300     DISPLAY ABEND-CODE.                                          10030000
100400                                                                  10040000
100500     CALL 'ILBOABN0' USING ABEND-CODE.                            10050000
100600                                                                  10060000
