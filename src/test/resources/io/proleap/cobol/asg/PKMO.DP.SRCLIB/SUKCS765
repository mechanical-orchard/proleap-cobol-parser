000801*--CHANGE TO ADD RFID CHECKS FOR DIRECTIVES---------------------* 00010099
000100*-----------------------*                                         00020001
000200 IDENTIFICATION DIVISION.                                         00030001
000300*-----------------------*                                         00040099
000400 PROGRAM-ID.    SUKCS765.                                         00050001
000500 AUTHOR.        OMAN.                                             00060001
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070001
000700 DATE-WRITTEN.  OCTOBER 2008.                                     00080001
000800 DATE-COMPILED.                                                   00090001
000801*---------------------------------------------------------------* 00100099
000802* 18574 IR     DAVID MEDICI. FORMAT PO-RCVR ON SCREEN AS        * 00110099
000803*              8-DIGIT PO, 3-DIGIT RCVR SEPARATED BY HYPHEN.    * 00120099
000804*                                                               * 00130099
000805* 12/29 OMAN  CHANGE 7200- FUNCTION TEMPORARILY UNTIL NEW ONE   * 00140099
000806*             IS DEFINED.  NO IR.  MIKE W. WAS NOT ABLE TO DO   * 00150099
000807*             ANYTHING.                                         * 00160099
000808*                                                               * 00170099
000809* 12/26 OMAN  ADD NULL INDICATORS FOR ANY FIELDS WHERE          * 00180099
000810*             APPLICABLE.  NO IR.  DAVID M E-MAIL               * 00190099
000811*                                                               * 00200099
000812* 12/26 OMAN  CHANGED RACF FUNCTION IN 7200- PARA TO SUDIRRLS.  * 00210099
000813*             CATHY FAIRWEATHER E-MAIL.                         * 00220099
000814*                                                               * 00230099
000815* 12/22 OMAN  ADDED 2050-DELETE-LIST-QUEUE TO F19 AND F20       * 00240099
000816* 17861 IR    LOGIC TO FIX DISPLAY ISSUE.                       * 00250099
000817*                                                               * 00260099
000818*                                                               * 00270099
000815* 12/13 RLK    ADDED LOGIC TO SET DIRECTIVES WHEN FAILED OR     * 00280099
000819*              PENDING RFID AUDIT.                              * 00290099
000820*                                                               * 00300099
000815* 09/14 CLP    CHANGED PO# FROM 7 DIGITS TO 8 DIGITS            * 00311099
000820*                                                               * 00313099
000830*---------------------------------------------------------------* 00320099
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00322099
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00323099
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00324099
001130*                                                                 00324199
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00324299
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00324399
263968*---------------------------------------------------------------* 00325099
000900                                                                  00330001
001000*---------------------------------------------------------------* 00340001
001100*    S765 - DIRECTIVE RELEASE BY CARTON SCREEN                  * 00350045
001200*                                                               * 00360022
001300*    CAN BE ACCESSED BY:               FMT                      * 00370057
001400*        F22 SULDHSTL SUKCS773 FORMAT - 3 - SUWS101 - 102       * 00380057
001500*        F24 SULDRLNE SUKCS799 FORMAT - 2 - SUWS098 - 099       * 00390057
001600*        F22 SULDRLST SUKCS772 FORMAT - 3 - SUWS101 - 102       * 00400057
001700*        F24 SULDRRCR SUKCS768 FORMAT - 2 - SUWS098 - 099       * 00410045
001800*        F24 SUSDRRSL SUKCS798 FORMAT - 1 - SUWS097             * 00420045
001900*                                                               * 00430045
002000*                                                               * 00440022
002100*---------------------------------------------------------------* 00450001
002200 ENVIRONMENT DIVISION.                                            00460001
002300 DATA DIVISION.                                                   00470001
002400                                                                  00480001
002500 WORKING-STORAGE SECTION.                                         00490001
002600                                                                  00500001
002700 01  DK-DB2-KEYS.                                                 00510001
002800     05  DK-OPER-UNT-ID            PIC S9(04) COMP VALUE +0.      00520001
002900     05  DK-PO-NBR                 PIC S9(09) COMP VALUE +0.      00530030
003000     05  DK-REC-SEQ-NBR            PIC S9(09) COMP VALUE +0.      00540030
003100     05  DK-PO-LNE-NBR             PIC S9(09) COMP VALUE +0.      00550030
003200     05  DK-TRIP-ID                PIC S9(09) COMP VALUE +0.      00560061
003300     05  DK-PREPK-ID               PIC S9(04) COMP VALUE +0.      00570030
003400     05  DK-SHIPT-UNT-ID           PIC S9(18) COMP-3 VALUE 0.     00580051
003500     05  DK-AUD-CNTL-NBR           PIC S9(09)  COMP VALUE +0.     00590030
003600     05  DK-BRCDE-NBR              PIC X(22)      VALUE SPACES.   00600030
003700     05  DK-STATUS-DATE            PIC X(10)      VALUE SPACES.   00610030
003800     05  DK-STATUS-TIME            PIC X(08)      VALUE SPACES.   00620030
003900                                                                  00630030
004000 01  DN-DB2-NULL-INDICATORS.                                      00640030
004100     05  DN-VEH-NBR                PIC S9(04) COMP VALUE +0.      00650030
004110     05  DN-CASI-CDE               PIC S9(04) COMP VALUE +0.      00660099
004120     05  DN-AUD-FALR-RSN-NM        PIC S9(04) COMP VALUE +0.      00670099
004130     05  DN-STR-ZN-ID              PIC S9(04) COMP VALUE +0.      00680099
004140     05  DN-SEASET-YR              PIC S9(04) COMP VALUE +0.      00690099
004150     05  DN-SEASET-SHRT-NM         PIC S9(04) COMP VALUE +0.      00700099
004200                                                                  00710099
004300 01  PC-PROGRAM-CONSTANTS.                                        00720001
004400     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SUK765  '.  00730001
004500     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM765 '.  00740001
004600     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS765'.  00750001
004700     05  PC-APPL-MAP               PIC S9(04)  VALUE  +1          00760001
004800                                                     COMP.        00770001
004900     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00780001
005000     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00790001
005100     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00800001
005200     05  PC-DETAIL-SCREEN          PIC  X(01)  VALUE '2'.         00810001
005300     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +09          00820006
005400                                               COMP SYNC.         00830001
005500     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00840001
005600                                               COMP SYNC.         00850001
005700     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00860001
005800                                               COMP-3.            00870001
005900     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00880001
006000                                               COMP SYNC.         00890001
006100     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00900001
006200                                               COMP-3.            00910001
006300     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00920001
006400     05  PC-ADD                    PIC  X(03)  VALUE 'ADD'.       00930001
006500     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00940001
006600     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00950001
006700     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00960001
006800     05  PC-DOOR                   PIC  X(04)  VALUE 'DOOR'.      00970001
006900     05  PC-STORE                  PIC  X(05)  VALUE 'STORE'.     00980001
007000     05  PC-CAROUSEL               PIC  X(08)  VALUE 'CAROUSEL'.  00990096
007100     05  PC-01                     PIC  X(02)  VALUE '01'.        01000001
007200     05  PC-A                      PIC  X(01)  VALUE 'A'.         01010001
007300     05  PC-D                      PIC  X(01)  VALUE 'D'.         01020001
007400     05  PC-S                      PIC  X(01)  VALUE 'S'.         01030001
007500     05  PC-U                      PIC  X(01)  VALUE 'U'.         01040001
007600     05  PC-Y                      PIC  X(01)  VALUE 'Y'.         01050031
007700     05  PC-RLO                    PIC  X(03)  VALUE 'RLO'.       01060054
007800     05  PC-MULTI                  PIC  X(05)  VALUE 'MULTI'.     01070001
007900     05  PC-DEFAULT-TIMESTAMP     PIC  X(26)                      01080001
008000                          VALUE  '9999-09-09-09.09.09.999999'.    01090001
008100                                                                  01100094
008200**   FOLLOWING ARE PACK TYPE DESCRIPTIONS                         01110093
008300**                                                                01120093
008400     05  PC-MULTIPLE-SKU-PPK       PIC  X(20)  VALUE              01130093
008500         'M-MULTI SKU PREPACK '.                                  01140093
008600     05  PC-SINGLE-SKU-PPK         PIC  X(20)  VALUE              01150093
008700         'S-SINGLE SKU PREPACK'.                                  01160093
008800     05  PC-INNER-PPK              PIC  X(20)  VALUE              01170093
008900         'I-INNER PREPACK     '.                                  01180093
009000     05  PC-BULK-PPK               PIC  X(20)  VALUE              01190093
009100         'B-BULK PACK         '.                                  01200093
009200     05  PC-CASEPACK               PIC  X(20)  VALUE              01210093
009300         'C-CASEPACK          '.                                  01220093
009400     05  PC-PACK-BY-STORE          PIC  X(20)  VALUE              01230093
009500         'PACK BY STORE       '.                                  01240093
009600     05  PC-OTHER                  PIC  X(20)  VALUE              01250093
009700         'OTHER - ?????       '.                                  01260093
009800                                                                  01270001
009900*----------------------------------------------------------------*01280001
010000*  SYSTEM MESSAGES                                               *01290001
010100*----------------------------------------------------------------*01300001
010200*   00005 = INVALID VALUE                                        *01310001
010300*   00008 = MUST BE NUMERIC                                      *01320001
010400*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01330001
010500*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01340001
010600*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01350001
010700*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01360001
010800*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01370001
010900*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01380001
011000*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01390001
011100*   00069 - TOP OF LIST                                          *01400001
011200*   00070 - BOTTOM OF LIST                                       *01410001
011300*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01420001
011400*   00279 - MORE ITEMS TO DISPLAY                                *01430001
011500*   02571 - UNABLE TO UPD - CURRENT OPER UNT AND OPER UNIT ID ENTE01440001
011600*   02575 - STORE ASSIGNMNT FUNCTION ONLY VALID FOR DOOR TYPES SHI01450001
011610*   03645 - UNABLE TO RELEASE DIRECTIVES FOR ANOTHER DC          *01460099
011620*   03646 - YOU DO NOT HAVE AUTHORITY TO RELEASE DIRECTIVES.     *01470099
011630*   03657 - DIRECTIVES HAVE BEEN RELEASED                        *01480099
011700*----------------------------------------------------------------*01490001
011800     05  PC-TSYMSG-NUMBERS.                                       01500001
011900         10  PC-TSYMSG-00004            PIC  9(05)  VALUE 00004.  01510053
012000         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01520053
012100         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01530001
012200         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01540078
012300         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01550001
012400         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01560001
012500         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01570001
012600         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01580001
012700         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01590001
012800         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01600001
012900         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01610001
013000         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01620001
013100         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01630001
013200         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01640001
013300         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01650001
013400         10  PC-TSYMSG-02571            PIC  9(05)  VALUE 02571.  01660001
013500         10  PC-TSYMSG-02575            PIC  9(05)  VALUE 02575.  01670001
013600         10  PC-TSYMSG-03628            PIC  9(05)  VALUE 03628.  01680099
013700         10  PC-TSYMSG-03640            PIC  9(05)  VALUE 03640.  01690099
013800         10  PC-TSYMSG-03641            PIC  9(05)  VALUE 03641.  01700053
013900         10  PC-TSYMSG-03642            PIC  9(05)  VALUE 03642.  01710053
014000         10  PC-TSYMSG-03643            PIC  9(05)  VALUE 03643.  01720053
014100         10  PC-TSYMSG-03645            PIC  9(05)  VALUE 03645.  01730099
014200         10  PC-TSYMSG-03646            PIC  9(05)  VALUE 03646.  01740053
014300         10  PC-TSYMSG-03657            PIC  9(05)  VALUE 03657.  01750099
014310         10  PC-TSYMSG-03660            PIC  9(05)  VALUE 03660.  01760099
014400*                                                                 01770001
014500 01  PS-PROGRAM-SWITCHES.                                         01780001
014600     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01790001
014700         88  PS-NO-ERROR                            VALUE 'Y'.    01800001
014800         88  PS-ERROR                               VALUE 'N'.    01810001
014900     05  PS-RELEASE-ALLOWED-SW          PIC  X(01)  VALUE 'Y'.    01820042
015000         88  PS-RELEASE-ALLOWED                     VALUE 'Y'.    01830042
015100         88  PS-RELEASE-NOT-ALLOWED                 VALUE 'N'.    01840042
015200     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01850001
015300         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01860001
015400         88  PS-BLOCK-ERROR                         VALUE 'N'.    01870001
015500     05  PS-CONFIRM-PROCESSING-IND      PIC  X(01)  VALUE  'N'.   01880001
015600         88  PS-CONFIRM-PROCESSING                  VALUE  'Y'.   01890001
015700         88  PS-NOT-CONFIRM-PROCESSING              VALUE  'N'.   01900001
015800     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    01910001
015900         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    01920001
016000         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    01930001
016100     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01940001
016200         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01950001
016300         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01960001
016400     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    01970001
016500         88  PS-LIST-END                            VALUE 'Y'.    01980001
016600         88  PS-NO-LIST-END                         VALUE 'N'.    01990001
      * 12/13 RLK BEG                                                   02000099
016400     05  PS-RFID-AUDIT-NO-FAIL-SW       PIC  X(01)  VALUE 'N'.    02010099
016500         88  PS-RFID-AUDIT-NO-FAIL                  VALUE ' '.    02020099
016600         88  PS-FAILED-RF-AUD                       VALUE 'F'.    02030099
016600         88  PS-PENDING-RF-AUD                      VALUE 'I'.    02040099
016600         88  PS-FAILED-PENDING-RF-FOUND        VALUES 'I', 'F'.   02050099
      * 12/13 RLK END                                                   02060099
016700*                                                                 02070001
016800 01  PV-PROGRAM-VARIABLES.                                        02080001
016900     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  02090001
017000                                        COMP SYNC.                02100001
017100     05  PV-SUB                         PIC S9(04)  VALUE +0      02110001
017200                                                    COMP SYNC.    02120001
017300     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02130001
017400                                                    COMP SYNC.    02140001
017500     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02150001
017600                                                    COMP-3.       02160001
017700     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02170001
017800                                                    COMP-3.       02180001
017900     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02190001
018000                                                    COMP-3.       02200001
018100     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02210001
018200                                                    COMP-3.       02220001
018300     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02230001
018400                                                    COMP-3.       02240001
018500     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02250001
018600                                                    COMP-3.       02260001
018700     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02270001
018800                                                    COMP-3.       02280001
018900     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02290001
019000                                                    COMP SYNC.    02300001
019100     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02310001
019200                                                    COMP SYNC.    02320001
019300     05  PV-ITEM                        PIC S9(04)  VALUE +0      02330001
019400                                                    COMP SYNC.    02340001
019500     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02350001
019600                                                    COMP SYNC.    02360001
019700     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02370001
019800                                                    COMP SYNC.    02380001
019900     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02390001
020000                                                    COMP SYNC.    02400001
020100     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02410001
020200                                                    COMP SYNC.    02420001
020300     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02430001
020400                                                    COMP SYNC.    02440001
020500     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02450001
020600                                                    COMP SYNC.    02460001
020700     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02470001
020800                                                    COMP SYNC.    02480001
020900     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02490001
021000                                                    COMP SYNC.    02500001
021100     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02510001
021200                                                    COMP SYNC.    02520001
021300     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02530001
021400                                                    COMP SYNC.    02540001
021500     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02550001
021600                                                    COMP SYNC.    02560001
021700     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02570001
021800                                                    COMP SYNC.    02580001
021900     05  PV-SOFT-ABORT-MSG.                                       02590001
022000         10  FILLER            PIC X(12) VALUE ' SUKCS765 - '.    02600001
022100         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02610001
022200         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02620001
022300         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02630001
022400         10  PV-SOFT-PARAGRAPH PIC X(30).                         02640001
022500     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02650001
022600                                                     COMP SYNC.   02660001
022700     05  PV-CICS-MSG-AREA.                                        02670099
022710         10  FILLER                    PIC X(19)     VALUE        02680099
022720                       'SUKUT129 CALLED BY '.                     02690099
022730         10  PV-MSG-PGM                PIC X(08)     VALUE SPACES.02700099
022740         10  PV-ERROR-TYPE             PIC X(14)     VALUE SPACES.02710099
022750             88  PV-PARM-ERROR                       VALUE        02720099
022760                       '  PARM ERROR: '.                          02730099
022770             88  PV-DB2-ERROR                        VALUE        02740099
022780                       '   DB2 ERROR: '.                          02750099
022790             88  PV-MQ-ERROR                         VALUE        02760099
022791                       '    MQ ERROR: '.                          02770099
022792             88  PV-OTHER-ERROR                      VALUE        02780099
022793                       ' OTHER ERROR: '.                          02790099
022794         10  PV-ERROR-DESC             PIC X(59)     VALUE SPACES.02800099
022795     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02810099
022900     05  PV-CICS-MSG-HOLD.                                        02820001
023000         10  FILLER                      PIC  X(01)  VALUE SPACE. 02830001
023100         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02840001
023200     05  PV-CICS-MSG-HOLD2.                                       02850001
023300         10  FILLER                      PIC  X(01)  VALUE SPACE. 02860001
023400         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02870001
023500                                                                  02880001
023600     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     02890001
023700                                                     COMP SYNC.   02900001
023800     05  PV-EXPECTED-CARTONS      PIC S9(04)  VALUE 0 COMP.       02910035
023900     05  PV-DIRECTIVE-CARTONS     PIC S9(04)  VALUE 0 COMP.       02920035
024000                                                                  02930098
024100     05  PV-ITEMS-HOLD            PIC S9(03)  COMP-3.             02940001
024200     05  PV-ITEMS-DIFF            PIC S9(03)  COMP-3.             02950001
024300                                                                  02960098
024400     05  PV-SQLCODE               PIC S9(09)  VALUE 0.            02970059
024500     05  PV-MQ-COND-CODE          PIC S9(09)  VALUE 0.            02980059
024600     05  PV-MQ-REAS-CODE          PIC S9(09)  VALUE 0.            02990059
024700                                                                  03000098
024800     05  PV-ASSIGN-TMST           PIC  X(26)  VALUE SPACES.       03010098
024900     05  PV-AUDIT-STATUS          PIC  X(08)  VALUE SPACES.       03020098
022800     05  PV-RFID-AUD-CNTL         PIC  S9(9) COMP  VALUE +0.      03030099
024910     05  PV-PO-RCVR-FORMAT.                                       03040099
024920         10  PV-PO-NBR            PIC  9(08)  VALUE 0.            03050099
024930         10  FILLER               PIC  X(01)  VALUE '-'.          03060099
024940         10  PV-RCVR-NBR          PIC  9(03)  VALUE 0.            03070099
025000                                                                  03080001
025100******************************************************************03090001
025200**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03100001
025300**  THIS MUST BE THE EXACT SAME FORMAT AS BLOCK IN THE          **03110001
025400**  APPLICATION-SPECIFIC COMMAREA.                              **03120001
025500******************************************************************03130001
025600 01  LQW-LIST-QUEUE-WORK-AREA.                                    03140001
025700     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03150001
025800     05  LQW-ITEM-ENTRIES               OCCURS 09 TIMES           03160005
025900                                        INDEXED BY LQW-IDX.       03170001
026000         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03180001
026100         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03190001
026200         10  LQW-SELECTED-SW            PIC  X(01).               03200001
026300             88  LQW-SELECT                         VALUE 'S'.    03210001
026400             88  LQW-DESELECT                       VALUE ' '.    03220001
026500         10  LQW-ACTION                 PIC  X(03).               03230001
026600             88  LQW-ADD                            VALUE 'ADD'.  03240001
026700             88  LQW-INQ                            VALUE 'INQ'.  03250001
026800             88  LQW-UPD                            VALUE 'UPD'.  03260001
026900             88  LQW-ERR                            VALUE 'ERR'.  03270001
027000         10  LQW-BARCODE                PIC  X(22).               03280006
027100         10  LQW-CASI                   PIC  X(01).               03290017
027200         10  LQW-AUD-STAT-CDE           PIC  X(08).               03300099
027300         10  LQW-AUD-CNTL-NBR           PIC  9(09).               03310017
027400         10  LQW-DIRECTIVE-TMST         PIC  X(26).               03320006
027500         10  LQW-LNE-NBR             PIC  9(04).                  03330065
027600         10  LQW-PREPK-ID            PIC  9(04).                  03340065
027700         10  LQW-SHIPT-UNT-ID        PIC S9(18) COMP-3.           03350065
027800         10  LQW-STR-NBR             PIC S9(04) COMP.             03360065
027900         10  LQW-AUD-FALR-RSN-NM     PIC  X(04).                  03370065
028000         10  LQW-STR-ZN-ID           PIC  X(05).                  03380065
028100         10  LQW-SEASET-YR           PIC  X(04).                  03390065
028200         10  LQW-SEASET-SHRT-NM      PIC  X(05).                  03400065
028300         10  LQW-BRCDE-TYPE          PIC  X(01).                  03410065
028400*---------------------------------------------------------------* 03420001
028500*    COMMAREA TO CALL SUKUT129                                  * 03430022
028600*---------------------------------------------------------------* 03440001
028700     COPY SUWS090.                                                03450022
028800                                                                  03460022
028900*---------------------------------------------------------------* 03470022
029000* SELECTION QUEUE LAYOUT                                        * 03480022
029100*---------------------------------------------------------------* 03490022
029200     COPY SUWS099.                                                03500022
029300                                                                  03510099
029400*---------------------------------------------------------------* 03520099
029500* SELECTION QUEUE LAYOUT                                        * 03530099
029600*---------------------------------------------------------------* 03540099
029700     COPY SUWS102.                                                03550099
029800                                                                  03560001
029900*---------------------------------------------------------------* 03570001
030000*    MAP LAYOUT                                                 * 03580001
030100*---------------------------------------------------------------* 03590001
030200     COPY SUKM765.                                                03600001
030300*                                                                 03610001
030400 01  MR-OCCURS-LAYOUT                   REDEFINES  SUK765O.       03620001
030500     05  FILLER                         PIC X(172).               03630099
030700     05  MR-SCROLL-AREA                 OCCURS 09 TIMES.          03640005
030800         10  MR-SELECTL                 PIC S9(04) COMP.          03650001
030900         10  MR-SELECTA                 PIC  X(01).               03660001
031000         10  MR-SELECTC                 PIC  X(01).               03670001
031100         10  MR-SELECTH                 PIC  X(01).               03680001
031200         10  MR-SELECTI                 PIC  X(01).               03690001
031300                                                                  03700001
031400         10  MR-ACTIONL                 PIC S9(04) COMP.          03710001
031500         10  MR-ACTIONA                 PIC  X(01).               03720001
031600         10  MR-ACTIONC                 PIC  X(01).               03730001
031700         10  MR-ACTIONH                 PIC  X(01).               03740001
031800         10  MR-ACTION                  PIC  X(03).               03750001
031900                                                                  03760001
032000         10  MR-LINE-PACKL             PIC S9(04) COMP.           03770006
032100         10  MR-LINE-PACKA             PIC  X(01).                03780006
032200         10  MR-LINE-PACKC             PIC  X(01).                03790006
032300         10  MR-LINE-PACKH             PIC  X(01).                03800006
032400         10  MR-LINE-PACK              PIC  X(04).                03810006
032500                                                                  03820001
032600         10  MR-BARCODEL               PIC S9(04) COMP.           03830006
032700         10  MR-BARCODEA               PIC  X(01).                03840006
032800         10  MR-BARCODEC               PIC  X(01).                03850006
032900         10  MR-BARCODEH               PIC  X(01).                03860006
033000         10  MR-BARCODE                PIC  X(22).                03870006
033100                                                                  03880003
033200         10  MR-CASIL                  PIC S9(04) COMP.           03890006
033300         10  MR-CASIA                  PIC  X(01).                03900006
033400         10  MR-CASIC                  PIC  X(01).                03910006
033500         10  MR-CASIH                  PIC  X(01).                03920006
033600         10  MR-CASI                   PIC  X(01).                03930006
033700                                                                  03940003
033800         10  MR-AUD-STATL              PIC S9(04) COMP.           03950017
033900         10  MR-AUD-STATA              PIC  X(01).                03960017
034000         10  MR-AUD-STATC              PIC  X(01).                03970017
034100         10  MR-AUD-STATH              PIC  X(01).                03980017
034200         10  MR-AUD-STAT               PIC  X(08).                03990017
034300                                                                  04000003
034400         10  MR-AUD-CNTL-NBRL          PIC S9(04) COMP.           04010006
034500         10  MR-AUD-CNTL-NBRA          PIC  X(01).                04020006
034600         10  MR-AUD-CNTL-NBRC          PIC  X(01).                04030006
034700         10  MR-AUD-CNTL-NBRH          PIC  X(01).                04040006
034800         10  MR-AUD-CNTL-NBR           PIC  Z(09).                04050006
034900                                                                  04060001
035000         10  MR-DRTV-CRTE-DTEL         PIC S9(04) COMP.           04070001
035100         10  MR-DRTV-CRTE-DTEA         PIC  X(01).                04080001
035200         10  MR-DRTV-CRTE-DTEC         PIC  X(01).                04090001
035300         10  MR-DRTV-CRTE-DTEH         PIC  X(01).                04100001
035400         10  MR-DRTV-CRTE-DTE          PIC  X(08).                04110001
035500                                                                  04120001
035600         10  MR-DRTV-CRTE-TMEL         PIC S9(04) COMP.           04130001
035700         10  MR-DRTV-CRTE-TMEA         PIC  X(01).                04140001
035800         10  MR-DRTV-CRTE-TMEC         PIC  X(01).                04150001
035900         10  MR-DRTV-CRTE-TMEH         PIC  X(01).                04160001
036000         10  MR-DRTV-CRTE-TME          PIC  X(08).                04170001
036100                                                                  04180001
036200     05  FILLER                         PIC  X(12).               04190001
036300                                                                  04200001
036400*----------------------------------------------------------------*04210001
036500*  SENDING/RECEIVING AREA FOR THE                                 04220001
036600*  PRINTER VALIDATION ROUTING (DPKCS060)                          04230001
036700*----------------------------------------------------------------*04240001
036800     COPY DPWS072.                                                04250001
036900                                                                  04260001
037000*---------------------------------------------------------------* 04270001
037100*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04280001
037200*---------------------------------------------------------------* 04290001
037300     COPY DPWS015.                                                04300001
037400                                                                  04310001
037500*---------------------------------------------------------------* 04320001
037600*    FUNCTION KEYS COPYBOOK.                                    * 04330001
037700*---------------------------------------------------------------* 04340001
037800     COPY DPWS016.                                                04350001
037900                                                                  04360001
038000*---------------------------------------------------------------* 04370001
038100*    NUMERIC EDIT LAYOUT.                                       * 04380001
038200*---------------------------------------------------------------* 04390001
038300     COPY DPWS010I.                                               04400001
038400                                                                  04410001
038500*---------------------------------------------------------------* 04420001
038600*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 04430099
038700*---------------------------------------------------------------* 04440001
038800     COPY DPWS030.                                                04450001
038800     COPY DPWS930.                                                04451099
038900                                                                  04460001
039000*---------------------------------------------------------------* 04470001
039100*    STANDARD COMMAREA.                                         * 04480001
039200*---------------------------------------------------------------* 04490001
039300     COPY DPWS020.                                                04500001
039400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04510001
039500                                                                  04520001
039600*---------------------------------------------------------------* 04530001
039700* INTER-APPLICATION COMMAREA.                                   * 04540001
039800*   SUWS097 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04550003
039900*             SPEC SCREEN.                                      * 04560001
040000*   SUWS097 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04570003
040100*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04580001
040200*---------------------------------------------------------------* 04590001
040300         10  INTER-APPL-COMM-AREA       PIC X(200).               04600001
040400     COPY SUWS097.                                                04610003
040500     COPY SUWS098.                                                04620003
040600     COPY SUWS101.                                                04630099
040700                                                                  04640001
040800*---------------------------------------------------------------* 04650001
040900*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04660001
041000*---------------------------------------------------------------* 04670001
041100         10  ASC-SPECIFIC-COMMAREA.                               04680001
041200             15  ASC-OPER-UNT-ID              PIC  9(04).         04690001
041300             15  ASC-FCLTY-NAME               PIC  X(25).         04700024
041400             15  ASC-BRCDE-NBR                PIC  X(22).         04710051
      *CLP 09/25/2014                                                   04711099
041500             15  ASC-PO-NBR                   PIC  9(08).         04720099
041600             15  ASC-REC-SEQ-NBR              PIC  9(04).         04730055
041700             15  ASC-PO-LNE-NBR               PIC  9(04).         04740024
041800             15  ASC-PREPACK-ID               PIC  9(04).         04750053
041900             15  ASC-PACK-TYPE                PIC  X(20).         04760037
042000             15  ASC-SCAC                     PIC  X(04).         04770024
042100             15  ASC-TRAILER                  PIC  X(10).         04780024
042200             15  ASC-TRIP-ID                  PIC  9(09).         04790024
042300             15  ASC-ARRIVAL-DATE             PIC  X(08).         04800024
042310             15  ASC-INT-APPL-FORMAT-IND      PIC  X(01).         04810099
042400             15  ASC-TRAILER-STATUS           PIC  X(14).         04820024
042500             15  ASC-ARRIVE-DATE              PIC  X(10).         04830089
042600             15  ASC-EXPECTED-CARTONS         PIC  9(04).         04840099
042700             15  ASC-DIRECTIVE-CARTONS        PIC  9(04).         04850099
042800             15  ASC-AUDIT-CNTL-NBR           PIC  9(09).         04860034
042900             15  ASC-ACTION-SW                PIC  X(03).         04870084
043000             15  ASC-F2-CONFIRM-SW            PIC  X(01).         04880084
043100                 88  ASC-F2-CONFIRM-YES            VALUE 'Y'.     04890053
043200                 88  ASC-F2-CONFIRM-NO             VALUE 'N'.     04900053
043300             15  ASC-PKGING-CDE               PIC  X(01).         04910055
043400                 88  ASC-PREPK-ORDER               VALUE '1'.     04920055
043500                 88  ASC-PACK-BY-STORE-ORDER       VALUE '2'.     04930055
043600                 88  ASC-BULK-CASE-ORDER           VALUE '3'.     04940055
043700             15  ASC-RQST-SW                  PIC  X(01).         04950055
043800                 88  ASC-RQST-PO-RCVR              VALUE '1'.     04960055
043900                 88  ASC-RQST-PO-RCVR-PREPK        VALUE '2'.     04970055
044000                 88  ASC-RQST-PO-RCVR-LINE         VALUE '3'.     04980055
044100                 88  ASC-RQST-AUDIT                VALUE '4'.     04990027
044200                 88  ASC-RQST-BAR-CODE             VALUE '5'.     05000039
044300             15  ASC-BLK-SUB                  PIC S9(04) COMP     05010001
044400                                                         SYNC.    05020001
044500             15  ASC-ITEM-SUB                 PIC S9(04) COMP     05030001
044600                                                         SYNC.    05040001
044700             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  05050001
044800             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  05060001
044900             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  05070001
045000             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  05080001
045100             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  05090001
045200             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     05100001
045300                                                         SYNC.    05110001
045400             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  05120001
045500             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  05130001
045600             15  ASC-XCNTL-TO-RESEND-SW       PIC  X(01).         05140001
045700                 88  ASC-XCNTL-TO-RESEND           VALUE 'Y'.     05150001
045800                 88  ASC-XCNTL-TO-RESEND-NO        VALUE 'N'.     05160001
045900             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         05170001
046000                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05180001
046100                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05190001
046200             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05200001
046300                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05210001
046400                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05220001
046500             15  ASC-LIST-QUEUE-NAME.                             05230001
046600                 20  ASC-LIST-TERM-ID         PIC  X(04).         05240001
046700                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  05250001
046800                 20  ASC-LIST-SEQ             PIC  9(01).         05260001
046900                                                                  05270001
047000             15  ASC-START-ITEM-REQUEST.                          05280001
047100                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         05290001
047200                                                                  05300001
047300             15  ASC-SEL-SUB                  PIC S9(4) COMP.     05310001
047400             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     05320001
047500             15  ASC-CURSOR-SW                PIC  X(02).         05330001
047600                 88  ASC-NO-CURSOR                   VALUE 'Z '.  05340001
047700                 88  ASC-DOOR-TYPE-CSR               VALUE 'A '.  05350001
047800                                                                  05360001
047900             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          05370001
048000                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05380001
048100             15  ASC-SEL-QUEUE-NAME.                              05390001
048200                 20  ASC-SEL-TERM-ID          PIC  X(04).         05400001
048300                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  05410001
048400                 20  ASC-SEL-SEQ              PIC  9(01).         05420001
048500                                                                  05430001
048600             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  05440001
048700                                                                  05450001
048800*-----------------------------------------------------------------05460001
048900             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05470001
049000                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05480001
049100                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05490001
049200                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05500001
049300                                                                  05510001
049400                 20  ASC-ITEM-ARRAY.                              05520001
049500                     25  ASC-ITEM-ENTRIES OCCURS 09 TIMES.        05530005
049600                         30  ASC-LIST-ITEM-NUMBER                 05540001
049700                                                     PIC S9(09)   05550001
049800                                                     COMP-3.      05560001
049900                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05570001
050000                             88  ASC-VALID-SELECT    VALUE ' '    05580001
050100                                                           'S'    05590001
050200                                                           'B'    05600001
050300                                                           'E'.   05610001
050400                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05620001
050500                             88  ASC-TEMP-SELECT     VALUE 'S'.   05630001
050600                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05640001
050700                             88  ASC-TEMP-END        VALUE 'E'.   05650001
050800                         30  ASC-SELECTED-SW         PIC  X(01).  05660001
050900                             88  ASC-NO-SELECT       VALUE ' '.   05670001
051000                             88  ASC-SELECT          VALUE 'S'.   05680001
051100                             88  ASC-BEGIN           VALUE 'B'.   05690001
051200                             88  ASC-END             VALUE 'E'.   05700001
051300                         30  ASC-ACTION              PIC  X(03).  05710002
051400                         30  ASC-BARCODE             PIC  X(22).  05720065
051500                         30  ASC-CASI                PIC  X(01).  05730022
051600                         30  ASC-AUD-STAT-CDE        PIC  X(08).  05740065
051700                         30  ASC-AUD-CNTL-NBR        PIC  9(09).  05750022
051800                         30  ASC-DIRECTIVE-TMST      PIC  X(26).  05760022
051900                         30  ASC-LNE-NBR             PIC  9(04).  05770065
052000                         30  ASC-PREPK-ID            PIC  9(04).  05780065
052100                         30  ASC-SHIPT-UNT-ID    PIC S9(18)       05790050
052200                                                      COMP-3.     05800050
052300                         30  ASC-STR-NBR         PIC S9(04) COMP. 05810050
052400                         30  ASC-AUD-FALR-RSN-NM PIC  X(04).      05820056
052500                         30  ASC-STR-ZN-ID       PIC  X(05).      05830046
052600                         30  ASC-SEASET-YR       PIC  X(04).      05840055
052700                         30  ASC-SEASET-SHRT-NM  PIC  X(05).      05850055
052800                         30  ASC-BRCDE-TYPE          PIC  X(01).  05860065
052900                             88 ASC-NO-BARCODE     VALUE ' '.     05870065
053000                             88 ASC-BRCDE-SML      VALUE 'S'.     05880065
053100                             88 ASC-BRCDE-P2L      VALUE 'P'.     05890065
053200                                                                  05900001
053300*---------------------------------------------------------------* 05910001
053400*    ABEND PROCESSING COPYBOOK.                                 * 05920001
053500*---------------------------------------------------------------* 05930001
053600     COPY DPWS013.                                                05940001
053700                                                                  05950002
053800*---------------------------------------------------------------* 05960050
053900*    RACF  PROCESSING COPYBOOK.                                 * 05970050
054000*---------------------------------------------------------------* 05980050
054100     COPY DPWS008.                                                05990050
054200                                                                  06000050
054300*----------------------------------------------------------------*06010002
054400*    DB2 TABLE                                                    06020002
054500*----------------------------------------------------------------*06030002
054600     EXEC SQL                                                     06040002
054700          INCLUDE SUT00015                                        06050022
054800     END-EXEC.                                                    06060002
054900                                                                  06070022
055000*----------------------------------------------------------------*06080022
055100*    DB2 TABLE                                                    06090022
055200*----------------------------------------------------------------*06100022
055300     EXEC SQL                                                     06110022
055400          INCLUDE SUT00102                                        06120022
055500     END-EXEC.                                                    06130022
055600                                                                  06140022
055700*----------------------------------------------------------------*06150022
055800*    DB2 TABLE                                                    06160022
055900*----------------------------------------------------------------*06170022
056000     EXEC SQL                                                     06180022
056100          INCLUDE WST00008                                        06190022
056200     END-EXEC.                                                    06200022
056300                                                                  06210022
056400*----------------------------------------------------------------*06220022
056500*    DB2 TABLE                                                    06230022
056600*----------------------------------------------------------------*06240022
056700     EXEC SQL                                                     06250022
056800          INCLUDE WST00009                                        06260022
056900     END-EXEC.                                                    06270022
057000                                                                  06280022
057100*----------------------------------------------------------------*06290022
057200*    DB2 TABLE                                                    06300022
057300*----------------------------------------------------------------*06310022
057400     EXEC SQL                                                     06320022
057500          INCLUDE WST00010                                        06330022
057600     END-EXEC.                                                    06340022
057700                                                                  06350022
057800*----------------------------------------------------------------*06360022
057900*    DB2 TABLE                                                    06370022
058000*----------------------------------------------------------------*06380022
058100     EXEC SQL                                                     06390022
058200          INCLUDE XLT00003                                        06400022
058300     END-EXEC.                                                    06410022
058400                                                                  06420022
058500*----------------------------------------------------------------*06430022
058600*    DB2 TABLE - PURCHASE ORDER                                   06440099
058700*----------------------------------------------------------------*06450002
058800     EXEC SQL                                                     06460002
058900          INCLUDE TPURCHS                                         06470099
059000     END-EXEC.                                                    06480002
059100                                                                  06490099
059200*----------------------------------------------------------------*06500099
059300*    DB2 TABLE - RECEIVER                                         06510099
059400*----------------------------------------------------------------*06520099
059500     EXEC SQL                                                     06530099
059600          INCLUDE TRECEIV                                         06540099
059700     END-EXEC.                                                    06550099
059800                                                                  06560002
059900*----------------------------------------------------------------*06570002
060000*    DB2 TABLE - ????                                             06580052
060100*----------------------------------------------------------------*06590002
060200     EXEC SQL                                                     06600002
060300          INCLUDE TSULBXF                                         06610052
060400     END-EXEC.                                                    06620002
060500                                                                  06630052
060600*----------------------------------------------------------------*06640052
060700*    DB2 TABLE - TRIP STATUS                                      06650062
060800*----------------------------------------------------------------*06660052
060900     EXEC SQL                                                     06670052
061000          INCLUDE TTRIPST                                         06680062
061100     END-EXEC.                                                    06690052
061200                                                                  06700002
061300*----------------------------------------------------------------*06710002
061400*    DB2 TABLE - TRIP                                             06720062
061500*----------------------------------------------------------------*06730002
061600     EXEC SQL                                                     06740062
061700          INCLUDE TVHTRIP                                         06750062
061800     END-EXEC.                                                    06760062
061900                                                                  06770062
062000*----------------------------------------------------------------*06780062
062100*    DB2 TABLE - SHIPMENT                                         06790062
062200*----------------------------------------------------------------*06800062
062300     EXEC SQL                                                     06810002
062400          INCLUDE TSHIPMT                                         06820002
062500     END-EXEC.                                                    06830002
062600                                                                  06840002
062700*----------------------------------------------------------------*06850002
062800*    DB2 TABLE - SHIPMENT TO PO                                   06860046
062900*----------------------------------------------------------------*06870002
063000     EXEC SQL                                                     06880002
063100          INCLUDE TSHPTPO                                         06890002
063200     END-EXEC.                                                    06900002
063300                                                                  06910002
063400*----------------------------------------------------------------*06920002
063500*    DB2 TABLE - PACKING SLIP                                     06930046
063600*----------------------------------------------------------------*06940002
063700     EXEC SQL                                                     06950002
063800          INCLUDE TPKSLIP                                         06960002
063900     END-EXEC.                                                    06970002
064000                                                                  06980002
064100*----------------------------------------------------------------*06990002
064200*    DB2 TABLE                                                    07000002
064300*----------------------------------------------------------------*07010002
064400     EXEC SQL                                                     07020002
064500          INCLUDE TINPKSU                                         07030002
064600     END-EXEC.                                                    07040002
064700                                                                  07050002
064800*----------------------------------------------------------------*07060002
064900*    DB2 TABLE                                                    07070002
065000*----------------------------------------------------------------*07080002
065100     EXEC SQL                                                     07090002
065200          INCLUDE TSHPUNT                                         07100002
065300     END-EXEC.                                                    07110002
065400                                                                  07120002
065500*----------------------------------------------------------------*07130002
065600*    DB2 TABLE                                                    07140002
065700*----------------------------------------------------------------*07150002
065800     EXEC SQL                                                     07160002
065900          INCLUDE TRECITM                                         07170002
066000     END-EXEC.                                                    07180002
066100                                                                  07190027
066200                                                                  07200038
066300     EXEC SQL                                                     07210038
066400        DECLARE BAR-CODE-CSR     CURSOR FOR                       07220099
066500        SELECT                                                    07230099
066600                A.BRCDE_NBR                                       07240038
066700               ,A.CRE_TMST                                        07250046
066800               ,A.AUD_CNTL_NBR                                    07260038
066900               ,A.SHIPT_UNT_ID                                    07270046
067000               ,A.AUD_STAT_CDE                                    07280038
067100               ,A.PO_LNE_NBR                                      07290038
067200               ,A.PREPK_ID                                        07300046
067300               ,A.STR_NBR                                         07310046
067400               ,A.STR_ZN_ID                                       07320046
067500               ,A.SEASET_YR                                       07330046
067600               ,A.SEASET_SHRT_NM                                  07340046
067700               ,A.AUD_FALR_RSN_NM                                 07350099
067800       FROM  SUT_CART_DIRV_TRKG   A                               07360038
067900      WHERE  A.BRCDE_NBR      = :DK-BRCDE-NBR                     07370099
067910        AND  A.CNVYR_PRC_ACTN_NM NOT IN ('DELETE')                07380099
067920        AND  A.DIRV_RSN_CDE NOT IN ('AUQ' ,'RFD')                 07390099
068000        AND  A.CRE_TMST       =                                   07400038
068100               ( SELECT MAX (CRE_TMST)                            07410038
068200                 FROM SUT_CART_DIRV_TRKG B                        07420038
068300                 WHERE B.BRCDE_NBR  =  A.BRCDE_NBR                07430038
068400                 )                                                07440038
068500        AND  A.LGCL_LOC_NM  IN                                    07450038
068600   (                                                              07460038
068700       SELECT DISTINCT(E.ATTR_ELEM_TXT)                           07470038
068800       FROM WST_INTGRTN_TYP A                                     07480038
068900          , WST_ATTR_DEFN           B                             07490038
069000          , WST_ATTR_ELEM           C                             07500038
069100          , WST_ATTR_ELEM           D                             07510038
069200          , WST_ATTR_ELEM           E                             07520038
069300          , WST_ATTR_ELEM           F                             07530038
069400          , WST_ATTR_ELEM           G                             07540038
069500          , WST_ATTR_ELEM           H                             07550038
069600          , WST_ATTR_ELEM           I                             07560038
069700          , WST_ATTR_ELEM           J                             07570038
069800          , WST_ATTR_ELEM           K                             07580038
069900       WHERE A.INTGRTN_TYP_CDE   = 'ACAULGDST'                    07590038
070000         AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE              07600038
070100         AND A.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE              07610038
070200         AND A.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE              07620038
070300         AND A.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE              07630038
070400         AND A.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE              07640038
070500         AND A.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE              07650038
070600         AND A.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE              07660038
070700         AND A.INTGRTN_TYP_CDE   = I.INTGRTN_TYP_CDE              07670038
070800         AND A.INTGRTN_TYP_CDE   = J.INTGRTN_TYP_CDE              07680038
070900         AND A.INTGRTN_TYP_CDE   = K.INTGRTN_TYP_CDE              07690038
071000         AND B.ATTR_DEFN_SEQ_NBR = 1                              07700038
071100         AND C.ATTR_DEFN_SEQ_NBR = 1                              07710038
071200         AND D.ATTR_DEFN_SEQ_NBR = 2                              07720038
071300         AND E.ATTR_DEFN_SEQ_NBR = 3                              07730038
071400         AND F.ATTR_DEFN_SEQ_NBR = 4                              07740038
071500         AND G.ATTR_DEFN_SEQ_NBR = 5                              07750038
071600         AND H.ATTR_DEFN_SEQ_NBR = 6                              07760038
071700         AND I.ATTR_DEFN_SEQ_NBR = 7                              07770038
071800         AND J.ATTR_DEFN_SEQ_NBR = 8                              07780038
071900         AND K.ATTR_DEFN_SEQ_NBR = 9                              07790038
072000         AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR            07800038
072100         AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR            07810038
072200         AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR            07820038
072300         AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR            07830038
072400         AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR            07840038
072500         AND C.ATTR_ELEM_SEQ_NBR = I.ATTR_ELEM_SEQ_NBR            07850038
072600         AND C.ATTR_ELEM_SEQ_NBR = J.ATTR_ELEM_SEQ_NBR            07860038
072700         AND C.ATTR_ELEM_SEQ_NBR = K.ATTR_ELEM_SEQ_NBR            07870038
072800         AND F.ATTR_ELEM_TXT     = 'Y'                            07880038
072900         AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP            07890038
073000         AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP            07900038
073100         AND C.ATTR_ELEM_NBR     = :DK-OPER-UNT-ID                07910099
073200         AND K.ATTR_ELEM_TXT     = 'Y'                            07920038
073300                                        )                         07930038
073400     END-EXEC.                                                    07940038
073500                                                                  07950099
073600     EXEC SQL                                                     07960099
073700        DECLARE AUDIT-CSR         CURSOR FOR                      07970099
073800        SELECT                                                    07980099
073900                A.BRCDE_NBR                                       07990099
074000               ,A.CRE_TMST                                        08000099
074100               ,A.AUD_CNTL_NBR                                    08010099
074200               ,SHIPT_UNT_ID                                      08020099
074300               ,A.AUD_STAT_CDE                                    08030099
074400               ,A.PO_LNE_NBR                                      08040099
074500               ,A.PREPK_ID                                        08050099
074600               ,A.STR_NBR                                         08060099
074700               ,A.STR_ZN_ID                                       08070099
074800               ,A.SEASET_YR                                       08080099
074900               ,A.SEASET_SHRT_NM                                  08090099
075000               ,A.AUD_FALR_RSN_NM                                 08100099
075100               FROM  SUT_CART_DIRV_TRKG          A                08110099
075200              WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID           08120099
075300                AND  A.PO_NBR         = :DK-PO-NBR                08130099
075400                AND  A.RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR           08140099
075501                AND  A.AUD_CNTL_NBR   = :DK-AUD-CNTL-NBR          08150099
075510                AND  A.CNVYR_PRC_ACTN_NM NOT IN ('DELETE')        08160099
075520                AND  A.DIRV_RSN_CDE   NOT IN ('AUQ' ,'RFD')       08170099
075600                AND  A.CRE_TMST       =                           08180099
075700                       ( SELECT MAX (CRE_TMST)                    08190099
075800                         FROM SUT_CART_DIRV_TRKG B                08200099
075900                         WHERE B.BRCDE_NBR  =  A.BRCDE_NBR        08210099
076000                         )                                        08220099
076100                AND  A.LGCL_LOC_NM  IN                            08230099
076200           (                                                      08240099
076300               SELECT DISTINCT(E.ATTR_ELEM_TXT)                   08250099
076400               FROM WST_INTGRTN_TYP A                             08260099
076500                  , WST_ATTR_DEFN           B                     08270099
076600                  , WST_ATTR_ELEM           C                     08280099
076700                  , WST_ATTR_ELEM           D                     08290099
076800                  , WST_ATTR_ELEM           E                     08300099
076900                  , WST_ATTR_ELEM           F                     08310099
077000                  , WST_ATTR_ELEM           G                     08320099
077100                  , WST_ATTR_ELEM           H                     08330099
077200                  , WST_ATTR_ELEM           I                     08340099
077300                  , WST_ATTR_ELEM           J                     08350099
077400                  , WST_ATTR_ELEM           K                     08360099
077500               WHERE A.INTGRTN_TYP_CDE    =  'ACAULGDST'          08370099
077600                 AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE    08380099
077700                 AND A.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE    08390099
077800                 AND A.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE    08400099
077900                 AND A.INTGRTN_TYP_CDE    =  E.INTGRTN_TYP_CDE    08410099
078000                 AND A.INTGRTN_TYP_CDE    =  F.INTGRTN_TYP_CDE    08420099
078100                 AND A.INTGRTN_TYP_CDE    =  G.INTGRTN_TYP_CDE    08430099
078200                 AND A.INTGRTN_TYP_CDE    =  H.INTGRTN_TYP_CDE    08440099
078300                 AND A.INTGRTN_TYP_CDE    =  I.INTGRTN_TYP_CDE    08450099
078400                 AND A.INTGRTN_TYP_CDE    =  J.INTGRTN_TYP_CDE    08460099
078500                 AND A.INTGRTN_TYP_CDE    =  K.INTGRTN_TYP_CDE    08470099
078600                 AND B.ATTR_DEFN_SEQ_NBR  =  1                    08480099
078700                 AND C.ATTR_DEFN_SEQ_NBR  =  1                    08490099
078800                 AND D.ATTR_DEFN_SEQ_NBR  =  2                    08500099
078900                 AND E.ATTR_DEFN_SEQ_NBR  =  3                    08510099
079000                 AND F.ATTR_DEFN_SEQ_NBR  =  4                    08520099
079100                 AND G.ATTR_DEFN_SEQ_NBR  =  5                    08530099
079200                 AND H.ATTR_DEFN_SEQ_NBR  =  6                    08540099
079300                 AND I.ATTR_DEFN_SEQ_NBR  =  7                    08550099
079400                 AND J.ATTR_DEFN_SEQ_NBR  =  8                    08560099
079500                 AND K.ATTR_DEFN_SEQ_NBR  =  9                    08570099
079600                 AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR  08580099
079700                 AND C.ATTR_ELEM_SEQ_NBR  =  E.ATTR_ELEM_SEQ_NBR  08590099
079800                 AND C.ATTR_ELEM_SEQ_NBR  =  F.ATTR_ELEM_SEQ_NBR  08600099
079900                 AND C.ATTR_ELEM_SEQ_NBR  =  G.ATTR_ELEM_SEQ_NBR  08610099
080000                 AND C.ATTR_ELEM_SEQ_NBR  =  H.ATTR_ELEM_SEQ_NBR  08620099
080100                 AND C.ATTR_ELEM_SEQ_NBR  =  I.ATTR_ELEM_SEQ_NBR  08630099
080200                 AND C.ATTR_ELEM_SEQ_NBR  =  J.ATTR_ELEM_SEQ_NBR  08640099
080300                 AND C.ATTR_ELEM_SEQ_NBR  =  K.ATTR_ELEM_SEQ_NBR  08650099
080400                 AND F.ATTR_ELEM_TXT      =  'Y'                  08660099
080500                 AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP    08670099
080600                 AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP    08680099
080700                 AND C.ATTR_ELEM_NBR      =  :DK-OPER-UNT-ID      08690099
080800                 AND K.ATTR_ELEM_TXT      =  'Y'                  08700099
080900                                                )                 08710099
081000         WITH UR                                                  08720099
081100     END-EXEC.                                                    08730099
081200                                                                  08740099
081300     EXEC SQL                                                     08750099
081400        DECLARE PO-RCVR-CSR      CURSOR FOR                       08760099
081500        SELECT                                                    08770099
081600                A.BRCDE_NBR                                       08780099
081700               ,A.CRE_TMST                                        08790099
081800               ,A.AUD_CNTL_NBR                                    08800099
081900               ,A.SHIPT_UNT_ID                                    08810099
082000               ,A.AUD_STAT_CDE                                    08820099
082100               ,A.PO_LNE_NBR                                      08830099
082200               ,A.PREPK_ID                                        08840099
082300               ,A.STR_NBR                                         08850099
082400               ,A.STR_ZN_ID                                       08860099
082500               ,A.SEASET_YR                                       08870099
082600               ,A.SEASET_SHRT_NM                                  08880099
082700               ,A.AUD_FALR_RSN_NM                                 08890099
082800       FROM  SUT_CART_DIRV_TRKG   A                               08900099
082900      WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID                   08910099
083000        AND  A.PO_NBR         = :DK-PO-NBR                        08920099
083100        AND  A.RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR                   08930099
083110        AND  A.CNVYR_PRC_ACTN_NM NOT IN ('DELETE')                08940099
083120        AND  A.DIRV_RSN_CDE   NOT IN ('AUQ' ,'RFD')               08950099
083200        AND  A.CRE_TMST       =                                   08960099
083300               ( SELECT MAX (CRE_TMST)                            08970099
083400                 FROM SUT_CART_DIRV_TRKG B                        08980099
083500                 WHERE B.BRCDE_NBR  =  A.BRCDE_NBR                08990099
083600                 )                                                09000099
083700        AND  A.LGCL_LOC_NM  IN                                    09010099
083800   (                                                              09020099
083900       SELECT DISTINCT(E.ATTR_ELEM_TXT)                           09030099
084000       FROM WST_INTGRTN_TYP A                                     09040099
084100          , WST_ATTR_DEFN           B                             09050099
084200          , WST_ATTR_ELEM           C                             09060099
084300          , WST_ATTR_ELEM           D                             09070099
084400          , WST_ATTR_ELEM           E                             09080099
084500          , WST_ATTR_ELEM           F                             09090099
084600          , WST_ATTR_ELEM           G                             09100099
084700          , WST_ATTR_ELEM           H                             09110099
084800          , WST_ATTR_ELEM           I                             09120099
084900          , WST_ATTR_ELEM           J                             09130099
085000          , WST_ATTR_ELEM           K                             09140099
085100       WHERE A.INTGRTN_TYP_CDE   = 'ACAULGDST'                    09150099
085200         AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE              09160099
085300         AND A.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE              09170099
085400         AND A.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE              09180099
085500         AND A.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE              09190099
085600         AND A.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE              09200099
085700         AND A.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE              09210099
085800         AND A.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE              09220099
085900         AND A.INTGRTN_TYP_CDE   = I.INTGRTN_TYP_CDE              09230099
086000         AND A.INTGRTN_TYP_CDE   = J.INTGRTN_TYP_CDE              09240099
086100         AND A.INTGRTN_TYP_CDE   = K.INTGRTN_TYP_CDE              09250099
086200         AND B.ATTR_DEFN_SEQ_NBR = 1                              09260099
086300         AND C.ATTR_DEFN_SEQ_NBR = 1                              09270099
086400         AND D.ATTR_DEFN_SEQ_NBR = 2                              09280099
086500         AND E.ATTR_DEFN_SEQ_NBR = 3                              09290099
086600         AND F.ATTR_DEFN_SEQ_NBR = 4                              09300099
086700         AND G.ATTR_DEFN_SEQ_NBR = 5                              09310099
086800         AND H.ATTR_DEFN_SEQ_NBR = 6                              09320099
086900         AND I.ATTR_DEFN_SEQ_NBR = 7                              09330099
087000         AND J.ATTR_DEFN_SEQ_NBR = 8                              09340099
087100         AND K.ATTR_DEFN_SEQ_NBR = 9                              09350099
087200         AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR            09360099
087300         AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR            09370099
087400         AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR            09380099
087500         AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR            09390099
087600         AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR            09400099
087700         AND C.ATTR_ELEM_SEQ_NBR = I.ATTR_ELEM_SEQ_NBR            09410099
087800         AND C.ATTR_ELEM_SEQ_NBR = J.ATTR_ELEM_SEQ_NBR            09420099
087900         AND C.ATTR_ELEM_SEQ_NBR = K.ATTR_ELEM_SEQ_NBR            09430099
088000         AND F.ATTR_ELEM_TXT     = 'Y'                            09440099
088100         AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP            09450099
088200         AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP            09460099
088300         AND C.ATTR_ELEM_NBR     = :DK-OPER-UNT-ID                09470099
088400         AND K.ATTR_ELEM_TXT     = 'Y'                            09480099
088500                                        )                         09490099
088600       ORDER BY A.PREPK_ID                                        09500099
088700               ,A.PO_LNE_NBR                                      09510099
088800               ,A.BRCDE_NBR                                       09520099
088900     END-EXEC.                                                    09530099
089000                                                                  09540099
089100     EXEC SQL                                                     09550079
089200        DECLARE PO-RCVR-LINE-CSR CURSOR FOR                       09560079
089300        SELECT                                                    09570079
089400                A.BRCDE_NBR                                       09580079
089500               ,A.CRE_TMST                                        09590079
089600               ,A.AUD_CNTL_NBR                                    09600079
089700               ,A.SHIPT_UNT_ID                                    09610079
089800               ,A.AUD_STAT_CDE                                    09620079
089900               ,A.PO_LNE_NBR                                      09630079
090000               ,A.PREPK_ID                                        09640079
090100               ,A.STR_NBR                                         09650079
090200               ,A.STR_ZN_ID                                       09660079
090300               ,A.SEASET_YR                                       09670079
090400               ,A.SEASET_SHRT_NM                                  09680079
090500               ,A.AUD_FALR_RSN_NM                                 09690099
090600       FROM  SUT_CART_DIRV_TRKG   A                               09700079
090700      WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID                   09710079
090800        AND  A.PO_NBR         = :DK-PO-NBR                        09720079
090900        AND  A.RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR                   09730079
091000        AND  A.PO_LNE_NBR     = :DK-PO-LNE-NBR                    09740099
091010        AND  A.CNVYR_PRC_ACTN_NM NOT IN ('DELETE')                09750099
091020        AND  A.DIRV_RSN_CDE   NOT IN ('AUQ' ,'RFD')               09760099
091100        AND  A.CRE_TMST       =                                   09770079
091200               ( SELECT MAX (CRE_TMST)                            09780079
091300                 FROM SUT_CART_DIRV_TRKG B                        09790079
091400                 WHERE B.BRCDE_NBR  =  A.BRCDE_NBR                09800079
091500                 )                                                09810079
091600        AND  A.LGCL_LOC_NM  IN                                    09820079
091700   (                                                              09830079
091800       SELECT DISTINCT(E.ATTR_ELEM_TXT)                           09840079
091900       FROM WST_INTGRTN_TYP A                                     09850079
092000          , WST_ATTR_DEFN           B                             09860079
092100          , WST_ATTR_ELEM           C                             09870079
092200          , WST_ATTR_ELEM           D                             09880079
092300          , WST_ATTR_ELEM           E                             09890079
092400          , WST_ATTR_ELEM           F                             09900079
092500          , WST_ATTR_ELEM           G                             09910079
092600          , WST_ATTR_ELEM           H                             09920079
092700          , WST_ATTR_ELEM           I                             09930079
092800          , WST_ATTR_ELEM           J                             09940079
092900          , WST_ATTR_ELEM           K                             09950079
093000       WHERE A.INTGRTN_TYP_CDE   = 'ACAULGDST'                    09960079
093100         AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE              09970079
093200         AND A.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE              09980079
093300         AND A.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE              09990079
093400         AND A.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE              10000079
093500         AND A.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE              10010079
093600         AND A.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE              10020079
093700         AND A.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE              10030079
093800         AND A.INTGRTN_TYP_CDE   = I.INTGRTN_TYP_CDE              10040079
093900         AND A.INTGRTN_TYP_CDE   = J.INTGRTN_TYP_CDE              10050079
094000         AND A.INTGRTN_TYP_CDE   = K.INTGRTN_TYP_CDE              10060079
094100         AND B.ATTR_DEFN_SEQ_NBR = 1                              10070079
094200         AND C.ATTR_DEFN_SEQ_NBR = 1                              10080079
094300         AND D.ATTR_DEFN_SEQ_NBR = 2                              10090079
094400         AND E.ATTR_DEFN_SEQ_NBR = 3                              10100079
094500         AND F.ATTR_DEFN_SEQ_NBR = 4                              10110079
094600         AND G.ATTR_DEFN_SEQ_NBR = 5                              10120079
094700         AND H.ATTR_DEFN_SEQ_NBR = 6                              10130079
094800         AND I.ATTR_DEFN_SEQ_NBR = 7                              10140079
094900         AND J.ATTR_DEFN_SEQ_NBR = 8                              10150079
095000         AND K.ATTR_DEFN_SEQ_NBR = 9                              10160079
095100         AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR            10170079
095200         AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR            10180079
095300         AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR            10190079
095400         AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR            10200079
095500         AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR            10210079
095600         AND C.ATTR_ELEM_SEQ_NBR = I.ATTR_ELEM_SEQ_NBR            10220079
095700         AND C.ATTR_ELEM_SEQ_NBR = J.ATTR_ELEM_SEQ_NBR            10230079
095800         AND C.ATTR_ELEM_SEQ_NBR = K.ATTR_ELEM_SEQ_NBR            10240079
095900         AND F.ATTR_ELEM_TXT     = 'Y'                            10250079
096000         AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP            10260079
096100         AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP            10270079
096200         AND C.ATTR_ELEM_NBR     = :DK-OPER-UNT-ID                10280099
096300         AND K.ATTR_ELEM_TXT     = 'Y'                            10290079
096400                                        )                         10300079
096500       ORDER BY A.BRCDE_NBR                                       10310099
096600     END-EXEC.                                                    10320079
096700                                                                  10330079
096800     EXEC SQL                                                     10340079
096900        DECLARE PO-RCVR-PREPK-CSR  CURSOR FOR                     10350079
097000        SELECT                                                    10360079
097100                A.BRCDE_NBR                                       10370079
097200               ,A.CRE_TMST                                        10380079
097300               ,A.AUD_CNTL_NBR                                    10390079
097400               ,A.SHIPT_UNT_ID                                    10400079
097500               ,A.AUD_STAT_CDE                                    10410079
097600               ,A.PO_LNE_NBR                                      10420079
097700               ,A.PREPK_ID                                        10430079
097800               ,A.STR_NBR                                         10440079
097900               ,A.STR_ZN_ID                                       10450079
098000               ,A.SEASET_YR                                       10460079
098100               ,A.SEASET_SHRT_NM                                  10470079
098200               ,A.AUD_FALR_RSN_NM                                 10480099
098300       FROM  SUT_CART_DIRV_TRKG   A                               10490079
098400      WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID                   10500079
098500        AND  A.PO_NBR         = :DK-PO-NBR                        10510079
098600        AND  A.RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR                   10520079
098700        AND  A.PREPK_ID       = :DK-PREPK-ID                      10530099
098710        AND  A.CNVYR_PRC_ACTN_NM NOT IN ('DELETE')                10540099
098720        AND  A.DIRV_RSN_CDE   NOT IN ('AUQ' ,'RFD')               10550099
098800        AND  A.CRE_TMST       =                                   10560079
098900               ( SELECT MAX (CRE_TMST)                            10570079
099000                 FROM SUT_CART_DIRV_TRKG B                        10580079
099100                 WHERE B.BRCDE_NBR  =  A.BRCDE_NBR                10590079
099200                 )                                                10600079
099300        AND  A.LGCL_LOC_NM  IN                                    10610079
099400   (                                                              10620079
099500       SELECT DISTINCT(E.ATTR_ELEM_TXT)                           10630079
099600       FROM WST_INTGRTN_TYP A                                     10640079
099700          , WST_ATTR_DEFN           B                             10650079
099800          , WST_ATTR_ELEM           C                             10660079
099900          , WST_ATTR_ELEM           D                             10670079
100000          , WST_ATTR_ELEM           E                             10680079
100100          , WST_ATTR_ELEM           F                             10690079
100200          , WST_ATTR_ELEM           G                             10700079
100300          , WST_ATTR_ELEM           H                             10710079
100400          , WST_ATTR_ELEM           I                             10720079
100500          , WST_ATTR_ELEM           J                             10730079
100600          , WST_ATTR_ELEM           K                             10740079
100700       WHERE A.INTGRTN_TYP_CDE   = 'ACAULGDST'                    10750079
100800         AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE              10760079
100900         AND A.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE              10770079
101000         AND A.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE              10780079
101100         AND A.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE              10790079
101200         AND A.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE              10800079
101300         AND A.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE              10810079
101400         AND A.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE              10820079
101500         AND A.INTGRTN_TYP_CDE   = I.INTGRTN_TYP_CDE              10830079
101600         AND A.INTGRTN_TYP_CDE   = J.INTGRTN_TYP_CDE              10840079
101700         AND A.INTGRTN_TYP_CDE   = K.INTGRTN_TYP_CDE              10850079
101800         AND B.ATTR_DEFN_SEQ_NBR = 1                              10860079
101900         AND C.ATTR_DEFN_SEQ_NBR = 1                              10870079
102000         AND D.ATTR_DEFN_SEQ_NBR = 2                              10880079
102100         AND E.ATTR_DEFN_SEQ_NBR = 3                              10890079
102200         AND F.ATTR_DEFN_SEQ_NBR = 4                              10900079
102300         AND G.ATTR_DEFN_SEQ_NBR = 5                              10910079
102400         AND H.ATTR_DEFN_SEQ_NBR = 6                              10920079
102500         AND I.ATTR_DEFN_SEQ_NBR = 7                              10930079
102600         AND J.ATTR_DEFN_SEQ_NBR = 8                              10940079
102700         AND K.ATTR_DEFN_SEQ_NBR = 9                              10950079
102800         AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR            10960079
102900         AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR            10970079
103000         AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR            10980079
103100         AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR            10990079
103200         AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR            11000079
103300         AND C.ATTR_ELEM_SEQ_NBR = I.ATTR_ELEM_SEQ_NBR            11010079
103400         AND C.ATTR_ELEM_SEQ_NBR = J.ATTR_ELEM_SEQ_NBR            11020079
103500         AND C.ATTR_ELEM_SEQ_NBR = K.ATTR_ELEM_SEQ_NBR            11030079
103600         AND F.ATTR_ELEM_TXT     = 'Y'                            11040079
103700         AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP            11050079
103800         AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP            11060079
103900         AND C.ATTR_ELEM_NBR     = :DK-OPER-UNT-ID                11070099
104000         AND K.ATTR_ELEM_TXT     = 'Y'                            11080079
104100                                        )                         11090079
104200       ORDER BY A.BRCDE_NBR                                       11100099
104300     END-EXEC.                                                    11110079
104400                                                                  11120079
104500*---------------------------------------------------------------* 11130079
104600*    DB2 AREA FOR COMMUNICATIONS                                * 11140038
104700*---------------------------------------------------------------* 11150001
104800     EXEC SQL                                                     11160001
104900          INCLUDE SQLCA                                           11170001
105000     END-EXEC.                                                    11180001
105100                                                                  11190001
105200***************************************************************** 11200001
105300 LINKAGE SECTION.                                                 11210001
105400                                                                  11220001
105500 01  DFHCOMMAREA.                                                 11230001
105600     05  FILLER                         OCCURS  1 TO 4072 TIMES   11240001
105700                                        DEPENDING ON EIBCALEN.    11250001
105800         10  FILLER                     PIC X.                    11260001
105900                                                                  11270001
106000                                                                  11280001
106100 PROCEDURE DIVISION.                                              11290001
106200******************************************************************11300001
106300**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **11310001
106400**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **11320001
106500**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **11330001
106600******************************************************************11340001
106700 0000-MAIN-MODULE.                                                11350001
106800     INITIALIZE DP030-CICS-API-FIELDS.                            11360001
106900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       11370001
107000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          11380001
107100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         11390001
107200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       11400001
107300     MOVE LENGTH OF SUK765I        TO DP030-MAP-LENGTH (1).       11410001
107400     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     11420001
107500     PERFORM 0001-CALL-CICS-ARCH-API.                             11430001
107600*                                                                 11440001
107700     PERFORM 1000-CONTROL-PROCESSING                              11450001
107800*                                                                 11460001
107900     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     11470001
108000     PERFORM 0001-CALL-CICS-ARCH-API.                             11480001
108100                                                                  11490001
108200******************************************************************11500001
108300**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **11510001
108400**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **11520001
108500******************************************************************11530001
108600 0001-CALL-CICS-ARCH-API.                                         11540001
108700*    CALL 'DPKCS030' USING DFHEIBLK                               11550099
108700     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      11551099
108800                           DFHCOMMAREA                            11560001
108900                           DP030-CICS-API-FIELDS                  11570001
109000                           DP020-STANDARD-COMMAREA                11580001
109100                           SUK765I.                               11590001
109200*                                                                 11600001
109300     IF  DP030-RC-CALL-SUCCESSFUL                                 11610001
109400         CONTINUE                                                 11620001
109500     ELSE                                                         11630001
109600         SET DP013-NO-ROLLBACK                                    11640001
109700             DP013-XCTL-DISPLAY-RESTART                           11650001
109800             DP013-CICS-ABEND      TO TRUE                        11660001
109900         MOVE '0001-CALL-CICS-ARCH-API'                           11670001
110000                                   TO DP013-PARAGRAPH             11680001
110100*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX11690099
110200*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      11700099
110100         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O11701099
110200-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      11702099
110300         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      11710001
110400         PERFORM DP013-0000-PROCESS-ABEND                         11720001
110500     END-IF.                                                      11730001
110600                                                                  11740001
110700*----------------------------------------------------------------*11750001
110800* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *11760001
110900* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *11770001
111000*                                                                *11780001
111100* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *11790001
111200*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *11800001
111300*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *11810001
111400*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *11820001
111500*----------------------------------------------------------------*11830001
111600 1000-CONTROL-PROCESSING.                                         11840001
111700     EVALUATE TRUE                                                11850001
111800         WHEN DP020-NEXT-ACT-INITIAL                              11860001
111900             INITIALIZE ASC-SPECIFIC-COMMAREA                     11870001
112000             MOVE EIBTRMID    TO ASC-LIST-TERM-ID                 11880001
112100                                 ASC-SEL-TERM-ID                  11890001
112200             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   11900001
112300                                           ASC-SEL-TASK-NUMBER    11910001
112400             MOVE PC-LIST-QUEUE-SEQ TO ASC-LIST-SEQ               11920001
112500             MOVE PC-SEL-QUEUE-SEQ  TO ASC-SEL-SEQ                11930001
112600             PERFORM 1100-PROCESS-INTER-APPL-COMM                 11940001
112800             PERFORM 4000-BUILD-INITIAL-PANEL                     11950001
112900                                                                  11960001
113000         WHEN DP020-NEXT-ACT-READ-MAP                             11970001
113100             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         11980001
113200             PERFORM 2000-PROCESS-PANEL                           11990001
113300                                                                  12000001
113400         WHEN DP020-NEXT-ACT-RETURN                               12010001
113500             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         12020001
113600             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               12030001
113700             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 12040001
113800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12050001
113900                                                                  12060001
114000         WHEN OTHER                                               12070001
114100             SET DP013-LOGIC-ABEND TO TRUE                        12080001
114200             SET DP013-NO-ROLLBACK TO TRUE                        12090001
114300             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    12100001
114400             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    12110001
114500                                   TO DP013-MESSAGE-TEXT(1)       12120001
114600             PERFORM DP013-0000-PROCESS-ABEND                     12130001
114700     END-EVALUATE.                                                12140001
114800                                                                  12150001
114900*----------------------------------------------------------------*12160001
115000* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *12170001
115100* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *12180001
115200*----------------------------------------------------------------*12190001
115300 1100-PROCESS-INTER-APPL-COMM.                                    12200001
115400                                                                  12210001
115500     SET PS-COMMAREA-VALID         TO TRUE.                       12220001
115600     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     12230001
115610     MOVE DP020-INT-APPL-FORMAT-IND                               12240099
115620                                   TO ASC-INT-APPL-FORMAT-IND.    12250099
115700                                                                  12260001
115800     EVALUATE TRUE                                                12270069
115900         WHEN DP020-INT-APPL-FORMAT-IND = '1'                     12280069
116000**            SUSDRRSL - SUKCS798 - F24                           12290069
116100              MOVE SU097-OPER-UNT-ID        TO ASC-OPER-UNT-ID    12300069
116200                                               DK-OPER-UNT-ID     12310099
116300              MOVE SU097-FCLTY-NME          TO ASC-FCLTY-NAME     12320069
116400              MOVE SU097-PO-NBR             TO ASC-PO-NBR         12330069
116500              MOVE SU097-RCVR-SEQ-NBR       TO ASC-REC-SEQ-NBR    12340069
116600              MOVE SU097-PO-LNE-NBR         TO ASC-PO-LNE-NBR     12350069
116700              MOVE SU097-PREPACK-ID         TO ASC-PREPACK-ID     12360069
116800              MOVE SU097-PACK-TYPE          TO ASC-PACK-TYPE      12370069
116900              MOVE SU097-AUD-CNTL-NBR       TO ASC-AUDIT-CNTL-NBR 12380069
117000              MOVE SU097-BRCDE-NBR          TO ASC-BRCDE-NBR      12390099
117100              PERFORM 1800-DETERMINE-DATA-COMBO                   12400099
117200                                                                  12410069
117300         WHEN DP020-INT-APPL-FORMAT-IND = '2'                     12420069
117400**            SULDRLNE - SUKCS799 - F24                           12430069
117500**            SULDRRCR - SUKCS768 - F24                           12440069
117600              IF SU098-NUMBER-OF-SELECTED-ITEMS > 0               12450069
117700                 SET  ASC-USE-SELECTION-QUEUE TO TRUE             12460069
117800                 MOVE SU098-NUMBER-OF-SELECTED-ITEMS              12470069
117900                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  12480069
118000                 MOVE SU098-NUMBER-OF-TS-ITEMS                    12490069
118100                                 TO ASC-NUMBER-OF-TS-ITEMS        12500069
118200                 MOVE SU098-SEL-QUEUE-NAME                        12510069
118300                                     TO ASC-SEL-QUEUE-NAME        12520069
118400                 MOVE SU098-OPER-UNT-ID    TO ASC-OPER-UNT-ID     12530069
118500                 MOVE SU098-FCLTY-NME      TO ASC-FCLTY-NAME      12540069
118600                 MOVE SU098-PO-NBR         TO ASC-PO-NBR          12550084
118700                 MOVE 'UPD'                TO ASC-ACTION-SW       12560084
118800                 PERFORM 1120-PREPARE-LIST-ENTRY                  12570069
118900                 PERFORM 1800-DETERMINE-DATA-COMBO                12580099
119000              END-IF                                              12590069
119100                                                                  12600069
119200         WHEN DP020-INT-APPL-FORMAT-IND = '3'                     12610069
119300**            SULDHSTL - SUKCS773 - F22                           12620069
119400**            SULDRLST - SUKCS772 - F22                           12630069
119500              IF SU101-NUMBER-OF-SELECTED-ITEMS > 0               12640099
119600                 SET  ASC-USE-SELECTION-QUEUE TO TRUE             12650069
119700                 MOVE SU101-NUMBER-OF-SELECTED-ITEMS              12660099
119800                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  12670069
119900                 MOVE SU101-NUMBER-OF-TS-ITEMS                    12680099
120000                                 TO ASC-NUMBER-OF-TS-ITEMS        12690069
120100                 MOVE SU101-SEL-QUEUE-NAME                        12700099
120200                                     TO ASC-SEL-QUEUE-NAME        12710069
120300                 MOVE SU101-OPER-UNIT      TO ASC-OPER-UNT-ID     12720099
120500                 MOVE SU101-PO-NUMBER      TO ASC-PO-NBR          12730099
120600                 MOVE 'UPD'                TO ASC-ACTION-SW       12740084
120700                 PERFORM 1320-PREPARE-LIST-ENTRY                  12750099
120800              END-IF                                              12760069
120900                                                                  12770069
121000     END-EVALUATE.                                                12780069
121100                                                                  12790069
121200                                                                  12800069
121300*----------------------------------------------------------------*12810069
121400* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *12820069
121500* STORAGE QUEUE PASSED FROM THE LIST.                            *12830069
121600*----------------------------------------------------------------*12840069
121700 1120-PREPARE-LIST-ENTRY.                                         12850069
121800     MOVE SU099-MAX-ITEMS          TO ASC-SEL-SUB.                12860069
121900     MOVE ZERO                     TO ASC-SEL-ITEM.               12870069
122000     PERFORM 1130-GET-NEXT-RECORD.                                12880069
122100                                                                  12890069
122200*---------------------------------------------------------------- 12900069
122300*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*12910069
122400*---------------------------------------------------------------- 12920069
122500 1130-GET-NEXT-RECORD.                                            12930069
122600     ADD +1                        TO ASC-SEL-SUB.                12940069
122700                                                                  12950069
122800     SET ASC-UPDATE-TSQ TO TRUE.                                  12960069
122900                                                                  12970069
123000     IF  ASC-SEL-SUB > SU099-MAX-ITEMS                            12980069
123100         ADD +1                    TO ASC-SEL-ITEM                12990069
123200         MOVE +1                   TO ASC-SEL-SUB                 13000069
123300     END-IF.                                                      13010069
123400                                                                  13020069
123500     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                13030069
123600         PERFORM 9100-READ-SEL-QUEUE                              13040069
123700         IF  SU099-ITEM (ASC-SEL-SUB) > ZERO                      13050069
123800             PERFORM 1160-MOVE-TO-ASC                             13060069
123900             SET SU099-INQ (ASC-SEL-SUB) TO TRUE                  13070069
124000             PERFORM 9200-REWRITE-SEL-QUEUE                       13080069
124100         ELSE                                                     13090069
124200             SUBTRACT +1 FROM ASC-SEL-SUB                         13100069
124300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            13110069
124400             SET DP020-MSG-INFORMATIONAL                          13120069
124500                 PS-LIST-END       TO TRUE                        13130069
124600         END-IF                                                   13140069
124700     ELSE                                                         13150069
124800         SUBTRACT +1 FROM ASC-SEL-ITEM                            13160069
124900         MOVE SU099-MAX-ITEMS      TO ASC-SEL-SUB                 13170069
125000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            13180069
125100         SET DP020-MSG-INFORMATIONAL                              13190069
125200                 PS-LIST-END       TO TRUE                        13200069
125300     END-IF.                                                      13210069
125400                                                                  13220069
125500******************************************************************13230069
125600*  GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING         13240069
125700*  PROCESSED.                                                     13250069
125800******************************************************************13260069
125900 1140-GET-PREV-RECORD.                                            13270069
126000     SUBTRACT +1 FROM ASC-SEL-SUB.                                13280069
126100                                                                  13290069
126200     IF  ASC-SEL-SUB < +1                                         13300069
126300         SUBTRACT +1 FROM ASC-SEL-ITEM                            13310069
126400         MOVE SU099-MAX-ITEMS      TO ASC-SEL-SUB                 13320069
126500     END-IF.                                                      13330069
126600                                                                  13340069
126700     IF  ASC-SEL-ITEM > ZERO                                      13350069
126800         PERFORM 9100-READ-SEL-QUEUE                              13360069
126900         IF  SU099-ITEM (ASC-SEL-SUB) > ZERO                      13370069
127000             PERFORM 1160-MOVE-TO-ASC                             13380069
127100         END-IF                                                   13390069
127200                                                                  13400069
127300         SET SU099-INQ (ASC-SEL-SUB) TO TRUE                      13410069
127400         PERFORM 9200-REWRITE-SEL-QUEUE                           13420069
127500     ELSE                                                         13430069
127600         MOVE +1                   TO ASC-SEL-ITEM                13440069
127700                                      ASC-SEL-SUB                 13450069
127800         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            13460069
127900         SET DP020-MSG-INFORMATIONAL                              13470069
128000             PS-LIST-END             TO TRUE                      13480069
128100     END-IF.                                                      13490069
128200                                                                  13500069
128300 1160-MOVE-TO-ASC.                                                13510069
128400                                                                  13520069
128500     EVALUATE TRUE                                                13530099
128600         WHEN DP020-INT-APPL-FORMAT-IND = '2'                     13540099
128700              MOVE SU099-RCVR         (ASC-SEL-SUB)               13550099
128701                TO ASC-REC-SEQ-NBR                                13560099
128710              MOVE SU099-PO-LNE-NBR   (ASC-SEL-SUB)               13570099
128711                TO ASC-PO-LNE-NBR                                 13580099
128720              MOVE SU099-PREPACK-ID   (ASC-SEL-SUB)               13590099
128721                TO ASC-PREPACK-ID                                 13600099
128730              MOVE SU099-PKG          (ASC-SEL-SUB)               13610099
128731                TO ASC-PACK-TYPE                                  13620099
128740              MOVE SU099-AUD-CNTL-NBR (ASC-SEL-SUB)               13630099
128741                TO ASC-AUDIT-CNTL-NBR                             13640099
128750              MOVE SU099-BRCDE-NBR    (ASC-SEL-SUB)               13650099
128760                TO ASC-BRCDE-NBR                                  13660099
128800*             MOVE ZEROES                   TO ASC-PO-LNE-NBR     13670099
128900*             MOVE ZEROES                   TO ASC-PREPACK-ID     13680099
129000*             MOVE SPACES                   TO ASC-PACK-TYPE      13690099
129100*             MOVE ZEROES                   TO ASC-AUDIT-CNTL-NBR 13700099
129200*             MOVE SPACES                   TO ASC-BRCDE-NBR      13710099
129300              PERFORM 1800-DETERMINE-DATA-COMBO                   13720099
129400                                                                  13730069
129500     END-EVALUATE.                                                13740099
129600                                                                  13750069
129700                                                                  13760099
129800*----------------------------------------------------------------*13770099
129900* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *13780099
130000* STORAGE QUEUE PASSED FROM THE LIST.                            *13790099
130100*----------------------------------------------------------------*13800099
130200 1320-PREPARE-LIST-ENTRY.                                         13810099
130300     MOVE SU102-MAX-ITEMS          TO ASC-SEL-SUB.                13820099
130400     MOVE ZERO                     TO ASC-SEL-ITEM.               13830099
130500     PERFORM 1330-GET-NEXT-RECORD.                                13840099
130600                                                                  13850099
130700*---------------------------------------------------------------- 13860099
130800*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*13870099
130900*---------------------------------------------------------------- 13880099
131000 1330-GET-NEXT-RECORD.                                            13890099
131100     ADD +1                        TO ASC-SEL-SUB.                13900099
131200                                                                  13910099
131300     SET ASC-UPDATE-TSQ TO TRUE.                                  13920099
131400                                                                  13930099
131500     IF  ASC-SEL-SUB > SU102-MAX-ITEMS                            13940099
131600         ADD +1                    TO ASC-SEL-ITEM                13950099
131700         MOVE +1                   TO ASC-SEL-SUB                 13960099
131800     END-IF.                                                      13970099
131900                                                                  13980099
132000     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                13990099
132100         PERFORM 9300-READ-SEL-QUEUE                              14000099
132200         IF  SU102-ITEM (ASC-SEL-SUB) > ZERO                      14010099
132300             PERFORM 1360-MOVE-TO-ASC                             14020099
132400             SET SU102-INQ (ASC-SEL-SUB) TO TRUE                  14030099
132500             PERFORM 9400-REWRITE-SEL-QUEUE                       14040099
132600         ELSE                                                     14050099
132700             SUBTRACT +1 FROM ASC-SEL-SUB                         14060099
132800             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            14070099
132900             SET DP020-MSG-INFORMATIONAL                          14080099
133000                 PS-LIST-END       TO TRUE                        14090099
133100         END-IF                                                   14100099
133200     ELSE                                                         14110099
133300         SUBTRACT +1 FROM ASC-SEL-ITEM                            14120099
133400         MOVE SU102-MAX-ITEMS      TO ASC-SEL-SUB                 14130099
133500         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            14140099
133600         SET DP020-MSG-INFORMATIONAL                              14150099
133700                 PS-LIST-END       TO TRUE                        14160099
133800     END-IF.                                                      14170099
133900                                                                  14180099
134000******************************************************************14190099
134100*  GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING         14200099
134200*  PROCESSED.                                                     14210099
134300******************************************************************14220099
134400 1340-GET-PREV-RECORD.                                            14230099
134500     SUBTRACT +1 FROM ASC-SEL-SUB.                                14240099
134600                                                                  14250099
134700     IF  ASC-SEL-SUB < +1                                         14260099
134800         SUBTRACT +1 FROM ASC-SEL-ITEM                            14270099
134900         MOVE SU102-MAX-ITEMS      TO ASC-SEL-SUB                 14280099
135000     END-IF.                                                      14290099
135100                                                                  14300099
135200     IF  ASC-SEL-ITEM > ZERO                                      14310099
135300         PERFORM 9300-READ-SEL-QUEUE                              14320099
135400         IF  SU102-ITEM (ASC-SEL-SUB) > ZERO                      14330099
135500             PERFORM 1360-MOVE-TO-ASC                             14340099
135600         END-IF                                                   14350099
135700                                                                  14360099
135800         SET SU102-INQ (ASC-SEL-SUB) TO TRUE                      14370099
135900         PERFORM 9400-REWRITE-SEL-QUEUE                           14380099
136000     ELSE                                                         14390099
136100         MOVE +1                   TO ASC-SEL-ITEM                14400099
136200                                      ASC-SEL-SUB                 14410099
136300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            14420099
136400         SET DP020-MSG-INFORMATIONAL                              14430099
136500             PS-LIST-END             TO TRUE                      14440099
136600     END-IF.                                                      14450099
136700                                                                  14460099
136800 1360-MOVE-TO-ASC.                                                14470099
136900                                                                  14480099
137000     EVALUATE TRUE                                                14490099
137100         WHEN DP020-INT-APPL-FORMAT-IND = '2'                     14500099
137200              CONTINUE                                            14510099
137300                                                                  14520099
137400         WHEN DP020-INT-APPL-FORMAT-IND = '3'                     14530099
137500              MOVE SU102-PO-NUMBER (ASC-SEL-SUB) TO ASC-PO-NBR    14540099
137600              MOVE SU102-RCVR (ASC-SEL-SUB) TO ASC-REC-SEQ-NBR    14550099
137700              MOVE ZEROES                   TO ASC-PO-LNE-NBR     14560099
137800              MOVE ZEROES                   TO ASC-PREPACK-ID     14570099
137900              MOVE SPACES                   TO ASC-PACK-TYPE      14580099
138000              MOVE ZEROES                   TO ASC-AUDIT-CNTL-NBR 14590099
138100              MOVE SU102-CARTON-ID (ASC-SEL-SUB) TO               14600099
138200                                               ASC-BRCDE-NBR      14610099
138300              PERFORM 1800-DETERMINE-DATA-COMBO                   14620099
138400                                                                  14630099
138500     END-EVALUATE.                                                14640099
138600                                                                  14650099
138700                                                                  14660099
138800*----------------------------------------------------------------*14670027
138900*                                                                *14680027
139000*                                                                *14690027
139100*----------------------------------------------------------------*14700027
139200 1800-DETERMINE-DATA-COMBO.                                       14710099
139300                                                                  14720027
139400     EVALUATE TRUE                                                14730027
139500         WHEN ASC-BRCDE-NBR  > SPACES                             14740099
139600              SET ASC-RQST-BAR-CODE TO TRUE                       14750099
139700              PERFORM 6900-SELECT-BAR-CODE                        14760099
139800              PERFORM 7000-SELECT-TRECEIV                         14770099
139900                                                                  14780099
140000         WHEN ASC-AUDIT-CNTL-NBR > 0                              14790027
140100              SET ASC-RQST-AUDIT     TO TRUE                      14800027
140200              PERFORM 7020-SELECT-AUD-CNTL-NBR                    14810027
140300              PERFORM 7000-SELECT-TRECEIV                         14820027
140400                                                                  14830027
140500         WHEN ASC-PREPACK-ID  > 0                                 14840053
140600              SET ASC-RQST-PO-RCVR-PREPK TO TRUE                  14850027
140700              PERFORM 7000-SELECT-TRECEIV                         14860027
140800                                                                  14870027
140900         WHEN ASC-PO-LNE-NBR > 0                                  14880027
141000              SET ASC-RQST-PO-RCVR-LINE TO TRUE                   14890027
141100              PERFORM 7000-SELECT-TRECEIV                         14900027
141200                                                                  14910039
141300         WHEN OTHER                                               14920039
141400              SET ASC-RQST-PO-RCVR TO TRUE                        14930039
141500              PERFORM 7000-SELECT-TRECEIV                         14940039
141600                                                                  14950039
141700     END-EVALUATE.                                                14960039
141800                                                                  14970039
141900     PERFORM 7030-FIND-SCAC-TRAILER.                              14980058
142000                                                                  14990039
142100     PERFORM 7040-FIND-MAX-STATUS.                                15000058
142200                                                                  15010058
142300     PERFORM 7080-SELECT-EXPECTED-CARTONS.                        15020058
142400                                                                  15030039
142500     PERFORM 7100-DIRECTIVES-AVAIL.                               15040097
142600                                                                  15050095
142700                                                                  15060001
142800*----------------------------------------------------------------*15070001
142900* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *15080001
143000* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *15090001
143100* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *15100001
143200* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *15110001
143300* FUNCTION KEYS CAN GET THIS FAR.                                *15120001
143400*----------------------------------------------------------------*15130001
143500 2000-PROCESS-PANEL.                                              15140001
143600     EVALUATE TRUE                                                15150001
143700         WHEN DP020-SRC-AID = DP016-CLEAR                         15160001
143800             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                15170001
143900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   15180001
144000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15190001
144100                                                                  15200001
144200         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    15210001
144300             PERFORM 2050-DELETE-LIST-QUEUE                       15220001
144400             PERFORM 4000-BUILD-INITIAL-PANEL                     15230001
144500                                                                  15240001
144600         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   15250001
144700             PERFORM 2140-DESELECT-ALL-ITEMS                      15260001
144800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15270001
144900                                                                  15280001
145000         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  15290001
145100             PERFORM 2150-SELECT-ALL-ITEMS                        15300001
145200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15310001
145300                                                                  15320077
145400*F20-NEXT SEL                                                     15330077
145500         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             15340077
145600             EVALUATE TRUE                                        15350099
145700                 WHEN DP020-INT-APPL-FORMAT-IND = '2'             15360099
145800                   IF  ASC-USE-SELECTION-QUEUE                    15370099
145900                       PERFORM 1130-GET-NEXT-RECORD               15380099
146000                       PERFORM 3000-EDIT-DATA-IN-COMMAREA         15390099
146100                       IF PS-LIST-END                             15400099
146200                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN   15410099
146300                           SET PS-NO-LIST-END TO TRUE             15420099
146400                       ELSE                                       15430099
146500                           PERFORM 2050-DELETE-LIST-QUEUE         15440099
146600                           PERFORM 3200-RESET-ATTRIBUTES          15450099
146700                           PERFORM 4000-BUILD-INITIAL-PANEL       15460099
146800                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN   15470099
146900                       END-IF                                     15480099
147000                   ELSE                                           15490099
147100*****                --- BOTTOM OF LIST ---                       15500099
147200                       MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER   15510099
147300                       SET DP020-MSG-INFORMATIONAL TO TRUE        15520099
147400                   END-IF                                         15530099
147500                                                                  15540077
147600                 WHEN DP020-INT-APPL-FORMAT-IND = '3'             15550099
147700                   IF  ASC-USE-SELECTION-QUEUE                    15560099
147800                       PERFORM 1330-GET-NEXT-RECORD               15570099
147900                       PERFORM 3000-EDIT-DATA-IN-COMMAREA         15580099
148000                       IF PS-LIST-END                             15590099
148100                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN   15600099
148200                           SET PS-NO-LIST-END TO TRUE             15610099
148300                       ELSE                                       15620099
148400                           PERFORM 2050-DELETE-LIST-QUEUE         15630099
148500                           PERFORM 3200-RESET-ATTRIBUTES          15640099
148600                           PERFORM 4000-BUILD-INITIAL-PANEL       15650099
148700                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN   15660099
148800                       END-IF                                     15670099
148900                   ELSE                                           15680099
149000*****                --- BOTTOM OF LIST ---                       15690099
149100                       MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER   15700099
149200                       SET DP020-MSG-INFORMATIONAL TO TRUE        15710099
149300                   END-IF                                         15720099
149400                                                                  15730099
149500                 WHEN OTHER                                       15740099
149600                   MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER       15750099
149700                   SET DP020-MSG-FATAL TO TRUE                    15760099
149800                                                                  15770099
149900             END-EVALUATE                                         15780099
150000                                                                  15790099
150100*F19-PREV SEL                                                     15800099
150200         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             15810077
150300             EVALUATE TRUE                                        15820099
150400                 WHEN DP020-INT-APPL-FORMAT-IND = '2'             15830099
150500                   IF  ASC-USE-SELECTION-QUEUE                    15840099
150600                      PERFORM 1140-GET-PREV-RECORD                15850099
150700                      PERFORM 3000-EDIT-DATA-IN-COMMAREA          15860099
150800                      IF PS-LIST-END                              15870099
150900                          PERFORM 4400-MOVE-COMMAREA-TO-SCREEN    15880099
151000                          SET PS-NO-LIST-END TO TRUE              15890099
151100                      ELSE                                        15900099
151200                          PERFORM 2050-DELETE-LIST-QUEUE          15910099
151300                          PERFORM 3200-RESET-ATTRIBUTES           15920099
151400                          PERFORM 4000-BUILD-INITIAL-PANEL        15930099
151500                          PERFORM 4400-MOVE-COMMAREA-TO-SCREEN    15940099
151600                      END-IF                                      15950099
151700                  ELSE                                            15960099
151800                      MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER    15970099
151900                      SET DP020-MSG-INFORMATIONAL TO TRUE         15980099
152000                  END-IF                                          15990099
152100                                                                  16000099
152200                WHEN DP020-INT-APPL-FORMAT-IND = '3'              16010099
152300                   IF  ASC-USE-SELECTION-QUEUE                    16020099
152400                      PERFORM 1340-GET-PREV-RECORD                16030099
152500                      PERFORM 3000-EDIT-DATA-IN-COMMAREA          16040099
152600                      IF PS-LIST-END                              16050099
152700                          PERFORM 4400-MOVE-COMMAREA-TO-SCREEN    16060099
152800                          SET PS-NO-LIST-END TO TRUE              16070099
152900                      ELSE                                        16080099
153000                          PERFORM 2050-DELETE-LIST-QUEUE          16090099
153100                          PERFORM 3200-RESET-ATTRIBUTES           16100099
153200                          PERFORM 4000-BUILD-INITIAL-PANEL        16110099
153300                          PERFORM 4400-MOVE-COMMAREA-TO-SCREEN    16120099
153400                      END-IF                                      16130099
153500                  ELSE                                            16140099
153600                      MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER    16150099
153700                      SET DP020-MSG-INFORMATIONAL TO TRUE         16160099
153800                  END-IF                                          16170099
153900                                                                  16180099
154000                WHEN OTHER                                        16190099
154100                  MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER        16200099
154200                  SET DP020-MSG-FATAL TO TRUE                     16210099
154300                                                                  16220099
154400             END-EVALUATE                                         16230099
154500                                                                  16240099
154600         WHEN OTHER                                               16250001
154700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 16260001
154800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   16270001
154900             IF  PS-NO-ERROR                                      16280001
155000                 SET DP030-CONTINUE-GO TO TRUE                    16290001
155100                 PERFORM 2100-CHECK-FUNCTION-KEY                  16300001
155200             ELSE                                                 16310001
155300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             16320001
155400                 SET DP030-OVERRIDE-GO TO TRUE                    16330001
155500             END-IF                                               16340001
155600     END-EVALUATE.                                                16350001
155700                                                                  16360001
155800*----------------------------------------------------------------*16370001
155900*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *16380001
156000*----------------------------------------------------------------*16390001
156100 2050-DELETE-LIST-QUEUE.                                          16400001
156200                                                                  16410001
156300     EXEC CICS                                                    16420001
156400         DELETEQ TS                                               16430001
156500             QUEUE (ASC-LIST-QUEUE-NAME)                          16440001
156600             RESP  (PV-CICS-RESP)                                 16450001
156700     END-EXEC.                                                    16460001
156800                                                                  16470001
156900     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       16480001
157000        (PV-CICS-RESP = DFHRESP(QIDERR))                          16490001
157100         CONTINUE                                                 16500001
157200     ELSE                                                         16510001
157300         SET DP013-CICS-ABEND      TO TRUE                        16520001
157400         SET DP013-NO-ROLLBACK     TO TRUE                        16530001
157500                                                                  16540001
157600         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         16550001
157700         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    16560001
157800                                   TO DP013-MESSAGE-TEXT (1)      16570001
157900         PERFORM DP013-0000-PROCESS-ABEND                         16580001
158000     END-IF.                                                      16590001
158100                                                                  16600001
158200     MOVE +0  TO ASC-HIGHEST-BLOCK-WRITTEN.                       16610001
158300                                                                  16620001
158400*----------------------------------------------------------------*16630001
158500* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*16640001
158600* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *16650001
158700* CICS ARCHITECTURE API.                                         *16660001
158800*----------------------------------------------------------------*16670001
158900 2100-CHECK-FUNCTION-KEY.                                         16680001
159000                                                                  16690001
159100     EVALUATE TRUE                                                16700001
159200* F2 - CONFIRM UPDATE                                             16710081
159300         WHEN DP020-FK-CONFIRM  (DP020-SRC-AID)                   16720082
159400             IF ( ASC-F2-CONFIRM-YES )                            16730099
159500               IF ( ASC-NUMBER-OF-SELECTED-ITEMS > 0 )            16740099
159600                  PERFORM 2400-EDIT-FOR-UPDATE                    16750099
159700                          VARYING PV-ITEM FROM 1 BY 1             16760099
159800                            UNTIL PV-ITEM >                       16770099
159900                                     ASC-HIGHEST-BLOCK-WRITTEN    16780099
160000                               OR PS-ERROR                        16790099
160100                                                                  16800099
160200                 IF ( PS-NO-ERROR )                               16810099
160300                     MOVE PC-TSYMSG-03657  TO DP020-MSG-NUMBER    16820099
160400                     SET DP030-OVERRIDE-GO TO TRUE                16830099
160500                     SET DP020-MSG-WARNING TO TRUE                16840099
160501                     SET DP030-DONT-ERASE                         16850099
160502                         DP030-SEND-DATAONLY (1)  TO TRUE         16860099
160510                     PERFORM 2050-DELETE-LIST-QUEUE               16870099
160520                     PERFORM 4000-BUILD-INITIAL-PANEL             16880099
160600                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         16890099
160700                 END-IF                                           16900099
160800               ELSE                                               16910099
160900                   SET DP030-OVERRIDE-GO TO TRUE                  16920099
161000                   MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER      16930099
161100                   SET DP020-MSG-WARNING TO TRUE                  16940099
161200               END-IF                                             16950099
161300             ELSE                                                 16960099
161310                 MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER         16970099
161320                 SET DP020-MSG-FATAL TO TRUE                      16980099
161330             END-IF                                               16990099
161400* F15 -  RELEASE (LOCAL-FUNC-01)                                  17000042
161500         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              17010042
161600            MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID             17020099
161700            IF ASC-OPER-UNT-ID = DK-OPER-UNT-ID                   17030099
161800               SET ASC-F2-CONFIRM-NO  TO TRUE                     17040099
161900               PERFORM 7200-RACF-ACCESS                           17050099
162000               IF PS-RELEASE-ALLOWED                              17060099
162100                  SET ASC-F2-CONFIRM-YES TO TRUE                  17070099
162200                  SET PS-ERROR                                    17080099
162300                      DP020-MSG-FATAL   TO TRUE                   17090099
162400                  MOVE PC-TSYMSG-03643 TO DP020-MSG-NUMBER        17100099
162500                  MOVE -1              TO MR-SELECTL (1)          17110099
162600                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             17120099
162700               ELSE                                               17130099
162800                  SET DP030-OVERRIDE-GO TO TRUE                   17140099
162900                  MOVE PC-TSYMSG-03646  TO DP020-MSG-NUMBER       17150099
163000                  SET PS-ERROR                                    17160099
163100                      DP020-MSG-FATAL   TO TRUE                   17170099
163300                  MOVE -1              TO MR-SELECTL (1)          17180099
163400                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             17190099
163500               END-IF                                             17200099
163600            ELSE                                                  17210099
163700               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               17220099
163800               SET DP030-OVERRIDE-GO TO TRUE                      17230099
163900               MOVE PC-TSYMSG-03645  TO DP020-MSG-NUMBER          17240099
164000               SET PS-ERROR                                       17250099
164100                   DP020-MSG-FATAL   TO TRUE                      17260099
164200            END-IF                                                17270099
164300                                                                  17280001
164400* F6 - FIRST PAGE                                                 17290001
164500         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  17300001
164600             MOVE +1               TO PV-TOP-ITEM                 17310001
164700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17320001
164800                                                                  17330001
164900* F7 - PREVIOUS PAGE                                              17340001
165000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   17350001
165100             PERFORM 2110-BROWSE-BACKWARD                         17360001
165200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17370001
165300                                                                  17380001
165400* F8 - NEXT PAGE                                                  17390001
165500         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   17400001
165600             PERFORM 2120-BROWSE-FORWARD                          17410001
165700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17420001
165800                                                                  17430001
165900* ENTER KEY                                                       17440001
166000         WHEN DP020-SRC-AID = DP016-ENTER                         17450001
166100             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   17460001
166200             IF  PS-ERROR                                         17470001
166300                 CONTINUE                                         17480001
166400             ELSE                                                 17490001
166500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             17500001
166600             END-IF                                               17510001
166700                                                                  17520001
166800         WHEN OTHER                                               17530001
166900             SET DP013-NO-ROLLBACK                                17540001
167000                 DP013-XCTL-DISPLAY-RESTART                       17550001
167100                 DP013-CICS-ABEND  TO TRUE                        17560001
167200             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    17570001
167300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      17580001
167400                                   TO DP013-MESSAGE-TEXT (1)      17590001
167500             PERFORM DP013-0000-PROCESS-ABEND                     17600001
167600     END-EVALUATE.                                                17610001
167700                                                                  17620001
167800******************************************************************17630001
167900** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **17640001
168000** INTER-APPLICATION COMMAREA.                                  **17650001
168100******************************************************************17660001
168200 2110-PREPARE-INTER-APPL-COMM.                                    17670001
168300                                                                  17680001
168400     INITIALIZE SU097-INTER-APPL-COMMAREA.                        17690005
168500                                                                  17700001
168600     MOVE DP020-LOCATION-NBR       TO DK-OPER-UNT-ID.             17710001
168700     MOVE ASC-OPER-UNT-ID          TO SU097-OPER-UNT-ID.          17720005
168800     MOVE ASC-FCLTY-NAME           TO SU097-FCLTY-NME.            17730005
168900                                                                  17740001
169000*----------------------------------------------------------------*17750001
169100*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *17760001
169200*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *17770001
169300*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *17780001
169400*    MESSAGE.                                                    *17790001
169500*----------------------------------------------------------------*17800001
169600 2110-BROWSE-BACKWARD.                                            17810001
169700     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    17820001
169800         GIVING PV-TOP-ITEM.                                      17830001
169900*                                                                 17840001
170000     IF  ((PV-TOP-ITEM < +1)                                      17850001
170100       OR (PV-TOP-ITEM = +1))                                     17860001
170200         MOVE +1                   TO PV-TOP-ITEM                 17870001
170300*        -- TOP OF LIST --                                        17880001
170400         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            17890001
170500         SET DP020-MSG-INFORMATIONAL TO TRUE                      17900001
170600     END-IF.                                                      17910001
170700                                                                  17920001
170800*----------------------------------------------------------------*17930001
170900*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *17940001
171000*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *17950001
171100*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *17960001
171200*----------------------------------------------------------------*17970001
171300 2120-BROWSE-FORWARD.                                             17980001
171400     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              17990001
171500         GIVING PV-TOP-ITEM.                                      18000001
171600     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   18010001
171700         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             18020001
171800*        -- BOTTOM OF LIST --                                     18030001
171900         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            18040001
172000         SET DP020-MSG-INFORMATIONAL TO TRUE                      18050001
172100     ELSE                                                         18060001
172200         COMPUTE PV-BOTTOM-ITEM =                                 18070001
172300             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 18080001
172400         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            18090001
172500*            -- BOTTOM OF LIST --                                 18100001
172600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            18110001
172700             SET DP020-MSG-INFORMATIONAL TO TRUE                  18120001
172800         END-IF                                                   18130001
172900     END-IF.                                                      18140001
173000                                                                  18150001
173100*----------------------------------------------------------------*18160001
173200*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *18170001
173300*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *18180001
173400*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *18190001
173500*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *18200001
173600*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *18210001
173700*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *18220001
173800*----------------------------------------------------------------*18230001
173900 2130-CHECK-FOR-JUMP-BROWSE.                                      18240001
174000     SET PS-NO-ERROR               TO TRUE.                       18250001
174100     IF (ASC-START-ITEM-REQUEST = SPACE)                          18260001
174200         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             18270001
174300     ELSE                                                         18280001
174400         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     18290001
174500         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       18300001
174600         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     18310001
174700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  18320001
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18331099
263968              USING DP010I-NUMERIC-EDIT-AREA                      18332099
174900                                                                  18340001
175000         IF  NOT DP010I-ERROR-DETECTED                            18350001
175100             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N18360001
175200             IF  ASC-START-ITEM-REQUEST-N > ZERO                  18370001
175300                 IF  ASC-START-ITEM-REQUEST-N >                   18380001
175400                                          ASC-NUMBER-OF-ITEMS-READ18390001
175500                     MOVE SPACE TO ASC-START-ITEM-REQUEST         18400001
175600                     COMPUTE PV-TOP-ITEM =                        18410001
175700                             ASC-NUMBER-OF-ITEMS-READ             18420001
175800                             - PC-ITEMS-PER-PANEL + 1             18430001
175900                     IF  PV-TOP-ITEM < +1                         18440001
176000                         MOVE +1   TO PV-TOP-ITEM                 18450001
176100                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 18460001
176200                         SET DP020-MSG-INFORMATIONAL TO TRUE      18470001
176300                     END-IF                                       18480001
176400                 ELSE                                             18490001
176500                     MOVE ASC-START-ITEM-REQUEST-N                18500001
176600                                   TO PV-TOP-ITEM                 18510001
176700                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      18520001
176800                     COMPUTE PV-BOTTOM-ITEM =                     18530001
176900                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     18540001
177000                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ18550001
177100*                        -- BOTTOM OF LIST --                     18560001
177200                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 18570001
177300                         SET DP020-MSG-INFORMATIONAL TO TRUE      18580001
177400                     END-IF                                       18590001
177500                 END-IF                                           18600001
177600             ELSE                                                 18610001
177700*                --- VALUE OUT OF RANGE ----                      18620001
177800                 MOVE PC-TSYMSG-00101 TO DP020-MSG-NUMBER         18630001
177900                 MOVE -1              TO ASTRTITL                 18640001
178000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              18650001
178100                 MOVE DP015-REVERSE   TO ASTRTITH                 18660001
178200                 MOVE DP015-RED       TO ASTRTITC                 18670001
178300                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           18680001
178400                 SET DP020-MSG-FATAL  TO TRUE                     18690001
178500                 SET PS-ERROR         TO TRUE                     18700001
178600             END-IF                                               18710001
178700         ELSE                                                     18720001
178800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            18730001
178900             MOVE -1               TO ASTRTITL                    18740001
179000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  18750001
179100             MOVE DP015-REVERSE    TO ASTRTITH                    18760001
179200             MOVE DP015-RED        TO ASTRTITC                    18770001
179300             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               18780001
179400             SET DP020-MSG-FATAL   TO TRUE                        18790001
179500             SET PS-ERROR          TO TRUE                        18800001
179600         END-IF                                                   18810001
179700     END-IF.                                                      18820001
179800                                                                  18830001
179900*----------------------------------------------------------------*18840001
180000*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *18850001
180100*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *18860001
180200*----------------------------------------------------------------*18870001
180300 2140-DESELECT-ALL-ITEMS.                                         18880001
180400     MOVE +1                       TO ASC-BLK-SUB.                18890001
180500                                                                  18900001
180600     PERFORM 2141-CLEAR-SELECTED-INDS                             18910001
180700         VARYING ASC-ITEM-SUB                                     18920001
180800         FROM 1 BY 1                                              18930001
180900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18940001
181000                                                                  18950001
181100     ADD +1                        TO ASC-BLK-SUB.                18960001
181200                                                                  18970001
181300     PERFORM 2141-CLEAR-SELECTED-INDS                             18980001
181400         VARYING ASC-ITEM-SUB                                     18990001
181500         FROM 1 BY 1                                              19000001
181600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19010001
181700                                                                  19020001
181800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               19030001
181900                                   TO PV-LIST-ITEM-NUMBER.        19040001
182000                                                                  19050001
182100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            19060001
182200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    19070001
182300                                                                  19080001
182400     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            19090001
182500         MOVE +1                   TO ASC-BLK-SUB                 19100001
182600                                                                  19110001
182700         PERFORM 5100-WRITE-TEMP-STORAGE                          19120001
182800         MOVE +2                   TO ASC-BLK-SUB                 19130001
182900         PERFORM 5100-WRITE-TEMP-STORAGE                          19140001
183000         MOVE +1                   TO ASC-BLK-SUB                 19150001
183100         MOVE +1                   TO PV-BLOCK-NUMBER             19160001
183200     END-IF.                                                      19170001
183300                                                                  19180001
183400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     19190001
183500        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      19200001
183600         MOVE +1                   TO ASC-BLK-SUB                 19210001
183700                                                                  19220001
183800         PERFORM 5100-WRITE-TEMP-STORAGE                          19230001
183900         MOVE +2  TO ASC-BLK-SUB                                  19240001
184000         PERFORM 5100-WRITE-TEMP-STORAGE                          19250001
184100         MOVE +1  TO ASC-BLK-SUB                                  19260001
184200         MOVE +1  TO PV-BLOCK-NUMBER                              19270001
184300                                                                  19280001
184400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         19290001
184500             PV-FIRST-BLOCK-IN-ARRAY - 1                          19300001
184600                                                                  19310001
184700         PERFORM                                                  19320001
184800             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       19330001
184900                                                                  19340001
185000             PERFORM 4410-READ-TEMP-STORAGE                       19350001
185100                                                                  19360001
185200             PERFORM 2141-CLEAR-SELECTED-INDS                     19370001
185300                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 19380001
185400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19390001
185500                                                                  19400001
185600             PERFORM 5100-WRITE-TEMP-STORAGE                      19410001
185700                                                                  19420001
185800             ADD +1                TO PV-BLOCK-NUMBER             19430001
185900                                                                  19440001
186000         END-PERFORM                                              19450001
186100                                                                  19460001
186200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         19470001
186300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     19480001
186400                                                                  19490001
186500         PERFORM                                                  19500001
186600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       19510001
186700                   ASC-HIGHEST-BLOCK-WRITTEN                      19520001
186800                                                                  19530001
186900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          19540001
187000                                   TO PV-BLOCK-NUMBER             19550001
187100                                                                  19560001
187200             PERFORM 4410-READ-TEMP-STORAGE                       19570001
187300                                                                  19580001
187400             PERFORM 2141-CLEAR-SELECTED-INDS                     19590001
187500                 VARYING ASC-ITEM-SUB                             19600001
187600                 FROM 1 BY 1                                      19610001
187700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19620001
187800                                                                  19630001
187900             PERFORM 5100-WRITE-TEMP-STORAGE                      19640001
188000                                                                  19650001
188100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      19660001
188200                                                                  19670001
188300         END-PERFORM                                              19680001
188400                                                                  19690001
188500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             19700001
188600                                   TO PV-BLOCK-NUMBER             19710001
188700                                                                  19720001
188800         PERFORM 4410-READ-TEMP-STORAGE                           19730001
188900     END-IF.                                                      19740001
189000                                                                  19750001
189100     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 19760001
189200     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.19770001
189300     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  19780001
189400                                                                  19790001
189500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        19800001
189600                                                                  19810001
189700*----------------------------------------------------------------*19820001
189800*    MARK EACH ITEM AS BEING NOT SELECTED.                       *19830001
189900*----------------------------------------------------------------*19840001
190000 2141-CLEAR-SELECTED-INDS.                                        19850001
190100     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           19860001
190200             NOT EQUAL ZERO                                       19870001
190300         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          19880001
190400             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          19890001
190500                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    19900001
190600                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          19910001
190700         END-IF                                                   19920001
190800     END-IF.                                                      19930001
190900                                                                  19940001
191000*----------------------------------------------------------------*19950001
191100*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTION SWITCH *19960001
191200*  FOR ALL ITEMS.                                                *19970001
191300*----------------------------------------------------------------*19980001
191400 2150-SELECT-ALL-ITEMS.                                           19990001
191500     MOVE +1                       TO ASC-BLK-SUB.                20000001
191600                                                                  20010001
191700     PERFORM 2151-SET-SELECTED-INDS                               20020001
191800         VARYING ASC-ITEM-SUB                                     20030001
191900         FROM 1 BY 1                                              20040001
192000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20050001
192100                                                                  20060001
192200     ADD +1                        TO ASC-BLK-SUB.                20070001
192300                                                                  20080001
192400     PERFORM 2151-SET-SELECTED-INDS                               20090001
192500         VARYING ASC-ITEM-SUB                                     20100001
192600         FROM 1 BY 1                                              20110001
192700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20120001
192800                                                                  20130001
192900     MOVE ASC-LIST-ITEM-NUMBER(1 1)  TO PV-LIST-ITEM-NUMBER.      20140001
193000                                                                  20150001
193100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            20160001
193200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    20170001
193300                                                                  20180001
193400     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            20190001
193500         MOVE +1                   TO ASC-BLK-SUB                 20200001
193600                                                                  20210001
193700         PERFORM 5100-WRITE-TEMP-STORAGE                          20220001
193800         MOVE +2                   TO ASC-BLK-SUB                 20230001
193900         PERFORM 5100-WRITE-TEMP-STORAGE                          20240001
194000         MOVE +1                   TO ASC-BLK-SUB                 20250001
194100         MOVE +1                   TO PV-BLOCK-NUMBER             20260001
194200     END-IF.                                                      20270001
194300     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     20280001
194400        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    20290001
194500         MOVE +1                   TO ASC-BLK-SUB                 20300001
194600                                                                  20310001
194700         PERFORM 5100-WRITE-TEMP-STORAGE                          20320001
194800                                                                  20330001
194900         MOVE +1                   TO PV-BLOCK-NUMBER             20340001
195000                                                                  20350001
195100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         20360001
195200             PV-FIRST-BLOCK-IN-ARRAY - 1                          20370001
195300                                                                  20380001
195400         PERFORM                                                  20390001
195500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       20400001
195600                                                                  20410001
195700             PERFORM 4410-READ-TEMP-STORAGE                       20420001
195800                                                                  20430001
195900             PERFORM 2151-SET-SELECTED-INDS                       20440001
196000                 VARYING ASC-ITEM-SUB                             20450001
196100                 FROM 1 BY 1                                      20460001
196200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20470001
196300                                                                  20480001
196400             PERFORM 5100-WRITE-TEMP-STORAGE                      20490001
196500                                                                  20500001
196600             ADD +1                TO PV-BLOCK-NUMBER             20510001
196700                                                                  20520001
196800         END-PERFORM                                              20530001
196900                                                                  20540001
197000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         20550001
197100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     20560001
197200                                                                  20570001
197300         PERFORM                                                  20580001
197400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       20590001
197500                   ASC-HIGHEST-BLOCK-WRITTEN                      20600001
197600                                                                  20610001
197700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          20620001
197800                                   TO PV-BLOCK-NUMBER             20630001
197900                                                                  20640001
198000             PERFORM 4410-READ-TEMP-STORAGE                       20650001
198100                                                                  20660001
198200             PERFORM 2151-SET-SELECTED-INDS                       20670001
198300                 VARYING ASC-ITEM-SUB                             20680001
198400                 FROM 1 BY 1                                      20690001
198500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20700001
198600                                                                  20710001
198700             PERFORM 5100-WRITE-TEMP-STORAGE                      20720001
198800                                                                  20730001
198900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      20740001
199000                                                                  20750001
199100         END-PERFORM                                              20760001
199200                                                                  20770001
199300         MOVE PV-FIRST-BLOCK-IN-ARRAY  TO PV-BLOCK-NUMBER         20780001
199400                                                                  20790001
199500         PERFORM 4410-READ-TEMP-STORAGE                           20800001
199600     END-IF.                                                      20810001
199700                                                                  20820001
199800     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             20830001
199900                       ASC-NUMBER-OF-SELECTED-ITEMS.              20840001
200000                                                                  20850001
200100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        20860001
200200                                                                  20870001
200300*----------------------------------------------------------------*20880001
200400*    MARK EACH ITEM AS BEING SELECTED.                           *20890001
200500*----------------------------------------------------------------*20900001
200600 2151-SET-SELECTED-INDS.                                          20910001
200700     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           20920001
200800             NOT EQUAL ZERO                                       20930001
200900         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             20940001
201000             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             20950001
201100                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        20960001
201200                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  20970001
201300                               TO  TRUE                           20980001
201400         END-IF                                                   20990001
201500     END-IF.                                                      21000001
201600                                                                  21010001
201700******************************************************************21020001
201800** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **21030001
201900** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **21040001
202000******************************************************************21050001
202100 2200-MOVE-SCREEN-TO-COMMAREA.                                    21060001
202200                                                                  21070001
202300     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             21080001
202400     MOVE +1                       TO PV-SUB.                     21090001
202500*                                                                 21100001
202600     PERFORM 3100-SET-SUBSCRIPTS.                                 21110001
202700                                                                  21120001
202800     IF  ASTRTITL > ZERO                                          21130001
202900         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          21140001
203000     ELSE                                                         21150001
203100         IF  ASTRTITF = DP015-ERASE-EOF                           21160001
203200             INITIALIZE ASC-START-ITEM-REQUEST                    21170001
203300         END-IF                                                   21180001
203400     END-IF.                                                      21190001
203500                                                                  21200001
203600     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          21210001
203700         VARYING PV-SUB FROM 1 BY 1                               21220001
203800         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      21230001
203900                                                                  21240001
204000******************************************************************21250001
204100** MOVE THE ENTERABLE FIELDS OF EACH LIST LINE INTO THE COMMAREA**21260001
204200******************************************************************21270001
204300 2210-MOVE-LINES-TO-COMMAREA.                                     21280001
206100                                                                  21290099
206110     IF  MR-SELECTL (PV-SUB) > ZERO                               21300099
206120         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             21310099
206130         MOVE MR-SELECTI (PV-SUB)  TO ASC-TEMP-SELECTED-SW        21320099
206140                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 21330099
206150     ELSE                                                         21340099
206160         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                21350099
206170                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     21360099
206180                 MOVE SPACE  TO ASC-TEMP-SELECTED-SW              21370099
206190                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 21380099
206191         END-IF                                                   21390099
206192     END-IF.                                                      21400099
206193                                                                  21410099
206194     ADD +1                        TO ASC-ITEM-SUB.               21420099
206195     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        21430099
206196         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     21440099
206197             COMPUTE PV-BLOCK-NUMBER  =                           21450099
206198                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         21460099
206199                    PC-ITEMS-PER-PANEL                            21470099
206200             PERFORM 5105-REWRITE-ASC-LISTQ                       21480099
206201         END-IF                                                   21490099
206202         ADD +1                    TO ASC-BLK-SUB                 21500099
206203         MOVE +1                   TO ASC-ITEM-SUB                21510099
206204     ELSE                                                         21520099
206206     IF  PV-SUB = ASC-ITEMS-DISPLAYED                             21530099
206207         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     21540099
206208             COMPUTE PV-BLOCK-NUMBER  =                           21550099
206209                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         21560099
206210                    PC-ITEMS-PER-PANEL                            21570099
206211             PERFORM 5105-REWRITE-ASC-LISTQ                       21580099
206212         END-IF                                                   21590099
206214     END-IF.                                                      21600099
206215                                                                  21610099
206220******************************************************************21620099
206300*                                                                 21630099
206400*                                                                 21640099
206500******************************************************************21650099
206600 2400-EDIT-FOR-UPDATE.                                            21660099
206700                                                                  21670099
206800     MOVE +1                       TO ASC-BLK-SUB.                21680099
206900     PERFORM 5100-WRITE-TEMP-STORAGE.                             21690099
207000     ADD +1                        TO ASC-BLK-SUB.                21700099
207100     PERFORM 5100-WRITE-TEMP-STORAGE.                             21710099
207200                                                                  21720099
207300     PERFORM 6112-READ-LIST-QUEUE.                                21730099
207400                                                                  21740099
207500     SET  LQW-IDX  TO   1.                                        21750099
207600                                                                  21760099
207700     IF PV-CICS-RESP = DFHRESP (NORMAL)                           21770099
207800         PERFORM                                                  21780099
207900         VARYING LQW-IDX  FROM 1 BY 1                             21790099
208000         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     21800099
208100            OR   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            21810099
208200            OR   PS-ERROR                                         21820099
208300             IF  LQW-SELECT (LQW-IDX)                             21830099
208400                 PERFORM 2420-PROCESS-SELECTIONS                  21840099
208500             END-IF                                               21850099
208600         END-PERFORM                                              21860099
208700     END-IF.                                                      21870099
208800                                                                  21880099
208900     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           21890099
209000     PERFORM 6111-WRITE-LIST-QUEUE.                               21900099
209100                                                                  21910099
209200     MOVE +1                     TO  ASC-BLK-SUB.                 21920099
209300     PERFORM 4410-READ-TEMP-STORAGE.                              21930099
209400                                                                  21940099
209500     ADD +1                      TO  ASC-BLK-SUB                  21950099
209600                                     PV-BLOCK-NUMBER.             21960099
209700                                                                  21970099
209800     PERFORM 4410-READ-TEMP-STORAGE.                              21980099
209900                                                                  21990099
210000******************************************************************22000099
210100*                                                                 22010099
210200*                                                                 22020099
210300******************************************************************22030099
210400 2420-PROCESS-SELECTIONS.                                         22040099
210500                                                                  22050099
210600     PERFORM 7400-BUILD-REQUEST.                                  22060099
210700     PERFORM 7500-CALL-SUKUT129.                                  22070099
210800                                                                  22080099
210900                                                                  22090099
211000******************************************************************22100001
211100** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **22110001
211200** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **22120001
211300******************************************************************22130001
211400 3000-EDIT-DATA-IN-COMMAREA.                                      22140001
211500     PERFORM 3200-RESET-ATTRIBUTES.                               22150001
211600     SET PS-NO-ERROR               TO TRUE.                       22160001
211700     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     22170001
211800                                                                  22180001
211900* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              22190001
212000* EDITTING IS DONE FROM THE BOTTOM UP.                            22200001
212100**                                                                22210001
212200     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       22220001
212300         ASC-ITEMS-DISPLAYED - 1.                                 22230001
212400     PERFORM 3100-SET-SUBSCRIPTS.                                 22240001
212500                                                                  22250001
212600      IF  PS-NO-ERROR                                             22260001
212700          PERFORM 3005-EDIT-COMMAREA-BLOCKS                       22270001
212800      END-IF.                                                     22280001
212900                                                                  22290001
213000     IF  PS-NO-ERROR                                              22300001
213100         PERFORM 3400-CHECK-RANGE-SEQUENCE                        22310001
213200     END-IF.                                                      22320001
213300                                                                  22330001
213400     IF  ((PS-NO-ERROR)                                           22340001
213500       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   22350001
213600       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    22360001
213700             PERFORM 3500-MARK-RANGE-AS-SELECTED                  22370001
213800     END-IF.                                                      22380001
213900                                                                  22390001
214000*----------------------------------------------------------------*22400001
214100* 3005-EDIT-COMMAREA-BLOCKS                                      *22410001
214200*----------------------------------------------------------------*22420001
214300 3005-EDIT-COMMAREA-BLOCKS.                                       22430001
214400     MOVE +1                       TO PV-BLOCK-NUMBER.            22440001
214500     MOVE +1                       TO ASC-BLK-SUB.                22450001
214600     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               22460001
214700                                                                  22470001
214800     COMPUTE PV-BLOCK-NUMBER  =                                   22480001
214900             1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /            22490001
215000             PC-ITEMS-PER-PANEL.                                  22500001
215100                                                                  22510001
215200     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          22520001
215300                                                                  22530001
215400     PERFORM                                                      22540001
215500        UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN         22550001
215600           OR PS-ERROR                                            22560001
215700           OR PS-BLOCK-ERROR                                      22570001
215800                                                                  22580001
215900              COMPUTE PV-ITEMS-HOLD  =                            22590001
216000                      ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +       22600001
216100                      PC-ITEMS-PER-PANEL - 1                      22610001
216200                                                                  22620001
216300               IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ     22630001
216400                   SUBTRACT  ASC-NUMBER-OF-ITEMS-READ             22640001
216500                       FROM  PV-ITEMS-HOLD                        22650001
216600                     GIVING  PV-ITEMS-DIFF                        22660001
216700                   SUBTRACT  PV-ITEMS-DIFF                        22670001
216800                       FROM  PC-ITEMS-PER-PANEL                   22680001
216900                     GIVING  PV-ITEMS-HOLD                        22690001
217000                       MOVE  PV-ITEMS-HOLD TO PV-SUB              22700001
217100                                              ASC-ITEM-SUB        22710001
217200                                              ASC-ITEMS-DISPLAYED 22720001
217300               ELSE                                               22730001
217400                   MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB            22740001
217500                   MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB      22750001
217600               END-IF                                             22760001
217700                                                                  22770001
217800               PERFORM 3300-EDIT-SELECTIONS                       22780001
217900                       VARYING PV-SUB                             22790001
218000                          FROM PV-SUB BY -1                       22800001
218100                          UNTIL PV-SUB < +1                       22810001
218200                                                                  22820001
218300               MOVE +1               TO ASC-BLK-SUB               22830001
218400                                                                  22840001
218500               PERFORM 5105-REWRITE-ASC-LISTQ                     22850001
218600                                                                  22860001
218700               MOVE +1                TO ASC-BLK-SUB              22870001
218800                                                                  22880001
218900               IF  PS-BLOCK-ERROR                                 22890001
219000                   SET  PS-ERROR     TO TRUE                      22900001
219100                   MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)      22910001
219200                                     TO PV-TOP-ITEM               22920001
219300               ELSE                                               22930001
219400                   ADD  +1           TO PV-BLOCK-NUMBER           22940001
219500                   IF  PV-BLOCK-NUMBER >                          22950001
219600                       ASC-HIGHEST-BLOCK-WRITTEN                  22960001
219700                       MOVE +2       TO ASC-BLK-SUB               22970001
219800                       PERFORM 4410-READ-TEMP-STORAGE             22980001
219900                       MOVE +1       TO ASC-BLK-SUB               22990001
220000                   ELSE                                           23000001
220100                       PERFORM 4410-READ-TEMP-STORAGE             23010001
220200                       ADD  +1        TO PV-BLOCK-NUMBER          23020001
220300                       MOVE +2        TO ASC-BLK-SUB              23030001
220400                       PERFORM 4410-READ-TEMP-STORAGE             23040001
220500                       SUBTRACT +1  FROM PV-BLOCK-NUMBER          23050001
220600                       MOVE +1        TO ASC-BLK-SUB              23060001
220700               END-IF                                             23070001
220800           END-IF                                                 23080001
220900     END-PERFORM.                                                 23090001
221000                                                                  23100001
221100     IF  (PV-ORIGINAL-BLOCK  = +1   AND                           23110001
221200          ASC-LIST-ITEM-NUMBER (1 1) = 1)  OR                     23120001
221300         PS-ERROR                   OR                            23130001
221400         PS-BLOCK-ERROR                                           23140001
221500             CONTINUE                                             23150001
221600     ELSE                                                         23160001
221700         MOVE +1                 TO PV-BLOCK-NUMBER               23170001
221800         MOVE +1                 TO ASC-BLK-SUB                   23180001
221900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  23190001
222000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           23200001
222100         PERFORM 4410-READ-TEMP-STORAGE                           23210001
222200                                                                  23220001
222300         PERFORM                                                  23230001
222400            UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK             23240001
222500               OR PS-ERROR                                        23250001
222600               OR PS-BLOCK-ERROR                                  23260001
222700                                                                  23270001
222800                  COMPUTE PV-ITEMS-HOLD  =                        23280001
222900                          ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +   23290001
223000                          PC-ITEMS-PER-PANEL - 1                  23300001
223100                                                                  23310001
223200                  IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ    23320001
223300                      SUBTRACT  ASC-NUMBER-OF-ITEMS-READ          23330001
223400                          FROM  PV-ITEMS-HOLD                     23340001
223500                        GIVING  PV-ITEMS-DIFF                     23350001
223600                      SUBTRACT  PV-ITEMS-DIFF                     23360001
223700                          FROM  PC-ITEMS-PER-PANEL                23370001
223800                        GIVING  PV-ITEMS-HOLD                     23380001
223900                          MOVE  PV-ITEMS-HOLD TO PV-SUB           23390001
224000                                                 ASC-ITEM-SUB     23400001
224100                                              ASC-ITEMS-DISPLAYED 23410001
224200                  ELSE                                            23420001
224300                      MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB         23430001
224400                      MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB   23440001
224500                  END-IF                                          23450001
224600                                                                  23460001
224700                  PERFORM 3300-EDIT-SELECTIONS                    23470001
224800                          VARYING PV-SUB                          23480001
224900                             FROM PV-SUB BY -1                    23490001
225000                            UNTIL PV-SUB < +1                     23500001
225100                                                                  23510001
225200                  MOVE +1               TO ASC-BLK-SUB            23520001
225300                                                                  23530001
225400                  PERFORM 5105-REWRITE-ASC-LISTQ                  23540001
225500                                                                  23550001
225600                  MOVE +1                TO ASC-BLK-SUB           23560001
225700                                                                  23570001
225800                  IF  PS-BLOCK-ERROR                              23580001
225900                      SET  PS-ERROR     TO TRUE                   23590001
226000                      MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)   23600001
226100                                        TO PV-TOP-ITEM            23610001
226200                  ELSE                                            23620001
226300                      ADD  +1            TO PV-BLOCK-NUMBER       23630001
226400                      IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK     23640001
226500                          MOVE +2        TO ASC-BLK-SUB           23650001
226600                          PERFORM 4410-READ-TEMP-STORAGE          23660001
226700                          MOVE +1        TO ASC-BLK-SUB           23670001
226800                      ELSE                                        23680001
226900                          PERFORM 4410-READ-TEMP-STORAGE          23690001
227000                          ADD  +1        TO PV-BLOCK-NUMBER       23700001
227100                          MOVE +2        TO ASC-BLK-SUB           23710001
227200                          PERFORM 4410-READ-TEMP-STORAGE          23720001
227300                          SUBTRACT +1  FROM PV-BLOCK-NUMBER       23730001
227400                          MOVE +1        TO ASC-BLK-SUB           23740001
227500                      END-IF                                      23750001
227600                  END-IF                                          23760001
227700     END-PERFORM.                                                 23770001
227800     MOVE +0 TO PV-ITEMS-HOLD.                                    23780001
227900                                                                  23790001
228000*----------------------------------------------------------------*23800001
228100*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *23810001
228200*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*23820001
228300*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *23830001
228400*                                                                *23840001
228500*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *23850001
228600*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *23860001
228700*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *23870001
228800*    US IN THE 2ND BLOCK OF THE ARRAY.                           *23880001
228900*----------------------------------------------------------------*23890001
229000 3100-SET-SUBSCRIPTS.                                             23900001
229100     COMPUTE ASC-ITEM-SUB =                                       23910001
229200         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        23920001
229300                                                                  23930001
229400     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         23940001
229500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            23950001
229600         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               23960001
229700     ELSE                                                         23970001
229800         MOVE +1                     TO ASC-BLK-SUB               23980001
229900     END-IF.                                                      23990001
230000                                                                  24000001
230100******************************************************************24010001
230200** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **24020001
230300******************************************************************24030001
230400 3200-RESET-ATTRIBUTES.                                           24040001
230500     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   24050001
230600     MOVE DP015-GREEN              TO ASTRTITC.                   24060001
230700     MOVE DP015-UNDERLINE          TO ASTRTITH.                   24070001
230800                                                                  24080001
230900     PERFORM                                                      24090001
231000         VARYING PV-SUB                                           24100001
231100         FROM 1 BY 1                                              24110001
231200         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        24120001
231300                                                                  24130001
231310         IF ( PV-SUB > ASC-ITEMS-DISPLAYED )                      24140099
231311             MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)       24150099
231312             MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)       24160099
231313             MOVE SPACES             TO MR-SELECTI (PV-SUB)       24170099
231320         ELSE                                                     24180099
231400             MOVE DP015-UNP-ALP-NOR-OFF TO MR-SELECTA (PV-SUB)    24190099
231500             MOVE DP015-GREEN           TO MR-SELECTC (PV-SUB)    24200099
231600             MOVE DP015-UNDERLINE       TO MR-SELECTH (PV-SUB)    24210099
231640         END-IF                                                   24220099
231700                                                                  24230001
231800     END-PERFORM.                                                 24240001
231900                                                                  24250001
232000******************************************************************24260001
232100** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **24270001
232200** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **24280001
232300** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **24290001
232400** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **24300001
232500******************************************************************24310001
232600 3300-EDIT-SELECTIONS.                                            24320001
232700     EVALUATE TRUE                                                24330001
232800         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     24340001
232900             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         24350001
233000                 CONTINUE                                         24360001
233100         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         24370001
233200             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        24380001
233300                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   24390001
233400                 MOVE ASC-TEMP-SELECTED-SW                        24400001
233500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24410001
233600                                TO ASC-SELECTED-SW                24420001
233700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24430001
233800             END-IF                                               24440001
233900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     24450001
234000                 = SPACE                                          24460001
234100             EVALUATE TRUE                                        24470001
234200                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       24480001
234300                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS24490001
234400                     MOVE SPACE TO ASC-SELECTED-SW                24500001
234500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24510001
234600                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        24520001
234700                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    24530001
234800                     MOVE SPACE TO ASC-SELECTED-SW                24540001
234900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24550001
235000                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          24560001
235100                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      24570001
235200                     MOVE SPACE TO ASC-SELECTED-SW                24580001
235300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24590001
235400             END-EVALUATE                                         24600001
235500         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           24610001
235600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            24620001
235700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    24630001
235800             END-IF                                               24640001
235900             PERFORM 3310-EDIT-RANGE                              24650001
236000         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             24660001
236100             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            24670001
236200                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    24680001
236300             END-IF                                               24690001
236400             PERFORM 3310-EDIT-RANGE                              24700001
236500         WHEN OTHER                                               24710001
236600             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           24720001
236700             SET DP020-MSG-FATAL    TO TRUE                       24730001
236800             MOVE -1                TO ASTRTITL                   24740001
236900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  24750001
237000*            MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        24760001
237100*            MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        24770001
237200             SET PS-ERROR TO TRUE                                 24780001
237300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            24790001
237400                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     24800001
237500                 MOVE SPACE         TO ASC-SELECTED-SW            24810001
237600                                        (ASC-BLK-SUB ASC-ITEM-SUB)24820001
237700             END-IF                                               24830001
237800     END-EVALUATE.                                                24840001
237900                                                                  24850001
238000     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 24860001
238100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               24870001
238200     IF  ASC-ITEM-SUB < 1                                         24880001
238300         SUBTRACT +1 FROM ASC-BLK-SUB                             24890001
238400         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                24900001
238500     END-IF.                                                      24910001
238600                                                                  24920001
238700******************************************************************24930001
238800** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **24940001
238900** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **24950001
239000** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**24960001
239100** THE ENDING.                                                  **24970001
239200******************************************************************24980001
239300 3310-EDIT-RANGE.                                                 24990001
239400     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                25000001
239500         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   25010001
239600             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)25020001
239700                                   TO ASC-SELECTED-SW             25030001
239800                                        (ASC-BLK-SUB ASC-ITEM-SUB)25040001
239900             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 25050001
240000         ELSE                                                     25060001
240100             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     25070001
240200                 CONTINUE                                         25080001
240300             ELSE                                                 25090001
240400*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        25100001
240500                 MOVE PC-TSYMSG-00054                             25110001
240600                                   TO DP020-MSG-NUMBER            25120001
240700                 SET DP020-MSG-FATAL                              25130001
240800                                   TO TRUE                        25140001
240900                 MOVE -1           TO ASTRTITL                    25150001
241000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              25160001
241100                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         25170001
241200                 MOVE DP015-UNDERLINE TO MR-SELECTH (PV-SUB)      25180001
241300                 SET PS-ERROR      TO TRUE                        25190001
241400             END-IF                                               25200001
241500         END-IF                                                   25210001
241600     ELSE                                                         25220001
241700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     25230001
241800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 25240001
241900                                   TO ASC-SELECTED-SW             25250001
242000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   25260001
242100             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   25270001
242200         ELSE                                                     25280001
242300             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       25290001
242400                 CONTINUE                                         25300001
242500             ELSE                                                 25310001
242600*                -- ONLY ONE END-OF-RANGE ALLOWED --              25320001
242700                 MOVE PC-TSYMSG-00055                             25330001
242800                                   TO DP020-MSG-NUMBER            25340001
242900                 SET DP020-MSG-FATAL                              25350001
243000                                   TO TRUE                        25360001
243100                 MOVE -1           TO ASTRTITL                    25370001
243200                 SET DP030-SET-CURSOR-APPL-1                      25380001
243300                                   TO TRUE                        25390001
243400                 SET PS-ERROR      TO TRUE                        25400001
243500             END-IF                                               25410001
243600         END-IF                                                   25420001
243700     END-IF.                                                      25430001
243800*                                                                 25440001
243900******************************************************************25450001
244000** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **25460001
244100** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **25470001
244200******************************************************************25480001
244300 3400-CHECK-RANGE-SEQUENCE.                                       25490001
244400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       25500001
244500       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      25510001
244600       AND  ASC-START-OF-SELECTED-RANGE >                         25520001
244700                                         ASC-END-OF-SELECTED-RANGE25530001
244800*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                25540001
244900         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 25550001
245000         SET DP020-MSG-FATAL TO TRUE                              25560001
245100         SET PS-ERROR TO TRUE                                     25570001
245200         PERFORM 3410-POSITION-AT-ERROR                           25580001
245300     END-IF.                                                      25590001
245400                                                                  25600001
245500******************************************************************25610001
245600** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **25620001
245700** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **25630001
245800** SHOULD BE POSITIONED ON A RANGE ERROR.                       **25640001
245900******************************************************************25650001
246000 3410-POSITION-AT-ERROR.                                          25660001
246100     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       25670001
246200     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 25680001
246300                    - PV-TOP-ITEM + 1.                            25690001
246400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25700001
246500         CONTINUE                                                 25710001
246600     ELSE                                                         25720001
246700         MOVE -1                   TO MR-SELECTL (PV-SUB)         25730001
246800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         25740001
246900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         25750001
247000     END-IF.                                                      25760001
247100                                                                  25770001
247200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   25780001
247300                    - PV-TOP-ITEM + 1.                            25790001
247400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25800001
247500         CONTINUE                                                 25810001
247600     ELSE                                                         25820001
247700         MOVE -1                   TO MR-SELECTL (PV-SUB)         25830001
247800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         25840001
247900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         25850001
248000     END-IF.                                                      25860001
248100                                                                  25870001
248200*----------------------------------------------------------------*25880001
248300*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *25890001
248400*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *25900001
248500*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *25910001
248600*----------------------------------------------------------------*25920001
248700 3500-MARK-RANGE-AS-SELECTED.                                     25930001
248800     MOVE +1                       TO  ASC-BLK-SUB.               25940001
248900     PERFORM 3510-MARK-SELECTED-INDS                              25950001
249000         VARYING ASC-ITEM-SUB                                     25960001
249100         FROM 1 BY 1                                              25970001
249200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 25980001
249300                                                                  25990001
249400     ADD +1                        TO ASC-BLK-SUB.                26000001
249500     PERFORM 3510-MARK-SELECTED-INDS                              26010001
249600         VARYING ASC-ITEM-SUB                                     26020001
249700         FROM 1 BY 1                                              26030001
249800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 26040001
249900                                                                  26050001
250000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               26060001
250100                                   TO  PV-LIST-ITEM-NUMBER.       26070001
250200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            26080001
250300         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         26090001
250400               PC-ITEMS-PER-PANEL).                               26100001
250500                                                                  26110001
250600     MOVE ASC-START-OF-SELECTED-RANGE                             26120001
250700                                   TO PV-START-OF-SELECTED-RANGE. 26130001
250800     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            26140001
250900         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  26150001
251000               PC-ITEMS-PER-PANEL).                               26160001
251100                                                                  26170001
251200     MOVE ASC-END-OF-SELECTED-RANGE                               26180001
251300                                   TO  PV-END-OF-SELECTED-RANGE.  26190001
251400     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             26200001
251500         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    26210001
251600               PC-ITEMS-PER-PANEL).                               26220001
251700     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             26230001
251800         PV-FIRST-BLOCK-IN-ARRAY + 1.                             26240001
251900                                                                  26250001
252000     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    26260001
252100        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        26270001
252200         MOVE +1                   TO ASC-BLK-SUB                 26280001
252300         PERFORM 5100-WRITE-TEMP-STORAGE                          26290001
252400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         26300001
252500             PV-FIRST-BLOCK-IN-ARRAY - 1                          26310001
252600                                                                  26320001
252700         PERFORM                                                  26330001
252800             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      26340001
252900                   PV-PREV-BLOCK-IN-ARRAY                         26350001
253000             MOVE PV-FIRST-BLOCK-IN-RANGE                         26360001
253100                                   TO PV-BLOCK-NUMBER             26370001
253200             PERFORM 4410-READ-TEMP-STORAGE                       26380001
253300             PERFORM 3510-MARK-SELECTED-INDS                      26390001
253400                 VARYING ASC-ITEM-SUB                             26400001
253500                 FROM 1 BY 1                                      26410001
253600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          26420001
253700             PERFORM 5100-WRITE-TEMP-STORAGE                      26430001
253800             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     26440001
253900         END-PERFORM                                              26450001
254000                                                                  26460001
254100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         26470001
254200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     26480001
254300         PERFORM                                                  26490001
254400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       26500001
254500                   PV-LAST-BLOCK-IN-RANGE                         26510001
254600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          26520001
254700                                   TO PV-BLOCK-NUMBER             26530001
254800             PERFORM 4410-READ-TEMP-STORAGE                       26540001
254900             PERFORM 3510-MARK-SELECTED-INDS                      26550001
255000                 VARYING ASC-ITEM-SUB                             26560001
255100                 FROM 1 BY 1                                      26570001
255200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          26580001
255300             PERFORM 5100-WRITE-TEMP-STORAGE                      26590001
255400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      26600001
255500         END-PERFORM                                              26610001
255600                                                                  26620001
255700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             26630001
255800                                   TO PV-BLOCK-NUMBER             26640001
255900         PERFORM 4410-READ-TEMP-STORAGE                           26650001
256000     END-IF.                                                      26660001
256100                                                                  26670001
256200     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 26680001
256300                                      ASC-END-OF-SELECTED-RANGE.  26690001
256400                                                                  26700001
256500*----------------------------------------------------------------*26710001
256600* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *26720001
256700*----------------------------------------------------------------*26730001
256800 3510-MARK-SELECTED-INDS.                                         26740001
256900     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         26750001
257000                                ASC-ITEM-SUB) >                   26760001
257100         ASC-START-OF-SELECTED-RANGE)                             26770001
257200     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         26780001
257300                                ASC-ITEM-SUB) =                   26790001
257400         ASC-START-OF-SELECTED-RANGE)                             26800001
257500                                                                  26810001
257600         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     26820001
257700                                    ASC-ITEM-SUB) <               26830001
257800             ASC-END-OF-SELECTED-RANGE)                           26840001
257900         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     26850001
258000                                    ASC-ITEM-SUB) =               26860001
258100             ASC-END-OF-SELECTED-RANGE)                           26870001
258200                                                                  26880001
258300             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          26890001
258400                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   26900001
258500                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   26910001
258600                               TO TRUE                            26920001
258700                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              26930001
258800                               TO TRUE                            26940001
258900                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    26950001
259000             END-IF                                               26960001
259100         END-IF                                                   26970001
259200     END-IF.                                                      26980001
259300                                                                  26990001
259400*----------------------------------------------------------------*27000001
259500*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *27010001
259600*    INITIALIZE ALL COUNTERS AND FLAGS.                          *27020001
259700*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *27030001
259800*    DISPLAY THE PANEL TO USER.                                  *27040001
259900*----------------------------------------------------------------*27050001
260000 4000-BUILD-INITIAL-PANEL.                                        27060001
260100     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            27070001
260200                                 ASC-BLOCK-ENTRIES (2).           27080001
260300     MOVE +1                   TO ASC-BLK-SUB.                    27090001
260400     SET ASC-ITEMS-LEFT-ON-DB  TO TRUE.                           27100001
260500                                                                  27110001
260600     MOVE +0                 TO ASC-ITEM-SUB                      27120001
260700                                ASC-NUMBER-OF-ITEMS-READ          27130001
260800                                ASC-NUMBER-OF-SELECTED-ITEMS      27140001
260900                                ASC-HIGHEST-BLOCK-WRITTEN         27150001
261000                                ASC-START-OF-SELECTED-RANGE       27160001
261100                                ASC-END-OF-SELECTED-RANGE         27170001
261200                                ASC-ITEM-AT-TOP-OF-PANEL.         27180001
261300                                                                  27190001
261400     PERFORM 4100-PREPARE-CURSOR.                                 27200001
261500     PERFORM 4120-OPEN-CURSOR.                                    27210099
261600     PERFORM 4300-READ-ITEMS-FROM-DB.                             27220001
261700     PERFORM 4140-CLOSE-CURSOR.                                   27230001
261800                                                                  27240001
261900     MOVE +1                   TO  PV-TOP-ITEM.                   27250001
262000     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          27260001
262100**?? IR 17887 WHEN COMING FROM SUKCS772 AND ONLY 1 ITEM WAS       27270099
262200**??          SELECTED, IF THERE AREN'T ANY ITEMS FOUND, RETURN   27280099
262210**??          TO SUKCS772 WITH ERROR MESSAGE OTHERWISE STAY ON    27290099
262220**??          SCREEN.                                             27300099
262240        IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT OR    27310099
262250           (DP020-INT-APPL-FORMAT-IND = '2' AND                   27320099
262260            ASC-USE-SELECTION-QUEUE         AND                   27330099
262270            SU098-NUMBER-OF-SELECTED-ITEMS = 1)                   27340099
262280            IF DP020-MSG-NUMBER  =  PC-TSYMSG-03657               27350099
262290               CONTINUE                                           27360099
262291            ELSE                                                  27370099
262300               SET DP020-NEXT-ACT-APPL-ERROR TO TRUE              27380099
262400               SET DP020-MSG-FATAL   TO  TRUE                     27390099
262500               MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER         27400099
262510            END-IF                                                27410099
262600        ELSE                                                      27420099
262601**??        STAY ON THIS SCREEN IF MORE THAN 1 LINE HAD BEEN      27430099
262602**??        SELECTED ON SUKCS772                                  27440099
262604            MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER            27450099
262605            SET DP020-MSG-WARNING TO TRUE                         27460099
262606            SET PS-ERROR          TO TRUE                         27470099
262607            PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                  27480099
262608        END-IF                                                    27490099
262610     ELSE                                                         27500099
262700         MOVE -1               TO MR-SELECTL (1)                  27510001
262800         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      27520001
262900         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     27530001
263000     END-IF.                                                      27540001
263100                                                                  27550001
263200*----------------------------------------------------------------*27560001
263300* OPEN THE CURSOR.                                               *27570001
263400*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *27580001
263500*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *27590001
263600*   ASSOCIATE.                                                   *27600001
263700*----------------------------------------------------------------*27610001
263800 4120-OPEN-CURSOR.                                                27620001
263900     PERFORM                                                      27630001
264000         WITH TEST AFTER                                          27640001
264100         VARYING PV-RETRY-COUNTER                                 27650001
264200         FROM 1 BY 1                                              27660001
264300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27670001
264400                   OR (SQLCODE = ZERO))                           27680001
264500                                                                  27690001
264600         MOVE 'CURSOR:  DOOR-CAPABLE-CSR '                        27700001
264700                               TO DP013-MESSAGE-TEXT (2)          27710001
264800         EVALUATE TRUE                                            27720038
264900             WHEN ASC-RQST-BAR-CODE                               27730038
265000                  EXEC SQL                                        27740099
265100                       OPEN  BAR-CODE-CSR                         27750099
265200                  END-EXEC                                        27760099
265300                                                                  27770038
265400             WHEN ASC-RQST-PO-RCVR                                27780038
265500                  EXEC SQL                                        27790038
265600                       OPEN  PO-RCVR-CSR                          27800038
265700                  END-EXEC                                        27810038
265800                                                                  27820038
265900             WHEN ASC-RQST-PO-RCVR-PREPK                          27830038
266000                  EXEC SQL                                        27840038
266100                       OPEN  PO-RCVR-PREPK-CSR                    27850079
266200                  END-EXEC                                        27860038
266300                                                                  27870038
266400             WHEN ASC-RQST-PO-RCVR-LINE                           27880038
266500                  EXEC SQL                                        27890038
266600                       OPEN  PO-RCVR-LINE-CSR                     27900079
266700                  END-EXEC                                        27910038
266800                                                                  27920038
266900             WHEN ASC-RQST-AUDIT                                  27930038
267000                  EXEC SQL                                        27940038
267100                       OPEN  AUDIT-CSR                            27950099
267200                  END-EXEC                                        27960038
267300                                                                  27970038
267400         END-EVALUATE                                             27980038
267500                                                                  27990038
267600         EVALUATE TRUE                                            28000001
267700             WHEN SQLCODE = ZERO                                  28010001
267800             WHEN SQLCODE = -904                                  28020001
267900             WHEN SQLCODE = -913                                  28030001
268000                 CONTINUE                                         28040001
268100             WHEN SQLWARN0 NOT = SPACES                           28050001
268200             WHEN SQLCODE < ZERO                                  28060001
268300             WHEN SQLCODE > ZERO                                  28070001
268400                 MOVE '4120-OPEN-CURSOR' TO DP013-PARAGRAPH       28080001
268500                 MOVE 'UNABLE TO OPEN A CURSOR -'                 28090001
268600                                   TO DP013-MESSAGE-TEXT (1)      28100001
268700                 MOVE SQLCA        TO DP013-SQLCA                 28110001
268800                 MOVE 'SUT-CART-DIRV-TRKG' TO                     28120099
268810                                      DP013-DB2-TABLE-NAME (1)    28130099
268900                 SET DP013-DB2-ABEND                              28140001
269000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           28150001
269100                 PERFORM DP013-0000-PROCESS-ABEND                 28160001
269200         END-EVALUATE                                             28170001
269300     END-PERFORM.                                                 28180001
269400                                                                  28190001
269500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28200001
269600         MOVE '4120-OPEN-CURSOR'   TO DP013-PARAGRAPH             28210001
269700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   28220001
269800                                   TO DP013-MESSAGE-TEXT (1)      28230001
269900         MOVE SQLCA                TO DP013-SQLCA                 28240001
269901         MOVE 'SUT-CART-DIRV-TRKG' TO                             28250099
269920                                      DP013-DB2-TABLE-NAME (1)    28260099
270100         SET DP013-DB2-ABEND                                      28270001
270200             DP013-XCTL-DISPLAY-RESTART TO TRUE                   28280001
270300         PERFORM DP013-0000-PROCESS-ABEND                         28290001
270400     END-IF.                                                      28300001
270500                                                                  28310001
270600*----------------------------------------------------------------*28320001
270700* CLOSE THE CURSOR                                               *28330001
270800*----------------------------------------------------------------*28340001
270900 4140-CLOSE-CURSOR.                                               28350001
271000                                                                  28360001
271100         EVALUATE TRUE                                            28370038
271200             WHEN ASC-RQST-BAR-CODE                               28380038
271300                  EXEC SQL                                        28390099
271400                      CLOSE  BAR-CODE-CSR                         28400099
271500                  END-EXEC                                        28410099
271600                                                                  28420038
271700             WHEN ASC-RQST-PO-RCVR                                28430038
271800                  EXEC SQL                                        28440038
271900                       CLOSE PO-RCVR-CSR                          28450038
272000                  END-EXEC                                        28460038
272100                                                                  28470038
272200             WHEN ASC-RQST-PO-RCVR-PREPK                          28480038
272300                  EXEC SQL                                        28490038
272400                       CLOSE PO-RCVR-PREPK-CSR                    28500079
272500                  END-EXEC                                        28510038
272600                                                                  28520038
272700             WHEN ASC-RQST-PO-RCVR-LINE                           28530038
272800                  EXEC SQL                                        28540038
272900                       CLOSE PO-RCVR-LINE-CSR                     28550079
273000                  END-EXEC                                        28560038
273100                                                                  28570038
273200             WHEN ASC-RQST-AUDIT                                  28580038
273300                  EXEC SQL                                        28590038
273400                       CLOSE AUDIT-CSR                            28600099
273500                  END-EXEC                                        28610038
273600                                                                  28620038
273700         END-EVALUATE                                             28630038
273800                                                                  28640001
273900     EVALUATE TRUE                                                28650001
274000         WHEN SQLCODE = ZERO                                      28660001
274100             CONTINUE                                             28670001
274200         WHEN SQLWARN0 NOT = SPACES                               28680001
274300         WHEN SQLCODE < ZERO                                      28690001
274400         WHEN SQLCODE > ZERO                                      28700001
274500             MOVE '4140-CLOSE-CURSOR' TO DP013-PARAGRAPH          28710001
274600             MOVE 'UNABLE TO CLOSE CURSOR '                       28720001
274700                               TO DP013-MESSAGE-TEXT (1)          28730001
274800             MOVE SQLCA        TO DP013-SQLCA                     28740001
275010             MOVE 'SUT-CART-DIRV-TRKG' TO                         28750099
275020                                      DP013-DB2-TABLE-NAME (1)    28760099
275100             SET DP013-DB2-ABEND                                  28770001
275200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               28780001
275300             PERFORM DP013-0000-PROCESS-ABEND                     28790001
275400     END-EVALUATE.                                                28800001
275500                                                                  28810001
275600*----------------------------------------------------------------*28820001
275700*    SET UP THE HOST VARIABLES.                                  *28830001
275800*----------------------------------------------------------------*28840001
275900 4100-PREPARE-CURSOR.                                             28850001
276000                                                                  28860001
276100     MOVE ASC-OPER-UNT-ID      TO  DK-OPER-UNT-ID.                28870001
276200     MOVE ASC-PO-NBR           TO  DK-PO-NBR.                     28880020
276300     MOVE ASC-REC-SEQ-NBR      TO  DK-REC-SEQ-NBR.                28890055
276400     MOVE ASC-PO-LNE-NBR       TO  DK-PO-LNE-NBR.                 28900099
276500     MOVE ASC-PREPACK-ID       TO  DK-PREPK-ID.                   28910099
276600                                                                  28920001
276700     MOVE ASC-AUDIT-CNTL-NBR   TO  DK-AUD-CNTL-NBR.               28930099
276800     MOVE ASC-BRCDE-NBR        TO  DK-BRCDE-NBR.                  28940099
276900                                                                  28950099
276920     PERFORM 7100-DIRECTIVES-AVAIL.                               28960099
277000                                                                  28970001
277100                                                                  28980001
277200*----------------------------------------------------------------*28990001
277300*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *29000001
277400*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *29010001
277500*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *29020001
277600*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *29030001
277700*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *29040001
277800*                                                                *29050001
277900*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *29060001
278000*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *29070001
278100*    UPON INITIALIZATION.                                        *29080001
278200*----------------------------------------------------------------*29090001
278300 4300-READ-ITEMS-FROM-DB.                                         29100001
278400     PERFORM                                                      29110001
278500         VARYING PV-READ-COUNT                                    29120001
278600         FROM 1 BY 1                                              29130001
278700         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    29140001
278800            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         29150001
278900                                                                  29160001
279000         PERFORM 4310-FETCH                                       29170001
279500                                                                  29180007
279600         IF  ASC-ITEMS-LEFT-ON-DB                                 29190007
279700             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                29200001
279800                 ADD +1            TO ASC-ITEM-SUB                29210001
279900             ELSE                                                 29220001
280000                 ADD +1            TO ASC-BLK-SUB                 29230001
280100                 MOVE +1           TO ASC-ITEM-SUB                29240001
280200                                                                  29250001
280300                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         29260001
280400                     MOVE +1       TO ASC-BLK-SUB                 29270001
280500                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           29280001
280600                     PERFORM 5100-WRITE-TEMP-STORAGE              29290001
280700                     MOVE ASC-BLOCK-ENTRIES                       29300001
280800                               (PC-MAX-BLOCKS-IN-ARRAY)           29310001
280900                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 29320001
281000                     ADD +1        TO ASC-BLK-SUB                 29330001
281100                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   29340001
281200                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      29350001
281300                                   TO TRUE                        29360001
281400                 END-IF                                           29370001
281500             END-IF                                               29380001
281600             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    29390001
281700             MOVE ASC-NUMBER-OF-ITEMS-READ                        29400001
281800                                   TO ASC-LIST-ITEM-NUMBER        29410001
281900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29420001
282000                                                                  29430018
282100             MOVE SUT00102-PREPK-ID         TO                    29440099
282200                    ASC-PREPK-ID       (ASC-BLK-SUB ASC-ITEM-SUB) 29450099
282300             MOVE SUT00102-PO-LNE-NBR       TO                    29460099
282400                    ASC-LNE-NBR        (ASC-BLK-SUB ASC-ITEM-SUB) 29470099
282500             MOVE SUT00102-BRCDE-NBR        TO                    29480027
282600                    ASC-BARCODE        (ASC-BLK-SUB ASC-ITEM-SUB) 29490027
282700             MOVE SUT00102-SHIPT-UNT-ID     TO                    29500087
282800                    ASC-SHIPT-UNT-ID   (ASC-BLK-SUB ASC-ITEM-SUB) 29510087
282900             IF SUT00102-SHIPT-UNT-ID = 0                         29520099
283000                MOVE 'P'  TO                                      29530099
283100                    ASC-BRCDE-TYPE     (ASC-BLK-SUB ASC-ITEM-SUB) 29540099
283200             ELSE                                                 29550099
283300                MOVE 'S'  TO                                      29560099
283400                    ASC-BRCDE-TYPE     (ASC-BLK-SUB ASC-ITEM-SUB) 29570099
283500             END-IF                                               29580099
283600**??         MOVE SULBXF-CART-LBL-TYP-CDE   TO                    29590099
283700**??                ASC-BRCDE-TYPE     (ASC-BLK-SUB ASC-ITEM-SUB) 29600099
283710             IF DN-CASI-CDE  = 0                                  29610099
283800                MOVE SUT00102-CASI-CDE      TO                    29620099
283900                    ASC-CASI           (ASC-BLK-SUB ASC-ITEM-SUB) 29630099
283901             ELSE                                                 29640099
283910                MOVE SPACES                 TO                    29650099
283920                    ASC-CASI           (ASC-BLK-SUB ASC-ITEM-SUB) 29660099
283930             END-IF                                               29670099
284000             MOVE PV-AUDIT-STATUS           TO                    29680098
284100                    ASC-AUD-STAT-CDE   (ASC-BLK-SUB ASC-ITEM-SUB) 29690055
284200             MOVE SUT00102-AUD-CNTL-NBR     TO                    29700018
284300                    ASC-AUD-CNTL-NBR   (ASC-BLK-SUB ASC-ITEM-SUB) 29710018
284400             MOVE SUT00102-CRE-TMST         TO                    29720099
284500                    ASC-DIRECTIVE-TMST (ASC-BLK-SUB ASC-ITEM-SUB) 29730018
284600             MOVE SUT00102-STR-NBR          TO                    29740099
284700                    ASC-STR-NBR        (ASC-BLK-SUB ASC-ITEM-SUB) 29750099
284710             IF DN-STR-ZN-ID = 0                                  29760099
284800                MOVE SUT00102-STR-ZN-ID     TO                    29770099
284900                    ASC-STR-ZN-ID      (ASC-BLK-SUB ASC-ITEM-SUB) 29780099
284901             ELSE                                                 29790099
284902                MOVE SPACES                 TO                    29800099
284903                    ASC-STR-ZN-ID      (ASC-BLK-SUB ASC-ITEM-SUB) 29810099
284904             END-IF                                               29820099
284910             IF DN-SEASET-YR = 0                                  29830099
285000                MOVE SUT00102-SEASET-YR     TO                    29840099
285100                    ASC-SEASET-YR      (ASC-BLK-SUB ASC-ITEM-SUB) 29850099
285110             ELSE                                                 29860099
285111                MOVE SPACES                 TO                    29870099
285112                    ASC-SEASET-YR      (ASC-BLK-SUB ASC-ITEM-SUB) 29880099
285120             END-IF                                               29890099
285130             IF DN-SEASET-SHRT-NM = 0                             29900099
285200                MOVE SUT00102-SEASET-SHRT-NM TO                   29910099
285300                    ASC-SEASET-SHRT-NM (ASC-BLK-SUB ASC-ITEM-SUB) 29920099
285301             ELSE                                                 29930099
285310                MOVE SPACES                  TO                   29940099
285320                    ASC-SEASET-SHRT-NM (ASC-BLK-SUB ASC-ITEM-SUB) 29950099
285330             END-IF                                               29960099
285340             IF DN-AUD-FALR-RSN-NM = 0                            29970099
285400                MOVE SUT00102-AUD-FALR-RSN-NM TO                  29980099
285500                   ASC-AUD-FALR-RSN-NM (ASC-BLK-SUB ASC-ITEM-SUB) 29990099
285501             ELSE                                                 30000099
285520                MOVE SPACES                   TO                  30010099
285530                   ASC-AUD-FALR-RSN-NM (ASC-BLK-SUB ASC-ITEM-SUB) 30020099
285540             END-IF                                               30030099
285600                                                                  30040001
285700         END-IF                                                   30050001
285800     END-PERFORM.                                                 30060001
285900                                                                  30070001
286000     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          30080001
286100         MOVE +1               TO ASC-BLK-SUB                     30090001
286200         PERFORM 5100-WRITE-TEMP-STORAGE                          30100001
286300         ADD +1                TO ASC-BLK-SUB                     30110001
286400         PERFORM 5100-WRITE-TEMP-STORAGE                          30120001
286500                                                                  30130001
286600         MOVE 1                TO ASC-BLK-SUB                     30140001
286700                                  PV-BLOCK-NUMBER                 30150001
286800         PERFORM 4410-READ-TEMP-STORAGE                           30160001
286900         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             30170001
287000             MOVE 2            TO ASC-BLK-SUB                     30180001
287100                                  PV-BLOCK-NUMBER                 30190001
287200             PERFORM 4410-READ-TEMP-STORAGE                       30200001
287300         END-IF                                                   30210001
287400     END-IF.                                                      30220001
287500                                                                  30230001
287600*----------------------------------------------------------------*30240001
287700*    FETCH THE CURSOR                                             30250001
287800*----------------------------------------------------------------*30260001
287900 4310-FETCH.                                                      30270001
288000                                                                  30280001
288100     EVALUATE TRUE                                                30290038
288200         WHEN ASC-RQST-BAR-CODE                                   30300038
288300              EXEC SQL                                            30310099
288400                  FETCH BAR-CODE-CSR                              30320099
288500                   INTO :SUT00102-BRCDE-NBR                       30330099
288600                       ,:SUT00102-CRE-TMST                        30340099
288700                       ,:SUT00102-AUD-CNTL-NBR                    30350099
288800                       ,:SUT00102-SHIPT-UNT-ID                    30360099
288900                       ,:SUT00102-AUD-STAT-CDE                    30370099
289000                       ,:SUT00102-PO-LNE-NBR                      30380099
289100                       ,:SUT00102-PREPK-ID                        30390099
289200                       ,:SUT00102-STR-NBR                         30400099
289300                       ,:SUT00102-STR-ZN-ID   :DN-STR-ZN-ID       30410099
289400                       ,:SUT00102-SEASET-YR   :DN-SEASET-YR       30420099
289500                       ,:SUT00102-SEASET-SHRT-NM                  30430099
289510                                          :DN-SEASET-SHRT-NM      30440099
289600                       ,:SUT00102-AUD-FALR-RSN-NM                 30450099
289610                                          :DN-AUD-FALR-RSN-NM     30460099
289700              END-EXEC                                            30470099
289800                                                                  30480038
289900         WHEN ASC-RQST-PO-RCVR                                    30490038
290000              EXEC SQL                                            30500038
290100                  FETCH PO-RCVR-CSR                               30510038
290200                   INTO :SUT00102-BRCDE-NBR                       30520038
290300                       ,:SUT00102-CRE-TMST                        30530046
290400                       ,:SUT00102-AUD-CNTL-NBR                    30540038
290500                       ,:SUT00102-SHIPT-UNT-ID                    30550047
290600                       ,:SUT00102-AUD-STAT-CDE                    30560038
290700                       ,:SUT00102-PO-LNE-NBR                      30570038
290800                       ,:SUT00102-PREPK-ID                        30580046
290900                       ,:SUT00102-STR-NBR                         30590046
290910                       ,:SUT00102-STR-ZN-ID   :DN-STR-ZN-ID       30600099
290920                       ,:SUT00102-SEASET-YR   :DN-SEASET-YR       30610099
290930                       ,:SUT00102-SEASET-SHRT-NM                  30620099
290940                                          :DN-SEASET-SHRT-NM      30630099
290950                       ,:SUT00102-AUD-FALR-RSN-NM                 30640099
290960                                          :DN-AUD-FALR-RSN-NM     30650099
291400              END-EXEC                                            30660038
291500                                                                  30670038
291600         WHEN ASC-RQST-PO-RCVR-PREPK                              30680038
291700              EXEC SQL                                            30690038
291800                  FETCH PO-RCVR-PREPK-CSR                         30700079
291900                   INTO :SUT00102-BRCDE-NBR                       30710046
292000                       ,:SUT00102-CRE-TMST                        30720046
292100                       ,:SUT00102-AUD-CNTL-NBR                    30730046
292200                       ,:SUT00102-SHIPT-UNT-ID                    30740047
292300                       ,:SUT00102-AUD-STAT-CDE                    30750046
292400                       ,:SUT00102-PO-LNE-NBR                      30760046
292500                       ,:SUT00102-PREPK-ID                        30770046
292600                       ,:SUT00102-STR-NBR                         30780046
292610                       ,:SUT00102-STR-ZN-ID   :DN-STR-ZN-ID       30790099
292620                       ,:SUT00102-SEASET-YR   :DN-SEASET-YR       30800099
292630                       ,:SUT00102-SEASET-SHRT-NM                  30810099
292640                                          :DN-SEASET-SHRT-NM      30820099
292650                       ,:SUT00102-AUD-FALR-RSN-NM                 30830099
292660                                          :DN-AUD-FALR-RSN-NM     30840099
293100              END-EXEC                                            30850038
293200                                                                  30860038
293300         WHEN ASC-RQST-PO-RCVR-LINE                               30870038
293400              EXEC SQL                                            30880038
293500                  FETCH PO-RCVR-LINE-CSR                          30890079
293600                   INTO :SUT00102-BRCDE-NBR                       30900046
293700                       ,:SUT00102-CRE-TMST                        30910046
293800                       ,:SUT00102-AUD-CNTL-NBR                    30920046
293900                       ,:SUT00102-SHIPT-UNT-ID                    30930047
294000                       ,:SUT00102-AUD-STAT-CDE                    30940046
294100                       ,:SUT00102-PO-LNE-NBR                      30950046
294200                       ,:SUT00102-PREPK-ID                        30960046
294300                       ,:SUT00102-STR-NBR                         30970046
294310                       ,:SUT00102-STR-ZN-ID   :DN-STR-ZN-ID       30980099
294320                       ,:SUT00102-SEASET-YR   :DN-SEASET-YR       30990099
294330                       ,:SUT00102-SEASET-SHRT-NM                  31000099
294340                                          :DN-SEASET-SHRT-NM      31010099
294350                       ,:SUT00102-AUD-FALR-RSN-NM                 31020099
294360                                          :DN-AUD-FALR-RSN-NM     31030099
294800              END-EXEC                                            31040038
294900                                                                  31050038
295000         WHEN ASC-RQST-AUDIT                                      31060038
295100              EXEC SQL                                            31070038
295200                  FETCH AUDIT-CSR                                 31080099
295300                   INTO :SUT00102-BRCDE-NBR                       31090046
295400                       ,:SUT00102-CRE-TMST                        31100046
295500                       ,:SUT00102-AUD-CNTL-NBR                    31110046
295600                       ,:SUT00102-SHIPT-UNT-ID                    31120047
295700                       ,:SUT00102-AUD-STAT-CDE                    31130046
295800                       ,:SUT00102-PO-LNE-NBR                      31140046
295900                       ,:SUT00102-PREPK-ID                        31150046
296000                       ,:SUT00102-STR-NBR                         31160046
296010                       ,:SUT00102-STR-ZN-ID   :DN-STR-ZN-ID       31170099
296020                       ,:SUT00102-SEASET-YR   :DN-SEASET-YR       31180099
296030                       ,:SUT00102-SEASET-SHRT-NM                  31190099
296040                                          :DN-SEASET-SHRT-NM      31200099
296050                       ,:SUT00102-AUD-FALR-RSN-NM                 31210099
296060                                          :DN-AUD-FALR-RSN-NM     31220099
296500              END-EXEC                                            31230038
296600                                                                  31240038
296700     END-EVALUATE.                                                31250038
296800                                                                  31260038
296900     EVALUATE TRUE                                                31270001
297000         WHEN SQLCODE = ZERO                                      31280001
297200              PERFORM 4320-SELECT-CASI                            31290051
297300              PERFORM 4330-SELECT-AUDIT-STATUS                    31300098
297400         WHEN SQLCODE = +100                                      31310001
297500              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 31320001
297600         WHEN SQLWARN0 NOT = SPACE                                31330001
297700         WHEN SQLCODE NOT = ZERO                                  31340001
297800              MOVE '4310-FETCH-CURSOR' TO DP013-PARAGRAPH         31350001
297900              MOVE 'COULD NOT PERFORM FETCH  '                    31360099
298100                        TO DP013-MESSAGE-TEXT (1)                 31370099
298200              MOVE SQLCA       TO DP013-SQLCA                     31380001
298300              SET DP013-DB2-ABEND TO TRUE                         31390001
298400              PERFORM DP013-0000-PROCESS-ABEND                    31400001
298500     END-EVALUATE.                                                31410001
298600                                                                  31420050
298700******************************************************************31430050
298800*                                                                *31440051
298900******************************************************************31450050
299000 4320-SELECT-CASI.                                                31460051
299100                                                                  31470050
299200**?? MOVE SUT00102-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID.               31480099
299300     MOVE SUT00102-BRCDE-NBR    TO DK-BRCDE-NBR.                  31490099
299400                                                                  31500050
299500     EXEC SQL                                                     31510050
299600         SELECT                                                   31520051
299700                A.CASI_CDE                                        31530099
299800               ,B.CART_LBL_TYP_CDE                                31540099
300000         INTO  :SUT00102-CASI-CDE                                 31550051
300100              ,:SULBXF-CART-LBL-TYP-CDE                           31560050
300300         FROM   SUT_CART_DIRV_TRKG  A                             31570099
300400         JOIN   TSULBXF             B                             31580099
300500           ON   A.BRCDE_NBR     =   B.BRCDE_NBR                   31590099
300700          AND   A.BRCDE_NBR     =  :DK-BRCDE-NBR                  31600099
300800         ORDER BY A.CRE_TMST                                      31610099
300900         FETCH FIRST ROW ONLY                                     31620099
301400     END-EXEC.                                                    31630051
301500                                                                  31640050
301600     EVALUATE TRUE                                                31650051
301700         WHEN SQLCODE = ZERO                                      31660051
301800              CONTINUE                                            31670051
301900                                                                  31680051
302000         WHEN SQLCODE = +100                                      31690051
302100              PERFORM 4325-SELECT-CASI-RCLM                       31700099
302200                                                                  31710051
302300         WHEN SQLWARN0 NOT = SPACE                                31720051
302400         WHEN SQLCODE NOT = ZERO                                  31730051
302500              MOVE '4320-SELECT-CASI ' TO DP013-PARAGRAPH         31740051
302600              MOVE 'COULD NOT SELECT CASI   ' TO                  31750051
302700                              DP013-MESSAGE-TEXT (1)              31760051
302800              MOVE 'SUT-CART-DIRV-TRKG      ' TO                  31770051
302900                              DP013-DB2-TABLE-NAME (1)            31780056
303000              MOVE 'TSULBXF                 ' TO                  31790051
303100                              DP013-DB2-TABLE-NAME (2)            31800056
303200              MOVE SQLCA       TO DP013-SQLCA                     31810051
303300              SET DP013-DB2-ABEND TO TRUE                         31820051
303400              PERFORM DP013-0000-PROCESS-ABEND                    31830051
303500     END-EVALUATE.                                                31840051
303600                                                                  31850098
303610******************************************************************31860099
303620*                                                                *31870099
303630******************************************************************31880099
303640 4325-SELECT-CASI-RCLM.                                           31890099
303650                                                                  31900099
303651     EXEC SQL                                                     31910099
303660          SELECT   CASI_CDE                                       31920099
303661            INTO  :SUT00102-CASI-CDE                              31930099
303670            FROM  SUT_CART_DIRV_TRKG                              31940099
303672           WHERE  BRCDE_NBR = :DK-BRCDE-NBR                       31950099
303674           ORDER BY CRE_TMST                                      31960099
303675           FETCH FIRST ROW ONLY                                   31970099
303713     END-EXEC.                                                    31980099
303714                                                                  31990099
303728     EVALUATE TRUE                                                32000099
303729         WHEN SQLCODE = ZERO                                      32010099
303730         WHEN SQLCODE = +100                                      32020099
303731              CONTINUE                                            32030099
303732         WHEN SQLWARN0 NOT = SPACE                                32040099
303733         WHEN SQLCODE NOT = ZERO                                  32050099
303734              MOVE '4325-SELECT-CASI-RCLM ' TO DP013-PARAGRAPH    32060099
303735              MOVE 'COULD NOT SELECT CASI   ' TO                  32070099
303736                              DP013-MESSAGE-TEXT (1)              32080099
303737              MOVE DK-BRCDE-NBR               TO                  32090099
303738                              DP013-MESSAGE-TEXT (2)              32100099
303739              MOVE 'SUT-CART-DIRV-TRKG      ' TO                  32110099
303740                              DP013-DB2-TABLE-NAME (1)            32120099
303741              MOVE SQLCA       TO DP013-SQLCA                     32130099
303742              SET DP013-DB2-ABEND TO TRUE                         32140099
303743              PERFORM DP013-0000-PROCESS-ABEND                    32150099
303744     END-EVALUATE.                                                32160099
303745                                                                  32170099
303750*----------------------------------------------------------------*32180099
303800*    USE AUDIT CONTROL NUMBER TO                                  32190098
303900*----------------------------------------------------------------*32200098
304000 4330-SELECT-AUDIT-STATUS.                                        32210098
304100                                                                  32220098
304200     MOVE SUT00102-AUD-CNTL-NBR TO DK-AUD-CNTL-NBR.               32230098
304300                                                                  32240098
304400     EXEC SQL                                                     32250098
304500        SELECT                                                    32260098
304600                S015.AUD_STAT_CDE                                 32270098
304700                                                                  32280098
304800          INTO                                                    32290098
304900                :SUT00015-AUD-STAT-CDE                            32300098
305000                                                                  32310098
305100          FROM  SUT_PO_AUD_REQ   S015                             32320098
305200         WHERE  S015.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR              32330098
305300          WITH  UR                                                32340098
305400     END-EXEC.                                                    32350098
305500                                                                  32360098
305600     EVALUATE TRUE                                                32370098
305700         WHEN SQLCODE = ZERO                                      32380098
305800              EVALUATE SUT00015-AUD-STAT-CDE                      32390098
305900                  WHEN 'I'                                        32400098
306000                       MOVE 'INPROCES' TO PV-AUDIT-STATUS         32410098
306100                                                                  32420098
306200                  WHEN 'P'                                        32430098
306300                       MOVE 'PASS    ' TO PV-AUDIT-STATUS         32440098
306400                                                                  32450098
306500                  WHEN 'F'                                        32460098
306600                       MOVE 'FAIL    ' TO PV-AUDIT-STATUS         32470098
306700                                                                  32480098
306800                  WHEN 'N'                                        32490098
306900                       MOVE 'NOT NEED' TO PV-AUDIT-STATUS         32500098
307000                                                                  32510098
307100                  WHEN OTHER                                      32520098
307200                       MOVE 'OTHER   ' TO PV-AUDIT-STATUS         32530098
307300                                                                  32540098
307400              END-EVALUATE                                        32550098
307500                                                                  32560098
307600         WHEN SQLCODE = +100                                      32570098
307700              MOVE 'NOTFOUND' TO PV-AUDIT-STATUS                  32580098
307800         WHEN SQLWARN0 NOT = SPACE                                32590098
307900         WHEN SQLCODE NOT = ZERO                                  32600098
308000              MOVE '4330-SELECT-AUDIT-STATUS  ' TO                32610098
308100                                   DP013-PARAGRAPH                32620098
308200              MOVE 'SELECT FOR PO BAD' TO                         32630098
308300                                   DP013-MESSAGE-TEXT (1)         32640098
308400              MOVE SQLCA       TO DP013-SQLCA                     32650098
308500              MOVE 'SUT-PO-AUD-REQ    ' TO                        32660098
308600                                   DP013-DB2-TABLE-NAME (1)       32670098
308700              SET DP013-DB2-ABEND                                 32680098
308800                  DP013-XCTL-DISPLAY-RESTART TO TRUE              32690098
308900              PERFORM DP013-0000-PROCESS-ABEND                    32700098
309000     END-EVALUATE.                                                32710098
309100                                                                  32720098
309200                                                                  32730098
309300                                                                  32740001
309400*----------------------------------------------------------------*32750001
309500* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *32760001
309600*----------------------------------------------------------------*32770001
309700 4400-MOVE-COMMAREA-TO-SCREEN.                                    32780001
309800     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             32790001
309900         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          32800001
310000         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          32810001
310100             MOVE +1    TO ASC-BLK-SUB                            32820001
310200             PERFORM 5100-WRITE-TEMP-STORAGE                      32830001
310300             ADD +1     TO ASC-BLK-SUB                            32840001
310400             PERFORM 5100-WRITE-TEMP-STORAGE                      32850001
310500             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             32860001
310600                 GIVING PV-BLOCK-NUMBER                           32870001
310700                 REMAINDER PV-REMAINDER                           32880001
310800             IF  PV-REMAINDER > ZERO                              32890001
310900                 ADD +1 TO PV-BLOCK-NUMBER                        32900001
311000             END-IF                                               32910001
311100             MOVE +1    TO ASC-BLK-SUB                            32920001
311200             PERFORM 4410-READ-TEMP-STORAGE                       32930001
311300             ADD +1     TO ASC-BLK-SUB                            32940001
311400                           PV-BLOCK-NUMBER                        32950001
311500             PERFORM 4410-READ-TEMP-STORAGE                       32960001
311600     END-IF.                                                      32970001
311700     MOVE +1            TO ASC-BLK-SUB.                           32980001
311800     COMPUTE ASC-ITEM-SUB =                                       32990001
311900         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              33000001
312000         + PC-ITEMS-PER-PANEL).                                   33010001
312100*                                                                 33020001
312200     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        33030001
312300         ADD +1         TO ASC-BLK-SUB                            33040001
312400         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            33050001
312500     END-IF.                                                      33060001
312600*                                                                 33070001
312700     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           33080001
312800         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                33090001
312900     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        33100001
313000     PERFORM 4420-FORMAT-LIST-LINES                               33110001
313100         VARYING PV-SUB                                           33120001
313200         FROM PC-ITEMS-PER-PANEL BY -1                            33130001
313300         UNTIL PV-SUB < +1.                                       33140001
313400*                                                                 33150001
313500     COMPUTE ASC-ITEMS-DISPLAYED =                                33160001
313600         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          33170001
313700     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    33180001
313800                                      ASTRTITO.                   33190001
313900     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    33200001
314000     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    33210001
314100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            33220001
314200                                   TO ASELITO.                    33230001
314300     MOVE ASC-OPER-UNT-ID          TO AOPRUNTO.                   33240001
314310     MOVE ASC-PO-NBR               TO PV-PO-NBR.                  33250099
314320     MOVE ASC-REC-SEQ-NBR          TO PV-RCVR-NBR.                33260099
314330     MOVE PV-PO-RCVR-FORMAT        TO APORCVRO.                   33270099
315000     MOVE ASC-SCAC                 TO ASCACO.                     33280027
315100     MOVE ASC-TRAILER              TO ATRLRO.                     33290027
315200     MOVE ASC-TRIP-ID              TO ATRIPIDO.                   33300027
315300     MOVE ASC-TRAILER-STATUS       TO ATRLSTTO.                   33310060
315400     MOVE ASC-PACK-TYPE            TO APCKTYO.                    33320037
315700     MOVE ASC-EXPECTED-CARTONS     TO AEXPCTNO.                   33330099
315800     MOVE ASC-DIRECTIVE-CARTONS    TO ADIRCTNO.                   33340099
315900     STRING ASC-ARRIVE-DATE (6:2) '/'                             33350099
316000            ASC-ARRIVE-DATE (9:2) '/'                             33360099
316100            ASC-ARRIVE-DATE (3:2)                                 33370099
316200            DELIMITED BY SIZE                                     33380088
316300            INTO AARRDATO.                                        33390088
316400                                                                  33400001
316500     IF  DP020-MSG-NUMBER-X = SPACE                               33410001
316600         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  33420001
316700*            --- MORE ITEMS TO DISPLAY ----                       33430001
316800             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            33440001
316900             SET DP020-MSG-INFORMATIONAL TO TRUE                  33450001
317000         END-IF                                                   33460001
317100     END-IF.                                                      33470001
317200                                                                  33480001
317300*----------------------------------------------------------------*33490001
317400*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *33500001
317500*----------------------------------------------------------------*33510001
317600 4410-READ-TEMP-STORAGE.                                          33520001
317700     EXEC CICS                                                    33530001
317800         READQ TS                                                 33540001
317900             QUEUE (ASC-LIST-QUEUE-NAME)                          33550001
318000             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               33560001
318100             ITEM  (PV-BLOCK-NUMBER)                              33570001
318200             RESP  (PV-CICS-RESP)                                 33580001
318300     END-EXEC.                                                    33590001
318400                                                                  33600001
318500     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       33610001
318600       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     33620001
318700         CONTINUE                                                 33630001
318800     ELSE                                                         33640001
318900         SET DP013-CICS-ABEND     TO TRUE                         33650001
319000         SET DP013-NO-ROLLBACK    TO TRUE                         33660001
319100         MOVE '4410-READ-TEMP-STORAGE' TO DP013-PARAGRAPH         33670001
319200         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      33680001
319300                                  TO DP013-MESSAGE-TEXT(1)        33690001
319400         PERFORM DP013-0000-PROCESS-ABEND                         33700001
319500     END-IF.                                                      33710001
319600                                                                  33720001
319700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             33730001
319800*                                                                 33740001
319900     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         33750001
320000         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               33760001
320100     END-IF.                                                      33770001
320200                                                                  33780001
320300*----------------------------------------------------------------*33790001
320400*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *33800001
320500*----------------------------------------------------------------*33810001
320600 4420-FORMAT-LIST-LINES.                                          33820001
320700     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      33830001
320800         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                33840001
320900         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           33850001
321000         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           33860001
321100         MOVE SPACES             TO MR-SELECTI      (PV-SUB)      33870001
321200                                    MR-ACTION       (PV-SUB)      33880001
321300                                    MR-LINE-PACK    (PV-SUB)      33890007
321400                                    MR-BARCODE      (PV-SUB)      33900007
321500                                    MR-CASI         (PV-SUB)      33910007
321600                                    MR-AUD-STAT     (PV-SUB)      33920017
321700                                    MR-DRTV-CRTE-DTE (PV-SUB)     33930001
321800                                    MR-DRTV-CRTE-TME (PV-SUB)     33940001
321900         MOVE 0                  TO MR-AUD-CNTL-NBR (PV-SUB)      33950007
322000     ELSE                                                         33960001
322100         IF ( ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     33970099
322200                                                   > SPACE )      33980099
322300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 33990001
322400                                          TO MR-SELECTI (PV-SUB)  34000001
322500         ELSE                                                     34010001
322510             MOVE DP015-UNP-ALP-NOR-OFF TO MR-SELECTA (PV-SUB)    34020099
322520             MOVE DP015-GREEN           TO MR-SELECTC (PV-SUB)    34030099
322530             MOVE DP015-UNDERLINE       TO MR-SELECTH (PV-SUB)    34040099
322600*            MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      34050099
322700*                                          TO MR-SELECTI (PV-SUB) 34060099
322800         END-IF                                                   34070001
322900                                                                  34080001
323000         IF  DP030-SET-CURSOR-TRAILER                             34090001
323100             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)34100001
323200                 > SPACE)                                         34110001
323300               OR (PV-SUB = 1))                                   34120001
323400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               34130001
323500                MOVE -1          TO MR-SELECTL (PV-SUB)           34140001
323600             END-IF                                               34150001
323700         END-IF                                                   34160001
323800*>>>>>>>>                                                         34170001
323900         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               34180001
324000                                            TO MR-ACTION (PV-SUB) 34190001
324100                                                                  34200099
324200         EVALUATE TRUE                                            34210099
324300             WHEN ASC-PREPK-ORDER                                 34220099
324400                  MOVE ASC-PREPK-ID (ASC-BLK-SUB ASC-ITEM-SUB)    34230099
324500                                  TO MR-LINE-PACK (PV-SUB)        34240099
324600                                                                  34250099
324700             WHEN ASC-PACK-BY-STORE-ORDER                         34260099
324800                  MOVE SPACES     TO MR-LINE-PACK (PV-SUB)        34270099
324900                                                                  34280099
325000             WHEN ASC-BULK-CASE-ORDER                             34290099
325100                  MOVE ASC-LNE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)     34300099
325200                                  TO MR-LINE-PACK (PV-SUB)        34310099
325300                                                                  34320099
325400         END-EVALUATE                                             34330099
325500                                                                  34340099
325600         MOVE ASC-BARCODE        (ASC-BLK-SUB ASC-ITEM-SUB)       34350017
325700                                  TO MR-BARCODE  (PV-SUB)         34360017
325800         MOVE ASC-CASI           (ASC-BLK-SUB ASC-ITEM-SUB)       34370017
325900                                  TO MR-CASI     (PV-SUB)         34380017
326000         MOVE ASC-AUD-STAT-CDE   (ASC-BLK-SUB ASC-ITEM-SUB)       34390055
326100                                  TO MR-AUD-STAT (PV-SUB)         34400017
326200         MOVE ASC-AUD-CNTL-NBR   (ASC-BLK-SUB ASC-ITEM-SUB)       34410017
326300                                  TO MR-AUD-CNTL-NBR (PV-SUB)     34420017
326400         STRING ASC-DIRECTIVE-TMST (ASC-BLK-SUB ASC-ITEM-SUB)     34430017
326500                                   (06:06)                        34440017
326600                ASC-DIRECTIVE-TMST (ASC-BLK-SUB ASC-ITEM-SUB)     34450017
326700                                   (03:02)                        34460099
326800                DELIMITED BY SIZE                                 34470017
326900                INTO MR-DRTV-CRTE-DTE (PV-SUB)                    34480017
327000         MOVE ASC-DIRECTIVE-TMST (ASC-BLK-SUB ASC-ITEM-SUB)       34490017
327100                                   (12:8)                         34500017
327200                                TO  MR-DRTV-CRTE-TME (PV-SUB)     34510017
327300     END-IF.                                                      34520001
327400     SUBTRACT +1 FROM ASC-ITEM-SUB                                34530001
327500     IF  ASC-ITEM-SUB < + 1                                       34540001
327600         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  34550001
327700         MOVE +1                 TO ASC-BLK-SUB                   34560001
327800     END-IF.                                                      34570001
327900                                                                  34580001
328000******************************************************************34590001
328100** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **34600001
328200** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **34610001
328300** ISSUE A WARNING.                                             **34620001
328400******************************************************************34630001
328500 4430-CHECK-FOR-BEGIN-AND-END.                                    34640001
328600     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       34650001
328700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     34660001
328800*            -- NO END-OF-RANGE SPECFIED ---                      34670001
328900             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            34680001
329000             SET DP020-MSG-WARNING TO TRUE                        34690001
329100             PERFORM 4431-POSITION-AT-WARNING                     34700001
329200         END-IF                                                   34710001
329300     ELSE                                                         34720001
329400         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     34730001
329500*            -- NO BEGINNING-OF-RANGE SPECFIED ---                34740001
329600             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            34750001
329700             SET DP020-MSG-WARNING TO TRUE                        34760001
329800             PERFORM 4431-POSITION-AT-WARNING                     34770001
329900         END-IF                                                   34780001
330000     END-IF.                                                      34790001
330100                                                                  34800001
330200******************************************************************34810001
330300** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **34820001
330400** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **34830001
330500** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **34840001
330600** POSITION THE CURSOR THERE.                                   **34850001
330700******************************************************************34860001
330800 4431-POSITION-AT-WARNING.                                        34870001
330900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 34880001
331000                    - PV-TOP-ITEM + 1.                            34890001
331100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34900001
331200         CONTINUE                                                 34910001
331300     ELSE                                                         34920001
331400         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      34930001
331500         MOVE -1                     TO MR-SELECTL (PV-SUB)       34940001
331600         MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)       34950001
331700         MOVE DP015-YELLOW           TO MR-SELECTC (PV-SUB)       34960001
331800     END-IF.                                                      34970001
331900                                                                  34980001
332000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   34990001
332100                    - PV-TOP-ITEM + 1.                            35000001
332200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      35010001
332300         CONTINUE                                                 35020001
332400     ELSE                                                         35030001
332500         SET DP030-SET-CURSOR-APPL-1                              35040001
332600                                   TO TRUE                        35050001
332700         MOVE -1                   TO MR-SELECTL (PV-SUB)         35060001
332800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         35070001
332900         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         35080001
333000     END-IF.                                                      35090001
333100                                                                  35100001
333200*----------------------------------------------------------------*35110001
333300* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *35120001
333400* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *35130001
333500* FOR THE SELECTED ITEMS QUEUE.                                  *35140001
333600*                                                                *35150001
333700* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *35160001
333800* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *35170001
333900* THE ARRAY IS FULL.                                             *35180001
334000*----------------------------------------------------------------*35190001
334100 5000-PREPARE-SEL-QUEUE.                                          35200001
334200     MOVE +1                   TO  ASC-BLK-SUB.                   35210001
334300     PERFORM 5100-WRITE-TEMP-STORAGE.                             35220001
334400     ADD +1                    TO  ASC-BLK-SUB.                   35230001
334500     PERFORM 5100-WRITE-TEMP-STORAGE.                             35240001
334600                                                                  35250001
334700     MOVE ASC-SEL-QUEUE-NAME   TO  SU098-SEL-QUEUE-NAME.          35260005
334800     PERFORM 6010-DELETE-SEL-QUEUE.                               35270001
334900                                                                  35280001
335000     SET ASC-UPDATE-TSQ        TO  TRUE.                          35290001
335100                                                                  35300001
335200     SET SU099-IDX             TO  1.                             35310005
335300     MOVE ZERO                 TO SU098-NUMBER-OF-TS-ITEMS.       35320005
335400     INITIALIZE SU099-SELECTED-ITEM-ARRAY.                        35330005
335500                                                                  35340001
335600     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           35350001
335700             VARYING PV-ITEM                                      35360001
335800             FROM 1 BY 1                                          35370001
335900             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     35380001
336000                                                                  35390001
336100     IF  SU099-IDX > 1                                            35400005
336200         PERFORM 5205-WRITE-SEL-QUEUE                             35410001
336300         ADD +1                TO SU098-NUMBER-OF-TS-ITEMS        35420005
336400     END-IF.                                                      35430001
336500                                                                  35440001
336600*----------------------------------------------------------------*35450001
336700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *35460001
336800*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *35470001
336900*----------------------------------------------------------------*35480001
337000 5100-WRITE-TEMP-STORAGE.                                         35490001
337100     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     35500001
337200                                   TO PV-LIST-ITEM-NUMBER.        35510001
337300     COMPUTE PV-BLOCK-NUMBER =                                    35520001
337400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    35530001
337500                                                                  35540001
337600     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             35550001
337700     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             35560001
337800         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      35570001
337900             PERFORM 5105-REWRITE-ASC-LISTQ                       35580001
338000         END-IF                                                   35590001
338100     ELSE                                                         35600001
338200         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       35610001
338300         ASC-HIGHEST-BLOCK-WRITTEN + 1                            35620001
338400         PERFORM 5110-WRITE-ASC-LISTQ                             35630001
338500         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   35640001
338600     END-IF.                                                      35650001
338700                                                                  35660001
338800     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             35670001
338900                                                                  35680001
339000******************************************************************35690001
339100** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **35700001
339200** SPECIFIC COMMAREA.                                           **35710001
339300******************************************************************35720001
339400 5105-REWRITE-ASC-LISTQ.                                          35730001
339500     EXEC CICS                                                    35740001
339600         WRITEQ TS                                                35750001
339700             QUEUE (ASC-LIST-QUEUE-NAME)                          35760001
339800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               35770001
339900             ITEM  (PV-BLOCK-NUMBER)                              35780001
340000             REWRITE                                              35790001
340100             RESP  (PV-CICS-RESP)                                 35800001
340200     END-EXEC.                                                    35810001
340300                                                                  35820001
340400     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           35830001
340500         CONTINUE                                                 35840001
340600     ELSE                                                         35850001
340700         SET DP013-CICS-ABEND            TO TRUE                  35860001
340800         SET DP013-NO-ROLLBACK           TO TRUE                  35870001
340900         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       35880001
341000         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     35890001
341100                                         TO DP013-MESSAGE-TEXT(1) 35900001
341200         PERFORM DP013-0000-PROCESS-ABEND                         35910001
341300     END-IF.                                                      35920001
341400                                                                  35930001
341500******************************************************************35940001
341600** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **35950001
341700** SPECIFIC COMMAREA.                                           **35960001
341800******************************************************************35970001
341900 5110-WRITE-ASC-LISTQ.                                            35980001
342000     EXEC CICS                                                    35990001
342100         WRITEQ TS                                                36000001
342200             QUEUE (ASC-LIST-QUEUE-NAME)                          36010001
342300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               36020001
342400             ITEM  (PV-BLOCK-NUMBER)                              36030001
342500             RESP  (PV-CICS-RESP)                                 36040001
342600     END-EXEC.                                                    36050001
342700     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      36060001
342800         SET DP013-CICS-ABEND      TO TRUE                        36070001
342900         SET DP013-NO-ROLLBACK     TO TRUE                        36080001
343000         MOVE '5110-WRITE-ASC-LISTQ'                              36090001
343100                                   TO DP013-PARAGRAPH             36100001
343200         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           36110001
343300                                   TO DP013-MESSAGE-TEXT(1)       36120001
343400         PERFORM DP013-0000-PROCESS-ABEND                         36130001
343500     END-IF.                                                      36140001
343600                                                                  36150001
343700*----------------------------------------------------------------*36160001
343800* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *36170001
343900* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *36180001
344000*----------------------------------------------------------------*36190001
344100 5200-FILL-SEL-QUEUE-RECORD.                                      36200001
344200     PERFORM 6112-READ-LIST-QUEUE.                                36210001
344300                                                                  36220001
344400     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       36230001
344500         PERFORM VARYING LQW-IDX                                  36240001
344600         FROM 1 BY 1                                              36250001
344700         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            36260001
344800           OR  LQW-LIST-ITEM-NUMBER(LQW-IDX) = ZERO               36270001
344900                                                                  36280001
345000           IF LQW-SELECT (LQW-IDX)                                36290001
345100                 MOVE LQW-LIST-ITEM-NUMBER(LQW-IDX) TO            36300001
345200                                            SU099-ITEM (SU099-IDX)36310005
345300                 MOVE LQW-ACTION (LQW-IDX)                        36320001
345400                                   TO SU099-ACTION-SW (SU099-IDX) 36330005
345500                                                                  36340009
345600**??                                                              36350009
345700**??             MOVE LQW-LINE-PACK      (LQW-IDX)                36360009
345800**??                             TO SU099-LINE-PACK   (SU099-IDX) 36370009
345900**??             MOVE LQW-BARCODE        (LQW-IDX)                36380009
346000**??                             TO SU099-BARCODE     (SU099-IDX) 36390009
346500**??             MOVE LQW-AUDIT-NBR      (LQW-IDX)                36400009
346600**??                             TO SU099-AUDIT-NBR   (SU099-IDX) 36410009
346900                                                                  36420001
347000                 SET SU099-IDX UP BY 1                            36430005
347100                 IF  SU099-IDX > SU099-MAX-ITEMS                  36440005
347200                     PERFORM 5205-WRITE-SEL-QUEUE                 36450001
347300                     ADD +1        TO SU098-NUMBER-OF-TS-ITEMS    36460005
347400                     INITIALIZE SU099-SELECTED-ITEM-ARRAY         36470005
347500                     SET SU099-IDX TO  1                          36480005
347600                 END-IF                                           36490001
347700           END-IF                                                 36500001
347800         END-PERFORM                                              36510001
347900     END-IF.                                                      36520001
348000                                                                  36530001
348100*----------------------------------------------------------------*36540001
348200*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *36550001
348300*----------------------------------------------------------------*36560001
348400 5205-WRITE-SEL-QUEUE.                                            36570001
348500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO SU099-SELECTED-ITEMS.   36580005
348600                                                                  36590001
348700     EXEC CICS                                                    36600001
348800          WRITEQ TS                                               36610001
348900              QUEUE (ASC-SEL-QUEUE-NAME)                          36620001
349000              FROM  (SU099-SELECT-RECORD)                         36630005
349100              ITEM  (PV-SEL-QUEUE-ITEM)                           36640001
349200              RESP  (PV-CICS-RESP)                                36650001
349300     END-EXEC.                                                    36660001
349400                                                                  36670001
349500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          36680001
349600         CONTINUE                                                 36690001
349700     ELSE                                                         36700001
349800         SET DP013-CICS-ABEND      TO TRUE                        36710001
349900         SET DP013-NO-ROLLBACK     TO TRUE                        36720001
350000         MOVE '5205-WRITE-SEL-QUEUE'                              36730001
350100                                   TO DP013-PARAGRAPH             36740001
350200         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          36750001
350300                                   TO DP013-MESSAGE-TEXT(1)       36760001
350400         PERFORM DP013-0000-PROCESS-ABEND                         36770001
350500     END-IF.                                                      36780001
350600                                                                  36790001
350700******************************************************************36800001
350800** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **36810001
350900** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **36820001
351000** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **36830001
351100** THE USER.                                                    **36840001
351200******************************************************************36850001
351300 6000-REFRESH-PANEL-FROM-TEMP.                                    36860001
351400     IF  ASC-UPDATE-TSQ                                           36870001
351500         SET ASC-NO-TSQ-UPDATE TO TRUE                            36880001
351600         MOVE ZERO                 TO PV-SAVE-ITEM                36890001
351700                                      PV-SEL-QUEUE-ITEM           36900001
351800         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        36910001
351900                                   TO PV-HOLD-SELECTED-ITEMS      36920001
352000         MOVE +1                   TO PV-ITEMS-PROCESSED          36930001
352100         PERFORM 6100-UPDATE-TSQ                                  36940001
352200             UNTIL PV-ITEMS-PROCESSED >                           36950001
352300                                     PV-HOLD-SELECTED-ITEMS       36960001
352400         INITIALIZE ASC-BLOCK-ENTRIES (1)                         36970001
352500                    ASC-BLOCK-ENTRIES (2)                         36980001
352600     END-IF.                                                      36990001
352700                                                                  37000001
352800*----------------------------------------------------------------*37010001
352900*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *37020001
353000*----------------------------------------------------------------*37030001
353100 6010-DELETE-SEL-QUEUE.                                           37040001
353200                                                                  37050001
353300     EXEC CICS                                                    37060001
353400         DELETEQ TS                                               37070001
353500             QUEUE (ASC-SEL-QUEUE-NAME)                           37080001
353600             RESP  (PV-CICS-RESP)                                 37090001
353700     END-EXEC.                                                    37100001
353800*                                                                 37110001
353900     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      37120001
354000        (PV-CICS-RESP = DFHRESP(QIDERR)))                         37130001
354100         CONTINUE                                                 37140001
354200     ELSE                                                         37150001
354300         SET DP013-CICS-ABEND TO TRUE                             37160001
354400         SET DP013-NO-ROLLBACK TO TRUE                            37170001
354500         MOVE '6010-DELETE-SEL-QUEUE' TO DP013-PARAGRAPH          37180001
354600         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         37190001
354700                                        TO DP013-MESSAGE-TEXT (1) 37200001
354800         PERFORM DP013-0000-PROCESS-ABEND                         37210001
354900     END-IF.                                                      37220001
355000                                                                  37230001
355100*----------------------------------------------------------------*37240001
355200*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *37250001
355300*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *37260001
355400*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *37270001
355500*    THE TEMP QUEUE.                                             *37280001
355600*----------------------------------------------------------------*37290001
355700 6100-UPDATE-TSQ.                                                 37300001
355800                                                                  37310001
355900     ADD 1    TO  PV-SEL-QUEUE-ITEM.                              37320001
356000     PERFORM 6105-READ-SEL-QUEUE.                                 37330001
356100     PERFORM                                                      37340001
356200         VARYING SU099-IDX FROM 1 BY 1                            37350005
356300         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     37360001
356400         OR (SU099-IDX GREATER THAN SU099-MAX-ITEMS))             37370005
356500         IF  SU099-ACTION-SW (SU099-IDX) > SPACE                  37380005
356600             PERFORM 6110-PROCESS-ITEMS                           37390001
356700         END-IF                                                   37400001
356800         ADD +1                TO PV-ITEMS-PROCESSED              37410001
356900     END-PERFORM.                                                 37420001
357000     PERFORM 6111-WRITE-LIST-QUEUE.                               37430001
357100                                                                  37440001
357200*----------------------------------------------------------------*37450001
357300*    READ THE LIST QUEUE RECORD.                                 *37460001
357400*----------------------------------------------------------------*37470001
357500 6105-READ-SEL-QUEUE.                                             37480001
357600                                                                  37490001
357700     EXEC CICS                                                    37500001
357800          READQ TS                                                37510001
357900              QUEUE (ASC-SEL-QUEUE-NAME)                          37520001
358000              INTO  (SU099-SELECT-RECORD)                         37530005
358100              ITEM  (PV-SEL-QUEUE-ITEM)                           37540001
358200              RESP  (PV-CICS-RESP)                                37550001
358300     END-EXEC.                                                    37560001
358400*                                                                 37570001
358500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37580001
358600         CONTINUE                                                 37590001
358700     ELSE                                                         37600001
358800         SET DP013-CICS-ABEND      TO  TRUE                       37610001
358900         SET DP013-NO-ROLLBACK     TO  TRUE                       37620001
359000         MOVE '6105-READ-SEL-QUEUE'                               37630001
359100                                   TO  DP013-PARAGRAPH            37640001
359200         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           37650001
359300                                   TO  DP013-MESSAGE-TEXT(1)      37660001
359400         PERFORM DP013-0000-PROCESS-ABEND                         37670001
359500     END-IF.                                                      37680001
359600                                                                  37690001
359700*----------------------------------------------------------------*37700001
359800*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*37710001
359900*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*37720001
360000*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *37730001
360100*----------------------------------------------------------------*37740001
360200 6110-PROCESS-ITEMS.                                              37750001
360300                                                                  37760001
360400     COMPUTE PV-ITEM = 1 + ((SU099-ITEM (SU099-IDX) - 1)          37770005
360500                     / PC-ITEMS-PER-PANEL).                       37780001
360600                                                                  37790001
360700     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           37800001
360800         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          37810001
360900             PERFORM 6111-WRITE-LIST-QUEUE                        37820001
361000         END-IF                                                   37830001
361100         MOVE PV-ITEM          TO PV-SAVE-ITEM                    37840001
361200                                                                  37850001
361300         PERFORM 6112-READ-LIST-QUEUE                             37860001
361400         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               37870001
361500             CONTINUE                                             37880001
361600         END-IF                                                   37890001
361700     END-IF.                                                      37900001
361800                                                                  37910001
361900     COMPUTE PV-SUB = (SU099-ITEM (SU099-IDX)                     37920005
362000                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              37930001
362100     SET LQW-DESELECT (PV-SUB) TO    TRUE                         37940001
362200     MOVE LQW-SELECTED-SW (PV-SUB)                                37950001
362300                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  37960001
362400     EVALUATE TRUE                                                37970001
362500         WHEN SU099-INQ (SU099-IDX)                               37980005
362600              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             37990001
362700                                                                  38000001
362800         WHEN SU099-UPD (SU099-IDX)                               38010005
362900              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             38020001
363000                                                                  38030001
363100         WHEN SU099-DEL (SU099-IDX)                               38040005
363200              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             38050001
363300                                                                  38060001
363400         WHEN SU099-ERR (SU099-IDX)                               38070005
363500              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             38080001
363600                                                                  38090001
363700         WHEN OTHER                                               38100001
363800              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             38110001
363900                                                                  38120001
364000     END-EVALUATE.                                                38130001
364100                                                                  38140001
364200     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                38150001
364300                                                                  38160001
364400*----------------------------------------------------------------*38170001
364500*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *38180001
364600*----------------------------------------------------------------*38190001
364700 6111-WRITE-LIST-QUEUE.                                           38200001
364800                                                                  38210001
364900     EXEC CICS                                                    38220001
365000         WRITEQ TS                                                38230001
365100             QUEUE (ASC-LIST-QUEUE-NAME)                          38240001
365200             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     38250001
365300             ITEM  (PV-SAVE-ITEM)                                 38260001
365400             REWRITE                                              38270001
365500             RESP  (PV-CICS-RESP)                                 38280001
365600     END-EXEC.                                                    38290001
365700*                                                                 38300001
365800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          38310001
365900         CONTINUE                                                 38320001
366000     ELSE                                                         38330001
366100         SET DP013-CICS-ABEND  TO  TRUE                           38340001
366200         SET DP013-NO-ROLLBACK TO  TRUE                           38350001
366300         MOVE '6111-WRITE-LIST-QUEUE' TO  DP013-PARAGRAPH         38360001
366400         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  38370001
366500                               TO  DP013-MESSAGE-TEXT(1)          38380001
366600         PERFORM DP013-0000-PROCESS-ABEND                         38390001
366700     END-IF.                                                      38400001
366800                                                                  38410001
366900*----------------------------------------------------------------*38420001
367000*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*38430001
367100*----------------------------------------------------------------*38440001
367200 6112-READ-LIST-QUEUE.                                            38450001
367300     EXEC CICS                                                    38460001
367400         READQ TS                                                 38470001
367500             QUEUE (ASC-LIST-QUEUE-NAME)                          38480001
367600             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     38490001
367700             ITEM  (PV-ITEM)                                      38500001
367800             RESP  (PV-CICS-RESP)                                 38510001
367900     END-EXEC.                                                    38520001
368000*                                                                 38530001
368100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          38540001
368200         CONTINUE                                                 38550001
368300     ELSE                                                         38560001
368400         SET DP013-CICS-ABEND        TO TRUE                      38570001
368500         SET DP013-NO-ROLLBACK       TO TRUE                      38580001
368600         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           38590001
368700         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    38600001
368800                                     TO DP013-MESSAGE-TEXT(1)     38610001
368900         PERFORM DP013-0000-PROCESS-ABEND                         38620001
369000     END-IF.                                                      38630001
369100                                                                  38640028
369200*----------------------------------------------------------------*38650028
369300*                                                                 38660099
369400*----------------------------------------------------------------*38670028
369500 6900-SELECT-BAR-CODE.                                            38680099
369600                                                                  38690028
369700     MOVE ASC-BRCDE-NBR   TO DK-BRCDE-NBR.                        38700099
369800     EXEC SQL                                                     38710099
369900        SELECT                                                    38720099
370000                A.BRCDE_NBR                                       38730099
370100               ,A.CRE_TMST                                        38740099
370200               ,A.AUD_CNTL_NBR                                    38750099
370300               ,A.SHIPT_UNT_ID                                    38760099
370400               ,A.AUD_STAT_CDE                                    38770099
370500               ,A.PO_LNE_NBR                                      38780099
370600               ,A.PO_NBR                                          38790099
370700               ,A.RCVR_SEQ_NBR                                    38800099
370800               ,A.PREPK_ID                                        38810099
370900               ,A.STR_NBR                                         38820099
371000               ,A.STR_ZN_ID                                       38830099
371100               ,A.SEASET_YR                                       38840099
371200               ,A.SEASET_SHRT_NM                                  38850099
371300               ,A.AUD_FALR_RSN_NM                                 38860099
371400          INTO :SUT00102-BRCDE-NBR                                38870099
371500              ,:SUT00102-CRE-TMST                                 38880099
371600              ,:SUT00102-AUD-CNTL-NBR                             38890099
371700              ,:SUT00102-SHIPT-UNT-ID                             38900099
371800              ,:SUT00102-AUD-STAT-CDE                             38910099
371900              ,:SUT00102-PO-LNE-NBR                               38920099
372000              ,:SUT00102-PO-NBR                                   38930099
372100              ,:SUT00102-RCVR-SEQ-NBR                             38940099
372200              ,:SUT00102-PREPK-ID                                 38950099
372300              ,:SUT00102-STR-NBR                                  38960099
372400              ,:SUT00102-STR-ZN-ID                                38970099
372500              ,:SUT00102-SEASET-YR                                38980099
372600              ,:SUT00102-SEASET-SHRT-NM                           38990099
372700              ,:SUT00102-AUD-FALR-RSN-NM                          39000099
372800       FROM  SUT_CART_DIRV_TRKG   A                               39010099
372900      WHERE  A.BRCDE_NBR      = :DK-BRCDE-NBR                     39020099
373000        AND  A.CRE_TMST       =                                   39030099
373100               ( SELECT MAX (CRE_TMST)                            39040099
373200                 FROM SUT_CART_DIRV_TRKG B                        39050099
373300                 WHERE B.BRCDE_NBR  =  A.BRCDE_NBR                39060099
373400                 )                                                39070099
373500        AND  A.LGCL_LOC_NM  IN                                    39080099
373600   (                                                              39090099
373700       SELECT DISTINCT(E.ATTR_ELEM_TXT)                           39100099
373800       FROM WST_INTGRTN_TYP A                                     39110099
373900          , WST_ATTR_DEFN           B                             39120099
374000          , WST_ATTR_ELEM           C                             39130099
374100          , WST_ATTR_ELEM           D                             39140099
374200          , WST_ATTR_ELEM           E                             39150099
374300          , WST_ATTR_ELEM           F                             39160099
374400          , WST_ATTR_ELEM           G                             39170099
374500          , WST_ATTR_ELEM           H                             39180099
374600          , WST_ATTR_ELEM           I                             39190099
374700          , WST_ATTR_ELEM           J                             39200099
374800          , WST_ATTR_ELEM           K                             39210099
374900       WHERE A.INTGRTN_TYP_CDE   = 'ACAULGDST'                    39220099
375000         AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE              39230099
375100         AND A.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE              39240099
375200         AND A.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE              39250099
375300         AND A.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE              39260099
375400         AND A.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE              39270099
375500         AND A.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE              39280099
375600         AND A.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE              39290099
375700         AND A.INTGRTN_TYP_CDE   = I.INTGRTN_TYP_CDE              39300099
375800         AND A.INTGRTN_TYP_CDE   = J.INTGRTN_TYP_CDE              39310099
375900         AND A.INTGRTN_TYP_CDE   = K.INTGRTN_TYP_CDE              39320099
376000         AND B.ATTR_DEFN_SEQ_NBR = 1                              39330099
376100         AND C.ATTR_DEFN_SEQ_NBR = 1                              39340099
376200         AND D.ATTR_DEFN_SEQ_NBR = 2                              39350099
376300         AND E.ATTR_DEFN_SEQ_NBR = 3                              39360099
376400         AND F.ATTR_DEFN_SEQ_NBR = 4                              39370099
376500         AND G.ATTR_DEFN_SEQ_NBR = 5                              39380099
376600         AND H.ATTR_DEFN_SEQ_NBR = 6                              39390099
376700         AND I.ATTR_DEFN_SEQ_NBR = 7                              39400099
376800         AND J.ATTR_DEFN_SEQ_NBR = 8                              39410099
376900         AND K.ATTR_DEFN_SEQ_NBR = 9                              39420099
377000         AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR            39430099
377100         AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR            39440099
377200         AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR            39450099
377300         AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR            39460099
377400         AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR            39470099
377500         AND C.ATTR_ELEM_SEQ_NBR = I.ATTR_ELEM_SEQ_NBR            39480099
377600         AND C.ATTR_ELEM_SEQ_NBR = J.ATTR_ELEM_SEQ_NBR            39490099
377700         AND C.ATTR_ELEM_SEQ_NBR = K.ATTR_ELEM_SEQ_NBR            39500099
377800         AND F.ATTR_ELEM_TXT     = 'Y'                            39510099
377900         AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP            39520099
378000         AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP            39530099
378100         AND C.ATTR_ELEM_NBR     = :DK-OPER-UNT-ID                39540099
378200         AND K.ATTR_ELEM_TXT     = 'Y'                            39550099
378300                                        )                         39560099
378400     END-EXEC.                                                    39570099
378500                                                                  39580028
378600     EVALUATE TRUE                                                39590028
378700         WHEN SQLCODE = ZERO                                      39600028
378800              MOVE SUT00102-PO-NBR      TO DK-PO-NBR              39610099
378900                                           ASC-PO-NBR             39620099
379000              MOVE SUT00102-RCVR-SEQ-NBR TO DK-REC-SEQ-NBR        39630099
379100                                           ASC-REC-SEQ-NBR        39640099
379200              MOVE SUT00102-PO-LNE-NBR   TO DK-PO-LNE-NBR         39650099
379300                                           ASC-PO-LNE-NBR         39660099
379400              MOVE SUT00102-PREPK-ID     TO DK-PREPK-ID           39670099
379500                                           ASC-PO-LNE-NBR         39680099
379600              MOVE SUT00102-AUD-CNTL-NBR TO DK-AUD-CNTL-NBR       39690099
379700                                                                  39700099
379800         WHEN SQLCODE = +100                                      39710028
379900              CONTINUE                                            39720099
380000                                                                  39730099
380100         WHEN SQLWARN0 NOT = SPACE                                39740028
380200         WHEN SQLCODE NOT = ZERO                                  39750028
380300              MOVE '6900-SELECT-BAR-CODE  ' TO                    39760099
380400                                   DP013-PARAGRAPH                39770028
380500              MOVE 'SELECT FOR BAD   ' TO                         39780099
380600                                   DP013-MESSAGE-TEXT (1)         39790028
380700              MOVE SQLCA       TO DP013-SQLCA                     39800028
380800              MOVE 'SUT-CART-DIRV-TRKG' TO                        39810099
380900                                   DP013-DB2-TABLE-NAME (1)       39820028
381000              SET DP013-DB2-ABEND                                 39830028
381100                  DP013-XCTL-DISPLAY-RESTART TO TRUE              39840028
381200              PERFORM DP013-0000-PROCESS-ABEND                    39850028
381300     END-EVALUATE.                                                39860028
381400                                                                  39870099
381500*----------------------------------------------------------------*39880099
381600*    FIND PACK TYPE                                               39890099
381700*----------------------------------------------------------------*39900099
381800 7000-SELECT-TRECEIV.                                             39910099
381900                                                                  39920099
382000     MOVE ASC-PO-NBR      TO DK-PO-NBR.                           39930099
382100     MOVE ASC-REC-SEQ-NBR TO DK-REC-SEQ-NBR.                      39940099
382200                                                                  39950099
382300     EXEC SQL                                                     39960099
382400         SELECT  OPER_UNT_ID                                      39970099
382500                ,PACK_BY_ST_IND                                   39980099
382600                ,PKGNG_CDE                                        39990099
382700           INTO  :RECEIV-OPER-UNT-ID                              40000099
382800                ,:RECEIV-PACK-BY-ST-IND                           40010099
382900                ,:RECEIV-PKGNG-CDE                                40020099
383000           FROM  TRECEIV                                          40030099
383100          WHERE  ORD_NBR       =  :DK-PO-NBR                      40040099
383200            AND  REC_SEQ_NBR   =  :DK-REC-SEQ-NBR                 40050099
383300     END-EXEC.                                                    40060099
383400                                                                  40070099
383500     EVALUATE TRUE                                                40080099
383600         WHEN SQLCODE = ZERO                                      40090099
383800              EVALUATE RECEIV-PKGNG-CDE                           40100099
383900                  WHEN 'M'                                        40110099
384000                  WHEN 'I'                                        40120099
384100                       SET ASC-PREPK-ORDER TO TRUE                40130099
384200                  WHEN ' '                                        40140099
384300                       SET ASC-PACK-BY-STORE-ORDER TO TRUE        40150099
384400                  WHEN OTHER                                      40160099
384500                       SET ASC-BULK-CASE-ORDER TO TRUE            40170099
384600              END-EVALUATE                                        40180099
384700              IF RECEIV-PACK-BY-ST-IND = PC-Y                     40190099
384800                 MOVE PC-PACK-BY-STORE    TO ASC-PACK-TYPE        40200099
384900              ELSE                                                40210099
385000              EVALUATE RECEIV-PKGNG-CDE                           40220099
385100                  WHEN 'M'                                        40230099
385200                       MOVE PC-MULTIPLE-SKU-PPK TO ASC-PACK-TYPE  40240099
385300                  WHEN 'S'                                        40250099
385400                       MOVE PC-SINGLE-SKU-PPK   TO ASC-PACK-TYPE  40260099
385500                  WHEN 'I'                                        40270099
385600                       MOVE PC-INNER-PPK        TO ASC-PACK-TYPE  40280099
385700                  WHEN 'B'                                        40290099
385800                       MOVE PC-BULK-PPK         TO ASC-PACK-TYPE  40300099
385900                  WHEN 'C'                                        40310099
386000                       MOVE PC-CASEPACK         TO ASC-PACK-TYPE  40320099
386100                  WHEN OTHER                                      40330099
386200                       MOVE PC-OTHER            TO ASC-PACK-TYPE  40340099
386300              END-EVALUATE                                        40350099
386400              END-IF                                              40360099
386500         WHEN SQLCODE = +100                                      40370099
386600              CONTINUE                                            40380099
386700                                                                  40390099
386800         WHEN SQLWARN0 NOT = SPACE                                40400099
386900         WHEN SQLCODE NOT = ZERO                                  40410099
387000              MOVE '7000-SELECT-TRECEIV   ' TO                    40420099
387100                                   DP013-PARAGRAPH                40430099
387200              MOVE 'SELECT FOR PO BAD' TO                         40440099
387300                                   DP013-MESSAGE-TEXT (1)         40450099
387400              MOVE SQLCA       TO DP013-SQLCA                     40460099
387500              MOVE 'TRECEIV           ' TO                        40470099
387600                                   DP013-DB2-TABLE-NAME (1)       40480099
387700              SET DP013-DB2-ABEND                                 40490099
387800                  DP013-XCTL-DISPLAY-RESTART TO TRUE              40500099
387900              PERFORM DP013-0000-PROCESS-ABEND                    40510099
388000     END-EVALUATE.                                                40520099
388100                                                                  40530099
388200*----------------------------------------------------------------*40540028
388300*    USE AUDIT CONTROL NUMBER TO                                  40550028
388400*----------------------------------------------------------------*40560028
388500 7020-SELECT-AUD-CNTL-NBR.                                        40570028
388600                                                                  40580028
388700     MOVE ASC-AUDIT-CNTL-NBR   TO DK-AUD-CNTL-NBR.                40590028
388800                                                                  40600028
388900     EXEC SQL                                                     40610028
389000        SELECT                                                    40620028
389100                S015.PO_NBR                                       40630028
389200               ,S015.RCVR_SEQ_NBR                                 40640028
389300               ,S015.PO_LNE_NBR                                   40650028
389400               ,S015.PO_PREPK_ID                                  40660028
389500               ,S015.DIRV_RLSE_IND                                40670028
389600          INTO                                                    40680028
389700                :SUT00015-PO-NBR                                  40690028
389800               ,:SUT00015-RCVR-SEQ-NBR                            40700028
389900               ,:SUT00015-PO-LNE-NBR                              40710028
390000               ,:SUT00015-PO-PREPK-ID                             40720028
390100               ,:SUT00015-DIRV-RLSE-IND                           40730028
390200                                                                  40740028
390300          FROM  SUT_PO_AUD_REQ   S015                             40750028
390400         WHERE  S015.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR              40760028
390500          WITH  UR                                                40770028
390600     END-EXEC.                                                    40780028
390700                                                                  40790028
390800     EVALUATE TRUE                                                40800028
390900         WHEN SQLCODE = ZERO                                      40810028
391100              MOVE SUT00015-PO-NBR        TO ASC-PO-NBR           40820028
391200              MOVE SUT00015-RCVR-SEQ-NBR  TO ASC-REC-SEQ-NBR      40830055
391300              MOVE SUT00015-PO-LNE-NBR    TO ASC-PO-LNE-NBR       40840028
391400              MOVE SUT00015-PO-PREPK-ID   TO ASC-PREPACK-ID       40850053
391500         WHEN SQLCODE = +100                                      40860028
391600              CONTINUE                                            40870028
391700         WHEN SQLWARN0 NOT = SPACE                                40880028
391800         WHEN SQLCODE NOT = ZERO                                  40890028
391900              MOVE '7020-SELECT-AUD-CNTL-NBR  ' TO                40900028
392000                                   DP013-PARAGRAPH                40910028
392100              MOVE 'SELECT FOR PO BAD' TO                         40920028
392200                                   DP013-MESSAGE-TEXT (1)         40930028
392300              MOVE SQLCA       TO DP013-SQLCA                     40940028
392400              MOVE 'SUT-PO-AUD-REQ    ' TO                        40950028
392500                                   DP013-DB2-TABLE-NAME (1)       40960028
392600              SET DP013-DB2-ABEND                                 40970028
392700                  DP013-XCTL-DISPLAY-RESTART TO TRUE              40980028
392800              PERFORM DP013-0000-PROCESS-ABEND                    40990028
392900     END-EVALUATE.                                                41000028
393000                                                                  41010028
393100*----------------------------------------------------------------*41020028
393200*    FIND SCAC AND TRAILER INFORMATION                            41030058
393300*----------------------------------------------------------------*41040028
393400 7030-FIND-SCAC-TRAILER.                                          41050058
393500                                                                  41060028
393600     MOVE ASC-PO-NBR      TO DK-PO-NBR.                           41070055
393700     MOVE ASC-REC-SEQ-NBR TO DK-REC-SEQ-NBR.                      41080055
393800                                                                  41090028
393900     EXEC SQL                                                     41100028
394000         SELECT                                                   41110028
394100                A.OWNER_SCAC_ID                                   41120028
394200               ,A.VEH_NBR                                         41130028
394300               ,A.TRIP_ID                                         41140028
394400          INTO                                                    41150028
394500                :VHTRIP-OWNER-SCAC-ID                             41160028
394600               ,:VHTRIP-VEH-NBR   :DN-VEH-NBR                     41170028
394700               ,:VHTRIP-TRIP-ID                                   41180028
394800         FROM  TVHTRIP   A                                        41190028
394900              ,TSHIPMT   B                                        41200028
395000              ,TSHPTPO   C                                        41210028
395100        WHERE  A.TRIP_ID     = B.TRIP_ID                          41220028
395200          AND  C.SHIPT_ID    = B.SHIPT_ID                         41230028
395300          AND  C.PO_NBR      = :DK-PO-NBR                         41240028
395400          AND  C.REC_SEQ_NBR = :DK-REC-SEQ-NBR                    41250028
395500     END-EXEC.                                                    41260028
395600                                                                  41270028
395700     EVALUATE TRUE                                                41280028
395800         WHEN SQLCODE = ZERO                                      41290028
395900         WHEN SQLCODE = -811                                      41300028
396000              MOVE VHTRIP-OWNER-SCAC-ID  TO ASC-SCAC              41310028
396100              MOVE VHTRIP-TRIP-ID        TO ASC-TRIP-ID           41320028
396200              IF DN-VEH-NBR = 0                                   41330028
396300                 MOVE VHTRIP-VEH-NBR TO ASC-TRAILER               41340028
396400              ELSE                                                41350028
396500                 MOVE SPACES         TO ASC-TRAILER               41360028
396600              END-IF                                              41370028
396700                                                                  41380028
396800         WHEN SQLCODE = +100                                      41390028
396900              MOVE SPACES         TO ASC-SCAC                     41400028
397000              MOVE ZEROES         TO ASC-TRIP-ID                  41410028
397100              MOVE SPACES         TO ASC-TRAILER                  41420028
397200                                                                  41430028
397300         WHEN SQLWARN0 NOT = SPACE                                41440028
397400         WHEN SQLCODE NOT = ZERO                                  41450028
397500              MOVE '7030-FIND-SCAC-TRAILER'    TO                 41460058
397600                                   DP013-PARAGRAPH                41470028
397700              MOVE 'SELECT FOR PO BAD' TO                         41480028
397800                                   DP013-MESSAGE-TEXT (1)         41490028
397900              MOVE SQLCA       TO DP013-SQLCA                     41500028
398000              MOVE 'TVHTRIP TSHIPMT   ' TO                        41510028
398100                                   DP013-DB2-TABLE-NAME (1)       41520028
398200              MOVE 'TSHPTPO           ' TO                        41530028
398300                                   DP013-DB2-TABLE-NAME (2)       41540028
398400              SET DP013-DB2-ABEND                                 41550028
398500                  DP013-XCTL-DISPLAY-RESTART TO TRUE              41560028
398600              PERFORM DP013-0000-PROCESS-ABEND                    41570028
398700     END-EVALUATE.                                                41580028
398800                                                                  41590058
398900*----------------------------------------------------------------*41600058
399000*                                                                 41610058
399100*----------------------------------------------------------------*41620058
399200 7040-FIND-MAX-STATUS.                                            41630058
399300                                                                  41640058
399400     MOVE ASC-TRIP-ID       TO DK-TRIP-ID.                        41650058
399500                                                                  41660058
399600     EXEC SQL                                                     41670058
399700          SELECT MAX(STATUS_DTE)                                  41680058
399800                ,MAX(STATUS_TME)                                  41690058
399900                ,TRIP_STATUS_CDE                                  41700058
400000          INTO  :DK-STATUS-DATE                                   41710061
400100               ,:DK-STATUS-TIME                                   41720061
400200               ,:TRIPST-TRIP-STATUS-CDE                           41730058
400300          FROM   TVHTRIP A                                        41740058
400400                ,TTRIPST B                                        41750058
400500          WHERE A.TRIP_ID = :DK-TRIP-ID                           41760058
400600            AND A.TRIP_ID =  B.TRIP_ID                            41770058
400700            AND B.STATUS_DTE =                                    41780058
400800                 (SELECT MAX(D.STATUS_DTE)                        41790058
400900                    FROM TTRIPST D                                41800058
401000                  WHERE D.TRIP_ID = A.TRIP_ID)                    41810058
401100        GROUP BY TRIP_STATUS_CDE                                  41820058
401200     END-EXEC.                                                    41830058
401300                                                                  41840058
401400     EVALUATE TRUE                                                41850058
401500         WHEN SQLCODE = +0                                        41860058
401600         WHEN SQLCODE = -811                                      41870058
401800                                                                  41880099
401900              EVALUATE TRIPST-TRIP-STATUS-CDE                     41890099
402000                  WHEN 'AR'                                       41900099
402100                       MOVE 'ARRIVED'   TO ASC-TRAILER-STATUS     41910099
402200                  WHEN 'UN'                                       41920099
402300                       MOVE 'UNLOADED'  TO ASC-TRAILER-STATUS     41930099
402400                  WHEN 'UG'                                       41940099
402500                       MOVE 'UNLOADING' TO ASC-TRAILER-STATUS     41950099
402600                  WHEN 'EN'                                       41960099
402700                       MOVE 'ENROUTE'   TO ASC-TRAILER-STATUS     41970099
402800                  WHEN 'DP'                                       41980099
402900                       MOVE 'DEPARTED'  TO ASC-TRAILER-STATUS     41990099
403000                  WHEN 'ET'                                       42000099
403100                       MOVE 'END TRIP'  TO ASC-TRAILER-STATUS     42010099
403200              END-EVALUATE                                        42020099
403300              MOVE DK-STATUS-DATE         TO ASC-ARRIVE-DATE      42030088
403400         WHEN SQLCODE = +100                                      42040058
403500              MOVE SPACES                 TO ASC-TRAILER-STATUS   42050060
403600                                             ASC-ARRIVE-DATE      42060088
403700         WHEN SQLWARN0 NOT = SPACES                               42070058
403800         WHEN SQLCODE < +0                                        42080058
403900         WHEN SQLCODE > +0                                        42090058
404000             MOVE '7040-FIND-MAX-STATUS        '                  42100058
404100                                       TO DP013-PARAGRAPH         42110058
404200             MOVE '????                           '               42120058
404300                                 TO DP013-MESSAGE-TEXT (1)        42130058
404400             MOVE SQLCA      TO DP013-SQLCA                       42140058
404500             MOVE 'TVHTRIP     '  TO                              42150058
404600                                DP013-DB2-TABLE-NAME (1)          42160058
404700             MOVE 'TTRIPST     '  TO                              42170058
404800                                DP013-DB2-TABLE-NAME (2)          42180058
404900             SET DP013-DB2-ABEND                                  42190058
405000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               42200058
405100             PERFORM DP013-0000-PROCESS-ABEND                     42210058
405200     END-EVALUATE.                                                42220058
405300                                                                  42230028
405400*----------------------------------------------------------------*42240028
405500*    DETERMINE EXPECTED CARTONS                                   42250099
405600*----------------------------------------------------------------*42260028
405700 7080-SELECT-EXPECTED-CARTONS.                                    42270028
405800                                                                  42280028
405900     EXEC SQL                                                     42290028
406000         SELECT COUNT(*)                                          42300028
406100           INTO :PV-EXPECTED-CARTONS                              42310036
406200                                                                  42320028
406300           FROM  TSHIPMT   A                                      42330028
406400                ,TSHPTPO   B                                      42340028
406500                ,TPKSLIP   C                                      42350028
406600                ,TINPKSU   D                                      42360028
406700                ,TSHPUNT   E                                      42370028
406800                                                                  42380028
406900          WHERE  B.PO_NBR         = :DK-PO-NBR                    42390028
407000            AND  B.REC_SEQ_NBR    = :DK-REC-SEQ-NBR               42400028
407100            AND  B.PO_NBR         =  C.PO_NBR                     42410028
407200            AND  B.REC_SEQ_NBR    =  C.REC_SEQ_NBR                42420028
407300            AND  B.PRIM_SHIPT_IND = :PC-Y                         42430028
407400            AND  C.VER_STAT_CDE   = :PC-A                         42440028
407500            AND  B.PO_NBR         =  D.PO_NBR                     42450028
407600            AND  D.SEQ_NBR        =  C.SEQ_NBR                    42460028
407700            AND  A.SHIPT_ID       =  B.SHIPT_ID                   42470028
407800            AND  D.SHIPT_UNT_ID   =  E.SHIPT_UNT_ID               42480028
407900            AND  E.ACTV_IND       = :PC-A                         42490028
408000     END-EXEC.                                                    42500028
408100                                                                  42510028
408200     EVALUATE TRUE                                                42520028
408300         WHEN SQLCODE = ZERO                                      42530028
408400              MOVE PV-EXPECTED-CARTONS  TO ASC-EXPECTED-CARTONS   42540099
408500                                                                  42550099
408600         WHEN SQLCODE = +100                                      42560028
408700              MOVE ZEROS TO ASC-EXPECTED-CARTONS                  42570099
408800         WHEN SQLWARN0 NOT = SPACE                                42580028
408900         WHEN SQLCODE NOT = ZERO                                  42590028
409000              MOVE '7080-SELECT-EXPECTED-CARTONS'  TO             42600028
409100                                   DP013-PARAGRAPH                42610028
409200              MOVE 'SELECT FOR PO BAD' TO                         42620028
409300                                   DP013-MESSAGE-TEXT (1)         42630028
409400              MOVE SQLCA       TO DP013-SQLCA                     42640028
409500              MOVE 'TSHIPMT  TSHPTPO  ' TO                        42650028
409600                                   DP013-DB2-TABLE-NAME (1)       42660028
409700              MOVE 'TPKSLIP  TINPKSU  ' TO                        42670028
409800                                   DP013-DB2-TABLE-NAME (1)       42680028
409900              MOVE 'TSHPUNT           ' TO                        42690028
410000                                   DP013-DB2-TABLE-NAME (1)       42700028
410100              SET DP013-DB2-ABEND                                 42710028
410200                  DP013-XCTL-DISPLAY-RESTART TO TRUE              42720028
410300              PERFORM DP013-0000-PROCESS-ABEND                    42730028
410400     END-EVALUATE.                                                42740028
410500                                                                  42750095
410600******************************************************************42760095
410700*                                                                 42770095
410800*                                                                 42780095
410900******************************************************************42790095
411000 7100-DIRECTIVES-AVAIL.                                           42800095
411100                                                                  42810095
411200     MOVE ASC-OPER-UNT-ID  TO DK-OPER-UNT-ID.                     42820095
411300     MOVE ASC-REC-SEQ-NBR  TO DK-REC-SEQ-NBR.                     42830099
411500                                                                  42840095
411600     EXEC SQL                                                     42850095
411700         SELECT  COUNT(*)                                         42860095
411800                                                                  42870095
411900           INTO  :PV-DIRECTIVE-CARTONS                            42880095
412000                                                                  42890095
412100           FROM  SUT_CART_DIRV_TRKG   A                           42900095
412200          WHERE  A.OPER_UNT_ID       = :DK-OPER-UNT-ID            42910095
412300            AND  A.PO_NBR            = :DK-PO-NBR                 42920099
412400            AND  A.RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR            42930099
412500            AND  A.LGCL_LOC_NM       = :PC-CAROUSEL               42940095
412510            AND  A.DIRV_RSN_CDE   NOT IN ('AUQ' ,'RFD')           42950099
412600            AND  A.CRE_TMST          =                            42960095
412700                        (SELECT MAX(B.CRE_TMST)                   42970095
412800                           FROM SUT_CART_DIRV_TRKG  B             42980095
412900                          WHERE B.BRCDE_NBR = A.BRCDE_NBR)        42990095
413000     END-EXEC.                                                    43000095
413100                                                                  43010095
413200     EVALUATE TRUE                                                43020095
413300         WHEN SQLCODE = +0                                        43030095
413400              MOVE PV-DIRECTIVE-CARTONS TO ASC-DIRECTIVE-CARTONS  43040099
413500                                                                  43050095
413600         WHEN SQLCODE = +100                                      43060095
413700              MOVE ZEROS                TO ASC-DIRECTIVE-CARTONS  43070099
413800                                                                  43080099
413900         WHEN SQLWARN0 NOT = SPACES                               43090095
414000         WHEN SQLCODE < +0                                        43100095
414100         WHEN SQLCODE > +0                                        43110095
414200             MOVE '7100-DIRECTIVES-AVAIL       '                  43120095
414300                                       TO DP013-PARAGRAPH         43130095
414400             MOVE 'BAD SELECT                     '               43140095
414500                                 TO DP013-MESSAGE-TEXT (1)        43150095
414600             MOVE SQLCA      TO DP013-SQLCA                       43160095
414700             MOVE 'SUT_CART_DIRV_TRKG'  TO                        43170095
414800                                DP013-DB2-TABLE-NAME (1)          43180095
414900             SET DP013-DB2-ABEND                                  43190095
415000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               43200095
415100             PERFORM DP013-0000-PROCESS-ABEND                     43210095
415200     END-EVALUATE.                                                43220095
415300                                                                  43230028
415400                                                                  43240042
415500 7200-RACF-ACCESS.                                                43250042
415600                                                                  43260042
415700* IS THE USER AUTHORIZED TO RELEASE DIRECTIVES ON THIS SCREEN?    43270042
415800                                                                  43280042
415900      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  43290042
415910**??  SHOULD BE CHANGED BACK TO SUDIRRLS AFTER IT IS DEFINED      43300099
415920**??  TALK TO CATHY FAIRWEATHER.                                  43310099
416000      MOVE 'SUDIRRLS'                    TO DP008-FUNCTION-NAME   43320099
416010**??  MOVE 'RCPSINAC'                    TO DP008-FUNCTION-NAME   43330099
416100      SET DP008-ACCESS-TYPE-USE          TO TRUE                  43340042
416200                                                                  43350042
416300      EXEC CICS                                                   43360042
416400         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 43370042
416500              COMMAREA (DP008-SECURITY-COMMAREA)                  43380042
416600              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             43390042
416700      END-EXEC                                                    43400042
416800                                                                  43410042
416900      IF DP008-CALL-SUCCESSFUL                                    43420042
417000         IF DP008-ACCESS-ALLOWED                                  43430042
417100             SET PS-RELEASE-ALLOWED TO TRUE                       43440042
417200         ELSE                                                     43450042
417300             SET PS-RELEASE-NOT-ALLOWED TO TRUE                   43460042
417400         END-IF                                                   43470042
417500     ELSE                                                         43480042
417600         MOVE '7200-RACF-ACCESS'                                  43490042
417700                               TO DP013-PARAGRAPH                 43500042
417800          MOVE 'UNABLE TO ACCESS CICS'                            43510042
417900                               TO DP013-MESSAGE-TEXT (1)          43520042
418000          MOVE SQLCA                 TO DP013-SQLCA               43530042
418100          SET DP013-DB2-ABEND                                     43540042
418200              DP013-XCTL-DISPLAY-RESTART                          43550042
418300                               TO TRUE                            43560042
418400          PERFORM DP013-0000-PROCESS-ABEND                        43570042
418500      END-IF.                                                     43580042
418600                                                                  43590042
418700                                                                  43600042
418800 7400-BUILD-REQUEST.                                              43610081
418900                                                                  43620042
419000     INITIALIZE SU090-DG-REQUEST-COMMAREA.                        43630042
419100                                                                  43640042
419200     MOVE '00'                  TO SU090-RET-CODE.                43650043
419300     MOVE 'SUKCS765'            TO SU090-CALLING-PGM.             43660043
419400     SET  SU090-ONLINE          TO TRUE.                          43670043
419500                                                                  43680043
419600     MOVE ASC-OPER-UNT-ID       TO SU090-OPER-UNT-ID.             43690043
419700     SET SU090-ADD-ACTION       TO TRUE.                          43700043
419800     SET SU090-CARTON-DIRECTIVE TO TRUE.                          43710043
419900     MOVE PC-RLO                TO SU090-DIRV-RSN-CDE.            43720043
420000                                                                  43730051
420100     EVALUATE TRUE                                                43740043
420200         WHEN LQW-BRCDE-TYPE (LQW-IDX) = 'S'                      43750099
420300              MOVE 'S'     TO  SU090-BRCDE-TYP-CDE                43760080
420400              MOVE LQW-SHIPT-UNT-ID (LQW-IDX)                     43770099
420500                                TO  SU090-SML-BRCDE-NBR           43780087
420600              MOVE SPACES  TO  SU090-P2L-BRCDE-NBR                43790080
420700                                                                  43800043
420800         WHEN LQW-BRCDE-TYPE (LQW-IDX) = 'P'                      43810099
420900              MOVE 'P'     TO  SU090-BRCDE-TYP-CDE                43820080
421000              MOVE LQW-BARCODE (LQW-IDX)  TO                      43830099
421100                                    SU090-P2L-BRCDE-NBR           43840043
421200              MOVE ZEROES  TO  SU090-SML-BRCDE-NBR                43850080
421300                                                                  43860043
421400         WHEN OTHER                                               43870051
421500              MOVE SPACES  TO  SU090-BRCDE-TYP-CDE                43880080
421600              MOVE SPACES  TO  SU090-P2L-BRCDE-NBR                43890080
421700              MOVE ZEROES  TO  SU090-SML-BRCDE-NBR                43900080
421800                                                                  43910043
421900     END-EVALUATE.                                                43920043
422000                                                                  43930043
422100     MOVE ASC-PO-NBR            TO SU090-PO-NBR.                  43940043
422200                                                                  43950043
422300     EVALUATE TRUE                                                43960043
422400         WHEN ASC-PREPK-ORDER                                     43970043
422500              MOVE LQW-PREPK-ID (LQW-IDX) TO                      43980099
422700                                            SU090-PO-PREPK-ID     43990080
422800                                                                  44000080
422900         WHEN ASC-PACK-BY-STORE-ORDER                             44010043
423000              CONTINUE                                            44020043
423100                                                                  44030043
423200         WHEN ASC-BULK-CASE-ORDER                                 44040043
423300              MOVE LQW-LNE-NBR (LQW-IDX) TO                       44050099
423500                                            SU090-PO-LNE-NBR      44060043
423600                                                                  44070043
423700     END-EVALUATE.                                                44080043
423800                                                                  44090043
423900     MOVE ASC-REC-SEQ-NBR TO SU090-RCVR-SEQ-NBR.                  44100043
424000                                                                  44110042
424100     SET  SU090-ACTIVE-CART        TO TRUE.                       44120043
424200     MOVE LQW-AUD-CNTL-NBR (LQW-IDX) TO                           44130099
424400                                   SU090-AUD-CNTL-NBR             44140054
424500     MOVE LQW-AUD-STAT-CDE (LQW-IDX) TO                           44150099
424700                                   SU090-AUD-STAT-CDE             44160054
424800                                                                  44170042
424900     MOVE LQW-AUD-FALR-RSN-NM (LQW-IDX) TO                        44180099
425100                                      SU090-AUD-FAIL-RSN.         44190054
425200     MOVE LQW-STR-ZN-ID    (LQW-IDX) TO                           44200099
425400                                      SU090-STR-ZN.               44210063
425600     MOVE LQW-SEASET-YR    (LQW-IDX) TO                           44220099
425800                                      SU090-SEASET-YR.            44230054
425900     MOVE LQW-SEASET-SHRT-NM (LQW-IDX) TO                         44240099
426100                                      SU090-SEASET-CDE.           44250054
426200     MOVE LQW-STR-NBR      (LQW-IDX) TO                           44260099
426400                                      SU090-STR-NBR.              44270064
426500     MOVE DP020-USERID    TO SU090-ASSOC-ID.                      44280099
426600                                                                  44290043
      * 12/13 RLK BEG                                                   44300099
           PERFORM 7700-CHECK-FOR-PRV-RF-AUD-FAIL                       44310099
      ***NEED TO CHECK FOR RF PENDING/FAILED                            44320099
           IF PS-FAILED-PENDING-RF-FOUND                                44330099
             IF PS-FAILED-RF-AUD                                        44340099
      ***IF RF PENDING/FAILED WE WILL USE RF AUDIT AS SOURCE FOR DI     44350099
               MOVE PV-RFID-AUD-CNTL TO SU090-AUD-CNTL-NBR              44360099
               MOVE 'R'   TO SU090-CASI-CDE                             44370099
               MOVE 'RFD' TO SU090-DIRV-RSN-CDE                         44380099
             ELSE                                                       44390099
               MOVE 'U'   TO SU090-CASI-CDE                             44400099
               MOVE 'AUU' TO SU090-DIRV-RSN-CDE                         44410099
             END-IF                                                     44420099
           END-IF.                                                      44430099
      * 12/13 RLK END                                                   44440099
                                                                        44450099
426700     PERFORM 7600-SELECT-TPURCHS.                                 44460099
426800                                                                  44470099
427100******************************************************************44480042
427200*     CALL PGM SUKUT129. CHECK FOR ERRORS UPON RETURN            *44490042
427300******************************************************************44500042
427400 7500-CALL-SUKUT129.                                              44510053
427500                                                                  44520042
427510     INSPECT SU090-DG-REQUEST-COMMAREA                            44530099
427520         REPLACING ALL LOW-VALUES BY '?'.                         44540099
427530                                                                  44550099
427600     CALL SU090-DIRV-GEN-PGM USING DFHEIBLK                       44560043
427700                                SU090-COMMAREA                    44570042
427800                                SU090-DG-REQUEST-COMMAREA.        44580042
427900                                                                  44590042
428000     IF SU090-SUCCESS                                             44600053
428100        CONTINUE                                                  44610053
428200     ELSE                                                         44620042
428210         SET PS-ERROR                  TO TRUE                    44630099
428220         SET DP020-MSG-WARNING         TO TRUE                    44640099
428240                                                                  44650099
428300         MOVE SU090-SQLCA          TO DP013-SQLCA                 44660099
428500         MOVE '7500-CALL-SUKUT129' TO DP013-PARAGRAPH             44670099
428700         MOVE SU090-SQLCODE        TO PV-SQLCODE                  44680099
428800         MOVE SU090-MQ-COND-CODE   TO PV-MQ-COND-CODE             44690099
428900         MOVE SU090-MQ-REAS-CODE   TO PV-MQ-REAS-CODE             44700099
428910         MOVE PC-TSYMSG-03660      TO DP020-MSG-NUMBER            44710099
429000                                                                  44720059
429100         EVALUATE TRUE                                            44730099
429200             WHEN SU090-PARAMETER-ERROR                           44740099
429300                 SET PV-PARM-ERROR  TO TRUE                       44750099
429400                 MOVE '** INVALID PARM UPON RETURN FROM SUKUT129 '44760099
429500                   TO PV-ERROR-DESC                               44770099
429600             WHEN SU090-DB2-ERROR                                 44780099
429700                 SET PV-DB2-ERROR   TO TRUE                       44790099
429710                 STRING '** DB2 ERROR - '                         44800099
429720                        'PGM SUKUT129 - '                         44810099
429730                        'PARA - '         SU090-ERR-PARAGRAPH     44820099
429740                        ' SQLCODE =: '    PV-SQLCODE              44830099
429750                     DELIMITED BY SIZE INTO PV-SQLCODE            44840099
429760             WHEN SU090-MQ-ERROR                                  44850099
429770                 SET PV-MQ-ERROR    TO TRUE                       44860099
429780                 STRING '** MQ ERROR - '                          44870099
429790                        'PGM SUKUT129 - '                         44880099
429791                        'PARA - '         SU090-ERR-PARAGRAPH     44890099
429792                        ' MQCODE =: '     PV-MQ-COND-CODE         44900099
429793                     DELIMITED BY SIZE INTO PV-ERROR-DESC         44910099
429794             WHEN SU090-OTHER-ERROR                               44920099
429795                 SET PV-OTHER-ERROR TO TRUE                       44930099
429796                 STRING '** UNKNOWN ERROR UPON '                  44940099
429797                        'RETURN FROM SUKUT129 '                   44950099
429798                     DELIMITED BY SIZE INTO PV-ERROR-DESC         44960099
429799         END-EVALUATE                                             44970099
429800         PERFORM 9999-WRITE-CSSL-MSG                              44980099
429810      END-IF.                                                     44990053
429900                                                                  45000099
430000******************************************************************45010099
430100*                                                                 45020099
430200*                                                                 45030099
430300******************************************************************45040099
430400 7600-SELECT-TPURCHS.                                             45050099
430500                                                                  45060099
430600     MOVE ASC-PO-NBR       TO DK-PO-NBR.                          45070099
430700                                                                  45080099
430800     EXEC SQL                                                     45090099
430900         SELECT  ENT_ID                                           45100099
431000                                                                  45110099
431100           INTO  :PURCHS-ENT-ID                                   45120099
431200                                                                  45130099
431300           FROM  TPURCHS                                          45140099
431400          WHERE  PO_NBR           = :DK-PO-NBR                    45150099
431500     END-EXEC.                                                    45160099
431600                                                                  45170099
431700     EVALUATE TRUE                                                45180099
431800         WHEN SQLCODE = +0                                        45190099
431900         WHEN SQLCODE = -811                                      45200099
432000              CONTINUE                                            45210099
432100                                                                  45220099
432200         WHEN SQLCODE = +100                                      45230099
432300              MOVE 0   TO PURCHS-ENT-ID                           45240099
432400         WHEN SQLWARN0 NOT = SPACES                               45250099
432500         WHEN SQLCODE < +0                                        45260099
432600         WHEN SQLCODE > +0                                        45270099
432700             MOVE '7600-SELECT-TPURCHS         '                  45280099
432800                                       TO DP013-PARAGRAPH         45290099
432900             MOVE 'BAD SELECT                     '               45300099
433000                                 TO DP013-MESSAGE-TEXT (1)        45310099
433100             MOVE SQLCA      TO DP013-SQLCA                       45320099
433200             MOVE 'TPURCHS           '  TO                        45330099
433300                                DP013-DB2-TABLE-NAME (1)          45340099
433400             SET DP013-DB2-ABEND                                  45350099
433500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               45360099
433600             PERFORM DP013-0000-PROCESS-ABEND                     45370099
433700     END-EVALUATE.                                                45380099
433800/                                                                 45390099
      * 12/13 RLK BEG                                                   45400099
430000******************************************************************45410099
430100* GET ANY FAILED/PENDING RFID AUDITS                              45420099
430200*                                                                 45430099
430300******************************************************************45440099
430400 7700-CHECK-FOR-PRV-RF-AUD-FAIL.                                  45450099
430500                                                                  45460099
 30600     MOVE LQW-AUD-CNTL-NBR (LQW-IDX) TO DK-AUD-CNTL-NBR.          45470099
430600     MOVE ASC-OPER-UNT-ID            TO DK-OPER-UNT-ID.           45480099
430600     MOVE ASC-PO-NBR                 TO SUT00015-PO-NBR.          45481099
430700                                                                  45490099
430800     EXEC SQL                                                     45500099
              SELECT B.AUD_STAT_CDE                                     45510099
                    ,B.AUD_CNTL_NBR                                     45520099
              INTO :SUT00015-AUD-STAT-CDE                               45530099
                  ,:PV-RFID-AUD-CNTL                                    45540099
              FROM SUT_PO_AUD_REQ A                                     45550099
                  ,SUT_PO_AUD_REQ B                                     45560099
              WHERE A.PO_NBR = :SUT00015-PO-NBR                         45570099
                AND A.OPER_UNT_ID  = :DK-OPER-UNT-ID                    45580099
                AND A.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                   45590099
                AND B.AUD_CNTL_NBR = A.RWRK_AUD_CNTL_NBR                45600099
                AND B.AUD_STAT_CDE IN ('I','F')                         45610099
431500     END-EXEC.                                                    45620099
431600                                                                  45630099
431700     EVALUATE TRUE                                                45640099
431800         WHEN SQLCODE = +0                                        45650099
                 MOVE SUT00015-AUD-STAT-CDE TO PS-RFID-AUDIT-NO-FAIL-SW 45660099
431800         WHEN SQLCODE = +100                                      45670099
                 SET PS-RFID-AUDIT-NO-FAIL TO TRUE                      45680099
432400         WHEN SQLWARN0 NOT = SPACES                               45690099
432500         WHEN SQLCODE < +0                                        45700099
432600         WHEN SQLCODE > +0                                        45710099
432700             MOVE '7700-CHECK-FOR-PRV-RF-AUD-FAIL'                45720099
432800                                       TO DP013-PARAGRAPH         45730099
432900             MOVE 'BAD SELECT                     '               45740099
433000                                 TO DP013-MESSAGE-TEXT (1)        45750099
433100             MOVE SQLCA      TO DP013-SQLCA                       45760099
433200             MOVE 'SUT_PO_AUD_REQ    '  TO                        45770099
433300                                DP013-DB2-TABLE-NAME (1)          45780099
433400             SET DP013-DB2-ABEND                                  45790099
433500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               45800099
433600             PERFORM DP013-0000-PROCESS-ABEND                     45810099
433700     END-EVALUATE.                                                45820099
433800/                                                                 45830099
      * 12/13 RLK END                                                   45840099
434100*----------------------------------------------------------------*45850099
434200* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *45860070
434300*----------------------------------------------------------------*45870070
434400 9100-READ-SEL-QUEUE.                                             45880070
434500                                                                  45890099
434600     EVALUATE TRUE                                                45900099
434700         WHEN DP020-INT-APPL-FORMAT-IND = '2'                     45910099
434800              EXEC CICS                                           45920099
434900                  READQ TS                                        45930099
435000                      QUEUE (ASC-SEL-QUEUE-NAME)                  45940099
435100                      INTO  (SU099-SELECT-RECORD)                 45950099
435200                      ITEM  (ASC-SEL-ITEM)                        45960099
435300                      RESP  (PV-CICS-RESPONSE)                    45970099
435400              END-EXEC                                            45980099
435500                                                                  45990070
435600                                                                  46000099
435700     END-EVALUATE.                                                46010099
435800                                                                  46020099
435900     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       46030070
436000         CONTINUE                                                 46040070
436100     ELSE                                                         46050070
436200         SET DP013-LOGIC-ABEND                                    46060070
436300             DP013-NO-ROLLBACK     TO TRUE                        46070070
436400         MOVE '9100-READ-SEL-QUEUE' TO DP013-PARAGRAPH            46080070
436500         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   46090070
436600                                   TO DP013-MESSAGE-TEXT (1)      46100070
436700         PERFORM DP013-0000-PROCESS-ABEND                         46110070
436800     END-IF.                                                      46120070
436900                                                                  46130070
437000*----------------------------------------------------------------*46140070
437100* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *46150070
437200*----------------------------------------------------------------*46160070
437300 9200-REWRITE-SEL-QUEUE.                                          46170070
437400                                                                  46180099
437500     EVALUATE TRUE                                                46190099
437600         WHEN DP020-INT-APPL-FORMAT-IND = '2'                     46200099
437700              EXEC CICS                                           46210099
437800                   WRITEQ TS                                      46220099
437900                       QUEUE  (ASC-SEL-QUEUE-NAME)                46230099
438000                       FROM   (SU099-SELECT-RECORD)               46240099
438100                       ITEM   (ASC-SEL-ITEM)                      46250099
438200                       RESP   (PV-CICS-RESPONSE)                  46260099
438300                       REWRITE                                    46270099
438400              END-EXEC                                            46280099
438500                                                                  46290099
438600                                                                  46300099
438700     END-EVALUATE.                                                46310099
438800                                                                  46320070
438900     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   46330070
439000         SET DP013-CICS-ABEND                                     46340070
439100             DP013-NO-ROLLBACK     TO TRUE                        46350070
439200         MOVE '9200-REWRITE-SEL-QUEUE'  TO DP013-PARAGRAPH        46360070
439300         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   46370070
439400                                   TO DP013-MESSAGE-TEXT (1)      46380070
439500         PERFORM DP013-0000-PROCESS-ABEND                         46390070
439600     END-IF.                                                      46400070
439700                                                                  46410099
439800*----------------------------------------------------------------*46420099
439900* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *46430099
440000*----------------------------------------------------------------*46440099
440100 9300-READ-SEL-QUEUE.                                             46450099
440200                                                                  46460099
440300     EVALUATE TRUE                                                46470099
440400         WHEN DP020-INT-APPL-FORMAT-IND = '3'                     46480099
440500              EXEC CICS                                           46490099
440600                  READQ TS                                        46500099
440700                      QUEUE (ASC-SEL-QUEUE-NAME)                  46510099
440800                      INTO  (SU102-SELECT-RECORD)                 46520099
440900                      ITEM  (ASC-SEL-ITEM)                        46530099
441000                      RESP  (PV-CICS-RESPONSE)                    46540099
441100              END-EXEC                                            46550099
441200                                                                  46560099
441300     END-EVALUATE.                                                46570099
441400                                                                  46580099
441500     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       46590099
441600         CONTINUE                                                 46600099
441700     ELSE                                                         46610099
441800         SET DP013-LOGIC-ABEND                                    46620099
441900             DP013-NO-ROLLBACK     TO TRUE                        46630099
442000         MOVE '9300-READ-SEL-QUEUE' TO DP013-PARAGRAPH            46640099
442100         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   46650099
442200                                   TO DP013-MESSAGE-TEXT (1)      46660099
442300         PERFORM DP013-0000-PROCESS-ABEND                         46670099
442400     END-IF.                                                      46680099
442500                                                                  46690099
442600*----------------------------------------------------------------*46700099
442700* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *46710099
442800*----------------------------------------------------------------*46720099
442900 9400-REWRITE-SEL-QUEUE.                                          46730099
443000                                                                  46740099
443100     EVALUATE TRUE                                                46750099
443200                                                                  46760099
443300         WHEN DP020-INT-APPL-FORMAT-IND = '3'                     46770099
443400              EXEC CICS                                           46780099
443500                   WRITEQ TS                                      46790099
443600                       QUEUE  (ASC-SEL-QUEUE-NAME)                46800099
443700                       FROM   (SU102-SELECT-RECORD)               46810099
443800                       ITEM   (ASC-SEL-ITEM)                      46820099
443900                       RESP   (PV-CICS-RESPONSE)                  46830099
444000                       REWRITE                                    46840099
444100              END-EXEC                                            46850099
444200                                                                  46860099
444300     END-EVALUATE.                                                46870099
444400                                                                  46880099
444500     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   46890099
444600         SET DP013-CICS-ABEND                                     46900099
444700             DP013-NO-ROLLBACK     TO TRUE                        46910099
444800         MOVE '9400-REWRITE-SEL-QUEUE'  TO DP013-PARAGRAPH        46920099
444900         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   46930099
445000                                   TO DP013-MESSAGE-TEXT (1)      46940099
445100         PERFORM DP013-0000-PROCESS-ABEND                         46950099
445200     END-IF.                                                      46960099
445300                                                                  46970099
445310******************************************************************46980099
445320* 9999-WRITE-CSSL-MSG                                            *46990099
445330*     WRITE SPECIFIC ERROR MESSAGES TO THE CSSL QUEUE            *47000099
445340******************************************************************47010099
445350 9999-WRITE-CSSL-MSG.                                             47020099
445360                                                                  47030099
445370     MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH.       47040099
445380                                                                  47050099
445390     EXEC CICS                                                    47060099
445391          WRITEQ TD                                               47070099
445392           QUEUE  ('CSSL')                                        47080099
445393            FROM  (PV-CICS-MSG-AREA)                              47090099
445394          LENGTH  (PV-COMMAREA-LENGTH)                            47100099
445395            RESP  (PV-CICS-RESPONSE)                              47110099
445396     END-EXEC.                                                    47120099
445397/                                                                 47130099
445400*----------------------------------------------------------------*47140001
445500*    ABEND PROCESSOR MODULE                                      *47150001
445600*----------------------------------------------------------------*47160001
445700     COPY DPPD013.                                                47170001
