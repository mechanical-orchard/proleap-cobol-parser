000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             RMKUT011.                                00050000
000600 AUTHOR.                 RICK TULLOCH.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN.           03-06-2014.                              00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*       CREATE INFOPAC RECIPIENT, COPY, REPORT AND VERSION       *00120000
001210*  EXTRACT FILES FROM THE DISTRIBUTION AND VERSION MASTER FILES  *00121000
001220*  FOR A SPECIFIC SUBSYSTEM.  CREATE ONE RECORD FOR EACH         *00122007
001230*  QUALIFYING INFOPAC RECORD (RECIPIENT (ON THE DISTRIBUTION     *00123007
001240*  FILE), COPY (COMPLETE REPORT AND SELECTIVE DISTRIBUTION COPY  *00124007
001250*  TYPES ON THE DISTRIBUTION FILE), REPORT (ON THE DISTRIBUTION  *00125007
001260*  FILE) AND VERSION (REPORT VERSION ON THE VERSION FILE).       *00126007
001319******************************************************************00131900
001320                                                                  00132000
001330******************************************************************00133000
001340 ENVIRONMENT DIVISION.                                            00134000
001350******************************************************************00135000
001360                                                                  00136000
001370 CONFIGURATION SECTION.                                           00137000
001380                                                                  00138000
001390 SOURCE-COMPUTER.        IBM-3090.                                00139000
001400 OBJECT-COMPUTER.        IBM-3090.                                00140000
001500                                                                  00150000
001600 INPUT-OUTPUT SECTION.                                            00160000
001700                                                                  00170000
001800 FILE-CONTROL.                                                    00180000
001900                                                                  00190000
002000     SELECT INFOPAC-DISTRIB-FILE                                  00200000
002100         ASSIGN TO INP01.                                         00210000
002200                                                                  00220000
002210     SELECT INFOPAC-VERSION-FILE                                  00221000
002220         ASSIGN TO INP02.                                         00222000
002230                                                                  00223000
004100     SELECT RECIPIENT-EXTRACT-FILE                                00410000
004200         ASSIGN TO OUT01.                                         00420000
004300                                                                  00430000
004400     SELECT COPY-EXTRACT-FILE                                     00440000
004500         ASSIGN TO OUT02.                                         00450000
004510                                                                  00451000
004520     SELECT REPORT-EXTRACT-FILE                                   00452000
004530         ASSIGN TO OUT03.                                         00453000
004540                                                                  00454000
004550     SELECT VERSION-EXTRACT-FILE                                  00455000
004560         ASSIGN TO OUT04.                                         00456000
004600                                                                  00460000
004700******************************************************************00470000
004800 DATA DIVISION.                                                   00480000
004900******************************************************************00490000
005000                                                                  00500000
005100 FILE SECTION.                                                    00510000
005200                                                                  00520000
005300 FD  INFOPAC-DISTRIB-FILE                                         00530000
005400     RECORDING MODE IS V                                          00540000
005500     LABEL RECORDS ARE STANDARD                                   00550000
005600     BLOCK CONTAINS 0 RECORDS                                     00560000
005700     RECORD CONTAINS 60 TO 2060 CHARACTERS                        00570000
005800     DATA RECORDS ARE ID-INFOPAC-DISTRIB-RECORD-MIN               00580000
005810                      ID-INFOPAC-DISTRIB-RECORD-MAX.              00581000
005900                                                                  00590000
006000 01  ID-INFOPAC-DISTRIB-RECORD-MIN                                00600000
006001                                 PIC X(60).                       00600100
006002 01  ID-INFOPAC-DISTRIB-RECORD-MAX                                00600200
006003                                 PIC X(2060).                     00600300
006004                                                                  00600400
006005 FD  INFOPAC-VERSION-FILE                                         00600500
006006     RECORDING MODE IS V                                          00600600
006007     LABEL RECORDS ARE STANDARD                                   00600700
006008     BLOCK CONTAINS 0 RECORDS                                     00600800
006009     RECORD CONTAINS 60 TO 1060 CHARACTERS                        00600900
006010     DATA RECORDS ARE IV-INFOPAC-VERSION-RECORD-MIN               00601000
006011                      IV-INFOPAC-VERSION-RECORD-MAX.              00601100
006012                                                                  00601200
006013 01  ID-INFOPAC-VERSION-RECORD-MIN                                00601300
006014                                 PIC X(60).                       00601400
006015 01  ID-INFOPAC-VERSION-RECORD-MAX                                00601500
006016                                 PIC X(1060).                     00601600
006020                                                                  00602000
012700 FD  RECIPIENT-EXTRACT-FILE                                       01270000
012800     RECORDING MODE IS F                                          01280000
012900     LABEL RECORDS ARE STANDARD                                   01290000
013000     BLOCK CONTAINS 0 RECORDS                                     01300000
013100     RECORD CONTAINS 150 CHARACTERS                               01310000
013200     DATA RECORD IS RE-RECIPIENT-EXTRACT-RECORD.                  01320000
013300                                                                  01330000
013400 01  RE-RECIPIENT-EXTRACT-RECORD PIC X(150).                      01340000
013410                                                                  01341000
013420 FD  COPY-EXTRACT-FILE                                            01342000
013430     RECORDING MODE IS F                                          01343000
013440     LABEL RECORDS ARE STANDARD                                   01344000
013450     BLOCK CONTAINS 0 RECORDS                                     01345000
013460     RECORD CONTAINS 150 CHARACTERS                               01346000
013470     DATA RECORD IS CE-COPY-EXTRACT-RECORD.                       01347000
013480                                                                  01348000
013490 01  CE-COPY-EXTRACT-RECORD      PIC X(150).                      01349000
013491                                                                  01349100
013492 FD  REPORT-EXTRACT-FILE                                          01349200
013493     RECORDING MODE IS F                                          01349300
013494     LABEL RECORDS ARE STANDARD                                   01349400
013495     BLOCK CONTAINS 0 RECORDS                                     01349500
013496     RECORD CONTAINS 100 CHARACTERS                               01349600
013497     DATA RECORD IS RE-REPORT-EXTRACT-RECORD.                     01349700
013498                                                                  01349800
013499 01  RE-REPORT-EXTRACT-RECORD    PIC X(100).                      01349900
013500                                                                  01350000
013501 FD  VERSION-EXTRACT-FILE                                         01350100
013502     RECORDING MODE IS F                                          01350200
013503     LABEL RECORDS ARE STANDARD                                   01350300
013504     BLOCK CONTAINS 0 RECORDS                                     01350400
013505     RECORD CONTAINS 100 CHARACTERS                               01350500
013506     DATA RECORD IS VE-VERSION-EXTRACT-RECORD.                    01350600
013507                                                                  01350700
013508 01  VE-VERSION-EXTRACT-RECORD   PIC X(100).                      01350800
013510                                                                  01351000
013600 WORKING-STORAGE SECTION.                                         01360000
013700                                                                  01370000
013800*                                                                 01380000
013900*  INFOPAC DISTRIBUTION FILE RECORD LAYOUT.                       01390000
014000*                                                                 01400000
014100                                                                  01410000
014200     COPY RMRD005.                                                01420000
014210                                                                  01421000
014220*                                                                 01422000
014230*  INFOPAC VERSION FILE RECORD LAYOUT.                            01423000
014240*                                                                 01424000
014250                                                                  01425000
014260     COPY RMRD006.                                                01426000
014270                                                                  01427000
014280*                                                                 01428000
014290*  INFOPAC RECIPIENT EXTRACT RECORD LAYOUT.                       01429000
014291*                                                                 01429100
014292                                                                  01429200
014293     COPY RMRD007.                                                01429300
014294                                                                  01429400
014295*                                                                 01429500
014296*  INFOPAC COPY EXTRACT RECORD LAYOUT.                            01429600
014297*                                                                 01429700
014298                                                                  01429800
014299     COPY RMRD008.                                                01429900
014300                                                                  01430000
014400*                                                                 01440000
014500*  INFOPAC REPORT EXTRACT RECORD LAYOUT.                          01450000
014600*                                                                 01460000
014700                                                                  01470000
014800     COPY RMRD009.                                                01480000
014900                                                                  01490000
015000*                                                                 01500000
015100*  INFOPAC VERSION EXTRACT RECORD LAYOUT.                         01510000
015200*                                                                 01520000
015300                                                                  01530000
015400     COPY RMRD010.                                                01540000
018000                                                                  01800000
018100 01  ABEND-CODE                  PIC S9(04)   VALUE ZERO          01810000
018200                                              COMP SYNC.          01820000
018700                                                                  01870000
018800 01  PS-PROGRAM-SWITCHES.                                         01880000
018900     05  PS-END-OF-DISTRIB-FILE-SW                                01890000
018910                                 PIC X(1)     VALUE 'N'.          01891000
019000         88  PS-END-OF-DISTRIB-FILE           VALUE 'Y'.          01900000
019010     05  PS-END-OF-VERSION-FILE-SW                                01901000
019020                                 PIC X(1)     VALUE 'N'.          01902000
019030         88  PS-END-OF-VERSION-FILE           VALUE 'Y'.          01903000
021100                                                                  02110000
021200 01  PC-PROGRAM-CONSTANTS.                                        02120000
021300     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'RMKUT011'.   02130000
022500     05  PC-TIMESTAMP-INVERSION  PIC 9(14) VALUE 99999999999999.  02250000
022600     05  PC-CLOSING-PARENTHESIS  PIC X(1)     VALUE ')'.          02260005
023900                                                                  02390000
024000 01  PV-PROGRAM-VARIABLES.                                        02400000
024100     05  PV-HOLD                 PIC S9(7)    VALUE ZEROS         02410000
024200                                              COMP-3.             02420000
026200                                                                  02620000
026300 01  PT-PROGRAM-TOTALS.                                           02630000
026400     05  PT-DISTRIB-RCDS-READ    PIC S9(9)    VALUE ZEROS         02640000
026500                                              COMP-3.             02650000
026510     05  PT-VERSION-RCDS-READ    PIC S9(9)    VALUE ZEROS         02651000
026520                                              COMP-3.             02652000
028400     05  PT-RECIPIENT-RCDS-WRITTEN                                02840000
028500                                 PIC S9(9)    VALUE ZEROS         02850000
028600                                              COMP-3.             02860000
028800     05  PT-COPY-RCDS-WRITTEN    PIC S9(9)    VALUE ZEROS         02880000
028910                                              COMP-3.             02891000
028920     05  PT-REPORT-RCDS-WRITTEN  PIC S9(9)    VALUE ZEROS         02892000
028940                                              COMP-3.             02894000
028950     05  PT-VERSION-RCDS-WRITTEN PIC S9(9)    VALUE ZEROS         02895000
028970                                              COMP-3.             02897000
029000                                                                  02900000
029100 01  TD-TOTAL-DISPLAY-MESSAGE.                                    02910000
029200     05  TD-TOTAL-ID             PIC X(52)    VALUE SPACES.       02920000
029300         88  TD-DISTRIB-RCDS-READ-ID          VALUE               02930000
029400             'INFOPAC DISTRIBUTION RECORDS READ . . . . . . . . '.02940000
029500         88  TD-VERSION-RCDS-READ-ID          VALUE               02950000
029600             'INFOPAC VERSION RECORDS READ  . . . . . . . . . . '.02960000
031500         88  TD-RECIPIENT-RCDS-WRITTEN-ID     VALUE               03150000
031600             'RECIPIENT EXTRACT RECORDS WRITTEN . . . . . . . . '.03160000
031700         88  TD-COPY-RCDS-WRITTEN-ID          VALUE               03170000
031800             'COPY EXTRACT RECORDS WRITTEN  . . . . . . . . . . '.03180000
031810         88  TD-REPORT-RCDS-WRITTEN-ID        VALUE               03181000
031820             'REPORT EXTRACT RECORDS WRITTEN  . . . . . . . . . '.03182000
031830         88  TD-VERSION-RCDS-WRITTEN-ID       VALUE               03183000
031840             'VERSION EXTRACT RECORDS WRITTEN . . . . . . . . . '.03184000
031900     05  TD-TOTAL-AMOUNT         PIC ZZZ,ZZZ,ZZ9                  03190000
032000                                              VALUE ZEROS.        03200000
041100                                                                  04110000
041200******************************************************************04120000
041300 PROCEDURE DIVISION.                                              04130000
041400******************************************************************04140000
041500                                                                  04150000
041600 0000-MAINLINE.                                                   04160000
041700                                                                  04170000
041800     PERFORM 1000-INITIALIZE.                                     04180000
041900                                                                  04190000
042000     PERFORM 2000-PROCESS-DISTRIB-RECORD                          04200000
042100         UNTIL PS-END-OF-DISTRIB-FILE.                            04210000
042110                                                                  04211000
042120     PERFORM 3000-PROCESS-VERSION-RECORD                          04212000
042130         UNTIL PS-END-OF-VERSION-FILE.                            04213000
046000                                                                  04600000
046100     PERFORM 1500-DISPLAY-PROGRAM-TOTALS.                         04610000
046200                                                                  04620000
046300     PERFORM 9000-EOJ-ROUTINE.                                    04630000
046400                                                                  04640000
046500     GOBACK.                                                      04650000
046600                                                                  04660000
046700******************************************************************04670000
046800*  INITIALIZE FOR PROGRAM PROCESSING.  OPEN ALL FILES.  PERFORM  *04680007
046900*  PRIMING READS ON THE INFOPAC DISTRIBUTION AND VERSION FILES.  *04690007
047700******************************************************************04770000
047800                                                                  04780000
047900 1000-INITIALIZE.                                                 04790000
048000     OPEN INPUT  INFOPAC-DISTRIB-FILE                             04800000
048100                 INFOPAC-VERSION-FILE                             04810000
048200          OUTPUT RECIPIENT-EXTRACT-FILE                           04820000
048700                 COPY-EXTRACT-FILE                                04870000
048710                 REPORT-EXTRACT-FILE                              04871000
048800                 VERSION-EXTRACT-FILE.                            04880000
053300                                                                  05330000
053400     PERFORM 7000-READ-DISTRIB-FILE.                              05340000
053500                                                                  05350000
053600     PERFORM 7100-READ-VERSION-FILE.                              05360000
053900*1000-EXIT.                                                       05390000
054000                                                                  05400000
084500******************************************************************08450000
084600*  DISPLAY SUMMARY TOTALS OF I/O ACTIVITY.                       *08460000
084700******************************************************************08470000
084800                                                                  08480000
084900 1500-DISPLAY-PROGRAM-TOTALS.                                     08490000
085000     DISPLAY ' '.                                                 08500000
085100                                                                  08510000
085200     SET TD-DISTRIB-RCDS-READ-ID TO TRUE.                         08520000
085300     MOVE PT-DISTRIB-RCDS-READ TO TD-TOTAL-AMOUNT.                08530000
085400     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       08540000
085500               TD-TOTAL-DISPLAY-MESSAGE.                          08550000
085600                                                                  08560000
085700     SET TD-VERSION-RCDS-READ-ID TO TRUE.                         08570000
085800     MOVE PT-VERSION-RCDS-READ TO TD-TOTAL-AMOUNT.                08580000
085900     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       08590000
086000               TD-TOTAL-DISPLAY-MESSAGE.                          08600000
090800                                                                  09080000
090900     DISPLAY ' '.                                                 09090000
091000                                                                  09100000
091100     SET TD-RECIPIENT-RCDS-WRITTEN-ID TO TRUE.                    09110000
091200     MOVE PT-RECIPIENT-RCDS-WRITTEN TO TD-TOTAL-AMOUNT.           09120000
091300     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       09130000
091400               TD-TOTAL-DISPLAY-MESSAGE.                          09140000
091500                                                                  09150000
091600     SET TD-COPY-RCDS-WRITTEN-ID TO TRUE.                         09160000
091700     MOVE PT-COPY-RCDS-WRITTEN TO TD-TOTAL-AMOUNT.                09170000
091800     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       09180000
091900               TD-TOTAL-DISPLAY-MESSAGE.                          09190000
091910                                                                  09191000
091920     SET TD-REPORT-RCDS-WRITTEN-ID TO TRUE.                       09192000
091930     MOVE PT-REPORT-RCDS-WRITTEN TO TD-TOTAL-AMOUNT.              09193000
091940     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       09194000
091950               TD-TOTAL-DISPLAY-MESSAGE.                          09195000
091960                                                                  09196000
091970     SET TD-VERSION-RCDS-WRITTEN-ID TO TRUE.                      09197000
091980     MOVE PT-VERSION-RCDS-WRITTEN TO TD-TOTAL-AMOUNT.             09198000
091990     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       09199000
091991               TD-TOTAL-DISPLAY-MESSAGE.                          09199100
092000*1500-EXIT.                                                       09200000
092100                                                                  09210000
092200******************************************************************09220000
092300*  CREATE RECIPIENT, COPY AND REPORT EXTRACT RECORDS FOR EVERY   *09230000
092400*  QUALIFYING INFOPAC DISTRIBUTION FILE RECORD.                  *09240000
093700******************************************************************09370000
093800                                                                  09380000
093900 2000-PROCESS-DISTRIB-RECORD.                                     09390000
102410     EVALUATE TRUE                                                10241000
102420         WHEN RM005-TI-RECIPIENT                                  10242000
102421              PERFORM 2100-CREATE-RECIPIENT                       10242100
102422         WHEN RM005-TI-COPY                                       10242200
102423              IF ((RM005-CR-CT-COMPLETE-REPORT)                   10242301
102424                      OR (RM005-CR-CT-SELECTIVE-DIST))            10242401
102425                  PERFORM 2200-CREATE-COPY                        10242501
102426              END-IF                                              10242601
102427         WHEN RM005-TI-REPORT                                     10242700
102428              PERFORM 2300-CREATE-REPORT                          10242800
102430         WHEN OTHER                                               10243000
102440              CONTINUE                                            10244000
102450     END-EVALUATE.                                                10245000
102600                                                                  10260000
102700     PERFORM 7000-READ-DISTRIB-FILE.                              10270000
102800*2000-EXIT.                                                       10280000
122601                                                                  12260101
122602******************************************************************12260201
122603*  CREATE A RECIPIENT EXTRACT RECORD.                            *12260307
122605******************************************************************12260501
122606                                                                  12260601
122607 2100-CREATE-RECIPIENT.                                           12260701
122608     INITIALIZE RM007-RECIPIENT-EXTR-RECORD.                      12260801
122609                                                                  12260901
122610     MOVE RM005-RR-RECIPIENT-ID TO RM007-RECIPIENT-ID.            12261001
122611     MOVE RM005-RR-RECIPIENT-NAME TO RM007-RECIPIENT-NAME.        12261101
122612     MOVE RM005-RR-RECIPIENT-TITLE TO RM007-RECIPIENT-TITLE.      12261201
122613     MOVE RM005-RR-RECIPIENT-ADDR-LINE-1 TO                       12261301
122614               RM007-RECIPIENT-ADDR-LINE-1.                       12261401
122615     MOVE RM005-RR-RECIPIENT-ID-SEQUENCE TO                       12261501
122616               RM007-RECIPIENT-ID-SEQUENCE.                       12261601
122617     MOVE RM005-RR-REMOTE-ID TO RM007-RECIPIENT-PRINTER-ID.       12261701
122618     MOVE RM005-RR-UA-ACCESS-CODE TO RM007-UPDATE-ACCESS-CODE.    12261801
122619     MOVE RM005-RR-VA-ACCESS-CODE TO RM007-VIEWER-ACCESS-CODE.    12261902
122620     MOVE RM005-RR-JCL-ID TO RM007-JCL-ID.                        12262001
122621                                                                  12262101
122622     PERFORM 8000-WRITE-RECIPIENT-RECORD.                         12262201
122623*2100-EXIT.                                                       12262301
122624                                                                  12262401
122625******************************************************************12262501
122626*  CREATE A COPY EXTRACT RECORD.                                 *12262607
122627******************************************************************12262701
122628                                                                  12262801
122629 2200-CREATE-COPY.                                                12262901
122630     INITIALIZE RM008-COPY-EXTR-RECORD.                           12263001
122631                                                                  12263101
122632     MOVE RM005-CR-COPY-TYPE-CODE TO RM008-COPY-TYPE-CODE.        12263201
122633     MOVE RM005-CR-REPORT-ID TO RM008-REPORT-ID.                  12263301
122634     MOVE RM005-CR-HIERARCHY-CODE TO RM008-HIERARCHY-CODE.        12263401
122635     MOVE RM005-CR-REPORT-GROUP-ID TO RM008-REPORT-GROUP-ID.      12263501
122636     MOVE RM005-CR-RECIPIENT-ID TO RM008-RECIPIENT-ID.            12263601
122637     MOVE RM005-CR-NUMBER-OF-COPIES TO                            12263701
122638               RM008-NUMBER-OF-COPIES.                            12263801
122639     MOVE RM005-CR-COPY-COMMENTS TO RM008-COPY-COMMENTS.          12263901
122640     MOVE RM005-CR-VIEW-ACCESS-IND TO RM008-VIEW-ACCESS-IND.      12264001
122641     IF RM008-CC-DYNAM-DISTRIB-IND                                12264104
122642         MOVE RM008-CC-DYNAM-DISTRIB-KEY TO                       12264206
122643                   RM008-DYNAMIC-DISTRIBUTION-KEY                 12264306
122644     END-IF.                                                      12264404
122646*                                                                 12264604
122647*    INCORRECT OR OLD SETUPS MUST BE CORRECTED IN THE EXTRACT     12264704
122648*                                                                 12264804
122649     INSPECT RM008-DYNAMIC-DISTRIBUTION-KEY                       12264906
122650         REPLACING ALL PC-CLOSING-PARENTHESIS BY SPACES.          12265005
122651                                                                  12265104
122652     PERFORM 8100-WRITE-COPY-RECORD.                              12265204
122653*2200-EXIT.                                                       12265304
122654                                                                  12265404
122655******************************************************************12265504
122656*  CREATE A REPORT EXTRACT RECORD.                               *12265607
122657******************************************************************12265704
122658                                                                  12265804
122659 2300-CREATE-REPORT.                                              12265904
122660     INITIALIZE RM009-REPORT-EXTR-RECORD.                         12266004
122661                                                                  12266104
122662     MOVE RM005-TR-REPORT-ID TO RM009-REPORT-ID.                  12266204
122663     MOVE RM005-TR-REPORT-NAME TO RM009-REPORT-NAME.              12266304
122664     MOVE RM005-TR-PURGE-QUANTITY TO RM009-PURGE-QUANTITY.        12266404
122665     IF (RM005-TR-PAGE-ROW-START-1 NOT = ZERO)                    12266504
122666         SET RM009-HI-HIERARCHY-IN-USE TO TRUE                    12266604
122667     ELSE                                                         12266704
122668         SET RM009-HI-HIERARCHY-NOT-IN-USE TO TRUE                12266804
122669     END-IF.                                                      12266904
122670                                                                  12267004
122671     PERFORM 8200-WRITE-REPORT-RECORD.                            12267104
122672*2300-EXIT.                                                       12267204
122673                                                                  12267304
122674******************************************************************12267404
122675*  CREATE VERSION EXTRACT RECORDS FOR EVERY QUALIFYING INFOPAC   *12267504
122676*  VERSION FILE RECORD.                                          *12267604
122677******************************************************************12267704
122678                                                                  12267804
122679 3000-PROCESS-VERSION-RECORD.                                     12267904
122680     EVALUATE TRUE                                                12268000
122690         WHEN RM006-TI-REPORT-VERSION                             12269000
122691              PERFORM 3100-CREATE-VERSION                         12269100
122696         WHEN OTHER                                               12269600
122697              CONTINUE                                            12269700
122698     END-EVALUATE.                                                12269800
122699                                                                  12269900
122700     PERFORM 7100-READ-VERSION-FILE.                              12270000
122701*3000-EXIT.                                                       12270100
122702                                                                  12270201
122703******************************************************************12270301
122704*  CREATE A VERSION EXTRACT RECORD.                              *12270407
122705******************************************************************12270501
122706                                                                  12270601
122707 3100-CREATE-VERSION.                                             12270701
122708     INITIALIZE RM010-VERSION-EXTR-RECORD.                        12270801
122709                                                                  12270901
122710     MOVE RM006-RV-REPORT-ID TO RM010-REPORT-ID.                  12271001
122711     COMPUTE RM010-REPORT-TIMESTAMP =                             12271101
122712          (PC-TIMESTAMP-INVERSION - RM006-RV-INVERTED-TIMESTAMP). 12271201
122713     MOVE RM006-RV-NUMBER-OF-PAGES TO RM010-NUMBER-OF-PAGES.      12271301
122714     MOVE RM006-RV-REPORT-STATUS-CODE TO RM010-REPORT-STATUS-CODE.12271401
122715     MOVE RM006-RV-DATASET-NAME TO RM010-DATASET-NAME.            12271501
122720                                                                  12272001
122721     PERFORM 8300-WRITE-VERSION-RECORD.                           12272101
122722*2300-EXIT.                                                       12272201
122723                                                                  12272300
122730******************************************************************12273000
122800*  READ AN INFOPAC DISTRIBUTION FILE RECORD.                     *12280000
123000******************************************************************12300000
123100                                                                  12310000
123200 7000-READ-DISTRIB-FILE.                                          12320000
123300     READ INFOPAC-DISTRIB-FILE                                    12330000
123400         INTO RM005-INFOPAC-DISTRIB-RECORD                        12340000
123500         AT END                                                   12350000
123600             SET PS-END-OF-DISTRIB-FILE TO TRUE                   12360001
123700             SUBTRACT +1 FROM PT-DISTRIB-RCDS-READ                12370000
123800     END-READ.                                                    12380000
123900                                                                  12390000
124000     ADD +1 TO PT-DISTRIB-RCDS-READ.                              12400000
124100*7000-EXIT.                                                       12410000
124110                                                                  12411000
124120******************************************************************12412000
124130*  READ AN INFOPAC VERSION FILE RECORD.                          *12413000
124140******************************************************************12414000
124150                                                                  12415000
124160 7100-READ-VERSION-FILE.                                          12416000
124170     READ INFOPAC-VERSION-FILE                                    12417003
124180         INTO RM006-INFOPAC-VERSION-RECORD                        12418000
124190         AT END                                                   12419000
124191             SET PS-END-OF-VERSION-FILE TO TRUE                   12419101
124192             SUBTRACT +1 FROM PT-VERSION-RCDS-READ                12419200
124193     END-READ.                                                    12419300
124194                                                                  12419400
124195     ADD +1 TO PT-VERSION-RCDS-READ.                              12419500
124196*7100-EXIT.                                                       12419600
133900                                                                  13390000
134000******************************************************************13400000
134100*  WRITE A RECIPIENT EXTRACT RECORD.                             *13410000
134200******************************************************************13420000
134300                                                                  13430000
134400 8000-WRITE-RECIPIENT-RECORD.                                     13440000
134500     WRITE RE-RECIPIENT-EXTRACT-RECORD                            13450000
134600         FROM RM007-RECIPIENT-EXTR-RECORD.                        13460000
134700                                                                  13470000
134800     ADD +1 TO PT-RECIPIENT-RCDS-WRITTEN.                         13480000
134900*8000-EXIT.                                                       13490000
135000                                                                  13500000
135100******************************************************************13510000
135200*  WRITE A COPY EXTRACT RECORD.                                  *13520000
135300******************************************************************13530000
135400                                                                  13540000
135500 8100-WRITE-COPY-RECORD.                                          13550000
135600     WRITE CE-COPY-EXTRACT-RECORD                                 13560000
135700         FROM RM008-COPY-EXTR-RECORD.                             13570000
135800                                                                  13580000
135900     ADD +1 TO PT-COPY-RCDS-WRITTEN.                              13590000
136000*8100-EXIT.                                                       13600000
136100                                                                  13610000
136110******************************************************************13611000
136120*  WRITE A REPORT EXTRACT RECORD.                                *13612000
136130******************************************************************13613000
136140                                                                  13614000
136150 8200-WRITE-REPORT-RECORD.                                        13615000
136160     WRITE RE-REPORT-EXTRACT-RECORD                               13616000
136170         FROM RM009-REPORT-EXTR-RECORD.                           13617000
136180                                                                  13618000
136190     ADD +1 TO PT-REPORT-RCDS-WRITTEN.                            13619000
136191*8200-EXIT.                                                       13619100
136192                                                                  13619200
136193******************************************************************13619300
136194*  WRITE A VERSION EXTRACT RECORD.                               *13619400
136195******************************************************************13619500
136196                                                                  13619600
136197 8300-WRITE-VERSION-RECORD.                                       13619700
136198     WRITE VE-VERSION-EXTRACT-RECORD                              13619801
136199         FROM RM010-VERSION-EXTR-RECORD.                          13619900
136200                                                                  13620000
136201     ADD +1 TO PT-VERSION-RCDS-WRITTEN.                           13620100
136202*8300-EXIT.                                                       13620200
136210                                                                  13621000
136300******************************************************************13630000
136400*  CLOSE ALL FILES.                                              *13640000
136500******************************************************************13650000
136600                                                                  13660000
136700 9000-EOJ-ROUTINE.                                                13670000
137610     CLOSE INFOPAC-DISTRIB-FILE                                   13761000
137620           INFOPAC-VERSION-FILE                                   13762000
137630           RECIPIENT-EXTRACT-FILE                                 13763000
137640           COPY-EXTRACT-FILE                                      13764000
137650           REPORT-EXTRACT-FILE                                    13765000
137660           VERSION-EXTRACT-FILE.                                  13766000
137700*9000-EXIT.                                                       13770000
