000100*************************                                         00010003
000200 IDENTIFICATION DIVISION.                                         00020003
000300*************************                                         00030003
000400 PROGRAM-ID.      DPKUT002.                                       00040003
000500 AUTHOR.          MICHAEL N TYE, CAP GEMINI AMERICA.              00050003
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00060003
000700 DATE-WRITTEN.    AUGUST 12, 1988.                                00070003
000800 DATE-COMPILED.                                                   00080003
000900                                                                  00090003
001000*             THIS PROGRAM USES THE OUTPUT FROM PROGRAM PROCXREF, 00100003
001100*             DDNAME SORTOUT, (AFTER IT HAS BEEN SORTED BY PROC   00110003
001200*             NAME AND STEP NAME) AS INPUT TO CREATE FILES TO BE  00120003
001300*             USED TO LOAD AND MAINTAIN TWO OF THE SYSTEM CROSS   00130003
001400*             REFERENCE TABLES:                                   00140003
001500*                           PROCSTEP TABLE                        00150003
001600*                           ASSOCIATOR TABLE                      00160003
001700* CHANGE 10/11/88  ADDED TEST FOR DB2 TMP IKJEFT1A    F. SCHMELZER00170003
001800* CHANGE 11/04/88  ADDED TEST FOR DB2 TMP IKJEFT01    F. SCHMELZER00180003
001900* CHANGE 04/10/89  ADDED TEST FOR IMS/DB2 DSNMTV01    C. KOBE     00190003
002000*                  ALSO INCREASED LENGTH OF INP02 FROM            00200003
002100*                  20 TO 28 TO ACCOMMODATE PLAN NAME              00210003
002200* CHANGE 01/22/91  INCREASED THE SIZE OF "TABLE-CONTROL-DATA" FROM00220003
002300*                  300 ENTRIES TO 400.                J. NEWQUIST 00230003
002400* CHANGE 10/09/91  ADDED TEST FOR DB2 TMP IKJEFT1B    B. JOHNSON  00240003
002500* CHANGE 01/17/92  INCREASED THE SIZE OF "TABLE-CONTROL-DATA" FROM00250003
002600*                  400 ENTRIES TO 600.                B. JOHNSON  00260003
002700                                                                  00270003
002800 ENVIRONMENT DIVISION.                                            00280003
002900 CONFIGURATION SECTION.                                           00290003
003000 SOURCE-COMPUTER. IBM-3090.                                       00300003
003100 OBJECT-COMPUTER. IBM-3090.                                       00310003
003200                                                                  00320003
003300 INPUT-OUTPUT SECTION.                                            00330003
003400 FILE-CONTROL.                                                    00340003
003500     SELECT PROCXREF-SORTED-FILE       ASSIGN TO INP01.           00350003
003600     SELECT CONTROL-FILE               ASSIGN TO INP02.           00360003
003700     SELECT PROCSTEP-TABLE-FILE        ASSIGN TO OUT01.           00370003
003800     SELECT ASSOCIATOR-TABLE-FILE      ASSIGN TO OUT02.           00380003
003900                                                                  00390003
004000***************                                                   00400003
004100 DATA DIVISION.                                                   00410003
004200***************                                                   00420003
004300 FILE SECTION.                                                    00430003
004400                                                                  00440003
004500 FD  PROCXREF-SORTED-FILE                                         00450003
004600                             BLOCK CONTAINS 0 RECORDS             00460003
004700                             RECORD CONTAINS 143 CHARACTERS       00470003
004800                             LABEL RECORDS ARE STANDARD           00480003
004900                             RECORDING MODE F                     00490003
005000                             DATA RECORD IS PROCXREF-SORTED-REC.  00500003
005100 01  PROCXREF-SORTED-REC     PIC X(143).                          00510003
005200                                                                  00520003
005300 FD  CONTROL-FILE                                                 00530003
005400                             BLOCK CONTAINS 0 RECORDS             00540003
005500                             RECORD CONTAINS  28 CHARACTERS       00550003
005600                             LABEL RECORDS ARE STANDARD           00560003
005700                             RECORDING MODE F                     00570003
005800                             DATA RECORD IS CONTROL-REC.          00580003
005900 01  CONTROL-REC             PIC X(28).                           00590003
006000                                                                  00600003
006100 FD  PROCSTEP-TABLE-FILE                                          00610003
006200                             BLOCK CONTAINS 0 RECORDS             00620003
006300                             RECORD CONTAINS 24 CHARACTERS        00630003
006400                             LABEL RECORDS ARE STANDARD           00640003
006500                             RECORDING MODE F                     00650003
006600                             DATA RECORD IS PROCSTEP-TABLE-REC.   00660003
006700 01  PROCSTEP-TABLE-REC      PIC X(24).                           00670003
006800                                                                  00680003
006900 FD  ASSOCIATOR-TABLE-FILE                                        00690003
007000                             BLOCK CONTAINS 0 RECORDS             00700003
007100                             RECORD CONTAINS 60 CHARACTERS        00710003
007200                             LABEL RECORDS ARE STANDARD           00720003
007300                             RECORDING MODE F                     00730003
007400                             DATA RECORD IS ASSOCIATOR-TABLE-REC. 00740003
007500 01  ASSOCIATOR-TABLE-REC    PIC X(60).                           00750003
007600                                                                  00760003
007700     EJECT                                                        00770003
007800                                                                  00780003
007900 WORKING-STORAGE SECTION.                                         00790003
008000                                                                  00800003
008100**   PROCXREF-SORTED-FILE LAYOUT (INPUT)  **                      00810003
008200                                                                  00820003
008300     COPY DPRD005I.                                               00830003
008400                                                                  00840003
008500**   CONTROL-FILE LAYOUT (INPUT)         **                       00850003
008600                                                                  00860003
008700     COPY DPRD004I.                                               00870003
008800                                                                  00880003
008900**   PROCSTEP-TABLE-FILE LAYOUT (OUTPUT)  **                      00890003
009000                                                                  00900003
009100     COPY DPRD008O.                                               00910003
009200                                                                  00920003
009300**   ASSOCIATOR-TABLE-FILE LAYOUT (OUTPUT)  **                    00930003
009400                                                                  00940003
009500     COPY DPRD006O.                                               00950003
009600                                                                  00960003
009700     EJECT                                                        00970003
009800                                                                  00980003
009900 01  PROGRAM-CONSTANTS.                                           00990003
010000     05  PC-TABLE-CONTROL-MAX    PIC S9(04) COMP VALUE +5000.     01000004
010100                                                                  01010003
010200 01  ABEND-CODE                  PIC S9(04) COMP SYNC             01020003
010300                                            VALUE +0.             01030003
010400                                                                  01040003
010500 01  PROGRAM-SWITCHES.                                            01050003
010600     05  PS-NO                   PIC X          VALUE 'N'.        01060003
010700     05  PS-YES                  PIC X          VALUE 'Y'.        01070003
010800     05  PS-VALID-FILE-NAME      PIC X          VALUE 'N'.        01080003
010900         88  VALID-FILE-NAME                    VALUE 'Y'.        01090003
011000     05  PS-EOF-PROCXRFI         PIC X          VALUE 'N'.        01100003
011100         88  EOF-PROCXRFI                       VALUE 'Y'.        01110003
011200     05  PS-EOF-CONTROLI         PIC X          VALUE 'N'.        01120003
011300         88  EOF-CONTROLI                       VALUE 'Y'.        01130003
011400     05  PS-WRITE                PIC X          VALUE 'N'.        01140003
011401                                                                  01140106
011402 01  PV-PROGRAM-VARIABLES.                                        01140206
011410     05  PV-CURRENT-PROC-NAME    PIC X(8)       VALUE SPACES.     01141006
011420     05  PV-CURRENT-STEP-NAME    PIC X(8)       VALUE SPACES.     01142006
011430     05  PV-CURRENT-PROGRAM-NAME PIC X(8)       VALUE SPACES.     01143006
011440     05  PV-CURRENT-ACTUAL-PROGRAM-NAME                           01144006
011450                                 PIC X(8)       VALUE SPACES.     01145006
011500                                                                  01150003
011600 01  WORK-AREA.                                                   01160003
011700     05  WS-FILE-NAME-TABLE      PIC X(44)      VALUE SPACES.     01170003
011800     05  WS-FILE-NAME-TBL  REDEFINES  WS-FILE-NAME-TABLE.         01180003
011900         10  WS-FILE-NAME-CHAR  OCCURS 44 TIMES INDEXED BY IX-FNT 01190003
012000                                 PIC X.                           01200003
012100                                                                  01210003
012200     05  WS-FILE-NAME-BREAKDOWN.                                  01220003
012300         10  WS-FILE-NAME        PIC X(12).                       01230003
012400         10  FILLER              PIC X(01).                       01240003
012500         10  WS-CONTROL-NAME.                                     01250003
012600             15  WS-CONTROL-NAME-1-4                              01260003
012700                                 PIC X(04).                       01270003
012800             15  FILLER          PIC X(03).                       01280003
012900             15  WS-CONTROL-NAME-8                                01290003
013000                                 PIC X(01).                       01300003
013100         10  FILLER              PIC X(23).                       01310003
013200                                                                  01320003
013300     05  WS-VARIABLES.                                            01330003
013400         10  WS-AMPERSAND        PIC X          VALUE '&'.        01340003
013500         10  WS-COMMA            PIC X          VALUE ','.        01350003
013600         10  WS-TEMPORARY        PIC X(11)      VALUE             01360003
013700                                                '<TEMPORARY>'.    01370003
013800         10  WS-ASTERISK         PIC X          VALUE '*'.        01380003
013900                                                                  01390003
014000 01  TABLE-CONTROL-DATA.                                          01400003
014100     05  TABLE-CONTROL-ENTRY     OCCURS 5000 TIMES                01410004
014200                                 INDEXED BY TBL-INDX.             01420003
014300         10  TABLE-CONTROL-NAME  PIC X(8).                        01430003
014400         10  TABLE-PROGRAM-NAME  PIC X(8).                        01440003
014500         10  TABLE-TYPE          PIC X(4).                        01450003
014600         10  TABLE-PLAN-NAME     PIC X(8).                        01460003
014700                                                                  01470003
014800     EJECT                                                        01480003
014900********************                                              01490003
015000 PROCEDURE DIVISION.                                              01500003
015100********************                                              01510003
015200                                                                  01520003
015300                                                                  01530003
015400     MOVE SPACES TO TABLE-CONTROL-DATA.                           01540003
015500                                                                  01550003
015600                                                                  01560003
015700     OPEN INPUT     PROCXREF-SORTED-FILE                          01570003
015800                    CONTROL-FILE                                  01580003
015900          OUTPUT    PROCSTEP-TABLE-FILE                           01590003
016000                    ASSOCIATOR-TABLE-FILE.                        01600003
016100                                                                  01610003
016200                                                                  01620003
016300     PERFORM X100-READ-PROCXREF-FILE.                             01630010
016600                                                                  01660003
016700                                                                  01670003
016800     SET TBL-INDX TO 1.                                           01680003
016900     PERFORM X200-READ-CONTROL-FILE                               01690003
017000             UNTIL EOF-CONTROLI.                                  01700003
017100                                                                  01710003
017200                                                                  01720003
017400     PERFORM A100-PROCESS-PROC-STEP                               01740010
017500             UNTIL EOF-PROCXRFI.                                  01750010
017600                                                                  01760010
017800     CLOSE          PROCXREF-SORTED-FILE                          01780003
017900                    CONTROL-FILE                                  01790003
018000                    PROCSTEP-TABLE-FILE                           01800003
018100                    ASSOCIATOR-TABLE-FILE.                        01810003
018200                                                                  01820003
018300     STOP RUN.                                                    01830003
018400                                                                  01840003
018500     EJECT                                                        01850003
018600                                                                  01860003
018700******************************************************************01870003
018800*** A100 THIS PARAGRAPH PROCESSES THE INPUT FILE FROM "PROCXREF", 01880006
018900***      CONTROL BREAK BY PROC STEP.  AT THE END OF PROCESSING THE01890006
019000***      PROCXREF RECORDS ASSOCIATED WITH THE STEP, WRITE OUT THE 01900006
019100***      PROC STEP RECORD.  WHILE PROCESSING THE RECORDS FOR      01910006
019200***      THE STEP, THE TRUE PROGRAM ASSOCIATION MAY BE FOUND, SO  01920006
019300***      NO PROC STEP INFORMATION IS WRITTEN UNTIL REVIEWING ALL  01930006
019310***      FILES USED BY THE PROC STEP.                             01931006
019400******************************************************************01940003
019500 A100-PROCESS-PROC-STEP.                                          01950006
019600                                                                  01960003
019610     MOVE DP005I-PROC-NAME TO PV-CURRENT-PROC-NAME.               01961006
019620     MOVE DP005I-STEP-NAME TO PV-CURRENT-STEP-NAME.               01962006
019630     MOVE DP005I-PROGRAM-NAME TO PV-CURRENT-PROGRAM-NAME.         01963006
019640     INITIALIZE PV-CURRENT-ACTUAL-PROGRAM-NAME.                   01964006
019700                                                                  01970003
024110     PERFORM B100-PROCESS-PROCXREF-RECORD                         02411006
024120             UNTIL ((EOF-PROCXRFI)                                02412006
024121             OR (DP005I-PROC-NAME NOT = PV-CURRENT-PROC-NAME)     02412106
024122             OR (DP005I-STEP-NAME NOT = PV-CURRENT-STEP-NAME)     02412214
024123             OR (DP005I-PROGRAM-NAME NOT =                        02412312
024124                                        PV-CURRENT-PROGRAM-NAME)).02412412
024125*                                                                 02412513
024126*  THE CONDITION OF PROGRAM NAME MUST BE ADDED DUE TO THE         02412613
024127*  EXISTENCE OF MULTI-STEP SYSTEM PROCS, SINCE CROSS-REFERENCE    02412713
024128*  DOES NOT HAVE THE ABILITY TO HANDLE TRULY NESTED PROCS.  IT    02412814
024129*  IS STILL ONLY AN APPROXIMATION, BASED ON THE INFORMATION       02412914
024130*  AVAILABLE AT THIS POINT IN THE PROCESS.                        02413014
024131*                                                                 02413114
024132                                                                  02413214
024140     PERFORM C100-PROCESS-DP008O-RECORD.                          02414013
024200                                                                  02420003
024300*A100-END.                                                        02430006
024410                                                                  02441005
024420******************************************************************02442005
024430*** B100 THIS PARAGRAPH PROCESSES THE INPUT FILE FROM "PROCXREF"  02443005
024440***      EXAMINING EACH FILE RECORD TO CREATE THE FILE ASSOCIATION02444006
024450***      RECORD, AND TO DETERMINE IF THERE IS A DIFFERENT ACTUAL  02445006
024460***      PROGRAM ASSOCIATED WITH THE STEP.                        02446006
024490******************************************************************02449005
024491 B100-PROCESS-PROCXREF-RECORD.                                    02449106
024492                                                                  02449206
024493     PERFORM C400-VALIDATE-FILE-NAME.                             02449310
024494     IF VALID-FILE-NAME                                           02449410
024495         PERFORM C200-PROCESS-DP006O-RECORD                       02449510
024496     END-IF.                                                      02449610
024497                                                                  02449705
024498     IF DP005I-PROGRAM-NAME    =  'IKJEFT1A' OR                   02449805
024499                                  'IKJEFT1B' OR                   02449905
024500                                  'IKJEFT01' OR                   02450005
024501                                  'DYL280  ' OR                   02450105
024502                                  'DYLIDB  '                      02450205
024503         MOVE DP005I-FILE-NAME TO WS-FILE-NAME-BREAKDOWN          02450305
024504         IF WS-FILE-NAME = 'PKMO.CONTROL'                         02450405
024505             IF WS-CONTROL-NAME-1-4  EQUAL TO  'VSAM'             02450505
024506                 CONTINUE                                         02450605
024507             ELSE                                                 02450705
024508                 PERFORM C300-SEARCH-TABLE                        02450807
024510             END-IF                                               02451005
024511         ELSE                                                     02451105
024512             CONTINUE                                             02451205
024513         END-IF                                                   02451305
024522     END-IF.                                                      02452205
024533                                                                  02453305
024534     PERFORM X100-READ-PROCXREF-FILE.                             02453410
024537                                                                  02453705
024539*B100-END.                                                        02453905
024600                                                                  02460003
024700******************************************************************02470003
024800*** C100 THIS PARAGRAPH PROCESSES THE PROC TABLE DATA OUTPUT      02480006
024900***      RECORD BY FILLING THE OUTPUT FIELDS WITH THE APPROPRIATE 02490003
025000***      INPUT DATA AND THEN WRITING IT TO THE OUTPUT FILE.       02500003
025100******************************************************************02510003
025200 C100-PROCESS-DP008O-RECORD.                                      02520005
025300                                                                  02530003
025500     MOVE PV-CURRENT-PROC-NAME    TO DP008O-PROC-NAME.            02550006
025600     MOVE PV-CURRENT-STEP-NAME    TO DP008O-PROCSTEP-NAME.        02560006
025610     IF (PV-CURRENT-ACTUAL-PROGRAM-NAME NOT = SPACES)             02561006
025620         MOVE PV-CURRENT-ACTUAL-PROGRAM-NAME                      02562006
025700                                  TO DP008O-PROGRAM-NAME          02570006
025800     ELSE                                                         02580006
025810         MOVE PV-CURRENT-PROGRAM-NAME                             02581006
025820                                  TO DP008O-PROGRAM-NAME          02582006
025830     END-IF.                                                      02583006
025900                                                                  02590003
026000     WRITE PROCSTEP-TABLE-REC   FROM DP008O-RECORD.               02600003
026200                                                                  02620003
026300*C100-END.                                                        02630005
026600                                                                  02660003
026700******************************************************************02670003
026800*** C200 THIS PARAGRAPH PROCESSES THE PROC/STEP ASSOCIATOR TABLE  02680005
026900***      DATA RECORD BY FILLING THE OUTPUT FIELDS WITH THE APPRO- 02690003
027000***      PRIATE INPUT DATA AND THEN WRITING IT TO THE OUTPUT FILE.02700003
027100******************************************************************02710003
027200 C200-PROCESS-DP006O-RECORD.                                      02720005
027300                                                                  02730003
027500     MOVE DP005I-PROC-NAME        TO DP006O-PROCNAME.             02750003
027600     MOVE DP005I-STEP-NAME        TO DP006O-STEPNAME.             02760003
027700     MOVE DP005I-FILE-NAME        TO DP006O-FILE-NAME.            02770003
027800                                                                  02780003
027900                                                                  02790003
028000     WRITE ASSOCIATOR-TABLE-REC FROM DP006O-RECORD.               02800003
028200                                                                  02820003
028300*C200-END.                                                        02830005
028600                                                                  02860003
028700******************************************************************02870003
028800*** C300 FOR DB2 AND DYL280 PROCS WE SEARCH THE TABLE TO OBTAIN   02880005
028900***      THE REAL PROGRAM NAME.  THE PROCXREF FILE ONLY CONTAINS  02890003
029000***      'IKJEFT01' OR 'DYL280' WHICH IS NOT REALLY WHAT IS BEING 02900003
029100***      EXECUTED.                                                02910003
029200******************************************************************02920003
029300 C300-SEARCH-TABLE.                                               02930005
029400                                                                  02940003
029600      IF WS-CONTROL-NAME-8  EQUAL TO ')'                          02960003
029700          MOVE SPACE TO WS-CONTROL-NAME-8                         02970003
029800      END-IF.                                                     02980003
029900                                                                  02990003
030000                                                                  03000003
030100      SET TBL-INDX TO 1.                                          03010003
030200      SEARCH TABLE-CONTROL-ENTRY  VARYING TBL-INDX                03020003
030300         AT END                                                   03030003
030310             CONTINUE                                             03031011
030500         WHEN                                                     03050003
030600             TABLE-CONTROL-NAME (TBL-INDX)  =  WS-CONTROL-NAME    03060003
030601*                                                                 03060106
030602* IF AN ACTUAL PROGRAM HAS ALREADY BEEN DETERMINED, WRITE OUT     03060206
030603* PROC STEP RECORD FOR THAT PROGRAM TO FORCE THE DUPLICATE        03060306
030604* REFERENCE THAT EXISTED PRIOR TO THE USE OF THE CONTROL BREAK    03060406
030605* PROCESSING.  THIS WILL TRIGGER THE EXISTING DUP PROCESSING FOR  03060506
030606* FOLLOW-UP AND JCL CORRECTION (DUPLICATE EXPANDED INPUT DD       03060606
030607* REFERENCES).                                                    03060706
030608*                                                                 03060806
030610                 IF (PV-CURRENT-ACTUAL-PROGRAM-NAME NOT = SPACES) 03061006
030611                      PERFORM C100-PROCESS-DP008O-RECORD          03061106
030620                 END-IF                                           03062006
030700                 MOVE TABLE-PROGRAM-NAME (TBL-INDX)               03070003
030710                         TO PV-CURRENT-ACTUAL-PROGRAM-NAME        03071007
031000      END-SEARCH.                                                 03100003
031100                                                                  03110003
031300*C300-END.                                                        03130005
031400                                                                  03140010
031410***************************************************************** 03141010
031420*** C400 DETERMINES IF THE FILE FROM "PROCXREF" IS VALID FOR      03142010
031430***      THE PURPOSES OF CROSS-REFERENCE.  IT ALSO REMOVES THE    03143010
031440***      QUOTES AROUND THE DATASET NAME IF THEY ARE FOUND.        03144010
031450***************************************************************** 03145010
031460 C400-VALIDATE-FILE-NAME.                                         03146010
031480     MOVE PS-YES              TO PS-VALID-FILE-NAME               03148010
031490     IF DP005I-FILE-NAME    =  WS-TEMPORARY OR                    03149010
031500                               WS-ASTERISK                        03150010
031510         MOVE PS-NO           TO PS-VALID-FILE-NAME               03151010
031520     ELSE                                                         03152010
031530         MOVE DP005I-FILE-NAME                                    03153010
031540                              TO  WS-FILE-NAME-TABLE              03154010
031550         IF ( WS-FILE-NAME-CHAR (1)  =  WS-AMPERSAND )  OR        03155010
031560            ( WS-FILE-NAME-CHAR (2)  =  WS-COMMA )      OR        03156010
031570            ( WS-FILE-NAME-CHAR (2)  =  SPACE )         OR        03157010
031580            ( WS-FILE-NAME-CHAR (3)  =  WS-COMMA )                03158010
031590             MOVE PS-NO       TO PS-VALID-FILE-NAME               03159010
031591         ELSE                                                     03159110
031592             IF WS-FILE-NAME-CHAR (1)  =  QUOTE                   03159210
031593                 PERFORM X110-REMOVE-DSNAME-QUOTES                03159310
031594                     VARYING IX-FNT FROM 1 BY 1                   03159410
031595                     UNTIL IX-FNT > 44                            03159510
031596                 MOVE WS-FILE-NAME-TABLE                          03159610
031597                              TO DP005I-FILE-NAME                 03159710
031598             END-IF                                               03159810
031599         END-IF                                                   03159910
031600     END-IF.                                                      03160010
031602*C400-END.                                                        03160210
031610                                                                  03161003
031700***************************************************************** 03170003
031800*** X100 THIS PARAGRAPH READS THE INPUT FILE FROM "PROCXREF".     03180010
032200***************************************************************** 03220003
032300 X100-READ-PROCXREF-FILE.                                         03230003
032500                                                                  03250003
032600     READ PROCXREF-SORTED-FILE  INTO DP005I-RECORD                03260003
032700         AT END                                                   03270003
032800             MOVE PS-YES          TO PS-EOF-PROCXRFI.             03280003
035600                                                                  03560003
035700*X100-END.                                                        03570005
036000                                                                  03600003
036100******************************************************************03610003
036200*** X110 THIS PARAGRAPH REMOVES THE QUOTES AROUND THE DATASET NAME03620003
036300***      IF THEY ARE FOUND.                                       03630003
036400******************************************************************03640003
036500 X110-REMOVE-DSNAME-QUOTES.                                       03650003
036700                                                                  03670003
036800     IF ( IX-FNT  >  1 )  AND                                     03680003
036900        ( WS-FILE-NAME-CHAR (IX-FNT + 1)  =  QUOTE )              03690003
037000         MOVE SPACE               TO WS-FILE-NAME-CHAR (IX-FNT)   03700003
037100                                  WS-FILE-NAME-CHAR (IX-FNT + 1)  03710003
037200         SET IX-FNT               TO 44                           03720003
037300     ELSE                                                         03730003
037400         MOVE WS-FILE-NAME-CHAR (IX-FNT + 1)                      03740003
037500                                  TO WS-FILE-NAME-CHAR (IX-FNT)   03750003
037600     END-IF.                                                      03760003
037800                                                                  03780003
037900*X110-END.                                                        03790005
038200                                                                  03820003
038300***************************************************************** 03830003
038400*** X200 READS THE CONTROL FILE WHICH CONTAINS THE PKMO.CONTROL   03840003
038500***      MEMBER NAME, THE PROGRAM NAME AND PROGRAM TYPE FOR ALL   03850004
038600***      DB2 AND DYL280 PROCS.                                    03860003
038700***************************************************************** 03870003
038800 X200-READ-CONTROL-FILE.                                          03880003
038900                                                                  03890003
039000     READ CONTROL-FILE          INTO DP004I-RECORD                03900003
039100         AT END                                                   03910003
039200             MOVE PS-YES          TO PS-EOF-CONTROLI.             03920003
039300                                                                  03930003
039400     IF NOT EOF-CONTROLI                                          03940003
039500         MOVE DP004I-RECORD TO TABLE-CONTROL-ENTRY (TBL-INDX)     03950003
039600         SET TBL-INDX UP BY 1                                     03960003
039700     END-IF.                                                      03970003
039800                                                                  03980003
039900     IF  TBL-INDX > PC-TABLE-CONTROL-MAX                          03990003
040000         DISPLAY '*** ABEND ****'                                 04000003
040100         DISPLAY '*** PARAGRAPH X200-READ-CONTROL-FILE ***'       04010003
040200         DISPLAY '*** MAX TABLE ENTRIES EXCEEDED FOR  ***'        04020003
040300         DISPLAY '*** TABLE CONTROL DATA              ***'        04030003
040400         DISPLAY '*** PC-TABLE-CONTROL-MAX = '                    04040003
040500                      PC-TABLE-CONTROL-MAX                        04050003
040600         MOVE +4004 TO ABEND-CODE                                 04060004
040700         CALL 'ILBOABN0' USING ABEND-CODE                         04070003
040800     END-IF.                                                      04080003
040900                                                                  04090003
041000*X200-END.                                                        04100005
