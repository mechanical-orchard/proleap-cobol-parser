00001 ******************************************************************01/03/96
00002  IDENTIFICATION DIVISION.                                         RVKRP008
00003 ******************************************************************   LV001
00004                                                                   RVKRP008
00005  PROGRAM-ID.             RVKRP008.                                RVKRP008
00006  AUTHOR.                 MICHAEL WALTERS.                         RVKRP008
00007  INSTALLATION.           KOHLS.                                   RVKRP008
00008  DATE-WRITTEN            AUGUST, 1995.                            RVKRP008
00009  DATE-COMPILED.                                                   RVKRP008
00010                                                                   RVKRP008
00011 ******************************************************************RVKRP008
00012 *  THIS PROGRAM WILL SUMMARIZE ALL THE "SHIPPED" DEFECTIVE ITEMS  RVKRP008
00013 *  BY FACILITY AND DEPARTMENT.                                    RVKRP008
00014 ******************************************************************RVKRP008
00015                                                                   RVKRP008
00016 ******************************************************************RVKRP008
00017  ENVIRONMENT DIVISION.                                            RVKRP008
00018 ******************************************************************RVKRP008
00019                                                                   RVKRP008
00020  CONFIGURATION SECTION.                                           RVKRP008
00021                                                                   RVKRP008
00022  SOURCE-COMPUTER.        IBM-3090.                                RVKRP008
00023  OBJECT-COMPUTER.        IBM-3090.                                RVKRP008
00024                                                                   RVKRP008
00025  INPUT-OUTPUT SECTION.                                            RVKRP008
00026                                                                   RVKRP008
00027  FILE-CONTROL.                                                    RVKRP008
00028                                                                   RVKRP008
00029      SELECT RTV-REPORT-EXTRACT                                    RVKRP008
00030          ASSIGN TO IN01.                                          RVKRP008
00031                                                                   RVKRP008
00032      SELECT DI-DEFECT-ITEM-REPORT                                 RVKRP008
00033          ASSIGN TO RPT01.                                         RVKRP008
00034                                                                   RVKRP008
00035 ******************************************************************RVKRP008
00036  DATA DIVISION.                                                   RVKRP008
00037 ******************************************************************RVKRP008
00038                                                                   RVKRP008
00039  FILE SECTION.                                                    RVKRP008
00040                                                                   RVKRP008
00041  FD  RTV-REPORT-EXTRACT                                           RVKRP008
00042      RECORDING MODE IS F                                          RVKRP008
00043      LABEL RECORDS ARE STANDARD                                   RVKRP008
00044      BLOCK CONTAINS 0 RECORDS.                                    RVKRP008
00045                                                                   RVKRP008
00046  01  RTV-REPORT-EXTRACT-RECORD       PIC  X(200).                 RVKRP008
00047                                                                   RVKRP008
00048  FD  DI-DEFECT-ITEM-REPORT                                        RVKRP008
00049      RECORDING MODE IS F                                          RVKRP008
00050      LABEL RECORDS ARE STANDARD                                   RVKRP008
00051      BLOCK CONTAINS 0 RECORDS.                                    RVKRP008
00052                                                                   RVKRP008
00053  01  DI-DEFECT-ITEM-LINE             PIC  X(132).                 RVKRP008
00054                                                                   RVKRP008
00055 ******************************************************************RVKRP008
00056  WORKING-STORAGE SECTION.                                         RVKRP008
00057 ******************************************************************RVKRP008
00058                                                                   RVKRP008
00059 *                                                                 RVKRP008
00060 *  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.                RVKRP008
00061 *                                                                 RVKRP008
00062      COPY DPWS132O.                                               RVKRP008
00063                                                                   RVKRP008
00064 *                                                                 RVKRP008
00065 *  RECORD LAYOUT OF THE RTV EXTRACT FILE.                         RVKRP008
00066 *                                                                 RVKRP008
00067      COPY RVWS010.                                                RVKRP008
00068                                                                   RVKRP008
00069                                                                   RVKRP008
00070  01  ABEND-CODE                          PIC S9(04) VALUE +0      RVKRP008
00071                                                      COMP SYNC.   RVKRP008
00072  01  PH2-PAGE-HEADING-MONTHLY.                                    RVKRP008
00073      05  FILLER                          PIC  X(45)  VALUE SPACE. RVKRP008
00074      05  FILLER                          PIC  X(48)  VALUE        RVKRP008
00075          'RETURN-TO-VENDOR DMM MONTHLY SUMMARY REPORT'.           RVKRP008
00076      05  FILLER                          PIC  X(42)  VALUE SPACE. RVKRP008
00077                                                                   RVKRP008
00078  01  PH2-PAGE-HEADING-YTD.                                        RVKRP008
00079      05  FILLER                          PIC  X(42)  VALUE SPACE. RVKRP008
00080      05  FILLER                          PIC  X(53)  VALUE        RVKRP008
00081          'RETURN-TO-VENDOR DMM YEAR TO DATE SUMMARY REPORT'.      RVKRP008
00082      05  FILLER                          PIC  X(40)  VALUE SPACE. RVKRP008
00071                                                                   RVKRP008
00072  01  PH2-PAGE-HEADING-WEEKLY.                                     RVKRP008
00073      05  FILLER                          PIC  X(45)  VALUE SPACE. RVKRP008
00074      05  FILLER                          PIC  X(48)  VALUE        RVKRP008
00075          'RETURN-TO-VENDOR DMM WEEKLY SUMMARY REPORT '.           RVKRP008
00076      05  FILLER                          PIC  X(42)  VALUE SPACE. RVKRP008
00077                                                                   RVKRP008
00083                                                                   RVKRP008
00084  01  PH3-PAGE-HEADING-3.                                          RVKRP008
00085      05  FILLER                          PIC  X(44)  VALUE SPACE. RVKRP008
00086      05  FILLER                          PIC  X(12)  VALUE        RVKRP008
00087          'BEGIN DATE: '.                                          RVKRP008
00088      05  PH3-START-DATE                  PIC  X(10)  VALUE SPACE. RVKRP008
00089      05  FILLER                          PIC  X(13)  VALUE        RVKRP008
00090          ' - END DATE: '.                                         RVKRP008
00091      05  PH3-END-DATE                    PIC  X(10)  VALUE SPACE. RVKRP008
00092      05  FILLER                          PIC  X(42)  VALUE SPACE. RVKRP008
00093                                                                   RVKRP008
00094  01  PH4-PAGE-HEADING-4.                                          RVKRP008
00095      05  FILLER                          PIC  X(48)  VALUE SPACES.RVKRP008
00096      05  FILLER                          PIC  X(19)  VALUE        RVKRP008
00097          'ITEMS SHIPPED FROM '.                                   RVKRP008
00098      05  PH4-FCLTY-NAME                  PIC  X(25)  VALUE SPACES.RVKRP008
00099      05  FILLER                          PIC  X(20)  VALUE SPACES.RVKRP008
00100                                                                   RVKRP008
00101  01  DH1-DETAIL-HEADING-1.                                        RVKRP008
00102      05  FILLER                          PIC X(03) VALUE          RVKRP008
00103          'DMM'.                                                   RVKRP008
00104      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00105      05  FILLER                          PIC X(18) VALUE          RVKRP008
00106          '                 '.                                     RVKRP008
00107      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00108      05  FILLER                          PIC X(03) VALUE          RVKRP008
00109          'DPT'.                                                   RVKRP008
00110      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00111      05  FILLER                          PIC X(18) VALUE          RVKRP008
00112          '                 '.                                     RVKRP008
00113      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00114      05  FILLER                          PIC X(10) VALUE          RVKRP008
00115          '          '.                                            RVKRP008
00116      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00117      05  FILLER                          PIC X(07) VALUE          RVKRP008
00118          ' DEBITE'.                                               RVKRP008
00119      05  FILLER                          PIC X(02)  VALUE         RVKRP008
00120          'D '.                                                    RVKRP008
00121      05  FILLER                          PIC X(13) VALUE          RVKRP008
00122          '& RETURNED  '.                                          RVKRP008
00123      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00124      05  FILLER                          PIC X(07) VALUE          RVKRP008
00125          ' DEBITE'.                                               RVKRP008
00126      05  FILLER                          PIC X(02)  VALUE         RVKRP008
00127          'D '.                                                    RVKRP008
00128      05  FILLER                          PIC X(13) VALUE          RVKRP008
00129          '& DESTROYED '.                                          RVKRP008
00130      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00131      05  FILLER                          PIC X(07) VALUE          RVKRP008
00132          ' MARKED'.                                               RVKRP008
00133      05  FILLER                          PIC X(02)  VALUE         RVKRP008
00134          ' O'.                                                    RVKRP008
00135      05  FILLER                          PIC X(13) VALUE          RVKRP008
00136          'UT OF STOCK '.                                          RVKRP008
00137                                                                   RVKRP008
00138                                                                   RVKRP008
00139  01  DH2-DETAIL-HEADING-2.                                        RVKRP008
00140      05  FILLER                          PIC X(03) VALUE          RVKRP008
00141          'NUM'.                                                   RVKRP008
00142      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00143      05  FILLER                          PIC X(18) VALUE          RVKRP008
00144          'DMM NAME         '.                                     RVKRP008
00145      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00146      05  FILLER                          PIC X(03) VALUE          RVKRP008
00147          'NUM'.                                                   RVKRP008
00148      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00149      05  FILLER                          PIC X(18) VALUE          RVKRP008
00150          'DEPT DESCRIPTION '.                                     RVKRP008
00151      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00152      05  FILLER                          PIC X(10) VALUE          RVKRP008
00153          'FACILITY  '.                                            RVKRP008
00154      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00155      05  FILLER                          PIC X(07) VALUE          RVKRP008
00156          '    QTY'.                                               RVKRP008
00157      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00158      05  FILLER                          PIC X(13) VALUE          RVKRP008
00159          '       COST '.                                          RVKRP008
00160      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00161      05  FILLER                          PIC X(07) VALUE          RVKRP008
00162          '    QTY'.                                               RVKRP008
00163      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00164      05  FILLER                          PIC X(13) VALUE          RVKRP008
00165          '       COST '.                                          RVKRP008
00166      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00167      05  FILLER                          PIC X(07) VALUE          RVKRP008
00168          '    QTY'.                                               RVKRP008
00169      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00170      05  FILLER                          PIC X(13) VALUE          RVKRP008
00171          '       COST '.                                          RVKRP008
00172                                                                   RVKRP008
00173  01  DHD-DETAIL-HEADING-DASHES.                                   RVKRP008
00174      05  FILLER                          PIC X(03) VALUE ALL '_'. RVKRP008
00175      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00176      05  FILLER                          PIC X(18) VALUE ALL '_'. RVKRP008
00177      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00178      05  FILLER                          PIC X(03) VALUE ALL '_'. RVKRP008
00179      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00180      05  FILLER                          PIC X(18) VALUE ALL '_'. RVKRP008
00181      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00182      05  FILLER                          PIC X(10) VALUE ALL '_'. RVKRP008
00183      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00184      05  FILLER                          PIC X(07) VALUE ALL '_'. RVKRP008
00185      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00186      05  FILLER                          PIC X(13) VALUE ALL '_'. RVKRP008
00187      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00188      05  FILLER                          PIC X(07) VALUE ALL '_'. RVKRP008
00189      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00190      05  FILLER                          PIC X(13) VALUE ALL '_'. RVKRP008
00191      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00192      05  FILLER                          PIC X(07) VALUE ALL '_'. RVKRP008
00193      05  FILLER                          PIC X(02)  VALUE SPACES. RVKRP008
00194      05  FILLER                          PIC X(13) VALUE ALL '_'. RVKRP008
00195                                                                   RVKRP008
00196  01  DL-DETAIL-LINE.                                              RVKRP008
00197      05  DL-DMM-NBR                      PIC  X(03).              RVKRP008
00198      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00199      05  DL-DMM-NAME                     PIC  X(18).              RVKRP008
00200      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00201      05  DL-DPT-NBR                      PIC  X(03).              RVKRP008
00202      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00203      05  DL-DPT-DESC                     PIC  X(18).              RVKRP008
00204      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00205      05  DL-FCLTY-ABBR                   PIC  X(10).              RVKRP008
00206      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00207      05  DL-DR-QTY                       PIC  ZZZ,ZZ9.            RVKRP008
00208      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00209      05  DL-DR-COST                      PIC  ZZ,ZZZ,ZZ9.99.      RVKRP008
00210      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00211      05  DL-DD-QTY                       PIC  ZZZ,ZZ9.            RVKRP008
00212      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00213      05  DL-DD-COST                      PIC  ZZ,ZZZ,ZZ9.99.      RVKRP008
00214      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00215      05  DL-MO-QTY                       PIC  ZZZ,ZZ9.            RVKRP008
00216      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00217      05  DL-MO-COST                      PIC  ZZ,ZZZ,ZZ9.99.      RVKRP008
00218                                                                   RVKRP008
00219  01  TL-TOTAL-LINE-DASHES.                                        RVKRP008
00220      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP008
00221      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00222      05  FILLER                          PIC  X(18)  VALUE SPACES.RVKRP008
00223      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP008
00224      05  FILLER                          PIC  X(25)  VALUE SPACES.RVKRP008
00225 *        TL-TOTAL-DESCRIPTION                                     RVKRP008
00226      05  FILLER                          PIC  X(08)  VALUE SPACES.RVKRP008
00227 *        VALUE ' TOTAL: '.                                        RVKRP008
00228      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00229      05  FILLER                          PIC  X(07)               RVKRP008
00230          VALUE '_______'.                                         RVKRP008
00231      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00232      05  FILLER                          PIC  X(13)               RVKRP008
00233          VALUE '_____________'.                                   RVKRP008
00234      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00235      05  FILLER                          PIC  X(07)               RVKRP008
00236          VALUE '_______'.                                         RVKRP008
00237      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00238      05  FILLER                          PIC  X(13)               RVKRP008
00239          VALUE '_____________'.                                   RVKRP008
00240      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00241      05  FILLER                          PIC  X(07)               RVKRP008
00242          VALUE '_______'.                                         RVKRP008
00243      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00244      05  FILLER                          PIC  X(13)               RVKRP008
00245          VALUE '_____________'.                                   RVKRP008
00246      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00247                                                                   RVKRP008
00248  01  TL-TOTAL-LINE.                                               RVKRP008
00249      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP008
00250      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00251      05  FILLER                          PIC  X(18)  VALUE SPACES.RVKRP008
00252      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP008
00253      05  TL-TOTAL-DESCRIPTION            PIC  X(25).              RVKRP008
00254      05  FILLER                          PIC  X(08)               RVKRP008
00255          VALUE ' TOTAL: '.                                        RVKRP008
00256      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00257      05  TL-DR-QTY                       PIC  ZZZ,ZZ9.            RVKRP008
00258      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00259      05  TL-DR-COST                      PIC  ZZ,ZZZ,ZZ9.99.      RVKRP008
00260      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00261      05  TL-DD-QTY                       PIC  ZZZ,ZZ9.            RVKRP008
00262      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00263      05  TL-DD-COST                      PIC  ZZ,ZZZ,ZZ9.99.      RVKRP008
00264      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00265      05  TL-MO-QTY                       PIC  ZZZ,ZZ9.            RVKRP008
00266      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00267      05  TL-MO-COST                      PIC  ZZ,ZZZ,ZZ9.99.      RVKRP008
00268      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP008
00269                                                                   RVKRP008
00270                                                                   RVKRP008
00271  01  BLANK-LINE.                                                  RVKRP008
00272      05  FILLER                          PIC  X(132) VALUE SPACE. RVKRP008
00273                                                                   RVKRP008
00274  01  END-OF-REPORT-LINE.                                          RVKRP008
00275      05  FILLER                          PIC  X(88)  VALUE SPACE. RVKRP008
00276      05  FILLER                          PIC  X(25)  VALUE        RVKRP008
00277          '***** END OF REPORT *****'.                             RVKRP008
00278      05  FILLER                          PIC  X(87)  VALUE SPACE. RVKRP008
00279                                                                   RVKRP008
00280  01  ER-EMPTY-REPORT-LINE.                                        RVKRP008
00281      05  FILLER                          PIC  X(42)  VALUE SPACE. RVKRP008
00282      05  FILLER                          PIC  X(48)  VALUE        RVKRP008
00283          '*** NO DATA SATISFIES THE SELECTION CRITERIA ***'.      RVKRP008
00284      05  FILLER                          PIC  X(42)  VALUE SPACE. RVKRP008
00285                                                                   RVKRP008
00286  01  PA-PROGRAM-ACCUMULATORS.                                     RVKRP008
00287      05  PA-DPT-TOTALS.                                           RVKRP008
00288          10 PA-DR-DPT-QTY                PIC S9(06)  VALUE +0     RVKRP008
00289                                                      COMP-3.      RVKRP008
00290          10 PA-DR-DPT-COST               PIC S9(08)V99            RVKRP008
00291                                                      VALUE +0     RVKRP008
00292                                                      COMP-3.      RVKRP008
00293          10 PA-DD-DPT-QTY                PIC S9(06)  VALUE +0     RVKRP008
00294                                                      COMP-3.      RVKRP008
00295          10 PA-DD-DPT-COST               PIC S9(08)V99            RVKRP008
00296                                                      VALUE +0     RVKRP008
00297                                                      COMP-3.      RVKRP008
00298          10 PA-MO-DPT-QTY                PIC S9(06)  VALUE +0     RVKRP008
00299                                                      COMP-3.      RVKRP008
00300          10 PA-MO-DPT-COST               PIC S9(08)V99            RVKRP008
00301                                                      VALUE +0     RVKRP008
00302                                                      COMP-3.      RVKRP008
00303      05  PA-DMM-TOTALS.                                           RVKRP008
00304          10 PA-DR-DMM-QTY                PIC S9(06)  VALUE +0     RVKRP008
00305                                                      COMP-3.      RVKRP008
00306          10 PA-DR-DMM-COST               PIC S9(08)V99            RVKRP008
00307                                                      VALUE +0     RVKRP008
00308                                                      COMP-3.      RVKRP008
00309          10 PA-DD-DMM-QTY                PIC S9(06)  VALUE +0     RVKRP008
00310                                                      COMP-3.      RVKRP008
00311          10 PA-DD-DMM-COST               PIC S9(08)V99            RVKRP008
00312                                                      VALUE +0     RVKRP008
00313                                                      COMP-3.      RVKRP008
00314          10 PA-MO-DMM-QTY                PIC S9(06)  VALUE +0     RVKRP008
00315                                                      COMP-3.      RVKRP008
00316          10 PA-MO-DMM-COST               PIC S9(08)V99            RVKRP008
00317                                                      VALUE +0     RVKRP008
00318                                                      COMP-3.      RVKRP008
00319      05  PA-FCLTY-TOTALS.                                         RVKRP008
00320          10 PA-DR-FCLTY-QTY              PIC S9(06)  VALUE +0     RVKRP008
00321                                                      COMP-3.      RVKRP008
00322          10 PA-DR-FCLTY-COST             PIC S9(08)V99            RVKRP008
00323                                                      VALUE +0     RVKRP008
00324                                                      COMP-3.      RVKRP008
00325          10 PA-DD-FCLTY-QTY              PIC S9(06)  VALUE +0     RVKRP008
00326                                                      COMP-3.      RVKRP008
00327          10 PA-DD-FCLTY-COST             PIC S9(08)V99            RVKRP008
00328                                                      VALUE +0     RVKRP008
00329                                                      COMP-3.      RVKRP008
00330          10 PA-MO-FCLTY-QTY              PIC S9(06)  VALUE +0     RVKRP008
00331                                                      COMP-3.      RVKRP008
00332          10 PA-MO-FCLTY-COST             PIC S9(08)V99            RVKRP008
00333                                                      VALUE +0     RVKRP008
00334                                                      COMP-3.      RVKRP008
00335      05  PA-GRAND-TOTALS.                                         RVKRP008
00336          10 PA-DR-GRAND-QTY              PIC S9(06)  VALUE +0     RVKRP008
00337                                                      COMP-3.      RVKRP008
00338          10 PA-DR-GRAND-COST             PIC S9(08)V99            RVKRP008
00339                                                      VALUE +0     RVKRP008
00340                                                      COMP-3.      RVKRP008
00341          10 PA-DD-GRAND-QTY              PIC S9(06)  VALUE +0     RVKRP008
00342                                                      COMP-3.      RVKRP008
00343          10 PA-DD-GRAND-COST             PIC S9(08)V99            RVKRP008
00344                                                      VALUE +0     RVKRP008
00345                                                      COMP-3.      RVKRP008
00346          10 PA-MO-GRAND-QTY              PIC S9(06)  VALUE +0     RVKRP008
00347                                                      COMP-3.      RVKRP008
00348          10 PA-MO-GRAND-COST             PIC S9(08)V99            RVKRP008
00349                                                      VALUE +0     RVKRP008
00350                                                      COMP-3.      RVKRP008
00351                                                                   RVKRP008
00352  01  PC-CONSTANTS.                                                RVKRP008
00353      05  PC-COMMIT-INTERVAL              PIC  9(02)  VALUE 10.    RVKRP008
00354      05  PC-MAX-REFERRAL-CODES           PIC S9(04)  VALUE +7     RVKRP008
00355                                                      COMP SYNC.   RVKRP008
00356 * 6 LPI -- 14 X 8.5 PAPER (6 * 8.5 = 51)                          RVKRP008
00357      05  PC-MAX-REPORT-LINES             PIC S9(04)  VALUE +55    RVKRP008
00358                                                      COMP SYNC.   RVKRP008
00359      05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   RVKRP008
00360                                                      COMP SYNC.   RVKRP008
00361      05  PC-ZERO                         PIC  9(01)  VALUE 0.     RVKRP008
00362      05  PC-ONE                          PIC  9(01)  VALUE 1.     RVKRP008
00363      05  PC-TWO                          PIC  9(01)  VALUE 2.     RVKRP008
00364      05  PC-THREE                        PIC  9(01)  VALUE 3.     RVKRP008
00365      05  PC-FOUR                         PIC  9(01)  VALUE 4.     RVKRP008
00366      05  PC-EIGHT                        PIC  9(01)  VALUE 8.     RVKRP008
00367      05  PC-NINE                         PIC  9(01)  VALUE 9.     RVKRP008
00368      05  PC-KOHLS-OPERATING-COMPANY      PIC  X(02)  VALUE '03'.  RVKRP008
00369      05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        RVKRP008
00370          'RVKRP008'.                                              RVKRP008
00371      05  PC-CURRENT-JOB-NAME             PIC  X(08)  VALUE        RVKRP008
00372          'RVK050  '.                                              RVKRP008
00373      05  PC-SKU-DESC-ZERO                PIC  X(15)  VALUE        RVKRP008
00374          'V E N D O R    '.                                       RVKRP008
00377      05  PC-MBS-SYSTEM-CODE-RV           PIC  X(02)  VALUE 'RV'.  RVKRP008
00378      05  PC-MBS-OP-CO-03                 PIC  X(02)  VALUE '03'.  RVKRP008
00379      05  PC-PGM-DPKUT039                 PIC  X(08)               RVKRP008
00380                                          VALUE 'DPKUT039'.        RVKRP008
00381                                                                   RVKRP008
00382  01  PS-PROGRAM-SWITCHES.                                         RVKRP008
00383      05  PS-END-OF-EXTRACT-FILE-IND      PIC  X(01)  VALUE 'N'.   RVKRP008
00384          88  PS-END-OF-EXTRACT-FILE                  VALUE 'Y'.   RVKRP008
00385          88  PS-NOT-END-OF-EXTRACT-FILE              VALUE 'N'.   RVKRP008
00386                                                                   RVKRP008
00387      05  PS-NEW-LINE-IND                 PIC  X(01)  VALUE 'N'.   RVKRP008
00388          88  PS-NEW-LINE                             VALUE 'Y'.   RVKRP008
00389          88  PS-NO-NEW-LINE                          VALUE 'N'.   RVKRP008
00390                                                                   RVKRP008
00391      05  PS-NO-DATA-IND                  PIC  X(01)  VALUE 'N'.   RVKRP008
00392          88  PS-NO-DATA                              VALUE 'N'.   RVKRP008
00393          88  PS-DATA                                 VALUE 'Y'.   RVKRP008
00394                                                                   RVKRP008
00395      05  PS-TOTAL-TYPE-IND               PIC  X(01)  VALUE ' '.   RVKRP008
00396          88  PS-DMM-TOTAL                            VALUE '1'.   RVKRP008
00397          88  PS-DPT-TOTAL                            VALUE '2'.   RVKRP008
00398          88  PS-FCLTY-TOTAL                          VALUE '3'.   RVKRP008
00399          88  PS-GRAND-TOTAL                          VALUE '4'.   RVKRP008
00400                                                                   RVKRP008
00401  01  PV-PROGRAM-VARIABLES.                                        RVKRP008
00402      05  PV-PAGE-COUNT                   PIC S9(04)  VALUE +0     RVKRP008
00403                                                      COMP SYNC.   RVKRP008
00404      05  PV-LINE-COUNT                   PIC S9(04)  VALUE +0     RVKRP008
00405                                                      COMP SYNC.   RVKRP008
00406                                                                   RVKRP008
00407      05  PV-HOLD-DPT-NBR                 PIC  X(03).              RVKRP008
00408      05  PV-HOLD-DPT-DESC                PIC  X(25).              RVKRP008
00409      05  PV-HOLD-DMM-NMBR                PIC  X(03).              RVKRP008
00410      05  PV-HOLD-DMM-NAME                PIC  X(25).              RVKRP008
00411      05  PV-HOLD-OPER-UNT-ID             PIC S9(04) COMP.         RVKRP008
00412      05  PV-HOLD-FCLTY-ABBR              PIC  X(10).              RVKRP008
00413      05  PV-RPT-TYPE                     PIC  X(1).               RVKRP008
00414          88  PV-MONTHLY-REPORT           VALUE 'M'.               RVKRP008
00415          88  PV-YTD-REPORT               VALUE 'Y'.               RVKRP008
00414          88  PV-WEEKLY-REPORT            VALUE 'W'.               RVKRP008
00416 *                                                                 RVKRP008
00417      05  PV-START-DATE.                                           RVKRP008
00418          10  PV-START-MONTH              PIC  9(02).              RVKRP008
00419          10  FILLER                      PIC  X(01) VALUE '/'.    RVKRP008
00420          10  PV-START-DAY                PIC  9(02).              RVKRP008
00421          10  FILLER                      PIC  X(01) VALUE '/'.    RVKRP008
00422          10  PV-START-CENTURY            PIC  9(02).              RVKRP008
00423          10  PV-START-YEAR               PIC  9(02).              RVKRP008
00424      05  PV-END-DATE.                                             RVKRP008
00425          10  PV-END-MONTH                PIC  9(02).              RVKRP008
00426          10  FILLER                      PIC  X(01) VALUE '/'.    RVKRP008
00427          10  PV-END-DAY                  PIC  9(02).              RVKRP008
00428          10  FILLER                      PIC  X(01) VALUE '/'.    RVKRP008
00429          10  PV-END-CENTURY              PIC  9(02).              RVKRP008
00430          10  PV-END-YEAR                 PIC  9(02).              RVKRP008
00431      05  PV-REPORT-LINE                 PIC X(132).               RVKRP008
00432      05  PV-CHAR-COUNT                   PIC S9(02)  VALUE +0     RVKRP008
00433                                                      COMP SYNC.   RVKRP008
00434      05  PV-TOTAL-DESCRIPTION           PIC X(25) VALUE SPACES    RVKRP008
00435                                                   JUST RIGHT.     RVKRP008
00436      05  PV-TEMP-TOTAL-DESC.                                      RVKRP008
00437          10 FILLER                       PIC  X(01)               RVKRP008
00438             OCCURS 25 TIMES DEPENDING ON PV-CHAR-COUNT.           RVKRP008
00439                                                                   RVKRP008
00440                                                                   RVKRP008
00441  01  ST-SYSTEM-TIME.                                              RVKRP008
00442      05  ST-SYSTEM-HOUR                  PIC  9(02)  VALUE ZEROS. RVKRP008
00443      05  ST-SYSTEM-MINUTE                PIC  9(02)  VALUE ZEROS. RVKRP008
00444                                                                   RVKRP008
00445 *                                                                 RVKRP008
00446 ******************************************************************RVKRP008
00447 *  WORK FIELDS FOR THE MBS SUBROUTINE                             RVKRP008
00448 ******************************************************************RVKRP008
00449      COPY DPWS003.                                                RVKRP008
00450                                                                   RVKRP008
00451 * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * RVKRP008
00452  PROCEDURE DIVISION.                                              RVKRP008
00453 * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * RVKRP008
00454                                                                   RVKRP008
00455 ******************************************************************RVKRP008
00456 *  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    RVKRP008
00457 ******************************************************************RVKRP008
00458  0000-PROGRAM-MAINLINE.                                           RVKRP008
00459                                                                   RVKRP008
00460      PERFORM 1000-INITIALIZE.                                     RVKRP008
00461                                                                   RVKRP008
00462      PERFORM 2000-CREATE-REPORT.                                  RVKRP008
00463                                                                   RVKRP008
00464      PERFORM 9000-EOJ-ROUTINE.                                    RVKRP008
00465      STOP RUN.                                                    RVKRP008
00466 *0000-EXIT.                                                       RVKRP008
00467                                                                   RVKRP008
00468 ******************************************************************RVKRP008
00469 *  1000-INITIALIZE -  OPENS ALL THE REPORT FILE, ACCEPTS, EDITS,  RVKRP008
00470 *  AND DISPLAYS CONTROL CARD INFORMATION, OPENS AND FETCHES FIRST RVKRP008
00471 *  OCCURANCE OF DB2 CURSOR, PRINTS INITIAL PAGE HEADING TO REPORT RVKRP008
00472 *  FILE.                                                          RVKRP008
00473 ******************************************************************RVKRP008
00474  1000-INITIALIZE.                                                 RVKRP008
00475                                                                   RVKRP008
00476      OPEN OUTPUT DI-DEFECT-ITEM-REPORT                            RVKRP008
00477           INPUT  RTV-REPORT-EXTRACT.                              RVKRP008
00478                                                                   RVKRP008
00479      SET PS-NOT-END-OF-EXTRACT-FILE TO TRUE.                      RVKRP008
00480                                                                   RVKRP008
00481      PERFORM 7000-READ-EXTRACT-FILE.                              RVKRP008
00482                                                                   RVKRP008
00483      IF PS-END-OF-EXTRACT-FILE                                    RVKRP008
00484          SET PS-NO-DATA          TO TRUE                          RVKRP008
00485      ELSE                                                         RVKRP008
00486          IF RV010-DETAIL-REC                                      RVKRP008
00487              DISPLAY '** ABEND **'                                RVKRP008
00488              DISPLAY '** PROGRAM = RVKRP008 **'                   RVKRP008
00489              DISPLAY '** PARAGRAPH = 1000-INITIALIZE.     **'     RVKRP008
00490              DISPLAY '** FIRST RECORD NOT THE DATE RECORD **'     RVKRP008
00491              MOVE +4003 TO ABEND-CODE                             RVKRP008
00492              CALL 'ILBOABN0' USING ABEND-CODE                     RVKRP008
00493          ELSE                                                     RVKRP008
00494              SET PS-DATA           TO TRUE                        RVKRP008
00495                                                                   RVKRP008
00496              MOVE RV010-RPT-TYPE   TO PV-RPT-TYPE                 RVKRP008
00497                                                                   RVKRP008
00498              MOVE RV010-END-MM     TO PV-END-MONTH                RVKRP008
00499              MOVE RV010-END-DD     TO PV-END-DAY                  RVKRP008
00500              MOVE RV010-END-CC     TO PV-END-CENTURY              RVKRP008
00501              MOVE RV010-END-YY     TO PV-END-YEAR                 RVKRP008
00502                                                                   RVKRP008
00503              MOVE RV010-BEGIN-MM   TO PV-START-MONTH              RVKRP008
00504              MOVE RV010-BEGIN-DD   TO PV-START-DAY                RVKRP008
00505              MOVE RV010-BEGIN-CC   TO PV-START-CENTURY            RVKRP008
00506              MOVE RV010-BEGIN-YY   TO PV-START-YEAR               RVKRP008
00507                                                                   RVKRP008
00508              MOVE PV-START-DATE    TO PH3-START-DATE              RVKRP008
00509              MOVE PV-END-DATE      TO PH3-END-DATE                RVKRP008
00510                                                                   RVKRP008
00511              MOVE RV010-CURR-YY    TO DP132O-RUN-YEAR             RVKRP008
00512              MOVE RV010-CURR-MM    TO DP132O-RUN-MONTH            RVKRP008
00513              MOVE RV010-CURR-DD    TO DP132O-RUN-DAY              RVKRP008
00514                                                                   RVKRP008
00515              ACCEPT ST-SYSTEM-TIME FROM TIME                      RVKRP008
00516              MOVE ST-SYSTEM-HOUR   TO DP132O-RUN-HOUR             RVKRP008
00517              MOVE ST-SYSTEM-MINUTE TO DP132O-RUN-MINUTE           RVKRP008
00518                                                                   RVKRP008
00519              MOVE 'RVKRP008'       TO DP132O-PROGRAM-NAME         RVKRP008
00520                                                                   RVKRP008
                   EVALUATE TRUE                                                
00521                WHEN PV-MONTHLY-REPORT                             RVKRP008
00522                  MOVE 1            TO DP132O-REPORT-NUMBER        RVKRP008
00521                WHEN PV-YTD-REPORT                                 RVKRP008
00524                  MOVE 2            TO DP132O-REPORT-NUMBER        RVKRP008
00521                WHEN PV-WEEKLY-REPORT                              RVKRP008
00524                  MOVE 3            TO DP132O-REPORT-NUMBER        RVKRP008
00525              END-EVALUATE                                         RVKRP008
00526                                                                   RVKRP008
00527              MOVE PC-MAX-REPORT-LINES                             RVKRP008
00528                                    TO PV-LINE-COUNT               RVKRP008
00529              MOVE +0               TO PV-PAGE-COUNT               RVKRP008
00530                                                                   RVKRP008
00531              INITIALIZE DL-DETAIL-LINE                            RVKRP008
00532                         PA-PROGRAM-ACCUMULATORS                   RVKRP008
00533              PERFORM 7000-READ-EXTRACT-FILE                       RVKRP008
00534          END-IF                                                   RVKRP008
00535      END-IF.                                                      RVKRP008
00536                                                                   RVKRP008
00537                                                                   RVKRP008
00538 *1000-EXIT.                                                       RVKRP008
00539                                                                   RVKRP008
00540 ******************************************************************RVKRP008
00541 * 2000-CREATE-REPORT                                              RVKRP008
00542 * PROCESS:  THIS PARAGRAPH WILL SET UP THE WORKING STORAGE INTERNARVKRP008
00543 * SORT FILE.                                                      RVKRP008
00544 ******************************************************************RVKRP008
00545  2000-CREATE-REPORT.                                              RVKRP008
00546                                                                   RVKRP008
00547      IF PS-END-OF-EXTRACT-FILE                                    RVKRP008
00548          MOVE ER-EMPTY-REPORT-LINE  TO PV-REPORT-LINE             RVKRP008
00549          PERFORM 8000-PRINT-REPORT-LINE                           RVKRP008
00550      ELSE                                                         RVKRP008
00551          MOVE RV010-DPT-NBR       TO PV-HOLD-DPT-NBR              RVKRP008
00552          MOVE RV010-DPT-DESC      TO PV-HOLD-DPT-DESC             RVKRP008
00553          MOVE RV010-DMM-NAME      TO PV-HOLD-DMM-NAME             RVKRP008
00554          MOVE RV010-DMM-NBR       TO PV-HOLD-DMM-NMBR             RVKRP008
00555          MOVE RV010-OPER-UNT-ID   TO PV-HOLD-OPER-UNT-ID          RVKRP008
00556          MOVE RV010-FCLTY-ABBR    TO PV-HOLD-FCLTY-ABBR           RVKRP008
00557 *                                                                 RVKRP008
00558          PERFORM UNTIL PS-END-OF-EXTRACT-FILE                     RVKRP008
00559              IF RV010-DMM-NBR = PV-HOLD-DMM-NMBR                  RVKRP008
00560                  IF RV010-DPT-NBR = PV-HOLD-DPT-NBR               RVKRP008
00561                      IF RV010-OPER-UNT-ID = PV-HOLD-OPER-UNT-ID   RVKRP008
00562                          PERFORM 2100-ACCUMULATE-TOTALS           RVKRP008
00563                      ELSE                                         RVKRP008
00564                          PERFORM 2200-FCLTY-BREAK                 RVKRP008
00565                      END-IF                                       RVKRP008
00566                  ELSE                                             RVKRP008
00567                      PERFORM 2300-DPT-BREAK                       RVKRP008
00568                  END-IF                                           RVKRP008
00569              ELSE                                                 RVKRP008
00570                  PERFORM 2400-DMM-BREAK                           RVKRP008
00571              END-IF                                               RVKRP008
00572                                                                   RVKRP008
00573              PERFORM 7000-READ-EXTRACT-FILE                       RVKRP008
00574                                                                   RVKRP008
00575          END-PERFORM                                              RVKRP008
00576      END-IF.                                                      RVKRP008
00577                                                                   RVKRP008
00578 ******************************************************************RVKRP008
00579 * 2100-ACCUMULATE-TOTALS                                          RVKRP008
00580 * PROCESS:  THIS PARAGRAPH WILL ACCUMULATE TOTALS AT THE DEPARTMENRVKRP008
00581 *  LEVEL.                                                         RVKRP008
00582 ******************************************************************RVKRP008
00583  2100-ACCUMULATE-TOTALS.                                          RVKRP008
00584                                                                   RVKRP008
00585      EVALUATE TRUE                                                RVKRP008
00586          WHEN RV010-RTV-TYPE                                      RVKRP008
00587              ADD RV010-UNIT-COST-AMT TO PA-DR-FCLTY-COST          RVKRP008
00588              ADD +1                  TO PA-DR-FCLTY-QTY           RVKRP008
00589                                                                   RVKRP008
00590          WHEN RV010-DD-TYPE                                       RVKRP008
00591              ADD RV010-UNIT-COST-AMT TO PA-DD-FCLTY-COST          RVKRP008
00592              ADD +1                  TO PA-DD-FCLTY-QTY           RVKRP008
00593                                                                   RVKRP008
00594          WHEN RV010-MO-TYPE                                       RVKRP008
00595              ADD RV010-UNIT-COST-AMT TO PA-MO-FCLTY-COST          RVKRP008
00596              ADD +1                  TO PA-MO-FCLTY-QTY           RVKRP008
00597      END-EVALUATE.                                                RVKRP008
00598                                                                   RVKRP008
00599 *                                                                 RVKRP008
00600 ******************************************************************RVKRP008
00601 * 2200-FCLTY-BREAK                                                RVKRP008
00602 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR A CHANGE IN RVKRP008
00603 *  THE FACILITY (OPERATING UNIT ID)                               RVKRP008
00604 *     1) PERFORM DMM BREAK LOGIC                                  RVKRP008
00605 *     2) PRINT FACILITY TOTAL LINE (SET COUNT FOR A PAGE BREAK)   RVKRP008
00606 *     3) RESET THE "HOLD" FACILITY ID                             RVKRP008
00607 *     4) ADD "OLD" FACIITY TOTALS TO THE GRAND TOTALS             RVKRP008
00608 *     5) INITIALIZE FACILITY TOTALS FOR NEW FACILITY              RVKRP008
00609 ******************************************************************RVKRP008
00610  2200-FCLTY-BREAK.                                                RVKRP008
00611                                                                   RVKRP008
00612      PERFORM 8000-PRINT-REPORT-LINE.                              RVKRP008
00613                                                                   RVKRP008
00614      MOVE RV010-OPER-UNT-ID   TO PV-HOLD-OPER-UNT-ID.             RVKRP008
00615      MOVE RV010-FCLTY-ABBR    TO DL-FCLTY-ABBR                    RVKRP008
00616                                  PV-HOLD-FCLTY-ABBR.              RVKRP008
00617 *                                                                 RVKRP008
00618      ADD PA-DR-FCLTY-QTY      TO PA-DR-DPT-QTY.                   RVKRP008
00619      ADD PA-DR-FCLTY-COST     TO PA-DR-DPT-COST.                  RVKRP008
00620                                                                   RVKRP008
00621      ADD PA-DD-FCLTY-QTY      TO PA-DD-DPT-QTY.                   RVKRP008
00622      ADD PA-DD-FCLTY-COST     TO PA-DD-DPT-COST.                  RVKRP008
00623                                                                   RVKRP008
00624      ADD PA-MO-FCLTY-QTY      TO PA-MO-DPT-QTY.                   RVKRP008
00625      ADD PA-MO-FCLTY-COST     TO PA-MO-DPT-COST.                  RVKRP008
00626 *                                                                 RVKRP008
00627      INITIALIZE PA-FCLTY-TOTALS.                                  RVKRP008
00628 *                                                                 RVKRP008
00629      PERFORM 2100-ACCUMULATE-TOTALS.                              RVKRP008
00630                                                                   RVKRP008
00631 ******************************************************************RVKRP008
00632 * 2300-DPT-BREAK.                                                 RVKRP008
00633 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR A CHANGE IN RVKRP008
00634 *  THE DEPARTMENT NUMBER:                                         RVKRP008
00635 *     1) PRINT LINE OF OLD DEPT TO REPORT                         RVKRP008
00636 *     2) RESET THE "HOLD" VARIABLES                               RVKRP008
00637 *     3) ADD "OLD" DEPT TOTALS TO DMM TOTALS                      RVKRP008
00638 *     4) INITIALIZE DEPT TOTALS FOR NEW DEPT                      RVKRP008
00639 *     5) ADD CURRENT VALUES TO NEW DEPT TOTALS                    RVKRP008
00640 ******************************************************************RVKRP008
00641  2300-DPT-BREAK.                                                  RVKRP008
00642                                                                   RVKRP008
00643      PERFORM 2200-FCLTY-BREAK.                                    RVKRP008
00644 *                                                                 RVKRP008
00645      SET PS-DPT-TOTAL         TO TRUE.                            RVKRP008
00646      PERFORM 8100-PRINT-TOTAL-LINE.                               RVKRP008
00647 *                                                                 RVKRP008
00648      MOVE RV010-DPT-NBR       TO DL-DPT-NBR                       RVKRP008
00649                                  PV-HOLD-DPT-NBR.                 RVKRP008
00650      MOVE RV010-DPT-DESC      TO DL-DPT-DESC                      RVKRP008
00651                                  PV-HOLD-DPT-DESC.                RVKRP008
00652                                                                   RVKRP008
00653      ADD PA-DR-DPT-QTY        TO PA-DR-DMM-QTY.                   RVKRP008
00654      ADD PA-DR-DPT-COST       TO PA-DR-DMM-COST.                  RVKRP008
00655 *                                                                 RVKRP008
00656      ADD PA-DD-DPT-QTY        TO PA-DD-DMM-QTY.                   RVKRP008
00657      ADD PA-DD-DPT-COST       TO PA-DD-DMM-COST.                  RVKRP008
00658 *                                                                 RVKRP008
00659      ADD PA-MO-DPT-QTY        TO PA-MO-DMM-QTY.                   RVKRP008
00660      ADD PA-MO-DPT-COST       TO PA-MO-DMM-COST.                  RVKRP008
00661 *                                                                 RVKRP008
00662      INITIALIZE PA-DPT-TOTALS.                                    RVKRP008
00663 *                                                                 RVKRP008
00664 ******************************************************************RVKRP008
00665 * 2400-DMM-BREAK                                                  RVKRP008
00666 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR A CHANGE IN RVKRP008
00667 *  THE DMM:                                                       RVKRP008
00668 *     1) PERFORM DEPT BREAK LOGIC                                 RVKRP008
00669 *     2) PRINT DMM TOTAL LINE                                     RVKRP008
00670 *     3) RESET THE "HOLD" DMM VALUE                               RVKRP008
00671 *     4) ADD "OLD" DMM TOTALS TO FACILITY TOTALS                  RVKRP008
00672 *     5) INITIALIZE DMM TOTALS FOR NEW DMM                        RVKRP008
00673 ******************************************************************RVKRP008
00674  2400-DMM-BREAK.                                                  RVKRP008
00675                                                                   RVKRP008
00676      PERFORM 2300-DPT-BREAK.                                      RVKRP008
00677 *                                                                 RVKRP008
00678      SET PS-DMM-TOTAL         TO TRUE.                            RVKRP008
00679      PERFORM 8100-PRINT-TOTAL-LINE.                               RVKRP008
00680 *                                                                 RVKRP008
00681      MOVE RV010-DMM-NAME      TO DL-DMM-NAME                      RVKRP008
00682                                  PV-HOLD-DMM-NAME.                RVKRP008
00683      MOVE RV010-DMM-NBR       TO DL-DMM-NBR                       RVKRP008
00684                                  PV-HOLD-DMM-NMBR.                RVKRP008
00685 *                                                                 RVKRP008
00686      ADD PA-DR-DMM-QTY        TO PA-DR-GRAND-QTY.                 RVKRP008
00687      ADD PA-DR-DMM-COST       TO PA-DR-GRAND-COST.                RVKRP008
00688                                                                   RVKRP008
00689      ADD PA-DD-DMM-QTY        TO PA-DD-GRAND-QTY.                 RVKRP008
00690      ADD PA-DD-DMM-COST       TO PA-DD-GRAND-COST.                RVKRP008
00691                                                                   RVKRP008
00692      ADD PA-MO-DMM-QTY        TO PA-MO-GRAND-QTY.                 RVKRP008
00693      ADD PA-MO-DMM-COST       TO PA-MO-GRAND-COST.                RVKRP008
00694 *                                                                 RVKRP008
00695      INITIALIZE PA-DMM-TOTALS.                                    RVKRP008
00696 *                                                                 RVKRP008
00697 *    START ON NEW PAGE WITH NEW PAGE NUMBERING AT THE DMM LEVEL   RVKRP008
00698      MOVE PC-MAX-REPORT-LINES TO PV-LINE-COUNT.                   RVKRP008
00699      MOVE +0                  TO PV-PAGE-COUNT.                   RVKRP008
00700 *                                                                 RVKRP008
00701 ******************************************************************RVKRP008
00702 * 2500-GRAND-TOTAL                                                RVKRP008
00703 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR THE GRAND   RVKRP008
00704 *  TOTAL:                                                         RVKRP008
00705 *     1) PERFORM DMM BREAK LOGIC                                  RVKRP008
00706 *     2) PRINT FACILITY TOTAL LINE                                RVKRP008
00707 *     3) RESET THE "HOLD" FACILITY ID                             RVKRP008
00708 *     4) ADD "OLD" FACIITY TOTALS TO THE GRAND TOTALS             RVKRP008
00709 *     5) INITIALIZE FACILITY TOTALS FOR NEW FACILITY              RVKRP008
00710 ******************************************************************RVKRP008
00711  2500-GRAND-TOTAL.                                                RVKRP008
00712                                                                   RVKRP008
00713      PERFORM 2400-DMM-BREAK.                                      RVKRP008
00714 *                                                                 RVKRP008
00715      SET PS-GRAND-TOTAL       TO TRUE.                            RVKRP008
00716      PERFORM 8100-PRINT-TOTAL-LINE.                               RVKRP008
00717 *                                                                 RVKRP008
00718 *                                                                 RVKRP008
00719 ******************************************************************RVKRP008
00720 * 7000-READ-EXTRACT-FILE.                                        *RVKRP008
00721 *  THIS PROCEDURE WILL READ ONE EXTRACT RECORD FROM THE EXTRACT  *RVKRP008
00722 *  FLAT FILE.                                                    *RVKRP008
00723 ******************************************************************RVKRP008
00724  7000-READ-EXTRACT-FILE.                                          RVKRP008
00725 *                                                                 RVKRP008
00726      READ RTV-REPORT-EXTRACT                                      RVKRP008
00727          INTO RV010-EXTRACT-RECORD                                RVKRP008
00728          AT END SET PS-END-OF-EXTRACT-FILE TO TRUE.               RVKRP008
00729                                                                   RVKRP008
00730 ******************************************************************RVKRP008
00731 * 8000-PRINT-REPORT-LINE - CHECKS IF THE PAGE SIZE HAS BEEN EX-   RVKRP008
00732 * CEEDED.  IF SO, THE HEADING LINES ARE WRITTEN AND THE LINE COUNTRVKRP008
00733 * INITIALIZED.  THE DETAIL LINE IS THEN WRITTEN.                  RVKRP008
00734 ******************************************************************RVKRP008
00735  8000-PRINT-REPORT-LINE.                                          RVKRP008
00736                                                                   RVKRP008
00737      ADD +1 TO PV-LINE-COUNT.                                     RVKRP008
00738                                                                   RVKRP008
00739      IF PV-LINE-COUNT >= PC-MAX-REPORT-LINES                      RVKRP008
00740          PERFORM 8300-WRITE-PAGE-HEADING                          RVKRP008
00741          PERFORM 8400-WRITE-COLUMN-HEADING                        RVKRP008
00742      END-IF.                                                      RVKRP008
00743                                                                   RVKRP008
00744      MOVE PA-DR-FCLTY-QTY          TO DL-DR-QTY.                  RVKRP008
00745      MOVE PA-DR-FCLTY-COST         TO DL-DR-COST.                 RVKRP008
00746      MOVE PA-DD-FCLTY-QTY          TO DL-DD-QTY.                  RVKRP008
00747      MOVE PA-DD-FCLTY-COST         TO DL-DD-COST.                 RVKRP008
00748      MOVE PA-MO-FCLTY-QTY          TO DL-MO-QTY.                  RVKRP008
00749      MOVE PA-MO-FCLTY-COST         TO DL-MO-COST.                 RVKRP008
00750                                                                   RVKRP008
00751      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP008
00752          FROM DL-DETAIL-LINE                                      RVKRP008
00753          AFTER ADVANCING 1 LINES.                                 RVKRP008
00754                                                                   RVKRP008
00755      MOVE SPACES                   TO DL-DPT-NBR                  RVKRP008
00756                                       DL-DPT-DESC                 RVKRP008
00757                                       DL-DMM-NAME                 RVKRP008
00758                                       DL-DMM-NBR                  RVKRP008
00759                                       DL-FCLTY-ABBR.              RVKRP008
00760                                                                   RVKRP008
00761 *8000-EXIT.                                                       RVKRP008
00762                                                                   RVKRP008
00763 ******************************************************************RVKRP008
00764 * 8100-PRINT-TOTAL-LINE - WRITE THE CONTROL BREAK TOTAL LINES     RVKRP008
00765 ******************************************************************RVKRP008
00766  8100-PRINT-TOTAL-LINE.                                           RVKRP008
00767                                                                   RVKRP008
00768      EVALUATE TRUE                                                RVKRP008
00769          WHEN PS-DPT-TOTAL                                        RVKRP008
00770              SET  PS-NEW-LINE         TO TRUE                     RVKRP008
00771              MOVE SPACES              TO TL-TOTAL-DESCRIPTION     RVKRP008
00772              MOVE PA-DR-DPT-QTY       TO TL-DR-QTY                RVKRP008
00773              MOVE PA-DR-DPT-COST      TO TL-DR-COST               RVKRP008
00774              MOVE PA-DD-DPT-QTY       TO TL-DD-QTY                RVKRP008
00775              MOVE PA-DD-DPT-COST      TO TL-DD-COST               RVKRP008
00776              MOVE PA-MO-DPT-QTY       TO TL-MO-QTY                RVKRP008
00777              MOVE PA-MO-DPT-COST      TO TL-MO-COST               RVKRP008
00778                                                                   RVKRP008
00779          WHEN PS-DMM-TOTAL                                        RVKRP008
00780              SET  PS-NEW-LINE         TO TRUE                     RVKRP008
00781              MOVE +0 TO PV-CHAR-COUNT                             RVKRP008
00782                                                                   RVKRP008
00783              INSPECT PV-HOLD-DMM-NAME TALLYING PV-CHAR-COUNT      RVKRP008
00784                  FOR CHARACTERS BEFORE '  '                       RVKRP008
00785                                                                   RVKRP008
00786              MOVE PV-HOLD-DMM-NAME    TO PV-TEMP-TOTAL-DESC       RVKRP008
00787                                                                   RVKRP008
00788              MOVE PV-TEMP-TOTAL-DESC  TO PV-TOTAL-DESCRIPTION     RVKRP008
00789              MOVE PV-TOTAL-DESCRIPTION                            RVKRP008
00790                                       TO TL-TOTAL-DESCRIPTION     RVKRP008
00791                                                                   RVKRP008
00792              MOVE PA-DR-DMM-QTY       TO TL-DR-QTY                RVKRP008
00793              MOVE PA-DR-DMM-COST      TO TL-DR-COST               RVKRP008
00794              MOVE PA-DD-DMM-QTY       TO TL-DD-QTY                RVKRP008
00795              MOVE PA-DD-DMM-COST      TO TL-DD-COST               RVKRP008
00796              MOVE PA-MO-DMM-QTY       TO TL-MO-QTY                RVKRP008
00797              MOVE PA-MO-DMM-COST      TO TL-MO-COST               RVKRP008
00798                                                                   RVKRP008
00799                                                                   RVKRP008
00800          WHEN PS-GRAND-TOTAL                                      RVKRP008
00801              MOVE '                GRAND '                        RVKRP008
00802                                       TO TL-TOTAL-DESCRIPTION     RVKRP008
00803              MOVE PA-DR-GRAND-QTY     TO TL-DR-QTY                RVKRP008
00804              MOVE PA-DR-GRAND-COST    TO TL-DR-COST               RVKRP008
00805              MOVE PA-DD-GRAND-QTY     TO TL-DD-QTY                RVKRP008
00806              MOVE PA-DD-GRAND-COST    TO TL-DD-COST               RVKRP008
00807              MOVE PA-MO-GRAND-QTY     TO TL-MO-QTY                RVKRP008
00808              MOVE PA-MO-GRAND-COST    TO TL-MO-COST               RVKRP008
00809      END-EVALUATE.                                                RVKRP008
00810                                                                   RVKRP008
00811      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP008
00812          FROM TL-TOTAL-LINE-DASHES                                RVKRP008
00813          AFTER ADVANCING 0 LINES.                                 RVKRP008
00814                                                                   RVKRP008
00815      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP008
00816          FROM TL-TOTAL-LINE                                       RVKRP008
00817          AFTER ADVANCING 1 LINES.                                 RVKRP008
00818                                                                   RVKRP008
00819      ADD +1                        TO PV-LINE-COUNT.              RVKRP008
00820                                                                   RVKRP008
00821      PERFORM 8200-WRITE-BLANK-LINE.                               RVKRP008
00822                                                                   RVKRP008
00823                                                                   RVKRP008
00824 *8100-EXIT.                                                       RVKRP008
00825                                                                   RVKRP008
00826 ******************************************************************RVKRP008
00827 * 8200-WRITE-BLANK-LINE - WRITES A BLANK LINE TO THE REPORT.      RVKRP008
00828 ******************************************************************RVKRP008
00829  8200-WRITE-BLANK-LINE.                                           RVKRP008
00830                                                                   RVKRP008
00831      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP008
00832          FROM BLANK-LINE                                          RVKRP008
00833          AFTER ADVANCING 1 LINES.                                 RVKRP008
00834                                                                   RVKRP008
00835      ADD +1                        TO PV-LINE-COUNT.              RVKRP008
00836                                                                   RVKRP008
00837                                                                   RVKRP008
00838 *8200-EXIT.                                                       RVKRP008
00839 ******************************************************************RVKRP008
00840 * 8300-WRITE-PAGE-HEADING - WRITE THE PAGE AND DETAIL HEADINGS FORRVKRP008
00841 * THE DEFECTIVE ITEM REPORT.                                      RVKRP008
00842 ******************************************************************RVKRP008
00843  8300-WRITE-PAGE-HEADING.                                         RVKRP008
00844                                                                   RVKRP008
00845      ADD +1 TO PV-PAGE-COUNT.                                     RVKRP008
00846      MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    RVKRP008
00847                                                                   RVKRP008
00848      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP008
00849          FROM DP132O-STANDRD-HEADER-132-COLS                      RVKRP008
00850          AFTER ADVANCING PAGE.                                    RVKRP008
00851                                                                   RVKRP008
           EVALUATE TRUE                                                        
00852        WHEN PV-MONTHLY-REPORT                                     RVKRP008
00853          WRITE DI-DEFECT-ITEM-LINE                                RVKRP008
00854              FROM PH2-PAGE-HEADING-MONTHLY                        RVKRP008
00855              AFTER ADVANCING 1 LINES                              RVKRP008
00852        WHEN PV-YTD-REPORT                                         RVKRP008
00857          WRITE DI-DEFECT-ITEM-LINE                                RVKRP008
00858              FROM PH2-PAGE-HEADING-YTD                            RVKRP008
00859              AFTER ADVANCING 1 LINES                              RVKRP008
00852        WHEN PV-WEEKLY-REPORT                                      RVKRP008
00857          WRITE DI-DEFECT-ITEM-LINE                                RVKRP008
00858              FROM PH2-PAGE-HEADING-WEEKLY                         RVKRP008
00859              AFTER ADVANCING 1 LINES                              RVKRP008
           END-EVALUATE.                                                        
00861                                                                   RVKRP008
00862      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP008
00863          FROM PH3-PAGE-HEADING-3                                  RVKRP008
00864          AFTER ADVANCING 1 LINES.                                 RVKRP008
00865                                                                   RVKRP008
00866      MOVE +4     TO PV-LINE-COUNT.                                RVKRP008
00867                                                                   RVKRP008
00868      MOVE PV-HOLD-DPT-NBR     TO DL-DPT-NBR.                      RVKRP008
00869      MOVE PV-HOLD-DPT-DESC    TO DL-DPT-DESC.                     RVKRP008
00870      MOVE PV-HOLD-DMM-NMBR    TO DL-DMM-NBR.                      RVKRP008
00871      MOVE PV-HOLD-DMM-NAME    TO DL-DMM-NAME.                     RVKRP008
00872      MOVE PV-HOLD-FCLTY-ABBR  TO DL-FCLTY-ABBR.                   RVKRP008
00873                                                                   RVKRP008
00874                                                                   RVKRP008
00875 *8300-EXIT.                                                       RVKRP008
00876                                                                   RVKRP008
00877 ******************************************************************RVKRP008
00878 * 8400-WRITE-COLUMN-HEADING - WRITE THE COLUMN HEADINGS FOR       RVKRP008
00879 * THE DEFECTIVE ITEM REPORT.                                      RVKRP008
00880 ******************************************************************RVKRP008
00881  8400-WRITE-COLUMN-HEADING.                                       RVKRP008
00882                                                                   RVKRP008
00883      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP008
00884          FROM DH1-DETAIL-HEADING-1                                RVKRP008
00885          AFTER ADVANCING 2 LINES.                                 RVKRP008
00886                                                                   RVKRP008
00887      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP008
00888          FROM DH2-DETAIL-HEADING-2                                RVKRP008
00889          AFTER ADVANCING 1 LINES.                                 RVKRP008
00890                                                                   RVKRP008
00891      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP008
00892          FROM DHD-DETAIL-HEADING-DASHES                           RVKRP008
00893          AFTER ADVANCING 0 LINES.                                 RVKRP008
00894                                                                   RVKRP008
00895      ADD +4       TO PV-LINE-COUNT.                               RVKRP008
00896 *8400-EXIT.                                                       RVKRP008
00897                                                                   RVKRP008
00898 ******************************************************************RVKRP008
00899 * 9000-EOJ-ROUTINE - PRINTS A GRAND TOTAL, AND CLOSES THE DRIVER  RVKRP008
00900 * CURSOR AND THE REPORT FILE.                                     RVKRP008
00901 ******************************************************************RVKRP008
00902  9000-EOJ-ROUTINE.                                                RVKRP008
00903                                                                   RVKRP008
00904      IF PS-NO-DATA                                                RVKRP008
00905          CONTINUE                                                 RVKRP008
00906      ELSE                                                         RVKRP008
00907          PERFORM 2500-GRAND-TOTAL                                 RVKRP008
00908      END-IF.                                                      RVKRP008
00909                                                                   RVKRP008
00910      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP008
00911          FROM END-OF-REPORT-LINE                                  RVKRP008
00912          AFTER ADVANCING 1 LINES.                                 RVKRP008
00913                                                                   RVKRP008
00914      CLOSE DI-DEFECT-ITEM-REPORT                                  RVKRP008
00915            RTV-REPORT-EXTRACT.                                    RVKRP008
00916                                                                   RVKRP008
00917 ******************************************************************RVKRP008
00918 **************************** END OF RVKRP008 *********************RVKRP008
00919 ******************************************************************RVKRP008
