      ***************************************************************** 00010000
       IDENTIFICATION DIVISION.                                         00020000
      ***************************************************************** 00030000
                                                                        00040000
       PROGRAM-ID.             PCKRP033.                                00050000
       AUTHOR.                 BRENDA ROCKWELL.                         00060000
       INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
       DATE-WRITTEN            NOVEMBER, 2011.                          00080000
       DATE-COMPILED.                                                   00090000
                                                                        00100000
      ***************************************************************** 00110000
      *                                                               * 00120000
      * THIS PROGRAM WILL CREATE/PRINT THE EFC INBOUND CARTON FORE-   * 00130000
      * CAST BY TRAILER DETAIL REPORT.                                * 00140000
      *                                                               * 00150000
      ***************************************************************** 00160000
      *  CHANGE LOG.                                                    00170000
      *  DATE         CHANGED BY      DESC                              00180000
      *  -----------  --------------  --------------------------------- 00190000
W40796*  04/03/2012   B. ROCKWELL    ADD CAN COLUMN TO REPORT           00191000
W40796*                              PROJ ID:  3347A                    00192000
W40796*                              WR/IR#:   WR40796                  00193000
      *  01/16/2012   B. ROCKWELL   - EFC OPTIMIZATION AND HOLIDAY PREP 00200000
      *                               NEW PROGRAM  PROJ ID:   3253      00210000
      *                                             WR/IR#:   WR40392   00220000
      ***************************************************************** 00230000
                                                                        00240000
      ***************************************************************** 00250000
       ENVIRONMENT DIVISION.                                            00260000
      ***************************************************************** 00270000
                                                                        00280000
       CONFIGURATION SECTION.                                           00290000
       SOURCE-COMPUTER.        IBM-3090.                                00300000
       OBJECT-COMPUTER.        IBM-3090.                                00310000
                                                                        00320000
       INPUT-OUTPUT SECTION.                                            00330000
                                                                        00340000
       FILE-CONTROL.                                                    00350000
                                                                        00360000
           SELECT INPUT01-FILE       ASSIGN TO INP01.                   00370000
           SELECT REPORT-FILE        ASSIGN TO RPT01.                   00380000
                                                                        00390000
      ***************************************************************** 00400000
       DATA DIVISION.                                                   00410000
      ***************************************************************** 00420000
                                                                        00430000
       FILE SECTION.                                                    00440000
                                                                        00450000
       FD  INPUT01-FILE                                                 00460000
           LABEL RECORDS ARE STANDARD                                   00470000
           RECORDING MODE IS F                                          00480000
           BLOCK CONTAINS 0 RECORDS                                     00490000
           RECORD CONTAINS 400 CHARACTERS.                              00500000
       01  INPUT01-RECORD                  PIC X(400).                  00510000
                                                                        00520000
       FD  REPORT-FILE                                                  00530000
           RECORDING MODE IS F                                          00540000
           BLOCK CONTAINS 0  RECORDS.                                   00550000
W40796 01  REPORT-RECORD                   PIC  X(150).                 00560000
                                                                        00570000
       WORKING-STORAGE SECTION.                                         00580000
                                                                        00590000
       01  PROGRAM-SWITCHES.                                            00600000
           05  PS-END-OF-INPUT-SW          PIC  X(01)    VALUE 'N'.     00610000
               88  PS-END-OF-INPUT                       VALUE 'Y'.     00620000
           05  PS-UNPR-TOT-NEEDED          PIC  X(01)    VALUE 'N'.     00740000
               88  PS-UNPR-NEEDED-YES                    VALUE 'Y'.     00750000
               88  PS-UNPR-NEEDED-NO                     VALUE 'N'.     00760000
           05  PS-HGPK-TOT-NEEDED          PIC  X(01)    VALUE 'N'.     00770000
               88  PS-HGPK-NEEDED-YES                    VALUE 'Y'.     00780000
               88  PS-HGPK-NEEDED-NO                     VALUE 'N'.     00790000
           05  PS-PROC-TOT-NEEDED          PIC  X(01)    VALUE 'N'.     00800000
               88  PS-PROC-NEEDED-YES                    VALUE 'Y'.     00810000
               88  PS-PROC-NEEDED-NO                     VALUE 'N'.     00820000
                                                                        00830000
       01  PC-CONSTANTS.                                                00840000
           05  PC-PROGRAM-NAME             PIC  X(08)    VALUE          00850000
                                 'PCKRP033'.                            00860000
           05  PC-REPORT-NBR               PIC  X(02)    VALUE          00870000
                                 '-1'.                                  00880000
                                                                        00890000
       01  PV-MISC-FIELDS.                                              00900000
           05  PV-LINE-CNT                 PIC S9(05) COMP-3 VALUE +0.  00910000
           05  PV-LINE-LIMIT               PIC S9(03) COMP-3 VALUE +57. 00920000
           05  PV-PAGE-CNT                 PIC S9(05) COMP-3 VALUE +0.  00930000
           05  PV-CTNS-NOT-SCND            PIC S9(9) COMP-3 VALUE +0.   01010000
           05  PV-TODAYS-DATE.                                          01120000
               10  PV-TODAYS-DATE-CCYY     PIC  9(04)    VALUE ZERO.    01130000
               10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    01140000
               10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    01150000
           05  PV-TODAYS-TIME.                                          01160000
               10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    01170000
               10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    01180000
               10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    01190000
               10  FILLER                  PIC  9(02)    VALUE ZERO.    01200000
           05  PV-FORMAT-DATE.                                          01210000
               10  PV-FORMAT-DATE-MM       PIC  X(02)    VALUE SPACES.  01220000
               10  FILLER                  PIC  X(01)    VALUE '/'.     01230000
               10  PV-FORMAT-DATE-DD       PIC  X(02)    VALUE SPACES.  01240000
               10  FILLER                  PIC  X(01)    VALUE '/'.     01250000
               10  PV-FORMAT-DATE-YYYY     PIC  X(04)    VALUE SPACES.  01260000
           05  PV-DC-LOCATION              PIC 9(04)         VALUE 0.   01300000
           05  PV-PCNT-FIELD               PIC 999V99        VALUE 0.   01310000
           05  PV-TOTAL-TLRS               PIC 9(09).                   01311000
           05  PV-TOTAL-POS                PIC 9(09).                   01311100
           05  PV-TOTAL-CTNS               PIC 9(09).                   01312000
           05  PV-TOTAL-UNTS               PIC 9(09).                   01313000
           05  PV-TOTAL-NEW-SKUS           PIC 9(09).                   01314000
                                                                        01320000
       01  PV-GRAND-TOT-TABLE.                                          01330000
           05  PV-GRAND-ITEMS    OCCURS 15 INDEXED BY PV-IDX.           01340000
               10  PV-GRAND-LOC            PIC X.                       01350000
               10  PV-GRAND-PO-CNT         PIC 9(09).                   01360000
               10  PV-GRAND-CTN-CNT        PIC 9(09).                   01370000
               10  PV-GRAND-UNT-CNT        PIC 9(09).                   01380000
               10  PV-GRAND-TLR-CNT        PIC 9(09).                   01381000
               10  PV-GRAND-SKU-CNT        PIC 9(09).                   01382000
                                                                        01390000
       01  WS-WORKING-STOR-FLDS.                                        01400000
           05  WS-SUBTOT-PO               PIC 9(09) COMP    VALUE 0.    01410000
           05  WS-SUBTOT-CTN              PIC 9(09) COMP    VALUE 0.    01420000
           05  WS-SUBTOT-UNT              PIC 9(09) COMP    VALUE 0.    01430000
           05  WS-SUBTOT-TLR              PIC 9(09) COMP    VALUE 0.    01431000
           05  WS-SUBTOT-SKU              PIC 9(09) COMP    VALUE 0.    01432000
           05  WS-HOLD-LOC-IND            PIC X     VALUE SPACES.       01440000
           05  WS-HOLD-PROCESS-GROUP      PIC 9             VALUE 0.    01450000
      ****************************************************              01470000
      * INPUT01 COPYBOOK                                 *              01480000
      ****************************************************              01490000
           COPY PCRD068.                                                01500000
      ****************************************************              01520000
W40796* 150 BYTE REPORT HEADER                           *              01530000
      ****************************************************              01540000
W40796     COPY DPWS150O.                                               01550000
       01  HDR-LINES.                                                   01570000
           05  HDR01-LINE.                                              01580000
W40796         10  FILLER                  PIC  X(57)    VALUE SPACES.  01590000
               10  FILLER                  PIC  X(38)    VALUE          01600000
                   'EFC INBOUND CARTON FORECAST BY TRAILER'.            01610000
W40796         10  FILLER                  PIC  X(47)    VALUE SPACES.  01620000
           05  HDR02-LINE.                                              01630000
               10  FILLER                  PIC  X(17)    VALUE          01640000
                   'EFC............: '.                                 01650000
               10  HDR02-DC                PIC  ZZZZ9.                  01660000
               10  FILLER                  PIC  X(02)    VALUE SPACES.  01670000
               10  HDR02-DC-DESCRIPTION    PIC  X(40)    VALUE SPACES.  01680000
               10  FILLER                  PIC  X(68)    VALUE SPACES.  01690000
           05  HDR03-LINE.                                              01700000
               10  FILLER                  PIC  X(50)    VALUE          01710000
               '----------TRAILER INFORMATION--------- --------PO '.    01720000
               10  FILLER                  PIC  X(50)    VALUE          01730000
W40796         'CNTS----------- ----------------OTHER-------------'.    01740000
W40796         10  FILLER                  PIC  X(50)    VALUE          01750000
W40796         '------------------------------ ---STATUS----      '.    01760000
           05  HDR04-LINE.                                              01780000
               10  FILLER                  PIC  X(50)    VALUE          01790000
               '                                                  '.    01800000
               10  FILLER                  PIC  X(50)    VALUE          01830000
W40796         '                       #            #       #     '.    01840000
W40796         10  FILLER                  PIC  X(50)    VALUE          01841000
W40796         '                               #CTNS              '.    01842000
           05  HDR05-LINE.                                              01860000
               10  FILLER                  PIC  X(50)    VALUE          01870000
               '              ARRIVAL                   #       # '.    01880000
               10  FILLER                  PIC  X(50)    VALUE          01910000
W40796         '        #        DNLD  NEW     #    PROC   CTNS   '.    01920000
W40796         10  FILLER                  PIC  X(50)    VALUE          01930000
W40796         '                               NOT     %          '.    01931000
           05  HDR06-LINE.                                              01940000
               10  FILLER                  PIC  X(50)    VALUE          01950000
               ' EFC   LOC     DATE    SCAC TRAILER #   POS     CT'.    01981000
               10  FILLER                  PIC  X(50)    VALUE          01982000
W40796         'NS      UNITS    CTNS  SKUS   SKUS  CNTS   TRBL   '.    01983000
W40796         10  FILLER                  PIC  X(50)    VALUE          01990000
W40796         ' CAN                           SCND   SCND        '.    02000000
           05  HDR07-LINE.                                              02020000
               10  FILLER                  PIC  X(50)    VALUE          02030000
               '----- ----- ---------- ---- ---------- ------ ----'.    02040000
               10  FILLER                  PIC  X(50)    VALUE          02050000
W40796         '----- --------- ------ ----- ----- ------ ------- '.    02060000
W40796         10  FILLER                  PIC  X(50)    VALUE          02070000
W40796         '------------------------------ ------ ------      '.    02080000
W40796     05  BLANK-LINE                  PIC X(150)    VALUE SPACES.  02100000
                                                                        02110000
           05  UNPROCESSED-FREIGHT-HDR.                                 02120000
               10  UPF-HEADER-EFC          PIC  ZZZZ9.                  02121000
               10  FILLER                  PIC  X(50)    VALUE          02130000
                   ' UNPROCESSED FREIGHT FROM VENDORS                 '.02140000
               10  FILLER                  PIC  X(50)    VALUE SPACES.  02150000
               10  FILLER                  PIC  X(27)    VALUE SPACES.  02160000
           05  PROCESSED-FREIGHT-HDR.                                   02170000
               10  PF-HEADER-EFC           PIC  ZZZZ9.                  02171000
               10  FILLER                  PIC  X(27)    VALUE          02180000
                   ' PROCESSED FREIGHT FROM DC '.                       02190000
               10  PF-HEADER-DC            PIC  ZZZZ9.                  02200000
               10  FILLER                  PIC  X(50)    VALUE SPACES.  02210000
               10  FILLER                  PIC  X(45)    VALUE SPACES.  02220000
           05  UNPROCESSED-FREIGHT-TOTAL-LINE.                          02230000
               10  UPF-TOT-EFC             PIC  ZZZZ9.                  02231000
               10  FILLER                  PIC  X(19)    VALUE SPACES.  02240000
               10  UPF-TITLE               PIC  X(14)    VALUE SPACES.  02250000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02260000
               10  UPF-TOT-POS-TOTAL       PIC  ZZ,ZZ9  BLANK WHEN ZERO.02270000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02280000
               10  UPF-TOT-CTN-TOTAL       PIC  Z,ZZZ,ZZ9               02290000
                                                        BLANK WHEN ZERO.02291000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02300000
               10  UPF-TOT-UNIT-TOTAL      PIC  Z,ZZZ,ZZ9               02310000
                                                        BLANK WHEN ZERO.02311000
               10  FILLER                  PIC  X(66)    VALUE SPACES.  02320000
           05  PCKSLPS-HANGING-TOTAL-LINE.                              02330000
               10  PK-TOT-EFC              PIC  ZZZZ9.                  02331000
               10  FILLER                  PIC  X(34)    VALUE          02340000
                   ' PACKSLIPS HANGING            '.                    02350000
               10  PK-HANGING-POS-TOTAL    PIC  ZZ,ZZ9  BLANK WHEN ZERO.02360000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02370000
               10  PK-HANGING-CTN-TOTAL    PIC  Z,ZZZ,ZZ9               02380000
                                                        BLANK WHEN ZERO.02381000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02390000
               10  PK-HANGING-UNT-TOTAL    PIC  Z,ZZZ,ZZ9               02400000
                                                        BLANK WHEN ZERO.02401000
               10  FILLER                  PIC  X(65)    VALUE SPACES.  02410000
           05  PROCESSED-FREIGHT-TOTAL-LINE.                            02420000
               10  PF-TOT-EFC              PIC  ZZZZ9.                  02421000
               10  FILLER                  PIC  X(10)    VALUE SPACES.  02430000
               10  PF-TITLE                PIC  X(24)    VALUE SPACES.  02440000
               10  PF-TOT-POS-TOTAL        PIC  ZZ,ZZ9 BLANK WHEN ZERO. 02450000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02460000
               10  PF-TOT-CTN-TOTAL        PIC  Z,ZZZ,ZZ9               02470000
                                                        BLANK WHEN ZERO.02471000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02480000
               10  PF-TOT-UNIT-TOTAL       PIC  Z,ZZZ,ZZ9               02490000
                                                        BLANK WHEN ZERO.02491000
               10  FILLER                  PIC  X(65)    VALUE SPACES.  02500000
           05  END-OF-REPORT-LINE.                                      02510000
               10  FILLER                  PIC  X(44)    VALUE SPACES.  02520000
               10  FILLER                  PIC  X(45)    VALUE          02530000
                   '*******   E N D   O F   R E P O R T   *******'.     02540000
               10  FILLER                  PIC  X(43)    VALUE SPACES.  02550000
           05  NO-DATA-TO-REPORT-LINE.                                  02560000
               10  FILLER                  PIC  X(40)    VALUE SPACES.  02570000
               10  FILLER                  PIC  X(52)    VALUE          02580000
               '*******  N O   D A T A   T O   R E P O R T   *******'.  02590000
               10  FILLER                  PIC  X(40)    VALUE SPACES.  02600000
                                                                        02610000
       01  GRAND-TOTAL-LINES.                                           02620000
           05  GT-HEADER-LINE.                                          02630000
               10  GT-HDR-EFC              PIC  ZZZZ9.                  02631000
               10  FILLER                  PIC  X(20)    VALUE          02640000
                   ' GRAND TOTALS       '.                              02650000
               10  FILLER                  PIC  X(107)   VALUE SPACES.  02660000
           05  GT-TOTAL-LINE.                                           02670000
               10  GT-TOT-EFC              PIC  ZZZZ9.                  02671000
               10  FILLER                  PIC  X(03)    VALUE SPACES.  02680000
               10  GT-TITLE                PIC  X(18)    VALUE SPACES.  02681000
               10  GT-TRLR-TOTAL           PIC  Z,ZZZ,ZZ9               02690000
                                                        BLANK WHEN ZERO.02691000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02700000
               10  GT-PO-TOTAL             PIC  Z,ZZZ,ZZ9               02710000
                                                        BLANK WHEN ZERO.02711000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02720000
               10  GT-CTN-TOTAL            PIC  Z,ZZZ,ZZ9               02730000
                                                        BLANK WHEN ZERO.02731000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02740000
               10  GT-UNT-TOTAL            PIC  Z,ZZZ,ZZ9               02750000
                                                        BLANK WHEN ZERO.02751000
               10  FILLER                  PIC  X(04)    VALUE SPACES.  02760000
               10  GT-SKU-TOTAL            PIC  Z,ZZZ,ZZ9               02770000
                                                        BLANK WHEN ZERO.02771000
               10  FILLER                  PIC  X(56)    VALUE SPACES.  02780000
                                                                        02790000
       01  DETAIL-LINES.                                                02800000
           05  DTL01-LINE.                                              02810000
               10  DTL01-EFC               PIC  ZZZZ9 BLANK WHEN ZERO.  02820000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02830000
               10  DTL01-LOC               PIC  X(05)    VALUE SPACES.  02831000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02832000
               10  DTL01-ARRIVAL-DATE      PIC  X(10)    VALUE SPACES.  02840000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02850000
               10  DTL01-SCAC              PIC  X(04)    VALUE SPACES.  02860000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02870000
               10  DTL01-VEHICLE           PIC  X(10)    VALUE SPACES.  02880000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02890000
               10  DTL01-NBR-OF-POS        PIC  ZZ,ZZ9  BLANK WHEN ZERO.02900000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02910000
               10  DTL01-NBR-OF-CTNS       PIC  Z,ZZZ,ZZ9               02920000
                                                        BLANK WHEN ZERO.02921000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02930000
               10  DTL01-NBR-OF-UNITS      PIC  Z,ZZZ,ZZ9               02940000
                                                        BLANK WHEN ZERO.02941000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02950000
               10  DTL01-DNLD-CTNS         PIC  ZZ,ZZ9  BLANK WHEN ZERO.02960000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02970000
               10  DTL01-NEW-SKUS          PIC  Z,ZZ9   BLANK WHEN ZERO.02971000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02972000
W40796         10  DTL01-TTL-SKUS          PIC  Z,ZZ9   BLANK WHEN ZERO.02973000
W40796         10  FILLER                  PIC  X(01)    VALUE SPACES.  02974000
               10  DTL01-NBR-PROC-CNTS     PIC  ZZ,ZZ9  BLANK WHEN ZERO.02980000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  02990000
               10  DTL01-NBR-CTNS-TROUBLE  PIC  ZZZ,ZZ9 BLANK WHEN ZERO.03000000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  03010000
W40796         10  DTL01-CAN               PIC  X(30)    VALUE SPACES.  03011000
W40796         10  FILLER                  PIC  X(01)    VALUE SPACES.  03012000
               10  DTL01-NBR-CTNS-NOT-SCN  PIC ZZ,ZZ9   BLANK WHEN ZERO.03020000
               10  FILLER                  PIC  X(01)    VALUE SPACES.  03030000
               10  DTL01-PCNT-SCANNED      PIC  ZZ9   BLANK WHEN ZERO.  03040000
               10  FILLER                  PIC  X(28)    VALUE SPACES.  03050000
           05  DTL01-LINEA REDEFINES DTL01-LINE.                        03060000
               10  FILLER                  PIC  X(06).                  03070000
               10  DTL01-DESCR             PIC  X(16).                  03071000
               10  FILLER                  PIC  X(110).                 03080000
                                                                        03090000
      ******************************************************            03100000
      *  XLT00010 - DC LOCATION TABLE                      *            03110000
      ******************************************************            03120000
           EXEC SQL                                                     03130000
                INCLUDE XLT00010                                        03140000
           END-EXEC.                                                    03150000
W40796******************************************************            03160000
W40796*  TSHIPMT - TSHIPMT TABLE                           *            03161000
W40796******************************************************            03162000
W40796     EXEC SQL                                                     03163000
W40796          INCLUDE TSHIPMT                                         03164000
W40796     END-EXEC.                                                    03165000
W40796******************************************************            03166000
W40796*  TTRIPST - TTRIPST TABLE (TRIP STATUS)             *            03167000
W40796******************************************************            03168000
W40796     EXEC SQL                                                     03169000
W40796          INCLUDE TTRIPST                                         03169100
W40796     END-EXEC.                                                    03169200
      ******************************************************            03170000
      *  DB2 AREA FOR COMMUNICATIONS                       *            03180000
      ******************************************************            03190000
           EXEC SQL                                                     03200000
                INCLUDE SQLCA                                           03210000
           END-EXEC.                                                    03220000
                                                                        03230000
           COPY SQLCA2.                                                 03240000
                                                                        03250000
       PROCEDURE DIVISION.                                              03260000
                                                                        03270000
           DISPLAY '*** PROGRAM PCKRP033 BEGINS ***'.                   03280000
      ******************************************************            03290000
      * 0000-MAINLINE.                                     *            03300000
      ******************************************************            03310000
       0000-MAINLINE.                                                   03320000
                                                                        03340000
           PERFORM 0010-INITIALIZATION.                                 03350000
                                                                        03360000
           PERFORM 1000-PROCESS-INPUT                                   03370000
              THRU 1000-PROCESS-INPUT-EXIT                              03380000
               UNTIL ( PS-END-OF-INPUT ).                               03390000
                                                                        03400000
           PERFORM 0020-END-PROGRAM.                                    03410000
           DISPLAY '*** PROGRAM PCKRP033 ENDS   ***'.                   03420000
           GOBACK.                                                      03430000
                                                                        03440000
      ******************************************************            03450000
      * 0010-INITIALIZATION.                               *            03460000
      ******************************************************            03470000
       0010-INITIALIZATION.                                             03480000
                                                                        03500000
           OPEN INPUT  INPUT01-FILE                                     03510000
                OUTPUT REPORT-FILE.                                     03520000
                                                                        03530000
           MOVE FUNCTION CURRENT-DATE (1:8) TO PV-TODAYS-DATE.          03540000
           ACCEPT PV-TODAYS-TIME   FROM TIME.                           03550000
                                                                        03560000
W40796     MOVE PV-TODAYS-DATE-MM      TO DP150O-RUN-MONTH.             03570000
W40796     MOVE PV-TODAYS-DATE-DD      TO DP150O-RUN-DAY.               03580000
W40796     MOVE PV-TODAYS-DATE-CCYY    TO DP150O-RUN-YEAR.              03590000
W40796     MOVE PV-TODAYS-TIME-HH      TO DP150O-RUN-HOUR.              03600000
W40796     MOVE PV-TODAYS-TIME-MM      TO DP150O-RUN-MINUTE.            03610000
W40796     MOVE PC-PROGRAM-NAME        TO DP150O-PROGRAM-NAME.          03620000
W40796     MOVE PC-REPORT-NBR          TO DP150O-REPORT-NUMBER.         03630000
                                                                        03640000
           PERFORM 9050-REPORT-HEADERS.                                 03650000
                                                                        03660000
           READ INPUT01-FILE INTO PC068-RECORD-LAYOUT                   03670000
               AT END                                                   03680000
                   MOVE 'Y'                   TO PS-END-OF-INPUT-SW     03690000
                   DISPLAY 'NO INPUT RECORDS FOUND'                     03700000
               NOT AT END                                               03710000
                   MOVE PC068-SORT-BY-LOC-IND TO WS-HOLD-LOC-IND        03730000
                   MOVE PC068-OPER-UNT-ID     TO PV-DC-LOCATION         03740000
                                                 HDR02-DC               03750000
                                                 UPF-HEADER-EFC         03750100
                                                 PF-HEADER-EFC          03750200
                                                 UPF-TOT-EFC            03750300
                                                 PK-TOT-EFC             03750400
                                                 PF-TOT-EFC             03750500
                                                 GT-HDR-EFC             03750600
                                                 GT-TOT-EFC             03750700
                                                 DTL01-EFC              03750800
                   PERFORM 2000-VALIDATE-DC                             03760000
                   PERFORM 9040-PAGE-HEADERS.                           03770000
                                                                        03780000
           MOVE 0                  TO WS-HOLD-PROCESS-GROUP.            03781000
           SET PV-IDX              TO 1.                                03790000
           INITIALIZE PV-GRAND-TOT-TABLE                                03800000
                      DTL01-LINE.                                       03810000
      ******************************************************            03820000
      * 0020-END-PROGRAM.                                  *            03830000
      ******************************************************            03840000
       0020-END-PROGRAM.                                                03850000
                                                                        03860000
      *    IF LAST REC READ WAS UNPROCESSED FREIGHT - PRINT THE TOTAL   03880000
           IF PS-UNPR-NEEDED-YES                                        03890000
               PERFORM 4000-UNPROC-TOTALS                               03900000
           END-IF.                                                      03910000
      *    IF LAST REC READ WAS HANGING PACKSLIP - PRINT THE TOTAL      03920000
           IF PS-HGPK-NEEDED-YES                                        03930000
               PERFORM 4100-HNGPKL-TOTALS                               03940000
           END-IF.                                                      03950000
      *    IF LAST REC READ WAS PROCESSED FREIGHT - PRINT THE TOTAL     03960000
           IF PS-PROC-NEEDED-YES                                        03970000
               PERFORM 4200-PROC-TOTALS                                 03980000
           END-IF.                                                      03990000
           PERFORM 8000-TOTAL-RECORDS.                                  04000000
                                                                        04010000
           IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           04020000
               PERFORM 9050-REPORT-HEADERS                              04030000
           END-IF.                                                      04040000
                                                                        04050000
           IF WS-HOLD-PROCESS-GROUP = 0                                 04060000
               WRITE REPORT-RECORD FROM NO-DATA-TO-REPORT-LINE          04070000
                    AFTER ADVANCING 2 LINES                             04080000
           END-IF.                                                      04090000
                                                                        04100000
           WRITE REPORT-RECORD FROM END-OF-REPORT-LINE                  04110000
                AFTER ADVANCING 3 LINES.                                04120000
                                                                        04130000
           CLOSE INPUT01-FILE                                           04140000
                 REPORT-FILE.                                           04150000
                                                                        04160000
      ******************************************************            04170000
      * 1000-PROCESS-INPUT.                                *            04180000
      ******************************************************            04190000
       1000-PROCESS-INPUT.                                              04200000
                                                                        04220000
      **** THIS PROGRAM SHOULD ONLY PROCESS TRAILER LEVEL RECORD TYPES  04230000
           IF PC068-DETAIL-RECORD                                       04240000
               GO TO 1000-PROCESS-INPUT-EXIT                            04250000
           END-IF.                                                      04260000
                                                                        04270000
      **** AT THE START OF EACH NEW GROUP, PRINT A HEADER LINE          04271000
      **** AND/OR A TOTAL LINE                                          04272000
           IF PC068-PROCESS-GROUP NOT = WS-HOLD-PROCESS-GROUP           04280000
               EVALUATE TRUE                                            04290000
                   WHEN PC068-UNPROCESSED                               04301000
                       WRITE REPORT-RECORD FROM                         04310000
                                    UNPROCESSED-FREIGHT-HDR             04320000
                            AFTER ADVANCING 1 LINES                     04330000
                       ADD  +1     TO PV-LINE-CNT                       04340000
                   WHEN PC068-HANG-PKSLP                                04350000
                       IF PS-UNPR-NEEDED-YES                            04360000
                           PERFORM 4000-UNPROC-TOTALS                   04370000
                       END-IF                                           04380000
                   WHEN PC068-PROCESSED                                 04390000
                       IF PS-UNPR-NEEDED-YES                            04400000
                           PERFORM 4000-UNPROC-TOTALS                   04410000
                       END-IF                                           04420000
                       IF PS-HGPK-NEEDED-YES                            04430000
                           PERFORM 4100-HNGPKL-TOTALS                   04440000
                       END-IF                                           04450000
                       MOVE PC068-CURR-LOC TO PF-HEADER-DC              04451000
                       WRITE REPORT-RECORD FROM                         04460000
                                    PROCESSED-FREIGHT-HDR               04470000
                            AFTER ADVANCING 2 LINES                     04480000
                       ADD  +2     TO PV-LINE-CNT                       04490000
                   WHEN OTHER                                           04500000
                       CONTINUE                                         04510000
               END-EVALUATE                                             04520000
               MOVE PC068-PROCESS-GROUP  TO WS-HOLD-PROCESS-GROUP       04530000
           END-IF.                                                      04540000
                                                                        04550000
           EVALUATE TRUE                                                04561000
               WHEN PC068-UNPROCESSED                                   04571000
                   PERFORM 3000-PRINT-UNPROC                            04580000
               WHEN PC068-HANG-PKSLP                                    04591000
                   PERFORM 3200-COUNT-PKSL-HNG                          04600000
               WHEN PC068-PROCESSED                                     04611000
                   PERFORM 3400-PRINT-PROC                              04620000
           END-EVALUATE.                                                04630000
                                                                        04640000
       1000-PROCESS-INPUT-EXIT.                                         04650000
                                                                        04660000
           MOVE PC068-SORT-BY-LOC-IND  TO WS-HOLD-LOC-IND.              04670000
           READ INPUT01-FILE INTO PC068-RECORD-LAYOUT                   04680000
               AT END MOVE 'Y' TO PS-END-OF-INPUT-SW.                   04690000
                                                                        04700000
           EXIT.                                                        04710000
      ******************************************************            04730000
      * 2000-VALIDATE-DC.                                  *            04740000
      ******************************************************            04750000
       2000-VALIDATE-DC.                                                04760000
                                                                        04780000
           MOVE PV-DC-LOCATION TO XLT00010-LOC-NBR.                     04790000
                                                                        04800000
           EXEC SQL                                                     04810000
               SELECT A.LOC_NM                                          04820000
                 INTO :XLT00010-LOC-NM                                  04830000
                 FROM XLT_LOC A                                         04840000
                WHERE A.LOC_NBR     = :XLT00010-LOC-NBR                 04850000
                 WITH UR                                                04860000
           END-EXEC.                                                    04870000
                                                                        04880000
           EVALUATE TRUE                                                04890000
             WHEN SQLCODE = ZERO                                        04900000
                 MOVE XLT00010-LOC-NM TO HDR02-DC-DESCRIPTION           04910000
             WHEN OTHER                                                 04920000
                 MOVE SPACES          TO HDR02-DC-DESCRIPTION           04930000
           END-EVALUATE.                                                04940000
      ******************************************************            04960000
       3000-PRINT-UNPROC.                                               04970000
                                                                        04990000
           IF PC068-SORT-BY-LOC-IND NOT = WS-HOLD-LOC-IND               05000000
               PERFORM 4000-UNPROC-TOTALS                               05010000
           END-IF.                                                      05020000
                                                                        05030000
           IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           05040000
               PERFORM 9050-REPORT-HEADERS                              05050000
               PERFORM 9040-PAGE-HEADERS                                05060000
           END-IF.                                                      05070000
                                                                        05080000
           EVALUATE TRUE                                                05090000
               WHEN PC068-UNP-DOOR                                      05101000
                  MOVE PC068-TRLR-LOC     TO DTL01-LOC                  05110000
                  MOVE PC068-ARRIVAL-DATE TO DTL01-ARRIVAL-DATE         05120000
               WHEN PC068-UNP-YARD                                      05131000
                  MOVE 'YARD'             TO DTL01-LOC                  05140000
                  MOVE PC068-ARRIVAL-DATE TO DTL01-ARRIVAL-DATE         05150000
               WHEN PC068-UNP-ENRT                                      05161000
                  MOVE 'ENROU'            TO DTL01-LOC                  05170000
                  MOVE 'ENROUTE'          TO DTL01-ARRIVAL-DATE         05180000
               WHEN OTHER                                               05190000
                  CONTINUE                                              05200000
           END-EVALUATE.                                                05210000
                                                                        05220000
           PERFORM 3800-LOAD-AND-PRINT.                                 05230000
           SET PS-UNPR-NEEDED-YES TO TRUE.                              05240000
           PERFORM 3500-ADD-TO-TOTS.                                    05250000
                                                                        05260000
      ******************************************************            05270000
       3200-COUNT-PKSL-HNG.                                             05280000
                                                                        05300000
           PERFORM 3500-ADD-TO-TOTS.                                    05310000
                                                                        05320000
           SET PS-HGPK-NEEDED-YES TO TRUE.                              05330000
                                                                        05330100
      ******************************************************            05350000
       3400-PRINT-PROC.                                                 05360000
                                                                        05400000
           IF PC068-SORT-BY-LOC-IND NOT = WS-HOLD-LOC-IND               05410000
              AND PS-PROC-NEEDED-YES                                    05411000
               PERFORM 4200-PROC-TOTALS                                 05420000
           END-IF.                                                      05430000
                                                                        05440000
           IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           05450000
               PERFORM 9050-REPORT-HEADERS                              05460000
               PERFORM 9040-PAGE-HEADERS                                05470000
           END-IF.                                                      05480000
                                                                        05490000
           EVALUATE TRUE                                                05501000
               WHEN PC068-PRC-ENR-TO-DC                                 05540000
                  MOVE 'ENROUTE TO DC'    TO DTL01-DESCR                05540100
               WHEN PC068-PRC-IN-YARD                                   05540200
                  MOVE 'IN YARD @ DC'     TO DTL01-DESCR                05540300
               WHEN PC068-PRC-IN-DOOR                                   05540400
                  MOVE 'IN DOOR @ DC'     TO DTL01-DESCR                05540500
               WHEN PC068-PRC-DOOR-OPEN                                 05540600
                  MOVE 'DOOR OPEN (DO)'   TO DTL01-DESCR                05540700
               WHEN PC068-PRC-DOOR-CLSD                                 05540800
                  MOVE 'DOOR CLOSED (DC)' TO DTL01-DESCR                05540900
               WHEN PC068-PRC-DC-SHIP                                   05541000
                  MOVE 'DC SHIPPED (DS)'  TO DTL01-DESCR                05550000
               WHEN PC068-PRC-STR-OPEN                                  05560000
                  MOVE 'STORE OPEN (SO)'  TO DTL01-DESCR                05570000
               WHEN OTHER                                               05640000
                  MOVE 'UNKNOWN'          TO DTL01-DESCR                05650000
           END-EVALUATE.                                                05660000
                                                                        05670000
           PERFORM 3800-LOAD-AND-PRINT.                                 05681000
           SET PS-PROC-NEEDED-YES TO TRUE.                              05690000
           PERFORM 3500-ADD-TO-TOTS.                                    05691000
                                                                        05700000
      ******************************************************            05710000
       3500-ADD-TO-TOTS.                                                05720000
                                                                        05740000
           IF PC068-PROCESSED                                           05741000
               ADD PC068-EFC-CTN-CNT-TRLR TO WS-SUBTOT-CTN              05743000
               ADD PC068-EFC-UNT-CNT-TRLR TO WS-SUBTOT-UNT              05744000
               ADD PC068-EFC-PO-CNT-TRLR  TO WS-SUBTOT-PO               05744100
           ELSE                                                         05745000
               ADD PC068-PO-CNT-TRLR      TO WS-SUBTOT-PO               05750000
               ADD PC068-TOT-CTN-CNT      TO WS-SUBTOT-CTN              05760000
               ADD PC068-UNIT-CNT-TRLR    TO WS-SUBTOT-UNT.             05770000
           ADD 1                          TO WS-SUBTOT-TLR.             05771000
           ADD PC068-NEW-SKU-CNT          TO WS-SUBTOT-SKU.             05772000
                                                                        05780000
      ******************************************************            05790000
       3800-LOAD-AND-PRINT.                                             05800000
                                                                        05810000
           MOVE PC068-OPER-UNT-ID        TO DTL01-EFC.                  05810100
           MOVE PC068-SCAC               TO DTL01-SCAC.                 05811100
           MOVE PC068-TRLR-NBR           TO DTL01-VEHICLE.              05811200
           MOVE PC068-NBR-CTNS-DNLD      TO DTL01-DNLD-CTNS.            05811300
           IF PC068-UNPROCESSED                                         05811400
               MOVE PC068-PO-CNT-TRLR    TO DTL01-NBR-OF-POS            05811500
               MOVE PC068-TOT-CTN-CNT    TO DTL01-NBR-OF-CTNS           05811600
               MOVE PC068-UNIT-CNT-TRLR  TO DTL01-NBR-OF-UNITS          05811700
               MOVE PC068-TRBLE-CTN-CNT-TRLR                            05811800
                                         TO DTL01-NBR-CTNS-TROUBLE      05811900
               MOVE PC068-CRTNS-TO-SCAN-TRLR                            05812000
                                         TO DTL01-NBR-CTNS-NOT-SCN      05812100
W40796         MOVE PC068-NEW-SKU-CNT    TO DTL01-NEW-SKUS              05812200
W40796         MOVE PC068-TOT-SKU-CNT    TO DTL01-TTL-SKUS              05812300
W40796         PERFORM 3900-GET-CAN.                                    05812400
           IF PC068-HANG-PKSLP                                          05812500
               MOVE PC068-PO-CNT-TRLR    TO DTL01-NBR-OF-POS            05813000
               MOVE PC068-TOT-CTN-CNT    TO DTL01-NBR-OF-CTNS           05813100
               MOVE PC068-UNIT-CNT-TRLR  TO DTL01-NBR-OF-UNITS.         05813200
           IF PC068-PROCESSED                                           05814000
               MOVE PC068-EFC-NBR        TO DTL01-EFC                   05814100
               MOVE PC068-EFC-CTN-CNT-TRLR TO DTL01-NBR-OF-CTNS         05815000
               MOVE PC068-EFC-UNT-CNT-TRLR TO DTL01-NBR-OF-UNITS        05816000
               MOVE PC068-EFC-PO-CNT-TRLR  TO DTL01-NBR-OF-POS          05816100
W40796         MOVE PC068-REPLEN-CARTON-CNT TO DTL01-NBR-PROC-CNTS      05817000
W40796         PERFORM 3900-GET-CAN.                                    05818000
           IF PC068-CRTNS-TO-SCAN-TRLR > ZERO AND                       05990000
              PC068-TOT-CTN-CNT > ZERO AND PC068-UNPROCESSED            06000000
               COMPUTE PV-PCNT-FIELD =                                  06010000
                    ((PC068-TOT-CTN-CNT - PC068-CRTNS-TO-SCAN-TRLR) /   06020000
                      PC068-TOT-CTN-CNT) * 100                          06030000
               MOVE PV-PCNT-FIELD TO DTL01-PCNT-SCANNED                 06040000
           ELSE                                                         06050000
               IF PC068-TOT-CTN-CNT = ZERO OR PC068-PROCESSED           06060000
                   MOVE ZERO          TO DTL01-PCNT-SCANNED             06070000
               ELSE                                                     06080000
                   MOVE 100           TO DTL01-PCNT-SCANNED             06090000
               END-IF                                                   06100000
           END-IF.                                                      06110000
                                                                        06120000
           WRITE REPORT-RECORD FROM DTL01-LINE                          06140000
                    AFTER ADVANCING 1 LINE.                             06150000
           ADD  +1     TO PV-LINE-CNT.                                  06160000
           INITIALIZE DTL01-LINE.                                       06161000
                                                                        06170000
W40796******************************************************            06171000
W40796* 3900-GET-CAN.                                      *            06172000
W40796******************************************************            06173000
W40796 3900-GET-CAN.                                                    06174000
W40796                                                                  06175000
W40796     EXEC SQL                                                     06176000
W40796         SELECT DISTINCT CARR_AUTH_ID                             06179400
W40796                        ,LAST_UPD_DTE                             06179500
W40796                        ,LAST_UPD_TME                             06179600
W40796           INTO :SHIPMT-CARR-AUTH-ID                              06179700
W40796               ,:SHIPMT-LAST-UPD-DTE                              06179800
W40796               ,:SHIPMT-LAST-UPD-TME                              06179900
W40796           FROM TSHIPMT A                                         06180000
W40796               ,TTRIPST B                                         06180100
W40796          WHERE A.TRIP_ID      = :PC068-TRIP-ID                   06180200
W40796            AND A.PRO_SCAC_ID  = :PC068-SCAC                      06180300
W40796            AND A.CARR_AUTH_ID > ' '                              06180400
W40796            AND B.TRIP_ID      = A.TRIP_ID                        06180500
W40796            AND B.OPER_UNT_ID  = :PC068-OPER-UNT-ID               06180600
W40796          ORDER BY  LAST_UPD_DTE DESC                             06180700
W40796                   ,LAST_UPD_TME DESC                             06180800
W40796          WITH UR                                                 06180900
W40796     END-EXEC.                                                    06181000
W40796     EVALUATE TRUE                                                06181100
W40796       WHEN SQLCODE = ZERO                                        06181200
W40796       WHEN SQLCODE = -811                                        06181300
W40796           MOVE SHIPMT-CARR-AUTH-ID  TO DTL01-CAN                 06181400
W40796       WHEN OTHER                                                 06181500
W40796           MOVE SPACES               TO DTL01-CAN                 06181600
W40796     END-EVALUATE.                                                06181700
      ******************************************************            06182000
       4000-UNPROC-TOTALS.                                              06190000
                                                                        06210000
           IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           06220000
               PERFORM 9050-REPORT-HEADERS                              06230000
               PERFORM 9040-PAGE-HEADERS                                06240000
           END-IF.                                                      06250000
                                                                        06260000
           EVALUATE WS-HOLD-LOC-IND                                     06270000
               WHEN '1'                                                 06280000
                   MOVE '    LOC TOTAL:' TO UPF-TITLE                   06290000
               WHEN '2'                                                 06300000
                   MOVE '   YARD TOTAL:' TO UPF-TITLE                   06310000
               WHEN '3'                                                 06320000
                   MOVE 'ENROUTE TOTAL:' TO UPF-TITLE                   06330000
               WHEN OTHER                                               06340000
                   MOVE 'UNKNOWN       ' TO UPF-TITLE                   06350000
           END-EVALUATE.                                                06360000
                                                                        06370000
           MOVE WS-SUBTOT-PO             TO UPF-TOT-POS-TOTAL.          06380000
           MOVE WS-SUBTOT-CTN            TO UPF-TOT-CTN-TOTAL.          06390000
           MOVE WS-SUBTOT-UNT            TO UPF-TOT-UNIT-TOTAL.         06400000
                                                                        06410000
           WRITE REPORT-RECORD FROM UNPROCESSED-FREIGHT-TOTAL-LINE      06420000
                  AFTER ADVANCING 1 LINE.                               06430000
                                                                        06440000
           ADD  +1     TO PV-LINE-CNT.                                  06450000
                                                                        06460000
           PERFORM 4800-LOAD-GRAND-TOT.                                 06470000
                                                                        06480000
           SET PS-UNPR-NEEDED-NO TO TRUE.                               06490000
                                                                        06500000
      ******************************************************            06510000
       4100-HNGPKL-TOTALS.                                              06520000
                                                                        06540000
           IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           06550000
               PERFORM 9050-REPORT-HEADERS                              06560000
               PERFORM 9040-PAGE-HEADERS                                06570000
           END-IF.                                                      06580000
                                                                        06590000
           MOVE WS-SUBTOT-PO             TO PK-HANGING-POS-TOTAL.       06600000
           MOVE WS-SUBTOT-CTN            TO PK-HANGING-CTN-TOTAL.       06610000
           MOVE WS-SUBTOT-UNT            TO PK-HANGING-UNT-TOTAL.       06620000
                                                                        06621000
           WRITE REPORT-RECORD FROM PCKSLPS-HANGING-TOTAL-LINE          06630000
                  AFTER ADVANCING 2 LINES.                              06640000
           ADD  +2     TO PV-LINE-CNT.                                  06650000
                                                                        06660000
           PERFORM 4800-LOAD-GRAND-TOT.                                 06670000
           SET PS-HGPK-NEEDED-NO TO TRUE.                               06680000
                                                                        06690000
      ******************************************************            06700000
       4200-PROC-TOTALS.                                                06710000
                                                                        06730000
           IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           06740000
               PERFORM 9050-REPORT-HEADERS                              06750000
               PERFORM 9040-PAGE-HEADERS                                06760000
           END-IF.                                                      06770000
                                                                        06780000
           EVALUATE WS-HOLD-LOC-IND                                     06790000
               WHEN 'A'                                                 06800000
                   MOVE '  ENROUTE TO DC  TOTAL:'                       06810000
                                         TO PF-TITLE                    06820000
               WHEN 'B'                                                 06821000
                   MOVE '   IN YARD @ DC  TOTAL:'                       06821100
                                         TO PF-TITLE                    06822000
               WHEN 'C'                                                 06830000
                   MOVE '   IN DOOR @ DC  TOTAL:'                       06831000
                                         TO PF-TITLE                    06850000
               WHEN 'D'                                                 06860000
                   MOVE '  DOOR OPEN (DO) TOTAL:'                       06861000
                                         TO PF-TITLE                    06880000
               WHEN 'E'                                                 06890000
                   MOVE 'DOOR CLOSED (DC) TOTAL:'                       06900000
                                         TO PF-TITLE                    06910000
               WHEN 'F'                                                 06920000
                   MOVE ' DC SHIPPED (DS) TOTAL:'                       06930000
                                         TO PF-TITLE                    06940000
               WHEN 'G'                                                 06950000
                   MOVE ' STORE OPEN (SO) TOTAL:'                       06951000
                                         TO PF-TITLE                    06970000
               WHEN OTHER                                               06980000
                   MOVE 'UNKNOWN       ' TO PF-TITLE                    06990000
           END-EVALUATE.                                                07000000
                                                                        07001000
           MOVE WS-SUBTOT-PO             TO PF-TOT-POS-TOTAL.           07011000
           MOVE WS-SUBTOT-CTN            TO PF-TOT-CTN-TOTAL.           07020000
           MOVE WS-SUBTOT-UNT            TO PF-TOT-UNIT-TOTAL.          07030000
                                                                        07040000
           WRITE REPORT-RECORD FROM PROCESSED-FREIGHT-TOTAL-LINE        07050000
                  AFTER ADVANCING 1 LINE.                               07060000
           ADD  +1     TO PV-LINE-CNT.                                  07080000
                                                                        07090000
           PERFORM 4800-LOAD-GRAND-TOT.                                 07100000
                                                                        07110000
           SET PS-PROC-NEEDED-NO TO TRUE.                               07120000
                                                                        07130000
      ******************************************************            07140000
       4800-LOAD-GRAND-TOT.                                             07150000
                                                                        07170000
           MOVE WS-HOLD-LOC-IND     TO PV-GRAND-LOC     (PV-IDX).       07180000
           MOVE WS-SUBTOT-PO        TO PV-GRAND-PO-CNT  (PV-IDX).       07190000
           MOVE WS-SUBTOT-CTN       TO PV-GRAND-CTN-CNT (PV-IDX).       07200000
           MOVE WS-SUBTOT-UNT       TO PV-GRAND-UNT-CNT (PV-IDX).       07210000
           MOVE WS-SUBTOT-TLR       TO PV-GRAND-TLR-CNT (PV-IDX).       07211000
           MOVE WS-SUBTOT-SKU       TO PV-GRAND-SKU-CNT (PV-IDX).       07212000
           SET PV-IDX UP BY 1.                                          07220000
                                                                        07230000
           MOVE ZERO TO WS-SUBTOT-PO                                    07240000
                        WS-SUBTOT-CTN                                   07250000
                        WS-SUBTOT-TLR                                   07251000
                        WS-SUBTOT-SKU                                   07252000
                        WS-SUBTOT-UNT.                                  07260000
                                                                        07270000
      ******************************************************            07280000
       8000-TOTAL-RECORDS.                                              07290000
                                                                        07310000
           WRITE REPORT-RECORD FROM GT-HEADER-LINE                      07320000
                  AFTER ADVANCING 2 LINE.                               07330000
           ADD  +2     TO PV-LINE-CNT.                                  07340000
                                                                        07350000
           SET PV-IDX TO 1.                                             07360000
           PERFORM 8100-PRINT-TOT                                       07370000
               UNTIL PV-GRAND-LOC (PV-IDX) = ' '.                       07380000
           PERFORM 8200-PRINT-TOTALS.                                   07381000
                                                                        07390000
      ******************************************************            07400000
       8100-PRINT-TOT.                                                  07410000
                                                                        07430000
           IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           07440000
               PERFORM 9050-REPORT-HEADERS                              07450000
               PERFORM 9040-PAGE-HEADERS                                07460000
           END-IF.                                                      07470000
                                                                        07480000
           EVALUATE PV-GRAND-LOC (PV-IDX)                               07490000
               WHEN '1'                                                 07500000
                   MOVE 'IN DOORS @ EFC'     TO GT-TITLE                07510000
               WHEN '2'                                                 07520000
                   MOVE 'IN YARD @ EFC'      TO GT-TITLE                07530000
               WHEN '3'                                                 07540000
                   MOVE 'ENROUTE TO EFC'     TO GT-TITLE                07550000
               WHEN 'X'                                                 07560000
                   MOVE 'PACKSLIPS HANGING'  TO GT-TITLE                07570000
                   MOVE ZERO                 TO PV-GRAND-TLR-CNT(PV-IDX)07571000
               WHEN 'A'                                                 07580000
                   MOVE 'ENROUTE TO DC'      TO GT-TITLE                07590000
               WHEN 'B'                                                 07591000
                   MOVE 'IN YARD @ DC'       TO GT-TITLE                07592000
               WHEN 'C'                                                 07600000
                   MOVE 'IN DOOR @ DC'       TO GT-TITLE                07601000
               WHEN 'D'                                                 07620000
                   MOVE 'DOOR OPEN (DO)'     TO GT-TITLE                07621000
               WHEN 'E'                                                 07640000
                   MOVE 'DOOR CLOSED (DC)'   TO GT-TITLE                07650000
               WHEN 'F'                                                 07660000
                   MOVE 'DC SHIPPED (DS)'    TO GT-TITLE                07661000
               WHEN 'G'                                                 07680000
                   MOVE 'STORE OPEN (SO)'    TO GT-TITLE                07681000
               WHEN OTHER                                               07700000
                   MOVE 'UNKNOWN'            TO GT-TITLE                07710000
           END-EVALUATE.                                                07720000
                                                                        07730000
           MOVE PV-GRAND-PO-CNT  (PV-IDX)  TO GT-PO-TOTAL.              07740000
           MOVE PV-GRAND-CTN-CNT (PV-IDX)  TO GT-CTN-TOTAL.             07750000
           MOVE PV-GRAND-UNT-CNT (PV-IDX)  TO GT-UNT-TOTAL.             07760000
           MOVE PV-GRAND-TLR-CNT (PV-IDX)  TO GT-TRLR-TOTAL.            07761000
           MOVE PV-GRAND-SKU-CNT (PV-IDX)  TO GT-SKU-TOTAL.             07762000
                                                                        07790000
           ADD PV-GRAND-TLR-CNT (PV-IDX)   TO PV-TOTAL-TLRS.            07791000
           ADD PV-GRAND-PO-CNT  (PV-IDX)   TO PV-TOTAL-POS.             07792000
           ADD PV-GRAND-CTN-CNT (PV-IDX)   TO PV-TOTAL-CTNS.            07793000
           ADD PV-GRAND-UNT-CNT (PV-IDX)   TO PV-TOTAL-UNTS.            07794000
           ADD PV-GRAND-SKU-CNT (PV-IDX)   TO PV-TOTAL-NEW-SKUS.        07795000
                                                                        07796000
           WRITE REPORT-RECORD FROM GT-TOTAL-LINE                       07800000
                  AFTER ADVANCING 1 LINE.                               07810000
                                                                        07820000
           ADD  +1     TO PV-LINE-CNT.                                  07830000
           SET PV-IDX UP BY 1.                                          07840000
                                                                        07850000
      ******************************************************            07851000
       8200-PRINT-TOTALS.                                               07852000
                                                                        07853000
           IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           07854000
               PERFORM 9050-REPORT-HEADERS                              07855000
               PERFORM 9040-PAGE-HEADERS                                07856000
           END-IF.                                                      07857000
                                                                        07861700
           MOVE 'TOTALS'             TO GT-TITLE.                       07861800
           MOVE PV-TOTAL-POS         TO GT-PO-TOTAL.                    07861900
           MOVE PV-TOTAL-CTNS        TO GT-CTN-TOTAL.                   07862000
           MOVE PV-TOTAL-UNTS        TO GT-UNT-TOTAL.                   07862100
           MOVE PV-TOTAL-TLRS        TO GT-TRLR-TOTAL.                  07862200
           MOVE PV-TOTAL-NEW-SKUS    TO GT-SKU-TOTAL.                   07862300
                                                                        07862400
           WRITE REPORT-RECORD FROM GT-TOTAL-LINE                       07863100
                  AFTER ADVANCING 1 LINE.                               07863200
                                                                        07863300
           ADD  +1     TO PV-LINE-CNT.                                  07863400
                                                                        07863600
      ******************************************************            07870000
      * 9040-PAGE-HEADERS.                                 *            07880000
      ******************************************************            07890000
       9040-PAGE-HEADERS.                                               07900000
                                                                        07920000
           IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           07930000
               PERFORM 9050-REPORT-HEADERS                              07940000
           END-IF.                                                      07950000
                                                                        07960000
           WRITE REPORT-RECORD FROM HDR02-LINE                          07970000
                  AFTER ADVANCING 2 LINES.                              07980000
           WRITE REPORT-RECORD FROM HDR03-LINE                          07990000
                  AFTER ADVANCING 1 LINE.                               08000000
           WRITE REPORT-RECORD FROM HDR04-LINE                          08010000
                  AFTER ADVANCING 1 LINE.                               08020000
           WRITE REPORT-RECORD FROM HDR05-LINE                          08030000
                  AFTER ADVANCING 1 LINE.                               08040000
           WRITE REPORT-RECORD FROM HDR06-LINE                          08050000
                  AFTER ADVANCING 1 LINES.                              08060000
           WRITE REPORT-RECORD FROM HDR07-LINE                          08070000
                  AFTER ADVANCING 1 LINES.                              08080000
                                                                        08090000
           ADD  +7 TO PV-LINE-CNT.                                      08100000
                                                                        08110000
      ******************************************************            08120000
      * 9050-REPORT-HEADERS.                               *            08130000
      ******************************************************            08140000
       9050-REPORT-HEADERS.                                             08150000
                                                                        08170000
           ADD +1           TO PV-PAGE-CNT.                             08180000
W40796     MOVE PV-PAGE-CNT TO DP150O-PAGE-NUMBER.                      08190000
                                                                        08200000
W40796     WRITE REPORT-RECORD FROM DP150O-STANDRD-HEADER-150-COLS      08210000
                  AFTER ADVANCING PAGE.                                 08220000
           WRITE REPORT-RECORD FROM HDR01-LINE                          08230000
                  AFTER ADVANCING 1 LINE.                               08240000
                                                                        08250000
           MOVE +2 TO PV-LINE-CNT.                                      08260000
                                                                        08270000
