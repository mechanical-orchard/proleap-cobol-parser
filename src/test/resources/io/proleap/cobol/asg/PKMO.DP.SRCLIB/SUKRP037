000100***************************************************************** 00030002
000200 IDENTIFICATION DIVISION.                                         00040002
000300 TITLE 'TRAILER SEAL DISCREPANCY REPORT'                          00050002
000400***************************************************************** 00060002
000500                                                                  00070002
000600 PROGRAM-ID.             SUKRP037.                                00080002
000700 AUTHOR.                 DEANNA BRANTNER.                         00090002
000800 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00100002
000900 DATE-WRITTEN            DECEMBER, 2002.                          00110002
001000 DATE-COMPILED.                                                   00120002
001100***************************************************************** 00130002
001200* THIS PROGRAM CREATES THE 'TRAILER SEAL DISCREPANCY REPORT'      00140002
001300* IN JOB SUK010 USING INPUT CREATED BY PROGRAM SUKUT081.          00150002
001400***************************************************************** 00160002
001500 ENVIRONMENT DIVISION.                                            00170002
001600 CONFIGURATION SECTION.                                           00200002
001700                                                                  00210002
001800 SOURCE-COMPUTER.        IBM-3090.                                00220002
001900 OBJECT-COMPUTER.        IBM-3090.                                00230002
002000                                                                  00240002
002100 INPUT-OUTPUT SECTION.                                            00250002
002200                                                                  00260002
002300 FILE-CONTROL.                                                    00270002
002400*                                                                 00280002
002500     SELECT SU-TRLR-SEAL-INPUT-FILE                               00290002
002600         ASSIGN TO INP01.                                         00300002
002700*                                                                 00301002
002800     SELECT SU-TRLR-SEAL-RPT-FILE                                 00302002
002900         ASSIGN TO RPT01.                                         00303002
003000*                                                                 00310002
003100***************************************************************** 00320002
003200 DATA DIVISION.                                                   00330002
003300 FILE SECTION.                                                    00360002
003400*                                                                 00370002
003500 FD  SU-TRLR-SEAL-INPUT-FILE                                      00380002
003600     RECORDING MODE IS F                                          00390002
003700     BLOCK CONTAINS 0  RECORDS.                                   00400002
003800 01  SU-TRLR-SEAL-INPUT-RECORD       PIC  X(200).                 00410002
003900*                                                                 00411002
004000 FD  SU-TRLR-SEAL-RPT-FILE                                        00412002
004100     RECORDING MODE IS F                                          00413002
004200     BLOCK CONTAINS 0  RECORDS.                                   00414002
004300 01  SU-TRLR-SEAL-RPT-RECORD         PIC  X(132).                 00415002
004400*                                                                 00420002
004500***************************************************************** 00431003
004600 WORKING-STORAGE SECTION.                                         00440002
004700*                                                                 00450002
004800 01  PROGRAM-SWITCHES.                                            00460002
004900     05  PS-FIRST-TIME-SW                PIC X(01) VALUE 'N'.     00470002
005000         88  PS-FIRST-TIME-YES                     VALUE 'Y'.     00480002
005100         88  PS-FIRST-TIME-NO                      VALUE 'N'.     00490002
005200     05  PS-NEW-PAGE-SW              PIC  X(03)    VALUE 'N'.     00530002
005300         88  PS-NEW-PAGE                           VALUE 'Y'.     00540002
005400         88  PS-NOT-NEW-PAGE                       VALUE 'N'.     00550002
005500     05  PS-EOF-SW                   PIC  X(03)    VALUE 'N'.     00551003
005600         88  PS-EOF-YES                            VALUE 'Y'.     00552003
005700         88  PS-EOF-NO                             VALUE 'N'.     00553003
005800*                                                                 00560002
005900 01  PC-CONSTANTS.                                                00570002
006000     05  PC-DASH                     PIC  X(01)    VALUE '-'.     00712020
006100     05  PC-BLANK                    PIC  X(02)    VALUE '  '.    00740002
006200     05  PC-SUKRP037                 PIC  X(08)    VALUE          00770002
006300         'SUKRP037'.                                              00780002
006400     05  PC-BLANK-LINE               PIC  X(132)   VALUE SPACE.   00990002
006500     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       01000002
006600     05  PC-MAX-REPORT-LINES         PIC S9(04)  VALUE +62        01010002
006700                                                  COMP SYNC.      01020002
006800     05  PC-PROGRAM-NAME             PIC  X(08)    VALUE          01030002
006900         'SUKRP037'.                                              01040002
007000*                                                                 01050002
007100 01  PV-VARIABLES.                                                01110002
007200     05  PV-OPER-UNT-ID              PIC  S9(4) COMP  VALUE ZERO. 01111008
007300     05  PV-DB2-FUNCTION             PIC X(30) VALUE SPACE.       01120002
007400     05  PV-PARAGRAPH                PIC X(30) VALUE SPACE.       01130002
007500     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     01140002
007600                                                   COMP-3.        01150002
007700     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01160002
007800                                                   COMP-3.        01170002
007900     05  PV-TOTAL-DISCP-CNT          PIC S9(04)    VALUE ZERO     01171008
008000                                                   COMP-3.        01172008
008100     05  PV-GRAND-TOTAL              PIC S9(04)    VALUE ZERO     01173008
008200                                                   COMP-3.        01174008
008300     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01180002
008400                                                   COMP SYNC.     01190002
008500     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACE.   01200002
008600                                                                  01290002
008700********************                                              01910002
008800     05  PV-TODAYS-DATE              PIC X(10)     VALUE SPACES.  01920027
008900     05  PV-TODAYS-DATE-R REDEFINES PV-TODAYS-DATE.               01930002
009000         10  PV-TODAYS-DATE-YY       PIC  9(04).                  01940027
009100         10  FILLER                  PIC  X(01).                  01980127
009200         10  PV-TODAYS-DATE-MM       PIC  9(02).                  01980227
009300         10  FILLER                  PIC  X(01).                  01980327
009400         10  PV-TODAYS-DATE-DD       PIC  9(02).                  01982025
009500                                                                  01990002
009600     05  PV-TODAYS-TIME              PIC  X(08)    VALUE SPACES.  02000002
009700     05  PV-TODAYS-TIME-R REDEFINES PV-TODAYS-TIME.               02010002
009800         10  PV-TODAYS-TIME-HH       PIC  9(02).                  02020002
009900         10  FILLER                  PIC  X(01).                  02030002
010000         10  PV-TODAYS-TIME-MM       PIC  9(02).                  02040002
010100         10  FILLER                  PIC  X(01).                  02050002
010200         10  PV-TODAYS-TIME-SS       PIC  9(02).                  02060002
010300                                                                  02070002
010400     05  PV-REFORMAT-DATE            PIC X(08)     VALUE SPACES.  02080048
010500     05  PV-REFORMAT-DATE-R REDEFINES PV-REFORMAT-DATE.           02090047
010600         10  PV-RFRMT-DATE-MM        PIC  9(02).                  02100049
010700         10  PV-RFRMT-DASH-1         PIC  X(01).                  02110047
010800         10  PV-RFRMT-DATE-DD        PIC  9(02).                  02120049
010900         10  PV-RFRMT-DASH-2         PIC  X(01).                  02130047
011000         10  PV-RFRMT-DATE-YY        PIC  9(02).                  02140047
011100                                                                  02150047
011200     05  PV-REFORMAT-TIME            PIC  X(05)    VALUE SPACES.  02160048
011300     05  PV-REFORMAT-TIME-R REDEFINES PV-REFORMAT-TIME.           02170047
011400         10  PV-RFRMT-TIME-HH        PIC  9(02).                  02180047
011500         10  PV-RFRMT-TIME-1         PIC  X(01).                  02190047
011600         10  PV-RFRMT-TIME-MM        PIC  9(02).                  02200047
011700                                                                  02230047
011800  01  SAVE-FIELDS.                                                02310002
011900     05  SAVE-OPER-UNT-ID            PIC  S9(4) COMP  VALUE ZERO. 02320028
012000     05  SAVE-DEST-NBR               PIC  S9(4) COMP  VALUE ZERO. 02321040
012100     05  SAVE-TRLR-SRL-NBR           PIC  S9(9) COMP  VALUE ZERO. 02330034
012200*                                                                 02410002
012300******************************************************************02420002
012400* COPY BOOK FOR INPUT FILE                                        02430002
012500******************************************************************02440002
012600     COPY SURD042.                                                02450002
012700                                                                  02460002
012800*  LOGISTICS DOMAIN LOCATION MODULE                               02461054
012900*                                                                 02462054
013000     COPY XLWS071.                                                02463054
013100******************************************************************02471002
013200*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02480002
013300******************************************************************02490002
013400     COPY DPWS132.                                                02500002
013500*                                                                 02510002
013600*                                                                 02520002
013700 01  HEADING-LINES.                                               02530002
013800     05  HEADING-LINE-1.                                          02540003
013900         10  FILLER                  PIC  X(51)    VALUE SPACE.   02550002
014000         10  FILLER                  PIC  X(31)    VALUE          02560002
014100             'TRAILER SEAL DISCREPANCY REPORT'.                   02570002
014200         10  FILLER                  PIC  X(50)    VALUE SPACE.   02580002
014300                                                                  02590002
014400     05  HEADING-LINE-2.                                          02600003
014500         10  FILLER                  PIC  X(03)    VALUE SPACE.   02670002
014600         10  FILLER                  PIC  X(11)    VALUE          02680002
014700             'OPER UNIT: '.                                       02690002
014800         10  HL2-OPER-UNIT           PIC  X(04)    VALUE SPACE.   02700002
014900         10  FILLER                  PIC  X(03)    VALUE ' - '.   02710002
015000         10  HL2-OPER-UNIT-DESC      PIC  X(25)    VALUE SPACE.   02720002
015100         10  FILLER                  PIC  X(86)    VALUE SPACE.   02730002
015200                                                                  02740002
015300     05  HEADING-LINE-3.                                          02750002
015400         10  FILLER                  PIC  X(15)    VALUE          02770002
015500             '--DESTINATION--'.                                   02780002
015600         10  FILLER                  PIC  X(15)    VALUE SPACE.   02781049
015700         10  FILLER                  PIC  X(44)    VALUE          02782047
015800             '---------------- C L O S E D ---------------'.      02783047
015900         10  FILLER                  PIC  X(02)    VALUE SPACE.   02784047
016000         10  FILLER                  PIC  X(55)    VALUE          02785047
016100        '---------------------- O P E N ------------------------'.02786048
016200         10  FILLER                  PIC  X(01)    VALUE SPACE.   02790002
016300                                                                  03130002
016400     05  HEADING-LINE-4.                                          03140002
016500         10  FILLER                  PIC  X(01)    VALUE SPACE.   03150053
016600         10  FILLER                  PIC  X(03)    VALUE          03160002
016700             'NBR'.                                               03170002
016800         10  FILLER                  PIC  X(01)    VALUE SPACE.   03180047
016900         10  FILLER                  PIC  X(04)    VALUE          03190002
017000             'NAME'.                                              03200002
017100         10  FILLER                  PIC  X(02)    VALUE SPACE.   03210047
017200         10  FILLER                  PIC  X(04)    VALUE          03220002
017300             'SCAC'.                                              03230002
017400         10  FILLER                  PIC  X(01)    VALUE SPACE.   03240002
017500         10  FILLER                  PIC  X(10)    VALUE          03250002
017600             'TRAILER ID'.                                        03260002
017700         10  FILLER                  PIC  X(10)    VALUE SPACE.   03270047
017800         10  FILLER                  PIC  X(07)    VALUE          03280002
017900             'SEAL ID'.                                           03290002
018000         10  FILLER                  PIC  X(08)    VALUE SPACE.   03300047
018100         10  FILLER                  PIC  X(07)    VALUE          03310002
018200             'USER ID'.                                           03320002
018300         10  FILLER                  PIC  X(04)    VALUE SPACE.   03330047
018400         10  FILLER                  PIC  X(04)    VALUE          03340002
018500             'DATE'.                                              03350002
018600         10  FILLER                  PIC  X(03)    VALUE SPACE.   03351047
018700         10  FILLER                  PIC  X(04)    VALUE          03352047
018800             'TIME'.                                              03353047
018900         10  FILLER                  PIC  X(04)    VALUE SPACE.   03360047
019000         10  FILLER                  PIC  X(08)    VALUE          03370002
019100             'FUNCTION'.                                          03380002
019200         10  FILLER                  PIC  X(08)    VALUE SPACE.   03390047
019300         10  FILLER                  PIC  X(07)    VALUE          03400002
019400             'SEAL ID'.                                           03410002
019500         10  FILLER                  PIC  X(08)    VALUE SPACE.   03420047
019600         10  FILLER                  PIC  X(07)    VALUE          03430002
019700             'USER ID'.                                           03440002
019800         10  FILLER                  PIC  X(04)    VALUE SPACE.   03450047
019900         10  FILLER                  PIC  X(04)    VALUE          03460002
020000             'DATE'.                                              03460147
020100         10  FILLER                  PIC  X(03)    VALUE SPACE.   03461047
020200         10  FILLER                  PIC  X(04)    VALUE          03462047
020300             'TIME'.                                              03470047
020400         10  FILLER                  PIC  X(01)    VALUE SPACE.   03480047
020500*                                                                 03490002
020600 01  MISCELLANEOUS-LINES.                                         03500002
020700     05  END-OF-REPORT-LINE.                                      03510002
020800         10  FILLER                  PIC  X(55)    VALUE SPACE.   03520028
020900         10  FILLER                  PIC  X(19)    VALUE          03530002
021000             '** END OF REPORT **'.                               03540002
021100         10  FILLER                  PIC  X(058)   VALUE SPACE.   03550028
021200*                                                                 03560002
021300 01  ER-EMPTY-REPORT-LINE.                                        03570002
021400     05  FILLER                      PIC  X(55)  VALUE SPACE.     03580028
021500     05  FILLER                      PIC  X(19)  VALUE            03590002
021600         '**   NO DATA     **'.                                   03600002
021700     05  FILLER                      PIC  X(058) VALUE SPACE.     03610028
021800*                                                                 03620002
021900 01  DETAIL-LINES.                                                03630002
022000     05  DETAIL-LINE1.                                            03640002
022100         10  DL1-DEST-NBR            PIC  Z(04)    VALUE SPACE.   03660002
022200         10  FILLER                  PIC  X(01)    VALUE SPACE.   03750002
022300         10  DL1-DEST-NAME           PIC  X(05)    VALUE SPACE.   03760047
022400         10  FILLER                  PIC  X(01)    VALUE SPACE.   03820002
022500         10  DL1-SCAC                PIC  X(04)    VALUE ZEROES.  03830002
022600         10  FILLER                  PIC  X(01)    VALUE SPACE.   03840002
022700         10  DL1-TRLR-ID             PIC  X(12)    VALUE SPACE.   03850002
022800         10  FILLER                  PIC  X(02)    VALUE SPACE.   03860014
022900         10  DL1-CLOSED-TRLR-SEAL    PIC  X(20)    VALUE SPACE.   03870002
023000         10  FILLER                  PIC  X(01)    VALUE SPACE.   03880002
023100         10  DL1-CLOSED-USER-ID      PIC  X(08)    VALUE SPACE.   03890002
023200         10  FILLER                  PIC  X(01)    VALUE SPACE.   03900047
023300         10  DL1-CLOSED-DATE         PIC  X(08)    VALUE SPACE.   03910049
023400         10  FILLER                  PIC  X(01)    VALUE SPACE.   03920047
023500         10  DL1-CLOSED-TIME         PIC  X(05)    VALUE SPACE.   03930047
023600         10  FILLER                  PIC  X(02)    VALUE SPACE.   03950047
023700         10  DL1-OPEN-FUNCTION       PIC  X(10)    VALUE ZEROES.  03960002
023800         10  FILLER                  PIC  X(01)    VALUE SPACE.   03970002
023900         10  DL1-OPEN-TRLR-SEAL      PIC  X(20)    VALUE ZEROES.  03980002
024000         10  FILLER                  PIC  X(01)    VALUE SPACE.   03990002
024100         10  DL1-OPEN-USER-ID        PIC  X(08)    VALUE SPACE.   04000002
024200         10  FILLER                  PIC  X(01)    VALUE SPACE.   04010002
024300         10  DL1-OPEN-DATE           PIC  X(08)    VALUE SPACE.   04020049
024400         10  FILLER                  PIC  X(01)    VALUE SPACE.   04030047
024500         10  DL1-OPEN-TIME           PIC  X(05)    VALUE SPACE.   04040049
024600         10  FILLER                  PIC  X(01)    VALUE SPACE.   04060002
024700*                                                                 04100002
024800 01  TOTAL-LINES.                                                 04120002
024900     05  TOTAL-LINE1.                                             04130002
025000         10  FILLER                  PIC  X(03)    VALUE SPACE.   04140002
025100         10  FILLER                  PIC  X(22)    VALUE          04150002
025200                          'TOTAL DISCREPANCIES:  '.               04160002
025300         10  TL1-DC-DISCREP          PIC  ZZZ,ZZZ  VALUE ZEROES.  04170002
025400         10  FILLER                  PIC  X(95)    VALUE SPACES.  04180002
025500*                                                                 04190002
025600     05  TOTAL-LINE2.                                             04200002
025700         10  FILLER                  PIC  X(03)    VALUE SPACE.   04210002
025800         10  FILLER                  PIC  X(14)    VALUE          04220002
025900                          'GRAND TOTAL: '.                        04230002
026000         10  TL2-GRAND-TOTAL         PIC  ZZZ,ZZZ  VALUE ZEROES.  04240002
026100         10  FILLER                  PIC  X(102)   VALUE SPACES.  04250002
026200                                                                  04710002
026300     EXEC SQL                                                     04712006
026400          INCLUDE TKRPRPM                                         04713006
026500     END-EXEC.                                                    04714006
026600                                                                  04715006
026700*  DB2 COMMUNICATION AREA                                         04720002
026800     EXEC SQL                                                     04730002
026900         INCLUDE SQLCA                                            04740002
027000     END-EXEC.                                                    04750002
027100                                                                  04760002
027200*  DB2 COMMUNICATION AREA2                                        04770002
027300     COPY SQLCA2.                                                 04780002
027400                                                                  04790002
027500*---------------------------------------------------------------  06090002
027600*                                                                 06091003
027700 PROCEDURE DIVISION.                                              06100002
027800*---------------------------------------------------------------  06110002
027900*THIS IS THE MAIN DRIVER FOR THE PROGRAM.                         06120002
028000*---------------------------------------------------------------  06121002
028100 0000-MAINLINE-PROCESSING.                                        06130002
028200                                                                  06150002
028300     DISPLAY '***** STARTING SUKRP037 *****'                      06151005
028400                                                                  06152005
028500     PERFORM 1000-INITIALIZATION.                                 06160002
028600                                                                  06170002
028700     IF PS-EOF-YES AND                                            06180004
028800        PS-FIRST-TIME-YES                                         06190002
028900          WRITE SU-TRLR-SEAL-RPT-RECORD                           06191051
029000             FROM PC-BLANK-LINE                                   06192051
029100                AFTER ADVANCING 1 LINE                            06193051
029200         WRITE SU-TRLR-SEAL-RPT-RECORD                            06200004
029300           FROM  ER-EMPTY-REPORT-LINE                             06210051
029400              AFTER ADVANCING 1 LINE                              06220051
029500     ELSE                                                         06230002
029600         PERFORM 2000-PROCESS-SU                                  06300002
029700             UNTIL PS-EOF-YES                                     06310004
029800     END-IF.                                                      06320002
029900                                                                  06330002
030000     PERFORM 8500-WRITE-DC-TOTALS.                                06331031
030100     PERFORM 8600-PRINT-GRAND-TOTAL.                              06340028
030200                                                                  06350028
030300     WRITE SU-TRLR-SEAL-RPT-RECORD                                06351051
030400        FROM PC-BLANK-LINE                                        06352051
030500           AFTER ADVANCING 1 LINE.                                06353051
030600     WRITE SU-TRLR-SEAL-RPT-RECORD                                06360004
030700       FROM END-OF-REPORT-LINE                                    06370051
030800         AFTER ADVANCING 1 LINE.                                  06380051
030900                                                                  06390002
031000     CLOSE SU-TRLR-SEAL-INPUT-FILE                                06400005
031100           SU-TRLR-SEAL-RPT-FILE.                                 06401005
031200                                                                  06410002
031300     DISPLAY '***** END OF SUKRP037 *****'                        06411047
031400                                                                  06412047
031500     GOBACK.                                                      06420002
031600*                                                                 06430002
031700*---------------------------------------------------------------  06440002
031800* PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.                 06450002
031900*---------------------------------------------------------------  06451002
032000 1000-INITIALIZATION.                                             06460002
032100                                                                  06480002
032200     OPEN  INPUT SU-TRLR-SEAL-INPUT-FILE                          06480102
032300          OUTPUT SU-TRLR-SEAL-RPT-FILE.                           06480202
032400                                                                  06480302
032500     PERFORM 3000-SELECT-DATE.                                    06481010
032600                                                                  06482002
032700     MOVE PC-REPORT-NBR      TO DP132-REPORT-NUMBER.              06490002
032800     MOVE PC-SUKRP037        TO DP132-PROGRAM-NAME.               06560002
032900                                                                  06570002
033000     SET PS-FIRST-TIME-YES TO TRUE.                               06600009
033100     PERFORM 7000-READ-INPUT-RECORD.                              06601009
033200                                                                  06610002
033300     IF PS-EOF-NO                                                 06620003
033400        MOVE SU042-OPER-UNIT    TO SAVE-OPER-UNT-ID               06650028
033500        MOVE SU042-DEST-NBR     TO SAVE-DEST-NBR                  06651041
033600        MOVE SU042-TRLR-SRL-NBR TO SAVE-TRLR-SRL-NBR              06660028
033700        MOVE +0               TO PV-PAGE-CNT                      06670002
033800        PERFORM 1200-SELECT-FCLTY-NAME                            06680002
033900        PERFORM 1300-SELECT-STORE-NAME                            06690002
034000     END-IF.                                                      06820002
034100                                                                  06830002
034200     PERFORM 8000-WRITE-REPORT-HEADERS.                           06840002
034300*                                                                 06850002
034400*---------------------------------------------------------------  06861002
034500*SELECT THE FACILITY NAME TO DISPLAY IN THE HEADING OF THE        06862002
034600*REPORT.                                                          06863002
034700*---------------------------------------------------------------  06864002
034800 1200-SELECT-FCLTY-NAME.                                          06870002
034900                                                                  02464054
035000     INITIALIZE XL071-COMMAREA-REC.                               02465054
035100     MOVE SU042-OPER-UNIT       TO HL2-OPER-UNIT                  06880008
035200                                   XL071-LOCATION-NUMBER          02466054
035300                                                                  02467054
035400     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         02468054
035500                                                                  02469054
035600     EVALUATE TRUE                                                02469154
035700     WHEN XL071-NO-ERRORS                                         02469254
035800         MOVE XL071-LOC-NM          TO HL2-OPER-UNIT-DESC         02469354
035900     WHEN XL071-LOC-NOT-FOUND                                     02469454
036000     WHEN XL071-DC-ASGMT-NOT-FND                                  02469554
036100         MOVE 'UNKNOWN FACILTY'     TO HL2-OPER-UNIT-DESC         02469654
036200     WHEN XL071-BAD-DB2-RETURN                                    02469754
036300         DISPLAY '1200-SELECT-FCLTY-NAME'                         02469854
036400         DISPLAY 'CALL LOCATION MOD '                             02469954
036500         DISPLAY 'XLT00010'                                       02470054
036600         MOVE XL071-SQLCA             TO SQLCA                    02470154
036700         PERFORM 9200-SQL-ERROR                                   02470254
036800     END-EVALUATE.                                                02470354
036900*                                                                 07430002
037000*---------------------------------------------------------------  07431002
037100*SELECT THE STORE NAME TO DISPLAY IN THE HEADING OF THE           07432002
037200*REPORT.                                                          07433002
037300*---------------------------------------------------------------  07434002
037400 1300-SELECT-STORE-NAME.                                          07435002
037500                                                                  02464054
037600     INITIALIZE XL071-COMMAREA-REC.                               02465054
037700     MOVE SU042-DEST-NBR        TO DL1-DEST-NBR                   07436003
037800                                   XL071-LOCATION-NUMBER          02466054
037900                                                                  02467054
038000     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         02468054
038100                                                                  02469054
038200     EVALUATE TRUE                                                02469154
038300     WHEN XL071-NO-ERRORS                                         02469254
038400         MOVE XL071-LOC-5-ABBR-NM   TO DL1-DEST-NAME              02469354
038500     WHEN XL071-LOC-NOT-FOUND                                     02469454
038600     WHEN XL071-DC-ASGMT-NOT-FND                                  02469554
038700         MOVE 'UNKWN'               TO DL1-DEST-NAME              07440047
038800     WHEN XL071-BAD-DB2-RETURN                                    02469754
038900         DISPLAY '1300-SELECT-STORE-NAME'                         02469854
039000         DISPLAY 'CALL LOCATION MOD '                             02469954
039100         DISPLAY 'XLT00010'                                       02470054
039200         MOVE XL071-SQLCA             TO SQLCA                    02470154
039300         PERFORM 9200-SQL-ERROR                                   02470254
039400     END-EVALUATE.                                                02470354
039500/                                                                 07430002
039600*---------------------------------------------------------------  07440703
039700*THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE        07670002
039800*  TRAILER SEAL DISCREPANCY REPORT.                               07680003
039900*---------------------------------------------------------------  07681003
040000 2000-PROCESS-SU.                                                 07690002
040100                                                                  07700005
040200     IF SU042-OPER-UNIT  =  SAVE-OPER-UNT-ID                      07710030
040300         IF SU042-DEST-NBR   =  SAVE-DEST-NBR                     07711040
040400             PERFORM 8400-WRITE-DETAIL-LINES                      07720040
040500             ADD  1  TO  PV-TOTAL-DISCP-CNT                       07721040
040600             ADD  1  TO  PV-GRAND-TOTAL                           07722040
040700             PERFORM 7000-READ-INPUT-RECORD                       07730040
040800         ELSE                                                     07760040
040900              WRITE SU-TRLR-SEAL-RPT-RECORD                       07760144
041000                 FROM PC-BLANK-LINE                               07760244
041100                    AFTER ADVANCING 1 LINES                       07760344
041200             ADD +1                  TO PV-LINE-CNT               07760446
041300             MOVE SU042-DEST-NBR     TO SAVE-DEST-NBR             07760542
041400             MOVE SU042-TRLR-SRL-NBR TO SAVE-TRLR-SRL-NBR         07760642
041500             SET PS-FIRST-TIME-YES   TO TRUE                      07760742
041600             PERFORM 1300-SELECT-STORE-NAME                       07760840
041700             PERFORM 8400-WRITE-DETAIL-LINES                      07760940
041800             ADD  1  TO  PV-TOTAL-DISCP-CNT                       07761040
041900             ADD  1  TO  PV-GRAND-TOTAL                           07761140
042000             PERFORM 7000-READ-INPUT-RECORD                       07761240
042100         END-IF                                                   07761340
042200     ELSE                                                         07761440
042300         PERFORM 8500-WRITE-DC-TOTALS                             07761528
042400         MOVE SU042-OPER-UNIT    TO SAVE-OPER-UNT-ID              07762028
042500         MOVE SU042-DEST-NBR     TO SAVE-DEST-NBR                 07762140
042600         MOVE SU042-TRLR-SRL-NBR TO SAVE-TRLR-SRL-NBR             07762240
042700         SET PS-FIRST-TIME-YES   TO TRUE                          07762340
042800         MOVE +0                 TO PV-PAGE-CNT                   07763028
042900         MOVE +0                 TO PV-TOTAL-DISCP-CNT            07763131
043000         PERFORM 1200-SELECT-FCLTY-NAME                           07764028
043100         PERFORM 1300-SELECT-STORE-NAME                           07765028
043200         PERFORM 8000-WRITE-REPORT-HEADERS                        07769028
043300         PERFORM 8400-WRITE-DETAIL-LINES                          07770028
043400         ADD  1  TO  PV-TOTAL-DISCP-CNT                           07770128
043500         ADD  1  TO  PV-GRAND-TOTAL                               07770228
043600         PERFORM 7000-READ-INPUT-RECORD                           07771028
043700     END-IF.                                                      07780029
043800                                                                  07790005
043900*                                                                 08300002
044000*-----------------------------------------------------------------08310004
044100 3000-SELECT-DATE.                                                08331010
044200*-----------------------------------------------------------------08332004
044300     INITIALIZE DCLTKRPRPM.                                       08333027
044400                                                                  08334027
044500     EXEC SQL                                                     08338027
044600       SELECT  DISTINCT (CURRENT_DATE)                            08339027
044700              ,CURRENT_TIME                                       08339227
044800         INTO  :PV-TODAYS-DATE                                    08339327
044900              ,:PV-TODAYS-TIME                                    08339527
045000         FROM TKRPRPM                                             08339627
045100     END-EXEC.                                                    08339927
045200                                                                  08340027
045300     EVALUATE TRUE                                                08341027
045400       WHEN SQLCODE = ZEROS                                       08342027
045500       WHEN SQLCODE = +100                                        08344027
045600         CONTINUE                                                 08345027
045700       WHEN OTHER                                                 08346027
045800         MOVE '3000-SELECT-TKRPRPM'  TO PV-ABEND-PARAGRAPH        08346127
045900         DISPLAY PV-ABEND-PARAGRAPH                               08347027
046000         PERFORM 9200-SQL-ERROR                                   08348027
046100     END-EVALUATE.                                                08349027
046200*                                                                 08349127
046300     MOVE PV-TODAYS-DATE-MM  TO DP132-RUN-MONTH.                  08510010
046400     MOVE PV-TODAYS-DATE-DD  TO DP132-RUN-DAY.                    08520010
046500     MOVE PV-TODAYS-DATE-YY  TO DP132-RUN-YEAR.                   08530010
046600                                                                  08540010
046700     MOVE PV-TODAYS-TIME-HH  TO DP132-RUN-HOUR.                   08550010
046800     MOVE PV-TODAYS-TIME-MM  TO DP132-RUN-MINUTE.                 08560010
046900                                                                  08600017
047000                                                                  08603017
047100*-----------------------------------------------------------------08610005
047200 7000-READ-INPUT-RECORD.                                          08620004
047300     READ SU-TRLR-SEAL-INPUT-FILE                                 08630005
047400         INTO SU042-EXTRACT-RECORD                                08640005
047500            AT END                                                08650005
047600       SET PS-EOF-YES TO TRUE.                                    08660005
047700                                                                  08670005
047800*-----------------------------------------------------------      09850004
047900*PRINT THE HEADING FOR THE REPORT.                                09860002
048000*-----------------------------------------------------------      09861005
048100 8000-WRITE-REPORT-HEADERS.                                       09870002
048200     PERFORM 8200-WRITE-TOP-LINE.                                 09880002
048300                                                                  09890002
048400     WRITE SU-TRLR-SEAL-RPT-RECORD                                09891051
048500        FROM PC-BLANK-LINE                                        09892051
048600           AFTER ADVANCING 1 LINE.                                09893051
048700                                                                  09894051
048800     WRITE SU-TRLR-SEAL-RPT-RECORD                                09900003
048900       FROM HEADING-LINE-1                                        09910003
049000         AFTER ADVANCING 1 LINE.                                  09920051
049100                                                                  09930002
049200     WRITE SU-TRLR-SEAL-RPT-RECORD                                09940003
049300       FROM HEADING-LINE-2                                        09950003
049400         AFTER ADVANCING 1 LINE.                                  09960002
049500                                                                  09970002
049600     WRITE SU-TRLR-SEAL-RPT-RECORD                                09971051
049700        FROM PC-BLANK-LINE                                        09972051
049800           AFTER ADVANCING 1 LINE.                                09973051
049900                                                                  09974051
050000     WRITE SU-TRLR-SEAL-RPT-RECORD                                09980008
050100       FROM HEADING-LINE-3                                        09990003
050200         AFTER ADVANCING 1 LINE.                                  10000051
050300                                                                  10010002
050400     WRITE SU-TRLR-SEAL-RPT-RECORD                                10020003
050500       FROM HEADING-LINE-4                                        10030003
050600         AFTER ADVANCING 1 LINE.                                  10040051
050700                                                                  10050002
050800     WRITE SU-TRLR-SEAL-RPT-RECORD                                10060038
050900          FROM PC-BLANK-LINE                                      10070038
051000            AFTER ADVANCING 1 LINE.                               10080051
051100                                                                  10090038
051200     MOVE 09                   TO PV-LINE-CNT.                    10100038
051300*                                                                 10110002
051400*--------------------------------------------------------------   10120005
051500*WRITES HEADER LINES 1 AND 2 WHEN MORE THAN ONE PAGE IS           10130003
051600*NEEDED FOR A DC.                                                 10140002
051700*--------------------------------------------------------------   10141005
051800 8200-WRITE-TOP-LINE.                                             10150002
051900     ADD 1                        TO PV-PAGE-CNT.                 10160002
052000                                                                  10170002
052100     MOVE PV-PAGE-CNT             TO DP132-PAGE-NUMBER.           10180002
052200                                                                  10190002
052300     WRITE SU-TRLR-SEAL-RPT-RECORD                                10200003
052400       FROM DP132-STANDRD-HEADER-132-COLS                         10210002
052500         AFTER ADVANCING PAGE.                                    10220002
052600*                                                                 10230002
052700*-----------------------------------------------------------------10240005
052800*WRITES THE DETAIL LINE INFORMATION.                              10250002
052900*-----------------------------------------------------------------10251005
053000 8400-WRITE-DETAIL-LINES.                                         10260002
053100     IF  PV-LINE-CNT > PC-MAX-REPORT-LINES                        10270028
053200          WRITE SU-TRLR-SEAL-RPT-RECORD                           10280028
053300               FROM PC-BLANK-LINE                                 10290028
053400                 AFTER ADVANCING 1 LINES                          10300028
053500          PERFORM 8000-WRITE-REPORT-HEADERS                       10310028
053600     END-IF.                                                      10320028
053700                                                                  11110002
053800     IF SU042-TRLR-SRL-NBR  =  SAVE-TRLR-SRL-NBR                  11111139
053900         IF PS-FIRST-TIME-YES                                     11111239
054000             MOVE SU042-DEST-NBR   TO  DL1-DEST-NBR               11111339
054100             MOVE SU042-SCAC       TO  DL1-SCAC                   11111439
054200             MOVE SU042-TRLR-ID    TO  DL1-TRLR-ID                11111539
054300             SET PS-FIRST-TIME-NO  TO  TRUE                       11111639
054400         ELSE                                                     11111739
054500             MOVE ZEROES           TO  DL1-DEST-NBR               11111839
054600             MOVE SPACES           TO  DL1-SCAC                   11111939
054700                                       DL1-TRLR-ID                11112039
054800                                       DL1-DEST-NAME              11112139
054900         END-IF                                                   11112239
055000     ELSE                                                         11112339
055100          WRITE SU-TRLR-SEAL-RPT-RECORD                           11112443
055200               FROM PC-BLANK-LINE                                 11112543
055300                 AFTER ADVANCING 1 LINES                          11112643
055400         ADD +1                TO PV-LINE-CNT                     11112746
055500         MOVE SU042-DEST-NBR   TO  DL1-DEST-NBR                   11112839
055600         MOVE XL071-LOC-5-ABBR-NM TO DL1-DEST-NAME                11112950
055700         MOVE SU042-SCAC       TO  DL1-SCAC                       11113039
055800         MOVE SU042-TRLR-ID    TO  DL1-TRLR-ID                    11114039
055900     END-IF.                                                      11118135
056000     MOVE SU042-CLOSE-SEAL-ID  TO  DL1-CLOSED-TRLR-SEAL           11119005
056100     MOVE SU042-CLOSE-USER-ID  TO  DL1-CLOSED-USER-ID             11119205
056200     MOVE SU042-CLOSE-TMST     TO  DL1-CLOSED-DATE                11119405
056300     MOVE SU042-OPEN-FUNCTION  TO  DL1-OPEN-FUNCTION              11119605
056400     MOVE SU042-OPEN-SEAL-ID   TO  DL1-OPEN-TRLR-SEAL             11119805
056500     MOVE SU042-OPEN-USER-ID   TO  DL1-OPEN-USER-ID               11120005
056600     MOVE SU042-OPEN-TMST      TO  DL1-OPEN-DATE                  11120205
056700                                                                  11120305
056800     MOVE SU042-CLOSE-TMST (3:2)  TO  PV-RFRMT-DATE-YY.           11120447
056900     MOVE SU042-CLOSE-TMST (6:2)  TO  PV-RFRMT-DATE-MM.           11120549
057000     MOVE SU042-CLOSE-TMST (9:2)  TO  PV-RFRMT-DATE-DD.           11120649
057100     MOVE PC-DASH                 TO  PV-RFRMT-DASH-1.            11120747
057200     MOVE PC-DASH                 TO  PV-RFRMT-DASH-2.            11120847
057300     MOVE PV-REFORMAT-DATE        TO  DL1-CLOSED-DATE.            11120948
057400     MOVE SU042-CLOSE-TMST (12:2) TO  PV-RFRMT-TIME-HH.           11121047
057500     MOVE SU042-CLOSE-TMST (15:2) TO  PV-RFRMT-TIME-MM.           11121147
057600     MOVE ':'                     TO  PV-RFRMT-TIME-1.            11121347
057700     MOVE PV-REFORMAT-TIME        TO  DL1-CLOSED-TIME.            11121548
057800                                                                  11121647
057900     MOVE SU042-OPEN-TMST (3:2)   TO  PV-RFRMT-DATE-YY.           11121747
058000     MOVE SU042-OPEN-TMST (6:2)   TO  PV-RFRMT-DATE-MM.           11121847
058100     MOVE SU042-OPEN-TMST (9:2)   TO  PV-RFRMT-DATE-DD.           11121947
058200     MOVE PC-DASH                 TO  PV-RFRMT-DASH-1.            11122047
058300     MOVE PC-DASH                 TO  PV-RFRMT-DASH-2.            11122147
058400     MOVE PV-REFORMAT-DATE        TO  DL1-OPEN-DATE.              11122247
058500     MOVE SU042-OPEN-TMST (12:2)  TO  PV-RFRMT-TIME-HH.           11122347
058600     MOVE SU042-OPEN-TMST (15:2)  TO  PV-RFRMT-TIME-MM.           11122447
058700     MOVE ':'                     TO  PV-RFRMT-TIME-1.            11122547
058800     MOVE PV-REFORMAT-TIME        TO  DL1-OPEN-TIME.              11122647
058900                                                                  11122747
059000     WRITE SU-TRLR-SEAL-RPT-RECORD                                11123047
059100      FROM DETAIL-LINE1.                                          11130038
059200                                                                  11140002
059300     ADD +1                          TO PV-LINE-CNT.              11150002
059400                                                                  11160002
059500*                                                                 11250002
059600*-----------------------------------------------------------------11260004
059700 8500-WRITE-DC-TOTALS.                                            11270002
059800     IF  PV-LINE-CNT > PC-MAX-REPORT-LINES                        11390002
059900          WRITE SU-TRLR-SEAL-RPT-RECORD                           11400004
060000               FROM PC-BLANK-LINE                                 11410002
060100                 AFTER ADVANCING 1 LINE                           11420028
060200          PERFORM 8000-WRITE-REPORT-HEADERS                       11430002
060300          WRITE SU-TRLR-SEAL-RPT-RECORD                           11440004
060400               FROM PC-BLANK-LINE                                 11450002
060500                 AFTER ADVANCING 1 LINES                          11460002
060600     END-IF.                                                      11490002
060700                                                                  11500002
060800     MOVE PV-TOTAL-DISCP-CNT      TO TL1-DC-DISCREP.              11510028
060900                                                                  11520028
061000     WRITE SU-TRLR-SEAL-RPT-RECORD                                11521051
061100          FROM PC-BLANK-LINE                                      11522051
061200            AFTER ADVANCING 1 LINE.                               11523051
061300                                                                  11524051
061400     WRITE SU-TRLR-SEAL-RPT-RECORD                                11530028
061500       FROM TOTAL-LINE1                                           11540051
061600         AFTER ADVANCING 1 LINE.                                  11550051
061700                                                                  11560028
061800     ADD +2                          TO PV-LINE-CNT.              11570028
061900                                                                  11580028
062000*-----------------------------------------------------------------11590028
062100 8600-PRINT-GRAND-TOTAL.                                          11600029
062200     IF  PV-LINE-CNT > PC-MAX-REPORT-LINES                        11610028
062300          WRITE SU-TRLR-SEAL-RPT-RECORD                           11620028
062400               FROM PC-BLANK-LINE                                 11630028
062500                 AFTER ADVANCING 1 LINE                           11640028
062600          PERFORM 8000-WRITE-REPORT-HEADERS                       11650028
062700          WRITE SU-TRLR-SEAL-RPT-RECORD                           11660028
062800               FROM PC-BLANK-LINE                                 11670028
062900                 AFTER ADVANCING 1 LINES                          11680028
063000     END-IF.                                                      11690028
063100                                                                  11700028
063200     MOVE PV-GRAND-TOTAL          TO TL2-GRAND-TOTAL.             11710028
063300                                                                  11720028
063400     WRITE SU-TRLR-SEAL-RPT-RECORD                                11721051
063500          FROM PC-BLANK-LINE                                      11722051
063600            AFTER ADVANCING 1 LINE.                               11723051
063700                                                                  11724051
063800     WRITE SU-TRLR-SEAL-RPT-RECORD                                11730028
063900       FROM TOTAL-LINE2                                           11740051
064000         AFTER ADVANCING 1 LINE.                                  11750051
064100                                                                  11760028
064200     ADD +2                          TO PV-LINE-CNT.              11770028
064300                                                                  11780028
064400*-----------------------------------------------------------------12040004
064500*SQL WARNING OR ERROR PROCESSING.                                 12050002
064600*-----------------------------------------------------------------12051004
064700 9200-SQL-ERROR.                                                  12060002
064800     MOVE SQLCODE    TO SQLCODE2.                                 12070002
064900     MOVE SQLERRD(3) TO SQLERRD3.                                 12080002
065000     DISPLAY '** ABEND **       ** = SQLERROR'.                   12090002
065100     DISPLAY '** PROGRAM        ** = SUKRP037'.                   12100002
065200     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  12110002
065300     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  12120002
065400     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   12130002
065500     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  12140002
065600     EXEC SQL                                                     12150002
065700         COMMIT                                                   12160002
065800     END-EXEC.                                                    12170002
065900     MOVE +4013 TO PV-ABEND-CODE.                                 12180002
066000     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         12190002
066100*                                                                 12200002
