000100 IDENTIFICATION DIVISION.                                         00010000
000200 TITLE 'MARKING APRON REPORT'.                                    00020000
000300 PROGRAM-ID.             PCKCS010.                                00030000
000400 AUTHOR.                 DENNIS STEFFEN.                          00040000
000500 INSTALLATION.           KOHLS.                                   00050000
000600 DATE-WRITTEN.           NOVEMBER, 1995.                          00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900*    ANY CHANGES THAT MAY EFFECT THE LAYOUT OF THIS REPORT SHOULD 00090000
001000*    BE TESTED ON EVERY MODEL OF PRINTER.  THERE MIGHT BE         00100000
001100*    DIFFERENCES IN CARRIAGE CONTROL AND GRAPHICS PRINTING FOR    00110000
001200*    EACH MODEL.  ALSO BE AWARE THAT WHEN USING PROGRAM DRS1INTC  00120000
001300*    TO PRINT THE REPORT, A NON-BLANK CHARACTER IN PRINT POSITION 00130000
001400*    132 WILL CAUSE A DOUBLE-SPACE TO OCCUR REGARDLESS OF THE     00140000
001500*    VALUE OF THE CARRIAGE CONTROL.                               00150000
001600                                                                  00160000
001700******************************************************************00170000
001800* THIS PROGRAM PRODUCES THE WORK ORDER DISTRIBUTION SHEET.        00180000
001900******************************************************************00190000
002000                                                                  00200000
002100******************************************************************00210000
002200 ENVIRONMENT DIVISION.                                            00220000
002300******************************************************************00230000
002400                                                                  00240000
002500******************************************************************00250000
002600 DATA DIVISION.                                                   00260000
002700******************************************************************00270000
002800                                                                  00280000
002900******************************************************************00290000
003000 WORKING-STORAGE SECTION.                                         00300000
003100******************************************************************00310000
003200                                                                  00320000
003300*                                                                 00330000
003400*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      00340000
003500*                                                                 00350000
003600     COPY DFHAID.                                                 00360000
003700                                                                  00370000
003800*                                                                 00380000
003900*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00390000
004000*                                                                 00400000
004100     COPY DPWS013.                                                00410000
004200 EJECT                                                            00420000
004300*                                                                 00430000
004400*                                                                 00440000
004500*  LAYOUT FOR THE PRINT PACKAGE COMMAND WORKING STORAGE           00450000
004600*                                                                 00460000
004700     COPY DSWS004.                                                00470000
004800 EJECT                                                            00480000
004900*----------- COPYBOOK FOR THE LOGISTICS DOMAIN MODULE -----------*00490099
005000     COPY XLWS001.                                                00500099
005100*----------------------------------------------------------------*00510099
005200*                                                                 00520000
005300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIPT ITEM       00530000
005400*  DISTRIBUTION TABLE.                                            00540000
005500*                                                                 00550000
005600     EXEC SQL                                                     00560000
005700          INCLUDE TRECDIS                                         00570000
005800     END-EXEC.                                                    00580000
005900 EJECT                                                            00590000
006000*                                                                 00600000
006100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIPT ITEM       00610000
006200*  TABLE.                                                         00620000
006300*                                                                 00630000
006400     EXEC SQL                                                     00640000
006500          INCLUDE TRECITM                                         00650000
006600     END-EXEC.                                                    00660000
006700 EJECT                                                            00670000
006800******************************************************************00680099
006900* DCLGEN OF XLT_LOC                                               00690099
007000******************************************************************00700099
007100*                                                                 00710099
007200     EXEC SQL                                                     00720099
007300         INCLUDE XLT00010                                         00730099
007400     END-EXEC.                                                    00740099
007500******************************************************************00750099
007600* DCLGEN OF XLT_DC_LOC_ASGMT                                      00760099
007700******************************************************************00770099
007800*                                                                 00780099
007900     EXEC SQL                                                     00790099
008000         INCLUDE XLT00014                                         00800099
008100     END-EXEC.                                                    00810099
008200 EJECT                                                            00820000
008300*                                                                 00830000
008400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIVER TABLE     00840000
008500*                                                                 00850000
008600     EXEC SQL                                                     00860000
008700         INCLUDE TRECEIV                                          00870000
008800     END-EXEC.                                                    00880000
008900 EJECT                                                            00890000
009000*                                                                 00900000
009100*                                                                 00910000
009200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIP PO TABLE      00920000
009300*                                                                 00930000
009400     EXEC SQL                                                     00940000
009500         INCLUDE TSHPTPO                                          00950000
009600     END-EXEC.                                                    00960000
009700*                                                                 00970000
009800*                                                                 00980000
009900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPMENT TABLE     00990000
010000*                                                                 01000000
010100     EXEC SQL                                                     01010000
010200         INCLUDE TSHIPMT                                          01020000
010300     END-EXEC.                                                    01030000
010400 EJECT                                                            01040000
010500*                                                                 01050000
010600*                                                                 01060000
010700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE VEHICLE TRIP       01070000
010800*                                                                 01080000
010900     EXEC SQL                                                     01090000
011000         INCLUDE TVHTRIP                                          01100000
011100     END-EXEC.                                                    01110000
011200 EJECT                                                            01120000
011300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE STATUS CODE TABLE  01130000
011400*                                                                 01140000
011500     EXEC SQL                                                     01150000
011600          INCLUDE TSTATCD                                         01160000
011700     END-EXEC.                                                    01170000
011800 EJECT                                                            01180000
011900*                                                                 01190000
012000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TVNDAGR TABLE      01200000
012100*                                                                 01210000
012200     EXEC SQL                                                     01220000
012300          INCLUDE TVNDAGR                                         01230000
012400     END-EXEC.                                                    01240000
012500 EJECT                                                            01250000
012600*                                                                 01260000
012700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01270000
012800*  HEADER TABLE                                                   01280000
012900*                                                                 01290000
013000     EXEC SQL                                                     01300000
013100          INCLUDE TPURCHS                                         01310000
013200     END-EXEC.                                                    01320000
013300 EJECT                                                            01330000
013400*                                                                 01340000
013500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01350000
013600*  ITEM TABLE                                                     01360000
013700*                                                                 01370000
013800     EXEC SQL                                                     01380000
013900          INCLUDE TPURITM                                         01390000
014000     END-EXEC.                                                    01400000
014100 EJECT                                                            01410000
014200*                                                                 01420000
014300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE ENTERPRIZE NAME    01430000
014400*  TABLE.                                                         01440000
014500*                                                                 01450000
014600     EXEC SQL                                                     01460000
014700          INCLUDE TENTNME                                         01470000
014800     END-EXEC.                                                    01480000
014900 EJECT                                                            01490000
015000*                                                                 01500000
015100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01510000
015200*  INSTRUCTIONS TABLE                                             01520000
015300*                                                                 01530000
015400     EXEC SQL                                                     01540000
015500          INCLUDE TPOINST                                         01550000
015600     END-EXEC.                                                    01560000
015700 EJECT                                                            01570000
015800*                                                                 01580000
015900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01590000
016000*  INSTRUCTIONS CODE TABLE                                        01600000
016100*                                                                 01610000
016200     EXEC SQL                                                     01620000
016300          INCLUDE TINSTCD                                         01630000
016400     END-EXEC.                                                    01640000
016500 EJECT                                                            01650000
016600*                                                                 01660000
016700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE WORK ORDER         01670000
016800*  INSTRUCTIONS TABLE                                             01680000
016900*                                                                 01690000
017000     EXEC SQL                                                     01700000
017100          INCLUDE TWKORIN                                         01710000
017200     END-EXEC.                                                    01720000
017300/                                                                 01730000
017400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TROUBLE            01740000
017500*  NOTIFICATION TABLE                                             01750000
017600*                                                                 01760000
017700     EXEC SQL                                                     01770000
017800          INCLUDE TTRBNTF                                         01780000
017900     END-EXEC.                                                    01790000
018000                                                                  01800000
018100*                                                                 01810000
018200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TROUBLE            01820000
018300*  REASON CODE TABLE                                              01830000
018400*                                                                 01840000
018500     EXEC SQL                                                     01850000
018600          INCLUDE TTRBRSN                                         01860000
018700     END-EXEC.                                                    01870000
018800 EJECT                                                            01880000
018900*                                                                 01890099
019000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TICKET FORMAT      01900099
019100*  TABLE                                                          01910099
019200*                                                                 01920099
019300     EXEC SQL                                                     01930099
019400          INCLUDE TTKTFMT                                         01940099
019500     END-EXEC.                                                    01950099
019600 EJECT                                                            01960099
019700*                                                                 01970099
019800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PRETICKET REQUEST  01980099
019900*  TABLE                                                          01990099
020000*                                                                 02000099
020100     EXEC SQL                                                     02010099
020200          INCLUDE TPTKREQ                                         02020099
020300     END-EXEC.                                                    02030099
020400 EJECT                                                            02040099
020500*                                                                 02050099
020600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TICKET LINE ITEM   02060099
020700*  TABLE                                                          02070099
020800*                                                                 02080099
020900     EXEC SQL                                                     02090099
021000          INCLUDE TPTKLNE                                         02100099
021100     END-EXEC.                                                    02110099
021200 EJECT                                                            02120099
021300*                                                                 02130099
021400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TICKET PLACEMENT   02140099
021500*  DESCRIPTION TABLE                                              02150099
021600*                                                                 02160099
021700     EXEC SQL                                                     02170099
021800          INCLUDE TPLDESC                                         02180099
021900     END-EXEC.                                                    02190099
022000 EJECT                                                            02200099
022100*----------------------------------------------------------------*02210099
022200*    DB2 DCLGEN FOR THE TMDSEAR TABLE                             02220099
022300*----------------------------------------------------------------*02230099
022400*    EXEC SQL                                                     02240099
022500*         INCLUDE TMDSEAR                                         02250099
022600*    END-EXEC.                                                    02260099
022700/                                                                 02270099
022800/                                                                 02280099
022900*----------------------------------------------------------------*02290099
023000*    DB2 DCLGEN FOR THE TDCVSVL TABLE                             02300099
023100*----------------------------------------------------------------*02310099
023200*    EXEC SQL                                                     02320099
023300*         INCLUDE TDCVSVL                                         02330099
023400*    END-EXEC.                                                    02340099
023500/                                                                 02350099
023600*----------------------------------------------------------------*02360099
023700*    DB2 DCLGEN FOR THE TVSCHVL TABLE                             02370099
023800*----------------------------------------------------------------*02380099
023900*    EXEC SQL                                                     02390099
024000*         INCLUDE TVSCHVL                                         02400099
024100*    END-EXEC.                                                    02410099
024200/                                                                 02420099
024300*----------------------------------------------------------------*02430099
024400*    DB2 DCLGEN FOR THE TVNDSTL TABLE                             02440099
024500*----------------------------------------------------------------*02450099
024600*    EXEC SQL                                                     02460099
024700*         INCLUDE TVNDSTL                                         02470099
024800*    END-EXEC.                                                    02480099
024900/                                                                 02490099
025000*----------------------------------------------------------------*02500099
025100*    DB2 DCLGEN FOR THE TMDARVS TABLE                             02510099
025200*----------------------------------------------------------------*02520099
025300*    EXEC SQL                                                     02530099
025400*         INCLUDE TMDARVS                                         02540099
025500*    END-EXEC.                                                    02550099
025600/                                                                 02560099
025700*                                                                 02570099
025800*  COMMUNICATIONS AREA FOR DB2                                    02580099
025900*                                                                 02590099
026000     EXEC SQL                                                     02600099
026100         INCLUDE SQLCA                                            02610099
026200     END-EXEC.                                                    02620099
026300 EJECT                                                            02630099
026400*---------------------------------------------------------------* 02640099
026500*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 02650099
026600*---------------------------------------------------------------* 02660099
026700                                                                  02670099
026800     COPY PCWS016.                                                02680099
026900                                                                  02690099
027000 01  CA-PCKCS014-COMMAREA.                                        02700099
027100   03  CA-COMMAREA.                                               02710099
027200     05  CA-WRK-ORD-KEY-X.                                        02720099
027300         10  CA-ORD-NBR-X                PIC  X(08)  VALUE SPACE. 02730099
027400         10  CA-ORD-NBR  REDEFINES  CA-ORD-NBR-X                  02740099
027500                                         PIC  9(08).              02750099
027600         10  CA-RCVR-SEQ-NBR-X           PIC  X(03)  VALUE SPACE. 02760099
027700         10  CA-RCVR-SEQ-NBR  REDEFINES  CA-RCVR-SEQ-NBR-X        02770099
027800                                         PIC  9(03).              02780099
027900         10  CA-ORD-LNE-NBR-X            PIC  X(04)  VALUE SPACE. 02790099
028000         10  CA-ORD-LNE-NBR  REDEFINES  CA-ORD-LNE-NBR-X          02800099
028100                                         PIC  9(04).              02810099
028200         10  CA-WORK-ORD-SEQ-NBR-X       PIC  X(03)  VALUE SPACE. 02820099
028300         10  CA-WORK-ORD-SEQ-NBR  REDEFINES  CA-WORK-ORD-SEQ-NBR-X02830099
028400                                         PIC  9(03).              02840099
028500     05  CA-DESTINATION                  PIC  X(08)  VALUE SPACE. 02850099
028600     05  CA-PREPAIRER-USER-ID            PIC  X(08)  VALUE SPACE. 02860099
028700     05  CA-OPER-UNT-ID                  PIC  9(04)  VALUE ZERO.  02870099
028800     05  CA-FCLTY-ID                     PIC  X(04)  VALUE SPACE. 02880099
028900     05  FILLER                          PIC  X(01)  VALUE SPACE. 02890099
029000     05  CA-PRTR-AUTO-CUTTER-IND         PIC  X(01)  VALUE SPACE. 02900099
029100     05  CA-PRTR-PRTR-BRCDE-IND          PIC  X(01)  VALUE SPACE. 02910099
029200     05  CA-PRTR-PRTR-CNTL-IND           PIC  X(01)  VALUE SPACE. 02920099
029300     05  CA-PRINT-PACKAGE-IND            PIC  X(01)  VALUE SPACE. 02930099
029400     05  CA-LINES-PER-INCH               PIC  X(03)  VALUE SPACE. 02940099
029500     05  FILLER                          PIC  X(08)  VALUE SPACE. 02950099
029600     05  CA-SEL-QUEUE-NAME.                                       02960099
029700         10  FILLER                      PIC X(4).                02970099
029800         10  CA-QUEUE-TASK               PIC S9(5) COMP-3.        02980099
029900         10  FILLER                      PIC X(1).                02990099
030000     05  FILLER                          PIC  X(02)  VALUE SPACE. 03000099
030100     05  CA-MRKG-APRON-HDR-IND           PIC  X(01)  VALUE SPACE. 03010099
030200         88  CA-PRINT-MRKG-APRON-HDR                 VALUE 'Y'.   03020099
030300     05  CA-MRKG-APRON-IND               PIC  X(01)  VALUE SPACE. 03030099
030400         88  CA-PRINT-MRKG-APRON                     VALUE 'Y'.   03040099
030500     05  CA-DRIB-AREA                    PIC X(480).              03050099
030600   02  CA-LINE-TABLE.                                             03060099
030700     05  CA-LINE-ENTRY OCCURS 999 TIMES INDEXED BY                03070099
030800                                      LINE-IDX.                   03080099
030900       10  CA-LINE-NBR             PIC S9(4) COMP.                03090099
031000*                                                                 03100099
031100 01  ASC-SPECIFIC-COMMAREA.                                       03110099
031200     05  FILLER                          PIC S9(04) COMP.         03120099
031300     05  ASC-NUMBER-OF-ITEMS-READ                                 03130099
031400                                         PIC S9(09) COMP-3.       03140099
031500     05  FILLER                          PIC S9(09) COMP-3.       03150099
031600     05  FILLER                          PIC S9(05) COMP-3.       03160099
031700     05  ASC-SEL-QUEUE-NAME-IN           PIC X(08).               03170099
031800*                                                                 03180099
031900 01  DK-DB2-KEYS.                                                 03190099
032000     05  DK-ORD-NBR                      PIC S9(09)  VALUE ZEROS  03200099
032100                                                     COMP.        03210099
032200     05  DK-RCVR-SEQ-NBR                 PIC S9(09)  VALUE ZEROS  03220099
032300                                                     COMP.        03230099
032400     05  DK-ORD-LNE-NBR                  PIC S9(04)  VALUE ZEROS  03240099
032500                                                     COMP.        03250099
032600     05  DK-WORK-ORD-SEQ-NBR             PIC S9(04)  VALUE ZEROS  03260099
032700                                                     COMP.        03270099
032800     05  DK-OPER-UNT-ID                  PIC S9(04)  VALUE ZEROS  03280099
032900                                                     COMP.        03290099
033000     05  DK-OPER-UNT-ID-TALL             PIC S9(04)  VALUE ZEROS  03300099
033100                                                     COMP.        03310099
033200     05  DK-FCLTY-ID                     PIC S9(04)  VALUE ZEROS  03320099
033300                                                     COMP.        03330099
033400     05  DK-STR-NBR                      PIC S9(04)  VALUE ZEROS  03340099
033500                                                     COMP.        03350099
033600     05  DK-TKT-FMT-ID                PIC X(06)  VALUE SPACES.    03360099
033700     05  DK-VS-ID                     PIC S9(09) COMP VALUE +0.   03370099
033800     05  DK-HNG-TYP-SEQ-NBR           PIC S9(4) COMP VALUE +0.    03380099
033900     05  DK-MDSEAR-ID                 PIC S9(9) COMP VALUE +0.    03390099
034000     05  DK-ENT-ID                    PIC S9(09) COMP VALUE +0.   03400099
034100     05  DK-DEPT-NBR                  PIC X(03)  VALUE SPACES.    03410099
034200     05  DK-SUBCLASS-NBR              PIC X(03) VALUE SPACE.      03420099
034300     05  DK-MAJCLASS-NBR              PIC X(02) VALUE SPACE.      03430099
034400     05  DK-AGRMT-TYP-ID              PIC X(01)  VALUE SPACES.    03440099
034500     05  DK-TYP-CDE                   PIC S9(04) VALUE +0         03450099
034600                                                  COMP.           03460099
034700     COPY DPWS020.                                                03470099
034800*                                                                 03480099
034900 01  TL1-TROUBLE-LINE-1.                                          03490099
035000     05  FILLER                          PIC X(19)   VALUE        03500099
035100         'T R O U B L E  **  '.                                   03510099
035200     05  FILLER                          PIC X(19)   VALUE        03520099
035300         'T R O U B L E  **  '.                                   03530099
035400     05  FILLER                          PIC X(19)   VALUE        03540099
035500         'T R O U B L E  **  '.                                   03550099
035600     05  FILLER                          PIC X(19)   VALUE        03560099
035700         'T R O U B L E  **  '.                                   03570099
035800     05  FILLER                          PIC X(19)   VALUE        03580099
035900         'T R O U B L E  **  '.                                   03590099
036000     05  FILLER                          PIC X(19)   VALUE        03600099
036100         'T R O U B L E  **  '.                                   03610099
036200     05  FILLER                          PIC X(18)   VALUE        03620099
036300         'T R O U B L E  ** '.                                    03630099
036400*                                                                 03640099
036500 01  TL2-TROUBLE-LINE-2.                                          03650099
036600     05  TL2-TRBL-DESC-TABLE OCCURS 5 TIMES INDEXED BY            03660099
036700                                            TRBL-IDX.             03670099
036800         10  FILLER                      PIC X(06)   VALUE SPACES.03680099
036900         10  TL2-TRBL-DESC               PIC X(20).               03690099
037000     05  FILLER                          PIC X(02)   VALUE SPACES.03700099
037100*                                                                 03710099
037200 01  TL3-TROUBLE-LINE-3.                                          03720099
037300     05  TL3-TRBL-DESC-TABLE OCCURS 5 TIMES INDEXED BY            03730099
037400                                            TRBL-IDX2.            03740099
037500         10  FILLER                      PIC X(04)   VALUE SPACES.03750099
037600         10  TL3-TRBL-IND                PIC X(01)   VALUE SPACES.03760099
037700         10  TL3-DASH                    PIC X(01)   VALUE SPACES.03770099
037800         10  TL3-TRBL-DESC               PIC X(20).               03780099
037900     05  FILLER                          PIC X(02)   VALUE SPACES.03790099
038000*                                                                 03800099
038100 01  RL1-REPRINT-LINE-1.                                          03810099
038200     05  FILLER                          PIC X(19)   VALUE        03820099
038300         'R E P R I N T  **  '.                                   03830099
038400     05  FILLER                          PIC X(19)   VALUE        03840099
038500         'R E P R I N T  **  '.                                   03850099
038600     05  FILLER                          PIC X(19)   VALUE        03860099
038700         'R E P R I N T  **  '.                                   03870099
038800     05  FILLER                          PIC X(19)   VALUE        03880099
038900         'R E P R I N T  **  '.                                   03890099
039000     05  FILLER                          PIC X(19)   VALUE        03900099
039100         'R E P R I N T  **  '.                                   03910099
039200     05  FILLER                          PIC X(19)   VALUE        03920099
039300         'R E P R I N T  **  '.                                   03930099
039400     05  FILLER                          PIC X(18)   VALUE        03940099
039500         'R E P R I N T  ** '.                                    03950099
039600                                                                  03960099
039700 01  RT1-RTV-DISTRO-LINE-1.                                       03970099
039800     05  FILLER                          PIC X(38)   VALUE        03980099
039900         'R T V   D I S T R I B U T I O N   **  '.                03990099
040000     05  FILLER                          PIC X(49)   VALUE        04000099
040100         'RTV SHEETS LOCATED AT END OF MARKING APRON PACKET'.     04010099
040200     05  FILLER                          PIC X(38)   VALUE        04020099
040300         '   **  R T V   D I S T R I B U T I O N'.                04030099
040400     05  FILLER                          PIC X(07)  VALUE SPACE.  04040099
040500*                                                                 04050099
040600 01  HL1-HEADING-LINE-1.                                          04060099
040700     05  FILLER                          PIC X(02)   VALUE SPACE. 04070099
040800     05  HL1-RUN-DATE.                                            04080099
040900         10  HL1-RUN-MONTH               PIC  9(02)  VALUE ZERO.  04090099
041000         10  FILLER                      PIC  X(01)  VALUE '/'.   04100099
041100         10  HL1-RUN-DAY                 PIC  9(02)  VALUE ZERO.  04110099
041200         10  FILLER                      PIC  X(01)  VALUE '/'.   04120099
041300         10  HL1-RUN-YEAR                PIC  9(02)  VALUE ZERO.  04130099
041400     05  FILLER                          PIC  X(02)  VALUE SPACE. 04140099
041500     05  HL1-RUN-TIME.                                            04150099
041600         10  HL1-RUN-HOUR                PIC  9(02)  VALUE ZERO.  04160099
041700         10  FILLER                      PIC  X(01)  VALUE ':'.   04170099
041800         10  HL1-RUN-MINUTE              PIC  9(02)  VALUE ZERO.  04180099
041900     05  FILLER                          PIC  X(24)  VALUE SPACE. 04190099
042000     05  HL1-RPT-HDR                     PIC  X(46)  VALUE SPACE. 04200099
042100     05  FILLER                          PIC  X(20)  VALUE SPACE. 04210099
042200     05  HL1-PROGRAM-NAME                PIC  X(08)  VALUE SPACE. 04220099
042300     05  FILLER                          PIC  X(01)  VALUE '-'.   04230099
042400     05  HL1-RPT-NBR                     PIC  9(01)  VALUE ZERO.  04240099
042500     05  FILLER                          PIC  X(02)  VALUE SPACE. 04250099
042600     05  FILLER                          PIC  X(05)  VALUE        04260099
042700         'PAGE '.                                                 04270099
042800     05  HL1-PGE-NBR                     PIC  9(01)  VALUE ZERO.  04280099
042900     05  FILLER                          PIC  X(04)  VALUE        04290099
043000         ' OF '.                                                  04300099
043100     05  HL1-OF-PGE-NBR                  PIC  9(01)  VALUE ZERO.  04310099
043200     05  FILLER                          PIC  X(02)  VALUE SPACE. 04320099
043300*                                                                 04330099
043400 01  HL2-HEADING-LINE-2.                                          04340099
043500     05  FILLER                          PIC  X(06)  VALUE SPACE. 04350099
043600     05  FILLER                          PIC  X(13)  VALUE        04360099
043700         '   OPER UNIT:'.                                         04370099
043800     05  FILLER                          PIC  X(01)  VALUE SPACE. 04380099
043900     05  HL2-OPERATING-ID                PIC  X(04)  VALUE SPACE. 04390099
044000     05  FILLER                          PIC  X(24)  VALUE SPACE. 04400099
044100     05  FILLER                          PIC  X(12)  VALUE        04410099
044200         'FACILITY ID:'.                                          04420099
044300     05  FILLER                          PIC  X(01)  VALUE SPACE. 04430099
044400     05  HL2-FACILITY-ID                 PIC  X(04)  VALUE SPACE. 04440099
044500     05  FILLER                          PIC  X(33)  VALUE SPACE. 04450099
044600     05  FILLER                          PIC  X(08)  VALUE        04460099
044700         'TRIP ID:'.                                              04470099
044800     05  FILLER                          PIC  X(01)  VALUE SPACE. 04480099
044900     05  HL2-TRIP-ID                     PIC  ZZZZZZZZZ.          04490099
045000     05  FILLER                          PIC  X(02)  VALUE SPACE. 04500099
045100*                                                                 04510099
045200 01  HL3-HEADING-LINE-3.                                          04520099
045300     05  FILLER                          PIC  X(05)  VALUE SPACE. 04530099
045400     05  FILLER                          PIC  X(14)  VALUE        04540099
045500         'LINE LOCATION:'.                                        04550099
045600     05  FILLER                          PIC  X(01)  VALUE SPACE. 04560099
045700     05  HL3-LNE-LOC                     PIC  X(05)  VALUE SPACE. 04570099
045800     05  FILLER                          PIC  X(23)  VALUE SPACE. 04580099
045900     05  FILLER                          PIC  X(12)  VALUE        04590099
046000         'PREPARED BY:'.                                          04600099
046100     05  FILLER                          PIC  X(01)  VALUE SPACE. 04610099
046200     05  HL3-PREPAIRER-USER-ID           PIC  X(08)  VALUE SPACE. 04620099
046300     05  FILLER                          PIC  X(27)  VALUE SPACE. 04630099
046400     05  FILLER                          PIC  X(10)  VALUE        04640099
046500         'DIVIDE BY:'.                                            04650099
046600     05  FILLER                          PIC  X(01)  VALUE SPACE. 04660099
046700     05  FILLER                          PIC  X(15)  VALUE ALL    04670099
046800         '_'.                                                     04680099
046900     05  FILLER                          PIC  X(11)  VALUE SPACE. 04690099
047000*                                                                 04700099
047100 01  HL4-HEADING-LINE-4.                                          04710099
047200     05  FILLER                          PIC  X(07)  VALUE SPACE. 04720099
047300     05  FILLER                          PIC  X(12)  VALUE        04730099
047400         'VENDOR NAME:'.                                          04740099
047500     05  FILLER                          PIC  X(01)  VALUE SPACE. 04750099
047600     05  HL4-VNDR-NME                    PIC  X(25)  VALUE SPACE. 04760099
047700     05  FILLER                          PIC  X(04)  VALUE SPACE. 04770099
047800     05  FILLER                          PIC  X(11)  VALUE        04780099
047900         'PRINTER ID:'.                                           04790099
048000     05  FILLER                          PIC  X(01)  VALUE SPACE. 04800099
048100     05  HL4-PRINTER-DEST                PIC  X(08)  VALUE SPACE. 04810099
048200     05  FILLER                          PIC  X(30)  VALUE SPACE. 04820099
048300     05  FILLER                          PIC  X(07)  VALUE        04830099
048400         'KEYREC:'.                                               04840099
048500     05  FILLER                          PIC  X(01)  VALUE SPACE. 04850099
048600     05  HL4-KEYREC                      PIC  9(08)  VALUE ZEROS. 04860099
048700     05  FILLER                          PIC  X(18)  VALUE SPACE. 04870099
048800*                                                                 04880099
048900 01  HL5-HEADING-LINE-5.                                          04890099
049000     05  FILLER                          PIC  X(12)  VALUE SPACE. 04900099
049100     05  FILLER                          PIC  X(07)  VALUE        04910099
049200         'PO NBR:'.                                               04920099
049300     05  FILLER                          PIC  X(01)  VALUE SPACE. 04930099
049400     05  HL5-PO-NBR                      PIC  X(08)  VALUE SPACE. 04940099
049500     05  FILLER                          PIC  X(27)  VALUE SPACE. 04950099
049600     05  FILLER                          PIC  X(05)  VALUE        04960099
049700         'DEPT:'.                                                 04970099
049800     05  FILLER                          PIC  X(01)  VALUE SPACE. 04980099
049900     05  HL5-DEPT-NBR                    PIC  X(03)  VALUE SPACE. 04990099
050000     05  FILLER                          PIC  X(01)  VALUE SPACE. 05000099
050100     05  FILLER                          PIC  X(04)  VALUE        05010099
050200         'CLS:'.                                                  05020099
050300     05  FILLER                          PIC  X(01)  VALUE SPACE. 05030099
050400     05  HL5-CLASS-NBR                   PIC  X(02)  VALUE SPACE. 05040099
050500     05  FILLER                          PIC  X(01)  VALUE SPACE. 05050099
050600     05  FILLER                          PIC  X(04)  VALUE        05060099
050700         'SKU:'.                                                  05070099
050800     05  FILLER                          PIC  X(01)  VALUE SPACE. 05080099
050900     05  HL5-SEQ-NBR                     PIC  X(08)  VALUE SPACE. 05090099
051000     05  FILLER                          PIC  X(02)  VALUE SPACE. 05100099
051100     05  FILLER                          PIC  X(18)  VALUE        05110099
051200         'EXPTED CARTON CNT:'.                                    05120099
051300     05  FILLER                          PIC  X(03)  VALUE SPACE. 05130099
051400     05  HL5-TOT-CARTON-CNT              PIC  ZZZ,ZZZ,ZZZ.        05140099
051500     05  FILLER                          PIC  X(12)  VALUE SPACE. 05150099
051600*                                                                 05160099
051700 01  HL6-HEADING-LINE-6.                                          05170099
051800     05  FILLER                          PIC  X(02)  VALUE SPACE. 05180099
051900     05  FILLER                          PIC  X(17)  VALUE        05190099
052000         'RECEIVER SEQ NBR:'.                                     05200099
052100     05  FILLER                          PIC  X(01)  VALUE SPACE. 05210099
052200     05  HL6-RCVR-SEQ-NBR                PIC  X(03)  VALUE SPACE. 05220099
052300     05  FILLER                          PIC  X(32)  VALUE SPACE. 05230099
052400     05  FILLER                          PIC  X(05)  VALUE        05240099
052500         'SIZE:'.                                                 05250099
052600     05  FILLER                          PIC  X(01)  VALUE SPACE. 05260099
052700     05  HL6-SIZE                        PIC  X(20)  VALUE SPACE. 05270099
052800     05  FILLER                          PIC  X(05)  VALUE SPACE. 05280099
052900     05  FILLER                          PIC  X(20)  VALUE        05290099
053000         'ADJUSTED CARTON CNT:'.                                  05300099
053100     05  FILLER                          PIC  X(01)  VALUE SPACE. 05310099
053200     05  HL6-TOT-CARTON-CNT              PIC  ZZZ,ZZZ,ZZZ.        05320099
053300     05  FILLER                          PIC  X(12)  VALUE SPACE. 05330099
053400*                                                                 05340099
053500 01  HL7-HEADING-LINE-7.                                          05350099
053600     05  FILLER                          PIC  X(10)  VALUE SPACE. 05360099
053700     05  FILLER                          PIC  X(09)  VALUE        05370099
053800         'LINE NBR:'.                                             05380099
053900     05  FILLER                          PIC  X(01)  VALUE SPACE. 05390099
054000     05  HL7-LINE-NBR                    PIC  X(04)  VALUE SPACE. 05400099
054100     05  FILLER                          PIC  X(30)  VALUE SPACE. 05410099
054200     05  FILLER                          PIC  X(06)  VALUE        05420099
054300         'COLOR:'.                                                05430099
054400     05  FILLER                          PIC  X(01)  VALUE SPACE. 05440099
054500     05  HL7-COLOR                       PIC  X(20)  VALUE SPACE. 05450099
054600     05  FILLER                          PIC  X(08)  VALUE SPACE. 05460099
054700     05  FILLER                          PIC  X(17)  VALUE        05470099
054800         '    ARRIVED DATE:'.                                     05480099
054900     05  FILLER                          PIC  X(01)  VALUE SPACE. 05490099
055000     05  HL7-REC-DATE                    PIC  X(10).              05500099
055100     05  FILLER                          PIC  X(16)  VALUE SPACE. 05510099
055200*                                                                 05520099
055300 01  HL8-HEADING-LINE-8.                                          05530099
055400     05  FILLER                          PIC  X(04)  VALUE SPACE. 05540099
055500     05  FILLER                          PIC  X(15)  VALUE        05550099
055600         'WORK ORDER NBR:'.                                       05560099
055700     05  FILLER                          PIC  X(01)  VALUE SPACE. 05570099
055800     05  HL8-WORK-ORD-NBR                PIC  X(03)  VALUE SPACE. 05580099
055900     05  FILLER                          PIC  X(28)  VALUE SPACE. 05590099
056000     05  FILLER                          PIC  X(09)  VALUE        05600099
056100         'SKU DESC:'.                                             05610099
056200     05  FILLER                          PIC  X(01)  VALUE SPACE. 05620099
056300     05  HL8-SKU-DESC                    PIC  X(25)  VALUE SPACE. 05630099
056400     05  FILLER                          PIC  X(13)  VALUE SPACE. 05640099
056500     05  FILLER                          PIC  X(08)  VALUE        05650099
056600         'HANGER: '.                                              05660099
056700     05  HL8-HANGER                      PIC  X(20)  VALUE SPACE. 05670099
056800     05  FILLER                          PIC  X(05)  VALUE SPACE. 05680099
056900*                                                                 05690099
057000 01  HL9-HEADING-LINE-9.                                          05700099
057100     05  FILLER                          PIC  X(04)  VALUE SPACE. 05710099
057200     05  FILLER                          PIC  X(15)  VALUE        05720099
057300         'LINE ITEM DESC:'.                                       05730099
057400     05  FILLER                          PIC  X(01)  VALUE SPACE. 05740099
057500     05  HL9-LNE-ITM-DESC                PIC  X(25)  VALUE SPACE. 05750099
057600     05  FILLER                          PIC  X(05)  VALUE SPACE. 05760099
057700     05  FILLER                          PIC  X(10)  VALUE        05770099
057800         'SKU STYLE:'.                                            05780099
057900     05  FILLER                          PIC  X(01)  VALUE SPACE. 05790099
058000     05  HL9-VNDR-STYLE-NME              PIC  X(15)  VALUE SPACE. 05800099
058100     05  FILLER                          PIC  X(17)  VALUE SPACE. 05810099
058200     05  FILLER                          PIC  X(14)  VALUE        05820099
058300         'PRESENTATION: '.                                        05830099
058400     05  HL9-PRESENTATION                PIC  X(07)  VALUE SPACE. 05840099
058500     05  FILLER                          PIC  X(08)  VALUE SPACE. 05850099
058600*                                                                 05860099
058700 01  HL10-HEADING-LINE-10.                                        05870099
058800     05  FILLER                          PIC  X(09)  VALUE SPACE. 05880099
058900     05  FILLER                          PIC  X(10)  VALUE        05890099
059000         'SIZE DESC:'.                                            05900099
059100     05  FILLER                          PIC  X(01)  VALUE SPACE. 05910099
059200     05  HL10-SIZE-DESC                  PIC  X(25)  VALUE SPACE. 05920099
059300     05  FILLER                          PIC  X(06)  VALUE SPACE. 05930099
059400     05  FILLER                          PIC  X(09)  VALUE        05940099
059500         'PO STYLE:'.                                             05950099
059600     05  FILLER                          PIC  X(01)  VALUE SPACE. 05960099
059700     05  HL10-VNDR-STYLE-NME             PIC  X(15)  VALUE SPACE. 05970099
059800     05  FILLER                          PIC  X(18)  VALUE SPACE. 05980099
059900     05  FILLER                          PIC  X(13)  VALUE        05990099
060000         'PICTURED AD: '.                                         06000099
060100     05  HL10-PIC-ITM-IND                PIC  X(01)  VALUE SPACES.06010099
060200     05  FILLER                          PIC  X(24)  VALUE SPACE. 06020099
060300*    05  FILLER                          PIC  X(06)  VALUE SPACE. 06030099
060400*    05  HL10-TICKET-PLCMNT              PIC  X(50)  VALUE SPACES.06040099
060500*                                                                 06050099
060600 01  HL11-HEADING-LINE-11.                                        06060099
060700     05  FILLER                          PIC  X(08)  VALUE SPACE. 06070099
060800     05  FILLER                          PIC  X(11)  VALUE        06080099
060900         'COLOR DESC:'.                                           06090099
061000     05  FILLER                          PIC  X(01)  VALUE SPACE. 06100099
061100     05  HL11-COLOR-DESC                 PIC  X(25)  VALUE SPACE. 06110099
061200     05  FILLER                          PIC  X(04)  VALUE SPACE. 06120099
061300     05  FILLER                          PIC  X(11)  VALUE        06130099
061400         'SKU RETAIL:'.                                           06140099
061500     05  HL11-SKU-RTL                    PIC ZZ,ZZZ.99            06150099
061600                                                     VALUE ZEROS. 06160099
061700     05  FILLER                          PIC  X(27)  VALUE SPACE. 06170099
061800     05  FILLER                          PIC  X(11)  VALUE        06180099
061900         'PACK TYPE: '.                                           06190099
062000     05  HL11-PACK-TYPE-DESC             PIC  X(22)  VALUE SPACE. 06200099
062100     05  FILLER                          PIC  X(03)  VALUE SPACE. 06210099
062200*    05  FILLER                          PIC  X(22)  VALUE SPACE. 06220099
062300*    05  HL11-UPC-CERT-MESSAGE           PIC  X(38)  VALUE SPACE. 06230099
062400*    05  FILLER                          PIC  X(03)  VALUE SPACES.06240099
062500*                                                                 06250099
062600 01  HL12-HEADING-LINE-12.                                        06260099
062700     05  FILLER                          PIC  X(05)  VALUE SPACE. 06270099
062800     05  FILLER                          PIC  X(14)  VALUE        06280099
062900         'TICKET RETAIL:'.                                        06290099
063000     05  FILLER                          PIC  X(01)  VALUE SPACE. 06300099
063100     05  HL12-UNT-RTL-PR-AMT             PIC ZZZ,ZZZ.99           06310099
063200                                                     VALUE ZEROS  06320099
063300                                         BLANK WHEN ZERO.         06330099
063400     05  FILLER                          PIC  X(53)  VALUE SPACE. 06340099
063500*    05  FILLER                          PIC  X(49)  VALUE SPACE. 06350099
063600     05  FILLER                          PIC  X(01)  VALUE SPACE. 06360099
063700     05  FILLER                          PIC  X(08)  VALUE        06370099
063800         'BOX ID: '.                                              06380099
063900*    05  HL12-BOX-ID                     PIC  X(03)  VALUE SPACE. 06390099
064000     05  HL12-BOX-ID                     PIC  X(04)  VALUE SPACE. 06400099
064100*    05  FILLER                          PIC  X(01)  VALUE SPACES.06410099
064200     05  HL12-UPC-CERT-MESSAGE           PIC  X(36)  VALUE SPACE. 06420099
064300*                                                                 06430099
064400 01  HL13-HEADING-LINE-13.                                        06440099
064500     05  FILLER                          PIC  X(01)  VALUE SPACE. 06450099
064600     05  FILLER                          PIC  X(18)  VALUE        06460099
064700         'ACTUAL CARTON CNT:'.                                    06470099
064800     05  FILLER                          PIC  X(01)  VALUE SPACE. 06480099
064900     05  HL13-ACTUAL-CART-CNT            PIC ZZZ,ZZZ,ZZZ          06490099
065000                                                     VALUE ZEROS  06500099
065100                                         BLANK WHEN ZERO.         06510099
065200     05  FILLER                          PIC  X(94)  VALUE SPACE. 06520099
065300     05  FILLER                          PIC  X(07)  VALUE SPACE. 06530099
065400*                                                                 06540099
065500 01  HL13A-HEADING-LINE-13A.                                      06550099
065600     05  FILLER                          PIC  X(01)  VALUE SPACE. 06560099
065700     05  FILLER                          PIC  X(11)  VALUE        06570099
065800         'PRETICKET: '.                                           06580099
065900     05  HL13A-PRETICKET-IND             PIC  X(01)  VALUE SPACES.06590099
066000     05  FILLER                          PIC  X(02)  VALUE SPACE. 06600099
066100     05  FILLER                          PIC  X(13)  VALUE        06610099
066200         'TICKET TYPE: '.                                         06620099
066300     05  HL13A-TICKET-TYPE               PIC  X(20)  VALUE SPACE. 06630099
066400     05  FILLER                          PIC  X(02)  VALUE SPACE. 06640099
066500     05  FILLER                          PIC  X(18)  VALUE        06650099
066600         'TICKET PLACEMENT: '.                                    06660099
066700     05  HL13A-TICKET-PLACEMENT          PIC  X(50)  VALUE SPACE. 06670099
066800*                                                                 06680099
066900 01  HL14-HEADING-LINE-14.                                        06690099
067000     05  FILLER                          PIC  X(05)  VALUE SPACE. 06700099
067100     05  FILLER                          PIC  X(14)  VALUE        06710099
067200         'SPECIAL INSTR:'.                                        06720099
067300     05  FILLER                          PIC  X(01)  VALUE SPACE. 06730099
067400     05  HL14-SPECIAL-INSTR              PIC  X(100) VALUE SPACE. 06740099
067500     05  FILLER                          PIC  X(12)  VALUE SPACE. 06750099
067600*                                                                 06760099
067700 01  HL15-HEADING-LINE-15.                                        06770099
067800     05  FILLER                          PIC  X(01)  VALUE SPACE. 06780099
067900     05  FILLER                          PIC  X(25)  VALUE        06790099
068000         '*** RTV DISTRIBUTIONS ***'.                             06800099
068100     05  FILLER                          PIC  X(106) VALUE SPACE. 06810099
068200*                                                                 06820099
068300 01  DH1-DETAIL-HEADING-LINE-1.                                   06830099
068400     05  FILLER                          PIC  X(01)  VALUE SPACE. 06840099
068500     05  FILLER                          PIC  X(10)  VALUE        06850099
068600         'STORE/NAME'.                                            06860099
068700     05  FILLER                          PIC  X(01)  VALUE SPACE. 06870099
068800     05  FILLER                          PIC  X(06)  VALUE        06880099
068900         'EXPTED'.                                                06890099
069000     05  FILLER                          PIC  X(03)  VALUE SPACE. 06900099
069100     05  FILLER                          PIC  X(05)  VALUE        06910099
069200         'ITEMS'.                                                 06920099
069300     05  FILLER                          PIC  X(03)  VALUE SPACE. 06930099
069400     05  FILLER                          PIC  X(05)  VALUE        06940099
069500         'ITEMS'.                                                 06950099
069600     05  FILLER                          PIC  X(01)  VALUE SPACE. 06960099
069700     05  FILLER                          PIC  X(07)  VALUE        06970099
069800         'OPEN TO'.                                               06980099
069900     05  FILLER                          PIC  X(03)  VALUE SPACE. 06990099
070000     05  FILLER                          PIC  X(10)  VALUE        07000099
070100         'STORE/NAME'.                                            07010099
070200     05  FILLER                          PIC  X(01)  VALUE SPACE. 07020099
070300     05  FILLER                          PIC  X(06)  VALUE        07030099
070400         'EXPTED'.                                                07040099
070500     05  FILLER                          PIC  X(03)  VALUE SPACE. 07050099
070600     05  FILLER                          PIC  X(05)  VALUE        07060099
070700         'ITEMS'.                                                 07070099
070800     05  FILLER                          PIC  X(03)  VALUE SPACE. 07080099
070900     05  FILLER                          PIC  X(05)  VALUE        07090099
071000         'ITEMS'.                                                 07100099
071100     05  FILLER                          PIC  X(01)  VALUE SPACE. 07110099
071200     05  FILLER                          PIC  X(07)  VALUE        07120099
071300         'OPEN TO'.                                               07130099
071400     05  FILLER                          PIC  X(03)  VALUE SPACE. 07140099
071500     05  FILLER                          PIC  X(10)  VALUE        07150099
071600         'STORE/NAME'.                                            07160099
071700     05  FILLER                          PIC  X(01)  VALUE SPACE. 07170099
071800     05  FILLER                          PIC  X(06)  VALUE        07180099
071900         'EXPTED'.                                                07190099
072000     05  FILLER                          PIC  X(03)  VALUE SPACE. 07200099
072100     05  FILLER                          PIC  X(05)  VALUE        07210099
072200         'ITEMS'.                                                 07220099
072300     05  FILLER                          PIC  X(03)  VALUE SPACE. 07230099
072400     05  FILLER                          PIC  X(05)  VALUE        07240099
072500         'ITEMS'.                                                 07250099
072600     05  FILLER                          PIC  X(01)  VALUE SPACE. 07260099
072700     05  FILLER                          PIC  X(07)  VALUE        07270099
072800         'OPEN TO'.                                               07280099
072900     05  FILLER                          PIC  X(02)  VALUE SPACE. 07290099
073000*                                                                 07300099
073100 01  DH2-DETAIL-HEADING-LINE-2.                                   07310099
073200     05  FILLER                          PIC  X(12)  VALUE SPACE. 07320099
073300     05  FILLER                          PIC  X(05)  VALUE        07330099
073400         'ITEMS'.                                                 07340099
073500     05  FILLER                          PIC  X(05)  VALUE SPACE. 07350099
073600     05  FILLER                          PIC  X(03)  VALUE        07360099
073700         'O/S'.                                                   07370099
073800     05  FILLER                          PIC  X(04)  VALUE SPACE. 07380099
073900     05  FILLER                          PIC  X(04)  VALUE        07390099
074000         'DMGD'.                                                  07400099
074100     05  FILLER                          PIC  X(02)  VALUE SPACE. 07410099
074200     05  FILLER                          PIC  X(07)  VALUE        07420099
074300         'RECEIVE'.                                               07430099
074400     05  FILLER                          PIC  X(14)  VALUE SPACE. 07440099
074500     05  FILLER                          PIC  X(05)  VALUE        07450099
074600         'ITEMS'.                                                 07460099
074700     05  FILLER                          PIC  X(05)  VALUE SPACE. 07470099
074800     05  FILLER                          PIC  X(03)  VALUE        07480099
074900         'O/S'.                                                   07490099
075000     05  FILLER                          PIC  X(04)  VALUE SPACE. 07500099
075100     05  FILLER                          PIC  X(04)  VALUE        07510099
075200         'DMGD'.                                                  07520099
075300     05  FILLER                          PIC  X(02)  VALUE SPACE. 07530099
075400     05  FILLER                          PIC  X(07)  VALUE        07540099
075500         'RECEIVE'.                                               07550099
075600     05  FILLER                          PIC  X(14)  VALUE SPACE. 07560099
075700     05  FILLER                          PIC  X(05)  VALUE        07570099
075800         'ITEMS'.                                                 07580099
075900     05  FILLER                          PIC  X(05)  VALUE SPACE. 07590099
076000     05  FILLER                          PIC  X(03)  VALUE        07600099
076100         'O/S'.                                                   07610099
076200     05  FILLER                          PIC  X(04)  VALUE SPACE. 07620099
076300     05  FILLER                          PIC  X(04)  VALUE        07630099
076400         'DMGD'.                                                  07640099
076500     05  FILLER                          PIC  X(02)  VALUE SPACE. 07650099
076600     05  FILLER                          PIC  X(07)  VALUE        07660099
076700         'RECEIVE'.                                               07670099
076800     05  FILLER                          PIC  X(02)  VALUE SPACE. 07680099
076900*                                                                 07690099
077000 01  DH3-NO-DISTRO-MSG .                                          07700099
077100     05  FILLER                          PIC X(19)   VALUE        07710099
077200         '   NO DISTRO   **  '.                                   07720099
077300     05  FILLER                          PIC X(19)   VALUE        07730099
077400         '   NO DISTRO   **  '.                                   07740099
077500     05  FILLER                          PIC X(19)   VALUE        07750099
077600         '   NO DISTRO   **  '.                                   07760099
077700     05  FILLER                          PIC X(19)   VALUE        07770099
077800         '   NO DISTRO   **  '.                                   07780099
077900     05  FILLER                          PIC X(19)   VALUE        07790099
078000         '   NO DISTRO   **  '.                                   07800099
078100     05  FILLER                          PIC X(19)   VALUE        07810099
078200         '   NO DISTRO   **  '.                                   07820099
078300     05  FILLER                          PIC X(18)   VALUE        07830099
078400         '   NO DISTRO   ** '.                                    07840099
078500*                                                                 07850099
078600 01  DH4-STORE-PROBLEM-LINE.                                      07860099
078700     05  FILLER                          PIC X(01)   VALUE SPACE. 07870099
078800     05  FILLER                          PIC X(24)   VALUE        07880099
078900         '** WARNING ** WARNING **'.                              07890099
079000     05  FILLER                          PIC X(16)   VALUE SPACE. 07900099
079100     05  FILLER                          PIC X(52)   VALUE        07910099
079200         'POTENTIAL PROBLEMS WITH STORES FOR THIS DISTRIBUTION'.  07920099
079300     05  FILLER                          PIC X(16)   VALUE SPACE. 07930099
079400     05  FILLER                          PIC X(24)   VALUE        07940099
079500         '** WARNING ** WARNING **'.                              07950099
079600                                                                  07960099
079700 01  DL-DETAIL-LINE.                                              07970099
079800     05  FILLER                          PIC  X(01)  VALUE SPACE. 07980099
079900     05  DL-DTL-LNE-AREA                 OCCURS 3 TIMES           07990099
080000                                            INDEXED BY            08000099
080100                                            DL-DTL-LNE-IDX.       08010099
080200         10  FILLER                      PIC  X(01).              08020099
080300         10  DL-STR-NBR                  PIC  ZZZ9.               08030099
080400         10  FILLER                      PIC  X(01).              08040099
080500         10  DL-CHAR5-ABBR-NAME          PIC  X(05).              08050099
080600         10  FILLER                      PIC  X(01).              08060099
080700         10  DL-EXPTED-ITM-CNT           PIC  ZZ,ZZ9.             08070099
080800         10  FILLER                      PIC  X(02).              08080099
080900         10  DL-UNITS-OVER-SHORT         PIC  X(06).              08090099
081000         10  FILLER                      PIC  X(02).              08100099
081100         10  DL-UNITS-DAMAGED            PIC  X(06).              08110099
081200         10  FILLER                      PIC  X(02).              08120099
081300         10  DL-UNITS-OPEN-TO-RECEIVE    PIC  X(6).               08130099
081400         10  DL-FILLER                   PIC  X(02).              08140099
081500*                                                                 08150099
081600 01  PC-PROGRAM-CONSTANTS.                                        08160099
081700     05  PC-DB2-DUMMY-DATE               PIC  X(26)  VALUE        08170099
081800         '9999-09-09-09.09.09.000000'.                            08180099
081900     05  PC-DB2-DUMMY-DATE-TIME          PIC  X(26)  VALUE        08190099
082000         '9999-09-09-09.09.09.999999'.                            08200099
082100     05  PC-DB2-ZERO-DATE-TIME           PIC  X(26)  VALUE        08210099
082200         '0000-00-00-00.00.00.000000'.                            08220099
082300     05  PC-MULTIPLE-RESULT-SET-ROWS     PIC S9(04)  VALUE -811   08230099
082400                                                     COMP SYNC.   08240099
082500     05  PC-PCKCS014                     PIC  X(08)  VALUE        08250099
082600                                                     'PCKCS014'.  08260099
082700     05  PC-SLASH                        PIC  X(01)  VALUE '/'.   08270099
082800     05  PC-Y                            PIC  X(02)  VALUE 'Y'.   08280099
082900     05  PC-ONE                          PIC  9(01)  VALUE 1.     08290099
083000     05  PC-ZERO                         PIC S9(09)  COMP VALUE   08300099
083100         ZERO.                                                    08310099
083200     05  PC-2                            PIC  9(01)  VALUE 2.     08320099
083300     05  PC-5                            PIC  9(01)  VALUE 5.     08330099
083400     05  PC-3                            PIC  9(01)  VALUE 3.     08340099
083500     05  PC-B                            PIC  X(01)  VALUE 'B'.   08350099
083600     05  PC-C                            PIC  X(01)  VALUE 'C'.   08360099
083700     05  PC-T                            PIC  X(01)  VALUE 'T'.   08370099
083800     05  PC-M                            PIC  X(01)  VALUE 'M'.   08380099
083900     05  PC-N                            PIC  X(01)  VALUE 'N'.   08390099
084000     05  PC-I                            PIC  X(01)  VALUE 'I'.   08400099
084100     05  PC-U                            PIC  X(01)  VALUE 'U'.   08410099
084200     05  PC-R                            PIC  X(01)  VALUE 'R'.   08420099
084300     05  PC-S                            PIC  X(01)  VALUE 'S'.   08430099
084400     05  PC-V                            PIC  X(01)  VALUE 'V'.   08440099
084500     05  PC-DS                           PIC  X(02)  VALUE 'DS'.  08450099
084600     05  PC-CS                           PIC  X(02)  VALUE 'CS'.  08460099
084700     05  PC-DC                           PIC  X(02)  VALUE 'DC'.  08470099
084800     05  PC-RV                           PIC  X(02)  VALUE 'RV'.  08480099
084900     05  PC-DASH                         PIC  X(01)  VALUE '-'.   08490099
085000     05  PC-KOHLS-OPERATING-COMPANY      PIC  X(02)  VALUE '03'.  08500099
085100     05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   08510099
085200                                                     COMP SYNC.   08520099
085300     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        08530099
085400                                              'PCKCS010'.         08540099
085500     05  PC-ROWS-PER-PAGE-32             PIC S9(04)  VALUE +32    08550099
085600                                                     COMP SYNC.   08560099
085700     05  PC-COLS-PER-PAGE                PIC S9(04)  VALUE +3     08570099
085800                                                     COMP SYNC.   08580099
085900     05  PC-MAX-STR-TBL-OCCURANCES       PIC S9(04)  VALUE +1500  08590099
086000                                                     COMP SYNC.   08600099
086100     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     08610099
086200                                                     COMP SYNC.   08620099
086300     05  PC-PUT                          PIC  X(03)  VALUE 'PUT'. 08630099
086400     05  PC-A                            PIC  X(02)  VALUE 'A'.   08640099
086500     05  PC-10                           PIC  X(02)  VALUE '10'.  08650099
086600     05  PC-TOP-OF-PAGE                  PIC  X(01)  VALUE '1'.   08660099
086700     05  PC-SINGLE-SPACE                 PIC  X(01)  VALUE ' '.   08670099
086800     05  PC-DOUBLE-SPACE                 PIC  X(01)  VALUE '0'.   08680099
086900     05  PC-MULTIPLE-SKU-PPK             PIC  X(21)  VALUE        08690099
087000         'M - MULTI SKU PREPACK'.                                 08700099
087100     05  PC-SINGLE-SKU-PPK               PIC  X(22)  VALUE        08710099
087200         'S - SINGLE SKU PREPACK'.                                08720099
087300     05  PC-INNER-PPK                    PIC  X(17)  VALUE        08730099
087400         'I - INNER PREPACK'.                                     08740099
087500     05  PC-BULK-PPK                     PIC  X(13)  VALUE        08750099
087600         'B - BULK PACK'.                                         08760099
087700     05  PC-CASEPACK                     PIC  X(12)  VALUE        08770099
087800         'C - CASEPACK'.                                          08780099
087900     05  PC-MULT-SPECIAL-INSTRS-MSG      PIC  X(100) VALUE        08790099
088000         'MULT SPECIAL INSTRUCTIONS EXIST, SEE ONLINE SYSTEM'.    08800099
088100     05  PC-MARKING-APRON-RPT-HDR        PIC  X(46)  VALUE        08810099
088200         '    M  A  R  K  I  N  G     A  P  R  O  N     '.        08820099
088300     05  PC-UPC-CERT-MSG                 PIC  X(36)  VALUE        08830099
088400         '**** UPC CERTIFICATION REQUIRED ****'.                  08840099
088500     05  PC-EXTERNAL-UPC-LOW          PIC S9(15)V                 08850099
088600                                      VALUE 000000000000000       08860099
088700                                      COMP-3.                     08870099
088800     05  PC-INTERNAL-UPC-LOW          PIC S9(15)V                 08880099
088900                                      VALUE 000399999999999       08890099
089000                                      COMP-3.                     08900099
089100     05  PC-INTERNAL-UPC-HIGH         PIC S9(15)V                 08910099
089200                                      VALUE 000500000000000       08920099
089300                                      COMP-3.                     08930099
089400     05  PC-EXTERNAL-UPC-HIGH         PIC S9(15)V                 08940099
089500                                      VALUE 999999999999999       08950099
089600                                      COMP-3.                     08960099
089700     05  PC-ABEND-MESSAGE                PIC  X(132) VALUE        08970099
089800          '  ***** ABEND   ABEND   ABEND   ABEND   ABEND ***'.    08980099
089900                                                                  08990099
090000     05  PC-CURRENT-DATE              PIC X(10) VALUE SPACE.      09000099
090100     05  PC-VS-HNGFLD-TYPE-CDE       PIC S9(04) COMP              09010099
090200                                                VALUE +10.        09020099
090300     05  PC-SUBCLASS-MDSELV-CDE      PIC  X(03) VALUE 'SCL'.      09030099
090400     05  PC-MAJCLASS-MDSELV-CDE      PIC X(03) VALUE 'MCL'.       09040099
090500     05  PC-DPT-MDSELV-CDE           PIC X(03) VALUE 'DPT'.       09050099
090600*                                                                 09060099
090700     05  PC-000                       PIC X(03) VALUE '000'.      09070099
090800     05  PC-999                       PIC X(03) VALUE '999'.      09080099
090900*                                                                 09090099
091000 01  PS-PROGRAM-SWITCHES.                                         09100099
091100     05  PS-UPDATES-DONE-SW              PIC  X      VALUE 'N'.   09110099
091200         88  PS-UPDATES-DONE                         VALUE 'Y'.   09120099
091300         88  PS-NO-UPDATES-DONE                      VALUE 'N'.   09130099
091400     05  PS-PRINT-NO-DISTRO-MSG-SW       PIC  X      VALUE 'N'.   09140099
091500         88  PS-PRINT-NO-DISTRO-MSG                  VALUE 'Y'.   09150099
091600         88  PS-DONT-PRINT-NO-DISTRO-MSG             VALUE 'N'.   09160099
091700     05  PS-PRINT-STORE-PROBLEM-SW       PIC  X      VALUE 'N'.   09170099
091800         88  PS-DONT-PRINT-STORE-PROBLEM             VALUE 'N'.   09180099
091900         88  PS-PRINT-STORE-PROBLEM                  VALUE 'Y'.   09190099
092000     05  PS-MORE-RECEIPT-SW              PIC  X      VALUE 'Y'.   09200099
092100         88  PS-NO-MORE-RECEIPT                      VALUE 'N'.   09210099
092200         88  PS-MORE-RECEIPT                         VALUE 'Y'.   09220099
092300     05  PS-REDISTRO-SW                  PIC  X      VALUE 'Y'.   09230099
092400         88  PS-NO-REDISTRO                          VALUE 'N'.   09240099
092500         88  PS-REDISTRO                             VALUE 'Y'.   09250099
092600     05  PS-MATCH-FOUND-SW               PIC  X      VALUE 'N'.   09260099
092700         88  PS-MATCH-FOUND                          VALUE 'Y'.   09270099
092800         88  PS-MATCH-NOT-FOUND                      VALUE 'N'.   09280099
092900     05  PS-SPECIAL-INSTRS-IND           PIC  X(01)  VALUE SPACE. 09290099
093000         88  PS-NO-SPECIAL-INSTRS-FOUND              VALUE 'N'.   09300099
093100         88  PS-MULT-SPECIAL-INSTRS-FOUND            VALUE 'Y'.   09310099
093200     05  PS-DIFF-OPER-UNIT-ID-IND        PIC  X(01)  VALUE 'N'.   09320099
093300         88  PS-DIFF-OPER-UNIT-ID                    VALUE 'Y'.   09330099
093400         88  PS-SAME-OPER-UNIT-ID                    VALUE 'N'.   09340099
093500     05  PS-VENDOR-REQ-CERT-IND          PIC X(1)    VALUE 'N'.   09350099
093600         88  PS-VENDOR-REQ-CERT                      VALUE 'Y'.   09360099
093700     05  PS-EOF-QUEUE-SW                 PIC  X(01)  VALUE 'N'.   09370099
093800         88  PS-EOF-QUEUE                            VALUE 'Y'.   09380099
093900     05  PS-FIRST-TIME-SW                PIC  X(01)  VALUE 'Y'.   09390099
094000         88  PS-FIRST-TIME                           VALUE 'Y'.   09400099
094100         88  PS-NOT-FIRST-TIME                       VALUE 'N'.   09410099
094200     05  PS-TOP-OF-PAGE-SET-SW           PIC  X(01)  VALUE 'N'.   09420099
094300         88  PS-TOP-OF-PAGE-SET                      VALUE 'Y'.   09430099
094400         88  PS-TOP-OF-PAGE-NOT-SET                  VALUE 'N'.   09440099
094500     05  PS-TVNDAGR-FOUND-SW             PIC X(01)   VALUE 'Y'.   09450099
094600         88  PS-NO-TVNDAGR                           VALUE 'N'.   09460099
094700     05  PS-TRECITM-FOUND-SW             PIC X(01)   VALUE 'Y'.   09470099
094800         88  PS-NO-TRECITM                           VALUE 'N'.   09480099
094900         88  PS-YES-TRECITM                          VALUE 'Y'.   09490099
095000     05  PS-RTV-DISTRO-SW                PIC X(01)   VALUE 'N'.   09500099
095100         88  PS-NO-RTV-DISTRO                        VALUE 'N'.   09510099
095200         88  PS-RTV-DISTRO                           VALUE 'Y'.   09520099
095300     05  PS-END-OF-DETAIL-SW             PIC X(01)   VALUE 'N'.   09530099
095400         88  PS-END-OF-DETAIL                        VALUE 'Y'.   09540099
095500         88  PS-NOT-END-OF-DETAIL                    VALUE 'N'.   09550099
095600     05  PS-RTV-PRINT-SW                 PIC X(01)   VALUE 'N'.   09560099
095700         88  PS-RTV-PRINT                            VALUE 'Y'.   09570099
095800         88  PS-NO-RTV-PRINT                         VALUE 'N'.   09580099
095900     05  PS-REPRINT-MSG-PRTED-SW         PIC X(01)   VALUE 'N'.   09590099
096000         88  PS-REPRINT-MSG-PRTED                    VALUE 'Y'.   09600099
096100         88  PS-NO-REPRINT-MSG-PRTED                 VALUE 'N'.   09610099
096200     05  PS-SHORTEN-LAST-PAGE-SW         PIC X(01)   VALUE 'N'.   09620099
096300         88  PS-SHORTEN-LAST-PAGE                    VALUE 'Y'.   09630099
096400         88  PS-DONT-SHORTEN-LAST-PAGE               VALUE 'N'.   09640099
096500     05  PS-VSM-SW                        PIC  X     VALUE 'N'.   09650099
096600         88  PS-NOT-VSM                              VALUE 'N'.   09660099
096700         88  PS-VSM                                  VALUE 'Y'.   09670099
096800*                                                                 09680099
096900     05  PS-CALL-API-SW               PIC  X    VALUE 'N'.        09690099
097000         88  PS-CALL-API-NO                     VALUE 'N'.        09700099
097100         88  PS-CALL-API-YES                    VALUE 'Y'.        09710099
097200                                                                  09720099
097300 01  PS-PROGRAM-SUBSCRIPTS.                                       09730099
097400     05  PS-DTL-LNE-SUB                  PIC S9(04)  VALUE +0     09740099
097500                                                     COMP SYNC.   09750099
097600     05  PS-COUNTER                      PIC S9(04)  VALUE +0     09760099
097700                                                     COMP SYNC.   09770099
097800     05  PS-PAGE-SUB                     PIC S9(04)  VALUE +0     09780099
097900                                                     COMP SYNC.   09790099
098000     05  PS-RTV-SUB                      PIC S9(04)  VALUE +0     09800099
098100                                                     COMP SYNC.   09810099
098200     05  STR-SUB                         PIC S9(04)  VALUE +0     09820099
098300                                                     COMP SYNC.   09830099
098400*                                                                 09840099
098500 01  PV-PROGRAM-VARIABLES.                                        09850099
098600     05  PV-ROWS-PER-PAGE                PIC S9(04)  VALUE +0     09860099
098700                                                     COMP SYNC.   09870099
098800     05  PV-STRS-PER-PAGE                PIC S9(04)  VALUE +0     09880099
098900                                                     COMP SYNC.   09890099
099000     05  PV-NUM-ITEMS                    PIC S9(4)   VALUE ZERO   09900099
099100                                                     COMP SYNC.   09910099
099200     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  09920099
099300                                                     COMP SYNC.   09930099
099400     05  PV-ITEM-NBR                     PIC S9(04) COMP.         09940099
099500     05  PV-STR-REC-QTY                  PIC S9(9) COMP.          09950099
099600     05  PV-STRS-ON-LAST-PAGE            PIC S9(9) COMP.          09960099
099700     05  PV-SUB-1                        PIC S9(4)   VALUE ZERO   09970099
099800                                                     COMP SYNC.   09980099
099900     05  PV-SUM-STR-PLAN-QTY             PIC S9(9)   COMP.        09990099
100000     05  PV-RETRY-COUNTER                PIC S9(4)   VALUE ZERO   10000099
100100                                                     COMP SYNC.   10010099
100200     05  PV-SUM-VERIFIED-QTY             PIC S9(09)  VALUE ZERO   10020099
100300                                                     COMP SYNC.   10030099
100400     05  PV-VERIFIED-IND                 PIC S9(04)  VALUE ZERO   10040099
100500                                                     COMP SYNC.   10050099
100600     05  PV-OTR                          PIC S9(09)  VALUE ZEROS. 10060099
100700     05  PV-UNION-IND                    PIC  X(01).              10070099
100800     05  PV-DB2-CURRENT-TMST             PIC  X(26).              10080099
100900     05  PV-REC-TMST                     PIC  X(26).              10090099
101000     05  PV-REC-TMST-R REDEFINES PV-REC-TMST.                     10100099
101100         10  FILLER                      PIC  X(02).              10110099
101200         10  PV-REC-YY                   PIC  X(02).              10120099
101300         10  FILLER                      PIC  X(01).              10130099
101400         10  PV-REC-MM                   PIC  X(02).              10140099
101500         10  FILLER                      PIC  X(01).              10150099
101600         10  PV-REC-DD                   PIC  X(02).              10160099
101700         10  FILLER                      PIC  X(16).              10170099
101800     05  PV-R-DATE.                                               10180099
101900         10  PV-R-MM                     PIC  X(02).              10190099
102000         10  PV-SLASH-1                  PIC  X(01) VALUE '/'.    10200099
102100         10  PV-R-DD                     PIC  X(02).              10210099
102200         10  PV-SLASH-1                  PIC  X(01) VALUE '/'.    10220099
102300         10  PV-R-YY                     PIC  X(02).              10230099
102400     05  PV-SELECT-COUNT                 PIC S9(08)  VALUE +0.    10240099
102500     05  PV-SELECT-COUNTER               PIC S9(04)  VALUE ZERO   10250099
102600                                                     COMP SYNC.   10260099
102700     05  PV-PAGES-REQ                    PIC  9(01)  VALUE ZEROS. 10270099
102800     05  PV-TOTAL-PAGES                  PIC  9(01)  VALUE ZEROS. 10280099
102900     05  PV-LAST-PAGE-COUNT              PIC S9(04)  VALUE ZEROS  10290099
103000                                                     COMP SYNC.   10300099
103100     05  PV-STR-NBR                      PIC S9(4)   VALUE +0     10310099
103200                                                     COMP.        10320099
103300     05  PV-DB2-COUNT                    PIC S9(9)   VALUE +0     10330099
103400                                                     COMP-3.      10340099
103500     05  PV-COUNT                        PIC S9(9)   VALUE +0     10350099
103600                                                     COMP-3.      10360099
103700     05  PV-EFF-CLOSE-DATE               PIC  X(10)  VALUE SPACES.10370099
103800     05  PV-DB2-CURRENT-DATE             PIC  X(10)  VALUE SPACES.10380099
103900     05  PV-FRMTD-DIFF-OPER-UNT-ID.                               10390099
104000         10  FILLER                      PIC  X(01)  VALUE '('.   10400099
104100         10  PV-DIFF-OPER-UNT-ID         PIC  9(04)  VALUE ZEROS. 10410099
104200         10  FILLER                      PIC  X(01)  VALUE ')'.   10420099
104300     05  PV-EXPTED-ITM-CNT               PIC  9(06)  VALUE ZEROS. 10430099
104400     05  PV-STARTING-IDX-LOCATION        PIC  9(03)  VALUE ZEROS. 10440099
104500     05  PV-STR-CNT                      PIC  9(03)  VALUE ZEROS. 10450099
104600     05  PV-STORES-GIVEN-PIECES          PIC  9(04)  VALUE ZEROS. 10460099
104700     05  PV-RTV-STORES                   PIC  9(04)  VALUE ZEROS. 10470099
104800     05  PV-TOT-EXPTED-ITM-CNT           PIC  9(09)  VALUE ZEROS. 10480099
104900     05  PV-TOT-RTV-EXPTED-ITM-CNT       PIC  9(09)  VALUE ZEROS. 10490099
105000     05  PV-TABLE-STORE-COUNT            PIC S9(05)  VALUE ZERO   10500099
105100                                                     COMP-3.      10510099
105200     05  PV-CICS-RESP                    PIC S9(8) VALUE ZERO     10520099
105300                                                COMP SYNC.        10530099
105400     05  PV-NULL-IND                  PIC S9(4) VALUE ZERO        10540099
105500                                                COMP SYNC.        10550099
105600     05  PV-SUBCLASS-NBR.                                         10560099
105700         10  FILLER                   PIC X(01) VALUE '0'.        10570099
105800         10  PV-SUBCLASS.                                         10580099
105900             15  PV-SUBCLASS-MAJ-NBR   PIC X(01).                 10590099
106000             15  PV-SUBCLASS-MIN-NBR  PIC X(01).                  10600099
106100     05  PV-MAJCLASS-NBR.                                         10610099
106200         10  PV-MAJCLASS-MAJ-NBR      PIC X(01).                  10620099
106300         10  FILLER                   PIC X(01) VALUE '0'.        10630099
106400     05  PV-CURRENT-DATE-X.                                       10640099
106500         10  PV-CURRENT-CENTURY-YEAR     PIC  9(04)  VALUE ZEROS. 10650099
106600         10  FILLER                      PIC  X(01)  VALUE '-'.   10660099
106700         10  PV-CURRENT-MONTH            PIC  9(02)  VALUE ZEROS. 10670099
106800         10  FILLER                      PIC  X(01)  VALUE '-'.   10680099
106900         10  PV-CURRENT-DAY              PIC  9(02)  VALUE ZEROS. 10690099
107000     05  PV-CURRENT-DATE  REDEFINES  PV-CURRENT-DATE-X            10700099
107100                                         PIC  X(10).              10710099
107200     05  PV-SQLCODE-NUMBER.                                       10720099
107300         10  FILLER                      PIC X(10)  VALUE         10730099
107400             'SQLCODE = '.                                        10740099
107500         10  PV-SQLCODE                  PIC +999.                10750099
107600     05  PV-DRS-ABEND-DISPLAY-LINE1.                              10760099
107700         10  FILLER                      PIC  X(14)  VALUE        10770099
107800             'DRRB ID = DRRB'.                                    10780099
107900         10  FILLER                      PIC  X(02)  VALUE SPACE. 10790099
108000         10  FILLER                      PIC  X(12)  VALUE        10800099
108100             'DRRB FUNC = '.                                      10810099
108200         10  PV-DRS-DRRB-FUNC            PIC  X(04)  VALUE SPACE. 10820099
108300         10  FILLER                      PIC  X(02)  VALUE SPACE. 10830099
108400         10  FILLER                      PIC  X(11)  VALUE        10840099
108500             'DRRB RID = '.                                       10850099
108600         10  PV-DRS-DRRB-RID             PIC  X(08)  VALUE SPACE. 10860099
108700         10  FILLER                      PIC  X(02)  VALUE SPACE. 10870099
108800         10  FILLER                      PIC  X(15)  VALUE        10880099
108900             'DRRB OPTIONS = '.                                   10890099
109000         10  PV-DRS-DRRB-OPTIONS         PIC  X(08)  VALUE SPACE. 10900099
109100     05  PV-DRS-ABEND-DISPLAY-LINE2.                              10910099
109200         10  FILLER                      PIC  X(10)  VALUE        10920099
109300             'DRRB RC = '.                                        10930099
109400         10  PV-DRS-DRRB-RC              PIC  X(04)  VALUE SPACE. 10940099
109500         10  FILLER                      PIC  X(02)  VALUE SPACE. 10950099
109600         10  FILLER                      PIC  X(18)  VALUE        10960099
109700             'DRRB ATTR-ERROR = '.                                10970099
109800         10  PV-DRS-ATTR-ERROR           PIC  X(02)  VALUE SPACE. 10980099
109900         10  FILLER                      PIC  X(02)  VALUE SPACE. 10990099
110000         10  FILLER                      PIC  X(12)  VALUE        11000099
110100             'DRRB DRDC = '.                                      11010099
110200         10  PV-DRS-DRRB-DRDC            PIC  X(04)  VALUE SPACE. 11020099
110300         10  FILLER                      PIC  X(02)  VALUE SPACE. 11030099
110400         10  FILLER                      PIC  X(13)  VALUE        11040099
110500             'DRRB LINES = '.                                     11050099
110600         10  PV-DRS-DRRB-LINES           PIC  X(04)  VALUE SPACE. 11060099
110700     05  PV-DISPLAY-ITEM-NBR             PIC  9(15)  VALUE ZEROS. 11070099
110800     05  PV-DISPLAY-ENT-ID               PIC  9(09)  VALUE ZEROS. 11080099
110900     05  PV-DISPLAY-KEYS.                                         11090099
111000         10  PV-DISPLAY-ORD-NBR          PIC  9(09)  VALUE ZEROS  11100099
111100                                                BLANK WHEN ZEROS. 11110099
111200         10  FILLER                      PIC  X(02)  VALUE SPACE. 11120099
111300         10  PV-DISPLAY-RCVR-SEQ-NBR     PIC  9(09)  VALUE ZEROS  11130099
111400                                                BLANK WHEN ZEROS. 11140099
111500         10  FILLER                      PIC  X(02)  VALUE SPACE. 11150099
111600         10  PV-DISPLAY-ORD-LNE-NBR      PIC  9(04)  VALUE ZEROS  11160099
111700                                                BLANK WHEN ZEROS. 11170099
111800         10  FILLER                      PIC  X(02)  VALUE SPACE. 11180099
111900         10  PV-DISPLAY-WORK-ORD-SEQ-NBR PIC  9(04)  VALUE ZEROS  11190099
112000                                                BLANK WHEN ZEROS. 11200099
112100         10  FILLER                      PIC  X(02)  VALUE SPACE. 11210099
112200         10  PV-DISPLAY-OPER-UNT-ID      PIC  9(04)  VALUE ZEROS  11220099
112300                                                BLANK WHEN ZEROS. 11230099
112400         10  FILLER                      PIC  X(02)  VALUE SPACE. 11240099
112500         10  PV-DISPLAY-FCLTY-ID         PIC  9(04)  VALUE ZEROS  11250099
112600                                                BLANK WHEN ZEROS. 11260099
112700     05  PV-GP-QTY                       PIC  9(03)  VALUE ZEROS. 11270099
112800     05  PV-GROUP-PRICE-NUMERIC-EDIT     PIC ZZ,ZZZ.ZZ.           11280099
112900     05  PV-GROUP-PRICE-NUMERIC-EDIT-X  REDEFINES                 11290099
113000             PV-GROUP-PRICE-NUMERIC-EDIT PIC  X(09).              11300099
113100     05  PV-MAX-GROUP-PRICE-DIGITS       PIC  9(04)V9(02)         11310099
113200                                                     VALUE ZEROS. 11320099
113300     05  PV-EFF-DATE                     PIC  X(10)  VALUE SPACE. 11330099
113400     05  FILLER  REDEFINES  PV-EFF-DATE.                          11340099
113500         10  PV-EFF-DATE-CENTURY         PIC  X(02).              11350099
113600         10  PV-EFF-DATE-YEAR            PIC  X(02).              11360099
113700         10  FILLER                      PIC  X(01).              11370099
113800         10  PV-EFF-MONTH                PIC  X(02).              11380099
113900         10  FILLER                      PIC  X(01).              11390099
114000         10  PV-EFF-DAY                  PIC  X(02).              11400099
114100*                                                                 11410099
114200     05  PV-PRC-FCLTY-AREA-ID         PIC  X(06)  VALUE SPACES.   11420099
114300     05  PV-RETRY-COUNT               PIC  S9(4)  VALUE ZERO      11430099
114400                                                  COMP SYNC.      11440099
114500*                                                                 11450099
114600*  USED FOR COMPUTING SORTATION CONTROL NUMBER CHECK DIGIT        11460099
114700     05  PV-CNTL-NBR-X                   PIC  X(13)  VALUE SPACE. 11470099
114800     05  PV-CNTL-NBR  REDEFINES  PV-CNTL-NBR-X                    11480099
114900                                         PIC  9(13).              11490099
115000     05  FILLER  REDEFINES  PV-CNTL-NBR.                          11500099
115100         10  PV-CNTL-NBR-DIGIT           PIC  9(01)               11510099
115200                                         OCCURS 13 TIMES          11520099
115300                                         INDEXED BY               11530099
115400                                         PV-DIGIT-IDX.            11540099
115500     05  PV-CNTL-NBR-PRODUCT             PIC  9(02)  VALUE ZEROS. 11550099
115600     05  FILLER  REDEFINES  PV-CNTL-NBR-PRODUCT.                  11560099
115700         10  PV-PRODUCT-DIGIT            PIC 9(01)                11570099
115800                                         OCCURS 2 TIMES.          11580099
115900     05  PV-CHECK-SUM                    PIC  9(03)  VALUE ZEROS. 11590099
116000     05  FILLER  REDEFINES  PV-CHECK-SUM.                         11600099
116100         10  FILLER                      PIC  9(02).              11610099
116200         10  PV-CKSUM-LEAST-SIGNIFICANT-DGT                       11620099
116300                                         PIC  9(01).              11630099
116400     05  PV-CHECK-DIGIT                  PIC  9(01)  VALUE ZEROS. 11640099
116500                                                                  11650099
116600 01  PV-CICS-MSG-AREA.                                            11660099
116700     05  FILLER                          PIC X(20) VALUE          11670099
116800                 '** PCKCS010 ** TASK='.                          11680099
116900     05  PV-TASK-NUMBER                  PIC Z(08).               11690099
117000     05  FILLER                          PIC X(07) VALUE          11700099
117100                 ' TIME= '.                                       11710099
117200     05  PV-TIME                         PIC X(08).               11720099
117300     05  FILLER                          PIC X(09) VALUE          11730099
117400         ' QUEUE = '.                                             11740099
117500     05  PV-QUEUE-NAME.                                           11750099
117600         10  PV-ADDRESS                  PIC X(4)  VALUE SPACES.  11760099
117700         10  PV-TASK                     PIC 9(5)  VALUE ZERO.    11770099
117800         10  PV-LAST-NUMBER              PIC X(1)  VALUE SPACES.  11780099
117900     05  FILLER                          PIC X(1)  VALUE SPACES.  11790099
118000     05  PV-CICS-MESSAGE                 PIC X(55) VALUE SPACES.  11800099
118100                                                                  11810099
118200                                                                  11820099
118300 01  ST-SYSTEM-TIME-DATE-AREA.                                    11830099
118400     05  ST-ABSTIME                      PIC S9(15)  VALUE ZERO   11840099
118500                                                     COMP-3.      11850099
118600     05  ST-SYSTEM-TIME.                                          11860099
118700         10  ST-HHMMSS-FORMAT            PIC  X(08)  VALUE SPACE. 11870099
118800         10  FILLER  REDEFINES  ST-HHMMSS-FORMAT.                 11880099
118900             15  ST-SYSTEM-HOUR          PIC  X(02).              11890099
119000             15  FILLER                  PIC  X(01).              11900099
119100             15  ST-SYSTEM-MINUTE        PIC  X(02).              11910099
119200             15  FILLER                  PIC  X(01).              11920099
119300             15  ST-SYSTEM-SECOND        PIC  X(02).              11930099
119400     05  SD-SYSTEM-DATE.                                          11940099
119500         10  SD-MMDDYY-FORMAT            PIC  X(08)  VALUE SPACE. 11950099
119600         10  FILLER  REDEFINES  SD-MMDDYY-FORMAT.                 11960099
119700             15  SD-SYSTEM-MONTH         PIC  X(02).              11970099
119800             15  FILLER                  PIC  X(01).              11980099
119900             15  SD-SYSTEM-DAY           PIC  X(02).              11990099
120000             15  FILLER                  PIC  X(01).              12000099
120100             15  SD-SYSTEM-YEAR          PIC  X(02).              12010099
120200         10  FILLER                      PIC  X(02)  VALUE SPACE. 12020099
120300     05  FILLER  REDEFINES  SD-SYSTEM-DATE.                       12030099
120400         10  FILLER                      PIC  X(06).              12040099
120500         10  SD-SYSTEM-CENTURY-YEAR      PIC  9(04).              12050099
120600     05  SD-YYYY-FORMAT                  PIC S9(09)  VALUE +0     12060099
120700                                                     COMP.        12070099
120800*                                                                 12080099
120900*  THIS TABLE WILL CONSIST OF ALL STORES OPEN FOR RECEIVING       12090099
121000*  FOR THE CURRENT DATE, FOR A GIVEN DISTRIBUTION CENTER.         12100099
121100*                                                                 12110099
121200 01  ST-STORE-TABLE.                                              12120099
121300                                                                  12130099
121400     05  ST-STORE-ENTRY                  OCCURS 1 TO 1500 TIMES   12140099
121500                                         DEPENDING ON             12150099
121600                                            PV-TABLE-STORE-COUNT  12160099
121700                                         ASCENDING KEY IS         12170099
121800                                            ST-STR-NBR            12180099
121900                                         INDEXED BY ST-STR-IDX.   12190099
122000         10  ST-STR-NBR                  PIC S9(4) COMP.          12200099
122100         10  ST-CHAR5-ABBR-NAME          PIC X(5).                12210099
122200         10  ST-DC-NMBR                  PIC 9(4).                12220099
122300         10  ST-DC-RCT-START-DATE        PIC X(10).               12230099
122400         10  ST-DC-RCT-STOP-DATE         PIC X(10).               12240099
122500*                                                                 12250099
122600*  THIS TABLE WILL CONSIST OF ONLY THOSE STORES WHICH HAVE AN     12260099
122700*  EXPECTED ITEM COUNT. IT IS USED FOR PRINTING THE STORE DETAIL  12270099
122800*  LINE INFORMATION.                                              12280099
122900*                                                                 12290099
123000 01  EA-EXPTED-ALLOC-TABLE.                                       12300099
123100     05  EA-ALLOC-ENTRY                  OCCURS 1500 TIMES        12310099
123200                                         INDEXED BY EA-ALLOC-IDX. 12320099
123300         10  EA-STR-NBR                  PIC  9(04).              12330099
123400         10  EA-CHAR5-ABBR-NAME          PIC  X(05).              12340099
123500         10  EA-EXPTED-ITM-CNT           PIC  9(06).              12350099
123600         10  EA-DIFF-OPER-UNT-ID         PIC  X(06).              12360099
123700         10  EA-ITEMS-OPEN-TO-RECEIVE    PIC  X(06).              12370099
123800         10  EA-CLOSED-IND               PIC  X(01).              12380099
123900             88  EA-STR-OPEN                  VALUE SPACE.        12390099
124000             88  EA-STR-CLOSED                VALUE '*'.          12400099
124100                                                                  12410099
124200 01  RA-RTV-ALLOC-TABLE.                                          12420099
124300     05  RA-ALLOC-ENTRY                  OCCURS 3 TIMES           12430099
124400                                         INDEXED BY RA-ALLOC-IDX. 12440099
124500         10  RA-STR-NBR                  PIC  9(04).              12450099
124600         10  RA-CHAR5-ABBR-NAME          PIC  X(05).              12460099
124700         10  RA-EXPTED-ITM-CNT           PIC  9(06).              12470099
124800         10  RA-DIFF-OPER-UNT-ID         PIC  X(06).              12480099
124900         10  RA-ITEMS-OPEN-TO-RECEIVE    PIC  X(06).              12490099
125000         10  RA-CLOSED-IND               PIC  X(01).              12500099
125100             88  RA-STR-OPEN                  VALUE SPACE.        12510099
125200             88  RA-STR-CLOSED                VALUE '*'.          12520099
125300                                                                  12530099
125400*                                                                 12540099
125500 01  TL-BARCODE-LINE.                                             12550099
125600     05  FILLER                          PIC X(15)  VALUE         12560099
125700         '^M0101000^T0010'.                                       12570099
125800     05  FILLER                          PIC X(26)   VALUE        12580099
125900         'TOTAL STORES GIVEN ALLOCS:'.                            12590099
126000     05  FILLER                          PIC X(05)   VALUE SPACE. 12600099
126100     05  TL1-TOT-STR-GIVEN               PIC Z,ZZ9   VALUE ZERO.  12610099
126200     05  FILLER                          PIC X(19)   VALUE        12620099
126300         '^M0505000^T0750^BNZ'.                                   12630099
126400     05  TL-BARCODE-KEYREC-1             PIC X(08)   VALUE SPACES.12640099
126500     05  TL-BARCODE-REC-SEQ-1            PIC X(3)    VALUE SPACES.12650099
126600     05  TL-BARCODE-LINE-NMBR-X-1        PIC X(4)    VALUE SPACES.12660099
126700     05  TL-BARCODE-LINE-NMBR-1 REDEFINES TL-BARCODE-LINE-NMBR-X-112670099
126800                                         PIC 9(04).               12680099
126900     05  FILLER                          PIC X(4)    VALUE '^G^-'.12690099
127000                                                                  12700099
127100 01  TL-NO-BARCODE-LINE.                                          12710099
127200     05  FILLER                          PIC X(26)   VALUE        12720099
127300         'TOTAL STORES GIVEN ALLOCS:'.                            12730099
127400     05  FILLER                          PIC X(05)   VALUE SPACE. 12740099
127500     05  TL1-TOT-STR-GIVEN-NB            PIC Z,ZZ9   VALUE ZERO.  12750099
127600                                                                  12760099
127700 01 TL2-TOTAL-LINE-2.                                             12770099
127800     05  FILLER                          PIC X(15)  VALUE         12780099
127900         '^M0101000^T0010'.                                       12790099
128000     05  FILLER                          PIC  X(26)  VALUE        12800099
128100         'TOTAL EXPECTED ITEM COUNT:'.                            12810099
128200     05  FILLER                          PIC  X(01)  VALUE SPACE. 12820099
128300     05  TL2-TOT-EXPTED-ITM-CNT          PIC Z,ZZZ,ZZ9.           12830099
128400* TRANSLATED TEXT                                                 12840099
128500     05  FILLER                          PIC X(15)  VALUE         12850099
128600         '^M0101000^T0750'.                                       12860099
128700     05  TL-BARCODE-KEYREC               PIC X(08)   VALUE SPACES.12870099
128800     05  FILLER                          PIC X(01)   VALUE SPACE. 12880099
128900     05  TL-BARCODE-REC-SEQ              PIC X(3)    VALUE SPACES.12890099
129000     05  FILLER                          PIC X(01)   VALUE SPACE. 12900099
129100     05  TL-BARCODE-LINE-NMBR-X          PIC X(4)    VALUE SPACES.12910099
129200     05  TL-BARCODE-LINE-NMBR  REDEFINES  TL-BARCODE-LINE-NMBR-X  12920099
129300                                         PIC 9(04).               12930099
129400     05  FILLER                          PIC X(01)   VALUE SPACE. 12940099
129500*  SORTATION CONTROL NUMBER BARCODE                               12950099
129600     05  FILLER                          PIC X(19)   VALUE        12960099
129700         '^M0705000^T1000^BYZ'.                                   12970099
129800     05  TL-SORT-CONTROL-NBR.                                     12980099
129900         10 TL-SORT-KEYREC               PIC 9(08)   VALUE ZERO.  12990099
130000         10 TL-SORT-LINE-NBR             PIC 9(3)    VALUE ZERO.  13000099
130100         10 TL-SEQ-NBR                   PIC 9(2)    VALUE ZERO.  13010099
130200         10 TL-SORT-CHKDGT               PIC 9(1)    VALUE ZERO.  13020099
130300     05  FILLER                          PIC X(4)    VALUE '^G^-'.13030099
130400                                                                  13040099
130500 01 TL2-TOTAL-LINE-2-2.                                           13050099
130600     05  FILLER                          PIC X(15)  VALUE         13060099
130700         '^M0101000^T0010'.                                       13070099
130800     05  FILLER                          PIC  X(26)  VALUE        13080099
130900         'TOTAL EXPECTED ITEM COUNT:'.                            13090099
131000     05  FILLER                          PIC  X(01)  VALUE SPACE. 13100099
131100     05  TL2-TOT-EXPTED-ITM-CNT-2        PIC Z,ZZZ,ZZ9.           13110099
131200* TRANSLATED TEXT                                                 13120099
131300     05  FILLER                          PIC X(15)  VALUE         13130099
131400         '^M0101000^T0750'.                                       13140099
131500     05  TL-BARCODE-KEYREC-2             PIC X(08)   VALUE SPACES.13150099
131600     05  FILLER                          PIC X(01)   VALUE SPACE. 13160099
131700     05  TL-BARCODE-REC-SEQ-2            PIC X(3)    VALUE SPACES.13170099
131800     05  FILLER                          PIC X(01)   VALUE SPACE. 13180099
131900     05  TL-BARCODE-LINE-NMBR-X-2        PIC X(4)    VALUE SPACES.13190099
132000     05  TL-BARCODE-LINE-NMBR-2                                   13200099
132100         REDEFINES  TL-BARCODE-LINE-NMBR-X-2                      13210099
132200                                         PIC 9(04).               13220099
132300     05  FILLER                          PIC X(01)   VALUE SPACE. 13230099
132400     05  FILLER                          PIC X(4)    VALUE '^G^-'.13240099
132500                                                                  13250099
132600 01 TL2-TOTAL-LINE-2-NO-BARCODE.                                  13260099
132700     05  FILLER                          PIC  X(26)  VALUE        13270099
132800         'TOTAL EXPECTED ITEM COUNT:'.                            13280099
132900     05  FILLER                          PIC  X(01)  VALUE SPACE. 13290099
133000     05  TL2-TOT-EXPTED-ITM-CNT-NB       PIC Z,ZZZ,ZZ9.           13300099
133100                                                                  13310099
133200                                                                  13320099
133300                                                                  13330099
133400 EJECT                                                            13340099
133500*                                                                 13350099
133600*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) COMMAREA            13360099
133700*                                                                 13370099
133800     COPY DRRD001O.                                               13380099
133900                                                                  13390099
134000*                                                                 13400099
134100*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) DETAIL LINES        13410099
134200*                                                                 13420099
134300     COPY DRRD002O.                                               13430099
134400                                                                  13440099
134500 EJECT                                                            13450099
134600*LMM - 1/27/05 -BEGIN                                             13460099
134700*    COPY PEWS049.                                                13470099
134800*LMM - 1/27/05 -END                                               13480099
134900 EJECT                                                            13490099
135000*                                                                 13500099
135100*  SQL DB2 STORE TABLE CURSOR DECLARATION                         13510099
135200*                                                                 13520099
135300                                                                  13530099
135400     EXEC SQL                                                     13540099
135500         DECLARE STR-NBR-CSR  CURSOR FOR                          13550099
135600             SELECT A.LOC_NBR                                     13560099
135700                  , A.LOC_5_ABBR_NM                               13570099
135800                  , A.CLO_DTE                                     13580099
135900                  , A.CLO_DTE -                                   13590099
136000                            COALESCE(A.STP_ORD_DAYS_QTY,0) DAYS   13600099
136100                            AS EFF_STOP_DATE                      13610099
136200                  , B.EFF_BEG_DTE                                 13620099
136300                  , B.DC_NBR                                      13630099
136400               FROM XLT_LOC A                                     13640099
136500                  , XLT_DC_LOC_ASGMT B                            13650099
136600              WHERE A.LOC_TYP_CDE IN ('DS', 'DC', 'CS', 'RV')     13660099
136700                AND B.LOC_NBR     = A.LOC_NBR                     13670099
136800                AND B.EFF_BEG_DTE =                               13680099
136900                (SELECT MAX(C.EFF_BEG_DTE)                        13690099
137000                   FROM XLT_DC_LOC_ASGMT C                        13700099
137100                  WHERE C.LOC_NBR = A.LOC_NBR                     13710099
137200                    AND DATE(EFF_BEG_DTE) <= CURRENT DATE         13720099
137300                )                                                 13730099
137400           ORDER BY A.LOC_NBR                                     13740099
137500     END-EXEC.                                                    13750099
137600                                                                  13760099
137700                                                                  13770099
137800*                                                                 13780099
137900*  SQL DB2 RECEIPT ITEM DISTRIBUTION CURSOR DECLARATION           13790099
138000*                                                                 13800099
138100     EXEC SQL                                                     13810099
138200          DECLARE RECDIS-CSR CURSOR FOR                           13820099
138300              SELECT  'A',                                        13830099
138400                      A.STR_NBR,                                  13840099
138500                      A.EXPTED_ITM_QTY                            13850099
138600                FROM  TRECDIS A                                   13860099
138700                    , XLT_LOC B                                   13870099
138800               WHERE  (A.ORD_NBR           =  :DK-ORD-NBR         13880099
138900                 AND   A.ORD_LNE_NBR       =  :DK-ORD-LNE-NBR     13890099
139000                 AND   A.REC_SEQ_NBR       =  :DK-RCVR-SEQ-NBR    13900099
139100                 AND   A.OPER_UNT_ID       =  :DK-OPER-UNT-ID     13910099
139200                 AND   A.FCLTY_ID          =  :DK-FCLTY-ID        13920099
139400                 AND   A.STR_NBR           =  B.LOC_NBR           13940099
139500                 AND   B.LOC_TYP_CDE     IN (:PC-DS, :PC-CS))     13950099
139600      UNION                                                       13960099
139700              SELECT  'B',                                        13970099
139800                      A.STR_NBR,                                  13980099
139900                      A.EXPTED_ITM_QTY                            13990099
140000                FROM  TRECDIS A                                   14000099
140100                    , XLT_LOC B                                   14010099
140200               WHERE  (A.ORD_NBR           =  :DK-ORD-NBR         14020099
140300                 AND   A.ORD_LNE_NBR       =  :DK-ORD-LNE-NBR     14030099
140400                 AND   A.REC_SEQ_NBR       =  :DK-RCVR-SEQ-NBR    14040099
140500                 AND   A.OPER_UNT_ID       =  :DK-OPER-UNT-ID     14050099
140600                 AND   A.FCLTY_ID          =  :DK-FCLTY-ID        14060099
140800                 AND   A.STR_NBR           =  B.LOC_NBR           14080099
140900                 AND   A.EXPTED_ITM_QTY    >  :PC-ZERO            14090099
141000                 AND   B.LOC_TYP_CDE     IN (:PC-DC, :PC-RV))     14100099
141100            ORDER BY  1, 2                                        14110099
141200     END-EXEC.                                                    14120099
141300                                                                  14130099
141400*                                                                 14140099
141500*  SQL DB2 LINE LOCATION CURSOR DECLARATION                       14150099
141600*                                                                 14160099
141700     EXEC SQL                                                     14170099
141800          DECLARE LNELOC-CSR CURSOR FOR                           14180099
141900              SELECT  STRT_TMST,                                  14190099
142000                      LNE_LOC_CDE,                                14200099
142100                      SCREEN_SEQ_NBR                              14210099
142200                FROM  TWKORIN                                     14220099
142300               WHERE  (ORD_NBR           =  :DK-ORD-NBR           14230099
142400                 AND   RCVR_SEQ_NBR      =  :DK-RCVR-SEQ-NBR      14240099
142500                 AND   ORD_LNE_NBR       =  :DK-ORD-LNE-NBR       14250099
142600                 AND   WORK_ORD_SEQ_NBR  =  :DK-WORK-ORD-SEQ-NBR  14260099
142700                 AND   OPER_UNT_ID       =  :DK-OPER-UNT-ID       14270099
142800                 AND   FCLTY_ID          =  :DK-FCLTY-ID          14280099
142900                 AND   VER_STATUS_CDE    =  'A')                  14290099
143000            ORDER BY  SCREEN_SEQ_NBR                              14300099
143100     END-EXEC.                                                    14310099
143200                                                                  14320099
143300*                                                                 14330099
143400*  SQL DB2 TROUBLE RECORD CURSOR DECLARATION                      14340099
143500*                                                                 14350099
143600     EXEC SQL                                                     14360099
143700          DECLARE TRBL-CSR1 CURSOR FOR                            14370099
143800              SELECT  B.TRBL_LONG_DESC                            14380099
143900                FROM  TTRBNTF A                                   14390099
144000                    , TTRBRSN B                                   14400099
144100               WHERE  (A.PO_NBR          =  :DK-ORD-NBR           14410099
144200                 AND   A.PO_LNE_NBR      =  :DK-ORD-LNE-NBR       14420099
144300                 AND   A.REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR      14430099
144400                 AND   A.OPER_UNT_ID     =  :DK-OPER-UNT-ID       14440099
144500*                AND   A.FCLTY_ID        =  :DK-FCLTY-ID          14450099
144600                 AND   A.RESOLVED_IND    IN ('N', 'I')            14460099
144700                 AND   A.TRBL_RSN_CDE    =  B.TRBL_RSN_CDE)       14470099
144800     END-EXEC.                                                    14480099
144900                                                                  14490099
145000                                                                  14500099
145100     EXEC SQL                                                     14510099
145200          DECLARE TRBL-CSR2 CURSOR FOR                            14520099
145300              SELECT  B.TRBL_LONG_DESC,                           14530099
145400                      A.RESOLVED_IND                              14540099
145500                FROM  TTRBNTF A                                   14550099
145600                    , TTRBRSN B                                   14560099
145700               WHERE  (A.PO_NBR          =  :DK-ORD-NBR           14570099
145800                 AND   A.PO_LNE_NBR      =  :DK-ORD-LNE-NBR       14580099
145900                 AND   A.REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR      14590099
146000                 AND   A.OPER_UNT_ID     =  :DK-OPER-UNT-ID       14600099
146100                 AND   A.TRBL_RSN_CDE    =  B.TRBL_RSN_CDE        14610099
146200                 AND   B.NOTIF_IND       =  :PC-T)                14620099
146300     END-EXEC.                                                    14630099
146400******************************************************************14640099
146500*  TWKORIN CURSOR                                                *14650099
146600******************************************************************14660099
146700*    EXEC SQL                                                     14670099
146800*         DECLARE TWKORIN-CSR CURSOR FOR                          14680099
146900*            SELECT ORD_NBR                                       14690099
147000*                  ,RCVR_SEQ_NBR                                  14700099
147100*                  ,ORD_LNE_NBR                                   14710099
147200*                  ,OPER_UNT_ID                                   14720099
147300*                  ,WORK_ORD_SEQ_NBR                              14730099
147400*                  ,FCLTY_AREA_ID                                 14740099
147500*                  ,STRT_TMST                                     14750099
147600*                  ,STOP_TMST                                     14760099
147700*                  ,PRC_FCLTY_AREA_ID                             14770099
147800*                  ,SCREEN_SEQ_NBR                                14780099
147900*            FROM   TWKORIN                                       14790099
148000*            WHERE ORD_NBR            = :DK-ORD-NBR               14800099
148100*              AND RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR          14810099
148200*              AND ORD_LNE_NBR        = :DK-ORD-LNE-NBR           14820099
148300*              AND WORK_ORD_SEQ_NBR   = 1                         14830099
148400*              AND OPER_UNT_ID        = :DK-OPER-UNT-ID           14840099
148500*              AND VER_STATUS_CDE     = 'A'                       14850099
148600*            ORDER BY SCREEN_SEQ_NBR                              14860099
148700*    END-EXEC.                                                    14870099
148800*                                                                 14880099
148900*                                                                 14890099
149000******************************************************************14900099
149100*  TWKORIN CURSOR - FOR LINE NUMBER = ZERO                       *14910099
149200******************************************************************14920099
149300*    EXEC SQL                                                     14930099
149400*         DECLARE WKORIN0-CSR CURSOR FOR                          14940099
149500*            SELECT ORD_NBR                                       14950099
149600*                  ,RCVR_SEQ_NBR                                  14960099
149700*                  ,ORD_LNE_NBR                                   14970099
149800*                  ,OPER_UNT_ID                                   14980099
149900*                  ,WORK_ORD_SEQ_NBR                              14990099
150000*                  ,FCLTY_AREA_ID                                 15000099
150100*                  ,STRT_TMST                                     15010099
150200*                  ,STOP_TMST                                     15020099
150300*                  ,PRC_FCLTY_AREA_ID                             15030099
150400*                  ,SCREEN_SEQ_NBR                                15040099
150500*            FROM   TWKORIN                                       15050099
150600*            WHERE ORD_NBR            = :DK-ORD-NBR               15060099
150700*              AND RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR          15070099
150800*              AND ORD_LNE_NBR        = 0                         15080099
150900*              AND WORK_ORD_SEQ_NBR   = 1                         15090099
151000*              AND OPER_UNT_ID        = :DK-OPER-UNT-ID           15100099
151100*              AND VER_STATUS_CDE     = 'A'                       15110099
151200*            ORDER BY SCREEN_SEQ_NBR                              15120099
151300*    END-EXEC.                                                    15130099
151400/                                                                 15140099
151500     COPY DPWS276.                                                15150099
151600 01  PV-SAVE-OTR-AREA.                                            15160099
151700     05  PV-SAVE-OTR-TABLE OCCURS 3 TIMES                         15170099
151800             INDEXED BY PV-SAVE-OTR-IDX.                          15180099
151900         10 PV-OTR-DIST          PIC 9(4).                        15190099
152000         10 PV-SAVE-OTR          PIC X(32000).                    15200099
152100*        10 PV-SAVE-OTR          PIC X(23000).                    15210099
152200* THIS TABLE HOLDS THE OTR TABLES FOR UP TO 3 D.C.'S.             15220099
152300/                                                                 15230099
152400******************************************************************15240099
152500 LINKAGE SECTION.                                                 15250099
152600******************************************************************15260099
152700 01  DFHCOMMAREA.                                                 15270099
152800     05  FILLER                       OCCURS 1 TO 600 TIMES       15280099
152900                                      DEPENDING ON EIBCALEN.      15290099
153000         10  FILLER                   PIC X.                      15300099
153100                                                                  15310099
153200 PROCEDURE DIVISION.                                              15320099
153300                                                                  15330099
153400     MOVE EIBTASKN        TO  PV-TASK-NUMBER                      15340099
153500                                                                  15350099
153600                                                                  15360099
153700     PERFORM 1000-INITIALIZE.                                     15370099
153800                                                                  15380099
153900     PERFORM 2000-PROCESS-QUEUE-REC                               15390099
154000              UNTIL PS-EOF-QUEUE.                                 15400099
154100                                                                  15410099
154200     IF CA-LINE-NBR (1) NOT = 0                                   15420099
154300         PERFORM 7900-START-TRANID-E014                           15430099
154400     END-IF.                                                      15440099
154500                                                                  15450099
154600 0000-GOBACK.                                                     15460099
154700                                                                  15470099
154800     GOBACK.                                                      15480099
154900 EJECT                                                            15490099
155000 1000-INITIALIZE.                                                 15500099
155100* SETUP KEY FIELDS                                                15510099
155200     INITIALIZE CA-PCKCS014-COMMAREA.                             15520099
155300     MOVE DFHCOMMAREA           TO CA-COMMAREA.                   15530099
155400     MOVE CA-ORD-NBR            TO DK-ORD-NBR.                    15540099
155500     MOVE CA-RCVR-SEQ-NBR       TO DK-RCVR-SEQ-NBR.               15550099
155600     MOVE CA-OPER-UNT-ID        TO DK-OPER-UNT-ID.                15560099
155700     MOVE CA-FCLTY-ID           TO DK-FCLTY-ID.                   15570099
155800     MOVE CA-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN.         15580099
155900                                                                  15590099
156000                                                                  15600099
156100*  THIS RESTORES THE DRIB WORK AREAS THAT WERE INITIALIZED        15610099
156200*  IN PCKCS013                                                    15620099
156300     MOVE CA-DRIB-AREA(1:264)   TO DRS01-COMMAREA.                15630099
156400     MOVE CA-DRIB-AREA(265:216) TO DRS02-DRIB.                    15640099
156500                                                                  15650099
156600                                                                  15660099
156700* SETUP DATE AND TIME FOR REPORT HEADERS                          15670099
156800     EXEC CICS                                                    15680099
156900         ASKTIME ABSTIME (ST-ABSTIME)                             15690099
157000     END-EXEC.                                                    15700099
157100     EXEC CICS                                                    15710099
157200         FORMATTIME ABSTIME  (ST-ABSTIME)                         15720099
157300                    MMDDYY   (SD-MMDDYY-FORMAT)                   15730099
157400                    DATESEP                                       15740099
157500                    TIME     (ST-HHMMSS-FORMAT)                   15750099
157600                    TIMESEP                                       15760099
157700     END-EXEC.                                                    15770099
157800     EXEC CICS                                                    15780099
157900         FORMATTIME ABSTIME  (ST-ABSTIME)                         15790099
158000                       YEAR  (SD-YYYY-FORMAT)                     15800099
158100     END-EXEC.                                                    15810099
158200     MOVE SD-YYYY-FORMAT  TO  PV-CURRENT-CENTURY-YEAR.            15820099
158300     MOVE SD-SYSTEM-MONTH TO  PV-CURRENT-MONTH.                   15830099
158400     MOVE SD-SYSTEM-DAY   TO  PV-CURRENT-DAY.                     15840099
158500                                                                  15850099
158600     SET ST-STR-IDX                                               15860099
158700         LINE-IDX                                                 15870099
158800         EA-ALLOC-IDX                                             15880099
158900         RA-ALLOC-IDX TO 1.                                       15890099
159000     INITIALIZE EA-EXPTED-ALLOC-TABLE                             15900099
159100                RA-RTV-ALLOC-TABLE.                               15910099
159200                                                                  15920099
159300*  BUILD TABLE OF STORES                                          15930099
159400     PERFORM 7000-OPEN-STR-NBR-CSR.                               15940099
159500     PERFORM 7010-FETCH-STR-NBR-CSR.                              15950099
159600                                                                  15960099
159700     PERFORM 1200-LOAD-STR-NBR-TBL                                15970099
159800         VARYING ST-STR-IDX FROM 1 BY 1                           15980099
159900         UNTIL SQLCODE = PC-ROW-NOT-FOUND                         15990099
160000         OR ST-STR-IDX > PC-MAX-STR-TBL-OCCURANCES.               16000099
160100     IF ST-STR-IDX > PC-MAX-STR-TBL-OCCURANCES                    16010099
160200         PERFORM 7020-CLOSE-STR-NBR-CSR                           16020099
160300         MOVE '1200-LOAD-STR-NBR-TBL'                             16030099
160400             TO DP013-PARAGRAPH                                   16040099
160500         MOVE 'STR TBL OVERFLOW.  MAX OCCURANCES IS: '            16050099
160600             TO DP013-MESSAGE-TEXT (1)                            16060099
160700         MOVE PC-MAX-STR-TBL-OCCURANCES                           16070099
160800             TO DP013-MESSAGE-TEXT (2)                            16080099
160900         SET DP013-LOGIC-ABEND TO TRUE                            16090099
161000         SET DP013-NO-ROLLBACK TO TRUE                            16100099
161100         PERFORM 9999-WRITE-CICS-LOG-MSG                          16110099
161200         GO TO 0000-GOBACK                                        16120099
161300     END-IF.                                                      16130099
161400     PERFORM 7020-CLOSE-STR-NBR-CSR.                              16140099
161500                                                                  16150099
161600                                                                  16160099
161700**************************************************************    16170099
161800* GET REPORT HEADER INFORMATION                                   16180099
161900**************************************************************    16190099
162000                                                                  16200099
162100                                                                  16210099
162200     PERFORM 7100-SELECT-PO-HDR-DATA.                             16220099
162300     MOVE CA-ORD-NBR-X           TO  HL5-PO-NBR.                  16230099
162400     MOVE PURCHS-DEPT-NBR        TO  HL5-DEPT-NBR.                16240099
162500                                                                  16250099
162600     PERFORM 7110-GET-KEYREC-NBR.                                 16260099
162700     MOVE SPACES                 TO  HL11-PACK-TYPE-DESC          16270099
162800     EVALUATE TRUE                                                16280099
162900         WHEN RECEIV-PKGNG-CDE = PC-M                             16290099
163000             MOVE PC-MULTIPLE-SKU-PPK                             16300099
163100                                 TO  HL11-PACK-TYPE-DESC          16310099
163200         WHEN RECEIV-PKGNG-CDE = PC-S                             16320099
163300             MOVE PC-SINGLE-SKU-PPK                               16330099
163400                                 TO  HL11-PACK-TYPE-DESC          16340099
163500         WHEN RECEIV-PKGNG-CDE = PC-I                             16350099
163600             MOVE PC-INNER-PPK                                    16360099
163700                                 TO  HL11-PACK-TYPE-DESC          16370099
163800         WHEN RECEIV-PKGNG-CDE = PC-B                             16380099
163900             MOVE PC-BULK-PPK    TO  HL11-PACK-TYPE-DESC          16390099
164000         WHEN RECEIV-PKGNG-CDE = PC-C                             16400099
164100             MOVE PC-CASEPACK    TO  HL11-PACK-TYPE-DESC          16410099
164200     END-EVALUATE.                                                16420099
164300     MOVE RECEIV-RCVR-NBR        TO  HL4-KEYREC.                  16430099
164400     MOVE RECEIV-EXPTED-CART-CNT TO  HL5-TOT-CARTON-CNT.          16440099
164500     MOVE RECEIV-ACTL-CART-CNT   TO  HL6-TOT-CARTON-CNT.          16450099
164600     MOVE RECEIV-GOH-IND         TO  HL8-HANGER.                  16460099
164700     MOVE PV-REC-MM              TO  PV-R-MM.                     16470099
164800     MOVE PV-REC-DD              TO  PV-R-DD.                     16480099
164900     MOVE PV-REC-YY              TO  PV-R-YY.                     16490099
165000     MOVE PV-R-DATE              TO  HL7-REC-DATE                 16500099
165100                                                                  16510099
165200     PERFORM 7120-GET-PRIMARY-VNDR-NME.                           16520099
165300     MOVE ENTNME-ENT-NAME-DESC   TO  HL4-VNDR-NME.                16530099
165400     MOVE CA-DESTINATION         TO  HL4-PRINTER-DEST.            16540099
165500                                                                  16550099
165600*  THIS PARAGRAPH SETS A SWITCH FOR USE IN THE DETAIL LINES       16560099
165700     PERFORM 7130-GET-CERT-INFO.                                  16570099
165800                                                                  16580099
165900     PERFORM 7140-GET-SPECIAL-INSTRS.                             16590099
166000     EVALUATE TRUE                                                16600099
166100     WHEN PS-NO-SPECIAL-INSTRS-FOUND                              16610099
166200             CONTINUE                                             16620099
166300     WHEN PS-MULT-SPECIAL-INSTRS-FOUND                            16630099
166400         MOVE PC-MULT-SPECIAL-INSTRS-MSG  TO  HL14-SPECIAL-INSTR  16640099
166500     WHEN OTHER                                                   16650099
166600         MOVE INSTCD-INSTR-DESC       TO  HL14-SPECIAL-INSTR      16660099
166700     END-EVALUATE.                                                16670099
166800                                                                  16680099
166900                                                                  16690099
167000* GET THE FIRST TS QUEUE RECORD FOR PROCESSING                    16700099
167100     MOVE +1                  TO PV-ITEM-NBR.                     16710099
167200     PERFORM 9100-READ-SEL-QUEUE                                  16720099
167300     IF PS-EOF-QUEUE                                              16730099
167400         NEXT SENTENCE                                            16740099
167500     ELSE                                                         16750099
167600         SET PC016-IDX        TO 1                                16760099
167700     END-IF.                                                      16770099
167800                                                                  16780099
167900* LOAD KEY FIELDS FROM THE QUEUE RECORD FIRST OCCURRENCE          16790099
168000     EVALUATE TRUE                                                16800099
168100     WHEN PS-EOF-QUEUE                                            16810099
168200         CONTINUE                                                 16820099
168300     WHEN PC016-ITEM (PC016-IDX) > ZERO                           16830099
168400         MOVE PC016-PO-NBR-N (PC016-IDX)                          16840099
168500                                 TO DK-ORD-NBR                    16850099
168600                                    CA-ORD-NBR                    16860099
168700        MOVE PC016-REC-SEQ-NBR-N (PC016-IDX)                      16870099
168800                                 TO DK-RCVR-SEQ-NBR               16880099
168900                                    CA-RCVR-SEQ-NBR               16890099
169000        MOVE PC016-LINE-NBR-N (PC016-IDX)                         16900099
169100                                 TO DK-ORD-LNE-NBR                16910099
169200                                    CA-ORD-LNE-NBR                16920099
169300        MOVE PC016-WO-NBR-N(PC016-IDX) TO  DK-WORK-ORD-SEQ-NBR    16930099
169400                                           CA-WORK-ORD-SEQ-NBR    16940099
169500        MOVE PC016-OPER-UNT-ID (PC016-IDX)                        16950099
169600                                 TO DK-OPER-UNT-ID                16960099
169700                                    CA-OPER-UNT-ID                16970099
169800        MOVE PC016-FCLTY-ID (PC016-IDX)                           16980099
169900                                 TO DK-FCLTY-ID                   16990099
170000                                    CA-FCLTY-ID                   17000099
170100                                                                  17010099
170200       MOVE CA-OPER-UNT-ID       TO  HL2-OPERATING-ID             17020099
170300       MOVE CA-FCLTY-ID          TO  HL2-FACILITY-ID              17030099
170400                                                                  17040099
170500       PERFORM 4050-SELECT-PRIM-SHIP                              17050099
170600                                                                  17060099
170700       MOVE CA-RCVR-SEQ-NBR-X    TO  HL6-RCVR-SEQ-NBR             17070099
170800       MOVE CA-ORD-LNE-NBR-X     TO  HL7-LINE-NBR                 17080099
170900       MOVE CA-WORK-ORD-SEQ-NBR-X                                 17090099
171000                                 TO HL8-WORK-ORD-NBR              17100099
171100                                                                  17110099
171200        INITIALIZE EA-EXPTED-ALLOC-TABLE                          17120099
171300                   RA-RTV-ALLOC-TABLE                             17130099
171400        MOVE ZERO  TO  PV-TOT-EXPTED-ITM-CNT                      17140099
171500                       PV-STORES-GIVEN-PIECES                     17150099
171600                       PV-TOT-RTV-EXPTED-ITM-CNT                  17160099
171700                       PV-STR-CNT                                 17170099
171800                       PV-RTV-STORES                              17180099
171900        SET EA-ALLOC-IDX                                          17190099
172000            RA-ALLOC-IDX         TO 1                             17200099
172100                                                                  17210099
172200     WHEN PC016-ITEM (PC016-IDX) NOT > ZERO                       17220099
172300        SET PS-EOF-QUEUE         TO TRUE                          17230099
172400     END-EVALUATE.                                                17240099
172500/                                                                 17250099
172600 1200-LOAD-STR-NBR-TBL.                                           17260099
172700                                                                  17270099
172800     MOVE XLT00010-LOC-NBR       TO ST-STR-NBR (ST-STR-IDX)       17280099
172900     MOVE XLT00010-LOC-5-ABBR-NM TO ST-CHAR5-ABBR-NAME            17290099
173000                                   (ST-STR-IDX)                   17300099
173100                                                                  17310099
173200     MOVE XLT00014-DC-NBR        TO ST-DC-NMBR (ST-STR-IDX)       17320099
173300     MOVE XLT00014-EFF-BEG-DTE   TO ST-DC-RCT-START-DATE          17330099
173400                                   (ST-STR-IDX)                   17340099
173500     MOVE PV-EFF-CLOSE-DATE      TO ST-DC-RCT-STOP-DATE           17350099
173600                                   (ST-STR-IDX)                   17360099
173700                                                                  17370099
173800     ADD +1                      TO PV-TABLE-STORE-COUNT          17380099
173900                                                                  17390099
174000     PERFORM 7010-FETCH-STR-NBR-CSR.                              17400099
174100     EJECT                                                        17410099
174200 2000-PROCESS-QUEUE-REC.                                          17420099
174300                                                                  17430099
174400     SET PS-DONT-PRINT-NO-DISTRO-MSG                              17440099
174500         PS-DONT-PRINT-STORE-PROBLEM                              17450099
174600         PS-DONT-SHORTEN-LAST-PAGE                                17460099
174700         PS-NO-UPDATES-DONE      TO TRUE.                         17470099
174800                                                                  17480099
174900                                                                  17490099
175000     PERFORM 7200-SELECT-PURITM-DATA.                             17500099
175100     MOVE PURITM-SKU-DESC        TO  HL9-LNE-ITM-DESC.            17510099
175200     MOVE PURITM-SIZE-DESC       TO  HL10-SIZE-DESC.              17520099
175300     MOVE PURITM-COLOR-DESC      TO  HL11-COLOR-DESC.             17530099
175400     MOVE PURITM-UNT-RTL-PR-AMT  TO  HL12-UNT-RTL-PR-AMT.         17540099
175500     MOVE PURITM-VEND-STYL-NAME  TO  HL10-VNDR-STYLE-NME.         17550099
175600     IF PURITM-PIC-ITM-IND = PC-Y OR PC-N                         17560099
175700         MOVE PURITM-PIC-ITM-IND TO  HL10-PIC-ITM-IND             17570099
175800     ELSE                                                         17580099
175900         MOVE PC-N               TO  HL10-PIC-ITM-IND.            17590099
176000     MOVE RECITM-TKT-FMT-ID      TO  DK-TKT-FMT-ID.               17600099
176100     MOVE RECITM-PRE-TKT-IND     TO  HL13A-PRETICKET-IND          17610099
176200     PERFORM 4300-GET-TKT-DESC.                                   17620099
176300     PERFORM 4310-GET-TKT-PLACEMENT.                              17630099
176400*----------------------------------------------------------------*17640099
176500     INITIALIZE XL001-ITEM-COMMAREA.                              17650099
176600                                                                  17660099
176700     IF    PS-CALL-API-YES                AND                     17670099
176800        ((PURITM-SKU-SEQ-NBR NOT = PC-000 AND                     17680099
176900          PURITM-SKU-SEQ-NBR NOT = PC-999))                       17690099
177000                                                                  17700099
177100         PERFORM 7205-CALL-CICS-API-ARCH                          17710099
177200     ELSE                                                         17720099
177300         MOVE ZEROES TO HL5-SEQ-NBR                               17730099
177400                        HL12-BOX-ID                               17740099
177500         MOVE SPACES TO HL8-SKU-DESC                              17750099
177600                        HL6-SIZE                                  17760099
177700                        HL7-COLOR                                 17770099
177800                        HL9-VNDR-STYLE-NME                        17780099
177900                        HL9-PRESENTATION                          17790099
178000                        HL5-CLASS-NBR                             17800099
178100         IF PURITM-SKU-SEQ-NBR = PC-000                           17810099
178200            MOVE '00000000'      TO  HL5-SEQ-NBR                  17820099
178300         ELSE                                                     17830099
178400            IF PURITM-SKU-SEQ-NBR = PC-999                        17840099
178500               MOVE '99999999'      TO  HL5-SEQ-NBR               17850099
178600            END-IF                                                17860099
178700         END-IF                                                   17870099
178800     END-IF                                                       17880099
178900                                                                  17890099
179000**** WHEN THE STICKER-NBR  IS ZEROS, WE WANT THE BOX ID ON THE    17900099
179100**** MARKING APRON TO BE BLANK, TO PREVENT CONFUSION THAT ZEROS   17910099
179200**** ARE A VALID STICKER NBR (WHICH THEY ARE NOT)                 17920099
179300                                                                  17930099
179400     IF XL001-SKU-SQLCODE = PC-ROW-NOT-FOUND                      17940099
179500         PERFORM 7220-SELECT-TRECITM                              17950099
179600         MOVE RECITM-SIZE-DESC       TO  HL6-SIZE                 17960099
179700         MOVE RECITM-COLOR-DESC      TO  HL7-COLOR                17970099
179800     ELSE                                                         17980099
179900         MOVE XL001-SIZE-DESC        TO  HL6-SIZE                 17990099
180000         MOVE XL001-CSTM-CLOR-DESC   TO  HL7-COLOR                18000099
180100     END-IF.                                                      18010099
180200                                                                  18020099
180300                                                                  18030099
180400     PERFORM 2100-FIND-LNE-LOC.                                   18040099
180500                                                                  18050099
180600     PERFORM 2200-PO-LINE-TRBL.                                   18060099
180700                                                                  18070099
180800     PERFORM 2230-PO-LINE-TRBL.                                   18080099
180900                                                                  18090099
181000     INITIALIZE PV-SAVE-OTR-AREA.                                 18100099
181100     SET PV-SAVE-OTR-IDX         TO 1.                            18110099
181200     SEARCH PV-SAVE-OTR-TABLE                                     18120099
181300     WHEN PC016-OPER-UNT-ID (PC016-IDX) = PV-OTR-DIST             18130099
181400                                         (PV-SAVE-OTR-IDX)        18140099
181500         CONTINUE                                                 18150099
181600     WHEN PV-OTR-DIST(PV-SAVE-OTR-IDX) = ZERO                     18160099
181700         MOVE PC016-OPER-UNT-ID (PC016-IDX)                       18170099
181800                                 TO PV-OTR-DIST(PV-SAVE-OTR-IDX)  18180099
181900         PERFORM 4200-CALC-OPEN-TO-REC                            18190099
182000         MOVE DP276-OTR-TABLE TO PV-SAVE-OTR (PV-SAVE-OTR-IDX)    18200099
182100     END-SEARCH.                                                  18210099
182200                                                                  18220099
182300                                                                  18230099
182400     SET PS-NO-RTV-DISTRO                                         18240099
182500         PS-NO-RTV-PRINT TO TRUE.                                 18250099
182600     PERFORM 2500-GET-RECDIS-DATA.                                18260099
182700     IF PS-RTV-DISTRO                                             18270099
182800         IF CA-PRINT-MRKG-APRON-HDR                               18280099
182900             CONTINUE                                             18290099
183000         ELSE                                                     18300099
183100             MOVE CA-ORD-LNE-NBR-X     TO CA-LINE-NBR (LINE-IDX)  18310099
183200             SET LINE-IDX UP BY 1                                 18320099
183300         END-IF                                                   18330099
183400     END-IF.                                                      18340099
183500                                                                  18350099
183600                                                                  18360099
183700*    PERFORM 2600-UPC-CERTIFICATION.                              18370099
183800                                                                  18380099
183900     PERFORM 7410-SELECT-MKING-TMST.                              18390099
184000                                                                  18400099
184100     MOVE PC-ROWS-PER-PAGE-32       TO PV-ROWS-PER-PAGE.          18410099
184200                                                                  18420099
184300     IF PS-PRINT-STORE-PROBLEM                                    18430099
184400         SUBTRACT 2 FROM PV-ROWS-PER-PAGE                         18440099
184500     END-IF.                                                      18450099
184600                                                                  18460099
184700     IF PS-YES-TRECITM AND                                        18470099
184800        RECITM-MKING-APRON-TMST NOT = PC-DB2-DUMMY-DATE-TIME      18480099
184900         SUBTRACT 2 FROM PV-ROWS-PER-PAGE                         18490099
185000     END-IF.                                                      18500099
185100                                                                  18510099
185200     IF TL2-TRBL-DESC (1) = SPACES                                18520099
185300         CONTINUE                                                 18530099
185400     ELSE                                                         18540099
185500         SUBTRACT 2 FROM PV-ROWS-PER-PAGE                         18550099
185600     END-IF.                                                      18560099
185700                                                                  18570099
185800     PERFORM 4040-COUNT-RTV-DISTROS.                              18580099
185900     IF PV-COUNT > 0                                              18590099
186000         SUBTRACT 2 FROM PV-ROWS-PER-PAGE                         18600099
186100     END-IF.                                                      18610099
186200                                                                  18620099
186300     COMPUTE PV-STRS-PER-PAGE =                                   18630099
186400             (PV-ROWS-PER-PAGE * PC-COLS-PER-PAGE)                18640099
186500     COMPUTE PV-PAGES-REQ =                                       18650099
186600         (((PV-STR-CNT - 1) / PV-STRS-PER-PAGE) + 1).             18660099
186700                                                                  18670099
186800     MOVE PV-STR-CNT TO PV-STRS-ON-LAST-PAGE.                     18680099
186900     PERFORM UNTIL PV-STRS-ON-LAST-PAGE <= PV-STRS-PER-PAGE       18690099
187000         IF PV-STRS-ON-LAST-PAGE > PV-STRS-PER-PAGE               18700099
187100             SUBTRACT PV-STRS-PER-PAGE                            18710099
187200                               FROM PV-STRS-ON-LAST-PAGE          18720099
187300         END-IF                                                   18730099
187400     END-PERFORM.                                                 18740099
187500     IF PS-RTV-DISTRO AND                                         18750099
187600        PV-STRS-ON-LAST-PAGE <                                    18760099
187700                  (PV-STRS-PER-PAGE - (PC-COLS-PER-PAGE * 3))     18770099
187800         SET PS-SHORTEN-LAST-PAGE TO TRUE                         18780099
187900     END-IF.                                                      18790099
188000                                                                  18800099
188100     MOVE PV-PAGES-REQ TO PV-TOTAL-PAGES.                         18810099
188200     IF PS-RTV-DISTRO                                             18820099
188300         COMPUTE PV-LAST-PAGE-COUNT =                             18830099
188400             (PV-STR-CNT -                                        18840099
188500                 ((PV-PAGES-REQ - 1) * PV-STRS-PER-PAGE))         18850099
188600         IF PV-LAST-PAGE-COUNT > (PV-ROWS-PER-PAGE - 2) AND       18860099
188700             PS-DONT-SHORTEN-LAST-PAGE                            18870099
188800             ADD PC-ONE  TO PV-TOTAL-PAGES                        18880099
188900         END-IF                                                   18890099
189000     END-IF.                                                      18900099
189100     SET PS-NOT-END-OF-DETAIL TO TRUE.                            18910099
189200                                                                  18920099
189300     PERFORM 4000-PRODUCE-RPT                                     18930099
189400         VARYING PS-PAGE-SUB                                      18940099
189500         FROM 1 BY 1                                              18950099
189600         UNTIL PS-PAGE-SUB > PV-PAGES-REQ.                        18960099
189700                                                                  18970099
189800     IF PS-RTV-DISTRO AND                                         18980099
189900        PS-NO-RTV-PRINT                                           18990099
190000         SET PS-END-OF-DETAIL TO TRUE                             19000099
190100         PERFORM 4000-PRODUCE-RPT                                 19010099
190200         ADD PC-ONE TO PS-PAGE-SUB                                19020099
190300     END-IF.                                                      19030099
190400                                                                  19040099
190500     IF RECITM-MKING-APRON-TMST = PC-DB2-DUMMY-DATE-TIME AND      19050099
190600        TL2-TRBL-DESC (1) = SPACES                                19060099
190700         PERFORM 7420-UPDATE-TRECITM-TMST                         19070099
190800     END-IF.                                                      19080099
190900                                                                  19090099
191000     IF PS-UPDATES-DONE                                           19100099
191100         EXEC CICS                                                19110099
191200             SYNCPOINT                                            19120099
191300         END-EXEC                                                 19130099
191400                                                                  19140099
191500     END-IF.                                                      19150099
191600                                                                  19160099
191700* GET THE NEXT QUEUE RECORD                                       19170099
191800     PERFORM 9200-GET-NEXT-PO.                                    19180099
191900                                                                  19190099
192000                                                                  19200099
192100 EJECT                                                            19210099
192200******************************************************************19220099
192300*  DETERMINE THE CURRENT LINE LOCATION.                           19230099
192400******************************************************************19240099
192500 2100-FIND-LNE-LOC.                                               19250099
192600     PERFORM 7230-OPEN-LNELOC-CSR.                                19260099
192700     PERFORM 7240-FETCH-LNELOC-CSR.                               19270099
192800     PERFORM 2110-DETERMINE-LOC-LOC                               19280099
192900         UNTIL SQLCODE = PC-ROW-NOT-FOUND.                        19290099
193000     PERFORM 7250-CLOSE-LNELOC-CSR.                               19300099
193100*                                                                 19310099
193200******************************************************************19320099
193300*  THE CURRENT LINE LOCATION WILL HAVE A STARTING TIME STAMP      19330099
193400*  EQUAL TO THE DUMMY DATE.                                       19340099
193500******************************************************************19350099
193600 2110-DETERMINE-LOC-LOC.                                          19360099
193700     IF WKORIN-STRT-TMST  =  PC-DB2-DUMMY-DATE                    19370099
193800         CONTINUE                                                 19380099
193900     ELSE                                                         19390099
194000         MOVE WKORIN-LNE-LOC-CDE  TO  HL3-LNE-LOC                 19400099
194100     END-IF.                                                      19410099
194200     PERFORM 7240-FETCH-LNELOC-CSR.                               19420099
194300     EJECT                                                        19430099
194400 2200-PO-LINE-TRBL.                                               19440099
194500     PERFORM 7260-OPEN-TRBL-CSR.                                  19450099
194600     PERFORM 7270-FETCH-TRBL-CSR.                                 19460099
194700     INITIALIZE TL2-TROUBLE-LINE-2.                               19470099
194800     PERFORM 2210-LOAD-TRBL-TBL                                   19480099
194900         VARYING TRBL-IDX FROM 1 BY 1                             19490099
195000         UNTIL SQLCODE = PC-ROW-NOT-FOUND                         19500099
195100         OR TRBL-IDX > 5.                                         19510099
195200     PERFORM 7280-CLOSE-TRBL-CSR.                                 19520099
195300                                                                  19530099
195400******************************************************************19540099
195500*  LOAD THE TROUBLE DESCRIPTION INTO THE TROUBLE LINE.            19550099
195600******************************************************************19560099
195700 2210-LOAD-TRBL-TBL.                                              19570099
195800     MOVE TRBRSN-TRBL-LONG-DESC TO TL2-TRBL-DESC (TRBL-IDX).      19580099
195900     PERFORM 7270-FETCH-TRBL-CSR.                                 19590099
196000     EJECT                                                        19600099
196100 2230-PO-LINE-TRBL.                                               19610099
196200     PERFORM 7265-OPEN-TRBL-CSR2.                                 19620099
196300     PERFORM 7275-FETCH-TRBL-CSR2.                                19630099
196400     INITIALIZE TL3-TROUBLE-LINE-3.                               19640099
196500     PERFORM 2240-LOAD-TRBL-TBL2                                  19650099
196600         VARYING TRBL-IDX2 FROM 1 BY 1                            19660099
196700         UNTIL SQLCODE = PC-ROW-NOT-FOUND                         19670099
196800         OR TRBL-IDX2 > 5.                                        19680099
196900     PERFORM 7285-CLOSE-TRBL-CSR2.                                19690099
197000                                                                  19700099
197100******************************************************************19710099
197200*  LOAD THE TROUBLE DESCRIPTION INTO THE TROUBLE LINE.            19720099
197300******************************************************************19730099
197400 2240-LOAD-TRBL-TBL2.                                             19740099
197500     MOVE TRBRSN-TRBL-LONG-DESC TO TL3-TRBL-DESC (TRBL-IDX2).     19750099
197600     MOVE PC-DASH               TO TL3-DASH (TRBL-IDX2).          19760099
197700     IF TRBNTF-RESOLVED-IND = (PC-N OR PC-I)                      19770099
197800         MOVE PC-U              TO TL3-TRBL-IND (TRBL-IDX2)       19780099
197900     ELSE                                                         19790099
198000         MOVE PC-R              TO TL3-TRBL-IND (TRBL-IDX2)       19800099
198100     END-IF.                                                      19810099
198200     PERFORM 7275-FETCH-TRBL-CSR2.                                19820099
198300     EJECT                                                        19830099
198400******************************************************************19840099
198500*  THIS MODULE RETRIEVES DATA FROM THE RECEIPT ITEM DISTRIBUTION  19850099
198600*  TABLE.  THE RECEIPT ITEM DISTRIBUTION TABLE IS ACCESSED WHEN   19860099
198700*  THE WORK ORDER DISTRIBUTION INDICATOR IS EQUAL TO A 'N'.       19870099
198800******************************************************************19880099
198900 2500-GET-RECDIS-DATA.                                            19890099
199000     PERFORM 7320-OPEN-RECDIS-CSR.                                19900099
199100     PERFORM 7330-FETCH-RECDIS-CSR.                               19910099
199200     PERFORM 2510-PROCESS-RECDIS-ROWS                             19920099
199300         UNTIL SQLCODE = PC-ROW-NOT-FOUND.                        19930099
199400     PERFORM 7340-CLOSE-RECDIS-CSR.                               19940099
199500*                                                                 19950099
199600 2510-PROCESS-RECDIS-ROWS.                                        19960099
199700     MOVE RECDIS-STR-NBR         TO  PV-STR-NBR.                  19970099
199800     MOVE RECDIS-EXPTED-ITM-QTY  TO  PV-EXPTED-ITM-CNT.           19980099
199900     IF PV-UNION-IND = PC-A                                       19990099
200000         SET EA-STR-OPEN(EA-ALLOC-IDX)                            20000099
200100             PS-SAME-OPER-UNIT-ID      TO TRUE                    20010099
200200     ELSE                                                         20020099
200300         SET RA-STR-OPEN(RA-ALLOC-IDX)                            20030099
200400             PS-SAME-OPER-UNIT-ID      TO TRUE                    20040099
200500     END-IF                                                       20050099
200600                                                                  20060099
200700     SEARCH ALL ST-STORE-ENTRY                                    20070099
200800         AT END                                                   20080099
200900             IF PV-UNION-IND = PC-A                               20090099
201000                 SET EA-STR-CLOSED(EA-ALLOC-IDX)                  20100099
201100                     PS-PRINT-STORE-PROBLEM                       20110099
201200                                     TO TRUE                      20120099
201300             ELSE                                                 20130099
201400                 SET RA-STR-CLOSED(RA-ALLOC-IDX)                  20140099
201500                     PS-PRINT-STORE-PROBLEM                       20150099
201600                                     TO TRUE                      20160099
201700             END-IF                                               20170099
201800         WHEN ST-STR-NBR (ST-STR-IDX) = PV-STR-NBR                20180099
201900             PERFORM 2511-CHECK-IF-OPEN                           20190099
202000             PERFORM 2520-FILL-PRINT-TBL                          20200099
202100     END-SEARCH.                                                  20210099
202200                                                                  20220099
202300     PERFORM 7330-FETCH-RECDIS-CSR.                               20230099
202400 2511-CHECK-IF-OPEN.                                              20240099
202500     EVALUATE TRUE                                                20250099
202600     WHEN ST-DC-NMBR (ST-STR-IDX) = CA-OPER-UNT-ID                20260099
202700         IF  (PV-CURRENT-DATE NOT < ST-DC-RCT-START-DATE          20270099
202800                                  (ST-STR-IDX))                   20280099
202900             AND                                                  20290099
203000             (PV-CURRENT-DATE NOT > ST-DC-RCT-STOP-DATE           20300099
203100                                  (ST-STR-IDX))                   20310099
203200             CONTINUE                                             20320099
203300         ELSE                                                     20330099
203400             IF PV-UNION-IND = PC-A                               20340099
203500                 SET EA-STR-CLOSED(EA-ALLOC-IDX)                  20350099
203600                     PS-PRINT-STORE-PROBLEM                       20360099
203700                                     TO TRUE                      20370099
203800             ELSE                                                 20380099
203900                 SET RA-STR-CLOSED(RA-ALLOC-IDX)                  20390099
204000                     PS-PRINT-STORE-PROBLEM                       20400099
204100                                     TO TRUE                      20410099
204200             END-IF                                               20420099
204300         END-IF                                                   20430099
204400     WHEN OTHER                                                   20440099
204500*DIFFERENT OPER UNIT                                              20450099
204600         SET PS-DIFF-OPER-UNIT-ID TO TRUE                         20460099
204700     END-EVALUATE.                                                20470099
204800                                                                  20480099
204900                                                                  20490099
205000******************************************************************20500099
205100*  MOVE THE NECESSARY FIELDS TO THE WORKING STORAGE TABLE USED    20510099
205200*  FOR PRINTING THE REPORT.                                       20520099
205300******************************************************************20530099
205400 2520-FILL-PRINT-TBL.                                             20540099
205500     IF PV-UNION-IND = PC-A                                       20550099
205600         PERFORM 2530-INSERT-TO-EA-TABLE                          20560099
205700     ELSE                                                         20570099
205800         SET PS-RTV-DISTRO TO TRUE                                20580099
205900         PERFORM 2540-INSERT-TO-RA-TABLE                          20590099
206000     END-IF.                                                      20600099
206100 2530-INSERT-TO-EA-TABLE.                                         20610099
206200     MOVE PV-STR-NBR             TO EA-STR-NBR (EA-ALLOC-IDX)     20620099
206300     MOVE ST-CHAR5-ABBR-NAME (ST-STR-IDX)                         20630099
206400                                 TO EA-CHAR5-ABBR-NAME            20640099
206500                                   (EA-ALLOC-IDX)                 20650099
206600                                                                  20660099
206700     IF PS-DIFF-OPER-UNIT-ID                                      20670099
206800         MOVE ST-DC-NMBR (ST-STR-IDX)                             20680099
206900                                 TO PV-DIFF-OPER-UNT-ID           20690099
207000         MOVE PV-FRMTD-DIFF-OPER-UNT-ID                           20700099
207100                                 TO EA-DIFF-OPER-UNT-ID           20710099
207200                                    (EA-ALLOC-IDX)                20720099
207300         IF PV-DIFF-OPER-UNT-ID = SPACES OR ZERO                  20730099
207400             CONTINUE                                             20740099
207500         ELSE                                                     20750099
207600             SET PV-SAVE-OTR-IDX TO 1                             20760099
207700             SEARCH PV-SAVE-OTR-TABLE                             20770099
207800                 WHEN PV-DIFF-OPER-UNT-ID = PV-OTR-DIST           20780099
207900                                         (PV-SAVE-OTR-IDX)        20790099
208000                      MOVE PV-SAVE-OTR (PV-SAVE-OTR-IDX)          20800099
208100                                 TO DP276-OTR-TABLE               20810099
208200                 WHEN PV-OTR-DIST(PV-SAVE-OTR-IDX) = ZERO         20820099
208300                     MOVE PV-DIFF-OPER-UNT-ID                     20830099
208400                                 TO PV-OTR-DIST(PV-SAVE-OTR-IDX)  20840099
208500                     PERFORM 4200-CALC-OPEN-TO-REC                20850099
208600                     MOVE DP276-OTR-TABLE                         20860099
208700                                 TO                               20870099
208800                          PV-SAVE-OTR (PV-SAVE-OTR-IDX)           20880099
208900             END-SEARCH                                           20890099
209000         END-IF                                                   20900099
209100     ELSE                                                         20910099
209200         SET PV-SAVE-OTR-IDX TO 1                                 20920099
209300         SEARCH PV-SAVE-OTR-TABLE                                 20930099
209400             WHEN PC016-OPER-UNT-ID (PC016-IDX) = PV-OTR-DIST     20940099
209500                                     (PV-SAVE-OTR-IDX)            20950099
209600                 MOVE PV-SAVE-OTR (PV-SAVE-OTR-IDX)               20960099
209700                                 TO DP276-OTR-TABLE               20970099
209800         END-SEARCH                                               20980099
209900     END-IF.                                                      20990099
210000                                                                  21000099
210100     MOVE PV-STR-NBR            TO DP276-SEARCH-NBR               21010099
210200     PERFORM 4210-SEARCH-OTR                                      21020099
210300     MOVE DP276-OTR-OUT         TO PV-OTR                         21030099
210400     MOVE DP276-OTR-OUT-X       TO EA-ITEMS-OPEN-TO-RECEIVE       21040099
210500                                   (EA-ALLOC-IDX)                 21050099
210600                                                                  21060099
210700     IF DP276-NO-DISTRO                                           21070099
210800         SET PS-PRINT-NO-DISTRO-MSG TO TRUE                       21080099
210900     END-IF.                                                      21090099
211000                                                                  21100099
211100                                                                  21110099
211200     MOVE PV-EXPTED-ITM-CNT                                       21120099
211300         TO  EA-EXPTED-ITM-CNT (EA-ALLOC-IDX).                    21130099
211400     COMPUTE  PV-TOT-EXPTED-ITM-CNT  =                            21140099
211500         PV-EXPTED-ITM-CNT  +  PV-TOT-EXPTED-ITM-CNT.             21150099
211600     ADD 1  TO  PV-STORES-GIVEN-PIECES.                           21160099
211700                                                                  21170099
211800     SET EA-ALLOC-IDX UP BY +1.                                   21180099
211900                                                                  21190099
212000 2540-INSERT-TO-RA-TABLE.                                         21200099
212100     MOVE PV-STR-NBR             TO RA-STR-NBR (RA-ALLOC-IDX)     21210099
212200     MOVE ST-CHAR5-ABBR-NAME (ST-STR-IDX)                         21220099
212300                                 TO RA-CHAR5-ABBR-NAME            21230099
212400                                   (RA-ALLOC-IDX)                 21240099
212500                                                                  21250099
212600     IF PS-DIFF-OPER-UNIT-ID                                      21260099
212700         MOVE ST-DC-NMBR (ST-STR-IDX)                             21270099
212800                                 TO PV-DIFF-OPER-UNT-ID           21280099
212900         MOVE PV-FRMTD-DIFF-OPER-UNT-ID                           21290099
213000                                 TO RA-DIFF-OPER-UNT-ID           21300099
213100                                    (RA-ALLOC-IDX)                21310099
213200         IF PV-DIFF-OPER-UNT-ID = SPACES OR ZERO                  21320099
213300             CONTINUE                                             21330099
213400         ELSE                                                     21340099
213500             SET PV-SAVE-OTR-IDX TO 1                             21350099
213600             SEARCH PV-SAVE-OTR-TABLE                             21360099
213700                 WHEN PV-DIFF-OPER-UNT-ID = PV-OTR-DIST           21370099
213800                                         (PV-SAVE-OTR-IDX)        21380099
213900                      MOVE PV-SAVE-OTR (PV-SAVE-OTR-IDX)          21390099
214000                                 TO DP276-OTR-TABLE               21400099
214100                 WHEN PV-OTR-DIST(PV-SAVE-OTR-IDX) = ZERO         21410099
214200                     MOVE PV-DIFF-OPER-UNT-ID                     21420099
214300                                 TO PV-OTR-DIST(PV-SAVE-OTR-IDX)  21430099
214400                     PERFORM 4200-CALC-OPEN-TO-REC                21440099
214500                     MOVE DP276-OTR-TABLE                         21450099
214600                                 TO                               21460099
214700                          PV-SAVE-OTR (PV-SAVE-OTR-IDX)           21470099
214800             END-SEARCH                                           21480099
214900         END-IF                                                   21490099
215000     ELSE                                                         21500099
215100         SET PV-SAVE-OTR-IDX TO 1                                 21510099
215200         SEARCH PV-SAVE-OTR-TABLE                                 21520099
215300             WHEN PC016-OPER-UNT-ID (PC016-IDX) = PV-OTR-DIST     21530099
215400                                     (PV-SAVE-OTR-IDX)            21540099
215500                 MOVE PV-SAVE-OTR (PV-SAVE-OTR-IDX)               21550099
215600                                 TO DP276-OTR-TABLE               21560099
215700         END-SEARCH                                               21570099
215800     END-IF.                                                      21580099
215900                                                                  21590099
216000     MOVE PV-STR-NBR            TO DP276-SEARCH-NBR               21600099
216100     PERFORM 4210-SEARCH-OTR                                      21610099
216200     MOVE DP276-OTR-OUT         TO PV-OTR                         21620099
216300     MOVE DP276-OTR-OUT-X       TO RA-ITEMS-OPEN-TO-RECEIVE       21630099
216400                                   (RA-ALLOC-IDX)                 21640099
216500                                                                  21650099
216600     IF DP276-NO-DISTRO                                           21660099
216700         SET PS-PRINT-NO-DISTRO-MSG TO TRUE                       21670099
216800     END-IF.                                                      21680099
216900                                                                  21690099
217000                                                                  21700099
217100     MOVE PV-EXPTED-ITM-CNT                                       21710099
217200         TO  RA-EXPTED-ITM-CNT (RA-ALLOC-IDX).                    21720099
217300     COMPUTE  PV-TOT-EXPTED-ITM-CNT  =                            21730099
217400         PV-EXPTED-ITM-CNT  +  PV-TOT-EXPTED-ITM-CNT.             21740099
217500     ADD 1  TO  PV-STORES-GIVEN-PIECES.                           21750099
217600     ADD 1  TO  PV-RTV-STORES.                                    21760099
217700                                                                  21770099
217800     SET RA-ALLOC-IDX UP BY +1.                                   21780099
217900                                                                  21790099
218000     EJECT                                                        21800099
218100                                                                  21810099
218200*2600-UPC-CERTIFICATION.                                          21820099
218300*  THIS SWITCH IS SET IN PARA 7130-GET-CERT-INFO WHILE            21830099
218400*  BUILDING THE REPORT HEADINGS FOR THE PO                        21840099
218500*    IF  PS-NO-TVNDAGR                                            21850099
218600*        CONTINUE                                                 21860099
218700*    ELSE                                                         21870099
218800*        PERFORM 2610-CHECK-UPC-CERTIFICATION                     21880099
218900*        IF PS-VENDOR-REQ-CERT                                    21890099
219000*            MOVE PC-UPC-CERT-MSG    TO HL12-UPC-CERT-MESSAGE     21900099
219100*            PERFORM 7430-GET-UPC-CERT                            21910099
219200*            IF SQLCODE = +100                                    21920099
219300*                PERFORM 2620-CREATE-UPCCER-ROW                   21930099
219400*            END-IF                                               21940099
219500*        ELSE                                                     21950099
219600*            MOVE SPACES             TO HL12-UPC-CERT-MESSAGE     21960099
219700*        END-IF                                                   21970099
219800*    END-IF.                                                      21980099
219900*                                                                 21990099
220000*                                                                 22000099
220100*2610-CHECK-UPC-CERTIFICATION.                                    22010099
220200*    MOVE 'N' TO PS-VENDOR-REQ-CERT-IND.                          22020099
220300*    PERFORM 2611-CT-VENDOR-UPCS                                  22030099
220400*    IF SQLCODE = +100                                            22040099
220500*        MOVE PC-UPC-CERT-MSG    TO HL12-UPC-CERT-MESSAGE         22050099
220600*        SET PS-VENDOR-REQ-CERT TO TRUE                           22060099
220700*    ELSE                                                         22070099
220800*        PERFORM 2612-CT-VENDORS-REQ-CERT                         22080099
220900*        IF SQLCODE = +0   OR -811                                22090099
221000*            MOVE PC-UPC-CERT-MSG    TO HL12-UPC-CERT-MESSAGE     22100099
221100*            SET PS-VENDOR-REQ-CERT TO TRUE                       22110099
221200*         END-IF                                                  22120099
221300*    END-IF.                                                      22130099
221400*                                                                 22140099
221500*2611-CT-VENDOR-UPCS.                                             22150099
221600*    INITIALIZE PV-DB2-CURRENT-DATE.                              22160099
221700*                                                                 22170099
221800*    EXEC SQL                                                     22180099
221900*        SELECT CURRENT DATE                                      22190099
222000*              ,UPC_NBR                                           22200099
222100*        INTO :PV-DB2-CURRENT-DATE                                22210099
222200*            ,:XLV00003-UPC-NBR                                   22220099
222300*        FROM XLV_UPC                                             22230099
222400*        WHERE   INTR_UPC_ID   = :XL001-INTR-UPC-ID               22240099
222500*          AND   UPC_TYP_CDE   = :PC-V                            22250099
222600*          AND ((UPC_NBR BETWEEN :PC-EXTERNAL-UPC-LOW             22260099
222700*                                      AND                        22270099
222800*                                :PC-INTERNAL-UPC-LOW)            22280099
222900*                         OR                                      22290099
223000*               (UPC_NBR BETWEEN :PC-INTERNAL-UPC-HIGH            22300099
223100*                                      AND                        22310099
223200*                                :PC-EXTERNAL-UPC-HIGH))          22320099
223300*    END-EXEC                                                     22330099
223400*                                                                 22340099
223500*    EVALUATE TRUE                                                22350099
223600*        WHEN SQLCODE = 0                                         22360099
223700*        WHEN SQLCODE = -811                                      22370099
223800*        WHEN SQLCODE = -904                                      22380099
223900*        WHEN SQLCODE = -911                                      22390099
224000*           CONTINUE                                              22400099
224100*        WHEN SQLCODE = +100                                      22410099
224200*           MOVE ZEROES TO  XLV00003-UPC-NBR                      22420099
224300*        WHEN SQLWARN0 NOT = SPACES                               22430099
224400*        WHEN SQLCODE < 0                                         22440099
224500*        WHEN SQLCODE > 0                                         22450099
224600*            MOVE '2611-CT-VENDOR-UPCS'                           22460099
224700*                TO DP013-PARAGRAPH                               22470099
224800*            MOVE 'SELECT THE XLV_UPC VIEW'                       22480099
224900*                TO DP013-MESSAGE-TEXT (1)                        22490099
225000*            MOVE SQLCA          TO DP013-SQLCA                   22500099
225100*            MOVE 'XLV_UPC'      TO DP013-DB2-TABLE-NAME (1)      22510099
225200*            SET DP013-DB2-ABEND TO TRUE                          22520099
225300*            SET DP013-NO-ROLLBACK TO TRUE                        22530099
225400*            PERFORM 9999-WRITE-CICS-LOG-MSG                      22540099
225500*            GO TO 0000-GOBACK                                    22550099
225600*    END-EVALUATE.                                                22560099
225700*                                                                 22570099
225800*2612-CT-VENDORS-REQ-CERT.                                        22580099
225900*    INITIALIZE PV-DB2-CURRENT-DATE.                              22590099
226000*                                                                 22600099
226100*    EXEC SQL                                                     22610099
226200*        SELECT CURRENT DATE                                      22620099
226300*              ,UPC_NBR                                           22630099
226400*        INTO :PV-DB2-CURRENT-DATE                                22640099
226500*            ,:XLV00003-UPC-NBR                                   22650099
226600*        FROM XLV_UPC                                             22660099
226700*        WHERE  (INTR_UPC_ID   = :XL001-INTR-UPC-ID               22670099
226800*          AND   UPC_TYP_CDE   = :PC-V                            22680099
226900*          AND ((UPC_NBR BETWEEN :PC-EXTERNAL-UPC-LOW             22690099
227000*                                      AND                        22700099
227100*                                :PC-INTERNAL-UPC-LOW)            22710099
227200*                         OR                                      22720099
227300*               (UPC_NBR BETWEEN :PC-INTERNAL-UPC-HIGH            22730099
227400*                                      AND                        22740099
227500*                                :PC-EXTERNAL-UPC-HIGH))          22750099
227600*          AND                                                    22760099
227700*              NOT  (CERTD_IND     = :PC-Y))                      22770099
227800*    END-EXEC                                                     22780099
227900*                                                                 22790099
228000*    EVALUATE TRUE                                                22800099
228100*        WHEN SQLCODE = 0                                         22810099
228200*        WHEN SQLCODE = +100                                      22820099
228300*        WHEN SQLCODE = -811                                      22830099
228400*        WHEN SQLCODE = -904                                      22840099
228500*        WHEN SQLCODE = -911                                      22850099
228600*            CONTINUE                                             22860099
228700*        WHEN SQLWARN0 NOT = SPACES                               22870099
228800*        WHEN SQLCODE < 0                                         22880099
228900*        WHEN SQLCODE > 0                                         22890099
229000*            MOVE '2612-CT-VENDORS-REQ-CERT'                      22900099
229100*                TO DP013-PARAGRAPH                               22910099
229200*            MOVE 'SELECT THE XLV_UPC VIEW'                       22920099
229300*                TO DP013-MESSAGE-TEXT (1)                        22930099
229400*            MOVE SQLCA          TO DP013-SQLCA                   22940099
229500*            MOVE 'XLV_UPC'      TO DP013-DB2-TABLE-NAME (1)      22950099
229600*            SET DP013-DB2-ABEND TO TRUE                          22960099
229700*            SET DP013-NO-ROLLBACK TO TRUE                        22970099
229800*            PERFORM 9999-WRITE-CICS-LOG-MSG                      22980099
229900*            GO TO 0000-GOBACK                                    22990099
230000*    END-EVALUATE.                                                23000099
230100*                                                                 23010099
230200*                                                                 23020099
230300*2620-CREATE-UPCCER-ROW.                                          23030099
230400*    INITIALIZE DCLTUPCCER                                        23040099
230500*    MOVE XL001-KEY-ITM-NBR     TO UPCCER-MDSE-LNE-ITM-NBR        23050099
230600*                                  UPCCER-SCAN-ITM-NBR.           23060099
230700*    MOVE PV-DB2-CURRENT-TMST   TO UPCCER-CRE-TMST.               23070099
230800*    MOVE PC-10                 TO UPCCER-ACT-CDE.                23080099
230900*    MOVE DK-OPER-UNT-ID        TO UPCCER-OPER-UNT-ID.            23090099
231000*    MOVE DK-ORD-NBR            TO UPCCER-PO-NBR.                 23100099
231100*    MOVE DK-RCVR-SEQ-NBR       TO UPCCER-REC-SEQ-NBR.            23110099
231200*    MOVE CA-ORD-LNE-NBR        TO UPCCER-PO-LNE-NBR.             23120099
231300*    MOVE CA-PREPAIRER-USER-ID  TO UPCCER-UID-NBR.                23130099
231400*    MOVE XLV00003-UPC-NBR      TO UPCCER-UPC-NBR.                23140099
231500*    MOVE PC-ONE                TO UPCCER-FUNC-CDE.               23150099
231600*    PERFORM 2621-GET-PROCESSING-AREA.                            23160099
231700*    MOVE PV-PRC-FCLTY-AREA-ID  TO UPCCER-MDSE-PRC-AREA-CDE.      23170099
231800*    MOVE 'Y'                   TO UPCCER-REQ-FOR-CERT-CDE.       23180099
231900*    PERFORM 7440-INSERT-UPCCER.                                  23190099
232000*                                                                 23200099
232100*2621-GET-PROCESSING-AREA.                                        23210099
232200*                                                                 23220099
232300*    PERFORM 7350-OPEN-TWKORIN.                                   23230099
232400*    PERFORM 2622-FETCH-TWKORIN-LOOP.                             23240099
232500*                                                                 23250099
232600*2622-FETCH-TWKORIN-LOOP.                                         23260099
232700*                                                                 23270099
232800*    MOVE 'N' TO PS-TWKORIN-CURSOR-SW.                            23280099
232900*    MOVE 'N' TO PS-TWKORIN-ZERO-SW.                              23290099
233000*    PERFORM 7360-FETCH-TWKORIN.                                  23300099
233100*    IF  PS-EOF-TWKORIN-CSR                                       23310099
233200*      OR WKORIN-STRT-TMST = PC-DB2-DUMMY-DATE-TIME               23320099
233300*        PERFORM 7370-CLOSE-TWKORIN                               23330099
233400*        PERFORM 7380-OPEN-WKORIN0-CURSOR                         23340099
233500*        PERFORM 7390-FETCH-TWKORIN-ZERO                          23350099
233600*        IF  WKORIN-STRT-TMST = PC-DB2-DUMMY-DATE-TIME            23360099
233700*            MOVE WKORIN-PRC-FCLTY-AREA-ID TO                     23370099
233800*                     PV-PRC-FCLTY-AREA-ID                        23380099
233900*            MOVE 'N' TO PS-TWKORIN-ZERO-SW                       23390099
234000*            PERFORM 7400-CLOSE-WKORIN0                           23400099
234100*        ELSE                                                     23410099
234200*            MOVE WKORIN-PRC-FCLTY-AREA-ID TO                     23420099
234300*                     PV-PRC-FCLTY-AREA-ID                        23430099
234400*            PERFORM 7390-FETCH-TWKORIN-ZERO                      23440099
234500*                UNTIL PS-EOF-TWKORIN-ZERO                        23450099
234600*            PERFORM 7400-CLOSE-WKORIN0                           23460099
234700*    ELSE                                                         23470099
234800*        MOVE WKORIN-PRC-FCLTY-AREA-ID TO PV-PRC-FCLTY-AREA-ID    23480099
234900*        PERFORM 7360-FETCH-TWKORIN                               23490099
235000*            UNTIL PS-EOF-TWKORIN-CSR                             23500099
235100*        PERFORM 7370-CLOSE-TWKORIN                               23510099
235200*    END-IF.                                                      23520099
235300     EJECT                                                        23530099
235400 4200-CALC-OPEN-TO-REC.                                           23540099
235500                                                                  23550099
235600     SET DP276-STORE-LEVEL-OTR                                    23560099
235700         DP276-RECEIVER-OTR               TO TRUE                 23570099
235800                                                                  23580099
235900     INITIALIZE DP276-KEYS                                        23590099
236000     MOVE PC016-PO-NBR-N (PC016-IDX)      TO DP276-PO-NBR         23600099
236100     MOVE PC016-LINE-NBR-N (PC016-IDX)    TO DP276-PO-LNE-NBR     23610099
236200     MOVE PC016-REC-SEQ-NBR-N (PC016-IDX) TO DP276-REC-SEQ-NBR    23620099
236300     MOVE PV-OTR-DIST(PV-SAVE-OTR-IDX)    TO DP276-OPER-UNT-ID    23630099
236400     MOVE PURITM-PO-LNE-NBR               TO DP276-PO-LNE-NBR     23640099
236500     MOVE PC016-FCLTY-ID (PC016-IDX)      TO DP276-FCLTY-ID.      23650099
236600                                                                  23660099
236700     COPY DPPD276.                                                23670099
236800 EJECT                                                            23680099
236900*                                                                 23690099
237000******************************************************************23700099
237100*  WRITE THE DATA TO THE DETAIL AND HEADING LINES VIA DRS.        23710099
237200******************************************************************23720099
237300 4000-PRODUCE-RPT.                                                23730099
237400     IF PS-PAGE-SUB = PV-PAGES-REQ AND                            23740099
237500        PS-SHORTEN-LAST-PAGE                                      23750099
237600         SUBTRACT PC-3 FROM PV-ROWS-PER-PAGE                      23760099
237700     END-IF.                                                      23770099
237800                                                                  23780099
237900     MOVE PC-PUT                     TO  DRS01-DRRB-FUNC.         23790099
238000                                                                  23800099
238100     MOVE SD-SYSTEM-MONTH            TO  HL1-RUN-MONTH.           23810099
238200     MOVE SD-SYSTEM-DAY              TO  HL1-RUN-DAY.             23820099
238300     MOVE SD-SYSTEM-YEAR             TO  HL1-RUN-YEAR.            23830099
238400     MOVE ST-SYSTEM-HOUR             TO  HL1-RUN-HOUR.            23840099
238500     MOVE ST-SYSTEM-MINUTE           TO  HL1-RUN-MINUTE.          23850099
238600                                                                  23860099
238700     IF PS-YES-TRECITM                                            23870099
238800         IF RECITM-MKING-APRON-TMST NOT = PC-DB2-DUMMY-DATE-TIME  23880099
238900             MOVE RL1-REPRINT-LINE-1 TO  DRS01-COMM-DATA          23890099
239000             MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL           23900099
239100             PERFORM 8000-LINK-TO-DRS                             23910099
239200             SET PS-TOP-OF-PAGE-SET                               23920099
239300                 PS-REPRINT-MSG-PRTED TO TRUE                     23930099
239400         ELSE                                                     23940099
239500             CONTINUE                                             23950099
239600     ELSE                                                         23960099
239700         INITIALIZE DRS01-COMM-DATA                               23970099
239800         STRING                                                   23980099
239900         'MARKING APRON COULD NOT BE PRINTED BECAUSE '            23990099
240000         'NO PACKSLIPS WERE KEYED FOR THIS LINE.     '            24000099
240100             DELIMITED BY SIZE INTO DRS01-COMM-DATA               24010099
240200             MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL           24020099
240300             PERFORM 8000-LINK-TO-DRS                             24030099
240400             SET PS-TOP-OF-PAGE-SET TO TRUE                       24040099
240500     END-IF.                                                      24050099
240600                                                                  24060099
240700     IF PV-COUNT > 0                                              24070099
240800         MOVE RT1-RTV-DISTRO-LINE-1 TO  DRS01-COMM-DATA           24080099
240900         IF PS-TOP-OF-PAGE-SET                                    24090099
241000             MOVE PC-DOUBLE-SPACE    TO  DRS01-COMM-CTL           24100099
241100         ELSE                                                     24110099
241200             MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL           24120099
241300         END-IF                                                   24130099
241400         PERFORM 8000-LINK-TO-DRS                                 24140099
241500         SET PS-TOP-OF-PAGE-SET TO TRUE                           24150099
241600     END-IF.                                                      24160099
241700                                                                  24170099
241800     IF TL2-TRBL-DESC (1) NOT = SPACES                            24180099
241900         MOVE TL1-TROUBLE-LINE-1     TO  DRS01-COMM-DATA          24190099
242000         IF PS-TOP-OF-PAGE-SET                                    24200099
242100             MOVE PC-DOUBLE-SPACE    TO  DRS01-COMM-CTL           24210099
242200         ELSE                                                     24220099
242300             MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL           24230099
242400         END-IF                                                   24240099
242500         PERFORM 8000-LINK-TO-DRS                                 24250099
242600         MOVE TL2-TROUBLE-LINE-2     TO  DRS01-COMM-DATA          24260099
242700         MOVE PC-DOUBLE-SPACE        TO  DRS01-COMM-CTL           24270099
242800         PERFORM 8000-LINK-TO-DRS                                 24280099
242900         SET PS-TOP-OF-PAGE-SET TO TRUE                           24290099
243000     END-IF.                                                      24300099
243100                                                                  24310099
243200     MOVE PC-MARKING-APRON-RPT-HDR  TO  HL1-RPT-HDR               24320099
243300                                                                  24330099
243400     IF PS-PRINT-STORE-PROBLEM                                    24340099
243500         MOVE DH4-STORE-PROBLEM-LINE     TO  DRS01-COMM-DATA      24350099
243600         IF PS-TOP-OF-PAGE-SET                                    24360099
243700             MOVE PC-DOUBLE-SPACE    TO  DRS01-COMM-CTL           24370099
243800         ELSE                                                     24380099
243900             MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL           24390099
244000         END-IF                                                   24400099
244100         PERFORM 8000-LINK-TO-DRS                                 24410099
244200         SET PS-TOP-OF-PAGE-SET TO TRUE                           24420099
244300     END-IF.                                                      24430099
244400                                                                  24440099
244500     MOVE PC-CURRENT-PROGRAM-NAME    TO HL1-PROGRAM-NAME.         24450099
244600     MOVE 1                          TO  HL1-RPT-NBR.             24460099
244700     MOVE PS-PAGE-SUB                TO  HL1-PGE-NBR.             24470099
244800     MOVE PV-TOTAL-PAGES             TO  HL1-OF-PGE-NBR.          24480099
244900     MOVE HL1-HEADING-LINE-1         TO  DRS01-COMM-DATA.         24490099
245000     IF PS-TOP-OF-PAGE-SET                                        24500099
245100         MOVE PC-DOUBLE-SPACE        TO  DRS01-COMM-CTL           24510099
245200     ELSE                                                         24520099
245300         MOVE PC-TOP-OF-PAGE         TO  DRS01-COMM-CTL           24530099
245400     END-IF.                                                      24540099
245500     SET PS-TOP-OF-PAGE-NOT-SET TO TRUE.                          24550099
245600     PERFORM 8000-LINK-TO-DRS.                                    24560099
245700                                                                  24570099
245800     MOVE HL2-HEADING-LINE-2         TO  DRS01-COMM-DATA.         24580099
245900     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          24590099
246000     PERFORM 8000-LINK-TO-DRS.                                    24600099
246100                                                                  24610099
246200     MOVE CA-PREPAIRER-USER-ID       TO  HL3-PREPAIRER-USER-ID.   24620099
246300     MOVE CA-DESTINATION             TO  HL4-PRINTER-DEST.        24630099
246400     MOVE HL3-HEADING-LINE-3         TO  DRS01-COMM-DATA.         24640099
246500     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          24650099
246600     PERFORM 8000-LINK-TO-DRS.                                    24660099
246700                                                                  24670099
246800     MOVE HL4-HEADING-LINE-4         TO  DRS01-COMM-DATA.         24680099
246900     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          24690099
247000     PERFORM 8000-LINK-TO-DRS.                                    24700099
247100                                                                  24710099
247200     MOVE HL5-HEADING-LINE-5         TO  DRS01-COMM-DATA.         24720099
247300     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          24730099
247400     PERFORM 8000-LINK-TO-DRS.                                    24740099
247500                                                                  24750099
247600     MOVE HL6-HEADING-LINE-6         TO  DRS01-COMM-DATA.         24760099
247700     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          24770099
247800     PERFORM 8000-LINK-TO-DRS.                                    24780099
247900                                                                  24790099
248000     MOVE HL7-HEADING-LINE-7         TO  DRS01-COMM-DATA.         24800099
248100     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          24810099
248200     PERFORM 8000-LINK-TO-DRS.                                    24820099
248300                                                                  24830099
248400     MOVE HL8-HEADING-LINE-8         TO  DRS01-COMM-DATA.         24840099
248500     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          24850099
248600     PERFORM 8000-LINK-TO-DRS.                                    24860099
248700                                                                  24870099
248800     MOVE HL9-HEADING-LINE-9         TO  DRS01-COMM-DATA.         24880099
248900     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          24890099
249000     PERFORM 8000-LINK-TO-DRS.                                    24900099
249100                                                                  24910099
249200     MOVE HL10-HEADING-LINE-10       TO  DRS01-COMM-DATA.         24920099
249300     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          24930099
249400     PERFORM 8000-LINK-TO-DRS.                                    24940099
249500                                                                  24950099
249600     MOVE HL11-HEADING-LINE-11       TO  DRS01-COMM-DATA.         24960099
249700     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          24970099
249800     PERFORM 8000-LINK-TO-DRS.                                    24980099
249900                                                                  24990099
250000     MOVE HL12-HEADING-LINE-12       TO  DRS01-COMM-DATA.         25000099
250100     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          25010099
250200     PERFORM 8000-LINK-TO-DRS.                                    25020099
250300                                                                  25030099
250400     MOVE HL13-HEADING-LINE-13       TO  DRS01-COMM-DATA.         25040099
250500     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          25050099
250600     PERFORM 8000-LINK-TO-DRS.                                    25060099
250700                                                                  25070099
250800     MOVE HL13A-HEADING-LINE-13A     TO  DRS01-COMM-DATA.         25080099
250900     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          25090099
251000     PERFORM 8000-LINK-TO-DRS.                                    25100099
251100                                                                  25110099
251200     MOVE HL14-HEADING-LINE-14       TO  DRS01-COMM-DATA.         25120099
251300     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          25130099
251400     PERFORM 8000-LINK-TO-DRS.                                    25140099
251500                                                                  25150099
251600     MOVE DH1-DETAIL-HEADING-LINE-1  TO  DRS01-COMM-DATA.         25160099
251700     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          25170099
251800     PERFORM 8000-LINK-TO-DRS.                                    25180099
251900                                                                  25190099
252000     MOVE DH2-DETAIL-HEADING-LINE-2  TO  DRS01-COMM-DATA.         25200099
252100     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          25210099
252200     PERFORM 8000-LINK-TO-DRS.                                    25220099
252300                                                                  25230099
252400     IF PS-PRINT-NO-DISTRO-MSG                                    25240099
252500         MOVE DH3-NO-DISTRO-MSG          TO  DRS01-COMM-DATA      25250099
252600         MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL       25260099
252700         PERFORM 8000-LINK-TO-DRS                                 25270099
252800     END-IF.                                                      25280099
252900                                                                  25290099
253000     PERFORM 4010-PRINT-DTL-LNE                                   25300099
253100         VARYING PS-DTL-LNE-SUB                                   25310099
253200         FROM 1 BY 1                                              25320099
253300         UNTIL PS-DTL-LNE-SUB > PV-ROWS-PER-PAGE OR               25330099
253400               PS-END-OF-DETAIL.                                  25340099
253500                                                                  25350099
253600     IF PS-RTV-DISTRO                                             25360099
253700         IF PS-PAGE-SUB = PV-PAGES-REQ                            25370099
253800             IF PS-DTL-LNE-SUB + 3 < PV-ROWS-PER-PAGE OR          25380099
253900                PS-SHORTEN-LAST-PAGE                              25390099
254000                 SET PS-RTV-PRINT TO TRUE                         25400099
254100                 MOVE HL15-HEADING-LINE-15   TO  DRS01-COMM-DATA  25410099
254200                 MOVE PC-DOUBLE-SPACE        TO  DRS01-COMM-CTL   25420099
254300                 PERFORM 8000-LINK-TO-DRS                         25430099
254400                 PERFORM 4030-FILL-RTV-LNE                        25440099
254500                 MOVE DL-DETAIL-LINE     TO  DRS01-COMM-DATA      25450099
254600                 MOVE PC-SINGLE-SPACE    TO  DRS01-COMM-CTL       25460099
254700                 PERFORM 8000-LINK-TO-DRS                         25470099
254800                 MOVE SPACES             TO  DRS01-COMM-DATA      25480099
254900                 MOVE PC-SINGLE-SPACE    TO  DRS01-COMM-CTL       25490099
255000*                ADD PC-3 TO PS-DTL-LNE-SUB                       25500099
255100                 PERFORM 8000-LINK-TO-DRS                         25510099
255200                     VARYING PS-DTL-LNE-SUB                       25520099
255300                     FROM PS-DTL-LNE-SUB BY 1                     25530099
255400                     UNTIL PS-DTL-LNE-SUB > PV-ROWS-PER-PAGE      25540099
255500             ELSE                                                 25550099
255600                 MOVE SPACES             TO  DRS01-COMM-DATA      25560099
255700                 MOVE PC-SINGLE-SPACE    TO  DRS01-COMM-CTL       25570099
255800                 PERFORM 8000-LINK-TO-DRS                         25580099
255900                     VARYING PS-DTL-LNE-SUB                       25590099
256000                     FROM PS-DTL-LNE-SUB BY 1                     25600099
256100                     UNTIL PS-DTL-LNE-SUB > PV-ROWS-PER-PAGE      25610099
256200             END-IF                                               25620099
256300         ELSE                                                     25630099
256400             IF PS-PAGE-SUB > PV-PAGES-REQ                        25640099
256500                 SET PS-RTV-PRINT TO TRUE                         25650099
256600                 MOVE HL15-HEADING-LINE-15   TO  DRS01-COMM-DATA  25660099
256700                 MOVE PC-DOUBLE-SPACE        TO  DRS01-COMM-CTL   25670099
256800                 PERFORM 8000-LINK-TO-DRS                         25680099
256900                 PERFORM 4030-FILL-RTV-LNE                        25690099
257000                 MOVE DL-DETAIL-LINE     TO  DRS01-COMM-DATA      25700099
257100                 MOVE PC-SINGLE-SPACE    TO  DRS01-COMM-CTL       25710099
257200                 PERFORM 8000-LINK-TO-DRS                         25720099
257300                 MOVE SPACES             TO  DRS01-COMM-DATA      25730099
257400                 MOVE PC-SINGLE-SPACE    TO  DRS01-COMM-CTL       25740099
257500*                ADD PC-3 TO PS-DTL-LNE-SUB                       25750099
257600                 PERFORM 8000-LINK-TO-DRS                         25760099
257700                     VARYING PS-DTL-LNE-SUB                       25770099
257800                     FROM 5 BY 1                                  25780099
257900                     UNTIL PS-DTL-LNE-SUB > PV-ROWS-PER-PAGE      25790099
258000             END-IF                                               25800099
258100     ELSE                                                         25810099
258200         IF PS-NO-RTV-DISTRO AND                                  25820099
258300            PS-DTL-LNE-SUB < PV-ROWS-PER-PAGE                     25830099
258400             MOVE SPACES             TO  DRS01-COMM-DATA          25840099
258500             MOVE PC-SINGLE-SPACE    TO  DRS01-COMM-CTL           25850099
258600             PERFORM 8000-LINK-TO-DRS                             25860099
258700                 VARYING PS-DTL-LNE-SUB                           25870099
258800                 FROM PS-DTL-LNE-SUB BY 1                         25880099
258900                 UNTIL PS-DTL-LNE-SUB > PV-ROWS-PER-PAGE          25890099
259000         END-IF                                                   25900099
259100     END-IF.                                                      25910099
259200                                                                  25920099
259300                                                                  25930099
259400     IF PS-PAGE-SUB = PV-PAGES-REQ                                25940099
259500       IF CA-PRTR-PRTR-BRCDE-IND = 'Y'                            25950099
259600***  BARCODE CODING                                               25960099
259700         MOVE DS004-PLC-ACTIVATE-IMAGE1                           25970099
259800                                      TO DRS01-COMM-DATA          25980099
259900*        MOVE '^PY^-'                 TO DRS01-COMM-DATA          25990099
260000         MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL           26000099
260100         PERFORM 8000-LINK-TO-DRS                                 26010099
260200                                                                  26020099
260300*        IF THE PRINTER CONTROL INDICATOR SAYS IT IS A "FORMSPRO" 26030099
260400*        PRINTER, ACTIVATE FREE-FORM CONTROL                      26040099
260500         IF CA-PRTR-PRTR-CNTL-IND = 'P'                           26050099
260600             MOVE DS004-PLC-ACTIVATE-FF-PROC                      26060099
260700                                          TO DRS01-COMM-DATA      26070099
260800*            MOVE '^F'                    TO DRS01-COMM-DATA      26080099
260900             MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL       26090099
261000             PERFORM 8000-LINK-TO-DRS                             26100099
261100         END-IF                                                   26110099
261200                                                                  26120099
261300         MOVE PV-STORES-GIVEN-PIECES  TO TL1-TOT-STR-GIVEN        26130099
261400         MOVE CA-ORD-NBR-X            TO TL-BARCODE-KEYREC        26140099
261500                                         TL-BARCODE-KEYREC-1      26150099
261600                                         TL-BARCODE-KEYREC-2      26160099
261700         MOVE CA-RCVR-SEQ-NBR-X       TO TL-BARCODE-REC-SEQ       26170099
261800                                         TL-BARCODE-REC-SEQ-1     26180099
261900                                         TL-BARCODE-REC-SEQ-2     26190099
262000         MOVE CA-ORD-LNE-NBR          TO TL-BARCODE-LINE-NMBR     26200099
262100                                         TL-BARCODE-LINE-NMBR-1   26210099
262200                                         TL-BARCODE-LINE-NMBR-2   26220099
262300         MOVE RECEIV-RCVR-NBR         TO TL-SORT-KEYREC           26230099
262400         MOVE ZERO                    TO TL-SEQ-NBR               26240099
262500         MOVE CA-ORD-LNE-NBR          TO TL-SORT-LINE-NBR         26250099
262600         PERFORM 4020-COMPUTE-CNTL-NBR-CKDGT                      26260099
262700                                                                  26270099
262800         MOVE TL-BARCODE-LINE         TO DRS01-COMM-DATA          26280099
262900         MOVE PC-DOUBLE-SPACE         TO DRS01-COMM-CTL           26290099
263000         PERFORM 8000-LINK-TO-DRS                                 26300099
263100                                                                  26310099
263200*        IF A MENOMONEE FALLS RECEIVER, PRINT THE "LOWER" BARCODE 26320099
263300         IF CA-OPER-UNT-ID = 85                                   26330099
263400             MOVE PV-TOT-EXPTED-ITM-CNT                           26340099
263500                                      TO  TL2-TOT-EXPTED-ITM-CNT  26350099
263600             MOVE TL2-TOTAL-LINE-2    TO  DRS01-COMM-DATA         26360099
263700             MOVE PC-SINGLE-SPACE     TO  DRS01-COMM-CTL          26370099
263800             PERFORM 8000-LINK-TO-DRS                             26380099
263900         ELSE                                                     26390099
264000*        ELSE PRINT THE LINE WITHOUT THE SECOND BARCODE           26400099
264100             MOVE PV-TOT-EXPTED-ITM-CNT                           26410099
264200                  TO TL2-TOT-EXPTED-ITM-CNT-2                     26420099
264300             MOVE TL2-TOTAL-LINE-2-2  TO  DRS01-COMM-DATA         26430099
264400             MOVE PC-SINGLE-SPACE     TO  DRS01-COMM-CTL          26440099
264500             PERFORM 8000-LINK-TO-DRS                             26450099
264600         END-IF                                                   26460099
264700                                                                  26470099
264800                                                                  26480099
264900*        IF THE PRINTER CONTROL INDICATOR SAYS IT IS A "FORMSPRO" 26490099
265000*        PRINTER, DEACTIVATE THE FREE-FORM CONTROL, AND END       26500099
265100*        GRAPHICS MODE.                                           26510099
265200         IF CA-PRTR-PRTR-CNTL-IND = 'P'                           26520099
265300             MOVE DS004-PLC-DEACTIVATE-FF-PROC                    26530099
265400                                          TO DRS01-COMM-DATA      26540099
265500*            MOVE '^O'                    TO DRS01-COMM-DATA      26550099
265600             MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL       26560099
265700             PERFORM 8000-LINK-TO-DRS                             26570099
265800                                                                  26580099
265900             MOVE CA-LINES-PER-INCH       TO DS004-PLC-DI-LPI     26590099
266000             MOVE DS004-PLC-DEACTIVATE-IMAGE                      26600099
266100                                          TO DRS01-COMM-DATA      26610099
266200*            MOVE '^PN'                   TO DRS01-COMM-DATA      26620099
266300             MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL       26630099
266400             PERFORM 8000-LINK-TO-DRS                             26640099
266500                                                                  26650099
266600         ELSE                                                     26660099
266700             MOVE '^PN^-'                 TO DRS01-COMM-DATA      26670099
266800             MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL       26680099
266900             PERFORM 8000-LINK-TO-DRS                             26690099
267000         END-IF                                                   26700099
267100                                                                  26710099
267200*      IF BARCODE INDICATOR WASN'T 'Y', PRINT LINES WITHOUT       26720099
267300*      BARCODES                                                   26730099
267400       ELSE                                                       26740099
267500         MOVE PV-STORES-GIVEN-PIECES  TO TL1-TOT-STR-GIVEN-NB     26750099
267600         MOVE TL-NO-BARCODE-LINE      TO DRS01-COMM-DATA          26760099
267700         MOVE PC-DOUBLE-SPACE         TO DRS01-COMM-CTL           26770099
267800         PERFORM 8000-LINK-TO-DRS                                 26780099
267900                                                                  26790099
268000         MOVE PV-TOT-EXPTED-ITM-CNT                               26800099
268100              TO TL2-TOT-EXPTED-ITM-CNT-NB                        26810099
268200         MOVE TL2-TOTAL-LINE-2-NO-BARCODE                         26820099
268300                                      TO  DRS01-COMM-DATA         26830099
268400         MOVE PC-SINGLE-SPACE         TO  DRS01-COMM-CTL          26840099
268500         PERFORM 8000-LINK-TO-DRS                                 26850099
268600                                                                  26860099
268700       END-IF                                                     26870099
268800     END-IF.                                                      26880099
268900                                                                  26890099
269000                                                                  26900099
269100***  BARCODE CODING                                               26910099
269200*                                                                 26920099
269300******************************************************************26930099
269400*  THIS MODULE CONTROLS THE PRINTING OF THE STORE DETAIL LINES.   26940099
269500*  ONLY STORES WHICH HAVE AN EXPECTED ALLOCATION WILL BE PRINTED. 26950099
269600******************************************************************26960099
269700 4010-PRINT-DTL-LNE.                                              26970099
269800     IF PS-PAGE-SUB = PC-ONE                                      26980099
269900         SET EA-ALLOC-IDX TO PS-DTL-LNE-SUB                       26990099
270000     ELSE                                                         27000099
270100         COMPUTE PV-STARTING-IDX-LOCATION =                       27010099
270200         (((PS-PAGE-SUB - 1) * PV-STRS-PER-PAGE)                  27020099
270300                   +  PS-DTL-LNE-SUB)                             27030099
270400         SET EA-ALLOC-IDX TO PV-STARTING-IDX-LOCATION             27040099
270500     END-IF.                                                      27050099
270600                                                                  27060099
270700     PERFORM 4011-FILL-DTL-LNE                                    27070099
270800        VARYING DL-DTL-LNE-IDX                                    27080099
270900        FROM 1 BY 1                                               27090099
271000        UNTIL DL-DTL-LNE-IDX > PC-COLS-PER-PAGE.                  27100099
271100                                                                  27110099
271200     MOVE DL-DETAIL-LINE             TO  DRS01-COMM-DATA.         27120099
271300     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          27130099
271400     PERFORM 8000-LINK-TO-DRS.                                    27140099
271500                                                                  27150099
271600 4011-FILL-DTL-LNE.                                               27160099
271700     IF EA-CLOSED-IND (EA-ALLOC-IDX) = '*'                        27170099
271800         MOVE ALL '*' TO  DL-DTL-LNE-AREA (DL-DTL-LNE-IDX)        27180099
271900         IF DL-DTL-LNE-IDX = 3                                    27190099
272000             MOVE SPACES TO DL-FILLER (DL-DTL-LNE-IDX)            27200099
272100         END-IF                                                   27210099
272200     ELSE                                                         27220099
272300         MOVE SPACES  TO  DL-DTL-LNE-AREA (DL-DTL-LNE-IDX)        27230099
272400     END-IF.                                                      27240099
272500                                                                  27250099
272600     IF EA-STR-NBR (EA-ALLOC-IDX) = ZEROS                         27260099
272700         IF DL-DTL-LNE-IDX = 1                                    27270099
272800             SET PS-END-OF-DETAIL TO TRUE                         27280099
272900         END-IF                                                   27290099
273000     ELSE                                                         27300099
273100         MOVE EA-STR-NBR (EA-ALLOC-IDX)                           27310099
273200             TO  DL-STR-NBR (DL-DTL-LNE-IDX)                      27320099
273300         MOVE EA-CHAR5-ABBR-NAME (EA-ALLOC-IDX)                   27330099
273400             TO  DL-CHAR5-ABBR-NAME (DL-DTL-LNE-IDX)              27340099
273500         MOVE EA-EXPTED-ITM-CNT (EA-ALLOC-IDX)                    27350099
273600             TO  DL-EXPTED-ITM-CNT (DL-DTL-LNE-IDX)               27360099
273700         MOVE EA-DIFF-OPER-UNT-ID (EA-ALLOC-IDX)                  27370099
273800             TO  DL-UNITS-OVER-SHORT (DL-DTL-LNE-IDX)             27380099
273900         MOVE EA-ITEMS-OPEN-TO-RECEIVE (EA-ALLOC-IDX)             27390099
274000             TO  DL-UNITS-OPEN-TO-RECEIVE (DL-DTL-LNE-IDX)        27400099
274100     END-IF.                                                      27410099
274200                                                                  27420099
274300     SET EA-ALLOC-IDX UP BY PV-ROWS-PER-PAGE.                     27430099
274400/                                                                 27440099
274500 4020-COMPUTE-CNTL-NBR-CKDGT.                                     27450099
274600     SET PV-DIGIT-IDX TO +13.                                     27460099
274700     MOVE TL-SORT-CONTROL-NBR TO PV-CNTL-NBR-X.                   27470099
274800                                                                  27480099
274900     PERFORM                                                      27490099
275000         UNTIL PV-DIGIT-IDX = ZERO                                27500099
275100         COMPUTE PV-CNTL-NBR-PRODUCT =                            27510099
275200             PV-CNTL-NBR-DIGIT (PV-DIGIT-IDX) * 2                 27520099
275300         COMPUTE PV-CHECK-SUM =                                   27530099
275400             PV-CHECK-SUM + (PV-PRODUCT-DIGIT (1) +               27540099
275500                             PV-PRODUCT-DIGIT (2))                27550099
275600         SET PV-DIGIT-IDX DOWN BY 1                               27560099
275700         IF PV-DIGIT-IDX NOT = ZERO                               27570099
275800             COMPUTE PV-CHECK-SUM =                               27580099
275900                 PV-CHECK-SUM + PV-CNTL-NBR-DIGIT (PV-DIGIT-IDX)  27590099
276000             SET PV-DIGIT-IDX DOWN BY 1                           27600099
276100         END-IF                                                   27610099
276200     END-PERFORM.                                                 27620099
276300                                                                  27630099
276400     COMPUTE PV-CHECK-DIGIT = 10 - PV-CKSUM-LEAST-SIGNIFICANT-DGT.27640099
276500     MOVE PV-CHECK-DIGIT TO TL-SORT-CHKDGT                        27650099
276600     INITIALIZE PV-CHECK-SUM.                                     27660099
276700*                                                                 27670099
276800 4030-FILL-RTV-LNE.                                               27680099
276900     IF RA-CLOSED-IND (1) = '*'                                   27690099
277000         MOVE ALL '*' TO  DL-DTL-LNE-AREA (1)                     27700099
277100     ELSE                                                         27710099
277200         MOVE SPACES  TO  DL-DTL-LNE-AREA (1)                     27720099
277300     END-IF.                                                      27730099
277400                                                                  27740099
277500     MOVE RA-STR-NBR (1)                                          27750099
277600         TO  DL-STR-NBR (1).                                      27760099
277700     MOVE RA-CHAR5-ABBR-NAME (1)                                  27770099
277800         TO  DL-CHAR5-ABBR-NAME (1).                              27780099
277900     MOVE RA-EXPTED-ITM-CNT (1)                                   27790099
278000         TO  DL-EXPTED-ITM-CNT (1).                               27800099
278100     MOVE RA-DIFF-OPER-UNT-ID (1)                                 27810099
278200         TO  DL-UNITS-OVER-SHORT (1).                             27820099
278300     MOVE RA-ITEMS-OPEN-TO-RECEIVE (1)                            27830099
278400         TO  DL-UNITS-OPEN-TO-RECEIVE (1).                        27840099
278500                                                                  27850099
278600     IF RA-CLOSED-IND (2) = '*'                                   27860099
278700         MOVE ALL '*' TO  DL-DTL-LNE-AREA (2)                     27870099
278800     ELSE                                                         27880099
278900         MOVE SPACES  TO  DL-DTL-LNE-AREA (2)                     27890099
279000     END-IF.                                                      27900099
279100                                                                  27910099
279200     IF RA-STR-NBR (2) = ZEROS                                    27920099
279300         CONTINUE                                                 27930099
279400     ELSE                                                         27940099
279500         MOVE RA-STR-NBR (2)                                      27950099
279600             TO  DL-STR-NBR (2)                                   27960099
279700         MOVE RA-CHAR5-ABBR-NAME (2)                              27970099
279800             TO  DL-CHAR5-ABBR-NAME (2)                           27980099
279900         MOVE RA-EXPTED-ITM-CNT (2)                               27990099
280000             TO  DL-EXPTED-ITM-CNT (2)                            28000099
280100         MOVE RA-DIFF-OPER-UNT-ID (2)                             28010099
280200             TO  DL-UNITS-OVER-SHORT (2)                          28020099
280300         MOVE RA-ITEMS-OPEN-TO-RECEIVE (2)                        28030099
280400             TO  DL-UNITS-OPEN-TO-RECEIVE (2)                     28040099
280500     END-IF.                                                      28050099
280600                                                                  28060099
280700     IF RA-CLOSED-IND (3) = '*'                                   28070099
280800         MOVE ALL '*' TO  DL-DTL-LNE-AREA (3)                     28080099
280900         MOVE SPACES TO DL-FILLER (3)                             28090099
281000     ELSE                                                         28100099
281100         MOVE SPACES  TO  DL-DTL-LNE-AREA (3)                     28110099
281200     END-IF.                                                      28120099
281300                                                                  28130099
281400     IF RA-STR-NBR (3) = ZEROS                                    28140099
281500         CONTINUE                                                 28150099
281600     ELSE                                                         28160099
281700         MOVE RA-STR-NBR (3)                                      28170099
281800             TO  DL-STR-NBR (3)                                   28180099
281900         MOVE RA-CHAR5-ABBR-NAME (3)                              28190099
282000             TO  DL-CHAR5-ABBR-NAME (3)                           28200099
282100         MOVE RA-EXPTED-ITM-CNT (3)                               28210099
282200             TO  DL-EXPTED-ITM-CNT (3)                            28220099
282300         MOVE RA-DIFF-OPER-UNT-ID (3)                             28230099
282400             TO  DL-UNITS-OVER-SHORT (3)                          28240099
282500         MOVE RA-ITEMS-OPEN-TO-RECEIVE (3)                        28250099
282600             TO  DL-UNITS-OPEN-TO-RECEIVE (3)                     28260099
282700     END-IF.                                                      28270099
282800                                                                  28280099
282900 4040-COUNT-RTV-DISTROS.                                          28290099
283000                                                                  28300099
283100     MOVE ZERO TO PV-COUNT.                                       28310099
283200                                                                  28320099
283300     EXEC SQL                                                     28330099
283400          SELECT  COUNT(*)                                        28340099
283500            INTO  :PV-COUNT                                       28350099
283600            FROM  TRECDIS A                                       28360099
283700                , XLT_LOC B                                       28370099
283800           WHERE A.ORD_NBR           =  :DK-ORD-NBR               28380099
283900             AND A.ORD_LNE_NBR       =  :DK-ORD-LNE-NBR           28390099
284000             AND A.REC_SEQ_NBR       =  :DK-RCVR-SEQ-NBR          28400099
284100             AND A.OPER_UNT_ID       =  :DK-OPER-UNT-ID           28410099
284200             AND A.FCLTY_ID          =  :DK-FCLTY-ID              28420099
284400             AND A.EXPTED_ITM_QTY    >  :PC-ZERO                  28440099
284500             AND A.STR_NBR           =  B.LOC_NBR                 28450099
284600             AND B.LOC_TYP_CDE     IN (:PC-DC, :PC-RV)            28460099
284700     END-EXEC.                                                    28470099
284800                                                                  28480099
284900     EVALUATE TRUE                                                28490099
285000         WHEN SQLCODE = ZERO                                      28500099
285100             CONTINUE                                             28510099
285200         WHEN SQLWARN0 NOT = SPACE                                28520099
285300         WHEN SQLCODE < ZERO                                      28530099
285400         WHEN SQLCODE > ZERO                                      28540099
285500             MOVE '4040-COUNT-RTV-DISTROS'                        28550099
285600                 TO DP013-PARAGRAPH                               28560099
285700             MOVE 'SELECT A COUNT OR RTV DISTROS'                 28570099
285800                 TO DP013-MESSAGE-TEXT (1)                        28580099
285900             MOVE SQLCA            TO DP013-SQLCA                 28590099
286000             MOVE 'TRECDIS'        TO DP013-DB2-TABLE-NAME (1)    28600099
286100             MOVE 'XLT_LOC'        TO DP013-DB2-TABLE-NAME (2)    28610099
286200             SET DP013-DB2-ABEND   TO TRUE                        28620099
286300             SET DP013-NO-ROLLBACK TO TRUE                        28630099
286400             PERFORM 9999-WRITE-CICS-LOG-MSG                      28640099
286500             GO TO 0000-GOBACK                                    28650099
286600     END-EVALUATE.                                                28660099
286700                                                                  28670099
286800 4050-SELECT-PRIM-SHIP.                                           28680099
286900                                                                  28690099
287000     EXEC SQL                                                     28700099
287100         SELECT C.TRIP_ID                                         28710099
287200          INTO  :VHTRIP-TRIP-ID                                   28720099
287300           FROM TSHPTPO A                                         28730099
287400              , TSHIPMT B                                         28740099
287500              , TVHTRIP C                                         28750099
287600          WHERE A.PO_NBR         = :DK-ORD-NBR                    28760099
287700            AND A.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR               28770099
287800            AND A.SHIPT_ID       = B.SHIPT_ID                     28780099
287900            AND B.TRIP_ID        = C.TRIP_ID                      28790099
288000            AND A.PRIM_SHIPT_IND = :PC-Y                          28800099
288100     END-EXEC.                                                    28810099
288200                                                                  28820099
288300     EVALUATE TRUE                                                28830099
288400         WHEN SQLCODE = ZERO                                      28840099
288500             MOVE VHTRIP-TRIP-ID   TO HL2-TRIP-ID                 28850099
288600         WHEN SQLCODE = PC-ROW-NOT-FOUND                          28860099
288700             MOVE ZEROES           TO HL2-TRIP-ID                 28870099
288800             CONTINUE                                             28880099
288900         WHEN SQLWARN0 NOT = SPACE                                28890099
289000         WHEN SQLCODE < ZERO                                      28900099
289100         WHEN SQLCODE > ZERO                                      28910099
289200             MOVE '4050-SELECT-PRIM-SHIP '                        28920099
289300                 TO DP013-PARAGRAPH                               28930099
289400             MOVE 'ATTEMPTING TO SELECT TRIP ID  '                28940099
289500                 TO DP013-MESSAGE-TEXT (1)                        28950099
289600             MOVE SQLCA            TO DP013-SQLCA                 28960099
289700             MOVE 'TVHTRIP'        TO DP013-DB2-TABLE-NAME (1)    28970099
289800             SET DP013-DB2-ABEND   TO TRUE                        28980099
289900             SET DP013-NO-ROLLBACK TO TRUE                        28990099
290000             PERFORM 9999-WRITE-CICS-LOG-MSG                      29000099
290100             GO TO 0000-GOBACK                                    29010099
290200     END-EVALUATE.                                                29020099
290300                                                                  29030099
290400******************************************************************29040099
290500*GET THE LONG DESCRIPTION FOR ON THE MARKING APRON.               29050099
290600******************************************************************29060099
290700 4300-GET-TKT-DESC.                                               29070099
290800     INITIALIZE DCLTTKTFMT.                                       29080099
290900                                                                  29090099
291000     PERFORM                                                      29100099
291100         WITH TEST AFTER                                          29110099
291200         VARYING PV-SELECT-COUNTER                                29120099
291300         FROM 1 BY 1                                              29130099
291400         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              29140099
291500            OR  (SQLCODE = ZERO)                                  29150099
291600            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     29160099
291700      EXEC SQL                                                    29170099
291800          SELECT DISTINCT TKT_FMT_DESC                            29180099
291900                INTO :TKTFMT-TKT-FMT-DESC                         29190099
292000              FROM TTKTFMT                                        29200099
292100           WHERE                                                  29210099
292200              TKT_FMT_ID   = :DK-TKT-FMT-ID                       29220099
292300     END-EXEC                                                     29230099
292400                                                                  29240099
292500                                                                  29250099
292600         EVALUATE TRUE                                            29260099
292700             WHEN SQLCODE = ZERO                                  29270099
292800                 MOVE TKTFMT-TKT-FMT-DESC TO                      29280099
292900                                         HL13A-TICKET-TYPE        29290099
293000             WHEN SQLCODE = -904                                  29300099
293100             WHEN SQLCODE = -913                                  29310099
293200                 CONTINUE                                         29320099
293300             WHEN SQLCODE = PC-ROW-NOT-FOUND                      29330099
293400                 MOVE SPACES    TO                                29340099
293500                                   HL13A-TICKET-TYPE              29350099
293600             WHEN SQLCODE = PC-MULTIPLE-RESULT-SET-ROWS           29360099
293700                 MOVE TKTFMT-TKT-FMT-DESC TO                      29370099
293800                                   HL13A-TICKET-TYPE              29380099
293900             WHEN SQLWARN0 NOT = SPACES                           29390099
294000             WHEN SQLCODE < ZERO                                  29400099
294100             WHEN SQLCODE > ZERO                                  29410099
294200                  MOVE '4300-GET-TKT-DESC'                        29420099
294300                                 TO DP013-PARAGRAPH               29430099
294400                  MOVE 'UNSUCCESSFUL SELECT OF TTKTFMT'           29440099
294500                                 TO DP013-MESSAGE-TEXT (1)        29450099
294600                  MOVE DK-TKT-FMT-ID                              29460099
294700                                 TO DP013-MESSAGE-TEXT (2)        29470099
294800                  MOVE PV-DISPLAY-KEYS                            29480099
294900                                     TO DP013-MESSAGE-TEXT (2)    29490099
295000                  MOVE SQLCA         TO DP013-SQLCA               29500099
295100                  MOVE 'TTKTFMT'     TO DP013-DB2-TABLE-NAME (1)  29510099
295200                  SET DP013-DB2-ABEND                             29520099
295300                                     TO TRUE                      29530099
295400                  SET DP013-NO-ROLLBACK                           29540099
295500                                     TO TRUE                      29550099
295600                  PERFORM 9999-WRITE-CICS-LOG-MSG                 29560099
295700                  GO TO 0000-GOBACK                               29570099
295800         END-EVALUATE                                             29580099
295900     END-PERFORM.                                                 29590099
296000                                                                  29600099
296100     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE = ZERO    29610099
296200         MOVE '4300-GET-TKT-DESC'                                 29620099
296300                                     TO DP013-PARAGRAPH           29630099
296400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     29640099
296500                                     TO DP013-MESSAGE-TEXT (1)    29650099
296600         MOVE 'UNSUCCESSFUL SELECT OF TTKTFMT'                    29660099
296700                                 TO DP013-MESSAGE-TEXT (1)        29670099
296800         MOVE DK-TKT-FMT-ID                                       29680099
296900                                 TO DP013-MESSAGE-TEXT (2)        29690099
297000         MOVE SQLCA                  TO DP013-SQLCA               29700099
297100         MOVE 'TTKTFMT'              TO DP013-DB2-TABLE-NAME (1)  29710099
297200         MOVE 'TINSTCD'              TO DP013-DB2-TABLE-NAME (2)  29720099
297300         SET DP013-DB2-ABEND         TO TRUE                      29730099
297400         SET DP013-NO-ROLLBACK       TO TRUE                      29740099
297500         PERFORM 9999-WRITE-CICS-LOG-MSG                          29750099
297600         GO TO 0000-GOBACK                                        29760099
297700     END-IF.                                                      29770099
297800 EJECT                                                            29780099
297900                                                                  29790099
298000******************************************************************29800099
298100*GET THE LONG DESCRIPTION FOR ON THE MARKING APRON.               29810099
298200******************************************************************29820099
298300 4310-GET-TKT-PLACEMENT.                                          29830099
298400     INITIALIZE DCLTPTKREQ                                        29840099
298500                DCLTPTKLNE                                        29850099
298600                DCLTPLDESC.                                       29860099
298700                                                                  29870099
298800     PERFORM                                                      29880099
298900         WITH TEST AFTER                                          29890099
299000         VARYING PV-SELECT-COUNTER                                29900099
299100         FROM 1 BY 1                                              29910099
299200         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              29920099
299300            OR  (SQLCODE = ZERO)                                  29930099
299400            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     29940099
299500      EXEC SQL                                                    29950099
299600      SELECT                                                      29960099
299700              A.PO_NBR,                                           29970099
299800              A.PO_REQ_NBR,                                       29980099
299900              B.PO_LNE_NBR,                                       29990099
300000              B.TKT_PLCMNT_CDE,                                   30000099
300100              C.TKT_PLCMNT_DESC                                   30010099
300200         INTO  :PTKREQ-PO-NBR                                     30020099
300300             , :PTKREQ-PO-REQ-NBR                                 30030099
300400             , :PTKLNE-PO-LNE-NBR                                 30040099
300500             , :PTKLNE-TKT-PLCMNT-CDE                             30050099
300600             , :PLDESC-TKT-PLCMNT-DESC                            30060099
300700         FROM                                                     30070099
300800              TPTKREQ A                                           30080099
300900             ,TPTKLNE B                                           30090099
301000             ,TPLDESC C                                           30100099
301100         WHERE  A.PO_NBR = :DK-ORD-NBR                            30110099
301200           AND  B.PO_LNE_NBR =  :DK-ORD-LNE-NBR                   30120099
301300           AND  A.PO_REQ_NBR = B.PO_REQ_NBR                       30130099
301400           AND  B.TKT_PLCMNT_CDE = C.TKT_PLCMNT_CDE               30140099
301500     END-EXEC                                                     30150099
301600                                                                  30160099
301700                                                                  30170099
301800         EVALUATE TRUE                                            30180099
301900             WHEN SQLCODE = ZERO                                  30190099
302000                 MOVE PLDESC-TKT-PLCMNT-DESC TO                   30200099
302100                      HL13A-TICKET-PLACEMENT                      30210099
302200             WHEN SQLCODE = -904                                  30220099
302300             WHEN SQLCODE = -913                                  30230099
302400                 CONTINUE                                         30240099
302500             WHEN SQLCODE = PC-ROW-NOT-FOUND                      30250099
302600                 MOVE SPACES TO  HL13A-TICKET-PLACEMENT           30260099
302700             WHEN SQLCODE = PC-MULTIPLE-RESULT-SET-ROWS           30270099
302800                 MOVE PLDESC-TKT-PLCMNT-DESC TO                   30280099
302900                                         HL13A-TICKET-PLACEMENT   30290099
303000             WHEN SQLWARN0 NOT = SPACES                           30300099
303100             WHEN SQLCODE < ZERO                                  30310099
303200             WHEN SQLCODE > ZERO                                  30320099
303300                  MOVE '4310-GET-TKT-PLACEMENT'                   30330099
303400                                 TO DP013-PARAGRAPH               30340099
303500                  MOVE 'UNSUCCESSFUL SELECT OF PLACMNT'           30350099
303600                                 TO DP013-MESSAGE-TEXT (1)        30360099
303700                  MOVE DK-ORD-NBR                                 30370099
303800                                 TO DP013-MESSAGE-TEXT (2)        30380099
303900                  MOVE SQLCA         TO DP013-SQLCA               30390099
304000                  MOVE 'TPTKREQ'     TO DP013-DB2-TABLE-NAME (1)  30400099
304100                  MOVE 'TPTKLNE'     TO DP013-DB2-TABLE-NAME (2)  30410099
304200                  MOVE 'TPLDESC'     TO DP013-DB2-TABLE-NAME (3)  30420099
304300                  SET DP013-DB2-ABEND                             30430099
304400                                     TO TRUE                      30440099
304500                  SET DP013-NO-ROLLBACK                           30450099
304600                                     TO TRUE                      30460099
304700                  PERFORM 9999-WRITE-CICS-LOG-MSG                 30470099
304800                  GO TO 0000-GOBACK                               30480099
304900         END-EVALUATE                                             30490099
305000     END-PERFORM.                                                 30500099
305100                                                                  30510099
305200     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE = ZERO    30520099
305300         MOVE '4310-GET-TKT-PLACEMENT'                            30530099
305400                                     TO DP013-PARAGRAPH           30540099
305500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     30550099
305600                                     TO DP013-MESSAGE-TEXT (1)    30560099
305700         MOVE 'UNSUCCESSFUL SELECT OF TPLDESC'                    30570099
305800                                 TO DP013-MESSAGE-TEXT (1)        30580099
305900         MOVE DK-ORD-NBR                                          30590099
306000                                 TO DP013-MESSAGE-TEXT (2)        30600099
306100         MOVE SQLCA                  TO DP013-SQLCA               30610099
306200         MOVE 'TPTKREQ'              TO DP013-DB2-TABLE-NAME (1)  30620099
306300         MOVE 'TPTKLNE'              TO DP013-DB2-TABLE-NAME (2)  30630099
306400         MOVE 'TPLDESC'              TO DP013-DB2-TABLE-NAME (3)  30640099
306500         SET DP013-DB2-ABEND         TO TRUE                      30650099
306600         SET DP013-NO-ROLLBACK       TO TRUE                      30660099
306700         PERFORM 9999-WRITE-CICS-LOG-MSG                          30670099
306800         GO TO 0000-GOBACK                                        30680099
306900     END-IF.                                                      30690099
307000 EJECT                                                            30700099
307100 7000-OPEN-STR-NBR-CSR.                                           30710099
307200     EXEC SQL                                                     30720099
307300         OPEN STR-NBR-CSR                                         30730099
307400     END-EXEC.                                                    30740099
307500                                                                  30750099
307600     EVALUATE TRUE                                                30760099
307700         WHEN SQLCODE = ZERO                                      30770099
307800             CONTINUE                                             30780099
307900         WHEN SQLWARN0 NOT = SPACE                                30790099
308000         WHEN SQLCODE < ZERO                                      30800099
308100         WHEN SQLCODE > ZERO                                      30810099
308200             MOVE '7000-OPEN-STR-NBR-CSR'                         30820099
308300                 TO DP013-PARAGRAPH                               30830099
308400             MOVE 'OPEN THE STR-NBR-CSR'                          30840099
308500                 TO DP013-MESSAGE-TEXT (1)                        30850099
308600             MOVE SQLCA              TO DP013-SQLCA               30860099
308700             MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (1)  30870099
308800             MOVE 'XLT_DC_LOC_ASGMT' TO DP013-DB2-TABLE-NAME (2)  30880099
308900             SET DP013-DB2-ABEND     TO TRUE                      30890099
309000             SET DP013-NO-ROLLBACK   TO TRUE                      30900099
309100             PERFORM 9999-WRITE-CICS-LOG-MSG                      30910099
309200             GO TO 0000-GOBACK                                    30920099
309300     END-EVALUATE.                                                30930099
309400*                                                                 30940099
309500     SKIP3                                                        30950099
309600 7010-FETCH-STR-NBR-CSR.                                          30960099
309700                                                                  30970099
309800     EXEC SQL                                                     30980099
309900         FETCH  STR-NBR-CSR                                       30990099
310000          INTO  :XLT00010-LOC-NBR                                 31000099
310100             ,  :XLT00010-LOC-5-ABBR-NM                           31010099
310200             ,  :XLT00010-CLO-DTE                                 31020099
310300             ,  :PV-EFF-CLOSE-DATE                                31030099
310400             ,  :XLT00014-EFF-BEG-DTE                             31040099
310500             ,  :XLT00014-DC-NBR                                  31050099
310600     END-EXEC.                                                    31060099
310700                                                                  31070099
310800     EVALUATE TRUE                                                31080099
310900         WHEN SQLCODE = ZERO                                      31090099
311000* * PV-EFF-CLOSE-DATE IS CALCULATED IN THE DECLARE, BUT           31100099
311100* * THERE IS NO CHECK TO SEE IF THE STORE IS CLOSED OR NOT        31110099
311200             IF XLT00010-CLO-DTE = '9999-09-99'                   31120099
311300                 MOVE '9999-09-09'   TO PV-EFF-CLOSE-DATE         31130099
311400             END-IF                                               31140099
311500         WHEN SQLCODE = PC-ROW-NOT-FOUND                          31150099
311600             CONTINUE                                             31160099
311700         WHEN SQLWARN0 NOT = SPACE                                31170099
311800         WHEN SQLCODE < ZERO                                      31180099
311900         WHEN SQLCODE > ZERO                                      31190099
312000             MOVE '7010-FETCH-STR-NBR-CSR'                        31200099
312100                 TO DP013-PARAGRAPH                               31210099
312200             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 31220099
312300-                 'FROM THE STR-NBR-CSR'                          31230099
312400                 TO DP013-MESSAGE-TEXT (1)                        31240099
312500             MOVE SQLCA              TO DP013-SQLCA               31250099
312600             MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (1)  31260099
312700             MOVE 'XLT_DC_LOC_ASGMT' TO DP013-DB2-TABLE-NAME (2)  31270099
312800             SET DP013-DB2-ABEND     TO TRUE                      31280099
312900             SET DP013-NO-ROLLBACK   TO TRUE                      31290099
313000             PERFORM 9999-WRITE-CICS-LOG-MSG                      31300099
313100             GO TO 0000-GOBACK                                    31310099
313200     END-EVALUATE.                                                31320099
313300     SKIP3                                                        31330099
313400 7020-CLOSE-STR-NBR-CSR.                                          31340099
313500     EXEC SQL                                                     31350099
313600         CLOSE STR-NBR-CSR                                        31360099
313700     END-EXEC.                                                    31370099
313800                                                                  31380099
313900     EVALUATE TRUE                                                31390099
314000         WHEN SQLCODE = ZERO                                      31400099
314100             CONTINUE                                             31410099
314200         WHEN SQLWARN0 NOT = SPACE                                31420099
314300         WHEN SQLCODE < ZERO                                      31430099
314400         WHEN SQLCODE > ZERO                                      31440099
314500             MOVE '7020-CLOSE-STR-NBR-CSR'                        31450099
314600                 TO DP013-PARAGRAPH                               31460099
314700             MOVE 'CLOSE THE STR-NBR-CSR'                         31470099
314800                 TO DP013-MESSAGE-TEXT (1)                        31480099
314900             MOVE SQLCA              TO DP013-SQLCA               31490099
315000             MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (1)  31500099
315100             MOVE 'XLT_DC_LOC_ASGMT' TO DP013-DB2-TABLE-NAME (2)  31510099
315200             SET DP013-DB2-ABEND   TO TRUE                        31520099
315300             SET DP013-NO-ROLLBACK TO TRUE                        31530099
315400             PERFORM 9999-WRITE-CICS-LOG-MSG                      31540099
315500             GO TO 0000-GOBACK                                    31550099
315600     END-EVALUATE.                                                31560099
315700 EJECT                                                            31570099
315800 7100-SELECT-PO-HDR-DATA.                                         31580099
315900     INITIALIZE DCLTPURCHS                                        31590099
316000                DCLTSTATCD.                                       31600099
316100                                                                  31610099
316200     PERFORM                                                      31620099
316300         WITH TEST AFTER                                          31630099
316400         VARYING PV-SELECT-COUNTER                                31640099
316500         FROM 1 BY 1                                              31650099
316600         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              31660099
316700            OR  (SQLCODE = ZERO)                                  31670099
316800            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     31680099
316900                                                                  31690099
317000         EXEC SQL                                                 31700099
317100             SELECT  A.ENT_ID                                     31710099
317200                   , A.DEPT_NBR                                   31720099
317300               INTO  :PURCHS-ENT-ID                               31730099
317400                   , :PURCHS-DEPT-NBR                             31740099
317500               FROM  TPURCHS A,                                   31750099
317600                     TSTATCD B                                    31760099
317700              WHERE  A.PO_NBR          =  :DK-ORD-NBR             31770099
317800                AND  A.VER_STATUS_CDE  =  'A'                     31780099
317900                AND  B.STATUS_TYP_CDE  =  'P'                     31790099
318000                AND  B.STATUS_CLS      IN ('ACT', 'CMP')          31800099
318100                AND  A.STATUS_CDE      =  B.STATUS_CDE            31810099
318200         END-EXEC                                                 31820099
318300                                                                  31830099
318400         EVALUATE TRUE                                            31840099
318500             WHEN SQLCODE = ZERO                                  31850099
318600             WHEN SQLCODE = -904                                  31860099
318700             WHEN SQLCODE = -913                                  31870099
318800             WHEN SQLCODE = PC-ROW-NOT-FOUND                      31880099
318900                  CONTINUE                                        31890099
319000             WHEN SQLWARN0 NOT = SPACES                           31900099
319100             WHEN SQLCODE < ZERO                                  31910099
319200             WHEN SQLCODE > ZERO                                  31920099
319300                  MOVE '7100-SELECT-PO-HDR-DATA'                  31930099
319400                                     TO DP013-PARAGRAPH           31940099
319500                  MOVE 'SELECT INFO FOR THE FOLLOWING RECEIVER: ' 31950099
319600                                     TO DP013-MESSAGE-TEXT (1)    31960099
319700                  MOVE DK-ORD-NBR    TO  PV-DISPLAY-ORD-NBR       31970099
319800                  MOVE ZEROES        TO  PV-DISPLAY-ORD-LNE-NBR   31980099
319900                  MOVE PV-DISPLAY-KEYS                            31990099
320000                                     TO DP013-MESSAGE-TEXT (2)    32000099
320100                  MOVE SQLCA         TO DP013-SQLCA               32010099
320200                  MOVE 'TPURCHS'     TO DP013-DB2-TABLE-NAME (1)  32020099
320300                  MOVE 'TSTATCD'     TO DP013-DB2-TABLE-NAME (2)  32030099
320400                  SET DP013-DB2-ABEND                             32040099
320500                                     TO TRUE                      32050099
320600                  SET DP013-NO-ROLLBACK                           32060099
320700                                     TO TRUE                      32070099
320800                  PERFORM 9999-WRITE-CICS-LOG-MSG                 32080099
320900                  GO TO 0000-GOBACK                               32090099
321000         END-EVALUATE                                             32100099
321100     END-PERFORM.                                                 32110099
321200                                                                  32120099
321300     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE > ZERO    32130099
321400         MOVE '7100-SELECT-PO-HDR-DATA' TO DP013-PARAGRAPH        32140099
321500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     32150099
321600                                     TO DP013-MESSAGE-TEXT (1)    32160099
321700         MOVE 'THE FOLLOWING RECEIVER: '                          32170099
321800                                     TO DP013-MESSAGE-TEXT (2)    32180099
321900         MOVE DK-ORD-NBR             TO  PV-DISPLAY-ORD-NBR       32190099
322000         MOVE ZERO                   TO  PV-DISPLAY-ORD-LNE-NBR   32200099
322100         MOVE PV-DISPLAY-KEYS        TO DP013-MESSAGE-TEXT (3)    32210099
322200         MOVE SQLCA                  TO DP013-SQLCA               32220099
322300         MOVE 'TPURCHS'              TO DP013-DB2-TABLE-NAME (1)  32230099
322400         MOVE 'TPURITM'              TO DP013-DB2-TABLE-NAME (2)  32240099
322500         MOVE 'TSTATCD'              TO DP013-DB2-TABLE-NAME (3)  32250099
322600         SET DP013-DB2-ABEND         TO TRUE                      32260099
322700         SET DP013-NO-ROLLBACK       TO TRUE                      32270099
322800         PERFORM 9999-WRITE-CICS-LOG-MSG                          32280099
322900         GO TO 0000-GOBACK                                        32290099
323000     END-IF.                                                      32300099
323100     EJECT                                                        32310099
323200 7110-GET-KEYREC-NBR.                                             32320099
323300     INITIALIZE DCLTRECEIV.                                       32330099
323400                                                                  32340099
323500     PERFORM                                                      32350099
323600         WITH TEST AFTER                                          32360099
323700         VARYING PV-SELECT-COUNTER                                32370099
323800         FROM 1 BY 1                                              32380099
323900         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              32390099
324000            OR  (SQLCODE = ZERO)                                  32400099
324100            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     32410099
324200                                                                  32420099
324300         EXEC SQL                                                 32430099
324400             SELECT  ACTL_CART_CNT,                               32440099
324500                     EXPTED_CART_CNT,                             32450099
324600                     RCVR_NBR,                                    32460099
324700                     REC_TMST,                                    32470099
324800                     GOH_IND,                                     32480099
324900                     PKGNG_CDE                                    32490099
325000               INTO  :RECEIV-ACTL-CART-CNT,                       32500099
325100                     :RECEIV-EXPTED-CART-CNT,                     32510099
325200                     :RECEIV-RCVR-NBR,                            32520099
325300                     :PV-REC-TMST,                                32530099
325400                     :RECEIV-GOH-IND,                             32540099
325500                     :RECEIV-PKGNG-CDE                            32550099
325600               FROM  TRECEIV                                      32560099
325700              WHERE  (ORD_NBR         =  :DK-ORD-NBR              32570099
325800                AND   REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR         32580099
325900                AND   OPER_UNT_ID     =  :DK-OPER-UNT-ID          32590099
326000                AND   FCLTY_ID        =  :DK-FCLTY-ID             32600099
326100                AND   VER_STATUS_CDE  =  'A')                     32610099
326200         END-EXEC                                                 32620099
326300                                                                  32630099
326400         EVALUATE TRUE                                            32640099
326500             WHEN SQLCODE = ZERO                                  32650099
326600             WHEN SQLCODE = -904                                  32660099
326700             WHEN SQLCODE = -913                                  32670099
326800             WHEN SQLCODE = PC-ROW-NOT-FOUND                      32680099
326900                 CONTINUE                                         32690099
327000             WHEN SQLWARN0 NOT = SPACES                           32700099
327100             WHEN SQLCODE < ZERO                                  32710099
327200             WHEN SQLCODE > ZERO                                  32720099
327300                  MOVE '7110-GET-KEYREC-NBR'                      32730099
327400                                     TO DP013-PARAGRAPH           32740099
327500                  MOVE 'SELECT SPECIAL INSTRUCTIONS  KEYS = '     32750099
327600                                     TO DP013-MESSAGE-TEXT (1)    32760099
327700                  MOVE DK-ORD-NBR    TO PV-DISPLAY-ORD-NBR        32770099
327800                  MOVE DK-RCVR-SEQ-NBR                            32780099
327900                                     TO PV-DISPLAY-RCVR-SEQ-NBR   32790099
328000                  MOVE DK-OPER-UNT-ID                             32800099
328100                                     TO PV-DISPLAY-OPER-UNT-ID    32810099
328200                  MOVE DK-FCLTY-ID   TO PV-DISPLAY-FCLTY-ID       32820099
328300                  MOVE PV-DISPLAY-KEYS                            32830099
328400                                     TO DP013-MESSAGE-TEXT (2)    32840099
328500                  MOVE SQLCA         TO DP013-SQLCA               32850099
328600                  MOVE 'TRECEIV'     TO DP013-DB2-TABLE-NAME (1)  32860099
328700                  SET DP013-DB2-ABEND                             32870099
328800                                     TO TRUE                      32880099
328900                  SET DP013-NO-ROLLBACK                           32890099
329000                                     TO TRUE                      32900099
329100                  PERFORM 9999-WRITE-CICS-LOG-MSG                 32910099
329200                  GO TO 0000-GOBACK                               32920099
329300         END-EVALUATE                                             32930099
329400     END-PERFORM.                                                 32940099
329500                                                                  32950099
329600     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE > ZERO    32960099
329700         MOVE '7110-GET-KEYREC-NBR'                               32970099
329800                                     TO DP013-PARAGRAPH           32980099
329900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     32990099
330000                                     TO DP013-MESSAGE-TEXT (1)    33000099
330100         MOVE 'THE KEYREC NUMBER.  KEYS = '                       33010099
330200                                     TO DP013-MESSAGE-TEXT (2)    33020099
330300         MOVE DK-ORD-NBR             TO PV-DISPLAY-ORD-NBR        33030099
330400         MOVE DK-RCVR-SEQ-NBR        TO PV-DISPLAY-RCVR-SEQ-NBR   33040099
330500         MOVE DK-OPER-UNT-ID         TO PV-DISPLAY-OPER-UNT-ID    33050099
330600         MOVE DK-FCLTY-ID            TO PV-DISPLAY-FCLTY-ID       33060099
330700         MOVE PV-DISPLAY-KEYS        TO DP013-MESSAGE-TEXT (3)    33070099
330800         MOVE SQLCA                  TO DP013-SQLCA               33080099
330900         MOVE 'TRECEIV'              TO DP013-DB2-TABLE-NAME (1)  33090099
331000         SET DP013-DB2-ABEND         TO TRUE                      33100099
331100         SET DP013-NO-ROLLBACK       TO TRUE                      33110099
331200         PERFORM 9999-WRITE-CICS-LOG-MSG                          33120099
331300         GO TO 0000-GOBACK                                        33130099
331400     END-IF.                                                      33140099
331500/                                                                 33150099
331600 7120-GET-PRIMARY-VNDR-NME.                                       33160099
331700     INITIALIZE DCLTENTNME.                                       33170099
331800                                                                  33180099
331900     PERFORM                                                      33190099
332000         WITH TEST AFTER                                          33200099
332100         VARYING PV-SELECT-COUNTER                                33210099
332200         FROM 1 BY 1                                              33220099
332300         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              33230099
332400            OR   (SQLCODE = ZERO)                                 33240099
332500            OR   (SQLCODE = PC-ROW-NOT-FOUND))                    33250099
332600                                                                  33260099
332700         EXEC SQL                                                 33270099
332800             SELECT  ENT_NAME_DESC                                33280099
332900               INTO  :ENTNME-ENT-NAME-DESC                        33290099
333000               FROM  TENTNME                                      33300099
333100              WHERE  (ENT_ID    =  :PURCHS-ENT-ID                 33310099
333200                AND   TYPE_CDE  =  '01')                          33320099
333300         END-EXEC                                                 33330099
333400                                                                  33340099
333500         EVALUATE TRUE                                            33350099
333600             WHEN SQLCODE = ZERO                                  33360099
333700             WHEN SQLCODE = -904                                  33370099
333800             WHEN SQLCODE = -913                                  33380099
333900             WHEN SQLCODE = PC-ROW-NOT-FOUND                      33390099
334000                  CONTINUE                                        33400099
334100             WHEN SQLWARN0 NOT = SPACES                           33410099
334200             WHEN SQLCODE < ZERO                                  33420099
334300             WHEN SQLCODE > ZERO                                  33430099
334400                  MOVE '7120-GET-PRIMARY-VNDR-NME'                33440099
334500                                     TO DP013-PARAGRAPH           33450099
334600                  MOVE 'SELECT PRIMARY VENDOR NAME ENT ID = '     33460099
334700                                     TO DP013-MESSAGE-TEXT (1)    33470099
334800                  MOVE PURCHS-ENT-ID TO PV-DISPLAY-ENT-ID         33480099
334900                  MOVE PV-DISPLAY-ENT-ID                          33490099
335000                                     TO DP013-MESSAGE-TEXT (2)    33500099
335100                  MOVE SQLCA         TO DP013-SQLCA               33510099
335200                  MOVE 'TENTNME'     TO DP013-DB2-TABLE-NAME (1)  33520099
335300                  SET DP013-DB2-ABEND                             33530099
335400                                     TO TRUE                      33540099
335500                  SET DP013-NO-ROLLBACK                           33550099
335600                                     TO TRUE                      33560099
335700                  PERFORM 9999-WRITE-CICS-LOG-MSG                 33570099
335800                  GO TO 0000-GOBACK                               33580099
335900         END-EVALUATE                                             33590099
336000     END-PERFORM.                                                 33600099
336100                                                                  33610099
336200     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE > ZERO    33620099
336300         MOVE '7120-GET-PRIMARY-VNDR-NME'                         33630099
336400                                     TO DP013-PARAGRAPH           33640099
336500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     33650099
336600                                     TO DP013-MESSAGE-TEXT (1)    33660099
336700         MOVE 'THE PRIMARY VENDOR NAME.  ENT ID = '               33670099
336800                                     TO DP013-MESSAGE-TEXT (2)    33680099
336900         MOVE PURCHS-ENT-ID          TO PV-DISPLAY-ENT-ID         33690099
337000         MOVE PV-DISPLAY-ENT-ID      TO DP013-MESSAGE-TEXT (3)    33700099
337100         MOVE SQLCA                  TO DP013-SQLCA               33710099
337200         MOVE 'TENTNME'              TO DP013-DB2-TABLE-NAME (1)  33720099
337300         SET DP013-DB2-ABEND         TO TRUE                      33730099
337400         SET DP013-NO-ROLLBACK       TO TRUE                      33740099
337500         PERFORM 9999-WRITE-CICS-LOG-MSG                          33750099
337600         GO TO 0000-GOBACK                                        33760099
337700     END-IF.                                                      33770099
337800/                                                                 33780099
337900 7130-GET-CERT-INFO.                                              33790099
338000     INITIALIZE PV-DB2-CURRENT-DATE.                              33800099
338100                                                                  33810099
338200     EXEC SQL                                                     33820099
338300         SELECT  CURRENT DATE                                     33830099
338400           INTO  :PV-DB2-CURRENT-DATE                             33840099
338500           FROM  TVNDAGR                                          33850099
338600          WHERE  (ENT_ID        =  :PURCHS-ENT-ID                 33860099
338700            AND   DEPT_NBR      =  :PURCHS-DEPT-NBR               33870099
338800            AND   AGRMT_TYP_ID  =  '4'                            33880099
338900            AND   TYP_CDE       =  3                              33890099
339000            AND  (CHAR(CURRENT DATE, ISO)                         33900099
339100                  BETWEEN                                         33910099
339200                  CHAR(EFFECTIVE_DATE,ISO)                        33920099
339300                      AND                                         33930099
339400                  CHAR(EXPIRATION_DATE,ISO)))                     33940099
339500     END-EXEC.                                                    33950099
339600                                                                  33960099
339700     EVALUATE TRUE                                                33970099
339800         WHEN SQLCODE = ZERO                                      33980099
339900         WHEN SQLCODE = -811                                      33990099
340000             CONTINUE                                             34000099
340100         WHEN SQLCODE = +100                                      34010099
340200             SET PS-NO-TVNDAGR TO TRUE                            34020099
340300         WHEN SQLWARN0 NOT = SPACES                               34030099
340400         WHEN SQLCODE < ZERO                                      34040099
340500         WHEN SQLCODE > ZERO                                      34050099
340600              MOVE '7130-GET-CERT-INFO'                           34060099
340700                                     TO  DP013-PARAGRAPH          34070099
340800              MOVE 'SELECT INFO FOR THE FOLLOWING ENT-ID/DEPT: '  34080099
340900                                     TO  DP013-MESSAGE-TEXT (1)   34090099
341000              MOVE PURCHS-ENT-ID     TO  DP013-MESSAGE-TEXT (2)   34100099
341100              MOVE PURCHS-DEPT-NBR   TO  DP013-MESSAGE-TEXT (3)   34110099
341200*             MOVE PV-DISPLAY-KEYS   TO  DP013-MESSAGE-TEXT (2)   34120099
341300              MOVE SQLCA             TO  DP013-SQLCA              34130099
341400              MOVE 'TVNDAGR'         TO  DP013-DB2-TABLE-NAME (1) 34140099
341500              SET DP013-DB2-ABEND    TO  TRUE                     34150099
341600              SET DP013-NO-ROLLBACK  TO  TRUE                     34160099
341700              PERFORM 9999-WRITE-CICS-LOG-MSG                     34170099
341800              GO TO 0000-GOBACK                                   34180099
341900     END-EVALUATE.                                                34190099
342000/                                                                 34200099
342100 7140-GET-SPECIAL-INSTRS.                                         34210099
342200     INITIALIZE DCLTPOINST                                        34220099
342300                DCLTINSTCD.                                       34230099
342400                                                                  34240099
342500     PERFORM                                                      34250099
342600         WITH TEST AFTER                                          34260099
342700         VARYING PV-SELECT-COUNTER                                34270099
342800         FROM 1 BY 1                                              34280099
342900         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              34290099
343000            OR  (SQLCODE = ZERO)                                  34300099
343100            OR  (SQLCODE = PC-ROW-NOT-FOUND)                      34310099
343200            OR  (SQLCODE = PC-MULTIPLE-RESULT-SET-ROWS))          34320099
343300                                                                  34330099
343400         EXEC SQL                                                 34340099
343500             SELECT  B.INSTR_DESC                                 34350099
343600               INTO  :INSTCD-INSTR-DESC                           34360099
343700               FROM  TPOINST A,                                   34370099
343800                     TINSTCD B                                    34380099
343900              WHERE  (A.PO_NBR     =  :DK-ORD-NBR                 34390099
344000                AND   A.RECIP_CDE  =  'DC'                        34400099
344100                AND   A.INSTR_NBR  =  B.INSTR_NBR)                34410099
344200         END-EXEC                                                 34420099
344300                                                                  34430099
344400         EVALUATE TRUE                                            34440099
344500             WHEN SQLCODE = ZERO                                  34450099
344600                 CONTINUE                                         34460099
344700             WHEN SQLCODE = -904                                  34470099
344800             WHEN SQLCODE = -913                                  34480099
344900                 CONTINUE                                         34490099
345000             WHEN SQLCODE = PC-ROW-NOT-FOUND                      34500099
345100                 SET PS-NO-SPECIAL-INSTRS-FOUND    TO  TRUE       34510099
345200             WHEN SQLCODE = PC-MULTIPLE-RESULT-SET-ROWS           34520099
345300                 SET PS-MULT-SPECIAL-INSTRS-FOUND  TO  TRUE       34530099
345400             WHEN SQLWARN0 NOT = SPACES                           34540099
345500             WHEN SQLCODE < ZERO                                  34550099
345600             WHEN SQLCODE > ZERO                                  34560099
345700                  MOVE '7140-GET-SPECIAL-INSTRS'                  34570099
345800                                     TO DP013-PARAGRAPH           34580099
345900                  MOVE 'SELECT SPECIAL INSTRUCTIONS  KEYS = '     34590099
346000                                     TO DP013-MESSAGE-TEXT (1)    34600099
346100                  MOVE DK-ORD-NBR    TO PV-DISPLAY-ORD-NBR        34610099
346200                  MOVE PV-DISPLAY-KEYS                            34620099
346300                                     TO DP013-MESSAGE-TEXT (2)    34630099
346400                  MOVE SQLCA         TO DP013-SQLCA               34640099
346500                  MOVE 'TPOINST'     TO DP013-DB2-TABLE-NAME (1)  34650099
346600                  MOVE 'TINSTCD'     TO DP013-DB2-TABLE-NAME (2)  34660099
346700                  SET DP013-DB2-ABEND                             34670099
346800                                     TO TRUE                      34680099
346900                  SET DP013-NO-ROLLBACK                           34690099
347000                                     TO TRUE                      34700099
347100                  PERFORM 9999-WRITE-CICS-LOG-MSG                 34710099
347200                  GO TO 0000-GOBACK                               34720099
347300         END-EVALUATE                                             34730099
347400     END-PERFORM.                                                 34740099
347500                                                                  34750099
347600     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE = ZERO    34760099
347700         MOVE '7140-GET-SPECIAL-INSTRS'                           34770099
347800                                     TO DP013-PARAGRAPH           34780099
347900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     34790099
348000                                     TO DP013-MESSAGE-TEXT (1)    34800099
348100         MOVE 'THE SPECIAL INSTRUCTIONS.  KEYS = '                34810099
348200                                     TO DP013-MESSAGE-TEXT (2)    34820099
348300         MOVE DK-ORD-NBR             TO PV-DISPLAY-ORD-NBR        34830099
348400         MOVE PV-DISPLAY-KEYS        TO DP013-MESSAGE-TEXT (3)    34840099
348500         MOVE SQLCA                  TO DP013-SQLCA               34850099
348600         MOVE 'TPOINST'              TO DP013-DB2-TABLE-NAME (1)  34860099
348700         MOVE 'TINSTCD'              TO DP013-DB2-TABLE-NAME (2)  34870099
348800         SET DP013-DB2-ABEND         TO TRUE                      34880099
348900         SET DP013-NO-ROLLBACK       TO TRUE                      34890099
349000         PERFORM 9999-WRITE-CICS-LOG-MSG                          34900099
349100         GO TO 0000-GOBACK                                        34910099
349200     END-IF.                                                      34920099
349300/                                                                 34930099
349400 7200-SELECT-PURITM-DATA.                                         34940099
349500     INITIALIZE DCLTPURITM                                        34950099
349600                                                                  34960099
349700     PERFORM                                                      34970099
349800         WITH TEST AFTER                                          34980099
349900         VARYING PV-SELECT-COUNTER                                34990099
350000         FROM 1 BY 1                                              35000099
350100         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              35010099
350200            OR  (SQLCODE = ZERO)                                  35020099
350300            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     35030099
350400                                                                  35040099
350500         EXEC SQL                                                 35050099
350600             SELECT  A.SKU_SEQ_NBR,                               35060099
350700                     A.VEND_STYL_NAME,                            35070099
350800                     A.SKU_DESC,                                  35080099
350900                     A.SIZE_DESC,                                 35090099
351000                     A.COLOR_DESC,                                35100099
351100                     A.UNT_RTL_PR_AMT,                            35110099
351200                     A.ITM_NBR                                    35120099
351300                   , A.PO_LNE_NBR                                 35130099
351400                   , A.PIC_ITM_IND                                35140099
351500                   , B.TKT_FMT_ID                                 35150099
351600                   , B.PRE_TKT_IND                                35160099
351700               INTO  :PURITM-SKU-SEQ-NBR,                         35170099
351800                     :PURITM-VEND-STYL-NAME,                      35180099
351900                     :PURITM-SKU-DESC,                            35190099
352000                     :PURITM-SIZE-DESC,                           35200099
352100                     :PURITM-COLOR-DESC,                          35210099
352200                     :PURITM-UNT-RTL-PR-AMT,                      35220099
352300                     :PURITM-ITM-NBR,                             35230099
352400                     :PURITM-PO-LNE-NBR,                          35240099
352500                     :PURITM-PIC-ITM-IND,                         35250099
352600                     :RECITM-TKT-FMT-ID,                          35260099
352700                     :RECITM-PRE-TKT-IND                          35270099
352800               FROM  TPURITM A                                    35280099
352900                  ,  TRECITM B                                    35290099
353000              WHERE  A.PO_NBR          =  :DK-ORD-NBR             35300099
353100                AND  A.PO_NBR          =  B.ORD_NBR               35310099
353200                AND  A.APP_PO_LNE_NBR  =  :DK-ORD-LNE-NBR         35320099
353300                AND  A.APP_PO_LNE_NBR  =  B.ORD_LNE_NBR           35330099
353400                AND  A.VER_NBR         =  B.PO_VER_NBR            35340099
353500                AND  B.REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR        35350099
353600                AND  B.OPER_UNT_ID     =  :DK-OPER-UNT-ID         35360099
353700                AND  B.FCLTY_ID        =  :DK-FCLTY-ID            35370099
353800                AND  B.VER_STATUS_CDE  =  :PC-A                   35380099
353900         END-EXEC                                                 35390099
354000                                                                  35400099
354100         EVALUATE TRUE                                            35410099
354200             WHEN SQLCODE = ZERO                                  35420099
354300                  SET PS-CALL-API-YES TO TRUE                     35430099
354400             WHEN SQLCODE = -904                                  35440099
354500             WHEN SQLCODE = -913                                  35450099
354600             WHEN SQLCODE = PC-ROW-NOT-FOUND                      35460099
354700                  SET PS-CALL-API-NO  TO TRUE                     35470099
354800             WHEN SQLWARN0 NOT = SPACES                           35480099
354900             WHEN SQLCODE < ZERO                                  35490099
355000             WHEN SQLCODE > ZERO                                  35500099
355100                  MOVE '7200-SELECT-PURITM-DATA'                  35510099
355200                                     TO DP013-PARAGRAPH           35520099
355300                  MOVE 'SELECT INFO FOR THE FOLLOWING RECEIVER: ' 35530099
355400                                     TO DP013-MESSAGE-TEXT (1)    35540099
355500                  MOVE DK-ORD-NBR    TO  PV-DISPLAY-ORD-NBR       35550099
355600                  MOVE DK-ORD-LNE-NBR                             35560099
355700                                     TO  PV-DISPLAY-ORD-LNE-NBR   35570099
355800                  MOVE PV-DISPLAY-KEYS                            35580099
355900                                     TO DP013-MESSAGE-TEXT (2)    35590099
356000                  MOVE SQLCA         TO DP013-SQLCA               35600099
356100                  MOVE 'TPURITM'     TO DP013-DB2-TABLE-NAME (1)  35610099
356200                  MOVE 'TSTATCD'     TO DP013-DB2-TABLE-NAME (2)  35620099
356300                  SET DP013-DB2-ABEND                             35630099
356400                                     TO TRUE                      35640099
356500                  SET DP013-NO-ROLLBACK                           35650099
356600                                     TO TRUE                      35660099
356700                  PERFORM 9999-WRITE-CICS-LOG-MSG                 35670099
356800                  GO TO 0000-GOBACK                               35680099
356900         END-EVALUATE                                             35690099
357000     END-PERFORM.                                                 35700099
357100                                                                  35710099
357200     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE = ZERO    35720099
357300         MOVE '7200-PURITM-DATA' TO DP013-PARAGRAPH               35730099
357400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     35740099
357500                                     TO DP013-MESSAGE-TEXT (1)    35750099
357600         MOVE 'THE FOLLOWING RECEIVER: '                          35760099
357700                                     TO DP013-MESSAGE-TEXT (2)    35770099
357800         MOVE DK-ORD-NBR             TO  PV-DISPLAY-ORD-NBR       35780099
357900         MOVE DK-ORD-LNE-NBR         TO  PV-DISPLAY-ORD-LNE-NBR   35790099
358000         MOVE PV-DISPLAY-KEYS        TO DP013-MESSAGE-TEXT (3)    35800099
358100         MOVE SQLCA                  TO DP013-SQLCA               35810099
358200         MOVE 'TPURITM'              TO DP013-DB2-TABLE-NAME (1)  35820099
358300         MOVE 'TSTATCD'              TO DP013-DB2-TABLE-NAME (2)  35830099
358400         SET DP013-DB2-ABEND         TO TRUE                      35840099
358500         SET DP013-NO-ROLLBACK       TO TRUE                      35850099
358600         PERFORM 9999-WRITE-CICS-LOG-MSG                          35860099
358700         GO TO 0000-GOBACK                                        35870099
358800     END-IF.                                                      35880099
358900     EJECT                                                        35890099
359000*----------------------------------------------------------------*35900099
359100* CALL TO LOGISTICS DOMAIN ITEM ACCESS MODULE                    *35910099
359200*----------------------------------------------------------------*35920099
359300*                                                                 35930099
359400 7205-CALL-CICS-API-ARCH.                                         35940099
359500                                                                  35950099
359600        MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR.               35960099
359700                                                                  35970099
359800        SET  XL001-BY-ITEM                                        35980099
359900             XL001-SELECT-SKU                                     35990099
360000             XL001-SELECT-SKU-STR                                 36000099
360100             XL001-SELECT-VND-STYL TO TRUE.                       36010099
360200                                                                  36020099
360300        CALL XL001-VSM-PGM USING  DFHEIBLK                        36030099
360400                                  XL001-COMMAREA                  36040099
360500                                  XL001-ITEM-COMMAREA.            36050099
360600                                                                  36060099
360700     EVALUATE TRUE                                                36070099
360800                                                                  36080099
360900          WHEN XL001-SKU-SQLCODE = +0                             36090099
361000              MOVE XL001-SKU-NBR   TO HL5-SEQ-NBR                 36100099
361100              MOVE XL001-SKU-DESC  TO HL8-SKU-DESC                36110099
361200              PERFORM 7206-SELECT-VND-STYL                        36120099
361300                                                                  36130099
361400          WHEN XL001-SKU-NOT-FOUND                                36140099
361500              MOVE ZEROES TO HL5-SEQ-NBR                          36150099
361600              MOVE SPACES TO HL8-SKU-DESC                         36160099
361700              MOVE SPACES TO HL6-SIZE                             36170099
361800              MOVE SPACES TO HL7-COLOR                            36180099
361900              MOVE SPACES TO HL9-VNDR-STYLE-NME                   36190099
362000              MOVE ZEROES TO HL12-BOX-ID                          36200099
362100              MOVE SPACES TO HL9-PRESENTATION                     36210099
362200                             HL5-CLASS-NBR                        36220099
362300                                                                  36230099
362400          WHEN XL001-INVALID-ACCESS                               36240099
362500              MOVE '7205-CALL-CICS-API-ARCH'                      36250099
362600                                    TO DP013-PARAGRAPH            36260099
362700              MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'           36270099
362800                                    TO DP013-MESSAGE-TEXT (1)     36280099
362900              MOVE PURITM-ITM-NBR   TO PV-DISPLAY-ITEM-NBR        36290099
363000              MOVE PV-DISPLAY-ITEM-NBR                            36300099
363100                                    TO DP013-MESSAGE-TEXT (2)     36310099
363200              MOVE SQLCA            TO DP013-SQLCA                36320099
363300              MOVE 'XLV_SKU'        TO DP013-DB2-TABLE-NAME (1)   36330099
363400              SET DP013-DB2-ABEND   TO TRUE                       36340099
363500              SET DP013-NO-ROLLBACK TO TRUE                       36350099
363600              PERFORM 9999-WRITE-CICS-LOG-MSG                     36360099
363700              GO TO 0000-GOBACK                                   36370099
363800                                                                  36380099
363900          WHEN OTHER                                              36390099
364000              MOVE '7205-CALL-CICS-API-ARCH'                      36400099
364100                   TO DP013-PARAGRAPH                             36410099
364200              MOVE 'PROCESSING SKU VIEW: '                        36420099
364300                   TO DP013-MESSAGE-TEXT (1)                      36430099
364400              MOVE PURITM-ITM-NBR    TO PV-DISPLAY-ITEM-NBR       36440099
364500              MOVE PV-DISPLAY-ITEM-NBR                            36450099
364600                                     TO DP013-MESSAGE-TEXT (2)    36460099
364700              MOVE XL001-SKU-SQLCODE TO SQLCODE                   36470099
364800              MOVE SQLCA             TO DP013-SQLCA               36480099
364900              MOVE 'XLV_SKU'         TO DP013-DB2-TABLE-NAME (1)  36490099
365000              SET DP013-DB2-ABEND    TO TRUE                      36500099
365100              SET DP013-NO-ROLLBACK  TO TRUE                      36510099
365200              PERFORM 9999-WRITE-CICS-LOG-MSG                     36520099
365300              GO TO 0000-GOBACK                                   36530099
365400                                                                  36540099
365500     END-EVALUATE.                                                36550099
365600                                                                  36560099
365700 7206-SELECT-VND-STYL.                                            36570099
365800                                                                  36580099
365900     EVALUATE TRUE                                                36590099
366000                                                                  36600099
366100          WHEN XL001-VND-STYL-SQLCODE = +0                        36610099
366200              MOVE XL001-VS-NBR    TO  HL9-VNDR-STYLE-NME         36620099
366300              MOVE XL001-HNG-FOLD-DESC                            36630099
366400                                     TO HL9-PRESENTATION          36640099
366500              MOVE XL001-SUB-CL-NBR-2CH                           36650099
366600                                     TO HL5-CLASS-NBR             36660099
366700              IF XL001-STKR-NBR  = ZEROS                          36670099
366800                 MOVE SPACES         TO  HL12-BOX-ID              36680099
366900              ELSE                                                36690099
367000                 MOVE XL001-STKR-NBR TO  HL12-BOX-ID              36700099
367100              END-IF                                              36710099
367200              PERFORM 7207-SELECT-SKU-STR                         36720099
367300                                                                  36730099
367400          WHEN XL001-VND-STYL-NOT-FOUND                           36740099
367500              MOVE SPACES            TO  HL9-VNDR-STYLE-NME       36750099
367600              MOVE ZEROES            TO  HL12-BOX-ID              36760099
367700              MOVE SPACES            TO  HL9-PRESENTATION         36770099
367800                                         HL5-CLASS-NBR            36780099
367900              MOVE ZEROES            TO  HL11-SKU-RTL             36790099
368000                                                                  36800099
368100                                                                  36810099
368200          WHEN OTHER                                              36820099
368300              MOVE '7206-SELECT-VND-STYL'                         36830099
368400                                      TO DP013-PARAGRAPH          36840099
368500              MOVE 'PROCESSING VENDOR STYLE:'                     36850099
368600                                      TO DP013-MESSAGE-TEXT (1)   36860099
368700              MOVE PURITM-ITM-NBR     TO PV-DISPLAY-ITEM-NBR      36870099
368800              MOVE PV-DISPLAY-ITEM-NBR                            36880099
368900                                      TO DP013-MESSAGE-TEXT (2)   36890099
369000              MOVE XL001-VND-STYL-SQLCODE                         36900099
369100                                      TO SQLCODE                  36910099
369200              MOVE SQLCA              TO DP013-SQLCA              36920099
369300              MOVE 'XLV_VND_STYL'     TO DP013-DB2-TABLE-NAME (1) 36930099
369400              SET DP013-DB2-ABEND     TO TRUE                     36940099
369500              SET DP013-NO-ROLLBACK   TO TRUE                     36950099
369600              PERFORM 9999-WRITE-CICS-LOG-MSG                     36960099
369700              GO TO 0000-GOBACK                                   36970099
369800                                                                  36980099
369900     END-EVALUATE.                                                36990099
370000                                                                  37000099
370100 7207-SELECT-SKU-STR.                                             37010099
370200                                                                  37020099
370300     EVALUATE TRUE                                                37030099
370400                                                                  37040099
370500          WHEN XL001-SKU-STR-SQLCODE = +0                         37050099
370600              MOVE XL001-UNT-RTL-AMT                              37060099
370700                           TO  HL11-SKU-RTL                       37070099
370800                                                                  37080099
370900          WHEN XL001-SKU-STR-SQLCODE = +100                       37090099
371000              MOVE ZEROES            TO  HL11-SKU-RTL             37100099
371100                                                                  37110099
371200                                                                  37120099
371300          WHEN OTHER                                              37130099
371400              MOVE '7207-SELECT-SKU-STR'                          37140099
371500                                      TO DP013-PARAGRAPH          37150099
371600              MOVE 'PROCESSING SKU STR:'                          37160099
371700                                      TO DP013-MESSAGE-TEXT (1)   37170099
371800              MOVE PURITM-ITM-NBR     TO PV-DISPLAY-ITEM-NBR      37180099
371900              MOVE PV-DISPLAY-ITEM-NBR                            37190099
372000                                      TO DP013-MESSAGE-TEXT (2)   37200099
372100              MOVE XL001-SKU-STR-SQLCODE                          37210099
372200                                      TO SQLCODE                  37220099
372300              MOVE SQLCA              TO DP013-SQLCA              37230099
372400              MOVE 'XLV_SKU_STR'      TO DP013-DB2-TABLE-NAME (1) 37240099
372500              SET DP013-DB2-ABEND     TO TRUE                     37250099
372600              SET DP013-NO-ROLLBACK   TO TRUE                     37260099
372700              PERFORM 9999-WRITE-CICS-LOG-MSG                     37270099
372800              GO TO 0000-GOBACK                                   37280099
372900                                                                  37290099
373000     END-EVALUATE.                                                37300099
373100                                                                  37310099
373200 7220-SELECT-TRECITM.                                             37320099
373300                                                                  37330099
373400     EXEC SQL                                                     37340099
373500         SELECT COLOR_DESC                                        37350099
373600              , SIZE_DESC                                         37360099
373700           INTO :RECITM-COLOR-DESC                                37370099
373800              , :RECITM-SIZE-DESC                                 37380099
373900           FROM  TRECITM                                          37390099
374000           WHERE ORD_NBR         = :DK-ORD-NBR                    37400099
374100             AND ORD_LNE_NBR     = :DK-ORD-LNE-NBR                37410099
374200             AND OPER_UNT_ID     = :DK-OPER-UNT-ID                37420099
374300             AND REC_SEQ_NBR     = :DK-RCVR-SEQ-NBR               37430099
374400             AND VER_STATUS_CDE  = :PC-A                          37440099
374500     END-EXEC.                                                    37450099
374600                                                                  37460099
374700     EVALUATE TRUE                                                37470099
374800         WHEN SQLCODE = ZERO                                      37480099
374900         WHEN SQLCODE = +100                                      37490099
375000              CONTINUE                                            37500099
375100         WHEN SQLWARN0 NOT = SPACES                               37510099
375200         WHEN SQLCODE < ZERO                                      37520099
375300         WHEN SQLCODE > ZERO                                      37530099
375400              MOVE '7220-SELECT-TRECITM'                          37540099
375500                                     TO  DP013-PARAGRAPH          37550099
375600              MOVE 'SELECT INFO FOR THE FOLLOWING ENT-ID/DEPT: '  37560099
375700                                     TO  DP013-MESSAGE-TEXT (1)   37570099
375800              MOVE PURCHS-ENT-ID     TO  DP013-MESSAGE-TEXT (2)   37580099
375900              MOVE PURCHS-DEPT-NBR   TO  DP013-MESSAGE-TEXT (3)   37590099
376000              MOVE SQLCA             TO  DP013-SQLCA              37600099
376100              MOVE 'TRECITM'         TO  DP013-DB2-TABLE-NAME (1) 37610099
376200              SET DP013-DB2-ABEND    TO  TRUE                     37620099
376300              SET DP013-NO-ROLLBACK  TO  TRUE                     37630099
376400              PERFORM 9999-WRITE-CICS-LOG-MSG                     37640099
376500              GO TO 0000-GOBACK                                   37650099
376600     END-EVALUATE.                                                37660099
376700/                                                                 37670099
376800 7230-OPEN-LNELOC-CSR.                                            37680099
376900     EXEC SQL                                                     37690099
377000         OPEN LNELOC-CSR                                          37700099
377100     END-EXEC.                                                    37710099
377200                                                                  37720099
377300     EVALUATE TRUE                                                37730099
377400         WHEN SQLCODE = ZERO                                      37740099
377500             CONTINUE                                             37750099
377600         WHEN SQLWARN0 NOT = SPACE                                37760099
377700         WHEN SQLCODE < ZERO                                      37770099
377800         WHEN SQLCODE > ZERO                                      37780099
377900             MOVE '7230-OPEN-LNELOC-CSR'                          37790099
378000                 TO DP013-PARAGRAPH                               37800099
378100             MOVE 'OPEN THE LNELOC-CSR'                           37810099
378200                 TO DP013-MESSAGE-TEXT (1)                        37820099
378300             MOVE SQLCA            TO DP013-SQLCA                 37830099
378400             MOVE 'TWKORIN'        TO DP013-DB2-TABLE-NAME (1)    37840099
378500             SET DP013-DB2-ABEND   TO TRUE                        37850099
378600             SET DP013-NO-ROLLBACK TO TRUE                        37860099
378700             PERFORM 9999-WRITE-CICS-LOG-MSG                      37870099
378800             GO TO 0000-GOBACK                                    37880099
378900     END-EVALUATE.                                                37890099
379000     SKIP3                                                        37900099
379100 7240-FETCH-LNELOC-CSR.                                           37910099
379200     INITIALIZE DCLTWKORIN.                                       37920099
379300                                                                  37930099
379400     EXEC SQL                                                     37940099
379500         FETCH  LNELOC-CSR                                        37950099
379600          INTO  :WKORIN-STRT-TMST,                                37960099
379700                :WKORIN-LNE-LOC-CDE,                              37970099
379800                :WKORIN-SCREEN-SEQ-NBR                            37980099
379900     END-EXEC.                                                    37990099
380000                                                                  38000099
380100     EVALUATE TRUE                                                38010099
380200         WHEN SQLCODE = ZERO                                      38020099
380300             CONTINUE                                             38030099
380400         WHEN SQLCODE = PC-ROW-NOT-FOUND                          38040099
380500             CONTINUE                                             38050099
380600         WHEN SQLWARN0 NOT = SPACE                                38060099
380700         WHEN SQLCODE < ZERO                                      38070099
380800         WHEN SQLCODE > ZERO                                      38080099
380900             MOVE '7240-FETCH-LNELOC-CSR'                         38090099
381000                 TO DP013-PARAGRAPH                               38100099
381100             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 38110099
381200-                 'FROM THE LNELOC-CSR'                           38120099
381300               TO DP013-MESSAGE-TEXT (1)                          38130099
381400             MOVE SQLCA            TO DP013-SQLCA                 38140099
381500             MOVE 'TWKORIN'        TO DP013-DB2-TABLE-NAME (1)    38150099
381600             SET DP013-DB2-ABEND   TO TRUE                        38160099
381700             SET DP013-NO-ROLLBACK TO TRUE                        38170099
381800             PERFORM 9999-WRITE-CICS-LOG-MSG                      38180099
381900             GO TO 0000-GOBACK                                    38190099
382000     END-EVALUATE.                                                38200099
382100     SKIP3                                                        38210099
382200 7250-CLOSE-LNELOC-CSR.                                           38220099
382300     EXEC SQL                                                     38230099
382400         CLOSE LNELOC-CSR                                         38240099
382500     END-EXEC.                                                    38250099
382600                                                                  38260099
382700     EVALUATE TRUE                                                38270099
382800         WHEN SQLCODE = ZERO                                      38280099
382900             CONTINUE                                             38290099
383000         WHEN SQLWARN0 NOT = SPACE                                38300099
383100         WHEN SQLCODE < ZERO                                      38310099
383200         WHEN SQLCODE > ZERO                                      38320099
383300             MOVE '7250-CLOSE-LNELOC-CSR'                         38330099
383400                 TO DP013-PARAGRAPH                               38340099
383500             MOVE 'CLOSE THE LNELOC-CSR'                          38350099
383600                 TO DP013-MESSAGE-TEXT (1)                        38360099
383700             MOVE SQLCA            TO DP013-SQLCA                 38370099
383800             MOVE 'TWKORIN'        TO DP013-DB2-TABLE-NAME (1)    38380099
383900             SET DP013-DB2-ABEND   TO TRUE                        38390099
384000             SET DP013-NO-ROLLBACK TO TRUE                        38400099
384100             PERFORM 9999-WRITE-CICS-LOG-MSG                      38410099
384200             GO TO 0000-GOBACK                                    38420099
384300     END-EVALUATE.                                                38430099
384400     EJECT                                                        38440099
384500 7260-OPEN-TRBL-CSR.                                              38450099
384600     EXEC SQL                                                     38460099
384700         OPEN TRBL-CSR1                                           38470099
384800     END-EXEC.                                                    38480099
384900                                                                  38490099
385000     EVALUATE TRUE                                                38500099
385100         WHEN SQLCODE = ZERO                                      38510099
385200             CONTINUE                                             38520099
385300         WHEN SQLWARN0 NOT = SPACE                                38530099
385400         WHEN SQLCODE < ZERO                                      38540099
385500         WHEN SQLCODE > ZERO                                      38550099
385600             MOVE '7260-OPEN-TRBL-CSR'                            38560099
385700                 TO DP013-PARAGRAPH                               38570099
385800             MOVE 'OPEN THE TRBL-CSR'                             38580099
385900                 TO DP013-MESSAGE-TEXT (1)                        38590099
386000             MOVE SQLCA            TO DP013-SQLCA                 38600099
386100             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    38610099
386200             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    38620099
386300             SET DP013-DB2-ABEND   TO TRUE                        38630099
386400             SET DP013-NO-ROLLBACK TO TRUE                        38640099
386500             PERFORM 9999-WRITE-CICS-LOG-MSG                      38650099
386600             GO TO 0000-GOBACK                                    38660099
386700     END-EVALUATE.                                                38670099
386800*                                                                 38680099
386900 7265-OPEN-TRBL-CSR2.                                             38690099
387000     EXEC SQL                                                     38700099
387100         OPEN TRBL-CSR2                                           38710099
387200     END-EXEC.                                                    38720099
387300                                                                  38730099
387400     EVALUATE TRUE                                                38740099
387500         WHEN SQLCODE = ZERO                                      38750099
387600             CONTINUE                                             38760099
387700         WHEN SQLWARN0 NOT = SPACE                                38770099
387800         WHEN SQLCODE < ZERO                                      38780099
387900         WHEN SQLCODE > ZERO                                      38790099
388000             MOVE '7265-OPEN-TRBL-CSR2'                           38800099
388100                 TO DP013-PARAGRAPH                               38810099
388200             MOVE 'OPEN THE TRBL-CSR2'                            38820099
388300                 TO DP013-MESSAGE-TEXT (1)                        38830099
388400             MOVE SQLCA            TO DP013-SQLCA                 38840099
388500             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    38850099
388600             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    38860099
388700             SET DP013-DB2-ABEND   TO TRUE                        38870099
388800             SET DP013-NO-ROLLBACK TO TRUE                        38880099
388900             PERFORM 9999-WRITE-CICS-LOG-MSG                      38890099
389000             GO TO 0000-GOBACK                                    38900099
389100     END-EVALUATE.                                                38910099
389200*                                                                 38920099
389300 7270-FETCH-TRBL-CSR.                                             38930099
389400     INITIALIZE DCLTWKORIN.                                       38940099
389500                                                                  38950099
389600     EXEC SQL                                                     38960099
389700         FETCH  TRBL-CSR1                                         38970099
389800          INTO  :TRBRSN-TRBL-LONG-DESC                            38980099
389900     END-EXEC.                                                    38990099
390000                                                                  39000099
390100     EVALUATE TRUE                                                39010099
390200         WHEN SQLCODE = ZERO                                      39020099
390300             CONTINUE                                             39030099
390400         WHEN SQLCODE = PC-ROW-NOT-FOUND                          39040099
390500             CONTINUE                                             39050099
390600         WHEN SQLWARN0 NOT = SPACE                                39060099
390700         WHEN SQLCODE < ZERO                                      39070099
390800         WHEN SQLCODE > ZERO                                      39080099
390900             MOVE '7270-FETCH-TRBL-CSR'                           39090099
391000                 TO DP013-PARAGRAPH                               39100099
391100             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 39110099
391200-                 'FROM THE TRBL-CSR'                             39120099
391300               TO DP013-MESSAGE-TEXT (1)                          39130099
391400             MOVE SQLCA            TO DP013-SQLCA                 39140099
391500             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    39150099
391600             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    39160099
391700             SET DP013-DB2-ABEND   TO TRUE                        39170099
391800             SET DP013-NO-ROLLBACK TO TRUE                        39180099
391900             PERFORM 9999-WRITE-CICS-LOG-MSG                      39190099
392000             GO TO 0000-GOBACK                                    39200099
392100     END-EVALUATE.                                                39210099
392200*                                                                 39220099
392300 7275-FETCH-TRBL-CSR2.                                            39230099
392400     INITIALIZE DCLTWKORIN.                                       39240099
392500                                                                  39250099
392600     EXEC SQL                                                     39260099
392700         FETCH  TRBL-CSR2                                         39270099
392800          INTO  :TRBRSN-TRBL-LONG-DESC                            39280099
392900              , :TRBNTF-RESOLVED-IND                              39290099
393000     END-EXEC.                                                    39300099
393100                                                                  39310099
393200     EVALUATE TRUE                                                39320099
393300         WHEN SQLCODE = ZERO                                      39330099
393400             CONTINUE                                             39340099
393500         WHEN SQLCODE = PC-ROW-NOT-FOUND                          39350099
393600             CONTINUE                                             39360099
393700         WHEN SQLWARN0 NOT = SPACE                                39370099
393800         WHEN SQLCODE < ZERO                                      39380099
393900         WHEN SQLCODE > ZERO                                      39390099
394000             MOVE '7275-FETCH-TRBL-CSR2'                          39400099
394100                 TO DP013-PARAGRAPH                               39410099
394200             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 39420099
394300-                 'FROM THE TRBL-CSR2'                            39430099
394400               TO DP013-MESSAGE-TEXT (1)                          39440099
394500             MOVE SQLCA            TO DP013-SQLCA                 39450099
394600             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    39460099
394700             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    39470099
394800             SET DP013-DB2-ABEND   TO TRUE                        39480099
394900             SET DP013-NO-ROLLBACK TO TRUE                        39490099
395000             PERFORM 9999-WRITE-CICS-LOG-MSG                      39500099
395100             GO TO 0000-GOBACK                                    39510099
395200     END-EVALUATE.                                                39520099
395300*                                                                 39530099
395400 7280-CLOSE-TRBL-CSR.                                             39540099
395500     EXEC SQL                                                     39550099
395600         CLOSE TRBL-CSR1                                          39560099
395700     END-EXEC.                                                    39570099
395800                                                                  39580099
395900     EVALUATE TRUE                                                39590099
396000         WHEN SQLCODE = ZERO                                      39600099
396100             CONTINUE                                             39610099
396200         WHEN SQLWARN0 NOT = SPACE                                39620099
396300         WHEN SQLCODE < ZERO                                      39630099
396400         WHEN SQLCODE > ZERO                                      39640099
396500             MOVE '7280-CLOSE-TRBL-CSR'                           39650099
396600                 TO DP013-PARAGRAPH                               39660099
396700             MOVE 'CLOSE THE TRBL-CSR'                            39670099
396800                 TO DP013-MESSAGE-TEXT (1)                        39680099
396900             MOVE SQLCA            TO DP013-SQLCA                 39690099
397000             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    39700099
397100             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    39710099
397200             SET DP013-DB2-ABEND   TO TRUE                        39720099
397300             SET DP013-NO-ROLLBACK TO TRUE                        39730099
397400             PERFORM 9999-WRITE-CICS-LOG-MSG                      39740099
397500             GO TO 0000-GOBACK                                    39750099
397600     END-EVALUATE.                                                39760099
397700 7285-CLOSE-TRBL-CSR2.                                            39770099
397800     EXEC SQL                                                     39780099
397900         CLOSE TRBL-CSR2                                          39790099
398000     END-EXEC.                                                    39800099
398100                                                                  39810099
398200     EVALUATE TRUE                                                39820099
398300         WHEN SQLCODE = ZERO                                      39830099
398400             CONTINUE                                             39840099
398500         WHEN SQLWARN0 NOT = SPACE                                39850099
398600         WHEN SQLCODE < ZERO                                      39860099
398700         WHEN SQLCODE > ZERO                                      39870099
398800             MOVE '7285-CLOSE-TRBL-CSR2'                          39880099
398900                 TO DP013-PARAGRAPH                               39890099
399000             MOVE 'CLOSE THE TRBL-CSR2'                           39900099
399100                 TO DP013-MESSAGE-TEXT (1)                        39910099
399200             MOVE SQLCA            TO DP013-SQLCA                 39920099
399300             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    39930099
399400             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    39940099
399500             SET DP013-DB2-ABEND   TO TRUE                        39950099
399600             SET DP013-NO-ROLLBACK TO TRUE                        39960099
399700             PERFORM 9999-WRITE-CICS-LOG-MSG                      39970099
399800             GO TO 0000-GOBACK                                    39980099
399900     END-EVALUATE.                                                39990099
400000     EJECT                                                        40000099
400100     EJECT                                                        40010099
400200 7320-OPEN-RECDIS-CSR.                                            40020099
400300     EXEC SQL                                                     40030099
400400         OPEN RECDIS-CSR                                          40040099
400500     END-EXEC.                                                    40050099
400600                                                                  40060099
400700     EVALUATE TRUE                                                40070099
400800         WHEN SQLCODE = ZERO                                      40080099
400900             CONTINUE                                             40090099
401000         WHEN SQLWARN0 NOT = SPACE                                40100099
401100         WHEN SQLCODE < ZERO                                      40110099
401200         WHEN SQLCODE > ZERO                                      40120099
401300             MOVE '7320-OPEN-RECDIS-CSR'                          40130099
401400                 TO DP013-PARAGRAPH                               40140099
401500             MOVE 'OPEN THE RECDIS-CSR'                           40150099
401600                 TO DP013-MESSAGE-TEXT (1)                        40160099
401700             MOVE SQLCA             TO DP013-SQLCA                40170099
401800             MOVE 'TRECDIS'         TO DP013-DB2-TABLE-NAME (1)   40180099
401900             MOVE 'XLT_LOC'         TO DP013-DB2-TABLE-NAME (2)   40190099
402000             SET DP013-DB2-ABEND    TO TRUE                       40200099
402100             SET DP013-NO-ROLLBACK  TO TRUE                       40210099
402200             PERFORM 9999-WRITE-CICS-LOG-MSG                      40220099
402300             GO TO 0000-GOBACK                                    40230099
402400     END-EVALUATE.                                                40240099
402500*                                                                 40250099
402600 7330-FETCH-RECDIS-CSR.                                           40260099
402700     INITIALIZE DCLTRECDIS.                                       40270099
402800                                                                  40280099
402900     EXEC SQL                                                     40290099
403000         FETCH  RECDIS-CSR                                        40300099
403100          INTO  :PV-UNION-IND,                                    40310099
403200                :RECDIS-STR-NBR,                                  40320099
403300                :RECDIS-EXPTED-ITM-QTY                            40330099
403400     END-EXEC.                                                    40340099
403500                                                                  40350099
403600     EVALUATE TRUE                                                40360099
403700         WHEN SQLCODE = ZERO                                      40370099
403800              IF PV-UNION-IND = PC-A                              40380099
403900                  ADD 1 TO PV-STR-CNT                             40390099
404000              END-IF                                              40400099
404100         WHEN SQLCODE = PC-ROW-NOT-FOUND                          40410099
404200             CONTINUE                                             40420099
404300         WHEN SQLWARN0 NOT = SPACE                                40430099
404400         WHEN SQLCODE < ZERO                                      40440099
404500         WHEN SQLCODE > ZERO                                      40450099
404600             MOVE '7330-FETCH-RECDIS-CSR'                         40460099
404700                 TO DP013-PARAGRAPH                               40470099
404800             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 40480099
404900-                 'FROM THE RECDIS-CSR'                           40490099
405000                 TO DP013-MESSAGE-TEXT (1)                        40500099
405100             MOVE SQLCA            TO DP013-SQLCA                 40510099
405200             MOVE 'TRECDIS'        TO DP013-DB2-TABLE-NAME (1)    40520099
405300             MOVE 'XLT_LOC'        TO DP013-DB2-TABLE-NAME (2)    40530099
405400             SET DP013-DB2-ABEND   TO TRUE                        40540099
405500             SET DP013-NO-ROLLBACK TO TRUE                        40550099
405600             PERFORM 9999-WRITE-CICS-LOG-MSG                      40560099
405700             GO TO 0000-GOBACK                                    40570099
405800     END-EVALUATE.                                                40580099
405900     SKIP2                                                        40590099
406000 7340-CLOSE-RECDIS-CSR.                                           40600099
406100     EXEC SQL                                                     40610099
406200         CLOSE RECDIS-CSR                                         40620099
406300     END-EXEC.                                                    40630099
406400                                                                  40640099
406500     EVALUATE TRUE                                                40650099
406600         WHEN SQLCODE = ZERO                                      40660099
406700             CONTINUE                                             40670099
406800         WHEN SQLWARN0 NOT = SPACE                                40680099
406900         WHEN SQLCODE < ZERO                                      40690099
407000         WHEN SQLCODE > ZERO                                      40700099
407100             MOVE '7340-CLOSE-RECDIS-CSR'                         40710099
407200                 TO DP013-PARAGRAPH                               40720099
407300             MOVE 'CLOSE THE RECDIS-CSR'                          40730099
407400                 TO DP013-MESSAGE-TEXT (1)                        40740099
407500             MOVE SQLCA            TO DP013-SQLCA                 40750099
407600             MOVE 'TRECDIS'        TO DP013-DB2-TABLE-NAME (1)    40760099
407700             MOVE 'XLT_LOC'        TO DP013-DB2-TABLE-NAME (1)    40770099
407800             SET DP013-DB2-ABEND   TO TRUE                        40780099
407900             SET DP013-NO-ROLLBACK TO TRUE                        40790099
408000             PERFORM 9999-WRITE-CICS-LOG-MSG                      40800099
408100             GO TO 0000-GOBACK                                    40810099
408200     END-EVALUATE.                                                40820099
408300/                                                                 40830099
408400*7350-OPEN-TWKORIN.                                               40840099
408500*    PERFORM                                                      40850099
408600*        WITH TEST AFTER                                          40860099
408700*        VARYING PV-RETRY-COUNT                                   40870099
408800*        FROM 1 BY 1                                              40880099
408900*        UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 40890099
409000*           OR  (SQLCODE = +0))                                   40900099
409100*                                                                 40910099
409200*        EXEC SQL                                                 40920099
409300*            OPEN TWKORIN-CSR                                     40930099
409400*        END-EXEC                                                 40940099
409500*                                                                 40950099
409600*        EVALUATE TRUE                                            40960099
409700*            WHEN SQLCODE = +0                                    40970099
409800*            WHEN SQLCODE = -904                                  40980099
409900*            WHEN SQLCODE = -913                                  40990099
410000*                 CONTINUE                                        41000099
410100*            WHEN SQLWARN0 NOT = SPACE                            41010099
410200*            WHEN SQLCODE  NOT = +0                               41020099
410300*                 MOVE '7350-OPEN-TWKORIN'                        41030099
410400*                                TO DP013-PARAGRAPH               41040099
410500*                 MOVE 'OPEN TWKORIN CURSOR'                      41050099
410600*                                TO DP013-MESSAGE-TEXT (1)        41060099
410700*                 MOVE SQLCA     TO DP013-SQLCA                   41070099
410800*                 MOVE 'TWKORIN'   TO DP013-DB2-TABLE-NAME (1)    41080099
410900*                 SET DP013-DB2-ABEND    TO  TRUE                 41090099
411000*                 SET DP013-NO-ROLLBACK  TO  TRUE                 41100099
411100*                 PERFORM 9999-WRITE-CICS-LOG-MSG                 41110099
411200*                 GO TO 0000-GOBACK                               41120099
411300*        END-EVALUATE                                             41130099
411400*    END-PERFORM.                                                 41140099
411500*                                                                 41150099
411600*    IF  PV-RETRY-COUNT > PC-MAX-RETRIES AND SQLCODE > ZERO       41160099
411700*        MOVE '7350-OPEN-TWKORIN'                                 41170099
411800*                                TO DP013-PARAGRAPH               41180099
411900*        MOVE 'MAX RETRIES EXCEEDED'                              41190099
412000*                                TO DP013-MESSAGE-TEXT (1)        41200099
412100*        SET DP013-DB2-ABEND TO TRUE                              41210099
412200*        SET DP013-NO-ROLLBACK TO TRUE                            41220099
412300*        PERFORM 9999-WRITE-CICS-LOG-MSG                          41230099
412400*        GO TO 0000-GOBACK                                        41240099
412500*    END-IF.                                                      41250099
412600*                                                                 41260099
412700*7360-FETCH-TWKORIN.                                              41270099
412800*    EXEC SQL                                                     41280099
412900*         FETCH TWKORIN-CSR                                       41290099
413000*            INTO :WKORIN-ORD-NBR                                 41300099
413100*                ,:WKORIN-RCVR-SEQ-NBR                            41310099
413200*                ,:WKORIN-ORD-LNE-NBR                             41320099
413300*                ,:WKORIN-OPER-UNT-ID                             41330099
413400*                ,:WKORIN-WORK-ORD-SEQ-NBR                        41340099
413500*                ,:WKORIN-FCLTY-AREA-ID                           41350099
413600*                ,:WKORIN-STRT-TMST                               41360099
413700*                ,:WKORIN-STOP-TMST                               41370099
413800*                ,:WKORIN-PRC-FCLTY-AREA-ID                       41380099
413900*                ,:WKORIN-SCREEN-SEQ-NBR                          41390099
414000*    END-EXEC.                                                    41400099
414100*                                                                 41410099
414200*    EVALUATE TRUE                                                41420099
414300*        WHEN SQLCODE = ZERO                                      41430099
414400*            IF  WKORIN-STRT-TMST NOT =                           41440099
414500*                          PC-DB2-DUMMY-DATE-TIME                 41450099
414600*                IF  WKORIN-STOP-TMST NOT =                       41460099
414700*                                PC-DB2-DUMMY-DATE-TIME           41470099
414800*                    MOVE WKORIN-PRC-FCLTY-AREA-ID TO             41480099
414900*                                PV-PRC-FCLTY-AREA-ID             41490099
415000*                ELSE                                             41500099
415100*                    MOVE WKORIN-PRC-FCLTY-AREA-ID TO             41510099
415200*                                PV-PRC-FCLTY-AREA-ID             41520099
415300*                    SET PS-EOF-TWKORIN-CSR TO TRUE               41530099
415400*               END-IF                                            41540099
415500*            ELSE                                                 41550099
415600*                SET PS-EOF-TWKORIN-CSR TO TRUE                   41560099
415700*            END-IF                                               41570099
415800*        WHEN SQLCODE = +100                                      41580099
415900*             SET PS-EOF-TWKORIN-CSR TO TRUE                      41590099
416000*        WHEN SQLWARN0 NOT = SPACE                                41600099
416100*        WHEN SQLCODE  NOT = +0                                   41610099
416200*             MOVE '7360-FETCH-TWKORIN'                           41620099
416300*                                  TO DP013-PARAGRAPH             41630099
416400*             MOVE 'FETCH TWKORIN CURSOR'                         41640099
416500*                                  TO DP013-MESSAGE-TEXT (1)      41650099
416600*             MOVE 'TWKORIN'       TO DP013-DB2-TABLE-NAME (1)    41660099
416700*             MOVE 'CURRENT PO BEING PROCESSED ID:         '      41670099
416800*                                  TO DP013-MESSAGE-TEXT (2)      41680099
416900*             MOVE DK-ORD-NBR                                     41690099
417000*                                  TO DP013-MESSAGE-TEXT (3)      41700099
417100*             MOVE CA-ORD-LNE-NBR                                 41710099
417200*                                  TO DP013-MESSAGE-TEXT (4)      41720099
417300*             SET DP013-DB2-ABEND TO TRUE                         41730099
417400*             SET DP013-NO-ROLLBACK TO TRUE                       41740099
417500*             PERFORM 9999-WRITE-CICS-LOG-MSG                     41750099
417600*             GO TO 0000-GOBACK                                   41760099
417700*    END-EVALUATE.                                                41770099
417800*                                                                 41780099
417900*7370-CLOSE-TWKORIN.                                              41790099
418000*    PERFORM                                                      41800099
418100*        WITH TEST AFTER                                          41810099
418200*        VARYING PV-RETRY-COUNT                                   41820099
418300*        FROM 1 BY 1                                              41830099
418400*        UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 41840099
418500*           OR  (SQLCODE = +0))                                   41850099
418600*                                                                 41860099
418700*           EXEC SQL                                              41870099
418800*               CLOSE TWKORIN-CSR                                 41880099
418900*           END-EXEC                                              41890099
419000*                                                                 41900099
419100*           EVALUATE TRUE                                         41910099
419200*               WHEN SQLCODE = 0                                  41920099
419300*                   CONTINUE                                      41930099
419400*               WHEN SQLCODE = -911                               41940099
419500*               WHEN SQLCODE = -904                               41950099
419600*                   CONTINUE                                      41960099
419700*               WHEN SQLCODE  NOT = +0                            41970099
419800*                    MOVE '2160 CLOSE-TWKORIN'                    41980099
419900*                                 TO DP013-PARAGRAPH              41990099
420000*                    MOVE 'CLOSE TWKORIN CURSOR'                  42000099
420100*                                 TO DP013-MESSAGE-TEXT (1)       42010099
420200*                    MOVE SQLCA   TO DP013-SQLCA                  42020099
420300*                    MOVE 'TWKORIN'   TO DP013-MESSAGE-TEXT (1)   42030099
420400*                    SET DP013-DB2-ABEND TO TRUE                  42040099
420500*                    SET DP013-NO-ROLLBACK TO TRUE                42050099
420600*                    PERFORM 9999-WRITE-CICS-LOG-MSG              42060099
420700*                    GO TO 0000-GOBACK                            42070099
420800*           END-EVALUATE                                          42080099
420900*                                                                 42090099
421000*    END-PERFORM.                                                 42100099
421100*                                                                 42110099
421200*    IF  PV-RETRY-COUNT > PC-MAX-RETRIES AND SQLCODE > ZERO       42120099
421300*        MOVE '7370-CLOSE-TWKORIN'                                42130099
421400*                                TO DP013-PARAGRAPH               42140099
421500*        MOVE 'MAX RETRIES EXCEEDED'                              42150099
421600*                                TO DP013-MESSAGE-TEXT (1)        42160099
421700*        SET DP013-DB2-ABEND TO TRUE                              42170099
421800*        SET DP013-NO-ROLLBACK TO TRUE                            42180099
421900*        PERFORM 9999-WRITE-CICS-LOG-MSG                          42190099
422000*        GO TO 0000-GOBACK                                        42200099
422100*    END-IF.                                                      42210099
422200*    EJECT                                                        42220099
422300*7380-OPEN-WKORIN0-CURSOR.                                        42230099
422400*    PERFORM                                                      42240099
422500*        WITH TEST AFTER                                          42250099
422600*        VARYING PV-RETRY-COUNT                                   42260099
422700*        FROM 1 BY 1                                              42270099
422800*        UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 42280099
422900*           OR  (SQLCODE = +0))                                   42290099
423000*                                                                 42300099
423100*        EXEC SQL                                                 42310099
423200*            OPEN WKORIN0-CSR                                     42320099
423300*        END-EXEC                                                 42330099
423400*                                                                 42340099
423500*        EVALUATE TRUE                                            42350099
423600*            WHEN SQLCODE = +0                                    42360099
423700*            WHEN SQLCODE = -904                                  42370099
423800*            WHEN SQLCODE = -913                                  42380099
423900*                 CONTINUE                                        42390099
424000*            WHEN SQLWARN0 NOT = SPACE                            42400099
424100*            WHEN SQLCODE  NOT = +0                               42410099
424200*                 MOVE '7380-OPEN-WKORIN0'                        42420099
424300*                                TO DP013-PARAGRAPH               42430099
424400*                 MOVE 'OPEN WKORIN0 CURSOR'                      42440099
424500*                                  TO DP013-MESSAGE-TEXT (1)      42450099
424600*                 MOVE 'TWKORIN'   TO DP013-DB2-TABLE-NAME (1)    42460099
424700*                 SET DP013-DB2-ABEND TO TRUE                     42470099
424800*                 SET DP013-NO-ROLLBACK TO TRUE                   42480099
424900*                 PERFORM 9999-WRITE-CICS-LOG-MSG                 42490099
425000*                 GO TO 0000-GOBACK                               42500099
425100*        END-EVALUATE                                             42510099
425200*    END-PERFORM.                                                 42520099
425300*                                                                 42530099
425400*    IF  PV-RETRY-COUNT > PC-MAX-RETRIES AND SQLCODE > ZERO       42540099
425500*        MOVE '7380-OPEN-WKORIN0'                                 42550099
425600*                                TO DP013-PARAGRAPH               42560099
425700*        MOVE 'MAX RETRIES EXCEEDED'                              42570099
425800*                                TO DP013-MESSAGE-TEXT (1)        42580099
425900*        SET DP013-DB2-ABEND TO TRUE                              42590099
426000*        SET DP013-NO-ROLLBACK TO TRUE                            42600099
426100*        PERFORM 9999-WRITE-CICS-LOG-MSG                          42610099
426200*        GO TO 0000-GOBACK                                        42620099
426300*    END-IF.                                                      42630099
426400*                                                                 42640099
426500*7390-FETCH-TWKORIN-ZERO.                                         42650099
426600*    EXEC SQL                                                     42660099
426700*         FETCH WKORIN0-CSR                                       42670099
426800*            INTO :WKORIN-ORD-NBR                                 42680099
426900*                ,:WKORIN-RCVR-SEQ-NBR                            42690099
427000*                ,:WKORIN-ORD-LNE-NBR                             42700099
427100*                ,:WKORIN-OPER-UNT-ID                             42710099
427200*                ,:WKORIN-WORK-ORD-SEQ-NBR                        42720099
427300*                ,:WKORIN-FCLTY-AREA-ID                           42730099
427400*                ,:WKORIN-STRT-TMST                               42740099
427500*                ,:WKORIN-STOP-TMST                               42750099
427600*                ,:WKORIN-PRC-FCLTY-AREA-ID                       42760099
427700*                ,:WKORIN-SCREEN-SEQ-NBR                          42770099
427800*    END-EXEC.                                                    42780099
427900*                                                                 42790099
428000*    EVALUATE TRUE                                                42800099
428100*        WHEN SQLCODE = ZERO                                      42810099
428200*            IF WKORIN-STRT-TMST NOT = PC-DB2-DUMMY-DATE-TIME     42820099
428300*                 IF  WKORIN-STOP-TMST NOT =                      42830099
428400*                                      PC-DB2-DUMMY-DATE-TIME     42840099
428500*                    MOVE WKORIN-PRC-FCLTY-AREA-ID TO             42850099
428600*                                      PV-PRC-FCLTY-AREA-ID       42860099
428700*                 ELSE                                            42870099
428800*                    MOVE WKORIN-PRC-FCLTY-AREA-ID TO             42880099
428900*                                      PV-PRC-FCLTY-AREA-ID       42890099
429000*                    SET PS-EOF-TWKORIN-CSR TO TRUE               42900099
429100*                 END-IF                                          42910099
429200*            ELSE                                                 42920099
429300*                 MOVE WKORIN-PRC-FCLTY-AREA-ID TO                42930099
429400*                                      PV-PRC-FCLTY-AREA-ID       42940099
429500*                 SET PS-EOF-TWKORIN-CSR TO TRUE                  42950099
429600*            END-IF                                               42960099
429700*        WHEN SQLCODE = +100                                      42970099
429800*             SET PS-EOF-TWKORIN-ZERO TO TRUE                     42980099
429900*        WHEN SQLWARN0 NOT = SPACE                                42990099
430000*        WHEN SQLCODE  NOT = +0                                   43000099
430100*             MOVE '7390-FETCH-TWKORIN-ZERO'                      43010099
430200*                                  TO DP013-PARAGRAPH             43020099
430300*             MOVE 'FETCH TWKORIN CURSOR'                         43030099
430400*                                  TO DP013-MESSAGE-TEXT (1)      43040099
430500*             MOVE 'TWKORIN'       TO DP013-DB2-TABLE-NAME (1)    43050099
430600*             MOVE 'CURRENT PO BEING PROCESSED ID:         '      43060099
430700*                                  TO DP013-MESSAGE-TEXT (2)      43070099
430800*             MOVE DK-ORD-NBR                                     43080099
430900*                                  TO DP013-MESSAGE-TEXT (3)      43090099
431000*             MOVE CA-ORD-LNE-NBR                                 43100099
431100*                                  TO DP013-MESSAGE-TEXT (4)      43110099
431200*             SET DP013-DB2-ABEND TO TRUE                         43120099
431300*             SET DP013-NO-ROLLBACK TO TRUE                       43130099
431400*             PERFORM 9999-WRITE-CICS-LOG-MSG                     43140099
431500*             GO TO 0000-GOBACK                                   43150099
431600*    END-EVALUATE.                                                43160099
431700*                                                                 43170099
431800*7400-CLOSE-WKORIN0.                                              43180099
431900*    PERFORM                                                      43190099
432000*        WITH TEST AFTER                                          43200099
432100*        VARYING PV-RETRY-COUNT                                   43210099
432200*        FROM 1 BY 1                                              43220099
432300*        UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 43230099
432400*           OR  (SQLCODE = +0))                                   43240099
432500*                                                                 43250099
432600*           EXEC SQL                                              43260099
432700*               CLOSE WKORIN0-CSR                                 43270099
432800*           END-EXEC                                              43280099
432900*                                                                 43290099
433000*           EVALUATE TRUE                                         43300099
433100*               WHEN SQLCODE = 0                                  43310099
433200*                   CONTINUE                                      43320099
433300*               WHEN SQLCODE = -911                               43330099
433400*               WHEN SQLCODE = -904                               43340099
433500*                   CONTINUE                                      43350099
433600*               WHEN SQLCODE  NOT = +0                            43360099
433700*                    MOVE '7400-CLOSE-WKORIN0'                    43370099
433800*                                 TO DP013-PARAGRAPH              43380099
433900*                    MOVE 'CLOSE WKORIN0 CURSOR'                  43390099
434000*                                 TO DP013-MESSAGE-TEXT (1)       43400099
434100*                    MOVE 'TWKORIN'   TO DP013-DB2-TABLE-NAME (1) 43410099
434200*                    SET DP013-DB2-ABEND TO TRUE                  43420099
434300*                    SET DP013-NO-ROLLBACK TO TRUE                43430099
434400*                    PERFORM 9999-WRITE-CICS-LOG-MSG              43440099
434500*                    GO TO 0000-GOBACK                            43450099
434600*           END-EVALUATE                                          43460099
434700*                                                                 43470099
434800*    END-PERFORM.                                                 43480099
434900*                                                                 43490099
435000*    IF  PV-RETRY-COUNT > PC-MAX-RETRIES AND SQLCODE > ZERO       43500099
435100*        MOVE '7400-CLOSE-WKORIN0'                                43510099
435200*                                TO DP013-PARAGRAPH               43520099
435300*        MOVE 'MAX RETRIES EXCEEDED'                              43530099
435400*                                TO DP013-MESSAGE-TEXT (1)        43540099
435500*        SET DP013-DB2-ABEND TO TRUE                              43550099
435600*        SET DP013-NO-ROLLBACK TO TRUE                            43560099
435700*        PERFORM 9999-WRITE-CICS-LOG-MSG                          43570099
435800*        GO TO 0000-GOBACK                                        43580099
435900*    END-IF.                                                      43590099
436000     EJECT                                                        43600099
436100 7410-SELECT-MKING-TMST.                                          43610099
436200                                                                  43620099
436300     EXEC SQL                                                     43630099
436400         SELECT MKING_APRON_TMST                                  43640099
436500           INTO :RECITM-MKING-APRON-TMST                          43650099
436600           FROM  TRECITM                                          43660099
436700           WHERE ORD_NBR         = :DK-ORD-NBR                    43670099
436800             AND ORD_LNE_NBR     = :DK-ORD-LNE-NBR                43680099
436900             AND OPER_UNT_ID     = :DK-OPER-UNT-ID                43690099
437000             AND REC_SEQ_NBR     = :DK-RCVR-SEQ-NBR               43700099
437100             AND VER_STATUS_CDE  = :PC-A                          43710099
437200     END-EXEC.                                                    43720099
437300                                                                  43730099
437400     EVALUATE TRUE                                                43740099
437500         WHEN SQLCODE = ZERO                                      43750099
437600              SET PS-YES-TRECITM     TO TRUE                      43760099
437700         WHEN SQLCODE = +100                                      43770099
437800              SET PS-NO-TRECITM      TO TRUE                      43780099
437900              MOVE PC-DB2-ZERO-DATE-TIME                          43790099
438000                                     TO RECITM-MKING-APRON-TMST   43800099
438100         WHEN SQLWARN0 NOT = SPACES                               43810099
438200         WHEN SQLCODE < ZERO                                      43820099
438300         WHEN SQLCODE > ZERO                                      43830099
438400              MOVE '7410-SELECT-MKING-TMST'                       43840099
438500                                     TO  DP013-PARAGRAPH          43850099
438600              MOVE 'SELECT INFO FOR THE FOLLOWING ENT-ID/DEPT: '  43860099
438700                                     TO  DP013-MESSAGE-TEXT (1)   43870099
438800              MOVE PURCHS-ENT-ID     TO  DP013-MESSAGE-TEXT (2)   43880099
438900              MOVE PURCHS-DEPT-NBR   TO  DP013-MESSAGE-TEXT (3)   43890099
439000              MOVE SQLCA             TO  DP013-SQLCA              43900099
439100              MOVE 'TRECITM'         TO  DP013-DB2-TABLE-NAME (1) 43910099
439200              SET DP013-DB2-ABEND    TO  TRUE                     43920099
439300              SET DP013-NO-ROLLBACK  TO  TRUE                     43930099
439400              PERFORM 9999-WRITE-CICS-LOG-MSG                     43940099
439500              GO TO 0000-GOBACK                                   43950099
439600     END-EVALUATE.                                                43960099
439700     EJECT                                                        43970099
439800 7420-UPDATE-TRECITM-TMST.                                        43980099
439900                                                                  43990099
440000     PERFORM                                                      44000099
440100         WITH TEST AFTER                                          44010099
440200         VARYING PV-RETRY-COUNTER                                 44020099
440300         FROM 1 BY 1                                              44030099
440400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               44040099
440500             OR (SQLCODE = +0))                                   44050099
440600                                                                  44060099
440700         EXEC SQL                                                 44070099
440800             UPDATE TRECITM                                       44080099
440900               SET  MKING_APRON_TMST     = CURRENT TIMESTAMP      44090099
441000               WHERE ORD_NBR         = :DK-ORD-NBR                44100099
441100                 AND ORD_LNE_NBR     = :DK-ORD-LNE-NBR            44110099
441200                 AND OPER_UNT_ID     = :DK-OPER-UNT-ID            44120099
441300                 AND REC_SEQ_NBR     = :DK-RCVR-SEQ-NBR           44130099
441400                 AND VER_STATUS_CDE  = :PC-A                      44140099
441500         END-EXEC                                                 44150099
441600                                                                  44160099
441700         EVALUATE TRUE                                            44170099
441800             WHEN SQLCODE = +0                                    44180099
441900                 SET PS-UPDATES-DONE         TO TRUE              44190099
442000             WHEN SQLCODE = -904                                  44200099
442100             WHEN SQLCODE = -913                                  44210099
442200                 CONTINUE                                         44220099
442300                                                                  44230099
442400             WHEN SQLWARN0 NOT = SPACES                           44240099
442500             WHEN SQLCODE < +0                                    44250099
442600             WHEN SQLCODE > +0                                    44260099
442700                 MOVE '7420-UPDATE-TRECITM-TMST'                  44270099
442800                                   TO DP013-PARAGRAPH             44280099
442900                 MOVE 'UPDATE TIMESTMP ON TRECITM'                44290099
443000                                   TO DP013-MESSAGE-TEXT(1)       44300099
443100                 MOVE SQLCA        TO DP013-SQLCA                 44310099
443200                 MOVE 'TRECITM'    TO DP013-DB2-TABLE-NAME (1)    44320099
443300                 SET DP013-DB2-ABEND    TO  TRUE                  44330099
443400                 SET DP013-ROLLBACK  TO  TRUE                     44340099
443500                 PERFORM 9999-WRITE-CICS-LOG-MSG                  44350099
443600                 GO TO 0000-GOBACK                                44360099
443700         END-EVALUATE                                             44370099
443800                                                                  44380099
443900     END-PERFORM.                                                 44390099
444000                                                                  44400099
444100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND SQLCODE > ZERO     44410099
444200         MOVE '7420-UPDATE-TRECITM-TMST'                          44420099
444300                                   TO DP013-PARAGRAPH             44430099
444400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              44440099
444500                                   TO DP013-MESSAGE-TEXT (1)      44450099
444600         MOVE 'TO UPDATE A TRECITM ROW'                           44460099
444700                                   TO DP013-MESSAGE-TEXT (2)      44470099
444800         MOVE SQLCA                TO DP013-SQLCA                 44480099
444900         MOVE 'TRECITM'            TO DP013-DB2-TABLE-NAME (1)    44490099
445000         SET DP013-DB2-ABEND       TO  TRUE                       44500099
445100         SET DP013-NO-ROLLBACK     TO  TRUE                       44510099
445200         PERFORM 9999-WRITE-CICS-LOG-MSG                          44520099
445300         GO TO 0000-GOBACK                                        44530099
445400     END-IF.                                                      44540099
445500     EJECT                                                        44550099
445600*7430-GET-UPC-CERT.                                               44560099
445700*    MOVE DK-ORD-NBR         TO UPCCER-PO-NBR.                    44570099
445800*    MOVE DK-RCVR-SEQ-NBR    TO UPCCER-REC-SEQ-NBR.               44580099
445900*    MOVE CA-ORD-LNE-NBR     TO UPCCER-PO-LNE-NBR.                44590099
446000*    PERFORM WITH TEST AFTER                                      44600099
446100*    VARYING PV-RETRY-COUNTER FROM 1 BY 1                         44610099
446200*        UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  44620099
446300*            OR SQLCODE = ZERO OR +100 OR -811                    44630099
446400*                                                                 44640099
446500*        EXEC SQL                                                 44650099
446600*            SELECT CRE_TMST                                      44660099
446700*                INTO :UPCCER-CRE-TMST                            44670099
446800*                FROM TUPCCER                                     44680099
446900*            WHERE PO_NBR      = :UPCCER-PO-NBR                   44690099
447000*            AND   REC_SEQ_NBR = :UPCCER-REC-SEQ-NBR              44700099
447100*            AND   PO_LNE_NBR  = :UPCCER-PO-LNE-NBR               44710099
447200*        END-EXEC                                                 44720099
447300*                                                                 44730099
447400*        EVALUATE TRUE                                            44740099
447500*            WHEN SQLCODE = ZERO                                  44750099
447600*            WHEN SQLCODE = +100                                  44760099
447700*            WHEN SQLCODE = -811                                  44770099
447800*                CONTINUE                                         44780099
447900*            WHEN SQLCODE = -913                                  44790099
448000*            WHEN SQLCODE = -904                                  44800099
448100*                CONTINUE                                         44810099
448200*            WHEN SQLWARN0 NOT = SPACES                           44820099
448300*            WHEN SQLCODE < ZEROS                                 44830099
448400*            WHEN SQLCODE > ZEROS                                 44840099
448500*                MOVE '7430-GET-UPC-CERT'                         44850099
448600*                                TO DP013-PARAGRAPH               44860099
448700*                MOVE 'ATTEMPTING TO INSERT UPCCER ROW       '    44870099
448800*                    TO DP013-MESSAGE-TEXT (1)                    44880099
448900*                MOVE SQLCA      TO DP013-SQLCA                   44890099
449000*                MOVE 'TUPCCER'  TO DP013-DB2-TABLE-NAME (1)      44900099
449100*                SET DP013-DB2-ABEND TO TRUE                      44910099
449200*                SET DP013-NO-ROLLBACK  TO  TRUE                  44920099
449300*                PERFORM 9999-WRITE-CICS-LOG-MSG                  44930099
449400*                GO TO 0000-GOBACK                                44940099
449500*        END-EVALUATE                                             44950099
449600*                                                                 44960099
449700*    END-PERFORM.                                                 44970099
449800*    EJECT                                                        44980099
449900*7440-INSERT-UPCCER.                                              44990099
450000*    PERFORM WITH TEST AFTER                                      45000099
450100*            VARYING PV-RETRY-COUNTER FROM 1 BY 1                 45010099
450200*        UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  45020099
450300*            OR SQLCODE = ZERO                                    45030099
450400*                                                                 45040099
450500*        EXEC SQL                                                 45050099
450600*            INSERT                                               45060099
450700*                INTO TUPCCER                                     45070099
450800*                    (MDSE_LNE_ITM_NBR,                           45080099
450900*                     CRE_TMST,                                   45090099
451000*                     ACT_CDE,                                    45100099
451100*                     OPER_UNT_ID,                                45110099
451200*                     PO_NBR,                                     45120099
451300*                     REC_SEQ_NBR,                                45130099
451400*                     PO_LNE_NBR,                                 45140099
451500*                     UID_NBR,                                    45150099
451600*                     UPC_NBR,                                    45160099
451700*                     FUNC_CDE,                                   45170099
451800*                     SCAN_ITM_NBR,                               45180099
451900*                     MDSE_PRC_AREA_CDE,                          45190099
452000*                     REQ_FOR_CERT_CDE)                           45200099
452100*            VALUES                                               45210099
452200*                     (:UPCCER-MDSE-LNE-ITM-NBR,                  45220099
452300*                      CURRENT TIMESTAMP,                         45230099
452400*                      :UPCCER-ACT-CDE,                           45240099
452500*                      :UPCCER-OPER-UNT-ID,                       45250099
452600*                      :UPCCER-PO-NBR,                            45260099
452700*                      :UPCCER-REC-SEQ-NBR,                       45270099
452800*                      :UPCCER-PO-LNE-NBR,                        45280099
452900*                      :UPCCER-UID-NBR,                           45290099
453000*                      :UPCCER-UPC-NBR,                           45300099
453100*                      :UPCCER-FUNC-CDE,                          45310099
453200*                      :UPCCER-SCAN-ITM-NBR,                      45320099
453300*                      :UPCCER-MDSE-PRC-AREA-CDE,                 45330099
453400*                      :UPCCER-REQ-FOR-CERT-CDE)                  45340099
453500*        END-EXEC                                                 45350099
453600*                                                                 45360099
453700*        EVALUATE TRUE                                            45370099
453800*            WHEN SQLCODE = ZERO                                  45380099
453900*                SET PS-UPDATES-DONE         TO TRUE              45390099
454000*            WHEN SQLCODE = -913                                  45400099
454100*            WHEN SQLCODE = -904                                  45410099
454200*                CONTINUE                                         45420099
454300*            WHEN SQLWARN0 NOT = SPACES                           45430099
454400*            WHEN SQLCODE < ZEROS                                 45440099
454500*            WHEN SQLCODE > ZEROS                                 45450099
454600*                MOVE '7440-INSERT-UPCCER'                        45460099
454700*                                TO DP013-PARAGRAPH               45470099
454800*                MOVE 'ATTEMPTING TO INSERT UPCCER ROW       '    45480099
454900*                    TO DP013-MESSAGE-TEXT (1)                    45490099
455000*                MOVE SQLCA          TO DP013-SQLCA               45500099
455100*                MOVE 'TUPCCER'      TO DP013-DB2-TABLE-NAME (1)  45510099
455200*                SET DP013-DB2-ABEND TO TRUE                      45520099
455300*                SET DP013-ROLLBACK  TO  TRUE                     45530099
455400*                PERFORM 9999-WRITE-CICS-LOG-MSG                  45540099
455500*                GO TO 0000-GOBACK                                45550099
455600*        END-EVALUATE                                             45560099
455700*                                                                 45570099
455800*    END-PERFORM.                                                 45580099
455900*----------------------------------------------------------------*45590099
456000*    START TRANID FOR PCKCS014 (MARKING APRON RTV PAGES)         *45600099
456100*----------------------------------------------------------------*45610099
456200 7900-START-TRANID-E014.                                          45620099
456300                                                                  45630099
456400                                                                  45640099
456500     EXEC CICS                                                    45650099
456600         LINK PROGRAM  (PC-PCKCS014)                              45660099
456700              COMMAREA (CA-PCKCS014-COMMAREA)                     45670099
456800              RESP     (PV-CICS-RESPONSE)                         45680099
456900     END-EXEC.                                                    45690099
457000                                                                  45700099
457100     EVALUATE TRUE                                                45710099
457200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 45720099
457300             CONTINUE                                             45730099
457400         WHEN OTHER                                               45740099
457500               MOVE '7900-START-TRANID-E014'                      45750099
457600                                    TO DP013-PARAGRAPH            45760099
457700               MOVE 'ATTEMPTING TO LINK TO E014 '                 45770099
457800                     TO DP013-MESSAGE-TEXT (1)                    45780099
457900               MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)     45790099
458000               MOVE SQLCA           TO DP013-SQLCA                45800099
458100               SET DP013-LINK-RETURN                              45810099
458200                   DP013-CICS-ABEND                               45820099
458300                   DP013-NO-ROLLBACK TO TRUE                      45830099
458400               PERFORM 9999-WRITE-CICS-LOG-MSG                    45840099
458500               GO TO 0000-GOBACK                                  45850099
458600     END-EVALUATE.                                                45860099
458700                                                                  45870099
458800/                                                                 45880099
458900* THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     45890099
459000******************************************************************45900099
459100 8000-LINK-TO-DRS.                                                45910099
459200                                                                  45920099
459300*  CAUTION:  ANY NON-BLANK CHARACTER IN PRINT POSITION 132        45930099
459400*            WILL CAUSE DOUBLE-SPACING REGARDLESS OF THE          45940099
459500*            CONTENTS OF CARRIAGE CONTROL CHARACTER.              45950099
459600     EXEC CICS                                                    45960099
459700         LINK                                                     45970099
459800             PROGRAM   ('DRS1INTC')                               45980099
459900             COMMAREA  (DRS01-COMMAREA)                           45990099
460000     END-EXEC.                                                    46000099
460100                                                                  46010099
460200     EVALUATE TRUE                                                46020099
460300         WHEN DRS01-DRRB-RC = ZERO                                46030099
460400             CONTINUE                                             46040099
460500         WHEN OTHER                                               46050099
460600             MOVE '8000-LINK-TO-DRS'    TO DP013-PARAGRAPH        46060099
460700             SET DP013-OTHER-ABEND      TO TRUE                   46070099
460800             MOVE DRS01-DRRB-FUNC       TO PV-DRS-DRRB-FUNC       46080099
460900             MOVE DRS01-DRRB-RID        TO PV-DRS-DRRB-RID        46090099
461000             MOVE DRS01-DRRD-OPTIONS    TO PV-DRS-DRRB-OPTIONS    46100099
461100             MOVE DRS01-DRRB-RC         TO PV-DRS-DRRB-RC         46110099
461200             MOVE DRS01-DRRB-ATTR-ERROR TO PV-DRS-ATTR-ERROR      46120099
461300             MOVE DRS01-DRRB-DRDC       TO PV-DRS-DRRB-DRDC       46130099
461400             MOVE DRS01-DRRB01-LINES    TO PV-DRS-DRRB-LINES      46140099
461500             MOVE PV-DRS-ABEND-DISPLAY-LINE1                      46150099
461600                 TO DP013-MESSAGE-TEXT (1)                        46160099
461700             MOVE PV-DRS-ABEND-DISPLAY-LINE2                      46170099
461800                 TO DP013-MESSAGE-TEXT (2)                        46180099
461900             SET DP013-LINK-RETURN      TO TRUE                   46190099
462000             PERFORM DP013-0000-PROCESS-ABEND                     46200099
462100             GO TO 0000-GOBACK                                    46210099
462200     END-EVALUATE.                                                46220099
462300     EJECT                                                        46230099
462400******************************************************************46240099
462500* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *46250099
462600******************************************************************46260099
462700 9100-READ-SEL-QUEUE.                                             46270099
462800     EXEC CICS                                                    46280099
462900         READQ TS                                                 46290099
463000             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        46300099
463100             INTO  (PC016-TS-SEL-REC)                             46310099
463200             ITEM  (PV-ITEM-NBR)                                  46320099
463300             NUMITEMS (PV-NUM-ITEMS)                              46330099
463400             RESP  (PV-CICS-RESP)                                 46340099
463500     END-EXEC.                                                    46350099
463600                                                                  46360099
463700     EVALUATE TRUE                                                46370099
463800     WHEN PV-CICS-RESP EQUAL DFHRESP(NORMAL)                      46380099
463900         CONTINUE                                                 46390099
464000     WHEN PV-CICS-RESP EQUAL DFHRESP(ITEMERR)                     46400099
464100         SET PS-EOF-QUEUE TO TRUE                                 46410099
464200     WHEN OTHER                                                   46420099
464300         MOVE '9100-READ-SEL-QUEUE'                               46430099
464400             TO DP013-PARAGRAPH                                   46440099
464500         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    46450099
464600             TO DP013-MESSAGE-TEXT (1)                            46460099
464700         SET DP013-CICS-ABEND  TO TRUE                            46470099
464800         SET DP013-NO-ROLLBACK TO TRUE                            46480099
464900         PERFORM 9999-WRITE-CICS-LOG-MSG                          46490099
465000         GO TO 0000-GOBACK                                        46500099
465100     END-EVALUATE.                                                46510099
465200     EJECT                                                        46520099
465300 9200-GET-NEXT-PO.                                                46530099
465400                                                                  46540099
465500     SET PC016-IDX UP BY 1                                        46550099
465600                                                                  46560099
465700     IF (PC016-IDX > PC016-MAX-ITEMS)   OR                        46570099
465800                           (PC016-ITEM (PC016-IDX) NOT > ZERO)    46580099
465900         ADD +1                  TO PV-ITEM-NBR                   46590099
466000         IF PV-ITEM-NBR > PV-NUM-ITEMS                            46600099
466100             SET PS-EOF-QUEUE    TO TRUE                          46610099
466200         ELSE                                                     46620099
466300             PERFORM 9100-READ-SEL-QUEUE                          46630099
466400             SET PC016-IDX       TO 1                             46640099
466500         END-IF                                                   46650099
466600     END-IF.                                                      46660099
466700                                                                  46670099
466800     EVALUATE TRUE                                                46680099
466900     WHEN PS-EOF-QUEUE                                            46690099
467000         CONTINUE                                                 46700099
467100     WHEN PC016-ITEM (PC016-IDX) > ZERO                           46710099
467200         MOVE PC016-PO-NBR-N (PC016-IDX)                          46720099
467300                                 TO DK-ORD-NBR                    46730099
467400                                    CA-ORD-NBR                    46740099
467500         MOVE PC016-REC-SEQ-NBR-N (PC016-IDX)                     46750099
467600                                 TO DK-RCVR-SEQ-NBR               46760099
467700                                    CA-RCVR-SEQ-NBR               46770099
467800         MOVE PC016-LINE-NBR-N (PC016-IDX)                        46780099
467900                                 TO DK-ORD-LNE-NBR                46790099
468000                                    CA-ORD-LNE-NBR                46800099
468100         MOVE PC016-WO-NBR-N(PC016-IDX)                           46810099
468200                                 TO  DK-WORK-ORD-SEQ-NBR          46820099
468300                                     CA-WORK-ORD-SEQ-NBR          46830099
468400                                                                  46840099
468500         MOVE PC016-OPER-UNT-ID (PC016-IDX)                       46850099
468600                                 TO DK-OPER-UNT-ID                46860099
468700                                    CA-OPER-UNT-ID                46870099
468800         MOVE PC016-FCLTY-ID (PC016-IDX)                          46880099
468900                                 TO DK-FCLTY-ID                   46890099
469000                                    CA-FCLTY-ID                   46900099
469100                                                                  46910099
469200         MOVE CA-OPER-UNT-ID     TO  HL2-OPERATING-ID             46920099
469300         MOVE CA-FCLTY-ID        TO  HL2-FACILITY-ID              46930099
469400                                                                  46940099
469500         PERFORM 4050-SELECT-PRIM-SHIP                            46950099
469600                                                                  46960099
469700         MOVE CA-RCVR-SEQ-NBR-X  TO  HL6-RCVR-SEQ-NBR             46970099
469800         MOVE CA-ORD-LNE-NBR-X   TO  HL7-LINE-NBR                 46980099
469900         MOVE CA-WORK-ORD-SEQ-NBR-X                               46990099
470000                                 TO HL8-WORK-ORD-NBR              47000099
470100                                                                  47010099
470200        INITIALIZE EA-EXPTED-ALLOC-TABLE                          47020099
470300                   RA-RTV-ALLOC-TABLE                             47030099
470400        MOVE ZERO  TO  PV-TOT-EXPTED-ITM-CNT                      47040099
470500                       PV-STORES-GIVEN-PIECES                     47050099
470600                       PV-TOT-RTV-EXPTED-ITM-CNT                  47060099
470700                       PV-STR-CNT                                 47070099
470800                       PV-RTV-STORES                              47080099
470900        SET EA-ALLOC-IDX         TO 1                             47090099
471000        SET RA-ALLOC-IDX         TO 1                             47100099
471100                                                                  47110099
471200     WHEN PC016-ITEM (PC016-IDX) NOT > ZERO                       47120099
471300        SET PS-EOF-QUEUE         TO TRUE                          47130099
471400     END-EVALUATE.                                                47140099
471500                                                                  47150099
471600/                                                                 47160099
471700 9999-WRITE-CICS-LOG-MSG.                                         47170099
471800                                                                  47180099
471900     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              47190099
472000     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             47200099
472100                                                                  47210099
472200     MOVE PC-PUT                     TO  DRS01-DRRB-FUNC.         47220099
472300                                                                  47230099
472400     MOVE SD-SYSTEM-MONTH            TO  HL1-RUN-MONTH.           47240099
472500     MOVE SD-SYSTEM-DAY              TO  HL1-RUN-DAY.             47250099
472600     MOVE SD-SYSTEM-YEAR             TO  HL1-RUN-YEAR.            47260099
472700     MOVE ST-SYSTEM-HOUR             TO  HL1-RUN-HOUR.            47270099
472800     MOVE ST-SYSTEM-MINUTE           TO  HL1-RUN-MINUTE.          47280099
472900                                                                  47290099
473000     MOVE PC-MARKING-APRON-RPT-HDR   TO  HL1-RPT-HDR              47300099
473100                                                                  47310099
473200     MOVE PC-CURRENT-PROGRAM-NAME    TO HL1-PROGRAM-NAME.         47320099
473300     MOVE 1                          TO  HL1-RPT-NBR.             47330099
473400     MOVE PS-PAGE-SUB                TO  HL1-PGE-NBR.             47340099
473500     MOVE PV-TOTAL-PAGES             TO  HL1-OF-PGE-NBR.          47350099
473600     MOVE HL1-HEADING-LINE-1         TO  DRS01-COMM-DATA.         47360099
473700     IF PS-TOP-OF-PAGE-SET                                        47370099
473800         MOVE PC-DOUBLE-SPACE        TO  DRS01-COMM-CTL           47380099
473900     ELSE                                                         47390099
474000         MOVE PC-TOP-OF-PAGE         TO  DRS01-COMM-CTL           47400099
474100     END-IF.                                                      47410099
474200     SET PS-TOP-OF-PAGE-NOT-SET TO TRUE.                          47420099
474300     PERFORM 8000-LINK-TO-DRS.                                    47430099
474400                                                                  47440099
474500     MOVE HL2-HEADING-LINE-2         TO  DRS01-COMM-DATA.         47450099
474600     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          47460099
474700     PERFORM 8000-LINK-TO-DRS.                                    47470099
474800                                                                  47480099
474900     MOVE CA-PREPAIRER-USER-ID       TO  HL3-PREPAIRER-USER-ID.   47490099
475000     MOVE CA-DESTINATION             TO  HL4-PRINTER-DEST.        47500099
475100     MOVE HL3-HEADING-LINE-3         TO  DRS01-COMM-DATA.         47510099
475200     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          47520099
475300     PERFORM 8000-LINK-TO-DRS.                                    47530099
475400                                                                  47540099
475500     MOVE HL4-HEADING-LINE-4         TO  DRS01-COMM-DATA.         47550099
475600     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          47560099
475700     PERFORM 8000-LINK-TO-DRS.                                    47570099
475800                                                                  47580099
475900     MOVE HL5-HEADING-LINE-5         TO  DRS01-COMM-DATA.         47590099
476000     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          47600099
476100     PERFORM 8000-LINK-TO-DRS.                                    47610099
476200                                                                  47620099
476300     MOVE HL6-HEADING-LINE-6         TO  DRS01-COMM-DATA.         47630099
476400     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          47640099
476500     PERFORM 8000-LINK-TO-DRS.                                    47650099
476600                                                                  47660099
476700     MOVE HL7-HEADING-LINE-7         TO  DRS01-COMM-DATA.         47670099
476800     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          47680099
476900     PERFORM 8000-LINK-TO-DRS.                                    47690099
477000                                                                  47700099
477100     MOVE HL8-HEADING-LINE-8         TO  DRS01-COMM-DATA.         47710099
477200     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          47720099
477300     PERFORM 8000-LINK-TO-DRS.                                    47730099
477400                                                                  47740099
477500     MOVE HL9-HEADING-LINE-9         TO  DRS01-COMM-DATA.         47750099
477600     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          47760099
477700     PERFORM 8000-LINK-TO-DRS.                                    47770099
477800                                                                  47780099
477900     MOVE HL10-HEADING-LINE-10       TO  DRS01-COMM-DATA.         47790099
478000     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          47800099
478100     PERFORM 8000-LINK-TO-DRS.                                    47810099
478200                                                                  47820099
478300     MOVE HL11-HEADING-LINE-11       TO  DRS01-COMM-DATA.         47830099
478400     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          47840099
478500     PERFORM 8000-LINK-TO-DRS.                                    47850099
478600                                                                  47860099
478700     MOVE HL12-HEADING-LINE-12       TO  DRS01-COMM-DATA.         47870099
478800     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          47880099
478900     PERFORM 8000-LINK-TO-DRS.                                    47890099
479000                                                                  47900099
479100     MOVE HL13-HEADING-LINE-13       TO  DRS01-COMM-DATA.         47910099
479200     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          47920099
479300     PERFORM 8000-LINK-TO-DRS.                                    47930099
479400                                                                  47940099
479500     MOVE HL14-HEADING-LINE-14       TO  DRS01-COMM-DATA.         47950099
479600     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          47960099
479700     PERFORM 8000-LINK-TO-DRS.                                    47970099
479800                                                                  47980099
479900     MOVE DH1-DETAIL-HEADING-LINE-1  TO  DRS01-COMM-DATA.         47990099
480000     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          48000099
480100     PERFORM 8000-LINK-TO-DRS.                                    48010099
480200                                                                  48020099
480300     MOVE DH2-DETAIL-HEADING-LINE-2  TO  DRS01-COMM-DATA.         48030099
480400     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          48040099
480500     PERFORM 8000-LINK-TO-DRS.                                    48050099
480600                                                                  48060099
480700     MOVE PC-ABEND-MESSAGE         TO  DRS01-COMM-DATA.           48070099
480800     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            48080099
480900     PERFORM 8000-LINK-TO-DRS.                                    48090099
481000                                                                  48100099
481100     MOVE DP013-PARAGRAPH          TO  DRS01-COMM-DATA.           48110099
481200     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            48120099
481300     PERFORM 8000-LINK-TO-DRS.                                    48130099
481400     MOVE DP013-MESSAGE-TEXT (1)   TO  DRS01-COMM-DATA.           48140099
481500     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            48150099
481600     PERFORM 8000-LINK-TO-DRS.                                    48160099
481700     MOVE DP013-MESSAGE-TEXT (2)   TO  DRS01-COMM-DATA.           48170099
481800     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            48180099
481900     PERFORM 8000-LINK-TO-DRS.                                    48190099
482000     MOVE DP013-MESSAGE-TEXT (3)   TO  DRS01-COMM-DATA.           48200099
482100     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            48210099
482200     PERFORM 8000-LINK-TO-DRS.                                    48220099
482300     MOVE DP013-DB2-TABLE-NAME (1) TO  DRS01-COMM-DATA.           48230099
482400     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            48240099
482500     PERFORM 8000-LINK-TO-DRS.                                    48250099
482600     MOVE DP013-DB2-TABLE-NAME (2) TO  DRS01-COMM-DATA.           48260099
482700     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            48270099
482800     PERFORM 8000-LINK-TO-DRS.                                    48280099
482900     MOVE DP013-DB2-TABLE-NAME (3) TO  DRS01-COMM-DATA.           48290099
483000     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            48300099
483100     PERFORM 8000-LINK-TO-DRS.                                    48310099
483200     MOVE SQLCODE TO PV-SQLCODE.                                  48320099
483300     MOVE PV-SQLCODE-NUMBER        TO  DRS01-COMM-DATA.           48330099
483400     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            48340099
483500     PERFORM 8000-LINK-TO-DRS.                                    48350099
483600                                                                  48360099
483700     SET DP013-LINK-RETURN         TO TRUE.                       48370099
483800     PERFORM DP013-0000-PROCESS-ABEND.                            48380099
483900                                                                  48390099
484000     COPY DPPD013.                                                48400099
484100/                                                                 48410099
