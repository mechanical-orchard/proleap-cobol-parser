00001 ******************************************************************03/17/92
00002  IDENTIFICATION DIVISION.                                         DPKCS005
00003 ******************************************************************   LV002
00004                                                                   DPKCS005
00005  PROGRAM-ID.                DPKCS005.                             DPKCS005
00006  AUTHOR.                    J. KNOKE  (TCC)                       DPKCS005
00007  INSTALLATION.              KOHLS DEPARTMENT STORES.              DPKCS005
00008  DATE-WRITTEN.              10-25-89.                             DPKCS005
00009  DATE-COMPILED.                                                   DPKCS005
00010                                                                   DPKCS005
00011 ******************************************************************DPKCS005
00012 *  CICS PROGRAM - DPKCS005 - Z005                                *DPKCS005
00013 *                                                                *DPKCS005
00014 *   DB2 CHECKPOINT RESTART SYSTEM - CHECKPOINT CONTROL INQUIRY   *DPKCS005
00015 *                                                                *DPKCS005
00016 *   CHANGED 3/92 BY M. FURLICK TO USE CICSAUTH, NOT RCHKCICS     *DPKCS005
00017 *                                                                *DPKCS005
00018 ******************************************************************DPKCS005
00019                                                                   DPKCS005
00020 ******************************************************************DPKCS005
00021  ENVIRONMENT DIVISION.                                            DPKCS005
00022 ******************************************************************DPKCS005
00023                                                                   DPKCS005
00024 ******************************************************************DPKCS005
00025  DATA DIVISION.                                                   DPKCS005
00026 ******************************************************************DPKCS005
00027                                                                   DPKCS005
00028  WORKING-STORAGE SECTION.                                         DPKCS005
00029                                                                   DPKCS005
00030 *                                                                 DPKCS005
00031 *  STANDARD ATTENTION IDENTIFIER LIST                             DPKCS005
00032 *                                                                 DPKCS005
00033                                                                   DPKCS005
00034      COPY DFHAID.                                                 DPKCS005
00035                                                                   DPKCS005
00036 *                                                                 DPKCS005
00037 *  STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST          DPKCS005
00038 *                                                                 DPKCS005
00039                                                                   DPKCS005
00040      COPY DFHBMSCA.                                               DPKCS005
00041                                                                   DPKCS005
00042 *                                                                 DPKCS005
00043 *  DESCRIPTIVE ATTRIBUTES                                         DPKCS005
00044 *                                                                 DPKCS005
00045                                                                   DPKCS005
00046      COPY ATTRIB.                                                 DPKCS005
00047 *                                                                    CL**2
00048 *    COPY BOOK FOR THE CICSAUTH SUBROUTINE                           CL**2
00049 *                                                                    CL**2
00050      COPY DPWS008.                                                   CL**2
00051      EJECT                                                           CL**2
00052  01  PS-PROGRAM-SWITCHES.                                         DPKCS005
00053      05  PS-EDIT-ERROR-IND            PIC X(1)    VALUE 'N'.      DPKCS005
00054          88  PS-NO-EDIT-ERROR                     VALUE 'N'.      DPKCS005
00055          88  PS-EDIT-ERROR                        VALUE 'Y'.      DPKCS005
00056                                                                   DPKCS005
00057  01  PV-PROGRAM-VARIABLES.                                        DPKCS005
00058      05  PV-CICS-RESPONSE             PIC S9(9)   VALUE ZERO      DPKCS005
00059                                       COMP SYNC.                  DPKCS005
00060      05  PV-LAST-DB2-ACTION           PIC X(48)   VALUE SPACES.   DPKCS005
00061          88  PV-OPEN-JOB-PLAN-CURSOR              VALUE           DPKCS005
00062              'OPEN JOB/PLAN CURSOR  -  TCKRSTCNTL            '.   DPKCS005
00063          88  PV-OPEN-JOB-CURSOR                   VALUE           DPKCS005
00064              'OPEN JOB CURSOR  -  TCKRSTCNTL                 '.   DPKCS005
00065          88  PV-OPEN-PLAN-CURSOR                  VALUE           DPKCS005
00066              'OPEN PLAN CURSOR  -  TCKRSTCNTL                '.   DPKCS005
00067          88  PV-FETCH-JOB-PLAN-TABLE              VALUE           DPKCS005
00068              'FETCH JOB/PLAN TABLE  -  TCKRSTCNTL            '.   DPKCS005
00069          88  PV-FETCH-JOB-TABLE                   VALUE           DPKCS005
00070              'FETCH JOB TABLE  -  TCKRSTCNTL                 '.   DPKCS005
00071          88  PV-FETCH-PLAN-TABLE                  VALUE           DPKCS005
00072              'FETCH PLAN TABLE  -  TCKRSTCNTL                '.   DPKCS005
00073          88  PV-CLOSE-JOB-PLAN-CURSOR             VALUE           DPKCS005
00074              'CLOSE JOB/PLAN CURSOR  -  TCKRSTCNTL           '.   DPKCS005
00075          88  PV-CLOSE-JOB-CURSOR                  VALUE           DPKCS005
00076              'CLOSE JOB CURSOR  -  TCKRSTCNTL                '.   DPKCS005
00077          88  PV-CLOSE-PLAN-CURSOR                 VALUE           DPKCS005
00078              'CLOSE PLAN CURSOR  -  TCKRSTCNTL               '.   DPKCS005
00079                                                                   DPKCS005
00080  01  PC-PROGRAM-CONSTANTS.                                        DPKCS005
00081      05  PC-MAIN-MENU                 PIC X(8)    VALUE           DPKCS005
00082          'DPKCS000'.                                              DPKCS005
00083      05  PC-RACF-PROGRAM              PIC X(8)    VALUE           DPKCS005
00084          'RCHKCICS'.                                              DPKCS005
00085      05  PC-DB2-ERROR-LENGTH          PIC S9(4)   VALUE +290      DPKCS005
00086                                       COMP SYNC.                  DPKCS005
00087      05  PC-DB2-WARNING-LENGTH        PIC S9(4)   VALUE +164      DPKCS005
00088                                       COMP SYNC.                  DPKCS005
00089      05  PC-TRANS-DPKCS004-LENGTH     PIC S9(4)   VALUE +33       DPKCS005
00090                                       COMP SYNC.                  DPKCS005
00091      05  PC-COMMON-AREA-LENGTH        PIC S9(4)   VALUE +83       DPKCS005
00092                                       COMP SYNC.                  DPKCS005
00093      05  PC-EOF-KEYED-COMP            PIC S9(4)   VALUE +128      DPKCS005
00094                                       COMP SYNC.                  DPKCS005
00095      05  FILLER                       REDEFINES                   DPKCS005
00096                                           PC-EOF-KEYED-COMP.      DPKCS005
00097          10  FILLER                   PIC X.                      DPKCS005
00098          10  PC-EOF-KEYED             PIC X.                      DPKCS005
00099      05  PC-MAX-RETRY                 PIC S9(4)   VALUE +3        DPKCS005
00100                                       COMP SYNC.                  DPKCS005
00101      05  PC-MORE-THAN-MAX-RETRY       PIC S9(4)   VALUE +4        DPKCS005
00102                                       COMP SYNC.                  DPKCS005
00103      05  PC-VALID-STATUS-CODES.                                   DPKCS005
00104          10  PC-STATUS-CODE-0         PIC X       VALUE '0'.      DPKCS005
00105          10  PC-STATUS-CODE-1         PIC X       VALUE '1'.      DPKCS005
00106          10  PC-STATUS-CODE-2         PIC X       VALUE '2'.      DPKCS005
00107          10  PC-STATUS-CODE-3         PIC X       VALUE '3'.      DPKCS005
00108          10  PC-STATUS-CODE-4         PIC X       VALUE '4'.      DPKCS005
00109          10  PC-STATUS-CODE-9         PIC X       VALUE '9'.      DPKCS005
00110      05  PC-VALID-CONTROL-CODES.                                  DPKCS005
00111          10  PC-CONTROL-CODE-A        PIC X       VALUE 'A'.      DPKCS005
00112          10  PC-CONTROL-CODE-R        PIC X       VALUE 'R'.      DPKCS005
00113      05  PC-VALID-TYPE-CODES.                                     DPKCS005
00114          10  PC-TYPE-CODE-C           PIC X       VALUE 'C'.      DPKCS005
00115          10  PC-TYPE-CODE-L           PIC X       VALUE 'L'.      DPKCS005
00116          10  PC-TYPE-CODE-T           PIC X       VALUE 'T'.      DPKCS005
00117                                                                   DPKCS005
00118  01  PT-PROGRAM-TRANSFER-AREAS.                                   DPKCS005
00119      05  PT-TRANSFER-PROGRAM          PIC X(8)    VALUE SPACES.   DPKCS005
00120      05  PT-TRANSFER-LENGTH           PIC S9(4)   VALUE +0        DPKCS005
00121                                       COMP SYNC.                  DPKCS005
00122                                                                   DPKCS005
00123  01  PW-PROGRAM-WORKAREAS.                                        DPKCS005
00124      05  PW-JOB-NAME.                                             DPKCS005
00125          10  PW-JOB-NME               OCCURS 8 TIMES              DPKCS005
00126                                       INDEXED BY PW-JOB-INDEX     DPKCS005
00127                                       PIC X.                      DPKCS005
00128      05  PW-PLAN-NAME.                                            DPKCS005
00129          10  PW-PLN-NME               OCCURS 8 TIMES              DPKCS005
00130                                       INDEXED BY PW-PLN-INDEX     DPKCS005
00131                                       PIC X.                      DPKCS005
00132                                                                   DPKCS005
00133      05  PW-TIMESTAMP-BREAKDOWN.                                  DPKCS005
00134          10  PW-TMESTP-DTE            PIC X(10)   VALUE SPACES.   DPKCS005
00135          10  FILLER                   PIC X       VALUE SPACES.   DPKCS005
00136          10  PW-TMESTP-TME            PIC X(8)    VALUE SPACES.   DPKCS005
00137          10  FILLER                   PIC X(7)    VALUE SPACES.   DPKCS005
00138                                                                   DPKCS005
00139      05  PW-TIME-BREAKDOWN.                                       DPKCS005
00140          10  PW-TIME                  PIC X(8)    VALUE SPACES.   DPKCS005
00141          10  FILLER                   PIC X(4)    VALUE SPACES.   DPKCS005
00142                                                                   DPKCS005
00143      05  PW-RETRY-COUNT               PIC S9(4)   VALUE +0        DPKCS005
00144                                       COMP SYNC.                  DPKCS005
00145      05  PW-NULL-PREP-TMESTP          PIC S9(4)   VALUE +0        DPKCS005
00146                                       COMP SYNC.                  DPKCS005
00147      05  PW-NULL-PRCSD-TMESTP         PIC S9(4)   VALUE +0        DPKCS005
00148                                       COMP SYNC.                  DPKCS005
00149      05  PW-NULL-DUR-TIME             PIC S9(4)   VALUE +0        DPKCS005
00150                                       COMP SYNC.                  DPKCS005
00151      05  PW-JOB-RANGE                 PIC X(8)                    DPKCS005
00152                                           VALUE LOW-VALUES.       DPKCS005
00153      05  FILLER   REDEFINES   PW-JOB-RANGE.                       DPKCS005
00154          10  PW-JOB        OCCURS  8  TIMES                       DPKCS005
00155                            INDEXED BY JOB-INDEX                   DPKCS005
00156                                       PIC X.                      DPKCS005
00157      05  PW-JOB-HIGH-RANGE            PIC X(8)                    DPKCS005
00158                                           VALUE HIGH-VALUES.      DPKCS005
00159      05  FILLER   REDEFINES   PW-JOB-HIGH-RANGE.                  DPKCS005
00160          10  PW-JOB-HIGH   OCCURS  8  TIMES                       DPKCS005
00161                            INDEXED BY JOB-HIGH-INDEX              DPKCS005
00162                                       PIC X.                      DPKCS005
00163      05  PW-PLAN-RANGE                PIC X(8)                    DPKCS005
00164                                           VALUE LOW-VALUES.       DPKCS005
00165      05  FILLER   REDEFINES   PW-PLAN-RANGE.                      DPKCS005
00166          10  PW-PLAN       OCCURS  8  TIMES                       DPKCS005
00167                            INDEXED BY PLAN-INDEX                  DPKCS005
00168                                       PIC X.                      DPKCS005
00169      05  PW-PLAN-HIGH-RANGE           PIC X(8)                    DPKCS005
00170                                           VALUE HIGH-VALUES.      DPKCS005
00171      05  FILLER   REDEFINES   PW-PLAN-HIGH-RANGE.                 DPKCS005
00172          10  PW-PLAN-HIGH  OCCURS  8  TIMES                       DPKCS005
00173                            INDEXED BY PLAN-HIGH-INDEX             DPKCS005
00174                                       PIC X.                      DPKCS005
00175                                                                   DPKCS005
00176 *************                                                     DPKCS005
00177 *   UNFORMATTED MESSAGES FOR DB2 ERRORS/WARNINGS                  DPKCS005
00178 *************                                                     DPKCS005
00179                                                                   DPKCS005
00180  01  DB2-MESSSAGE.                                                DPKCS005
00181                                                                   DPKCS005
00182      05  DM-RESOURCE-UNAVAIL-MSG.                                 DPKCS005
00183          10  FILLER                        PIC X(48)   VALUE      DPKCS005
00184              'A RESOURCE WAS NOT AVAILABLE.  PLEASE TRY AGAIN.'.  DPKCS005
00185          10  FILLER                        PIC X(36)   VALUE      DPKCS005
00186              'IF THE PROBLEM PERSISTS, CONTACT DP '.              DPKCS005
00187                                                                   DPKCS005
00188      05  DM-DEADLOCK-TIMEOUT-MSG.                                 DPKCS005
00189          10  FILLER                        PIC X(48)   VALUE      DPKCS005
00190              'DEADLOCK OR TIMEOUT.  PLEASE TRY AGAIN.         '.  DPKCS005
00191          10  FILLER                        PIC X(36)   VALUE      DPKCS005
00192              'IF THE PROBLEM PERSISTS, CONTACT DP '.              DPKCS005
00193                                                                   DPKCS005
00194      05  DM-NOT-AUTHORIZED-MSG.                                   DPKCS005
00195          10  FILLER                        PIC X(48)   VALUE      DPKCS005
00196              'CONNECTION AUTHORIZATION FAILURE.  CONTACT DP.  '.  DPKCS005
00197                                                                   DPKCS005
00198      05  DM-NOT-CONNECTED-MSG.                                    DPKCS005
00199          10  FILLER                        PIC X(48)   VALUE      DPKCS005
00200              'CONNECTION NOT ESTABLISHED.  TRY AGAIN.         '.  DPKCS005
00201          10  FILLER                        PIC X(36)   VALUE      DPKCS005
00202              'IF PROBLEM PERSISTS, CONTACT DP.    '.              DPKCS005
00203                                                                   DPKCS005
00204      05  DM-OTHER-DB2-ERROR-MSG.                                  DPKCS005
00205          10  FILLER                        PIC X(48)   VALUE      DPKCS005
00206              'A DB2 ERROR HAS OCCURRED - CONTACT DP - '.          DPKCS005
00207                                                                   DPKCS005
00208      05  DM-DB2-ERROR-MSG.                                        DPKCS005
00209          10  DM-ERROR-MSG                  PIC X(84).             DPKCS005
00210          10  FILLER                        PIC X(45)   VALUE      DPKCS005
00211              'PROGRAM DPKCS005'.                                  DPKCS005
00212          10  FILLER                        PIC X(11)   VALUE      DPKCS005
00213              'SQLCODE = ('.                                       DPKCS005
00214          10  DM-SQLCODE                    PIC Z(8)9-  VALUE ZERO.DPKCS005
00215          10  FILLER                        PIC X(22)   VALUE      DPKCS005
00216              ')   ROWS PROCESSED = ('.                            DPKCS005
00217          10  DM-ROWS-ERR-PROCESSED         PIC Z(8)9-  VALUE ZERO.DPKCS005
00218          10  FILLER                        PIC X(2)    VALUE ')'. DPKCS005
00219          10  FILLER                        PIC X(11)   VALUE      DPKCS005
00220              'SQLERRML= ('.                                       DPKCS005
00221          10  DM-SQLERRML                   PIC Z(8)9-  VALUE ZERO.DPKCS005
00222          10  FILLER                        PIC X(15)   VALUE      DPKCS005
00223              ')   SQLERRMC = '.                                   DPKCS005
00224          10  DM-SQLERRMC                   PIC X(70)   VALUE ZERO.DPKCS005
00225                                                                   DPKCS005
00226      05  DM-DB2-WARNING-MSG.                                      DPKCS005
00227          10  FILLER                        PIC X(42)   VALUE      DPKCS005
00228              'A DB2 WARNING HAS OCCURRED - CONTACT DP - '.        DPKCS005
00229          10  FILLER                        PIC X(43)   VALUE      DPKCS005
00230              'PROGRAM DPKCS005'.                                  DPKCS005
00231          10  FILLER                        PIC X(11)   VALUE      DPKCS005
00232              'SQLWARN = ('.                                       DPKCS005
00233          10  DM-SQLWARN                    PIC X(8)    VALUE      DPKCS005
00234                                                       SPACES.     DPKCS005
00235          10  FILLER                        PIC X(14)   VALUE      DPKCS005
00236              ')  SQLCODE = ('.                                    DPKCS005
00237          10  DM-SQLCODE1                   PIC Z(8)9-  VALUE ZERO.DPKCS005
00238          10  FILLER                        PIC X(22)   VALUE      DPKCS005
00239              ')   ROWS PROCESSED = ('.                            DPKCS005
00240          10  DM-ROWS-WRN-PROCESSED         PIC Z(8)9-  VALUE ZERO.DPKCS005
00241          10  FILLER                        PIC X(4)    VALUE ')'. DPKCS005
00242                                                                   DPKCS005
00243  01  ST-SYSTEM-TIME-AREA.                                         DPKCS005
00244      05  ST-ABSTIME                   PIC S9(18)  VALUE ZERO      DPKCS005
00245                                       COMP SYNC.                  DPKCS005
00246      05  ST-TIME-EDIT.                                            DPKCS005
00247          10  ST-TIME-HHMM             PIC X(5)    VALUE SPACES.   DPKCS005
00248          10  FILLER                   PIC X(3)    VALUE SPACES.   DPKCS005
00249                                                                   DPKCS005
00250  01  SE-SYSTEM-ERROR-MESSAGE.                                     DPKCS005
00251      05  FILLER                       PIC X(43)   VALUE           DPKCS005
00252          'A SYSTEM ERROR HAS OCCURRED - CONTACT DP -'.            DPKCS005
00253      05  FILLER                       PIC X(33)   VALUE           DPKCS005
00254          'PROGRAM DPKCS005       EIBRESP = '.                     DPKCS005
00255      05  SE-CICS-RESPONSE             PIC 9(4)    VALUE ZERO.     DPKCS005
00256      05  FILLER                       PIC X(5)    VALUE SPACES.   DPKCS005
00257      05  FILLER                       PIC X(14)   VALUE           DPKCS005
00258          'ATTEMPING TO '.                                         DPKCS005
00259      05  SE-ATTEMPTED-ACTION          PIC X(61)   VALUE SPACES.   DPKCS005
00260                                                                   DPKCS005
00261  01  CA-COMMON-AREA.                                              DPKCS005
00262      05  CA-COMMON-DATA.                                          DPKCS005
00263          10 CA-TRANSACTION-STATUS     PIC X.                      DPKCS005
00264              88  CA-INITIALIZE-SCREEN           VALUE 'S'.        DPKCS005
00265              88  CA-PROCESS-SCREEN              VALUE 'R'.        DPKCS005
00266          10  CA-MAIN-MENU             PIC X(8).                   DPKCS005
00267          10  CA-LAST-PROGRAM          PIC X(8).                   DPKCS005
00268          10  CA-SAVE-CURR-JOB         PIC X(8)  VALUE SPACES.     DPKCS005
00269          10  CA-SAVE-CURR-PLAN        PIC X(8)  VALUE SPACES.     DPKCS005
00270          10  CA-SAVE-FIRST-JOB        PIC X(8)  VALUE SPACES.     DPKCS005
00271          10  CA-SAVE-FIRST-PLAN       PIC X(8)  VALUE SPACES.     DPKCS005
00272          10  CA-SAVE-JOB-HIGH-RANGE   PIC X(8)  VALUE SPACES.     DPKCS005
00273          10  CA-SAVE-PLAN-HIGH-RANGE  PIC X(8)  VALUE SPACES.     DPKCS005
00274          10  CA-SAVE-NEXT-JOB         PIC X(8)  VALUE SPACES.     DPKCS005
00275          10  CA-SAVE-NEXT-PLAN        PIC X(8)  VALUE SPACES.     DPKCS005
00276          10  CA-JOB-INQUIRY           PIC X     VALUE 'N'.        DPKCS005
00277              88  CA-NO-JOB-INQ                  VALUE 'N'.        DPKCS005
00278              88  CA-JOB-INQ                     VALUE 'Y'.        DPKCS005
00279          10  CA-PLAN-INQUIRY          PIC X     VALUE 'N'.        DPKCS005
00280              88  CA-NO-PLAN-INQ                 VALUE 'N'.        DPKCS005
00281              88  CA-PLAN-INQ                    VALUE 'Y'.        DPKCS005
00282                                                                   DPKCS005
00283  01  PM-PROGRAM-MESSAGE-DATA.                                     DPKCS005
00284      05  FILLER                       PIC X(79)  VALUE            DPKCS005
00285          '                                           '.           DPKCS005
00286      05  FILLER                       PIC X(79)  VALUE            DPKCS005
00287          'UNKNOWN PF KEY PRESSED'.                                DPKCS005
00288      05  FILLER                       PIC X(79)  VALUE            DPKCS005
00289          'JOB/PLAN DOES NOT EXIST'.                               DPKCS005
00290      05  FILLER                       PIC X(79)  VALUE            DPKCS005
00291          'END OF REQUESTED JOB/PLANS'.                            DPKCS005
00292      05  FILLER                       PIC X(79)  VALUE            DPKCS005
00293          'SECURITY VIOLATION'.                                    DPKCS005
00294      05  FILLER                       PIC X(79)  VALUE            DPKCS005
00295          'BAD LINK TO RACF PROGRAM  -  NOTIFY DP'.                DPKCS005
00296      05  FILLER                       PIC X(79)  VALUE            DPKCS005
00297          'JOB NAME AND/OR PLAN NAME REQUIRED'.                    DPKCS005
00298      05  FILLER                       PIC X(79)  VALUE            DPKCS005
00299          'PRESS PF8 TO BROWSE THE NEXT JOB/PLAN'.                 DPKCS005
00300  01  PM-PROGRAM-MESSAGE-TABLE   REDEFINES                         DPKCS005
00301                                    PM-PROGRAM-MESSAGE-DATA.       DPKCS005
00302      05  PM-PROGRAM-MESSAGE           OCCURS   8   TIMES          DPKCS005
00303                                 INDEXED BY PM-MESSAGE-INDEX       DPKCS005
00304                                       PIC X(79).                  DPKCS005
00305  01  PM-CICSAUTH-MESSAGE.                                         DPKCS005
00306      05  FILLER                       PIC X(36)  VALUE            DPKCS005
00307          'INVALID RETURN CODE FROM CICSAUTH - '.                  DPKCS005
00308      05  PM-CM-RETURN-CODE            PIC 9(4).                   DPKCS005
00309 *                                                                 DPKCS005
00310 *  DSECT FOR THE DPKM005 MAPSET                                   DPKCS005
00311 *                                                                 DPKCS005
00312                                                                   DPKCS005
00313      COPY DPKM005.                                                DPKCS005
00314                                                                   DPKCS005
00315 *                                                                 DPKCS005
00316 *  SQL AND COBOL DECLARATIONS FOR THE                             DPKCS005
00317 *  (TCKRSTCN)                                                     DPKCS005
00318 *                                                                 DPKCS005
00319                                                                   DPKCS005
00320      EXEC SQL                                                     DPKCS005
00321          INCLUDE TCKRSTCN                                         DPKCS005
00322      END-EXEC.                                                    DPKCS005
00323                                                                   DPKCS005
00324 *                                                                 DPKCS005
00325 *  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                DPKCS005
00326 *                                                                 DPKCS005
00327                                                                   DPKCS005
00328      EXEC SQL                                                     DPKCS005
00329          INCLUDE SQLCA                                            DPKCS005
00330      END-EXEC.                                                    DPKCS005
00331                                                                   DPKCS005
00332 *                                                                 DPKCS005
00333 *  CURSOR USED TO RETRIEVE THE NEXT JOB AND PLAN NAME             DPKCS005
00334 *                                                                 DPKCS005
00335                                                                   DPKCS005
00336      EXEC SQL                                                     DPKCS005
00337          DECLARE JOBCSR CURSOR FOR                                DPKCS005
00338              SELECT JOB_NAME,                                     DPKCS005
00339                     PLAN_NAME,                                    DPKCS005
00340                     CKPT_STAT_CODE,                               DPKCS005
00341                     CKPT_CNTL_CODE,                               DPKCS005
00342                     CKPT_TYPE_CODE,                               DPKCS005
00343                     CKPT_FRQNCY_QTY,                              DPKCS005
00344                     TRANS_QTY,                                    DPKCS005
00345                     PREP_TMESTP,                                  DPKCS005
00346                     CKPT_TAKEN_QTY,                               DPKCS005
00347                     TRANS_PRCSD_QTY,                              DPKCS005
00348                     RST_QTY,                                      DPKCS005
00349                     PRCSD_TMESTP,                                 DPKCS005
00350                     CKPT_DURATION_TIME                            DPKCS005
00351              FROM TCKRSTCNTL                                      DPKCS005
00352              WHERE JOB_NAME  >= :PW-JOB-RANGE                     DPKCS005
00353              ORDER BY JOB_NAME,                                   DPKCS005
00354                       PLAN_NAME                                   DPKCS005
00355      END-EXEC.                                                    DPKCS005
00356                                                                   DPKCS005
00357      EXEC SQL                                                     DPKCS005
00358          DECLARE PLANCSR CURSOR FOR                               DPKCS005
00359              SELECT JOB_NAME,                                     DPKCS005
00360                     PLAN_NAME,                                    DPKCS005
00361                     CKPT_STAT_CODE,                               DPKCS005
00362                     CKPT_CNTL_CODE,                               DPKCS005
00363                     CKPT_TYPE_CODE,                               DPKCS005
00364                     CKPT_FRQNCY_QTY,                              DPKCS005
00365                     TRANS_QTY,                                    DPKCS005
00366                     PREP_TMESTP,                                  DPKCS005
00367                     CKPT_TAKEN_QTY,                               DPKCS005
00368                     TRANS_PRCSD_QTY,                              DPKCS005
00369                     RST_QTY,                                      DPKCS005
00370                     PRCSD_TMESTP,                                 DPKCS005
00371                     CKPT_DURATION_TIME                            DPKCS005
00372              FROM TCKRSTCNTL                                      DPKCS005
00373              WHERE PLAN_NAME  >= :PW-PLAN-RANGE                   DPKCS005
00374              ORDER BY PLAN_NAME,                                  DPKCS005
00375                       JOB_NAME                                    DPKCS005
00376      END-EXEC.                                                    DPKCS005
00377                                                                   DPKCS005
00378      EXEC SQL                                                     DPKCS005
00379          DECLARE INQCSR CURSOR FOR                                DPKCS005
00380              SELECT JOB_NAME,                                     DPKCS005
00381                     PLAN_NAME,                                    DPKCS005
00382                     CKPT_STAT_CODE,                               DPKCS005
00383                     CKPT_CNTL_CODE,                               DPKCS005
00384                     CKPT_TYPE_CODE,                               DPKCS005
00385                     CKPT_FRQNCY_QTY,                              DPKCS005
00386                     TRANS_QTY,                                    DPKCS005
00387                     PREP_TMESTP,                                  DPKCS005
00388                     CKPT_TAKEN_QTY,                               DPKCS005
00389                     TRANS_PRCSD_QTY,                              DPKCS005
00390                     RST_QTY,                                      DPKCS005
00391                     PRCSD_TMESTP,                                 DPKCS005
00392                     CKPT_DURATION_TIME                            DPKCS005
00393              FROM TCKRSTCNTL                                      DPKCS005
00394              WHERE JOB_NAME   = :PW-JOB-RANGE                     DPKCS005
00395                AND PLAN_NAME  = :PW-PLAN-RANGE                    DPKCS005
00396              ORDER BY JOB_NAME,                                   DPKCS005
00397                       PLAN_NAME                                   DPKCS005
00398      END-EXEC.                                                    DPKCS005
00399                                                                   DPKCS005
00400                                                                   DPKCS005
00401 ******************************************************************DPKCS005
00402  LINKAGE SECTION.                                                 DPKCS005
00403 ******************************************************************DPKCS005
00404                                                                   DPKCS005
00405  01  DFHCOMMAREA.                                                 DPKCS005
00406      05  DF-COMMON-DATA.                                          DPKCS005
00407          10 DF-TRANSACTION-STATUS     PIC X.                      DPKCS005
00408              88  DF-INITIALIZE-SCREEN           VALUE 'S'.        DPKCS005
00409              88  DF-PROCESS-SCREEN              VALUE 'R'.        DPKCS005
00410          10  DF-MAIN-MENU             PIC X(8).                   DPKCS005
00411          10  DF-LAST-PROGRAM          PIC X(8).                   DPKCS005
00412          10  DF-SAVE-CURR-JOB         PIC X(8).                   DPKCS005
00413          10  DF-SAVE-CURR-PLAN        PIC X(8).                   DPKCS005
00414          10  DF-SAVE-FIRST-JOB        PIC X(8).                   DPKCS005
00415          10  DF-SAVE-FIRST-PLAN       PIC X(8).                   DPKCS005
00416          10  DF-SAVE-JOB-HIGH-RANGE   PIC X(8).                   DPKCS005
00417          10  DF-SAVE-PLAN-HIGH-RANGE  PIC X(8).                   DPKCS005
00418          10  DF-SAVE-NEXT-JOB         PIC X(8).                   DPKCS005
00419          10  DF-SAVE-NEXT-PLAN        PIC X(8).                   DPKCS005
00420          10  DF-JOB-INQUIRY           PIC X.                      DPKCS005
00421              88  DF-NO-JOB-INQ                  VALUE 'N'.        DPKCS005
00422              88  DF-JOB-INQ                     VALUE 'Y'.        DPKCS005
00423          10  DF-PLAN-INQUIRY          PIC X.                      DPKCS005
00424              88  DF-NO-PLAN-INQ                 VALUE 'N'.        DPKCS005
00425              88  DF-PLAN-INQ                    VALUE 'Y'.        DPKCS005
00426                                                                   DPKCS005
00427  01  DF-TWA-AREA.                                                 DPKCS005
00428      05  DF-TWA-TRANID                PIC X(4).                   DPKCS005
00429      05  DF-TWA-AUTHOR                PIC X.                      DPKCS005
00430      05  FILLER                       PIC X(95).                  DPKCS005
00431                                                                   DPKCS005
00432 ******************************************************************DPKCS005
00433  PROCEDURE DIVISION.                                              DPKCS005
00434 ******************************************************************DPKCS005
00435                                                                   DPKCS005
00436  0000-MAINLINE.                                                   DPKCS005
00437                                                                   DPKCS005
00438      SET PM-MESSAGE-INDEX TO 1.                                   DPKCS005
00439      MOVE DFHRED TO AMSGC.                                        DPKCS005
00440      MOVE DFHCOMMAREA TO CA-COMMON-AREA.                          DPKCS005
00441      MOVE LOW-VALUES TO DP005AI.                                  DPKCS005
00442                                                                   DPKCS005
00443      EVALUATE TRUE                                                DPKCS005
00444          WHEN CA-LAST-PROGRAM = 'DPKCS004'                        DPKCS005
00445              PERFORM 2000-PROCESS-SCREEN-FIELDS                   DPKCS005
00446          WHEN EIBCALEN = 0                                        DPKCS005
00447              PERFORM 9000-RETURN-MAIN-MENU                        DPKCS005
00448          WHEN DF-INITIALIZE-SCREEN                                DPKCS005
00449              PERFORM 1000-INITIALIZE                              DPKCS005
00450          WHEN EIBAID = DFHPF4                                     DPKCS005
00451              PERFORM 9000-RETURN-MAIN-MENU                        DPKCS005
00452          WHEN EIBAID = DFHPF5                                     DPKCS005
00453              PERFORM 9200-TRANS-TO-MAINTENANCE                    DPKCS005
00454          WHEN EIBAID = DFHCLEAR                                   DPKCS005
00455              INITIALIZE CA-SAVE-CURR-JOB                          DPKCS005
00456                         CA-SAVE-CURR-PLAN                         DPKCS005
00457              PERFORM 1000-INITIALIZE                              DPKCS005
00458          WHEN OTHER                                               DPKCS005
00459              PERFORM 2000-PROCESS-SCREEN-FIELDS                   DPKCS005
00460      END-EVALUATE.                                                DPKCS005
00461                                                                   DPKCS005
00462      GOBACK.                                                      DPKCS005
00463                                                                   DPKCS005
00464                                                                   DPKCS005
00465 ******************************************************************DPKCS005
00466 *  INITIALIZE SCREEN FIELDS AND THE COMMON AREA FOR PROCESSING.  *DPKCS005
00467 *  SEND THE MAP AND THE INITIAL DATA.                            *DPKCS005
00468 ******************************************************************DPKCS005
00469                                                                   DPKCS005
00470  1000-INITIALIZE.                                                 DPKCS005
00471                                                                   DPKCS005
00472      MOVE 'DPKCS000' TO CA-MAIN-MENU.                             DPKCS005
00473      SET CA-PROCESS-SCREEN TO TRUE.                               DPKCS005
00474      INITIALIZE                                                   DPKCS005
00475              CA-SAVE-FIRST-JOB                                    DPKCS005
00476              CA-SAVE-FIRST-PLAN                                   DPKCS005
00477              CA-SAVE-JOB-HIGH-RANGE                               DPKCS005
00478              CA-SAVE-PLAN-HIGH-RANGE                              DPKCS005
00479              CA-SAVE-NEXT-JOB                                     DPKCS005
00480              CA-SAVE-NEXT-PLAN                                    DPKCS005
00481              CA-JOB-INQUIRY                                       DPKCS005
00482              CA-PLAN-INQUIRY.                                     DPKCS005
00483                                                                   DPKCS005
00484      PERFORM 7000-UPDATE-SCREEN-HEADER.                           DPKCS005
00485                                                                   DPKCS005
00486      IF CA-LAST-PROGRAM = 'DPKCS004'                              DPKCS005
00487          MOVE SPACES TO CA-LAST-PROGRAM                           DPKCS005
00488          MOVE CA-SAVE-CURR-JOB TO AJOBNMEO                        DPKCS005
00489          MOVE CA-SAVE-CURR-PLAN TO APLNNMEO                       DPKCS005
00490      END-IF.                                                      DPKCS005
00491                                                                   DPKCS005
00492      EXEC CICS                                                    DPKCS005
00493          SEND                                                     DPKCS005
00494              MAP('DP005A')                                        DPKCS005
00495              MAPSET('DPKM005')                                    DPKCS005
00496              ERASE                                                DPKCS005
00497              FORMFEED                                             DPKCS005
00498      END-EXEC.                                                    DPKCS005
00499                                                                   DPKCS005
00500      EXEC CICS                                                    DPKCS005
00501          RETURN                                                   DPKCS005
00502              TRANSID('Z005')                                      DPKCS005
00503              COMMAREA(CA-COMMON-AREA)                             DPKCS005
00504              LENGTH(PC-COMMON-AREA-LENGTH)                        DPKCS005
00505      END-EXEC.                                                    DPKCS005
00506 *1000-EXIT.        EXIT.                                          DPKCS005
00507                                                                   DPKCS005
00508                                                                   DPKCS005
00509 ******************************************************************DPKCS005
00510 *  RECEIVE AND INITIALIZE THE SCREEN, EDIT THE FUNCTION KEYS     *DPKCS005
00511 *  AND THE MAP FIELDS TO DETERMINE TYPE OF INQUIRY. IF NO        *DPKCS005
00512 *  ERRORS, SEND THE MAP, OTHERWISE DISPLAY ERROR MESSAGE.        *DPKCS005
00513 ******************************************************************DPKCS005
00514                                                                   DPKCS005
00515  2000-PROCESS-SCREEN-FIELDS.                                      DPKCS005
00516                                                                   DPKCS005
00517      SET PS-NO-EDIT-ERROR TO TRUE.                                DPKCS005
00518                                                                   DPKCS005
00519      IF ((EIBAID = DFHPF6 OR DFHPF8)                              DPKCS005
00520        AND (CA-JOB-INQ                                            DPKCS005
00521        AND CA-PLAN-INQ))                                          DPKCS005
00522            MOVE DFHENTER TO EIBAID                                DPKCS005
00523      END-IF.                                                      DPKCS005
00524                                                                   DPKCS005
00525      EVALUATE TRUE                                                DPKCS005
00526          WHEN CA-LAST-PROGRAM = 'DPKCS004'                        DPKCS005
00527            IF (CA-SAVE-CURR-JOB = SPACES OR LOW-VALUES            DPKCS005
00528              AND CA-SAVE-CURR-PLAN = SPACES OR LOW-VALUES)        DPKCS005
00529                INITIALIZE CA-SAVE-CURR-JOB                        DPKCS005
00530                           CA-SAVE-CURR-PLAN                       DPKCS005
00531                PERFORM 1000-INITIALIZE                            DPKCS005
00532            ELSE                                                   DPKCS005
00533              MOVE SPACES TO CA-LAST-PROGRAM                       DPKCS005
00534              MOVE CA-SAVE-CURR-JOB TO AJOBNMEI                    DPKCS005
00535              MOVE CA-SAVE-CURR-PLAN TO APLNNMEI                   DPKCS005
00536              MOVE DFHENTER TO EIBAID                              DPKCS005
00537              PERFORM 2110-SET-INQUIRY-SW                          DPKCS005
00538              PERFORM 2200-EDIT-JOB-PLAN                           DPKCS005
00539            END-IF                                                 DPKCS005
00540          WHEN EIBAID = DFHENTER                                   DPKCS005
00541              PERFORM 2100-RECEIVE-SCREEN-FIELDS                   DPKCS005
00542              PERFORM 2110-SET-INQUIRY-SW                          DPKCS005
00543              PERFORM 2200-EDIT-JOB-PLAN                           DPKCS005
00544          WHEN EIBAID = DFHPF6                                     DPKCS005
00545              MOVE CA-SAVE-FIRST-JOB TO PW-JOB-RANGE               DPKCS005
00546                                        CA-SAVE-NEXT-JOB           DPKCS005
00547              MOVE CA-SAVE-FIRST-PLAN TO PW-PLAN-RANGE             DPKCS005
00548                                         CA-SAVE-NEXT-PLAN         DPKCS005
00549          WHEN EIBAID = DFHPF8                                     DPKCS005
00550              MOVE CA-SAVE-NEXT-JOB TO PW-JOB-RANGE                DPKCS005
00551              MOVE CA-SAVE-NEXT-PLAN TO PW-PLAN-RANGE              DPKCS005
00552          WHEN OTHER                                               DPKCS005
00553              SET PS-EDIT-ERROR TO TRUE                            DPKCS005
00554              SET PM-MESSAGE-INDEX TO 2                            DPKCS005
00555              PERFORM 9600-SEND-AND-RETURN                         DPKCS005
00556      END-EVALUATE.                                                DPKCS005
00557                                                                   DPKCS005
00558      PERFORM 8000-INITIALIZE-SCREEN.                              DPKCS005
00559                                                                   DPKCS005
00560      IF PS-NO-EDIT-ERROR                                          DPKCS005
00561        IF CA-JOB-INQ                                              DPKCS005
00562          AND CA-PLAN-INQ                                          DPKCS005
00563            PERFORM 3000-READ-JOB-PLAN-INQ                         DPKCS005
00564          ELSE                                                     DPKCS005
00565          IF CA-JOB-INQ                                            DPKCS005
00566              PERFORM 3001-READ-JOB-INQ                            DPKCS005
00567            ELSE                                                   DPKCS005
00568            IF CA-PLAN-INQ                                         DPKCS005
00569                PERFORM 3002-READ-PLAN-INQ                         DPKCS005
00570            END-IF                                                 DPKCS005
00571          END-IF                                                   DPKCS005
00572        END-IF                                                     DPKCS005
00573      END-IF.                                                      DPKCS005
00574                                                                   DPKCS005
00575      PERFORM 7000-UPDATE-SCREEN-HEADER.                           DPKCS005
00576                                                                   DPKCS005
00577      IF PS-NO-EDIT-ERROR                                          DPKCS005
00578          MOVE UNBRI-MDT TO AJOBNMEA                               DPKCS005
00579          MOVE UNBRI-MDT TO APLNNMEA                               DPKCS005
00580          MOVE GREEN TO AJOBNMEC                                   DPKCS005
00581          MOVE GREEN TO APLNNMEC                                   DPKCS005
00582          MOVE UNDERSCORE TO AJOBNMEH                              DPKCS005
00583          MOVE UNDERSCORE TO APLNNMEH                              DPKCS005
00584      END-IF.                                                      DPKCS005
00585                                                                   DPKCS005
00586      PERFORM 9500-SEND-AND-RETURN.                                DPKCS005
00587 *2000-EXIT.        EXIT.                                          DPKCS005
00588                                                                   DPKCS005
00589                                                                   DPKCS005
00590 ******************************************************************DPKCS005
00591 *  RECEIVE THE MAP.                                              *DPKCS005
00592 ******************************************************************DPKCS005
00593                                                                   DPKCS005
00594  2100-RECEIVE-SCREEN-FIELDS.                                      DPKCS005
00595      EXEC CICS                                                    DPKCS005
00596          HANDLE CONDITION                                         DPKCS005
00597              MAPFAIL(1000-INITIALIZE)                             DPKCS005
00598      END-EXEC.                                                    DPKCS005
00599                                                                   DPKCS005
00600      EXEC CICS                                                    DPKCS005
00601          RECEIVE                                                  DPKCS005
00602              MAP('DP005A')                                        DPKCS005
00603              MAPSET('DPKM005')                                    DPKCS005
00604      END-EXEC.                                                    DPKCS005
00605 *2100-EXIT.        EXIT.                                          DPKCS005
00606                                                                   DPKCS005
00607                                                                   DPKCS005
00608 ******************************************************************DPKCS005
00609 *  EDIT THE SCREEN FIELDS AND DETERMINE THE TYPE OF INQUIRY      *DPKCS005
00610 *  TO BE PERFORMED.                                              *DPKCS005
00611 ******************************************************************DPKCS005
00612                                                                   DPKCS005
00613  2110-SET-INQUIRY-SW.                                             DPKCS005
00614                                                                   DPKCS005
00615      SET CA-NO-JOB-INQ TO TRUE.                                   DPKCS005
00616      SET CA-NO-PLAN-INQ TO TRUE.                                  DPKCS005
00617                                                                   DPKCS005
00618      IF ((AJOBNMEA = PC-EOF-KEYED)                                DPKCS005
00619        OR (AJOBNMEI = SPACES OR LOW-VALUES))                      DPKCS005
00620          MOVE SPACES TO PW-JOB-NAME                               DPKCS005
00621      ELSE                                                         DPKCS005
00622          MOVE AJOBNMEI TO PW-JOB-NAME                             DPKCS005
00623          SET CA-JOB-INQ TO TRUE                                   DPKCS005
00624      END-IF.                                                      DPKCS005
00625                                                                   DPKCS005
00626      IF ((APLNNMEA = PC-EOF-KEYED)                                DPKCS005
00627        OR (APLNNMEI = SPACES OR LOW-VALUES))                      DPKCS005
00628          MOVE SPACES TO PW-PLAN-NAME                              DPKCS005
00629      ELSE                                                         DPKCS005
00630          MOVE APLNNMEI TO PW-PLAN-NAME                            DPKCS005
00631          SET CA-PLAN-INQ TO TRUE                                  DPKCS005
00632      END-IF.                                                      DPKCS005
00633                                                                   DPKCS005
00634      IF CA-NO-JOB-INQ                                             DPKCS005
00635        AND CA-NO-PLAN-INQ                                         DPKCS005
00636          SET PM-MESSAGE-INDEX TO 7                                DPKCS005
00637          SET PS-EDIT-ERROR TO TRUE                                DPKCS005
00638          MOVE UNBRI-MDT TO AJOBNMEA                               DPKCS005
00639                            APLNNMEA                               DPKCS005
00640          MOVE DFHREVRS TO AJOBNMEH                                DPKCS005
00641                           APLNNMEH                                DPKCS005
00642          MOVE DFHRED TO AJOBNMEC                                  DPKCS005
00643                         APLNNMEC                                  DPKCS005
00644          PERFORM 9500-SEND-AND-RETURN                             DPKCS005
00645      END-IF.                                                      DPKCS005
00646 *2110-EXIT.        EXIT.                                          DPKCS005
00647                                                                   DPKCS005
00648                                                                   DPKCS005
00649 ******************************************************************DPKCS005
00650 *  IF BROWSING JOB/PLAN SET UP THE HIGH RANGE INDICATOR, SO AS   *DPKCS005
00651 *  TO BE ABLE TO BROWSE USING A GENERIC KEY.                     *DPKCS005
00652 ******************************************************************DPKCS005
00653                                                                   DPKCS005
00654  2200-EDIT-JOB-PLAN.                                              DPKCS005
00655                                                                   DPKCS005
00656      INITIALIZE                                                   DPKCS005
00657              CA-SAVE-FIRST-JOB                                    DPKCS005
00658              CA-SAVE-FIRST-PLAN                                   DPKCS005
00659              CA-SAVE-JOB-HIGH-RANGE                               DPKCS005
00660              CA-SAVE-PLAN-HIGH-RANGE                              DPKCS005
00661              CA-SAVE-CURR-JOB                                     DPKCS005
00662              CA-SAVE-CURR-PLAN                                    DPKCS005
00663              CA-SAVE-NEXT-JOB                                     DPKCS005
00664              CA-SAVE-NEXT-PLAN.                                   DPKCS005
00665                                                                   DPKCS005
00666      PERFORM                                                      DPKCS005
00667              VARYING PW-JOB-INDEX                                 DPKCS005
00668              FROM 1 BY 1                                          DPKCS005
00669              UNTIL PW-JOB-INDEX > 8                               DPKCS005
00670          IF PW-JOB-NME (PW-JOB-INDEX) = SPACES                    DPKCS005
00671              CONTINUE                                             DPKCS005
00672          ELSE                                                     DPKCS005
00673              SET JOB-INDEX TO PW-JOB-INDEX                        DPKCS005
00674              SET JOB-HIGH-INDEX TO PW-JOB-INDEX                   DPKCS005
00675              MOVE PW-JOB-NME (PW-JOB-INDEX) TO                    DPKCS005
00676                          PW-JOB (JOB-INDEX)                       DPKCS005
00677                          PW-JOB-HIGH (JOB-HIGH-INDEX)             DPKCS005
00678          END-IF                                                   DPKCS005
00679      END-PERFORM.                                                 DPKCS005
00680      PERFORM                                                      DPKCS005
00681              VARYING PW-PLN-INDEX                                 DPKCS005
00682              FROM 1 BY 1                                          DPKCS005
00683              UNTIL PW-PLN-INDEX > 8                               DPKCS005
00684          IF PW-PLN-NME (PW-PLN-INDEX) = SPACES                    DPKCS005
00685              CONTINUE                                             DPKCS005
00686          ELSE                                                     DPKCS005
00687              SET PLAN-INDEX TO PW-PLN-INDEX                       DPKCS005
00688              SET PLAN-HIGH-INDEX TO PW-PLN-INDEX                  DPKCS005
00689              MOVE PW-PLN-NME (PW-PLN-INDEX) TO                    DPKCS005
00690                          PW-PLAN (PLAN-INDEX)                     DPKCS005
00691                          PW-PLAN-HIGH (PLAN-HIGH-INDEX)           DPKCS005
00692          END-IF                                                   DPKCS005
00693      END-PERFORM.                                                 DPKCS005
00694                                                                   DPKCS005
00695      IF CA-JOB-INQ                                                DPKCS005
00696        AND CA-PLAN-INQ                                            DPKCS005
00697          MOVE PW-JOB-NAME TO PW-JOB-RANGE                         DPKCS005
00698          MOVE PW-PLAN-NAME TO PW-PLAN-RANGE                       DPKCS005
00699      ELSE                                                         DPKCS005
00700          MOVE PW-JOB-RANGE TO CA-SAVE-FIRST-JOB                   DPKCS005
00701          MOVE PW-PLAN-RANGE TO CA-SAVE-FIRST-PLAN                 DPKCS005
00702          MOVE PW-JOB-HIGH-RANGE TO CA-SAVE-JOB-HIGH-RANGE         DPKCS005
00703          MOVE PW-PLAN-HIGH-RANGE TO CA-SAVE-PLAN-HIGH-RANGE       DPKCS005
00704      END-IF.                                                      DPKCS005
00705 *2200-EXIT.        EXIT.                                          DPKCS005
00706                                                                   DPKCS005
00707                                                                   DPKCS005
00708 ******************************************************************DPKCS005
00709 *  OPEN CURSOR FOR JOB AND PLAN INQUIRY, PERFORM THE FETCH, AND  *DPKCS005
00710 *  CLOSE THE CURSOR.                                             *DPKCS005
00711 ******************************************************************DPKCS005
00712                                                                   DPKCS005
00713  3000-READ-JOB-PLAN-INQ.                                          DPKCS005
00714                                                                   DPKCS005
00715      PERFORM VARYING PW-RETRY-COUNT FROM 1 BY 1                   DPKCS005
00716          UNTIL PW-RETRY-COUNT > PC-MAX-RETRY                      DPKCS005
00717                                                                   DPKCS005
00718          EXEC SQL                                                 DPKCS005
00719            OPEN INQCSR                                            DPKCS005
00720          END-EXEC                                                 DPKCS005
00721                                                                   DPKCS005
00722          EVALUATE TRUE                                            DPKCS005
00723              WHEN SQLCODE = -913                                  DPKCS005
00724              WHEN SQLCODE = -904                                  DPKCS005
00725                  CONTINUE                                         DPKCS005
00726              WHEN SQLCODE < 0                                     DPKCS005
00727                  SET PV-OPEN-JOB-PLAN-CURSOR TO TRUE              DPKCS005
00728                  PERFORM 9300-SQL-ERROR                           DPKCS005
00729              WHEN SQLWARN0 = 'W'                                  DPKCS005
00730              WHEN SQLCODE > 0                                     DPKCS005
00731                  SET PV-OPEN-JOB-PLAN-CURSOR TO TRUE              DPKCS005
00732                  PERFORM 9400-SQL-WARNING                         DPKCS005
00733              WHEN SQLCODE = 0                                     DPKCS005
00734                  MOVE PC-MORE-THAN-MAX-RETRY TO PW-RETRY-COUNT    DPKCS005
00735          END-EVALUATE                                             DPKCS005
00736                                                                   DPKCS005
00737      END-PERFORM.                                                 DPKCS005
00738                                                                   DPKCS005
00739      PERFORM 4000-FETCH-JOB-PLAN-TABLE.                           DPKCS005
00740                                                                   DPKCS005
00741      IF SQLCODE = 0                                               DPKCS005
00742          PERFORM 5000-SETUP-SCREEN                                DPKCS005
00743      ELSE                                                         DPKCS005
00744          IF SQLCODE = +100                                        DPKCS005
00745              MOVE UNBRI-MDT TO AJOBNMEA                           DPKCS005
00746                                APLNNMEA                           DPKCS005
00747              MOVE DFHREVRS TO AJOBNMEH                            DPKCS005
00748                               APLNNMEH                            DPKCS005
00749              MOVE DFHRED TO AJOBNMEC                              DPKCS005
00750                             APLNNMEC                              DPKCS005
00751              IF PS-NO-EDIT-ERROR                                  DPKCS005
00752                  SET PS-EDIT-ERROR TO TRUE                        DPKCS005
00753                  SET PM-MESSAGE-INDEX TO 3                        DPKCS005
00754              END-IF                                               DPKCS005
00755          END-IF                                                   DPKCS005
00756      END-IF.                                                      DPKCS005
00757                                                                   DPKCS005
00758      PERFORM VARYING PW-RETRY-COUNT FROM 1 BY 1                   DPKCS005
00759          UNTIL PW-RETRY-COUNT > PC-MAX-RETRY                      DPKCS005
00760                                                                   DPKCS005
00761          EXEC SQL                                                 DPKCS005
00762              CLOSE INQCSR                                         DPKCS005
00763          END-EXEC                                                 DPKCS005
00764                                                                   DPKCS005
00765          EVALUATE TRUE                                            DPKCS005
00766              WHEN SQLCODE = -913                                  DPKCS005
00767              WHEN SQLCODE = -904                                  DPKCS005
00768                  CONTINUE                                         DPKCS005
00769              WHEN SQLCODE < 0                                     DPKCS005
00770                  SET PV-CLOSE-JOB-PLAN-CURSOR TO TRUE             DPKCS005
00771                  PERFORM 9300-SQL-ERROR                           DPKCS005
00772              WHEN SQLWARN0 = 'W'                                  DPKCS005
00773              WHEN SQLCODE > 0                                     DPKCS005
00774                  SET PV-CLOSE-JOB-PLAN-CURSOR TO TRUE             DPKCS005
00775                  PERFORM 9400-SQL-WARNING                         DPKCS005
00776              WHEN SQLCODE = 0                                     DPKCS005
00777                  MOVE PC-MORE-THAN-MAX-RETRY TO PW-RETRY-COUNT    DPKCS005
00778          END-EVALUATE                                             DPKCS005
00779                                                                   DPKCS005
00780      END-PERFORM.                                                 DPKCS005
00781 *3000-EXIT.        EXIT.                                          DPKCS005
00782                                                                   DPKCS005
00783                                                                   DPKCS005
00784 ******************************************************************DPKCS005
00785 *  OPEN CURSOR FOR JOB INQUIRY, PERFORM THE FETCH AND THEN FETCH *DPKCS005
00786 *  AGAIN SO AS TO GET THE NEXT RECORD FOR BROWSING, CLOSE THE    *DPKCS005
00787 *  CURSOR.                                                       *DPKCS005
00788 ******************************************************************DPKCS005
00789                                                                   DPKCS005
00790  3001-READ-JOB-INQ.                                               DPKCS005
00791                                                                   DPKCS005
00792      PERFORM VARYING PW-RETRY-COUNT FROM 1 BY 1                   DPKCS005
00793          UNTIL PW-RETRY-COUNT > PC-MAX-RETRY                      DPKCS005
00794                                                                   DPKCS005
00795          EXEC SQL                                                 DPKCS005
00796              OPEN JOBCSR                                          DPKCS005
00797          END-EXEC                                                 DPKCS005
00798                                                                   DPKCS005
00799          EVALUATE TRUE                                            DPKCS005
00800              WHEN SQLCODE = -913                                  DPKCS005
00801              WHEN SQLCODE = -904                                  DPKCS005
00802                  CONTINUE                                         DPKCS005
00803              WHEN SQLCODE < 0                                     DPKCS005
00804                  SET PV-OPEN-JOB-CURSOR TO TRUE                   DPKCS005
00805                  PERFORM 9300-SQL-ERROR                           DPKCS005
00806              WHEN SQLWARN0 = 'W'                                  DPKCS005
00807              WHEN SQLCODE > 0                                     DPKCS005
00808                  SET PV-OPEN-JOB-CURSOR TO TRUE                   DPKCS005
00809                  PERFORM 9400-SQL-WARNING                         DPKCS005
00810              WHEN SQLCODE = 0                                     DPKCS005
00811                  MOVE PC-MORE-THAN-MAX-RETRY TO PW-RETRY-COUNT    DPKCS005
00812          END-EVALUATE                                             DPKCS005
00813                                                                   DPKCS005
00814      END-PERFORM.                                                 DPKCS005
00815                                                                   DPKCS005
00816      PERFORM 4001-FETCH-JOB-TABLE                                 DPKCS005
00817          UNTIL                                                    DPKCS005
00818               ((CA-SAVE-NEXT-PLAN = TCKRSTCNTL-PLAN-NAME)         DPKCS005
00819            OR (SQLCODE = +100)).                                  DPKCS005
00820                                                                   DPKCS005
00821      IF SQLCODE = 0                                               DPKCS005
00822          PERFORM 5000-SETUP-SCREEN                                DPKCS005
00823      ELSE                                                         DPKCS005
00824        IF SQLCODE = +100                                          DPKCS005
00825                MOVE UNBRI-MDT TO AJOBNMEA                         DPKCS005
00826                MOVE DFHREVRS TO AJOBNMEH                          DPKCS005
00827                MOVE DFHRED TO AJOBNMEC                            DPKCS005
00828             IF PS-NO-EDIT-ERROR                                   DPKCS005
00829                  SET PS-EDIT-ERROR TO TRUE                        DPKCS005
00830                  SET PM-MESSAGE-INDEX TO 3                        DPKCS005
00831             END-IF                                                DPKCS005
00832        END-IF                                                     DPKCS005
00833      END-IF.                                                      DPKCS005
00834                                                                   DPKCS005
00835      IF PS-NO-EDIT-ERROR                                          DPKCS005
00836          PERFORM 4001-FETCH-JOB-TABLE                             DPKCS005
00837            IF SQLCODE = 0                                         DPKCS005
00838                IF TCKRSTCNTL-JOB-NAME > CA-SAVE-JOB-HIGH-RANGE    DPKCS005
00839                    SET PM-MESSAGE-INDEX TO 4                      DPKCS005
00840                    MOVE DFHNEUTR TO AMSGC                         DPKCS005
00841                ELSE                                               DPKCS005
00842                    MOVE TCKRSTCNTL-JOB-NAME TO                    DPKCS005
00843                                    CA-SAVE-NEXT-JOB               DPKCS005
00844                    MOVE TCKRSTCNTL-PLAN-NAME TO                   DPKCS005
00845                                    CA-SAVE-NEXT-PLAN              DPKCS005
00846                    SET PM-MESSAGE-INDEX TO 8                      DPKCS005
00847                    MOVE DFHNEUTR TO AMSGC                         DPKCS005
00848                END-IF                                             DPKCS005
00849            ELSE                                                   DPKCS005
00850              IF SQLCODE = +100                                    DPKCS005
00851                  SET PM-MESSAGE-INDEX TO 4                        DPKCS005
00852                  MOVE DFHNEUTR TO AMSGC                           DPKCS005
00853              END-IF                                               DPKCS005
00854            END-IF                                                 DPKCS005
00855      END-IF.                                                      DPKCS005
00856                                                                   DPKCS005
00857      PERFORM VARYING PW-RETRY-COUNT FROM 1 BY 1                   DPKCS005
00858          UNTIL PW-RETRY-COUNT > PC-MAX-RETRY                      DPKCS005
00859                                                                   DPKCS005
00860          EXEC SQL                                                 DPKCS005
00861              CLOSE JOBCSR                                         DPKCS005
00862          END-EXEC                                                 DPKCS005
00863                                                                   DPKCS005
00864          EVALUATE TRUE                                            DPKCS005
00865              WHEN SQLCODE = -913                                  DPKCS005
00866              WHEN SQLCODE = -904                                  DPKCS005
00867                  CONTINUE                                         DPKCS005
00868              WHEN SQLCODE < 0                                     DPKCS005
00869                  SET PV-CLOSE-JOB-CURSOR TO TRUE                  DPKCS005
00870                  PERFORM 9300-SQL-ERROR                           DPKCS005
00871              WHEN SQLWARN0 = 'W'                                  DPKCS005
00872              WHEN SQLCODE > 0                                     DPKCS005
00873                  SET PV-CLOSE-JOB-CURSOR TO TRUE                  DPKCS005
00874                  PERFORM 9400-SQL-WARNING                         DPKCS005
00875              WHEN SQLCODE = 0                                     DPKCS005
00876                  MOVE PC-MORE-THAN-MAX-RETRY TO PW-RETRY-COUNT    DPKCS005
00877          END-EVALUATE                                             DPKCS005
00878                                                                   DPKCS005
00879      END-PERFORM.                                                 DPKCS005
00880 *3001-EXIT.        EXIT.                                          DPKCS005
00881                                                                   DPKCS005
00882                                                                   DPKCS005
00883 ******************************************************************DPKCS005
00884 *  OPEN CURSOR FOR PLAN INQUIRY, PERFORM THE FETCH AND THEN      *DPKCS005
00885 *  FETCH AGAIN SO AS TO GET THE NEXT RECORD FOR BROWSING, CLOSE  *DPKCS005
00886 *  THE CURSOR.                                                   *DPKCS005
00887 ******************************************************************DPKCS005
00888                                                                   DPKCS005
00889  3002-READ-PLAN-INQ.                                              DPKCS005
00890                                                                   DPKCS005
00891      PERFORM VARYING PW-RETRY-COUNT FROM 1 BY 1                   DPKCS005
00892          UNTIL PW-RETRY-COUNT > PC-MAX-RETRY                      DPKCS005
00893                                                                   DPKCS005
00894          EXEC SQL                                                 DPKCS005
00895              OPEN PLANCSR                                         DPKCS005
00896          END-EXEC                                                 DPKCS005
00897                                                                   DPKCS005
00898          EVALUATE TRUE                                            DPKCS005
00899              WHEN SQLCODE = -913                                  DPKCS005
00900              WHEN SQLCODE = -904                                  DPKCS005
00901                  CONTINUE                                         DPKCS005
00902              WHEN SQLCODE < 0                                     DPKCS005
00903                  SET PV-OPEN-PLAN-CURSOR TO TRUE                  DPKCS005
00904                  PERFORM 9300-SQL-ERROR                           DPKCS005
00905              WHEN SQLWARN0 = 'W'                                  DPKCS005
00906              WHEN SQLCODE > 0                                     DPKCS005
00907                  SET PV-OPEN-PLAN-CURSOR TO TRUE                  DPKCS005
00908                  PERFORM 9400-SQL-WARNING                         DPKCS005
00909              WHEN SQLCODE = 0                                     DPKCS005
00910                  MOVE PC-MORE-THAN-MAX-RETRY TO PW-RETRY-COUNT    DPKCS005
00911          END-EVALUATE                                             DPKCS005
00912                                                                   DPKCS005
00913      END-PERFORM.                                                 DPKCS005
00914                                                                   DPKCS005
00915      PERFORM 4002-FETCH-PLAN-TABLE                                DPKCS005
00916          UNTIL                                                    DPKCS005
00917              ((CA-SAVE-NEXT-JOB = TCKRSTCNTL-JOB-NAME)            DPKCS005
00918           OR (SQLCODE = +100)).                                   DPKCS005
00919                                                                   DPKCS005
00920      IF SQLCODE = 0                                               DPKCS005
00921              PERFORM 5000-SETUP-SCREEN                            DPKCS005
00922      ELSE                                                         DPKCS005
00923          IF SQLCODE = +100                                        DPKCS005
00924              MOVE UNBRI-MDT TO APLNNMEA                           DPKCS005
00925              MOVE DFHREVRS TO APLNNMEH                            DPKCS005
00926              MOVE DFHRED TO APLNNMEC                              DPKCS005
00927              MOVE -1 TO APLNNMEL                                  DPKCS005
00928              IF PS-NO-EDIT-ERROR                                  DPKCS005
00929                  SET PS-EDIT-ERROR TO TRUE                        DPKCS005
00930                  SET PM-MESSAGE-INDEX TO 3                        DPKCS005
00931              END-IF                                               DPKCS005
00932          END-IF                                                   DPKCS005
00933      END-IF.                                                      DPKCS005
00934                                                                   DPKCS005
00935      IF PS-NO-EDIT-ERROR                                          DPKCS005
00936          PERFORM 4002-FETCH-PLAN-TABLE                            DPKCS005
00937              IF SQLCODE = 0                                       DPKCS005
00938                  IF TCKRSTCNTL-PLAN-NAME > CA-SAVE-PLAN-HIGH-RANGEDPKCS005
00939                      SET PM-MESSAGE-INDEX TO 4                    DPKCS005
00940                      MOVE DFHNEUTR TO AMSGC                       DPKCS005
00941                  ELSE                                             DPKCS005
00942                      MOVE TCKRSTCNTL-JOB-NAME TO                  DPKCS005
00943                                      CA-SAVE-NEXT-JOB             DPKCS005
00944                      MOVE TCKRSTCNTL-PLAN-NAME TO                 DPKCS005
00945                                      CA-SAVE-NEXT-PLAN            DPKCS005
00946                      SET PM-MESSAGE-INDEX TO 8                    DPKCS005
00947                      MOVE DFHNEUTR TO AMSGC                       DPKCS005
00948                  END-IF                                           DPKCS005
00949              ELSE                                                 DPKCS005
00950                  IF SQLCODE = +100                                DPKCS005
00951                      SET PM-MESSAGE-INDEX TO 4                    DPKCS005
00952                      MOVE DFHNEUTR TO AMSGC                       DPKCS005
00953                  END-IF                                           DPKCS005
00954              END-IF                                               DPKCS005
00955      END-IF.                                                      DPKCS005
00956                                                                   DPKCS005
00957      PERFORM VARYING PW-RETRY-COUNT FROM 1 BY 1                   DPKCS005
00958          UNTIL PW-RETRY-COUNT > PC-MAX-RETRY                      DPKCS005
00959                                                                   DPKCS005
00960          EXEC SQL                                                 DPKCS005
00961              CLOSE PLANCSR                                        DPKCS005
00962          END-EXEC                                                 DPKCS005
00963                                                                   DPKCS005
00964          EVALUATE TRUE                                            DPKCS005
00965              WHEN SQLCODE = -913                                  DPKCS005
00966              WHEN SQLCODE = -904                                  DPKCS005
00967                  CONTINUE                                         DPKCS005
00968              WHEN SQLCODE < 0                                     DPKCS005
00969                  SET PV-CLOSE-PLAN-CURSOR TO TRUE                 DPKCS005
00970                  PERFORM 9300-SQL-ERROR                           DPKCS005
00971              WHEN SQLWARN0 = 'W'                                  DPKCS005
00972              WHEN SQLCODE > 0                                     DPKCS005
00973                  SET PV-CLOSE-PLAN-CURSOR TO TRUE                 DPKCS005
00974                  PERFORM 9400-SQL-WARNING                         DPKCS005
00975              WHEN SQLCODE = 0                                     DPKCS005
00976                  MOVE PC-MORE-THAN-MAX-RETRY TO PW-RETRY-COUNT    DPKCS005
00977          END-EVALUATE                                             DPKCS005
00978                                                                   DPKCS005
00979      END-PERFORM.                                                 DPKCS005
00980 *3002-EXIT.        EXIT.                                          DPKCS005
00981                                                                   DPKCS005
00982                                                                   DPKCS005
00983 ******************************************************************DPKCS005
00984 *  FETCH JOB PLAN ROW.                                           *DPKCS005
00985 ******************************************************************DPKCS005
00986                                                                   DPKCS005
00987  4000-FETCH-JOB-PLAN-TABLE.                                       DPKCS005
00988                                                                   DPKCS005
00989      PERFORM VARYING PW-RETRY-COUNT FROM 1 BY 1                   DPKCS005
00990          UNTIL PW-RETRY-COUNT > PC-MAX-RETRY                      DPKCS005
00991                                                                   DPKCS005
00992          EXEC SQL                                                 DPKCS005
00993            FETCH INQCSR                                           DPKCS005
00994             INTO :TCKRSTCNTL-JOB-NAME,                            DPKCS005
00995                  :TCKRSTCNTL-PLAN-NAME,                           DPKCS005
00996                  :TCKRSTCNTL-CKPT-STAT-CODE,                      DPKCS005
00997                  :TCKRSTCNTL-CKPT-CNTL-CODE,                      DPKCS005
00998                  :TCKRSTCNTL-CKPT-TYPE-CODE,                      DPKCS005
00999                  :TCKRSTCNTL-CKPT-FRQNCY-QTY,                     DPKCS005
01000                  :TCKRSTCNTL-TRANS-QTY,                           DPKCS005
01001                  :TCKRSTCNTL-PREP-TMESTP:PW-NULL-PREP-TMESTP,     DPKCS005
01002                  :TCKRSTCNTL-CKPT-TAKEN-QTY,                      DPKCS005
01003                  :TCKRSTCNTL-TRANS-PRCSD-QTY,                     DPKCS005
01004                  :TCKRSTCNTL-RST-QTY,                             DPKCS005
01005                  :TCKRSTCNTL-PRCSD-TMESTP:PW-NULL-PRCSD-TMESTP,   DPKCS005
01006                  :TCKRSTCNTL-CKPT-DURATION-TIME:PW-NULL-DUR-TIME  DPKCS005
01007          END-EXEC                                                 DPKCS005
01008                                                                   DPKCS005
01009          EVALUATE TRUE                                            DPKCS005
01010              WHEN SQLCODE = -913                                  DPKCS005
01011              WHEN SQLCODE = -904                                  DPKCS005
01012                  CONTINUE                                         DPKCS005
01013              WHEN SQLCODE < 0                                     DPKCS005
01014                  SET PV-FETCH-JOB-PLAN-TABLE TO TRUE              DPKCS005
01015                  PERFORM 9300-SQL-ERROR                           DPKCS005
01016              WHEN SQLCODE = 0                                     DPKCS005
01017              WHEN SQLCODE = +100                                  DPKCS005
01018                  MOVE PC-MORE-THAN-MAX-RETRY TO PW-RETRY-COUNT    DPKCS005
01019              WHEN SQLWARN0 = 'W'                                  DPKCS005
01020              WHEN SQLCODE > 0                                     DPKCS005
01021                  SET PV-FETCH-JOB-PLAN-TABLE TO TRUE              DPKCS005
01022                  PERFORM 9400-SQL-WARNING                         DPKCS005
01023          END-EVALUATE                                             DPKCS005
01024                                                                   DPKCS005
01025      END-PERFORM.                                                 DPKCS005
01026 *4000-EXIT.        EXIT.                                          DPKCS005
01027                                                                   DPKCS005
01028                                                                   DPKCS005
01029 ******************************************************************DPKCS005
01030 *  FETCH JOB ROW.                                                *DPKCS005
01031 ******************************************************************DPKCS005
01032                                                                   DPKCS005
01033  4001-FETCH-JOB-TABLE.                                            DPKCS005
01034                                                                   DPKCS005
01035      PERFORM VARYING PW-RETRY-COUNT FROM 1 BY 1                   DPKCS005
01036          UNTIL PW-RETRY-COUNT > PC-MAX-RETRY                      DPKCS005
01037                                                                   DPKCS005
01038          EXEC SQL                                                 DPKCS005
01039            FETCH JOBCSR                                           DPKCS005
01040             INTO :TCKRSTCNTL-JOB-NAME,                            DPKCS005
01041                  :TCKRSTCNTL-PLAN-NAME,                           DPKCS005
01042                  :TCKRSTCNTL-CKPT-STAT-CODE,                      DPKCS005
01043                  :TCKRSTCNTL-CKPT-CNTL-CODE,                      DPKCS005
01044                  :TCKRSTCNTL-CKPT-TYPE-CODE,                      DPKCS005
01045                  :TCKRSTCNTL-CKPT-FRQNCY-QTY,                     DPKCS005
01046                  :TCKRSTCNTL-TRANS-QTY,                           DPKCS005
01047                  :TCKRSTCNTL-PREP-TMESTP:PW-NULL-PREP-TMESTP,     DPKCS005
01048                  :TCKRSTCNTL-CKPT-TAKEN-QTY,                      DPKCS005
01049                  :TCKRSTCNTL-TRANS-PRCSD-QTY,                     DPKCS005
01050                  :TCKRSTCNTL-RST-QTY,                             DPKCS005
01051                  :TCKRSTCNTL-PRCSD-TMESTP:PW-NULL-PRCSD-TMESTP,   DPKCS005
01052                  :TCKRSTCNTL-CKPT-DURATION-TIME:PW-NULL-DUR-TIME  DPKCS005
01053          END-EXEC                                                 DPKCS005
01054                                                                   DPKCS005
01055          EVALUATE TRUE                                            DPKCS005
01056              WHEN SQLCODE = +100                                  DPKCS005
01057                  MOVE PC-MORE-THAN-MAX-RETRY TO PW-RETRY-COUNT    DPKCS005
01058              WHEN SQLCODE = -913                                  DPKCS005
01059              WHEN SQLCODE = -904                                  DPKCS005
01060                  CONTINUE                                         DPKCS005
01061              WHEN SQLCODE < 0                                     DPKCS005
01062                  SET PV-FETCH-JOB-TABLE TO TRUE                   DPKCS005
01063                  PERFORM 9300-SQL-ERROR                           DPKCS005
01064              WHEN SQLWARN0 = 'W'                                  DPKCS005
01065              WHEN SQLCODE > 0                                     DPKCS005
01066                  SET PV-FETCH-JOB-TABLE TO TRUE                   DPKCS005
01067                  PERFORM 9400-SQL-WARNING                         DPKCS005
01068              WHEN SQLCODE = 0                                     DPKCS005
01069                  MOVE PC-MORE-THAN-MAX-RETRY TO PW-RETRY-COUNT    DPKCS005
01070          END-EVALUATE                                             DPKCS005
01071                                                                   DPKCS005
01072      END-PERFORM.                                                 DPKCS005
01073                                                                   DPKCS005
01074      IF CA-SAVE-NEXT-PLAN = SPACES OR LOW-VALUES                  DPKCS005
01075          MOVE TCKRSTCNTL-PLAN-NAME TO CA-SAVE-NEXT-PLAN           DPKCS005
01076                                       CA-SAVE-FIRST-PLAN          DPKCS005
01077      END-IF.                                                      DPKCS005
01078 *4001-EXIT.        EXIT.                                          DPKCS005
01079                                                                   DPKCS005
01080                                                                   DPKCS005
01081 ******************************************************************DPKCS005
01082 *  FETCH PLAN ROW.                                               *DPKCS005
01083 ******************************************************************DPKCS005
01084                                                                   DPKCS005
01085  4002-FETCH-PLAN-TABLE.                                           DPKCS005
01086                                                                   DPKCS005
01087      PERFORM VARYING PW-RETRY-COUNT FROM 1 BY 1                   DPKCS005
01088          UNTIL PW-RETRY-COUNT > PC-MAX-RETRY                      DPKCS005
01089                                                                   DPKCS005
01090          EXEC SQL                                                 DPKCS005
01091            FETCH PLANCSR                                          DPKCS005
01092             INTO :TCKRSTCNTL-JOB-NAME,                            DPKCS005
01093                  :TCKRSTCNTL-PLAN-NAME,                           DPKCS005
01094                  :TCKRSTCNTL-CKPT-STAT-CODE,                      DPKCS005
01095                  :TCKRSTCNTL-CKPT-CNTL-CODE,                      DPKCS005
01096                  :TCKRSTCNTL-CKPT-TYPE-CODE,                      DPKCS005
01097                  :TCKRSTCNTL-CKPT-FRQNCY-QTY,                     DPKCS005
01098                  :TCKRSTCNTL-TRANS-QTY,                           DPKCS005
01099                  :TCKRSTCNTL-PREP-TMESTP:PW-NULL-PREP-TMESTP,     DPKCS005
01100                  :TCKRSTCNTL-CKPT-TAKEN-QTY,                      DPKCS005
01101                  :TCKRSTCNTL-TRANS-PRCSD-QTY,                     DPKCS005
01102                  :TCKRSTCNTL-RST-QTY,                             DPKCS005
01103                  :TCKRSTCNTL-PRCSD-TMESTP:PW-NULL-PRCSD-TMESTP,   DPKCS005
01104                  :TCKRSTCNTL-CKPT-DURATION-TIME:PW-NULL-DUR-TIME  DPKCS005
01105          END-EXEC                                                 DPKCS005
01106                                                                   DPKCS005
01107          EVALUATE TRUE                                            DPKCS005
01108              WHEN SQLCODE = +100                                  DPKCS005
01109                  MOVE PC-MORE-THAN-MAX-RETRY TO PW-RETRY-COUNT    DPKCS005
01110              WHEN SQLCODE = -913                                  DPKCS005
01111              WHEN SQLCODE = -904                                  DPKCS005
01112                  CONTINUE                                         DPKCS005
01113              WHEN SQLCODE < 0                                     DPKCS005
01114                  SET PV-FETCH-PLAN-TABLE TO TRUE                  DPKCS005
01115                  PERFORM 9300-SQL-ERROR                           DPKCS005
01116              WHEN SQLWARN0 = 'W'                                  DPKCS005
01117              WHEN SQLCODE > 0                                     DPKCS005
01118                  SET PV-FETCH-PLAN-TABLE TO TRUE                  DPKCS005
01119                  PERFORM 9400-SQL-WARNING                         DPKCS005
01120              WHEN SQLCODE = 0                                     DPKCS005
01121                  MOVE PC-MORE-THAN-MAX-RETRY TO PW-RETRY-COUNT    DPKCS005
01122          END-EVALUATE                                             DPKCS005
01123                                                                   DPKCS005
01124      END-PERFORM.                                                 DPKCS005
01125                                                                   DPKCS005
01126      IF CA-SAVE-NEXT-JOB = SPACES OR LOW-VALUES                   DPKCS005
01127          MOVE TCKRSTCNTL-JOB-NAME TO CA-SAVE-NEXT-JOB             DPKCS005
01128                                      CA-SAVE-FIRST-JOB            DPKCS005
01129      END-IF.                                                      DPKCS005
01130 *4002-EXIT.        EXIT.                                          DPKCS005
01131                                                                   DPKCS005
01132                                                                   DPKCS005
01133 ******************************************************************DPKCS005
01134 *  SET-UP THE SCREEN.                                            *DPKCS005
01135 ******************************************************************DPKCS005
01136                                                                   DPKCS005
01137  5000-SETUP-SCREEN.                                               DPKCS005
01138                                                                   DPKCS005
01139      MOVE TCKRSTCNTL-JOB-NAME TO AJOBNMEO                         DPKCS005
01140                                  CA-SAVE-CURR-JOB.                DPKCS005
01141      MOVE TCKRSTCNTL-PLAN-NAME TO APLNNMEO                        DPKCS005
01142                                   CA-SAVE-CURR-PLAN.              DPKCS005
01143                                                                   DPKCS005
01144      MOVE TCKRSTCNTL-CKPT-STAT-CODE TO ASTATUSO                   DPKCS005
01145          EVALUATE TRUE                                            DPKCS005
01146              WHEN TCKRSTCNTL-CKPT-STAT-CODE =                     DPKCS005
01147                                      PC-STATUS-CODE-0             DPKCS005
01148                  MOVE 'CHECKPOINT CONTROL RECORD NOT IN USE'      DPKCS005
01149                              TO ASTDESCO                          DPKCS005
01150              WHEN TCKRSTCNTL-CKPT-STAT-CODE =                        CL**2
01151                                      PC-STATUS-CODE-1             DPKCS005
01152                  MOVE 'TRANSACTION PREPARATION PROCESS STARTED'   DPKCS005
01153                              TO ASTDESCO                          DPKCS005
01154              WHEN TCKRSTCNTL-CKPT-STAT-CODE =                     DPKCS005
01155                                      PC-STATUS-CODE-2             DPKCS005
01156                  MOVE 'TRANSACTION PREPARATION PROCESS COMPLETED' DPKCS005
01157                              TO ASTDESCO                          DPKCS005
01158              WHEN TCKRSTCNTL-CKPT-STAT-CODE =                     DPKCS005
01159                                      PC-STATUS-CODE-3             DPKCS005
01160                  MOVE 'UPDATE PROCESSING STARTED'                 DPKCS005
01161                              TO ASTDESCO                          DPKCS005
01162              WHEN TCKRSTCNTL-CKPT-STAT-CODE =                     DPKCS005
01163                                      PC-STATUS-CODE-4             DPKCS005
01164                  MOVE 'UPDATE PROCESSING COMPLETE'                DPKCS005
01165                              TO ASTDESCO                          DPKCS005
01166              WHEN TCKRSTCNTL-CKPT-STAT-CODE =                     DPKCS005
01167                                      PC-STATUS-CODE-9             DPKCS005
01168                  MOVE 'CHECKPOINT CONTROLS BEING UPDATED'         DPKCS005
01169                              TO ASTDESCO                          DPKCS005
01170          END-EVALUATE.                                            DPKCS005
01171                                                                   DPKCS005
01172      MOVE TCKRSTCNTL-CKPT-CNTL-CODE TO ACNTRLO                    DPKCS005
01173          EVALUATE TRUE                                            DPKCS005
01174              WHEN TCKRSTCNTL-CKPT-CNTL-CODE =                     DPKCS005
01175                                      PC-CONTROL-CODE-A            DPKCS005
01176                  MOVE 'CHECKPOINTS TAKEN AUTOMATICALLY'           DPKCS005
01177                              TO ACTLDSCO                          DPKCS005
01178              WHEN TCKRSTCNTL-CKPT-CNTL-CODE =                     DPKCS005
01179                                      PC-CONTROL-CODE-R            DPKCS005
01180                  MOVE 'CHECKPOINTS REQUESTED BY UPDATE PROGRAM'   DPKCS005
01181                              TO ACTLDSCO                          DPKCS005
01182          END-EVALUATE.                                            DPKCS005
01183                                                                   DPKCS005
01184      MOVE TCKRSTCNTL-CKPT-TYPE-CODE TO ATYPEO                     DPKCS005
01185          EVALUATE TRUE                                            DPKCS005
01186              WHEN TCKRSTCNTL-CKPT-TYPE-CODE =                     DPKCS005
01187                                      PC-TYPE-CODE-C               DPKCS005
01188                  MOVE 'CONTROL BREAK' TO ATPEDSCO                 DPKCS005
01189              WHEN TCKRSTCNTL-CKPT-TYPE-CODE =                     DPKCS005
01190                                      PC-TYPE-CODE-L               DPKCS005
01191                  MOVE 'LOGICAL TRANSACTION' TO ATPEDSCO           DPKCS005
01192              WHEN TCKRSTCNTL-CKPT-TYPE-CODE =                     DPKCS005
01193                                      PC-TYPE-CODE-T               DPKCS005
01194                  MOVE 'TIME INTERVAL (SECONDS)' TO ATPEDSCO       DPKCS005
01195          END-EVALUATE.                                            DPKCS005
01196                                                                   DPKCS005
01197      MOVE TCKRSTCNTL-CKPT-FRQNCY-QTY TO AFREQO.                   DPKCS005
01198      MOVE TCKRSTCNTL-TRANS-QTY TO ANBRTRNO.                       DPKCS005
01199                                                                   DPKCS005
01200      IF PW-NULL-PREP-TMESTP LESS THAN 0                           DPKCS005
01201          CONTINUE                                                 DPKCS005
01202      ELSE                                                         DPKCS005
01203          MOVE TCKRSTCNTL-PREP-TMESTP TO PW-TIMESTAMP-BREAKDOWN    DPKCS005
01204          MOVE PW-TMESTP-DTE TO ADTEPRPO                           DPKCS005
01205          MOVE PW-TMESTP-TME TO ATMEPRPO                           DPKCS005
01206      END-IF.                                                      DPKCS005
01207                                                                   DPKCS005
01208      MOVE TCKRSTCNTL-CKPT-TAKEN-QTY TO ACHKPTSO.                  DPKCS005
01209      MOVE TCKRSTCNTL-TRANS-PRCSD-QTY TO ATRNSPRO.                 DPKCS005
01210      MOVE TCKRSTCNTL-RST-QTY TO ARSTCNTO.                         DPKCS005
01211                                                                   DPKCS005
01212      IF PW-NULL-PRCSD-TMESTP LESS THAN 0                          DPKCS005
01213          CONTINUE                                                 DPKCS005
01214      ELSE                                                         DPKCS005
01215          MOVE TCKRSTCNTL-PRCSD-TMESTP TO PW-TIMESTAMP-BREAKDOWN   DPKCS005
01216          MOVE PW-TMESTP-DTE TO ADTEPROO                           DPKCS005
01217          MOVE PW-TMESTP-TME TO ATMEPROO                           DPKCS005
01218      END-IF.                                                      DPKCS005
01219                                                                   DPKCS005
01220      IF PW-NULL-DUR-TIME LESS THAN 0                              DPKCS005
01221          CONTINUE                                                 DPKCS005
01222      ELSE                                                         DPKCS005
01223          MOVE TCKRSTCNTL-CKPT-DURATION-TIME TO PW-TIME-BREAKDOWN  DPKCS005
01224          MOVE PW-TIME TO ACHKDURO                                 DPKCS005
01225      END-IF.                                                      DPKCS005
01226 *5000-EXIT.        EXIT.                                          DPKCS005
01227                                                                   DPKCS005
01228                                                                   DPKCS005
01229 ******************************************************************DPKCS005
01230 *  FILL IN THE SCREEN HEADER WITH THE DATE, TIME, AND TERMINAL   *DPKCS005
01231 *  NUMBER.                                                       *DPKCS005
01232 ******************************************************************DPKCS005
01233                                                                   DPKCS005
01234  7000-UPDATE-SCREEN-HEADER.                                       DPKCS005
01235                                                                   DPKCS005
01236      EXEC CICS                                                    DPKCS005
01237          ASKTIME                                                  DPKCS005
01238              ABSTIME(ST-ABSTIME)                                  DPKCS005
01239      END-EXEC.                                                    DPKCS005
01240                                                                   DPKCS005
01241      EXEC CICS                                                    DPKCS005
01242          FORMATTIME                                               DPKCS005
01243              ABSTIME(ST-ABSTIME)                                  DPKCS005
01244              MMDDYY(ADATEO)                                       DPKCS005
01245              DATESEP                                              DPKCS005
01246              TIME(ST-TIME-EDIT)                                   DPKCS005
01247              TIMESEP                                              DPKCS005
01248      END-EXEC.                                                    DPKCS005
01249                                                                   DPKCS005
01250      MOVE ST-TIME-HHMM TO ATIMEO.                                 DPKCS005
01251      MOVE EIBTRMID TO ATERMO.                                     DPKCS005
01252 *7000-EXIT.        EXIT.                                          DPKCS005
01253                                                                   DPKCS005
01254                                                                   DPKCS005
01255 ******************************************************************DPKCS005
01256 *  INITIALIZE SCREEN DATA FIELDS.                                *DPKCS005
01257 ******************************************************************DPKCS005
01258                                                                   DPKCS005
01259  8000-INITIALIZE-SCREEN.                                          DPKCS005
01260                                                                   DPKCS005
01261      INITIALIZE                                                   DPKCS005
01262              ASTATUSO      ASTDESCO      ACNTRLO      ACTLDSCO    DPKCS005
01263              ATYPEO        ATPEDSCO      AFREQO       ANBRTRNO    DPKCS005
01264              ACHKPTSO      ADTEPRPO      ATRNSPRO     ATMEPRPO    DPKCS005
01265              ARSTCNTO      ADTEPROO      ATMEPROO     AMSGO       DPKCS005
01266              ACHKDURO.                                            DPKCS005
01267 *8000-EXIT.        EXIT.                                          DPKCS005
01268                                                                   DPKCS005
01269                                                                   DPKCS005
01270 ******************************************************************DPKCS005
01271 *  RETURN TO MAIN MENU.                                          *DPKCS005
01272 ******************************************************************DPKCS005
01273                                                                   DPKCS005
01274  9000-RETURN-MAIN-MENU.                                           DPKCS005
01275                                                                   DPKCS005
01276      EXEC CICS                                                    DPKCS005
01277          XCTL                                                     DPKCS005
01278              PROGRAM(PC-MAIN-MENU)                                DPKCS005
01279      END-EXEC.                                                    DPKCS005
01280 *9000-EXIT.        EXIT.                                          DPKCS005
01281                                                                   DPKCS005
01282                                                                   DPKCS005
01283 ******************************************************************DPKCS005
01284 *  LINK TO 'CICSAUTH' TO CHECK FOR ACCESS AUTHORITY OF USER,     *DPKCS005
01285 *  BEFORE XCTL TO MAINTENANCE PROGRAM.                           *DPKCS005
01286 ******************************************************************DPKCS005
01287                                                                   DPKCS005
01288  9200-TRANS-TO-MAINTENANCE.                                       DPKCS005
01289                                                                   DPKCS005
01290      PERFORM 2100-RECEIVE-SCREEN-FIELDS.                          DPKCS005
01291                                                                   DPKCS005
01292      EXEC CICS                                                    DPKCS005
01293          SYNCPOINT                                                DPKCS005
01294      END-EXEC.                                                    DPKCS005
01295                                                                   DPKCS005
01296      SET DP008-RSRC-TYPE-TRAN  TO  TRUE.                          DPKCS005
01297      SET DP008-ACCESS-TYPE-READ                                   DPKCS005
01298                                TO  TRUE.                          DPKCS005
01299      MOVE 'Z004'               TO  DP008-RESOURCE-NAME.           DPKCS005
01300                                                                   DPKCS005
01301      EXEC CICS                                                    DPKCS005
01302           LINK PROGRAM  (DP008-SECURITY-SUBROUTINE)               DPKCS005
01303                COMMAREA (DP008-SECURITY-COMMAREA)                 DPKCS005
01304                LENGTH   (DP008-SECURITY-COMMAREA-LENGTH)          DPKCS005
01305                RESP     (PV-CICS-RESPONSE)                        DPKCS005
01306      END-EXEC.                                                    DPKCS005
01307                                                                   DPKCS005
01308      IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   DPKCS005
01309          IF  DP008-CALL-SUCCESSFUL                                DPKCS005
01310              IF  DP008-ACCESS-ALLOWED                             DPKCS005
01311                  CONTINUE                                         DPKCS005
01312              ELSE                                                 DPKCS005
01313                  SET PM-MESSAGE-INDEX TO 5                        DPKCS005
01314                  PERFORM 9500-SEND-AND-RETURN                     DPKCS005
01315              END-IF                                               DPKCS005
01316          ELSE                                                     DPKCS005
01317              SET PM-MESSAGE-INDEX TO 1                            DPKCS005
01318              MOVE DP008-ERROR-CODE TO                             DPKCS005
01319                   PM-CM-RETURN-CODE                               DPKCS005
01320              MOVE PM-CICSAUTH-MESSAGE TO                          DPKCS005
01321                   PM-PROGRAM-MESSAGE (1)                          DPKCS005
01322              PERFORM 9500-SEND-AND-RETURN                         DPKCS005
01323          END-IF                                                   DPKCS005
01324      ELSE                                                         DPKCS005
01325          SET PM-MESSAGE-INDEX TO 6                                DPKCS005
01326          PERFORM 9500-SEND-AND-RETURN                             DPKCS005
01327      END-IF.                                                      DPKCS005
01328                                                                   DPKCS005
01329      MOVE 'DPKCS004' TO PT-TRANSFER-PROGRAM.                      DPKCS005
01330      MOVE PC-TRANS-DPKCS004-LENGTH TO PT-TRANSFER-LENGTH.         DPKCS005
01331                                                                   DPKCS005
01332      SET CA-INITIALIZE-SCREEN TO TRUE.                            DPKCS005
01333      MOVE 'DPKCS005' TO CA-LAST-PROGRAM.                          DPKCS005
01334      MOVE AJOBNMEI TO CA-SAVE-CURR-JOB.                           DPKCS005
01335      MOVE APLNNMEI TO CA-SAVE-CURR-PLAN.                          DPKCS005
01336                                                                   DPKCS005
01337      EXEC CICS                                                    DPKCS005
01338          XCTL                                                     DPKCS005
01339              PROGRAM(PT-TRANSFER-PROGRAM)                         DPKCS005
01340              COMMAREA(CA-COMMON-AREA)                             DPKCS005
01341              LENGTH(PT-TRANSFER-LENGTH)                           DPKCS005
01342      END-EXEC.                                                    DPKCS005
01343 *9200-EXIT.        EXIT.                                          DPKCS005
01344                                                                   DPKCS005
01345                                                                   DPKCS005
01346 ******************************************************************DPKCS005
01347 *    DB2 SQL WARNING AND SQL ERROR PARAGRAPHS                     DPKCS005
01348 ******************************************************************DPKCS005
01349  9300-SQL-ERROR.                                                  DPKCS005
01350                                                                   DPKCS005
01351 **********                                                        DPKCS005
01352 *    -911 IS NOT EVALUATED BECAUSE IT IS NOT POSSIBLE.  IT IS     DPKCS005
01353 *         EITHER A -913 OR -911 DEPENDING ON HOW DB2 WAS          DPKCS005
01354 *         INITIALLY INSTALLED.  AT KOHLS -911 DOES NOT APPLY      DPKCS005
01355 *         TO CICS PROGRAMS.                                       DPKCS005
01356 *********                                                         DPKCS005
01357                                                                   DPKCS005
01358      EVALUATE SQLCODE                                             DPKCS005
01359                                                                   DPKCS005
01360          WHEN -904                                                DPKCS005
01361               MOVE DM-RESOURCE-UNAVAIL-MSG TO DM-ERROR-MSG        DPKCS005
01362          WHEN -913                                                DPKCS005
01363               MOVE DM-DEADLOCK-TIMEOUT-MSG TO DM-ERROR-MSG        DPKCS005
01364          WHEN -922                                                DPKCS005
01365               MOVE DM-NOT-AUTHORIZED-MSG  TO DM-ERROR-MSG         DPKCS005
01366          WHEN -923                                                DPKCS005
01367               MOVE DM-NOT-CONNECTED-MSG TO DM-ERROR-MSG           DPKCS005
01368          WHEN ANY                                                 DPKCS005
01369               MOVE DM-OTHER-DB2-ERROR-MSG  TO DM-ERROR-MSG        DPKCS005
01370      END-EVALUATE.                                                DPKCS005
01371                                                                   DPKCS005
01372      MOVE SQLCODE TO DM-SQLCODE.                                  DPKCS005
01373      MOVE SQLERRD(3) TO DM-ROWS-ERR-PROCESSED.                    DPKCS005
01374      MOVE SQLERRML   TO DM-SQLERRML.                              DPKCS005
01375      MOVE SQLERRMC   TO DM-SQLERRMC.                              DPKCS005
01376                                                                   DPKCS005
01377      EXEC CICS                                                    DPKCS005
01378          SYNCPOINT                                                DPKCS005
01379      END-EXEC                                                     DPKCS005
01380                                                                   DPKCS005
01381      EXEC CICS                                                    DPKCS005
01382          SEND                                                     DPKCS005
01383          FROM(DM-DB2-ERROR-MSG)                                   DPKCS005
01384          LENGTH(PC-DB2-ERROR-LENGTH)                              DPKCS005
01385          ERASE                                                    DPKCS005
01386      END-EXEC.                                                    DPKCS005
01387                                                                   DPKCS005
01388      EXEC CICS                                                    DPKCS005
01389          RETURN                                                   DPKCS005
01390      END-EXEC.                                                    DPKCS005
01391                                                                   DPKCS005
01392 ******************************************************************DPKCS005
01393 *  EXIT THE CHECK AUTH SYSTEM, DISPLAYING A FORMATTED DB2        *DPKCS005
01394 *  WARNING MESSAGE.                                              *DPKCS005
01395 ******************************************************************DPKCS005
01396                                                                   DPKCS005
01397  9400-SQL-WARNING.                                                DPKCS005
01398                                                                   DPKCS005
01399      MOVE SQLCODE TO DM-SQLCODE1.                                 DPKCS005
01400      MOVE SQLWARN TO DM-SQLWARN.                                  DPKCS005
01401      MOVE SQLERRD(3) TO DM-ROWS-WRN-PROCESSED.                    DPKCS005
01402                                                                   DPKCS005
01403      EXEC CICS                                                    DPKCS005
01404          SYNCPOINT                                                DPKCS005
01405      END-EXEC.                                                    DPKCS005
01406                                                                   DPKCS005
01407      EXEC CICS                                                    DPKCS005
01408          SEND                                                     DPKCS005
01409          FROM(DM-DB2-WARNING-MSG)                                 DPKCS005
01410          LENGTH(PC-DB2-WARNING-LENGTH)                            DPKCS005
01411          ERASE                                                    DPKCS005
01412      END-EXEC.                                                    DPKCS005
01413                                                                   DPKCS005
01414      EXEC CICS                                                    DPKCS005
01415          RETURN                                                   DPKCS005
01416      END-EXEC.                                                    DPKCS005
01417                                                                   DPKCS005
01418                                                                   DPKCS005
01419 ******************************************************************DPKCS005
01420 *  SEND MAP AND RETURN TO PROGRAM                                *DPKCS005
01421 ******************************************************************DPKCS005
01422                                                                   DPKCS005
01423  9500-SEND-AND-RETURN.                                            DPKCS005
01424                                                                   DPKCS005
01425      IF APLNNMEL NOT = -1                                         DPKCS005
01426          MOVE -1 TO AJOBNMEL                                      DPKCS005
01427      END-IF.                                                      DPKCS005
01428      MOVE PM-PROGRAM-MESSAGE (PM-MESSAGE-INDEX) TO AMSGO.         DPKCS005
01429                                                                   DPKCS005
01430      EXEC CICS                                                    DPKCS005
01431          SEND                                                     DPKCS005
01432              MAP('DP005A')                                        DPKCS005
01433              MAPSET('DPKM005')                                    DPKCS005
01434              ERASE                                                DPKCS005
01435              CURSOR                                               DPKCS005
01436              FORMFEED                                             DPKCS005
01437      END-EXEC.                                                    DPKCS005
01438                                                                   DPKCS005
01439      EXEC CICS                                                    DPKCS005
01440          RETURN                                                   DPKCS005
01441              TRANSID('Z005')                                      DPKCS005
01442              COMMAREA(CA-COMMON-AREA)                             DPKCS005
01443              LENGTH(PC-COMMON-AREA-LENGTH)                        DPKCS005
01444      END-EXEC.                                                    DPKCS005
01445 *9500-EXIT.        EXIT.                                          DPKCS005
01446                                                                   DPKCS005
01447                                                                   DPKCS005
01448 ******************************************************************DPKCS005
01449 *  THIS SEND AND RETURN IS USED FOR PF ERRORS. SCREEN WILL       *DPKCS005
01450 *  SEND MAP ALONG WITH PREVIOUS DATA AND RETURN TO PROGRAM.      *DPKCS005
01451 ******************************************************************DPKCS005
01452                                                                   DPKCS005
01453  9600-SEND-AND-RETURN.                                            DPKCS005
01454                                                                   DPKCS005
01455      IF APLNNMEL NOT = -1                                         DPKCS005
01456          MOVE -1 TO AJOBNMEL                                      DPKCS005
01457      END-IF.                                                      DPKCS005
01458      MOVE PM-PROGRAM-MESSAGE (PM-MESSAGE-INDEX) TO AMSGO.         DPKCS005
01459                                                                   DPKCS005
01460      EXEC CICS                                                    DPKCS005
01461          SEND                                                     DPKCS005
01462              MAP('DP005A')                                        DPKCS005
01463              MAPSET('DPKM005')                                    DPKCS005
01464              CURSOR                                               DPKCS005
01465              FORMFEED                                             DPKCS005
01466      END-EXEC.                                                    DPKCS005
01467                                                                   DPKCS005
01468      EXEC CICS                                                    DPKCS005
01469          RETURN                                                   DPKCS005
01470              TRANSID('Z005')                                      DPKCS005
01471              COMMAREA(CA-COMMON-AREA)                             DPKCS005
01472              LENGTH(PC-COMMON-AREA-LENGTH)                        DPKCS005
01473      END-EXEC.                                                    DPKCS005
01474 *9600-EXIT.        EXIT.                                          DPKCS005
01475                                                                   DPKCS005
01476                                                                   DPKCS005
