000100 IDENTIFICATION DIVISION.                                         00010010
000200 PROGRAM-ID.     DSKUT009.                                        00020011
000300 AUTHOR.         RICHARD MOORE.                                   00030011
000400 DATE-WRITTEN.   12/30/98.                                        00040011
000500 DATE-COMPILED.                                                   00050011
000600*************************************************************     00060011
000700*    COBOL II WITH DB2                                      *     00070011
000800*                                                           *     00080011
000900*    DELETE GROUP 3 DATA                                    *     00090011
001000*                                                           *     00100011
001100*************************************************************     00110011
001200* CHANGE LOG:                                               *     00120011
001300*                                                           *     00130011
001400* 08/10/2022  JEAN KURK                  CHG0272895         *     00140015
001400*             REMOVE TABLES TIMBKVS, TIMKBUP, TAUBKVS,      *     00141015
001400*             TAUBKUP, TIMRCVS, TIMRCUP, TAURCUP, TAURCVS   *     00142015
004510* 04/10/2022  JEAN KURK                  CHG0286696         *     00143016
001400*             RECOMPILE FOR UPDATED COPYBOOKS               *     00144016
001500*************************************************************     00150011
001600                                                                  00160011
001700 ENVIRONMENT DIVISION.                                            00170011
001800                                                                  00180011
001900 INPUT-OUTPUT SECTION.                                            00190011
002000                                                                  00200011
002100 FILE-CONTROL.                                                    00210011
002200                                                                  00220011
002300     SELECT PO-NBR-FILE                                           00230011
002400         ASSIGN         TO UT-S-PO01.                             00240011
002500     SELECT TBLE-FILE                                             00250011
002600         ASSIGN         TO UT-S-TBL01.                            00260011
002700     SELECT CONTROL-FILE                                          00270011
002800         ASSIGN         TO UT-S-CTL01.                            00280011
002900                                                                  00290011
003000 DATA DIVISION.                                                   00300011
003010                                                                  00301011
003011 FILE SECTION.                                                    00301111
003012******************************************************************00301211
003013     COPY DSFD001.                                                00301311
003014                                                                  00301411
003015 WORKING-STORAGE SECTION.                                         00301511
003016                                                                  00301611
003017 01  PC-CONSTANTS.                                                00301711
003018     05  PC-90                       PIC S9(04)    COMP           00301811
003019                                                   VALUE 90.      00301911
003020     05  PC-A                        PIC  X(01)    VALUE 'A'.     00302011
003021     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     00302111
003022     05  PC-RCV                      PIC  X(03)    VALUE 'RCV'.   00302211
003023     05  PC-KHL                      PIC  X(03)    VALUE 'KHL'.   00302311
003024     05  PC-PRDCHK                   PIC  X(06)    VALUE 'PRDCHK'.00302411
003026     05  PC-PARM-TEXT                PIC  X(25)    VALUE          00302611
003027         'LOWER LEVEL ONLY         '.                             00302711
003028     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00302811
003029         'DSKUT009'.                                              00302911
003030                                                                  00303011
003031 01  WS-LOCAL-SERVER.                                             00303111
003032     05  WS-SUBSYS                   PIC X(04)  VALUE SPACES.     00303211
003033     05  FILLER                      PIC X(12)  VALUE SPACES.     00303311
003034******************************************************************00303411
003035     COPY DSWS008.                                                00303511
003036******************************************************************00303611
003037     COPY DSWS009.                                                00303711
003038******************************************************************00303811
003039     COPY DSWS010.                                                00303911
003040******************************************************************00304011
003050     COPY DPWS004.                                                00305011
003060******************************************************************00306011
003070*                                                                 00307011
003080*    USED IS DSPD002                                              00308011
003081     COPY DSRD002.                                                00308111
003082******************************************************************00308211
003083*  COMMUNICATIONS AREA FOR PROD TO TEST UTILITIES                 00308311
003084******************************************************************00308411
003085     COPY DSWS011.                                                00308511
003086*                                                                 00308611
003087******************************************************************00308711
003088*LINKAGE SECTION.                                                 00308811
003089******************************************************************00308911
003090*                                                                 00309011
003100 PROCEDURE DIVISION.                                              00310011
003200                                                                  00320011
003300 A100-MAINLINE.                                                   00330011
003410                                                                  00341011
003411     DISPLAY SPACES                                               00341113
003412     DISPLAY ' *** DSKUT009 ***'                                  00341213
003413     DISPLAY SPACES                                               00341313
003414                                                                  00341413
003420     PERFORM 1100-GET-DB2-INSTANCE.                               00342011
003430     PERFORM 1200-CHECK-IF-PRODUCTION.                            00343011
003440                                                                  00344011
003500     SET DS009-D-PGM TO TRUE.                                     00350011
003600     PERFORM DS002-INITIAL-PROCESSING.                            00360011
003700     PERFORM B100-PROCESSING                                      00370011
003800         UNTIL TABLE-EOF.                                         00380011
003900     PERFORM DS002-END-OF-JOB.                                    00390011
004000                                                                  00400011
004100     GOBACK.                                                      00410011
004200 EJECT                                                            00420011
004300***************************************************************** 00430011
004400*     FOR EACH TABLE, DELETE ANY EXISTING DATA AND THEN DELETE    00440011
004500*     THE DATA FROM THE FILE.                                     00450011
004600***************************************************************** 00460011
004700 B100-PROCESSING.                                                 00470011
004800*                                                                 00480011
004900     READ TBLE-FILE                                               00490011
005000         AT END SET TABLE-EOF TO TRUE.                            00500011
005100     IF NOT-TABLE-EOF                                             00510011
005200        MOVE TBLE-DATA-SIZE TO DS009-TBLE-DATA-SIZE               00520011
005300        MOVE TBLE-NAME  TO DS009-PROCESS-TABLE                    00530011
005400        MOVE TBLE-KEYS  TO DS009-PKYS                             00540011
005500        PERFORM DS002-DO-PROCESS                                  00550011
005600        IF DS009-DO-PROCESS                                       00560011
005700        DISPLAY '**********************************'              00570011
005800        DISPLAY DS009-PROCESS-TABLE                               00580011
005900        EVALUATE TRUE                                             00590011
006000         WHEN DS009-PROCESS-TABLE = 'TIMCNPO'                     00600011
006100             MOVE TBLE-DATA-ITEM TO WS-IMCNPO                     00610011
006200             MOVE WS-IMCNPO-PO-NBR  TO HOLD-PO-NBR                00620011
006300             DISPLAY HOLD-PO-NBR                                  00630011
006400             DISPLAY WS-IMCNPO                                    00640011
006500             PERFORM R100-DELETE                                  00650011
006600         WHEN DS009-PROCESS-TABLE = 'TIMBKPO'                     00660011
006700             MOVE TBLE-DATA-ITEM TO WS-IMBKPO                     00670011
006800             MOVE WS-IMBKPO-PO-NBR  TO HOLD-PO-NBR                00680011
006900             DISPLAY HOLD-PO-NBR                                  00690011
007000             DISPLAY WS-IMBKPO                                    00700011
007100             PERFORM R100-DELETE                                  00710011
007200*        WHEN DS009-PROCESS-TABLE = 'TIMBKVS'                     00720014
007300*            MOVE TBLE-DATA-ITEM TO WS-IMBKVS                     00730014
007400*            MOVE WS-IMBKVS-PO-NBR  TO HOLD-PO-NBR                00740014
007500*            DISPLAY HOLD-PO-NBR                                  00750014
007600*            DISPLAY WS-IMBKVS                                    00760014
007700*            PERFORM R100-DELETE                                  00770014
007800*        WHEN DS009-PROCESS-TABLE = 'TIMBKUP'                     00780014
007900*            MOVE TBLE-DATA-ITEM TO WS-IMBKUP                     00790014
008000*            MOVE WS-IMBKUP-PO-NBR  TO HOLD-PO-NBR                00800014
008100*            DISPLAY HOLD-PO-NBR                                  00810014
008200*            DISPLAY WS-IMBKUP                                    00820014
008300*            PERFORM R100-DELETE                                  00830014
008400         WHEN DS009-PROCESS-TABLE = 'TIMRCPO'                     00840011
008500             MOVE TBLE-DATA-ITEM TO WS-IMRCPO                     00850011
008600             MOVE WS-IMRCPO-PO-NBR  TO HOLD-PO-NBR                00860011
008700             DISPLAY HOLD-PO-NBR                                  00870011
008800             DISPLAY WS-IMRCPO                                    00880011
008900             PERFORM R100-DELETE                                  00890011
009000*        WHEN DS009-PROCESS-TABLE = 'TIMRCUP'                     00900014
009100*            MOVE TBLE-DATA-ITEM TO WS-IMRCUP                     00910014
009200*            MOVE WS-IMRCUP-PO-NBR  TO HOLD-PO-NBR                00920014
009300*            DISPLAY HOLD-PO-NBR                                  00930014
009400*            DISPLAY WS-IMRCUP                                    00940014
009500*            PERFORM R100-DELETE                                  00950014
009600*        WHEN DS009-PROCESS-TABLE = 'TIMRCVS'                     00960014
009700*            MOVE TBLE-DATA-ITEM TO WS-IMRCVS                     00970014
009800*            MOVE WS-IMRCVS-PO-NBR  TO HOLD-PO-NBR                00980014
009900*            DISPLAY HOLD-PO-NBR                                  00990014
010000*            DISPLAY WS-IMRCVS                                    01000014
010100*            PERFORM R100-DELETE                                  01010014
010200         WHEN DS009-PROCESS-TABLE = 'TIMCNTK'                     01020011
010300             MOVE TBLE-DATA-ITEM TO WS-IMCNTK                     01030011
010400             MOVE WS-IMCNTK-CONTNR-ID  TO HOLD-CONTNR-ID          01040011
010500             DISPLAY HOLD-CONTNR-ID                               01050011
010600             DISPLAY WS-IMCNTK                                    01060011
010700             PERFORM R100-DELETE                                  01070011
010800         WHEN DS009-PROCESS-TABLE = 'TIMCNUP'                     01080011
010900             MOVE TBLE-DATA-ITEM TO WS-IMCNUP                     01090011
011000             MOVE WS-IMCNUP-CONTNR-ID  TO HOLD-CONTNR-ID          01100011
011100             MOVE WS-IMCNUP-PO-NBR  TO HOLD-PO-NBR                01110014
011100*            MOVE WS-IMRCVS-PO-NBR  TO HOLD-PO-NBR                01111014
011200             DISPLAY HOLD-CONTNR-ID ' TIMCNUP '                   01120011
011300             DISPLAY HOLD-PO-NBR                                  01130011
011400             DISPLAY WS-IMCNUP                                    01140011
011500             PERFORM R100-DELETE                                  01150011
011600         WHEN DS009-PROCESS-TABLE = 'TIMCSEN'                     01160011
011700             MOVE TBLE-DATA-ITEM         TO WS-IMCSEN             01170011
011800             MOVE WS-IMCSEN-CSTM-ENTR-ID TO HOLD-CSTM-ENTR-ID     01180011
011900             DISPLAY HOLD-CSTM-ENTR-ID                            01190011
012000             DISPLAY WS-IMCSEN                                    01200011
012100             PERFORM R100-DELETE                                  01210011
012200         WHEN DS009-PROCESS-TABLE = 'TIMCSBL'                     01220011
012300             MOVE TBLE-DATA-ITEM         TO WS-IMCSBL             01230011
012400             MOVE WS-IMCSBL-CSTM-ENTR-ID TO HOLD-CSTM-ENTR-ID     01240011
012500             DISPLAY HOLD-CSTM-ENTR-ID                            01250011
012600             DISPLAY WS-IMCSBL                                    01260011
012700             PERFORM R100-DELETE                                  01270011
012800         WHEN DS009-PROCESS-TABLE = 'TIMCSCN'                     01280011
012900             MOVE TBLE-DATA-ITEM         TO WS-IMCSCN             01290011
013000             MOVE WS-IMCSCN-CSTM-ENTR-ID TO HOLD-CSTM-ENTR-ID     01300011
013100             DISPLAY HOLD-CSTM-ENTR-ID                            01310011
013200             DISPLAY WS-IMCSCN                                    01320011
013300             PERFORM R100-DELETE                                  01330011
013400         WHEN DS009-PROCESS-TABLE = 'TIMCSPO'                     01340011
013500             MOVE TBLE-DATA-ITEM         TO WS-IMCSPO             01350011
013600             MOVE WS-IMCSPO-CSTM-ENTR-ID TO HOLD-CSTM-ENTR-ID     01360011
013700             DISPLAY HOLD-CSTM-ENTR-ID                            01370011
013800             DISPLAY WS-IMCSPO                                    01380011
013900             PERFORM R100-DELETE                                  01390011
014000         WHEN DS009-PROCESS-TABLE = 'TAUCSEN'                     01400011
014100             MOVE TBLE-DATA-ITEM          TO WS-AUCSEN            01410011
014200             MOVE WS-AUCSEN-CSTM-ENTR-ID  TO HOLD-CSTM-ENTR-ID    01420011
014300             DISPLAY HOLD-CSTM-ENTR-ID                            01430011
014400             DISPLAY WS-AUCSEN                                    01440011
014500             PERFORM R100-DELETE                                  01450011
014600         WHEN DS009-PROCESS-TABLE = 'TAUCSBL'                     01460011
014700             MOVE TBLE-DATA-ITEM          TO WS-AUCSBL            01470011
014800             MOVE WS-AUCSBL-CSTM-ENTR-ID  TO HOLD-CSTM-ENTR-ID    01480011
014900             DISPLAY HOLD-CSTM-ENTR-ID                            01490011
015000             DISPLAY WS-AUCSBL                                    01500011
015100             PERFORM R100-DELETE                                  01510011
015200         WHEN DS009-PROCESS-TABLE = 'TAUCSCN'                     01520011
015300             MOVE TBLE-DATA-ITEM          TO WS-AUCSCN            01530011
015400             MOVE WS-AUCSCN-CSTM-ENTR-ID  TO HOLD-CSTM-ENTR-ID    01540011
015500             DISPLAY HOLD-CSTM-ENTR-ID                            01550011
015600             DISPLAY WS-AUCSCN                                    01560011
015700             PERFORM R100-DELETE                                  01570011
015800         WHEN DS009-PROCESS-TABLE = 'TAUCSPO'                     01580011
015900             MOVE TBLE-DATA-ITEM          TO WS-AUCSPO            01590011
016000             MOVE WS-AUCSPO-CSTM-ENTR-ID  TO HOLD-CSTM-ENTR-ID    01600011
016100             DISPLAY HOLD-CSTM-ENTR-ID                            01610011
016200             DISPLAY WS-AUCSPO                                    01620011
016300             PERFORM R100-DELETE                                  01630011
016400         WHEN DS009-PROCESS-TABLE = 'TAURCPO'                     01640011
016500             MOVE TBLE-DATA-ITEM          TO WS-AURCPO            01650011
016600             MOVE WS-AURCPO-PO-NBR        TO HOLD-PO-NBR          01660011
016700             DISPLAY HOLD-PO-NBR                                  01670011
016800             DISPLAY WS-AURCPO                                    01680011
016900             PERFORM R100-DELETE                                  01690011
017000*        WHEN DS009-PROCESS-TABLE = 'TAURCVS'                     01700014
017100*            MOVE TBLE-DATA-ITEM          TO WS-AURCVS            01710014
017200*            MOVE WS-AURCVS-PO-NBR        TO HOLD-PO-NBR          01720014
017300*            DISPLAY HOLD-PO-NBR                                  01730014
017400*            DISPLAY WS-AURCVS                                    01740014
017500*            PERFORM R100-DELETE                                  01750014
017600*        WHEN DS009-PROCESS-TABLE = 'TAURCUP'                     01760014
017700*            MOVE TBLE-DATA-ITEM          TO WS-AURCUP            01770014
017800*            MOVE WS-AURCUP-PO-NBR        TO HOLD-PO-NBR          01780014
017900*            DISPLAY HOLD-PO-NBR                                  01790014
018000*            DISPLAY WS-AURCUP                                    01800014
018100*            PERFORM R100-DELETE                                  01810014
018200         WHEN DS009-PROCESS-TABLE = 'TAUBKPO'                     01820011
018300             MOVE TBLE-DATA-ITEM          TO WS-AUBKPO            01830011
018400             MOVE WS-AUBKPO-PO-NBR        TO HOLD-PO-NBR          01840011
018500             DISPLAY HOLD-PO-NBR                                  01850011
018600             DISPLAY WS-AUBKPO                                    01860011
018700             PERFORM R100-DELETE                                  01870011
018800*        WHEN DS009-PROCESS-TABLE = 'TAUBKVS'                     01880014
018900*            MOVE TBLE-DATA-ITEM          TO WS-AUBKVS            01890014
019000*            MOVE WS-AUBKVS-PO-NBR        TO HOLD-PO-NBR          01900014
019100*            DISPLAY HOLD-PO-NBR                                  01910014
019200*            DISPLAY WS-AUBKVS                                    01920014
019300*            PERFORM R100-DELETE                                  01930014
019400*        WHEN DS009-PROCESS-TABLE = 'TAUBKUP'                     01940014
019500*            MOVE TBLE-DATA-ITEM          TO WS-AUBKUP            01950014
019600*            MOVE WS-AUBKUP-PO-NBR        TO HOLD-PO-NBR          01960014
019700*            DISPLAY HOLD-PO-NBR                                  01970014
019800*            DISPLAY WS-AUBKUP                                    01980014
019900*            PERFORM R100-DELETE                                  01990014
020000         WHEN DS009-PROCESS-TABLE = 'TAUCNPO'                     02000011
020100             MOVE TBLE-DATA-ITEM          TO WS-AUCNPO            02010011
020200             MOVE WS-AUCNPO-PO-NBR        TO HOLD-PO-NBR          02020011
020300             DISPLAY HOLD-PO-NBR                                  02030011
020400             DISPLAY WS-AUCNPO                                    02040011
020500             PERFORM R100-DELETE                                  02050011
020600         WHEN DS009-PROCESS-TABLE = 'TAUCNUP'                     02060011
020700             MOVE TBLE-DATA-ITEM          TO WS-AUCNUP            02070011
020800             MOVE WS-AUCNUP-PO-NBR        TO HOLD-PO-NBR          02080011
020900             DISPLAY HOLD-PO-NBR                                  02090011
021000             DISPLAY WS-AUCNUP                                    02100011
021100             PERFORM R100-DELETE                                  02110011
021200         WHEN DS009-PROCESS-TABLE = 'TAUCNTK'                     02120011
021300             MOVE TBLE-DATA-ITEM           TO WS-AUCNTK           02130011
021400             MOVE WS-AUCNTK-CONTNR-ID      TO HOLD-CONTNR-ID      02140011
021500             MOVE WS-AUCNTK-CONTNR-SEQ-NBR TO HOLD-CONTNR-SEQ-NBR 02150011
021600             DISPLAY HOLD-CONTNR-ID                               02160011
021700             DISPLAY HOLD-CONTNR-SEQ-NBR                          02170011
021800             DISPLAY WS-AUCNTK                                    02180011
021900             PERFORM R100-DELETE                                  02190011
022000         WHEN DS009-PROCESS-TABLE = 'TELCPO'                      02200011
022100             MOVE TBLE-DATA-ITEM          TO WS-ELCPO             02210011
022200             MOVE WS-ELCPO-PO-NBR         TO HOLD-PO-NBR          02220011
022300             DISPLAY HOLD-PO-NBR                                  02230011
022400             DISPLAY WS-ELCPO                                     02240011
022500             PERFORM R100-DELETE                                  02250011
022600         WHEN DS009-PROCESS-TABLE = 'TELCVS'                      02260011
022700             MOVE TBLE-DATA-ITEM          TO WS-ELCVS             02270011
022800             MOVE WS-ELCVS-PO-NBR         TO HOLD-PO-NBR          02280011
022900             DISPLAY HOLD-PO-NBR                                  02290011
023000             DISPLAY WS-ELCVS                                     02300011
023100             PERFORM R100-DELETE                                  02310011
023200         WHEN DS009-PROCESS-TABLE = 'TVSCPT'                      02320011
023300             MOVE TBLE-DATA-ITEM          TO WS-VSCPT             02330011
023400             MOVE WS-VSCPT-PO-NBR         TO HOLD-PO-NBR          02340011
023500             DISPLAY HOLD-PO-NBR                                  02350011
023600             DISPLAY WS-VSCPT                                     02360011
023700             PERFORM R100-DELETE                                  02370011
023800         WHEN DS009-PROCESS-TABLE = 'TIMCNRL'                     02380011
023900             MOVE TBLE-DATA-ITEM           TO WS-IMCNRL           02390011
024000             MOVE WS-IMCNRL-PO-NBR         TO HOLD-PO-NBR         02400011
024100             MOVE WS-IMCNRL-CONTNR-ID      TO HOLD-CONTNR-ID      02410011
024200             MOVE WS-IMCNRL-CONTNR-SEQ-NBR TO HOLD-CONTNR-SEQ-NBR 02420011
024300             DISPLAY HOLD-CONTNR-ID ' TIMCNRL '                   02430011
024400             DISPLAY HOLD-CONTNR-SEQ-NBR                          02440011
024500             DISPLAY HOLD-PO-NBR                                  02450011
024600             DISPLAY WS-IMCNRL                                    02460011
024700             PERFORM R100-DELETE                                  02470011
024800         WHEN DS009-PROCESS-TABLE = 'TAUCNRL'                     02480011
024900             MOVE TBLE-DATA-ITEM           TO WS-AUCNRL           02490011
025000             MOVE WS-AUCNRL-PO-NBR         TO HOLD-PO-NBR         02500011
025100             MOVE WS-AUCNRL-CONTNR-ID      TO HOLD-CONTNR-ID      02510011
025200             MOVE WS-AUCNRL-CONTNR-SEQ-NBR TO HOLD-CONTNR-SEQ-NBR 02520011
025300             DISPLAY HOLD-CONTNR-ID ' TAUCNRL '                   02530011
025400             DISPLAY HOLD-CONTNR-SEQ-NBR                          02540011
025500             DISPLAY HOLD-PO-NBR                                  02550011
025600             DISPLAY WS-AUCNRL                                    02560011
025700             PERFORM R100-DELETE                                  02570011
025800         END-EVALUATE                                             02580011
025900         DISPLAY 'DELETE RETURN SQLCODE:' SQLCODE                 02590011
026000         DISPLAY 'NUMBER OF ROWS DELETED:' SQLERRD (3)            02600011
026100         IF DS009-UPDATE-COUNT > DS009-COMMIT-COUNT               02610011
026200            EXEC SQL                                              02620011
026300                COMMIT                                            02630011
026400            END-EXEC                                              02640011
026500            IF SQLCODE NOT = ZERO                                 02650011
026600               PERFORM DS002-SQL-ABEND-COMMIT                     02660011
026700            END-IF                                                02670011
026800            MOVE +0  TO DS009-UPDATE-COUNT                        02680011
026900            DISPLAY 'COMMIT TAKEN AFTER RECORD: '                 02690011
027000                                      DS009-TUPDATE-COUNT         02700011
027100         END-IF                                                   02710011
027200         ADD SQLERRD(3) TO DS009-UPDATE-COUNT                     02720011
027300         ADD SQLERRD(3) TO DS009-TUPDATE-COUNT                    02730011
027400        END-IF                                                    02740011
027500     END-IF.                                                      02750011
027600 EJECT                                                            02760011
027700***************************************************************** 02770011
027800*     DELETE PARAGRAPH                                          * 02780011
027900***************************************************************** 02790011
028000 R100-DELETE.                                                     02800011
028100     PERFORM WITH TEST AFTER                                      02810011
028200             VARYING DS009-RETRY-COUNTER FROM 1 BY 1              02820011
028300             UNTIL   DS009-RETRY-COUNTER > 3 OR                   02830011
028400                     SQLCODE = ZERO OR +100                       02840011
028500                                                                  02850011
028600         EVALUATE TRUE                                            02860011
028700           WHEN DS009-PROCESS-TABLE = 'TIMCNPO'                   02870011
028800             EXEC SQL                                             02880011
028900                DELETE FROM TIMCNPO                               02890011
029000                WHERE PO_NBR = :HOLD-PO-NBR                       02900011
029100             END-EXEC                                             02910011
029200           WHEN DS009-PROCESS-TABLE = 'TIMBKPO'                   02920011
029300             EXEC SQL                                             02930011
029400                DELETE FROM TIMBKPO                               02940011
029500                WHERE PO_NBR = :HOLD-PO-NBR                       02950011
029600             END-EXEC                                             02960011
029700*          WHEN DS009-PROCESS-TABLE = 'TIMBKVS'                   02970014
029800*            EXEC SQL                                             02980014
029900*               DELETE FROM TIMBKVS                               02990014
030000*               WHERE PO_NBR = :HOLD-PO-NBR                       03000014
030100*            END-EXEC                                             03010014
030200*          WHEN DS009-PROCESS-TABLE = 'TIMBKUP'                   03020014
030300*            EXEC SQL                                             03030014
030400*               DELETE FROM TIMBKUP                               03040014
030500*               WHERE PO_NBR = :HOLD-PO-NBR                       03050014
030600*            END-EXEC                                             03060014
030700           WHEN DS009-PROCESS-TABLE = 'TIMRCPO'                   03070011
030800             EXEC SQL                                             03080011
030900                DELETE FROM TIMRCPO                               03090011
031000                WHERE PO_NBR = :HOLD-PO-NBR                       03100011
031100             END-EXEC                                             03110011
031200*          WHEN DS009-PROCESS-TABLE = 'TIMRCUP'                   03120014
031300*            EXEC SQL                                             03130014
031400*               DELETE FROM TIMRCUP                               03140014
031500*               WHERE PO_NBR = :HOLD-PO-NBR                       03150014
031600*            END-EXEC                                             03160014
031700*          WHEN DS009-PROCESS-TABLE = 'TIMRCVS'                   03170014
031800*            EXEC SQL                                             03180014
031900*               DELETE FROM TIMRCVS                               03190014
032000*               WHERE PO_NBR = :HOLD-PO-NBR                       03200014
032100*            END-EXEC                                             03210014
032200           WHEN DS009-PROCESS-TABLE = 'TIMCNTK'                   03220011
032300             EXEC SQL                                             03230011
032400                DELETE FROM TIMCNTK                               03240011
032500                WHERE CONTNR_ID  = :HOLD-CONTNR-ID                03250011
032600             END-EXEC                                             03260011
032700           WHEN DS009-PROCESS-TABLE = 'TIMCNUP'                   03270011
032800             EXEC SQL                                             03280011
032900                DELETE FROM TIMCNUP                               03290011
033000                WHERE CONTNR_ID = :HOLD-CONTNR-ID                 03300011
033100                AND   PO_NBR    = :HOLD-PO-NBR                    03310011
033200             END-EXEC                                             03320011
033300           WHEN DS009-PROCESS-TABLE = 'TIMCSEN'                   03330011
033400             EXEC SQL                                             03340011
033500                DELETE FROM TIMCSEN                               03350011
033600                WHERE CSTM_ENTR_ID  = :HOLD-CSTM-ENTR-ID          03360011
033700             END-EXEC                                             03370011
033800           WHEN DS009-PROCESS-TABLE = 'TIMCSBL'                   03380011
033900             EXEC SQL                                             03390011
034000                DELETE FROM TIMCSBL                               03400011
034100                WHERE CSTM_ENTR_ID  = :HOLD-CSTM-ENTR-ID          03410011
034200             END-EXEC                                             03420011
034300           WHEN DS009-PROCESS-TABLE = 'TIMCSCN'                   03430011
034400             EXEC SQL                                             03440011
034500                DELETE FROM TIMCSCN                               03450011
034600                WHERE CSTM_ENTR_ID  = :HOLD-CSTM-ENTR-ID          03460011
034700             END-EXEC                                             03470011
034800           WHEN DS009-PROCESS-TABLE = 'TIMCSPO'                   03480011
034900             EXEC SQL                                             03490011
035000                DELETE FROM TIMCSPO                               03500011
035100                WHERE CSTM_ENTR_ID  = :HOLD-CSTM-ENTR-ID          03510011
035200             END-EXEC                                             03520011
035300           WHEN DS009-PROCESS-TABLE = 'TAUCSEN'                   03530011
035400             EXEC SQL                                             03540011
035500                DELETE FROM TAUCSEN                               03550011
035600                WHERE CSTM_ENTR_ID  = :HOLD-CSTM-ENTR-ID          03560011
035700             END-EXEC                                             03570011
035800           WHEN DS009-PROCESS-TABLE = 'TAUCSBL'                   03580011
035900             EXEC SQL                                             03590011
036000                DELETE FROM TAUCSBL                               03600011
036100                WHERE CSTM_ENTR_ID = :HOLD-CSTM-ENTR-ID           03610011
036200             END-EXEC                                             03620011
036300           WHEN DS009-PROCESS-TABLE = 'TAUCSCN'                   03630011
036400             EXEC SQL                                             03640011
036500                DELETE FROM TAUCSCN                               03650011
036600                WHERE CSTM_ENTR_ID = :HOLD-CSTM-ENTR-ID           03660011
036700             END-EXEC                                             03670011
036800           WHEN DS009-PROCESS-TABLE = 'TAUCSPO'                   03680011
036900             EXEC SQL                                             03690011
037000                DELETE FROM TAUCSPO                               03700011
037100                WHERE CSTM_ENTR_ID = :HOLD-CSTM-ENTR-ID           03710011
037200             END-EXEC                                             03720011
037300           WHEN DS009-PROCESS-TABLE = 'TAURCPO'                   03730011
037400             EXEC SQL                                             03740011
037500                DELETE FROM TAURCPO                               03750011
037600                WHERE PO_NBR       = :HOLD-PO-NBR                 03760011
037700             END-EXEC                                             03770011
037800*          WHEN DS009-PROCESS-TABLE = 'TAURCVS'                   03780014
037900*            EXEC SQL                                             03790014
038000*               DELETE FROM TAURCVS                               03800014
038100*               WHERE PO_NBR       = :HOLD-PO-NBR                 03810014
038200*            END-EXEC                                             03820014
038300*          WHEN DS009-PROCESS-TABLE = 'TAURCUP'                   03830014
038400*            EXEC SQL                                             03840014
038500*               DELETE FROM TAURCUP                               03850014
038600*               WHERE PO_NBR       = :HOLD-PO-NBR                 03860014
038700*            END-EXEC                                             03870014
038800           WHEN DS009-PROCESS-TABLE = 'TAUBKPO'                   03880011
038900             EXEC SQL                                             03890011
039000                DELETE FROM TAUBKPO                               03900011
039100                WHERE PO_NBR       = :HOLD-PO-NBR                 03910011
039200             END-EXEC                                             03920011
039300*          WHEN DS009-PROCESS-TABLE = 'TAUBKVS'                   03930014
039400*            EXEC SQL                                             03940014
039500*               DELETE FROM TAUBKVS                               03950014
039600*               WHERE PO_NBR       = :HOLD-PO-NBR                 03960014
039700*            END-EXEC                                             03970014
039800*          WHEN DS009-PROCESS-TABLE = 'TAUBKUP'                   03980014
039810*            EXEC SQL                                             03981014
039820*               DELETE FROM TAUBKUP                               03982014
039830*               WHERE PO_NBR       = :HOLD-PO-NBR                 03983014
039840*            END-EXEC                                             03984014
039850           WHEN DS009-PROCESS-TABLE = 'TAUCNPO'                   03985011
039860             EXEC SQL                                             03986011
039870                DELETE FROM TAUCNPO                               03987011
039880                WHERE PO_NBR       = :HOLD-PO-NBR                 03988011
039890             END-EXEC                                             03989011
039900           WHEN DS009-PROCESS-TABLE = 'TAUCNUP'                   03990011
039910             EXEC SQL                                             03991011
039920                DELETE FROM TAUCNUP                               03992011
039930                WHERE PO_NBR       = :HOLD-PO-NBR                 03993011
039940             END-EXEC                                             03994011
039950           WHEN DS009-PROCESS-TABLE = 'TAUCNTK'                   03995011
039960             EXEC SQL                                             03996011
039970                DELETE FROM TAUCNTK                               03997011
039980                WHERE CONTNR_ID      = :HOLD-CONTNR-ID            03998011
039990                AND   CONTNR_SEQ_NBR = :HOLD-CONTNR-SEQ-NBR       03999011
039991             END-EXEC                                             03999111
039992           WHEN DS009-PROCESS-TABLE = 'TELCPO'                    03999211
039993             EXEC SQL                                             03999311
039994                DELETE FROM TELCPO                                03999411
039995                WHERE PO_NBR       = :HOLD-PO-NBR                 03999511
039996             END-EXEC                                             03999611
039997           WHEN DS009-PROCESS-TABLE = 'TELCVS'                    03999711
039998             EXEC SQL                                             03999811
039999                DELETE FROM TELCVS                                03999911
040000                WHERE PO_NBR       = :HOLD-PO-NBR                 04000011
040010             END-EXEC                                             04001011
040020           WHEN DS009-PROCESS-TABLE = 'TVSCPT'                    04002011
040030             EXEC SQL                                             04003011
040040                DELETE FROM TVSCPT                                04004011
040041                WHERE PO_NBR       = :HOLD-PO-NBR                 04004111
040042             END-EXEC                                             04004211
040043           WHEN DS009-PROCESS-TABLE = 'TIMCNRL'                   04004311
040044             EXEC SQL                                             04004411
040045                DELETE FROM TIMCNRL                               04004511
040046                WHERE CONTNR_ID      = :HOLD-CONTNR-ID            04004611
040047                AND   CONTNR_SEQ_NBR = :HOLD-CONTNR-SEQ-NBR       04004711
040048                AND   PO_NBR         = :HOLD-PO-NBR               04004811
040049             END-EXEC                                             04004911
040050           WHEN DS009-PROCESS-TABLE = 'TAUCNRL'                   04005011
040060             EXEC SQL                                             04006011
040070                DELETE FROM TAUCNRL                               04007011
040080                WHERE CONTNR_ID      = :HOLD-CONTNR-ID            04008011
040090                AND   CONTNR_SEQ_NBR = :HOLD-CONTNR-SEQ-NBR       04009011
040091                AND   PO_NBR         = :HOLD-PO-NBR               04009111
040092             END-EXEC                                             04009211
040093         END-EVALUATE                                             04009311
040094     END-PERFORM.                                                 04009411
040095     PERFORM DS002-SQL-ABEND-DELETE.                              04009511
040096 EJECT                                                            04009611
040097                                                                  04009711
040098 1100-GET-DB2-INSTANCE.                                           04009811
040099                                                                  04009911
040100     MOVE '1100-GET-DB2-INSTANCE'                                 04010011
040101          TO DS009-PARAGRAPH.                                     04010111
040102     MOVE 'GET DB2 INSTANCE'                                      04010211
040103          TO DS009-OPERATION.                                     04010311
040104                                                                  04010411
040105     EXEC SQL                                                     04010511
040106         SELECT CURRENT SERVER INTO :WS-LOCAL-SERVER              04010611
040107             FROM SYSIBM.SYSDUMMY1 WITH UR                        04010711
040108     END-EXEC.                                                    04010811
040109                                                                  04010911
040110     EVALUATE TRUE                                                04011011
040111         WHEN SQLCODE = +0                                        04011111
040112             CONTINUE                                             04011211
040113         WHEN SQLWARN0 NOT = SPACES                               04011311
040114         WHEN SQLCODE < +0                                        04011411
040115         WHEN SQLCODE > +0                                        04011511
040116             PERFORM DS002-SQL-ERROR                              04011611
040117     END-EVALUATE.                                                04011711
040118*                                                                 04011811
040119 1200-CHECK-IF-PRODUCTION.                                        04011911
040120                                                                  04012011
040121     MOVE '1200-CHECK-IF-PRODUCTION'                              04012111
040122          TO DS009-PARAGRAPH.                                     04012211
040123     MOVE 'SELECT PRDCHK TKRPRPM '                                04012311
040124          TO DS009-OPERATION.                                     04012411
040125                                                                  04012511
040126     EXEC SQL                                                     04012611
040127       SELECT FUNC_TXT                                            04012711
040128         INTO :KRPRPM-FUNC-TXT                                    04012811
040129       FROM   TKRPRPM                                             04012911
040130       WHERE  SYS_PRC_FUNC_CDE  = :PC-PRDCHK                      04013012
040131         AND  INTFC_SYS_CDE     = :PC-KHL                         04013111
040132         AND  LOC_ID            = :PC-90                          04013211
040133         AND  FUNC_TXT          = :PC-PARM-TEXT                   04013311
040134     END-EXEC                                                     04013411
040135                                                                  04013511
040136     EVALUATE TRUE                                                04013611
040137         WHEN SQLCODE = +0                                        04013711
040138             CONTINUE                                             04013811
040139         WHEN SQLCODE = +100                                      04013911
040140             DISPLAY '*******************************************'04014011
040141             DISPLAY '** ABEND - DO NOT RUN THIS DSKUT009 PROGRAM'04014111
040142             DISPLAY '** ABEND - AGAINST PRODUCTION'              04014211
040143             DISPLAY '** ABEND - THIS SHOULD ONLY EVER BE'        04014311
040144             DISPLAY '** ABEND - RUN AGAINST TEST DATA'           04014411
040145             DISPLAY '*******************************************'04014511
040146             DISPLAY '** ABEND - THIS RUN IS GOING AGAINST'       04014611
040147             DISPLAY '** ABEND - DB2 INSTANCE:  '                 04014711
040148                     WS-LOCAL-SERVER                              04014811
040149             DISPLAY '*******************************************'04014911
040150             PERFORM DS002-SQL-ERROR                              04015011
040151                                                                  04015111
040152         WHEN SQLWARN0 NOT = SPACES                               04015211
040153         WHEN SQLCODE < +0                                        04015311
040154         WHEN SQLCODE > +0                                        04015411
040155             PERFORM DS002-SQL-ERROR                              04015511
040156     END-EVALUATE.                                                04015611
040157                                                                  04015711
040158***************************************************************** 04015811
040159*     PRODUCTION - TO - TEST STANDARD PARAGRAPHS                * 04015911
040160***************************************************************** 04016011
040200     COPY DSPD002.                                                04020011
