      ******************************************************************00010000
       IDENTIFICATION DIVISION.                                         00010100
      ******************************************************************00010200
                                                                        00010300
       PROGRAM-ID.             TFKCS418.                                00010400
       AUTHOR.                 DAVID WELLER                             00010500
       INSTALLATION.           KOHLS.                                   00010600
       DATE-WRITTEN.           NOVEMBER 2004.                           00010700
       DATE-COMPILED.                                                   00010800
      *    ANY CHANGES THAT MAY EFFECT THE LAYOUT OF THIS REPORT SHOULD 00010900
      *    BE TESTED ON EVERY MODEL OF PRINTER.  THERE MIGHT BE         00011000
      *    DIFFERENCES IN CARRIAGE CONTROL AND GRAPHICS PRINTING FOR    00012000
      *    EACH MODEL.  ALSO BE AWARE THAT WHEN USING PROGRAM DRS1INTC  00013000
      *    TO PRINT THE REPORT, A NON-BLANK CHARACTER IN PRINT POSITION 00014000
      *    132 WILL CAUSE A DOUBLE-SPACE TO OCCUR REGARDLESS OF THE     00015000
      *    VALUE OF THE CARRIAGE CONTROL.                               00016000
                                                                        00017000
      ******************************************************************00018000
      * THIS PROGRAM PRODUCES THE TRANSFER DOCUMENT REPORT.             00019000
      ******************************************************************00020000
      *  1/20/2003 - RAY GRAF                                           00030000
      *   PROCESS NONINTELLIGENT SKU.                                   00040000
      ******************************************************************00050000
      * 11/17/2003 - RAY GRAF                                           00060000
      *   SORT1/SORT2 TRANSFER TYPES.                                   00070000
      ******************************************************************00080000
      **DATE:08/02/2004 CHANGED BY: RAY GRAF                            00090000
      **     CHANGE PRINTER DESTINATION TO NEW 8 CHARACTER FORMAT       00100000
      ***************************************************************** 00110000
      **DATE:11/01/2004 CHANGED BY: DAVE WELLER                         00120000
      **    STORE EXPANSION (PARTICULARLY IN THE TRANSFER DOC NBR)      00130000
      **    PROGRAM TFKCS423 CHANGED TO TFKCS418                        00140000
      ***************************************************************** 00150000
      **DATE:02/15/2005 CHANGED BY: RAY GRAF                            00151000
      **    RECOMPILE TO FIX XFER DOC PROB NOW THAT PRODUCTION CICS     00152000
      **    HAS BEEN RECYCLED.                                          00152100
      ***************************************************************** 00152200
021605**DATE:02/16/2005 CHANGED BY: DAVID WELLER                        00152300
021605**    STANDARDS COMPLIANCE FOR TFWS007 AND TFWS008                00152400
021605***************************************************************** 00152500
051705*  DATE 05/17/05 RAY GRAF                                         00152600
051705*  REMOVE PHYSICAL INVENTORY LOGIC                                00152700
051705******************************************************************00152800
SR3403*  DATE 03/20/12 TEJA KARWEER                                     00152900
SR3403*  LARGE RETAIL AMT FIELD EXPANSION. ADD PRINTER LOGIC            00153000
SR3403******************************************************************00153100
CICS  * CHANGED 11/15/2022    BY JIM HUNTER      WR: CHG0278345         00153201
CICS  * THIS PROGRAM DOES NOT CALL THE CICS ARCHITECTURE - REMOVE       00153301
CICS  * COPYBOOK DPWS030.                                               00153401
CICS  *-----------------------------------------------------------------00153501
                                                                        00153600
      ******************************************************************00153700
       ENVIRONMENT DIVISION.                                            00153800
      ******************************************************************00153900
                                                                        00154000
      ******************************************************************00154100
       DATA DIVISION.                                                   00154200
      ******************************************************************00154300
                                                                        00154400
      ******************************************************************00155000
       WORKING-STORAGE SECTION.                                         00156000
      ******************************************************************00157000
                                                                        00158000
      *                                                                 00159000
      *  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      00160000
      *                                                                 00170000
           COPY DFHAID.                                                 00180000
                                                                        00190000
      *                                                                 00200000
      *  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00210000
      *                                                                 00220000
           COPY DPWS013.                                                00230000
                                                                        00240000
      *                                                                 00250000
      *  THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT     *00260000
      *  SUB-ROUTINE (DPKUT100).                                       *00270000
      *                                                                 00280000
           COPY DPWS010I.                                               00290000
                                                                        00300000
      *----------------------------------------------------------------*00370000
      *  DATE VALIDATION CALLING PARAMETER LIST                        *00380000
      *----------------------------------------------------------------*00390000
           COPY DPWS500.                                                00400000
      *                                                                 00410000
      *----------------------------------------------------------------*00420000
      *  PARAMETERS FOR CALLING UCC128 CHECK DIGIT SUBROUTINE.          00430000
      *----------------------------------------------------------------*00440000
      *                                                                 00450000
           COPY TFWS100.                                                00460000
      *                                                                 00470000
      *                                                                 00480000
      *  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) COMMAREA            00490000
      *                                                                 00500000
           COPY DRRD003.                                                00510000
                                                                        00520000
      *                                                                 00530000
      *  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) INIT BLOCK          00540000
      *                                                                 00550000
           COPY DRRD006.                                                00560000
      *                                                                 00570000
      *                                                                 00580000
      *  LAYOUT FOR THE DRS COMMAREA WITH OUTPUT BLOCK                  00590000
      *                                                                 00600000
           COPY DRRD005.                                                00610000
      *                                                                 00620000
      *                                                                 00630000
      *  LAYOUT FOR THE DRS TERMINATION BLOCK                           00640000
      *                                                                 00650000
           COPY DRRD007.                                                00660000
                                                                        00670000
           COPY TFWS005.                                                00680000
                                                                        00690000
       01  DK-DB2-KEYS.                                                 00700000
           05  DK-FROM-STORE-NBR           PIC S9(04)  VALUE ZEROS      00710000
                                                       COMP.            00720000
           05  DK-XFER-SEQ-NBR             PIC S9(09)  VALUE ZEROS      00730000
                                                       COMP.            00740000
           05  DK-XFER-DKEY-ID             PIC S9(09)  VALUE ZEROS      00750000
                                                       COMP.            00760000
           05  DK-STORE-NBR                PIC S9(04)  VALUE ZEROS      00770000
                                                       COMP.            00780000
051705*    05  DK-STORE-NBR-9              PIC S9(04)  VALUE ZEROS      00790000
051705*                                                COMP.            00800000
           05  DK-UPC-NBR                  PIC S9(15)  VALUE ZEROS      00810000
                                                       COMP-3.          00820000
       01  HL1-HEADING-LINE.                                            00830000
           05  FILLER                      PIC  X(01)  VALUE SPACES.    00840000
           05  HL1-FROM-STORE-NBR          PIC  9(04)  VALUE ZEROS.     00850000
           05  FILLER                      PIC  X(01)  VALUE '-'.       00860000
           05  HL1-XFER-SEQ-NBR            PIC  X(06)  VALUE SPACES.    00870000
           05  FILLER                      PIC  X(01)  VALUE '-'.       00880000
           05  HL1-CHK-DIGIT               PIC  X(01)  VALUE SPACES.    00890000
           05  FILLER                      PIC  X(02)  VALUE SPACES.    00900000
           05  HL1-BARCODE-DATA            PIC  X(14)  VALUE SPACES.    00910000
           05  FILLER                      PIC  X(04)  VALUE SPACES.    00920000
           05  HL1-AFP-GROUP               PIC  X(01)  VALUE SPACES.    00930000
           05  HL1-AFP-COMBINATION         PIC  X(01)  VALUE SPACES.    00940000
           05  FILLER                      PIC  X(13)  VALUE SPACES.    00950000
           05  FILLER                      PIC  X(15)  VALUE            00960000
               'KOHL''S TRANSFER'.                                      00970000
           05  FILLER                      PIC  X(20)  VALUE SPACES.    00980000
           05  FILLER                      PIC  X(05)  VALUE            00990000
               'PAGE '.                                                 01000000
           05  HL1-PAGE                    PIC  ZZ9.                    01010000
           05  FILLER                      PIC  X(01)  VALUE SPACE.     01020000
           05  FILLER                      PIC  X(02)  VALUE 'OF'.      01030000
           05  FILLER                      PIC  X(01)  VALUE SPACE.     01040000
           05  HL1-PAGE-TOTAL              PIC  ZZ9.                    01050000
           05  FILLER                      PIC  X(03)  VALUE SPACE.     01060000
                                                                        01070000
       01  HL2-HEADING-LINE.                                            01080000
           05  FILLER                      PIC  X(38)  VALUE SPACE.     01090000
           05  HL2-XFER-DESC               PIC  X(36)  VALUE SPACES.    01100000
           05  FILLER                      PIC  X(35)  VALUE SPACES.    01110000
           05  HL2-BEFORE-AFTER-INV        PIC  X(16)  VALUE SPACES.    01120000
                                                                        01130000
       01  HL3-HEADING-LINE.                                            01140000
           05  FILLER                      PIC  X(08)  VALUE            01150000
               'TO LOC: '.                                              01160000
           05  HL3-TO-STORE-NBR            PIC  9(04)  VALUE ZERO.      01170000
           05  FILLER                      PIC  X(03)  VALUE SPACE.     01180000
           05  HL3-TO-STORE-NAME           PIC  X(10)  VALUE SPACE.     01190000
           05  FILLER                      PIC  X(02)  VALUE SPACE.     01200000
           05  FILLER                      PIC  X(17)  VALUE            01210000
               'FROM STORE.....:'.                                      01220000
           05  HL3-FROM-STORE-NBR          PIC  9(04)  VALUE ZERO.      01230000
           05  FILLER                      PIC  X(01)  VALUE SPACE.     01240000
           05  HL3-FROM-STORE-NAME         PIC  X(10)  VALUE SPACE.     01250000
           05  FILLER                      PIC  X(11)  VALUE SPACE.     01260000
           05  HL3-CUST-NAME-LITERAL       PIC  X(16)  VALUE            01270000
               'CUSTOMER NAME.:'.                                       01280000
           05  HL3-CUST-NAME               PIC  X(22)  VALUE SPACE.     01290000
                                                                        01300000
       01  HL4-HEADING-LINE.                                            01310000
           05  FILLER                      PIC  X(26)  VALUE SPACE.     01320000
           05  FILLER                      PIC  X(17)  VALUE            01330000
               'CONTAINER TYPE.:'.                                      01340000
           05  HL4-CONTAINER-TYPE          PIC  X(12)  VALUE SPACE.     01350000
           05  FILLER                      PIC  X(15)  VALUE SPACE.     01360000
           05  HL4-CUSTOMER.                                            01370000
               10  HL4-CUST-PHONE-LITERAL  PIC  X(16)  VALUE            01380000
                   'CUSTOMER PHONE:'.                                   01390000
               10  FILLER                  PIC  X(01)  VALUE '('.       01400000
               10  HL4-PHONE-AREA          PIC  X(03).                  01410000
               10  FILLER                  PIC  X(02)  VALUE ')-'.      01420000
               10  HL4-PHONE-EXCH          PIC  X(03).                  01430000
               10  FILLER                  PIC  X(01)  VALUE '-'.       01440000
               10  HL4-PHONE-NBR           PIC  X(04).                  01450000
           05  FILLER                      PIC  X(15)  VALUE SPACE.     01460000
                                                                        01470000
       01  HL5-HEADING-LINE.                                            01480000
           05  FILLER                      PIC  X(26)  VALUE SPACE.     01490000
           05  FILLER                      PIC  X(17)  VALUE            01500000
               'COMPLETED BY...:'.                                      01510000
           05  HL5-COMP-BY-INIT            PIC  X(01)  VALUE SPACE.     01520000
           05  FILLER                      PIC  X(01)  VALUE SPACE.     01530000
           05  HL5-COMP-BY-NAME            PIC  X(20)  VALUE SPACE.     01540000
           05  FILLER                      PIC  X(05)  VALUE SPACE.     01550000
           05  HL5-CUST-ADDR-LITERAL       PIC  X(16)  VALUE            01560000
               'ADDRESS.......:'.                                       01570000
           05  HL5-CUST-ADDRESS            PIC  X(20)  VALUE SPACE.     01580000
                                                                        01590000
       01  HL6-HEADING-LINE.                                            01600000
           05  FILLER                      PIC  X(26)  VALUE SPACE.     01610000
           05  FILLER                      PIC  X(17)  VALUE            01620000
               'COMPLETION DATE:'.                                      01630000
           05  HL6-COMP-DATE.                                           01640000
               10  HL6-COMP-MONTH          PIC  X(02)  VALUE SPACE.     01650000
               10                          PIC  X(01)  VALUE '-'.       01660000
               10  HL6-COMP-DAY            PIC  X(02)  VALUE SPACE.     01670000
               10                          PIC  X(01)  VALUE '-'.       01680000
               10  HL6-COMP-YEAR           PIC  X(04)  VALUE SPACE.     01690000
           05  FILLER                      PIC  X(33)  VALUE SPACE.     01700000
           05  HL6-CUST-ADDRESS            PIC  X(20)  VALUE SPACE.     01710000
                                                                        01720000
       01  HL7-HEADING-LINE.                                            01730000
           05  HL7-LITERAL                 PIC  X(22)  VALUE SPACE.     01740000
           05  FILLER                      PIC  X(04)  VALUE SPACE.     01750000
           05  HL7-SEAL-TRLR-LITERAL       PIC  X(17)  VALUE            01760000
               'LARGE TOTE SEAL:'.                                      01770000
           05  HL7-SEAL-TRAILER            PIC  X(15)  VALUE SPACE.     01780000
           05  FILLER                      PIC  X(12)  VALUE SPACE.     01790000
           05  HL7-CITY-LITERAL            PIC  X(16)  VALUE            01800000
               'CITY..........:'.                                       01810000
           05  HL7-CITY                    PIC  X(20)  VALUE SPACE.     01820000
                                                                        01830000
       01  HL8-HEADING-LINE.                                            01840000
           05  FILLER                      PIC  X(01)  VALUE SPACE.     01850000
           05  HL8-NAME                    PIC  X(22)  VALUE SPACE.     01860000
           05  FILLER                      PIC  X(03)  VALUE SPACE.     01870000
           05  HL8-SEAL-TRLR-LITERAL       PIC  X(17)  VALUE            01880000
               'SMALL TOTE SEAL:'.                                      01890000
           05  HL8-SEAL-TRAILER            PIC  X(15)  VALUE SPACE.     01900000
           05  FILLER                      PIC  X(12)  VALUE SPACE.     01910000
           05  HL8-STATE-ZIP-LITERAL       PIC  X(16)  VALUE            01920000
               'STATE/ZIP.....:'.                                       01930000
           05  HL8-STATE                   PIC  X(02)  VALUE SPACE.     01940000
           05  FILLER                      PIC  X(08)  VALUE SPACE.     01950000
           05  HL8-ZIP                     PIC  X(05)  VALUE SPACE.     01960000
           05  HL8-ZIP-DASH                PIC  X(01)  VALUE SPACE.     01970000
           05  HL8-ZIP-EXT                 PIC  X(04)  VALUE SPACE.     01980000
                                                                        01990000
       01  HL9-HEADING-LINE.                                            02000000
           05  FILLER                      PIC  X(26)  VALUE SPACE.     02010000
           05  HL9-RETAIL.                                              02020000
               10  HL9-TOT-RETAIL-LITERAL  PIC  X(20)  VALUE            02030000
               'TOTAL RETAIL......:'.                                   02040000
SR3403         10  HL9-TOTAL-RETAIL        PIC  $$$,$$$,$$$.99.         02050000
           05  FILLER                      PIC  X(10)  VALUE SPACE.     02060000
           05  HL9-TOT-UNITS-LITERAL       PIC  X(17)  VALUE            02070000
               'TOTAL UNITS....:'.                                      02080000
           05  HL9-TOTAL-UNITS             PIC  ZZZZ9.                  02090000
       01  CH1-COLUMN-HEADING-1.                                        02100000
           05  FILLER                      PIC  X(03)  VALUE            02110000
               'LIN'.                                                   02120000
           05  FILLER                      PIC  X(08)  VALUE SPACE.     02130000
           05  FILLER                      PIC  X(05)  VALUE            02140000
               'D/M/S'.                                                 02150000
           05  FILLER                      PIC  X(12)  VALUE SPACE.     02160000
           05  FILLER                      PIC  X(03)  VALUE            02170000
               'SKU'.                                                   02180000
           05  FILLER                      PIC  X(06)  VALUE SPACE.     02190000
           05  FILLER                      PIC  X(07)  VALUE            02200000
               'UPC NO.'.                                               02210000
           05  FILLER                      PIC  X(12)  VALUE SPACE.     02220000
           05  FILLER                      PIC  X(06)  VALUE            02230000
               'RETAIL'.                                                02240000
           05  FILLER                      PIC  X(04)  VALUE SPACE.     02250000
           05  FILLER                      PIC  X(03)  VALUE            02260000
               'QTY'.                                                   02270000
           05  FILLER                      PIC  X(02)  VALUE SPACE.     02280000
           05  FILLER                      PIC  X(17)  VALUE            02290000
               'STYLE DESCRIPTION'.                                     02300000
           05  FILLER                      PIC  X(16)  VALUE SPACE.     02310000
           05  FILLER                      PIC  X(12)  VALUE            02320000
               'VENDOR STYLE'.                                          02330000
           05  FILLER                      PIC  X(02)  VALUE SPACE.     02340000
           05  FILLER                      PIC  X(05)  VALUE            02350000
               'COLOR'.                                                 02360000
           05  FILLER                      PIC  X(07)  VALUE SPACE.     02370000
           05  FILLER                      PIC  X(04)  VALUE            02380000
               'SIZE'.                                                  02390000
           05  FILLER                      PIC  X(10)  VALUE SPACE.     02400000
           05  CH1-LITERAL                 PIC  X(12)  VALUE            02410000
               'LABL/VEND'.                                             02420000
                                                                        02430000
       01  CH1A-COLUMN-HEADING-1A.                                      02440000
           05  FILLER                      PIC  X(04)  VALUE            02450000
               'LINE'.                                                  02460000
           05  FILLER                      PIC  X(02)  VALUE SPACE.     02470000
           05  FILLER                      PIC  X(16)  VALUE            02480000
               'ITEM DESCRIPTION'.                                      02490000
           05  FILLER                      PIC  X(27)  VALUE SPACE.     02500000
           05  FILLER                      PIC  X(14)  VALUE            02510000
               'FIXTURE NUMBER'.                                        02520000
           05  FILLER                      PIC  X(09)  VALUE SPACE.     02530000
           05  FILLER                      PIC  X(04)  VALUE            02540000
               'DEPT'.                                                  02550000
           05  FILLER                      PIC  X(03)  VALUE SPACE.     02560000
           05  FILLER                      PIC  X(03)  VALUE            02570000
               'QTY'.                                                   02580000
                                                                        02590000
       01  DL1-DETAIL-LINE-1.                                           02600000
           05  DL1-LINE-NBR              PIC  ZZ9.                      02610000
           05  FILLER                    PIC  X(03)  VALUE SPACE.       02620000
           05  DL1-DEPT                  PIC  999.                      02630000
           05  FILLER                    PIC  X(01)  VALUE SPACE.       02640000
           05  DL1-GROUP-1.                                             02650000
               10  DL1-CLASS-1           PIC  99     VALUE ZEROS.       02660000
               10  FILLER                PIC  X(01)  VALUE SPACE.       02670000
               10  DL1-SUBCLASS-1        PIC  99     VALUE ZEROS.       02680000
               10  FILLER                PIC  X(05)  VALUE SPACE.       02690000
           05  DL1-GROUP-2 REDEFINES DL1-GROUP-1.                       02700000
               10  DL1-CLASS-2           PIC  99.                       02710000
               10  DL1-FILLER-2A         PIC  X(01).                    02720000
               10  DL1-SUBCLASS-2        PIC  999.                      02730000
               10  DL1-FILLER-2B         PIC  X(04).                    02740000
           05  DL1-GROUP-3 REDEFINES DL1-GROUP-1.                       02750000
               10  DL1-CLASS-3           PIC  999.                      02760000
               10  DL1-FILLER-3A         PIC  X(01).                    02770000
               10  DL1-SUBCLASS-3        PIC  99.                       02780000
               10  DL1-FILLER-3B         PIC  X(04).                    02790000
           05  DL1-GROUP-4 REDEFINES DL1-GROUP-1.                       02800000
               10  DL1-CLASS-4           PIC  999.                      02810000
               10  DL1-FILLER-4A         PIC  X(01).                    02820000
               10  DL1-SUBCLASS-4        PIC  999.                      02830000
               10  DL1-FILLER-4B         PIC  X(03).                    02840000
           05  DL1-SKU                   PIC  X(08)  VALUE SPACE.       02850000
           05  FILLER                    PIC  X(01)  VALUE SPACE.       02860000
           05  DL1-UPC                   PIC  X(16)  VALUE SPACE.       02870000
           05  FILLER                    PIC  X(03)  VALUE SPACE.       02880000
SR3403     05  DL1-PRICE                 PIC  ZZZZZ.99.                 02890000
           05  FILLER                    PIC  X(02)  VALUE SPACE.       02900000
           05  DL1-QTY                   PIC  ZZZ9.                     02910000
           05  FILLER                    PIC  X(02)  VALUE SPACE.       02920000
           05  DL1-DESCRIPTION           PIC  X(25)  VALUE SPACE.       02921000
           05  FILLER                    PIC  X(01)  VALUE SPACE.       02922000
           05  DL1-STYLE                 PIC  X(15)  VALUE SPACE.       02922100
           05  FILLER                    PIC  X(05)  VALUE SPACE.       02922200
           05  DL1-COLOR                 PIC  X(10)  VALUE SPACE.       02922300
           05  FILLER                    PIC  X(03)  VALUE SPACE.       02922400
           05  DL1-SIZE                  PIC  X(10)  VALUE SPACE.       02922500
           05  FILLER                    PIC  X(01)  VALUE SPACE.       02922600
           05  DL1-VENDOR-LABEL.                                        02922700
               10  FILLER                PIC  X(01)  VALUE SPACE.       02922800
               10  DL1-VENDOR            PIC  9(05)  VALUE ZEROS.       02922900
               10  FILLER                PIC  X(30)  VALUE SPACE.       02923000
                                                                        02924000
       01  DL1A-DETAIL-LINE-1A.                                         02925000
           05  DL1A-LINE-NBR             PIC  ZZ9.                      02926000
           05  FILLER                    PIC  X(03)  VALUE SPACE.       02927000
           05  DL1A-DESC1                PIC  X(20)  VALUE SPACE.       02928000
           05  DL1A-DESC2                PIC  X(20)  VALUE SPACE.       02929000
           05  FILLER                    PIC  X(03)  VALUE SPACE.       02930000
           05  DL1A-FIXTURE              PIC  X(20)  VALUE SPACE.       02940000
           05  FILLER                    PIC  X(03)  VALUE SPACE.       02950000
           05  DL1A-DEPT                 PIC  X(03)  VALUE SPACE.       02960000
           05  FILLER                    PIC  X(03)  VALUE SPACE.       02970000
           05  DL1A-QTY                  PIC  ZZZ9.                     02980000
      /                                                                 02990000
       01  EH1-ERROR-HEADING-1.                                         03000000
           05  EH1-RUN-DATE                PIC  X(08)  VALUE SPACES.    03010000
           05  FILLER                      PIC  X(02)  VALUE SPACES.    03020000
           05  EH1-RUN-TIME                PIC  X(08)  VALUE SPACES.    03030000
           05  FILLER                      PIC  X(10)  VALUE SPACES.    03040000
           05  FILLER                      PIC  X(45)  VALUE            03050000
               'KOHL''S TRANSFER DOCUMENT PRINT REQUEST ERROR'.         03060000
       01  EH2-ERROR-HEADING-2.                                         03070000
           05  FILLER                      PIC  X(28)  VALUE            03080000
               'PRINT REQUEST FOR DOCUMENT:'.                           03090000
           05  EH2-FROM-STORE-NBR          PIC  X(05).                  03100000
           05  FILLER                      PIC  X(01)  VALUE '-'.       03110000
           05  EH2-XFER-SEQ-NBR            PIC  X(06).                  03120000
           05  FILLER                      PIC  X(03)  VALUE SPACE.     03130000
           05  FILLER                      PIC  X(14)  VALUE            03140000
               'REQUESTED BY:'.                                         03150000
           05  EH2-USER-ID                 PIC  X(08)  VALUE SPACE.     03160000
           05  FILLER                      PIC  X(02)  VALUE SPACE.     03170000
           05  FILLER                      PIC  X(40)  VALUE            03180000
               'WAS CANCELLED FOR THE FOLLOWING REASON:'.               03190000
       01  ED1-ERROR-DETAIL-1.                                          03200000
           05  ED1-ERROR                   PIC  X(50)  VALUE SPACE.     03210000
           05  FILLER                      PIC  X(02)  VALUE SPACE.     03220000
           05  FILLER                      PIC  X(02)  VALUE SPACE.     03230000
           05  ED1-ERROR-KEY               PIC  X(25)  VALUE SPACE.     03240000
       01  ED2-ERROR-DETAIL-2.                                          03250000
           05  ED2-MESSAGE                 PIC  X(35)  VALUE SPACE.     03260000
       01  PC-PROGRAM-CONSTANTS.                                        03270000
           05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)  VALUE            03280000
               'TFKCS418'.                                              03290000
           05  PC-SORT1-DC                 PIC  X(08)                   03300000
                                           VALUE 'SORT1-DC'.            03310000
           05  PC-SORT2-RTV                PIC  X(09)                   03320000
                                           VALUE 'SORT2-RTV'.           03330000
           05  PC-RF-USERID                PIC  X(08)  VALUE 'RF GUN'.  03340000
           05  PC-3                        PIC S9(04)  VALUE +3         03350000
                                                       COMP SYNC.       03360000
           05  PC-099                      PIC  9(03)  VALUE 099.       03370000
           05  PC-100                      PIC  9(03)  VALUE 100.       03380000
           05  PC-MAX-DATE                 PIC X(10) VALUE '9999-09-09'.03390000
           05  PC-SECURE-TOTE              PIC  X(02)  VALUE '02'.      03400000
           05  PC-TRAILER                  PIC  X(02)  VALUE '04'.      03410000
           05  PC-HAND-CARRY               PIC  X(02)  VALUE '05'.      03420000
           05  PC-PRIMARY-NAME             PIC  X(02)  VALUE '01'.      03430000
           05  PC-YES                      PIC  X(01)  VALUE 'Y'.       03440000
           05  PC-PUT                      PIC  X(03)  VALUE 'PUT'.     03450000
           05  PC-INIT                     PIC  X(04)  VALUE 'INIT'.    03460000
           05  PC-TERM                     PIC  X(04)  VALUE 'TERM'.    03470000
           05  PC-OUTP                     PIC  X(04)  VALUE 'OUTP'.    03480000
           05  PC-PAGEDEF-FORMDEF          PIC  X(08)  VALUE 'KTR41A'.  03490000
           05  PC-TOP-OF-PAGE              PIC  X(01)  VALUE '1'.       03500000
           05  PC-SINGLE-SPACE             PIC  X(01)  VALUE ' '.       03510000
           05  PC-DOUBLE-SPACE             PIC  X(01)  VALUE '0'.       03520000
           05  PC-TRIPLE-SPACE             PIC  X(01)  VALUE '-'.       03530000
           05  PC-PAGE-MAX                 PIC S9(02)  VALUE +28        03540000
                                                          COMP-3.       03550000
           05  PC-VENDOR-DUNS-LITERAL      PIC  X(21)  VALUE            03560000
               ' DUNS #      VENDOR #'.                                 03570000
           05  PC-HAND-CARRY-LITERAL       PIC  X(20)  VALUE            03580000
               'HAND CARRY TRANSFER'.                                   03590000
           05  PC-TRAILER-LITERAL          PIC  X(17)  VALUE            03600000
               'TRAILER NUMBER.:'.                                      03610000
           05  PC-TRAILER-SEAL-LITERAL     PIC  X(17)  VALUE            03620000
               'TRAILER SEAL...:'.                                      03630000
           05  PC-TOTE-NUMBER-LITERAL      PIC  X(17)  VALUE            03640000
               'TOTE NUMBER....:'.                                      03650000
           05  PC-CUSTOMER-LITERAL         PIC  X(15)  VALUE            03660000
               'CUSTOMER:'.                                             03670000
           05  PC-WAREHOUSE-LITERAL        PIC  X(15)  VALUE            03680000
               'WAREHOUSE:'.                                            03690000
           05  PC-REQUESTED-BY-LITERAL     PIC  X(15)  VALUE            03700000
               'REQUESTED BY:'.                                         03710000
           05  PC-ATTENTION-TO-LITERAL     PIC  X(15)  VALUE            03720000
               'ATTENTION TO:'.                                         03730000
           05  PC-WAREHOUSE-NAME-LITERAL   PIC  X(15)  VALUE            03740000
               'WAREHOUSE NAME:'.                                       03750000
           05  PC-WAREHOUSE-PHON-LITERAL   PIC  X(15)  VALUE            03760000
               'WAREHOUSE PHON:'.                                       03770000
           05  PC-NO-INV-LITERAL           PIC  X(16)  VALUE            03780000
               '  NO  INVENTORY'.                                       03790000
           05  PC-BEFORE-INV-LITERAL       PIC  X(16)  VALUE            03800000
               'BEFORE INVENTORY'.                                      03810000
           05  PC-AFTER-INV-LITERAL        PIC  X(16)  VALUE            03820000
               'AFTER INVENTORY'.                                       03830000
                                                                        03840000
           05  PC-RETRIEVE-MSG                 PIC  X(28)  VALUE        03850000
               'CICS ERROR IN PASSING DATA. '.                          03860000
           05  PC-CONTENTION-MSG               PIC  X(36)  VALUE        03870000
               'SYSTEM IS BUSY.  PLEASE TRY AGAIN.'.                    03880000
           05  PC-GET-TRANSFER-MSG             PIC  X(33)  VALUE        03890000
               'ERROR READING THE TRANSFER MASTER'.                     03900000
           05  PC-GET-UCC128-DATA-MSG          PIC  X(27)  VALUE        03910000
               'INVALID UCC128 BARCODE DATA'.                           03920000
           05  PC-GET-STORE-MSG                PIC  X(29)  VALUE        03930000
               'ERROR READING THE STORE TABLE'.                         03940000
051705*    05  PC-GET-STORE-INV-MSG            PIC  X(21)  VALUE        03950000
051705*        'ERROR READING TINVPAR'.                                 03960000
           05  PC-CALENDAR-ERROR-MSG           PIC  X(25)  VALUE        03970000
               'ERROR IN CALENDAR ROUTINE'.                             03980000
           05  PC-GET-CUSTOMER-MSG             PIC  X(41)  VALUE        03990000
               'ERROR READING THE TRANSFER CUSTOMER TABLE'.             04000000
           05  PC-OPEN-RTL-CSR-MSG             PIC  X(35)  VALUE        04010000
               'ERROR OPENING THE RETAIL ITEM TABLE'.                   04020000
           05  PC-OPEN-NRTL-CSR-MSG            PIC  X(39)  VALUE        04030000
               'ERROR OPENING THE NON-RETAIL ITEM TABLE'.               04040000
           05  PC-CLOSE-RTL-CSR-MSG            PIC  X(35)  VALUE        04050000
               'ERROR CLOSING THE RETAIL ITEM TABLE'.                   04060000
           05  PC-CLOSE-NRTL-CSR-MSG           PIC  X(39)  VALUE        04070000
               'ERROR CLOSING THE NON-RETAIL ITEM TABLE'.               04080000
           05  PC-FETCH-RTL-CSR-MSG            PIC  X(35)  VALUE        04090000
               'ERROR READING THE RETAIL ITEM TABLE'.                   04100000
           05  PC-FETCH-NRTL-CSR-MSG           PIC  X(39)  VALUE        04110000
               'ERROR READING THE NON-RETAIL ITEM TABLE'.               04120000
           05  PC-READ-SKU-MSG                 PIC  X(27)  VALUE        04130000
               'ERROR READING THE SKU TABLE'.                           04140000
           05  PC-READ-TUPC-MSG                PIC  X(27)  VALUE        04150000
               'ERROR READING THE UPC TABLE'.                           04160000
           05  PC-READ-VNDS-MSG                PIC  X(36)  VALUE        04170000
               'ERROR READING THE VENDOR STYLE TABLE'.                  04180000
           05  PC-VENDOR-LABEL-MSG             PIC  X(30)  VALUE        04190000
               'ERROR READING THE VENDOR LABEL'.                        04200000
           05  PC-VENDOR-NAME-MSG              PIC  X(29)  VALUE        04210000
               'ERROR READING THE VENDOR NAME'.                         04220000
           05  PC-GET-TOTALS-MSG               PIC  X(35)  VALUE        04230000
               'ERROR READING TRANSFER ITEM TOTALS'.                    04240000
           05  PC-GET-COLOR-MSG                PIC  X(29)  VALUE        04250000
               'ERROR READING THE COLOR TABLE'.                         04260000
           05  PC-GET-SIZE-MSG                 PIC  X(28)  VALUE        04270000
               'ERROR READING THE SIZE TABLE'.                          04280000
           05  PC-DUNS-NUMBER-MSG              PIC  X(37)  VALUE        04290000
               'ERROR READING TEXTENT FOR DUNS NUMBER'.                 04300000
           05  PC-GET-CONTROL-MSG              PIC  X(36)  VALUE        04310000
               'ERROR READING TRANSFER CONTROL TABLE'.                  04320000
           05  PC-ABEND-MESSAGE                PIC  X(62)  VALUE        04330000
                '  ***** ABEND   ABEND   ABEND   ABEND   ABEND ***'.    04340000
                                                                        04350000
021605     COPY TFWS007.                                                04360000
021605     COPY TFWS008.                                                04370000
                                                                        04380000
       01  PV-PROGRAM-VARIABLES.                                        04390000
           05  PV-XFER-NBR.                                             04400000
               10  PV-XFER-FROM-STR-NBR    PIC 9(04).                   04410000
               10  PV-XFER-SEQ-NBR         PIC 9(06).                   04420000
           05  PV-XFER-TYPE-DESC           PIC X(40).                   04430000
           05  PV-POINTER                  PIC S9(03)  VALUE +0 COMP-3. 04431000
           05  PV-CHARACTER-COUNT          PIC S9(03)  VALUE +0 COMP-3. 04432000
           05  PV-APPROVAL.                                             04433000
               10                          PIC X(12)   VALUE            04434000
                   'APPROVAL #:'.                                       04435000
               10  PV-APPROVAL-NBR         PIC 9(09).                   04436000
           05  PV-CALLBACK.                                             04437000
               10                          PIC X(12)   VALUE            04438000
                   'CALLBACK #:'.                                       04439000
               10  PV-CALLBACK-NBR         PIC 9(04).                   04440000
           05  PV-COMP-DATE.                                            04450000
               10  PV-COMP-YEAR            PIC  X(04)  VALUE SPACE.     04460000
               10                          PIC  X(01)  VALUE SPACE.     04470000
               10  PV-COMP-MONTH           PIC  X(02)  VALUE SPACE.     04480000
               10                          PIC  X(01)  VALUE SPACE.     04490000
               10  PV-COMP-DAY             PIC  X(02)  VALUE SPACE.     04500000
           05  PV-HOLD-UPC-NBR.                                         04510000
               10  PV-KOHLS-UPC-DIGITS     PIC X(06).                   04520000
               10  PV-KOHLS-DUMMY-SKU.                                  04530000
                   20 PV-KOHLS-DEPT        PIC 9(03).                   04540000
                   20 PV-KOHLS-CL.                                      04550000
                       25 PV-KOHLS-CL-1    PIC X(01).                   04560000
                       25 PV-KOHLS-CL-2    PIC X(01).                   04570000
                   20 PV-KOHLS-CL-9 REDEFINES PV-KOHLS-CL               04580000
                                           PIC 9(02).                   04590000
                   20 PV-KOHLS-DUMMY-000   PIC X(03).                   04600000
               10  PV-KOHLS-DUMMY-SKU-N REDEFINES PV-KOHLS-DUMMY-SKU    04610000
                                           PIC 9(08).                   04620000
               10  PV-KOHLS-CHECKDIGIT     PIC X(01).                   04630000
           05  PV-HOLD-UPC-NBR-9 REDEFINES PV-HOLD-UPC-NBR              04640000
                                           PIC 9(15).                   04650000
           05  PV-UPC                         PIC 99B99999B99999B9.     04660000
           05  FILLER REDEFINES PV-UPC.                                 04670000
               10                             PIC XX.                   04680000
               10  PV-UPC-DASH-1              PIC X.                    04690000
               10                             PIC X(05).                04700000
               10  PV-UPC-DASH-2              PIC X.                    04710000
               10                             PIC X(05).                04720000
               10  PV-UPC-DASH-3              PIC X.                    04730000
               10                             PIC X.                    04740000
           05  PV-NAME.                                                 04750000
               10  PV-FIRST-INIT               PIC X.                   04760000
               10                              PIC X  VALUE SPACE.      04770000
               10  PV-LAST-NAME                PIC X(20).               04780000
               10  PV-PHONE                    PIC  X(10).              04790000
               10  FILLER REDEFINES PV-PHONE.                           04800000
                   20  PV-PHONE-AREA.                                   04810000
                       25  PV-PHONE-AREA-N     PIC  9(03).              04820000
                   20  PV-PHONE-EXCH.                                   04830000
                       25  PV-PHONE-EXCH-N     PIC  9(03).              04831000
                   20  PV-PHONE-NBR.                                    04832000
                       25  PV-PHONE-NBR-N      PIC  9(04).              04833000
           05  PV-LARGE-TOTE-SEALS.                                     04834000
               10  PV-LARGE-TOTE-SEAL1         PIC X(07).               04835000
               10                              PIC X  VALUE SPACE.      04836000
               10  PV-LARGE-TOTE-SEAL2         PIC X(07).               04837000
           05  PV-BARCODE-DATA.                                         04838000
               10  PV-BARCODE-XFER-NBR         PIC X(10).               04839000
               10  PV-BARCODE-CHECK-DIGIT      PIC X(01).               04840000
           05  PV-XFER-QTY              PIC S9(08)    VALUE +0 COMP-3.  04850000
           05  PV-XFER-PRICE            PIC S9(08)V99 VALUE +0 COMP-3.  04860000
           05  PV-XFER-QTY-IND          PIC S9(04)  VALUE +0            04870000
                                                    COMP SYNC.          04880000
           05  PV-XFER-PRICE-IND        PIC S9(04)  VALUE +0            04890000
                                                    COMP SYNC.          04900000
           05  PV-TOTAL-LINES                 PIC  S9(09)  VALUE +0     04910000
                                                           COMP.        04920000
           05  PV-TOTAL-PAGES                 PIC  S9(09)  VALUE +0     04930000
                                                           COMP.        04940000
           05  PV-LINE-COUNT                  PIC  S9(03)  VALUE +90.   04950000
           05  PV-PAGE-COUNT                  PIC  S9(03)  VALUE +0.    04960000
           05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  04970000
                                                           COMP SYNC.   04980000
           05  PV-ABSTIME                      PIC S9(16)  VALUE +0     04990000
                                                           COMP SYNC.   05000000
           05  PV-NULL-IND                    PIC S9(04)  VALUE +0      05010000
                                                    COMP SYNC.          05020000
           05  PV-ERROR-MSG                    PIC  X(50) VALUE SPACE.  05030000
           05  PV-ERROR-KEY                    PIC  X(25)  VALUE SPACE. 05040000
051705*    05  PV-BEFORE-INV-START             PIC  X(10)  VALUE SPACE. 05050000
051705*    05  PV-PHY-INV-PERD-IND             PIC  X(01)  VALUE SPACE. 05060000
051705*    05  PV-MAX-FINCL-BK-DTE             PIC  X(10)  VALUE SPACE. 05070000
051705*    05  PV-STR-PLND-INV-DTE             PIC  X(10)  VALUE SPACE. 05080000
051705*    05  PV-FR-STR-INV-DTE               PIC X(10)   VALUE SPACE. 05090000
051705*    05  PV-TO-STR-INV-DTE               PIC X(10)   VALUE SPACE. 05100000
051705*    05  PV-XFER-INV-CTOFF-DTE           PIC  X(10)  VALUE SPACE. 05110000
051705*    05  PV-HOLD-INVENTORY-IND           PIC X(01)   VALUE 'N'.   05120000
051705*        88  PV-HOLD-PHYSICAL-COUNT                  VALUE 'Y'.   05130000
051705*        88  PV-HOLD-FAKE-INVENTORY                  VALUE 'F'.   05140000
051705*        88  PV-HOLD-NO-INVENTORY                    VALUE 'N'.   05150000
051705*    05  PV-FR-INVENTORY-IND             PIC X(01)   VALUE 'N'.   05160000
051705*        88  PV-FR-PHYSICAL-COUNT                    VALUE 'Y'.   05170000
051705*        88  PV-FR-FAKE-INVENTORY                    VALUE 'F'.   05180000
051705*        88  PV-FR-NO-INVENTORY                      VALUE 'N'.   05190000
051705*    05  PV-TO-INVENTORY-IND             PIC X(01)   VALUE 'N'.   05200000
051705*        88  PV-TO-PHYSICAL-COUNT                    VALUE 'Y'.   05210000
051705*        88  PV-TO-FAKE-INVENTORY                    VALUE 'F'.   05220000
051705*        88  PV-TO-NO-INVENTORY                      VALUE 'N'.   05230000
SR3403     05  PV-CICS-APPL-ID.                                         05240000
SR3403         10  FILLER                      PIC X(04).               05250000
SR3403         10  PV-CICS-REGION-ENVIRONMENT  PIC X.                   05260000
SR3403             88  PV-CR-PRODUCTION                    VALUE 'P'.   05270000
SR3403         10  PV-FILLER                   PIC X(03).               05271000
SR3403*                                                                 05272000
           05  PV-DRS-ABEND-DISPLAY-LINE1.                              05273000
               10  FILLER                      PIC  X(14)  VALUE        05274000
                   'DRRB ID = DRRB'.                                    05275000
               10  FILLER                      PIC  X(02)  VALUE SPACE. 05276000
               10  FILLER                      PIC  X(12)  VALUE        05277000
                   'DRRB FUNC = '.                                      05278000
               10  PV-DRS-DRRB-FUNC            PIC  X(04)  VALUE SPACE. 05279000
               10  FILLER                      PIC  X(02)  VALUE SPACE. 05280000
               10  FILLER                      PIC  X(11)  VALUE        05290000
                   'DRRB RID = '.                                       05300000
               10  PV-DRS-DRRB-RID             PIC  X(08)  VALUE SPACE. 05310000
               10  FILLER                      PIC  X(02)  VALUE SPACE. 05320000
               10  FILLER                      PIC  X(15)  VALUE        05330000
                   'DRRB OPTIONS = '.                                   05340000
               10  PV-DRS-DRRB-OPTIONS         PIC  X(08)  VALUE SPACE. 05350000
                                                                        05360000
           05  PV-DRS-ABEND-DISPLAY-LINE.                               05370000
               10  FILLER                      PIC  X(10)  VALUE        05380000
                   'DRRB RC = '.                                        05390000
               10  PV-DRS-DRRB-RC              PIC  9(04)  VALUE ZERO.  05400000
               10  FILLER                      PIC  X(02)  VALUE SPACE. 05410000
               10  FILLER                      PIC  X(18)  VALUE        05420000
                   'DRRB ATTR-ERROR = '.                                05430000
               10  PV-DRS-ATTR-ERROR           PIC  9(02)  VALUE ZERO.  05440000
               10  FILLER                      PIC  X(02)  VALUE SPACE. 05450000
               10  FILLER                      PIC  X(12)  VALUE        05460000
                   'DRRB DRDC = '.                                      05470000
               10  PV-DRS-DRRB-DRDC            PIC  9(04)  VALUE ZERO.  05480000
               10  FILLER                      PIC  X(02)  VALUE SPACE. 05490000
               10  FILLER                      PIC  X(13)  VALUE        05500000
                   'DRRB LINES = '.                                     05510000
               10  PV-DRS-DRRB-LINES           PIC  9(04)  VALUE ZERO.  05520000
                                                                        05530000
           05  PV-DISPLAY-KEYS.                                         05540000
               10  PV-DISPLAY-USER-ID          PIC  X(08)  VALUE SPACE. 05550000
               10  FILLER                      PIC  X(02)  VALUE SPACE. 05560000
               10  PV-DISPLAY-XFER-FROM-STORE-NBR                       05570000
                                               PIC  X(05)  VALUE SPACE. 05580000
               10  FILLER                      PIC  X(01)  VALUE '-'.   05590000
               10  PV-DISPLAY-XFER-SEQ-NBR     PIC  X(06)  VALUE SPACE. 05600000
               10  FILLER                      PIC  X(02)  VALUE SPACE. 05610000
               10  PV-DISPLAY-PRINTER-DEST     PIC  X(08)  VALUE SPACE. 05620000
                                                                        05630000
       01  PVE-PROGRAM-VARIABLE-ERRORS.                                 05640000
           05  PVE-STORE-ERROR.                                         05650000
               10  FILLER                      PIC X(09)   VALUE        05660000
                   'STORE ='.                                           05670000
               10  PVE-STORE                   PIC ZZ999.               05680000
           05  PVE-SKU-ERROR.                                           05690000
               10  FILLER                      PIC X(06)   VALUE        05700000
                   'SKU ='.                                             05710000
               10  PVE-SKU                     PIC X(08).               05720000
           05  PVE-UPC-ERROR.                                           05730000
               10  FILLER                      PIC X(06)   VALUE        05740000
                   'UPC ='.                                             05750000
               10  PVE-UPC                     PIC 9(15).               05760000
           05  PVE-COLOR-ERROR.                                         05770000
               10  FILLER                      PIC X(08)   VALUE        05780000
                   'COLOR ='.                                           05790000
               10  PVE-COLOR                   PIC X(03).               05800000
           05  PVE-SIZE-ERROR.                                          05810000
               10  FILLER                      PIC X(08)   VALUE        05820000
                   'SIZE ='.                                            05830000
               10  PVE-SIZE.                                            05840000
                   15  PVE-KOHLS-SIZE          PIC 9(05).               05850000
           05  PVE-VENDOR-ERROR.                                        05860000
               10  FILLER                      PIC X(09)   VALUE        05870000
                   'VENDOR ='.                                          05880000
               10  PVE-VENDOR                  PIC 9(05).               05890000
                                                                        05900000
       01  PS-PROGRAM-SWITCHES.                                         05910000
           05  PS-DRS-INITIALIZED-SW           PIC  X      VALUE 'N'.   05920000
               88  PS-DRS-INITIALIZED                      VALUE 'Y'.   05930000
               88  PS-DRS-NOT-INITIALIZED                  VALUE 'N'.   05940000
           05  PS-ITEMS-LEFT-INDICATOR         PIC  X(01)  VALUE 'Y'.   05950000
               88  PS-ITEMS-LEFT-ON-DB                     VALUE 'Y'.   05960000
               88  PS-NO-ITEMS-LEFT-ON-DB                  VALUE 'N'.   05970000
           05  PS-HAND-CARRY-SW                PIC  X(01)  VALUE 'N'.   05980000
               88  PS-HAND-CARRY                           VALUE 'Y'.   05990000
               88  PS-NO-HAND-CARRY                        VALUE 'N'.   06000000
051705*    05  PS-INVENTORY-SW                 PIC  X(01)  VALUE 'N'.   06010000
051705*        88  PS-INVENTORY                            VALUE 'I'.   06020000
051705*        88  PS-NO-INVENTORY                         VALUE 'N'.   06030000
           05  PS-ERROR-SW                     PIC  X(01)  VALUE 'N'.   06040000
               88  PS-ERROR                                VALUE 'Y'.   06050000
               88  PS-NO-ERROR                             VALUE 'N'.   06060000
           05  PS-CONTENTION-SW                PIC  X(01)  VALUE 'N'.   06070000
               88  PS-CONTENTION                           VALUE 'Y'.   06080000
                                                                        06090000
       01  PRV-PROGRAM-RETURN-VARIABLES.                                06100000
           05  PRV-01                       PIC X(42) VALUE             06110000
               '01-ERROR - RETRIEVE COMMAREA DATA.       '.             06120000
           05  PRV-02                       PIC X(42) VALUE             06130000
               '02-DB2 ERROR READING TRANSFER MASTER     '.             06140000
           05  PRV-03                       PIC X(42) VALUE             06150000
               '03-DB2 ERROR READING STORE TABLE         '.             06160000
           05  PRV-04                       PIC X(42) VALUE             06170000
               '04-DB2 ERROR READING TRANSFER CUSTOMER   '.             06180000
           05  PRV-05                       PIC X(42) VALUE             06190000
               '05-DB2 ERROR OPENING RETAIL ITEM CURSOR  '.             06200000
           05  PRV-06                       PIC X(42) VALUE             06210000
               '06-DB2 ERROR CLOSING RETAIL ITEM CURSOR  '.             06220000
           05  PRV-07                       PIC X(42) VALUE             06230000
               '07-DB2 ERROR FETCHING RETAIL ITEM CURSOR '.             06240000
           05  PRV-08                       PIC X(42) VALUE             06250000
               '08-DB2 ERROR OPENING NON-RETAIL CURSOR   '.             06260000
           05  PRV-09                       PIC X(42) VALUE             06270000
               '09-DB2 ERROR CLOSING NON-RETAIL CURSOR   '.             06280000
           05  PRV-10                       PIC X(42) VALUE             06290000
               '10-DB2 ERROR FETCHING NON-RETAIL CURSOR  '.             06300000
           05  PRV-11                       PIC X(42) VALUE             06310000
               '11-DB2 ERROR READING SKU TABLE           '.             06320000
           05  PRV-12                       PIC X(42) VALUE             06330000
               '12-DB2 ERROR READING VENDOR LABEL        '.             06340000
           05  PRV-13                       PIC X(42) VALUE             06350000
               '13-DB2 ERROR READING VENDOR NAME         '.             06360000
           05  PRV-14                       PIC X(42) VALUE             06370000
               '14-DRS ERROR                             '.             06380000
           05  PRV-15                       PIC X(42) VALUE             06390000
               '15-DB2 ERROR READING COLOR TABLE         '.             06400000
           05  PRV-16                       PIC X(42) VALUE             06410000
               '16-DB2 ERROR READING SIZE TABLE          '.             06420000
           05  PRV-17                       PIC X(42) VALUE             06430000
               '17-DB2 ERROR READING TEXTENT TABLE       '.             06440000
           05  PRV-18                       PIC X(42) VALUE             06450000
               '18-DB2 ERROR READING TFITEM - TOTALS     '.             06460000
           05  PRV-19                       PIC X(42) VALUE             06470000
               '19-DB2 ERROR READING UPC TABLE - TUPC    '.             06480000
           05  PRV-20                       PIC X(42) VALUE             06490000
               '20-DB2 ERROR READING VENDOR STYLE        '.             06500000
           05  PRV-21                       PIC X(42) VALUE             06510000
               '21-DB2 ERROR READING INVENTORY PARAMETERS'.             06520000
           05  PRV-22                       PIC X(44) VALUE             06530000
               '22-CALENDAR ROUTINE ERROR - INVENTORY DATES'.           06540000
051705*    05  PRV-23                       PIC X(42) VALUE             06550000
051705*        '23-DB2 ERROR READING TTFCNTL             '.             06560000
      *---------------------------------------------------------------* 06570000
      *    DB2 AREA FOR TFFMSTR(TRANSFER TABLE)                         06580000
      *---------------------------------------------------------------* 06590000
           EXEC SQL                                                     06600000
                INCLUDE TTFMSTR                                         06610000
           END-EXEC.                                                    06620000
      *---------------------------------------------------------------* 06630000
      *    DB2 AREA FOR TTFITEM (TRANSFER ITEM TABLE)                   06640000
      *---------------------------------------------------------------* 06650000
           EXEC SQL                                                     06660000
                INCLUDE TTFITEM                                         06670000
           END-EXEC.                                                    06680000
      *---------------------------------------------------------------* 06690000
      *    DB2 AREA FOR TTFTYCD  (TRANSFER TYPE TABLE)                  06700000
      *---------------------------------------------------------------* 06710000
           EXEC SQL                                                     06720000
                INCLUDE TTFTYCD                                         06730000
           END-EXEC.                                                    06740000
      *---------------------------------------------------------------* 06750000
      *    DB2 AREA FOR TTFCUST  (TRANSFER CUSTOMER TABLE)              06760000
      *---------------------------------------------------------------* 06770000
           EXEC SQL                                                     06780000
                INCLUDE TTFCUST                                         06790000
           END-EXEC.                                                    06800000
      *---------------------------------------------------------------* 06810000
      *    DB2 AREA FOR TTFSHCT  (CONTAINER CODE TABLE)                 06820000
      *---------------------------------------------------------------* 06830000
           EXEC SQL                                                     06840000
                INCLUDE TTFSHCT                                         06850000
           END-EXEC.                                                    06860000
      *---------------------------------------------------------------* 06870000
      *    DB2 AREA FOR XS DOMAIN TABLES                              * 06880000
      *---------------------------------------------------------------* 06890000
           EXEC SQL                                                     06900000
                INCLUDE XST00001                                        06910000
           END-EXEC.                                                    06920000
           EXEC SQL                                                     06930000
                INCLUDE XST00010                                        06940000
           END-EXEC.                                                    06950000
           EXEC SQL                                                     06960000
                INCLUDE XST00012                                        06970000
           END-EXEC.                                                    06980000
           EXEC SQL                                                     06990000
                INCLUDE XST00013                                        07000000
           END-EXEC.                                                    07010000
           EXEC SQL                                                     07020000
                INCLUDE XST00018                                        07030000
           END-EXEC.                                                    07040000
051705*---------------------------------------------------------------* 07050000
051705*    DB2 AREA FOR TTFCNTL                                       * 07060000
051705*---------------------------------------------------------------* 07070000
051705*    EXEC SQL                                                     07080000
051705*         INCLUDE TTFCNTL                                         07090000
051705*    END-EXEC.                                                    07100000
051705*---------------------------------------------------------------* 07110000
051705*    DB2 AREA FOR TINVPAR                                       * 07120000
051705*---------------------------------------------------------------* 07130000
051705*    EXEC SQL                                                     07140000
051705*         INCLUDE TINVPAR                                         07150000
051705*    END-EXEC.                                                    07160000
      *                                                                 07170000
      *  COMMUNICATIONS AREA FOR DB2                                    07180000
      *                                                                 07190000
           EXEC SQL                                                     07200000
               INCLUDE SQLCA                                            07210000
           END-EXEC.                                                    07220000
      *---------------------------------------------------------------* 07230000
      *    CURSOR TO GET TRANSFER ITEMS FOR A RETAIL TRANSFER.        * 07240000
      *---------------------------------------------------------------* 07250000
                                                                        07260000
           EXEC SQL                                                     07270000
                DECLARE RTL-ITEM-CSR CURSOR                             07280000
                FOR SELECT                                              07290000
                      XFER_LNE_NBR                                      07300000
                     ,KOHLS_UPC_NBR                                     07310000
                     ,XFER_PRIC_AMT                                     07320000
                     ,XFER_QTY                                          07330000
                     ,ITM_NBR                                           07340000
                FROM  TTFITEM                                           07350000
               WHERE  XFER_DKEY_ID   = :DK-XFER-DKEY-ID  AND            07360000
                      XFER_QTY       > 0.                               07370000
               ORDER BY  XFER_LNE_NBR                                   07380000
                WITH UR                                                 07390000
           END-EXEC.                                                    07400000
                                                                        07410000
      *---------------------------------------------------------------* 07420000
      *    CURSOR TO GET TRANSFER ITEMS FOR A NON-RETAIL TRANSFER.    * 07430000
      *---------------------------------------------------------------* 07440000
                                                                        07450000
           EXEC SQL                                                     07460000
                DECLARE NRTL-ITEM-CSR CURSOR                            07470000
                FOR SELECT                                              07480000
                      XFER_LNE_NBR                                      07490000
                     ,NRTL_1ST_LNE_DESC                                 07500000
                     ,NRTL_2ND_LNE_DESC                                 07510000
                     ,NRTL_FIXT_ID                                      07520000
                     ,NRTL_DEPT_NBR                                     07530000
                     ,XFER_QTY                                          07540000
                FROM  TTFITEM                                           07550000
               WHERE  XFER_DKEY_ID   = :DK-XFER-DKEY-ID   AND           07560000
                      XFER_QTY       > 0.                               07570000
               ORDER BY  XFER_LNE_NBR                                   07580000
                WITH UR                                                 07590000
           END-EXEC.                                                    07600000
                                                                        07610000
      ******************************************************************07620000
       LINKAGE SECTION.                                                 07630000
      ******************************************************************07640000
       01  DFHCOMMAREA.                                                 07650000
           05  FILLER                         OCCURS  1 TO 100 TIMES    07660000
                                              DEPENDING ON EIBCALEN.    07670000
               10  FILLER                     PIC X.                    07680000
                                                                        07690000
                                                                        07700000
      ******************************************************************07710000
       PROCEDURE DIVISION.                                              07720000
      ******************************************************************07730000
       0000-PROGRAM-MAINLINE.                                           07740000
                                                                        07750000
           SET PS-NO-ERROR         TO TRUE.                             07760000
           PERFORM 8100-FORMAT-TIME.                                    07770000
           PERFORM 0100-RETRIEVE-STORED-DATA.                           07780000
           PERFORM 0200-MAIN-PROCESS.                                   07790000
                                                                        07800000
           MOVE PC-TERM            TO DRS01-DRRB-FUNC.                  07810000
           PERFORM 8000-LINK-TO-DRS.                                    07820000
                                                                        07830000
           GOBACK.                                                      07840000
                                                                        07850000
                                                                        07860000
       0100-RETRIEVE-STORED-DATA.                                       07870000
                                                                        07880000
           EXEC CICS                                                    07890000
               RETRIEVE                                                 07900000
                   INTO  (TF005-COMMAREA)                               07910000
                   RESP  (PV-CICS-RESPONSE)                             07920000
           END-EXEC.                                                    07930000
                                                                        07940000
           EVALUATE TRUE                                                07950000
               WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 07960000
                   CONTINUE                                             07970000
               WHEN OTHER                                               07980000
                   SET PS-ERROR    TO TRUE                              07990000
                   MOVE PC-RETRIEVE-MSG                                 08000000
                                   TO PV-ERROR-MSG                      08010000
                   MOVE '0100-RETRIEVE-STORED-DATA'                     08020000
                                   TO DP013-PARAGRAPH                   08030000
                   MOVE PRV-01     TO DP013-MESSAGE-TEXT (1)            08040000
                   PERFORM 9000-RETURN-MSG                              08050000
                   MOVE PV-DISPLAY-KEYS                                 08060000
                                   TO DP013-MESSAGE-TEXT (2)            08070000
                   SET DP013-LINK-RETURN                                08080000
                       DP013-CICS-ABEND                                 08090000
                       DP013-NO-ROLLBACK                                08100000
                                   TO TRUE                              08110000
                   PERFORM DP014-0000-PROCESS-ABEND                     08120000
           END-EVALUATE.                                                08130000
           MOVE TF005-XFER-FROM-STORE-NBR                               08140000
                                   TO DK-FROM-STORE-NBR                 08150000
021605                                TF008-XFER-FROM-STORE-NBR         08160000
                                      HL1-FROM-STORE-NBR                08170000
                                      PV-XFER-FROM-STR-NBR.             08180000
           MOVE TF005-XFER-SEQ-NBR TO DK-XFER-SEQ-NBR                   08190000
021605                                TF008-XFER-SEQ-NBR                08200000
                                      HL1-XFER-SEQ-NBR                  08210000
                                      PV-XFER-SEQ-NBR.                  08220000
           MOVE PV-XFER-NBR        TO PV-BARCODE-XFER-NBR.              08230000
SR3403     EXEC CICS                                                    08240000
SR3403     ASSIGN                                                       08250000
SR3403     APPLID (PV-CICS-APPL-ID)                                     08260000
SR3403     END-EXEC.                                                    08270000
SR3403                                                                  08280000
SR3403     EVALUATE TRUE                                                08290000
SR3403         WHEN PV-CR-PRODUCTION                                    08300000
SR3403             CONTINUE                                             08301000
SR3403         WHEN OTHER                                               08302000
SR3403             MOVE 'U4106' TO  TF005-PRINTER-DEST                  08303000
SR3403     END-EVALUATE.                                                08304000
      ** COMMENT OUT THE FOLLOWING STATEMENT FOR PRODUCTION CODE        08305000
021605**   MOVE 'U4002'            TO TF005-PRINTER-DEST.               08306000
                                                                        08307000
      ******************************************************************08308000
       0200-MAIN-PROCESS.                                               08309000
                                                                        08310000
           IF PS-NO-ERROR                                               08320000
               PERFORM TFPD008-GET-CHK-DIGIT                            08330000
021605         MOVE TF008-CHK-DIGIT                                     08340000
                                   TO HL1-CHK-DIGIT                     08350000
                                      PV-BARCODE-CHECK-DIGIT            08360000
               PERFORM 0350-GET-BARCODE-DATA                            08370000
           END-IF.                                                      08380000
                                                                        08390000
           IF PS-NO-ERROR                                               08400000
               PERFORM 1000-GET-TRANSFER                                08410000
           END-IF.                                                      08420000
                                                                        08430000
           IF PS-NO-ERROR                                               08440000
               PERFORM 0400-INIT-PRINTER-FOR-DOCUMENT                   08450000
           END-IF.                                                      08460000
                                                                        08470000
           IF PS-NO-ERROR                                               08480000
021605         IF TFMSTR-XFER-TYP-CDE NOT = TF007-NON-RETAIL            08490000
                   PERFORM 4000-OPEN-RTL-CURSOR                         08500000
                   IF PS-NO-ERROR                                       08510000
                       PERFORM 4010-READ-RTL-ITEMS-FROM-DB              08520000
                       PERFORM 4020-CLOSE-RTL-CURSOR                    08530000
                   END-IF                                               08540000
      *  PRINT A SECOND COPY OF THE DOCUMENT FOR OFFSITE STORAGE        08550000
      *  BUT ONLY IF THE REQUEST IS FROM THE PTC (USER ID WILL BE BLANK)08560000
021605             IF TFMSTR-XFER-TYP-CDE = TF007-OFFSITE-STORAGE AND   08570000
                      TF005-USER-ID NOT > SPACES                        08580000
                       MOVE +0     TO PV-PAGE-COUNT                     08590000
                       MOVE +90    TO PV-LINE-COUNT                     08600000
                       PERFORM 4000-OPEN-RTL-CURSOR                     08610000
                       IF PS-NO-ERROR                                   08620000
                           PERFORM 4010-READ-RTL-ITEMS-FROM-DB          08630000
                           PERFORM 4020-CLOSE-RTL-CURSOR                08640000
                       END-IF                                           08650000
                   END-IF                                               08660000
               ELSE                                                     08670000
                   PERFORM 4100-OPEN-NRTL-CURSOR                        08680000
                   IF PS-NO-ERROR                                       08690000
                       PERFORM 4110-READ-NRTL-ITEMS-FROM-DB             08700000
                       PERFORM 4120-CLOSE-NRTL-CURSOR                   08710000
                   END-IF                                               08720000
               END-IF                                                   08730000
           END-IF.                                                      08740000
                                                                        08750000
      *----------------------------------------------------------------*08760000
      * IF THERE WAS AN ERROR ENCOUNTERED, TERMINATE DRS AND DELETE ANY 08770000
      * PORTION OF THE DOCUMENT THAT MAY HAVE ALREADY BEEN PRINTED;     08780000
      * THEN INITIALIZE DRS FOR AN ERROR REPORT.                        08790000
      *----------------------------------------------------------------*08800000
           IF PS-ERROR                                                  08810000
               IF PS-DRS-INITIALIZED                                    08820000
                   MOVE 'D'        TO DRS07-DRTB-DISP (1)               08830000
                   MOVE +1         TO DRS07-DRTB-ATTR-INDX (1)          08840000
                   MOVE PC-TERM    TO DRS01-DRRB-FUNC                   08850000
                   MOVE DRS07-DRTB-TERM-BLOCK                           08860000
                                   TO DRS01-COMM-DRIB                   08870000
                   PERFORM 8000-LINK-TO-DRS                             08880000
               END-IF                                                   08890000
               PERFORM 0500-INIT-PRINTER-FOR-ERROR                      08900000
               IF PS-DRS-INITIALIZED                                    08910000
                   PERFORM 9100-PRINT-ERROR                             08920000
               END-IF                                                   08930000
           END-IF.                                                      08940000
           COPY TFPD008.                                                08950000
      *----------------------------------------------------------------*08960000
      * CALCULATE THE CHECK DIGIT FOR THE TRANSFER NUMBER.              08970000
      *----------------------------------------------------------------*08980000
       0350-GET-BARCODE-DATA.                                           08990000
           INITIALIZE TF100-PARAMETERS.                                 09000000
           MOVE 11                 TO TF100-NUMBER-OF-CHARACTERS.       09010000
           SET TF100-SET-A         TO TRUE.                             09020000
           MOVE PV-BARCODE-DATA    TO TF100-PASSED-DATA.                09030000
           CALL 'TFKUT100'               USING TF100-PARAMETERS.        09040000
           IF TF100-SUCCESSFUL                                          09050000
               MOVE TF100-RETURNED-DATA                                 09060000
                                   TO HL1-BARCODE-DATA                  09070000
           ELSE                                                         09080000
               SET PS-ERROR        TO TRUE                              09090000
               MOVE PC-GET-UCC128-DATA-MSG                              09100000
                                   TO PV-ERROR-MSG                      09110000
               PERFORM 9000-RETURN-MSG                                  09120000
           END-IF.                                                      09130000
      *----------------------------------------------------------------*09140000
      * INITIALIZE THE PRINTER FOR THE TRANSFER DOCUMENT.               09150000
      *----------------------------------------------------------------*09160000
       0400-INIT-PRINTER-FOR-DOCUMENT.                                  09170000
           MOVE PC-OUTP            TO DRS05-DRRB-FUNC.                  09180000
           MOVE 'ADD'              TO DRS05-DROB-FUNCTION.              09190000
           MOVE 'XFERDROB'         TO DRS05-DROB-OUTPUT-ID.             09200000
           MOVE PC-PAGEDEF-FORMDEF TO DRS05-DROB-FORMDEF                09210000
                                          DRS05-DROB-PAGEDEF.           09220000
           MOVE 'A'                TO DRS05-DROB-CLASS.                 09230000
           IF TF005-PRINTER-DEST = 'XXXX'                               09240000
               MOVE 'R'            TO DRS06-DRIB-CLASS                  09250000
               MOVE 'N'            TO DRS06-DRIB-HOLD                   09260000
               MOVE 'LOCAL'        TO DRS06-DRIB-DEST                   09270000
                                      DRS05-DROB-DESTINATION            09280000
           ELSE                                                         09290000
               MOVE 'A'            TO DRS06-DRIB-CLASS                  09300000
               MOVE 'N'            TO DRS06-DRIB-HOLD                   09310000
               MOVE TF005-PRINTER-DEST                                  09320000
                                   TO DRS06-DRIB-DEST                   09330000
                                      DRS05-DROB-DESTINATION            09340000
           END-IF.                                                      09350000
                                                                        09360000
           PERFORM 8050-LINK-TO-DRS.                                    09370000
                                                                        09380000
           MOVE 'XFERDROB'         TO DRS06-DRIB-OUTPUT-STMT-NAME.      09390000
           MOVE 'Y'                TO DRS06-DRIB-EXTN-IND.              09400000
                                                                        09410000
           MOVE PC-INIT            TO DRS01-DRRB-FUNC.                  09420000
           MOVE DRS06-DRIB-HEADER  TO DRS01-COMM-DRIB-HDR.              09430000
           MOVE DRS06-DRIB-ATTRIB  TO DRS01-COMM-DRIB-AT1.              09440000
           PERFORM 8000-LINK-TO-DRS.                                    09450000
                                                                        09460000
           IF DRS01-DRRB-RC = ZERO                                      09470000
               SET PS-DRS-INITIALIZED                                   09480000
                                   TO TRUE                              09490000
           END-IF.                                                      09500000
           MOVE PC-PUT             TO  DRS01-DRRB-FUNC.                 09510000
                                                                        09520000
      *----------------------------------------------------------------*09530000
      * INITIALIZE THE PRINTER FOR THE ERROR REPORT.                    09540000
      *----------------------------------------------------------------*09550000
       0500-INIT-PRINTER-FOR-ERROR.                                     09560000
                                                                        09570000
           IF TF005-PRINTER-DEST = 'XXXX'                               09580000
               MOVE 'R'            TO DRS06-DRIB-CLASS                  09590000
               MOVE 'N'            TO DRS06-DRIB-HOLD                   09600000
               MOVE 'LOCAL'        TO DRS06-DRIB-DEST                   09610000
           ELSE                                                         09620000
               MOVE 'A'            TO DRS06-DRIB-CLASS                  09630000
               MOVE 'N'            TO DRS06-DRIB-HOLD                   09640000
               MOVE TF005-PRINTER-DEST                                  09650000
                                   TO DRS06-DRIB-DEST                   09660000
           END-IF.                                                      09670000
                                                                        09680000
           MOVE SPACE              TO DRS06-DRIB-OUTPUT-STMT-NAME.      09690000
           MOVE 'N'                TO DRS06-DRIB-EXTN-IND.              09700000
                                                                        09710000
           MOVE PC-INIT            TO DRS01-DRRB-FUNC.                  09720000
           MOVE DRS06-DRIB-HEADER  TO DRS01-COMM-DRIB-HDR.              09730000
           MOVE DRS06-DRIB-ATTRIB  TO DRS01-COMM-DRIB-AT1.              09740000
                                                                        09750000
           PERFORM 8000-LINK-TO-DRS.                                    09760000
                                                                        09770000
           IF DRS01-DRRB-RC = ZERO                                      09780000
               SET PS-DRS-INITIALIZED                                   09790000
                                   TO TRUE                              09800000
           END-IF.                                                      09810000
           MOVE PC-PUT             TO  DRS01-DRRB-FUNC.                 09820000
                                                                        09830000
      /                                                                 09840000
      *----------------------------------------------------------------*09850000
      * SELECT DATA FROM THE TRANSFER TABLES                            09860000
      *----------------------------------------------------------------*09870000
       1000-GET-TRANSFER.                                               09880000
      *                                                                 09890000
           EXEC SQL                                                     09900000
               SELECT X.XFER_DKEY_ID                                    09910000
                     ,X.XFER_TYP_CDE                                    09920000
                     ,X.CONTNR_TYP_CDE                                  09930000
                     ,X.FR_STR_NBR                                      09940000
                     ,X.TO_STR_NBR                                      09950000
                     ,X.CMPT_XFER_END_TMST                              09960000
                     ,X.CPLD_INIT_1ST_NM                                09970000
                     ,X.CPLD_LAST_NM                                    09980000
                     ,X.LG_TTE_1ST_SEAL_ID                              09990000
                     ,X.LG_TTE_2ND_SEAL_ID                              10000000
                     ,X.SM_TTE_BAG_SEAL_ID                              10010000
                     ,X.TRLR_NBR                                        10020000
                     ,X.TRLR_SEAL_ID                                    10030000
                     ,X.CLBK_NBR                                        10040000
                     ,X.STK_BAL_APVL_NBR                                10050000
                     ,X.RQSTR_INIT_1ST_NM                               10060000
                     ,X.RQSTR_LAST_NM                                   10070000
                     ,X.ATTN_INIT_1ST_NM                                10080000
                     ,X.ATTN_LAST_NM                                    10090000
                     ,CT.CONTNR_TYP_DESC                                10100000
                     ,XT.TYP_1ST_LNE_DESC                               10110000
                     ,XT.TYP_2ND_LNE_DESC                               10120000
               INTO   :TFMSTR-XFER-DKEY-ID                              10130000
                     ,:TFMSTR-XFER-TYP-CDE                              10140000
                     ,:TFMSTR-CONTNR-TYP-CDE                            10150000
                     ,:TFMSTR-FR-STR-NBR                                10160000
                     ,:TFMSTR-TO-STR-NBR                                10170000
                     ,:TFMSTR-CMPT-XFER-END-TMST                        10180000
                     ,:TFMSTR-CPLD-INIT-1ST-NM                          10190000
                     ,:TFMSTR-CPLD-LAST-NM                              10200000
                     ,:TFMSTR-LG-TTE-1ST-SEAL-ID                        10210000
                     ,:TFMSTR-LG-TTE-2ND-SEAL-ID                        10220000
                     ,:TFMSTR-SM-TTE-BAG-SEAL-ID                        10230000
                     ,:TFMSTR-TRLR-NBR                                  10240000
                     ,:TFMSTR-TRLR-SEAL-ID                              10250000
                     ,:TFMSTR-CLBK-NBR                                  10260000
                     ,:TFMSTR-STK-BAL-APVL-NBR                          10270000
                     ,:TFMSTR-RQSTR-INIT-1ST-NM                         10280000
                     ,:TFMSTR-RQSTR-LAST-NM                             10290000
                     ,:TFMSTR-ATTN-INIT-1ST-NM                          10300000
                     ,:TFMSTR-ATTN-LAST-NM                              10310000
                     ,:TFSHCT-CONTNR-TYP-DESC                           10320000
                     ,:TFTYCD-TYP-1ST-LNE-DESC                          10330000
                     ,:TFTYCD-TYP-2ND-LNE-DESC                          10340000
               FROM   TTFMSTR X                                         10350000
                     ,TTFSHCT CT                                        10360000
                     ,TTFTYCD XT                                        10370000
               WHERE  X.XFER_SEQ_NBR   = :DK-XFER-SEQ-NBR     AND       10380000
                      X.FR_STR_NBR     = :DK-FROM-STORE-NBR   AND       10390000
                      X.CONTNR_TYP_CDE = CT.CONTNR_TYP_CDE    AND       10400000
                      X.XFER_TYP_CDE   = XT.XFER_TYP_CDE                10410000
                WITH  UR                                                10420000
           END-EXEC.                                                    10430000
                                                                        10440000
           EVALUATE SQLCODE                                             10450000
               WHEN ZERO                                                10460000
                   MOVE TFMSTR-XFER-DKEY-ID                             10470000
                                   TO DK-XFER-DKEY-ID                   10480000
               WHEN OTHER                                               10490000
                   IF SQLCODE = -904 OR -911 OR -913                    10500000
                       SET PS-CONTENTION                                10510000
                                   TO TRUE                              10520000
                   END-IF                                               10530000
                   SET PS-ERROR    TO TRUE                              10540000
                   MOVE PC-GET-TRANSFER-MSG                             10550000
                                   TO PV-ERROR-MSG                      10560000
                   MOVE '1000-GET-TRANSFER'                             10570000
                                   TO DP013-PARAGRAPH                   10580000
                   MOVE PRV-02     TO DP013-MESSAGE-TEXT (1)            10590000
                   PERFORM 9000-RETURN-MSG                              10600000
                   MOVE PV-DISPLAY-KEYS                                 10610000
                                   TO DP013-MESSAGE-TEXT (2)            10620000
                   MOVE 'TTFMSTR'  TO DP013-DB2-TABLE-NAME (1)          10630000
                   MOVE 'TTFSHCT'  TO DP013-DB2-TABLE-NAME (2)          10640000
                   MOVE 'TTFTYCD'  TO DP013-DB2-TABLE-NAME (3)          10650000
                   MOVE SQLCA      TO DP013-SQLCA                       10660000
                   SET DP013-LINK-RETURN                                10670000
                       DP013-DB2-ABEND                                  10680000
                       DP013-NO-ROLLBACK                                10690000
                                   TO TRUE                              10700000
                   PERFORM DP014-0000-PROCESS-ABEND                     10710000
           END-EVALUATE.                                                10720000
      *                                                                 10730000
           PERFORM 2000-GET-STORE-NAMES.                                10740000
           PERFORM 2200-GET-TOTALS.                                     10750000
051705*    INITIALIZE DCLTTFCNTL.                                       10760000
051705*    IF TFMSTR-XFER-TYP-CDE NOT = TF007-OFFSITE-STORAGE  AND      10770000
051705*       TFMSTR-XFER-TYP-CDE NOT = TF007-NON-RETAIL                10780000
051705*        PERFORM 2300-CHECK-INVENTORY-PERIOD                      10790000
051705*    END-IF.                                                      10800000
           IF PS-NO-ERROR                           AND                 10810000
021605       (TFMSTR-XFER-TYP-CDE = TF007-CUSTOMER OR                   10820000
021605        TFMSTR-XFER-TYP-CDE = TF007-OFFSITE-STORAGE)              10830000
               PERFORM 3000-READ-CUSTOMER                               10840000
           END-IF.                                                      10850000
           PERFORM 1100-MOVE-TRANSFER-DATA.                             10860000
       EJECT                                                            10870000
      *----------------------------------------------------------------*10880000
      * MOVE THE TRANSFER DATA TO THE REPORT HEADING LINES              10890000
      *----------------------------------------------------------------*10900000
       1100-MOVE-TRANSFER-DATA.                                         10910000
           MOVE TFMSTR-FR-STR-NBR  TO HL3-FROM-STORE-NBR.               10920000
           MOVE TFMSTR-TO-STR-NBR  TO HL3-TO-STORE-NBR.                 10930000
           MOVE TFMSTR-CMPT-XFER-END-TMST                               10940000
                                   TO PV-COMP-DATE.                     10950000
           MOVE PV-COMP-YEAR       TO HL6-COMP-YEAR.                    10960000
           MOVE PV-COMP-MONTH      TO HL6-COMP-MONTH.                   10970000
           MOVE PV-COMP-DAY        TO HL6-COMP-DAY.                     10980000
           MOVE TFMSTR-CPLD-INIT-1ST-NM                                 10990000
                                   TO HL5-COMP-BY-INIT.                 11000000
           MOVE TFMSTR-CPLD-LAST-NM                                     11010000
                                   TO HL5-COMP-BY-NAME.                 11020000
           MOVE TFSHCT-CONTNR-TYP-DESC                                  11030000
                                   TO HL4-CONTAINER-TYPE.               11040000
           IF TFTYCD-TYP-2ND-LNE-DESC = SPACES                          11050000
               STRING TFTYCD-TYP-1ST-LNE-DESC DELIMITED BY '  '         11060000
                      '*'                     DELIMITED BY SIZE         11070000
                                          INTO PV-XFER-TYPE-DESC        11080000
           ELSE                                                         11090000
               STRING TFTYCD-TYP-1ST-LNE-DESC DELIMITED BY '  '         11100000
                      TFTYCD-TYP-2ND-LNE-DESC DELIMITED BY '  '         11110000
                      '*'                     DELIMITED BY SIZE         11120000
                                          INTO PV-XFER-TYPE-DESC        11130000
           END-IF.                                                      11140000
           MOVE ZERO               TO PV-CHARACTER-COUNT.               11150000
           INSPECT PV-XFER-TYPE-DESC TALLYING PV-CHARACTER-COUNT        11160000
             FOR CHARACTERS BEFORE '*'.                                 11170000
           COMPUTE PV-POINTER =                                         11180000
                   (LENGTH OF HL2-XFER-DESC - PV-CHARACTER-COUNT) / 2.  11190000
           STRING PV-XFER-TYPE-DESC DELIMITED BY '*'                    11200000
               INTO HL2-XFER-DESC                                       11210000
               WITH POINTER PV-POINTER.                                 11220000
021605     IF TFMSTR-XFER-TYP-CDE NOT = TF007-CUSTOMER AND              11230000
021605        TFMSTR-XFER-TYP-CDE NOT = TF007-OFFSITE-STORAGE           11240000
               MOVE SPACES         TO HL3-CUST-NAME-LITERAL             11250000
                                             HL4-CUSTOMER               11260000
                                             HL5-CUST-ADDR-LITERAL      11270000
                                             HL7-CITY-LITERAL           11280000
                                             HL8-STATE-ZIP-LITERAL      11290000
           END-IF.                                                      11300000
           EVALUATE TFMSTR-XFER-TYP-CDE                                 11310000
021605         WHEN TF007-DEFECTIVES-DAMAGES-SORT1                      11320000
021605         WHEN TF007-DEFECTIVES-DAMAGES-SORT2                      11330000
021605             IF TFMSTR-XFER-TYP-CDE =                             11340000
021605                     TF007-DEFECTIVES-DAMAGES-SORT1               11350000
                       MOVE PC-SORT1-DC                                 11360000
                                   TO HL8-NAME                          11370000
                   ELSE                                                 11380000
                       MOVE PC-SORT2-RTV                                11390000
                                   TO HL8-NAME                          11400000
                   END-IF                                               11410000
                   MOVE '2'        TO HL1-AFP-GROUP                     11420000
                   MOVE PC-VENDOR-DUNS-LITERAL                          11430000
                                   TO CH1-LITERAL                       11440000
021605         WHEN TF007-STOCK-BALANCE-STORE                           11450000
                   MOVE '1'        TO HL1-AFP-GROUP                     11460000
021605         WHEN TF007-CALLBACK                                      11470000
                   MOVE '2'        TO HL1-AFP-GROUP                     11480000
                   MOVE PC-VENDOR-DUNS-LITERAL                          11490000
                                   TO CH1-LITERAL                       11500000
                   MOVE TFMSTR-CLBK-NBR                                 11510000
                                   TO PV-CALLBACK-NBR                   11520000
                   MOVE PV-CALLBACK                                     11530000
                                   TO HL8-NAME                          11540000
021605         WHEN TF007-STOCK-BALANCE-CORPORATE                       11550000
                   MOVE '1'        TO HL1-AFP-GROUP                     11560000
                   MOVE TFMSTR-STK-BAL-APVL-NBR                         11570000
                                   TO PV-APPROVAL-NBR                   11580000
                   MOVE PV-APPROVAL                                     11590000
                                   TO HL8-NAME                          11600000
021605         WHEN TF007-CUSTOMER                                      11610000
021605         WHEN TF007-OFFSITE-STORAGE                               11620000
                   MOVE '1'        TO HL1-AFP-GROUP                     11630000
021605             IF TFMSTR-XFER-TYP-CDE = TF007-CUSTOMER              11640000
                       MOVE PC-CUSTOMER-LITERAL                         11650000
                                   TO HL7-LITERAL                       11660000
                   ELSE                                                 11670000
                       MOVE PC-WAREHOUSE-NAME-LITERAL                   11680000
                                   TO HL3-CUST-NAME-LITERAL             11690000
                       MOVE PC-WAREHOUSE-PHON-LITERAL                   11700000
                                   TO HL4-CUST-PHONE-LITERAL            11710000
                       MOVE PC-WAREHOUSE-LITERAL                        11720000
                                   TO HL7-LITERAL                       11730000
                   END-IF                                               11740000
                   MOVE TFCUST-CUST-NM                                  11750000
                                   TO HL3-CUST-NAME                     11760000
                                      HL8-NAME                          11770000
                   MOVE TFCUST-PHN-NBR                                  11780000
                                   TO PV-PHONE                          11790000
                   MOVE PV-PHONE-AREA                                   11800000
                                   TO HL4-PHONE-AREA                    11810000
                   MOVE PV-PHONE-EXCH                                   11820000
                                   TO HL4-PHONE-EXCH                    11830000
                   MOVE PV-PHONE-NBR                                    11840000
                                   TO HL4-PHONE-NBR                     11850000
                   MOVE TFCUST-CUST-1ST-LNE-ADDR                        11860000
                                   TO HL5-CUST-ADDRESS                  11870000
                   MOVE TFCUST-CUST-2ND-LNE-ADDR                        11880000
                                   TO HL6-CUST-ADDRESS                  11890000
                   MOVE TFCUST-CTY-NM                                   11900000
                                   TO HL7-CITY                          11910000
                   MOVE TFCUST-ST-CDE                                   11920000
                                   TO HL8-STATE                         11930000
                   MOVE TFCUST-ZIP-CDE                                  11940000
                                   TO HL8-ZIP                           11950000
                   IF TFCUST-ZIP-EXT-CDE > SPACES                       11960000
                       MOVE TFCUST-ZIP-EXT-CDE                          11970000
                                   TO HL8-ZIP-EXT                       11980000
                       MOVE '-'    TO HL8-ZIP-DASH                      11990000
                   END-IF                                               12000000
021605         WHEN TF007-NON-RETAIL                                    12010000
                   MOVE '3'        TO HL1-AFP-GROUP                     12020000
                   MOVE PC-ATTENTION-TO-LITERAL                         12030000
                                   TO HL7-LITERAL                       12040000
                   MOVE TFMSTR-ATTN-INIT-1ST-NM                         12050000
                                   TO PV-FIRST-INIT                     12060000
                   MOVE TFMSTR-ATTN-LAST-NM                             12070000
                                   TO PV-LAST-NAME                      12080000
                   MOVE PV-NAME    TO HL8-NAME                          12090000
                   MOVE SPACES     TO HL9-RETAIL                        12100000
           END-EVALUATE.                                                12110000
           EVALUATE TFMSTR-CONTNR-TYP-CDE                               12120000
               WHEN PC-TRAILER                                          12130000
                   MOVE PC-TRAILER-LITERAL                              12140000
                                   TO HL7-SEAL-TRLR-LITERAL             12150000
                   MOVE PC-TRAILER-SEAL-LITERAL                         12160000
                                   TO HL8-SEAL-TRLR-LITERAL             12170000
                   MOVE TFMSTR-TRLR-NBR                                 12180000
                                   TO HL7-SEAL-TRAILER                  12190000
                   MOVE TFMSTR-TRLR-SEAL-ID                             12200000
                                   TO HL8-SEAL-TRAILER                  12210000
               WHEN OTHER                                               12220000
                   IF TFMSTR-CONTNR-TYP-CDE = PC-SECURE-TOTE            12230000
                       MOVE PC-TOTE-NUMBER-LITERAL                      12240000
                                   TO              HL8-SEAL-TRLR-LITERAL12250000
                   END-IF                                               12260000
                   MOVE TFMSTR-LG-TTE-1ST-SEAL-ID                       12270000
                                   TO PV-LARGE-TOTE-SEAL1               12280000
                   MOVE TFMSTR-LG-TTE-2ND-SEAL-ID                       12290000
                                   TO PV-LARGE-TOTE-SEAL2               12300000
                   MOVE PV-LARGE-TOTE-SEALS                             12310000
                                   TO HL7-SEAL-TRAILER                  12320000
                   MOVE TFMSTR-SM-TTE-BAG-SEAL-ID                       12330000
                                   TO HL8-SEAL-TRAILER                  12340000
                                                                        12350000
                                                                        12360000
           END-EVALUATE.                                                12370000
051705*    SET PS-NO-INVENTORY                                          12380000
           SET PS-NO-HAND-CARRY    TO TRUE.                             12390000
           IF TFMSTR-CONTNR-TYP-CDE = PC-HAND-CARRY                     12400000
               SET PS-HAND-CARRY   TO TRUE                              12410000
           END-IF.                                                      12420000
051705*    IF TFCNTL-PHY-INV-PERD-IND = PC-YES                          12430000
051705*        PERFORM 1110-CHECK-INVENTORY                             12440000
051705*    END-IF.                                                      12450000
           EVALUATE TFMSTR-XFER-TYP-CDE                                 12460000
021605         WHEN TF007-DEFECTIVES-DAMAGES-SORT1                      12470000
021605         WHEN TF007-DEFECTIVES-DAMAGES-SORT2                      12480000
021605         WHEN TF007-CALLBACK                                      12490000
021605         WHEN TF007-NON-RETAIL                                    12500000
051705              IF PS-NO-HAND-CARRY                                 12510000
                       MOVE 'A'    TO HL1-AFP-COMBINATION               12520000
                         ELSE                                           12530000
051705*              IF PS-NO-HAND-CARRY AND  PS-INVENTORY              12540000
051705*                 MOVE 'B'   TO HL1-AFP-COMBINATION               12550000
051705*                   ELSE                                          12560000
051705                IF PS-HAND-CARRY                                  12570000
                         MOVE 'C'  TO HL1-AFP-COMBINATION               12580000
051705*                    ELSE                                         12590000
051705*                IF PS-HAND-CARRY    AND  PS-INVENTORY            12600000
051705*                   MOVE 'D' TO HL1-AFP-COMBINATION               12610000
051705*                END-IF                                           12620000
051705*               END-IF                                            12630000
                     END-IF                                             12640000
                    END-IF                                              12650000
021605         WHEN TF007-CUSTOMER                                      12660000
021605         WHEN TF007-OFFSITE-STORAGE                               12670000
051705              IF PS-NO-HAND-CARRY                                 12680000
                       MOVE 'D'    TO HL1-AFP-COMBINATION               12690000
                         ELSE                                           12700000
051705*              IF PS-NO-HAND-CARRY AND  PS-INVENTORY              12710000
051705*                 MOVE 'F'   TO HL1-AFP-COMBINATION               12720000
051705*                   ELSE                                          12730000
051705                IF PS-HAND-CARRY                                  12740000
                         MOVE 'G'  TO HL1-AFP-COMBINATION               12750000
051705*                    ELSE                                         12760000
051705*                IF PS-HAND-CARRY    AND  PS-INVENTORY            12770000
051705*                   MOVE 'H' TO HL1-AFP-COMBINATION               12780000
051705*                END-IF                                           12790000
051705*               END-IF                                            12800000
                     END-IF                                             12810000
                    END-IF                                              12820000
021605         WHEN TF007-STOCK-BALANCE-STORE                           12830000
021605         WHEN TF007-STOCK-BALANCE-CORPORATE                       12840000
051705              IF PS-NO-HAND-CARRY                                 12850000
                       MOVE 'A'    TO HL1-AFP-COMBINATION               12860000
                         ELSE                                           12870000
051705*              IF PS-NO-HAND-CARRY AND  PS-INVENTORY              12880000
051705*                 MOVE 'B'   TO HL1-AFP-COMBINATION               12890000
051705*                   ELSE                                          12900000
051705                IF PS-HAND-CARRY                                  12910000
                         MOVE 'C'  TO HL1-AFP-COMBINATION               12920000
051705*                    ELSE                                         12930000
051705*                IF PS-HAND-CARRY    AND  PS-INVENTORY            12940000
051705*                   MOVE 'E' TO HL1-AFP-COMBINATION               12950000
051705*                END-IF                                           12960000
051705*               END-IF                                            12970000
                     END-IF                                             12980000
                    END-IF                                              12990000
           END-EVALUATE.                                                13000000
051705*----------------------------------------------------------------*13010000
051705*  INVENTORY PERIOD IS ACTIVE - CHECK FOR PRINTING OF 'BEFORE'   *13020000
051705*  OR 'AFTER' INVENTORY MESSAGE.                                 *13030000
051705*----------------------------------------------------------------*13040000
051705*1110-CHECK-INVENTORY.                                            13050000
051705*    MOVE TFMSTR-FR-STR-NBR  TO DK-STORE-NBR-9.                   13060000
051705*    PERFORM 2320-GET-PLND-INV-DTE.                               13070000
051705*    MOVE INVPAR-PLND-INV-DTE                                     13080000
051705*                            TO PV-FR-STR-INV-DTE.                13090000
051705*    MOVE PV-HOLD-INVENTORY-IND                                   13100000
051705*                            TO PV-FR-INVENTORY-IND.              13110000
051705*    MOVE TFMSTR-TO-STR-NBR  TO DK-STORE-NBR-9.                   13120000
051705*    PERFORM 2320-GET-PLND-INV-DTE.                               13130000
051705*    MOVE INVPAR-PLND-INV-DTE                                     13140000
051705*                            TO PV-TO-STR-INV-DTE.                13150000
051705*    MOVE PV-HOLD-INVENTORY-IND                                   13160000
051705*                            TO PV-TO-INVENTORY-IND.              13170000
051705*    IF PV-FR-NO-INVENTORY  AND                                   13180000
051705*       PV-TO-NO-INVENTORY                                        13190000
051705*        MOVE PC-NO-INV-LITERAL                                   13200000
051705*                            TO HL2-BEFORE-AFTER-INV              13210000
051705*        SET PS-INVENTORY    TO TRUE                              13220000
051705*    ELSE                                                         13230000
051705*        IF PV-FR-NO-INVENTORY                                    13240000
051705*            MOVE PV-TO-STR-INV-DTE                               13250000
051705*                            TO  PV-STR-PLND-INV-DTE              13260000
051705*        ELSE                                                     13270000
051705*            MOVE PV-FR-STR-INV-DTE                               13280000
051705*                            TO  PV-STR-PLND-INV-DTE              13290000
051705*        END-IF                                                   13300000
051705*        IF TFMSTR-CONTNR-TYP-CDE = PC-HAND-CARRY                 13310000
051705*          IF PV-COMP-DATE >  PV-BEFORE-INV-START     AND         13320000
051705*             PV-COMP-DATE <= PV-STR-PLND-INV-DTE                 13330000
051705*             MOVE PC-BEFORE-INV-LITERAL                          13340000
051705*                            TO HL2-BEFORE-AFTER-INV              13350000
051705*             SET PS-INVENTORY                                    13360000
051705*                            TO TRUE                              13370000
051705*          ELSE                                                   13380000
051705*             IF PV-COMP-DATE >  PV-STR-PLND-INV-DTE      AND     13390000
051705*               PV-COMP-DATE <= PV-MAX-FINCL-BK-DTE               13400000
051705*               MOVE PC-AFTER-INV-LITERAL                         13410000
051705*                            TO HL2-BEFORE-AFTER-INV              13420000
051705*               SET PS-INVENTORY                                  13430000
051705*                            TO TRUE                              13440000
051705*             END-IF                                              13450000
051705*          END-IF                                                 13460000
051705*        ELSE                                                     13470000
051705*          IF PV-COMP-DATE > PV-BEFORE-INV-START                  13480000
051705*             AND PV-COMP-DATE <= PV-XFER-INV-CTOFF-DTE           13490000
051705*             MOVE PC-BEFORE-INV-LITERAL                          13500000
051705*                            TO HL2-BEFORE-AFTER-INV              13510000
051705*             SET PS-INVENTORY                                    13520000
051705*                            TO TRUE                              13530000
051705*          ELSE                                                   13540000
051705*            IF PV-COMP-DATE > PV-XFER-INV-CTOFF-DTE              13550000
051705*               AND PV-COMP-DATE <= PV-MAX-FINCL-BK-DTE           13560000
051705*               MOVE PC-AFTER-INV-LITERAL                         13570000
051705*                            TO HL2-BEFORE-AFTER-INV              13580000
051705*               SET PS-INVENTORY                                  13590000
051705*                            TO TRUE                              13600000
051705*            END-IF                                               13610000
051705*          END-IF                                                 13620000
051705*        END-IF                                                   13630000
051705*    END-IF.                                                      13640000
051705*EJECT                                                            13650000
      *----------------------------------------------------------------*13660000
      *    GET THE STORE NAMES FOR THE FROM AND TO STORES.             *13670000
      *----------------------------------------------------------------*13680000
       2000-GET-STORE-NAMES.                                            13690000
           MOVE TFMSTR-FR-STR-NBR  TO DK-STORE-NBR.                     13700000
           PERFORM 2100-GET-LOC-NAME.                                   13710000
           MOVE XST00001-LOC-10-ABBR-NM                                 13720000
                                   TO HL3-FROM-STORE-NAME.              13730000
           MOVE TFMSTR-TO-STR-NBR  TO DK-STORE-NBR.                     13740000
           PERFORM 2100-GET-LOC-NAME.                                   13750000
           MOVE XST00001-LOC-10-ABBR-NM                                 13760000
                                   TO HL3-TO-STORE-NAME.                13770000
       EJECT                                                            13780000
      *----------------------------------------------------------------*13790000
      *    GET THE 10 CHARACTER ABBREVIATED LOCATION NAME.             *13800000
      *----------------------------------------------------------------*13810000
       2100-GET-LOC-NAME.                                               13820000
           EXEC SQL                                                     13830000
               SELECT LOC_10_ABBR_NM                                    13840000
                   INTO :XST00001-LOC-10-ABBR-NM                        13850000
                   FROM XST_LOC                                         13860000
                   WHERE LOC_NBR  = :DK-STORE-NBR                       13870000
                    WITH UR                                             13880000
           END-EXEC                                                     13890000
           EVALUATE SQLCODE                                             13900000
               WHEN ZERO                                                13910000
                   CONTINUE                                             13920000
               WHEN OTHER                                               13930000
                   IF SQLCODE = -904 OR -911 OR -913                    13940000
                       SET PS-CONTENTION                                13950000
                                   TO TRUE                              13960000
                   END-IF                                               13970000
                   MOVE '2100-GET-LOC-NAME'                             13980000
                                   TO DP013-PARAGRAPH                   13990000
                   SET PS-ERROR    TO TRUE                              14000000
                   MOVE DK-STORE-NBR                                    14010000
                                   TO PVE-STORE                         14020000
                   MOVE PVE-STORE-ERROR                                 14030000
                                   TO PV-ERROR-KEY                      14040000
                   MOVE PC-GET-STORE-MSG                                14050000
                                   TO PV-ERROR-MSG                      14060000
                   MOVE PRV-03     TO DP013-MESSAGE-TEXT (1)            14070000
                   PERFORM 9000-RETURN-MSG                              14080000
                   MOVE PV-DISPLAY-KEYS                                 14090000
                                   TO DP013-MESSAGE-TEXT (2)            14100000
                   MOVE SQLCA      TO DP013-SQLCA                       14110000
                   MOVE 'XST_LOC'  TO DP013-DB2-TABLE-NAME (1)          14120000
                   SET DP013-LINK-RETURN                                14130000
                       DP013-DB2-ABEND                                  14140000
                       DP013-NO-ROLLBACK                                14150000
                                   TO TRUE                              14160000
                   PERFORM DP014-0000-PROCESS-ABEND                     14170000
           END-EVALUATE.                                                14180000
      *                                                                 14190000
       EJECT                                                            14200000
      *----------------------------------------------------------------*14210000
      *  GET THE TOTAL XFER QTY & PRICE.                               *14220000
      *----------------------------------------------------------------*14230000
       2200-GET-TOTALS.                                                 14240000
           EXEC SQL                                                     14250000
               SELECT COALESCE(SUM(XFER_PRIC_AMT * XFER_QTY),0)         14260000
                     ,COALESCE(SUM(XFER_QTY),0)                         14270000
                     ,COUNT(*)                                          14280000
                   INTO :PV-XFER-PRICE                                  14290000
                        :PV-XFER-PRICE-IND                              14300000
                       ,:PV-XFER-QTY                                    14310000
                        :PV-XFER-QTY-IND                                14320000
                       ,:PV-TOTAL-LINES                                 14330000
                   FROM TTFITEM                                         14340000
                   WHERE XFER_DKEY_ID  = :DK-XFER-DKEY-ID               14350000
                    WITH UR                                             14360000
           END-EXEC                                                     14370000
           EVALUATE SQLCODE                                             14380000
               WHEN ZERO                                                14390000
                   CONTINUE                                             14400000
               WHEN OTHER                                               14410000
                   IF SQLCODE = -904 OR -911 OR -913                    14420000
                       SET PS-CONTENTION                                14430000
                                   TO TRUE                              14440000
                   END-IF                                               14450000
                   MOVE '2200-GET-TOTALS'                               14460000
                                   TO DP013-PARAGRAPH                   14470000
                   MOVE PC-GET-TOTALS-MSG                               14480000
                                   TO PV-ERROR-MSG                      14490000
                   SET PS-ERROR    TO TRUE                              14500000
                   MOVE PRV-18     TO DP013-MESSAGE-TEXT (1)            14510000
                   PERFORM 9000-RETURN-MSG                              14520000
                   MOVE PV-DISPLAY-KEYS                                 14530000
                                   TO DP013-MESSAGE-TEXT (2)            14540000
                   MOVE SQLCA      TO DP013-SQLCA                       14550000
                   MOVE 'TTFITEM'  TO DP013-DB2-TABLE-NAME (1)          14560000
                   SET DP013-LINK-RETURN                                14570000
                       DP013-DB2-ABEND                                  14580000
                       DP013-NO-ROLLBACK                                14590000
                                   TO TRUE                              14600000
                   PERFORM DP014-0000-PROCESS-ABEND                     14610000
           END-EVALUATE                                                 14620000
      *                                                                 14630000
           MOVE PV-XFER-PRICE      TO HL9-TOTAL-RETAIL.                 14640000
           MOVE PV-XFER-QTY        TO HL9-TOTAL-UNITS.                  14650000
           COMPUTE PV-TOTAL-PAGES =                                     14660000
              ((PV-TOTAL-LINES - 1)/ PC-PAGE-MAX) + 1.                  14670000
           MOVE PV-TOTAL-PAGES     TO HL1-PAGE-TOTAL.                   14680000
       EJECT                                                            14690000
051705*----------------------------------------------------------------*14700000
051705*  READ TTFCNTL TO CHECK THE PHYSICAL INVENTORY PERIOD INDICATOR *14710000
051705*----------------------------------------------------------------*14720000
051705*2300-CHECK-INVENTORY-PERIOD.                                     14730000
051705*    IF PS-NO-ERROR                                               14740000
051705*        PERFORM 2310-READ-CONTROL-TABLE                          14750000
051705*    END-IF.                                                      14760000
051705*----------------------------------------------------------------*14770000
051705*    GET THE PHYSICAL INVENTORY PERIOD INDICATOR FROM TTFCNTL    *14780000
051705*----------------------------------------------------------------*14790000
051705*2310-READ-CONTROL-TABLE.                                         14800000
051705*    EXEC SQL                                                     14810000
051705*        SELECT PHY_INV_PERD_IND                                  14820000
051705*              ,XFER_INV_CTOFF_DTE                                14830000
051705*              ,MAX_FINCL_BK_DTE                                  14840000
051705*              ,BEF_CTOFF_DAYS_QTY                                14850000
051705*         INTO :TFCNTL-PHY-INV-PERD-IND                           14860000
051705*              ,:TFCNTL-XFER-INV-CTOFF-DTE                        14870000
051705*              ,:TFCNTL-MAX-FINCL-BK-DTE                          14880000
051705*              ,:TFCNTL-BEF-CTOFF-DAYS-QTY                        14890000
051705*         FROM TTFCNTL                                            14900000
051705*          WITH UR                                                14910000
051705*    END-EXEC                                                     14920000
051705*    EVALUATE SQLCODE                                             14930000
051705*        WHEN ZERO                                                14940000
051705*              MOVE TFCNTL-PHY-INV-PERD-IND                       14950000
051705*                            TO PV-PHY-INV-PERD-IND               14960000
051705*              MOVE TFCNTL-XFER-INV-CTOFF-DTE                     14970000
051705*                            TO PV-XFER-INV-CTOFF-DTE             14980000
051705*              MOVE TFCNTL-MAX-FINCL-BK-DTE                       14990000
051705*                            TO PV-MAX-FINCL-BK-DTE               15000000
051705*        WHEN OTHER                                               15010000
051705*            IF SQLCODE = -904 OR -911 OR -913                    15020000
051705*                SET PS-CONTENTION                                15030000
051705*                            TO TRUE                              15040000
051705*            END-IF                                               15050000
051705*            MOVE '2310-READ-CONTROL-TABLE'                       15060000
051705*                            TO DP013-PARAGRAPH                   15070000
051705*            MOVE PC-GET-CONTROL-MSG                              15080000
051705*                            TO PV-ERROR-MSG                      15090000
051705*            SET PS-ERROR    TO TRUE                              15100000
051705*            MOVE PRV-23     TO DP013-MESSAGE-TEXT (1)            15110000
051705*            PERFORM 9000-RETURN-MSG                              15120000
051705*            MOVE PV-DISPLAY-KEYS                                 15130000
051705*                            TO DP013-MESSAGE-TEXT (2)            15140000
051705*            MOVE SQLCA      TO DP013-SQLCA                       15150000
051705*            MOVE 'TTFCNTL'  TO DP013-DB2-TABLE-NAME (1)          15160000
051705*            SET DP013-LINK-RETURN                                15170000
051705*                DP013-DB2-ABEND                                  15180000
051705*                DP013-NO-ROLLBACK                                15190000
051705*                            TO TRUE                              15200000
051705*            PERFORM DP014-0000-PROCESS-ABEND                     15210000
051705*    END-EVALUATE                                                 15220000
051705*                                                                 15230000
051705*    INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              15240000
051705*    SET DPG51-ACTUAL-CALENDAR-ONLY                               15250000
051705*        DPG51-DECREMENT-DATE                                     15260000
051705*        DPG52-LK-DTE-ISO-FMT                                     15270000
051705*                            TO TRUE.                             15280000
051705*    MOVE TFCNTL-XFER-INV-CTOFF-DTE                               15290000
051705*                            TO DPG52-DB2-ISO-DATE-FMT.           15300000
051705*    MOVE TFCNTL-BEF-CTOFF-DAYS-QTY                               15310000
051705*                            TO DPG51-INCR-DECR-DAYS-9.           15320000
051705*    CALL DP500-KOHLS-CALENDAR-ROUTINE USING                      15330000
051705*                               DPG51 DPG52                       15340000
051705*                               DPG53 DPG54                       15350000
051705*                               DPG55 DPG56.                      15360000
051705*    IF DPG54-NO-ERROR                                            15370000
051705*        MOVE DPG55-DB2-ISO-DATE-FMT                              15380000
051705*                            TO PV-BEFORE-INV-START               15390000
051705*    ELSE                                                         15400000
051705*        MOVE '2310-READ-CONTROL-TABLE'                           15410000
051705*                            TO DP013-PARAGRAPH                   15420000
051705*        SET PS-ERROR        TO TRUE                              15430000
051705*        MOVE DK-STORE-NBR   TO PVE-STORE                         15440000
051705*        MOVE PVE-STORE-ERROR                                     15450000
051705*                            TO PV-ERROR-KEY                      15460000
051705*        MOVE PC-CALENDAR-ERROR-MSG                               15470000
051705*                            TO PV-ERROR-MSG                      15480000
051705*        MOVE PRV-22         TO DP013-MESSAGE-TEXT (1)            15490000
051705*        PERFORM 9000-RETURN-MSG                                  15500000
051705*        MOVE PV-DISPLAY-KEYS                                     15510000
051705*                            TO DP013-MESSAGE-TEXT (2)            15520000
051705*        MOVE SQLCA          TO DP013-SQLCA                       15530000
051705*        SET DP013-LINK-RETURN                                    15540000
051705*            DP013-DB2-ABEND                                      15550000
051705*            DP013-NO-ROLLBACK                                    15560000
051705*                            TO TRUE                              15570000
051705*        PERFORM DP014-0000-PROCESS-ABEND                         15580000
051705*    END-IF.                                                      15590000
051705*----------------------------------------------------------------*15600000
051705*    GET THE MAX PLANNED INVENTORY DATE FOR THIS STORE           *15610000
051705*----------------------------------------------------------------*15620000
051705*2320-GET-PLND-INV-DTE.                                           15630000
051705*    EXEC SQL                                                     15640000
051705*        SELECT A.PLND_INV_DTE                                    15650000
051705*              ,A.ACTL_FIN_BK_DTE                                 15660000
051705*              ,A.SCHD_PHY_CNT_IND                                15670000
051705*         INTO :INVPAR-PLND-INV-DTE                               15680000
051705*             ,:INVPAR-ACTL-FIN-BK-DTE                            15690000
051705*             ,:INVPAR-SCHD-PHY-CNT-IND                           15700000
051705*         FROM TINVPAR A                                          15710000
051705*        WHERE  A.LOC_NBR      = :DK-STORE-NBR-9             AND  15720000
051705*               A.PLND_INV_DTE < :PC-MAX-DATE                     15730000
051705*          AND  A.PLND_INV_DTE =                                  15740000
051705*               (SELECT MAX(PLND_INV_DTE)                         15750000
051705*                  FROM TINVPAR B                                 15760000
051705*                 WHERE  B.LOC_NBR         = :DK-STORE-NBR-9 AND  15770000
051705*                        B.ACTL_FIN_BK_DTE = :PC-MAX-DATE    AND  15780000
051705*                        PLND_INV_DTE      < :PC-MAX-DATE)        15790000
051705*         WITH UR                                                 15800000
051705*    END-EXEC.                                                    15810000
051705*    EVALUATE SQLCODE                                             15820000
051705*        WHEN ZERO                                                15830000
051705*            IF INVPAR-SCHD-PHY-CNT-IND = PC-YES                  15840000
051705*                SET PV-HOLD-PHYSICAL-COUNT                       15850000
051705*                            TO TRUE                              15860000
051705*            ELSE                                                 15870000
051705*                IF INVPAR-ACTL-FIN-BK-DTE = PC-MAX-DATE          15880000
051705*                    SET PV-HOLD-FAKE-INVENTORY                   15890000
051705*                            TO TRUE                              15900000
051705*                ELSE                                             15910000
051705*                    SET PV-HOLD-NO-INVENTORY                     15920000
051705*                            TO TRUE                              15930000
051705*                END-IF                                           15940000
051705*            END-IF                                               15950000
051705*        WHEN +100                                                15960000
051705*            MOVE PV-XFER-INV-CTOFF-DTE                           15970000
051705*                            TO INVPAR-PLND-INV-DTE               15980000
051705*            SET PV-HOLD-NO-INVENTORY                             15990000
051705*                            TO TRUE                              16000000
051705*        WHEN OTHER                                               16010000
051705*            IF SQLCODE = -904 OR -911 OR -913                    16020000
051705*                SET PS-CONTENTION                                16030000
051705*                            TO TRUE                              16040000
051705*            END-IF                                               16050000
051705*            MOVE '2320-GET-PLND-INV-DTE'                         16060000
051705*                            TO DP013-PARAGRAPH                   16070000
051705*            SET PS-ERROR    TO TRUE                              16080000
051705*            MOVE DK-STORE-NBR                                    16090000
051705*                            TO PVE-STORE                         16100000
051705*            MOVE PVE-STORE-ERROR                                 16110000
051705*                            TO PV-ERROR-KEY                      16120000
051705*            MOVE PC-GET-STORE-INV-MSG                            16130000
051705*                            TO PV-ERROR-MSG                      16140000
051705*            MOVE PRV-21     TO DP013-MESSAGE-TEXT (1)            16150000
051705*            PERFORM 9000-RETURN-MSG                              16160000
051705*            MOVE PV-DISPLAY-KEYS                                 16170000
051705*                            TO DP013-MESSAGE-TEXT (2)            16180000
051705*            MOVE SQLCA      TO DP013-SQLCA                       16190000
051705*            MOVE 'TINVPAR'  TO DP013-DB2-TABLE-NAME (1)          16200000
051705*            SET DP013-LINK-RETURN                                16210000
051705*                DP013-DB2-ABEND                                  16220000
051705*                DP013-NO-ROLLBACK                                16230000
051705*                            TO TRUE                              16240000
051705*            PERFORM DP014-0000-PROCESS-ABEND                     16250000
051705*    END-EVALUATE.                                                16260000
      *----------------------------------------------------------------*16270000
      *  GET THE CUSTOMER INFORMATION FOR CUSTOMER TRANSFERS.          *16280000
      *----------------------------------------------------------------*16290000
       3000-READ-CUSTOMER.                                              16300000
               EXEC SQL                                                 16310000
                   SELECT CUST_NM                                       16320000
                         ,CUST_1ST_LNE_ADDR                             16330000
                         ,CUST_2ND_LNE_ADDR                             16340000
                         ,CTY_NM                                        16350000
                         ,ST_CDE                                        16360000
                         ,ZIP_CDE                                       16370000
                         ,ZIP_EXT_CDE                                   16380000
                         ,PHN_NBR                                       16390000
                       INTO :TFCUST-CUST-NM                             16400000
                           ,:TFCUST-CUST-1ST-LNE-ADDR                   16410000
                           ,:TFCUST-CUST-2ND-LNE-ADDR                   16420000
                           ,:TFCUST-CTY-NM                              16430000
                           ,:TFCUST-ST-CDE                              16440000
                           ,:TFCUST-ZIP-CDE                             16450000
                           ,:TFCUST-ZIP-EXT-CDE                         16460000
                           ,:TFCUST-PHN-NBR                             16470000
                       FROM TTFCUST                                     16480000
                       WHERE XFER_DKEY_ID  = :DK-XFER-DKEY-ID           16490000
                       WITH UR                                          16500000
               END-EXEC                                                 16510000
               EVALUATE SQLCODE                                         16520000
                   WHEN ZERO                                            16530000
                       CONTINUE                                         16540000
                   WHEN OTHER                                           16550000
                       IF SQLCODE = -904 OR -911 OR -913                16560000
                           SET PS-CONTENTION                            16570000
                                   TO TRUE                              16580000
                       END-IF                                           16590000
                       MOVE '3000-READ-CUSTOMER'                        16600000
                                   TO DP013-PARAGRAPH                   16610000
                       SET PS-ERROR                                     16620000
                                   TO TRUE                              16630000
                       MOVE PC-GET-CUSTOMER-MSG                         16640000
                                   TO PV-ERROR-MSG                      16650000
                       MOVE PRV-04 TO DP013-MESSAGE-TEXT (1)            16660000
                       PERFORM 9000-RETURN-MSG                          16670000
                       MOVE PV-DISPLAY-KEYS                             16680000
                                   TO DP013-MESSAGE-TEXT (2)            16690000
                       MOVE SQLCA  TO DP013-SQLCA                       16700000
                       MOVE 'TTFCUST'                                   16710000
                                   TO DP013-DB2-TABLE-NAME (1)          16720000
                       SET DP013-LINK-RETURN                            16730000
                           DP013-DB2-ABEND                              16740000
                           DP013-NO-ROLLBACK                            16750000
                                   TO TRUE                              16760000
                       PERFORM DP014-0000-PROCESS-ABEND                 16770000
               END-EVALUATE.                                            16780000
      *                                                                 16790000
       EJECT                                                            16800000
      *----------------------------------------------------------------*16810000
      * OPEN THE RETAIL TRANSFER ITEM CURSOR.                          *16820000
      *----------------------------------------------------------------*16830000
       4000-OPEN-RTL-CURSOR.                                            16840000
               EXEC SQL                                                 16850000
                    OPEN RTL-ITEM-CSR                                   16860000
               END-EXEC                                                 16870000
                                                                        16880000
               EVALUATE SQLCODE                                         16890000
                   WHEN ZERO                                            16900000
                       CONTINUE                                         16910000
                   WHEN OTHER                                           16920000
                       IF SQLCODE = -904 OR -911 OR -913                16930000
                           SET PS-CONTENTION                            16940000
                                   TO TRUE                              16950000
                       END-IF                                           16960000
                       MOVE '4000-OPEN-RTL-CURSOR'                      16970000
                                   TO DP013-PARAGRAPH                   16980000
                       SET PS-ERROR                                     16990000
                                   TO TRUE                              17000000
                       MOVE PC-OPEN-RTL-CSR-MSG                         17010000
                                   TO PV-ERROR-MSG                      17020000
                       MOVE PRV-05 TO DP013-MESSAGE-TEXT (1)            17030000
                       PERFORM 9000-RETURN-MSG                          17040000
                       MOVE PV-DISPLAY-KEYS                             17050000
                                   TO DP013-MESSAGE-TEXT (2)            17060000
                       MOVE SQLCA  TO DP013-SQLCA                       17070000
                       MOVE 'TTFITEM '                                  17080000
                                   TO DP013-DB2-TABLE-NAME (1)          17090000
                       SET DP013-LINK-RETURN                            17100000
                           DP013-DB2-ABEND                              17110000
                           DP013-NO-ROLLBACK                            17120000
                                   TO TRUE                              17130000
                       PERFORM DP014-0000-PROCESS-ABEND                 17140000
               END-EVALUATE.                                            17150000
      *                                                                 17160000
       EJECT                                                            17170000
      *----------------------------------------------------------------*17180000
      *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM TO THE      *17190000
      *    REPORT DETAIL LINE, THEN PRINT THE DETAIL LINE.             *17200000
      *      (RETAIL TRANSFERS)                                        *17210000
      *----------------------------------------------------------------*17220000
                                                                        17230000
       4010-READ-RTL-ITEMS-FROM-DB.                                     17240000
                                                                        17250000
           SET PS-ITEMS-LEFT-ON-DB TO TRUE.                             17260000
           PERFORM                                                      17270000
               UNTIL  PS-NO-ITEMS-LEFT-ON-DB                            17280000
                                                                        17290000
               PERFORM 4030-FETCH-RTL-ITEMS                             17300000
                                                                        17310000
               IF  PS-ITEMS-LEFT-ON-DB                                  17320000
                   MOVE SPACE      TO DL1-DETAIL-LINE-1                 17330000
                   MOVE TFITEM-KOHLS-UPC-NBR                            17340000
                                   TO PV-UPC                            17350000
                                      DK-UPC-NBR                        17360000
                   MOVE '-'        TO PV-UPC-DASH-1                     17370000
                                      PV-UPC-DASH-2                     17380000
                                      PV-UPC-DASH-3                     17390000
                   MOVE PV-UPC     TO DL1-UPC                           17400000
                   IF TFITEM-ITM-NBR NOT = ZEROS                        17410000
                       PERFORM 4300-GET-DESCRIPTIONS                    17420000
                   ELSE                                                 17430000
                       PERFORM 4310-GET-DUMMY-SKU                       17440000
                   END-IF                                               17450000
                   MOVE XST00010-SKU-NBR                                17460000
                                   TO DL1-SKU                           17470000
                   MOVE TFITEM-XFER-LNE-NBR                             17480000
                                   TO DL1-LINE-NBR                      17490000
                   MOVE TFITEM-XFER-QTY                                 17500000
                                   TO DL1-QTY                           17510000
                   MOVE TFITEM-XFER-PRIC-AMT                            17520000
                                   TO DL1-PRICE                         17530000
                   EVALUATE TFMSTR-XFER-TYP-CDE                         17540000
021605                 WHEN TF007-STOCK-BALANCE-CORPORATE               17550000
021605                 WHEN TF007-STOCK-BALANCE-STORE                   17560000
021605                 WHEN TF007-CUSTOMER                              17570000
021605                 WHEN TF007-OFFSITE-STORAGE                       17580000
                           IF XST00013-LBL-NM = SPACES                  17590000
                               MOVE XST00018-ENT-NM-DESC                17600000
                                   TO DL1-VENDOR-LABEL                  17610000
                           ELSE                                         17620000
                               MOVE XST00013-LBL-NM                     17630000
                                   TO DL1-VENDOR-LABEL                  17640000
                           END-IF                                       17650000
                       WHEN OTHER                                       17660000
                           MOVE SPACES                                  17670000
                                   TO DL1-VENDOR-LABEL                  17680000
                           MOVE XST00013-ENT-ID                         17681000
                                   TO DL1-VENDOR                        17681100
                   END-EVALUATE                                         17681200
                   ADD 1           TO PV-LINE-COUNT                     17681300
                   IF PV-LINE-COUNT > PC-PAGE-MAX                       17681400
                       PERFORM 7500-PRINT-HEADINGS                      17681500
                   END-IF                                               17681600
                   MOVE DL1-DETAIL-LINE-1                               17681700
                                   TO DRS01-COMM-DATA                   17681800
                   MOVE PC-SINGLE-SPACE                                 17681900
                                   TO DRS01-COMM-CTL                    17682000
                   PERFORM 8000-LINK-TO-DRS                             17683000
               END-IF                                                   17684000
           END-PERFORM.                                                 17685000
                                                                        17686000
       EJECT                                                            17687000
      *----------------------------------------------------------------*17688000
      * CLOSE THE TRANSFER ITEM CURSOR.                                *17689000
      *----------------------------------------------------------------*17690000
                                                                        17700000
       4020-CLOSE-RTL-CURSOR.                                           17710000
           EXEC SQL                                                     17720000
               CLOSE RTL-ITEM-CSR                                       17730000
           END-EXEC                                                     17740000
      *                                                                 17750000
           EVALUATE SQLCODE                                             17760000
               WHEN ZERO                                                17770000
                   CONTINUE                                             17780000
               WHEN OTHER                                               17790000
                   MOVE '4020-CLOSE-RTL-CURSOR'                         17800000
                                   TO DP013-PARAGRAPH                   17810000
                   SET PS-ERROR    TO TRUE                              17820000
                   MOVE PC-CLOSE-RTL-CSR-MSG                            17830000
                                   TO PV-ERROR-MSG                      17840000
                   MOVE PRV-06     TO DP013-MESSAGE-TEXT (1)            17850000
                   PERFORM 9000-RETURN-MSG                              17860000
                   MOVE PV-DISPLAY-KEYS                                 17870000
                                   TO DP013-MESSAGE-TEXT (2)            17880000
                   MOVE SQLCA      TO DP013-SQLCA                       17890000
                   MOVE 'TTFITEM ' TO DP013-DB2-TABLE-NAME (1)          17900000
                   SET DP013-LINK-RETURN                                17910000
                       DP013-DB2-ABEND                                  17920000
                       DP013-NO-ROLLBACK                                17930000
                                   TO TRUE                              17940000
                   PERFORM DP014-0000-PROCESS-ABEND                     17950000
           END-EVALUATE.                                                17960000
                                                                        17970000
       EJECT                                                            17980000
      *----------------------------------------------------------------*17981000
      *    FETCH THE TRANSFER ITEM CURSOR. (RETAIL TRANSFERS)          *17982000
      *----------------------------------------------------------------*17983000
                                                                        17984000
       4030-FETCH-RTL-ITEMS.                                            17985000
                                                                        17986000
           EXEC SQL                                                     17987000
               FETCH RTL-ITEM-CSR                                       17988000
               INTO                                                     17989000
                      :TFITEM-XFER-LNE-NBR                              17990000
                    , :TFITEM-KOHLS-UPC-NBR                             18000000
                    , :TFITEM-XFER-PRIC-AMT                             18010000
                    , :TFITEM-XFER-QTY                                  18020000
                    , :TFITEM-ITM-NBR                                   18030000
           END-EXEC                                                     18040000
                                                                        18050000
           EVALUATE SQLCODE                                             18060000
               WHEN ZERO                                                18070000
                    CONTINUE                                            18080000
               WHEN +100                                                18090000
                    SET PS-NO-ITEMS-LEFT-ON-DB                          18100000
                                   TO TRUE                              18110000
               WHEN OTHER                                               18120000
                    IF SQLCODE = -904 OR -911 OR -913                   18130000
                        SET PS-CONTENTION                               18140000
                                   TO TRUE                              18150000
                    END-IF                                              18160000
                    MOVE '4030-FETCH-RTL-ITEMS'                         18170000
                                   TO DP013-PARAGRAPH                   18180000
                    SET PS-NO-ITEMS-LEFT-ON-DB                          18190000
                        PS-ERROR   TO TRUE                              18200000
                    MOVE PC-FETCH-RTL-CSR-MSG                           18210000
                                   TO PV-ERROR-MSG                      18220000
                    MOVE PRV-07    TO DP013-MESSAGE-TEXT (1)            18230000
                    PERFORM 9000-RETURN-MSG                             18240000
                    MOVE PV-DISPLAY-KEYS                                18250000
                                   TO DP013-MESSAGE-TEXT (2)            18260000
                    MOVE SQLCA     TO DP013-SQLCA                       18270000
                    MOVE 'TTFITEM '                                     18280000
                                   TO DP013-DB2-TABLE-NAME (1)          18290000
                    SET DP013-LINK-RETURN                               18300000
                        DP013-DB2-ABEND                                 18310000
                        DP013-NO-ROLLBACK                               18320000
                                   TO TRUE                              18330000
                    PERFORM DP014-0000-PROCESS-ABEND                    18340000
           END-EVALUATE.                                                18350000
                                                                        18360000
       EJECT                                                            18370000
      *----------------------------------------------------------------*18380000
      * OPEN THE NON-RETAIL TRANSFER ITEM CURSOR.                      *18390000
      *----------------------------------------------------------------*18400000
       4100-OPEN-NRTL-CURSOR.                                           18410000
               EXEC SQL                                                 18420000
                    OPEN NRTL-ITEM-CSR                                  18430000
               END-EXEC                                                 18440000
                                                                        18450000
               EVALUATE SQLCODE                                         18460000
                   WHEN ZERO                                            18470000
                       CONTINUE                                         18480000
                   WHEN OTHER                                           18490000
                       IF SQLCODE = -904 OR -911 OR -913                18500000
                           SET PS-CONTENTION                            18510000
                                   TO TRUE                              18520000
                       END-IF                                           18530000
                       MOVE '4100-OPEN-NRTL-CURSOR'                     18540000
                                   TO DP013-PARAGRAPH                   18550000
                       SET PS-ERROR                                     18560000
                                   TO TRUE                              18570000
                       MOVE PC-OPEN-NRTL-CSR-MSG                        18580000
                                   TO PV-ERROR-MSG                      18590000
                       MOVE PRV-08 TO DP013-MESSAGE-TEXT (1)            18600000
                       PERFORM 9000-RETURN-MSG                          18610000
                       MOVE PV-DISPLAY-KEYS                             18620000
                                   TO DP013-MESSAGE-TEXT (2)            18630000
                       MOVE SQLCA  TO DP013-SQLCA                       18640000
                       MOVE 'TTFITEM '                                  18650000
                                   TO DP013-DB2-TABLE-NAME (1)          18660000
                       SET DP013-LINK-RETURN                            18670000
                           DP013-DB2-ABEND                              18680000
                           DP013-NO-ROLLBACK                            18690000
                                   TO TRUE                              18700000
                       PERFORM DP014-0000-PROCESS-ABEND                 18710000
               END-EVALUATE.                                            18720000
      *                                                                 18730000
       EJECT                                                            18740000
      *----------------------------------------------------------------*18741000
      *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM TO THE      *18742000
      *    REPORT DETAIL LINE, THEN PRINT THE DETAIL LINE.             *18743000
      *      (NON-RETAIL TRANSFERS)                                    *18744000
      *----------------------------------------------------------------*18745000
                                                                        18746000
       4110-READ-NRTL-ITEMS-FROM-DB.                                    18747000
                                                                        18748000
           PERFORM                                                      18749000
               UNTIL  PS-NO-ITEMS-LEFT-ON-DB                            18750000
                                                                        18760000
               PERFORM 4130-FETCH-NRTL-ITEMS                            18770000
                                                                        18780000
               IF  PS-ITEMS-LEFT-ON-DB                                  18790000
                   MOVE TFITEM-XFER-LNE-NBR                             18800000
                                   TO DL1A-LINE-NBR                     18810000
                   MOVE TFITEM-NRTL-FIXT-ID                             18820000
                                   TO DL1A-FIXTURE                      18830000
                   MOVE TFITEM-NRTL-DEPT-NBR                            18840000
                                   TO DL1A-DEPT                         18850000
                   MOVE TFITEM-NRTL-1ST-LNE-DESC                        18860000
                                   TO DL1A-DESC1                        18870000
                   MOVE TFITEM-NRTL-2ND-LNE-DESC                        18880000
                                   TO DL1A-DESC2                        18890000
                   MOVE TFITEM-XFER-QTY                                 18900000
                                   TO DL1A-QTY                          18910000
                   ADD 1           TO PV-LINE-COUNT                     18920000
                   IF PV-LINE-COUNT > PC-PAGE-MAX                       18930000
                       PERFORM 7500-PRINT-HEADINGS                      18940000
                   END-IF                                               18950000
                   MOVE DL1A-DETAIL-LINE-1A                             18960000
                                   TO DRS01-COMM-DATA                   18970000
                   MOVE PC-SINGLE-SPACE                                 18980000
                                   TO DRS01-COMM-CTL                    18990000
                   PERFORM 8000-LINK-TO-DRS                             19000000
               END-IF                                                   19010000
           END-PERFORM.                                                 19020000
                                                                        19030000
       EJECT                                                            19040000
      *----------------------------------------------------------------*19050000
      * CLOSE THE NON-RETAIL TRANSFER ITEM CURSOR.                     *19060000
      *----------------------------------------------------------------*19070000
                                                                        19080000
       4120-CLOSE-NRTL-CURSOR.                                          19090000
           EXEC SQL                                                     19100000
               CLOSE NRTL-ITEM-CSR                                      19110000
           END-EXEC                                                     19120000
      *                                                                 19130000
           EVALUATE SQLCODE                                             19140000
               WHEN ZERO                                                19150000
                   CONTINUE                                             19160000
               WHEN OTHER                                               19170000
                   MOVE '4120-CLOSE-NRTL-CURSOR'                        19180000
                                   TO DP013-PARAGRAPH                   19190000
                   SET PS-ERROR    TO TRUE                              19200000
                   MOVE PC-CLOSE-NRTL-CSR-MSG                           19210000
                                   TO PV-ERROR-MSG                      19220000
                   MOVE PRV-09     TO DP013-MESSAGE-TEXT (1)            19230000
                   PERFORM 9000-RETURN-MSG                              19240000
                   MOVE PV-DISPLAY-KEYS                                 19250000
                                   TO DP013-MESSAGE-TEXT (2)            19260000
                   MOVE SQLCA      TO DP013-SQLCA                       19270000
                   MOVE 'TTFITEM ' TO DP013-DB2-TABLE-NAME (1)          19280000
                   SET DP013-LINK-RETURN                                19290000
                       DP013-DB2-ABEND                                  19300000
                       DP013-NO-ROLLBACK                                19310000
                                   TO TRUE                              19320000
                   PERFORM DP014-0000-PROCESS-ABEND                     19330000
           END-EVALUATE.                                                19340000
                                                                        19350000
       EJECT                                                            19360000
      *----------------------------------------------------------------*19370000
      *    FETCH THE TRANSFER ITEM CURSOR. (NON-RETAIL)                *19380000
      *----------------------------------------------------------------*19390000
                                                                        19400000
       4130-FETCH-NRTL-ITEMS.                                           19410000
                                                                        19420000
           EXEC SQL                                                     19430000
               FETCH NRTL-ITEM-CSR                                      19440000
               INTO                                                     19450000
                      :TFITEM-XFER-LNE-NBR                              19460000
                    , :TFITEM-NRTL-1ST-LNE-DESC                         19470000
                    , :TFITEM-NRTL-2ND-LNE-DESC                         19480000
                    , :TFITEM-NRTL-FIXT-ID                              19490000
                    , :TFITEM-NRTL-DEPT-NBR                             19500000
                    , :TFITEM-XFER-QTY                                  19510000
           END-EXEC                                                     19520000
                                                                        19530000
           EVALUATE SQLCODE                                             19540000
               WHEN ZERO                                                19550000
                    CONTINUE                                            19560000
               WHEN +100                                                19570000
                    SET PS-NO-ITEMS-LEFT-ON-DB                          19580000
                                   TO TRUE                              19590000
               WHEN OTHER                                               19600000
                    IF SQLCODE = -904 OR -911 OR -913                   19610000
                        SET PS-CONTENTION                               19620000
                                   TO TRUE                              19630000
                    END-IF                                              19640000
                    SET PS-NO-ITEMS-LEFT-ON-DB                          19650000
                                   TO TRUE                              19660000
                    MOVE '4130-FETCH-NRTL-ITEMS'                        19670000
                                   TO DP013-PARAGRAPH                   19680000
                    SET PS-ERROR   TO TRUE                              19690000
                    MOVE PC-FETCH-NRTL-CSR-MSG                          19700000
                                   TO PV-ERROR-MSG                      19710000
                    MOVE PRV-10    TO DP013-MESSAGE-TEXT (1)            19720000
                    PERFORM 9000-RETURN-MSG                             19730000
                    MOVE PV-DISPLAY-KEYS                                19740000
                                   TO DP013-MESSAGE-TEXT (2)            19750000
                    MOVE SQLCA     TO DP013-SQLCA                       19760000
                    MOVE 'TTFITEM '                                     19770000
                                   TO DP013-DB2-TABLE-NAME (1)          19780000
                    SET DP013-LINK-RETURN                               19790000
                        DP013-DB2-ABEND                                 19791000
                        DP013-NO-ROLLBACK                               19792000
                                   TO TRUE                              19793000
                    PERFORM DP014-0000-PROCESS-ABEND                    19794000
           END-EVALUATE.                                                19795000
      *----------------------------------------------------------------*19796000
      *  READ TSK AND TUPC FOR DESCRIPTIONS, STYLE, COLOR, SIZE, ETC   *19797000
      *----------------------------------------------------------------*19798000
       4300-GET-DESCRIPTIONS.                                           19799000
           PERFORM 5000-READ-SKU.                                       19800000
           IF PS-NO-ERROR                                               19810000
               MOVE XST00013-DEPT-NBR                                   19820000
                                   TO DL1-DEPT                          19830000
               IF XST00013-MAJ-CL-NBR < PC-100                          19840000
                       AND XST00013-SUB-CL-NBR < PC-100                 19850000
                   MOVE XST00013-MAJ-CL-NBR                             19860000
                                   TO DL1-CLASS-1                       19870000
                   MOVE XST00013-SUB-CL-NBR                             19880000
                                   TO DL1-SUBCLASS-1                    19890000
               ELSE IF                                                  19900000
                   XST00013-MAJ-CL-NBR < PC-100                         19910000
                           AND XST00013-SUB-CL-NBR > PC-099             19920000
                   MOVE XST00013-MAJ-CL-NBR                             19930000
                                   TO DL1-CLASS-2                       19940000
                   MOVE XST00013-SUB-CL-NBR                             19950000
                                   TO DL1-SUBCLASS-2                    19960000
                   MOVE SPACES     TO DL1-FILLER-2A                     19970000
                                      DL1-FILLER-2B                     19980000
               ELSE IF                                                  19990000
                   XST00013-MAJ-CL-NBR > PC-099                         20000000
                           AND XST00013-SUB-CL-NBR < PC-100             20010000
                   MOVE XST00013-MAJ-CL-NBR                             20020000
                                   TO DL1-CLASS-3                       20030000
                   MOVE XST00013-SUB-CL-NBR                             20040000
                                   TO DL1-SUBCLASS-3                    20050000
                   MOVE SPACES     TO DL1-FILLER-3A                     20060000
                                      DL1-FILLER-3B                     20070000
               ELSE IF                                                  20080000
                   XST00013-MAJ-CL-NBR > PC-099                         20090000
                           AND XST00013-SUB-CL-NBR > PC-099             20091000
                   MOVE XST00013-MAJ-CL-NBR                             20092000
                                   TO DL1-CLASS-4                       20093000
                   MOVE XST00013-SUB-CL-NBR                             20094000
                                   TO DL1-SUBCLASS-4                    20095000
                   MOVE SPACES     TO DL1-FILLER-4A                     20096000
                                      DL1-FILLER-4B                     20097000
               END-IF                                                   20098000
               END-IF                                                   20099000
               END-IF                                                   20100000
               END-IF                                                   20110000
                                                                        20120000
           END-IF.                                                      20130000
           IF PS-NO-ERROR                                               20140000
               MOVE XST00013-VS-NBR                                     20150000
                                   TO DL1-STYLE                         20160000
               MOVE XST00010-NRF-CLOR-DESC                              20170000
                                   TO DL1-COLOR                         20180000
               MOVE XST00010-SIZE-DESC                                  20190000
                                   TO DL1-SIZE                          20200000
               MOVE XST00010-SKU-DESC                                   20210000
                                   TO DL1-DESCRIPTION                   20220000
           END-IF.                                                      20230000
                                                                        20240000
       4310-GET-DUMMY-SKU.                                              20250000
           MOVE TFITEM-KOHLS-UPC-NBR                                    20260000
                                   TO PV-HOLD-UPC-NBR-9.                20270000
           MOVE PV-KOHLS-DUMMY-SKU-N                                    20280000
                                   TO XST00010-SKU-NBR.                 20290000
           MOVE PV-KOHLS-DEPT      TO DL1-DEPT.                         20300000
           MOVE PV-KOHLS-CL-9      TO XST00013-SUB-CL-NBR.              20310000
           MOVE ZERO               TO PV-KOHLS-CL-2.                    20320000
           MOVE PV-KOHLS-CL-9      TO XST00013-MAJ-CL-NBR.              20330000
                                                                        20340000
           IF XST00013-MAJ-CL-NBR < PC-100                              20350000
                   AND XST00013-SUB-CL-NBR < PC-100                     20360000
               MOVE XST00013-MAJ-CL-NBR                                 20370000
                                   TO DL1-CLASS-1                       20380000
               MOVE XST00013-SUB-CL-NBR                                 20390000
                                   TO DL1-SUBCLASS-1                    20400000
           ELSE IF                                                      20410000
               XST00013-MAJ-CL-NBR < PC-100                             20420000
                       AND XST00013-SUB-CL-NBR > PC-099                 20421000
               MOVE XST00013-MAJ-CL-NBR                                 20422000
                                   TO DL1-CLASS-2                       20423000
               MOVE XST00013-SUB-CL-NBR                                 20424000
                                   TO DL1-SUBCLASS-2                    20425000
               MOVE SPACES         TO DL1-FILLER-2A                     20426000
                                      DL1-FILLER-2B                     20427000
           ELSE IF                                                      20428000
               XST00013-MAJ-CL-NBR > PC-099                             20429000
                       AND XST00013-SUB-CL-NBR < PC-100                 20430000
               MOVE XST00013-MAJ-CL-NBR                                 20440000
                                   TO DL1-CLASS-3                       20450000
               MOVE XST00013-SUB-CL-NBR                                 20460000
                                   TO DL1-SUBCLASS-3                    20470000
               MOVE SPACES         TO DL1-FILLER-3A                     20480000
                                      DL1-FILLER-3B                     20490000
           ELSE IF                                                      20500000
               XST00013-MAJ-CL-NBR > PC-099                             20510000
                       AND XST00013-SUB-CL-NBR > PC-099                 20520000
               MOVE XST00013-MAJ-CL-NBR                                 20530000
                                   TO DL1-CLASS-4                       20540000
               MOVE XST00013-SUB-CL-NBR                                 20550000
                                   TO DL1-SUBCLASS-4                    20560000
               MOVE SPACES         TO DL1-FILLER-4A                     20570000
                                      DL1-FILLER-4B                     20580000
           END-IF                                                       20590000
           END-IF                                                       20600000
           END-IF                                                       20610000
           END-IF.                                                      20620000
                                                                        20630000
      *----------------------------------------------------------------*20640000
      * OBTAIN SKU INFORMATION                                          20650000
      *----------------------------------------------------------------*20660000
       5000-READ-SKU.                                                   20670000
           INITIALIZE DCLXST00010.                                      20680000
           INITIALIZE DCLXST00012.                                      20690000
           INITIALIZE DCLXST00013.                                      20700000
           INITIALIZE DCLXST00018.                                      20710000
                                                                        20720000
           EXEC SQL                                                     20730000
               SELECT B.SKU_DESC                                        20740000
                    , B.SIZE_DESC                                       20750000
                    , B.NRF_CLOR_DESC                                   20760000
                    , B.SKU_NBR                                         20770000
                    , C.VS_NBR                                          20780000
                    , C.DEPT_NBR                                        20790000
                    , C.MAJ_CL_NBR                                      20800000
                    , C.SUB_CL_NBR                                      20810000
                    , C.ENT_ID                                          20820000
                    , C.LBL_NM                                          20830000
                    , D.ENT_NM_DESC                                     20840000
                  INTO :XST00010-SKU-DESC                               20850000
                     , :XST00010-SIZE-DESC                              20860000
                     , :XST00010-NRF-CLOR-DESC                          20870000
                     , :XST00010-SKU-NBR                                20871000
                     , :XST00013-VS-NBR                                 20872000
                     , :XST00013-DEPT-NBR                               20873000
                     , :XST00013-MAJ-CL-NBR                             20874000
                     , :XST00013-SUB-CL-NBR                             20875000
                     , :XST00013-ENT-ID                                 20876000
                     , :XST00013-LBL-NM                                 20877000
                     , :XST00018-ENT-NM-DESC                            20878000
                  FROM XST_UPC      A                                   20879000
                     , XST_SKU      B                                   20880000
                     , XST_VND_STYL C                                   20890000
                     , XST_VND      D                                   20900000
                  WHERE  A.UPC_NBR         =  :TFITEM-KOHLS-UPC-NBR     20910000
                    AND  B.INTR_UPC_ID     =  A.INTR_UPC_ID             20920000
                    AND  C.STYL_ID         =  B.STYL_ID                 20930000
                    AND  D.ENT_ID          =  C.ENT_ID                  20940000
                   WITH  UR                                             20950000
           END-EXEC                                                     20960000
                                                                        20970000
           EVALUATE SQLCODE                                             20980000
               WHEN ZERO                                                20990000
                   CONTINUE                                             21000000
               WHEN +100                                                21010000
                   MOVE 'SKU IS NO LONGER VALID'                        21020000
                                   TO XST00010-SKU-DESC                 21030000
               WHEN OTHER                                               21040000
                   IF SQLCODE = -904 OR -911 OR -913                    21050000
                       SET PS-CONTENTION                                21060000
                                   TO TRUE                              21070000
                   END-IF                                               21080000
                   MOVE '5000-READ-SKU'                                 21090000
                                   TO DP013-PARAGRAPH                   21100000
                   SET PS-ERROR    TO TRUE                              21110000
                   MOVE DK-UPC-NBR TO PVE-UPC                           21120000
                   MOVE PVE-UPC-ERROR                                   21130000
                                   TO PV-ERROR-KEY                      21140000
                   MOVE PC-READ-SKU-MSG                                 21150000
                                   TO PV-ERROR-MSG                      21160000
                   MOVE PRV-11     TO DP013-MESSAGE-TEXT (1)            21170000
                   PERFORM 9000-RETURN-MSG                              21180000
                   MOVE PV-DISPLAY-KEYS                                 21190000
                                   TO DP013-MESSAGE-TEXT (2)            21200000
                   MOVE SQLCA      TO DP013-SQLCA                       21210000
                   MOVE 'XST_UPC ' TO DP013-DB2-TABLE-NAME (1)          21220000
                   MOVE 'XST_SKU ' TO DP013-DB2-TABLE-NAME (2)          21230000
                   MOVE 'XST_VND_STYL'                                  21240000
                                   TO DP013-DB2-TABLE-NAME (3)          21250000
                   SET DP013-LINK-RETURN                                21260000
                       DP013-DB2-ABEND                                  21270000
                       DP013-NO-ROLLBACK                                21280000
                                   TO TRUE                              21290000
                   PERFORM DP014-0000-PROCESS-ABEND                     21291000
           END-EVALUATE.                                                21292000
                                                                        21293000
      *----------------------------------------------------------------*21294000
      *  WRITE THE DATA TO THE HEADING LINES VIA DRS.                   21295000
      *----------------------------------------------------------------*21296000
       7500-PRINT-HEADINGS.                                             21297000
                                                                        21298000
           ADD 1                   TO  PV-PAGE-COUNT.                   21299000
           MOVE PV-PAGE-COUNT      TO  HL1-PAGE.                        21300000
                                                                        21310000
           MOVE HL1-HEADING-LINE   TO  DRS01-COMM-DATA.                 21320000
           MOVE PC-TOP-OF-PAGE     TO DRS01-COMM-CTL.                   21330000
           PERFORM 8000-LINK-TO-DRS.                                    21340000
                                                                        21350000
           MOVE HL2-HEADING-LINE   TO  DRS01-COMM-DATA.                 21360000
           MOVE PC-SINGLE-SPACE    TO  DRS01-COMM-CTL.                  21370000
           PERFORM 8000-LINK-TO-DRS.                                    21380000
                                                                        21390000
           MOVE HL3-HEADING-LINE   TO  DRS01-COMM-DATA.                 21400000
           MOVE PC-DOUBLE-SPACE    TO  DRS01-COMM-CTL                   21410000
           PERFORM 8000-LINK-TO-DRS.                                    21420000
                                                                        21430000
           MOVE HL4-HEADING-LINE   TO  DRS01-COMM-DATA.                 21440000
           MOVE PC-SINGLE-SPACE    TO  DRS01-COMM-CTL.                  21450000
           PERFORM 8000-LINK-TO-DRS.                                    21460000
                                                                        21470000
           MOVE HL5-HEADING-LINE   TO  DRS01-COMM-DATA.                 21480000
           MOVE PC-SINGLE-SPACE    TO  DRS01-COMM-CTL                   21490000
           PERFORM 8000-LINK-TO-DRS.                                    21500000
                                                                        21510000
           MOVE HL6-HEADING-LINE   TO  DRS01-COMM-DATA.                 21520000
           MOVE PC-SINGLE-SPACE    TO  DRS01-COMM-CTL                   21530000
           PERFORM 8000-LINK-TO-DRS.                                    21540000
                                                                        21550000
           MOVE HL7-HEADING-LINE   TO  DRS01-COMM-DATA.                 21560000
           MOVE PC-SINGLE-SPACE    TO  DRS01-COMM-CTL                   21570000
           PERFORM 8000-LINK-TO-DRS.                                    21580000
                                                                        21590000
           MOVE HL8-HEADING-LINE   TO  DRS01-COMM-DATA.                 21600000
           MOVE PC-SINGLE-SPACE    TO  DRS01-COMM-CTL                   21610000
           PERFORM 8000-LINK-TO-DRS.                                    21620000
                                                                        21630000
           MOVE HL9-HEADING-LINE   TO  DRS01-COMM-DATA.                 21640000
           MOVE PC-SINGLE-SPACE    TO  DRS01-COMM-CTL                   21650000
           PERFORM 8000-LINK-TO-DRS.                                    21660000
                                                                        21670000
021605     IF TFMSTR-XFER-TYP-CDE = TF007-NON-RETAIL                    21680000
               MOVE CH1A-COLUMN-HEADING-1A                              21690000
                                   TO  DRS01-COMM-DATA                  21700000
           ELSE                                                         21710000
      **       MOVE CH1-COLUMN-HEADING-1                                21720000
      **                           TO  DRS01-COMM-DATA                  21730000
               MOVE SPACES         TO  DRS01-COMM-DATA                  21740000
           END-IF.                                                      21750000
           MOVE PC-DOUBLE-SPACE    TO  DRS01-COMM-CTL.                  21760000
           PERFORM 8000-LINK-TO-DRS.                                    21770000
                                                                        21780000
           MOVE SPACES             TO  DRS01-COMM-DATA.                 21790000
           MOVE PC-SINGLE-SPACE    TO  DRS01-COMM-CTL                   21800000
           PERFORM 8000-LINK-TO-DRS.                                    21810000
                                                                        21820000
           MOVE +1                 TO PV-LINE-COUNT.                    21830000
                                                                        21840000
      *----------------------------------------------------------------*21850000
      * THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     21860000
      *----------------------------------------------------------------*21870000
       8000-LINK-TO-DRS.                                                21880000
                                                                        21890000
      *  CAUTION:  ANY NON-BLANK CHARACTER IN PRINT POSITION 132        21900000
      *            WILL CAUSE DOUBLE-SPACING REGARDLESS OF THE          21910000
      *            CONTENTS OF CARRIAGE CONTROL CHARACTER.              21920000
           EXEC CICS                                                    21930000
               LINK                                                     21940000
                   PROGRAM   ('DRS1INTC')                               21950000
                   COMMAREA  (DRS01-COMMAREA)                           21960000
           END-EXEC.                                                    21970000
                                                                        21980000
           EVALUATE TRUE                                                21990000
               WHEN DRS01-DRRB-RC = ZERO                                22000000
                   CONTINUE                                             22010000
               WHEN OTHER                                               22020000
                   MOVE '8000-LINK-TO-DRS'                              22030000
                                   TO DP013-PARAGRAPH                   22040000
                   MOVE PRV-14     TO DP013-MESSAGE-TEXT (1)            22050000
                   PERFORM 9000-RETURN-MSG                              22060000
                   MOVE PV-DISPLAY-KEYS                                 22070000
                                   TO DP013-MESSAGE-TEXT (2)            22080000
                   SET PS-ERROR                                         22090000
                       DP013-LINK-RETURN                                22100000
                       DP013-OTHER-ABEND                                22110000
                       DP013-NO-ROLLBACK                                22120000
                                   TO TRUE                              22130000
                   MOVE DRS01-DRRB-FUNC                                 22140000
                                   TO PV-DRS-DRRB-FUNC                  22150000
                   MOVE DRS01-DRRB-RID                                  22160000
                                   TO PV-DRS-DRRB-RID                   22170000
                   MOVE DRS01-DRRD-OPTIONS                              22180000
                                   TO PV-DRS-DRRB-OPTIONS               22190000
                   MOVE DRS01-DRRB-RC                                   22200000
                                   TO PV-DRS-DRRB-RC                    22210000
                   MOVE DRS01-DRRB-ATTR-ERROR                           22220000
                                   TO PV-DRS-ATTR-ERROR                 22230000
                   MOVE DRS01-DRRB-DRDC                                 22240000
                                   TO PV-DRS-DRRB-DRDC                  22250000
                   MOVE DRS01-DRRB01-LINES                              22251000
                                   TO PV-DRS-DRRB-LINES                 22252000
                   MOVE PV-DRS-ABEND-DISPLAY-LINE1                      22253000
                                   TO DP013-MESSAGE-TEXT (3)            22254000
                   MOVE PV-DRS-ABEND-DISPLAY-LINE                       22255000
                                   TO DP013-MESSAGE-TEXT (4)            22256000
                   PERFORM DP014-0000-PROCESS-ABEND                     22257000
           END-EVALUATE.                                                22258000
                                                                        22259000
      *----------------------------------------------------------------*22260000
      * THIS MODULE EXECUTES A LINK TO DRS USING COMMAREA 3 WHICH IS    22270000
      * THE COMBINED DRS REQUEST BLOCK AND OUTPUT BLOCK FOR THE         22280000
      * CREATION OF OUTPUT JCL STATEMENTS. THESE JCL STATEMENTS ALLOW   22290000
      * REFERENCING OF PAGEDEF AND FORMDEF STATEMENTS FOR PRINTING AFP  22300000
      * DOCUMENTS VIA DRS.                                              22310000
      *----------------------------------------------------------------*22320000
       8050-LINK-TO-DRS.                                                22330000
                                                                        22340000
      *  CAUTION:  ANY NON-BLANK CHARACTER IN PRINT POSITION 132        22350000
      *            WILL CAUSE DOUBLE-SPACING REGARDLESS OF THE          22360000
      *            CONTENTS OF CARRIAGE CONTROL CHARACTER.              22370000
           EXEC CICS                                                    22380000
               LINK                                                     22390000
                   PROGRAM   ('DRS1INTC')                               22400000
                   COMMAREA  (DRS05-COMMAREA)                           22410000
           END-EXEC.                                                    22420000
                                                                        22430000
           EVALUATE TRUE                                                22440000
               WHEN DRS01-DRRB-RC = ZERO                                22450000
                   CONTINUE                                             22460000
               WHEN OTHER                                               22470000
                   MOVE '8050-LINK-TO-DRS'                              22480000
                                   TO DP013-PARAGRAPH                   22490000
                   MOVE PRV-14     TO DP013-MESSAGE-TEXT (1)            22500000
                   PERFORM 9000-RETURN-MSG                              22510000
                   MOVE PV-DISPLAY-KEYS                                 22520000
                                   TO DP013-MESSAGE-TEXT (2)            22530000
                   SET PS-ERROR                                         22540000
                       DP013-LINK-RETURN                                22550000
                       DP013-OTHER-ABEND                                22560000
                       DP013-NO-ROLLBACK                                22570000
                                   TO TRUE                              22580000
                   MOVE DRS05-DRRB-FUNC                                 22590000
                                   TO PV-DRS-DRRB-FUNC                  22600000
                   MOVE DRS05-DRRB-RID                                  22610000
                                   TO PV-DRS-DRRB-RID                   22620000
                   MOVE DRS05-DRRD-OPTIONS                              22630000
                                   TO PV-DRS-DRRB-OPTIONS               22640000
                   MOVE DRS05-DRRB-RC                                   22650000
                                   TO PV-DRS-DRRB-RC                    22660000
                   MOVE DRS05-DRRB-ATTR-ERROR                           22670000
                                   TO PV-DRS-ATTR-ERROR                 22680000
                   MOVE DRS05-DRRB-DRDC                                 22690000
                                   TO PV-DRS-DRRB-DRDC                  22700000
                   MOVE DRS05-DRRB01-LINES                              22710000
                                   TO PV-DRS-DRRB-LINES                 22720000
                   MOVE PV-DRS-ABEND-DISPLAY-LINE1                      22730000
                                   TO DP013-MESSAGE-TEXT (3)            22740000
                   MOVE PV-DRS-ABEND-DISPLAY-LINE                       22741000
                                   TO DP013-MESSAGE-TEXT (4)            22742000
                   PERFORM DP014-0000-PROCESS-ABEND                     22743000
           END-EVALUATE.                                                22744000
      *----------------------------------------------------------------*22745000
      * FORMAT THE ERROR REPORT HEADING DATE AND TIME FIELDS.           22746000
      *----------------------------------------------------------------*22747000
       8100-FORMAT-TIME.                                                22748000
                                                                        22749000
           EXEC CICS                                                    22750000
               ASKTIME ABSTIME (PV-ABSTIME)                             22760000
           END-EXEC.                                                    22770000
                                                                        22780000
           EXEC CICS                                                    22790000
               FORMATTIME ABSTIME  (PV-ABSTIME)                         22800000
                          MMDDYY   (EH1-RUN-DATE)                       22810000
                          DATESEP  ('/')                                22820000
                          TIME     (EH1-RUN-TIME)                       22830000
                          TIMESEP  (':')                                22840000
           END-EXEC.                                                    22850000
                                                                        22860000
       EJECT                                                            22870000
                                                                        22880000
      *----------------------------------------------------------------*22890000
      * BUILD A CICS ERROR MESSAGE WITH DATA FROM THE PASSED COMMAREA.  22900000
      *----------------------------------------------------------------*22910000
       9000-RETURN-MSG.                                                 22920000
                                                                        22930000
           MOVE TF005-USER-ID      TO PV-DISPLAY-USER-ID.               22940000
           MOVE TF005-XFER-FROM-STORE-NBR                               22950000
                                   TO PV-DISPLAY-XFER-FROM-STORE-NBR.   22960000
           MOVE TF005-XFER-SEQ-NBR TO PV-DISPLAY-XFER-SEQ-NBR.          22970000
           MOVE TF005-PRINTER-DEST TO PV-DISPLAY-PRINTER-DEST.          22980000
                                                                        22990000
           EJECT                                                        23000000
                                                                        23010000
      *----------------------------------------------------------------*23020000
      * PRINT AN ERROR REPORT INDICATING THE REASON FOR THE PROGRAM     23030000
      * TERMINATION.                                                    23040000
      *----------------------------------------------------------------*23050000
       9100-PRINT-ERROR.                                                23060000
                                                                        23070000
           MOVE EH1-ERROR-HEADING-1                                     23080000
                                   TO  DRS01-COMM-DATA.                 23090000
           MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL.                  23100000
           PERFORM 8000-LINK-TO-DRS.                                    23110000
                                                                        23120000
           MOVE TF005-XFER-FROM-STORE-NBR                               23130000
                                   TO EH2-FROM-STORE-NBR.               23140000
           MOVE TF005-XFER-SEQ-NBR TO EH2-XFER-SEQ-NBR.                 23150000
           IF TF005-USER-ID > SPACES                                    23160000
               MOVE TF005-USER-ID  TO EH2-USER-ID                       23170000
           ELSE                                                         23180000
               MOVE 'PTC'          TO EH2-USER-ID.                      23190000
           MOVE EH2-ERROR-HEADING-2                                     23200000
                                   TO  DRS01-COMM-DATA.                 23210000
           MOVE PC-TRIPLE-SPACE    TO  DRS01-COMM-CTL.                  23220000
           PERFORM 8000-LINK-TO-DRS.                                    23230000
                                                                        23240000
           MOVE PV-ERROR-MSG       TO ED1-ERROR.                        23250000
           MOVE PV-ERROR-KEY       TO ED1-ERROR-KEY.                    23260000
           MOVE ED1-ERROR-DETAIL-1 TO  DRS01-COMM-DATA.                 23270000
           MOVE PC-TRIPLE-SPACE    TO  DRS01-COMM-CTL.                  23280000
           PERFORM 8000-LINK-TO-DRS.                                    23290000
                                                                        23300000
           IF PS-CONTENTION                                             23310000
               MOVE PC-CONTENTION-MSG                                   23320000
                                   TO ED2-MESSAGE                       23330000
               MOVE ED2-ERROR-DETAIL-2                                  23340000
                                   TO  DRS01-COMM-DATA                  23350000
               MOVE PC-TRIPLE-SPACE                                     23360000
                                   TO  DRS01-COMM-CTL                   23370000
               PERFORM 8000-LINK-TO-DRS                                 23380000
           END-IF.                                                      23390000
      *                                                                 23400000
      *    NON-CICS ARCHITECTURE ABEND ROUTINE CALL                     23410000
      *                                                                 23420000
                                                                        23430000
           COPY DPPD014.                                                23440000
