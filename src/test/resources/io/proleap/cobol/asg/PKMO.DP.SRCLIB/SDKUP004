       IDENTIFICATION DIVISION.                                         00010033
                                                                        00020033
       PROGRAM-ID.    SDKUP004.                                         00030033
       AUTHOR.        KOHLS DEPARTMENT STORES.                          00040033
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050033
       DATE-WRITTEN.  2002-03-19.                                       00060033
       DATE-COMPILED.                                                   00070033
                                                                        00080033
      ******************************************************************00090033
      *  LOAD THE MONTHLY OSA BUDGET/ADDBACK FILE (PROJBGT.CSV).        00100033
      *  FILE CONTAINS PLANNED SALES AND PAYROLL DOLLARS, PLANNED       00110033
      *  TRIPS, PLANNED TRUCK SIZES, AVERAGE HOURLY RATES NEEDED TO     00120033
      *  CALCULATE TRUCK AND SALES ADDBACK, MINIMUM AND MAXIMUM HOURS   00130033
      *  FOR POS AND SERVICE DESK.                                      00140033
      *=================================================================00150033
      * 03/28/2002 CHANGED BY:JACKIE HELING     INITIAL WRITE           00160033
      *                                                                 00170033
041403* 04/14/2003 CHANGED BY:JACKIE HELING     WR24800                 00180033
041403*    COLUMN ADDED TO INPUT FILE FOR MAX_ADD_BCK_PCT               00190033
072903* 07/29/2003 CHANGED BY:JACKIE HELING     WR25515                 00191034
072903*    COLUMNS ADDED TO INPUT FILE FOR TRUCK MERCHANDISING AHR,     00192034
072903*    UNLOAD INDICATOR AND MERCHANDISE INDICATOR.                  00193034
012705* 01/27/2005 CHANGED BY:JACKIE HELING     WR27926                 00194048
012705*    COLUMNS ADDED TO INPUT FILE FOR NEGATIVE WITHHOLDING PERCENT 00195048
032105* 03/21/2005 CHANGED BY:JACKIE HELING     WR28285                 00196053
032105*    DELETE COLUMNS FROM FILE, NO LONGER PROCESS ADD BACK CODES   00197053
032105*    IN THIS PROGRAM.  MOVED TO SDKUP007.                         00198053
063005* 06/30/2005 CHANGED BY:JACKIE HELING     WR28964                 00199059
063005*    EFFECTIVE DATE FILE                                          00199159
071205* 07/12/2005 CHANGED BY:JACKIE HELING     WR28964                 00199262
071205*    CHANGE DATE HEADER FORMAT                                    00199362
082905* 08/29/2005 CHANGED BY:JACKIE HELING     WR29109                 00199472
082905*    ADD TASK SALES MINIMUM COLUMNS TO INPUT FILE, CHANGE FORMAT  00199572
082905*    OF NEGATIVE CAP PERCENT IN INPUT FILE.                       00199672
032006* 03/20/2006 CHANGED BY:JACKIE HELING     WR30066                 00199775
032006*    CONTINUOUS FLOW AHR                                          00199875
032006* 08/09/2007 CHANGED BY:CHERI KRYSIAK     WR32675                 00199977
032006*    ELIMINATED UNLOAD AND MERCH WAGES                            00200076
100609* 10/06/2009 CHANGED BY:JACKIE HELING     WR35177                 00200188
100609*    REMOVE REFERENCE TO OBSOLETE TABLE, FORMAT CHANGES TO INPUT  00200288
      ******************************************************************00201033
                                                                        00210033
       ENVIRONMENT DIVISION.                                            00220033
       CONFIGURATION SECTION.                                           00230033
                                                                        00240033
       SOURCE-COMPUTER.  IBM-3090.                                      00250033
       OBJECT-COMPUTER.  IBM-3090.                                      00260033
                                                                        00270033
       INPUT-OUTPUT SECTION.                                            00280033
       FILE-CONTROL.                                                    00290033
                                                                        00300033
           SELECT OSA-PSALES-FILE                                       00310033
                  ASSIGN TO INP01.                                      00320033
                                                                        00350033
       DATA DIVISION.                                                   00360033
       FILE SECTION.                                                    00370033
                                                                        00380033
       FD  OSA-PSALES-FILE                                              00390033
           RECORDING MODE IS F                                          00400033
           LABEL RECORDS ARE STANDARD                                   00410033
100609     RECORD CONTAINS 500 CHARACTERS                               00421088
           BLOCK CONTAINS 0 RECORDS                                     00430033
           DATA RECORD IS OSA-PSALES-RECORD.                            00440033
                                                                        00441085
100609 01  OSA-PSALES-RECORD               PIC X(500).                  00450088
                                                                        00460033
                                                                        00550033
       WORKING-STORAGE SECTION.                                         00560033
      ******************************************************************00570033
      * PROGRAM SWITCHES                                                00580033
      ******************************************************************00590033
       01  PS-PROGRAM-SWITCHES.                                         00600033
           05  PS-END-OF-PSALES-FILE-SW    PIC X(01)  VALUE 'N'.        00610033
               88  PS-END-OF-PSALES-FILE              VALUE 'Y'.        00620033
               88  PS-NOT-END-OF-PSALES-FILE          VALUE 'N'.        00630033
                                                                        00640033
      ******************************************************************00770033
      * OSA PSALES FILE HEADER CHECK LAYOUT                             00780033
      ******************************************************************00790033
       01  OSA-PSALES-LAYOUT.                                           00800033
           05  OSA-PSALES-DATA-CHECK       PIC X(01)  VALUE SPACES.     00810033
100609     05  FILLER                      PIC X(499) VALUE SPACES.     00820088
                                                                        00830033
      ******************************************************************00831054
      * DATE HEADER LAYOUT                                              00832054
      ******************************************************************00833054
063005 01  DATE-FILE-LAYOUT.                                            00834059
063005     05  DATE-FILE-MONTH             PIC 9(02)  VALUE ZEROES.     00835059
063005     05  FILLER                      PIC X(01)  VALUE SPACES.     00836059
071205     05  DATE-FILE-DAY               PIC 9(02)  VALUE ZEROES.     00836162
071205     05  FILLER                      PIC X(01)  VALUE SPACES.     00836262
063005     05  DATE-FILE-YEAR              PIC 9(04)  VALUE ZEROES.     00836359
071205     05  FILLER                      PIC X(190) VALUE SPACES.     00836462
                                                                        00837054
      ******************************************************************00840033
      * PROGRAM CONSTANTS                                               00850033
      ******************************************************************00860033
       01  PC-PROGRAM-CONSTANTS.                                        00870033
           05  PC-UPDATE-USER-ID           PIC  X(08) VALUE 'BATCH   '. 00880033
           05  PC-JOB-NM-ID-POS            PIC S9(04) VALUE 568.        00890033
           05  PC-JOB-NM-ID-CS             PIC S9(04) VALUE 596.        00900033
           05  PC-JOB-NM-ID-TRK            PIC S9(04) VALUE 45.         00910033
           05  PC-SALES                    PIC  X(01) VALUE 'S'.        00920033
           05  PC-TRUCK                    PIC  X(01) VALUE 'T'.        00930033
072903     05  PC-TRUCK-MERCH              PIC  X(01) VALUE 'M'.        00931039
032006     05  PC-CF-MERCH                 PIC  X(01) VALUE 'C'.        00932075
032006     05  PC-CF-UNLOAD                PIC  X(01) VALUE 'U'.        00933075
           05  PC-ZERO                     PIC  9(01) VALUE  0.         00940033
           05  PC-PLANNED                  PIC  X(02) VALUE 'PL'.       00950033
100609     05  PC-DIRECT                   PIC  X(02) VALUE 'PD'.       00951088
100609     05  PC-INDIRECT                 PIC  X(02) VALUE 'PI'.       00952088
           05  PC-PROJECTED                PIC  X(02) VALUE 'PR'.       00960033
082905     05  PC-TSK-RECOV                PIC  9(03) VALUE 98.         00961072
082905     05  PC-TSK-FILLIN               PIC  9(03) VALUE 100.        00962072
082905     05  PC-TSK-FITRM                PIC  9(03) VALUE 99.         00963072
                                                                        00970033
      ******************************************************************00980033
      * PROGRAM CALCULATIONS                                            00990033
      ******************************************************************01000033
       01  PC-PROGRAM-CALCULATIONS.                                     01010033
           05  PC-TRUCK-WAGE               PIC  9(03)V99 VALUE ZEROS.   01020033
072903     05  PC-TRUCK-MERCH-WAGE         PIC  9(03)V99 VALUE ZEROS.   01021039
080907*    05  PC-CF-MERCH-WAGE            PIC  9(03)V99 VALUE ZEROS.   01022077
080907*    05  PC-CF-UNLOAD-WAGE           PIC  9(03)V99 VALUE ZEROS.   01023077
           05  PC-SALES-WAGE               PIC  9(03)V99 VALUE ZEROS.   01030033
           05  PC-TRUCK-FT-HRS             PIC  9(03)V99 VALUE ZEROS.   01040033
           05  PC-ADDBACK-PCNT             PIC  9(03)V99 VALUE ZEROS.   01050033
           05  PC-WHLDG-PCT                PIC  9(03)V99 VALUE ZEROS.   01060033
012705     05  PC-NEG-WHLDG-PCT            PIC  9(03)V99 VALUE ZEROS.   01061048
041403     05  PC-ADDBCK-CAP-PCT           PIC  9(03)V99 VALUE ZEROS.   01070033
                                                                        01080033
      ******************************************************************01090033
      * UNSTRING VARIABLES - IN INPUT FILE LAYOUT ORDER                 01100033
      ******************************************************************01110033
       01  UV-UNSTRING-VARIABLES.                                       01120033
           05  UV-STORE-NBR                PIC  9(04) VALUE ZEROS.      01130033
           05  UV-WEEK-1-SALES             PIC  9(08) VALUE ZEROS.      01140033
           05  UV-WEEK-2-SALES             PIC  9(08) VALUE ZEROS.      01150033
           05  UV-WEEK-3-SALES             PIC  9(08) VALUE ZEROS.      01160033
           05  UV-WEEK-4-SALES             PIC  9(08) VALUE ZEROS.      01170033
           05  UV-WEEK-5-SALES             PIC  9(08) VALUE ZEROS.      01180033
           05  UV-FILLER1                  PIC  X(01) VALUE SPACES.     01190033
                                                                        01200033
           05  UV-WEEK-1-PYRLL             PIC  9(06) VALUE ZEROS.      01210033
           05  UV-WEEK-2-PYRLL             PIC  9(06) VALUE ZEROS.      01220033
           05  UV-WEEK-3-PYRLL             PIC  9(06) VALUE ZEROS.      01230033
           05  UV-WEEK-4-PYRLL             PIC  9(06) VALUE ZEROS.      01240033
           05  UV-WEEK-5-PYRLL             PIC  9(06) VALUE ZEROS.      01250033
           05  UV-FILLER2                  PIC  X(01) VALUE SPACES.     01260033
                                                                        01270033
           05  UV-WEEK-1-TRUCKS            PIC  9(02) VALUE ZEROS.      01280033
           05  UV-WEEK-2-TRUCKS            PIC  9(02) VALUE ZEROS.      01290033
           05  UV-WEEK-3-TRUCKS            PIC  9(02) VALUE ZEROS.      01300033
           05  UV-WEEK-4-TRUCKS            PIC  9(02) VALUE ZEROS.      01310033
           05  UV-WEEK-5-TRUCKS            PIC  9(02) VALUE ZEROS.      01320033
           05  UV-FILLER3                  PIC  X(01) VALUE SPACES.     01330033
                                                                        01340033
           05  UV-TRUCK-SIZE               PIC  9(03) VALUE ZEROS.      01350033
           05  UV-TRUCK-WAGE               PIC  X(05) VALUE SPACES.     01360033
072903     05  UV-TRUCK-MERCH-WAGE         PIC  X(05) VALUE SPACES.     01371039
           05  UV-SALES-ADDBACK-WAGE       PIC  X(05) VALUE SPACES.     01380033
                                                                        01400033
           05  UV-POS-MIN-HRS              PIC  9(05) VALUE ZEROS.      01410033
           05  UV-POS-MAX-HRS              PIC  9(05) VALUE ZEROS.      01420033
           05  UV-CS-MIN-HRS               PIC  9(05) VALUE ZEROS.      01430033
           05  UV-CS-MAX-HRS               PIC  9(05) VALUE ZEROS.      01440033
           05  UV-WHLDG-PCT                PIC  X(07) VALUE SPACES.     01450033
041403     05  UV-ADDBCK-CAP-PCT           PIC  X(07) VALUE SPACES.     01460033
012705     05  UV-NEG-WHLDG-PCT            PIC  X(07) VALUE SPACES.     01463048
082905     05  UV-FILLER4                  PIC  X(01) VALUE SPACES.     01463172
082905     05  UV-RECOV-SLS-MIN            PIC  9(06) VALUE ZEROES.     01464072
082905     05  UV-FITRM-SLS-MIN            PIC  9(06) VALUE ZEROES.     01464172
082905     05  UV-FILLIN-SLS-MIN           PIC  9(06) VALUE ZEROES.     01465072
032006     05  UV-FILLER5                  PIC  X(01) VALUE SPACES.     01465175
100609     05  UV-PL-PYRL-HRS-WK1          PIC  9(07) VALUE ZEROS.      01465288
100609     05  UV-PL-PYRL-HRS-WK2          PIC  9(07) VALUE ZEROS.      01465388
100609     05  UV-PL-PYRL-HRS-WK3          PIC  9(07) VALUE ZEROS.      01465488
100609     05  UV-PL-PYRL-HRS-WK4          PIC  9(07) VALUE ZEROS.      01465588
100609     05  UV-PL-PYRL-HRS-WK5          PIC  9(07) VALUE ZEROS.      01465688
100609     05  UV-PD-PYRL-HRS-WK1          PIC  9(07) VALUE ZEROS.      01465788
100609     05  UV-PD-PYRL-HRS-WK2          PIC  9(07) VALUE ZEROS.      01465888
100609     05  UV-PD-PYRL-HRS-WK3          PIC  9(07) VALUE ZEROS.      01465988
100609     05  UV-PD-PYRL-HRS-WK4          PIC  9(07) VALUE ZEROS.      01466088
100609     05  UV-PD-PYRL-HRS-WK5          PIC  9(07) VALUE ZEROS.      01466188
100609     05  UV-PI-PYRL-HRS-WK1          PIC  9(07) VALUE ZEROS.      01466288
100609     05  UV-PI-PYRL-HRS-WK2          PIC  9(07) VALUE ZEROS.      01466388
100609     05  UV-PI-PYRL-HRS-WK3          PIC  9(07) VALUE ZEROS.      01466488
100609     05  UV-PI-PYRL-HRS-WK4          PIC  9(07) VALUE ZEROS.      01466588
100609     05  UV-PI-PYRL-HRS-WK5          PIC  9(07) VALUE ZEROS.      01466688
100609     05  UV-PD-PYRL-DLRS-WK1         PIC  9(07) VALUE ZEROS.      01466788
100609     05  UV-PD-PYRL-DLRS-WK2         PIC  9(07) VALUE ZEROS.      01466888
100609     05  UV-PD-PYRL-DLRS-WK3         PIC  9(07) VALUE ZEROS.      01466988
100609     05  UV-PD-PYRL-DLRS-WK4         PIC  9(07) VALUE ZEROS.      01467088
100609     05  UV-PD-PYRL-DLRS-WK5         PIC  9(07) VALUE ZEROS.      01467188
100609     05  UV-PI-PYRL-DLRS-WK1         PIC  9(07) VALUE ZEROS.      01468088
100609     05  UV-PI-PYRL-DLRS-WK2         PIC  9(07) VALUE ZEROS.      01469088
100609     05  UV-PI-PYRL-DLRS-WK3         PIC  9(07) VALUE ZEROS.      01469188
100609     05  UV-PI-PYRL-DLRS-WK4         PIC  9(07) VALUE ZEROS.      01469288
100609     05  UV-PI-PYRL-DLRS-WK5         PIC  9(07) VALUE ZEROS.      01469388
                                                                        01470033
      ***BELOW ARE NOT PART OF INPUT LAYOUT                             01480033
           05  UV-DOLLARS                  PIC  9(03) VALUE ZEROS.      01490033
           05  UV-CHANGE                   PIC  9(03)V99 VALUE ZEROS.   01500033
                                                                        01510033
      ******************************************************************01520033
      * DATE VARIABLES                                                  01530033
      ******************************************************************01540033
       01  PD-PROGRAM-DATE-VARIABLES.                                   01550033
           05  PD-MONTH-START              PIC  X(10) VALUE SPACES.     01560033
           05  PD-MONTH-END                PIC  X(10) VALUE SPACES.     01570033
           05  PD-WEEKS-IN-MONTH           PIC  9(01) VALUE ZEROS.      01580033
           05  PD-TIME-STAMP               PIC  X(26) VALUE SPACES.     01590033
                                                                        01600033
      ******************************************************************01610033
      * TIME FIELDS                                                     01620033
      ******************************************************************01630033
       01  SD-TIME-STAMP                   PIC  X(26)  VALUE SPACES.    01640033
       01  FILLER REDEFINES SD-TIME-STAMP.                              01650033
           05  SD-CURR-DTE                 PIC  X(10).                  01660033
           05  FILLER                      PIC  X(01).                  01670033
           05  SD-HOUR                     PIC  X(02).                  01680033
           05  FILLER                      PIC  X(01).                  01690033
           05  SD-MINUTE                   PIC  X(02).                  01700033
           05  FILLER                      PIC  X(01).                  01710033
           05  SD-SECOND                   PIC  X(02).                  01720033
           05  FILLER                      PIC  X(01).                  01730033
           05  SD-MICROSEC                 PIC  X(06).                  01740033
                                                                        01750033
      ******************************************************************01760033
      * PROGRAM ABEND FIELDS                                            01770033
      ******************************************************************01780033
       01  PV-MISC-ABEND-FIELDS.                                        01790033
           05  ABEND-CODE                   PIC S9(4)  VALUE ZEROS      01800033
                                                     COMP SYNC.         01810033
           05  PV-PARAGRAPH-NAME            PIC  X(30) VALUE SPACE.     01820033
           05  PV-PROGRAM-NAME              PIC  X(09) VALUE 'SDKUP004'.01830033
           05  PV-OPERATION-MSG-1           PIC  X(40) VALUE SPACE.     01840033
           05  PV-OPERATION-MSG-2           PIC  X(40) VALUE SPACE.     01850033
           05  PV-DB2-OPERATION             PIC  X(30) VALUE SPACE.     01860033
                                                                        01870033
063005 01  PV-DATE.                                                     01880059
063005     05  PV-YEAR                      PIC  9(04) VALUE ZEROS.     01890059
063005     05  FILLER                       PIC  X(01) VALUE '-'.       01890159
063005     05  PV-MONTH                     PIC  9(02) VALUE ZEROS.     01890259
063005     05  FILLER                       PIC  X(01) VALUE '-'.       01890359
063005     05  PV-DAY                       PIC  9(02) VALUE 15.        01890459
                                                                        01891055
       01  PV-PROGRAM-COUNTS.                                           01892055
           05  PV-ROWS-UPDATED-SALES        PIC  9(05) VALUE ZEROS.     01893055
           05  PV-ROWS-UPDATED-ADDBCK       PIC  9(05) VALUE ZEROS.     01900033
           05  PV-ROWS-UPDATED-JOB-LBR-STD  PIC  9(05) VALUE ZEROS.     01910033
082905     05  PV-ROWS-UPDATED-TSK-SLS-MIN  PIC  9(05) VALUE ZEROS.     01911072
           05  PV-ROWS-INSERTED-SALES       PIC  9(05) VALUE ZEROS.     01920033
           05  PV-ROWS-INSERTED-ADDBCK      PIC  9(05) VALUE ZEROS.     01940033
           05  PV-ROWS-INSERTED-JOB-LBR-STD PIC  9(05) VALUE ZEROS.     01950033
082905     05  PV-ROWS-INSERTED-TSK-SLS-MIN PIC  9(05) VALUE ZEROS.     01951072
           05  PV-RECORDS-READ              PIC  9(05) VALUE ZEROS.     01960033
                                                                        01970033
      ******************************************************************01980033
      * INTERNAL TABLES                                                 01990033
      ******************************************************************02000033
       01  PT-PROGRAM-TABLES.                                           02010033
           05  PT-FISCAL-WEEK-TABLE.                                    02020033
               10  PT-FISCAL-WEEK-ENTRIES OCCURS 5 TIMES.               02030033
                   15  PT-FISCAL-WEEK      PIC X(10).                   02040033
                                                                        02050033
       01  PT-PROGRAM-TABLES-DYNAMIC.                                   02060033
           05  PT-FCL-WK-BUDGET-TABLE.                                  02070033
               10  PT-FCL-WK-BUDGET-ENTRIES OCCURS 5 TIMES.             02080033
                   15  PT-FCL-WK-SALES     PIC 9(09).                   02090033
                   15  PT-FCL-WK-PAYROLL   PIC 9(09).                   02100033
100609             15  PT-FCL-WK-PYRL-HRS  PIC 9(07).                   02101088
                                                                        02110033
100609     05  PT-DIRECT-PYRL-TABLE.                                    02111088
100609         10  PT-DIRECT-PYRL-ENTRIES OCCURS 5 TIMES.               02112088
100609             15  PT-PD-WK-PYRL-DLRS  PIC 9(09).                   02114088
100609             15  PT-PD-WK-PYRL-HRS   PIC 9(07).                   02115088
                                                                        02116083
100609     05  PT-INDIRECT-PYRL-TABLE.                                  02117088
100609         10  PT-INDIRECT-PYRL-ENTRIES OCCURS 5 TIMES.             02118088
100609             15  PT-PI-WK-PYRL-DLRS  PIC 9(09).                   02119088
100609             15  PT-PI-WK-PYRL-HRS   PIC 9(07).                   02119188
                                                                        02119283
       01  PT-PROGRAM-TABLES-INDICES.                                   02160033
           05  F-WEEK                      PIC 9(1) VALUE ZEROS.        02170033
           05  F-BUDGET                    PIC 9(1) VALUE ZEROS.        02180033
           05  F-TRUCK                     PIC 9(1) VALUE ZEROS.        02190033
                                                                        02200033
      ******************************************************************02210033
      * COPYBOOKS                                                       02220033
      ******************************************************************02230033
      ***CALENDAR ROUTINE                                               02240033
           COPY DPWS500.                                                02250033
      ***SQLCA ROUTINE                                                  02260033
           COPY DPWS004.                                                02270043
      ***DB2 MESSAGE AREA                                               02280033
           COPY SQLCA2.                                                 02290033
                                                                        02300033
      ******************************************************************02310033
      * TABLE INCLUSIONS                                                02320033
      ******************************************************************02330033
      ***SQL COMM AREA                                                  02340033
           EXEC SQL                                                     02350033
               INCLUDE SQLCA                                            02360033
           END-EXEC.                                                    02370033
                                                                        02380033
      ***SDT_WKLY_STR_BGT TABLE                                         02390033
           EXEC SQL                                                     02400033
               INCLUDE SDT00000                                         02410033
           END-EXEC.                                                    02420033
                                                                        02430033
100907* TABLE NOT USED                                                  02431079
100907***SDT_AUD_W_STR_BGT                                              02440081
100907*    EXEC SQL                                                     02450081
100907*        INCLUDE SDT00001                                         02460081
100907*    END-EXEC.                                                    02470081
                                                                        02480033
      ***SDT_JOB_LBR_STD                                                02540033
           EXEC SQL                                                     02550033
               INCLUDE SDT00014                                         02560033
           END-EXEC.                                                    02570033
                                                                        02580033
      ***SDT_ADD_BCK_DOL                                                02590033
           EXEC SQL                                                     02600033
               INCLUDE SDT00012                                         02610033
           END-EXEC.                                                    02620033
                                                                        02650033
082905***SDT_TSK_SLS_MIN                                                02651072
082905     EXEC SQL                                                     02652072
082905         INCLUDE SDT00018                                         02653072
082905     END-EXEC.                                                    02654072
                                                                        02655061
                                                                        02656061
       PROCEDURE DIVISION.                                              02660033
      ******************************************************************02670033
      * MAINLINE                                                        02680033
      ******************************************************************02690033
       0000-MAINLINE.                                                   02700033
                                                                        02710033
           PERFORM 1000-INITIALIZATION.                                 02720033
                                                                        02730033
           PERFORM 2000-PROCESS-FILE                                    02740033
             UNTIL PS-END-OF-PSALES-FILE.                               02750033
                                                                        02760033
           PERFORM 9000-WRAPUP.                                         02770033
                                                                        02780033
           GOBACK.                                                      02790033
                                                                        02800033
                                                                        02810033
      *************************************************************     02820033
      * INITIALIZATION AREA                                             02830033
      *************************************************************     02840033
       1000-INITIALIZATION.                                             02850033
                                                                        02860033
           MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME.             02870033
                                                                        02880033
           OPEN INPUT OSA-PSALES-FILE.                                  02890055
                                                                        02910033
           PERFORM 1100-GET-TIMESTAMP.                                  02920033
063005     PERFORM 7000-READ-PLANNED-SALES-FILE.                        02931059
           PERFORM 1200-PROCESS-DATE.                                   02940033
                                                                        02950033
063005     PERFORM 7000-READ-PLANNED-SALES-FILE                         02951059
                                                                        02952054
           PERFORM 7000-READ-PLANNED-SALES-FILE                         02960033
             UNTIL OSA-PSALES-DATA-CHECK NUMERIC.                       02970033
                                                                        02980033
                                                                        02990033
      *************************************************************     03000033
      * INITIALIZATION AREA                                             03010033
      *************************************************************     03020033
       1100-GET-TIMESTAMP.                                              03030033
                                                                        03040033
           MOVE '1100-GET-TIMESTAMP' TO PV-PARAGRAPH-NAME.              03050033
                                                                        03060033
           EXEC SQL                                                     03070033
                SET :SD-TIME-STAMP = CURRENT TIMESTAMP                  03080033
           END-EXEC.                                                    03090033
                                                                        03100033
           MOVE SD-TIME-STAMP     TO PD-TIME-STAMP.                     03110033
                                                                        03120033
           IF  SQLCODE NOT EQUAL ZERO                                   03130033
               DISPLAY 'UNSUCCESSFUL SET TIMESTAMP'                     03140033
               PERFORM 9999-ABEND                                       03150033
           END-IF.                                                      03160033
                                                                        03170033
                                                                        03180033
      ******************************************************************03190033
      * RETRIEVE DATES NEEDED TO PROCESS PLANNED SALES FILE             03200033
      ******************************************************************03210033
       1200-PROCESS-DATE.                                               03220033
                                                                        03230033
           MOVE '1200-PROCESS-DATE' TO PV-PARAGRAPH-NAME                03240054
063005     MOVE OSA-PSALES-LAYOUT   TO DATE-FILE-LAYOUT.                03241059
063005     MOVE DATE-FILE-MONTH     TO PV-MONTH.                        03242059
063005     MOVE DATE-FILE-YEAR      TO PV-YEAR.                         03243059
                                                                        03250033
063005***RETRIEVE DATES OF FISCAL MONTH BEING PROCESSED                 03260059
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03270054
           SET DPG51-VALID-FISCAL-CALENDAR TO TRUE.                     03280054
           SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     03290054
           SET DPG52-LK-DTE-ISO-FMT        TO TRUE.                     03300054
063005     MOVE PV-DATE                    TO DPG52-LK-DATE-INPUT.      03311059
           PERFORM 1250-CALL-DATE-ROUTINE.                              03320054
           MOVE DPG56-LAST-FP-DB2-ISO-FMT  TO PD-MONTH-END.             03330054
           MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO PD-MONTH-START.           03331054
                                                                        03333054
                                                                        03340033
      ***RETRIEVES TOTAL NUMBER OF WEEKS IN MONTH                       03460054
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03470054
           SET DPG51-VALID-FISCAL-CALENDAR TO TRUE.                     03480054
           SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     03490054
           SET DPG52-LK-DTE-ISO-FMT        TO TRUE.                     03500054
           MOVE PD-MONTH-END               TO DPG52-LK-DATE-INPUT.      03510054
           PERFORM 1250-CALL-DATE-ROUTINE.                              03520054
           MOVE DPG56-FISCAL-PERIOD-WEEK   TO PD-WEEKS-IN-MONTH.        03530054
                                                                        03540033
      ***SETS THE FIRST ITEM IN THE TABLE TO THE FIRST WEEK END DATE    03550033
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03560033
           SET DPG51-VALID-FISCAL-CALENDAR TO TRUE.                     03570033
           SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     03580033
           SET DPG52-LK-DTE-ISO-FMT        TO TRUE.                     03590033
           MOVE PD-MONTH-START             TO DPG52-LK-DATE-INPUT.      03600033
           PERFORM 1250-CALL-DATE-ROUTINE.                              03610033
           MOVE DPG55-LAST-WKDY-DB2ISO-FMT TO PT-FISCAL-WEEK (1).       03620033
                                                                        03630033
      ***LOAD INTERNAL TABLE WITH FISCAL WEEK END-DATES                 03640033
           PERFORM 1225-RETRIEVE-WEEK-END-DATES                         03650033
                   VARYING F-WEEK FROM 2 BY 1                           03660033
                   UNTIL F-WEEK > PD-WEEKS-IN-MONTH.                    03670033
                                                                        03680033
                                                                        03690033
      ******************************************************************03700033
      * RETRIEVE END DATES OF ALL FISCAL WEEKS IN MONTH AND LOADS       03710033
      * DATES INTO AN INTERNAL TABLE.                                   03720033
      ******************************************************************03730033
       1225-RETRIEVE-WEEK-END-DATES.                                    03740033
                                                                        03750033
           MOVE '1225-RETRIEVE-WEEK-END-DATES' TO PV-PARAGRAPH-NAME.    03760033
                                                                        03770033
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03780033
           SET DPG51-VALID-FISCAL-CALENDAR TO TRUE.                     03790033
           SET DPG51-INCREMENT-DATE        TO TRUE.                     03800033
           SET DPG52-LK-DTE-ISO-FMT        TO TRUE.                     03810033
           MOVE 6                          TO DPG51-INCR-DECR-DAYS-9.   03820033
           MOVE PT-FISCAL-WEEK (F-WEEK - 1) TO DPG52-LK-DATE-INPUT.     03830033
                                                                        03840033
           PERFORM 1250-CALL-DATE-ROUTINE.                              03850033
                                                                        03860033
           MOVE DPG55-LAST-WKDY-DB2ISO-FMT TO PT-FISCAL-WEEK (F-WEEK).  03870033
                                                                        03880033
                                                                        03890033
      ******************************************************************03900033
      * CALLS DATE ROUTINE                                              03910033
      ******************************************************************03920033
       1250-CALL-DATE-ROUTINE.                                          03930033
                                                                        03940033
           MOVE '1250-CALL-DATE-ROUTINE' TO PV-PARAGRAPH-NAME           03950033
                                                                        03960033
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                03970033
                                                   DPG52                03980033
                                                   DPG53                03990033
                                                   DPG54                04000033
                                                   DPG55                04010033
                                                   DPG56.               04020033
                                                                        04030033
           EVALUATE TRUE                                                04040033
              WHEN DPG54-WARNING-ERROR                                  04050033
                   DISPLAY 'DATE ROUTINE WARNING: ' DPG54-ERROR-MESSAGE 04060033
                   DISPLAY DPG52-DB2-ISO-DATE                           04070033
                   PERFORM 9999-ABEND                                   04080033
                                                                        04090033
              WHEN DPG54-SEVERE-ERROR                                   04100033
                   DISPLAY 'DATE ROUTINE ERROR: ' DPG54-ERROR-MESSAGE   04110033
                   DISPLAY DPG52-DB2-ISO-DATE                           04120033
                   PERFORM 9999-ABEND                                   04130033
                                                                        04140033
           END-EVALUATE.                                                04150033
                                                                        04160033
                                                                        04170033
      *************************************************************     04180033
      * PROCESS INPUT FILE                                              04190033
      *************************************************************     04200033
       2000-PROCESS-FILE.                                               04210033
                                                                        04220033
           MOVE '2000-PROCESS-FILE'      TO PV-PARAGRAPH-NAME           04230033
                                                                        04240033
      ***UNSTRING INPUT CSV LAYOUT                                      04250033
           UNSTRING OSA-PSALES-LAYOUT                                   04260033
             DELIMITED BY ',' OR SPACE INTO   UV-STORE-NBR              04270071
                                   , UV-WEEK-1-SALES                    04280033
                                   , UV-WEEK-2-SALES                    04290033
                                   , UV-WEEK-3-SALES                    04300033
                                   , UV-WEEK-4-SALES                    04310033
                                   , UV-WEEK-5-SALES                    04320033
                                   , UV-FILLER1                         04330033
                                   , UV-WEEK-1-PYRLL                    04340033
                                   , UV-WEEK-2-PYRLL                    04350033
                                   , UV-WEEK-3-PYRLL                    04360033
                                   , UV-WEEK-4-PYRLL                    04370033
                                   , UV-WEEK-5-PYRLL                    04380033
                                   , UV-FILLER2                         04390033
                                   , UV-WEEK-1-TRUCKS                   04400033
                                   , UV-WEEK-2-TRUCKS                   04410033
                                   , UV-WEEK-3-TRUCKS                   04420033
                                   , UV-WEEK-4-TRUCKS                   04430033
                                   , UV-WEEK-5-TRUCKS                   04440033
                                   , UV-FILLER3                         04450033
                                   , UV-TRUCK-SIZE                      04460033
                                   , UV-TRUCK-WAGE                      04470033
072903                             , UV-TRUCK-MERCH-WAGE                04481039
                                   , UV-SALES-ADDBACK-WAGE              04490033
                                   , UV-POS-MIN-HRS                     04510033
                                   , UV-POS-MAX-HRS                     04520033
                                   , UV-CS-MIN-HRS                      04530033
                                   , UV-CS-MAX-HRS                      04540033
                                   , UV-WHLDG-PCT                       04550033
041403                             , UV-ADDBCK-CAP-PCT                  04560034
012705                             , UV-NEG-WHLDG-PCT                   04563061
082905                             , UV-FILLER4                         04564072
082905                             , UV-RECOV-SLS-MIN                   04564172
082905                             , UV-FITRM-SLS-MIN                   04564272
082905                             , UV-FILLIN-SLS-MIN                  04565074
032006                             , UV-FILLER4                         04566083
100609                             , UV-PL-PYRL-HRS-WK1                 04567088
100609                             , UV-PL-PYRL-HRS-WK2                 04568088
100609                             , UV-PL-PYRL-HRS-WK3                 04569088
100609                             , UV-PL-PYRL-HRS-WK4                 04569188
100609                             , UV-PL-PYRL-HRS-WK5                 04569288
100609                             , UV-FILLER4                         04569388
100609                             , UV-PD-PYRL-HRS-WK1                 04569488
100609                             , UV-PD-PYRL-HRS-WK2                 04569588
100609                             , UV-PD-PYRL-HRS-WK3                 04569688
100609                             , UV-PD-PYRL-HRS-WK4                 04569788
100609                             , UV-PD-PYRL-HRS-WK5                 04569888
100609                             , UV-FILLER4                         04569988
100609                             , UV-PI-PYRL-HRS-WK1                 04570088
100609                             , UV-PI-PYRL-HRS-WK2                 04570188
100609                             , UV-PI-PYRL-HRS-WK3                 04570288
100609                             , UV-PI-PYRL-HRS-WK4                 04570388
100609                             , UV-PI-PYRL-HRS-WK5                 04570488
100609                             , UV-FILLER4                         04570588
100609                             , UV-PD-PYRL-DLRS-WK1                04570688
100609                             , UV-PD-PYRL-DLRS-WK2                04570788
100609                             , UV-PD-PYRL-DLRS-WK3                04570888
100609                             , UV-PD-PYRL-DLRS-WK4                04570988
100609                             , UV-PD-PYRL-DLRS-WK5                04571088
100609                             , UV-FILLER4                         04571188
100609                             , UV-PI-PYRL-DLRS-WK1                04571288
100609                             , UV-PI-PYRL-DLRS-WK2                04571388
100609                             , UV-PI-PYRL-DLRS-WK3                04571488
100609                             , UV-PI-PYRL-DLRS-WK4                04571588
100609                             , UV-PI-PYRL-DLRS-WK5                04571688
                                                                        04572083
      ***FORMAT DATA WITH DECIMALS IN IT TO NUMERICS                    04580033
           PERFORM 2050-FORMAT-DECIMAL-DATA.                            04590033
                                                                        04600033
      ***LOAD INTERNAL TABLE WITH PAYROLL AND SALES DATA                04610033
           PERFORM 2100-LOAD-SALES-PYRL-TABLE.                          04620033
100609     PERFORM 2110-LOAD-DIRECT-PYRL-TABLE.                         04621088
100609     PERFORM 2120-LOAD-INDIRECT-PYRL-TABLE.                       04622088
                                                                        04630033
      ***INSERT/UPDATE FOR SALES BUDGET FOR EACH WEEK                   04670033
           PERFORM 2300-LOAD-BUDGETS                                    04680033
                   VARYING F-WEEK FROM 1 BY 1                           04690033
                   UNTIL F-WEEK > PD-WEEKS-IN-MONTH.                    04700033
                                                                        04710033
100609***INSERT/UPDATE FOR DIRECT PAYROLL FOR EACH WEEK                 04711088
100609     PERFORM 2310-LOAD-DIRECT-PYRL                                04712088
100609             VARYING F-WEEK FROM 1 BY 1                           04713088
100609             UNTIL F-WEEK > PD-WEEKS-IN-MONTH.                    04714088
                                                                        04715083
100609***INSERT/UPDATE FOR INDIRECT PAYROLL FOR EACH WEEK               04716088
100609     PERFORM 2320-LOAD-INDIRECT-PYRL                              04717088
100609             VARYING F-WEEK FROM 1 BY 1                           04718088
100609             UNTIL F-WEEK > PD-WEEKS-IN-MONTH.                    04719088
                                                                        04719183
                                                                        04760033
      ***INSERT ADDBACK DATA FOR SALES                                  04770033
           MOVE PC-SALES              TO SDT00012-ADD-BCK-TYP-CDE.      04780044
           MOVE PC-SALES-WAGE         TO SDT00012-ADD-BCK-WGE-AMT.      04790044
           MOVE PC-WHLDG-PCT          TO SDT00012-WHLDG-ADD-BCK-PCT.    04800044
012705     MOVE PC-NEG-WHLDG-PCT      TO SDT00012-NEG-WHLDG-PCT.        04801048
041403     MOVE PC-ADDBCK-CAP-PCT     TO SDT00012-MAX-ADD-BCK-PCT.      04810044
           PERFORM 2500-LOAD-ADDBACK.                                   04820033
                                                                        04830033
      ***INSERT ADDBACK DATA FOR TRUCKS                                 04840033
           MOVE PC-TRUCK              TO SDT00012-ADD-BCK-TYP-CDE.      04850044
           MOVE PC-TRUCK-WAGE         TO SDT00012-ADD-BCK-WGE-AMT.      04860044
           MOVE PC-ZERO               TO SDT00012-WHLDG-ADD-BCK-PCT.    04870044
041403     MOVE PC-ZERO               TO SDT00012-MAX-ADD-BCK-PCT.      04880044
012705     MOVE PC-ZERO               TO SDT00012-NEG-WHLDG-PCT.        04881048
           PERFORM 2500-LOAD-ADDBACK.                                   04890033
                                                                        04900033
072903     MOVE PC-TRUCK-MERCH        TO SDT00012-ADD-BCK-TYP-CDE.      04901044
080907     MOVE PC-TRUCK-MERCH-WAGE   TO SDT00012-ADD-BCK-WGE-AMT.      04902078
072903     MOVE PC-ZERO               TO SDT00012-WHLDG-ADD-BCK-PCT.    04903044
012705     MOVE PC-ZERO               TO SDT00012-NEG-WHLDG-PCT.        04903148
072903     MOVE PC-ZERO               TO SDT00012-MAX-ADD-BCK-PCT.      04904044
072903     PERFORM 2500-LOAD-ADDBACK.                                   04905039
                                                                        04906034
032006     MOVE PC-CF-MERCH           TO SDT00012-ADD-BCK-TYP-CDE.      04907075
080907     MOVE PC-ZERO               TO SDT00012-ADD-BCK-WGE-AMT.      04908077
032006     MOVE PC-ZERO               TO SDT00012-WHLDG-ADD-BCK-PCT.    04909075
032006     MOVE PC-ZERO               TO SDT00012-NEG-WHLDG-PCT.        04910075
032006     MOVE PC-ZERO               TO SDT00012-MAX-ADD-BCK-PCT.      04910175
032006     PERFORM 2500-LOAD-ADDBACK.                                   04910275
                                                                        04910374
032006     MOVE PC-CF-UNLOAD          TO SDT00012-ADD-BCK-TYP-CDE.      04910475
080907     MOVE PC-ZERO               TO SDT00012-ADD-BCK-WGE-AMT.      04910577
032006     MOVE PC-ZERO               TO SDT00012-WHLDG-ADD-BCK-PCT.    04910677
032006     MOVE PC-ZERO               TO SDT00012-NEG-WHLDG-PCT.        04910775
032006     MOVE PC-ZERO               TO SDT00012-MAX-ADD-BCK-PCT.      04910875
032006     PERFORM 2500-LOAD-ADDBACK.                                   04910975
                                                                        04911074
      ***INSERT DATA FOR JOB_LBR_STD TABLE                              04912074
           MOVE PC-JOB-NM-ID-CS           TO SDT00014-LS-JOB-NM-ID.     04920035
           MOVE UV-CS-MIN-HRS             TO SDT00014-MIN-WKLY-HR-QTY   04930035
           MOVE UV-CS-MAX-HRS             TO SDT00014-MAX-WKLY-HR-QTY   04940035
           MOVE PC-ZERO                   TO SDT00014-WKLY-FTEMP-HR-QTY 04950035
           PERFORM 2600-LOAD-JOB-LBR-STD.                               04960033
                                                                        04970033
           MOVE PC-JOB-NM-ID-POS          TO SDT00014-LS-JOB-NM-ID.     04980035
           MOVE UV-POS-MIN-HRS            TO SDT00014-MIN-WKLY-HR-QTY   04990035
           MOVE UV-POS-MAX-HRS            TO SDT00014-MAX-WKLY-HR-QTY   05000035
           MOVE PC-ZERO                   TO SDT00014-WKLY-FTEMP-HR-QTY 05010035
           PERFORM 2600-LOAD-JOB-LBR-STD.                               05020033
                                                                        05030033
082905* LOAD DATA TO SDT_TSK_SLS_MIN                                    05040072
082905     MOVE UV-STORE-NBR              TO SDT00018-STR-NBR.          05040172
082905     MOVE PT-FISCAL-WEEK (PD-WEEKS-IN-MONTH)                      05040272
                                          TO SDT00018-MN-END-DTE.       05040361
                                                                        05040461
082905     MOVE PC-TSK-RECOV              TO SDT00018-LS-TSK-NM-ID      05060072
082905     MOVE UV-RECOV-SLS-MIN          TO SDT00018-MIN-SLS-AMT       05080072
082905     PERFORM 2700-LOAD-TSK-SLS-MIN.                               05090072
                                                                        05100061
082905     MOVE PC-TSK-FILLIN             TO SDT00018-LS-TSK-NM-ID      05101072
082905     MOVE UV-FILLIN-SLS-MIN         TO SDT00018-MIN-SLS-AMT       05102072
082905     PERFORM 2700-LOAD-TSK-SLS-MIN.                               05103072
                                                                        05104061
082905     MOVE PC-TSK-FITRM              TO SDT00018-LS-TSK-NM-ID      05105072
082905     MOVE UV-FITRM-SLS-MIN          TO SDT00018-MIN-SLS-AMT       05106072
082905     PERFORM 2700-LOAD-TSK-SLS-MIN.                               05107072
                                                                        05108061
           INITIALIZE UV-UNSTRING-VARIABLES.                            05110033
           INITIALIZE PT-PROGRAM-TABLES-DYNAMIC.                        05120033
                                                                        05130033
           PERFORM 7000-READ-PLANNED-SALES-FILE.                        05140033
                                                                        05150033
           IF  OSA-PSALES-DATA-CHECK NOT NUMERIC                        05160033
               SET PS-END-OF-PSALES-FILE  TO TRUE                       05170033
           END-IF.                                                      05180033
                                                                        05190033
                                                                        05200033
      ******************************************************************05210033
      * FORMAT DATA THAT HAS A DECIMAL IN IT                            05220033
      ******************************************************************05230033
       2050-FORMAT-DECIMAL-DATA.                                        05240033
                                                                        05250033
           MOVE '2050-FORMAT-DECIMAL-DATA' TO PV-PARAGRAPH-NAME         05260033
                                                                        05270033
      *----------------------------------------------------------------*05280033
      * FORMAT SALES WAGE                                               05290033
      *----------------------------------------------------------------*05300033
           UNSTRING UV-SALES-ADDBACK-WAGE                               05310033
             DELIMITED BY '.' OR ' ' INTO   UV-DOLLARS                  05320033
                                          , UV-CHANGE.                  05330033
           COMPUTE UV-CHANGE = UV-CHANGE / 100.                         05340033
                                                                        05350033
           COMPUTE PC-SALES-WAGE =                                      05360033
                   UV-DOLLARS + UV-CHANGE.                              05370033
                                                                        05380033
      *----------------------------------------------------------------*05390033
      * FORMAT TRUCK WAGE                                               05400033
      *----------------------------------------------------------------*05410033
           UNSTRING UV-TRUCK-WAGE                                       05420033
             DELIMITED BY '.' OR ' ' INTO UV-DOLLARS                    05430033
                                        , UV-CHANGE.                    05440033
                                                                        05450033
           COMPUTE UV-CHANGE = UV-CHANGE / 100.                         05460033
                                                                        05470033
           COMPUTE PC-TRUCK-WAGE =                                      05480033
                   UV-DOLLARS + UV-CHANGE.                              05490033
                                                                        05500033
      *----------------------------------------------------------------*05501034
      * FORMAT TRUCK MERCHANDISING WAGE                                 05502034
      *----------------------------------------------------------------*05503034
           UNSTRING UV-TRUCK-MERCH-WAGE                                 05504034
             DELIMITED BY '.' OR ' ' INTO UV-DOLLARS                    05505034
                                        , UV-CHANGE.                    05506034
                                                                        05507034
           COMPUTE UV-CHANGE = UV-CHANGE / 100.                         05508034
                                                                        05509034
           COMPUTE PC-TRUCK-MERCH-WAGE =                                05509134
                   UV-DOLLARS + UV-CHANGE.                              05509234
                                                                        05509334
      *----------------------------------------------------------------*05620033
      * FORMAT WITH-HOLDING PERCENTS                                    05630044
      *----------------------------------------------------------------*05640033
           UNSTRING UV-WHLDG-PCT                                        05650033
             DELIMITED BY '.' OR ' ' INTO   UV-DOLLARS                  05660033
                                          , UV-CHANGE.                  05670033
           COMPUTE UV-CHANGE = UV-CHANGE / 100.                         05680033
                                                                        05690033
           COMPUTE PC-WHLDG-PCT =                                       05700033
                                UV-DOLLARS + UV-CHANGE.                 05710033
                                                                        05720033
012705     UNSTRING UV-NEG-WHLDG-PCT                                    05721048
012705       DELIMITED BY '.' OR ' ' INTO   UV-DOLLARS                  05722048
012705                                    , UV-CHANGE.                  05723048
012705     COMPUTE UV-CHANGE = UV-CHANGE / 100.                         05724048
012705                                                                  05725048
012705     COMPUTE PC-NEG-WHLDG-PCT =                                   05726048
012705                          UV-DOLLARS + UV-CHANGE.                 05727048
                                                                        05727246
                                                                        05728044
041403*----------------------------------------------------------------*05730033
041403* FORMAT ADDBACK-CAP PERCENT                                      05740033
041403*----------------------------------------------------------------*05750033
041403     UNSTRING UV-ADDBCK-CAP-PCT                                   05760033
041403       DELIMITED BY '.' OR ' ' INTO   UV-DOLLARS                  05770033
041403                                    , UV-CHANGE.                  05780033
041403     COMPUTE UV-CHANGE = UV-CHANGE / 10.                          05790060
041403                                                                  05800033
041403     COMPUTE PC-ADDBCK-CAP-PCT =                                  05810033
041403                          UV-DOLLARS + UV-CHANGE.                 05820033
                                                                        05830033
                                                                        05840033
      ******************************************************************05850033
      * LOAD SALES/PAYROLL INTERNAL TABLE                               05860033
      ******************************************************************05870033
       2100-LOAD-SALES-PYRL-TABLE.                                      05880033
                                                                        05890033
           MOVE '2100-LOAD-SALES-PYRL-TABLE' TO PV-PARAGRAPH-NAME       05900033
                                                                        05910033
           MOVE UV-WEEK-1-SALES              TO PT-FCL-WK-SALES (1).    05920033
           MOVE UV-WEEK-2-SALES              TO PT-FCL-WK-SALES (2).    05930033
           MOVE UV-WEEK-3-SALES              TO PT-FCL-WK-SALES (3).    05940033
           MOVE UV-WEEK-4-SALES              TO PT-FCL-WK-SALES (4).    05950033
           MOVE UV-WEEK-5-SALES              TO PT-FCL-WK-SALES (5).    05960033
                                                                        05970033
           MOVE UV-WEEK-1-PYRLL              TO PT-FCL-WK-PAYROLL (1).  05980033
           MOVE UV-WEEK-2-PYRLL              TO PT-FCL-WK-PAYROLL (2).  05990033
           MOVE UV-WEEK-3-PYRLL              TO PT-FCL-WK-PAYROLL (3).  06000033
           MOVE UV-WEEK-4-PYRLL              TO PT-FCL-WK-PAYROLL (4).  06010033
           MOVE UV-WEEK-5-PYRLL              TO PT-FCL-WK-PAYROLL (5).  06020033
                                                                        06030033
100609     MOVE UV-PL-PYRL-HRS-WK1           TO PT-FCL-WK-PYRL-HRS (1). 06031088
100609     MOVE UV-PL-PYRL-HRS-WK2           TO PT-FCL-WK-PYRL-HRS (2). 06032088
100609     MOVE UV-PL-PYRL-HRS-WK3           TO PT-FCL-WK-PYRL-HRS (3). 06033088
100609     MOVE UV-PL-PYRL-HRS-WK4           TO PT-FCL-WK-PYRL-HRS (4). 06034088
100609     MOVE UV-PL-PYRL-HRS-WK5           TO PT-FCL-WK-PYRL-HRS (5). 06035088
                                                                        06040033
      ******************************************************************06040183
100609 2110-LOAD-DIRECT-PYRL-TABLE.                                     06041088
      ******************************************************************06041183
                                                                        06042083
100609     MOVE '2110-LOAD-DIRECT-PYRL-TABLE' TO PV-PARAGRAPH-NAME      06043088
                                                                        06049183
100609     MOVE UV-PD-PYRL-DLRS-WK1          TO PT-PD-WK-PYRL-DLRS (1). 06049288
100609     MOVE UV-PD-PYRL-HRS-WK1           TO PT-PD-WK-PYRL-HRS (1).  06049388
                                                                        06049486
100609     MOVE UV-PD-PYRL-DLRS-WK2          TO PT-PD-WK-PYRL-DLRS (2). 06049588
100609     MOVE UV-PD-PYRL-HRS-WK2           TO PT-PD-WK-PYRL-HRS (2).  06049688
                                                                        06049786
100609     MOVE UV-PD-PYRL-DLRS-WK3          TO PT-PD-WK-PYRL-DLRS (3). 06049888
100609     MOVE UV-PD-PYRL-HRS-WK3           TO PT-PD-WK-PYRL-HRS (3).  06049988
                                                                        06050086
100609     MOVE UV-PD-PYRL-DLRS-WK4          TO PT-PD-WK-PYRL-DLRS (4). 06050188
100609     MOVE UV-PD-PYRL-HRS-WK4           TO PT-PD-WK-PYRL-HRS (4).  06050288
                                                                        06050386
100609     MOVE UV-PD-PYRL-DLRS-WK5          TO PT-PD-WK-PYRL-DLRS (5). 06050488
100609     MOVE UV-PD-PYRL-HRS-WK5           TO PT-PD-WK-PYRL-HRS (5).  06050588
                                                                        06050683
                                                                        06050783
      ******************************************************************06050883
100609 2120-LOAD-INDIRECT-PYRL-TABLE.                                   06050988
      ******************************************************************06051083
                                                                        06051183
100609     MOVE '2120-LOAD-INRECT-PYRL-TABLE' TO PV-PARAGRAPH-NAME      06051288
                                                                        06051383
100609     MOVE UV-PI-PYRL-DLRS-WK1          TO PT-PI-WK-PYRL-DLRS (1). 06051488
100609     MOVE UV-PI-PYRL-HRS-WK1           TO PT-PI-WK-PYRL-HRS (1).  06051588
                                                                        06051686
100609     MOVE UV-PI-PYRL-DLRS-WK2          TO PT-PI-WK-PYRL-DLRS (2). 06051788
100609     MOVE UV-PI-PYRL-HRS-WK2           TO PT-PI-WK-PYRL-HRS (2).  06051888
                                                                        06051986
100609     MOVE UV-PI-PYRL-DLRS-WK3          TO PT-PI-WK-PYRL-DLRS (3). 06052088
100609     MOVE UV-PI-PYRL-HRS-WK3           TO PT-PI-WK-PYRL-HRS (3).  06052188
                                                                        06052286
100609     MOVE UV-PI-PYRL-DLRS-WK4          TO PT-PI-WK-PYRL-DLRS (4). 06052388
100609     MOVE UV-PI-PYRL-HRS-WK4           TO PT-PI-WK-PYRL-HRS (4).  06052488
                                                                        06052586
100609     MOVE UV-PI-PYRL-DLRS-WK5          TO PT-PI-WK-PYRL-DLRS (5). 06052688
100609     MOVE UV-PI-PYRL-HRS-WK5           TO PT-PI-WK-PYRL-HRS (5).  06052788
                                                                        06052883
      ******************************************************************06190033
      * LOAD BUDGETS MODULE                                             06200033
      ******************************************************************06210033
       2300-LOAD-BUDGETS.                                               06220033
                                                                        06230033
           MOVE '2300-LOAD-BUDGETS' TO PV-PARAGRAPH-NAME.               06240033
                                                                        06250033
           MOVE F-WEEK                        TO F-BUDGET.              06260083
                                                                        06270033
           MOVE UV-STORE-NBR                  TO SDT00000-STR-NBR.      06280083
           MOVE PC-PLANNED                    TO SDT00000-BGTD-TYP-CDE. 06290083
           MOVE PT-FISCAL-WEEK     (F-WEEK)   TO SDT00000-WK-END-DTE.   06300083
           MOVE PT-FCL-WK-SALES    (F-BUDGET) TO SDT00000-SLS-AMT.      06310083
           MOVE PT-FCL-WK-PAYROLL  (F-BUDGET) TO SDT00000-PYRL-AMT.     06320083
100609     MOVE PT-FCL-WK-PYRL-HRS (F-BUDGET) TO SDT00000-PYRL-HR-QTY.  06320188
                                                                        06321083
100609     PERFORM 2340-LOAD-BUDGETS.                                   06322088
                                                                        06330033
      ******************************************************************06330183
100609* LOAD DIRECT PAYROLL                                             06330288
      ******************************************************************06330383
100609 2310-LOAD-DIRECT-PYRL.                                           06330488
                                                                        06330583
100609     MOVE '2310-LOAD-DIRECET-PYRL' TO PV-PARAGRAPH-NAME.          06330688
                                                                        06330783
100609     MOVE F-WEEK                       TO F-BUDGET.               06330888
                                                                        06330983
100609     MOVE UV-STORE-NBR                  TO SDT00000-STR-NBR.      06331088
100609     MOVE PC-DIRECT                     TO SDT00000-BGTD-TYP-CDE. 06331188
100609     MOVE PT-FISCAL-WEEK     (F-WEEK)   TO SDT00000-WK-END-DTE.   06331288
100609     MOVE 0                             TO SDT00000-SLS-AMT.      06331388
100609     MOVE PT-PD-WK-PYRL-DLRS (F-BUDGET) TO SDT00000-PYRL-AMT.     06331488
100609     MOVE PT-PD-WK-PYRL-HRS  (F-BUDGET) TO SDT00000-PYRL-HR-QTY.  06331588
                                                                        06331683
100609     PERFORM 2340-LOAD-BUDGETS.                                   06331788
                                                                        06331883
      ******************************************************************06331983
100609* LOAD INDIRECT PAYROLL                                           06332088
      ******************************************************************06332183
100609 2320-LOAD-INDIRECT-PYRL.                                         06332288
                                                                        06332383
100609     MOVE '2320-LOAD-INDIRECET-PYRL' TO PV-PARAGRAPH-NAME.        06332488
                                                                        06332583
100609     MOVE F-WEEK                        TO F-BUDGET.              06332688
                                                                        06332783
100609     MOVE UV-STORE-NBR                  TO SDT00000-STR-NBR.      06332888
100609     MOVE PC-INDIRECT                   TO SDT00000-BGTD-TYP-CDE. 06332988
100609     MOVE PT-FISCAL-WEEK     (F-WEEK)   TO SDT00000-WK-END-DTE.   06333088
100609     MOVE 0                             TO SDT00000-SLS-AMT.      06333188
100609     MOVE PT-PI-WK-PYRL-DLRS (F-BUDGET) TO SDT00000-PYRL-AMT.     06333388
100609     MOVE PT-PI-WK-PYRL-HRS  (F-BUDGET) TO SDT00000-PYRL-HR-QTY.  06333488
                                                                        06333583
100609     PERFORM 2340-LOAD-BUDGETS.                                   06333688
                                                                        06333783
      ******************************************************************06333883
100609 2340-LOAD-BUDGETS.                                               06333988
      ******************************************************************06334083
                                                                        06335083
           EXEC SQL                                                     06340033
                INSERT INTO SDT_WKLY_STR_BGT                            06350033
                       (STR_NBR                                         06360033
                       ,BGTD_TYP_CDE                                    06370033
                       ,WK_END_DTE                                      06380033
                       ,SLS_AMT                                         06390033
                       ,PYRL_AMT                                        06400033
                       ,LAST_UPD_USR_ID                                 06410033
                       ,LAST_UPD_TMST                                   06420083
100609                 ,PYRL_HR_QTY)                                    06421088
                  VALUES (  :SDT00000-STR-NBR                           06430033
                          , :SDT00000-BGTD-TYP-CDE                      06440033
                          , :SDT00000-WK-END-DTE                        06450033
                          , :SDT00000-SLS-AMT                           06460033
                          , :SDT00000-PYRL-AMT                          06470033
                          , :PC-UPDATE-USER-ID                          06480033
                          , :PD-TIME-STAMP                              06490083
100609                    , :SDT00000-PYRL-HR-QTY)                      06491088
           END-EXEC.                                                    06500033
                                                                        06510033
           EVALUATE TRUE                                                06520033
              WHEN SQLCODE = ZERO                                       06530033
                   ADD +1                     TO PV-ROWS-INSERTED-SALES 06540033
              WHEN SQLCODE = -803                                       06550033
                   PERFORM 2350-UPDATE-SALES                            06560033
              WHEN SQLCODE NOT EQUAL ZERO                               06570033
                   DISPLAY 'ERROR ON INSERT OF DATA'                    06580033
                   PERFORM 9999-ABEND                                   06590072
           END-EVALUATE.                                                06600033
                                                                        06610033
                                                                        06620033
      ******************************************************************06630033
      * UPDATE SALES DATA                                               06640033
      ******************************************************************06650033
       2350-UPDATE-SALES.                                               06660033
                                                                        06670033
           MOVE '2350-UPDATE-SALES' TO PV-PARAGRAPH-NAME                06680033
                                                                        06690033
           EXEC SQL                                                     06700033
                UPDATE SDT_WKLY_STR_BGT                                 06710033
                SET SLS_AMT        = :SDT00000-SLS-AMT                  06720033
                 ,  PYRL_AMT       = :SDT00000-PYRL-AMT                 06730033
                 ,  LAST_UPD_TMST  = :PD-TIME-STAMP                     06740033
100609           ,  PYRL_HR_QTY    = :SDT00000-PYRL-HR-QTY              06741088
                WHERE STR_NBR      = :SDT00000-STR-NBR                  06750033
                  AND WK_END_DTE   = :SDT00000-WK-END-DTE               06760033
                  AND BGTD_TYP_CDE = :SDT00000-BGTD-TYP-CDE             06770033
           END-EXEC.                                                    06780033
                                                                        06790033
           EVALUATE TRUE                                                06800033
              WHEN SQLCODE = ZERO                                       06810033
                   ADD +1                   TO PV-ROWS-UPDATED-SALES    06820033
              WHEN OTHER                                                06830033
                   DISPLAY 'ERROR ON UPDATE OF DATA'                    06840033
                   PERFORM 9999-ABEND                                   06850072
           END-EVALUATE.                                                06860033
                                                                        06870033
                                                                        06880033
      ******************************************************************07310033
      * LOAD ADDBACK DATA                                               07320033
      ******************************************************************07330033
       2500-LOAD-ADDBACK.                                               07340033
                                                                        07350033
           MOVE '2500-LOAD-ADDBACK'       TO PV-PARAGRAPH-NAME.         07360033
                                                                        07370033
           MOVE UV-STORE-NBR              TO SDT00012-STR-NBR.          07380033
           MOVE PT-FISCAL-WEEK (PD-WEEKS-IN-MONTH)                      07390033
                                          TO SDT00012-MN-END-DTE.       07400033
                                                                        07410033
           EXEC SQL                                                     07420033
                INSERT INTO SDT_ADD_BCK_DOL                             07430033
                       (STR_NBR                                         07440033
                      , MN_END_DTE                                      07450033
                      , ADD_BCK_TYP_CDE                                 07460033
                      , ADD_BCK_WGE_AMT                                 07470033
                      , WHLDG_ADD_BCK_PCT                               07480033
041403                , MAX_ADD_BCK_PCT                                 07490044
012705                , NEG_WHLDG_PCT)                                  07491048
                  VALUES ( :SDT00012-STR-NBR                            07500033
                         , :SDT00012-MN-END-DTE                         07510033
                         , :SDT00012-ADD-BCK-TYP-CDE                    07520033
                         , :SDT00012-ADD-BCK-WGE-AMT                    07530033
                         , :SDT00012-WHLDG-ADD-BCK-PCT                  07540033
041403                   , :SDT00012-MAX-ADD-BCK-PCT                    07550044
012705                   , :SDT00012-NEG-WHLDG-PCT)                     07551048
           END-EXEC.                                                    07560033
                                                                        07570033
           EVALUATE TRUE                                                07580033
              WHEN SQLCODE = ZERO                                       07590033
                   ADD +1                     TO PV-ROWS-INSERTED-ADDBCK07600033
              WHEN SQLCODE = -803                                       07610033
                   PERFORM 2550-UPDATE-ADDBCK-DOL                       07620033
              WHEN SQLCODE NOT EQUAL ZERO                               07630033
                   DISPLAY 'ERROR ON INSERT OF DATA'                    07640033
                   DISPLAY 'STORE = ' SDT00012-STR-NBR                  07651052
                   DISPLAY 'MONTH END = ' SDT00012-MN-END-DTE           07652052
                   DISPLAY 'TYPE CODE = ' SDT00012-ADD-BCK-TYP-CDE      07653052
                   DISPLAY 'WAGE = ' SDT00012-ADD-BCK-WGE-AMT           07654052
                   DISPLAY 'WHLDG % = ' SDT00012-WHLDG-ADD-BCK-PCT      07655052
                   DISPLAY 'MAX % = ' SDT00012-MAX-ADD-BCK-PCT          07656052
                   DISPLAY 'NEG % = ' SDT00012-NEG-WHLDG-PCT            07657052
                   PERFORM 9999-ABEND                                   07658072
           END-EVALUATE.                                                07660033
                                                                        07670033
                                                                        07680033
      ****************************************************************  07690033
      * UPDATE SDT_ADD_BCK_DOL IF ROW ALREADY EXISTS ON THE DATABASE    07700033
      ****************************************************************  07710033
       2550-UPDATE-ADDBCK-DOL.                                          07720033
                                                                        07730033
           MOVE '2550-UPDATE-ADDBCK-DOL' TO PV-PARAGRAPH-NAME.          07740033
                                                                        07750033
           EXEC SQL                                                     07760033
                UPDATE SDT_ADD_BCK_DOL                                  07770033
                SET ADD_BCK_WGE_AMT   = :SDT00012-ADD-BCK-WGE-AMT       07780033
                 ,  WHLDG_ADD_BCK_PCT = :SDT00012-WHLDG-ADD-BCK-PCT     07790033
041403           ,  MAX_ADD_BCK_PCT   = :SDT00012-MAX-ADD-BCK-PCT       07800033
012705           ,  NEG_WHLDG_PCT     = :SDT00012-NEG-WHLDG-PCT         07801048
                WHERE STR_NBR         = :SDT00012-STR-NBR               07810044
                  AND MN_END_DTE      = :SDT00012-MN-END-DTE            07820044
                  AND ADD_BCK_TYP_CDE = :SDT00012-ADD-BCK-TYP-CDE       07830033
           END-EXEC.                                                    07840033
                                                                        07850033
           EVALUATE TRUE                                                07860033
              WHEN SQLCODE = ZERO                                       07870033
              WHEN SQLCODE = -1405                                      07880033
              WHEN SQLCODE = 1405                                       07890033
                   ADD +1 TO PV-ROWS-UPDATED-ADDBCK                     07900033
              WHEN OTHER                                                07910033
                   DISPLAY 'ERROR ON UPDATE OF DATA'                    07920033
                   PERFORM 9999-ABEND                                   07930072
           END-EVALUATE.                                                07940033
                                                                        07950033
                                                                        07960033
      ******************************************************************07970033
      * LOAD SDT_JOB_LBR_STD TABLE                                      07980033
      ******************************************************************07990033
       2600-LOAD-JOB-LBR-STD.                                           08000033
                                                                        08010033
           MOVE '2600-LOAD-JOB-LBR-STD'   TO PV-PARAGRAPH-NAME.         08020033
                                                                        08030033
           MOVE UV-STORE-NBR              TO SDT00014-STR-NBR.          08040033
           MOVE PT-FISCAL-WEEK (PD-WEEKS-IN-MONTH)                      08050033
                                          TO SDT00014-MN-END-DTE.       08060033
                                                                        08070033
           EXEC SQL                                                     08080033
                INSERT INTO SDT_JOB_LBR_STD                             08090033
                       (MN_END_DTE                                      08100033
                      , STR_NBR                                         08110033
                      , LS_JOB_NM_ID                                    08120033
                      , MIN_WKLY_HR_QTY                                 08130033
                      , MAX_WKLY_HR_QTY                                 08140033
                      , WKLY_FTEMP_HR_QTY)                              08150033
                  VALUES ( :SDT00014-MN-END-DTE                         08160033
                         , :SDT00014-STR-NBR                            08170033
                         , :SDT00014-LS-JOB-NM-ID                       08180033
                         , :SDT00014-MIN-WKLY-HR-QTY                    08190033
                         , :SDT00014-MAX-WKLY-HR-QTY                    08200033
                         , :SDT00014-WKLY-FTEMP-HR-QTY)                 08210033
           END-EXEC.                                                    08220033
                                                                        08230033
           EVALUATE TRUE                                                08240033
              WHEN SQLCODE = ZERO                                       08250033
                   ADD +1 TO PV-ROWS-INSERTED-JOB-LBR-STD               08260033
              WHEN SQLCODE = -803                                       08270033
                   PERFORM 2650-UPDATE-JOB-LBR-STD                      08280033
              WHEN SQLCODE NOT EQUAL ZERO                               08290033
                   DISPLAY 'ERROR ON INSERT OF DATA'                    08300033
                   PERFORM 9999-ABEND                                   08310072
           END-EVALUATE.                                                08320033
                                                                        08330033
                                                                        08340033
      ****************************************************************  08350033
      * UPDATE SDT_JOB_LBR_STD IF ROW ALREADY EXISTS ON THE DATABASE    08360033
      ****************************************************************  08370033
       2650-UPDATE-JOB-LBR-STD.                                         08380033
                                                                        08390033
           MOVE '2650-UPDATE-JOB-LBR-STD' TO PV-PARAGRAPH-NAME.         08400033
                                                                        08410033
           EXEC SQL                                                     08420033
                UPDATE SDT_JOB_LBR_STD                                  08430033
                SET MIN_WKLY_HR_QTY   = :SDT00014-MIN-WKLY-HR-QTY       08440033
                 ,  MAX_WKLY_HR_QTY   = :SDT00014-MAX-WKLY-HR-QTY       08450033
                 ,  WKLY_FTEMP_HR_QTY = :SDT00014-WKLY-FTEMP-HR-QTY     08460033
                WHERE STR_NBR         = :SDT00014-STR-NBR               08470033
                  AND MN_END_DTE      = :SDT00014-MN-END-DTE            08480033
                  AND LS_JOB_NM_ID    = :SDT00014-LS-JOB-NM-ID          08490033
           END-EXEC.                                                    08500033
                                                                        08510033
           EVALUATE TRUE                                                08520033
              WHEN SQLCODE = ZERO                                       08530033
              WHEN SQLCODE = -1405                                      08540033
              WHEN SQLCODE = 1405                                       08550033
                   ADD +1 TO PV-ROWS-UPDATED-JOB-LBR-STD                08560033
              WHEN OTHER                                                08570033
                   DISPLAY 'ERROR ON UPDATE OF DATA'                    08580033
                   PERFORM 9999-ABEND                                   08590072
           END-EVALUATE.                                                08600033
                                                                        08610033
      ******************************************************************08620061
      * LOAD SDT_TSK_SLS_MIN TABLE                                      08630061
      ******************************************************************08630161
082905 2700-LOAD-TSK-SLS-MIN.                                           08630272
                                                                        08630361
082905     MOVE '2700-LOAD-TSK-SLS-MIN'   TO PV-PARAGRAPH-NAME.         08630472
                                                                        08630561
082905     EXEC SQL                                                     08631072
082905          INSERT INTO SDT_TSK_SLS_MIN                             08631172
082905                 (MN_END_DTE                                      08631272
082905                , LS_TSK_NM_ID                                    08631372
082905                , STR_NBR                                         08631472
082905                , MIN_SLS_AMT)                                    08631572
082905            VALUES ( :SDT00018-MN-END-DTE                         08631872
082905                   , :SDT00018-LS-TSK-NM-ID                       08631972
082905                   , :SDT00018-STR-NBR                            08632072
082905                   , :SDT00018-MIN-SLS-AMT)                       08632372
082905     END-EXEC.                                                    08632472
082905                                                                  08632572
082905     EVALUATE TRUE                                                08632672
082905        WHEN SQLCODE = ZERO                                       08632772
082905             ADD +1 TO PV-ROWS-INSERTED-TSK-SLS-MIN               08632872
082905        WHEN SQLCODE = -803                                       08632972
082905             PERFORM 2750-UPDATE-TSK-SLS-MIN                      08633072
082905        WHEN SQLCODE NOT EQUAL ZERO                               08633172
082905             DISPLAY 'ERROR ON INSERT OF DATA'                    08633272
082905             DISPLAY 'MIN SLS AMT = ' SDT00018-MIN-SLS-AMT        08633372
082905             DISPLAY 'STORE = ' SDT00018-STR-NBR                  08633472
082905             DISPLAY 'MONTH END DATE = ' SDT00018-MN-END-DTE      08633572
082905             DISPLAY 'TASK ID = ' SDT00018-LS-TSK-NM-ID           08633672
082905             PERFORM 9999-ABEND                                   08633772
082905     END-EVALUATE.                                                08633872
082905                                                                  08633972
082905****************************************************************  08634172
082905* UPDATE SDT_TSK_SLS_MIN IF ROW ALREADY EXISTS ON THE DATABASE    08634272
082905****************************************************************  08634372
082905 2750-UPDATE-TSK-SLS-MIN.                                         08634472
082905                                                                  08634572
082905     MOVE '2750-UPDATE-TSK-SLS-MIN' TO PV-PARAGRAPH-NAME.         08634672
082905                                                                  08634772
082905     EXEC SQL                                                     08634872
082905          UPDATE SDT_TSK_SLS_MIN                                  08634972
082905          SET MIN_SLS_AMT       = :SDT00018-MIN-SLS-AMT           08635072
082905          WHERE STR_NBR         = :SDT00018-STR-NBR               08635172
082905            AND MN_END_DTE      = :SDT00018-MN-END-DTE            08635272
082905            AND LS_TSK_NM_ID    = :SDT00018-LS-TSK-NM-ID          08635372
082905     END-EXEC.                                                    08635472
082905                                                                  08635572
082905     EVALUATE TRUE                                                08635672
082905        WHEN SQLCODE = ZERO                                       08635772
082905        WHEN SQLCODE = -1405                                      08635872
082905        WHEN SQLCODE = 1405                                       08635972
082905             ADD +1 TO PV-ROWS-UPDATED-TSK-SLS-MIN                08636072
082905        WHEN OTHER                                                08636172
082905             DISPLAY 'ERROR ON UPDATE OF DATA'                    08636272
082905             DISPLAY 'MIN SLS AMT = ' SDT00018-MIN-SLS-AMT        08636372
082905             DISPLAY 'STORE = ' SDT00018-STR-NBR                  08636472
082905             DISPLAY 'MONTH END DATE = ' SDT00018-MN-END-DTE      08636572
082905             DISPLAY 'TASK ID = ' SDT00018-LS-TSK-NM-ID           08636672
082905             PERFORM 9999-ABEND                                   08636772
082905     END-EVALUATE.                                                08636872
                                                                        08636961
      ****************************************************************  08637033
      * READ OSA PLANNED SALES FILE                                     08640033
      ****************************************************************  08650033
       7000-READ-PLANNED-SALES-FILE.                                    08660033
                                                                        08670033
           READ OSA-PSALES-FILE INTO OSA-PSALES-LAYOUT                  08680033
                AT END                                                  08690033
                   SET PS-END-OF-PSALES-FILE TO TRUE                    08700033
           END-READ.                                                    08710033
                                                                        08720033
           ADD +1                            TO PV-RECORDS-READ.        08740033
                                                                        08750033
                                                                        08760033
      *************************************************************     08890033
      * INITIALIZATION AREA                                             08900033
      *************************************************************     08910033
       9000-WRAPUP.                                                     08920033
                                                                        08930033
           MOVE '9000-WRAPUP' TO PV-PARAGRAPH-NAME.                     08940033
                                                                        08950033
           EXEC SQL                                                     08960033
                COMMIT                                                  08970033
           END-EXEC.                                                    08980033
                                                                        08990033
           IF  SQLCODE NOT EQUAL ZERO                                   09000033
                   PERFORM 9999-ABEND                                   09010033
           END-IF.                                                      09020033
                                                                        09030033
           CLOSE OSA-PSALES-FILE.                                       09040054
                                                                        09060033
           DISPLAY '*************************************************'. 09070033
           DISPLAY '* PROGRAM.................: ' PV-PROGRAM-NAME.      09080033
           DISPLAY '* RUN DATE/TIME...........: ' PD-TIME-STAMP.        09090033
           DISPLAY '*************************************************'. 09110033
           DISPLAY '* RECORDS READ............:' PV-RECORDS-READ.       09120033
           DISPLAY '* SALES RECORDS INSERTED..: '                       09130033
                                         PV-ROWS-INSERTED-SALES.        09140033
           DISPLAY '* SALES RECORDS UPDATED...: ' PV-ROWS-UPDATED-SALES.09150033
           DISPLAY '* ADDBACK RECORDS INSERTED: '                       09180033
                                         PV-ROWS-INSERTED-ADDBCK.       09190033
           DISPLAY '* ADDBACK RECORDS UPDATED: '                        09200033
                                         PV-ROWS-UPDATED-ADDBCK.        09210033
           DISPLAY '* JOB LBR STD RECORDS INSERTED: '                   09220033
                                         PV-ROWS-INSERTED-JOB-LBR-STD.  09230033
           DISPLAY '* JOB LBR STD RECORDS UPDATED: '                    09240033
                                         PV-ROWS-UPDATED-JOB-LBR-STD.   09250033
           DISPLAY '* TSK SLS MIN RECORDS INSERTED: '                   09250180
082905                                   PV-ROWS-INSERTED-TSK-SLS-MIN.  09251079
           DISPLAY '* TSK SLS MIN RECORDS UPDATED: '                    09252080
082905                                   PV-ROWS-UPDATED-TSK-SLS-MIN.   09253079
           DISPLAY '*************************************************'. 09260033
                                                                        09270033
                                                                        09280033
      ******************************************************************09290033
      * ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.    09300033
      ******************************************************************09310033
       9999-ABEND.                                                      09320033
                                                                        09330033
           DISPLAY '** ABEND     **'.                                   09340033
           DISPLAY '** PROGRAM   ** = ' PV-PROGRAM-NAME.                09350033
           DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              09360033
           DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               09370033
                                                                        09380033
      ******************************************************************09390033
      * COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     09400033
      * TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      09410033
      ******************************************************************09420033
           COPY DPPD004.                                                09430043
                                                                        09440033
           CALL 'ILBOABN0' USING ABEND-CODE.                            09450033
                                                                        09460033
                                                                        09470033
