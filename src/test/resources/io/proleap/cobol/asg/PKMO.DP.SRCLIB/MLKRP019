       IDENTIFICATION DIVISION.                                                 
000030 PROGRAM-ID.    MLKRP019.                                                 
000040 AUTHOR.        TESS BESTE.                                               
000050 INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
000060 DATE-WRITTEN.  04-18-94.                                                 
000070 DATE-COMPILED.                                                           
000080                                                                          
000090******************************************************************        
000100*           MLKRP019 - ACCUM TRANSFERS                                    
000110*                                                                         
000120* THIS PROGRAM ACCUMULATES THE AMOUNTS FROM A FILE OF TRANSFER            
000130* TRANSACTIONS IN THE MLRD019 FORMAT, WHICH IS INPUT TO MLKUP020          
000140* IN JOB MLK140, ON DD INP12. THE TRANSACTION COUNT AND TOTAL             
000150* RETAIL ARE DISPLAYED.                                                   
000160******************************************************************        
000170                                                                 *        
000180                                                                          
000190 ENVIRONMENT DIVISION.                                                    
000200                                                                          
000210 CONFIGURATION SECTION.                                                   
000220                                                                          
000230 SOURCE-COMPUTER.    IBM-3090.                                            
000240 OBJECT-COMPUTER.    IBM-3090.                                            
000250                                                                          
000260                                                                          
000270 INPUT-OUTPUT SECTION.                                                    
000280                                                                          
000290 FILE-CONTROL.                                                            
000300     SELECT INPUT-FILE                                                    
000310         ASSIGN TO INP01.                                                 
000320                                                                          
000350 DATA DIVISION.                                                           
000360                                                                          
000370 FILE SECTION.                                                            
000380                                                                          
000390 FD  INPUT-FILE                                                           
000400     LABEL RECORDS ARE STANDARD                                           
000410     BLOCK CONTAINS 0 RECORDS                                             
000420     RECORDING  MODE IS F.                                                
W26603     COPY MLRD019.                                                        
W26603                                                                          
000450 WORKING-STORAGE SECTION.                                                 
000460                                                                          
000470******************************************************************        
000480* INPUT RECORD LAYOUT                                                     
000490******************************************************************        
000500                                                                          
000530 01  PS-PROGRAM-SWITCHES.                                                 
000540     05  PS-END-OF-INPUT-FILE-SW      PIC X         VALUE 'N'.            
000550         88  PS-END-OF-INPUT-FILE                   VALUE 'Y'.            
000560         88  PS-NOT-END-OF-INPUT-FILE               VALUE 'N'.            
000570                                                                          
000580 01  PV-PROGRAM-VARIABLES.                                                
000590     05  PV-RECORD-COUNT              PIC S9(13)    VALUE +0              
000600                                                    COMP-3.               
           05  PV-ACCUM-QTY                 PIC S9(13)    VALUE +0              
                                                          COMP-3.               
000610     05  PV-ACCUM-AMT                 PIC S9(13)V99 VALUE +0              
000620                                                    COMP-3.               
000630     05  PV-DISPLAY-COUNT             PIC ZZZ,ZZZ,ZZZ,ZZZ-.               
000640     05  PV-DISPLAY-AMT               PIC ZZZ,ZZZ,ZZZ,ZZZ.99-.            
000650 EJECT                                                                    
000660 PROCEDURE DIVISION.                                                      
000670                                                                          
000680                                                                          
000690 A100-PROGRAM-MAINLINE.                                                   
000700                                                                          
000710     OPEN INPUT INPUT-FILE.                                               
W26603     READ INPUT-FILE NEXT                                                 
000730         AT END SET PS-END-OF-INPUT-FILE TO TRUE.                         
000740                                                                          
000750     PERFORM UNTIL PS-END-OF-INPUT-FILE                                   
000760         ADD +1 TO PV-RECORD-COUNT                                        
000770         COMPUTE PV-ACCUM-AMT                                             
000780               = PV-ACCUM-AMT                                             
000790               + (ML019-TRANSFER-QTY                                      
000800               *  ML019-TRANSFER-PER-UNT-RTL-AMT)                         
               ADD ML019-TRANSFER-QTY TO PV-ACCUM-QTY                           
W26603         READ INPUT-FILE NEXT                                             
000820             AT END SET PS-END-OF-INPUT-FILE TO TRUE                      
000830         END-READ                                                         
000840     END-PERFORM.                                                         
000850                                                                          
000860     MOVE PV-RECORD-COUNT TO PV-DISPLAY-COUNT.                            
000870     DISPLAY 'TRANSACTION COUNT: ' PV-DISPLAY-COUNT.                      
           MOVE PV-ACCUM-QTY    TO PV-DISPLAY-COUNT.                            
           DISPLAY 'TOTAL QTY:         ' PV-DISPLAY-COUNT.                      
000880     MOVE PV-ACCUM-AMT    TO PV-DISPLAY-AMT.                              
000890     DISPLAY 'TOTAL RETAIL:      ' PV-DISPLAY-AMT.                        
000900     CLOSE INPUT-FILE.                                                    
000910                                                                          
000920     STOP RUN.                                                            
