000100 IDENTIFICATION DIVISION.                                                 
000200 PROGRAM-ID.    MLKUT410.                                                 
000300 AUTHOR.        BARBARA HULL.                                             
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
000500 DATE-WRITTEN.  06-19-98.                                                 
000600 DATE-COMPILED.                                                           
000700******************************************************************        
000800*                                                                         
R21731* MLKUT410 - SKU RECLASS FINANCIAL REPORT.                                
001000*                                                                         
001100* THIS PROGRAM WILL CREATE A DETAIL REPORT BASED ON SKU RECLASS           
001200* THAT DETAIL THE COST AND RETAIL DOLLARS THAT WOULD BE MOVED.            
001300* ALSO CREATE TWO EXTRACT FILES: 1) FOR INPUT INTO MERCHANDISE            
001400* LEDGER (MLRD015) AND 2) FOR THE REPORT BY BUYER (MLRD113).              
001500*                                                                         
      ******************** HISTORY OF CHANGES **************************        
      * CHG ID/                                                        *        
      * WR/PROJ  DATE        DESCRIPTION OF CHANGES                    *        
      * -------  ----------  ----------------------------------------  *        
001500*          03/20/00    DUE TO REGIONAL CLEARANCE PRICING (RCP),  *        
001500*                      THE SOURCE OF UNIT RETAIL AND UNIT COST   *        
001500*                      FOR INDIVIDUAL STORES WILL NOW BE STORED  *        
001500*                      IN TUPCPLS (NOT TSKST). NEW COLUMN        *        
001500*                      (TSK.REGN_PRIC_IND) WILL BE USED TO       *        
001500*                      DETERMINE IF STORE '000' OR               *        
001500*                      STORE-SPECIFIC ROW IS TO BE RETRIEVED FROM*        
001500*                      TUPCPLS. NEW COLUMN (TUPCPLS.ITM_NBR) WILL*        
001500*                      TIE TO TSK.ITEM_NMBR AND IF               *        
001500*                      IF REGN_PRIC_IND = 'Y', THEN STORE        *        
001500*                      COST/RETAIL IS USED. IF NO ROW IS FOUND   *        
001500*                      ON TUPCPLS FOR STORE, THEN RTL/COST       *        
001500*                      REVERTS BACK TO STORE '000' COST/RETAIL.  *        
001500*                      IF REGN_PRIC_IND = 'N', THEN              *        
001500*                      STORE '000' AMTS ARE USED.                *        
      *                                             - AMY LAWSON       *        
      *                                                                *        
      *          04/17/00    CHANGED PROGRAM TO USE THE SKU RENUMBER   *        
      *                      DATE AND HARD-CODED TIMESTAMP TO GET THE  *        
      *                      COST AND RETAIL FROM THE TUPCPLS TABLE    *        
      *                      INSTEAD OF SKU RENUMBER TIME.             *        
      *                                             - AMY LAWSON       *        
      *                                                                *        
      * 21731    01-10-2002  CHANGE PROGRAM FOR NON-INTELLIGENT SKU    *        
      *                      PROJECT.  THIS PROGRAM WILL UTILIZE THE   *        
      *                      TABLE TSKXREF TO GET THE ATTRIBUTES       *        
W21731* WR21731  04-29-2003  ELIMINATE THE UNNECESSARY USAGE OF TSK    *        
      *                                                                *        
R21731* WR21731  07-31-2003  RENUMBERING SKUS IS GOING AWAY HOWEVER    *        
R21731*                      RECLASSING DEPT/SUBCLASS WILL ALLOW SKUS  *        
R21731*                      TO BE MOVED FROM ONE DEPT/SUB-CLASS       *        
R21731*                      TO ANOTHER DEPT/SUB-CLASS.                *        
R21731*                                                                *        
R21731*                      THE RENUMBER TABLE DOES NOT HAVE ANY MORE *        
R21731*                      ACTIVITY.  TO CAPTURE THE RECLASS ACTIVITY*        
R21731*                      USE AN INPUT FILE CONTAINING DATA PULLED  *        
R21731*                      FROM THE VSM ITEM HUB.  THE DATA IN THIS  *        
R21731*                      FILE IS STYLE RECLASS DATA ONLY.          *        
R21731*                                                                *        
R21731*                      THE FILE CONTAINS ACTIVITY OF THE CHANGES *        
R21731*                      WHERE A RECORD HAS THE BEFORE AND AFTER   *        
R21731*                      VALUES FOR A RECLASS.  USING THE          *        
R21731*                      VS ID AND THE NEW SUB CL MDSEAR ID,       *        
R21731*                      INTEROGATE THE TUPC TABLE TO IDENTIFY     *        
R21731*                      ALL OF THE SKUS THAT MOVED FROM ONE DEPT/ *        
R21731*                      MAJOR CLASS/ SUB CLASS TO ANOTHER.        *        
W26006*                                                                *        
W26006* WR26006  07-31-2003  PROGRAM WAS ASSIGNING THE SAME INHOUSE_NBR         
W26006*                      TO BOTH CREDIT (TO) AND DEBIT (FROM) RECS.         
W26006*                      THIS WAS CAUSING ISSUES IN VA TRYING TO            
W26006*                      FIND THE CORRECT ENT_ID FOR THE FROM DEPT.         
W26006*                      SINCE INHOUSE_NBR IS BASED ON THE RELATION         
W26006*                      BETWEEN AN ENT_ID AND DEPT_NBR, THE INHOUSE        
W26006*                      NUMBER WAS BEING ALWAYS FOUND IF THE RECLAS        
W26006*                      WAS TO A NEW DEPARTMENT. CHANGE PARA 2180-         
W26006*                      TO LOOK UP BOTH FROM/TO INHOUSE NUMBERS.           
W26603* W26603  03-08-2004 ROD JANSSEN MERCH LEDGER STORE EXPANSION             
      * W26006  08-10-2004   FIX MISSING STORE NUMBER ON THE DETAIL             
      *                      REPORT.  NOW THAT FASHION SALES TABLE              
      *                      TSKST CONTAINS LARGER STORE NUMBER, UPDATE         
      *                      PROGRAM TO USE NEW COLUMN.                         
      *                                               - V. LEE YANG             
R26006* W26606  06-07-2005 ROD JANSSEN USE TSKST LOC_NBR...                     
W28545* W28545  02-06-2006 JAN BLAZICH EXTRACT RECLASS INFO                     
W28545*                    ALSO, CREATE A DETAIL BUYER EXTRACT WITH             
W28545*                    STORE NUMBER ADDED TO THE END OF THE RECORD          
I15034* I15034  08-22-2007 S.JACKSON - TUPC CURSOR NOT ABLE TO RESOLVE          
I15034*                    SKU LIST IF MULT DAILY RECLASSES OCCUR FOR           
I15034*                    THE SAME STYLE. USE RMS_STYL_ID FROM MESSAGE         
I15034*                    TO RESOLVE SUB_CL_ID/VS_ID BEFORE TUPC_CURSOR        
W34517* W34517  10-15-2007 J.SELWITSCHKA - BRAND VENDOR PHASE II                
W34517*                    FILL RMS-STYL-ID AND LBL-SEQ-NBR ON MLRD015.         
B34517* W34517  10-17-2007 B.GRAHAM - STRATAGEM  BRAND VENDOR PHASE II          
B34517*                    CHANGE CALL TO TMDARVS                               
G34517* W34517  10-23-2007 B.GRAHAM - STRATAGEM  BRAND VENDOR PHASE II          
G34517*                    CHANGE AP TRANS FROM 52 AND 53 TO Z2 AND Z1          
H34517* W34517  11-11-2007 B.GRAHAM - STRATAGEM  BRAND VENDOR PHASE II          
H34517*                    CHANGE SOURCE OF BATCH NUMBER TO CONTROL             
H34517*                    CARD RATHER THAN SYSTEM RUN DATE                     
J34517* W34517  11-13-2007 J.SELWITSCHKA - BRAND VENDOR PHASE II                
J34517*                    GET ITEM NBR AND REMOVE JOIN IN TSKST_CURSOR.        
I34517* W34517  11-14-2007 B.GRAHAM - STRATAGEM  BRAND VENDOR PHASE II          
I34517*                    CORRECT LOOP IF NO STORE 000 IN 2105                 
001600******************************************************************00160099
001600******************************************************************00160099
001700*                                                                 00170099
001800 ENVIRONMENT DIVISION.                                            00180099
001900*                                                                 00190099
002000 CONFIGURATION SECTION.                                           00200099
002100*                                                                 00210099
002200 SOURCE-COMPUTER.        IBM-3090.                                00220099
002300 OBJECT-COMPUTER.        IBM-3090.                                00230099
002400*                                                                 00240099
002500 INPUT-OUTPUT SECTION.                                            00250099
002600 FILE-CONTROL.                                                    00260099
002700                                                                  00270099
002800     SELECT CONTROL-FILE                                          00280099
002900         ASSIGN TO INP01.                                         00290099
003000                                                                  00300099
R21731     SELECT RECLASS-FILE                                          00280099
R21731         ASSIGN TO INP02.                                         00290099
003000                                                                  00300099
003100     SELECT TRANS-EXTRACT-FILE                                    00310099
003200         ASSIGN TO OUT01.                                         00320099
003300                                                                  00330099
003400     SELECT RPT-EXTRACT-FILE                                      00340099
003500         ASSIGN TO OUT02.                                         00350099
003600                                                                  00360099
003700     SELECT DETAIL-REPORT-FILE                                    00370099
003800         ASSIGN TO RPT01.                                         00380099
003900                                                                  00390099
004000     SELECT SUMMARY-REPORT-FILE                                   00400099
004100         ASSIGN TO RPT02.                                         00410099
004200                                                                  00420099
W28545     SELECT RECLS-EXTRACT-FILE                                            
W28545         ASSIGN TO OUT03.                                         00410099
W28545                                                                          
W28545     SELECT BUYER-EXTRACT-FILE                                            
W28545         ASSIGN TO OUT04.                                         00410099
W28545                                                                          
004300******************************************************************00430099
004400 DATA DIVISION.                                                   00440099
004500******************************************************************00450099
004600                                                                  00460099
004700 FILE SECTION.                                                    00470099
004800                                                                  00480099
004900 FD  CONTROL-FILE                                                 00490099
005000     LABEL RECORDS ARE STANDARD                                   00500099
005100     RECORDING MODE IS F                                          00510099
005200     BLOCK CONTAINS 0 RECORDS.                                    00520099
005300 01  CONTROL-RECORD              PIC X(80).                       00530099
005400                                                                  00540099
R21731 FD  RECLASS-FILE                                                         
R21731     RECORDING MODE F                                                     
R21731     LABEL RECORDS OMITTED                                                
R21731     BLOCK CONTAINS  0 RECORDS.                                           
R21731 01  RECLASS-RECORD               PIC X(450).                             
R21731                                                                          
005500 FD  TRANS-EXTRACT-FILE                                           00550099
005600     RECORDING MODE IS F                                          00560099
005700     LABEL RECORDS ARE STANDARD                                   00570099
005800     BLOCK CONTAINS 0 RECORDS.                                    00580099
005900                                                                  00590099
W26603 01  TRANS-EXTRACT-RECORD        PIC X(150).                      00600099
006100                                                                  00610099
006200 FD  RPT-EXTRACT-FILE                                             00620099
006300     RECORDING MODE IS F                                          00630099
006400     LABEL RECORDS ARE STANDARD                                   00640099
006500     BLOCK CONTAINS 0 RECORDS.                                    00650099
006600                                                                  00660099
006700 01  RPT-EXTRACT-RECORD          PIC X(139).                      00670099
006800                                                                  00680099
006900 FD  DETAIL-REPORT-FILE                                           00690099
007000     RECORDING MODE IS F                                          00700099
007100     LABEL RECORDS ARE STANDARD                                   00710099
007200     BLOCK CONTAINS 0 RECORDS.                                    00720099
007300                                                                  00730099
007400 01  DETAIL-REPORT-RECORD        PIC X(150).                      00740099
007500                                                                  00750099
007600 FD  SUMMARY-REPORT-FILE                                          00760099
007700     RECORDING MODE IS F                                          00770099
007800     LABEL RECORDS ARE STANDARD                                   00780099
007900     BLOCK CONTAINS 0 RECORDS.                                    00790099
008000                                                                  00800099
008100 01  SUMMARY-REPORT-RECORD       PIC X(132).                      00810099
008200*                                                                 00820099
W28545 FD  RECLS-EXTRACT-FILE                                           00690099
W28545     RECORDING MODE IS F                                          00700099
W28545     LABEL RECORDS ARE STANDARD                                   00710099
W28545     BLOCK CONTAINS 0 RECORDS.                                    00720099
W28545                                                                  00730099
W28545 01  RECLS-EXTRACT-REC           PIC X(137).                      00740099
W28545                                                                          
W28545 FD  BUYER-EXTRACT-FILE                                           00690099
W28545     RECORDING MODE IS F                                          00700099
W28545     LABEL RECORDS ARE STANDARD                                   00710099
W28545     BLOCK CONTAINS 0 RECORDS.                                    00720099
W28545                                                                  00730099
W28545 01  BUYER-EXTRACT-REC           PIC X(139).                      00740099
W28545                                                                          
008300******************************************************************00830099
008400 WORKING-STORAGE SECTION.                                         00840099
008500******************************************************************00850099
008600                                                                  00860099
008700*** INPUT CONTROL RECORD                                          00870099
008800 01  CC-CONTROL-CARD.                                             00880099
008900     05  CC-EXTR-START-CCYY-MM-DD                                 00890099
009000                                 PIC X(10).                       00900099
009100     05  FILLER                  PIC X(70).                       00910099
009200                                                                  00920099
R21731*** INPUT RECLASS RECORD                                          00930099
R21731     COPY IMRD008.                                                00940099
R21731                                                                  00920099
009300*** OUTPUT DEBIT & CREDIT EXTRACT RECORDS                         00930099
W26006     COPY MLRD015.                                                00940099
009500                                                                  00950099
009600*** REPORT EXTRACT RECORDS                                        00960099
009700     COPY MLRD113.                                                00970099
009800                                                                  00980099
W28545*** CYCLE INVENTORY RECLASS OUTPUT                                        
W28545*** CONTAINS THE REPORT LINE (SL-D-SKU-LINE)                              
W28545*01  IN052-SKU-DETAIL.                                            00740099
W28545     COPY INRD052.                                                        
009900 EJECT                                                            00990099
010000                                                                  01000099
010100 01  PC-PROGRAM-COUNTERS                     COMP-3.              01010099
R21731     05  PC-ITEM-RECS-READ                                        01020099
010300                                 PIC S9(9)   VALUE ZERO.          01030099
010400     05  PC-TDTATTR-ROWS-SELECTED                                 01040099
010500                                 PIC S9(9)   VALUE ZERO.          01050099
W21731     05  PC-ATTR-ROWS-SELECTED   PIC S9(9)   VALUE ZERO.          01060099
R21731     05  PC-SKU-ROWS-SELECTED    PIC S9(9)   VALUE ZERO.          01060099
010700     05  PC-TMDSEAR-ROWS-SELECTED                                 01070099
010800                                 PIC S9(9)   VALUE ZERO.          01080099
010900     05  PC-TMDSEAR-TRSPBAR-ROWS-SLCTD                            01090099
011000                                 PIC S9(9)   VALUE ZERO.          01100099
011100     05  PC-TUPCPLS-ROWS-SLCTD                                    01110099
011200                                 PIC S9(9)   VALUE ZERO.          01120099
011100     05  PC-TVNDDPT-ROWS-SLCTD                                    01121099
011200                                 PIC S9(9)   VALUE ZERO.          01122099
W21731     05  PC-SKU-STORE-ROWS-FETCHED                                01130099
011400                                 PIC S9(9)   VALUE ZERO.          01140099
011500                                                                  01150099
011600     05  PC-TRNS-EXTR-RECS-WRITTEN                                01160099
011700                                 PIC S9(9)   VALUE ZERO.          01170099
011800     05  PC-RPT-EXTR-RECS-WRITTEN                                 01180099
011900                                 PIC S9(9)   VALUE ZERO.          01190099
W28545     05  PC-EXTRACT-OUT-COUNT    PIC S9(11)  VALUE ZERO.                  
012000                                                                  01200099
012100 01  PV-PROGRAM-VARIABLES.                                        01210099
           05  PV-HOLD-STORE-NMBR      PIC X(03).                       01210199
           05  FILLER REDEFINES PV-HOLD-STORE-NMBR.                     01210299
               10  PV-HOLD-STORE-NMBR-RED PIC 9(03).                    01210399
                                                                        01210499
           05  PV-HOLD-STORE-NMBR-INT  PIC  S9(4) COMP.                 01210599
           05  PV-UPCPLS-UNT-COST-AMT  PIC  S9(7)V9(3) COMP-3.          01211099
           05  PV-UPCPLS-UNT-RTL-AMT   PIC  S9(7)V9(2) COMP-3.          01212099
           05  PV-000-UNT-COST-AMT     PIC  S9(7)V9(3) COMP-3.          01213099
           05  PV-000-UNT-RTL-AMT      PIC  S9(7)V9(2) COMP-3.          01214099
12200      05  PV-KY-DTE               PIC X(10).                       01220099
R21731     05  PV-EFF-DTE              PIC X(10).                       01220099
012300                                                                  01230099
012900     05  PV-CR-BATCH-NBR         PIC 9(3).                        01290099
012910     05  PV-DR-BATCH-NBR         PIC 9(3).                        01291099
012920                                                                  01292099
012930     05  PV-DATE-YYMMDD.                                          01293099
012940         10  PV-DATE-YYMMDD-YY   PIC XX.                          01294099
012950         10  PV-DATE-YYMMDD-MM   PIC XX.                          01295099
012960         10  PV-DATE-YYMMDD-DD   PIC XX.                          01296099
012970     05  PV-TIME-HHMMSS.                                          01297099
012980         10  PV-TIME-HHMMSS-HH   PIC XX.                          01298099
012990         10  PV-TIME-HHMMSS-MM   PIC XX.                          01299099
013000         10  PV-TIME-HHMMSS-SS   PIC XX.                          01300099
013100                                                                  01310099
W26603     05  PV-WORK-SKU             PIC 9(08).                       01320099
W26603                                                                  01310099
W26603     05  PV-RCLS-SKU             PIC 9(08).                       01320099
I15034     05  PV-RMS-STYL-ID          PIC S9(8)V COMP-3.               01320099
I15034     05  PV-RMS-STYL-ID-NBR      PIC 9(8).                        01320099
I15034     05  PV-RMS-STYL-ID-NBR-SIGN PIC S9(8).                       01320099
013200     05  PV-RCLS-TMST            PIC X(10).                       01320099
013200     05  PV-DATE-REFORMATTER.                                     01320099
013300         10  PV-DATE-REFOR-CC    PIC XX.                          01330099
013400         10  PV-DATE-REFOR-YY    PIC XX.                          01340099
013500         10  FILLER              PIC X.                           01350099
013600         10  PV-DATE-REFOR-MM    PIC XX.                          01360099
013700         10  FILLER              PIC X.                           01370099
013800         10  PV-DATE-REFOR-DD    PIC XX.                          01380099
013900     05  PV-DATE-MMDDYY.                                          01390099
W26603         10  PV-DATE-MMDDYY-CC   PIC XX.                          01400099
W26603         10  PV-DATE-MMDDYY-YY   PIC XX.                          01420099
014000         10  PV-DATE-MMDDYY-MM   PIC XX.                          01400099
014100         10  PV-DATE-MMDDYY-DD   PIC XX.                          01410099
014300     05  FILLER REDEFINES PV-DATE-MMDDYY.                         01430099
W26603         10  FILLER              PIC X(04).                       01450099
014400         10  PV-DATE-MMDD        PIC X(4).                        01440099
014600     05  PV-DATE-MMDDCCYY.                                        01460099
014700         10  PV-DATE-MMDDCCYY-MM PIC XX.                          01470099
014800         10  FILLER              PIC X       VALUE '/'.           01480099
014900         10  PV-DATE-MMDDCCYY-DD PIC XX.                          01490099
015000         10  FILLER              PIC X       VALUE '/'.           01500099
015100         10  PV-DATE-MMDDCCYY-CC PIC XX.                          01510099
015200         10  PV-DATE-MMDDCCYY-YY PIC XX.                          01520099
015400                                                                  01540099
015500     05  PV-DB2-SELECT-COLUMNS.                                   01550099
21731          10  PV-FR-SKU-ATR.                                               
21731              15  PV-FR-SKU-ATR-DEPT  PIC 9(3)        VALUE ZEROES.        
21731              15  PV-FR-SKU-ATR-MAJ   PIC 9(2)        VALUE ZEROES.        
21731              15  PV-FR-SKU-ATR-SUB   PIC 9(2)        VALUE ZEROES.        
W21731         10  FILLER REDEFINES PV-FR-SKU-ATR.                              
W21731             15  PV-FR-SKU-ATR-DEPT-X                                     
W21731                                     PIC X(03).                           
W21731             15  PV-FR-SKU-ATR-MAJ-X PIC X(02).                           
W21731             15  PV-FR-SKU-ATR-SUB-X PIC X(02).                           
21731          10  PV-TO-SKU-ATR.                                               
21731              15  PV-TO-SKU-ATR-DEPT  PIC 9(3)        VALUE ZEROES.        
21731              15  PV-TO-SKU-ATR-MAJ   PIC 9(2)        VALUE ZEROES.        
21731              15  PV-TO-SKU-ATR-SUB   PIC 9(2)        VALUE ZEROES.        
W21731         10  FILLER REDEFINES PV-TO-SKU-ATR.                              
W21731             15  PV-TO-SKU-ATR-DEPT-X                                     
W21731                                     PIC X(03).                           
W21731             15  PV-TO-SKU-ATR-MAJ-X PIC X(02).                           
W21731             15  PV-TO-SKU-ATR-SUB-X PIC X(02).                           
R21731         10  PV-SKU                  PIC X(08).                           
W26603         10  PV-SKU-NUMERIC REDEFINES                                     
W26603             PV-SKU                  PIC 9(08).                           
016200         10  PV-MDSEAR-DEPT-NBR  PIC X(3).                        01620099
016300         10  PV-MDSEAR-MAJ-CL-NBR                                 01630099
016400                                 PIC X(2).                        01640099
016500         10  PV-MDSEAR-SUB-CL-NBR                                 01650099
016600                                 PIC X(3).                        01660099
016700                                                                  01670099
017300* TIMESTAMP FORMAT IS CCYY-MM-DD-HH.MM.SS.NNNNNN                  01730099
           05  PV-TMST.                                                 01730199
R21731         10  PV-RECL-DTE            PIC  X(10) VALUE SPACES.      01730299
               10  FILLER                 PIC  X(16) VALUE              01730399
                                                 '-23.59.59.999999'.    01730499
                                                                        01731099
R21731     05  PV-RECL-TIMESTAMP       PIC X(26).                       01740099
                                                                                
018200     05  PV-REPORT-DATA.                                          01820099
018300         10  PV-DTL-LINE-COUNT   PIC S9(3)  COMP-3  VALUE 0.      01830099
018400         10  PV-DTL-PAGE-COUNT   PIC S9(7)  COMP-3  VALUE 0.      01840099
018500                                                                  01850099
018600     05  PV-SKU-STORE-LVL-DATA.                                   01860099
018800         10  PV-ONHAND-QTY       PIC S9(7)V      COMP-3.          01880099
018900         10  PV-RND-MERCH-EXT-CST-AMT                             01890099
019000                                 PIC S9(11)V9(2) COMP-3.          01900099
019100         10  PV-MERCH-EXT-RTL-AMT                                 01910099
019200                                 PIC S9(11)V9(2) COMP-3.          01920099
019300                                                                  01930099
019400         10  PV-EXT-CST-RCRD-PROC                                 01940099
019500                                 PIC S9(11)V99   COMP-3.          01950099
019600         10  PV-EXT-RTL-RCRD-PROC                                 01960099
019700                                 PIC S9(11)V99   COMP-3.          01970099
019800                                                                  01980099
019900     05  PV-SKU-LVL-DATA.                                         01990099
020000         10  PV-SKU-FSCL-MN-NBR   PIC X(02).                      02000099
020100                                                                  02010099
W21731         10  PV-SKU-DESC          PIC X(30).                      02020099
W21731         10  PV-ENT-ID            PIC S9(09) COMP.                02021099
               10  PV-UPC-ID            PIC S9(09) COMP.                02022099
W21731         10  PV-HIST-ENT-ID       PIC S9(09) COMP.                02024099
R21731     05  PV-SKU-LVL-RPT-DATA.                                     01990099
020300**** THE FOLLOWING FIELDS ARE FOR THE REPORT EXTRACT RECORDS.*****02030099
020400         10  PV-SKU-HIST-MAJ-CL-DESC                              02040099
020500                                 PIC X(25).                       02050099
020600         10  PV-SKU-MERCH-MAJ-CL-DESC                             02060099
020700                                 PIC X(25).                       02070099
020800                                                                  02080099
020900         10  PV-SKU-HIST-SUB-CL-DESC                              02090099
021000                                 PIC X(25).                       02100099
021100         10  PV-SKU-MERCH-SUB-CL-DESC                             02110099
021200                                 PIC X(25).                       02120099
021300                                                                  02130099
021500         10  PV-SKU-HIST-BYR-NBR PIC X(3).                        02150099
021600         10  PV-SKU-MERCH-BYR-NBR                                 02160099
021700                                 PIC X(3).                        02170099
021800                                                                  02180099
022000         10  PV-SKU-HIST-DEPT-DESC                                02200099
022100                                 PIC X(25).                       02210099
022200         10  PV-SKU-MERCH-DEPT-DESC                               02220099
022300                                 PIC X(25).                       02230099
022400                                                                  02240099
022500         10  PV-SKU-HIST-WORKER-FIR-NAME                          02250099
022600                                 PIC X(12).                       02260099
022700         10  PV-SKU-MERCH-WORKER-FIR-NAME                         02270099
022800                                 PIC X(12).                       02280099
022900                                                                  02290099
023000         10  PV-SKU-HIST-WORKER-LAST-NAME                         02300099
023100                                 PIC X(18).                       02310099
023200         10  PV-SKU-MERCH-WORKER-LAST-NAME                        02320099
023300                                 PIC X(18).                       02330099
023400                                                                  02340099
023900         10  PV-SKU-HIST-VENDOR-NMBR.                             02390099
024000             15  PV-SKU-HIST-VENDOR-NMBR-00                       02400099
024100                                 PIC XX.                          02410099
024200             15  PV-SKU-HIST-VENDOR-NMBR-999                      02420099
024300                                 PIC 9(3).                        02430099
024400                                                                  02440099
024500         10  PV-SKU-MERCH-VENDOR-NMBR.                            02450099
024600             15  PV-SKU-MERCH-VENDOR-NMBR-00                      02460099
024700                                 PIC XX.                          02470099
024800             15  PV-SKU-MERCH-VENDOR-NMBR-999                     02480099
024900                                 PIC 9(3).                        02490099
025000**** THE ABOVE FIELDS ARE FOR THE REPORT EXTRACT RECORDS.*********02500099
025100         10  PV-SKU-MERCH-UNT-RTL-AMT                             02510099
025200                                 PIC S9(7)V9(2)  COMP-3.          02520099
025300         10  PV-SKU-MERCH-UNT-CST-AMT                             02530099
025400                                 PIC S9(7)V9(2)  COMP-3.          02540099
025500         10  PV-RND-SKU-MERCH-UNT-CST-AMT                         02550099
025600                                 PIC S9(7)V9(2)  COMP-3.          02560099
025700                                                                  02570099
025800         10  PV-SKU-ONHAND-QTY   PIC S9(7)V      COMP-3.          02580099
025900                                                                  02590099
026000         10  PV-SKU-D-MERCH-EXT-RTL-AMT                           02600099
026100                                 PIC S9(11)V9(2) COMP-3.          02610099
026200         10  PV-SKU-D-MERCH-EXT-CST-AMT                           02620099
026300                                 PIC S9(11)V9(2) COMP-3.          02630099
026400         10  PV-SKU-C-MERCH-EXT-RTL-AMT                           02640099
026500                                 PIC S9(11)V9(2) COMP-3.          02650099
026600         10  PV-SKU-C-MERCH-EXT-CST-AMT                           02660099
026700                                 PIC S9(11)V9(2) COMP-3.          02670099
026800                                                                  02680099
026900     05  PV-GRAND-TOTALS.                                         02690099
027000         10  PV-GT-TOTAL-QTY     PIC S9(13).                      02700099
027100         10  PV-GT-TOTAL-D-MERCH-EXT-RTL                          02710099
027200                                 PIC S9(13)V99.                   02720099
027300         10  PV-GT-TOTAL-D-MERCH-EXT-CST                          02730099
027400                                 PIC S9(13)V99.                   02740099
027500         10  PV-GT-TOTAL-C-MERCH-EXT-RTL                          02750099
027600                                 PIC S9(13)V99.                   02760099
027700         10  PV-GT-TOTAL-C-MERCH-EXT-CST                          02770099
027800                                 PIC S9(13)V99.                   02780099
027900                                                                  02790099
028000     05  PV-ERROR-TOTALS.                                         02800099
028100         10  PV-ERR-NO-DOLRS-TOTAL                                02810099
028200                                 PIC S9(13).                      02820099
028300                                                                  02830099
028400     05  PV-SKU-FORMATTER.                                        02840099
028500         10  PV-SKU-FRMT-DEPT    PIC X(3).                        02850099
028700         10  PV-SKU-FRMT-CLASS   PIC X(2).                        02870099
028900         10  PV-SKU-FRMT-SEQ     PIC X(3).                        02890099
029000                                                                  02900099
029900     05  PV-SUB-CL-NBR-FORMATTER.                                 02990099
030000         10  PV-SUB-CL-NBR-FRMT-1                                 03000099
030100                                 PIC X.                           03010099
030200         10  PV-SUB-CL-NBR-FRMT-2                                 03020099
030300                                 PIC XX.                          03030099
030400                                                                  03040099
R21731 01  WS-UPC-NBR                     PIC S9(15)V  COMP-3.                  
R21731 01  WS-UPC-NBR-REDEF-1             PIC 9(15).                            
R21731 01  WS-UPC-NBR-REDEF-2 REDEFINES WS-UPC-NBR-REDEF-1.                     
R21731     10  WS-UPC-NBR-REDEF-1-6       PIC 9(6).                             
R21731     10  WS-UPC-NBR-REDEF-7-14      PIC 9(8).                             
R21731     10  WS-UPC-NBR-REDEF-15        PIC 9.                                
R21731 01  WS-UPC-NBR-CONVERSION-1        PIC S9(8)    COMP-3.                  
R21731 01  WS-UPC-NBR-CONVERSION-2        PIC X(8)     VALUE SPACES.            
030500                                                                  03040099
031100 01  CD-COUNTER-DISPLAY.                                          03110099
031200     05  CD-COUNT-HOLD1          PIC Z,ZZZ,ZZZ,ZZZ,ZZ9.           03120099
031300                                                                  03130099
031400 01  PC-PROGRAM-CONSTANTS.                                        03140099
031500     05  PC-LINE-COUNT-MAX       PIC S9(3)   VALUE +65.           03150099
031600                                                                  03160099
031700     05  PC-MLKUT410             PIC X(8)    VALUE 'MLKUT410'.    03170099
031900                                                                  03190099
032000     05  PC-C                    PIC X       VALUE 'C'.           03200099
032100     05  PC-D                    PIC X       VALUE 'D'.           03210099
032400     05  PC-N                    PIC X       VALUE 'N'.           03240099
032500     05  PC-Y                    PIC X       VALUE 'Y'.           03250099
R21731     05  PC-I                    PIC X       VALUE 'I'.           03250099
032600     05  PC-BYR                  PIC XXX     VALUE 'BYR'.         03260099
032700     05  PC-DPT                  PIC XXX     VALUE 'DPT'.         03270099
032800     05  PC-MCL                  PIC XXX     VALUE 'MCL'.         03280099
032900     05  PC-SCL                  PIC XXX     VALUE 'SCL'.         03290099
033000                                                                  03300099
033100     05  PC-00                   PIC X(2)    VALUE '00'.          03310099
033200     05  PC-00000                PIC X(5)    VALUE '00000'.       03320099
033300     05  PC-1                    PIC X       VALUE '1'.           03330099
033400     05  PC-01                   PIC XX      VALUE '01'.          03340099
033500     05  PC-02                   PIC XX      VALUE '02'.          03350099
033600     05  PC-03                   PIC XX      VALUE '03'.          03360099
G34517*    05  PC-52                   PIC XX      VALUE '52'.          03370099
G34517     05  PC-Z2                   PIC XX      VALUE 'Z2'.          03370099
G34517*    05  PC-53                   PIC XX      VALUE '53'.          03380099
G34517     05  PC-Z1                   PIC XX      VALUE 'Z1'.          03380099
033900     05  PC-999                  PIC XXX     VALUE '999'.         03390099
034000                                                                  03400099
W26603     05  PC-POS-EXTENSION-2 PIC S9(09)V99  VALUE +999999999.99.   03410099
W26603     05  PC-NEG-EXTENSION-2 PIC S9(09)V99  VALUE -999999999.99.   03420099
034300                                                                  03430099
034400     05  PC-PCKD-7               PIC S9(07)V COMP-3 VALUE 0.      03440099
034500                                                                  03450099
034600 01  PS-PROGRAM-SWITCHES.                                         03460099
R21731     05  PS-RECLASS-FILE-EOF-SW  PIC X       VALUE 'N'.           03470099
R21731         88  PS-RECLASS-FILE-EOF             VALUE 'Y'.           03480099
R21731         88  PS-RECLASS-FILE-NOT-EOF         VALUE 'N'.           03490099
R21731     05  PS-TUPC-FOUND           PIC X       VALUE 'N'.           03470099
R21731         88  PS-TUPC-IS-FOUND                VALUE 'Y'.           03480099
R21731         88  PS-TUPC-IS-NOT-FOUND            VALUE 'N'.           03490099
W21731     05  PS-SKU-ATTR-FOUND       PIC X       VALUE 'N'.           03500099
W21731         88  PS-SKU-ATTR-IS-FOUND            VALUE 'Y'.           03510099
W21731         88  PS-SKU-ATTR-IS-NOT-FOUND        VALUE 'N'.           03520099
B34517     05  PS-TMDARVS-FOUND-SW     PIC X       VALUE 'N'.           03500099
B34517         88  PS-TMDARVS-IS-FOUND             VALUE 'Y'.           03510099
B34517         88  PS-TMDARVS-IS-NOT-FOUND         VALUE 'N'.           03520099
035300     05  PS-TSKST-DONE           PIC X       VALUE 'N'.           03530099
035400         88  PS-TSKST-IS-DONE                VALUE 'Y'.           03540099
035500         88  PS-TSKST-IS-NOT-DONE            VALUE 'N'.           03550099
035600     05  PS-TDTATTR-FOUND        PIC X       VALUE 'N'.           03560099
035700         88  PS-TDTATTR-IS-FOUND             VALUE 'Y'.           03570099
035800         88  PS-TDTATTR-IS-NOT-FOUND         VALUE 'N'.           03580099
035900     05  PS-TMDSEAR-FOUND        PIC X       VALUE 'N'.           03590099
036000         88  PS-TMDSEAR-IS-FOUND             VALUE 'Y'.           03600099
036100         88  PS-TMDSEAR-IS-NOT-FOUND         VALUE 'N'.           03610099
036200     05  PS-TMDSEAR-TRSPBAR-FOUND                                 03620099
036300                                 PIC X       VALUE 'N'.           03630099
036400         88  PS-TMDSEAR-TRSPBAR-IS-FOUND     VALUE 'Y'.           03640099
036500         88  PS-TMDSEAR-TRSPBAR-NOT-FOUND    VALUE 'N'.           03650099
036600     05  PS-TUPCPLS-FOUND                                         03660099
036700                                 PIC X       VALUE 'N'.           03670099
036800         88  PS-TUPCPLS-IS-FOUND             VALUE 'Y'.           03680099
W21731         88  PS-TUPCPLS-IS-NOT-FOUND         VALUE 'N'.           03690099
036600     05  PS-TUPCPLS-000-FOUND                                     03691099
036700                                 PIC X       VALUE 'N'.           03692099
036800         88  PS-TUPCPLS-000-IS-FOUND         VALUE 'Y'.           03693099
W21731         88  PS-TUPCPLS-000-IS-NOT-FOUND     VALUE 'N'.           03694099
037000                                                                  03700099
037100     05  PS-END-OF-CST-AMTS-SW   PIC X       VALUE 'N'.           03710099
037200         88  PS-END-OF-CST-AMTS              VALUE 'Y'.           03720099
037300     05  PS-END-OF-RTL-AMTS-SW   PIC X       VALUE 'N'.           03730099
037400         88  PS-END-OF-RTL-AMTS              VALUE 'Y'.           03740099
037500                                                                  03750099
037600 EJECT                                                            03760099
037700                                                                  03770099
037800 01 ABEND-AREAS.                                                  03780099
037900     05 ABEND-CODE               PIC S9(04)  VALUE ZERO           03790099
038000                                             COMP SYNC.           03800099
038100         88  AC-BAD-DATA                     VALUE +4003.         03810099
038200         88  AC-DB2-ERROR                    VALUE +4013.         03820099
038300     05  AA-ABEND-LIT            PIC X(40)   VALUE                03830099
038400           '*****       ABEND'.                                   03840099
038500     05  AA-PROGRAM-LIT          PIC X(40)   VALUE                03850099
038600             '*****   PROGRAM: MLKUT410'.                         03860099
038700     05  AA-PARAGRAPH-LIT.                                        03870099
038800         10  FILLER              PIC X(17)   VALUE                03880099
038900             '***** PARAGRAPH: '.                                 03890099
039000         10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.        03900099
039100     05  AA-MESSAGE-LINE.                                         03910099
039200         10  FILLER              PIC X(06)   VALUE '*****'.       03920099
039300         10  AA-MESSAGE          PIC X(127)  VALUE SPACES.        03930099
039400     05  AA-DB2-ERROR-LIT        PIC X(40)   VALUE                03940099
039500             '*****    DB2 ERROR'.                                03950099
039600     05  AA-DB2-OPERATION-LIT.                                    03960099
039700         10  FILLER              PIC X(17)   VALUE                03970099
039800             '***** OPERATION: '.                                 03980099
039900         10  AA-DB2-OPERATION.                                    03990099
040000             15  AA-DB2-OP-1     PIC X(25)   VALUE SPACES.        04000099
040100             15  AA-DB2-OP-2     PIC X(25)   VALUE SPACES.        04010099
040200     05  AA-DB2-TABLE-1          PIC X(08)   VALUE SPACES.        04020099
040300     05  AA-DB2-TABLE-2          PIC X(08)   VALUE SPACES.        04030099
040400     05  AA-DB2-TABLE-3          PIC X(08)   VALUE SPACES.        04040099
040500     05  AA-DB2-TABLE-4          PIC X(08)   VALUE SPACES.        04050099
040600                                                                  04060099
040700 EJECT                                                            04070099
040800                                                                  04080099
040900******************************************************************04090099
041000*  STANDARD KOHL'S HEADING LINE FOR A 150 COLUMN REPORT           04100099
041100******************************************************************04110099
041200     COPY DPWS150O.                                               04120099
041300*                                                                 04130099
041400 01  H2-D-HEADING2.                                               04140099
041500     05  FILLER                  PIC X(49)   VALUE SPACE.         04150099
041600     05  FILLER                  PIC X(45)   VALUE                04160099
R21731         ' SKU RECLASS FINANCIAL REPORT - STORE DETAIL '.         04170099
041800     05  FILLER                  PIC X(56)   VALUE SPACE.         04180099
041900*                                                                 04190099
042000 01  H3-D-HEADING3.                                               04200099
042100     05  FILLER                  PIC X(59)   VALUE SPACE.         04210099
042200     05  FILLER                  PIC X(04)   VALUE 'FOR '.        04220099
042300     05  H3-D-FROM-DATE.                                          04230099
042400         10  H3-D-FROM-MONTH     PIC 9(02)   VALUE ZEROS.         04240099
042500         10  FILLER              PIC X(01)   VALUE '/'.           04250099
042600         10  H3-D-FROM-DAY       PIC 9(02)   VALUE ZEROS.         04260099
042700         10  FILLER              PIC X(01)   VALUE '/'.           04270099
042800         10  H3-D-FROM-YEAR      PIC 9(02)   VALUE ZEROS.         04280099
042900     05  FILLER                  PIC X(16)                        04290099
043000                                 VALUE ' - BATCH NUMBER '.        04300099
043100     05  H3-D-CR-BATCH-NBR       PIC X(3).                        04310099
043200     05  FILLER                  PIC X(3)    VALUE ' - '.         04320099
043300     05  H3-D-DR-BATCH-NBR       PIC X(3).                        04330099
043400     05  FILLER                  PIC X(54)   VALUE SPACE.         04340099
043500*                                                                 04350099
21731  01  H4-D-HEADING4.                                               04360099
21731      05  FILLER                  PIC X(18)   VALUE                04370099
R21731*        '       FROM       '.                                    04410099
R21731         '    FROM        TO'.                                    04380099
21731      05  FILLER                  PIC X(02)   VALUE SPACES.        04390099
R21731*    05  FILLER                  PIC X(18)   VALUE                04400099
R21731     05  FILLER                  PIC X(18)   VALUE SPACES.        04400099
R21731*        '        TO        '.                                    04410099
21731      05  FILLER                  PIC X(02)   VALUE SPACES.        04420099
21731      05  FILLER                  PIC X(10)   VALUE SPACES.        04430099
21731      05  FILLER                  PIC X(02)   VALUE SPACES.        04450099
21731      05  FILLER                  PIC X(20)   VALUE SPACES.        04460099
21731      05  FILLER                  PIC X(01)   VALUE SPACES.        04480099
21731      05  FILLER                  PIC X(5)    VALUE SPACES.        04490099
21731      05  FILLER                  PIC X(02)   VALUE SPACES.        04510099
21731      05  FILLER                  PIC X(11)   VALUE SPACES.        04520099
21731      05  FILLER                  PIC X(01)   VALUE SPACES.        04540099
21731      05  FILLER                  PIC X(11)   VALUE SPACES.        04550099
21731      05  FILLER                  PIC X(02)   VALUE SPACES.        04570099
21731      05  FILLER                  PIC X(15)   VALUE SPACES.        04580099
21731      05  FILLER                  PIC X(02)   VALUE SPACES.        04600099
21731      05  FILLER                  PIC X(11)   VALUE SPACES.        04610099
21731      05  FILLER                  PIC X(01)   VALUE SPACES.        04630099
21731      05  FILLER                  PIC X(15)   VALUE SPACES.        04640099
21731      05  FILLER                  PIC X(01)   VALUE SPACES.        04660099
046700*                                                                 04670099
21731  01  H5-D-HEADING5.                                               04360099
R21731     05  FILLER                  PIC X(15)   VALUE                04370099
R21731         'DPT-CLASSES    '.                                               
R21731     05  FILLER                  PIC X(15)   VALUE                04400099
R21731         'DPT-CLASSES    '.                                               
R21731     05  FILLER                  PIC X(08)   VALUE                04390099
R21731         '  SKU   '.                                                      
21731      05  FILLER                  PIC X(01)   VALUE SPACES.        04420099
21731      05  FILLER                  PIC X(12)   VALUE                04430099
21731          'RECLASS DATE'.                                          04440099
21731      05  FILLER                  PIC X(01)   VALUE SPACES.        04450099
21731      05  FILLER                  PIC X(20)   VALUE                04460099
21731          'SKU DESC'.                                              04470099
21731      05  FILLER                  PIC X(01)   VALUE SPACES.        04480099
21731      05  FILLER                  PIC X(5)    VALUE                04490099
21731          'STORE'.                                                 04500099
21731      05  FILLER                  PIC X(02)   VALUE SPACES.        04510099
21731      05  FILLER                  PIC X(11)   VALUE                04520099
21731          ' ONHAND QTY'.                                           04530099
21731      05  FILLER                  PIC X(01)   VALUE SPACES.        04540099
21731      05  FILLER                  PIC X(11)   VALUE                04550099
21731          '     RETAIL'.                                           04560099
21731      05  FILLER                  PIC X(02)   VALUE SPACES.        04570099
21731      05  FILLER                  PIC X(15)   VALUE                04580099
21731          '     EXT RETAIL'.                                       04590099
21731      05  FILLER                  PIC X(02)   VALUE SPACES.        04600099
21731      05  FILLER                  PIC X(11)   VALUE                04610099
21731          '       COST'.                                           04620099
21731      05  FILLER                  PIC X(01)   VALUE SPACES.        04630099
21731      05  FILLER                  PIC X(15)   VALUE                04640099
21731          '       EXT COST'.                                       04650099
21731      05  FILLER                  PIC X(01)   VALUE SPACES.        04660099
21731                                                                   04670099
046800 01  EL-D-ERROR-LINE.                                             04680099
21731      05  EL-D-FROM-DEPT          PIC X(03)   VALUE SPACES.                
21731      05  FILLER                  PIC X(01)   VALUE '-'.                   
21731      05  EL-D-FROM-MAJ-CLASS     PIC X(02)   VALUE SPACES.                
21731      05  FILLER                  PIC X(01)   VALUE '/'.                   
21731      05  EL-D-FROM-SUB-CLASS     PIC X(02)   VALUE SPACES.                
R21731     05  FILLER                  PIC X(06)   VALUE SPACES.                
21731      05  EL-D-TO-DEPT            PIC X(03)   VALUE SPACES.                
21731      05  FILLER                  PIC X(01)   VALUE '-'.                   
21731      05  EL-D-TO-MAJ-CLASS       PIC X(02)   VALUE SPACES.                
21731      05  FILLER                  PIC X(01)   VALUE '/'.                   
21731      05  EL-D-TO-SUB-CLASS       PIC X(02)   VALUE SPACES.                
R21731     05  FILLER                  PIC X(06)   VALUE SPACES.                
21731      05  EL-D-TO-SKU             PIC X(08)   VALUE SPACES.        04710099
047200     05  FILLER                  PIC X(02)   VALUE SPACES.        04720099
047300     05  EL-D-DATE-MMDDCCYY      PIC X(10)   VALUE SPACES.        04730099
047400     05  FILLER                  PIC X(02)   VALUE SPACES.        04740099
047500*TRUNCATED SKU DESC FROM 25 TO 20                                 04750099
047600     05  EL-D-SKU-DESC           PIC X(20)   VALUE SPACES.        04760099
047700     05  FILLER                  PIC X(30)   VALUE SPACES.        04770099
047800     05  EL-D-MESSAGE            PIC X(65)   VALUE SPACES.        04780099
047900*                                                                 04790099
048000 01  SL-D-SKU-LINE.                                               04800099
21731      05  SL-D-FROM-DEPT          PIC X(03)   VALUE SPACES.                
21731      05  FILLER                  PIC X(01)   VALUE '-'.                   
21731      05  SL-D-FROM-MAJ-CLASS     PIC X(02)   VALUE SPACES.                
21731      05  FILLER                  PIC X(01)   VALUE '/'.                   
21731      05  SL-D-FROM-SUB-CLASS     PIC X(02)   VALUE SPACES.                
R21731     05  FILLER                  PIC X(06)   VALUE SPACES.                
21731      05  SL-D-TO-DEPT            PIC X(03)   VALUE SPACES.                
21731      05  FILLER                  PIC X(01)   VALUE '-'.                   
21731      05  SL-D-TO-MAJ-CLASS       PIC X(02)   VALUE SPACES.                
21731      05  FILLER                  PIC X(01)   VALUE '/'.                   
21731      05  SL-D-TO-SUB-CLASS       PIC X(02)   VALUE SPACES.                
R21731     05  FILLER                  PIC X(06)   VALUE SPACES.                
21731      05  SL-D-TO-SKU             PIC X(08)   VALUE SPACES.        04830099
048400     05  FILLER                  PIC X(02)   VALUE SPACES.        04840099
048500     05  SL-D-DATE-MMDDCCYY      PIC X(10)   VALUE SPACES.        04850099
048600     05  FILLER                  PIC X(02)   VALUE SPACES.        04860099
048700*TRUNCATED SKU DESC FROM 25 TO 20                                 04870099
048800     05  SL-D-SKU-DESC           PIC X(20)   VALUE SPACES.        04880099
W26603     05  FILLER                  PIC X(01)   VALUE SPACES.        04890099
W26006     05  SL-D-STORE-NMBR         PIC Z9999   VALUE ZEROES.        04900099
21731      05  FILLER                  PIC X(02)   VALUE SPACES.        04910099
21731      05  SL-D-ONHAND-QTY         PIC ZZZ,ZZZ,ZZ9-.                04920099
21731      05  SL-D-UNT-RTL-AMT        PIC ZZZZ,ZZZ.99-.                04940099
049500     05  FILLER                  PIC X(01)   VALUE SPACES.        04950099
049600     05  SL-D-EXT-RETAIL         PIC ZZZZ,ZZZ,ZZZ.99-.            04960099
049700     05  FILLER                  PIC X(01)   VALUE SPACES.        04970099
21731      05  SL-D-UNT-COST-AMT       PIC ZZZZ,ZZZ.99-.                04980099
050000     05  SL-D-EXT-COST           PIC ZZZZ,ZZZ,ZZZ.99-.            05000099
050100*                                                                 05010099
050200 01  TL-D1-TOTAL-LINE.                                            05020099
050300     05  TL-D1-TOTAL-LABEL       PIC X(22).                       05030099
050400     05  FILLER                  PIC X(55)   VALUE SPACES.        05040099
050500     05  TL-D1-ONHAND-QTY        PIC ZZ,ZZZ,ZZZ,ZZ9-.             05050099
050600     05  FILLER                  PIC X(11)   VALUE SPACES.        05060099
050700     05  TL-D1-EXT-RETAIL        PIC ZZ,ZZZ,ZZZ,ZZZ.99-.          05070099
050800     05  FILLER                  PIC X(11)   VALUE SPACES.        05080099
050900     05  TL-D1-EXT-COST          PIC ZZ,ZZZ,ZZZ,ZZZ.99-.          05090099
051000*                                                                 05100099
051100 01  TL-D2-TOTAL-LINE.                                            05110099
051200     05  TL-D2-ERR-LABEL         PIC X(43).                       05120099
051300     05  TL-D2-ERR-TOTAL         PIC Z,ZZZ,ZZZ,ZZZ,ZZ9.           05130099
051400     05  FILLER                  PIC X(91)   VALUE SPACES.        05140099
051500                                                                  05150099
051600 EJECT                                                            05160099
051700                                                                  05170099
051800******************************************************************05180099
051900*  STANDARD KOHL'S HEADING LINE FOR A 132 COLUMN REPORT           05190099
052000******************************************************************05200099
052100     COPY DPWS132O.                                               05210099
052200*                                                                 05220099
052300 01  H2-S-HEADING2.                                               05230099
052400     05  FILLER                  PIC X(41)   VALUE SPACE.         05240099
052500     05  FILLER                  PIC X(49)   VALUE                05250099
R21731         ' SKU RECLASS FINANCIAL REPORT - STORE DETAIL '.         04170099
052700     05  FILLER                  PIC X(42)   VALUE SPACE.         05270099
052800*                                                                 05280099
052900 01  H3-S-HEADING3.                                               05290099
053000     05  FILLER                  PIC X(51)   VALUE SPACE.         05300099
053100     05  FILLER                  PIC X(04)   VALUE 'FOR '.        05310099
053200     05  H3-S-FROM-DATE.                                          05320099
053300         10  H3-S-FROM-MONTH     PIC 9(02)   VALUE ZEROS.         05330099
053400         10  FILLER              PIC X(01)   VALUE '/'.           05340099
053500         10  H3-S-FROM-DAY       PIC 9(02)   VALUE ZEROS.         05350099
053600         10  FILLER              PIC X(01)   VALUE '/'.           05360099
053700         10  H3-S-FROM-YEAR      PIC 9(02)   VALUE ZEROS.         05370099
053800     05  FILLER                  PIC X(16)                        05380099
053900                                 VALUE ' - BATCH NUMBER '.        05390099
054000     05  H3-S-CR-BATCH-NBR       PIC X(3).                        05400099
054100     05  FILLER                  PIC X(3)    VALUE ' - '.         05410099
054200     05  H3-S-DR-BATCH-NBR       PIC X(3).                        05420099
054300     05  FILLER                  PIC X(44)   VALUE SPACE.         05430099
054400*                                                                 05440099
054500 01  H4-S-HEADING4.                                               05450099
054600     05  FILLER                  PIC X(91)   VALUE SPACE.         05460099
054700     05  FILLER                  PIC X(06)   VALUE 'RETAIL'.      05470099
054800     05  FILLER                  PIC X(30)   VALUE SPACE.         05480099
054900     05  FILLER                  PIC X(04)   VALUE 'COST'.        05490099
055000     05  FILLER                  PIC X(01)   VALUE SPACE.         05500099
055100*                                                                 05510099
055200 01  TL-S1-TOTAL-LINE.                                            05520099
055300     05  TL-S1-TOTAL-LABEL       PIC X(18)   VALUE SPACES.        05530099
055400     05  FILLER                  PIC X(62)   VALUE SPACES.        05540099
055500     05  TL-S1-EXT-RETAIL        PIC ZZ,ZZZ,ZZZ,ZZZ.99-.          05550099
055600     05  FILLER                  PIC X(16)   VALUE SPACES.        05560099
055700     05  TL-S1-EXT-COST          PIC ZZ,ZZZ,ZZZ,ZZZ.99-.          05570099
055800*                                                                 05580099
055900 01  ER-END-OF-REPORT-LINE.                                       05590099
056000     05  FILLER                  PIC X(21)   VALUE                05600099
056100                                    '*** END OF REPORT ***'.      05610099
056200                                                                  05620099
056300 EJECT                                                            05630099
056400                                                                  05640099
056500******************************************************************05650099
056600*  DB2 COMMUNICATION AREA                                         05660099
056700******************************************************************05670099
056800     EXEC SQL                                                     05680099
056900          INCLUDE SQLCA                                           05690099
057000     END-EXEC.                                                    05700099
057100                                                                  05710099
057200******************************************************************05720099
057300*  DB2 ERROR MESSAGES FORMAT AREA.                                05730099
057400******************************************************************05740099
057500     COPY DPWS004.                                                05750099
057600                                                                  05760099
057700******************************************************************05770099
057800*  DB2 TDTATTR TABLE LAYOUT                                       05780099
057900******************************************************************05790099
058000     EXEC SQL                                                     05800099
058100          INCLUDE TDTATTR                                         05810099
058200     END-EXEC.                                                    05820099
058300                                                                  05830099
058400******************************************************************05840099
058500*  DB2 TMDSEAR TABLE LAYOUT                                       05850099
058600******************************************************************05860099
058700     EXEC SQL                                                     05870099
058800          INCLUDE TMDSEAR                                         05880099
058900     END-EXEC.                                                    05890099
059000                                                                  05900099
059100******************************************************************05910099
059200*  DB2 TRSPBAR TABLE LAYOUT                                       05920099
059300******************************************************************05930099
059400     EXEC SQL                                                     05940099
059500          INCLUDE TRSPBAR                                         05950099
059600     END-EXEC.                                                    05960099
059700                                                                  05970099
060500******************************************************************06050099
060600*  DB2 TSKST TABLE LAYOUT                                         06060099
060700******************************************************************06070099
060800     EXEC SQL                                                     06080099
W26006          INCLUDE TSKST                                           06090099
061000     END-EXEC.                                                    06100099
061100                                                                  06110099
061900******************************************************************06190099
062000*  DB2 TUPC TABLE LAYOUT                                          06200099
062100******************************************************************06210099
062200     EXEC SQL                                                     06220099
062300          INCLUDE TUPC                                            06230099
062400     END-EXEC.                                                    06240099
062500                                                                  06250099
062600******************************************************************06260099
062700*  DB2 TUPCPLS TABLE LAYOUT                                       06270099
062800******************************************************************06280099
062900     EXEC SQL                                                     06290099
063000          INCLUDE TUPCPLS                                         06300099
063100     END-EXEC.                                                    06310099
063200                                                                  06320099
063300******************************************************************06330099
063400*  DB2 TVNDDPT TABLE LAYOUT                                       06340099
063500******************************************************************06350099
063600     EXEC SQL                                                     06360099
063700          INCLUDE TVNDDPT                                         06370099
063800     END-EXEC.                                                    06380099
063900                                                                  06390099
064000******************************************************************06400099
064100*  DB2 TVNDSTL TABLE LAYOUT                                       06410099
064200******************************************************************06420099
064300     EXEC SQL                                                     06430099
064400          INCLUDE TVNDSTL                                         06440099
064500     END-EXEC.                                                    06450099
064600                                                                  06460099
21731 ******************************************************************06400099
21731 *  DB2 TSKXREF TABLE SKU CROSS-REFERENCE LAYOUT                   06410099
21731 ******************************************************************06420099
21731      EXEC SQL                                                     06430099
21731           INCLUDE TSKXREF                                         06440099
21731      END-EXEC.                                                    06450099
21731                                                                   06460099
I15034******************************************************************06400099
I15034** DB2 TMDARVS TABLE MERCHANDISING VENDOR STYLE LAYOUT            06410099
I15034******************************************************************06420099
I15034     EXEC SQL                                                     06430099
I15034          INCLUDE TMDARVS                                         06440099
I15034     END-EXEC.                                                    06450099
I15034                                                                  06460099
R21731                                                                  06470099
R21731******************************************************************06470099
R21731*  DB2 CURSOR TO GET SKU FOR A SUBCLASS MDSEAR ID AND A VS ID     06480099
R21731******************************************************************06490099
R21731     EXEC SQL                                                     06500099
R21731         DECLARE TUPC_CURSOR CURSOR FOR                           06510099
R21731         SELECT B.INTR_UPC_DESC                                   18480099
R21731               ,B.UPC_ID                                          18480099
R21731               ,B.UPC_NBR                                         18480099
J34517               ,B.INTR_UPC_ID                                     18480099
R21731               ,C.ENT_ID                                          18481199
R21731           FROM  TUPC    B                                        18500099
R21731                ,TVNDSTL C                                        18500099
R21731          WHERE B.SUB_CL_MDSEAR_ID   = :UPC-SUB-CL-MDSEAR-ID      18510099
R21731            AND B.VS_ID              = :UPC-VS-ID                         
R21731            AND B.UPC_TYP_CDE        = :PC-I                              
R21731            AND B.EFF_BEG_DTE       <= :PV-EFF-DTE                18530099
R21731            AND (B.EFF_END_DTE      >= :PV-EFF-DTE                18530099
R21731                 OR B.EFF_END_DTE   IS NULL)                      18530099
R21731            AND C.VS_ID              = B.VS_ID                    18530099
R21731            AND C.EFF_BEG_DTE       <= :PV-EFF-DTE                18530099
R21731            AND (C.EFF_END_DTE      >= :PV-EFF-DTE                18530099
R21731                 OR C.EFF_END_DTE   IS NULL)                      18530099
R21731         ORDER BY B.UPC_NBR                                       18530099
W26603         WITH UR                                                          
R21731     END-EXEC.                                                    18540099
064700******************************************************************06470099
064800*  DB2 TSKST CURSOR                                               06480099
064900******************************************************************06490099
065000     EXEC SQL                                                     06500099
065100         DECLARE TSKST_CURSOR CURSOR FOR                          06510099
W26006          SELECT LOC_NBR,                                         06520099
065300                 ONHAND_QTY                                       06530099
J34517*           FROM TSKST, TSKXREF                                   06540099
J34517            FROM TSKST                                            06540099
065500          WHERE                                                           
W26006                (LOC_NBR             > SMALLINT(0))                       
J34517*           AND (ONHAND_QTY         <> :PC-PCKD-7)                06570099
J34517            AND (ONHAND_QTY         <> 0)                         06570099
J34517*           AND (SKU                 = :SKXREF-SKU)               06580099
J34517*           AND (TSKXREF.ITM_NBR     = TSKST.ITEM_NMBR)           06610099
J34517            AND (ITEM_NMBR           = :TSKST-ITEM-NMBR)          06610099
R26006        ORDER BY LOC_NBR                                          06620099
W26603        WITH UR                                                           
066300     END-EXEC.                                                    06630099
066400                                                                  06640099
068500                                                                  06850099
068600 EJECT                                                            06860099
068700                                                                  06870099
068800******************************************************************06880099
068900 PROCEDURE DIVISION.                                              06890099
069000******************************************************************06900099
069100                                                                  06910099
069200******************************************************************06920099
069300 0000-MAINLINE-MLKUT410.                                          06930099
069400******************************************************************06940099
069500*                                                                 06950099
069600     PERFORM 1000-INITIALIZATION.                                 06960099
069700                                                                  06970099
069800     PERFORM 2000-MAIN-PROCESS.                                   06980099
069900                                                                  06990099
070000     PERFORM 8000-EOJ.                                            07000099
070100                                                                  07010099
070200     STOP RUN.                                                    07020099
070300                                                                  07030099
070400 EJECT                                                            07040099
070500                                                                  07050099
070600******************************************************************07060099
070700 1000-INITIALIZATION.                                             07070099
070800******************************************************************07080099
070900*                                                                 07090099
071000     OPEN INPUT  CONTROL-FILE                                     07100099
R21731                 RECLASS-FILE.                                            
071100     OPEN OUTPUT TRANS-EXTRACT-FILE                               07110099
071200                 DETAIL-REPORT-FILE                               07120099
071300                 SUMMARY-REPORT-FILE                              07130099
W28545                 RPT-EXTRACT-FILE                                 07140099
W28545                 RECLS-EXTRACT-FILE                                       
W28545                 BUYER-EXTRACT-FILE.                                      
071500                                                                  07150099
071600     PERFORM 4000-READ-CONTROL-FILE.                              07160099
071700                                                                  07170099
071800     DISPLAY ' '.                                                 07180099
071900     DISPLAY '*** CONTROL CARD VALUES FOR MLKUT410 FOLLOW ***'    07190099
072000     DISPLAY CC-CONTROL-CARD.                                     07200099
072100                                                                  07210099
072200     PERFORM 1100-EDIT-CONTROL-CARD.                              07220099
072300                                                                  07230099
072400     PERFORM 1200-BUILD-RPT-DETAIL-TITLE.                         07240099
072500                                                                  07250099
072600     PERFORM 1300-BUILD-RPT-SUMMARY-TITLE.                        07260099
072700                                                                  07270099
072800     INITIALIZE PV-GRAND-TOTALS.                                  07280099
072900     INITIALIZE PV-ERROR-TOTALS.                                  07290099
W34517     INITIALIZE ML015-PURCHASE-RECORD.                            07290099
W34517                                                                  07290099
073000                                                                  07300099
073100 EJECT                                                            07310099
073200                                                                  07320099
073300******************************************************************07330099
073400 1100-EDIT-CONTROL-CARD.                                          07340099
073500******************************************************************07350099
073600*                                                                 07360099
W21731     MOVE CC-EXTR-START-CCYY-MM-DD TO PV-KY-DTE.                          
074000                                                                  07400099
074100     PERFORM 7000-SELECT-TDTATTR-FOR-EDIT.                        07410099
074200                                                                  07420099
074300     IF PS-TDTATTR-IS-NOT-FOUND                                   07430099
074400         MOVE '1100-EDIT-CONTROL-CARD'                            07440099
074500                                 TO AA-PARAGRAPH-NAME             07450099
074600         MOVE 'CTL CARD START DATE IS INVALID'                    07460099
074700                                 TO AA-MESSAGE                    07470099
074800         MOVE +4002              TO ABEND-CODE                    07480099
074900         PERFORM 9900-COMMON-ABEND-ROUTINE                        07490099
075000     END-IF.                                                      07500099
075100                                                                  07510099
075200                                                                  07520099
075300                                                                  07530099
075400 EJECT                                                            07540099
075500                                                                  07550099
075600******************************************************************07560099
075700 1200-BUILD-RPT-DETAIL-TITLE.                                     07570099
075800******************************************************************07580099
075900*                                                                 07590099
076000     ACCEPT PV-DATE-YYMMDD FROM DATE.                             07600099
076100     MOVE PV-DATE-YYMMDD-YY      TO DP150O-RUN-YEAR.              07610099
076200     MOVE PV-DATE-YYMMDD-MM      TO DP150O-RUN-MONTH.             07620099
076300     MOVE PV-DATE-YYMMDD-DD      TO DP150O-RUN-DAY.               07630099
076400     ACCEPT PV-TIME-HHMMSS FROM TIME.                             07640099
076500     MOVE PV-TIME-HHMMSS-HH      TO DP150O-RUN-HOUR.              07650099
076600     MOVE PV-TIME-HHMMSS-MM      TO DP150O-RUN-MINUTE.            07660099
076700     MOVE PC-MLKUT410            TO DP150O-PROGRAM-NAME.          07670099
076800     MOVE 1                      TO DP150O-REPORT-NUMBER.         07680099
076900                                                                  07690099
077000     MOVE CC-EXTR-START-CCYY-MM-DD                                07700099
077100                                 TO PV-DATE-REFORMATTER.          07710099
077200     MOVE PV-DATE-REFOR-MM       TO H3-D-FROM-MONTH.              07720099
077300     MOVE PV-DATE-REFOR-DD       TO H3-D-FROM-DAY.                07730099
077400     MOVE PV-DATE-REFOR-YY       TO H3-D-FROM-YEAR.               07740099
077500                                                                  07750099
077600     MOVE PC-C                   TO PV-CR-BATCH-NBR(1:1).         07760099
077700*    MOVE PV-DATE-YYMMDD-DD      TO PV-CR-BATCH-NBR(2:2).         07770099
H34517     MOVE CC-EXTR-START-CCYY-MM-DD (9:2)                                  
H34517                                 TO PV-CR-BATCH-NBR(2:2).         07770099
077800                                                                  07780099
077900     MOVE PC-D                   TO PV-DR-BATCH-NBR(1:1).         07790099
078000*    MOVE PV-DATE-YYMMDD-DD      TO PV-DR-BATCH-NBR(2:2).         07800099
H34517     MOVE CC-EXTR-START-CCYY-MM-DD (9:2)                                  
H34517                                 TO PV-DR-BATCH-NBR(2:2).         07770099
078100                                                                  07810099
078110     DISPLAY ' '.                                                 07811099
078120     DISPLAY '*** BATCH NUMBER FOR MLKUT410 FOLLOWS ***'.         07812099
078130     DISPLAY PV-DR-BATCH-NBR.                                     07813099
078140     DISPLAY PV-CR-BATCH-NBR.                                     07814099
078150 EJECT                                                            07815099
078160                                                                  07816099
078170******************************************************************07817099
078180 1300-BUILD-RPT-SUMMARY-TITLE.                                    07818099
078190******************************************************************07819099
078200*                                                                 07820099
078300     MOVE PV-DATE-YYMMDD-YY      TO DP132O-RUN-YEAR.              07830099
078400     MOVE PV-DATE-YYMMDD-MM      TO DP132O-RUN-MONTH.             07840099
078500     MOVE PV-DATE-YYMMDD-DD      TO DP132O-RUN-DAY.               07850099
078600     MOVE PV-TIME-HHMMSS-HH      TO DP132O-RUN-HOUR.              07860099
078700     MOVE PV-TIME-HHMMSS-MM      TO DP132O-RUN-MINUTE.            07870099
078800     MOVE PC-MLKUT410            TO DP132O-PROGRAM-NAME.          07880099
078900     MOVE 2                      TO DP132O-REPORT-NUMBER.         07890099
079000                                                                  07900099
079100     MOVE CC-EXTR-START-CCYY-MM-DD                                07910099
079200                                 TO PV-DATE-REFORMATTER.          07920099
079300     MOVE PV-DATE-REFOR-MM       TO H3-S-FROM-MONTH.              07930099
079400     MOVE PV-DATE-REFOR-DD       TO H3-S-FROM-DAY.                07940099
079500     MOVE PV-DATE-REFOR-YY       TO H3-S-FROM-YEAR.               07950099
079600                                                                  07960099
079700 EJECT                                                            07970099
079800                                                                  07980099
079900******************************************************************07990099
080000 2000-MAIN-PROCESS.                                               08000099
080100******************************************************************08010099
080200*                                                                 08020099
W21731     SET PS-TDTATTR-IS-NOT-FOUND TO TRUE.                         08030099
080400                                                                  08040099
R21731     PERFORM 7110-READ-RECLASS-FILE.                              08280099
R21731     PERFORM 2120-GET-SKU-INFO.                                   08280099
080800*                                                                 08080099
R21731     IF PS-RECLASS-FILE-NOT-EOF                                   08090099
081000         MOVE PV-CR-BATCH-NBR    TO H3-D-CR-BATCH-NBR             08100099
081100                                    H3-S-CR-BATCH-NBR             08110099
081200         MOVE PV-DR-BATCH-NBR    TO H3-D-DR-BATCH-NBR             08120099
081300                                    H3-S-DR-BATCH-NBR             08130099
081400     ELSE                                                         08140099
081500         MOVE SPACES             TO H3-D-CR-BATCH-NBR             08150099
081600                                    H3-S-CR-BATCH-NBR             08160099
081700                                    H3-D-DR-BATCH-NBR             08170099
081800                                    H3-S-DR-BATCH-NBR             08180099
081900     END-IF.                                                      08190099
082000                                                                  08200099
082100     PERFORM 6000-WRITE-RPT-DETAIL-TITLE.                         08210099
082200                                                                  08220099
082300     PERFORM 6100-WRITE-RPT-SUMMARY-TITLE.                        08230099
082400                                                                  08240099
082500     PERFORM                                                      08250099
R21731       UNTIL PS-RECLASS-FILE-EOF                                  08260099
R21731                                                                          
R21731         INITIALIZE PV-SKU-LVL-DATA                               08390099
R21731         PERFORM 2110-BLD-SKU-RECLS-DATES                                 
R21731                                                                          
R21731         SET PS-TUPC-IS-FOUND TO TRUE                                     
R21731         PERFORM 7200-OPEN-TUPC                                           
B34517                                                                          
B34517         IF PS-TMDARVS-IS-FOUND                                           
B34517             PERFORM 2050-CHECK-FOR-TUPC                                  
B34517         ELSE                                                             
B34517             MOVE 'NO TMDARVS EXISTS FOR STYLE      '             16520099
B34517                                 TO EL-D-MESSAGE                  16530099
B34517             PERFORM 6060-WRITE-RPT-DETAIL-NO-SKU                         
B34517         END-IF                                                           
R21731         PERFORM 7110-READ-RECLASS-FILE                           08280099
R21731         PERFORM 2120-GET-SKU-INFO                                08280099
B34517     END-PERFORM.                                                 08290099
R21731                                                                          
B34517******************************************************************07990099
B34517 2050-CHECK-FOR-TUPC.                                             08000099
B34517******************************************************************08010099
B34517                                                                          
R21731     PERFORM 7210-FETCH-TUPC.                                             
R21731                                                                  16540099
R21731     IF PS-TUPC-IS-NOT-FOUND                                              
B34517         MOVE 'NO SKUS EXIST FOR EITHER DEPT/CL'                  16520099
B34517                                 TO EL-D-MESSAGE                  16530099
R21731         PERFORM 6060-WRITE-RPT-DETAIL-NO-SKU                             
R21731     ELSE                                                                 
R21731         PERFORM 2100-PROCESS-TUPC-RECS                                   
R21731            UNTIL PS-TUPC-IS-NOT-FOUND                                    
R21731     END-IF.                                                              
R21731                                                                          
R21731     PERFORM 7220-CLOSE-TUPC.                                             
083000                                                                  08300099
083200                                                                  08320099
083300 EJECT                                                            08330099
083400                                                                  08340099
083500******************************************************************08350099
R21731 2100-PROCESS-TUPC-RECS.                                          08360099
083700******************************************************************08370099
083800*                                                                 08380099
084000                                                                  08400099
084200                                                                  08420099
084200                                                                  08420099
R21731     SET PS-TSKST-IS-NOT-DONE TO TRUE                                     
R21731     PERFORM 2105-PROCESS-TSKST                                           
R21731        UNTIL PS-TSKST-IS-DONE                                            
R21731                                                                          
R21731     PERFORM 7210-FETCH-TUPC.                                             
R21731                                                                          
R21731                                                                          
R21731******************************************************************08350099
R21731 2105-PROCESS-TSKST.                                              08360099
R21731******************************************************************08370099
084400                                                                  08440099
J34517     PERFORM 2200-GET-ITM-NBR.                                    11250099
084600     PERFORM 7300-OPEN-CURSOR-TSKST.                              08460099
084700     PERFORM 7310-FETCH-TSKST.                                    08470099
084800                                                                  08480099
084900     IF PS-TSKST-IS-NOT-DONE                                      08490099
085000         PERFORM 2130-GET-FSCL-MN-NBR                             08500099
085100         PERFORM 2140-GET-BYR-NBR-DEPT-DESC                       08510099
085200         PERFORM 2150-GET-MAJ-CL-DESC                             08520099
085300         PERFORM 2160-GET-SUB-CL-DESC                             08530099
085400         PERFORM 2170-GET-BYR-NAME                                08540099
085500         PERFORM 2180-GET-VNDR-INHOUSE-NBR                        08550099
               PERFORM 7910-SELECT-TUPCPLS-000-RCD                      08551099
W21731         IF PS-TUPCPLS-000-IS-FOUND                               08571099
085800             PERFORM                                              08580099
085900               UNTIL PS-TSKST-IS-DONE                             08590099
W21731                 PERFORM 2190-GET-VNDR-NBR-N-DOLRS                08661099
086000                 PERFORM 3000-CALC-EXT-CST-N-RTL-AMTS             08600099
W28545                 PERFORM 5130-WRITE-DR-BUYER-EXTRACT                      
W28545                 PERFORM 5140-WRITE-CR-BUYER-EXTRACT                      
086100                 PERFORM 3100-ACCUM-SKU-TOTALS                    08610099
086200                 PERFORM 3200-ACCUM-GRAND-TOTALS                  08620099
086300                 PERFORM 5110-WRITE-DEBIT-EXTRACT-REC             08630099
086400                 PERFORM 5120-WRITE-CREDIT-EXTRACT-REC            08640099
086500                 PERFORM 6010-WRITE-RPT-DETAIL-LINE               08650099
086600                 PERFORM 7310-FETCH-TSKST                         08660099
086700             END-PERFORM                                          08670099
086900             PERFORM 6020-WRITE-RPT-DETAIL-SKU-SUM                08690099
                   PERFORM 5210-WRITE-RPT-DEBIT-EXTRACT                 08700099
087100             PERFORM 5220-WRITE-RPT-CREDIT-EXTRACT                08710099
087200         ELSE                                                     08720099
087400             PERFORM 6030-WRITE-RPT-DETAIL-NO-DOLRS               08740099
085900             SET PS-TSKST-IS-DONE TO TRUE                         08590099
087500         END-IF                                                   08750099
087600     ELSE                                                         08760099
087800         PERFORM 6040-WRITE-RPT-DETAIL-NO-QTY                     08780099
087900     END-IF.                                                      08790099
                                                                                
W21731     PERFORM 7320-CLOSE-CURSOR-TSKST.                             08680099
088000                                                                  08800099
088100 EJECT                                                            08810099
088200                                                                  08820099
088300******************************************************************08830099
088400 2110-BLD-SKU-RECLS-DATES.                                        08840099
088500******************************************************************08850099
088600*                                                                 08860099
R21731     MOVE IM008-CRE-TMST(1:10)   TO PV-DATE-REFORMATTER           08870099
R21731                                    PV-RECL-DTE.                          
088800     MOVE PV-DATE-REFOR-MM       TO PV-DATE-MMDDYY-MM.            08880099
088900     MOVE PV-DATE-REFOR-DD       TO PV-DATE-MMDDYY-DD.            08890099
089000     MOVE PV-DATE-REFOR-YY       TO PV-DATE-MMDDYY-YY.            08900099
W26603     MOVE PV-DATE-REFOR-CC       TO PV-DATE-MMDDYY-CC.            08900099
089100                                                                  08910099
089200     MOVE PV-DATE-REFOR-MM       TO PV-DATE-MMDDCCYY-MM.          08920099
089300     MOVE PV-DATE-REFOR-DD       TO PV-DATE-MMDDCCYY-DD.          08930099
089400     MOVE PV-DATE-REFOR-CC       TO PV-DATE-MMDDCCYY-CC.          08940099
089500     MOVE PV-DATE-REFOR-YY       TO PV-DATE-MMDDCCYY-YY.          08950099
089600                                                                  08960099
089700 EJECT                                                            08970099
089800                                                                  08980099
089900******************************************************************08990099
W21731 2120-GET-SKU-INFO.                                               09000099
      *                                                                 09001099
090100******************************************************************09010099
R21731*    MAP RECLASS DATA FROM INPUT FILE                             09021099
090200***************************************************************** 09023099
R21731                                                                          
I15034**   GET RECLASS FROM RMS_STYL_ID INFO                                    
I15034     MOVE IM008-ITEM-KEY-RMS-STYL-ID TO PV-RMS-STYL-ID-NBR.               
X34517     DISPLAY 'PV-RMS-STYL-ID-NBR ' PV-RMS-STYL-ID-NBR.                    
I15034     MOVE PV-RMS-STYL-ID-NBR         TO PV-RMS-STYL-ID-NBR-SIGN.          
I15034     MOVE PV-RMS-STYL-ID-NBR-SIGN    TO PV-RMS-STYL-ID.                   
W34517     MOVE PV-RMS-STYL-ID             TO ML015-PURCH-RMS-STYL-ID.          
I15034                                                                          
W26603*    GET RECLASS SKU                                                      
W26603     MOVE IM008-ITEM-KEY-SKU     TO PV-RCLS-SKU.                          
R21731*    GET RECLASS DATE                                                     
R21731     MOVE IM008-CRE-TMST(1:10)   TO PV-RCLS-TMST.                         
R21731                                                                          
R21731*    GET OLD AND NEW DEPT                                                 
R21731     MOVE IM008-ITEM-KEY-DEPT    TO PV-FR-SKU-ATR-DEPT.           09050099
R21731                                                                          
R21731     IF IM008-STYLE-RECL-DEPT-CHG THEN                            09040099
R21731        MOVE IM008-STYLE-RECL-DEPT-NEW                            09040099
R21731                                 TO PV-TO-SKU-ATR-DEPT                    
R21731     ELSE                                                                 
R21731        MOVE IM008-ITEM-KEY-DEPT                                  09040099
R21731                                 TO PV-TO-SKU-ATR-DEPT.           09050099
R21731                                                                          
R21731                                                                          
R21731*    GET OLD AND NEW MAJOR CLASS                                          
R21731     MOVE IM008-ITEM-KEY-CLASS   TO PV-FR-SKU-ATR-MAJ.            09050099
R21731                                                                          
R21731     IF IM008-STYLE-RECL-CLASS-CHG THEN                           09040099
R21731        MOVE IM008-STYLE-RECL-CLASS-NEW                           09040099
R21731                                 TO PV-TO-SKU-ATR-MAJ                     
R21731     ELSE                                                                 
R21731        MOVE IM008-ITEM-KEY-CLASS                                 09040099
R21731                                 TO PV-TO-SKU-ATR-MAJ.            09050099
R21731                                                                          
R21731                                                                          
R21731*    GET OLD AND NEW SUB CLASS                                            
R21731     MOVE IM008-ITEM-KEY-SUBCL   TO PV-FR-SKU-ATR-SUB.            09050099
R21731                                                                          
R21731     IF IM008-STYLE-RECL-SUBCL-CHG THEN                           09040099
R21731        MOVE IM008-STYLE-RECL-SUBCL-NEW                           09040099
R21731                                 TO PV-TO-SKU-ATR-SUB                     
R21731     ELSE                                                                 
R21731        MOVE IM008-ITEM-KEY-SUBCL                                 09040099
R21731                                 TO PV-TO-SKU-ATR-SUB.            09050099
R21731                                                                          
093200******************************************************************09320099
093300 2130-GET-FSCL-MN-NBR.                                            09330099
093400******************************************************************09340099
093500*                                                                 09350099
093600     IF (PS-TDTATTR-IS-FOUND)                                     09360099
093700       AND (DTATTR-KY-DTE = PV-DATE-REFORMATTER)                  09370099
093800         MOVE DTATTR-FSCL-MN-NBR TO PV-SKU-FSCL-MN-NBR            09380099
093900     ELSE                                                         09390099
094100         PERFORM 7400-SELECT-TDTATTR-MN-NMBR                      09410099
094200         IF PS-TDTATTR-IS-FOUND                                   09420099
094300             MOVE DTATTR-FSCL-MN-NBR                              09430099
094400                                 TO PV-SKU-FSCL-MN-NBR            09440099
094500         ELSE                                                     09450099
094600             MOVE PC-01          TO PV-SKU-FSCL-MN-NBR            09460099
094700         END-IF                                                   09470099
094800     END-IF.                                                      09480099
094900                                                                  09490099
095000 EJECT                                                            09500099
095100                                                                  09510099
095200******************************************************************09520099
095300 2140-GET-BYR-NBR-DEPT-DESC.                                      09530099
095400******************************************************************09540099
095500*                                                                 09550099
W21731     MOVE PV-FR-SKU-ATR-DEPT-X   TO PV-MDSEAR-DEPT-NBR.           09570099
095800                                                                  09580099
095900     PERFORM 7500-SELECT-TMDSEAR-FOR-DPT.                         09590099
096000                                                                  09600099
096100     IF PS-TMDSEAR-IS-FOUND                                       09610099
W21731         AND MDSEAR-BYR-NBR NOT = SPACES                                  
096200         MOVE MDSEAR-BYR-NBR     TO PV-SKU-HIST-BYR-NBR           09620099
096300         MOVE MDSEAR-DESC        TO PV-SKU-HIST-DEPT-DESC         09630099
W21731     ELSE                                                                 
W21731         MOVE PC-999             TO PV-SKU-HIST-BYR-NBR                   
W21731         MOVE '* DEPT DESC NOT FOUND *' TO PV-SKU-HIST-DEPT-DESC          
096400     END-IF.                                                      09640099
096500                                                                  09650099
W21731     MOVE PV-TO-SKU-ATR-DEPT-X    TO PV-MDSEAR-DEPT-NBR.          09670099
096900                                                                  09690099
097000     PERFORM 7500-SELECT-TMDSEAR-FOR-DPT.                         09700099
097100                                                                  09710099
097200     IF PS-TMDSEAR-IS-FOUND                                       09720099
W21731         AND MDSEAR-BYR-NBR NOT = SPACES                                  
097300         MOVE MDSEAR-BYR-NBR     TO PV-SKU-MERCH-BYR-NBR          09730099
097400         MOVE MDSEAR-DESC        TO PV-SKU-MERCH-DEPT-DESC        09740099
W21731     ELSE                                                                 
W21731         MOVE PC-999             TO PV-SKU-MERCH-BYR-NBR                  
W21731         MOVE '* DEPT DESC NOT FOUND *' TO PV-SKU-MERCH-DEPT-DESC         
097500     END-IF.                                                      09750099
097600                                                                  09760099
100100 EJECT                                                            10010099
100200                                                                  10020099
100300******************************************************************10030099
100400 2150-GET-MAJ-CL-DESC.                                            10040099
100500******************************************************************10050099
100600*                                                                 10060099
W21731     MOVE PV-FR-SKU-ATR-DEPT-X   TO PV-MDSEAR-DEPT-NBR.           10080099
21731      MOVE PV-FR-SKU-ATR-MAJ      TO PV-MDSEAR-MAJ-CL-NBR.         10120099
101400                                                                  10140099
101500     PERFORM 7600-SELECT-TMDSEAR-FOR-MCL.                         10150099
101600                                                                  10160099
101700     IF PS-TMDSEAR-IS-FOUND                                       10170099
101800         MOVE MDSEAR-DESC        TO PV-SKU-HIST-MAJ-CL-DESC       10180099
101900     ELSE                                                         10190099
102000         MOVE '* CLASS DESC NOT FOUND * '                         10200099
102100                                 TO PV-SKU-HIST-MAJ-CL-DESC       10210099
102200     END-IF.                                                      10220099
102300                                                                  10230099
W21731     MOVE PV-TO-SKU-ATR-DEPT-X   TO PV-MDSEAR-DEPT-NBR.           10250099
21731      MOVE PV-TO-SKU-ATR-MAJ      TO PV-MDSEAR-MAJ-CL-NBR.         10300099
103200                                                                  10320099
103300     PERFORM 7600-SELECT-TMDSEAR-FOR-MCL.                         10330099
103400                                                                  10340099
103500     IF PS-TMDSEAR-IS-FOUND                                       10350099
103600         MOVE MDSEAR-DESC        TO PV-SKU-MERCH-MAJ-CL-DESC      10360099
103700     ELSE                                                         10370099
103800         MOVE '* CLASS DESC NOT FOUND * '                         10380099
103900                                 TO PV-SKU-MERCH-MAJ-CL-DESC      10390099
104000     END-IF.                                                      10400099
104100                                                                  10410099
104200 EJECT                                                            10420099
104300                                                                  10430099
104400******************************************************************10440099
104500 2160-GET-SUB-CL-DESC.                                            10450099
104600******************************************************************10460099
104700*                                                                 10470099
W21731     MOVE PV-FR-SKU-ATR-DEPT-X   TO PV-MDSEAR-DEPT-NBR.           10490099
105000     MOVE 0                      TO PV-SUB-CL-NBR-FRMT-1.         10500099
21731      MOVE PV-FR-SKU-ATR-SUB      TO PV-SUB-CL-NBR-FRMT-2.         10510099
105300     MOVE PV-SUB-CL-NBR-FORMATTER                                 10530099
105400                                 TO PV-MDSEAR-SUB-CL-NBR.         10540099
105500                                                                  10550099
105600     PERFORM 7700-SELECT-TMDSEAR-FOR-SCL.                         10560099
105700                                                                  10570099
105800     IF PS-TMDSEAR-IS-FOUND                                       10580099
105900         MOVE MDSEAR-DESC        TO PV-SKU-HIST-SUB-CL-DESC       10590099
106000     ELSE                                                         10600099
106100         MOVE '* SUB CL DESC NOT FOUND *'                         10610099
106200                                 TO PV-SKU-HIST-SUB-CL-DESC       10620099
106300     END-IF.                                                      10630099
106400                                                                  10640099
W21731     MOVE PV-TO-SKU-ATR-DEPT-X   TO PV-MDSEAR-DEPT-NBR.           10660099
106800     MOVE 0                      TO PV-SUB-CL-NBR-FRMT-1.         10680099
21731      MOVE PV-TO-SKU-ATR-SUB      TO PV-SUB-CL-NBR-FRMT-2.         10690099
107100     MOVE PV-SUB-CL-NBR-FORMATTER                                 10710099
107200                                 TO PV-MDSEAR-SUB-CL-NBR.         10720099
107300                                                                  10730099
107400     PERFORM 7700-SELECT-TMDSEAR-FOR-SCL.                         10740099
107500                                                                  10750099
107600     IF PS-TMDSEAR-IS-FOUND                                       10760099
107700         MOVE MDSEAR-DESC        TO PV-SKU-MERCH-SUB-CL-DESC      10770099
107800     ELSE                                                         10780099
107900         MOVE '* SUB CL DESC NOT FOUND *'                         10790099
108000                                 TO PV-SKU-MERCH-SUB-CL-DESC      10800099
108100     END-IF.                                                      10810099
108200                                                                  10820099
108300 EJECT                                                            10830099
108400                                                                  10840099
108500******************************************************************10850099
108600 2170-GET-BYR-NAME.                                               10860099
108700******************************************************************10870099
108800*                                                                 10880099
W21731     MOVE PV-FR-SKU-ATR-DEPT-X   TO PV-MDSEAR-DEPT-NBR.           10900099
109100                                                                  10910099
109200     PERFORM 7800-SELECT-TMDSEAR-TRSPBAR.                         10920099
109300                                                                  10930099
109400     IF PS-TMDSEAR-TRSPBAR-IS-FOUND                               10940099
109500         MOVE RSPBAR-WORKER-FIR-NAME                              10950099
109600                                 TO PV-SKU-HIST-WORKER-FIR-NAME   10960099
109700         MOVE RSPBAR-WORKER-LAST-NAME                             10970099
109800                                 TO PV-SKU-HIST-WORKER-LAST-NAME  10980099
109900     ELSE                                                         10990099
110000         MOVE '*** NO'           TO PV-SKU-HIST-WORKER-FIR-NAME   11000099
110100         MOVE 'BUYER NAME ***'                                    11010099
110200                                 TO PV-SKU-HIST-WORKER-LAST-NAME  11020099
110300     END-IF.                                                      11030099
110400                                                                  11040099
W21731     MOVE PV-TO-SKU-ATR-DEPT-X   TO PV-MDSEAR-DEPT-NBR.           11060099
110800                                                                  11080099
110900     PERFORM 7800-SELECT-TMDSEAR-TRSPBAR.                         11090099
111000                                                                  11100099
111100     IF PS-TMDSEAR-TRSPBAR-IS-FOUND                               11110099
111200         MOVE RSPBAR-WORKER-FIR-NAME                              11120099
111300                             TO PV-SKU-MERCH-WORKER-FIR-NAME      11130099
111400         MOVE RSPBAR-WORKER-LAST-NAME                             11140099
111500                             TO PV-SKU-MERCH-WORKER-LAST-NAME     11150099
111600     ELSE                                                         11160099
111700         MOVE '*** NO'           TO PV-SKU-MERCH-WORKER-FIR-NAME  11170099
111800         MOVE 'BUYER NAME ***'                                    11180099
111900                                 TO PV-SKU-MERCH-WORKER-LAST-NAME 11190099
112000     END-IF.                                                      11200099
112100                                                                  11210099
112200 EJECT                                                            11220099
112300                                                                  11230099
112400******************************************************************11240099
112500 2180-GET-VNDR-INHOUSE-NBR.                                       11250099
112600******************************************************************11260099
112700*                                                                 11270099
W26603     MOVE PV-ENT-ID            TO VNDDPT-ENT-ID.                          
W26603     MOVE PV-TO-SKU-ATR-DEPT-X TO VNDDPT-DEPT-NBR.                        
W26603                                                                          
211600     EXEC SQL                                                     11680599
               SELECT INHOUSE_NBR                                       11680699
                  INTO :VNDDPT-INHOUSE-NBR                              11680799
                 FROM TVNDDPT                                           11680899
W26603         WHERE ENT_ID    = :VNDDPT-ENT-ID                         11680999
W26603         AND   DEPT_NBR  = :VNDDPT-DEPT-NBR                       11681099
W26603         WITH UR                                                          
213800     END-EXEC.                                                    11681199
215400                                                                  11682099
214000     EVALUATE TRUE                                                11682199
214100         WHEN SQLCODE = 0                                         11682299
W21731             MOVE VNDDPT-INHOUSE-NBR                                      
W21731                 TO PV-SKU-MERCH-VENDOR-NMBR-999                          
214300             ADD +1              TO PC-TVNDDPT-ROWS-SLCTD         11682499
214400         WHEN SQLCODE = +100                                      11682599
W21731             MOVE 1              TO PV-SKU-MERCH-VENDOR-NMBR-999          
214600         WHEN OTHER                                               11682799
214700             MOVE '2180-SELECT-TVNDDPT-TUPCPLS'                   11682899
214800                                 TO AA-PARAGRAPH-NAME             11682999
214900             MOVE 'TVNDSTL TABLES ERROR'                          11683099
215000                                 TO AA-MESSAGE                    11683199
215100             MOVE 'SELECT'       TO AA-DB2-OPERATION              11683299
215200             PERFORM 9901-SQL-ERROR                               11683399
215300     END-EVALUATE.                                                11683499
                                                                        11683599
119600     MOVE PC-00                  TO PV-SKU-MERCH-VENDOR-NMBR-00.  11684299
119700                                                                  11684399
112600******************************************************************11684499
      *  GET THE INHOUSE NUMBER FOR THE OLD SKU                         11684599
      ****** 7/31/2003                                                  11684699
R21731*  NOTE: WITH THE RECLASS PROCESSES, THE VENDOR WILL NOT CHANGE   11684499
R21731*        THEREFORE, THIS PART OF THE CODE IS UNECCESSARY.         11684499
      ****** 3/01/2004                                                  11684699
W26006*  THE INHOUSE_NBR IS ASSIGNED BASED ON THE ASSOCIATION BETWEEN A 11684699
W26006*  DEPT_NBR AND ENT_ID. THEREFORE, WE CANNOT USE THE SAME NUMBER  11684699
W26006*  FOR BOTH THE CREDIT AND DEBIT TRANSACTIONS WHEN THE FROM AND TO11684699
W26006*  DEPARTMENTS ARE DIFFERENT. WHEN RECLASS CHANGES WERE APPLIED,  11684699
W26006*  THIS LOGIC WAS REMOVED. THIS CHANGE RE-INSTATES THE LOGIC      11684699
W26006******************************************************************11684699
W26006*                                                                 11684899
W26603     MOVE PV-ENT-ID            TO VNDDPT-ENT-ID.                          
W26603     MOVE PV-TO-SKU-ATR-DEPT-X TO VNDDPT-DEPT-NBR.                        
W26603                                                                          
W26006     EXEC SQL                                                     11684999
W26006         SELECT INHOUSE_NBR                                       11685099
W26006            INTO :VNDDPT-INHOUSE-NBR                              11685199
W26006           FROM TVNDDPT                                           11685299
W26603         WHERE ENT_ID    = :VNDDPT-ENT-ID                         11680999
W26603         AND   DEPT_NBR  = :VNDDPT-DEPT-NBR                       11681099
W26603         WITH UR                                                          
W26006     END-EXEC.                                                    11685599
W26006                                                                  11685699
W26006     EVALUATE TRUE                                                11685799
W26006         WHEN SQLCODE = 0                                         11685899
W26006             MOVE VNDDPT-INHOUSE-NBR                                      
W26006                 TO PV-SKU-HIST-VENDOR-NMBR-999                           
W26006             ADD +1              TO PC-TVNDDPT-ROWS-SLCTD         11686099
W26006         WHEN SQLCODE = +100                                      11686199
W26006             MOVE 1              TO PV-SKU-HIST-VENDOR-NMBR-999           
W26006         WHEN OTHER                                               11686399
W26006             MOVE '2180-SELECT-TVNDDPT-TUPCPLS'                   11686499
W26006                                 TO AA-PARAGRAPH-NAME             11686599
W26006             MOVE 'TVNDSTL TABLES ERROR'                          11686699
W26006                                 TO AA-MESSAGE                    11686799
W26006             MOVE 'SELECT'       TO AA-DB2-OPERATION              11686899
W26006             PERFORM 9901-SQL-ERROR                               11686999
W26006     END-EVALUATE.                                                11687099
W26006                                                                  11687199
W26006     MOVE PC-00                  TO PV-SKU-HIST-VENDOR-NMBR-00.   11687899
W26006                                                                  11687999
W26006                                                                  11688099
117000                                                                  11700099
117100******************************************************************11710099
117200 2190-GET-VNDR-NBR-N-DOLRS.                                       11720099
117300******************************************************************11730099
117400*                                                                 11740099
W21731     IF UPCPLS-UPC-STAT-CDE = '25' OR '30'                        11740399
W21731         PERFORM 7900-SELECT-TUPCPLS-STR-RCD                              
W21731         IF PS-TUPCPLS-IS-NOT-FOUND                                       
W21731             MOVE PV-000-UNT-COST-AMT TO PV-UPCPLS-UNT-COST-AMT           
W21731             MOVE PV-000-UNT-RTL-AMT  TO PV-UPCPLS-UNT-RTL-AMT            
W21731         END-IF                                                           
W21731     ELSE                                                                 
W21731         MOVE PV-000-UNT-COST-AMT TO PV-UPCPLS-UNT-COST-AMT               
W21731         MOVE PV-000-UNT-RTL-AMT  TO PV-UPCPLS-UNT-RTL-AMT                
W21731     END-IF.                                                      11744099
                                                                        11747099
121800******************************************************************12180099
121900**** ROUND THE FOLLOWING AMOUNTS FROM 3 DECIMAL PLACES TO 2.      12190099
122000******************************************************************12200099
W21731     COMPUTE PV-RND-SKU-MERCH-UNT-CST-AMT ROUNDED =                       
W21731           PV-UPCPLS-UNT-COST-AMT * 1.                                    
                                                                                
W21731     MOVE PV-UPCPLS-UNT-COST-AMT TO PV-SKU-MERCH-UNT-CST-AMT.             
W21731     MOVE PV-UPCPLS-UNT-RTL-AMT  TO PV-SKU-MERCH-UNT-RTL-AMT.             
123300                                                                  12330099
123400 EJECT                                                            12340099
123500                                                                  12350099
J34517******************************************************************11240099
J34517 2200-GET-ITM-NBR.                                                11250099
J34517******************************************************************11260099
J34517*                                                                 11270099
J34517     MOVE PV-SKU               TO SKXREF-SKU.                             
J34517     MOVE UPC-INTR-UPC-ID      TO SKXREF-INTR-UPC-ID.                     
J34517                                                                          
J34517     EXEC SQL                                                     11680599
J34517         SELECT ITM_NBR                                           11680699
J34517            INTO :SKXREF-ITM-NBR                                  11680799
J34517           FROM TSKXREF                                           11680899
J34517         WHERE SKU         = :SKXREF-SKU                          11680999
J34517         AND   INTR_UPC_ID = :SKXREF-INTR-UPC-ID                  11681099
J34517         WITH UR                                                          
J34517     END-EXEC.                                                    11681199
J34517                                                                  11682099
J34517     EVALUATE TRUE                                                11682199
J34517         WHEN SQLCODE = 0                                         11682299
J34517             CONTINUE                                                     
J34517         WHEN OTHER                                               11682799
J34517             DISPLAY ' SKU:         ' SKXREF-SKU                  11680999
J34517             DISPLAY ' INTR-UPC-ID: ' SKXREF-INTR-UPC-ID          11681099
J34517             MOVE '2200-GET-ITM-NBR'                              11682899
J34517                                 TO AA-PARAGRAPH-NAME             11682999
J34517             MOVE 'TSKXREF TABLE ERROR'                           11683099
J34517                                 TO AA-MESSAGE                    11683199
J34517             MOVE 'SELECT'       TO AA-DB2-OPERATION              11683299
J34517             PERFORM 9901-SQL-ERROR                               11683399
J34517     END-EVALUATE.                                                11683499
J34517                                                                  11683599
123600******************************************************************12361099
123700 3000-CALC-EXT-CST-N-RTL-AMTS.                                    12370099
123800******************************************************************12380099
123900*                                                                 12390099
124000     INITIALIZE PV-SKU-STORE-LVL-DATA.                            12400099
124100                                                                  12410099
124300     MOVE TSKST-ONHAND-QTY TO PV-ONHAND-QTY.                      12430099
124400                                                                  12440099
124500******************************************************************12450099
124600**** ROUND THE FOLLOWING AMOUNT FROM 3 DECIMAL PLACES TO 2.       12460099
124700******************************************************************12470099
124800                                                                  12480099
124900     COMPUTE PV-RND-MERCH-EXT-CST-AMT ROUNDED =                   12490099
125000         PV-ONHAND-QTY * PV-SKU-MERCH-UNT-CST-AMT.                12500099
125100                                                                  12510099
125200******************************************************************12520099
125300******************************************************************12530099
125400                                                                  12540099
125500     COMPUTE PV-MERCH-EXT-RTL-AMT ROUNDED =                       12550099
125600         PV-ONHAND-QTY * PV-SKU-MERCH-UNT-RTL-AMT.                12560099
125700                                                                  12570099
125800 EJECT                                                            12580099
125900                                                                  12590099
126000******************************************************************12600099
126100 3100-ACCUM-SKU-TOTALS.                                           12610099
126200******************************************************************12620099
126300*                                                                 12630099
126400     COMPUTE PV-SKU-ONHAND-QTY =                                  12640099
126500         PV-SKU-ONHAND-QTY + PV-ONHAND-QTY.                       12650099
126600                                                                  12660099
126700     COMPUTE PV-SKU-D-MERCH-EXT-RTL-AMT =                         12670099
126800         PV-SKU-D-MERCH-EXT-RTL-AMT +                             12680099
126900         (PV-MERCH-EXT-RTL-AMT * -1).                             12690099
127000     COMPUTE PV-SKU-D-MERCH-EXT-CST-AMT =                         12700099
127100         PV-SKU-D-MERCH-EXT-CST-AMT +                             12710099
127200         (PV-RND-MERCH-EXT-CST-AMT * -1).                         12720099
127300                                                                  12730099
127400     COMPUTE PV-SKU-C-MERCH-EXT-RTL-AMT =                         12740099
127500         PV-SKU-C-MERCH-EXT-RTL-AMT + PV-MERCH-EXT-RTL-AMT.       12750099
127600     COMPUTE PV-SKU-C-MERCH-EXT-CST-AMT =                         12760099
127700         PV-SKU-C-MERCH-EXT-CST-AMT + PV-RND-MERCH-EXT-CST-AMT.   12770099
127800                                                                  12780099
127900 EJECT                                                            12790099
128000                                                                  12800099
128100******************************************************************12810099
128200 3200-ACCUM-GRAND-TOTALS.                                         12820099
128300******************************************************************12830099
128400*                                                                 12840099
128500     COMPUTE PV-GT-TOTAL-QTY =                                    12850099
128600         PV-GT-TOTAL-QTY + PV-ONHAND-QTY.                         12860099
128700                                                                  12870099
128800     COMPUTE PV-GT-TOTAL-D-MERCH-EXT-RTL =                        12880099
128900         PV-GT-TOTAL-D-MERCH-EXT-RTL +                            12890099
129000         (PV-MERCH-EXT-RTL-AMT * -1).                             12900099
129100     COMPUTE PV-GT-TOTAL-D-MERCH-EXT-CST =                        12910099
129200         PV-GT-TOTAL-D-MERCH-EXT-CST +                            12920099
129300         (PV-RND-MERCH-EXT-CST-AMT * -1).                         12930099
129400                                                                  12940099
129500     COMPUTE PV-GT-TOTAL-C-MERCH-EXT-RTL =                        12950099
129600         PV-GT-TOTAL-C-MERCH-EXT-RTL + PV-MERCH-EXT-RTL-AMT.      12960099
129700     COMPUTE PV-GT-TOTAL-C-MERCH-EXT-CST =                        12970099
129800         PV-GT-TOTAL-C-MERCH-EXT-CST + PV-RND-MERCH-EXT-CST-AMT.  12980099
129900                                                                  12990099
130000 EJECT                                                            13000099
130100                                                                  13010099
130200******************************************************************13020099
130300 4000-READ-CONTROL-FILE.                                          13030099
130400******************************************************************13040099
130500*                                                                 13050099
130600     READ CONTROL-FILE                                            13060099
130700       INTO CC-CONTROL-CARD                                       13070099
130800         AT END                                                   13080099
130900             MOVE '4000-READ-CONTROL-FILE'                        13090099
131000                                 TO AA-PARAGRAPH-NAME             13100099
131100             MOVE 'CONTROL CARD IS MISSING'                       13110099
131200                                 TO AA-MESSAGE                    13120099
131300             MOVE +4001          TO ABEND-CODE                    13130099
131400             PERFORM 9900-COMMON-ABEND-ROUTINE                    13140099
131500     END-READ.                                                    13150099
131600                                                                  13160099
131700 EJECT                                                            13170099
131800                                                                  13180099
131900******************************************************************13190099
132000 5110-WRITE-DEBIT-EXTRACT-REC.                                    13200099
132100******************************************************************13210099
132200*                                                                 13220099
132300     MOVE PC-1                   TO ML015-PURCH-CDE.              13230099
W26006     MOVE PV-SKU-HIST-VENDOR-NMBR                                 13240099
W26603                          TO ML015-PURCH-VENDOR-INHSE-NMBR.       13250099
W26603     MOVE PV-ENT-ID              TO ML015-PURCH-ENT-ID.                   
W21731     MOVE PV-FR-SKU-ATR-DEPT     TO ML015-PURCH-DEPT-NBR.         13260099
21731      MOVE PV-FR-SKU-ATR-SUB      TO ML015-PURCH-CLASS-NBR.        13280099
133000     MOVE PV-DATE-MMDDYY         TO ML015-PURCH-INV-CUT-DTE.      13300099
W26603     MOVE ALL '0'                TO ML015-PURCH-PO-NBR.           13310099
133200     MOVE PV-DR-BATCH-NBR        TO ML015-PURCH-BATCH-NBR.        13320099
133300     MOVE PV-SKU-FSCL-MN-NBR     TO ML015-PURCH-KOHLS-MM.         13330099
G34517     MOVE PC-Z1                  TO ML015-PURCH-AP-TRANS-CDE.     13340099
W26603     MOVE PV-DATE-MMDDYY         TO ML015-PURCH-DOC-DTE.          13350099
W26603     MOVE ALL '0'                TO ML015-PURCH-DOC-5-NBR.        13360099
W26006     MOVE TSKST-LOC-NBR          TO ML015-PURCH-STORE-NBR-9.      13380099
133900     MOVE ZERO                   TO ML015-PURCH-DISCT-AMT.        13390099
134000     MOVE ZERO                   TO ML015-PURCH-FRGHT-AMT.        13400099
134100     IF PV-ONHAND-QTY > 0                                         13410099
134200         MOVE PC-02              TO ML015-PURCH-TRANS-CDE         13420099
134300     ELSE                                                         13430099
134400         MOVE PC-01              TO ML015-PURCH-TRANS-CDE         13440099
134500     END-IF.                                                      13450099
134600                                                                  13460099
W26603     IF PV-RCLS-SKU IS EQUAL TO ZEROS                                     
W26603         MOVE PV-SKU-NUMERIC  TO ML015-PURCH-SKU-NBR                      
W26603     ELSE                                                                 
W26603         MOVE PV-RCLS-SKU     TO ML015-PURCH-SKU-NBR                      
W26603     END-IF.                                                              
W26603                                                                          
W34517                                                                          
134700     IF (PV-RND-MERCH-EXT-CST-AMT > PC-POS-EXTENSION-2)           13470099
134800       OR (PV-RND-MERCH-EXT-CST-AMT < PC-NEG-EXTENSION-2)         13480099
134900       OR (PV-MERCH-EXT-RTL-AMT > PC-POS-EXTENSION-2)             13490099
135000       OR (PV-MERCH-EXT-RTL-AMT < PC-NEG-EXTENSION-2)             13500099
135100         PERFORM 9000-WRITE-MULTIPLE-RECS                         13510099
135200     ELSE                                                         13520099
135300         MOVE PV-RND-MERCH-EXT-CST-AMT                            13530099
135400                                 TO ML015-PURCH-MERCH-AMT         13540099
135500                                    ML015-PURCH-NET               13550099
135600         MOVE PV-MERCH-EXT-RTL-AMT                                13560099
135700                                 TO ML015-PURCH-RETAIL            13570099
135800         IF PV-RND-MERCH-EXT-CST-AMT < 0                          13580099
135900             COMPUTE ML015-PURCH-MERCH-AMT =                      13590099
136000                 ML015-PURCH-MERCH-AMT * -1                       13600099
136100             COMPUTE ML015-PURCH-NET =                            13610099
136200                 ML015-PURCH-NET * -1                             13620099
136300         END-IF                                                   13630099
136400         IF PV-MERCH-EXT-RTL-AMT < 0                              13640099
136500             COMPUTE ML015-PURCH-RETAIL =                         13650099
136600                 ML015-PURCH-RETAIL * -1                          13660099
136700         END-IF                                                   13670099
136800         WRITE TRANS-EXTRACT-RECORD FROM ML015-PURCHASE-RECORD    13680099
136900         ADD 1                   TO PC-TRNS-EXTR-RECS-WRITTEN     13690099
137000     END-IF.                                                      13700099
137100                                                                  13710099
137200 EJECT                                                            13720099
137300                                                                  13730099
137400******************************************************************13740099
137500 5120-WRITE-CREDIT-EXTRACT-REC.                                   13750099
137600******************************************************************13760099
137700*                                                                 13770099
137800                                                                  13780099
137900     MOVE PC-1                   TO ML015-PURCH-CDE.              13790099
138000     MOVE PV-SKU-MERCH-VENDOR-NMBR                                13800099
W26603                             TO ML015-PURCH-VENDOR-INHSE-NMBR.    13810099
W26603     MOVE PV-ENT-ID              TO ML015-PURCH-ENT-ID.           13810099
W21731     MOVE PV-TO-SKU-ATR-DEPT-X   TO ML015-PURCH-DEPT-NBR.         13820099
21731      MOVE PV-TO-SKU-ATR-SUB      TO ML015-PURCH-CLASS-NBR.        13840099
138600     MOVE PV-DATE-MMDDYY         TO ML015-PURCH-INV-CUT-DTE.      13860099
W26603     MOVE ALL '0'                TO ML015-PURCH-PO-NBR.           13870099
138800     MOVE PV-CR-BATCH-NBR        TO ML015-PURCH-BATCH-NBR.        13880099
138900     MOVE PV-SKU-FSCL-MN-NBR     TO ML015-PURCH-KOHLS-MM.         13890099
G34517     MOVE PC-Z2                  TO ML015-PURCH-AP-TRANS-CDE.     13900099
W26603     MOVE PV-DATE-MMDDYY         TO ML015-PURCH-DOC-DTE.          13910099
W26603     MOVE ALL '0'                TO ML015-PURCH-DOC-5-NBR.        13920099
W26006     MOVE TSKST-LOC-NBR          TO ML015-PURCH-STORE-NBR-9.      13940099
139500     MOVE ZERO                   TO ML015-PURCH-DISCT-AMT.        13950099
139600     MOVE ZERO                   TO ML015-PURCH-FRGHT-AMT.        13960099
139700     IF PV-ONHAND-QTY > 0                                         13970099
139800         MOVE PC-01              TO ML015-PURCH-TRANS-CDE         13980099
139900     ELSE                                                         13990099
140000         MOVE PC-02              TO ML015-PURCH-TRANS-CDE         14000099
140100     END-IF.                                                      14010099
140200                                                                  14020099
W26603     IF PV-RCLS-SKU IS EQUAL TO ZEROS                                     
W26603         MOVE PV-SKU-NUMERIC  TO ML015-PURCH-SKU-NBR                      
W26603     ELSE                                                                 
W26603         MOVE PV-RCLS-SKU     TO ML015-PURCH-SKU-NBR                      
W26603     END-IF.                                                              
W26603                                                                          
140300     IF (PV-RND-MERCH-EXT-CST-AMT > PC-POS-EXTENSION-2)           14030099
140400       OR (PV-RND-MERCH-EXT-CST-AMT < PC-NEG-EXTENSION-2)         14040099
140500       OR (PV-MERCH-EXT-RTL-AMT > PC-POS-EXTENSION-2)             14050099
140600       OR (PV-MERCH-EXT-RTL-AMT < PC-NEG-EXTENSION-2)             14060099
140700         PERFORM 9000-WRITE-MULTIPLE-RECS                         14070099
140800     ELSE                                                         14080099
140900         MOVE PV-RND-MERCH-EXT-CST-AMT                            14090099
141000                                 TO ML015-PURCH-MERCH-AMT         14100099
141100                                    ML015-PURCH-NET               14110099
141200         MOVE PV-MERCH-EXT-RTL-AMT                                14120099
141300                                 TO ML015-PURCH-RETAIL            14130099
141400         IF PV-RND-MERCH-EXT-CST-AMT < 0                          14140099
141500             COMPUTE ML015-PURCH-MERCH-AMT =                      14150099
141600                 ML015-PURCH-MERCH-AMT * -1                       14160099
141700             COMPUTE ML015-PURCH-NET =                            14170099
141800                 ML015-PURCH-NET * -1                             14180099
141900         END-IF                                                   14190099
142000         IF PV-MERCH-EXT-RTL-AMT < 0                              14200099
142100             COMPUTE ML015-PURCH-RETAIL =                         14210099
142200                 ML015-PURCH-RETAIL * -1                          14220099
142300         END-IF                                                   14230099
142400         WRITE TRANS-EXTRACT-RECORD FROM ML015-PURCHASE-RECORD    14240099
142500         ADD 1                   TO PC-TRNS-EXTR-RECS-WRITTEN     14250099
142600     END-IF.                                                      14260099
142700                                                                  14270099
142800 EJECT                                                            14280099
142900                                                                  14290099
W28545******************************************************************13740099
W28545 5130-WRITE-DR-BUYER-EXTRACT.                                             
W28545******************************************************************13740099
W28545     MOVE PV-SKU-HIST-BYR-NBR    TO ML113-BYR-NBR.                14340099
W28545     MOVE PV-FR-SKU-ATR-DEPT-X   TO ML113-DEPT-NBR.               14350099
W28545     MOVE PV-FR-SKU-ATR-SUB      TO ML113-SUB-CL-NBR.             14360099
W28545     MOVE PV-SKU-HIST-WORKER-FIR-NAME                             14380099
W28545                                 TO ML113-BYR-FIR-NAME.           14390099
W28545     MOVE PV-SKU-HIST-WORKER-LAST-NAME                            14400099
W28545                                 TO ML113-BYR-LAST-NAME.          14410099
W28545     MOVE PV-SKU-HIST-DEPT-DESC  TO ML113-DEPT-DESC.              14420099
W28545     MOVE PV-SKU-HIST-MAJ-CL-DESC                                 14430099
W28545                                 TO ML113-MAJ-CL-DESC.            14440099
W28545     MOVE PV-SKU-HIST-SUB-CL-DESC                                 14450099
W28545                                 TO ML113-SUB-CL-DESC.            14460099
W28545                                                                          
W28545     COMPUTE ML113-RTL-AMT  = PV-MERCH-EXT-RTL-AMT         * -1.          
W28545     COMPUTE ML113-COST-AMT = PV-RND-MERCH-EXT-CST-AMT     * -1.  14500099
W28545                                                                          
W28545     MOVE PV-DR-BATCH-NBR        TO ML113-BATCH-NBR.              14510099
W28545                                                                  14520099
W28545     MOVE TSKST-LOC-NBR          TO ML113-LOC-NBR.                14510099
W28545                                                                  14520099
W28545     WRITE BUYER-EXTRACT-REC FROM ML113-SKU-RNMBR-BYR-EXTRACT.    14530099
W28545                                                                  14540099
W28545******************************************************************13740099
W28545 5140-WRITE-CR-BUYER-EXTRACT.                                             
W28545******************************************************************13740099
W28545     MOVE PV-SKU-MERCH-BYR-NBR   TO ML113-BYR-NBR.                14630099
W28545     MOVE PV-TO-SKU-ATR-DEPT-X   TO ML113-DEPT-NBR.               14640099
W28545     MOVE PV-TO-SKU-ATR-SUB      TO ML113-SUB-CL-NBR.             14660099
W28545     MOVE PV-SKU-MERCH-WORKER-FIR-NAME                            14680099
W28545                                 TO ML113-BYR-FIR-NAME.           14690099
W28545     MOVE PV-SKU-MERCH-WORKER-LAST-NAME                           14700099
W28545                                 TO ML113-BYR-LAST-NAME.          14710099
W28545     MOVE PV-SKU-MERCH-DEPT-DESC TO ML113-DEPT-DESC.              14720099
W28545     MOVE PV-SKU-MERCH-MAJ-CL-DESC                                14730099
W28545                                 TO ML113-MAJ-CL-DESC.            14740099
W28545     MOVE PV-SKU-MERCH-SUB-CL-DESC                                14750099
W28545                                 TO ML113-SUB-CL-DESC.            14760099
W28545                                                                          
W28545     MOVE PV-MERCH-EXT-RTL-AMT       TO ML113-RTL-AMT.            14520099
W28545     MOVE PV-RND-MERCH-EXT-CST-AMT   TO ML113-COST-AMT            14520099
W28545                                                                          
W28545     MOVE PV-CR-BATCH-NBR        TO ML113-BATCH-NBR.              14510099
W28545                                                                  14520099
W28545     MOVE TSKST-LOC-NBR          TO ML113-LOC-NBR.                14510099
W28545                                                                  14520099
W28545     WRITE BUYER-EXTRACT-REC FROM ML113-SKU-RNMBR-BYR-EXTRACT.    14530099
W28545                                                                  14540099
143000******************************************************************14300099
143100 5210-WRITE-RPT-DEBIT-EXTRACT.                                    14310099
143200******************************************************************14320099
143300*                                                                 14330099
143400     MOVE PV-SKU-HIST-BYR-NBR    TO ML113-BYR-NBR.                14340099
W21731     MOVE PV-FR-SKU-ATR-DEPT-X   TO ML113-DEPT-NBR.               14350099
21731      MOVE PV-FR-SKU-ATR-SUB      TO ML113-SUB-CL-NBR.             14360099
143800     MOVE PV-SKU-HIST-WORKER-FIR-NAME                             14380099
143900                                 TO ML113-BYR-FIR-NAME.           14390099
144000     MOVE PV-SKU-HIST-WORKER-LAST-NAME                            14400099
144100                                 TO ML113-BYR-LAST-NAME.          14410099
144200     MOVE PV-SKU-HIST-DEPT-DESC  TO ML113-DEPT-DESC.              14420099
144300     MOVE PV-SKU-HIST-MAJ-CL-DESC                                 14430099
144400                                 TO ML113-MAJ-CL-DESC.            14440099
144500     MOVE PV-SKU-HIST-SUB-CL-DESC                                 14450099
144600                                 TO ML113-SUB-CL-DESC.            14460099
144700     MOVE PV-SKU-D-MERCH-EXT-RTL-AMT                              14470099
144800                                 TO ML113-RTL-AMT.                14480099
144900     MOVE PV-SKU-D-MERCH-EXT-CST-AMT                              14490099
145000                                 TO ML113-COST-AMT.               14500099
                                                                                
145100     MOVE PV-DR-BATCH-NBR        TO ML113-BATCH-NBR.              14510099
145200                                                                  14520099
W28545     MOVE TSKST-LOC-NBR          TO ML113-LOC-NBR.                14510099
W28545                                                                  14520099
145300     WRITE RPT-EXTRACT-RECORD FROM ML113-SKU-RNMBR-BYR-EXTRACT.   14530099
145400                                                                  14540099
145500     ADD +1                      TO PC-RPT-EXTR-RECS-WRITTEN.     14550099
145600                                                                  14560099
145700 EJECT                                                            14570099
145800                                                                  14580099
145900******************************************************************14590099
146000 5220-WRITE-RPT-CREDIT-EXTRACT.                                   14600099
146100******************************************************************14610099
146200*                                                                 14620099
146300     MOVE PV-SKU-MERCH-BYR-NBR   TO ML113-BYR-NBR.                14630099
W21731     MOVE PV-TO-SKU-ATR-DEPT-X   TO ML113-DEPT-NBR.               14640099
21731      MOVE PV-TO-SKU-ATR-SUB      TO ML113-SUB-CL-NBR.             14660099
146800     MOVE PV-SKU-MERCH-WORKER-FIR-NAME                            14680099
146900                                 TO ML113-BYR-FIR-NAME.           14690099
147000     MOVE PV-SKU-MERCH-WORKER-LAST-NAME                           14700099
147100                                 TO ML113-BYR-LAST-NAME.          14710099
147200     MOVE PV-SKU-MERCH-DEPT-DESC TO ML113-DEPT-DESC.              14720099
147300     MOVE PV-SKU-MERCH-MAJ-CL-DESC                                14730099
147400                                 TO ML113-MAJ-CL-DESC.            14740099
147500     MOVE PV-SKU-MERCH-SUB-CL-DESC                                14750099
147600                                 TO ML113-SUB-CL-DESC.            14760099
147700     MOVE PV-SKU-C-MERCH-EXT-RTL-AMT                              14770099
147800                                 TO ML113-RTL-AMT.                14780099
147900     MOVE PV-SKU-C-MERCH-EXT-CST-AMT                              14790099
148000                                 TO ML113-COST-AMT.               14800099
148100     MOVE PV-CR-BATCH-NBR        TO ML113-BATCH-NBR.              14810099
148200                                                                  14820099
W28545     MOVE TSKST-LOC-NBR          TO ML113-LOC-NBR.                14510099
W28545                                                                  14520099
148300     WRITE RPT-EXTRACT-RECORD FROM ML113-SKU-RNMBR-BYR-EXTRACT.   14830099
148400                                                                  14840099
148500     ADD +1                      TO PC-RPT-EXTR-RECS-WRITTEN.     14850099
148600                                                                  14860099
148700 EJECT                                                            14870099
148800                                                                  14880099
148900******************************************************************14890099
149000 6000-WRITE-RPT-DETAIL-TITLE.                                     14900099
149100******************************************************************14910099
149200*                                                                 14920099
149300     ADD 1                       TO PV-DTL-PAGE-COUNT.            14930099
149400     MOVE PV-DTL-PAGE-COUNT      TO DP150O-PAGE-NUMBER.           14940099
149500     WRITE DETAIL-REPORT-RECORD                                   14950099
149600       FROM DP150O-STANDRD-HEADER-150-COLS                        14960099
149700         AFTER ADVANCING PAGE.                                    14970099
149800                                                                  14980099
149900     WRITE DETAIL-REPORT-RECORD FROM H2-D-HEADING2                14990099
150000         AFTER ADVANCING 1 LINE.                                  15000099
150100                                                                  15010099
150200     WRITE DETAIL-REPORT-RECORD FROM H3-D-HEADING3                15020099
150300         AFTER ADVANCING 1 LINE.                                  15030099
150400                                                                  15040099
21731      WRITE DETAIL-REPORT-RECORD FROM H4-D-HEADING4                15050099
21731          AFTER ADVANCING 2 LINES.                                 15060099
21731                                                                   15070099
21731      WRITE DETAIL-REPORT-RECORD FROM H5-D-HEADING5                15050099
21731          AFTER ADVANCING 1 LINES.                                 15060099
21731                                                                   15070099
150800     MOVE SPACES                 TO DETAIL-REPORT-RECORD.         15080099
150900     WRITE DETAIL-REPORT-RECORD                                   15090099
151000         AFTER ADVANCING 1 LINE.                                  15100099
151100                                                                  15110099
21731      MOVE +7                     TO PV-DTL-LINE-COUNT.            15120099
151300                                                                  15130099
151400 EJECT                                                            15140099
151500                                                                  15150099
151600******************************************************************15160099
151700 6010-WRITE-RPT-DETAIL-LINE.                                      15170099
151800******************************************************************15180099
151900*                                                                 15190099
152000     IF PV-DTL-LINE-COUNT > PC-LINE-COUNT-MAX                     15200099
152100         PERFORM 6000-WRITE-RPT-DETAIL-TITLE.                     15210099
152200                                                                  15220099
21731      MOVE PV-FR-SKU-ATR-DEPT     TO SL-D-FROM-DEPT.                       
21731      MOVE PV-FR-SKU-ATR-MAJ      TO SL-D-FROM-MAJ-CLASS.                  
21731      MOVE PV-FR-SKU-ATR-SUB      TO SL-D-FROM-SUB-CLASS.                  
21731                                                                           
21731      MOVE PV-TO-SKU-ATR-DEPT     TO SL-D-TO-DEPT.                         
21731      MOVE PV-TO-SKU-ATR-MAJ      TO SL-D-TO-MAJ-CLASS.                    
21731      MOVE PV-TO-SKU-ATR-SUB      TO SL-D-TO-SUB-CLASS.                    
21731                                                                           
R21731     MOVE PV-SKU                 TO SL-D-TO-SKU.                  15360099
153700                                                                  15370099
153800     MOVE PV-DATE-MMDDCCYY       TO SL-D-DATE-MMDDCCYY.           15380099
153900     MOVE PV-SKU-DESC            TO SL-D-SKU-DESC.                15390099
W26006     MOVE TSKST-LOC-NBR          TO SL-D-STORE-NMBR.              15400099
154100                                                                  15410099
154200     MOVE PV-ONHAND-QTY          TO SL-D-ONHAND-QTY.              15420099
154300     MOVE PV-SKU-MERCH-UNT-RTL-AMT                                15430099
154400                                 TO SL-D-UNT-RTL-AMT.             15440099
154500     MOVE PV-MERCH-EXT-RTL-AMT   TO SL-D-EXT-RETAIL.              15450099
154600     MOVE PV-RND-SKU-MERCH-UNT-CST-AMT                            15460099
154700                                 TO SL-D-UNT-COST-AMT.            15470099
154800     MOVE PV-RND-MERCH-EXT-CST-AMT                                15480099
154900                                 TO SL-D-EXT-COST.                15490099
155000                                                                  15500099
155100     WRITE DETAIL-REPORT-RECORD FROM SL-D-SKU-LINE                15510099
155200         AFTER ADVANCING 1 LINES.                                 15520099
155300                                                                  15530099
155400     ADD +1                      TO PV-DTL-LINE-COUNT.            15540099
155500                                                                  15550099
W28545     MOVE SL-D-SKU-LINE            TO IN052-SKU-LINE-PART-1.              
W28545     MOVE PV-DR-BATCH-NBR          TO IN052-DR-BATCH-NBR.                 
W28545     MOVE PV-CR-BATCH-NBR          TO IN052-CR-BATCH-NBR.                 
W28545     MOVE TSKST-LOC-NBR            TO IN052-STORE-NMBR.           15400099
W28545     MOVE PV-ONHAND-QTY            TO IN052-ONHAND-QTY.                   
W28545     MOVE PV-SKU-MERCH-UNT-RTL-AMT TO IN052-UNT-RTL-AMT.                  
W28545     MOVE PV-MERCH-EXT-RTL-AMT     TO IN052-EXT-RETAIL.                   
W28545     MOVE PV-RND-SKU-MERCH-UNT-CST-AMT                                    
W28545                                   TO IN052-UNT-COST-AMT.                 
W28545     MOVE PV-RND-MERCH-EXT-CST-AMT TO IN052-EXT-COST.                     
W28545     WRITE RECLS-EXTRACT-REC     FROM IN052-SKU-DETAIL.                   
W28545     ADD +1 TO PC-EXTRACT-OUT-COUNT.                                      
W28545                                                                          
155600 EJECT                                                            15560099
155700                                                                  15570099
155800******************************************************************15580099
155900 6020-WRITE-RPT-DETAIL-SKU-SUM.                                   15590099
156000******************************************************************15600099
156100*                                                                 15610099
156200     IF PV-DTL-LINE-COUNT > PC-LINE-COUNT-MAX                     15620099
156300         PERFORM 6000-WRITE-RPT-DETAIL-TITLE.                     15630099
156400                                                                  15640099
R21731     MOVE '*** RECLASS TOTAL ***'                                 15650099
156600                                 TO TL-D1-TOTAL-LABEL.            15660099
156700     MOVE PV-SKU-ONHAND-QTY      TO TL-D1-ONHAND-QTY.             15670099
156800     MOVE PV-SKU-C-MERCH-EXT-RTL-AMT                              15680099
156900                                 TO TL-D1-EXT-RETAIL.             15690099
157000     MOVE PV-SKU-C-MERCH-EXT-CST-AMT                              15700099
157100                                 TO TL-D1-EXT-COST.               15710099
157200                                                                  15720099
157300     WRITE DETAIL-REPORT-RECORD FROM TL-D1-TOTAL-LINE             15730099
157400         AFTER ADVANCING 1 LINES.                                 15740099
157500                                                                  15750099
157600     MOVE SPACES                 TO DETAIL-REPORT-RECORD.         15760099
157700     WRITE DETAIL-REPORT-RECORD                                   15770099
157800         AFTER ADVANCING 1 LINES.                                 15780099
157900                                                                  15790099
158000     ADD +2                      TO PV-DTL-LINE-COUNT.            15800099
158100                                                                  15810099
158200 EJECT                                                            15820099
158300                                                                  15830099
158400******************************************************************15840099
158500 6030-WRITE-RPT-DETAIL-NO-DOLRS.                                  15850099
158600******************************************************************15860099
158700*                                                                 15870099
158800     IF PV-DTL-LINE-COUNT > PC-LINE-COUNT-MAX                     15880099
158900         PERFORM 6000-WRITE-RPT-DETAIL-TITLE.                     15890099
159000                                                                  15900099
21731      MOVE PV-FR-SKU-ATR-DEPT     TO EL-D-FROM-DEPT.                       
21731      MOVE PV-FR-SKU-ATR-MAJ      TO EL-D-FROM-MAJ-CLASS.                  
21731      MOVE PV-FR-SKU-ATR-SUB      TO EL-D-FROM-SUB-CLASS.                  
21731                                                                           
21731      MOVE PV-TO-SKU-ATR-DEPT     TO EL-D-TO-DEPT.                         
21731      MOVE PV-TO-SKU-ATR-MAJ      TO EL-D-TO-MAJ-CLASS.                    
21731      MOVE PV-TO-SKU-ATR-SUB      TO EL-D-TO-SUB-CLASS.                    
21731                                                                           
R21731     MOVE PV-SKU                 TO EL-D-TO-SKU.                  16070099
160800                                                                  16080099
160900     MOVE PV-DATE-MMDDCCYY       TO EL-D-DATE-MMDDCCYY.           16090099
161000     MOVE PV-SKU-DESC            TO EL-D-SKU-DESC.                16100099
161100                                                                  16110099
161200     MOVE 'NO UNIT DOLLAR COST AND RETAIL FOUND'                  16120099
161300                                 TO EL-D-MESSAGE.                 16130099
161400                                                                  16140099
161500     WRITE DETAIL-REPORT-RECORD FROM EL-D-ERROR-LINE              16150099
161600         AFTER ADVANCING 1 LINES.                                 16160099
161700                                                                  16170099
161800     ADD +1                      TO PV-DTL-LINE-COUNT.            16180099
161900                                                                  16190099
162000     ADD +1                      TO PV-ERR-NO-DOLRS-TOTAL.        16200099
162100                                                                  16210099
162200 EJECT                                                            16220099
162300                                                                  16230099
162400******************************************************************16240099
162500 6040-WRITE-RPT-DETAIL-NO-QTY.                                    16250099
162600******************************************************************16260099
162700*                                                                 16270099
162800     IF PV-DTL-LINE-COUNT > PC-LINE-COUNT-MAX                     16280099
162900         PERFORM 6000-WRITE-RPT-DETAIL-TITLE.                     16290099
163000                                                                  16300099
21731      MOVE PV-FR-SKU-ATR-DEPT     TO EL-D-FROM-DEPT.                       
21731      MOVE PV-FR-SKU-ATR-MAJ      TO EL-D-FROM-MAJ-CLASS.                  
21731      MOVE PV-FR-SKU-ATR-SUB      TO EL-D-FROM-SUB-CLASS.                  
21731                                                                           
21731      MOVE PV-TO-SKU-ATR-DEPT     TO EL-D-TO-DEPT.                         
21731      MOVE PV-TO-SKU-ATR-MAJ      TO EL-D-TO-MAJ-CLASS.                    
21731      MOVE PV-TO-SKU-ATR-SUB      TO EL-D-TO-SUB-CLASS.                    
21731                                                                           
R21731     MOVE PV-SKU                 TO EL-D-TO-SKU.                  16470099
164800                                                                  16480099
164900     MOVE PV-DATE-MMDDCCYY       TO EL-D-DATE-MMDDCCYY.           16490099
165000     MOVE PV-SKU-DESC            TO EL-D-SKU-DESC.                16500099
165100                                                                  16510099
165200     MOVE 'NO ONHAND QUANTITY FOUND'                              16520099
165300                                 TO EL-D-MESSAGE.                 16530099
165400                                                                  16540099
165500     WRITE DETAIL-REPORT-RECORD FROM EL-D-ERROR-LINE              16550099
165600         AFTER ADVANCING 1 LINES.                                 16560099
165700                                                                  16570099
165800     ADD +1                      TO PV-DTL-LINE-COUNT.            16580099
165900                                                                  16590099
166000 EJECT                                                            16600099
166100                                                                  16610099
166200******************************************************************16620099
166300 6050-WRITE-LAST-DETAIL-LINES.                                    16630099
166400******************************************************************16640099
166500*                                                                 16650099
166600     PERFORM 6000-WRITE-RPT-DETAIL-TITLE.                         16660099
166700                                                                  16670099
166800     MOVE '*** GRAND TOTAL ***'  TO TL-D1-TOTAL-LABEL.            16680099
166900     MOVE PV-GT-TOTAL-QTY        TO TL-D1-ONHAND-QTY              16690099
167000     MOVE PV-GT-TOTAL-C-MERCH-EXT-RTL                             16700099
167100                                 TO TL-D1-EXT-RETAIL.             16710099
167200     MOVE PV-GT-TOTAL-C-MERCH-EXT-CST                             16720099
167300                                 TO TL-D1-EXT-COST.               16730099
167400                                                                  16740099
167500     WRITE DETAIL-REPORT-RECORD FROM TL-D1-TOTAL-LINE             16750099
167600         AFTER ADVANCING 3 LINES.                                 16760099
167700                                                                  16770099
R21731     MOVE 'TOTAL NUMBER OF SKUS RECLASSED '                       16780099
167900                                 TO TL-D2-ERR-LABEL.              16790099
R21731     MOVE PC-SKU-ROWS-SELECTED                                    16800099
168020                                 TO TL-D2-ERR-TOTAL.              16801099
168100                                                                  16802099
168200     WRITE DETAIL-REPORT-RECORD FROM TL-D2-TOTAL-LINE             16803099
168300         AFTER ADVANCING 3 LINES.                                 16804099
168400                                                                  16805099
168410     MOVE 'TOTAL NO UNIT DOLLAR COST AND RETAIL FOUND'            16806099
168420                                 TO TL-D2-ERR-LABEL.              16807099
168430     MOVE PV-ERR-NO-DOLRS-TOTAL  TO TL-D2-ERR-TOTAL.              16808099
168440                                                                  16809099
168450     WRITE DETAIL-REPORT-RECORD FROM TL-D2-TOTAL-LINE             16810099
168460         AFTER ADVANCING 3 LINES.                                 16820099
168470                                                                  16830099
168500     WRITE DETAIL-REPORT-RECORD FROM ER-END-OF-REPORT-LINE        16840099
168600         AFTER ADVANCING 3 LINES.                                 16850099
168700                                                                  16860099
168800 EJECT                                                            16870099
168900                                                                  16880099
R21731                                                                          
R21731******************************************************************16240099
R21731 6060-WRITE-RPT-DETAIL-NO-SKU.                                    16250099
R21731******************************************************************16260099
R21731*                                                                 16270099
R21731     IF PV-DTL-LINE-COUNT > PC-LINE-COUNT-MAX                     16280099
R21731         PERFORM 6000-WRITE-RPT-DETAIL-TITLE.                     16290099
R21731                                                                  16300099
R21731     MOVE PV-FR-SKU-ATR-DEPT     TO EL-D-FROM-DEPT.                       
R21731     MOVE PV-FR-SKU-ATR-MAJ      TO EL-D-FROM-MAJ-CLASS.                  
R21731     MOVE PV-FR-SKU-ATR-SUB      TO EL-D-FROM-SUB-CLASS.                  
R21731                                                                          
R21731     MOVE PV-TO-SKU-ATR-DEPT     TO EL-D-TO-DEPT.                         
R21731     MOVE PV-TO-SKU-ATR-MAJ      TO EL-D-TO-MAJ-CLASS.                    
R21731     MOVE PV-TO-SKU-ATR-SUB      TO EL-D-TO-SUB-CLASS.                    
R21731                                                                          
R21731     MOVE SPACES                 TO EL-D-TO-SKU.                  16480099
R21731                                                                  16380099
R21731     MOVE PV-DATE-MMDDCCYY       TO EL-D-DATE-MMDDCCYY.           16490099
R21731     MOVE SPACES                 TO EL-D-SKU-DESC.                16500099
R21731                                                                  16510099
R21731     WRITE DETAIL-REPORT-RECORD FROM EL-D-ERROR-LINE              16550099
R21731         AFTER ADVANCING 1 LINES.                                 16560099
R21731                                                                  16570099
R21731     ADD +1                      TO PV-DTL-LINE-COUNT.            16580099
R21731                                                                  16590099
R21731 EJECT                                                            16600099
R21731                                                                  16610099
169000******************************************************************16890099
169100 6100-WRITE-RPT-SUMMARY-TITLE.                                    16900099
169200******************************************************************16910099
169300*                                                                 16920099
169400     MOVE 1                      TO DP132O-PAGE-NUMBER.           16930099
169500     WRITE SUMMARY-REPORT-RECORD                                  16940099
169600       FROM DP132O-STANDRD-HEADER-132-COLS                        16950099
169700         AFTER ADVANCING PAGE.                                    16960099
169800                                                                  16970099
169900     WRITE SUMMARY-REPORT-RECORD FROM H2-S-HEADING2               16980099
170000         AFTER ADVANCING 1 LINE.                                  16990099
170100                                                                  17000099
170200     WRITE SUMMARY-REPORT-RECORD FROM H3-S-HEADING3               17010099
170300         AFTER ADVANCING 1 LINE.                                  17020099
170400                                                                  17030099
170500     WRITE SUMMARY-REPORT-RECORD FROM H4-S-HEADING4               17040099
170600         AFTER ADVANCING 2 LINES.                                 17050099
170700                                                                  17060099
170800     MOVE SPACES                 TO SUMMARY-REPORT-RECORD.        17070099
170900     WRITE SUMMARY-REPORT-RECORD                                  17080099
171000         AFTER ADVANCING 1 LINE.                                  17090099
171100                                                                  17100099
171200 EJECT                                                            17110099
171300                                                                  17120099
171400******************************************************************17130099
171500 6110-WRITE-LAST-SUMMARY-LINES.                                   17140099
171600******************************************************************17150099
171700*                                                                 17160099
171800     MOVE '***TOTAL CREDIT***'  TO TL-S1-TOTAL-LABEL.             17170099
171900     MOVE PV-GT-TOTAL-C-MERCH-EXT-RTL                             17180099
172000                                 TO TL-S1-EXT-RETAIL.             17190099
172100     MOVE PV-GT-TOTAL-C-MERCH-EXT-CST                             17200099
172200                                 TO TL-S1-EXT-COST.               17210099
172300                                                                  17220099
172400     WRITE SUMMARY-REPORT-RECORD FROM TL-S1-TOTAL-LINE            17230099
172500         AFTER ADVANCING 3 LINES.                                 17240099
172600                                                                  17250099
172700     MOVE '***TOTAL CHARGE***'  TO TL-S1-TOTAL-LABEL.             17260099
172800     MOVE PV-GT-TOTAL-D-MERCH-EXT-RTL                             17270099
172900                                 TO TL-S1-EXT-RETAIL.             17280099
173000     MOVE PV-GT-TOTAL-D-MERCH-EXT-CST                             17290099
173100                                 TO TL-S1-EXT-COST.               17300099
173200                                                                  17310099
173300     WRITE SUMMARY-REPORT-RECORD FROM TL-S1-TOTAL-LINE            17320099
173400         AFTER ADVANCING 2 LINES.                                 17330099
173500                                                                  17340099
173600     WRITE SUMMARY-REPORT-RECORD FROM ER-END-OF-REPORT-LINE       17350099
173700         AFTER ADVANCING 3 LINES.                                 17360099
173800                                                                  17370099
173900 EJECT                                                            17380099
174000                                                                  17390099
174100******************************************************************17400099
174200 7000-SELECT-TDTATTR-FOR-EDIT.                                    17410099
174300******************************************************************17420099
174400*                                                                 17430099
W21731     SET PS-TDTATTR-IS-NOT-FOUND TO TRUE.                         17530099
                                                                                
W26603     MOVE PV-KY-DTE           TO DTATTR-KY-DTE.                           
W26603                                                                          
174500     EXEC SQL                                                     17440099
174600         SELECT KY_DTE                                            17450099
174700           INTO :DTATTR-KY-DTE                                    17460099
174800           FROM TDTATTR                                           17470099
W26603          WHERE KY_DTE = :DTATTR-KY-DTE                           17480099
W26603         WITH UR                                                          
175000     END-EXEC.                                                    17490099
175100                                                                  17500099
175200     EVALUATE TRUE                                                17510099
175300         WHEN SQLCODE = 0                                         17520099
W21731             SET PS-TDTATTR-IS-FOUND TO TRUE                      17530099
175500         WHEN SQLCODE = +100                                      17540099
175600             CONTINUE                                             17550099
175700         WHEN OTHER                                               17560099
175800             MOVE '7000-SELECT-TDTATTR-FOR-EDIT'                  17570099
175900                                 TO AA-PARAGRAPH-NAME             17580099
176000             MOVE 'TDTATTR TABLE ERROR'                           17590099
176100                                 TO AA-MESSAGE                    17600099
176200             MOVE 'SELECT'       TO AA-DB2-OPERATION              17610099
176300             PERFORM 9901-SQL-ERROR                               17620099
176400     END-EVALUATE.                                                17630099
176500                                                                  17640099
176600 EJECT                                                            17650099
176700                                                                  17660099
179000******************************************************************17890099
179100 7110-READ-RECLASS-FILE.                                          17900099
179200******************************************************************17910099
179300*                                                                 17920099
R21731     READ RECLASS-FILE INTO IMRD008-RECORD                                
R21731         AT END                                                           
R21731             SET PS-RECLASS-FILE-EOF TO TRUE                              
R21731         NOT AT END                                                       
R21731             ADD +1              TO PC-ITEM-RECS-READ.            18070099
X34517     DISPLAY 'PC-ITEM-RECS-READ ' PC-ITEM-RECS-READ.                      
181900                                                                  18180099
182000 EJECT                                                            18190099
182100                                                                  18200099
R21731******************************************************************18730099
R21731 7200-OPEN-TUPC.                                                  18740099
R21731******************************************************************18750099
R21731*                                                                 18760099
I15034**   MOVE IM008-STYLE-RECL-SCL-MDSE-NEW                                   
I15034**                                     TO UPC-SUB-CL-MDSEAR-ID.           
I15034**   MOVE IM008-ITEM-KEY-VS-ID         TO UPC-VS-ID.                      
I15034**                                                                        
B34517                                                                  18760099
B34517     SET PS-TMDARVS-IS-FOUND           TO TRUE.                   18760099
B34517                                                                  18760099
B34517     PERFORM 7205-PROCESS-RMS-STYL-ID.                            18760099
B34517                                                                          
B34517     IF PS-TMDARVS-IS-FOUND                                       18760099
B34517         PERFORM 7202-OPEN-TUPC-CURSOR                            18760099
B34517     END-IF.                                                      18760099
182100                                                                  18200099
R21731******************************************************************18730099
R21731 7202-OPEN-TUPC-CURSOR.                                           18740099
R21731******************************************************************18750099
B34517                                                                          
I15034     MOVE MDARVS-SUB-CL-MDSEAR-ID      TO UPC-SUB-CL-MDSEAR-ID.           
I15034     MOVE MDARVS-VS-ID                 TO UPC-VS-ID.                      
R21731*                                                                 18760099
R21731     MOVE IM008-CRE-TMST(1:10)         TO PV-EFF-DTE.                     
R21731                                                                          
R21731     EXEC SQL                                                     18770099
R21731         OPEN TUPC_CURSOR                                         18780099
R21731     END-EXEC.                                                    18790099
R21731                                                                  18800099
R21731     EVALUATE TRUE                                                18810099
R21731         WHEN SQLCODE = 0                                         18820099
R21731             CONTINUE                                             18830099
R21731         WHEN OTHER                                               18840099
R21731             DISPLAY 'SUB-CL-MDSEAR-ID ' UPC-SUB-CL-MDSEAR-ID             
R21731                     'VS-ID '            UPC-VS-ID                        
R21731                     'EFF-DTE '          PV-EFF-DTE                       
R21731             MOVE '7200-OPEN-TUPC'                                18850099
R21731                                 TO AA-PARAGRAPH-NAME             18860099
R21731             MOVE 'TUPC/TVNDSTL ERROR MESSAGE'                    18870099
R21731                                 TO AA-MESSAGE                    18880099
R21731             MOVE 'OPEN CURSOR'  TO AA-DB2-OPERATION              18890099
R21731             PERFORM 9901-SQL-ERROR                               18900099
R21731     END-EVALUATE.                                                18910099
R21731                                                                  18920099
R21731 EJECT                                                            18930099
R21731                                                                          
I15034******************************************************************18430099
I15034** 7205-PROCESS-RMS-STYL-ID.                                      18760099
I15034** USE THE RMS STYLE ID TO RETRIEVE THE VS STYLE AND SUB CLASS    18760099
I15034** IDENTIFIER. USED TOGETHER, THESE TWO FIELDS ARE USED TO RESOLVE18760099
I15034** A STYLE INTO A LIST OF SKUS                                    18760099
I15034******************************************************************18430099
I15034 7205-PROCESS-RMS-STYL-ID.                                        18760099
I15034***************************************************************** *       
I15034* DB2 CALL TO GET CURRENT SUBCLASS MDSEAR ID AND A VS ID                  
I15034***************************************************************** *       
I15034     EXEC SQL                                                             
I15034       SELECT VS_ID                                                       
I15034             ,SUB_CL_MDSEAR_ID                                            
I15034         INTO :MDARVS-VS-ID                                               
I15034             ,:MDARVS-SUB-CL-MDSEAR-ID                                    
I15034         FROM TMDARVS                                                     
I15034        WHERE RMS_STYL_ID  = :PV-RMS-STYL-ID                              
I15034          AND ACTV_IND = 'Y'                                              
I15034         WITH UR                                                          
I15034     END-EXEC.                                                            
I15034                                                                          
I15034     EVALUATE TRUE                                                18560099
I15034         WHEN SQLCODE = 0                                         18570099
I15034             CONTINUE                                                     
I15034         WHEN SQLCODE = +100                                      18600099
I15034             SET PS-TUPC-IS-NOT-FOUND TO TRUE                             
B34517             SET PS-TMDARVS-IS-NOT-FOUND TO TRUE                          
B34517             DISPLAY 'TMDARVS  NOT FOUND FOR '                            
B34517                                       PV-RMS-STYL-ID-NBR                 
I15034         WHEN OTHER                                               18620099
I15034             DISPLAY ' SQLCODE: ' SQLCODE                                 
I15034             DISPLAY ' SUB-CL-ID - ' MDARVS-SUB-CL-MDSEAR-ID              
I15034                     ' VS-ID     - ' MDARVS-VS-ID                         
I15034             MOVE '7205-PROCESS-RMS-STYL-ID'                      18630099
I15034                                 TO AA-PARAGRAPH-NAME             18640099
I15034             MOVE 'TMDARVS TABLES ERROR'                          18650099
I15034                                 TO AA-MESSAGE                    18660099
I15034             MOVE 'FETCH '       TO AA-DB2-OPERATION              18670099
I15034             PERFORM 9901-SQL-ERROR                               18680099
I15034     END-EVALUATE.                                                18690099
I15034*                                                                 18430099
R21731******************************************************************18430099
R21731 7210-FETCH-TUPC.                                                 18440099
R21731******************************************************************18450099
R21731*                                                                 18460099
R21731     INITIALIZE PV-SKU-LVL-RPT-DATA.                                      
R21731     MOVE ZEROES               TO WS-UPC-NBR.                             
R21731     MOVE ZEROES               TO WS-UPC-NBR-REDEF-1.                     
R21731     MOVE ZEROES               TO PV-SKU.                                 
R21731     MOVE IM008-CRE-TMST(1:10) TO PV-EFF-DTE.                             
R21731                                                                          
R21731     EXEC SQL                                                     18470099
R21731          FETCH TUPC_CURSOR                                               
R21731           INTO :UPC-INTR-UPC-DESC                                18490099
R21731               ,:UPC-UPC-ID                                       18490099
R21731               ,:UPC-UPC-NBR                                              
J34517               ,:UPC-INTR-UPC-ID                                          
R21731               ,:VNDSTL-ENT-ID                                    18491199
R21731     END-EXEC.                                                    18540099
R21731                                                                  18550099
R21731     EVALUATE TRUE                                                18560099
R21731         WHEN SQLCODE = 0                                         18570099
R21731             MOVE UPC-INTR-UPC-DESC     TO PV-SKU-DESC                    
R21731             MOVE UPC-UPC-ID            TO PV-UPC-ID                      
R21731             MOVE UPC-UPC-NBR           TO WS-UPC-NBR                     
R21731             MOVE WS-UPC-NBR            TO WS-UPC-NBR-REDEF-1             
R21731             MOVE WS-UPC-NBR-REDEF-7-14 TO PV-SKU                         
K34517             MOVE VNDSTL-ENT-ID         TO PV-ENT-ID                      
R21731             ADD +1                     TO PC-SKU-ROWS-SELECTED   18590099
R21731             SET PS-TUPC-IS-FOUND       TO TRUE                           
R21731         WHEN SQLCODE = +100                                      18600099
R21731             SET PS-TUPC-IS-NOT-FOUND TO TRUE                             
R21731         WHEN OTHER                                               18620099
R21731             DISPLAY ' SUB-CL-MDSEAR-ID - ' UPC-SUB-CL-MDSEAR-ID          
R21731                     ' VS-ID            - ' UPC-VS-ID                     
R21731                     ' UPC-TYP-CDE      - ' PC-I                          
R21731                     ' EFF DATES        - ' PV-EFF-DTE                    
R21731             MOVE '7210-FETCH-TUPC'                               18630099
R21731                                 TO AA-PARAGRAPH-NAME             18640099
R21731             MOVE 'UPC/VNDSTL TABLES ERROR'                       18650099
R21731                                 TO AA-MESSAGE                    18660099
R21731             MOVE 'FETCH '       TO AA-DB2-OPERATION              18670099
R21731             PERFORM 9901-SQL-ERROR                               18680099
R21731     END-EVALUATE.                                                18690099
R21731                                                                  18700099
R21731 EJECT                                                            18710099
R21731                                                                  18700099
R21731******************************************************************19210099
R21731 7220-CLOSE-TUPC.                                                 19220099
R21731******************************************************************19230099
R21731*                                                                 19240099
R21731     EXEC SQL                                                     19250099
R21731         CLOSE TUPC_CURSOR                                        19260099
R21731     END-EXEC.                                                    19270099
R21731                                                                  19280099
R21731     EVALUATE TRUE                                                19290099
R21731         WHEN SQLCODE = 0                                         19300099
R21731             CONTINUE                                             19310099
R21731         WHEN OTHER                                               19320099
R21731             MOVE '7220-CLOSE-TUPC'                               19330099
R21731                                 TO AA-PARAGRAPH-NAME             19340099
R21731             MOVE 'UPC/VNDSTL TABLES ERROR'                       19350099
R21731                                 TO AA-MESSAGE                    19360099
R21731             MOVE 'CLOSE CURSOR' TO AA-DB2-OPERATION              19370099
R21731             PERFORM 9901-SQL-ERROR                               19380099
R21731     END-EVALUATE.                                                19390099
R21731                                                                  19400099
R21731 EJECT                                                            19410099
194300                                                                  19420099
187300                                                                  18720099
187400******************************************************************18730099
187500 7300-OPEN-CURSOR-TSKST.                                          18740099
187600******************************************************************18750099
187700*                                                                 18760099
W21731     SET PS-TSKST-IS-NOT-DONE    TO TRUE.                         08450099
J34517*    MOVE PV-SKU                 TO SKXREF-SKU.                           
J34517     MOVE SKXREF-ITM-NBR         TO TSKST-ITEM-NMBR.                      
W21731                                                                          
187800     EXEC SQL                                                     18770099
187900         OPEN TSKST_CURSOR                                        18780099
188000     END-EXEC.                                                    18790099
188100                                                                  18800099
188200     EVALUATE TRUE                                                18810099
188300         WHEN SQLCODE = 0                                         18820099
188400             CONTINUE                                             18830099
188500         WHEN OTHER                                               18840099
J34517*            DISPLAY ' SKU: ' SKXREF-SKU                                  
J34517             DISPLAY ' ITM-NBR: ' SKXREF-ITM-NBR                          
W21731             MOVE '7300-OPEN-CURSOR-TSKST'                        18850099
188700                                 TO AA-PARAGRAPH-NAME             18860099
J34517*            MOVE 'TSKST/TSKXREF TABLES ERROR'                    18870099
J34517             MOVE 'TSKST TABLE ERROR'                             18870099
188900                                 TO AA-MESSAGE                    18880099
189000             MOVE 'OPEN CURSOR'  TO AA-DB2-OPERATION              18890099
189100             PERFORM 9901-SQL-ERROR                               18900099
189200     END-EVALUATE.                                                18910099
189300                                                                  18920099
189400 EJECT                                                            18930099
189500                                                                  18940099
189600******************************************************************18950099
189700 7310-FETCH-TSKST.                                                18960099
189800******************************************************************18970099
189900*                                                                 18980099
190000     EXEC SQL                                                     18990099
190100         FETCH TSKST_CURSOR                                       19000099
W26006          INTO :TSKST-LOC-NBR,                                    19010099
190300               :TSKST-ONHAND-QTY                                  19020099
190400     END-EXEC.                                                    19030099
190500                                                                  19040099
190600     EVALUATE TRUE                                                19050099
190700         WHEN SQLCODE = 0                                         19060099
W21731             ADD +1              TO PC-SKU-STORE-ROWS-FETCHED     19070099
R26006             MOVE TSKST-LOC-NBR  TO PV-HOLD-STORE-NMBR-INT        19073099
R26006****         MOVE TSKST-STORE-NMBR                                19071099
R26006****                             TO PV-HOLD-STORE-NMBR-RED        19072099
R26006****         MOVE PV-HOLD-STORE-NMBR-RED TO PV-HOLD-STORE-NMBR-INT19073099
R21731             SET PS-TSKST-IS-NOT-DONE TO TRUE                     19090099
190900         WHEN SQLCODE = +100                                      19080099
W21731             SET PS-TSKST-IS-DONE TO TRUE                         19090099
191100         WHEN OTHER                                               19100099
191200             MOVE '7310-FETCH-TSKST'                              19110099
191300                                 TO AA-PARAGRAPH-NAME             19120099
W21731             MOVE 'TSKST/TSKXREF TABLES ERROR'                    19130099
191500                                 TO AA-MESSAGE                    19140099
191600             MOVE 'FETCH'        TO AA-DB2-OPERATION              19150099
191700             PERFORM 9901-SQL-ERROR                               19160099
191800     END-EVALUATE.                                                19170099
191900                                                                  19180099
192000 EJECT                                                            19190099
192100                                                                  19200099
192200******************************************************************19210099
192300 7320-CLOSE-CURSOR-TSKST.                                         19220099
192400******************************************************************19230099
192500*                                                                 19240099
192600     EXEC SQL                                                     19250099
192700         CLOSE TSKST_CURSOR                                       19260099
192800     END-EXEC.                                                    19270099
192900                                                                  19280099
193000     EVALUATE TRUE                                                19290099
193100         WHEN SQLCODE = 0                                         19300099
193200             CONTINUE                                             19310099
193300         WHEN OTHER                                               19320099
193400             MOVE '7320-CLOSE-CURSOR-TSKST'                       19330099
193500                                 TO AA-PARAGRAPH-NAME             19340099
W21731             MOVE 'TSKST/TSKXREF TABLES ERROR'                    19350099
193700                                 TO AA-MESSAGE                    19360099
193800             MOVE 'CLOSE CURSOR' TO AA-DB2-OPERATION              19370099
193900             PERFORM 9901-SQL-ERROR                               19380099
194000     END-EVALUATE.                                                19390099
194100                                                                  19400099
194200 EJECT                                                            19410099
194300                                                                  19420099
194400******************************************************************19430099
194500 7400-SELECT-TDTATTR-MN-NMBR.                                     19440099
194600******************************************************************19450099
194700*                                                                 19460099
W21731     SET PS-TDTATTR-IS-NOT-FOUND TO TRUE.                         09400099
                                                                                
W26603     MOVE PV-RECL-DTE         TO DTATTR-KY-DTE.                           
W26603                                                                          
194800     EXEC SQL                                                     19470099
194900         SELECT KY_DTE,                                           19480099
195000                FSCL_MN_NBR                                       19490099
195100           INTO :DTATTR-KY-DTE,                                   19500099
195200                :DTATTR-FSCL-MN-NBR                               19510099
195300           FROM TDTATTR                                           19520099
W26603          WHERE KY_DTE = :DTATTR-KY-DTE                           19530099
W26603         WITH UR                                                          
195500     END-EXEC.                                                    19540099
195600                                                                  19550099
195700     EVALUATE TRUE                                                19560099
195800         WHEN SQLCODE = 0                                         19570099
W21731             SET PS-TDTATTR-IS-FOUND TO TRUE                      19580099
196000             ADD +1              TO PC-TDTATTR-ROWS-SELECTED      19590099
196100         WHEN SQLCODE = +100                                      19600099
196200             CONTINUE                                             19610099
196300         WHEN OTHER                                               19620099
196400             MOVE '7400-SELECT-TDTATTR-FOR-EDIT'                  19630099
196500                                 TO AA-PARAGRAPH-NAME             19640099
196600             MOVE 'TDTATTR TABLE ERROR'                           19650099
196700                                 TO AA-MESSAGE                    19660099
196800             MOVE 'SELECT'       TO AA-DB2-OPERATION              19670099
196900             PERFORM 9901-SQL-ERROR                               19680099
197000     END-EVALUATE.                                                19690099
197100                                                                  19700099
197200 EJECT                                                            19710099
197300                                                                  19700099
197400******************************************************************19730099
197500 7500-SELECT-TMDSEAR-FOR-DPT.                                     19740099
197600******************************************************************19750099
197700*                                                                 19760099
W21731     SET PS-TMDSEAR-IS-NOT-FOUND TO TRUE.                         09560099
W26603     MOVE PC-03               TO MDSEAR-OPERCO-NBR.               19830099
W26603     MOVE PV-MDSEAR-DEPT-NBR  TO MDSEAR-DEPT-NBR.                 19840099
W26603     MOVE PC-DPT              TO MDSEAR-MDSELV-CDE.               19850099
W26603     MOVE PV-RECL-DTE         TO MDSEAR-STRT-DTE.                 19860099
W26603     MOVE PV-RECL-DTE         TO MDSEAR-END-DTE.                  19870099
W26603                                                                          
197800     EXEC SQL                                                     19770099
197900         SELECT BYR_NBR,                                          19780099
198000                MDSEAR_DESC                                       19790099
198100           INTO :MDSEAR-BYR-NBR,                                  19800099
198200                :MDSEAR-DESC                                      19810099
198300           FROM TMDSEAR                                           19820099
W26603          WHERE (OPERCO_NBR = :MDSEAR-OPERCO-NBR)                 19830099
W26603            AND (DEPT_NBR   = :MDSEAR-DEPT-NBR)                   19840099
W26603            AND (MDSELV_CDE = :MDSEAR-MDSELV-CDE)                 19850099
W26603            AND (STRT_DTE   <= :MDSEAR-STRT-DTE)                  19860099
W26603            AND (END_DTE    >= :MDSEAR-END-DTE)                   19870099
W26603          WITH UR                                                         
198900     END-EXEC.                                                    19880099
199000                                                                  19890099
199100     EVALUATE TRUE                                                19900099
199200         WHEN SQLCODE = 0                                         19910099
W21731             SET PS-TMDSEAR-IS-FOUND TO TRUE                      19920099
199400             ADD +1              TO PC-TMDSEAR-ROWS-SELECTED      19930099
199500         WHEN SQLCODE = +100                                      19940099
199600             CONTINUE                                             19950099
199700         WHEN OTHER                                               19960099
199800             MOVE '7500-SELECT-TMDSEAR-FOR-DPT'                   19970099
199900                                 TO AA-PARAGRAPH-NAME             19980099
200000             MOVE 'TMDSEAR TABLE ERROR'                           19990099
200100                                 TO AA-MESSAGE                    20000099
200200             MOVE 'SELECT'       TO AA-DB2-OPERATION              20010099
200300             PERFORM 9901-SQL-ERROR                               20020099
200400     END-EVALUATE.                                                20030099
200500                                                                  20040099
200600 EJECT                                                            20050099
200700                                                                  20060099
200800******************************************************************20070099
200900 7600-SELECT-TMDSEAR-FOR-MCL.                                     20080099
201000******************************************************************20090099
201100*                                                                 20100099
W21731     SET PS-TMDSEAR-IS-NOT-FOUND TO TRUE.                         10070099
W26603     MOVE PC-03                TO MDSEAR-OPERCO-NBR.              19830099
W26603     MOVE PV-MDSEAR-DEPT-NBR   TO MDSEAR-DEPT-NBR.                19840099
W26603     MOVE PV-MDSEAR-MAJ-CL-NBR TO MDSEAR-MAJ-CL-NBR               19840099
W26603     MOVE PC-MCL               TO MDSEAR-MDSELV-CDE.              19850099
W26603     MOVE PV-RECL-DTE          TO MDSEAR-STRT-DTE.                19860099
W26603     MOVE PV-RECL-DTE          TO MDSEAR-END-DTE.                 19870099
W26603                                                                          
201200     EXEC SQL                                                     20110099
201300         SELECT MDSEAR_DESC                                       20120099
201400           INTO :MDSEAR-DESC                                      20130099
201500           FROM TMDSEAR                                           20140099
W26603          WHERE (OPERCO_NBR       = :MDSEAR-OPERCO-NBR)           20150099
W26603            AND (DEPT_NBR         = :MDSEAR-DEPT-NBR)             20160099
W26603            AND (MAJ_CL_NBR       = :MDSEAR-DEPT-NBR)             20170099
W26603            AND (MDSELV_CDE       = :MDSEAR-MDSELV-CDE)           20180099
W26603            AND (STRT_DTE        <= :MDSEAR-STRT-DTE)             20190099
W26603            AND (END_DTE         >= :MDSEAR-END-DTE)              20200099
W26603         WITH UR                                                          
202200     END-EXEC.                                                    20210099
202300                                                                  20220099
202400     EVALUATE TRUE                                                20230099
202500         WHEN SQLCODE = 0                                         20240099
W21731             SET PS-TMDSEAR-IS-FOUND TO TRUE                      20250099
202700             ADD +1              TO PC-TMDSEAR-ROWS-SELECTED      20260099
202800         WHEN SQLCODE = +100                                      20270099
202900             CONTINUE                                             20280099
203000         WHEN OTHER                                               20290099
203100             MOVE '7600-SELECT-TMDSEAR-FOR-MCL'                   20300099
203200                                 TO AA-PARAGRAPH-NAME             20310099
203300             MOVE 'TMDSEAR TABLE ERROR'                           20320099
203400                                 TO AA-MESSAGE                    20330099
203500             MOVE 'SELECT'       TO AA-DB2-OPERATION              20340099
203600             PERFORM 9901-SQL-ERROR                               20350099
203700     END-EVALUATE.                                                20360099
203800                                                                  20370099
203900 EJECT                                                            20380099
204000                                                                  20390099
204100******************************************************************20400099
204200 7700-SELECT-TMDSEAR-FOR-SCL.                                     20410099
204300******************************************************************20420099
204400*                                                                 20430099
W21731     SET PS-TMDSEAR-IS-NOT-FOUND TO TRUE.                         10070099
W26603     MOVE PC-03                TO MDSEAR-OPERCO-NBR.              19830099
W26603     MOVE PV-MDSEAR-DEPT-NBR   TO MDSEAR-DEPT-NBR.                19840099
W26603     MOVE PV-MDSEAR-SUB-CL-NBR TO MDSEAR-SUB-CL-NBR.              19840099
W26603     MOVE PC-SCL               TO MDSEAR-MDSELV-CDE.              19850099
W26603     MOVE PV-RECL-DTE          TO MDSEAR-STRT-DTE.                19860099
W26603     MOVE PV-RECL-DTE          TO MDSEAR-END-DTE.                 19870099
W26603                                                                          
204500     EXEC SQL                                                     20440099
204600         SELECT MDSEAR_DESC                                       20450099
204700           INTO :MDSEAR-DESC                                      20460099
204800           FROM TMDSEAR                                           20470099
W26603          WHERE (OPERCO_NBR       = :MDSEAR-OPERCO-NBR)           20480099
W26603            AND (DEPT_NBR         = :MDSEAR-DEPT-NBR)             20490099
W26603            AND (SUB_CL_NBR       = :MDSEAR-SUB-CL-NBR)           20500099
W26603            AND (MDSELV_CDE       = :MDSEAR-MDSELV-CDE)           20510099
W26603            AND (STRT_DTE        <= :MDSEAR-STRT-DTE)             20520099
W26603            AND (END_DTE         >= :MDSEAR-END-DTE)              20530099
W26603         WITH UR                                                          
205500     END-EXEC.                                                    20540099
205600                                                                  20550099
205700     EVALUATE TRUE                                                20560099
205800         WHEN SQLCODE = 0                                         20570099
W21731             SET PS-TMDSEAR-IS-FOUND TO TRUE                      20250099
206000             ADD +1              TO PC-TMDSEAR-ROWS-SELECTED      20590099
206100         WHEN SQLCODE = +100                                      20600099
206200             CONTINUE                                             20610099
206300         WHEN OTHER                                               20620099
206400             MOVE '7700-SELECT-TMDSEAR-FOR-SCL'                   20630099
206500                                 TO AA-PARAGRAPH-NAME             20640099
206600             MOVE 'TMDSEAR TABLE ERROR'                           20650099
206700                                 TO AA-MESSAGE                    20660099
206800             MOVE 'SELECT'       TO AA-DB2-OPERATION              20670099
206900             PERFORM 9901-SQL-ERROR                               20680099
207000     END-EVALUATE.                                                20690099
207100                                                                  20700099
207200 EJECT                                                            20710099
207300                                                                  20720099
207400******************************************************************20730099
207500 7800-SELECT-TMDSEAR-TRSPBAR.                                     20740099
207600******************************************************************20750099
207700*                                                                 20760099
W21731     SET PS-TMDSEAR-TRSPBAR-NOT-FOUND TO TRUE.                    10890099
W26603     MOVE PC-03                TO MDSEAR-OPERCO-NBR.              19830099
W26603     MOVE PV-MDSEAR-DEPT-NBR   TO MDSEAR-DEPT-NBR.                19840099
W26603     MOVE PC-DPT               TO MDSEAR-MDSELV-CDE.              19850099
W26603     MOVE PV-RECL-DTE          TO MDSEAR-STRT-DTE.                19860099
W26603     MOVE PV-RECL-DTE          TO MDSEAR-END-DTE.                 19870099
W26603                                                                          
W26603     MOVE PC-BYR               TO RSPBAR-RSPLVL-CDE.              20890099
W26603     MOVE PV-RECL-DTE          TO RSPBAR-WORKER-STRT-DTE.         20900099
W26603     MOVE PV-RECL-DTE          TO RSPBAR-WORKER-END-DTE.          20910099
W26603                                                                          
207800     EXEC SQL                                                     20770099
207900         SELECT WORKER_FIR_NAME,                                  20780099
208000                WORKER_LAST_NAME                                  20790099
208100           INTO :RSPBAR-WORKER-FIR-NAME,                          20800099
208200                :RSPBAR-WORKER-LAST-NAME                          20810099
208300           FROM TMDSEAR, TRSPBAR                                  20820099
W26603          WHERE (TMDSEAR.OPERCO_NBR  = :MDSEAR-OPERCO-NBR)        20830099
W26603            AND (DEPT_NBR            = :MDSEAR-DEPT-NBR)          20840099
W26603            AND (MDSELV_CDE          = :MDSEAR-MDSELV-CDE)        20850099
W26603            AND (STRT_DTE           <= :MDSEAR-STRT-DTE)          20860099
W26603            AND (END_DTE            >= :MDSEAR-END-DTE)           20870099
208900            AND (TMDSEAR.MDSEAR_DKEY = TRSPBAR.MDSEAR_DKEY)       20880099
W26603            AND (RSPLVL_CDE       = :RSPBAR-RSPLVL-CDE)           20890099
W26603            AND (WORKER_STRT_DTE <= :RSPBAR-WORKER-STRT-DTE)      20900099
W26603            AND (WORKER_END_DTE  >= :RSPBAR-WORKER-END-DTE)       20910099
W26603         WITH UR                                                          
209300     END-EXEC.                                                    20920099
209400                                                                  20930099
209500     EVALUATE TRUE                                                20940099
209600         WHEN SQLCODE = 0                                         20950099
W21731             SET PS-TMDSEAR-TRSPBAR-IS-FOUND TO TRUE              20960099
209800             ADD +1              TO PC-TMDSEAR-TRSPBAR-ROWS-SLCTD 20970099
209900         WHEN SQLCODE = +100                                      20980099
210000             CONTINUE                                             20990099
210100         WHEN OTHER                                               21000099
210200             MOVE '7800-SELECT-TMDSEAR-TRSPBAR'                   21010099
210300                                 TO AA-PARAGRAPH-NAME             21020099
210400             MOVE 'TMDSEAR/TRSPBAR TABLES ERROR'                  21030099
210500                                 TO AA-MESSAGE                    21040099
210600             MOVE 'SELECT'       TO AA-DB2-OPERATION              21050099
210700             PERFORM 9901-SQL-ERROR                               21060099
210800     END-EVALUATE.                                                21070099
210900                                                                  21080099
211000 EJECT                                                            21090099
211100                                                                  21100099
211200******************************************************************21110099
211300 7900-SELECT-TUPCPLS-STR-RCD.                                     21120099
211400******************************************************************21130099
211500*                                                                 21140099
W21731     SET PS-TUPCPLS-IS-NOT-FOUND TO TRUE.                                 
W26603     MOVE PV-UPC-ID              TO UPCPLS-UPC-ID.                        
W26603     MOVE '03'                   TO UPCPLS-OPERCO-NBR.                    
W26603     MOVE PV-HOLD-STORE-NMBR-INT TO UPCPLS-STR-NBR.                       
W26603                                                                          
R21731     MOVE PV-DATE-REFORMATTER    TO PV-RECL-DTE.                  21140299
R21731     MOVE PV-TMST                TO PV-RECL-TIMESTAMP.            21140499
W26603     MOVE PV-RECL-TIMESTAMP      TO UPCPLS-EFF-BEG-TMST.          21140499
W26603     MOVE PV-RECL-TIMESTAMP      TO UPCPLS-EFF-END-TMST.          21140499
118500                                                                  21141099
211600     EXEC SQL                                                     21150099
211700         SELECT UNT_COST_AMT,                                     21160099
211900                UNT_RTL_AMT                                       21180099
212000           INTO :UPCPLS-UNT-COST-AMT,                             21190099
212200                :UPCPLS-UNT-RTL-AMT                               21210099
212300           FROM TUPCPLS                                           21220099
W26603           WHERE  UPC_ID        = :UPCPLS-UPC-ID                  21230199
W26603           AND    OPERCO_NBR    = :UPCPLS-OPERCO-NBR              21230299
W26603           AND    STR_NBR       = :UPCPLS-STR-NBR                 21230399
W26603           AND    EFF_BEG_TMST <= :UPCPLS-EFF-BEG-TMST            21230499
W26603           AND   (EFF_END_TMST >= :UPCPLS-EFF-END-TMST            21231099
082600           OR     EFF_END_TMST IS NULL)                           21240099
W26603         WITH UR                                                          
213800     END-EXEC.                                                    21370099
213900                                                                  21380099
214000     EVALUATE TRUE                                                21390099
214100         WHEN SQLCODE = 0                                         21400099
W21731             SET PS-TUPCPLS-IS-FOUND  TO TRUE                     21410099
214300             ADD +1                   TO PC-TUPCPLS-ROWS-SLCTD    21420099
                   MOVE UPCPLS-UNT-COST-AMT TO PV-UPCPLS-UNT-COST-AMT   21421099
                   MOVE UPCPLS-UNT-RTL-AMT  TO PV-UPCPLS-UNT-RTL-AMT    21422099
214400         WHEN SQLCODE = +100                                      21430099
214500             CONTINUE                                             21440099
214600         WHEN OTHER                                               21450099
214700             MOVE '7900-SELECT-TUPCPLS-STR-RCD'                   21460099
214800                                 TO AA-PARAGRAPH-NAME             21470099
W21731             MOVE 'TUPCPLS TABLES ERROR'                          21480099
215000                                 TO AA-MESSAGE                    21490099
215100             MOVE 'SELECT'       TO AA-DB2-OPERATION              21500099
215200             PERFORM 9901-SQL-ERROR                               21510099
215300     END-EVALUATE.                                                21520099
215400                                                                  21530099
215500 EJECT                                                            21540099
215600                                                                  21550099
211200******************************************************************21551099
211300 7910-SELECT-TUPCPLS-000-RCD.                                     21552099
211400******************************************************************21553099
211500*                                                                 21554099
W21731     SET PS-TUPCPLS-000-IS-NOT-FOUND TO TRUE.                     21554199
W26603     MOVE PV-UPC-ID              TO UPCPLS-UPC-ID.                        
W26603     MOVE '03'                   TO UPCPLS-OPERCO-NBR.                    
W26603     MOVE 000                    TO UPCPLS-STR-NBR.                       
W26603                                                                          
R21731     MOVE PV-DATE-REFORMATTER    TO PV-RECL-DTE.                  21140299
R21731     MOVE PV-TMST                TO PV-RECL-TIMESTAMP.            21140499
W26603     MOVE PV-RECL-TIMESTAMP      TO UPCPLS-EFF-BEG-TMST.          21140499
W26603     MOVE PV-RECL-TIMESTAMP      TO UPCPLS-EFF-END-TMST.          21140499
W26603                                                                  21141099
211600     EXEC SQL                                                     21555099
W21731         SELECT  UNT_COST_AMT                                     21556099
W21731                ,UNT_RTL_AMT                                      21557099
W21731                ,UPC_STAT_CDE                                     21557099
W21731           INTO  :UPCPLS-UNT-COST-AMT                             21558099
W21731                ,:UPCPLS-UNT-RTL-AMT                              21559099
W21731                ,:UPCPLS-UPC-STAT-CDE                             21559099
212300           FROM TUPCPLS                                           21559199
W26603           WHERE  UPC_ID        = :UPCPLS-UPC-ID                  21230199
W26603           AND    OPERCO_NBR    = :UPCPLS-OPERCO-NBR              21230299
W26603           AND    STR_NBR       = :UPCPLS-STR-NBR                 21230399
W26603           AND    EFF_BEG_TMST <= :UPCPLS-EFF-BEG-TMST            21230499
W26603           AND   (EFF_END_TMST >= :UPCPLS-EFF-END-TMST            21231099
082600           OR     EFF_END_TMST IS NULL)                           21240099
W26603         WITH UR                                                          
213800     END-EXEC.                                                    21559899
213900                                                                  21559999
214000     EVALUATE TRUE                                                21560099
214100         WHEN SQLCODE = 0                                         21560199
W21731             SET PS-TUPCPLS-000-IS-FOUND TO TRUE                  21560299
214300             ADD +1                   TO PC-TUPCPLS-ROWS-SLCTD    21560599
                   MOVE UPCPLS-UNT-COST-AMT TO PV-000-UNT-COST-AMT      21561999
                   MOVE UPCPLS-UNT-RTL-AMT  TO PV-000-UNT-RTL-AMT       21562099
214400         WHEN SQLCODE = +100                                      21562199
W21731             MOVE ZEROES              TO UPCPLS-UPC-STAT-CDE      21562299
214600         WHEN OTHER                                               21562399
214700             MOVE '7910-SELECT-TUPCPLS-000-RCD'                   21562499
214800                                 TO AA-PARAGRAPH-NAME             21562599
W21731             MOVE 'TUPCPLS TABLES ERROR'                          21562699
215000                                 TO AA-MESSAGE                    21562799
215100             MOVE 'SELECT'       TO AA-DB2-OPERATION              21562899
215200             PERFORM 9901-SQL-ERROR                               21562999
215300     END-EVALUATE.                                                21563099
215400                                                                  21563199
215500 EJECT                                                            21563299
215600                                                                  21563399
215700******************************************************************21564099
215800 8000-EOJ.                                                        21570099
215900******************************************************************21580099
216000*                                                                 21590099
216100     PERFORM 6050-WRITE-LAST-DETAIL-LINES.                        21600099
216200                                                                  21610099
216300     PERFORM 6110-WRITE-LAST-SUMMARY-LINES.                       21620099
216400                                                                  21630099
216500     PERFORM 8100-DISPLAY-PROCESS-SUMMARY.                        21640099
216600                                                                  21650099
216700     CLOSE CONTROL-FILE                                           21660099
R21731           RECLASS-FILE                                                   
216800           TRANS-EXTRACT-FILE                                     21670099
216900           DETAIL-REPORT-FILE                                     21680099
217000           SUMMARY-REPORT-FILE                                    21690099
W28545           RPT-EXTRACT-FILE                                       21700099
W28545           RECLS-EXTRACT-FILE                                             
W28545           BUYER-EXTRACT-FILE.                                            
217200                                                                  21710099
217300 EJECT                                                            21720099
217400                                                                  21730099
217500******************************************************************21740099
217600 8100-DISPLAY-PROCESS-SUMMARY.                                    21750099
217700******************************************************************21760099
217800                                                                  21770099
217900     DISPLAY ' '.                                                 21780099
218000     DISPLAY '  PROGRAM MLKUT410 PROCESSING SUMMARY'.             21790099
218100     DISPLAY '  -----------------------------------'.             21800099
218200     DISPLAY ' '.                                                 21810099
R21731     MOVE PC-ITEM-RECS-READ                                       21820099
218400                                 TO CD-COUNT-HOLD1.               21830099
R21731     DISPLAY 'STYLE RECLASS RECORDS READ =    ' CD-COUNT-HOLD1.   21840099
218600*                                                                 21850099
R21731     MOVE PC-SKU-ROWS-SELECTED   TO CD-COUNT-HOLD1.               21860099
R21731     DISPLAY 'SKU ROWS FETCHED    =           ' CD-COUNT-HOLD1.   21870099
218900*                                                                 21880099
W21731     MOVE PC-SKU-STORE-ROWS-FETCHED                               21890099
219100                                 TO CD-COUNT-HOLD1.               21900099
W21731     DISPLAY 'SKU/STORE ROWS FETCHED =        ' CD-COUNT-HOLD1.   21910099
219300*                                                                 21920099
219400     MOVE PC-TDTATTR-ROWS-SELECTED                                21930099
219500                                 TO CD-COUNT-HOLD1.               21940099
219600     DISPLAY 'TDTATTR ROWS SELECTED =         ' CD-COUNT-HOLD1.   21950099
219700*                                                                 21960099
219800     MOVE PC-TMDSEAR-ROWS-SELECTED TO CD-COUNT-HOLD1.             21970099
219900     DISPLAY 'TMDSEAR ROWS SELECTED =         ' CD-COUNT-HOLD1.   21980099
220000*                                                                 21990099
220100     MOVE PC-TMDSEAR-TRSPBAR-ROWS-SLCTD TO CD-COUNT-HOLD1.        22000099
220200     DISPLAY 'TMDSEAR/TRSPBAR ROWS SELECTED = ' CD-COUNT-HOLD1.   22010099
220300*                                                                 22020099
220400     MOVE PC-TUPCPLS-ROWS-SLCTD                                   22030099
220500                                 TO CD-COUNT-HOLD1.               22040099
W21731     DISPLAY 'TUPCPLS ROWS SELECTED =         ' CD-COUNT-HOLD1.   22050099
220700*                                                                 22060099
220800     MOVE PC-TRNS-EXTR-RECS-WRITTEN                               22070099
220900                                 TO CD-COUNT-HOLD1.               22080099
221000     DISPLAY 'TRNS EXTRACT RECORDS WRITTEN =  ' CD-COUNT-HOLD1.   22090099
221100*                                                                 22100099
221200     MOVE PC-RPT-EXTR-RECS-WRITTEN TO CD-COUNT-HOLD1.             22110099
221300     DISPLAY 'RPT EXTRACT RECORDS WRITTEN =   ' CD-COUNT-HOLD1.   22120099
221400*                                                                 22130099
221500     DISPLAY ' '.                                                 22140099
221600                                                                  22150099
221700 EJECT                                                            22160099
221800                                                                  22170099
221900****************************************************************  22180099
222000*NOTE:                                                            22190099
222100*    IF EITHER THE COST OR RETAIL ON THE INPUT RECORDS EXCEEDS    22200099
222200*    99999.99, THEN MULTIPLE EXTRACT RECORDS MUST BE FORMATTED    22210099
222300*    SINCE THE MAX FIELD SIZE ON THE OUTPUT RECORD IS S9(5)V99.   22220099
222400****************************************************************  22230099
222500 9000-WRITE-MULTIPLE-RECS.                                        22240099
222600****************************************************************  22250099
222700*                                                                 22260099
222800     MOVE PC-N                   TO PS-END-OF-CST-AMTS-SW         22270099
222900                                    PS-END-OF-RTL-AMTS-SW.        22280099
223000                                                                  22290099
223100     MOVE PV-RND-MERCH-EXT-CST-AMT                                22300099
223200                                 TO PV-EXT-CST-RCRD-PROC.         22310099
223300     MOVE PV-MERCH-EXT-RTL-AMT   TO PV-EXT-RTL-RCRD-PROC.         22320099
223400                                                                  22330099
223500     IF PV-EXT-CST-RCRD-PROC < 0                                  22340099
223600         COMPUTE PV-EXT-CST-RCRD-PROC =                           22350099
223700             PV-EXT-CST-RCRD-PROC * -1                            22360099
223800     END-IF.                                                      22370099
223900                                                                  22380099
224000     IF PV-EXT-RTL-RCRD-PROC < 0                                  22390099
224100         COMPUTE PV-EXT-RTL-RCRD-PROC =                           22400099
224200             PV-EXT-RTL-RCRD-PROC * -1                            22410099
224300     END-IF.                                                      22420099
224400                                                                  22430099
224500     PERFORM 9100-CALC-EXTENSION                                  22440099
224600         UNTIL PS-END-OF-CST-AMTS                                 22450099
224700           AND PS-END-OF-RTL-AMTS.                                22460099
224800                                                                  22470099
224900 EJECT                                                            22480099
225000                                                                  22490099
225100****************************************************************  22500099
225200*NOTE:                                                            22510099
225300*    DETERMINE THE COST AND RETAIL EXTENSION BASED ON THE         22520099
225400*    DOLLARS REMAINING IN EACH BUCKET. WRITE AN EXTRACT RECORD.   22530099
225500****************************************************************  22540099
225600 9100-CALC-EXTENSION.                                             22550099
225700****************************************************************  22560099
225800*                                                                 22570099
225900     IF PV-EXT-CST-RCRD-PROC > PC-POS-EXTENSION-2                 22580099
226000         SUBTRACT PC-POS-EXTENSION-2 FROM PV-EXT-CST-RCRD-PROC    22590099
226100         MOVE PC-POS-EXTENSION-2 TO ML015-PURCH-MERCH-AMT         22600099
226200                                    ML015-PURCH-NET               22610099
226300     ELSE                                                         22620099
226400         IF PV-EXT-CST-RCRD-PROC < PC-NEG-EXTENSION-2             22630099
226500             SUBTRACT PC-NEG-EXTENSION-2 FROM PV-EXT-CST-RCRD-PROC22640099
226600             MOVE PC-NEG-EXTENSION-2                              22650099
226700                                 TO ML015-PURCH-MERCH-AMT         22660099
226800                                    ML015-PURCH-NET               22670099
226900         ELSE                                                     22680099
227000             IF PV-EXT-CST-RCRD-PROC NOT = 0                      22690099
227100                 MOVE PV-EXT-CST-RCRD-PROC                        22700099
227200                                 TO ML015-PURCH-MERCH-AMT         22710099
227300                                    ML015-PURCH-NET               22720099
227400                 MOVE +0         TO PV-EXT-CST-RCRD-PROC          22730099
227500                 MOVE PC-Y       TO PS-END-OF-CST-AMTS-SW         22740099
227600             ELSE                                                 22750099
227700                 MOVE PV-EXT-CST-RCRD-PROC                        22760099
227800                                 TO ML015-PURCH-MERCH-AMT         22770099
227900                                    ML015-PURCH-NET               22780099
228000             END-IF                                               22790099
228100         END-IF                                                   22800099
228200     END-IF.                                                      22810099
228300                                                                  22820099
228400                                                                  22830099
228500     IF PV-EXT-RTL-RCRD-PROC > PC-POS-EXTENSION-2                 22840099
228600         SUBTRACT PC-POS-EXTENSION-2 FROM PV-EXT-RTL-RCRD-PROC    22850099
228700         MOVE PC-POS-EXTENSION-2 TO ML015-PURCH-RETAIL            22860099
228800     ELSE                                                         22870099
228900         IF PV-EXT-RTL-RCRD-PROC < PC-NEG-EXTENSION-2             22880099
229000             SUBTRACT PC-NEG-EXTENSION-2 FROM PV-EXT-RTL-RCRD-PROC22890099
229100             MOVE PC-NEG-EXTENSION-2                              22900099
229200                                 TO ML015-PURCH-RETAIL            22910099
229300         ELSE                                                     22920099
229400             IF PV-EXT-RTL-RCRD-PROC NOT = 0                      22930099
229500                 MOVE PV-EXT-RTL-RCRD-PROC                        22940099
229600                                 TO ML015-PURCH-RETAIL            22950099
229700                 MOVE +0         TO PV-EXT-RTL-RCRD-PROC          22960099
229800                 MOVE PC-Y       TO PS-END-OF-RTL-AMTS-SW         22970099
229900             ELSE                                                 22980099
230000                 MOVE PV-EXT-RTL-RCRD-PROC                        22990099
230100                                 TO ML015-PURCH-RETAIL            23000099
230200             END-IF                                               23010099
230300         END-IF                                                   23020099
230400     END-IF.                                                      23030099
230500                                                                  23040099
230600     WRITE TRANS-EXTRACT-RECORD FROM ML015-PURCHASE-RECORD.       23050099
230700     ADD 1                       TO PC-TRNS-EXTR-RECS-WRITTEN.    23060099
230800                                                                  23070099
230900 EJECT                                                            23080099
231000                                                                  23090099
231100******************************************************************23100099
231200 9900-COMMON-ABEND-ROUTINE.                                       23110099
231300******************************************************************23120099
231400*                                                                 23130099
231500     DISPLAY AA-ABEND-LIT.                                        23140099
231600     DISPLAY AA-PROGRAM-LIT.                                      23150099
231700     DISPLAY AA-PARAGRAPH-LIT.                                    23160099
231800     DISPLAY AA-MESSAGE-LINE.                                     23170099
231900     DISPLAY ABEND-CODE.                                          23180099
232000                                                                  23190099
W21731     PERFORM 9999-ABEND.                                          23200099
232200                                                                  23210099
232300 EJECT                                                            23220099
232400                                                                  23230099
232500******************************************************************23240099
232600 9901-SQL-ERROR.                                                  23250099
232700******************************************************************23260099
232800*                                                                 23270099
216700     CLOSE CONTROL-FILE                                           21660099
R21731           RECLASS-FILE                                                   
216800           TRANS-EXTRACT-FILE                                     21670099
216900           DETAIL-REPORT-FILE                                     21680099
217000           SUMMARY-REPORT-FILE                                    21690099
W28545           RPT-EXTRACT-FILE                                       21700099
W28545           RECLS-EXTRACT-FILE                                             
W28545           BUYER-EXTRACT-FILE.                                            
233400                                                                  23330099
233500     DISPLAY AA-ABEND-LIT.                                        23340099
233600     DISPLAY AA-DB2-ERROR-LIT.                                    23350099
233700     DISPLAY AA-PROGRAM-LIT.                                      23360099
233800     DISPLAY AA-PARAGRAPH-LIT.                                    23370099
233900     DISPLAY AA-MESSAGE-LINE.                                     23380099
234000     DISPLAY AA-DB2-OPERATION-LIT.                                23390099
234100     SET AC-DB2-ERROR TO TRUE.                                    23400099
234200     MOVE +4013                  TO ABEND-CODE.                   23410099
234300                                                                  23420099
234400     COPY DPPD004.                                                23430099
W21731     PERFORM 9999-ABEND.                                                  
                                                                                
W21731 9999-ABEND.                                                              
                                                                                
234500     CALL 'ILBOABN0' USING ABEND-CODE.                            23440099
234600                                                                  23450099
