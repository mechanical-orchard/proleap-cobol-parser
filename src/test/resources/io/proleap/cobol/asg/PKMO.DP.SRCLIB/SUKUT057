000100******************************************************************00010012
000200 IDENTIFICATION DIVISION.                                         00020012
000300******************************************************************00030012
000400                                                                  00040012
000500 PROGRAM-ID.    SUKUT057.                                         00050012
000600 AUTHOR.        DAN HINTZ.                                        00060012
000700 INSTALLATION.  KOHLS.                                            00070012
000800 DATE-WRITTEN   FEBRUARY, 2016.                                   00080012
000900 DATE-COMPILED.                                                   00090012
001000                                                                  00100012
001100******************************************************************00110012
001200*  THIS PROGRAM WILL TAKE IN AN EXTRACT FILE CONTAINING P2L MIXED 00120012
001300*  TOTE DATA AND DETERMINE IF THE MERCHANDISE IS A HANG, FOLD, OR 00130012
001400*  TABLE AND TOWER COMMODITY IN THE CONTAINER.  THIS INFORMATION  00140012
001500*  WILL BE USED TO CREATE THE P2L MIXED TOTE REPORT IN A LATER    00150012
001600*  STEP IN THE JOB.                                               00160012
001700******************************************************************00170012
001800******************************************************************00180012
001900 ENVIRONMENT DIVISION.                                            00190012
002000******************************************************************00200012
002100                                                                  00210012
002200 CONFIGURATION SECTION.                                           00220012
002300                                                                  00230012
002400 SOURCE-COMPUTER.        IBM-3090.                                00240012
002500 OBJECT-COMPUTER.        IBM-3090.                                00250012
002600                                                                  00260012
002700 INPUT-OUTPUT SECTION.                                            00270012
002800                                                                  00280012
002900 FILE-CONTROL.                                                    00290012
003000                                                                  00300012
003100     SELECT SUT-MIXED-P2L-TOTE-EXT-IN                             00310012
003200         ASSIGN TO INP01.                                         00320012
003300                                                                  00330012
003400     SELECT SUT-MIXED-P2L-TOTE-EXT-OUT                            00340012
003500         ASSIGN TO OUT01.                                         00350012
003600                                                                  00360012
003700******************************************************************00370012
003800 DATA DIVISION.                                                   00380012
003900******************************************************************00390012
004000                                                                  00400012
004100 FILE SECTION.                                                    00410012
004200                                                                  00420012
004300 FD  SUT-MIXED-P2L-TOTE-EXT-IN                                    00430012
004400     RECORDING MODE IS F                                          00440012
004500     LABEL RECORDS ARE STANDARD                                   00450012
004600     BLOCK CONTAINS 0 RECORDS.                                    00460012
004700*                                                                 00470012
004800 01  SUT-MIXED-P2L-TOTE-IN-REC  PIC  X(50).                       00480012
004900*                                                                 00490012
005000*                                                                 00500012
005100 FD  SUT-MIXED-P2L-TOTE-EXT-OUT                                   00510012
005200     RECORDING MODE IS F                                          00520012
005300     LABEL RECORDS ARE STANDARD                                   00530012
005400     BLOCK CONTAINS 0 RECORDS.                                    00540012
005500*                                                                 00550012
005600 01  SUT-MIXED-P2L-TOTE-OUT-REC PIC  X(50).                       00560012
005700*                                                                 00570012
005800*                                                                 00580012
005900*                                                                 00590012
006000******************************************************************00600012
006100 WORKING-STORAGE SECTION.                                         00610012
006200******************************************************************00620012
006300*                                                                 00630012
006400*                                                                 00640012
006500*-----------------------------------------------------------------00650012
006600*  RECORD LAYOUT FOR THE INPUT P2L MIXED TOTE DETAIL FILE         00660012
006700*-----------------------------------------------------------------00670012
006800     COPY SURD110.                                                00680030
006900                                                                  00690012
007000*                                                                 00700012
007100*-----------------------------------------------------------------00710012
007200*  RECORD LAYOUT FOR THE OUTPUT P2L MIXED TOTE DETAIL FILE        00720012
007300*-----------------------------------------------------------------00730012
007400     COPY SURD111.                                                00740030
007500                                                                  00750012
007600*                                                                 00760012
007700******************************************************************00770012
007800*  DB2 FORMATTED MESSAGE AREA                                     00780012
007900******************************************************************00790012
008000     COPY DPWS004.                                                00800012
008100*                                                                 00810012
008200******************************************************************00820012
008300*  COMMUNICATIONS AREA FOR DB2                                    00830012
008400******************************************************************00840012
008500     EXEC SQL                                                     00850012
008600          INCLUDE SQLCA                                           00860012
008700     END-EXEC.                                                    00870012
008800*                                                                 00880012
008900******************************************************************00890012
009000*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE PURCHASE ORDER     00900012
009100*  TABLE                                                          00910012
009200******************************************************************00920012
009300     EXEC SQL                                                     00930012
009400          INCLUDE TPURCHS                                         00940012
009500     END-EXEC.                                                    00950012
009600*                                                                 00960012
009700*                                                                 00970012
009800******************************************************************00980012
009900*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE SEASONAL SET TABLE 00990012
010000******************************************************************01000012
010100     EXEC SQL                                                     01010012
010200          INCLUDE TSEASET                                         01020012
010300     END-EXEC.                                                    01030012
010400*                                                                 01040012
010500*                                                                 01050012
010600******************************************************************01060012
010700*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE PARAMETER TABLE    01070012
010800******************************************************************01080012
010900     EXEC SQL                                                     01090012
011000          INCLUDE TKRPRPM                                         01100012
011100     END-EXEC.                                                    01110012
011200*                                                                 01120012
011300*                                                                 01130012
011400******************************************************************01140012
011500*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE RECEIVER TABLE     01150012
011600******************************************************************01160012
011700     EXEC SQL                                                     01170012
011800          INCLUDE TRECEIV                                         01180012
011900     END-EXEC.                                                    01190012
012000*                                                                 01200012
012100*                                                                 01210012
012200******************************************************************01220012
012300*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE RECEIVER ITEM      01230012
012400*  TABLE                                                          01240012
012500******************************************************************01250012
012600     EXEC SQL                                                     01260012
012700          INCLUDE TRECITM                                         01270012
012800     END-EXEC.                                                    01280012
012900*                                                                 01290012
013000*                                                                 01300012
013100******************************************************************01310012
013200*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE PURCHASE ORDER     01320012
013300*  ITEM TABLE                                                     01330012
013400******************************************************************01340012
013500     EXEC SQL                                                     01350012
013600          INCLUDE TPURITM                                         01360012
013700     END-EXEC.                                                    01370012
013800*                                                                 01380012
013900*                                                                 01390012
014000******************************************************************01400012
014100*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE WAREHOUSE SYSTEMS  01410012
014200*  INTEGRATION TYPE TABLE (WST_INTGRTN_TYP)                       01420012
014300******************************************************************01430012
014400     EXEC SQL                                                     01440012
014500          INCLUDE WST00008                                        01450012
014600     END-EXEC.                                                    01460012
014700*                                                                 01470012
014800*                                                                 01480012
014900******************************************************************01490012
015000*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE WAREHOUSE SYSTEMS  01500012
015100*  ATTRIBUTION DEFINITION TABLE (WST_ATTR_DEFN)                   01510012
015200******************************************************************01520012
015300     EXEC SQL                                                     01530012
015400          INCLUDE WST00009                                        01540012
015500     END-EXEC.                                                    01550012
015600*                                                                 01560012
015700*                                                                 01570012
015800******************************************************************01580012
015900*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE WAREHOUSE SYSTEMS  01590012
016000*  ATTRIBUTION ELEMENT TABLE (WST_ATTR_ELEM)                      01600012
016100******************************************************************01610012
016200     EXEC SQL                                                     01620012
016300          INCLUDE WST00010                                        01630012
016400     END-EXEC.                                                    01640012
016500*                                                                 01650012
016600*                                                                 01660012
016700******************************************************************01670012
016800*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE LOGISTICS DOMAIN   01680012
016900*  SKU TABLE (XLT_SKU)                                            01690012
017000******************************************************************01700012
017100     EXEC SQL                                                     01710012
017200          INCLUDE XLT00003                                        01720012
017300     END-EXEC.                                                    01730012
017400*                                                                 01740012
017500*                                                                 01750012
017600******************************************************************01760012
017700*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE LOGISTICS DOMAIN   01770012
017800*  VENDOR STYLE TABLE (XLT_VND_STYL)                              01780012
017900******************************************************************01790012
018000     EXEC SQL                                                     01800012
018100          INCLUDE XLT00004                                        01810012
018200     END-EXEC.                                                    01820012
018300*                                                                 01830012
018400*                                                                 01840012
018500 01  PS-PROGRAM-SWITCHES.                                         01850012
018600     05  PS-EOF-MIXED-TOT-EXT-SW     PIC  X(01)    VALUE 'N'.     01860012
018700         88  PS-EOF-MIXED-TOT-EXT                  VALUE 'Y'.     01870012
018800         88  PS-MORE-MIXED-TOT-EXT                 VALUE 'N'.     01880012
018900     05  PS-TABLE-AND-TOWER-SW       PIC  X(01)    VALUE 'N'.     01890012
019000         88  PS-TABLE-AND-TOWER-STORE-ZONE         VALUE 'Y'.     01900012
019100         88  PS-NOT-TABLE-AND-TOWER-ZONE           VALUE 'N'.     01910012
019500                                                                  01950012
019600                                                                  01960012
019700 01  PC-PROGRAM-CONSTANTS.                                        01970012
019800     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01980012
019900         'SUKUT057'.                                              01990012
020000     05  PC-ROW-NOT-FOUND            PIC S9(04)    VALUE +100     02000012
020100                                                   COMP SYNC.     02010012
020200     05  PC-CURRENT-OPERATING-COMPANY                             02020012
020300                                     PIC  X(02)    VALUE '03'.    02030012
020400     05  PC-MAX-RETRIES              PIC S9(04)    VALUE +3       02040012
020500                                                   COMP SYNC.     02050012
020600     05  PC-CURRENT-TIMESTAMP        PIC  X(26)    VALUE SPACES.  02060012
020700                                                                  02070012
020800 01  PV-ABEND-FIELDS.                                             02080012
020900     05  PV-ABEND-CODE               PIC S9(4)     VALUE +0       02090012
021000                                                   COMP SYNC.     02100012
021100     05  PV-SQLCODE                  PIC  9999-    VALUE ZERO.    02110012
021200     05  PV-ABEND-PROGRAM            PIC  X(08)    VALUE          02120012
021300                                                   'SUKUT057'.    02130012
021400     05  PV-ABEND-PARAGRAPH          PIC  X(50)    VALUE SPACES.  02140012
021500     05  PV-ABEND-OPERATION          PIC  X(50)    VALUE SPACES.  02150012
021600     05  PV-DB2-OPERATION-MESSAGE-1  PIC  X(79)    VALUE SPACES.  02160012
021700     05  PV-DB2-OPERATION-MESSAGE-2  PIC  X(79)    VALUE SPACES.  02170012
021800     05  PV-DB2-OPERATION-MESSAGE-3  PIC  X(79)    VALUE SPACES.  02180012
021900     05  PV-DB2-OPERATION-MESSAGE-4  PIC  X(79)    VALUE SPACES.  02190012
022000     05  PV-DB2-TABLE-NAME-1         PIC  X(15)    VALUE SPACES.  02200012
022100     05  PV-DB2-TABLE-NAME-2         PIC  X(15)    VALUE SPACES.  02210012
022200     05  PV-DB2-TABLE-NAME-3         PIC  X(15)    VALUE SPACES.  02220012
022300     05  PV-DB2-TABLE-NAME-4         PIC  X(15)    VALUE SPACES.  02230012
022400     05  PV-DISPLAY-OPER-UNT-ID-X.                                02240012
022500         10  PV-DISPLAY-OPER-UNT-ID  PIC  9(04)    VALUE ZEROES.  02250012
022600                                                                  02260012
022700 01  PV-PROGRAM-VARIABLES.                                        02270012
022800     05  PV-ITEM-NBR                 PIC  9(15)    VALUE ZERO.    02280012
023300     05  PV-READ-COUNTER             PIC S9(09)    VALUE ZERO     02330018
023400                                                   COMP SYNC.     02340012
023500     05  PV-WRITE-COUNTER            PIC S9(09)    VALUE ZERO     02350012
023600                                                   COMP SYNC.     02360012
023610     05  PV-PROCESSED-COUNTER        PIC S9(09)    VALUE ZERO     02361030
023620                                                   COMP SYNC.     02362014
023700     05  PV-DIVERT-PFX-NBR           PIC S9(04)    VALUE ZERO     02370012
023800                                                   COMP SYNC.     02380012
023900     05  PV-DISPLAY-COUNT            PIC ZZZ,ZZZ,ZZ9.             02390012
024000                                                                  02400012
024100     05  PV-DB2-COUNT                PIC S9(09)    VALUE ZERO     02410012
024200                                                   COMP-3.        02420012
024300     05  PV-HANG-COUNT                  PIC S9(09)  COMP.         02430012
024400     05  PV-FOLD-COUNT                  PIC S9(09)  COMP.         02440012
024500     05  PV-COMMODITY-COUNT             PIC S9(09)  COMP.         02450012
024600     05  PV-OTHER-COUNT                 PIC S9(09)  COMP.         02460012
024800     05  PV-PREV-ORD-NBR                PIC S9(09)  COMP VALUE +0.02480012
024900     05  PV-PREV-REC-SEQ-NBR            PIC S9(09)  COMP VALUE +0.02490012
025000     05  PV-P2L-ZONE                    PIC X(14).                02500012
025100         88 PV-COMMODITY                 VALUE 'COMMODITY     '.  02510012
025200         88 PV-HANG-FOLD                 VALUE 'HANG/FOLD     '.  02520012
025300         88 PV-HANG-COMMODITY            VALUE 'HANG/COMMODITY'.  02530012
025400     05  PV-HANGER-IND                  PIC X(01)  VALUE SPACES.  02540012
025500         88 PV-HANGER-AGREEMENT          VALUE 'Y'.               02550012
025600     05  PV-DFLT-STR-ZN-ID              PIC  X(05) VALUE SPACES.  02560012
025700     05  PV-DISPLAY-PO-NBR              PIC  9(08) VALUE ZEROES.  02570012
025800     05  PV-DISPLAY-RCVR-SEQ-NBR        PIC  9(04) VALUE ZEROES.  02580012
025900     05  PV-DISPLAY-LNE-NBR             PIC  9(04) VALUE ZEROES.  02590012
026000     05  PV-DISPLAY-OPER                PIC  9(04) VALUE ZEROES.  02600012
026100     05  PV-DISPLAY-FCLTY               PIC  9(04) VALUE ZEROES.  02610012
026200     05  PV-DISPLAY-TASK-NBR            PIC  9(07) VALUE ZEROES.  02620012
026300     05  PV-DISPLAY-ITEM-NBR            PIC  9(15) VALUE ZEROES.  02630012
026400     05  PV-DISPLAY-ACTIVITY            PIC  X(10) VALUE SPACES.  02640012
026500     05  PV-DISPLAY-FKEY                PIC  X(05) VALUE SPACES.  02650012
026600     05  PV-DISPLAY-LABOR-ASGMTS        PIC  9(04) VALUE ZEROES.  02660012
026610     05  PV-SHIPT-UNT-ID-NUM            PIC  9(18)  VALUE ZEROES. 02661031
026620     05  PV-SHIPT-UNT-ID-NUM-R REDEFINES PV-SHIPT-UNT-ID-NUM.     02662031
026621         10  FILLER                     PIC  9(03).               02662131
026630         10  PV-STORE-NUMBER            PIC  9(04).               02663031
026640         10  FILLER                     PIC  9(11).               02664031
026700                                                                  02670012
026800                                                                  02680012
026900 01  SD-SYSTEM-DATE.                                              02690012
027000     05  SD-SYSTEM-DATE-YY           PIC  9(02)      VALUE ZERO.  02700012
027100     05  SD-SYSTEM-DATE-MM           PIC  9(02)      VALUE ZERO.  02710012
027200     05  SD-SYSTEM-DATE-DD           PIC  9(02)      VALUE ZERO.  02720012
027300                                                                  02730012
027400 01  DK-DB-KEYS.                                                  02740012
027500     05  DK-OPER-UNT-ID              PIC S9(04) COMP VALUE +0.    02750012
027600     05  DK-PO-NBR                   PIC S9(09) COMP VALUE +0.    02760012
027700     05  DK-REC-SEQ-NBR              PIC S9(09) COMP VALUE +0.    02770012
027800     05  DK-STR-ZN-CDE               PIC  X(05)      VALUE SPACES.02780012
027900                                                                  02790012
028000*                                                                 02800012
028100                                                                  02810012
028200******************************************************************02820012
028300 PROCEDURE DIVISION.                                              02830012
028400******************************************************************02840012
028500                                                                  02850012
028600 0000-PROGRAM-MAINLINE.                                           02860012
028700******************************************************************02870012
028800* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     02880012
028900*      PROGRAM.                                                   02890012
029000******************************************************************02900012
029100                                                                  02910012
029200     PERFORM 1000-INITIALIZE.                                     02920012
029400     PERFORM 2000-PROCESS-MIXED-TOT-EXT                           02940017
029500        UNTIL PS-EOF-MIXED-TOT-EXT.                               02950017
029700     PERFORM 9000-EOJ-ROUTINE.                                    02970012
029800                                                                  02980012
029900     STOP RUN.                                                    02990012
030000                                                                  03000012
030100 1000-INITIALIZE.                                                 03010012
030200******************************************************************03020012
030300*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    03030012
030400*    -- OPEN INPUT AND OUTPUT FILES                               03040012
030500*    -- READ RECORD FROM INPUT FILE                               03050012
030600******************************************************************03060012
030700                                                                  03070012
030800     OPEN INPUT  SUT-MIXED-P2L-TOTE-EXT-IN                        03080019
030900          OUTPUT SUT-MIXED-P2L-TOTE-EXT-OUT.                      03090012
031000                                                                  03100012
031100     PERFORM 8000-READ-MIXED-TOT-EXT.                             03110012
031200                                                                  03120012
031300                                                                  03130012
031400 2000-PROCESS-MIXED-TOT-EXT.                                      03140012
031500******************************************************************03150012
031600*  PROCESS THE MIXED P2L MIXED TOTE EXTRACT FILE.  DETERMINE THE  03160012
031700*  COMMODITY OF THE CONTENTS IN THE CONTAINER.                    03170012
031800******************************************************************03180012
031900                                                                  03190012
032700     IF  SU110-ORD-NBR = PV-PREV-ORD-NBR                          03270012
032800         IF  PS-TABLE-AND-TOWER-STORE-ZONE                        03280012
032900             MOVE 'T&T'                  TO SU111-STR-ZN-CDE      03290012
033001             MOVE SU110-SHIPT-UNT-ID     TO SU111-SHIPT-UNT-ID    03300131
033002                                            PV-SHIPT-UNT-ID-NUM   03300231
033010             MOVE PV-STORE-NUMBER        TO SU111-DEST-LOC-NBR    03301031
033100             MOVE SU110-ORGN-LOC-NBR     TO SU111-ORGN-LOC-NBR    03310012
033110             MOVE SU110-ORD-NBR          TO SU111-ORD-NBR         03311021
033120             MOVE SU110-REC-SEQ-NBR      TO SU111-REC-SEQ-NBR     03312021
033200             MOVE SU110-COUNT-NBR        TO SU111-COUNT-NBR       03320012
033300             PERFORM 8100-WRITE-EXTRACT-FILE                      03330012
033400             PERFORM 8000-READ-MIXED-TOT-EXT                      03340012
033500         ELSE                                                     03350012
033600             IF  SU110-REC-SEQ-NBR = PV-PREV-REC-SEQ-NBR          03360012
033700                 MOVE PV-DFLT-STR-ZN-ID  TO SU111-STR-ZN-CDE      03370012
033800                 MOVE SU110-SHIPT-UNT-ID TO SU111-SHIPT-UNT-ID    03380012
033810                                            PV-SHIPT-UNT-ID-NUM   03381031
033820                 MOVE PV-STORE-NUMBER    TO SU111-DEST-LOC-NBR    03382031
033900                 MOVE SU110-ORGN-LOC-NBR TO SU111-ORGN-LOC-NBR    03390012
033910                 MOVE SU110-ORD-NBR      TO SU111-ORD-NBR         03391021
033920                 MOVE SU110-REC-SEQ-NBR  TO SU111-REC-SEQ-NBR     03392021
034000                 MOVE SU110-COUNT-NBR    TO SU111-COUNT-NBR       03400012
034100                 PERFORM 8100-WRITE-EXTRACT-FILE                  03410012
034200                 PERFORM 8000-READ-MIXED-TOT-EXT                  03420012
034300             ELSE                                                 03430012
034400                 MOVE SU110-REC-SEQ-NBR  TO PV-PREV-REC-SEQ-NBR   03440012
034410                 MOVE SU110-STR-ZN-CDE   TO PV-DFLT-STR-ZN-ID     03441019
034500                 PERFORM 4000-DETERMINE-HANG-FOLD                 03450012
034600                 MOVE PV-DFLT-STR-ZN-ID  TO SU111-STR-ZN-CDE      03460012
034700                 MOVE SU110-SHIPT-UNT-ID TO SU111-SHIPT-UNT-ID    03470012
034710                                            PV-SHIPT-UNT-ID-NUM   03471031
034720                 MOVE PV-STORE-NUMBER    TO SU111-DEST-LOC-NBR    03472031
034800                 MOVE SU110-ORGN-LOC-NBR TO SU111-ORGN-LOC-NBR    03480012
034810                 MOVE SU110-ORD-NBR      TO SU111-ORD-NBR         03481021
034820                 MOVE SU110-REC-SEQ-NBR  TO SU111-REC-SEQ-NBR     03482021
034900                 MOVE SU110-COUNT-NBR    TO SU111-COUNT-NBR       03490012
035000                 PERFORM 8100-WRITE-EXTRACT-FILE                  03500012
035100                 PERFORM 8000-READ-MIXED-TOT-EXT                  03510012
035200             END-IF                                               03520012
035300         END-IF                                                   03530012
035400     ELSE                                                         03540012
035410         MOVE SU110-ORD-NBR              TO PV-PREV-ORD-NBR       03541014
035420         MOVE SU110-REC-SEQ-NBR          TO PV-PREV-REC-SEQ-NBR   03542014
035500         PERFORM 3000-DETERMINE-TABLE-AND-TOWER                   03550012
035600         IF  PS-TABLE-AND-TOWER-STORE-ZONE                        03560012
035700             MOVE 'T&T'                  TO SU111-STR-ZN-CDE      03570012
035800             MOVE SU110-SHIPT-UNT-ID     TO SU111-SHIPT-UNT-ID    03580012
035810                                            PV-SHIPT-UNT-ID-NUM   03581031
035820             MOVE PV-STORE-NUMBER    TO SU111-DEST-LOC-NBR        03582031
035900             MOVE SU110-ORGN-LOC-NBR     TO SU111-ORGN-LOC-NBR    03590012
035910             MOVE SU110-ORD-NBR          TO SU111-ORD-NBR         03591021
035920             MOVE SU110-REC-SEQ-NBR      TO SU111-REC-SEQ-NBR     03592021
036000             MOVE SU110-COUNT-NBR        TO SU111-COUNT-NBR       03600012
036100             PERFORM 8100-WRITE-EXTRACT-FILE                      03610012
036200             PERFORM 8000-READ-MIXED-TOT-EXT                      03620012
036300        ELSE                                                      03630012
036310             MOVE SU110-STR-ZN-CDE       TO PV-DFLT-STR-ZN-ID     03631019
036400             PERFORM 4000-DETERMINE-HANG-FOLD                     03640012
036500             MOVE PV-DFLT-STR-ZN-ID      TO SU111-STR-ZN-CDE      03650012
036600             MOVE SU110-SHIPT-UNT-ID     TO SU111-SHIPT-UNT-ID    03660012
036610                                            PV-SHIPT-UNT-ID-NUM   03661031
036620             MOVE PV-STORE-NUMBER    TO SU111-DEST-LOC-NBR        03662031
036700             MOVE SU110-ORGN-LOC-NBR     TO SU111-ORGN-LOC-NBR    03670012
036710             MOVE SU110-ORD-NBR          TO SU111-ORD-NBR         03671021
036720             MOVE SU110-REC-SEQ-NBR      TO SU111-REC-SEQ-NBR     03672021
036800             MOVE SU110-COUNT-NBR        TO SU111-COUNT-NBR       03680012
036900             PERFORM 8100-WRITE-EXTRACT-FILE                      03690012
037000             PERFORM 8000-READ-MIXED-TOT-EXT                      03700012
037100        END-IF                                                    03710012
037200     END-IF.                                                      03720012
037300                                                                  03730012
037400                                                                  03740012
037500*----------------------------------------------------------------*03750012
037600* CHECK TO SEE IF THERE IS AN ACTIVE SEASONAL SET CODE FOR THIS  *03760012
037700* SPECIFIC PO NUMBER.  IF THERE IS, THEN THE STORE ZONE SHOULD   *03770012
037800* BE 'T&T'.                                                      *03780012
037900*----------------------------------------------------------------*03790012
038000 3000-DETERMINE-TABLE-AND-TOWER.                                  03800012
038100                                                                  03810012
038200     MOVE SU110-ORD-NBR                     TO DK-PO-NBR.         03820012
038300     SET  PS-NOT-TABLE-AND-TOWER-ZONE       TO TRUE.              03830012
038400                                                                  03840012
038500     EXEC SQL                                                     03850012
038600          SELECT B.DIVERT_PFX_NBR                                 03860012
038700            INTO :SEASET-DIVERT-PFX-NBR                           03870012
038800            FROM TPURCHS A                                        03880012
038900                ,TSEASET B                                        03890012
039000           WHERE A.PO_NBR          = :DK-PO-NBR                   03900012
039100             AND A.VER_STATUS_CDE  = 'A'                          03910012
039200             AND A.SEASET_YR       = B.SEASET_YR                  03920012
039300             AND A.SEASET_SHRT_NM  = B.SEASET_SHRT_NM             03930012
039400             AND B.SEASET_STAT_CDE = 'A'                          03940012
039500     END-EXEC                                                     03950012
039600                                                                  03960012
039700     EVALUATE TRUE                                                03970012
039800         WHEN SQLCODE = +0                                        03980012
039900              IF  SEASET-DIVERT-PFX-NBR > 0                       03990012
040000                  SET PS-TABLE-AND-TOWER-STORE-ZONE     TO TRUE   04000012
040100              ELSE                                                04010012
040200                  SET PS-NOT-TABLE-AND-TOWER-ZONE       TO TRUE   04020012
040300              END-IF                                              04030012
040400         WHEN SQLCODE = +100                                      04040012
040500              SET PS-NOT-TABLE-AND-TOWER-ZONE           TO TRUE   04050012
040600         WHEN OTHER                                               04060012
040700              MOVE '3000-DETERMINE-TABLE-AND-TOWER'               04070012
040800                                 TO PV-ABEND-PARAGRAPH            04080012
040900              MOVE 'SELECT SEASONAL SET FOR PO'                   04090012
041000                                 TO PV-ABEND-OPERATION            04100012
041100              MOVE DK-PO-NBR     TO PV-DISPLAY-PO-NBR             04110012
041200              STRING 'PURCHASE ORDER NUMBER: ' DELIMITED BY SIZE  04120012
041300                     PV-DISPLAY-PO-NBR         DELIMITED BY SIZE  04130012
041400                               INTO PV-DB2-OPERATION-MESSAGE-1    04140012
041500              MOVE 'TPURCHS '    TO PV-DB2-TABLE-NAME-1           04150012
041600              MOVE 'TSEASET '    TO PV-DB2-TABLE-NAME-2           04160012
041700              PERFORM 9100-SQL-ABEND                              04170012
041800     END-EVALUATE.                                                04180012
041900                                                                  04190012
042000                                                                  04200012
042100*-----------------------------------------------------------------04210012
042200*                                                                 04220012
042300*** CHECK HOW DC IS PROCESSING P2L FREIGHT                        04230012
042400***       HANG/FOLD   (COMBINE ZONES: CHILD, MENS,JRS, WOMEN)     04240012
042500***       HANG/COMMODITY                                          04250012
042600***       COMMODITY                                               04260012
042700*** IF HANG/FOLD OR HANG/COMMODITY THE DEFAULT STORE ZONE TO      04270012
042800*** TO BE DISPLAYED WOULD BE FOR WHATEVER ZONE WOULD HAVE THE     04280012
042900*** MOST LINES:                                                   04290012
043000*** EX: RECEIVER HAS 5 LINES.  3 LINES ARE HANG  2 LINES ARE FOLD 04300012
043100***     THE DEFAULT STORE ZONE WOULD BE HANG                      04310012
043200*                                                                 04320012
043300*   1.  COUNT THE NUMBER OF RCVR LINES WITH HANG PRESENTATION     04330012
043400*   2.  COUNT THE NUMBER OF RCVR LINES WITH FOLD PRESENTATION     04340012
043500*   3.  COUNT THE NUMBER OF RCVR LINES WITH OTHER PRESENTATION    04350012
043600*   4.  GET GOH_IND (GOODS ON HAND FROM RECEIVER)                 04360012
043700*       Y=VENDOR HANG AGREEMENT   N=NO VENDOR HANG AGREEMENT      04370012
043800*                                                                 04380012
043900*   IF DC IS PROCESSING P2L AS HANG/FOLD  AND                     04390012
044000*      STORE ZONE FOR RECEIVER = CHILD, JRS, MENS, WOMEN          04400012
044100*          IF GOH-IND = Y    ADD OTHER-COUNT TO HANG-COUNT        04410012
044200*          IF GOH-IND = N    ADD OTHER-COUNT TO FOLD-COUNT        04420012
044300*      IF HANG-COUNT >  FOLD-COUNT =====  STORE-ZONE HANG         04430012
044400*         ELSE                                                    04440012
044500*      STORE-ZONE FOR P2L WILL BE FOLD                            04450012
044600*                                                                 04460012
044700* ELSE                                                            04470012
044800*                                                                 04480012
044900*   IF DC IS PROCESSING P2L AS HANG/COMMODITY AND                 04490012
045000*      STORE ZONE FOR RECEIVER = CHILD, JRS, MENS, WOMEN          04500012
045100*          IF GOH-IND = Y    ADD OTHER-COUNT TO HANG-COUNT        04510012
045200*          IF GOH-IND = N    ADD OTHER-COUNT TO COMMODITY-COUNT   04520012
045300*      IF HANG-COUNT >  COMMODITY-COUNT =====  STORE-ZONE HANG    04530012
045400*         ELSE                                                    04540012
045500*      STORE-ZONE FOR P2L WILL BE COMMODITY                       04550012
045600*                                                                 04560012
045700*-----------------------------------------------------------------04570012
045800 4000-DETERMINE-HANG-FOLD.                                        04580012
045900*                                                                 04590012
045902*** HOW IS DC PROCESSING P2L FREIGHT                              04590222
045903*                                                                 04590322
045905     PERFORM 4076-CHECK-P2L-ZONES.                                04590522
045920*                                                                 04592022
046000*** IS THE STORE ZONE ONE OF THE ZONES BEING PROCESSED AS H/F     04600012
046100*                                                                 04610012
046200     IF  PV-HANG-FOLD        OR                                   04620012
046300         PV-HANG-COMMODITY                                        04630012
046400         PERFORM 4077-CHECK-HANG-FOLD                             04640012
046500     END-IF.                                                      04650012
046600                                                                  04660012
046700*                                                                 04670012
046800*** COUNT THE NUMBER OF LINES ON THE RCVR WITH HANG PRESENTATION  04680012
046900*                                                                 04690012
047000     IF  PV-HANG-FOLD        OR                                   04700012
047100         PV-HANG-COMMODITY                                        04710012
047200         PERFORM 4078-COUNT-HANG                                  04720012
047300     END-IF.                                                      04730012
047400                                                                  04740012
047500*                                                                 04750012
047600*** COUNT THE NUMBER OF LINES ON THE RCVR WITH FOLD PRESENTATION  04760012
047700*                                                                 04770012
047800     IF  PV-HANG-FOLD                                             04780012
047900         PERFORM 4079-COUNT-FOLD                                  04790012
048000     END-IF.                                                      04800012
048100                                                                  04810012
048200*                                                                 04820012
048300*** COUNT THE NUMBER OF LINES ON THE RCVR BY COMMODITY NOT HANG   04830012
048400*                                                                 04840012
048500     IF  PV-HANG-COMMODITY                                        04850012
048600         PERFORM 4080-COUNT-COMMODITY                             04860012
048700     END-IF.                                                      04870012
048800                                                                  04880012
048900*                                                                 04890012
049000*** COUNT THE NUMBER OF LINES ON THE RCVR NOT H/F PRESENTATION    04900012
049100*                                                                 04910012
049200     IF  PV-HANG-FOLD                                             04920012
049300         PERFORM 4081-COUNT-OTHER                                 04930012
049400     END-IF.                                                      04940012
049500                                                                  04950012
049600*                                                                 04960012
049700*** COUNT THE NUMBER OF LINES ON THE RCVR NOT H/F PRESENTATION    04970012
049800*                                                                 04980012
049900     IF  PV-HANG-FOLD        OR                                   04990012
050000         PV-HANG-COMMODITY                                        05000012
050100         PERFORM 4082-CHECK-GOH-IND                               05010012
050200     END-IF.                                                      05020012
050300                                                                  05030012
050400*                                                                 05040012
050500* DC PROCESSING P2L AS HANG/FOLD                                  05050012
050600* VENDOR HANGER AGREEMENT (GOH-IND = Y) ADD OTHER TO HANG-COUNT   05060012
050700*                                                                 05070012
050800* DC PROCESSING P2L AS HANG/FOLD                                  05080012
050900* VENDOR HANGER AGREEMENT (GOH-IND = N) ADD OTHER TO FOLD-COUNT   05090012
051000*                                                                 05100012
051100     IF  PV-HANG-FOLD                                             05110012
051200         IF  PV-HANGER-AGREEMENT                                  05120012
051300             ADD  PV-OTHER-COUNT  TO  PV-HANG-COUNT               05130012
051400             MOVE ZEROES          TO  PV-OTHER-COUNT              05140012
051500         ELSE                                                     05150012
051600             ADD  PV-OTHER-COUNT  TO  PV-FOLD-COUNT               05160012
051700             MOVE ZEROES          TO  PV-OTHER-COUNT              05170012
051800         END-IF                                                   05180012
051900     END-IF.                                                      05190012
052000                                                                  05200012
052100*                                                                 05210012
052200* DC PROCESSING P2L AS HANG/COMMODITY                             05220012
052300* VENDOR HANGER AGREEMENT (GOH-IND = Y) ADD OTHER TO HANG-COUNT   05230012
052400*                                                                 05240012
052500     IF  PV-HANG-COMMODITY                                        05250012
052600         IF  PV-HANGER-AGREEMENT                                  05260012
052700             ADD  PV-OTHER-COUNT  TO  PV-HANG-COUNT               05270012
052800             MOVE ZEROES          TO  PV-OTHER-COUNT              05280012
052900         END-IF                                                   05290012
053000     END-IF.                                                      05300012
053100                                                                  05310012
053200*                                                                 05320012
053300***  IF  DC IS PROCESSING P2L AS HANG/FOLD                        05330012
053400***       IF  HANG-COUNT >=  FOLD COUNT                           05340012
053500***           STORE ZONE WILL BE "HANG"                           05350012
053600***       OHERWISE                                                05360012
053700***           STORE ZONE WILL BE "FOLD"                           05370012
053800*                                                                 05380012
053900     IF  PV-HANG-FOLD                                             05390012
054000                                                                  05400012
054100         IF  PV-HANG-COUNT  >  PV-FOLD-COUNT  OR                  05410012
054200             PV-HANG-COUNT  =  PV-FOLD-COUNT                      05420012
054300             MOVE  'HANG'  TO  PV-DFLT-STR-ZN-ID                  05430012
054400         ELSE                                                     05440012
054500             MOVE  'FOLD'  TO  PV-DFLT-STR-ZN-ID                  05450012
054600         END-IF                                                   05460012
054700     END-IF.                                                      05470012
054800                                                                  05480012
054900*                                                                 05490012
055000***  IF  DC IS PROCESSING P2L AS HANG/COMMODITY                   05500012
055100***       IF  HANG-COUNT >=  COMMODITY COUNT                      05510012
055200***           STORE ZONE WILL BE "HANG"                           05520012
055300***       OHERWISE                                                05530012
055400***           STORE ZONE WILL BE COMMODITY                        05540012
055500*                                                                 05550012
055600     IF  PV-HANG-COMMODITY                                        05560012
055700         IF  PV-HANG-COUNT  >  PV-COMMODITY-COUNT  OR             05570012
055800             PV-HANG-COUNT  =  PV-COMMODITY-COUNT                 05580012
055900             MOVE  'HANG'  TO  PV-DFLT-STR-ZN-ID                  05590012
056000         END-IF                                                   05600012
056100     END-IF.                                                      05610012
056200                                                                  05620012
056300                                                                  05630012
056400*----------------------------------------------------------------*05640012
056500* CHECK TO SEE HOW THE DC IS PROCESSING PACK-TO-LIGHT FREIGHT    *05650012
056600*        HANG/FOLD -OR- HANG/COMMODITY -OR- COMMODITY            *05660012
056700*----------------------------------------------------------------*05670012
056800 4076-CHECK-P2L-ZONES.                                            05680012
056900                                                                  05690012
057000     MOVE  SU110-ORGN-LOC-NBR TO  DK-OPER-UNT-ID.                 05700012
057100                                                                  05710012
057200     EXEC SQL                                                     05720012
057300          SELECT  FUNC_TXT                                        05730012
057400            INTO :PV-P2L-ZONE                                     05740012
057500            FROM  TKRPRPM                                         05750012
057600           WHERE  LOC_ID            = :DK-OPER-UNT-ID             05760012
057700             AND  SYS_PRC_FUNC_CDE  = 'P2LZON'                    05770012
057800             AND  INTFC_SYS_CDE     = 'KHL'                       05780012
057900             AND  FUNC_PRC_STAT_CDE = 'AC'                        05790012
058000             AND  FUNC_BEG_TMST    <=  CURRENT TIMESTAMP          05800012
058100             AND  FUNC_END_TMST    >=  CURRENT TIMESTAMP          05810012
058200     END-EXEC                                                     05820012
058300                                                                  05830012
058400     EVALUATE TRUE                                                05840012
058500         WHEN SQLCODE = +0                                        05850012
058600              IF  PV-HANG-FOLD                                    05860012
058700                  SET  PV-HANG-FOLD        TO  TRUE               05870012
058800              ELSE                                                05880012
058900              IF  PV-HANG-COMMODITY                               05890012
059000                  SET  PV-HANG-COMMODITY   TO  TRUE               05900012
059100              ELSE                                                05910012
059200                  SET  PV-COMMODITY        TO  TRUE               05920012
059300              END-IF                                              05930012
059400              END-IF                                              05940012
059500         WHEN SQLCODE = +100                                      05950012
059600              SET  PV-COMMODITY      TO  TRUE                     05960012
059700         WHEN OTHER                                               05970012
059800              MOVE '4076-CHECK-P2L-ZONES'                         05980012
059900                                 TO PV-ABEND-PARAGRAPH            05990012
060000              MOVE 'CHECK P2L ZONE SETUP    '                     06000012
060100                                 TO PV-ABEND-OPERATION            06010012
060200              MOVE DK-OPER-UNT-ID                                 06020012
060300                                 TO PV-DISPLAY-OPER-UNT-ID        06030012
060400              STRING 'OPER UNT ID: '          DELIMITED BY SIZE   06040012
060500                     PV-DISPLAY-OPER-UNT-ID-X DELIMITED BY SIZE   06050012
060600                               INTO PV-DB2-OPERATION-MESSAGE-1    06060012
060700              MOVE 'TKRPRPM '    TO PV-DB2-TABLE-NAME-1           06070012
060800              PERFORM 9100-SQL-ABEND                              06080012
060900     END-EVALUATE.                                                06090012
061000                                                                  06100012
061100                                                                  06110012
061200*----------------------------------------------------------------*06120012
061300* CHECK TO SEE IF THE DEFAULT STORE ZONE IS ONE OF THE ZONES     *06130012
061400* SETUP FOR HANG/FOLD OR HANG/COMMODITY                          *06140012
061500*----------------------------------------------------------------*06150012
061600 4077-CHECK-HANG-FOLD.                                            06160012
061700                                                                  06170012
061800     MOVE SU110-STR-ZN-CDE TO DK-STR-ZN-CDE.                      06180012
061900                                                                  06190012
062000     EXEC SQL                                                     06200012
062100          SELECT                                                  06210012
062200                   E.ATTR_ELEM_TXT  AS STORE_ZONE                 06220012
062300            INTO :WST00010-ATTR-ELEM-TXT                          06230012
062400            FROM                                                  06240012
062500                   WST_INTGRTN_TYP  A                             06250012
062600               ,   WST_ATTR_DEFN    B                             06260012
062700               ,   WST_ATTR_ELEM    C                             06270012
062800               ,   WST_ATTR_ELEM    D                             06280012
062900               ,   WST_ATTR_ELEM    E                             06290012
063000               ,   WST_ATTR_ELEM    F                             06300012
063100               ,   WST_ATTR_ELEM    G                             06310012
063200            WHERE                                                 06320012
063300                  A.INTGRTN_TYP_CDE   = 'P2LHNGFLD'               06330012
063400              AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         06340012
063500              AND B.ATTR_DEFN_SEQ_NBR = 1                         06350012
063600              AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         06360012
063700              AND C.ATTR_DEFN_SEQ_NBR = 1                         06370012
063800              AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         06380012
063900              AND D.ATTR_DEFN_SEQ_NBR = 2                         06390012
064000              AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         06400012
064100              AND E.ATTR_DEFN_SEQ_NBR = 3                         06410012
064200              AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE         06420012
064300              AND F.ATTR_DEFN_SEQ_NBR = 4                         06430012
064400              AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE         06440012
064500              AND G.ATTR_DEFN_SEQ_NBR = 5                         06450012
064600              AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       06460012
064700              AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       06470012
064800              AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR       06480012
064900              AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR       06490012
065000              AND C.ATTR_ELEM_NBR     =  90                       06500012
065100              AND D.ATTR_ELEM_TXT     = 'P2L'                     06510012
065200              AND F.ATTR_ELEM_TMST   <=  CURRENT TIMESTAMP        06520012
065300              AND G.ATTR_ELEM_TMST   >=  CURRENT TIMESTAMP        06530012
065400              AND E.ATTR_ELEM_TXT     = :DK-STR-ZN-CDE            06540012
065500     END-EXEC.                                                    06550012
065600                                                                  06560012
065700     EVALUATE TRUE                                                06570012
065800         WHEN SQLCODE = +0                                        06580012
065900              CONTINUE                                            06590012
066000         WHEN SQLCODE = +100                                      06600012
066100              SET  PV-COMMODITY      TO  TRUE                     06610012
066200         WHEN OTHER                                               06620012
066300              MOVE '4077-CHECK-HANG-FOLD'                         06630012
066400                                     TO PV-ABEND-PARAGRAPH        06640012
066500              MOVE 'CHECK IF STR ZNE SETUP FOR HANG/FOLD'         06650012
066600                                     TO PV-ABEND-OPERATION        06660012
066700              STRING 'STORE ZONE CODE: ' DELIMITED BY SIZE        06670012
066800                     DK-STR-ZN-CDE       DELIMITED BY SIZE        06680012
066900                                   INTO PV-DB2-OPERATION-MESSAGE-106690012
067000              MOVE 'WST_INTGRTN_TYP' TO PV-DB2-TABLE-NAME-1       06700012
067100              MOVE 'WST_ATTR_DEFN'   TO PV-DB2-TABLE-NAME-2       06710012
067200              MOVE 'WST_ATTR_ELEM'   TO PV-DB2-TABLE-NAME-3       06720012
067300              PERFORM 9100-SQL-ABEND                              06730012
067400     END-EVALUATE.                                                06740012
067500                                                                  06750012
067600                                                                  06760012
067700*----------------------------------------------------------------*06770012
067800* CHECK TO SEE WHICH ZONE HAS MORE LINES.  THAT WILL BECOME THE  *06780012
067900* DEFAULT FOR THIS ORDER  --- COUNTS THE NUMBER OF HANG LINES    *06790012
068000*----------------------------------------------------------------*06800012
068100 4078-COUNT-HANG.                                                 06810012
068200                                                                  06820012
068210     INITIALIZE PV-HANG-COUNT.                                    06821028
068300     MOVE  SU110-ORD-NBR     TO  DK-PO-NBR.                       06830012
068400     MOVE  SU110-REC-SEQ-NBR TO  DK-REC-SEQ-NBR.                  06840012
068500                                                                  06850012
068600     EXEC SQL                                                     06860012
068700          SELECT COUNT(*)                                         06870012
068800            INTO :PV-HANG-COUNT                                   06880012
068900            FROM TRECITM A                                        06890012
069000                ,TPURITM B                                        06900012
069100                ,XLT_SKU C                                        06910012
069200                ,XLT_VND_STYL D                                   06920012
069300           WHERE A.ORD_NBR           = :DK-PO-NBR                 06930012
069400             AND A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR            06940012
069500             AND A.ORD_NBR           = B.PO_NBR                   06950012
069600             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           06960012
069700             AND A.VER_STATUS_CDE    = 'A'                        06970012
069800             AND A.PO_VER_NBR        = B.VER_NBR                  06980012
069900             AND B.ITM_NBR           = C.ITM_NBR                  06990012
070000             AND C.STYL_ID           = D.STYL_ID                  07000012
070100             AND D.HNG_FOLD_DESC     = 'HANG'                     07010012
070200     END-EXEC.                                                    07020012
070300                                                                  07030012
070400     EVALUATE TRUE                                                07040012
070500         WHEN SQLCODE = +0                                        07050012
070600              CONTINUE                                            07060027
070700         WHEN SQLCODE = +100                                      07070012
070800              MOVE ZERO              TO  PV-HANG-COUNT            07080012
070900         WHEN OTHER                                               07090012
071000              MOVE  DK-PO-NBR        TO PV-DISPLAY-PO-NBR         07100012
071100              MOVE  DK-REC-SEQ-NBR   TO PV-DISPLAY-RCVR-SEQ-NBR   07110012
071200              STRING PV-DISPLAY-PO-NBR '-'                        07120012
071300                     PV-DISPLAY-RCVR-SEQ-NBR                      07130012
071400                                  DELIMITED BY SIZE               07140012
071500                             INTO PV-DB2-OPERATION-MESSAGE-1      07150012
071600              MOVE '4078-COUNT-HANG     '                         07160012
071700                                     TO PV-ABEND-PARAGRAPH        07170012
071800              MOVE 'COUNT THE NUMBER OF LINE FOR HANG   '         07180012
071900                                     TO PV-ABEND-OPERATION        07190012
072000              MOVE 'TRECITM'         TO PV-DB2-TABLE-NAME-1       07200012
072100              MOVE 'TPURITM'         TO PV-DB2-TABLE-NAME-2       07210012
072200              MOVE 'XLT_SKU'         TO PV-DB2-TABLE-NAME-3       07220012
072300              MOVE 'XLT_VND_STYL'    TO PV-DB2-TABLE-NAME-4       07230012
072400              PERFORM 9100-SQL-ABEND                              07240012
072500     END-EVALUATE.                                                07250012
072600                                                                  07260012
072700                                                                  07270012
072800*----------------------------------------------------------------*07280012
072900* CHECK TO SEE WHICH ZONE HAS MORE LINES.  THAT WILL BECOME THE  *07290012
073000* DEFAULT FOR THIS ORDER  --- COUNTS THE NUMBER OF FOLD LINES    *07300012
073100*----------------------------------------------------------------*07310012
073200 4079-COUNT-FOLD.                                                 07320012
073300                                                                  07330012
073310     INITIALIZE PV-FOLD-COUNT.                                    07331028
073400     MOVE  SU110-ORD-NBR     TO  DK-PO-NBR.                       07340012
073500     MOVE  SU110-REC-SEQ-NBR TO  DK-REC-SEQ-NBR.                  07350012
073600                                                                  07360012
073700     EXEC SQL                                                     07370012
073800          SELECT COUNT(*)                                         07380012
073900            INTO :PV-FOLD-COUNT                                   07390012
074000            FROM TRECITM A                                        07400012
074100                ,TPURITM B                                        07410012
074200                ,XLT_SKU C                                        07420012
074300                ,XLT_VND_STYL D                                   07430012
074400           WHERE A.ORD_NBR           = :DK-PO-NBR                 07440012
074500             AND A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR            07450012
074600             AND A.ORD_NBR           = B.PO_NBR                   07460012
074700             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           07470012
074800             AND A.VER_STATUS_CDE    = 'A'                        07480012
074900             AND A.PO_VER_NBR        = B.VER_NBR                  07490012
075000             AND B.ITM_NBR           = C.ITM_NBR                  07500012
075100             AND C.STYL_ID           = D.STYL_ID                  07510012
075200             AND D.HNG_FOLD_DESC     = 'FOLD'                     07520012
075300     END-EXEC.                                                    07530012
075400                                                                  07540012
075500     EVALUATE TRUE                                                07550012
075600         WHEN SQLCODE = +0                                        07560012
075700              CONTINUE                                            07570030
075720                                                                  07572025
075800         WHEN SQLCODE = +100                                      07580012
075900              MOVE ZERO              TO  PV-FOLD-COUNT            07590012
076000         WHEN OTHER                                               07600012
076100              MOVE  DK-PO-NBR        TO PV-DISPLAY-PO-NBR         07610012
076200              MOVE  DK-REC-SEQ-NBR   TO PV-DISPLAY-RCVR-SEQ-NBR   07620012
076300              STRING PV-DISPLAY-PO-NBR '-'                        07630012
076400                     PV-DISPLAY-RCVR-SEQ-NBR                      07640012
076500                                  DELIMITED BY SIZE               07650012
076600                             INTO PV-DB2-OPERATION-MESSAGE-1      07660012
076700              MOVE '4079-COUNT-FOLD     '                         07670012
076800                                     TO PV-ABEND-PARAGRAPH        07680012
076900              MOVE 'COUNT THE NUMBER OF LINE FOR FOLD   '         07690012
077000                                     TO PV-ABEND-OPERATION        07700012
077100              MOVE 'TRECITM'         TO PV-DB2-TABLE-NAME-1       07710012
077200              MOVE 'TPURITM'         TO PV-DB2-TABLE-NAME-2       07720012
077300              MOVE 'XLT_SKU'         TO PV-DB2-TABLE-NAME-3       07730012
077400              MOVE 'XLT_VND_STYL'    TO PV-DB2-TABLE-NAME-4       07740012
077500              PERFORM 9100-SQL-ABEND                              07750012
077600                                                                  07760012
077700     END-EVALUATE.                                                07770012
077800                                                                  07780012
077900                                                                  07790012
078000*----------------------------------------------------------------*07800012
078100* CHECK TO SEE WHICH ZONE HAS MORE LINES.  THAT WILL BECOME THE  *07810012
078200* DEFAULT FOR THIS ORDER  --- COUNTS THE NUMBER OF <> HANG LINES *07820012
078300*----------------------------------------------------------------*07830012
078400 4080-COUNT-COMMODITY.                                            07840012
078500                                                                  07850012
078510     INITIALIZE PV-COMMODITY-COUNT.                               07851028
078600     MOVE  SU110-ORD-NBR     TO  DK-PO-NBR.                       07860012
078700     MOVE  SU110-REC-SEQ-NBR TO  DK-REC-SEQ-NBR.                  07870012
078800                                                                  07880012
078900     EXEC SQL                                                     07890012
079000          SELECT COUNT(*)                                         07900012
079100            INTO :PV-COMMODITY-COUNT                              07910012
079200            FROM TRECITM A                                        07920012
079300                ,TPURITM B                                        07930012
079400                ,XLT_SKU C                                        07940012
079500                ,XLT_VND_STYL D                                   07950012
079600           WHERE A.ORD_NBR           = :DK-PO-NBR                 07960012
079700             AND A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR            07970012
079800             AND A.ORD_NBR           = B.PO_NBR                   07980012
079900             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           07990012
080000             AND A.VER_STATUS_CDE    = 'A'                        08000012
080100             AND A.PO_VER_NBR        = B.VER_NBR                  08010012
080200             AND B.ITM_NBR           = C.ITM_NBR                  08020012
080300             AND C.STYL_ID           = D.STYL_ID                  08030012
080400             AND D.HNG_FOLD_DESC    <> 'HANG'                     08040012
080500     END-EXEC.                                                    08050012
080600                                                                  08060012
080700     EVALUATE TRUE                                                08070012
080800         WHEN SQLCODE = +0                                        08080012
080900              CONTINUE                                            08090012
081000         WHEN SQLCODE = +100                                      08100012
081100              MOVE ZERO              TO  PV-COMMODITY-COUNT       08110012
081200         WHEN OTHER                                               08120012
081300              MOVE  DK-PO-NBR        TO PV-DISPLAY-PO-NBR         08130012
081400              MOVE  DK-REC-SEQ-NBR   TO PV-DISPLAY-RCVR-SEQ-NBR   08140012
081500              STRING PV-DISPLAY-PO-NBR '-'                        08150012
081600                     PV-DISPLAY-RCVR-SEQ-NBR                      08160012
081700                                  DELIMITED BY SIZE               08170012
081800                             INTO PV-DB2-OPERATION-MESSAGE-1      08180012
081900              MOVE '4080-COUNT-COMMODITY'                         08190012
082000                                     TO PV-ABEND-PARAGRAPH        08200012
082100              MOVE 'COUNT THE NUMBER OF LINE FOR COMMODITY'       08210012
082200                                     TO PV-ABEND-OPERATION        08220012
082300              MOVE 'TRECITM'         TO PV-DB2-TABLE-NAME-1       08230012
082400              MOVE 'TPURITM'         TO PV-DB2-TABLE-NAME-2       08240012
082500              MOVE 'XLT_SKU'         TO PV-DB2-TABLE-NAME-3       08250012
082600              MOVE 'XLT_VND_STYL'    TO PV-DB2-TABLE-NAME-4       08260012
082700              PERFORM 9100-SQL-ABEND                              08270012
082800                                                                  08280012
082900     END-EVALUATE.                                                08290012
083000                                                                  08300012
083100                                                                  08310012
083200*----------------------------------------------------------------*08320012
083300* CHECK TO SEE HOW MANY LINES HAVE SOMETHING OTHER THAN HANG OR  *08330012
083400* FOLD                                                           *08340012
083500*----------------------------------------------------------------*08350012
083600 4081-COUNT-OTHER.                                                08360012
083700                                                                  08370012
083710     INITIALIZE PV-OTHER-COUNT.                                   08371028
083800     MOVE  SU110-ORD-NBR     TO  DK-PO-NBR.                       08380012
083900     MOVE  SU110-REC-SEQ-NBR TO  DK-REC-SEQ-NBR.                  08390012
084000                                                                  08400012
084100     EXEC SQL                                                     08410012
084200          SELECT COUNT(*)                                         08420012
084300            INTO :PV-OTHER-COUNT                                  08430012
084400            FROM TRECITM A                                        08440012
084500                ,TPURITM B                                        08450012
084600                ,XLT_SKU C                                        08460012
084700                ,XLT_VND_STYL D                                   08470012
084800           WHERE A.ORD_NBR            =  :DK-PO-NBR               08480012
084900             AND A.REC_SEQ_NBR        =  :DK-REC-SEQ-NBR          08490012
085000             AND A.ORD_NBR            =  B.PO_NBR                 08500012
085100             AND A.ORD_LNE_NBR        =  B.APP_PO_LNE_NBR         08510012
085200             AND A.VER_STATUS_CDE     =  'A'                      08520012
085300             AND A.PO_VER_NBR         =  B.VER_NBR                08530012
085400             AND B.ITM_NBR            =  C.ITM_NBR                08540012
085500             AND C.STYL_ID            =  D.STYL_ID                08550012
085600             AND NOT D.HNG_FOLD_DESC IN ('FOLD', 'HANG')          08560012
085700     END-EXEC.                                                    08570012
085800                                                                  08580012
085900     EVALUATE TRUE                                                08590012
086000         WHEN SQLCODE = +0                                        08600012
086100              CONTINUE                                            08610030
086130                                                                  08613025
086200         WHEN SQLCODE = +100                                      08620012
086300              MOVE ZERO              TO  PV-OTHER-COUNT           08630012
086400         WHEN OTHER                                               08640012
086500              MOVE  DK-PO-NBR        TO PV-DISPLAY-PO-NBR         08650012
086600              MOVE  DK-REC-SEQ-NBR   TO PV-DISPLAY-RCVR-SEQ-NBR   08660012
086700              STRING PV-DISPLAY-PO-NBR '-'                        08670012
086800                     PV-DISPLAY-RCVR-SEQ-NBR                      08680012
086900                                  DELIMITED BY SIZE               08690012
087000                             INTO PV-DB2-OPERATION-MESSAGE-1      08700012
087100              MOVE '4081-COUNT-OTHER'                             08710012
087200                                     TO PV-ABEND-PARAGRAPH        08720012
087300              MOVE 'COUNT THE NUMBER OF LINE NOT HANG OR FOLD'    08730012
087400                                     TO PV-ABEND-OPERATION        08740012
087500              MOVE 'TRECITM'         TO PV-DB2-TABLE-NAME-1       08750012
087600              MOVE 'TPURITM'         TO PV-DB2-TABLE-NAME-2       08760012
087700              MOVE 'XLT_SKU'         TO PV-DB2-TABLE-NAME-3       08770012
087800              MOVE 'XLT_VND_STYL'    TO PV-DB2-TABLE-NAME-4       08780012
087900              PERFORM 9100-SQL-ABEND                              08790012
088000                                                                  08800012
088100     END-EVALUATE.                                                08810012
088200                                                                  08820012
088300                                                                  08830012
088400*----------------------------------------------------------------*08840012
088500* CHECK TO SEE HOW MANY LINES HAVE SOMETHING OTHER THAN HANG OR  *08850012
088600* FOLD                                                           *08860012
088700*----------------------------------------------------------------*08870012
088800 4082-CHECK-GOH-IND.                                              08880012
088900                                                                  08890012
089000     INITIALIZE PV-HANGER-IND.                                    08900012
089100     MOVE  SU110-ORD-NBR     TO  DK-PO-NBR.                       08910012
089200     MOVE  SU110-REC-SEQ-NBR TO  DK-REC-SEQ-NBR.                  08920012
089300                                                                  08930012
089400     EXEC SQL                                                     08940012
089500          SELECT A.GOH_IND                                        08950012
089600            INTO :PV-HANGER-IND                                   08960012
089700            FROM TRECEIV A                                        08970012
089800           WHERE A.ORD_NBR            =  :DK-PO-NBR               08980012
089900             AND A.REC_SEQ_NBR        =  :DK-REC-SEQ-NBR          08990012
090000             AND A.VER_STATUS_CDE     =  'A'                      09000012
090100     END-EXEC.                                                    09010012
090200                                                                  09020012
090300     EVALUATE TRUE                                                09030012
090400         WHEN SQLCODE = +0                                        09040012
090500              CONTINUE                                            09050030
090600         WHEN SQLCODE = +100                                      09060012
090700              MOVE 'N'               TO PV-HANGER-IND             09070012
090800         WHEN OTHER                                               09080012
090900              MOVE  DK-PO-NBR        TO PV-DISPLAY-PO-NBR         09090012
091000              MOVE  DK-REC-SEQ-NBR   TO PV-DISPLAY-RCVR-SEQ-NBR   09100012
091100              STRING PV-DISPLAY-PO-NBR '-'                        09110012
091200                     PV-DISPLAY-RCVR-SEQ-NBR                      09120012
091300                                  DELIMITED BY SIZE               09130012
091400                                   INTO PV-DB2-OPERATION-MESSAGE-109140012
091500              MOVE '4082-CHECK-GOH-IND'                           09150012
091600                                     TO PV-ABEND-PARAGRAPH        09160012
091700              MOVE 'FETCH GARMENT ON HANGER INDICATOR'            09170012
091800                                     TO PV-ABEND-OPERATION        09180012
091900              MOVE 'TRECEIV'         TO PV-DB2-TABLE-NAME-1       09190012
092000              PERFORM 9100-SQL-ABEND                              09200012
092100                                                                  09210012
092200     END-EVALUATE.                                                09220012
092300                                                                  09230012
092400                                                                  09240012
092500 8000-READ-MIXED-TOT-EXT.                                         09250012
092600******************************************************************09260012
092700*  READ THE INPUT P2L MIXED TOTE DATA                             09270013
092800******************************************************************09280012
092910     READ SUT-MIXED-P2L-TOTE-EXT-IN INTO SU110-P2L-MIXED-TOTE-DTL 09291020
093000        AT END                                                    09300012
093100             SET PS-EOF-MIXED-TOT-EXT TO TRUE                     09310020
093110        NOT AT END                                                09311020
093120             ADD +1 TO PV-READ-COUNTER.                           09312020
093400                                                                  09340012
093500                                                                  09350012
093600 8100-WRITE-EXTRACT-FILE.                                         09360012
093700******************************************************************09370012
093800*  WRITE THE OUTPUT P2L MIXED TOTE EXTRACT RECORD                 09380012
093900******************************************************************09390012
094000                                                                  09400012
094100     WRITE SUT-MIXED-P2L-TOTE-OUT-REC                             09410012
094200        FROM SU111-P2L-MIXED-TOTE-DTL.                            09420012
094300                                                                  09430012
094400     ADD +1 TO PV-WRITE-COUNTER.                                  09440012
094500                                                                  09450012
094600                                                                  09460012
094700                                                                  09470012
094800 9000-EOJ-ROUTINE.                                                09480012
094900******************************************************************09490012
095000*  CLOSE OUTPUT FILE.  CLOSE THE CURSOR.                          09500012
095100******************************************************************09510012
095200     CLOSE SUT-MIXED-P2L-TOTE-EXT-IN                              09520012
095300           SUT-MIXED-P2L-TOTE-EXT-OUT.                            09530012
095400                                                                  09540012
095500     DISPLAY '*** SUKUT057 TOTALS ***'.                           09550012
095600     MOVE PV-READ-COUNTER  TO PV-DISPLAY-COUNT.                   09560012
095700     DISPLAY 'TOTAL RECORDS READ...: ' PV-DISPLAY-COUNT.          09570012
095800     MOVE PV-WRITE-COUNTER TO PV-DISPLAY-COUNT.                   09580012
095900     DISPLAY 'TOTAL RECORDS WRITTEN: ' PV-DISPLAY-COUNT.          09590012
096000                                                                  09600012
096100                                                                  09610012
096200******************************************************************09620012
096300*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    09630013
096400*  ERROR OR WARNING CODE OCCURS.                                  09640013
096500******************************************************************09650012
096600 9100-SQL-ABEND.                                                  09660012
096700     DISPLAY '9100-SQL-ABEND'.                                    09670012
096800     DISPLAY '**           **'.                                   09680012
096900     MOVE SQLCODE TO PV-SQLCODE.                                  09690012
097000     DISPLAY '** ABEND     **'.                                   09700012
097100     DISPLAY '*** DB2 ERROR '.                                    09710012
097200     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       09720012
097300     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 09730012
097400     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               09740012
097500     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               09750012
097600     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       09760012
097700     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       09770012
097800     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-3.       09780012
097900     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-4.       09790012
098000     DISPLAY '*** TABLE 1   = ' PV-DB2-TABLE-NAME-1.              09800012
098100     DISPLAY '*** TABLE 2   = ' PV-DB2-TABLE-NAME-2.              09810012
098200     DISPLAY '*** TABLE 3   = ' PV-DB2-TABLE-NAME-3.              09820012
098300     DISPLAY '*** TABLE 4   = ' PV-DB2-TABLE-NAME-4.              09830012
098400                                                                  09840012
098500*    ABEND COPYBOOK                                               09850012
098600     COPY DPPD004.                                                09860012
098700                                                                  09870012
098800     MOVE +4013 TO PV-ABEND-CODE.                                 09880012
098900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         09890012
099000                                                                  09900012
099100/                                                                 09910012
