000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.         SVKRP024.                                    00020000
000300 AUTHOR.             KARI SUTTON.                                 00030000
000400 INSTALLATION.       KOHLS DEPARTMENT STORES.                     00040000
000500 DATE-WRITTEN.       JULY 1996.                                   00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800******************************************************************00080000
000900* THIS PROGRAM PRODUCES A REPORT FROM THE AUDIT FILE CREATED     *00090000
001000* DURING THE COMPARISON BETWEEN THE POS DAILY SALES FILE AND THE *00100000
001100* ACTIVITY FROM THE KMC ACTIVITY TABLE IN PROGRAM SVKUT029.      *00110000
001200******************************************************************00120000
001210*----------------------------------------------------------------*00130000
001211*  11/17/2009  IF THE TRN-STAT-CDE = 'L' I MOVED IT TO THE REPORT*00140000
001212*  ALSO ADDED THE LATE COLUMN ON THE REPORT.                     *00150000
001213*  MADE BY: BARB SCHULTZ                WR#: WR37510             *00160000
001240******************************************************************00170000
001211*  10/10/2014  ADDED THE OMNI-CHNL-FFLMT-CDE TO THE REPORT.      *00171001
001213*  MADE BY: BARB SCHULTZ                WR#: CHG0094005          *00173001
001240******************************************************************00175004
P10237*  07/08/2015  CHANGES TO ACCOMMODATE THE ENCRYPTED DL# IN INPUT *00176005
P10237*              FILE AND TO REMOVE THE DRIVER LICENSE FIELD IN    *00176105
P10237*              THE REPORT.                                       *00176205
P10237*  MADE BY: COGNIZANT                   WR#: CHG0104429          *00177004
001240******************************************************************00178004
P12431*  08/28/2018  MODIFIED THE PROGRAM TO HANDLE NEWLY ADDED        *00179007
P12431*              ORD_NBR FIELD IN THE SVT TABLES.                  *00179107
P12431*  MADE BY: COGNIZANT                   WR#: CHG0208643          *00179308
001240******************************************************************00179407
001300 ENVIRONMENT DIVISION.                                            00180000
001400******************************************************************00190000
001500 CONFIGURATION SECTION.                                           00200000
001600                                                                  00210000
001700 SOURCE-COMPUTER.    IBM-3090.                                    00220000
001800 OBJECT-COMPUTER.    IBM-3090.                                    00230000
001900                                                                  00240000
002000 INPUT-OUTPUT SECTION.                                            00250000
002100                                                                  00260000
002200 FILE-CONTROL.                                                    00270000
002300                                                                  00280000
002400     SELECT AUDIT-REPORT-FILE         ASSIGN TO INP01.            00290000
002500     SELECT CONTROL-DATE-FILE         ASSIGN TO INP02.            00300000
002600     SELECT TOTAL-FILE                ASSIGN TO INP03.            00310000
002700     SELECT KMRC-REPORT-FILE          ASSIGN TO RPT01.            00320000
002800     SELECT GIFT-REPORT-FILE          ASSIGN TO RPT02.            00330000
002900     SELECT KMRC-PREV-RPT             ASSIGN TO RPT03.            00340000
003000     SELECT GIFT-PREV-RPT             ASSIGN TO RPT04.            00350000
003100                                                                  00360000
003200******************************************************************00370000
003300 DATA DIVISION.                                                   00380000
003400******************************************************************00390000
003500                                                                  00400000
003600 FILE SECTION.                                                    00410000
003700                                                                  00420000
003800 FD  AUDIT-REPORT-FILE                                            00430000
003900     RECORDING MODE IS F                                          00440000
004000     BLOCK CONTAINS 0 RECORDS                                     00450000
004100     LABEL RECORDS ARE OMITTED.                                   00460000
004200                                                                  00470000
P12431 01  AUDIT-REPORT-RECORD              PIC X(198).                 00480007
004400                                                                  00490000
004500 FD  CONTROL-DATE-FILE                                            00500000
004600     RECORDING MODE IS F                                          00510000
004700     BLOCK CONTAINS 0 RECORDS                                     00520000
004800     LABEL RECORDS ARE OMITTED.                                   00530000
004900                                                                  00540000
005000 01  CONTROL-DATE-RECORD              PIC X(80).                  00550000
005100                                                                  00560000
005200 FD  TOTAL-FILE                                                   00570000
005300     RECORDING MODE IS F                                          00580000
005400     BLOCK CONTAINS 0 RECORDS                                     00590000
005500     LABEL RECORDS ARE OMITTED.                                   00600000
005600                                                                  00610000
005700 01  TOTAL-RECORD                     PIC X(312).                 00620000
005800                                                                  00630000
005900 FD  KMRC-REPORT-FILE                                             00640000
006000     RECORDING MODE IS F                                          00650000
006100     BLOCK CONTAINS 0 RECORDS                                     00660000
006200     LABEL RECORDS ARE OMITTED.                                   00670000
006300                                                                  00680000
006400 01  KMRC-REPORT-RECORD               PIC X(200).                 00690000
006500                                                                  00700000
006600 FD  GIFT-REPORT-FILE                                             00710000
006700     RECORDING MODE IS F                                          00720000
006800     BLOCK CONTAINS 0 RECORDS                                     00730000
006900     LABEL RECORDS ARE OMITTED.                                   00740000
007000                                                                  00750000
007100 01  GIFT-REPORT-RECORD               PIC X(200).                 00760000
007200                                                                  00770000
007300 FD  KMRC-PREV-RPT                                                00780000
007400     RECORDING MODE IS F                                          00790000
007500     BLOCK CONTAINS 0 RECORDS                                     00800000
007600     LABEL RECORDS ARE OMITTED.                                   00810000
007700                                                                  00820000
007800 01  KMRC-PREV-RECORD                 PIC X(200).                 00830000
007900                                                                  00840000
008000 FD  GIFT-PREV-RPT                                                00850000
008100     RECORDING MODE IS F                                          00860000
008200     BLOCK CONTAINS 0 RECORDS                                     00870000
008300     LABEL RECORDS ARE OMITTED.                                   00880000
008400                                                                  00890000
008500 01  GIFT-PREV-RECORD                 PIC X(200).                 00900000
008600                                                                  00910000
008700 WORKING-STORAGE SECTION.                                         00920000
008800                                                                  00930000
008900 01  ABEND-CODE                       PIC S9(04)    VALUE +0 COMP.00940000
009000                                                                  00950000
009100******************************************************************00960000
009200*    CR-CONTROL RECORD                                           *00970000
009300******************************************************************00980000
009400 01  CR-CONTROL-RECORD.                                           00990000
009500     05  CR-CONTROL-DATE              PIC  X(10)    VALUE SPACES. 01000000
009600     05  CR-ECOMM-IND                 PIC  X        VALUE SPACES. 01010000
009700         88  CR-ECOMM                               VALUE 'E'.    01020000
009800     05  FILLER                       PIC  X(69)    VALUE SPACES. 01030000
009900                                                                  01040000
010000******************************************************************01050000
010100*    PC-PROGRAM CONSTANTS                                        *01060000
010200******************************************************************01070000
010300 01  PC-PROGRAM-CONSTANTS.                                        01080000
010400     05  PC-PROGRAM-NAME             PIC  X(08) VALUE 'SVKRP024'. 01090000
010500     05  PC-ONE                      PIC  9(01) VALUE 1.          01100000
010600     05  PC-TWO                      PIC  9(01) VALUE 2.          01110000
010700     05  PC-THREE                    PIC  9(01) VALUE 3.          01120000
010800     05  PC-FOUR                     PIC  9(01) VALUE 4.          01130000
010900     05  PC-Y                        PIC  X(01) VALUE 'Y'.        01140000
011000     05  PC-HEADER-LINE-COUNT        PIC S9(03) VALUE +10         01150000
011100                                                COMP.             01160000
011200     05  PC-MAX-LINES-PER-PAGE       PIC S9(03) VALUE +72         01170000
011300                                                COMP.             01180000
011400     05  PC-PEPLSOFT                 PIC  X(08) VALUE 'PSFTFIRB'. 01190000
011500     05  PC-STORE-090                PIC  9(04) VALUE 0090.       01200000
011600     05  PC-STORE-873                PIC  9(04) VALUE 0873.       01210000
011700     05  PC-STORE-880                PIC  9(04) VALUE 0880.       01220000
011800                                                                  01230000
011900******************************************************************01240000
012000*    RESPROGRAM VARIABLES                                        *01250000
012100******************************************************************01260000
012200 01  PV-PROGRAM-VARIABLES.                                        01270000
012300     05  PV-PARAGRAPH-NAME            PIC  X(30)     VALUE SPACES.01280000
012400     05  PV-DB2-OPERATION-ATTEMPTED   PIC  X(30)     VALUE SPACES.01290000
012500                                                                  01300000
012600     05  PV-CURRENT-DATE.                                         01310000
012700         10  PV-CURRENT-YEAR         PIC  9(02) VALUE ZERO.       01320000
012800         10  PV-CURRENT-MONTH        PIC  9(02) VALUE ZERO.       01330000
012900         10  PV-CURRENT-DAY          PIC  9(02) VALUE ZERO.       01340000
013000     05  PV-CURRENT-TIME.                                         01350000
013100         10  PV-CURRENT-HOUR         PIC  9(02) VALUE ZERO.       01360000
013200         10  PV-CURRENT-MINUTE       PIC  9(02) VALUE ZERO.       01370000
013300         10  FILLER                  PIC  9(04) VALUE ZERO.       01380000
013400     05  PV-RPT-POSTING-DATE.                                     01390000
013500         10  PV-RPT-POST-DATE-CC     PIC  X(02) VALUE SPACES.     01400000
013600         10  PV-RPT-POST-DATE-YY     PIC  X(02) VALUE SPACES.     01410000
013700         10  FILLER                  PIC  X(01) VALUE SPACE.      01420000
013800         10  PV-RPT-POST-DATE-MM     PIC  X(02) VALUE SPACES.     01430000
013900         10  FILLER                  PIC  X(01) VALUE SPACE.      01440000
014000         10  PV-RPT-POST-DATE-DD     PIC  X(02) VALUE SPACES.     01450000
014100                                                                  01460000
014200     05  PV-HDR-POSTING-DATE.                                     01470000
014300         10  PV-HDR-POST-DATE-MM     PIC  X(02) VALUE SPACES.     01480000
014400         10  FILLER                  PIC  X(01) VALUE '/'.        01490000
014500         10  PV-HDR-POST-DATE-DD     PIC  X(02) VALUE SPACES.     01500000
014600         10  FILLER                  PIC  X(01) VALUE '/'.        01510000
014700         10  PV-HDR-POST-DATE-CC     PIC  X(02) VALUE SPACES.     01520000
014800         10  PV-HDR-POST-DATE-YY     PIC  X(02) VALUE SPACES.     01530000
014900                                                                  01540000
015000     05  PV-HOLD-STORE-NBR           PIC  9(04) VALUE ZERO.       01550000
015100     05  PV-HOLD-POS-DATE            PIC  X(10) VALUE SPACE.      01560000
015200     05  PV-HOLD-CRD-TYP-CDE         PIC S9(01) COMP-3            01570000
015300                                                VALUE +0.         01580000
015400                                                                  01590000
015500     05  PV-POS-DATE.                                             01600000
015600         10  PV-POS-DATE-CC          PIC  X(02) VALUE SPACE.      01610000
015700         10  PV-POS-DATE-YY          PIC  X(02) VALUE SPACE.      01620000
015800         10  FILLER                  PIC  X(01) VALUE SPACE.      01630000
015900         10  PV-POS-DATE-MM          PIC  X(02) VALUE SPACE.      01640000
016000         10  FILLER                  PIC  X(01) VALUE SPACE.      01650000
016100         10  PV-POS-DATE-DD          PIC  X(02) VALUE SPACE.      01660000
016200                                                                  01670000
016700     05  PV-DAILY-STORE-TOTAL-I      PIC S9(08)V9(02)             01720000
016800                                                     VALUE ZEROES 01730000
016900                                                     COMP-3.      01740000
017000     05  PV-DAILY-STORE-TOTAL-T      PIC S9(08)V9(02)             01750000
017100                                                     VALUE ZEROES 01760000
017200                                                     COMP-3.      01770000
017300     05  PV-DAILY-POS-DOLLARS-ISSUED PIC S9(09)V9(02)             01780000
017400                                                     VALUE ZEROES 01790000
017500                                                     COMP-3.      01800000
017600                                                                  01810000
017700******************************************************************01820000
017800*    PS-PROGRAM SWITCHES                                         *01830000
017900******************************************************************01840000
018000 01  PS-PROGRAM-SWITCHES.                                         01850000
018100     05  PS-END-OF-AUDIT-FILE-SW        PIC  X(01)   VALUE 'N'.   01860000
018200         88  PS-END-OF-AUDIT-FILE                    VALUE 'Y'.   01870000
018300     05  PS-END-OF-CONTROL-FILE-SW      PIC  X(01)   VALUE 'N'.   01880000
018400         88  PS-END-OF-CONTROL-FILE                  VALUE 'Y'.   01890000
018500                                                                  01900000
018600     05  PS-END-OF-TOTAL-FILE-SW        PIC  X(01)   VALUE 'N'.   01910000
018700         88  PS-END-OF-TOTAL-FILE                    VALUE 'Y'.   01920000
018800                                                                  01930000
018900     05  PS-EMPTY-AUDIT-FILE-SW         PIC  X(01)   VALUE 'N'.   01940000
019000         88  PS-EMPTY-AUDIT                          VALUE 'Y'.   01950000
019100         88  PS-AUDIT-NOT-EMPTY                      VALUE 'N'.   01960000
019200                                                                  01970000
019300     05  PS-EMPTY-KMRC-FILE-SW          PIC  X(01)   VALUE 'Y'.   01980000
019400         88  PS-EMPTY-KMRC                           VALUE 'Y'.   01990000
019500         88  PS-KMRC-NOT-EMPTY                       VALUE 'N'.   02000000
019600                                                                  02010000
019700     05  PS-EMPTY-GIFT-FILE-SW          PIC  X(01)   VALUE 'Y'.   02020000
019800         88  PS-EMPTY-GIFT                           VALUE 'Y'.   02030000
019900         88  PS-GIFT-NOT-EMPTY                       VALUE 'N'.   02040000
020000                                                                  02050000
020100******************************************************************02060000
020200*    PA-PROGRAM ACCUMULATORS                                     *02070000
020300******************************************************************02080000
020400 01  PA-PROGRAM-ACCUMULATORS.                                     02090000
020500     05  PA-AUDIT-FILE-RECS-READ        PIC S9(11)   COMP-3       02100000
020600                                                     VALUE ZEROES.02110000
020700     05  PA-KMRC-REPORT-RECORDS-WRITTEN PIC S9(11)   COMP-3       02120000
020800                                                     VALUE ZEROES.02130000
020900     05  PA-GIFT-REPORT-RECORDS-WRITTEN PIC S9(11)   COMP-3       02140000
021000                                                     VALUE ZEROES.02150000
021100     05  PA-LINE-COUNTER                PIC S9(11)   COMP-3       02160000
021200                                                     VALUE +75.   02170000
021300     05  PA-P-LINE-COUNTER              PIC S9(11)   COMP-3       02180000
021400                                                     VALUE +75.   02190000
021500     05  PA-PAGE-COUNTER                PIC S9(11)   COMP-3       02200000
021600                                                     VALUE ZEROES.02210000
021700     05  PA-P-PAGE-COUNTER              PIC S9(11)   COMP-3       02220000
021800                                                     VALUE ZEROES.02230000
021900                                                                  02240000
022000******************************************************************02250000
022100*    KOHLS MERCHANDISE CARD CONSTANTS                            *02260000
022200******************************************************************02270000
022300     COPY SVWS004.                                                02280000
022400                                                                  02290000
022500******************************************************************02300000
022600*    KMC AUDIT REPORT RECORD LAYOUT                              *02310000
022700******************************************************************02320000
022800     COPY SVRD019.                                                02330000
022900                                                                  02340000
023000******************************************************************02350000
023100*    TOTAL LAYOUT                                                *02360000
023200******************************************************************02370000
023300     COPY SVRD043.                                                02380000
023400                                                                  02390000
023500******************************************************************02400000
023600*    STANDARD HEADER FOR 200 COLUMN REPORT                       *02410000
023700******************************************************************02420000
023800     COPY DPWS200O.                                               02430000
023900                                                                  02440000
024000 01  REPORT-AUDIT-TITLE-LINE.                                     02450000
024100     05  FILLER                         PIC  X(74)   VALUE SPACES.02460000
024200     05  TL-HEADING                     PIC  X(52)   VALUE SPACES.02470000
024300     05  FILLER                         PIC  X(74)   VALUE SPACES.02480000
024400                                                                  02490000
024500 01  REPORT-CONSTANTS.                                            02500000
024600     05  RC-KMRC-TITLE-LINE.                                      02510000
024700         10  FILLER                     PIC  X(24)   VALUE        02520000
024800         '  KMRC AUDIT REPORT FOR '.                              02530000
024900         10  RC-KMRC-DATE               PIC  X(10).               02540000
025000         10  RC-KMRC-PREV               PIC  X(15).               02550000
025100             88  RC-KMRC-CURR-DATE   VALUE SPACES.                02560000
025200             88  RC-KMRC-PREV-DATE   VALUE  ' PREVIOUS DATES'.    02570000
025300     05  RC-GIFT-TITLE-LINE.                                      02580000
025400         10  FILLER                     PIC  X(27)   VALUE        02590000
025500         'GIFT CARD AUDIT REPORT FOR '.                           02600000
025600         10  RC-GIFT-DATE               PIC  X(10).               02610000
025700         10  RC-GIFT-PREV               PIC  X(15).               02620000
025800             88  RC-GIFT-CURR-DATE   VALUE SPACES.                02630000
025900             88  RC-GIFT-PREV-DATE   VALUE  ' PREVIOUS DATES'.    02640000
026000                                                                  02650000
026100 01  REPORT-AUDIT-STORE-LINE.                                     02660000
026200     05  FILLER                         PIC  X(07)   VALUE SPACES.02670000
026300     05  FILLER                         PIC  X(06)   VALUE        02680000
026400         'STORE:'.                                                02690000
026500     05  FILLER                         PIC  X(02)   VALUE SPACES.02700000
026600     05  RPT-AUDIT-STORE-NBR            PIC  X(04).               02710000
026700     05  FILLER                         PIC  X(06)   VALUE SPACES.02720000
026800     05  FILLER                         PIC  X(09)   VALUE        02730000
026900         'POS DATE:'.                                             02740000
027000     05  FILLER                         PIC  X(02)   VALUE SPACES.02750000
027100     05  RPT-AUDIT-POS-DATE-MM          PIC  X(02).               02760000
027200     05  FILLER                         PIC  X(01)   VALUE '/'.   02770000
027300     05  RPT-AUDIT-POS-DATE-DD          PIC  X(02).               02780000
027400     05  FILLER                         PIC  X(01)   VALUE '/'.   02790000
027500     05  RPT-AUDIT-POS-DATE-CC          PIC  X(02).               02800000
027600     05  RPT-AUDIT-POS-DATE-YY          PIC  X(02).               02810000
027700     05  FILLER                         PIC  X(154)  VALUE SPACES.02820000
027800                                                                  02830000
027900 01  REPORT-AUDIT-HEADING-LINE1.                                  02840000
028000     05  FILLER                         PIC  X(01)   VALUE SPACES.02850000
031600     05  FILLER                         PIC  X(04)   VALUE        02851000
031800         'OMNI'.                                                  02852000
P10237     05  FILLER                         PIC  X(35)   VALUE SPACES.02853004
028100     05  FILLER                         PIC  X(01)   VALUE        02860000
028200         'V'.                                                     02870000
028300     05  FILLER                         PIC  X(01)   VALUE SPACES.02880000
028310     05  FILLER                         PIC  X(01)   VALUE        02890000
028320         'L'.                                                     02900000
028330     05  FILLER                         PIC  X(01)   VALUE SPACES.02910000
028400     05  FILLER                         PIC  X(01)   VALUE        02920000
028500         'R'.                                                     02930000
P10237     05  FILLER                         PIC  X(154)  VALUE SPACES.02940004
028700                                                                  02950000
028800 01  REPORT-AUDIT-HEADING-LINE2.                                  02960000
028000     05  FILLER                         PIC  X(01)   VALUE SPACES.02971000
031600     05  FILLER                         PIC  X(04)   VALUE        02972000
031800         'CHNL'.                                                  02973000
P10237     05  FILLER                         PIC  X(35)   VALUE SPACES.02974004
029000     05  FILLER                         PIC  X(01)   VALUE        02980000
029100         'O'.                                                     02990000
029200     05  FILLER                         PIC  X(01)   VALUE SPACES.03000000
029210     05  FILLER                         PIC  X(01)   VALUE        03010000
029220         'A'.                                                     03020000
029230     05  FILLER                         PIC  X(01)   VALUE SPACES.03030000
029300     05  FILLER                         PIC  X(01)   VALUE        03040000
029400         'V'.                                                     03050000
P10237     05  FILLER                         PIC  X(154)  VALUE SPACES.03060004
029600                                                                  03070000
029700 01  REPORT-AUDIT-HEADING-LINE3.                                  03080000
028000     05  FILLER                         PIC  X(01)   VALUE SPACES.03091000
031600     05  FILLER                         PIC  X(05)   VALUE        03092000
031800         'FFLMT'.                                                 03093000
P10237     05  FILLER                         PIC  X(34)   VALUE SPACES.03094004
029900     05  FILLER                         PIC  X(01)   VALUE        03100000
030000         'I'.                                                     03110000
030100     05  FILLER                         PIC  X(01)   VALUE SPACES.03120000
030110     05  FILLER                         PIC  X(01)   VALUE        03130000
030120         'T'.                                                     03140000
030130     05  FILLER                         PIC  X(01)   VALUE SPACES.03150000
030200     05  FILLER                         PIC  X(01)   VALUE        03160000
030300         'R'.                                                     03170000
030400     05  FILLER                         PIC  X(03)   VALUE SPACES.03180000
030500     05  FILLER                         PIC  X(04)   VALUE        03190000
030600         'TRAN'.                                                  03200000
030700     05  FILLER                         PIC  X(04)   VALUE SPACES.03210000
030800     05  FILLER                         PIC  X(09)   VALUE        03220000
030900         'APPROVED '.                                             03230000
031000     05  FILLER                         PIC  X(04)   VALUE SPACES.03240000
031100     05  FILLER                         PIC  X(08)   VALUE        03250000
031200         'ORIGINAL'.                                              03260000
P10237     05  FILLER                         PIC  X(121)  VALUE SPACES.03270004
031400                                                                  03280000
031500 01  REPORT-AUDIT-HEADING-LINE4.                                  03290000
031600     05  FILLER                         PIC  X(01)   VALUE SPACES.03300000
031600     05  FILLER                         PIC  X(04)   VALUE        03301000
031800         'CODE'.                                                  03302000
031600     05  FILLER                         PIC  X(02)   VALUE SPACES.03303000
031700     05  FILLER                         PIC  X(04)   VALUE        03310000
031800         'TERM'.                                                  03320000
031900     05  FILLER                         PIC  X(02)   VALUE SPACES.03330000
032000     05  FILLER                         PIC  X(04)   VALUE        03340000
032100         'TRAN'.                                                  03350000
032200     05  FILLER                         PIC  X(04)   VALUE SPACES.03360000
032300     05  FILLER                         PIC  X(07)   VALUE        03370000
032400         'CARD ID'.                                               03380000
032500     05  FILLER                         PIC  X(04)   VALUE SPACES.03390000
032600     05  FILLER                         PIC  X(04)   VALUE        03400000
032700         'TYPE'.                                                  03410000
032800     05  FILLER                         PIC  X(04)   VALUE SPACES.03420000
033200     05  FILLER                         PIC  X(01)   VALUE        03460000
033300         'D'.                                                     03470000
033400     05  FILLER                         PIC  X(01)   VALUE SPACES.03480000
033410     05  FILLER                         PIC  X(01)   VALUE        03490000
033420         'E'.                                                     03500000
033430     05  FILLER                         PIC  X(01)   VALUE SPACES.03510000
033500     05  FILLER                         PIC  X(01)   VALUE        03520000
033600         'S'.                                                     03530000
033700     05  FILLER                         PIC  X(03)   VALUE SPACES.03540000
033800     05  FILLER                         PIC  X(04)   VALUE        03550000
033900         'TYPE'.                                                  03560000
034000     05  FILLER                         PIC  X(04)   VALUE SPACES.03570000
034100     05  FILLER                         PIC  X(09)   VALUE        03580000
034200         'TRANS AMT'.                                             03590000
034300     05  FILLER                         PIC  X(04)   VALUE SPACES.03600000
034400     05  FILLER                         PIC  X(08)   VALUE        03610000
034500         'AUTH AMT'.                                              03620000
034600     05  FILLER                         PIC  X(05)   VALUE SPACES.03630000
034700     05  FILLER                         PIC  X(11)   VALUE        03640000
034800         'OPERATOR ID'.                                           03650000
034900     05  FILLER                         PIC  X(04)   VALUE SPACES.03660000
035000     05  FILLER                         PIC  X(07)   VALUE        03670000
035100         'USER ID'.                                               03680000
035200     05  FILLER                         PIC  X(05)   VALUE SPACES.03690000
035300     05  FILLER                         PIC  X(13)   VALUE        03700000
035400         'ERROR MESSAGE'.                                         03710000
035500     05  FILLER                         PIC  X(22)   VALUE SPACES.03720000
035600     05  FILLER                         PIC  X(14)   VALUE        03730000
035700         'ACTION TO TAKE'.                                        03740000
P10237     05  FILLER                         PIC  X(40)   VALUE SPACES.03750004
035900                                                                  03760000
036000 01  REPORT-AUDIT-DETAIL-LINE.                                    03770000
036100     05  FILLER                         PIC  X(02)   VALUE SPACES.03780000
036100     05  RPT-AUDIT-FFLMT-CODE           PIC  X(03)   VALUE SPACES.03781000
036100     05  FILLER                         PIC  X(02)   VALUE SPACES.03782000
036200     05  RPT-AUDIT-TERMINAL-NBR         PIC  9(04).               03790000
036300     05  FILLER                         PIC  X(02)   VALUE SPACES.03800000
036400     05  RPT-AUDIT-TRANSACTION-NBR      PIC  9(04).               03810000
036500     05  FILLER                         PIC  X(01)   VALUE SPACES.03820000
036600     05  RPT-AUDIT-KMC-CARD-NBR         PIC  ZZ9(10).             03830000
036700     05  FILLER                         PIC  X(01)   VALUE SPACES.03840000
036800     05  RPT-AUDIT-CARD-TYPE            PIC  X(08)   VALUE SPACES.03850000
036900     05  FILLER                         PIC  X(01)   VALUE SPACES.03860000
037200     05  RPT-AUDIT-VOID-IND             PIC  X(01).               03890000
037300     05  FILLER                         PIC  X(01)   VALUE SPACES.03900000
037310     05  RPT-AUDIT-LATE-IND             PIC  X(02).               03910000
037320*    05  FILLER                         PIC  X(01)   VALUE SPACES.03920000
037400     05  RPT-AUDIT-RVRSL-IND            PIC  9(01).               03930000
037500     05  FILLER                         PIC  X(01)   VALUE SPACES.03940000
037600     05  RPT-AUDIT-TRANS-TYPE           PIC  X(07).               03950000
037700     05  FILLER                         PIC  X(03)   VALUE SPACES.03960000
037800     05  RPT-AUDIT-APPROVED-TRANS-AMT   PIC  Z,ZZ9.99-.           03970000
037900     05  FILLER                         PIC  X(04)   VALUE SPACES.03980000
038000     05  RPT-AUDIT-ORIGINAL-AUTH-AMT    PIC  Z,ZZ9.99-.           03990000
038100     05  FILLER                         PIC  X(04)   VALUE SPACES.04000000
038200     05  RPT-AUDIT-OPERATOR-ID          PIC  X(11).               04010000
038300     05  RPT-AUDIT-OPERATOR-ID-N REDEFINES RPT-AUDIT-OPERATOR-ID  04020000
038400                                        PIC  9(11).               04030000
038500     05  FILLER                         PIC  X(04)   VALUE SPACES.04040000
038600     05  RPT-AUDIT-USER-ID              PIC  X(08).               04050000
038700     05  FILLER                         PIC  X(04)   VALUE SPACES.04060000
038800     05  RPT-AUDIT-ERROR-MESSAGE        PIC  X(31).               04070000
038900     05  FILLER                         PIC  X(04)   VALUE SPACES.04080000
039000     05  RPT-AUDIT-ACTION-MESSAGE       PIC  X(26).               04090000
P10237     05  FILLER                         PIC  X(28)   VALUE SPACES.04100004
039200                                                                  04110000
039300 01  REPORT-AUDIT-STORE-TOTAL-LINE.                               04120000
039400     05  FILLER                         PIC  X(14)   VALUE SPACES.04130000
039500     05  FILLER                         PIC  X(25)   VALUE        04140000
039600         '***    DOLLARS FOR STORE '.                             04150000
039700     05  RPT-AUDIT-STORE-TOTAL-NBR      PIC  ZZZ9.                04160000
039800     05  FILLER                         PIC  X(08)   VALUE SPACES.04170000
039900     05  FILLER                         PIC  X(08)                04180000
040000                                        VALUE 'ISSUED: '.         04190000
040100     05  RPT-AUDIT-STORE-TOTAL-AMT-I    PIC  ZZ,ZZZ,ZZ9.99-.      04200000
040200     05  FILLER                         PIC  X(10)   VALUE SPACES.04210000
040300     05  FILLER                         PIC  X(10)                04220000
040400                                        VALUE 'TENDERED: '.       04230000
040500     05  RPT-AUDIT-STORE-TOTAL-AMT-T    PIC  ZZ,ZZZ,ZZ9.99-.      04240000
040600     05  FILLER                         PIC  X(102)  VALUE SPACES.04250000
040700                                                                  04260000
040800 01  REPORT-AUDIT-POS-ISSUED-LINE.                                04270000
040900     05  FILLER                         PIC  X(77)   VALUE SPACES.04280000
041000     05  FILLER                         PIC  X(28)   VALUE SPACES.04290000
041100     05  FILLER                         PIC  X(14)   VALUE SPACES.04300000
041200     05  FILLER                         PIC  X(04)   VALUE SPACES.04310000
041300     05  RPT-ON-LINE-POS-DOLLARS-ISSUED PIC  ZZZ,ZZZ,ZZ9.99-.     04320000
041400     05  FILLER                         PIC  X(42)   VALUE        04330000
041500     ' OF TOTAL WAS POS ISS BY THE ONLINE SYSTEM'.                04340000
041600     05  FILLER                         PIC  X(22)   VALUE SPACES.04350000
041700                                                                  04360000
041800 01  REPORT-AUDIT-POS-VERIFIED-LINE.                              04370000
041900     05  FILLER                         PIC  X(02)   VALUE SPACES.04380000
042000     05  FILLER                         PIC  X(25)   VALUE        04390000
042100         'TOTAL VERIFIED ISSUED '.                                04400000
042200     05  RPT-AUDIT-POS-DOLLARS-ISSUED   PIC ZZZ,ZZZ,ZZ9.99-.      04410000
042300     05  FILLER                         PIC  X(05)   VALUE SPACES.04420000
042400     05  FILLER                         PIC  X(26)   VALUE        04430000
042500         'TOTAL VERIFIED TENDERED  '.                             04440000
042600     05  RPT-AUDIT-POS-DOLLARS-TENDERED PIC ZZZ,ZZZ,ZZ9.99-.      04450000
042700     05  FILLER                         PIC  X(05)   VALUE SPACES.04460000
042800                                                                  04470000
042900 01  REPORT-AUDIT-POS-AUTHOR-LINE.                                04480000
043000     05  FILLER                         PIC  X(02)   VALUE SPACES.04490000
043100     05  FILLER                         PIC  X(25)   VALUE        04500000
043200         'TOTAL AUTHORIZED ISSUED '.                              04510000
043300     05  RPT-AUDIT-POS-AUTH-ISSUE       PIC ZZZ,ZZZ,ZZ9.99-.      04520000
043400     05  FILLER                         PIC  X(05)   VALUE SPACES.04530000
043500     05  FILLER                         PIC  X(26)   VALUE        04540000
043600         'TOTAL AUTHORIZED TENDERED '.                            04550000
043700     05  RPT-AUDIT-POS-AUTH-TENDER      PIC ZZZ,ZZZ,ZZ9.99-.      04560000
043800     05  FILLER                         PIC  X(05)   VALUE SPACES.04570000
043900                                                                  04580000
044000 01  REPORT-AUDIT-POS-COMPANY-LINE.                               04590000
044100     05  FILLER                         PIC  X(02)   VALUE SPACES.04600000
044200     05  FILLER                         PIC  X(25)   VALUE        04610000
044300         'TOTAL COMPANY ISSUED    '.                              04620000
044400     05  RPT-AUDIT-POS-COMP-ISSUE       PIC ZZZ,ZZZ,ZZ9.99-.      04630000
044500     05  FILLER                         PIC  X(05)   VALUE SPACES.04640000
044600     05  FILLER                         PIC  X(26)   VALUE        04650000
044700         'TOTAL COMPANY TENDERED    '.                            04660000
044800     05  RPT-AUDIT-POS-COMP-TENDER      PIC ZZZ,ZZZ,ZZ9.99-.      04670000
044900     05  FILLER                         PIC  X(05)   VALUE SPACES.04680000
045000                                                                  04690000
045100 01  REPORT-TOTALS.                                               04700000
045200     05  FILLER                         PIC  X(48)   VALUE SPACES.04710000
045300     05  FILLER                         PIC  X(22)   VALUE        04720000
045400         '$ ISSUED    &    COUNT'.                                04730000
045500     05  FILLER                         PIC  X(09)   VALUE SPACES.04740000
045600     05  FILLER                         PIC  X(23)   VALUE        04750000
045700         'VOIDED $ ISSUED & COUNT'.                               04760000
045800     05  FILLER                         PIC  X(09)   VALUE SPACES.04770000
045900     05  FILLER                         PIC  X(23)   VALUE        04780000
046000         '$ TENDERED   &    COUNT'.                               04790000
046100     05  FILLER                         PIC  X(05)   VALUE SPACES.04800000
046200     05  FILLER                         PIC  X(27)   VALUE        04810000
046300         'VOIDED $ TENDERED AND COUNT'.                           04820000
046400                                                                  04830000
046500 01  REPORT-TOTALS-FULFILLED-TODAY.                               04840000
046600     05  FILLER                         PIC  X(02)   VALUE SPACES.04850000
046700     05  FILLER                         PIC  X(34)   VALUE        04860000
046800         'ECOMM FULFILLED TODAY'.                                 04870000
046900     05  FILLER                         PIC  X(06)   VALUE SPACES.04880000
047000     05  RPT-ECOMM-FUL-TO-ISS-DOL       PIC ZZZ,ZZZ,ZZ9.99-.      04890000
047100     05  FILLER                         PIC  X(03)   VALUE SPACES.04900000
047200     05  RPT-ECOMM-FUL-TO-ISS-CNT       PIC  ZZ,ZZZ,ZZ9-.         04910000
047300     05  FILLER                         PIC  X(03)   VALUE SPACES.04920000
047400     05  RPT-ECOMM-FUL-TO-ISSVD-DOL     PIC ZZZ,ZZZ,ZZ9.99-.      04930000
047500     05  FILLER                         PIC  X(03)   VALUE SPACES.04940000
047600     05  RPT-ECOMM-FUL-TO-ISSVD-CNT     PIC  ZZ,ZZZ,ZZ9-.         04950000
047700     05  FILLER                         PIC  X(03)   VALUE SPACES.04960000
047800     05  RPT-ECOMM-FUL-TO-TND-DOL       PIC ZZZ,ZZZ,ZZ9.99-.      04970000
047900     05  FILLER                         PIC  X(03)   VALUE SPACES.04980000
048000     05  RPT-ECOMM-FUL-TO-TND-CNT       PIC  ZZ,ZZZ,ZZ9-.         04990000
048100     05  FILLER                         PIC  X(03)   VALUE SPACES.05000000
048200     05  RPT-ECOMM-FUL-TO-TNDVD-DOL     PIC ZZZ,ZZZ,ZZ9.99-.      05010000
048300     05  FILLER                         PIC  X(03)   VALUE SPACES.05020000
048400     05  RPT-ECOMM-FUL-TO-TNDVD-CNT     PIC  ZZ,ZZZ,ZZ9-.         05030000
048500     05  FILLER                         PIC  X(03)   VALUE SPACES.05040000
048600                                                                  05050000
048700 01  REPORT-TOT-NOT-FULFILL-TODAY.                                05060000
048800     05  FILLER                         PIC  X(02)   VALUE SPACES.05070000
048900     05  FILLER                         PIC  X(34)   VALUE        05080000
049000         'ECOMM NOT FULFILLED TODAY'.                             05090000
049100     05  FILLER                         PIC  X(06)   VALUE SPACES.05100000
049200     05  RPT-ECOMM-NFU-TO-ISS-DOL       PIC ZZZ,ZZZ,ZZ9.99-.      05110000
049300     05  FILLER                         PIC  X(03)   VALUE SPACES.05120000
049400     05  RPT-ECOMM-NFU-TO-ISS-CNT       PIC  ZZ,ZZZ,ZZ9-.         05130000
049500     05  FILLER                         PIC  X(03)   VALUE SPACES.05140000
049600     05  RPT-ECOMM-NFU-TO-ISSVD-DOL     PIC ZZZ,ZZZ,ZZ9.99-.      05150000
049700     05  FILLER                         PIC  X(03)   VALUE SPACES.05160000
049800     05  RPT-ECOMM-NFU-TO-ISSVD-CNT     PIC  ZZ,ZZZ,ZZ9-.         05170000
049900     05  FILLER                         PIC  X(03)   VALUE SPACES.05180000
050000     05  RPT-ECOMM-NFU-TO-TND-DOL       PIC ZZZ,ZZZ,ZZ9.99-.      05190000
050100     05  FILLER                         PIC  X(03)   VALUE SPACES.05200000
050200     05  RPT-ECOMM-NFU-TO-TND-CNT       PIC  ZZ,ZZZ,ZZ9-.         05210000
050300     05  FILLER                         PIC  X(03)   VALUE SPACES.05220000
050400     05  RPT-ECOMM-NFU-TO-TNDVD-DOL     PIC ZZZ,ZZZ,ZZ9.99-.      05230000
050500     05  FILLER                         PIC  X(03)   VALUE SPACES.05240000
050600     05  RPT-ECOMM-NFU-TO-TNDVD-CNT     PIC  ZZ,ZZZ,ZZ9-.         05250000
050700     05  FILLER                         PIC  X(03)   VALUE SPACES.05260000
050800                                                                  05270000
050900 01  REPORT-TOT-NOT-FULFILL-PRIOR.                                05280000
051000     05  FILLER                         PIC  X(02)   VALUE SPACES.05290000
051100     05  FILLER                         PIC  X(34)   VALUE        05300000
051200         'ECOMM NOT FULFILLED PRIOR TO TODAY'.                    05310000
051300     05  FILLER                         PIC  X(06)   VALUE SPACES.05320000
051400     05  RPT-ECOMM-NFUP-TO-ISS-DOL      PIC ZZZ,ZZZ,ZZ9.99-.      05330000
051500     05  FILLER                         PIC  X(03)   VALUE SPACES.05340000
051600     05  RPT-ECOMM-NFUP-TO-ISS-CNT      PIC  ZZ,ZZZ,ZZ9-.         05350000
051700     05  FILLER                         PIC  X(03)   VALUE SPACES.05360000
051800     05  RPT-ECOMM-NFUP-TO-ISSVD-DOL    PIC ZZZ,ZZZ,ZZ9.99-.      05370000
051900     05  FILLER                         PIC  X(03)   VALUE SPACES.05380000
052000     05  RPT-ECOMM-NFUP-TO-ISSVD-CNT    PIC  ZZ,ZZZ,ZZ9-.         05390000
052100     05  FILLER                         PIC  X(03)   VALUE SPACES.05400000
052200     05  RPT-ECOMM-NFUP-TO-TND-DOL      PIC ZZZ,ZZZ,ZZ9.99-.      05410000
052300     05  FILLER                         PIC  X(03)   VALUE SPACES.05420000
052400     05  RPT-ECOMM-NFUP-TO-TND-CNT      PIC  ZZ,ZZZ,ZZ9-.         05430000
052500     05  FILLER                         PIC  X(03)   VALUE SPACES.05440000
052600     05  RPT-ECOMM-NFUP-TO-TNDVD-DOL    PIC ZZZ,ZZZ,ZZ9.99-.      05450000
052700     05  FILLER                         PIC  X(03)   VALUE SPACES.05460000
052800     05  RPT-ECOMM-NFUP-TO-TNDVD-CNT    PIC  ZZ,ZZZ,ZZ9-.         05470000
052900     05  FILLER                         PIC  X(03)   VALUE SPACES.05480000
053000                                                                  05490000
053100 01  REPORT-TOTAL-COUNT-OUTSTAND.                                 05500000
053200     05  FILLER                         PIC  X(02)   VALUE SPACES.05510000
053300     05  FILLER                         PIC  X(30)   VALUE        05520000
053400         'ECOMM TOTAL COUNT OUTSTANDING '.                        05530000
053500     05  FILLER                         PIC  X(07)   VALUE SPACES.05540000
053600     05  RPT-ECOMM-TOT-COUNT-OUT        PIC ZZZ,ZZZ,ZZ9.          05550000
053700     05  FILLER                         PIC  X(05)   VALUE SPACES.05560000
053800                                                                  05570000
053900 01  REPORT-AUDIT-BLANK-LINE            PIC  X(200)  VALUE SPACES.05580000
054000                                                                  05590000
054100 01  REPORT-AUDIT-NO-ERROR-LINE.                                  05600000
054200     05  FILLER                         PIC  X(75)   VALUE SPACES.05610000
054300     05  FILLER                         PIC  X(42)   VALUE        05620000
054400         '***  NO ERRORS OCCURRED DURING POSTING ON '.            05630000
054500     05  RPT-AUDIT-NO-ERR-MM            PIC  X(02).               05640000
054600     05  FILLER                         PIC  X(01)   VALUE '/'.   05650000
054700     05  RPT-AUDIT-NO-ERR-DD            PIC  X(02).               05660000
054800     05  FILLER                         PIC  X(01)   VALUE '/'.   05670000
054900     05  RPT-AUDIT-NO-ERR-YY            PIC  X(02).               05680000
055000     05  FILLER                         PIC  X(04)   VALUE        05690000
055100         ' ***'.                                                  05700000
055200     05  FILLER                         PIC  X(71)   VALUE SPACES.05710000
055300                                                                  05720000
055400 01  REPORT-AUDIT-ENDING-LINE.                                    05730000
055500     05  FILLER                         PIC  X(90)   VALUE SPACES.05740000
055600     05  FILLER                         PIC  X(19)   VALUE        05750000
055700         '***END OF REPORT***'.                                   05760000
055800     05  FILLER                         PIC  X(91)   VALUE SPACES.05770000
055900                                                                  05780000
056000 01  REPORT-MESSAGES.                                             05790000
056100     05  RM-UNKNOWN-CARD-ID             PIC  X(31)   VALUE        05800000
056200         'CARD ID NOT KNOWN TO THE SYSTEM'.                       05810000
056300                                                                  05820000
056400     05  RM-VERIFIED-DUPLICATE          PIC  X(31)   VALUE        05830000
056500         'ALREADY VERIFIED OR A DUPLICATE'.                       05840000
056600                                                                  05850000
056700     05  RM-MISSING-POS-TRANS           PIC  X(31)   VALUE        05860000
056800         'MISSING POS TRANSACTION        '.                       05870000
056900                                                                  05880000
057000     05  RM-MISSING-KMRC-TRANS          PIC  X(31)   VALUE        05890000
057100         'MISSING KMRC ACTIVITY          '.                       05900000
057200                                                                  05910000
057300     05  RM-MISSING-GIFT-TRANS          PIC  X(31)   VALUE        05920000
057400         'MISSING GIFT CARD ACTIVITY     '.                       05930000
057500                                                                  05940000
057600     05  RM-MISSING-POS-VOID            PIC  X(31)   VALUE        05950000
057700         'MISSING POS VOID               '.                       05960000
057800                                                                  05970000
057900     05  RM-MISSING-KMRC-VOID           PIC  X(31)   VALUE        05980000
058000         'MISSING KMRC VOID              '.                       05990000
058100                                                                  06000000
058200     05  RM-MISSING-GIFT-VOID           PIC  X(31)   VALUE        06010000
058300         'MISSING GIFT CARD VOID         '.                       06020000
058400                                                                  06030000
058500     05  RM-AMOUNT-OVERRIDDEN           PIC  X(31)   VALUE        06040000
058600         'AUTHORIZED AMOUNT OVERRIDDEN   '.                       06050000
058700                                                                  06060000
058800     05  RM-CARD-OVERTENDERED           PIC  X(31)   VALUE        06070000
058900         'BALANCE OVERTENDERED           '.                       06080000
059000                                                                  06090000
059100     05  RM-KEY-ENTERED                 PIC  X(31)   VALUE        06100000
059200         'CARD ID KEY ENTERED            '.                       06110000
059300                                                                  06120000
059400     05  RM-MISSING-KMC-VOID-W-TNDR     PIC  X(31)   VALUE        06130000
059500         'VOID OF ISSUE MISSING-W/ TENDER'.                       06140000
059600                                                                  06150000
059700 01  REPORT-ACTION-MESSAGES.                                      06160000
059800     05  RA-VERIFY                      PIC  X(26)   VALUE        06170000
059900         'IF VALID POS TRANS, VERIFY'.                            06180000
060000     05  RA-INSERT-KMRC                 PIC  X(26)   VALUE        06190000
060100         'ADD THE KMRC ACTIVITY     '.                            06200000
060200     05  RA-INSERT-GIFT                 PIC  X(26)   VALUE        06210000
060300         'ADD THE GIFT CARD ACTIVITY'.                            06220000
060400     05  RA-VERIFY-VOID                 PIC  X(26)   VALUE        06230000
060500         'IF VALID POS VOID, VERIFY '.                            06240000
060600     05  RA-PROCEDURE-ISSUE             PIC  X(26)   VALUE        06250000
060700         'STORE PROCEDURE ISSUE     '.                            06260000
060800     05  RA-INVESTIGATE-VOID            PIC  X(26)   VALUE        06270000
060900         'AUDIT/LP INVESTIGATE VOID '.                            06280000
061000                                                                  06290000
061100******************************************************************06300000
061200*    DATE ROUTINE COPY MEMBERS                                   *06310000
061300******************************************************************06320000
061400     COPY DPWS500.                                                06330000
061500                                                                  06340000
061600******************************************************************06350000
061700*    VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004     *06360000
061800******************************************************************06370000
061900     COPY DPWS004.                                                06380000
062000                                                                  06390000
062100******************************************************************06400000
062200*    SV-KOHL'S STORED VALUE CARD CONTROL NUMBERS                 *06410000
062300******************************************************************06420000
062400     EXEC SQL                                                     06430000
062500         INCLUDE SVT00000                                         06440000
062600     END-EXEC.                                                    06450000
062700                                                                  06460000
062800******************************************************************06470000
062900*    SV-KOHL'S STORED VALUE CARD ACTIVITY TABLE                  *06480000
063000******************************************************************06490000
063100     EXEC SQL                                                     06500000
063200         INCLUDE SVT00002                                         06510000
063300     END-EXEC.                                                    06520000
063400                                                                  06530000
063500******************************************************************06540000
063600*    SV-KOHL'S STORED VALUE CARD TABLE                           *06550000
063700******************************************************************06560000
063800     EXEC SQL                                                     06570000
063900         INCLUDE SVT00001                                         06580000
064000     END-EXEC.                                                    06590000
064100                                                                  06600000
064200******************************************************************06610000
064300*    STANDARD LAYOUT FOR THE SQL COMMUNCATIONS AREA              *06620000
064400******************************************************************06630000
064500     EXEC SQL                                                     06640000
064600         INCLUDE SQLCA                                            06650000
064700     END-EXEC.                                                    06660000
064800                                                                  06670000
064900     COPY SQLCA2.                                                 06680000
065000                                                                  06690000
065100                                                                  06700000
065200 PROCEDURE DIVISION.                                              06710000
065300                                                                  06720000
065400 A100-MAINLINE.                                                   06730000
065500                                                                  06740000
065600     PERFORM B100-INITIALIZE.                                     06750000
065700                                                                  06760000
065800     PERFORM B200-WRITE-REPORT                                    06770000
065900         UNTIL PS-END-OF-AUDIT-FILE.                              06780000
066000                                                                  06790000
066100     PERFORM B300-EOJ-ROUTINE.                                    06800000
066200                                                                  06810000
066300     GOBACK.                                                      06820000
066400                                                                  06830000
066500******************************************************************06840000
066600*     B100-INITIALIZE                                            *06850000
066700* ==> PROCESSES:                                                 *06860000
066800*     - ACCEPTS THE CURRENT DATE AND TIME FOR THE REPORT HEADING *06870000
066900*     - READS THE FIRST RECORD FROM THE AUDIT REPORT FILE        *06880000
067000* ==> PERFORMED FROM:  A100-MAINLINE                             *06890000
067100******************************************************************06900000
067200 B100-INITIALIZE.                                                 06910000
067300                                                                  06920000
067400     OPEN INPUT AUDIT-REPORT-FILE                                 06930000
067500                CONTROL-DATE-FILE                                 06940000
067600                TOTAL-FILE.                                       06950000
067700     OPEN OUTPUT KMRC-REPORT-FILE                                 06960000
067800                 GIFT-REPORT-FILE                                 06970000
067900                 KMRC-PREV-RPT                                    06980000
068000                 GIFT-PREV-RPT.                                   06990000
068100                                                                  07000000
068200     READ CONTROL-DATE-FILE INTO CR-CONTROL-RECORD                07010000
068300         AT END                                                   07020000
068400             SET PS-END-OF-CONTROL-FILE TO TRUE.                  07030000
068500                                                                  07040000
068600     IF PS-END-OF-CONTROL-FILE                                    07050000
068700         DISPLAY ' '                                              07060000
068800         DISPLAY '** ABEND     **'                                07070000
068900         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            07080000
069000         DISPLAY '** PARAGRAPH **  = B100-INITIALIZE      '       07090000
069100         DISPLAY '** CONTROL DATE FILE IS EMPTY  '                07100000
069200         DISPLAY ' '                                              07110000
069300         MOVE +4002 TO ABEND-CODE                                 07120000
069400         CALL 'ILBOABN0' USING ABEND-CODE                         07130007
069500     ELSE                                                         07140000
069600         DISPLAY PC-PROGRAM-NAME ' CONTROL DATE:  '               07150000
069700                 CR-CONTROL-DATE                                  07160000
069800     END-IF.                                                      07170000
069900                                                                  07180000
070000     ACCEPT PV-CURRENT-DATE      FROM DATE.                       07190000
070100     MOVE PV-CURRENT-YEAR          TO DP200O-RUN-YEAR.            07200000
070200     MOVE PV-CURRENT-MONTH         TO DP200O-RUN-MONTH.           07210000
070300     MOVE PV-CURRENT-DAY           TO DP200O-RUN-DAY.             07220000
070400                                                                  07230000
070500     ACCEPT PV-CURRENT-TIME      FROM TIME.                       07240000
070600     MOVE PV-CURRENT-HOUR          TO DP200O-RUN-HOUR.            07250000
070700     MOVE PV-CURRENT-MINUTE        TO DP200O-RUN-MINUTE.          07260000
070800                                                                  07270000
070900     MOVE PC-PROGRAM-NAME          TO DP200O-PROGRAM-NAME.        07280000
071000                                                                  07290000
071100     MOVE CR-CONTROL-DATE          TO PV-RPT-POSTING-DATE.        07300000
071200     MOVE PV-RPT-POST-DATE-MM      TO PV-HDR-POST-DATE-MM.        07310000
071300     MOVE PV-RPT-POST-DATE-DD      TO PV-HDR-POST-DATE-DD.        07320000
071400     MOVE PV-RPT-POST-DATE-CC      TO PV-HDR-POST-DATE-CC.        07330000
071500     MOVE PV-RPT-POST-DATE-YY      TO PV-HDR-POST-DATE-YY.        07340000
071600                                                                  07350000
071700     PERFORM C100-READ-AUDIT-FILE.                                07360000
071800                                                                  07370000
071900     IF PS-END-OF-AUDIT-FILE                                      07380000
072000         SET PS-EMPTY-AUDIT TO TRUE                               07390000
072100***  KMRC CARD EMPTY REPORT                                       07400000
072200         ADD PC-ONE                TO PA-PAGE-COUNTER             07410000
072300         MOVE PA-PAGE-COUNTER      TO DP200O-PAGE-NUMBER          07420000
072400         MOVE PC-ONE               TO DP200O-REPORT-NUMBER        07430000
072500                                                                  07440000
072600         WRITE KMRC-REPORT-RECORD                                 07450000
072700             FROM DP200O-STANDRD-HEADER-200-COLS                  07460000
072800             AFTER ADVANCING PAGE                                 07470000
072900                                                                  07480000
073000         MOVE PV-HDR-POSTING-DATE TO RC-KMRC-DATE                 07490000
073100         SET RC-KMRC-CURR-DATE    TO TRUE                         07500000
073200         MOVE RC-KMRC-TITLE-LINE   TO TL-HEADING                  07510000
073300         WRITE KMRC-REPORT-RECORD                                 07520000
073400             FROM REPORT-AUDIT-TITLE-LINE                         07530000
073500             AFTER ADVANCING 1 LINE                               07540000
073600                                                                  07550000
073700         MOVE PV-RPT-POST-DATE-YY  TO RPT-AUDIT-NO-ERR-YY         07560000
073800         MOVE PV-RPT-POST-DATE-MM  TO RPT-AUDIT-NO-ERR-MM         07570000
073900         MOVE PV-RPT-POST-DATE-DD  TO RPT-AUDIT-NO-ERR-DD         07580000
074000                                                                  07590000
074100         WRITE KMRC-REPORT-RECORD                                 07600000
074200             FROM REPORT-AUDIT-NO-ERROR-LINE                      07610000
074300             AFTER ADVANCING 2 LINES                              07620000
074400                                                                  07630000
074500         MOVE SV004-KMRC-CRD-TYP       TO PV-HOLD-CRD-TYP-CDE     07640000
074600         PERFORM B350-PROCESS-FINAL-TOTALS                        07650000
074700         SET PS-KMRC-NOT-EMPTY TO TRUE                            07660000
074800                                                                  07670000
074900***  GIFT CARD EMPTY REPORT                                       07680000
075000                                                                  07690000
075100         MOVE PC-ONE               TO PA-PAGE-COUNTER             07700000
075200         MOVE PA-PAGE-COUNTER      TO DP200O-PAGE-NUMBER          07710000
075300         MOVE PC-TWO               TO DP200O-REPORT-NUMBER        07720000
075400                                                                  07730000
075500         WRITE GIFT-REPORT-RECORD                                 07740000
075600             FROM DP200O-STANDRD-HEADER-200-COLS                  07750000
075700             AFTER ADVANCING PAGE                                 07760000
075800                                                                  07770000
075900         MOVE PV-HDR-POSTING-DATE TO RC-GIFT-DATE                 07780000
076000         SET RC-GIFT-CURR-DATE    TO TRUE                         07790000
076100         MOVE RC-GIFT-TITLE-LINE   TO TL-HEADING                  07800000
076200         WRITE GIFT-REPORT-RECORD                                 07810000
076300             FROM REPORT-AUDIT-TITLE-LINE                         07820000
076400             AFTER ADVANCING 1 LINE                               07830000
076500                                                                  07840000
076600         MOVE CR-CONTROL-DATE      TO PV-RPT-POSTING-DATE         07850000
076700         MOVE PV-RPT-POST-DATE-YY  TO RPT-AUDIT-NO-ERR-YY         07860000
076800         MOVE PV-RPT-POST-DATE-MM  TO RPT-AUDIT-NO-ERR-MM         07870000
076900         MOVE PV-RPT-POST-DATE-DD  TO RPT-AUDIT-NO-ERR-DD         07880000
077000                                                                  07890000
077100         WRITE GIFT-REPORT-RECORD                                 07900000
077200             FROM REPORT-AUDIT-NO-ERROR-LINE                      07910000
077300             AFTER ADVANCING 2 LINES                              07920000
077400         MOVE SV004-GIFT-CRD-TYP   TO PV-HOLD-CRD-TYP-CDE         07930000
077500         MOVE SV004-GIFT-CRD-TYP       TO PV-HOLD-CRD-TYP-CDE     07940000
077600         PERFORM B350-PROCESS-FINAL-TOTALS                        07950000
077700         SET PS-GIFT-NOT-EMPTY TO TRUE                            07960000
077800                                                                  07970000
077900     ELSE                                                         07980000
078000         MOVE SV019-CRD-TYP-CDE   TO PV-HOLD-CRD-TYP-CDE          07990000
078100         MOVE SV019-STORE-NBR     TO PV-HOLD-STORE-NBR            08000000
078200         MOVE SV019-POS-DATE      TO PV-HOLD-POS-DATE             08010000
078300         IF PV-HOLD-CRD-TYP-CDE = SV004-GIFT-CRD-TYP              08020000
078400***  KMRC CARD EMPTY REPORT                                       08030000
078500             ADD PC-ONE            TO PA-PAGE-COUNTER             08040000
078600             MOVE PA-PAGE-COUNTER  TO DP200O-PAGE-NUMBER          08050000
078700             MOVE PC-ONE           TO DP200O-REPORT-NUMBER        08060000
078800                                                                  08070000
078900             WRITE KMRC-REPORT-RECORD                             08080000
079000                 FROM DP200O-STANDRD-HEADER-200-COLS              08090000
079100                 AFTER ADVANCING PAGE                             08100000
079200                                                                  08110000
079300             MOVE PV-HDR-POSTING-DATE TO RC-KMRC-DATE             08120000
079400             SET RC-KMRC-CURR-DATE    TO TRUE                     08130000
079500             MOVE RC-KMRC-TITLE-LINE   TO TL-HEADING              08140000
079600             WRITE KMRC-REPORT-RECORD                             08150000
079700                 FROM REPORT-AUDIT-TITLE-LINE                     08160000
079800                 AFTER ADVANCING 1 LINE                           08170000
079900                                                                  08180000
080000             MOVE CR-CONTROL-DATE  TO PV-RPT-POSTING-DATE         08190000
080100             MOVE PV-RPT-POST-DATE-YY                             08200000
080200                                   TO RPT-AUDIT-NO-ERR-YY         08210000
080300             MOVE PV-RPT-POST-DATE-MM                             08220000
080400                                   TO RPT-AUDIT-NO-ERR-MM         08230000
080500             MOVE PV-RPT-POST-DATE-DD                             08240000
080600                                   TO RPT-AUDIT-NO-ERR-DD         08250000
080700                                                                  08260000
080800             WRITE KMRC-REPORT-RECORD                             08270000
080900                 FROM REPORT-AUDIT-NO-ERROR-LINE                  08280000
081000                 AFTER ADVANCING 2 LINES                          08290000
081100             MOVE SV004-KMRC-CRD-TYP       TO PV-HOLD-CRD-TYP-CDE 08300000
081200             SET PS-EMPTY-KMRC TO TRUE                            08310000
081300         END-IF                                                   08320000
081400     END-IF.                                                      08330000
081500                                                                  08340000
081600******************************************************************08350000
081700*     B200-WRITE-REPORT                                          *08360000
081800* ==> PROCESSES:                                                 *08370000
081900*     - WRITES A LINE TO THE REPORT FOR EACH RECORD IN THE AUDIT *08380000
082000*       REPORT FILE.                                             *08390000
082100*     - TAKES CARE OF BREAKING BY STORE NUMBER                   *08400000
082200* ==> PERFORMED FROM:  A100-MAINLINE                             *08410000
082300******************************************************************08420000
082400 B200-WRITE-REPORT.                                               08430000
082500                                                                  08440000
082600     IF SV019-CRD-TYP-CDE = PV-HOLD-CRD-TYP-CDE                   08450000
082700         IF SV019-STORE-NBR = PV-HOLD-STORE-NBR AND               08460000
082800            SV019-POS-DATE  = PV-HOLD-POS-DATE                    08470000
082900             CONTINUE                                             08480000
083000         ELSE                                                     08490000
083100             IF PV-HOLD-POS-DATE < CR-CONTROL-DATE                08500000
083200                 PERFORM F100P-PRINT-STORE-TOTAL-LINE             08510000
083300             ELSE                                                 08520000
083400                 PERFORM F100-PRINT-STORE-TOTAL-LINE              08530000
083500             END-IF                                               08540000
083600             MOVE SV019-STORE-NBR TO PV-HOLD-STORE-NBR            08550000
083700             MOVE SV019-POS-DATE  TO PV-HOLD-POS-DATE             08560000
083800             IF PV-HOLD-POS-DATE < CR-CONTROL-DATE                08570000
083900                 PERFORM E100P-PRINT-STORE-LINE                   08580000
084000             ELSE                                                 08590000
084100                 PERFORM E100-PRINT-STORE-LINE                    08600000
084200             END-IF                                               08610000
084300         END-IF                                                   08620000
084400     ELSE                                                         08630000
084500         PERFORM B350-PROCESS-FINAL-TOTALS                        08640000
084600         INITIALIZE PA-PAGE-COUNTER                               08650000
084700                    PA-P-PAGE-COUNTER                             08660000
084800         MOVE +75                 TO PA-LINE-COUNTER              08670000
084900                                     PA-P-LINE-COUNTER            08680000
085000         MOVE PC-TWO              TO DP200O-REPORT-NUMBER         08690000
085100         MOVE SV019-CRD-TYP-CDE   TO PV-HOLD-CRD-TYP-CDE          08700000
085200         MOVE SV019-STORE-NBR     TO PV-HOLD-STORE-NBR            08710000
085300         MOVE SV019-POS-DATE      TO PV-HOLD-POS-DATE             08720000
085400         IF PV-HOLD-POS-DATE < CR-CONTROL-DATE                    08730000
085500             PERFORM D100P-PROCESS-PAGE-BREAK                     08740000
085600             PERFORM E100P-PRINT-STORE-LINE                       08750000
085700         ELSE                                                     08760000
085800             PERFORM D100-PROCESS-PAGE-BREAK                      08770000
085900             PERFORM E100-PRINT-STORE-LINE                        08780000
086000         END-IF                                                   08790000
086100     END-IF.                                                      08800000
086200                                                                  08810000
086200     IF SV019-OMNI-CHNL-FFLMT NOT EQUAL SPACES OR                 08810100
086200        SV019-OMNI-CHNL-FFLMT NOT EQUAL LOW-VALUES OR             08810200
086200        SV019-OMNI-CHNL-FFLMT NOT EQUAL HIGH-VALUES OR            08810300
086200        SV019-OMNI-CHNL-FFLMT NOT NUMERIC                         08810400
036100         IF SV019-OMNI-CHNL-FFLMT = 'AFS'                         08811002
036100            MOVE 'SFS'                   TO RPT-AUDIT-FFLMT-CODE  08811102
036100         ELSE                                                     08811202
036100            MOVE SV019-OMNI-CHNL-FFLMT   TO RPT-AUDIT-FFLMT-CODE  08811303
036100         END-IF                                                   08811402
036100     ELSE                                                         08811502
036100         MOVE SPACES                  TO RPT-AUDIT-FFLMT-CODE     08811602
086200     END-IF.                                                      08812000
086300     MOVE SV019-TERMINAL-NBR      TO RPT-AUDIT-TERMINAL-NBR.      08820000
086400     MOVE SV019-TRANSACTION-NBR   TO RPT-AUDIT-TRANSACTION-NBR.   08830000
086410     IF SV019-TRN-STAT-CDE = 'L'                                  08840000
086420         MOVE SV019-TRN-STAT-CDE  TO RPT-AUDIT-LATE-IND           08850000
086430     ELSE                                                         08860000
086440         MOVE SPACES              TO RPT-AUDIT-LATE-IND           08870000
086450     END-IF.                                                      08880000
086500     MOVE SV019-KMC-CRD-NBR       TO RPT-AUDIT-KMC-CARD-NBR.      08890000
087400     IF SV019-TRANS-VOID-IND = 'N'                                08980000
087500        MOVE SPACES TO SV019-TRANS-VOID-IND                       08990000
087600     END-IF.                                                      09000000
087700     MOVE SV019-TRANS-VOID-IND    TO RPT-AUDIT-VOID-IND.          09010000
087800     MOVE SV019-REVERSAL-IND      TO RPT-AUDIT-RVRSL-IND.         09020000
087900     EVALUATE TRUE                                                09030000
088000         WHEN SV019-ISSUANCE-KMRC                                 09040000
088100             MOVE SV004-ISSUE-KMRC-SHRT-DESC                      09050000
088200                                  TO RPT-AUDIT-TRANS-TYPE         09060000
088300         WHEN SV019-ISSUANCE-GIFT-CRD                             09070000
088400             MOVE SV004-ISSUE-GIFT-CRD-SHRT-DESC                  09080000
088500                                  TO RPT-AUDIT-TRANS-TYPE         09090000
088600             PERFORM C600-GET-CARD-STOCK-TYPE                     09100000
088700         WHEN SV019-TENDER                                        09110000
088800             MOVE SV004-TENDER-SHRT-DESC                          09120000
088900                                  TO RPT-AUDIT-TRANS-TYPE         09130000
089000             PERFORM C600-GET-CARD-STOCK-TYPE                     09140000
089100     END-EVALUATE.                                                09150000
089200     MOVE SV019-APPROVED-TRAN-AMT TO RPT-AUDIT-APPROVED-TRANS-AMT.09160000
089300     IF SV019-ISSUANCE-KMRC OR                                    09170000
089400        SV019-ISSUANCE-GIFT-CRD                                   09180000
089500        ADD  SV019-APPROVED-TRAN-AMT TO PV-DAILY-STORE-TOTAL-I    09190000
089600     ELSE                                                         09200000
089700        ADD  SV019-APPROVED-TRAN-AMT TO PV-DAILY-STORE-TOTAL-T    09210000
089800     END-IF.                                                      09220000
089900     MOVE SV019-ORIGINAL-AUTH-AMT TO RPT-AUDIT-ORIGINAL-AUTH-AMT. 09230000
090000     IF SV019-OPERATOR-ID = ZEROES                                09240000
090100         MOVE SPACES              TO RPT-AUDIT-OPERATOR-ID        09250000
090200     ELSE                                                         09260000
090300         MOVE SV019-OPERATOR-ID   TO RPT-AUDIT-OPERATOR-ID-N      09270000
090400     END-IF.                                                      09280000
090500     MOVE SV019-USER-ID           TO RPT-AUDIT-USER-ID.           09290000
090600                                                                  09300000
090700     EVALUATE TRUE                                                09310000
090800         WHEN SV019-UNKNOWN-CARD-ID                               09320000
090900            MOVE RM-UNKNOWN-CARD-ID                               09330000
091000                                  TO RPT-AUDIT-ERROR-MESSAGE      09340000
091100            MOVE RA-INVESTIGATE-VOID                              09350000
091200                                  TO RPT-AUDIT-ACTION-MESSAGE     09360000
091300                                                                  09370000
091400         WHEN SV019-VERIFIED-DUPLICATE                            09380000
091500            MOVE RM-VERIFIED-DUPLICATE                            09390000
091600                                  TO RPT-AUDIT-ERROR-MESSAGE      09400000
091700            MOVE SPACES           TO RPT-AUDIT-ACTION-MESSAGE     09410000
091800                                                                  09420000
091900         WHEN SV019-MISSING-POS-TRANS                             09430000
092000            MOVE RM-MISSING-POS-TRANS                             09440000
092100                                  TO RPT-AUDIT-ERROR-MESSAGE      09450000
092200            MOVE RA-VERIFY        TO RPT-AUDIT-ACTION-MESSAGE     09460000
092300                                                                  09470000
092400         WHEN SV019-MISSING-KMC-TRANS                             09480000
092500            IF SV019-CRD-TYP-CDE = SV004-KMRC-CRD-TYP             09490000
092600                MOVE RM-MISSING-KMRC-TRANS                        09500000
092700                                  TO RPT-AUDIT-ERROR-MESSAGE      09510000
092800                MOVE RA-INSERT-KMRC                               09520000
092900                                  TO RPT-AUDIT-ACTION-MESSAGE     09530000
093000            ELSE                                                  09540000
093100                MOVE RM-MISSING-GIFT-TRANS                        09550000
093200                                  TO RPT-AUDIT-ERROR-MESSAGE      09560000
093300                MOVE RA-INSERT-GIFT                               09570000
093400                                  TO RPT-AUDIT-ACTION-MESSAGE     09580000
093500            END-IF                                                09590000
093600                                                                  09600000
093700         WHEN SV019-MISSING-POS-VOID                              09610000
093800            MOVE RM-MISSING-POS-VOID                              09620000
093900                                  TO RPT-AUDIT-ERROR-MESSAGE      09630000
094000            MOVE RA-VERIFY-VOID   TO RPT-AUDIT-ACTION-MESSAGE     09640000
094100                                                                  09650000
094200         WHEN SV019-MISSING-KMC-VOID                              09660000
094300            IF SV019-CRD-TYP-CDE = SV004-KMRC-CRD-TYP             09670000
094400                MOVE RM-MISSING-KMRC-VOID                         09680000
094500                                  TO RPT-AUDIT-ERROR-MESSAGE      09690000
094600            ELSE                                                  09700000
094700                MOVE RM-MISSING-GIFT-VOID                         09710000
094800                                  TO RPT-AUDIT-ERROR-MESSAGE      09720000
094900            END-IF                                                09730000
095000            MOVE RA-PROCEDURE-ISSUE                               09740000
095100                                  TO RPT-AUDIT-ACTION-MESSAGE     09750000
095200                                                                  09760000
095300         WHEN SV019-AMOUNT-OVERRIDDEN                             09770000
095400            MOVE RM-AMOUNT-OVERRIDDEN                             09780000
095500                                  TO RPT-AUDIT-ERROR-MESSAGE      09790000
095600            MOVE SPACES           TO RPT-AUDIT-ACTION-MESSAGE     09800000
095700                                                                  09810000
095800         WHEN SV019-CARD-OVERTENDERED                             09820000
095900            MOVE RM-CARD-OVERTENDERED                             09830000
096000                                  TO RPT-AUDIT-ERROR-MESSAGE      09840000
096100            MOVE SPACES           TO RPT-AUDIT-ACTION-MESSAGE     09850000
096200                                                                  09860000
096300         WHEN SV019-KEY-ENTERED                                   09870000
096400            MOVE RM-KEY-ENTERED                                   09880000
096500                                  TO RPT-AUDIT-ERROR-MESSAGE      09890000
096600            MOVE SPACES           TO RPT-AUDIT-ACTION-MESSAGE     09900000
096700                                                                  09910000
096800         WHEN SV019-MISSING-KMC-VOID-W-TNDR                       09920000
096900            MOVE RM-MISSING-KMC-VOID-W-TNDR                       09930000
097000                                  TO RPT-AUDIT-ERROR-MESSAGE      09940000
097100            MOVE RA-INVESTIGATE-VOID                              09950000
097200                                  TO RPT-AUDIT-ACTION-MESSAGE     09960000
097300                                                                  09970000
097400     END-EVALUATE.                                                09980000
097500                                                                  09990000
PRTFIX     IF PV-HOLD-POS-DATE < CR-CONTROL-DATE                        10000006
PRTFIX         PERFORM C200P-PRINT-DETAIL                               10010006
PRTFIX     END-IF.                                                      10020006
PRTFIX     IF PV-HOLD-POS-DATE = CR-CONTROL-DATE                        10021006
PRTFIX         PERFORM C200-PRINT-DETAIL                                10030006
PRTFIX     END-IF.                                                      10040006
098100                                                                  10050000
098200     PERFORM C100-READ-AUDIT-FILE.                                10060000
098300                                                                  10070000
098400******************************************************************10080000
098500*     B300-EOJ-ROUTINE                                           *10090000
098600* ==> PROCESSES:                                                 *10100000
098700*     - WRITES AN END OF REPORT LINE TO THE REPORT               *10110000
098800*     - CLOSES THE FILES                                         *10120000
098900*     - DISPLAYS THE NUMBER OF RECORDS READ AND WRITTEN          *10130000
099000* ==> PERFORMED FROM:  A100-MAINLINE                             *10140000
099100******************************************************************10150000
099200 B300-EOJ-ROUTINE.                                                10160000
099300     IF PS-AUDIT-NOT-EMPTY                                        10170000
099400        PERFORM B350-PROCESS-FINAL-TOTALS                         10180000
099500     END-IF.                                                      10190000
099600     IF PS-EMPTY-AUDIT                                            10200000
099700        CONTINUE                                                  10210000
099800     ELSE                                                         10220000
099900       IF PS-GIFT-NOT-EMPTY                                       10230000
100000          CONTINUE                                                10240000
100100       ELSE                                                       10250000
100200***  GIFT CARD EMPTY REPORT                                       10260000
100300                                                                  10270000
100400         MOVE PC-ONE               TO PA-PAGE-COUNTER             10280000
100500         MOVE PA-PAGE-COUNTER      TO DP200O-PAGE-NUMBER          10290000
100600         MOVE PC-TWO               TO DP200O-REPORT-NUMBER        10300000
100700                                                                  10310000
100800         WRITE GIFT-REPORT-RECORD                                 10320000
100900             FROM DP200O-STANDRD-HEADER-200-COLS                  10330000
101000             AFTER ADVANCING PAGE                                 10340000
101100                                                                  10350000
101200         MOVE PV-HDR-POSTING-DATE TO RC-GIFT-DATE                 10360000
101300         SET RC-GIFT-CURR-DATE    TO TRUE                         10370000
101400         MOVE RC-GIFT-TITLE-LINE   TO TL-HEADING                  10380000
101500         WRITE GIFT-REPORT-RECORD                                 10390000
101600             FROM REPORT-AUDIT-TITLE-LINE                         10400000
101700             AFTER ADVANCING 1 LINE                               10410000
101800                                                                  10420000
101900         MOVE CR-CONTROL-DATE      TO PV-RPT-POSTING-DATE         10430000
102000         MOVE PV-RPT-POST-DATE-YY  TO RPT-AUDIT-NO-ERR-YY         10440000
102100         MOVE PV-RPT-POST-DATE-MM  TO RPT-AUDIT-NO-ERR-MM         10450000
102200         MOVE PV-RPT-POST-DATE-DD  TO RPT-AUDIT-NO-ERR-DD         10460000
102300                                                                  10470000
102400         WRITE GIFT-REPORT-RECORD                                 10480000
102500             FROM REPORT-AUDIT-NO-ERROR-LINE                      10490000
102600             AFTER ADVANCING 2 LINES                              10500000
102700         MOVE SV004-GIFT-CRD-TYP   TO PV-HOLD-CRD-TYP-CDE         10510000
102800         PERFORM B350-PROCESS-FINAL-TOTALS                        10520000
102900       END-IF                                                     10530000
103000     END-IF.                                                      10540000
103100     CLOSE AUDIT-REPORT-FILE                                      10550000
103200           KMRC-REPORT-FILE                                       10560000
103300           GIFT-REPORT-FILE                                       10570000
103400           KMRC-PREV-RPT                                          10580000
103500           GIFT-PREV-RPT                                          10590000
103600           TOTAL-FILE.                                            10600000
103700                                                                  10610000
103800     DISPLAY ' '.                                                 10620000
103900     DISPLAY 'MESSAGES FOR PROGRAM ' PC-PROGRAM-NAME.             10630000
104000     DISPLAY 'NUMBER OF AUDIT RECORDS READ:      '                10640000
104100         PA-AUDIT-FILE-RECS-READ.                                 10650000
104200     DISPLAY 'NUMBER OF KMRC REPORT RECORDS WRITTEN:  '           10660000
104300         PA-KMRC-REPORT-RECORDS-WRITTEN.                          10670000
104400     DISPLAY 'NUMBER OF GIFT CARD REPORT RECORDS WRITTEN:  '      10680000
104500         PA-GIFT-REPORT-RECORDS-WRITTEN.                          10690000
104600     DISPLAY ' '.                                                 10700000
104700                                                                  10710000
104800******************************************************************10720000
104900*     B350-PROCESS-FINAL-TOTALS                                  *10730000
105000* ==> PROCESSES:                                                 *10740000
105100*     - WRITES AN END OF REPORT LINE TO THE REPORT               *10750000
105200* ==> PERFORMED FROM:  B200-WRITE-REPORT                         *10760000
105300*                      B300-EOJ-ROUTINE                          *10770000
105400******************************************************************10780000
105500                                                                  10790000
105600 B350-PROCESS-FINAL-TOTALS.                                       10800000
105700     PERFORM F100-PRINT-STORE-TOTAL-LINE.                         10810000
105800                                                                  10820000
105900     READ TOTAL-FILE INTO SV043-RECORD                            10830000
106000         AT END                                                   10840000
106100             SET PS-END-OF-TOTAL-FILE TO TRUE.                    10850000
106200                                                                  10860000
106300     IF PV-HOLD-CRD-TYP-CDE = SV004-KMRC-CRD-TYP                  10870000
106400         MOVE SV004-KMRC-CRD-TYP        TO SVT00001-CRD-TYP-CDE   10880000
106500         MOVE SV004-ISSUE-KMRC-ACT-TYP  TO SVT00002-ACTVY-TYP-CDE 10890000
106600         IF PS-END-OF-TOTAL-FILE                                  10900000
106700            CONTINUE                                              10910000
106800         ELSE                                                     10920000
106900            MOVE SV043-TOT-VER-ISSUE-K TO                         10930000
107000                  RPT-AUDIT-POS-DOLLARS-ISSUED                    10940000
107100            MOVE SV043-TOT-VER-TND-K TO                           10950000
107200                  RPT-AUDIT-POS-DOLLARS-TENDERED                  10960000
107300            MOVE SV043-TOT-AUTH-ISSUE-K TO                        10970000
107400                  RPT-AUDIT-POS-AUTH-ISSUE                        10980000
107500            MOVE SV043-TOT-AUTH-TND-K TO                          10990000
107600                  RPT-AUDIT-POS-AUTH-TENDER                       11000000
107700            MOVE SV043-TOT-COMP-ISSUE-K TO                        11010000
107800                  RPT-AUDIT-POS-COMP-ISSUE                        11020000
107900            MOVE SV043-TOT-COMP-TND-K TO                          11030000
108000                  RPT-AUDIT-POS-COMP-TENDER                       11040000
108100            MOVE SV043-ECOMM-DOL-ISST-K TO                        11050000
108200                  RPT-ECOMM-FUL-TO-ISS-DOL                        11060000
108300            MOVE SV043-ECOMM-CNT-ISST-K TO                        11070000
108400                  RPT-ECOMM-FUL-TO-ISS-CNT                        11080000
108500            MOVE SV043-ECOMM-DOL-ISSVT-K TO                       11090000
108600                  RPT-ECOMM-FUL-TO-ISSVD-DOL                      11100000
108700            MOVE SV043-ECOMM-CNT-ISSVT-K TO                       11110000
108800                  RPT-ECOMM-FUL-TO-ISSVD-CNT                      11120000
108900            MOVE SV043-ECOMM-DOL-TNDT-K TO                        11130000
109000                  RPT-ECOMM-FUL-TO-TND-DOL                        11140000
109100            MOVE SV043-ECOMM-CNT-TNDT-K TO                        11150000
109200                  RPT-ECOMM-FUL-TO-TND-CNT                        11160000
109300            MOVE SV043-ECOMM-DOL-TNDVT-K TO                       11170000
109400                  RPT-ECOMM-FUL-TO-TNDVD-DOL                      11180000
109500            MOVE SV043-ECOMM-CNT-TNDVT-K TO                       11190000
109600                  RPT-ECOMM-FUL-TO-TNDVD-CNT                      11200000
109700            MOVE SV043-ECOMM-DOL-ISSNT-K TO                       11210000
109800                  RPT-ECOMM-NFU-TO-ISS-DOL                        11220000
109900            MOVE SV043-ECOMM-CNT-ISSNT-K TO                       11230000
110000                  RPT-ECOMM-NFU-TO-ISS-CNT                        11240000
110100            MOVE SV043-ECOMM-DOL-ISSVNT-K TO                      11250000
110200                  RPT-ECOMM-NFU-TO-ISSVD-DOL                      11260000
110300            MOVE SV043-ECOMM-CNT-ISSVNT-K TO                      11270000
110400                  RPT-ECOMM-NFU-TO-ISSVD-CNT                      11280000
110500            MOVE SV043-ECOMM-DOL-TNDNT-K TO                       11290000
110600                  RPT-ECOMM-NFU-TO-TND-DOL                        11300000
110700            MOVE SV043-ECOMM-CNT-TNDNT-K TO                       11310000
110800                  RPT-ECOMM-NFU-TO-TND-CNT                        11320000
110900            MOVE SV043-ECOMM-DOL-TNDVNT-K TO                      11330000
111000                  RPT-ECOMM-NFU-TO-TNDVD-DOL                      11340000
111100            MOVE SV043-ECOMM-CNT-TNDVNT-K TO                      11350000
111200                  RPT-ECOMM-NFU-TO-TNDVD-CNT                      11360000
111300            MOVE SV043-ECOMM-DOL-ISSNTP-K TO                      11370000
111400                  RPT-ECOMM-NFUP-TO-ISS-DOL                       11380000
111500            MOVE SV043-ECOMM-CNT-ISSNTP-K TO                      11390000
111600                  RPT-ECOMM-NFUP-TO-ISS-CNT                       11400000
111700            MOVE SV043-ECOMM-DOL-ISSVNTP-K TO                     11410000
111800                  RPT-ECOMM-NFUP-TO-ISSVD-DOL                     11420000
111900            MOVE SV043-ECOMM-CNT-ISSVNTP-K TO                     11430000
112000                  RPT-ECOMM-NFUP-TO-ISSVD-CNT                     11440000
112100            MOVE SV043-ECOMM-DOL-TNDNTP-K TO                      11450000
112200                  RPT-ECOMM-NFUP-TO-TND-DOL                       11460000
112300            MOVE SV043-ECOMM-CNT-TNDNTP-K TO                      11470000
112400                  RPT-ECOMM-NFUP-TO-TND-CNT                       11480000
112500            MOVE SV043-ECOMM-DOL-TNDVNTP-K TO                     11490000
112600                  RPT-ECOMM-NFUP-TO-TNDVD-DOL                     11500000
112700            MOVE SV043-ECOMM-CNT-TNDVNTP-K TO                     11510000
112800                  RPT-ECOMM-NFUP-TO-TNDVD-CNT                     11520000
112900         END-IF                                                   11530000
113000     ELSE                                                         11540000
113100         MOVE SV004-GIFT-CRD-TYP        TO SVT00001-CRD-TYP-CDE   11550000
113200         MOVE SV004-ISSUE-GIFT-CRD-ACT-TYP                        11560000
113300                                        TO SVT00002-ACTVY-TYP-CDE 11570000
113400         MOVE SV043-TOT-VER-ISSUE-G TO                            11580000
113500               RPT-AUDIT-POS-DOLLARS-ISSUED                       11590000
113600         MOVE SV043-TOT-VER-TND-G TO                              11600000
113700               RPT-AUDIT-POS-DOLLARS-TENDERED                     11610000
113800         MOVE SV043-TOT-AUTH-ISSUE-G TO                           11620000
113900               RPT-AUDIT-POS-AUTH-ISSUE                           11630000
114000         MOVE SV043-TOT-AUTH-TND-G TO                             11640000
114100               RPT-AUDIT-POS-AUTH-TENDER                          11650000
114200         MOVE SV043-TOT-COMP-ISSUE-G TO                           11660000
114300               RPT-AUDIT-POS-COMP-ISSUE                           11670000
114400         MOVE SV043-TOT-COMP-TND-G TO                             11680000
114500               RPT-AUDIT-POS-COMP-TENDER                          11690000
114600         MOVE SV043-ECOMM-DOL-ISST-G TO                           11700000
114700               RPT-ECOMM-FUL-TO-ISS-DOL                           11710000
114800         MOVE SV043-ECOMM-CNT-ISST-G TO                           11720000
114900               RPT-ECOMM-FUL-TO-ISS-CNT                           11730000
115000         MOVE SV043-ECOMM-DOL-ISSVT-G TO                          11740000
115100               RPT-ECOMM-FUL-TO-ISSVD-DOL                         11750000
115200         MOVE SV043-ECOMM-CNT-ISSVT-G TO                          11760000
115300               RPT-ECOMM-FUL-TO-ISSVD-CNT                         11770000
115400         MOVE SV043-ECOMM-DOL-TNDT-G TO                           11780000
115500               RPT-ECOMM-FUL-TO-TND-DOL                           11790000
115600         MOVE SV043-ECOMM-CNT-TNDT-G TO                           11800000
115700               RPT-ECOMM-FUL-TO-TND-CNT                           11810000
115800         MOVE SV043-ECOMM-DOL-TNDVT-G TO                          11820000
115900               RPT-ECOMM-FUL-TO-TNDVD-DOL                         11830000
116000         MOVE SV043-ECOMM-CNT-TNDVT-G TO                          11840000
116100               RPT-ECOMM-FUL-TO-TNDVD-CNT                         11850000
116200         MOVE SV043-ECOMM-DOL-ISSNT-G TO                          11860000
116300               RPT-ECOMM-NFU-TO-ISS-DOL                           11870000
116400         MOVE SV043-ECOMM-CNT-ISSNT-G TO                          11880000
116500               RPT-ECOMM-NFU-TO-ISS-CNT                           11890000
116600         MOVE SV043-ECOMM-DOL-ISSVNT-G TO                         11900000
116700               RPT-ECOMM-NFU-TO-ISSVD-DOL                         11910000
116800         MOVE SV043-ECOMM-CNT-ISSVNT-G TO                         11920000
116900               RPT-ECOMM-NFU-TO-ISSVD-CNT                         11930000
117000         MOVE SV043-ECOMM-DOL-TNDNT-G TO                          11940000
117100               RPT-ECOMM-NFU-TO-TND-DOL                           11950000
117200         MOVE SV043-ECOMM-CNT-TNDNT-G TO                          11960000
117300               RPT-ECOMM-NFU-TO-TND-CNT                           11970000
117400         MOVE SV043-ECOMM-DOL-TNDVNT-G TO                         11980000
117500               RPT-ECOMM-NFU-TO-TNDVD-DOL                         11990000
117600         MOVE SV043-ECOMM-CNT-TNDVNT-G TO                         12000000
117700               RPT-ECOMM-NFU-TO-TNDVD-CNT                         12010000
117800         MOVE SV043-ECOMM-DOL-ISSNTP-G TO                         12020000
117900               RPT-ECOMM-NFUP-TO-ISS-DOL                          12030000
118000         MOVE SV043-ECOMM-CNT-ISSNTP-G TO                         12040000
118100               RPT-ECOMM-NFUP-TO-ISS-CNT                          12050000
118200         MOVE SV043-ECOMM-DOL-ISSVNTP-G TO                        12060000
118300               RPT-ECOMM-NFUP-TO-ISSVD-DOL                        12070000
118400         MOVE SV043-ECOMM-CNT-ISSVNTP-G TO                        12080000
118500               RPT-ECOMM-NFUP-TO-ISSVD-CNT                        12090000
118600         MOVE SV043-ECOMM-DOL-TNDNTP-G TO                         12100000
118700               RPT-ECOMM-NFUP-TO-TND-DOL                          12110000
118800         MOVE SV043-ECOMM-CNT-TNDNTP-G TO                         12120000
118900               RPT-ECOMM-NFUP-TO-TND-CNT                          12130000
119000         MOVE SV043-ECOMM-DOL-TNDVNTP-G TO                        12140000
119100               RPT-ECOMM-NFUP-TO-TNDVD-DOL                        12150000
119200         MOVE SV043-ECOMM-CNT-TNDVNTP-G TO                        12160000
119300               RPT-ECOMM-NFUP-TO-TNDVD-CNT                        12170000
119400     END-IF.                                                      12180000
119500                                                                  12190000
119600     PERFORM C475-DAILY-POS-ONLINE-DLRS-ISS.                      12200000
119700                                                                  12210000
119800     IF PV-HOLD-CRD-TYP-CDE = SV004-KMRC-CRD-TYP                  12220000
119900         MOVE SV004-KMRC-CRD-TYP        TO SVT00001-CRD-TYP-CDE   12230000
120000         MOVE SV004-TENDER-ACT-TYP      TO SVT00002-ACTVY-TYP-CDE 12240000
120100     ELSE                                                         12250000
120200         MOVE SV004-GIFT-CRD-TYP        TO SVT00001-CRD-TYP-CDE   12260000
120300         MOVE SV004-TENDER-ACT-TYP      TO SVT00002-ACTVY-TYP-CDE 12270000
120400     END-IF.                                                      12280000
120500                                                                  12290000
120600                                                                  12300000
120700     ADD PC-TWO  TO PA-LINE-COUNTER.                              12310000
120800                                                                  12320000
120900     IF PA-LINE-COUNTER > PC-MAX-LINES-PER-PAGE                   12330000
121000         PERFORM D100-PROCESS-PAGE-BREAK                          12340000
121100         PERFORM E100-PRINT-STORE-LINE                            12350000
121200     END-IF.                                                      12360000
121300                                                                  12370000
121400     IF PV-HOLD-CRD-TYP-CDE = SV004-KMRC-CRD-TYP                  12380000
121500         WRITE KMRC-REPORT-RECORD                                 12390000
121600             FROM REPORT-AUDIT-POS-ISSUED-LINE                    12400000
121700             AFTER ADVANCING 2 LINES                              12410000
121800                                                                  12420000
121900         WRITE KMRC-REPORT-RECORD                                 12430000
122000             FROM REPORT-AUDIT-POS-VERIFIED-LINE                  12440000
122100             AFTER ADVANCING 1 LINES                              12450000
122200                                                                  12460000
122300         WRITE KMRC-REPORT-RECORD                                 12470000
122400             FROM REPORT-AUDIT-POS-AUTHOR-LINE                    12480000
122500             AFTER ADVANCING 1 LINE                               12490000
122600                                                                  12500000
122700         WRITE KMRC-REPORT-RECORD                                 12510000
122800             FROM REPORT-AUDIT-POS-COMPANY-LINE                   12520000
122900             AFTER ADVANCING 1 LINE                               12530000
123000                                                                  12540000
123100         IF CR-ECOMM                                              12550000
123200             WRITE KMRC-REPORT-RECORD                             12560000
123300                 FROM REPORT-TOTALS                               12570000
123400                 AFTER ADVANCING 2 LINES                          12580000
123500                                                                  12590000
123600             WRITE KMRC-REPORT-RECORD                             12600000
123700                 FROM REPORT-TOTALS-FULFILLED-TODAY               12610000
123800                 AFTER ADVANCING 1 LINES                          12620000
123900                                                                  12630000
124000             WRITE KMRC-REPORT-RECORD                             12640000
124100                 FROM REPORT-TOT-NOT-FULFILL-TODAY                12650000
124200                 AFTER ADVANCING 1 LINES                          12660000
124300                                                                  12670000
124400             WRITE KMRC-REPORT-RECORD                             12680000
124500                 FROM REPORT-TOT-NOT-FULFILL-PRIOR                12690000
124600                 AFTER ADVANCING 1 LINES                          12700000
124700         END-IF                                                   12710000
124800     ELSE                                                         12720000
124900         WRITE GIFT-REPORT-RECORD                                 12730000
125000             FROM REPORT-AUDIT-POS-ISSUED-LINE                    12740000
125100             AFTER ADVANCING 2 LINES                              12750000
125200                                                                  12760000
125300         WRITE GIFT-REPORT-RECORD                                 12770000
125400             FROM REPORT-AUDIT-POS-VERIFIED-LINE                  12780000
125500             AFTER ADVANCING 1 LINES                              12790000
125600                                                                  12800000
125700         WRITE GIFT-REPORT-RECORD                                 12810000
125800             FROM REPORT-AUDIT-POS-AUTHOR-LINE                    12820000
125900             AFTER ADVANCING 1 LINE                               12830000
126000                                                                  12840000
126100         WRITE GIFT-REPORT-RECORD                                 12850000
126200             FROM REPORT-AUDIT-POS-COMPANY-LINE                   12860000
126300             AFTER ADVANCING 1 LINE                               12870000
126400                                                                  12880000
126500         IF CR-ECOMM                                              12890000
126600             WRITE GIFT-REPORT-RECORD                             12900000
126700                 FROM REPORT-TOTALS                               12910000
126800                 AFTER ADVANCING 2 LINES                          12920000
126900                                                                  12930000
127000             WRITE GIFT-REPORT-RECORD                             12940000
127100                 FROM REPORT-TOTALS-FULFILLED-TODAY               12950000
127200                 AFTER ADVANCING 1 LINES                          12960000
127300                                                                  12970000
127400             WRITE GIFT-REPORT-RECORD                             12980000
127500                 FROM REPORT-TOT-NOT-FULFILL-TODAY                12990000
127600                 AFTER ADVANCING 1 LINES                          13000000
127700                                                                  13010000
127800             WRITE GIFT-REPORT-RECORD                             13020000
127900                 FROM REPORT-TOT-NOT-FULFILL-PRIOR                13030000
128000                 AFTER ADVANCING 1 LINES                          13040000
128100         END-IF                                                   13050000
128200     END-IF.                                                      13060000
128300                                                                  13070000
128400     ADD PC-TWO  TO PA-LINE-COUNTER.                              13080000
128500                                                                  13090000
128600     IF PA-LINE-COUNTER > PC-MAX-LINES-PER-PAGE                   13100000
128700         PERFORM D100-PROCESS-PAGE-BREAK                          13110000
128800         PERFORM E100-PRINT-STORE-LINE                            13120000
128900     END-IF.                                                      13130000
129000                                                                  13140000
129100     IF PV-HOLD-CRD-TYP-CDE = SV004-KMRC-CRD-TYP                  13150000
129200         WRITE KMRC-REPORT-RECORD                                 13160000
129300             FROM REPORT-AUDIT-ENDING-LINE                        13170000
129400             AFTER ADVANCING 3 LINES                              13180000
129500     ELSE                                                         13190000
129600         WRITE GIFT-REPORT-RECORD                                 13200000
129700             FROM REPORT-AUDIT-ENDING-LINE                        13210000
129800             AFTER ADVANCING 3 LINES                              13220000
129900     END-IF.                                                      13230000
130000                                                                  13240000
130100******************************************************************13250000
130200*     C100-READ-AUDIT-FILE                                       *13260000
130300* ==> PROCESSES:                                                 *13270000
130400*     - READS A RECORD FROM THE AUDIT REPORT FILE                *13280000
130500*     - COUNTS THE NUMBER OF RECORDS READ                        *13290000
130600* ==> PERFORMED FROM:  B100-INITIALIZE                           *13300000
130700*                      B200-WRITE-REPORT                         *13310000
130800******************************************************************13320000
130900 C100-READ-AUDIT-FILE.                                            13330000
131000                                                                  13340000
131100     READ AUDIT-REPORT-FILE INTO SV019-AUDIT-REPORT-RECORD        13350000
131200         AT END                                                   13360000
131300             SET PS-END-OF-AUDIT-FILE TO TRUE.                    13370000
131400                                                                  13380000
131500     IF PS-END-OF-AUDIT-FILE                                      13390006
131600         CONTINUE                                                 13400000
131700     ELSE                                                         13410000
131800         ADD PC-ONE TO PA-AUDIT-FILE-RECS-READ                    13420000
131900     END-IF.                                                      13430000
132000                                                                  13440000
132100******************************************************************13450000
132200*     C200-PRINT-DETAIL                                          *13460000
132300* ==> PROCESSES:                                                 *13470000
132400*     - WRITES THE DETAIL LINES FOR THE REPORT                   *13480000
132500* ==> PERFORMED FROM:  B200-WRITE-REPORT                         *13490000
132600******************************************************************13500000
132700 C200-PRINT-DETAIL.                                               13510000
132800                                                                  13520000
132900     IF PA-LINE-COUNTER > PC-MAX-LINES-PER-PAGE                   13530000
133000         PERFORM D100-PROCESS-PAGE-BREAK                          13540000
133100         PERFORM E100-PRINT-STORE-LINE                            13550000
133200     END-IF.                                                      13560000
133300                                                                  13570000
133400     IF PV-HOLD-CRD-TYP-CDE = SV004-KMRC-CRD-TYP                  13580000
133500         WRITE KMRC-REPORT-RECORD                                 13590000
133600             FROM REPORT-AUDIT-DETAIL-LINE                        13600000
133700             AFTER ADVANCING 1 LINE                               13610000
133800         ADD PC-ONE TO PA-KMRC-REPORT-RECORDS-WRITTEN             13620000
133900         SET PS-KMRC-NOT-EMPTY TO TRUE                            13630000
134000     ELSE                                                         13640000
134100         WRITE GIFT-REPORT-RECORD                                 13650000
134200             FROM REPORT-AUDIT-DETAIL-LINE                        13660000
134300             AFTER ADVANCING 1 LINE                               13670000
134400         ADD PC-ONE TO PA-GIFT-REPORT-RECORDS-WRITTEN             13680000
134500         SET PS-GIFT-NOT-EMPTY TO TRUE                            13690000
134600     END-IF.                                                      13700000
134700                                                                  13710000
134800     ADD PC-ONE TO PA-LINE-COUNTER.                               13720000
134900                                                                  13730000
135000******************************************************************13740000
135100*     C200P-PRINT-DETAIL                                         *13750000
135200* ==> PROCESSES:                                                 *13760000
135300*     - WRITES THE DETAIL LINES FOR THE REPORT OF PREV TRANS     *13770000
135400* ==> PERFORMED FROM:  B200-WRITE-REPORT                         *13780000
135500******************************************************************13790000
135600 C200P-PRINT-DETAIL.                                              13800000
135700                                                                  13810000
135800     IF PA-P-LINE-COUNTER > PC-MAX-LINES-PER-PAGE                 13820000
135900         PERFORM D100P-PROCESS-PAGE-BREAK                         13830000
136000         PERFORM E100P-PRINT-STORE-LINE                           13840000
136100     END-IF.                                                      13850000
136200                                                                  13860000
136300     IF PV-HOLD-CRD-TYP-CDE = SV004-KMRC-CRD-TYP                  13870000
136400         WRITE KMRC-PREV-RECORD                                   13880000
136500             FROM REPORT-AUDIT-DETAIL-LINE                        13890000
136600             AFTER ADVANCING 1 LINE                               13900000
136700         ADD PC-ONE TO PA-KMRC-REPORT-RECORDS-WRITTEN             13910000
136800         SET PS-KMRC-NOT-EMPTY TO TRUE                            13920000
136900     ELSE                                                         13930000
137000         WRITE GIFT-PREV-RECORD                                   13940000
137100             FROM REPORT-AUDIT-DETAIL-LINE                        13950000
137200             AFTER ADVANCING 1 LINE                               13960000
137300         ADD PC-ONE TO PA-GIFT-REPORT-RECORDS-WRITTEN             13970000
137400         SET PS-GIFT-NOT-EMPTY TO TRUE                            13980000
137500     END-IF.                                                      13990000
137600                                                                  14000000
137700     ADD PC-ONE TO PA-P-LINE-COUNTER.                             14010000
137800                                                                  14020000
137900******************************************************************14030000
138000*     C475-DAILY-POS-ONLINE-DLRS-ISS                             *14040000
138100* ==> PROCESSES:                                                 *14050000
138200*     - DOES A SUM ON SVT_KOHLS_CRD_TXN                           14060000
138300*     -                       CALCULATING THE DAILY POS DOLLARS  *14070000
138400*       THAT WAS ISSUED ON-LINE (HAS A APVL-USR-ID = RDUCRD)     *14080000
138500*     - SQLCODE = -305, ERROR:  THE NULL VALUE CANNOT BE ASSIGNED*14090000
138600*       TO OUTPUT HOST VARIABLE NUMBER 001 BECAUSE NO INDICATOR  *14100000
138700*       VARIABLE IS SPECIFIED                                    *14110000
138800*       - THIS ERROR MEANS THAT NONE OF THE ROWS QUALIFIED FOR   *14120000
138900*         THE SUM AND A NULL VALUE WAS RETURNED.  IF A NULL      *14130000
139000*         INDICATOR VARIABLE WAS PLACED NEXT TO THE HOST VARIABLE*14140000
139100*         THE SQLCODE WOULD HAVE BEEN A ZERO.                    *14150000
139200* ==> PERFORMED FROM:  B300-EOJ-ROUTINE                          *14160000
139300******************************************************************14170000
139400 C475-DAILY-POS-ONLINE-DLRS-ISS.                                  14180000
139500                                                                  14190000
139600     EXEC SQL                                                     14200000
139700         SELECT  SUM(APP_AUTH_AMT)                                14210000
139800           INTO  :PV-DAILY-POS-DOLLARS-ISSUED                     14220000
139900           FROM  SVT_KOHLS_CRD_TXN A,                             14230000
140000                 SVT_KOHLS_CRD_ACCT T                             14240000
140100          WHERE  A.CRD_NBR     = T.CRD_NBR                        14250000
140200            AND  CRD_TYP_CDE   = :SVT00001-CRD-TYP-CDE            14260000
140300            AND  ACTVY_TYP_CDE = :SVT00002-ACTVY-TYP-CDE          14270000
140400            AND  (APVL_USR_ID   = :SV004-ISSUE-MNEMONIC           14280000
140500            OR    APVL_USR_ID   = :PC-PEPLSOFT)                   14290000
140600            AND  TRN_VOID_IND  <> :PC-Y                           14300000
140700            AND  POS_DTE       = :CR-CONTROL-DATE                 14310000
140800     END-EXEC.                                                    14320000
140900                                                                  14330000
141000     EVALUATE TRUE                                                14340000
141100         WHEN SQLCODE = +0                                        14350000
141200             MOVE PV-DAILY-POS-DOLLARS-ISSUED                     14360000
141300                               TO RPT-ON-LINE-POS-DOLLARS-ISSUED  14370000
141400         WHEN SQLCODE = -305                                      14380000
141500             MOVE ZERO         TO RPT-ON-LINE-POS-DOLLARS-ISSUED  14390000
141600         WHEN OTHER                                               14400000
141700             MOVE 'C475-DAILY-ONLIN-POS-DLRS-ISS'                 14410000
141800                               TO PV-PARAGRAPH-NAME               14420000
141900             MOVE 'SUM OF ISSUED POS AUTH AMTS   '                14430000
142000                               TO PV-DB2-OPERATION-ATTEMPTED      14440000
142100             PERFORM Z900-SQL-ABEND                               14450000
142200     END-EVALUATE.                                                14460000
142300******************************************************************14470000
142400*     C600-GET-CARD-STOCK-TYPE                                   *14480000
142500* ==> PROCESSES:                                                 *14490000
142600*     - RETREIVES THE CARDS STOCK TYPE ID FROM SVT_CRD_PROD      *14500000
142700* ==> PERFORMED FROM:  B300-EOJ-ROUTINE                          *14510000
142800******************************************************************14520000
142900 C600-GET-CARD-STOCK-TYPE.                                        14530000
143000                                                                  14540000
143100     EXEC SQL                                                     14550000
143200         SELECT  C.CRD_TYP_CDE,                                   14560000
143300                 CRD_STK_TYP_ID                                   14570000
143400           INTO  :SVT00001-CRD-TYP-CDE,                           14580000
143500                 :SVT00000-CRD-STK-TYP-ID                         14590000
143600           FROM  SVT_CRD_PROD C,                                  14600000
143700                 SVT_KOHLS_CRD_ACCT T                             14610000
143800          WHERE  T.CRD_NBR        =  :SV019-KMC-CRD-NBR           14620000
143900            AND  T.CRD_PROD_YR    = C.CRD_PROD_YR                 14630000
144000            AND  T.SHIPT_REQ_NBR  = C.SHIPT_REQ_NBR               14640000
144100     END-EXEC.                                                    14650000
144200                                                                  14660000
144300     EVALUATE TRUE                                                14670000
144400         WHEN SQLCODE = +0                                        14680000
144500             IF SVT00001-CRD-TYP-CDE = SV004-KMRC-CRD-TYP         14690000
144600                 MOVE SPACES   TO RPT-AUDIT-CARD-TYPE             14700000
144700             ELSE                                                 14710000
144800                 MOVE SVT00000-CRD-STK-TYP-ID                     14720000
144900                               TO RPT-AUDIT-CARD-TYPE             14730000
145000             END-IF                                               14740000
145100         WHEN SQLCODE = +100                                      14750000
145200             MOVE SPACES       TO RPT-AUDIT-CARD-TYPE             14760000
145300         WHEN OTHER                                               14770000
145400             MOVE 'C600-GET-CARD-STOCK-TYPE      '                14780000
145500                               TO PV-PARAGRAPH-NAME               14790000
145600             MOVE 'RETRIEVE THE TYPE OF CARD     '                14800000
145700                               TO PV-DB2-OPERATION-ATTEMPTED      14810000
145800             PERFORM Z900-SQL-ABEND                               14820000
145900     END-EVALUATE.                                                14830000
146000                                                                  14840000
146100******************************************************************14850000
146200*     D100-PROCESS-PAGE-BREAK.                                   *14860000
146300* ==> PROCESSES:                                                 *14870000
146400*     - ADVANCES TO A NEW PAGE AND WRITES THE REPORT HEADINGS    *14880000
146500* ==> PERFORMED FROM:  B100-INITIALIZE                           *14890000
146600*                      B300-EOJ-ROUTINE                          *14900000
146700*                      C200-PRINT-DETAIL                         *14910000
146800******************************************************************14920000
146900 D100-PROCESS-PAGE-BREAK.                                         14930000
147000                                                                  14940000
147100     ADD PC-ONE                TO PA-PAGE-COUNTER.                14950000
147200     MOVE PA-PAGE-COUNTER      TO DP200O-PAGE-NUMBER.             14960000
147300     IF PV-HOLD-CRD-TYP-CDE = SV004-KMRC-CRD-TYP                  14970000
147400         SET PS-KMRC-NOT-EMPTY TO TRUE                            14980000
147500         MOVE PC-ONE           TO DP200O-REPORT-NUMBER            14990000
147600         WRITE KMRC-REPORT-RECORD                                 15000000
147700             FROM DP200O-STANDRD-HEADER-200-COLS                  15010000
147800             AFTER ADVANCING PAGE                                 15020000
147900         MOVE PV-HDR-POSTING-DATE TO RC-KMRC-DATE                 15030000
148000         SET RC-KMRC-CURR-DATE    TO TRUE                         15040000
148100         MOVE RC-KMRC-TITLE-LINE   TO TL-HEADING                  15050000
148200                                                                  15060000
148300         WRITE KMRC-REPORT-RECORD                                 15070000
148400             FROM REPORT-AUDIT-TITLE-LINE                         15080000
148500             AFTER ADVANCING 1 LINE                               15090000
148600                                                                  15100000
148700         WRITE KMRC-REPORT-RECORD                                 15110000
148800             FROM REPORT-AUDIT-HEADING-LINE1                      15120000
148900             AFTER ADVANCING 1 LINE                               15130000
149000                                                                  15140000
149100         WRITE KMRC-REPORT-RECORD                                 15150000
149200             FROM REPORT-AUDIT-HEADING-LINE2                      15160000
149300             AFTER ADVANCING 1 LINE                               15170000
149400                                                                  15180000
149500         WRITE KMRC-REPORT-RECORD                                 15190000
149600             FROM REPORT-AUDIT-HEADING-LINE3                      15200000
149700             AFTER ADVANCING 1 LINE                               15210000
149800                                                                  15220000
149900         WRITE KMRC-REPORT-RECORD                                 15230000
150000             FROM REPORT-AUDIT-HEADING-LINE4                      15240000
150100             AFTER ADVANCING 1 LINE                               15250000
150200                                                                  15260000
150300         WRITE KMRC-REPORT-RECORD                                 15270000
150400             FROM REPORT-AUDIT-BLANK-LINE                         15280000
150500             AFTER ADVANCING 1 LINE                               15290000
150600     ELSE                                                         15300000
150700         SET PS-GIFT-NOT-EMPTY TO TRUE                            15310000
150800         MOVE PC-TWO           TO DP200O-REPORT-NUMBER            15320000
150900         WRITE GIFT-REPORT-RECORD                                 15330000
151000             FROM DP200O-STANDRD-HEADER-200-COLS                  15340000
151100             AFTER ADVANCING PAGE                                 15350000
151200         MOVE PV-HDR-POSTING-DATE TO RC-GIFT-DATE                 15360000
151300         SET RC-GIFT-CURR-DATE    TO TRUE                         15370000
151400         MOVE RC-GIFT-TITLE-LINE   TO TL-HEADING                  15380000
151500                                                                  15390000
151600         WRITE GIFT-REPORT-RECORD                                 15400000
151700             FROM REPORT-AUDIT-TITLE-LINE                         15410000
151800             AFTER ADVANCING 1 LINE                               15420000
151900                                                                  15430000
152000         WRITE GIFT-REPORT-RECORD                                 15440000
152100             FROM REPORT-AUDIT-HEADING-LINE1                      15450000
152200             AFTER ADVANCING 1 LINE                               15460000
152300                                                                  15470000
152400         WRITE GIFT-REPORT-RECORD                                 15480000
152500             FROM REPORT-AUDIT-HEADING-LINE2                      15490000
152600             AFTER ADVANCING 1 LINE                               15500000
152700                                                                  15510000
152800         WRITE GIFT-REPORT-RECORD                                 15520000
152900             FROM REPORT-AUDIT-HEADING-LINE3                      15530000
153000             AFTER ADVANCING 1 LINE                               15540000
153100                                                                  15550000
153200         WRITE GIFT-REPORT-RECORD                                 15560000
153300             FROM REPORT-AUDIT-HEADING-LINE4                      15570000
153400             AFTER ADVANCING 1 LINE                               15580000
153500                                                                  15590000
153600         WRITE GIFT-REPORT-RECORD                                 15600000
153700             FROM REPORT-AUDIT-BLANK-LINE                         15610000
153800             AFTER ADVANCING 1 LINE                               15620000
153900     END-IF.                                                      15630000
154000                                                                  15640000
154100     MOVE PC-HEADER-LINE-COUNT TO PA-LINE-COUNTER.                15650000
154200                                                                  15660000
154300******************************************************************15670000
154400*     D100P-PROCESS-PAGE-BREAK.                                  *15680000
154500* ==> PROCESSES:                                                 *15690000
154600*     - ADVANCES TO A NEW PAGE AND WRITES THE REPORT HEADINGS    *15700000
154700*       FOR PREV DAYS TRANS                                      *15710000
154800* ==> PERFORMED FROM:  C200P-PRINT-DETAIL                        *15720000
154900******************************************************************15730000
155000 D100P-PROCESS-PAGE-BREAK.                                        15740000
155100                                                                  15750000
155200     ADD PC-ONE                TO PA-P-PAGE-COUNTER.              15760000
155300     MOVE PA-P-PAGE-COUNTER    TO DP200O-PAGE-NUMBER.             15770000
155400     IF PV-HOLD-CRD-TYP-CDE = SV004-KMRC-CRD-TYP                  15780000
155500         SET PS-KMRC-NOT-EMPTY TO TRUE                            15790000
155600         MOVE PC-THREE         TO DP200O-REPORT-NUMBER            15800000
155700         WRITE KMRC-PREV-RECORD                                   15810000
155800             FROM DP200O-STANDRD-HEADER-200-COLS                  15820000
155900             AFTER ADVANCING PAGE                                 15830000
156000         MOVE PV-HDR-POSTING-DATE TO RC-KMRC-DATE                 15840000
156100         SET RC-KMRC-PREV-DATE    TO TRUE                         15850000
156200         MOVE RC-KMRC-TITLE-LINE   TO TL-HEADING                  15860000
156300                                                                  15870000
156400         WRITE KMRC-PREV-RECORD                                   15880000
156500             FROM REPORT-AUDIT-TITLE-LINE                         15890000
156600             AFTER ADVANCING 1 LINE                               15900000
156700                                                                  15910000
156800         WRITE KMRC-PREV-RECORD                                   15920000
156900             FROM REPORT-AUDIT-HEADING-LINE1                      15930000
157000             AFTER ADVANCING 1 LINE                               15940000
157100                                                                  15950000
157200         WRITE KMRC-PREV-RECORD                                   15960000
157300             FROM REPORT-AUDIT-HEADING-LINE2                      15970000
157400             AFTER ADVANCING 1 LINE                               15980000
157500                                                                  15990000
157600         WRITE KMRC-PREV-RECORD                                   16000000
157700             FROM REPORT-AUDIT-HEADING-LINE3                      16010000
157800             AFTER ADVANCING 1 LINE                               16020000
157900                                                                  16030000
158000         WRITE KMRC-PREV-RECORD                                   16040000
158100             FROM REPORT-AUDIT-HEADING-LINE4                      16050000
158200             AFTER ADVANCING 1 LINE                               16060000
158300                                                                  16070000
158400         WRITE KMRC-PREV-RECORD                                   16080000
158500             FROM REPORT-AUDIT-BLANK-LINE                         16090000
158600             AFTER ADVANCING 1 LINE                               16100000
158700     ELSE                                                         16110000
158800         SET PS-GIFT-NOT-EMPTY TO TRUE                            16120000
158900         MOVE PC-FOUR          TO DP200O-REPORT-NUMBER            16130000
159000         WRITE GIFT-PREV-RECORD                                   16140000
159100             FROM DP200O-STANDRD-HEADER-200-COLS                  16150000
159200             AFTER ADVANCING PAGE                                 16160000
159300         MOVE PV-HDR-POSTING-DATE TO RC-GIFT-DATE                 16170000
159400         SET RC-GIFT-PREV-DATE    TO TRUE                         16180000
159500         MOVE RC-GIFT-TITLE-LINE   TO TL-HEADING                  16190000
159600                                                                  16200000
159700         WRITE GIFT-PREV-RECORD                                   16210000
159800             FROM REPORT-AUDIT-TITLE-LINE                         16220000
159900             AFTER ADVANCING 1 LINE                               16230000
160000                                                                  16240000
160100         WRITE GIFT-PREV-RECORD                                   16250000
160200             FROM REPORT-AUDIT-HEADING-LINE1                      16260000
160300             AFTER ADVANCING 1 LINE                               16270000
160400                                                                  16280000
160500         WRITE GIFT-PREV-RECORD                                   16290000
160600             FROM REPORT-AUDIT-HEADING-LINE2                      16300000
160700             AFTER ADVANCING 1 LINE                               16310000
160800                                                                  16320000
160900         WRITE GIFT-PREV-RECORD                                   16330000
161000             FROM REPORT-AUDIT-HEADING-LINE3                      16340000
161100             AFTER ADVANCING 1 LINE                               16350000
161200                                                                  16360000
161300         WRITE GIFT-PREV-RECORD                                   16370000
161400             FROM REPORT-AUDIT-HEADING-LINE4                      16380000
161500             AFTER ADVANCING 1 LINE                               16390000
161600                                                                  16400000
161700         WRITE GIFT-PREV-RECORD                                   16410000
161800             FROM REPORT-AUDIT-BLANK-LINE                         16420000
161900             AFTER ADVANCING 1 LINE                               16430000
162000     END-IF.                                                      16440000
162100                                                                  16450000
162200     MOVE PC-HEADER-LINE-COUNT TO PA-P-LINE-COUNTER.              16460000
162300                                                                  16470000
162400******************************************************************16480000
162500*     E100-PRINT-STORE-LINE.                                     *16490000
162600* ==> PROCESSES:                                                 *16500000
162700*     - WRITES THE STORE/POS DATE LINE ON THE REPORT             *16510000
162800* ==> PERFORMED FROM:  B200-WRITE-REPORT                         *16520000
162900*                      D100-PROCESS-PAGE-BREAK                   *16530000
163000******************************************************************16540000
163100 E100-PRINT-STORE-LINE.                                           16550000
163200                                                                  16560000
163300     IF PA-LINE-COUNTER > PC-MAX-LINES-PER-PAGE                   16570000
163400         PERFORM D100-PROCESS-PAGE-BREAK                          16580000
163500     END-IF.                                                      16590000
163600                                                                  16600000
163700     MOVE PV-HOLD-STORE-NBR TO RPT-AUDIT-STORE-NBR.               16610000
163800                                                                  16620000
163900     MOVE PV-HOLD-POS-DATE  TO PV-POS-DATE.                       16630000
164000     MOVE PV-POS-DATE-MM    TO RPT-AUDIT-POS-DATE-MM.             16640000
164100     MOVE PV-POS-DATE-DD    TO RPT-AUDIT-POS-DATE-DD.             16650000
164200     MOVE PV-POS-DATE-CC    TO RPT-AUDIT-POS-DATE-CC.             16660000
164300     MOVE PV-POS-DATE-YY    TO RPT-AUDIT-POS-DATE-YY.             16670000
164400                                                                  16680000
164500     IF PV-HOLD-CRD-TYP-CDE = SV004-KMRC-CRD-TYP                  16690000
164600         WRITE KMRC-REPORT-RECORD                                 16700000
164700             FROM REPORT-AUDIT-BLANK-LINE                         16710000
164800             AFTER ADVANCING 1 LINE                               16720000
164900                                                                  16730000
165000         WRITE KMRC-REPORT-RECORD                                 16740000
165100             FROM REPORT-AUDIT-STORE-LINE                         16750000
165200             AFTER ADVANCING 1 LINE                               16760000
165300                                                                  16770000
165400         WRITE KMRC-REPORT-RECORD                                 16780000
165500             FROM REPORT-AUDIT-BLANK-LINE                         16790000
165600             AFTER ADVANCING 1 LINE                               16800000
165700     ELSE                                                         16810000
165800         WRITE GIFT-REPORT-RECORD                                 16820000
165900             FROM REPORT-AUDIT-BLANK-LINE                         16830000
166000             AFTER ADVANCING 1 LINE                               16840000
166100                                                                  16850000
166200         WRITE GIFT-REPORT-RECORD                                 16860000
166300             FROM REPORT-AUDIT-STORE-LINE                         16870000
166400             AFTER ADVANCING 1 LINE                               16880000
166500                                                                  16890000
166600         WRITE GIFT-REPORT-RECORD                                 16900000
166700             FROM REPORT-AUDIT-BLANK-LINE                         16910000
166800             AFTER ADVANCING 1 LINE                               16920000
166900     END-IF.                                                      16930000
167000                                                                  16940000
167100     ADD PC-THREE TO PA-LINE-COUNTER.                             16950000
167200                                                                  16960000
167300******************************************************************16970000
167400*     E100P-PRINT-STORE-LINE.                                    *16980000
167500* ==> PROCESSES:                                                 *16990000
167600*     - WRITES THE STORE/POS DATE LINE ON THE REPORT FOR PREV    *17000000
167700* ==> PERFORMED FROM:  B200-WRITE-REPORT                         *17010000
167800*                      D100P-PROCESS-PAGE-BREAK                  *17020000
167900******************************************************************17030000
168000 E100P-PRINT-STORE-LINE.                                          17040000
168100                                                                  17050000
168200     IF PA-P-LINE-COUNTER > PC-MAX-LINES-PER-PAGE                 17060000
168300         PERFORM D100P-PROCESS-PAGE-BREAK                         17070000
168400     END-IF.                                                      17080000
168500                                                                  17090000
168600     MOVE PV-HOLD-STORE-NBR TO RPT-AUDIT-STORE-NBR.               17100000
168700                                                                  17110000
168800     MOVE PV-HOLD-POS-DATE  TO PV-POS-DATE.                       17120000
168900     MOVE PV-POS-DATE-MM    TO RPT-AUDIT-POS-DATE-MM.             17130000
169000     MOVE PV-POS-DATE-DD    TO RPT-AUDIT-POS-DATE-DD.             17140000
169100     MOVE PV-POS-DATE-CC    TO RPT-AUDIT-POS-DATE-CC.             17150000
169200     MOVE PV-POS-DATE-YY    TO RPT-AUDIT-POS-DATE-YY.             17160000
169300                                                                  17170000
169400     IF PV-HOLD-CRD-TYP-CDE = SV004-KMRC-CRD-TYP                  17180000
169500         WRITE KMRC-PREV-RECORD                                   17190000
169600             FROM REPORT-AUDIT-BLANK-LINE                         17200000
169700             AFTER ADVANCING 1 LINE                               17210000
169800                                                                  17220000
169900         WRITE KMRC-PREV-RECORD                                   17230000
170000             FROM REPORT-AUDIT-STORE-LINE                         17240000
170100             AFTER ADVANCING 1 LINE                               17250000
170200                                                                  17260000
170300         WRITE KMRC-PREV-RECORD                                   17270000
170400             FROM REPORT-AUDIT-BLANK-LINE                         17280000
170500             AFTER ADVANCING 1 LINE                               17290000
170600     ELSE                                                         17300000
170700         WRITE GIFT-PREV-RECORD                                   17310000
170800             FROM REPORT-AUDIT-BLANK-LINE                         17320000
170900             AFTER ADVANCING 1 LINE                               17330000
171000                                                                  17340000
171100         WRITE GIFT-PREV-RECORD                                   17350000
171200             FROM REPORT-AUDIT-STORE-LINE                         17360000
171300             AFTER ADVANCING 1 LINE                               17370000
171400                                                                  17380000
171500         WRITE GIFT-PREV-RECORD                                   17390000
171600             FROM REPORT-AUDIT-BLANK-LINE                         17400000
171700             AFTER ADVANCING 1 LINE                               17410000
171800     END-IF.                                                      17420000
171900                                                                  17430000
172000     ADD PC-THREE TO PA-P-LINE-COUNTER.                           17440000
172100                                                                  17450000
172200******************************************************************17460000
172300*     F100-PRINT-STORE-TOTAL-LINE                                *17470000
172400* ==> PROCESSES:                                                 *17480000
172500*     - WRITES THE STORE TOTAL LINE ON THE REPORT                *17490000
172600* ==> PERFORMED FROM:  B200-WRITE-REPORT                         *17500000
172700******************************************************************17510000
172800 F100-PRINT-STORE-TOTAL-LINE.                                     17520000
172900                                                                  17530000
173000     IF PA-LINE-COUNTER > PC-MAX-LINES-PER-PAGE                   17540000
173100         PERFORM D100-PROCESS-PAGE-BREAK                          17550000
173200         PERFORM E100-PRINT-STORE-LINE                            17560000
173300     END-IF.                                                      17570000
173400                                                                  17580000
173500     EVALUATE TRUE                                                17590000
173600         WHEN PV-HOLD-STORE-NBR = PC-STORE-090                    17600000
173700         WHEN PV-HOLD-STORE-NBR = PC-STORE-873                    17610000
173800         WHEN PV-HOLD-STORE-NBR = PC-STORE-880                    17620000
173900             MOVE PV-HOLD-STORE-NBR TO RPT-AUDIT-STORE-TOTAL-NBR  17630000
174000             MOVE PV-DAILY-STORE-TOTAL-I TO                       17640000
174100                  RPT-AUDIT-STORE-TOTAL-AMT-I                     17650000
174200             MOVE PV-DAILY-STORE-TOTAL-T TO                       17660000
174300                  RPT-AUDIT-STORE-TOTAL-AMT-T                     17670000
174400             IF PV-HOLD-CRD-TYP-CDE = SV004-KMRC-CRD-TYP          17680000
174500                 WRITE KMRC-REPORT-RECORD                         17690000
174600                     FROM REPORT-AUDIT-BLANK-LINE                 17700000
174700                     AFTER ADVANCING 1 LINE                       17710000
174800                 WRITE KMRC-REPORT-RECORD                         17720000
174900                     FROM REPORT-AUDIT-STORE-TOTAL-LINE           17730000
175000                     AFTER ADVANCING 1 LINE                       17740000
175100             ELSE                                                 17750000
175200                 WRITE GIFT-REPORT-RECORD                         17760000
175300                     FROM REPORT-AUDIT-BLANK-LINE                 17770000
175400                     AFTER ADVANCING 1 LINE                       17780000
175500                 WRITE GIFT-REPORT-RECORD                         17790000
175600                     FROM REPORT-AUDIT-STORE-TOTAL-LINE           17800000
175700                     AFTER ADVANCING 1 LINE                       17810000
175800             END-IF                                               17820000
175900             ADD PC-TWO TO PA-LINE-COUNTER                        17830000
176000     END-EVALUATE.                                                17840000
176100     MOVE ZERO TO PV-DAILY-STORE-TOTAL-I                          17850000
176200                  PV-DAILY-STORE-TOTAL-T.                         17860000
176300                                                                  17870000
176400******************************************************************17880000
176500*     F100P-PRINT-STORE-TOTAL-LINE                               *17890000
176600* ==> PROCESSES:                                                 *17900000
176700*     - WRITES THE STORE TOTAL LINE ON THE REPORT                *17910000
176800* ==> PERFORMED FROM:  B200-WRITE-REPORT                         *17920000
176900******************************************************************17930000
177000 F100P-PRINT-STORE-TOTAL-LINE.                                    17940000
177100                                                                  17950000
177200     IF PA-P-LINE-COUNTER > PC-MAX-LINES-PER-PAGE                 17960000
177300         PERFORM D100P-PROCESS-PAGE-BREAK                         17970000
177400         PERFORM E100P-PRINT-STORE-LINE                           17980000
177500     END-IF.                                                      17990000
177600                                                                  18000000
177700     EVALUATE TRUE                                                18010000
177800         WHEN PV-HOLD-STORE-NBR = PC-STORE-090                    18020000
177900         WHEN PV-HOLD-STORE-NBR = PC-STORE-873                    18030000
178000         WHEN PV-HOLD-STORE-NBR = PC-STORE-880                    18040000
178100             MOVE PV-HOLD-STORE-NBR TO RPT-AUDIT-STORE-TOTAL-NBR  18050000
178200             MOVE PV-DAILY-STORE-TOTAL-I TO                       18060000
178300                  RPT-AUDIT-STORE-TOTAL-AMT-I                     18070000
178400             MOVE PV-DAILY-STORE-TOTAL-T TO                       18080000
178500                  RPT-AUDIT-STORE-TOTAL-AMT-T                     18090000
178600             IF PV-HOLD-CRD-TYP-CDE = SV004-KMRC-CRD-TYP          18100000
178700                 WRITE KMRC-PREV-RECORD                           18110000
178800                     FROM REPORT-AUDIT-BLANK-LINE                 18120000
178900                     AFTER ADVANCING 1 LINE                       18130000
179000                 WRITE KMRC-PREV-RECORD                           18140000
179100                     FROM REPORT-AUDIT-STORE-TOTAL-LINE           18150000
179200                     AFTER ADVANCING 1 LINE                       18160000
179300             ELSE                                                 18170000
179400                 WRITE GIFT-PREV-RECORD                           18180000
179500                     FROM REPORT-AUDIT-BLANK-LINE                 18190000
179600                     AFTER ADVANCING 1 LINE                       18200000
179700                 WRITE GIFT-PREV-RECORD                           18210000
179800                     FROM REPORT-AUDIT-STORE-TOTAL-LINE           18220000
179900                     AFTER ADVANCING 1 LINE                       18230000
180000             END-IF                                               18240000
180100             ADD PC-TWO TO PA-P-LINE-COUNTER                      18250000
180200     END-EVALUATE.                                                18260000
180300     MOVE ZERO TO PV-DAILY-STORE-TOTAL-I                          18270000
180400                  PV-DAILY-STORE-TOTAL-T.                         18280000
180500                                                                  18290000
180600******************************************************************18300000
180700*     Z900-SQL-ABEND                                             *18310000
180800* ==> PROCESSES:                                                 *18320000
180900*     -PERFORMS ABEND PROCESSING FOR SQL ERRORS.                 *18330000
181000* ==> PERFORMED FROM:                                            *18340000
181100******************************************************************18350000
181200 Z900-SQL-ABEND.                                                  18360000
181300                                                                  18370000
181400     DISPLAY 'Z900-SQL-ABEND'.                                    18380000
181500     DISPLAY '**  ABEND     **'.                                  18390000
181600     DISPLAY '**  PROGRAM   ** = ' PC-PROGRAM-NAME.               18400000
181700     DISPLAY '**  PARAGRAPH ** = ' PV-PARAGRAPH-NAME.             18410000
181800     DISPLAY '**  OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.    18420000
181900                                                                  18430000
182000******************************************************************18440000
182100* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *18450000
182200* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *18460000
182300* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *18470000
182400* FORMAT.                                                        *18480000
182500******************************************************************18490000
182600     COPY DPPD004.                                                18500000
182700                                                                  18510000
182800     MOVE +4013 TO ABEND-CODE.                                    18520000
182900     CALL 'ILBOABN0' USING ABEND-CODE.                            18530007
