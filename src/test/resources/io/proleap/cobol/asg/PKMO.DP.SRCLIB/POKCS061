000100* VERSION FOR MULTI PREPACK PLUS NISKU                            00010039
000200*-----------------------*                                         00020039
000300 IDENTIFICATION DIVISION.                                         00030039
000400*-----------------------*                                         00040039
000500 PROGRAM-ID.    POKCS061.                                         00050039
000600 AUTHOR.        TIM SMITH.                                        00060039
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070039
000800 DATE-WRITTEN.  02-03-94.                                         00080039
000900 DATE-COMPILED.                                                   00090039
001000                                                                  00100039
001100*---------------------------------------------------------------* 00110039
001200*    W061 - DC SPLIT PO LIST PROGRAM.                           * 00120039
001300*                                                               * 00130039
001400*---------------------------------------------------------------* 00140039
001500*                                                               * 00150039
001600*    CHANGED TO ADD A RELEASE DATE COLUMN ON THE SCREEN FOR     * 00160039
001700*    EACH PO LINE.                                              * 00170039
001800*                                                               * 00180039
001900*    PAUL KEBER - STRATAGEM    05/09/95                         * 00190039
002000*---------------------------------------------------------------* 00200039
002100* DATE  09/01/98                                                  00210039
002200*     CHANGE MADE: FOR PRODUCT PACKAGING PROJECT, MODIFIED JCL TO 00220039
002300*            PULL IN NEW PROGRAMS POKRP080/POKRP081 FOR PO PRINT/ 00230039
002400*            SHIPPING INSTRUCTIONS FOR M AND I TYPE ORDERS.       00240039
002500*     MADE BY: SUE BARTELT             WR/IR #: 4560              00250039
002600*                                                                 00260039
002700*---------------------------------------------------------------* 00270039
002800*     10-15-99   CHIRS KUNSTMANN    TKMA318     WR 20302        * 00280039
002900*  ADDED LOGIC TO HANDLE TRI-STATE DC TABLE.                    * 00290039
003000*                                                               * 00300039
003100*---------------------------------------------------------------* 00310039
003200*     04-20-01   RYAN STAUFFACHER   TKMA609     PITS:           * 00320039
003300*  ADDED LOGIC TO PROPERLY UPDATE TPURCHS FOR NON EDI RELEASES  * 00330039
003400*---------------------------------------------------------------* 00340039
003500*     07-12-01   MIKE FRIESS        TKMA508     WR 20866        * 00350039
003600*  EXTENSIVE CHANGES TO MATCH IMPORT EDITS TO NEW BATCH PROCESS.* 00360039
003700*---------------------------------------------------------------* 00370039
003800* 05/02/03 - S PRABHAKAR RAO, IGSI - WR NO. 24803               * 00380039
003900*                                                               * 00390039
004000*    - IN MAP POKM061 REPLACED CLASS BY MAJOR CLASS, SUB CLASS  * 00400039
004100*      AND CHANGED THE POSITION OF OTHER FIELDS CORRESPONDINGLY.* 00410039
004200*    - ADDED A NEW FILLER FIELD WITH SIZE 320 BYTES AFTER THE   * 00420039
004300*      STRUCTURE ASC-SPECIFIC-COMMAREA.                         * 00430039
004400*    - REPLACED ALL REFERENCES TO  TUPCSKU, TUPC,               * 00440039
004500*      AND TSK TABLES WITH XLT_SKU, XLT_VND_STYL,               * 00450039
004600*      XLT_UPC TABLES.                                          * 00460039
004700*    - REPLACED ALL CLASS WITH SUB CLASS, MAJOR CLASS AND       * 00470039
004800*      REDUCED THE SIZE OF STATUS FIELD TO 15 BYTES FOR NI-SKU  * 00480039
004900*      CONVERSION.                                              * 00490039
005000*    - IN PARAGRAPH 4918-SELECT-UPC-FROM-TWEBITM, TABLES TUPCPLS* 00500039
005100*      AND TWEBITM ARE NOT REPLACED BY LOGISTICS DOMAIN TABLES  * 00510039
005200*      BECAUSE OF PERFORMANCE ISSUES.                           * 00520039
005300** TKMA888 7/10/03 ********************************************** 00530039
005400*     07-10-03   BILL SCHROEDER     TKMA888     WR              * 00540039
005500*  NI SKU REMEDIATION WORK                                      * 00550039
005600*  REMOVE PO LNE COUNT FROM SCREEN AND EXPAND STATUS AREA       * 00560039
005700*---------------------------------------------------------------* 00570039
005800*     05-14-04   SUE BARTELT        TKMA537     WR 26915        * 00580039
005900*  CHANGES TO CURSORS 4,5,6 AND 4332-CHECK-IF-IMPORT TO PROCESS * 00590039
006000*  LANDED PO'S.                                                   00600039
006100*---------------------------------------------------------------* 00610039
006200*---------------------------------------------------------------* 00620039
006300*     10-25-05   RICH KELLEN        TKMAA71     P000814058      * 00630039
006400*  CHANGE TO COMMENT OUT THE EXECUTION OF PARA                  * 00640039
006500*  4970-SELECT-BULK-UPCS TO STOP THE PC-MSG-U-NO-UPCS-FOR-PO-CMN* 00650039
006600*  FROM BEING EXECUTED                                          * 00660039
006700*---------------------------------------------------------------* 00670039
006800*---------------------------------------------------------------* 00680039
006900*     05-26-06   VIRGENE LENNEMAN   TKMA366     P000867251      * 00690039
007000*  CHANGE: MODIFY CURSORS 4,5 AND 6 AND PARAGRAPHS                00700039
007100*  4334-CHECK-IF-ACTIVE-LINES AND 4331-CHECK-IF-ACTIVE-PO         00710039
007200*---------------------------------------------------------------* 00720043
007200*---------------------------------------------------------------* 00730043
006900*     09-29-10   COGNIZANT (SANDEEP) TKMAZ07    WR  38972       * 00740049
007000*  CHANGE: MLOF PROJECT CHANGES.                                * 00750043
007000*          MODIFIED THE QUERY IN 4916-CHECK-FOR-E-COM-DCS       * 00760043
007000*          PARAGRAPH TO LOOKUP THE E_BUS_IND COLUMN INSTEAD OF  * 00770043
007000*          THE HARD CODED EFC STORE NUMBER.                     * 00780043
007200*---------------------------------------------------------------* 00790054
006900*     08-01-11   COGNIZANT (KARTHIK) TKMAZ10    CR  7896        * 00800055
000900*  CHANGE: FIXED UNWANTED ' IN THE BUYER NAME FIELD. WHEN BUYER * 00810054
000900*          NAME CONTAINS ' IN IT, THE JCL CREATED DYNAMICALLY   * 00820054
000900*          WILL FAIL WITH JCL ERROR. HERE ' WILL BE REPLACED    * 00830054
000900*          WITH _                                               * 00840054
000900*          CHANGED PARA 7300-GET-BUYER-NAME                     * 00850054
000900*                                                               * 00860054
000900*          EXAMPLE:                                             * 00870054
000900*          --------                                             * 00880054
000900*          NAME='STEVE O'BRIEN            ',                    * 00890054
000900*             WILL BE REPLACED WITH                             * 00900054
000900*          NAME='STEVE O_BRIEN            ',                    * 00910054
000900*                                                               * 00920054
007200*---------------------------------------------------------------* 00930039
C98147*     11-11-14   LINDA FRIESS       TKMA394     CHG0098147        00940058
C98147*  CHANGE: EXPANDED PO NUMBER TO 8 DIGITS IN MAP AND COMMAREA     00950058
C98147*---------------------------------------------------------------* 00960058
076319* DATE  10/27/2021                                                00961063
076320*            - CHANGE CALL OF 'DPKUT100' TO                     * 00962063
076321*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00963063
076322*              MAKING THE CALL DYNAMIC VS STATIC                * 00964063
076323*     MADE BY: GERMAN BANDA            WR/IR #: CHG0263126        00965064
076312*                                                               * 00966063
076318*---------------------------------------------------------------* 00966165
CICS  *  CHANGED 11/14/2022    BY BARB SCHULTZ    WR: CHG0278485        00966267
CICS  *                                                               * 00966365
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL   * 00966465
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.    * 00966565
CICS  *---------------------------------------------------------------* 00967065
007300 EJECT                                                            00970039
007400 ENVIRONMENT DIVISION.                                            00980039
007500                                                                  00990039
007600 DATA DIVISION.                                                   01000039
007700                                                                  01010039
007800 WORKING-STORAGE SECTION.                                         01020039
007900                                                                  01030039
008000 01  DK-DB2-KEYS.                                                 01040039
008100     15  DK-DPT                         PIC  X(03)  VALUE SPACE.  01050039
008200     15  DK-DPT-NBR-BEG                 PIC  X(03)  VALUE SPACE.  01060039
008300     15  DK-DPT-NBR-END                 PIC  X(03)  VALUE SPACE.  01070039
008400     15  DK-RLSE-DAYS                   PIC S9(09)  COMP          01080039
008500                                                    VALUE +0.     01090039
008600     15  DK-DB2-DATE                    PIC X(10)   VALUE SPACES. 01100039
008700     15  DK-DB2-SHIP-DATE               PIC X(10)   VALUE SPACES. 01110039
008800     15  DK-DB2-DATE-LOW                PIC X(10)   VALUE SPACES. 01120039
008900     15  DK-DB2-TMST                    PIC X(26)   VALUE SPACES. 01130039
009000     15  DK-DB2-SHIP-TMST               PIC X(26)   VALUE SPACES. 01140039
009100     15  DK-DB2-TMST-LOW                PIC X(26)   VALUE SPACES. 01150039
009200     15  DK-DMM-NAME                    PIC X(20)   VALUE SPACE.  01160039
009300     15  DK-PO-NUMBER                   PIC S9(09)  COMP          01170039
009400                                                    VALUE +0.     01180039
009500     15  DK-WORKER-NBR                  PIC S9(06)  COMP-3        01190039
009600                                                    VALUE +0.     01200039
009700     15  DK-DMA-NBR                     PIC X(02)   VALUE SPACES. 01210039
009800                                                                  01220039
009900                                                                  01230039
010000 01  PC-PROGRAM-CONSTANTS.                                        01240039
010100     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         01250039
010200                                                    'PO061A  '.   01260039
010300     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         01270039
010400                                                    'POKM061 '.   01280039
010500     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         01290039
010600                                                    'POKCS061'.   01300039
010700     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      01310039
010800     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      01320039
010900     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    01330039
011000     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +12     01340039
011100                                                    COMP SYNC.    01350039
011200     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      01360039
011300                                                    COMP SYNC.    01370039
011400     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         01380039
011500                                                    +1000000      01390039
011600                                                    COMP-3.       01400039
011700     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      01410039
011800                                                    COMP SYNC.    01420039
011900     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       01430039
012000                                                    COMP-3.       01440039
012100     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    01450039
012200     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  01460039
012300     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  01470039
012400     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  01480039
012500     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  01490039
012600     05  PC-SPACE                       PIC  X(01)  VALUE SPACE.  01500039
012700     05  PC-A                           PIC  X(01)  VALUE 'A'.    01510039
012800     05  PC-B                           PIC  X(01)  VALUE 'B'.    01520039
012900     05  PC-C                           PIC  X(01)  VALUE 'C'.    01530039
013000     05  PC-D                           PIC  X(01)  VALUE 'D'.    01540039
013100     05  PC-E                           PIC  X(01)  VALUE 'E'.    01550039
013200     05  PC-F                           PIC  X(01)  VALUE 'F'.    01560039
013300     05  PC-G                           PIC  X(01)  VALUE 'G'.    01570039
013400     05  PC-H                           PIC  X(01)  VALUE 'H'.    01580039
013500     05  PC-I                           PIC  X(01)  VALUE 'I'.    01590039
013600     05  PC-J                           PIC  X(01)  VALUE 'J'.    01600039
013700     05  PC-K                           PIC  X(01)  VALUE 'K'.    01610039
013800     05  PC-L                           PIC  X(01)  VALUE 'L'.    01620039
013900     05  PC-M                           PIC  X(01)  VALUE 'M'.    01630039
014000     05  PC-N                           PIC  X(01)  VALUE 'N'.    01640039
014100     05  PC-O                           PIC  X(01)  VALUE 'O'.    01650039
014200     05  PC-P                           PIC  X(01)  VALUE 'P'.    01660039
014300     05  PC-Q                           PIC  X(01)  VALUE 'Q'.    01670039
014400     05  PC-R                           PIC  X(01)  VALUE 'R'.    01680039
014500     05  PC-S                           PIC  X(01)  VALUE 'S'.    01690039
014600     05  PC-T                           PIC  X(01)  VALUE 'T'.    01700039
014700     05  PC-U                           PIC  X(01)  VALUE 'U'.    01710039
014800     05  PC-V                           PIC  X(01)  VALUE 'V'.    01720039
014900     05  PC-W                           PIC  X(01)  VALUE 'W'.    01730039
015000     05  PC-X                           PIC  X(01)  VALUE 'X'.    01740039
015100     05  PC-Y                           PIC  X(01)  VALUE 'Y'.    01750039
015200     05  PC-Z                           PIC  X(01)  VALUE 'Z'.    01760039
015300     05  PC-1                           PIC  X(02)  VALUE '1'.    01770039
015400     05  PC-2                           PIC  X(02)  VALUE '2'.    01780039
015500     05  PC-3                           PIC  X(02)  VALUE '3'.    01790039
015600     05  PC-4                           PIC  X(02)  VALUE '4'.    01800039
015700     05  PC-5                           PIC  X(02)  VALUE '5'.    01810039
015800     05  PC-6                           PIC  X(02)  VALUE '6'.    01820039
015900     05  PC-7                           PIC  X(02)  VALUE '7'.    01830039
016000     05  PC-8                           PIC  X(02)  VALUE '8'.    01840039
016100     05  PC-9                           PIC  X(02)  VALUE '9'.    01850039
016200     05  PC-0                           PIC  X(02)  VALUE '0'.    01860039
016300     05  PC-95                          PIC  X(02)  VALUE '95'.   01870039
016400     05  PC-DE                          PIC  X(02)  VALUE 'DE'.   01880039
016500     05  PC-AV                          PIC  X(02)  VALUE 'AV'.   01890039
016600     05  PC-VS                          PIC  X(02)  VALUE 'VS'.   01900039
016700     05  PC-CON                         PIC  X(03)  VALUE 'CON'.  01910039
016800     05  PC-CMN                         PIC  X(03)  VALUE 'CMN'.  01920039
016900     05  PC-04                          PIC  X(02)  VALUE '04'.   01930039
017000     05  PC-MULTI-MSGS                  PIC X(18)                 01940039
017100         VALUE 'MULTI MSGS-USE F18'.                              01950039
017200                                                                  01960039
017300     05  PC-PROCESSING-TIME             PIC  S9(04) COMP          01970039
017400                                             VALUE +7.            01980039
017500     05  PC-DEFAULT-TIMESTAMP           PIC X(26) VALUE           01990039
017600                        '0001-01-01-00.00.00.000000'.             02000039
017700*                                                                 02010039
017800     05  PC-TSYMSG-NUMBERS.                                       02020039
017900         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  02030039
018000         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  02040039
018100         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  02050039
018200         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  02060039
018300         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  02070039
018400         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  02080039
018500         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  02090039
018600         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  02100039
018700         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  02110039
018800         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  02120039
018900         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  02130039
019000         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  02140039
019100         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  02150039
019200         10  PC-TSYMSG-00083            PIC  9(05)  VALUE 00083.  02160039
019300         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  02170039
019400         10  PC-TSYMSG-00168            PIC  9(05)  VALUE 00168.  02180039
019500         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  02190039
019600         10  PC-TSYMSG-00588            PIC  9(05)  VALUE 00588.  02200039
019700         10  PC-TSYMSG-00732            PIC  9(05)  VALUE 00732.  02210039
019800         10  PC-TSYMSG-00733            PIC  9(05)  VALUE 00733.  02220039
019900         10  PC-TSYMSG-00748            PIC  9(05)  VALUE 00748.  02230039
020000         10  PC-TSYMSG-00754            PIC  9(05)  VALUE 00754.  02240039
020100         10  PC-TSYMSG-00755            PIC  9(05)  VALUE 00755.  02250039
020200         10  PC-TSYMSG-00768            PIC  9(05)  VALUE 00768.  02260039
020300         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  02270039
020400         10  PC-TSYMSG-01061            PIC  9(05)  VALUE 01061.  02280039
020500         10  PC-TSYMSG-01316            PIC  9(05)  VALUE 01316.  02290039
020600         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  02300039
020700         10  PC-TSYMSG-03416            PIC  9(05)  VALUE 03416.  02310039
020800                                                                  02320039
020900*---------------------------------------------------------------* 02330039
021000*  EDIT MESSAGES                                                * 02340039
021100*---------------------------------------------------------------* 02350039
021200                                                                  02360039
021300     COPY TRWS062.                                                02370039
021400                                                                  02380039
021500 01  TD-TRANSIENT-DATE-AREA.                                      02390039
021600     05  TD-QUEUE-NAME            PIC  X(04)  VALUE 'IRTD'.       02400039
021700     05  TD-JCL-LINE              PIC  X(80)  VALUE SPACES.       02410039
021800     05  TD-JCL-LINE-LENGTH       PIC S9(04)  VALUE +80           02420039
021900                                              COMP SYNC.          02430039
022000     05  TD-Q-NAME-LENGTH         PIC S9(04)  VALUE +4            02440039
022100                                              COMP SYNC.          02450039
022200*                                                                 02460039
022300 01  JL-JCL-LINE-AREA.                                            02470039
022400     05  JL-JCL-LINE-1.                                           02480039
022500         10  FILLER               PIC  X(02)  VALUE '//'.         02490039
022600         10  JL-JOB-NAME          PIC  X(08).                     02500039
022700         10  FILLER               PIC  X(11)  VALUE               02510039
022800         ' JOB KOHLS,'.                                           02520039
022900         10  FILLER               PIC  X(01)  VALUE QUOTE.        02530039
023000         10  FILLER               PIC  X(08)  VALUE               02540039
023100         'PO PRINT'.                                              02550039
023200         10  FILLER               PIC  X(01)  VALUE QUOTE.        02560039
023300         10  FILLER               PIC  X(01)  VALUE ','.          02570039
023400         10  FILLER               PIC  X(48)  VALUE SPACES.       02580039
023500     05  JL-JCL-LINE-2.                                           02590039
023600         10  JL-JCL-CLASS         PIC  X(80).                     02600039
023700***********************************************************       02610039
023800*   LINE-2T IS USED WHEN TESTING A PROC IN TKMA.PROCLIB           02620039
023900***********************************************************       02630039
024000     05  JL-JCL-LINE-2T.                                          02640039
024100         10  JL-JCL-LIBSRCH       PIC  X(80).                     02650039
024200     05  JL-JCL-LINE-3.                                           02660039
024300         10  JL-JCL-JOB-PARM      PIC  X(80).                     02670039
024400     05  JL-JCL-LINE-4.                                           02680039
024500         10  FILLER               PIC  X(40)  VALUE               02690039
024600         '//**************************************'.              02700039
024700         10  FILLER               PIC  X(40)  VALUE               02710039
024800         '****************************************'.              02720039
024900     05  JL-JCL-LINE-5.                                           02730039
025000         10  FILLER               PIC  X(40)  VALUE               02740039
025100         '//**   JOB WILL PRODUCE HARDCOPY PURCHAS'.              02750039
025200         10  FILLER               PIC  X(40)  VALUE               02760039
025300         'E ORDER FROM THE PO SYSTEM              '.              02770039
025400     05  JL-JCL-LINE-6.                                           02780039
025500         10  FILLER               PIC  X(40)  VALUE               02790039
025600         '//**************************************'.              02800039
025700         10  FILLER               PIC  X(40)  VALUE               02810039
025800         '****************************************'.              02820039
025900     05  JL-JCL-LINE-7.                                           02830039
026000         10  JL-JCL-JOBLIB        PIC  X(80).                     02840039
026100     05  JL-JCL-LINE-8.                                           02850039
026200         10  JL-JCL-OUTPUT1       PIC  X(80).                     02860039
026300     05  JL-JCL-LINE-9.                                           02870039
026400         10  JL-JCL-OUTPUT2       PIC  X(80).                     02880039
026500     05  JL-JCL-LINE-10.                                          02890039
026600         10  JL-JCL-OUTPUT3       PIC  X(80).                     02900039
026700     05  JL-JCL-LINE-11.                                          02910039
026800         10  JL-JCL-OUTPUT4       PIC  X(80).                     02920039
026900     05  JL-JCL-LINE-12.                                          02930039
027000         10  JL-JCL-PROC          PIC  X(80).                     02940039
027100     05  JL-JCL-LINE-13.                                          02950039
027200         10  FILLER               PIC  X(21)  VALUE               02960039
027300         '//S010.SYSUT1   DD * '.                                 02970039
027400         10  FILLER               PIC  X(59)  VALUE SPACES.       02980039
027500     05  JL-JCL-LINE-14.                                          02990039
027600         10  JL-PO-NBR            PIC S9(09)  COMP.               03000039
027700         10  JL-PRINT-TYPE-BY     PIC  X(02).                     03010039
027800         10  JL-PRINT-TYPE-VN     PIC  X(02).                     03020039
027900         10  JL-PRINT-TYPE-DC     PIC  X(02).                     03030039
028000         10  JL-PRINT-TYPE-AN     PIC  X(02).                     03040039
028100         10  FILLER               PIC  X(68)  VALUE SPACES.       03050039
028200     05  JL-JCL-LINE-15.                                          03060039
028300         10  FILLER               PIC  X(02)  VALUE '/*'.         03070039
028400         10  FILLER               PIC  X(78)  VALUE SPACES.       03080039
028500     05  JL-JCL-LINE-16.                                          03090039
028600         10  FILLER               PIC  X(03)  VALUE '//*'.        03100039
028700         10  FILLER               PIC  X(77)  VALUE SPACES.       03110039
028800     05  JL-JCL-LINE-EOF.                                         03120039
028900         10  FILLER               PIC  X(05)  VALUE '/*EOF'.      03130039
029000         10  FILLER               PIC  X(75)  VALUE SPACES.       03140039
029100                                                                  03150039
029200 01  JL-JCL-LINE-TABLE            REDEFINES JL-JCL-LINE-AREA.     03160039
029300     05  JL-JCL-LINE              OCCURS 18 TIMES                 03170039
029400                                  INDEXED BY JL-LINE-INDEX        03180039
029500                                  PIC X(80).                      03190039
029600                                                                  03200039
029700*                                                                 03210039
029800 01  PC-JOB.                                                      03220039
029900     05  PC-PROD-JOB-POK902       PIC  X(08)  VALUE  'POK902  '.  03230039
030000     05  PC-PROD-CLASS.                                           03240039
030100         10  FILLER               PIC  X(36)  VALUE               03250039
030200         '//      CLASS=Q,MSGCLASS=P,REGION=3M'.                  03260039
030300         10  FILLER               PIC  X(44)  VALUE  SPACES.      03270039
030400     05  PC-PROD-LIBSRCH.                                         03280039
030500         10  FILLER               PIC  X(40)  VALUE               03290039
030600         '//*                                    '.               03300039
030700         10  FILLER               PIC  X(40)  VALUE SPACES.       03310039
030800     05  PC-PROD-JOB-PARM.                                        03320039
030900         10  FILLER               PIC  X(03)  VALUE  '//*'.       03330039
031000         10  FILLER               PIC  X(77)  VALUE  SPACES.      03340039
031100     05  PC-PROD-JOBLIB.                                          03350039
031200         10  FILLER               PIC  X(39)  VALUE               03360039
031300         '//JOBLIB   DD DSN=PKMO.LOADLIB,DISP=SHR'.               03370039
031400         10  FILLER               PIC  X(41)  VALUE  SPACES.      03380039
031500     05  PC-PROD-JOBOUT1.                                         03390039
031600         10  FILLER               PIC  X(48)  VALUE               03400039
031700         '//JOBOUT02 OUTPUT FORMDEF=L1S4PO,PAGEDEF=L1S4PO,'.      03410039
031800         10  FILLER               PIC  X(32)  VALUE  SPACES.      03420039
031900     05  PC-PROD-JOBOUT2.                                         03430039
032000         10  FILLER               PIC  X(41)  VALUE               03440039
032100         '//         USERLIB=(SYS2.AFPTEST.FDEFLIB,'.             03450039
032200         10  FILLER               PIC  X(39)  VALUE               03460039
032300         'SYS2.AFPTEST.PDEFLIB),                 '.               03470039
032400     05  PC-PROD-JOBOUT3.                                         03480039
032500         10  FILLER               PIC  X(16)  VALUE               03490039
032600         '//         NAME='.                                      03500039
032700         10  FILLER               PIC  X(01)  VALUE  QUOTE.       03510039
032800         10  PV-PROD-BYR-NAME     PIC  X(25).                     03520039
032900         10  FILLER               PIC  X(01)  VALUE  QUOTE.       03530039
033000         10  FILLER               PIC  X(01)  VALUE  ','.         03540039
033100         10  FILLER               PIC  X(36)  VALUE  SPACES.      03550039
033200     05  PC-PROD-JOBOUT4.                                         03560039
033300         10  FILLER               PIC  X(19)  VALUE               03570039
033400         '//         ADDRESS='.                                   03580039
033500         10  FILLER               PIC  X(01)  VALUE  QUOTE.       03590039
033600         10  PV-PROD-BYR-NAME-NO  PIC  X(32).                     03600039
033700         10  FILLER               PIC  X(01)  VALUE  QUOTE.       03610039
033800         10  FILLER               PIC  X(27)  VALUE  SPACES.      03620039
033900     05  PC-PROD-PROC-SI.                                         03630039
034000         10  FILLER               PIC  X(30)  VALUE               03640039
034100         '//PS010    EXEC POK9021,SOPT=0'.                        03650039
034200         10  FILLER               PIC  X(50)  VALUE  SPACES.      03660039
034300     05  PC-PROD-PROC-SI-PK.                                      03670039
034400         10  FILLER               PIC  X(30)  VALUE               03680039
034500         '//PS010    EXEC POK9021,SOPT=1'.                        03690039
034600         10  FILLER               PIC  X(50)  VALUE  SPACES.      03700039
034700     05  PC-TEST-CLASS.                                           03710039
034800         10  FILLER               PIC  X(44)  VALUE               03720039
034900         '//      CLASS=E,MSGCLASS=X,REGION=3M,NOTIFY='.          03730039
035000         10  PC-TEST-NOTIFY-ID    PIC  X(07).                     03740039
035100         10  FILLER               PIC  X(29)  VALUE SPACES.       03750039
035200*        ',TYPRUN=HOLD                 '.                         03760039
035300     05  PC-TEST-LIBSRCH.                                         03770039
035400         10  FILLER               PIC  X(40)  VALUE               03780039
035500         '//LIBSRCH  JCLLIB ORDER=TKMA.PROCLIB   '.               03790039
035600         10  FILLER               PIC  X(40)  VALUE SPACES.       03800039
035700     05  PC-TEST-JOB-PARM.                                        03810039
035800         10  FILLER               PIC  X(18)  VALUE               03820039
035900         '/*JOBPARM P=PROC01'.                                    03830039
036000         10  FILLER               PIC  X(62)  VALUE  SPACES.      03840039
036100     05  PC-TEST-JOBLIB.                                          03850039
036200         10  FILLER               PIC  X(39)  VALUE               03860039
036300         '//JOBLIB   DD DSN=TKMA.LOADLIB,DISP=SHR'.               03870039
036400         10  FILLER               PIC  X(41)  VALUE  SPACES.      03880039
036500     05  PC-TEST-JOBOUT1.                                         03890039
036600         10  FILLER               PIC  X(45)  VALUE               03900039
036700         '//JOBOUT02 OUTPUT CLASS=L,FORMS=8050,COPIES=1'.         03910039
036800         10  FILLER               PIC  X(35)  VALUE  SPACES.      03920039
036900     05  PC-TEST-JOBOUT2A.                                        03930039
037000         10  FILLER               PIC  X(48)  VALUE               03940039
037100         '//JOBOUT02 OUTPUT FORMDEF=L1S4PO,PAGEDEF=L1S4PO,'.      03950039
037200         10  FILLER               PIC  X(32)  VALUE  SPACES.      03960039
037300     05  PC-TEST-JOBOUT2B.                                        03970039
037400         10  FILLER               PIC  X(41)  VALUE               03980039
037500         '//         USERLIB=(SYS2.AFPTEST.FDEFLIB,'.             03990039
037600         10  FILLER               PIC  X(39)  VALUE               04000039
037700         'SYS2.AFPTEST.PDEFLIB)                  '.               04010039
037800     05  PC-TEST-JOBOUT2C.                                        04020039
037900         10  FILLER               PIC  X(39)  VALUE               04030039
038000         '//         CLASS=A,FORMS=STD,DEST=U4001'.               04040039
038100         10  FILLER               PIC  X(32)  VALUE  SPACES.      04050039
038200     05  PC-TEST-JOBOUT3.                                         04060039
038300         10  FILLER               PIC  X(03)  VALUE  '//*'.       04070039
038400         10  FILLER               PIC  X(77)  VALUE  SPACES.      04080039
038500     05  PC-TEST-PROC-SI.                                         04090039
038600         10  FILLER               PIC  X(30)  VALUE               04100039
038700         '//PS010   EXEC POK9021T,SOPT=0'.                        04110039
038800         10  FILLER               PIC  X(50)  VALUE  SPACES.      04120039
038900     05  PC-TEST-PROC-SI-PK.                                      04130039
039000         10  FILLER               PIC  X(30)  VALUE               04140039
039100         '//PS010   EXEC POK9021T,SOPT=1'.                        04150039
039200         10  FILLER               PIC  X(50)  VALUE  SPACES.      04160039
039300                                                                  04170039
039400                                                                  04180039
039500                                                                  04190039
039600                                                                  04200039
039700 01  PS-PROGRAM-SWITCHES.                                         04210039
039800     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    04220039
039900         88  PS-NO-ERROR                            VALUE 'Y'.    04230039
040000         88  PS-ERROR                               VALUE 'N'.    04240039
040100     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    04250039
040200         88  PS-COMMAREA-VALID                      VALUE 'Y'.    04260039
040300         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    04270039
040400     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    04280039
040500         88  PS-DONE                                VALUE 'Y'.    04290039
040600         88  PS-NOT-DONE                            VALUE 'N'.    04300039
040700     05  PS-VALID-STATUS-SW             PIC  X(01)  VALUE 'N'.    04310039
040800         88 PS-VALID-STATUS                         VALUE 'Y'.    04320039
040900         88 PS-INVALID-STATUS                       VALUE 'N'.    04330039
041000     05  PS-CURR-SPLIT-QTY-PRESENT-SW  PIC   X(01)  VALUE 'N'.    04340039
041100         88 PS-CURR-SPLIT-QTY-PRESENT               VALUE 'Y'.    04350039
041200         88 PS-CURR-SPLIT-QTY-PRESENT-NO            VALUE 'N'.    04360039
041300     05  PS-LINES-ON-TPURITM-SW         PIC  X(01)  VALUE 'N'.    04370039
041400         88 PS-LINES-ON-TPURITM                     VALUE 'Y'.    04380039
041500         88 PS-LINES-ON-TPURITM-NO                  VALUE 'N'.    04390039
041600     05  PS-SKUS-FOUND-SW               PIC  X(01)  VALUE 'N'.    04400039
041700         88 PS-SKUS-FOUND                           VALUE 'Y'.    04410039
041800         88 PS-SKUS-FOUND-NO                        VALUE 'N'.    04420039
041900     05  PS-SHOW-PO-SW                  PIC  X(01)  VALUE 'N'.    04430039
042000         88 PS-SHOW-PO                              VALUE 'Y'.    04440039
042100         88 PS-DONT-SHOW-PO                         VALUE 'N'.    04450039
042200     05  PS-SPLITS-SW                   PIC  X(01)  VALUE 'N'.    04460039
042300         88 PS-SPLITS-OK                            VALUE 'Y'.    04470039
042400         88 PS-SPLITS-NOT-OK                        VALUE 'N'.    04480039
042500     05  PS-CREATE-TAUCNRL-SW           PIC  X(01)  VALUE 'N'.    04490039
042600         88 PS-CREATE-TAUCNRL                       VALUE 'Y'.    04500039
042700         88 PS-CREATE-TAUCNRL-NO                    VALUE 'N'.    04510039
042800     05  PS-EOC-TIMCNRL-SW              PIC  X(01)  VALUE 'N'.    04520039
042900         88 PS-EOC-TIMCNRL                          VALUE 'Y'.    04530039
043000         88 PS-EOC-TIMCNRL-NO                       VALUE 'N'.    04540039
043100     05  PS-SELECT-PACK-SUM-OK-SW       PIC  X(01)  VALUE 'N'.    04550039
043200         88 PS-SELECT-PACK-SUM-OK                   VALUE 'Y'.    04560039
043300         88 PS-SELECT-PACK-SUM-OK-NO                VALUE 'N'.    04570039
043400     05  PS-COUNT-DCS-OK-SW             PIC  X(01)  VALUE 'N'.    04580039
043500         88 PS-COUNT-DCS-OK                         VALUE 'Y'.    04590039
043600         88 PS-COUNT-DCS-OK-NO                      VALUE 'N'.    04600039
043700     05  PS-EOC-E-COM-PACK-UPC-CUR-SW   PIC  X(01)  VALUE 'N'.    04610039
043800         88 PS-EOC-E-COM-PACK-UPC-CUR               VALUE 'Y'.    04620039
043900         88 PS-EOC-E-COM-PACK-UPC-CUR-NO            VALUE 'N'.    04630039
044000     05  PS-PASSED-E-COM-CHECK-SW       PIC  X(01)  VALUE 'N'.    04640039
044100         88 PS-PASSED-E-COM-CHECK                   VALUE 'Y'.    04650039
044200         88 PS-PASSED-E-COM-CHECK-NO                VALUE 'N'.    04660039
044300     05  PS-THERE-ARE-E-COM-DCS-SW      PIC  X(01)  VALUE 'N'.    04670039
044400         88 PS-THERE-ARE-E-COM-DCS                  VALUE 'Y'.    04680039
044500         88 PS-THERE-ARE-E-COM-DCS-NO               VALUE 'N'.    04690039
044600     05  PS-EOC-MULTI-PACK-CUR-SW       PIC  X(01)  VALUE 'N'.    04700039
044700         88 PS-EOC-MULTI-PACK-CUR                   VALUE 'Y'.    04710039
044800         88 PS-EOC-MULTI-PACK-CUR-NO                VALUE 'N'.    04720039
044900     05  PS-EOC-DC-CURSOR-SW            PIC  X(01)  VALUE 'N'.    04730039
045000         88 PS-EOC-DC-CURSOR                        VALUE 'Y'.    04740039
045100         88 PS-EOC-DC-CURSOR-NO                     VALUE 'N'.    04750039
045200     05  PS-EOC-BULK-UPC-CUR-SW         PIC  X(01)  VALUE 'N'.    04760039
045300         88 PS-EOC-BULK-UPC-CUR                     VALUE 'Y'.    04770039
045400         88 PS-EOC-BULK-UPC-CUR-NO                  VALUE 'N'.    04780039
045500     05  PS-THIS-IS-E-COM-UPC-SW        PIC  X(01)  VALUE 'N'.    04790039
045600         88 PS-THIS-IS-E-COM-UPC                    VALUE 'Y'.    04800039
045700         88 PS-THIS-IS-E-COM-UPC-NO                 VALUE 'N'.    04810039
045800     05  PS-EOC-PACK-CURSOR-SW          PIC  X(01)  VALUE 'N'.    04820039
045900         88 PS-EOC-PACK-CURSOR                      VALUE 'Y'.    04830039
046000         88 PS-EOC-PACK-CURSOR-NO                   VALUE 'N'.    04840039
046100     05  PS-DC-SPLIT-INFO-PRESENT-SW    PIC  X(01)  VALUE 'N'.    04850039
046200         88 PS-DC-SPLIT-INFO-PRESENT                VALUE 'Y'.    04860039
046300         88 PS-DC-SPLIT-INFO-PRESENT-NO             VALUE 'N'.    04870039
046400     05  PS-READY-FOR-REL-SW            PIC  X(01)  VALUE 'Y'.    04880039
046500         88 PS-READY-FOR-REL                        VALUE 'Y'.    04890039
046600         88 PS-READY-FOR-REL-NO                     VALUE 'N'.    04900039
046700     05  PS-EOC-PREPACK-DC-CURSOR-SW    PIC X(01)   VALUE 'N'.    04910039
046800         88 PS-EOC-PREPACK-DC-CURSOR                VALUE 'Y'.    04920039
046900         88 PS-EOC-PREPACK-DC-CURSOR-NO             VALUE 'N'.    04930039
047000     05 PS-FOUND-SELECTED-PO-SW         PIC X(01)   VALUE 'N'.    04940039
047100         88 PS-FOUND-SELECTED-PO                    VALUE 'Y'.    04950039
047200         88 PS-FOUND-SELECTED-PO-NO                 VALUE 'N'.    04960039
047300     05  PS-PO-MSG-SWITCHES.                                      04970039
047400         10 PS-MSG-A-ALREADY-SET-SW     PIC X       VALUE ' '.    04980039
047500            88 PS-MSG-A-ALREADY-SET                 VALUE 'Y'.    04990039
047600         10 PS-MSG-B-ALREADY-SET-SW     PIC X       VALUE ' '.    05000039
047700            88 PS-MSG-B-ALREADY-SET                 VALUE 'Y'.    05010039
047800         10 PS-MSG-C-ALREADY-SET-SW     PIC X       VALUE ' '.    05020039
047900            88 PS-MSG-C-ALREADY-SET                 VALUE 'Y'.    05030039
048000         10 PS-MSG-D-ALREADY-SET-SW     PIC X       VALUE ' '.    05040039
048100            88 PS-MSG-D-ALREADY-SET                 VALUE 'Y'.    05050039
048200         10 PS-MSG-E-ALREADY-SET-SW     PIC X       VALUE ' '.    05060039
048300            88 PS-MSG-E-ALREADY-SET                 VALUE 'Y'.    05070039
048400         10 PS-MSG-F-ALREADY-SET-SW     PIC X       VALUE ' '.    05080039
048500            88 PS-MSG-F-ALREADY-SET                 VALUE 'Y'.    05090039
048600         10 PS-MSG-G-ALREADY-SET-SW     PIC X       VALUE ' '.    05100039
048700            88 PS-MSG-G-ALREADY-SET                 VALUE 'Y'.    05110039
048800         10 PS-MSG-H-ALREADY-SET-SW     PIC X       VALUE ' '.    05120039
048900            88 PS-MSG-H-ALREADY-SET                 VALUE 'Y'.    05130039
049000         10 PS-MSG-I-ALREADY-SET-SW     PIC X       VALUE ' '.    05140039
049100            88 PS-MSG-I-ALREADY-SET                 VALUE 'Y'.    05150039
049200         10 PS-MSG-J-ALREADY-SET-SW     PIC X       VALUE ' '.    05160039
049300            88 PS-MSG-J-ALREADY-SET                 VALUE 'Y'.    05170039
049400         10 PS-MSG-K-ALREADY-SET-SW     PIC X       VALUE ' '.    05180039
049500            88 PS-MSG-K-ALREADY-SET                 VALUE 'Y'.    05190039
049600         10 PS-MSG-L-ALREADY-SET-SW     PIC X       VALUE ' '.    05200039
049700            88 PS-MSG-L-ALREADY-SET                 VALUE 'Y'.    05210039
049800         10 PS-MSG-M-ALREADY-SET-SW     PIC X       VALUE ' '.    05220039
049900            88 PS-MSG-M-ALREADY-SET                 VALUE 'Y'.    05230039
050000         10 PS-MSG-N-ALREADY-SET-SW     PIC X       VALUE ' '.    05240039
050100            88 PS-MSG-N-ALREADY-SET                 VALUE 'Y'.    05250039
050200         10 PS-MSG-O-ALREADY-SET-SW     PIC X       VALUE ' '.    05260039
050300            88 PS-MSG-O-ALREADY-SET                 VALUE 'Y'.    05270039
050400         10 PS-MSG-P-ALREADY-SET-SW     PIC X       VALUE ' '.    05280039
050500            88 PS-MSG-P-ALREADY-SET                 VALUE 'Y'.    05290039
050600         10 PS-MSG-Q-ALREADY-SET-SW     PIC X       VALUE ' '.    05300039
050700            88 PS-MSG-Q-ALREADY-SET                 VALUE 'Y'.    05310039
050800         10 PS-MSG-R-ALREADY-SET-SW     PIC X       VALUE ' '.    05320039
050900            88 PS-MSG-R-ALREADY-SET                 VALUE 'Y'.    05330039
051000         10 PS-MSG-S-ALREADY-SET-SW     PIC X       VALUE ' '.    05340039
051100            88 PS-MSG-S-ALREADY-SET                 VALUE 'Y'.    05350039
051200         10 PS-MSG-T-ALREADY-SET-SW     PIC X       VALUE ' '.    05360039
051300            88 PS-MSG-T-ALREADY-SET                 VALUE 'Y'.    05370039
051400         10 PS-MSG-U-ALREADY-SET-SW     PIC X       VALUE ' '.    05380039
051500            88 PS-MSG-U-ALREADY-SET                 VALUE 'Y'.    05390039
051600         10 PS-MSG-V-ALREADY-SET-SW     PIC X       VALUE ' '.    05400039
051700            88 PS-MSG-V-ALREADY-SET                 VALUE 'Y'.    05410039
051800         10 PS-MSG-W-ALREADY-SET-SW     PIC X       VALUE ' '.    05420039
051900            88 PS-MSG-W-ALREADY-SET                 VALUE 'Y'.    05430039
052000         10 PS-MSG-X-ALREADY-SET-SW     PIC X       VALUE ' '.    05440039
052100            88 PS-MSG-X-ALREADY-SET                 VALUE 'Y'.    05450039
052200         10 PS-MSG-Y-ALREADY-SET-SW     PIC X       VALUE ' '.    05460039
052300            88 PS-MSG-Y-ALREADY-SET                 VALUE 'Y'.    05470039
052400         10 PS-MSG-Z-ALREADY-SET-SW     PIC X       VALUE ' '.    05480039
052500            88 PS-MSG-Z-ALREADY-SET                 VALUE 'Y'.    05490039
052600         10 PS-MSG-1-ALREADY-SET-SW     PIC X       VALUE ' '.    05500039
052700            88 PS-MSG-1-ALREADY-SET                 VALUE 'Y'.    05510039
052800         10 PS-MSG-2-ALREADY-SET-SW     PIC X       VALUE ' '.    05520039
052900            88 PS-MSG-2-ALREADY-SET                 VALUE 'Y'.    05530039
053000         10 PS-MSG-3-ALREADY-SET-SW     PIC X       VALUE ' '.    05540039
053100            88 PS-MSG-3-ALREADY-SET                 VALUE 'Y'.    05550039
053200         10 PS-MSG-4-ALREADY-SET-SW     PIC X       VALUE ' '.    05560039
053300            88 PS-MSG-4-ALREADY-SET                 VALUE 'Y'.    05570039
053400         10 PS-MSG-5-ALREADY-SET-SW     PIC X       VALUE ' '.    05580039
053500            88 PS-MSG-5-ALREADY-SET                 VALUE 'Y'.    05590039
053600         10 PS-MSG-6-ALREADY-SET-SW     PIC X       VALUE ' '.    05600039
053700            88 PS-MSG-6-ALREADY-SET                 VALUE 'Y'.    05610039
053800         10 PS-MSG-7-ALREADY-SET-SW     PIC X       VALUE ' '.    05620039
053900            88 PS-MSG-7-ALREADY-SET                 VALUE 'Y'.    05630039
054000         10 PS-MSG-8-ALREADY-SET-SW     PIC X       VALUE ' '.    05640039
054100            88 PS-MSG-8-ALREADY-SET                 VALUE 'Y'.    05650039
054200         10 PS-MSG-9-ALREADY-SET-SW     PIC X       VALUE ' '.    05660039
054300            88 PS-MSG-9-ALREADY-SET                 VALUE 'Y'.    05670039
054400         10 PS-MSG-0-ALREADY-SET-SW     PIC X       VALUE ' '.    05680039
054500            88 PS-MSG-0-ALREADY-SET                 VALUE 'Y'.    05690039
054600         10 PS-THERE-ARE-CMN-MSGS-SW    PIC X       VALUE ' '.    05700039
054700            88 PS-THERE-ARE-CMN-MSGS                VALUE 'Y'.    05710039
054800     05 PS-CMN-Y-R-SW                   PIC X(01)   VALUE ' '.    05720039
054900         88 PS-CMN-Y-R-YES                          VALUE 'Y'.    05730039
055000         88 PS-CMN-Y-R-NO                           VALUE 'N'.    05740039
055100*                                                                 05750039
055200 01  PV-PROGRAM-VARIABLES.                                        05760039
055300     05  PV-SUB                         PIC S9(04)  VALUE +0      05770039
055400                                                    COMP SYNC.    05780039
055500     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      05790039
055600                                                    COMP SYNC.    05800039
055700     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      05810039
055800                                                    COMP-3.       05820039
055900     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      05830039
056000                                                    COMP-3.       05840039
056100     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      05850039
056200                                                    COMP-3.       05860039
056300     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      05870039
056400                                                    COMP-3.       05880039
056500     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      05890039
056600                                                    COMP-3.       05900039
056700     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      05910039
056800                                                    COMP-3.       05920039
056900     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      05930039
057000                                                    COMP-3.       05940039
057100     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      05950039
057200                                                    COMP SYNC.    05960039
057300     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      05970039
057400                                                    COMP SYNC.    05980039
057500     05  PV-ITEM                        PIC S9(04)  VALUE +0      05990039
057600                                                    COMP SYNC.    06000039
057700     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      06010039
057800                                                    COMP SYNC.    06020039
057900     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      06030039
058000                                                    COMP SYNC.    06040039
058100     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      06050039
058200                                                    COMP SYNC.    06060039
058300     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      06070039
058400                                                    COMP SYNC.    06080039
058500     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      06090039
058600                                                    COMP SYNC.    06100039
058700     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      06110039
058800                                                    COMP SYNC.    06120039
058900     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      06130039
059000                                                    COMP SYNC.    06140039
059100     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      06150039
059200                                                    COMP SYNC.    06160039
059300     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      06170039
059400                                                    COMP SYNC.    06180039
059500     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      06190039
059600                                                    COMP SYNC.    06200039
059700     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      06210039
059800                                                    COMP SYNC.    06220039
059900     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      06230039
060000                                                    COMP SYNC.    06240039
060100     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      06250039
060200                                                    COMP SYNC.    06260039
060300     05  PV-RLSE-DAYS                   PIC S9(09)  COMP          06270039
060400                                                    VALUE +0.     06280039
060500     05  PV-TYPE-CON-OR-CMN             PIC X(03)   VALUE SPACES. 06290039
060600     05  PV-STATUS-TEXT                 PIC X(18)   VALUE SPACES. 06300039
060700     05  PV-DCONSLR-RLSE-CDE            PIC X(01)   VALUE SPACES. 06310039
060800                                                                  06320039
060900     05  PV-IMPORTS-VARIABLES.                                    06330039
061000         10 PV-TOTAL-LINES-PACK       PIC S9(04)  VALUE +0        06340039
061100                                                    COMP SYNC.    06350039
061200         10 PV-CANCELED-LINES-PACK    PIC S9(04)  VALUE +0        06360039
061300                                                    COMP SYNC.    06370039
061400         10 PV-TOTAL-NBR-OF-DCS       PIC S9(04)  VALUE +0        06380039
061500                                                    COMP SYNC.    06390039
061600         10 PV-TOTAL-NBR-OF-UPCS      PIC S9(04)   VALUE +0       06400039
061700                                                     COMP SYNC.   06410039
061800         10 PV-TOTAL-PACK-UNITS       PIC  S9(13)  VALUE +0       06420039
061900                                                     COMP-3.      06430039
062000         10 PV-PDC-SPLIT-QTY          PIC  S9(13)  VALUE +0       06440039
062100                                                     COMP-3.      06450039
062200         10 PV-TOTAL-PACK-SPLIT-QTY   PIC S9(13) VALUE +0         06460039
062300                                                     COMP-3.      06470039
062400         10 PV-PACK-UNITS-PER-CTN     PIC S9(04) VALUE +0         06480039
062500                                                     COMP.        06490039
062600         10 PV-DC-CART-CT             PIC S9(04) VALUE +0         06500039
062700                                                     COMP.        06510039
062800         10 PV-PACK-CART-CT           PIC S9(04) VALUE +0         06520039
062900                                                     COMP.        06530039
063000         10 PV-TOTAL-CURR-SPLIT-QTY   PIC S9(13) VALUE +0         06540039
063100                                                   COMP-3.        06550039
063200         10 PV-UPC-CARTONS            PIC S9(04) VALUE +0         06560039
063300                                                     COMP.        06570039
063400         10 PV-MULTI-UPC-ROWS         PIC S9(04) VALUE +0         06580039
063500                                                     COMP.        06590039
063600*    *************************************************************06600039
063700*    * CHANGE ASC-EDIT-ERROR-AREA TO MATCH ANY CHANGES BELOW     *06610039
063800*    *************************************************************06620039
063900     05  PC-MAX-ERRORS                  PIC S9(04)  VALUE +20     06630039
064000                                                    COMP SYNC.    06640039
064100     05  PV-EDIT-ERROR-ARRAY.                                     06650039
064200         15  FILLER         OCCURS 20 TIMES.                      06660039
064300             20 PV-ERROR-CDE            PIC X(01).                06670039
064400     05  PV-NBR-EDIT-ERRORS             PIC S9(04)  VALUE +0      06680039
064500                                                    COMP SYNC.    06690039
064600*    *************************************************************06700039
064700     05  PV-PO-LINES                    PIC 9(03)   VALUE 0.      06710039
064800     05  PV-SUB-CLASS                   PIC 9(02)   VALUE ZEROS.  06720039
064900     05  PV-SUB-CL  REDEFINES PV-SUB-CLASS                        06730039
065000                                        PIC X(02).                06740039
065100     05  PV-MAJ-CLASS                   PIC 9(02)   VALUE ZEROS.  06750039
065200     05  PV-MAJ-CL  REDEFINES  PV-MAJ-CLASS                       06760039
065300                                        PIC X(02).                06770039
065400     05  PV-CLASS-1                     PIC X(01)   VALUE SPACES. 06780039
065500     05  PV-DB2-COUNT1                  PIC S9(09)  COMP          06790039
065600                                                    VALUE +0.     06800039
065700     05  PV-DB2-COUNT2                  PIC S9(09)  COMP          06810039
065800                                                    VALUE +0.     06820039
065900     05  PV-DB2-COUNT3                  PIC S9(09)  COMP          06830039
066000                                                    VALUE +0.     06840039
066100     05  PV-DB2-COUNT4                  PIC S9(09)  COMP          06850039
066200                                                    VALUE +0.     06860039
066300     05  PV-DB2-COUNT5                  PIC S9(09)  COMP          06870039
066400                                                    VALUE +0.     06880039
066500     05  PV-DB2-COUNT6                  PIC S9(09)  COMP          06890039
066600                                                    VALUE +0.     06900039
066700     05  PV-NUM-7                       PIC 9(07)   VALUE 0.      06910039
066800     05  PV-DB2-DATE                    PIC X(10)   VALUE SPACES. 06920039
066900     05  FILLER REDEFINES PV-DB2-DATE.                            06930039
067000         10 PV-DB2-DATE-CC              PIC X(02).                06940039
067100         10 PV-DB2-DATE-YY              PIC X(02).                06950039
067200         10 FILLER                      PIC X(01).                06960039
067300         10 PV-DB2-DATE-MM              PIC X(02).                06970039
067400         10 FILLER                      PIC X(01).                06980039
067500         10 PV-DB2-DATE-DD              PIC X(02).                06990039
067600     05  PV-DISPLAY-DATE.                                         07000039
067700         10 PV-DISPLAY-DATE-MM          PIC X(02)  VALUE SPACES.  07010039
067800         10 PV-DISPLAY-DATE-DD          PIC X(02)  VALUE SPACES.  07020039
067900         10 PV-DISPLAY-DATE-YY          PIC X(02)  VALUE SPACES.  07030039
068000     05  PV-DB2-RLSE-DATE               PIC X(10)   VALUE SPACES. 07040039
068100     05  PV-RLSE-DATE                   PIC X(06)   VALUE SPACES. 07050039
068200     05  PV-DONT-SHIP-BEF-DTE           PIC X(06)   VALUE SPACES. 07060039
068300     05  PV-CAN-IFNOT-SHIP-DTE          PIC X(06)   VALUE SPACES. 07070039
068400     05  PV-SYSTEM-ID                   PIC X(04)   VALUE SPACES. 07080039
068500         88  PV-CIT1-CICS                           VALUE 'CIT1'. 07090039
068600         88  PV-CIQA-CICS                           VALUE 'CIQA'. 07100039
068700     05  PV-USER-ID                     PIC X(08)   VALUE SPACES. 07110039
068800     05  PV-TEST-JOB.                                             07120039
068900         10  PV-TEST-JOB-USER-ID        PIC X(07).                07130039
069000         10  FILLER                     PIC X(01)  VALUE 'T'.     07140039
069100     05  PV-DEPT-NBR                    PIC X(03).                07150039
069200     05  PV-BUYER-NAME                  PIC  X(25).               07160039
069300     05  PV-BUYER-NUMBER                PIC  X(03).               07170039
069400     05  PV-BUYER.                                                07180039
069500         10  FILLER                     PIC  X(01)  VALUE 'B'.    07190039
069600         10  PV-BYR-NBR                 PIC  X(03).               07200039
069700         10  FILLER                     PIC  X(03)  VALUE '   '.  07210039
069800         10  PV-BYR-NAME                PIC  X(25).               07220039
069900     05  PV-EST-AR-TMST PIC  X(26)  VALUE SPACES.                 07230039
070000     05  PV-E-COM-WORK-FIELDS.                                    07240039
070100         10  PV-NBR-OF-E-COM-DCS       PIC S9(04)  VALUE +0       07250039
070200                                                     COMP.        07260039
070300         10  PV-NBR-OF-E-COM-ROWS      PIC S9(04)  VALUE +0       07270039
070400                                                     COMP.        07280039
070500         10  PV-TTL-BAD-PACK-UPCS       PIC S9(04)  VALUE +0      07290039
070600                                                    COMP.         07300039
070700         10  PV-TTL-E-COM-PACK-UPCS     PIC S9(04)  VALUE +0      07310039
070800                                                    COMP.         07320039
070900         10  PV-TTL-PACK-UPCS           PIC S9(04)  VALUE +0      07330039
071000                                                    COMP.         07340039
071100         10  PV-HLD-PO-PREPK-ID         PIC S9(04)  VALUE +0      07350039
071200                                                    COMP.         07360039
071300******************************************************************07370039
071400**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **07380039
071500**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **07390039
071600**  APPLICATION-SPECIFIC COMMAREA.                              **07400039
071700******************************************************************07410039
071800 01  LQW-LIST-QUEUE-WORK-AREA.                                    07420039
071900     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  07430039
072000     05  LQW-ITEM-ENTRIES               OCCURS 12 TIMES           07440039
072100                                        INDEXED BY LQW-IDX.       07450039
072200         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       07460039
072300         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               07470039
072400         10  LQW-SELECTED-SW            PIC  X(01).               07480039
072500             88  LQW-SELECT                         VALUE 'S'.    07490039
072600             88  LQW-DESELECT                       VALUE ' '.    07500039
072700         10  LQW-REL                    PIC  X(01).               07510039
C98147         10  LQW-PO-NUMBER              PIC  9(08).               07520058
072900         10  LQW-RLSE-DAYS              PIC S9(03)                07530039
073000                                            COMP-3.               07540039
073100         10  LQW-RLSE-DATE              PIC  X(06).               07550039
073200         10  LQW-DPT                    PIC  X(03).               07560039
073300         10  LQW-MAJ-CLASS              PIC  X(02).               07570039
073400         10  LQW-SUB-CLASS              PIC  X(02).               07580039
073500         10  LQW-VENDOR                 PIC  X(10).               07590039
073600         10  LQW-SHIP-DATE              PIC  X(06).               07600039
073700         10  LQW-CAN-DATE               PIC  X(06).               07610039
073800** TKMA888 7/10/03 ********************************************** 07620039
073900* REPLACED 1 LINE                                                 07630039
074000*        10  LQW-STATUS                 PIC  X(15).               07640039
074100         10  LQW-STATUS                 PIC  X(18).               07650039
074200* DELETED  2 LINES                                                07660039
074300*        10  LQW-PO-LINES               PIC  9(03)                07670039
074400*                                           COMP-3.               07680039
074500** TKMA888 7/10/03 ********************************************** 07690039
074600         10  LQW-DCONSLR-RLSE-CDE       PIC  X(01).               07700039
074700         10  LQW-ENT-ID                 PIC S9(09)                07710039
074800                                            COMP-3.               07720039
074900         10  LQW-NEW-STR-PO-IND         PIC  X(01).               07730039
075000         10  LQW-CMN-ERROR-IND          PIC  X(01).               07740039
075100         10  LQW-TYPE-CON-OR-CMN        PIC  X(03).               07750039
075200         10  LQW-NBR-EDIT-ERRORS        PIC  S9(04)               07760039
075300                                             COMP.                07770039
075400         10  LQW-EDIT-ERROR-ARRAY       PIC  X(20).               07780039
075500     EJECT                                                        07790039
075600*---------------------------------------------------------------* 07800039
075700*  RECORD LAYOUT FOR THE PO RELEASE TEMP STORAGE QUEUE.         * 07810039
075800*---------------------------------------------------------------* 07820039
075900                                                                  07830039
076000     COPY POWS062.                                                07840039
076100                                                                  07850039
076200     EJECT                                                        07860039
076300*---------------------------------------------------------------* 07870039
076400*    MAP LAYOUT                                                 * 07880039
076500*---------------------------------------------------------------* 07890039
076600                                                                  07900039
076700     COPY POKM061.                                                07910039
076800*                                                                 07920039
076900 01  MR-OCCURS-LAYOUT                   REDEFINES  PO061AO.       07930039
077000     05  FILLER                         PIC X(48).                07940039
077100     05  MR-SCROLL-AREA                 OCCURS 12 TIMES.          07950039
077200         10  MR-SELECTL                 PIC S9(04) COMP.          07960039
077300         10  MR-SELECTA                 PIC  X(01).               07970039
077400         10  MR-SELECTC                 PIC  X(01).               07980039
077500         10  MR-SELECTH                 PIC  X(01).               07990039
077600         10  MR-SELECTI                 PIC  X(01).               08000039
077700                                                                  08010039
077800         10  MR-RELL                    PIC S9(04) COMP.          08020039
077900         10  MR-RELA                    PIC  X(01).               08030039
078000         10  MR-RELC                    PIC  X(01).               08040039
078100         10  MR-RELH                    PIC  X(01).               08050039
078200         10  MR-REL                     PIC  X(01).               08060039
078300                                                                  08070039
078400         10  MR-PO-NUMBERL              PIC S9(04) COMP.          08080039
078500         10  MR-PO-NUMBERA              PIC  X(01).               08090039
078600         10  MR-PO-NUMBERC              PIC  X(01).               08100039
078700         10  MR-PO-NUMBERH              PIC  X(01).               08110039
078800         10  MR-PO-NUMBER-X.                                      08120039
C98147             15  MR-PO-NUMBER           PIC  ZZZZZZZ9.            08130058
079000                                                                  08140039
079100         10  MR-RLSE-DAYSL              PIC S9(04) COMP.          08150039
079200         10  MR-RLSE-DAYSA              PIC  X(01).               08160039
079300         10  MR-RLSE-DAYSC              PIC  X(01).               08170039
079400         10  MR-RLSE-DAYSH              PIC  X(01).               08180039
079500         10  MR-RLSE-DAYS-X.                                      08190039
079600             15  MR-RLSE-DAYS           PIC ---9.                 08200039
079700                                                                  08210039
079800         10  MR-RLSE-DATEL              PIC S9(04) COMP.          08220039
079900         10  MR-RLSE-DATEA              PIC  X(01).               08230039
080000         10  MR-RLSE-DATEC              PIC  X(01).               08240039
080100         10  MR-RLSE-DATEH              PIC  X(01).               08250039
080200         10  MR-RLSE-DATE               PIC  X(06).               08260039
080300                                                                  08270039
080400         10  MR-DPTL                    PIC S9(04) COMP.          08280039
080500         10  MR-DPTA                    PIC  X(01).               08290039
080600         10  MR-DPTC                    PIC  X(01).               08300039
080700         10  MR-DPTH                    PIC  X(01).               08310039
080800         10  MR-DPT                     PIC  X(03).               08320039
080900                                                                  08330039
081000         10  MR-MAJ-CLASSL              PIC S9(04) COMP.          08340039
081100         10  MR-MAJ-CLASSA              PIC  X(01).               08350039
081200         10  MR-MAJ-CLASSC              PIC  X(01).               08360039
081300         10  MR-MAJ-CLASSH              PIC  X(01).               08370039
081400         10  MR-MAJ-CLASS               PIC  X(02).               08380039
081500                                                                  08390039
081600         10  MR-SUB-CLASSL              PIC S9(04) COMP.          08400039
081700         10  MR-SUB-CLASSA              PIC  X(01).               08410039
081800         10  MR-SUB-CLASSC              PIC  X(01).               08420039
081900         10  MR-SUB-CLASSH              PIC  X(01).               08430039
082000         10  MR-SUB-CLASS               PIC  X(02).               08440039
082100                                                                  08450039
082200         10  MR-VENDORL                 PIC S9(04) COMP.          08460039
082300         10  MR-VENDORA                 PIC  X(01).               08470039
082400         10  MR-VENDORC                 PIC  X(01).               08480039
082500         10  MR-VENDORH                 PIC  X(01).               08490039
082600         10  MR-VENDOR                  PIC  X(10).               08500039
082700                                                                  08510039
082800         10  MR-SHIP-DATEL              PIC S9(04) COMP.          08520039
082900         10  MR-SHIP-DATEA              PIC  X(01).               08530039
083000         10  MR-SHIP-DATEC              PIC  X(01).               08540039
083100         10  MR-SHIP-DATEH              PIC  X(01).               08550039
083200         10  MR-SHIP-DATE               PIC  X(06).               08560039
083300                                                                  08570039
083400         10  MR-CAN-DATEL               PIC S9(04) COMP.          08580039
083500         10  MR-CAN-DATEA               PIC  X(01).               08590039
083600         10  MR-CAN-DATEC               PIC  X(01).               08600039
083700         10  MR-CAN-DATEH               PIC  X(01).               08610039
083800         10  MR-CAN-DATE                PIC  X(06).               08620039
083900                                                                  08630039
084000         10  MR-STATUSL                 PIC S9(04) COMP.          08640039
084100         10  MR-STATUSA                 PIC  X(01).               08650039
084200         10  MR-STATUSC                 PIC  X(01).               08660039
084300         10  MR-STATUSH                 PIC  X(01).               08670039
084400** TKMA888 7/10/03 ********************************************** 08680039
084500* REPLACED 1 LINE                                                 08690039
084600*        10  MR-STATUS                  PIC  X(14).               08700039
084700         10  MR-STATUS                  PIC  X(18).               08710039
084800** TKMA888 7/10/03 ********************************************** 08720039
084900                                                                  08730039
085000** TKMA888 7/10/03 ********************************************** 08740039
085100* REMOVED 6 LINES                                                 08750039
085200*        10  MR-PO-LINESL               PIC S9(04) COMP.          08760039
085300*        10  MR-PO-LINESA               PIC  X(01).               08770039
085400*        10  MR-PO-LINESC               PIC  X(01).               08780039
085500*        10  MR-PO-LINESH               PIC  X(01).               08790039
085600*        10  MR-PO-LINES-X.                                       08800039
085700*            15  MR-PO-LINES            PIC  ZZZ.                 08810039
085800** TKMA888 7/10/03 ********************************************** 08820039
085900                                                                  08830039
086000     EJECT                                                        08840039
086100*---------------------------------------------------------------* 08850039
086200*    ATTRIBUTE SETTINGS COPYBOOK.                               * 08860039
086300*---------------------------------------------------------------* 08870039
086400                                                                  08880039
086500     COPY DPWS015.                                                08890039
086600                                                                  08900039
086700*---------------------------------------------------------------* 08910039
086800*    FUNCTION KEYS COPYBOOK.                                    * 08920039
086900*---------------------------------------------------------------* 08930039
087000                                                                  08940039
087100     COPY DPWS016.                                                08950039
087200                                                                  08960039
087300*---------------------------------------------------------------* 08970039
087400*    NUMERIC EDIT LAYOUT.                                       * 08980039
087500*---------------------------------------------------------------* 08990039
087600                                                                  09000039
087700     COPY DPWS010I.                                               09010039
087800 EJECT                                                            09020039
087900*---------------------------------------------------------------* 09030039
CICS  ** PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.            * 09040068
088100*---------------------------------------------------------------* 09050039
088200                                                                  09060039
088300     COPY DPWS030.                                                09070039
088300     COPY DPWS930.                                                09071065
088400 EJECT                                                            09080039
088500*----------------------------------------------------------------*09090039
088600**  SECURITY SUBROUTINE PARAMETERS                                09100039
088700*----------------------------------------------------------------*09110039
088800     COPY DPWS008.                                                09120039
088900/                                                                 09130039
089000*---------------------------------------------------------------* 09140039
089100*    STANDARD COMMAREA.                                         * 09150039
089200*---------------------------------------------------------------* 09160039
089300                                                                  09170039
089400     COPY DPWS020.                                                09180039
089500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                09190039
089600                                                                  09200039
089700                                                                  09210039
089800         10  INTER-APPL-COMM-AREA       PIC X(200).               09220039
089900*---------------------------------------------------------------* 09230039
090000* INTER-APPLICATION COMMAREA.                                   * 09240039
090100*   POWS060 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 09250039
090200*             SPEC SCREEN.                                      * 09260039
090300*   POWS013 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 09270039
090400*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 09280039
090500*   TRWS061 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 09290039
090600*             THIS LIST PROGRAMMING TO THE MESSAGE DETAIL       * 09300039
090700*             PROGRAM TRKCS361 (LOCAL FUNCTION 02).             * 09310039
090800*---------------------------------------------------------------* 09320039
090900     COPY POWS060.                                                09330039
091000     COPY POWS013.                                                09340039
091100     COPY TRWS061.                                                09350039
091200*---------------------------------------------------------------* 09360039
091300*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 09370039
091400*---------------------------------------------------------------* 09380039
091500         10  ASC-SPECIFIC-COMMAREA.                               09390039
091600             15  ASC-LIST-KEYS.                                   09400039
091700                 20  ASC-KEY-DPT                     PIC  X(03).  09410039
091800                 20  ASC-KEY-RLSE-DAYS               PIC  9(03).  09420039
091900                 20  ASC-KEY-STATUS                  PIC  X(01).  09430039
092000                 20  ASC-KEY-DMM-NAME                PIC  X(20).  09440039
092100                 20  ASC-KEY-PO-NUMBER               PIC  S9(09)  09450039
092200                                                          COMP.   09460039
092300             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                09470039
092400                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  09480039
092500                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   09490039
092600                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   09500039
092700                                                                  09510039
092800                 20  ASC-ITEM-ARRAY.                              09520039
092900                     25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        09530039
093000                         30  ASC-LIST-ITEM-NUMBER                 09540039
093100                                                     PIC S9(09)   09550039
093200                                                     COMP-3.      09560039
093300                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  09570039
093400                             88  ASC-VALID-SELECT    VALUE ' '    09580039
093500                                                           'S'    09590039
093600                                                           'B'    09600039
093700                                                           'E'.   09610039
093800                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   09620039
093900                             88  ASC-TEMP-SELECT     VALUE 'S'.   09630039
094000                             88  ASC-TEMP-BEGIN      VALUE 'B'.   09640039
094100                             88  ASC-TEMP-END        VALUE 'E'.   09650039
094200                         30  ASC-SELECTED-SW         PIC  X(01).  09660039
094300                             88  ASC-NO-SELECT       VALUE ' '.   09670039
094400                             88  ASC-SELECT          VALUE 'S'.   09680039
094500                             88  ASC-BEGIN           VALUE 'B'.   09690039
094600                             88  ASC-END             VALUE 'E'.   09700039
094700                         30  ASC-REL                 PIC  X(01).  09710039
094800                         30  ASC-PO-NUMBER.                       09720039
C98147                             35 ASC-PO-NUMBER-N      PIC  9(08).  09730059
095000                         30  ASC-RLSE-DAYS           PIC S9(03)   09740039
095100                                                         COMP-3.  09750039
095200                         30  ASC-RLSE-DATE           PIC  X(06).  09760039
095300                         30  ASC-DPT                 PIC  X(03).  09770039
095400                         30  ASC-MAJ-CLASS           PIC  X(02).  09780039
095500                         30  ASC-SUB-CLASS           PIC  X(02).  09790039
095600                         30  ASC-VENDOR              PIC  X(10).  09800039
095700                         30  ASC-SHIP-DATE           PIC  X(06).  09810039
095800                         30  ASC-CAN-DATE            PIC  X(06).  09820039
095900** TKMA888 7/10/03 ********************************************** 09830039
096000* REPLACED 1 LINE *********************************************** 09840039
096100*                        30  ASC-STATUS              PIC  X(14).  09850039
096200                         30  ASC-STATUS              PIC  X(18).  09860039
096300* DELETED 2 LINES *********************************************** 09870039
096400*                        30  ASC-PO-LINES            PIC  9(03)   09880039
096500*                                                        COMP-3.  09890039
096600** TKMA888 7/10/03 ********************************************** 09900039
096700                         30  ASC-DCONSLR-RLSE-CDE    PIC  X(01).  09910039
096800                         30  ASC-ENT-ID              PIC S9(09)   09920039
096900                                                         COMP-3.  09930039
097000                         30  ASC-NEW-STR-PO-IND      PIC  X(01).  09940039
097100                         30  ASC-CMN-ERROR-IND       PIC  X(01).  09950039
097200                         30  ASC-TYPE-CON-OR-CMN     PIC  X(03).  09960039
097300                         30  ASC-NBR-EDIT-ERRORS     PIC S9(04)   09970039
097400                                                          COMP.   09980039
097500                         30  ASC-EDIT-ERROR-ARRAY    PIC  X(20).  09990039
097600             15  ASC-BLK-SUB                         PIC S9(04)   10000039
097700                                                          COMP    10010039
097800                                                          SYNC.   10020039
097900             15  ASC-ITEM-SUB                        PIC S9(04)   10030039
098000                                                          COMP    10040039
098100                                                          SYNC.   10050039
098200             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   10060039
098300                                                          COMP-3. 10070039
098400             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   10080039
098500                                                          COMP-3. 10090039
098600             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   10100039
098700                                                          COMP-3. 10110039
098800             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   10120039
098900                                                          COMP-3. 10130039
099000             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   10140039
099100                                                          COMP-3. 10150039
099200             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   10160039
099300                                                          COMP    10170039
099400                                                          SYNC.   10180039
099500             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   10190039
099600                                                          COMP-3. 10200039
099700             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   10210039
099800                                                          COMP-3. 10220039
099900             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  10230039
100000                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   10240039
100100                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   10250039
100200             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  10260039
100300                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   10270039
100400                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   10280039
100500             15  ASC-LIST-QUEUE-NAME.                             10290039
100600                 20  ASC-LIST-TERM-ID                PIC  X(04).  10300039
100700                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   10310039
100800                                                          COMP-3. 10320039
100900                 20  ASC-LIST-SEQ                    PIC  9(01).  10330039
101000             15  ASC-SEL-QUEUE-NAME.                              10340039
101100                 20  ASC-SEL-TERM-ID                 PIC  X(04).  10350039
101200                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   10360039
101300                                                          COMP-3. 10370039
101400                 20  ASC-SEL-SEQ                     PIC  9(01).  10380039
101500                                                                  10390039
101600             15  ASC-CURSOR-SW                       PIC  X(01).  10400039
101700                 88  ASC-NO-CURSOR                   VALUE '0'.   10410039
101800                 88  ASC-CURSOR1                     VALUE '1'.   10420039
101900                 88  ASC-CURSOR2                     VALUE '2'.   10430039
102000                 88  ASC-CURSOR3                     VALUE '3'.   10440039
102100                 88  ASC-CURSOR4                     VALUE '4'.   10450039
102200                 88  ASC-CURSOR5                     VALUE '5'.   10460039
102300                 88  ASC-CURSOR6                     VALUE '6'.   10470039
102400             15  ASC-START-ITEM-REQUEST.                          10480039
102500                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  10490039
102600             15  ASC-DMA-NBR                         PIC  X(02).  10500039
102700** TKMA888 7/10/03 ********************************************** 10510039
102800* REPLACED 1 LINE *********************************************** 10520039
102900*        10  FILLER                                  PIC  X(320). 10530039
103000         10  FILLER                                  PIC  X(296). 10540039
103100** TKMA888 7/10/03 ********************************************** 10550039
103200     EJECT                                                        10560039
103300*---------------------------------------------------------------* 10570039
103400*    ABEND PROCESSING COPYBOOK.                                 * 10580039
103500*---------------------------------------------------------------* 10590039
103600                                                                  10600039
103700     COPY DPWS013.                                                10610039
103800                                                                  10620039
103900 EJECT                                                            10630039
104000*---------------------------------------------------------------* 10640039
104100*    DB2 AREA FOR TPURCHS                                       * 10650039
104200*---------------------------------------------------------------* 10660039
104300     EXEC SQL                                                     10670039
104400          INCLUDE TPURCHS                                         10680039
104500     END-EXEC.                                                    10690039
104600*---------------------------------------------------------------* 10700039
104700*    DB2 AREA FOR TPURITM                                       * 10710039
104800*---------------------------------------------------------------* 10720039
104900     EXEC SQL                                                     10730039
105000          INCLUDE TPURITM                                         10740039
105100     END-EXEC.                                                    10750039
105200*---------------------------------------------------------------* 10760039
105300*    DB2 AREA FOR TALLPLN                                       * 10770039
105400*---------------------------------------------------------------* 10780039
105500     EXEC SQL                                                     10790039
105600          INCLUDE TALLPLN                                         10800039
105700     END-EXEC.                                                    10810039
105800*---------------------------------------------------------------* 10820039
105900*    DB2 AREA FOR PO PREPACK TABLE                              * 10830039
106000*---------------------------------------------------------------* 10840039
106100     EXEC SQL                                                     10850039
106200          INCLUDE TPOPRPK                                         10860039
106300     END-EXEC.                                                    10870039
106400*---------------------------------------------------------------* 10880039
106500*    DB2 AREA FOR TMESTDS                                       * 10890039
106600*---------------------------------------------------------------* 10900039
106700     EXEC SQL                                                     10910039
106800          INCLUDE TMESTDS                                         10920039
106900     END-EXEC.                                                    10930039
107000*---------------------------------------------------------------* 10940039
107100*    DB2 AREA FOR TEXTENT                                       * 10950039
107200*---------------------------------------------------------------* 10960039
107300     EXEC SQL                                                     10970039
107400          INCLUDE TEXTENT                                         10980039
107500     END-EXEC.                                                    10990039
107600*---------------------------------------------------------------* 11000039
107700*    DB2 AREA FOR TENTNME                                       * 11010039
107800*---------------------------------------------------------------* 11020039
107900     EXEC SQL                                                     11030039
108000          INCLUDE TENTNME                                         11040039
108100     END-EXEC.                                                    11050039
108200*---------------------------------------------------------------* 11060039
108300*    DB2 AREA FOR TPLNSHP                                       * 11070039
108400*---------------------------------------------------------------* 11080039
108500     EXEC SQL                                                     11090039
108600          INCLUDE TPLNSHP                                         11100039
108700     END-EXEC.                                                    11110039
108800*---------------------------------------------------------------* 11120039
108900*    DB2 AREA FOR TMDSEAR                                       * 11130039
109000*---------------------------------------------------------------* 11140039
109100     EXEC SQL                                                     11150039
109200          INCLUDE TMDSEAR                                         11160039
109300     END-EXEC.                                                    11170039
109400*---------------------------------------------------------------* 11180039
109500*    DB2 AREA FOR TRSPBAR                                       * 11190039
109600*---------------------------------------------------------------* 11200039
109700     EXEC SQL                                                     11210039
109800          INCLUDE TRSPBAR                                         11220039
109900     END-EXEC.                                                    11230039
110000*---------------------------------------------------------------* 11240039
110100*    DB2 AREA FOR TWORKER                                       * 11250039
110200*---------------------------------------------------------------* 11260039
110300     EXEC SQL                                                     11270039
110400          INCLUDE TWORKER                                         11280039
110500     END-EXEC.                                                    11290039
110600*---------------------------------------------------------------* 11300039
110700*    DB2 AREA FOR XMT_LOC                                       * 11310039
110800*---------------------------------------------------------------* 11320039
110900     EXEC SQL                                                     11330039
111000          INCLUDE XMT00001                                        11340039
111100     END-EXEC.                                                    11350039
111200*---------------------------------------------------------------* 11360039
111300*    DB2 AREA FOR XMT_DC_LOC_ASGMT                              * 11370039
111400*---------------------------------------------------------------* 11380039
111500     EXEC SQL                                                     11390039
111600          INCLUDE XMT00002                                        11400039
111700     END-EXEC.                                                    11410039
111800*---------------------------------------------------------------* 11420039
111900*    DB2 AREA FOR TSTVNDC                                       * 11430039
112000*---------------------------------------------------------------* 11440039
112100*    EXEC SQL                                                     11450060
112200*         INCLUDE TSTVNDC                                         11460060
112300*    END-EXEC.                                                    11470060
112400*    EJECT                                                        11480060
112500     EXEC SQL                                                     11490039
112600          INCLUDE TVHTRIP                                         11500039
112700     END-EXEC.                                                    11510039
112800     EJECT                                                        11520039
112900     EXEC SQL                                                     11530039
113000          INCLUDE TSHIPMT                                         11540039
113100     END-EXEC.                                                    11550039
113200     EJECT                                                        11560039
113300     EXEC SQL                                                     11570039
113400          INCLUDE TSHPTPO                                         11580039
113500     END-EXEC.                                                    11590039
113600     EJECT                                                        11600039
113700     EXEC SQL                                                     11610039
113800          INCLUDE TVEHICL                                         11620039
113900     END-EXEC.                                                    11630039
114000     EJECT                                                        11640039
114100     EXEC SQL                                                     11650039
114200         INCLUDE TTRIPST                                          11660039
114300     END-EXEC.                                                    11670039
114400     EJECT                                                        11680039
114500     EXEC SQL                                                     11690039
114600         INCLUDE TTRSTYP                                          11700039
114700     END-EXEC.                                                    11710039
114800     EJECT                                                        11720039
114900     EXEC SQL                                                     11730039
115000         INCLUDE XLT00003                                         11740039
115100     END-EXEC.                                                    11750039
115200     EJECT                                                        11760039
115300     EXEC SQL                                                     11770039
115400         INCLUDE TUPCPLS                                          11780039
115500     END-EXEC.                                                    11790039
115600     EJECT                                                        11800039
115700     EXEC SQL                                                     11810039
115800         INCLUDE TWEBITM                                          11820039
115900     END-EXEC.                                                    11830039
116000     EJECT                                                        11840039
116100     EXEC SQL                                                     11850039
116200         INCLUDE XLT00004                                         11860039
116300     END-EXEC.                                                    11870039
116400     EJECT                                                        11880039
116500     EXEC SQL                                                     11890039
116600         INCLUDE XLT00006                                         11900039
116700     END-EXEC.                                                    11910039
116800     EJECT                                                        11920039
116900     EXEC SQL                                                     11930039
117000         INCLUDE TIMPORL                                          11940039
117100     END-EXEC.                                                    11950039
117200                                                                  11960039
117300     EXEC SQL                                                     11970039
117400         INCLUDE TIMCNRL                                          11980039
117500     END-EXEC.                                                    11990039
117600                                                                  12000039
117700     EXEC SQL                                                     12010039
117800         INCLUDE TIMCNTK                                          12020039
117900     END-EXEC.                                                    12030039
118000                                                                  12040039
118100     EXEC SQL                                                     12050039
118200         INCLUDE TIMCNPO                                          12060039
118300     END-EXEC.                                                    12070039
118400                                                                  12080039
118500     EXEC SQL                                                     12090039
118600         INCLUDE TUPCSKU                                          12100039
118700     END-EXEC.                                                    12110039
118800                                                                  12120039
118900*---------------------------------------------------------------* 12130039
119000*    DB2 AREA FOR IMPORTS CONTAINER UPC TABLE                   * 12140039
119100*---------------------------------------------------------------* 12150039
119200     EXEC SQL                                                     12160039
119300          INCLUDE TIMCNUP                                         12170039
119400     END-EXEC.                                                    12180039
119500                                                                  12190039
119600     EXEC SQL                                                     12200039
119700         INCLUDE TAUCNRL                                          12210039
119800     END-EXEC.                                                    12220039
119900                                                                  12230039
120000     EXEC SQL                                                     12240039
120100         INCLUDE TSHIPST                                          12250039
120200     END-EXEC.                                                    12260039
120300                                                                  12270039
120400     EXEC SQL                                                     12280039
120500         INCLUDE TSHSTYP                                          12290039
120600     END-EXEC.                                                    12300039
120700                                                                  12310039
120800     EXEC SQL                                                     12320039
120900         INCLUDE TVNDAGR                                          12330039
121000     END-EXEC.                                                    12340039
121100     EJECT                                                        12350039
121200*---------------------------------------------------------------* 12360039
121300*    DB2 AREA FOR COMMUNICATIONS                                * 12370039
121400*---------------------------------------------------------------* 12380039
121500     EXEC SQL                                                     12390039
121600          INCLUDE SQLCA                                           12400039
121700     END-EXEC.                                                    12410039
121701                                                                  12420039
121702*---------------------------------------------------------------* 12430015
121703*    CURSOR WHEN PO NUMBER AND DMM NAME ARE NOT ENTERED         * 12440015
121704*---------------------------------------------------------------* 12450015
121705                                                                  12460015
121706     EXEC SQL                                                     12470015
121707          DECLARE CURSOR1 CURSOR                                  12480015
121708          FOR SELECT DISTINCT                                     12490015
121709                A.PO_NBR,                                         12500015
121710                A.EDI_IND,                                        12510015
121711                A.DEPT_NBR,                                       12520015
121712                C.DONT_SHIP_BEF_DTE,                              12530015
121713                C.CAN_IFNOT_SHIP_DTE,                             12540015
121714                D.ENT_NAME_DESC,                                  12550015
121715                                                                  12560015
121716               (DAYS(C.DONT_SHIP_BEF_DTE)                         12570015
121717               - B.LEADTIME_DAYS_QTY                              12580015
121718               - :PC-PROCESSING-TIME)                             12590015
121719               - DAYS(CURRENT DATE),                              12600015
121720                                                                  12610015
121721               (C.DONT_SHIP_BEF_DTE                               12620015
121722               - B.LEADTIME_DAYS_QTY DAYS                         12630015
121723               - :PC-PROCESSING-TIME DAYS)                        12640015
121724                                                                  12650015
121725               ,A.ENT_ID                                          12660015
121726               ,A.NEW_STR_PO_IND                                  12670015
121727          FROM                                                    12680015
121728                TPURCHS A,                                        12690015
121729                TVNDAGR B,                                        12700015
121730                TPLNSHP C,                                        12710015
121731                TENTNME D                                         12720015
121732          WHERE                                                   12730015
121733                 A.RLSE_IND = 'N'                                 12740015
121734            AND  A.STATUS_CDE IN ('AP', 'AC')                     12750015
121735            AND  A.VER_STATUS_CDE = :PC-A                         12760015
121736            AND  A.PO_CATEG_CDE   = 'MR'                          12770015
121737            AND  A.PO_TYP_CDE NOT IN ('AP', 'IM', 'IE', 'IF')     12780015
121738            AND  (A.DEPT_NBR BETWEEN :DK-DPT-NBR-BEG              12790015
121739            AND  :DK-DPT-NBR-END)                                 12800015
121740            AND  A.ENT_ID   = B.ENT_ID                            12810015
121741            AND  A.DEPT_NBR = B.DEPT_NBR                          12820015
121742            AND  B.AGRMT_TYP_ID                                   12830015
121743                            = '6'                                 12840015
121744            AND  B.TYP_CDE  =  5                                  12850015
121745            AND  B.EFFECTIVE_DATE  <= CURRENT DATE                12860017
121746            AND  B.EXPIRATION_DATE >  CURRENT DATE                12870018
121747            AND (A.ENT_ID   = D.ENT_ID                            12880015
121748            AND  D.TYPE_CDE = '04')                               12890015
121749            AND  A.PO_NBR   = C.PO_NBR                            12900015
121750            AND  C.VER_STATUS_CDE = :PC-A                         12910015
121751            AND  (CURRENT DATE                                    12920015
121752                + B.LEADTIME_DAYS_QTY DAYS                        12930016
121753                + :PC-PROCESSING-TIME DAYS                        12940015
121754                + :DK-RLSE-DAYS DAYS)                             12950015
121755                >= C.DONT_SHIP_BEF_DTE                            12960015
121756          ORDER BY                                                12970015
121757                7, 3, 6                                           12980015
121758     END-EXEC.                                                    12990015
121759                                                                  13000015
121760*---------------------------------------------------------------* 13010015
121761*    CURSOR WHEN DMM NAME IS ENTERED                            * 13020015
121762*---------------------------------------------------------------* 13030015
121763                                                                  13040015
121764     EXEC SQL                                                     13050015
121765          DECLARE CURSOR2 CURSOR                                  13060015
121766          FOR SELECT DISTINCT                                     13070015
121767                A.PO_NBR,                                         13080015
121768                A.EDI_IND,                                        13090015
121769                A.DEPT_NBR,                                       13100015
121770                C.DONT_SHIP_BEF_DTE,                              13110015
121771                C.CAN_IFNOT_SHIP_DTE,                             13120015
121772                E.ENT_NAME_DESC,                                  13130015
121773                                                                  13140015
121774               (DAYS(C.DONT_SHIP_BEF_DTE)                         13150015
121775                - B.LEADTIME_DAYS_QTY                             13160016
121776                - :PC-PROCESSING-TIME)                            13170015
121777                - DAYS(CURRENT DATE),                             13180015
121778                                                                  13190015
121779                (C.DONT_SHIP_BEF_DTE                              13200015
121780                - B.LEADTIME_DAYS_QTY DAYS                        13210016
121781                - :PC-PROCESSING-TIME DAYS)                       13220015
121782                                                                  13230015
121783               ,A.ENT_ID                                          13240015
121784               ,A.NEW_STR_PO_IND                                  13250015
121785          FROM                                                    13260015
121786                TPURCHS A,                                        13270015
121787                TVNDAGR B,                                        13280015
121788                TPLNSHP C,                                        13290015
121789                TMDSEAR D,                                        13300015
121790                TENTNME E                                         13310015
121791          WHERE                                                   13320015
121792                 A.RLSE_IND = 'N'                                 13330015
121793            AND  A.STATUS_CDE IN ('AP', 'AC')                     13340015
121794            AND  A.VER_STATUS_CDE = :PC-A                         13350015
121795            AND  A.PO_TYP_CDE NOT IN ('AP', 'IM', 'IE', 'IF')     13360015
121796            AND  A.PO_CATEG_CDE   = 'MR'                          13370015
121797            AND  A.ENT_ID = B.ENT_ID                              13380015
121798            AND  A.DEPT_NBR = B.DEPT_NBR                          13390015
121799            AND  B.AGRMT_TYP_ID                                   13400015
121800                            = '6'                                 13410015
121801            AND  B.TYP_CDE  =  5                                  13420015
121802            AND  B.EFFECTIVE_DATE  <= CURRENT DATE                13430017
121803            AND  B.EXPIRATION_DATE >  CURRENT DATE                13440018
121804            AND (A.ENT_ID   = E.ENT_ID                            13450015
121805            AND  E.TYPE_CDE = '04')                               13460015
121806            AND  A.PO_NBR = C.PO_NBR                              13470015
121807            AND  C.VER_STATUS_CDE = :PC-A                         13480015
121808            AND ((CURRENT DATE                                    13490015
121809                 + B.LEADTIME_DAYS_QTY DAYS                       13500016
121810                 + :PC-PROCESSING-TIME DAYS                       13510015
121811                 + :DK-RLSE-DAYS DAYS)                            13520015
121812                 >= C.DONT_SHIP_BEF_DTE)                          13530015
121813            AND (A.DEPT_NBR  = D.DEPT_NBR                         13540015
121814            AND D.DMA_NBR    = :DK-DMA-NBR                        13550015
121815            AND D.MDSELV_CDE = 'DPT'                              13560015
121816            AND (CURRENT DATE BETWEEN D.STRT_DTE AND D.END_DTE))  13570015
121817          ORDER BY                                                13580015
121818                7, 3, 6                                           13590015
121819     END-EXEC.                                                    13600015
121820                                                                  13610015
121821*---------------------------------------------------------------* 13620015
121822*    CURSOR WHEN PO NUMBER IS ENTERED                           * 13630015
121823*---------------------------------------------------------------* 13640015
121824                                                                  13650015
121825     EXEC SQL                                                     13660015
121826          DECLARE CURSOR3 CURSOR                                  13670015
121827          FOR SELECT DISTINCT                                     13680015
121828                A.PO_NBR,                                         13690015
121829                A.EDI_IND,                                        13700015
121830                A.DEPT_NBR,                                       13710015
121831                B.DONT_SHIP_BEF_DTE,                              13720015
121832                B.CAN_IFNOT_SHIP_DTE,                             13730015
121833                D.ENT_NAME_DESC,                                  13740015
121834                                                                  13750015
121835               (DAYS(B.DONT_SHIP_BEF_DTE)                         13760015
121836                - C.LEADTIME_DAYS_QTY                             13770015
121837                - :PC-PROCESSING-TIME)                            13780015
121838                - DAYS(CURRENT DATE),                             13790015
121839                                                                  13800015
121840                (B.DONT_SHIP_BEF_DTE                              13810015
121841                - C.LEADTIME_DAYS_QTY DAYS                        13820015
121842                - :PC-PROCESSING-TIME DAYS)                       13830015
121843                                                                  13840015
121844               ,A.ENT_ID                                          13850015
121845               ,A.NEW_STR_PO_IND                                  13860015
121846          FROM                                                    13870015
121847                TPURCHS A,                                        13880015
121848                TPLNSHP B,                                        13890015
121849                TVNDAGR C,                                        13900015
121850                TENTNME D                                         13910015
121851          WHERE                                                   13920015
121852                 A.PO_NBR         = :DK-PO-NUMBER                 13930015
121853            AND  A.VER_STATUS_CDE = :PC-A                         13940015
121854            AND  A.PO_TYP_CDE NOT IN ('AP', 'IM', 'IE', 'IF')     13950015
121855            AND  A.PO_CATEG_CDE   = 'MR'                          13960015
121856            AND  A.RLSE_IND       = 'N'                           13970015
121857            AND  A.STATUS_CDE IN ('AP', 'AC')                     13980015
121858            AND  A.PO_NBR         = B.PO_NBR                      13990015
121859            AND  B.VER_STATUS_CDE = :PC-A                         14000015
121860            AND  A.ENT_ID         = C.ENT_ID                      14010015
121861            AND  A.DEPT_NBR = C.DEPT_NBR                          14020015
121862            AND  C.AGRMT_TYP_ID                                   14030015
121863                            = '6'                                 14040015
121864            AND  C.TYP_CDE  =  5                                  14050015
121865            AND  C.EFFECTIVE_DATE  <= CURRENT DATE                14060017
121866            AND  C.EXPIRATION_DATE >  CURRENT DATE                14070018
121867            AND (A.ENT_ID   = D.ENT_ID                            14080015
121868            AND  D.TYPE_CDE = '04')                               14090015
121869     END-EXEC.                                                    14100015
121870*---------------------------------------------------------------* 14110039
121880*  CURSOR 4                                                     * 14120039
121890*                                                               * 14130039
121900*    CURSOR WHEN PO NUMBER AND DMM NAME ARE NOT ENTERED         * 14140039
122000*    IMPORTS ONLY                                               * 14150039
122100*---------------------------------------------------------------* 14160039
122200*                                                                 14170039
122300*  THIS CURSOR IS DRIVEN BY VHTRIP ESTIMATED ARRIVAL TIMESTAMP.   14180039
122400*  ALL TRIPS THAT ARE DUE TO ARRIVE BETWEEN THE CURRENT TIMESTAMP 14190039
122500*  MINUS 60 DAYS AND THE CURRENT TIMESTAMP PLUS 2 DAYS PLUS       14200039
122600*  THE USER'S LEAD TIME WILL BE INCLUDED IF THE VEHICLE TYPE IS   14210039
122700*  'VS' (VESSEL).  THE CURSOR IS FURTHER LIMITED TO SHIPMENTS     14220039
122800*  THAT HAVEN'T BEEN RELEASED YET AND TRIPS THAT ARE STILL        14230039
122900*  ENROUTE.  IF THE USER ENTERS A DEPT NUMBER, IT WILL ALSO       14240039
123000*  LIMIT THE RESULTS.                                             14250039
123100                                                                  14260039
123200     EXEC SQL                                                     14270039
123300         DECLARE CURSOR4 CURSOR FOR                               14280039
123400          SELECT                                                  14290039
123500            COALESCE                                              14300039
123600             (X.ETA, Y.ETA, Z.ETA, AA.ETA)          AS MIN_ETA    14310039
123700           ,COALESCE                                              14320039
123800             (X.PO_NBR, Y.PO_NBR, Z.PO_NBR, AA.PO_NBR) AS PO_NBR  14330039
123900           ,COALESCE                                              14340039
124000             (X.DEPT_NBR, Y.DEPT_NBR,                             14350039
124100                          Z.DEPT_NBR, AA.DEPT_NBR)   AS DEPT_NBR  14360039
124200           ,COALESCE                                              14370039
124300             (X.ENT_ID, Y.ENT_ID, Z.ENT_ID, AA.ENT_ID) AS ENT_ID  14380039
124400           ,COALESCE                                              14390039
124500             (X.NEW_STR_PO_IND, Y.NEW_STR_PO_IND,                 14400039
124600                       Z.NEW_STR_PO_IND,                          14410039
124700                       AA.NEW_STR_PO_IND)    AS NEW_STR_PO_IND    14420039
124800           ,COALESCE                                              14430039
124900             (X.DONT_SHIP_BEF_DTE, Y.DONT_SHIP_BEF_DTE,           14440039
125000                    Z.DONT_SHIP_BEF_DTE,                          14450039
125100                   AA.DONT_SHIP_BEF_DTE)    AS DONT_SHIP_BEF_DTE  14460039
125200           ,COALESCE                                              14470039
125300             (X.CAN_IFNOT_SHIP_DTE, Y.CAN_IFNOT_SHIP_DTE,         14480039
125400                   Z.CAN_IFNOT_SHIP_DTE,                          14490039
125500                  AA.CAN_IFNOT_SHIP_DTE)    AS CAN_IFNOT_SHIP_DTE 14500039
125600           ,COALESCE                                              14510039
125700             (X.ENT_NAME_DESC, Y.ENT_NAME_DESC,                   14520039
125800                        Z.ENT_NAME_DESC,                          14530039
125900                       AA.ENT_NAME_DESC)    AS ENT_NAME_DESC      14540039
126000           ,COALESCE                                              14550039
126100             (X.PLUS_ETA, Y.PLUS_ETA,                             14560039
126200                          Z.PLUS_ETA,                             14570039
126300                         AA.PLUS_ETA)       AS CALC_PLUS_ETA      14580039
126400           ,COALESCE                                              14590039
126500             (X.MINUS_ETA, Y.MINUS_ETA,                           14600039
126600                           Z.MINUS_ETA,                           14610039
126700                          AA.MINUS_ETA)     AS CALC_MINUS_ETA     14620039
126800           ,COALESCE                                              14630039
126900             (X.DCONSLR_RLSE_CDE, Y.DCONSLR_RLSE_CDE,             14640039
127000                     Z.DCONSLR_RLSE_CDE,                          14650039
127100                    AA.DCONSLR_RLSE_CDE)    AS DCONSLR_RLSE_CDE   14660039
127200           ,COALESCE                                              14670039
127300             (X.TYPE, Y.TYPE, Z.TYPE, AA.TYPE)     AS TYPE        14680039
127400                                                                  14690039
127500          FROM(                                                   14700039
127600               (SELECT DISTINCT                                   14710039
127700                      MIN(A.EST_AR_TMST) AS ETA                   14720039
127800                  ,   D.PO_NBR                                    14730039
127900                  ,   D.DEPT_NBR                                  14740039
128000                  ,   D.ENT_ID                                    14750039
128100                  ,   D.NEW_STR_PO_IND                            14760039
128200                  ,   E.DONT_SHIP_BEF_DTE                         14770039
128300                  ,   E.CAN_IFNOT_SHIP_DTE                        14780039
128400                  ,   F.ENT_NAME_DESC                             14790039
128500                  ,   DAYS(MIN(A.EST_AR_TMST))                    14800039
128600                        - DAYS (CURRENT DATE + 2 DAYS)            14810039
128700                               AS PLUS_ETA                        14820039
128800                  ,   DATE(MIN(A.EST_AR_TMST)) - 2 DAYS           14830039
128900                               AS MINUS_ETA                       14840039
129000                  ,   H.DCONSLR_RLSE_CDE                          14850039
129100                  ,   'CON' AS TYPE                               14860039
129200                                                                  14870039
129300                FROM                                              14880039
129400                                                                  14890039
129500                      TVHTRIP A                                   14900039
129600                   ,  TSHIPMT B                                   14910039
129700                   ,  TSHPTPO C                                   14920039
129800                   ,  TPURCHS D                                   14930039
129900                   ,  TPLNSHP E                                   14940039
130000                   ,  TENTNME F                                   14950039
130100                   ,  TVEHICL G                                   14960039
130200                   ,  TIMPORL H                                   14970039
130300                                                                  14980039
130400                WHERE                                             14990039
130500                       (D.DEPT_NBR BETWEEN :DK-DPT-NBR-BEG        15000039
130600                                      AND  :DK-DPT-NBR-END)       15010039
130700                                                                  15020039
130800                   AND D.VER_STATUS_CDE        = :PC-A            15030039
130900                   AND D.STATUS_CDE            IN ('AC', 'AP')    15040039
131000                   AND C.PO_NBR                = D.PO_NBR         15050039
131100                   AND D.PO_TYP_CDE IN ('IM', 'IE', 'IF')         15060039
131200                   AND B.SHIPT_ID              = C.SHIPT_ID       15070039
131300                                                                  15080039
131400                   AND A.TRIP_ID               = B.TRIP_ID        15090039
131500                   AND (A.EST_AR_TMST  BETWEEN :DK-DB2-TMST-LOW   15100039
131600                                           AND :DK-DB2-TMST)      15110039
131700                                                                  15120039
131800                   AND E.PO_NBR                  = D.PO_NBR       15130039
131900                   AND E.VER_STATUS_CDE          = :PC-A          15140039
132000                                                                  15150039
132100                   AND (F.ENT_ID                 = D.ENT_ID       15160039
132200                                  AND F.TYPE_CDE = :PC-04)        15170039
132300                                                                  15180039
132400                   AND G.OWNER_SCAC_ID         = A.OWNER_SCAC_ID  15190039
132500                   AND G.VEH_NBR               = A.VEH_NBR        15200039
132600                   AND G.VEH_TYP_CDE         IN (:PC-VS, :PC-AV)  15210039
132700                                                                  15220039
132800                   AND H.PO_NBR                  = D.PO_NBR       15230039
132900                   AND H.VER_STATUS_CDE          = :PC-A          15240039
133000                   AND H.DCONSLR_RLSE_CDE    IN (:PC-S, :PC-N)    15250039
133100                                                                  15260039
133200                   AND :PC-5 >                                    15270039
133300                                                                  15280039
133400                     (SELECT MAX(Z.PRTY_CDE)                      15290039
133500                        FROM TTRIPST Y                            15300039
133600                           , TTRSTYP Z                            15310039
133700                       WHERE Y.TRIP_ID         = A.TRIP_ID        15320039
133800                       AND Y.TRIP_STATUS_CDE = Z.TRIP_STATUS_CDE  15330039
133900                      )                                           15340039
134000                                                                  15350039
134100                   AND :PC-5 >                                    15360039
134200                                                                  15370039
134300                     (SELECT MAX(X.PRTY_CDE)                      15380039
134400                        FROM TSHIPST W                            15390039
134500                           , TSHSTYP X                            15400039
134600                       WHERE W.SHIPT_ID           = B.SHIPT_ID    15410039
134700                       AND W.SHIPT_STATUS_CDE                     15420039
134800                                     = X.SHIPT_STATUS_CDE         15430039
134900                      )                                           15440039
135000                                                                  15450039
135100                GROUP BY                                          15460039
135200                       D.PO_NBR                                   15470039
135300                    ,  D.DEPT_NBR                                 15480039
135400                    ,  D.ENT_ID                                   15490039
135500                    ,  D.NEW_STR_PO_IND                           15500039
135600                    ,  E.DONT_SHIP_BEF_DTE                        15510039
135700                    ,  E.CAN_IFNOT_SHIP_DTE                       15520039
135800                    ,  F.ENT_NAME_DESC                            15530039
135900                    ,  H.DCONSLR_RLSE_CDE                         15540039
136000               ) AS X                                             15550039
136100                                                                  15560039
136200          FULL JOIN                                               15570039
136300                                                                  15580039
136400               (SELECT DISTINCT                                   15590039
136500                      MIN(A.MOM_POE_DELY_TMST) AS ETA             15600039
136600                  ,   D.PO_NBR                                    15610039
136700                  ,   D.DEPT_NBR                                  15620039
136800                  ,   D.ENT_ID                                    15630039
136900                  ,   D.NEW_STR_PO_IND                            15640039
137000                  ,   E.DONT_SHIP_BEF_DTE                         15650039
137100                  ,   E.CAN_IFNOT_SHIP_DTE                        15660039
137200                  ,   F.ENT_NAME_DESC                             15670039
137300                  ,   DAYS(MIN(A.MOM_POE_DELY_TMST))              15680039
137400                        - DAYS (CURRENT DATE + 2 DAYS)            15690039
137500                               AS PLUS_ETA                        15700039
137600                  ,   DATE(MIN(A.MOM_POE_DELY_TMST)) - 2 DAYS     15710039
137700                               AS MINUS_ETA                       15720039
137800                  ,   I.DCONSLR_RLSE_CDE                          15730039
137900                  ,   'CMN' AS TYPE                               15740039
138000                                                                  15750039
138100                FROM                                              15760039
138200                      TIMCNTK A                                   15770039
138300                   ,  TIMCNPO B                                   15780039
138400                   ,  TPURCHS D                                   15790039
138500                   ,  TPLNSHP E                                   15800039
138600                   ,  TENTNME F                                   15810039
138700                   ,  TIMPORL H                                   15820039
138800                   ,  TIMCNRL I                                   15830039
138900                                                                  15840039
139000                WHERE                                             15850039
139100                       (D.DEPT_NBR BETWEEN :DK-DPT-NBR-BEG        15860039
139200                                      AND  :DK-DPT-NBR-END)       15870039
139300                   AND D.VER_STATUS_CDE  = :PC-A                  15880039
139400                   AND D.STATUS_CDE      IN ('AC', 'AP')          15890039
139500                   AND B.PO_NBR          = D.PO_NBR               15900039
139600                   AND D.PO_TYP_CDE IN ('IM', 'IE', 'IF')         15910039
139700                   AND A.CONTNR_ID       = B.CONTNR_ID            15920039
139800                   AND A.CONTNR_SEQ_NBR  = B.CONTNR_SEQ_NBR       15930039
139900                   AND A.MOM_TRIP_TYP_CDE IN ('O', 'A')           15940039
140000                   AND (A.MOM_POE_DELY_TMST                       15950039
140100                                      BETWEEN :DK-DB2-TMST-LOW    15960039
140200                                          AND :DK-DB2-TMST)       15970039
140300                                                                  15980039
140400                   AND E.PO_NBR          = B.PO_NBR               15990039
140500                   AND E.VER_STATUS_CDE  = :PC-A                  16000039
140600                                                                  16010039
140700                   AND (F.ENT_ID         = D.ENT_ID               16020039
140800                         AND F.TYPE_CDE = :PC-04)                 16030039
140900                   AND H.VER_STATUS_CDE  = :PC-A                  16040039
141000                   AND H.PO_NBR          = D.PO_NBR               16050039
141100                   AND H.DCONSLR_RLSE_CDE  = :PC-N                16060039
141200                   AND I.CONTNR_ID       = B.CONTNR_ID            16070039
141300                   AND I.CONTNR_SEQ_NBR  = B.CONTNR_SEQ_NBR       16080039
141400                   AND I.PO_NBR          = B.PO_NBR               16090039
141500                   AND I.DCONSLR_RLSE_CDE  IN (:PC-N, :PC-S)      16100039
141600                                                                  16110039
141700                GROUP BY                                          16120039
141800                       D.PO_NBR                                   16130039
141900                    ,  D.DEPT_NBR                                 16140039
142000                    ,  D.ENT_ID                                   16150039
142100                    ,  D.NEW_STR_PO_IND                           16160039
142200                    ,  E.DONT_SHIP_BEF_DTE                        16170039
142300                    ,  E.CAN_IFNOT_SHIP_DTE                       16180039
142400                    ,  F.ENT_NAME_DESC                            16190039
142500                    ,  I.DCONSLR_RLSE_CDE                         16200039
142600               ) AS Y                                             16210039
142700          ON X.PO_NBR = Y.PO_NBR                                  16220039
142800          FULL JOIN                                               16230039
142900                                                                  16240039
143000               (SELECT DISTINCT                                   16250039
143100                      MIN(A.MOM_POE_DELY_TMST) AS ETA             16260039
143200                  ,   D.PO_NBR                                    16270039
143300                  ,   D.DEPT_NBR                                  16280039
143400                  ,   D.ENT_ID                                    16290039
143500                  ,   D.NEW_STR_PO_IND                            16300039
143600                  ,   E.DONT_SHIP_BEF_DTE                         16310039
143700                  ,   E.CAN_IFNOT_SHIP_DTE                        16320039
143800                  ,   F.ENT_NAME_DESC                             16330039
143900                  ,   DAYS(MIN(E.DONT_SHIP_BEF_DTE))              16340039
144000                        - DAYS (CURRENT DATE + 4 DAYS)            16350039
144100                               AS PLUS_ETA                        16360039
144200                  ,   DATE(MIN(E.DONT_SHIP_BEF_DTE)) - 4 DAYS     16370039
144300                               AS MINUS_ETA                       16380039
144400                  ,   I.DCONSLR_RLSE_CDE                          16390039
144500                  ,   'CMN' AS TYPE                               16400039
144600                                                                  16410039
144700                FROM                                              16420039
144800                      TIMCNTK A                                   16430039
144900                   ,  TIMCNPO B                                   16440039
145000                   ,  TPURCHS D                                   16450039
145100                   ,  TPLNSHP E                                   16460039
145200                   ,  TENTNME F                                   16470039
145300                   ,  TIMCNRL I                                   16480039
145400                                                                  16490039
145500                WHERE                                             16500039
145600                       (D.DEPT_NBR BETWEEN :DK-DPT-NBR-BEG        16510039
145700                                      AND  :DK-DPT-NBR-END)       16520039
145800                   AND D.VER_STATUS_CDE  = :PC-A                  16530039
145900                   AND D.STATUS_CDE      IN ('AC', 'AP')          16540039
146000                   AND B.PO_NBR          = D.PO_NBR               16550039
146100                   AND D.PO_TYP_CDE IN ('LD', 'ST')               16560039
146200                   AND A.CONTNR_ID       = B.CONTNR_ID            16570039
146300                   AND A.CONTNR_SEQ_NBR  = B.CONTNR_SEQ_NBR       16580039
146400                   AND A.MOM_TRIP_TYP_CDE IN ('O', 'A')           16590039
146500                   AND (E.DONT_SHIP_BEF_DTE                       16600039
146600                                      BETWEEN :DK-DB2-DATE-LOW    16610039
146700                                          AND :DK-DB2-SHIP-DATE)  16620039
146800                                                                  16630039
146900                   AND E.PO_NBR          = B.PO_NBR               16640039
147000                   AND E.VER_STATUS_CDE  = :PC-A                  16650039
147100                                                                  16660039
147200                   AND (F.ENT_ID         = D.ENT_ID               16670039
147300                         AND F.TYPE_CDE  = :PC-04)                16680039
147400                   AND I.CONTNR_ID       = B.CONTNR_ID            16690039
147500                   AND I.CONTNR_SEQ_NBR  = B.CONTNR_SEQ_NBR       16700039
147600                   AND I.PO_NBR          = B.PO_NBR               16710039
147700                   AND I.DCONSLR_RLSE_CDE  IN (:PC-N, :PC-S)      16720039
147800                   AND NOT EXISTS                                 16730039
147900                            (SELECT 1                             16740039
148000                             FROM TIMPORL J                       16750039
148100                             WHERE J.PO_NBR = I.PO_NBR            16760039
148200                       AND J.DCONSLR_RLSE_CDE IN (:PC-Y, :PC-R))  16770039
148300                                                                  16780039
148400                GROUP BY                                          16790039
148500                       D.PO_NBR                                   16800039
148600                    ,  D.DEPT_NBR                                 16810039
148700                    ,  D.ENT_ID                                   16820039
148800                    ,  D.NEW_STR_PO_IND                           16830039
148900                    ,  E.DONT_SHIP_BEF_DTE                        16840039
149000                    ,  E.CAN_IFNOT_SHIP_DTE                       16850039
149100                    ,  F.ENT_NAME_DESC                            16860039
149200                    ,  I.DCONSLR_RLSE_CDE                         16870039
149300               ) AS Z                                             16880039
149400            ON COALESCE (X.PO_NBR , Y.PO_NBR) = Z.PO_NBR          16890039
149500            FULL JOIN                                             16900039
149600                                                                  16910039
149700               (SELECT DISTINCT                                   16920039
149800                      MIN(A.EST_AR_TMST) AS ETA                   16930039
149900                  ,   D.PO_NBR                                    16940039
150000                  ,   D.DEPT_NBR                                  16950039
150100                  ,   D.ENT_ID                                    16960039
150200                  ,   D.NEW_STR_PO_IND                            16970039
150300                  ,   E.DONT_SHIP_BEF_DTE                         16980039
150400                  ,   E.CAN_IFNOT_SHIP_DTE                        16990039
150500                  ,   F.ENT_NAME_DESC                             17000039
150600                  ,   DAYS(MIN(E.DONT_SHIP_BEF_DTE))              17010039
150700                        - DAYS (CURRENT DATE + 4 DAYS)            17020039
150800                               AS PLUS_ETA                        17030039
150900                  ,   DATE(MIN(E.DONT_SHIP_BEF_DTE)) - 4 DAYS     17040039
151000                               AS MINUS_ETA                       17050039
151100                  ,   H.DCONSLR_RLSE_CDE                          17060039
151200                  ,   'CON' AS TYPE                               17070039
151300                                                                  17080039
151400                FROM                                              17090039
151500                                                                  17100039
151600                      TVHTRIP A                                   17110039
151700                   ,  TSHIPMT B                                   17120039
151800                   ,  TSHPTPO C                                   17130039
151900                   ,  TPURCHS D                                   17140039
152000                   ,  TPLNSHP E                                   17150039
152100                   ,  TENTNME F                                   17160039
152200                   ,  TVEHICL G                                   17170039
152300                   ,  TIMPORL H                                   17180039
152400                                                                  17190039
152500                WHERE                                             17200039
152600                       (D.DEPT_NBR BETWEEN :DK-DPT-NBR-BEG        17210039
152700                                      AND  :DK-DPT-NBR-END)       17220039
152800                                                                  17230039
152900                   AND D.VER_STATUS_CDE        = :PC-A            17240039
153000                   AND D.STATUS_CDE            IN ('AC', 'AP')    17250039
153100                   AND C.PO_NBR                = D.PO_NBR         17260039
153200                   AND D.PO_TYP_CDE IN ('LD', 'ST')               17270039
153300                   AND B.SHIPT_ID              = C.SHIPT_ID       17280039
153400                                                                  17290039
153500                   AND A.TRIP_ID               = B.TRIP_ID        17300039
153600                   AND (E.DONT_SHIP_BEF_DTE                       17310039
153700                                      BETWEEN :DK-DB2-DATE-LOW    17320039
153800                                          AND :DK-DB2-SHIP-DATE)  17330039
153900                                                                  17340039
154000                   AND E.PO_NBR                  = D.PO_NBR       17350039
154100                   AND E.VER_STATUS_CDE          = :PC-A          17360039
154200                                                                  17370039
154300                   AND (F.ENT_ID                 = D.ENT_ID       17380039
154400                                  AND F.TYPE_CDE = :PC-04)        17390039
154500                                                                  17400039
154600                   AND G.OWNER_SCAC_ID         = A.OWNER_SCAC_ID  17410039
154700                   AND G.VEH_NBR               = A.VEH_NBR        17420039
154800                   AND G.VEH_TYP_CDE         IN (:PC-VS, :PC-AV)  17430039
154900                                                                  17440039
155000                   AND H.PO_NBR                  = D.PO_NBR       17450039
155100                   AND H.VER_STATUS_CDE          = :PC-A          17460039
155200                   AND H.DCONSLR_RLSE_CDE    IN (:PC-S, :PC-N)    17470039
155300                                                                  17480039
155400                   AND :PC-5 >                                    17490039
155500                                                                  17500039
155600                     (SELECT MAX(Z.PRTY_CDE)                      17510039
155700                        FROM TTRIPST Y                            17520039
155800                           , TTRSTYP Z                            17530039
155900                       WHERE Y.TRIP_ID         = A.TRIP_ID        17540039
156000                       AND Y.TRIP_STATUS_CDE = Z.TRIP_STATUS_CDE  17550039
156100                      )                                           17560039
156200                                                                  17570039
156300                   AND :PC-5 >                                    17580039
156400                                                                  17590039
156500                     (SELECT MAX(X.PRTY_CDE)                      17600039
156600                        FROM TSHIPST W                            17610039
156700                           , TSHSTYP X                            17620039
156800                       WHERE W.SHIPT_ID           = B.SHIPT_ID    17630039
156900                       AND W.SHIPT_STATUS_CDE                     17640039
157000                                     = X.SHIPT_STATUS_CDE         17650039
157100                      )                                           17660039
157200                                                                  17670039
157300                GROUP BY                                          17680039
157400                       D.PO_NBR                                   17690039
157500                    ,  D.DEPT_NBR                                 17700039
157600                    ,  D.ENT_ID                                   17710039
157700                    ,  D.NEW_STR_PO_IND                           17720039
157800                    ,  E.DONT_SHIP_BEF_DTE                        17730039
157900                    ,  E.CAN_IFNOT_SHIP_DTE                       17740039
158000                    ,  F.ENT_NAME_DESC                            17750039
158100                    ,  H.DCONSLR_RLSE_CDE                         17760039
158200               ) AS AA                                            17770039
158300        ON COALESCE (X.PO_NBR , Y.PO_NBR, Z.PO_NBR) = AA.PO_NBR   17780039
158400              )                                                   17790039
158500          ORDER BY                                                17800039
158600                MIN_ETA, PO_NBR                                   17810039
158700     END-EXEC.                                                    17820039
158800                                                                  17830039
158900*---------------------------------------------------------------* 17840039
159000*  CURSOR 5                                                     * 17850039
159100*                                                               * 17860039
159200*    CURSOR WHEN DMM NAME IS ENTERED                            * 17870039
159300*    IMPORTS ONLY.                                              * 17880039
159400*    THIS WORKS THE SAME AS CURSOR4 EXCEPT THAT THE USER        * 17890039
159500*    ENTERS THE LAST NAME OF THE DISTRICT MERCHANDISE MANAGER.  * 17900039
159600*    THAT NAME IS TRACED THRU TWORKER AND TRSPBAR TO LIMIT      * 17910039
159700*    THE RESULTS TO THE DEPARTMENTS UNDER THE CONTROL OF THAT   * 17920039
159800*    PERSON.                                                    * 17930039
159900*---------------------------------------------------------------* 17940039
160000                                                                  17950039
160100     EXEC SQL                                                     17960039
160200         DECLARE CURSOR5 CURSOR FOR                               17970039
160300          SELECT                                                  17980039
160400            COALESCE                                              17990039
160500             (X.ETA, Y.ETA, Z.ETA, AA.ETA)          AS MIN_ETA    18000039
160600           ,COALESCE                                              18010039
160700             (X.PO_NBR, Y.PO_NBR, Z.PO_NBR, AA.PO_NBR) AS PO_NBR  18020039
160800           ,COALESCE                                              18030039
160900             (X.DEPT_NBR, Y.DEPT_NBR,                             18040039
161000                          Z.DEPT_NBR, AA.DEPT_NBR)   AS DEPT_NBR  18050039
161100           ,COALESCE                                              18060039
161200             (X.ENT_ID, Y.ENT_ID, Z.ENT_ID, AA.ENT_ID) AS ENT_ID  18070039
161300           ,COALESCE                                              18080039
161400             (X.NEW_STR_PO_IND, Y.NEW_STR_PO_IND,                 18090039
161500                       Z.NEW_STR_PO_IND,                          18100039
161600                       AA.NEW_STR_PO_IND)    AS NEW_STR_PO_IND    18110039
161700           ,COALESCE                                              18120039
161800             (X.DONT_SHIP_BEF_DTE, Y.DONT_SHIP_BEF_DTE,           18130039
161900                    Z.DONT_SHIP_BEF_DTE,                          18140039
162000                   AA.DONT_SHIP_BEF_DTE)    AS DONT_SHIP_BEF_DTE  18150039
162100           ,COALESCE                                              18160039
162200             (X.CAN_IFNOT_SHIP_DTE, Y.CAN_IFNOT_SHIP_DTE,         18170039
162300                   Z.CAN_IFNOT_SHIP_DTE,                          18180039
162400                  AA.CAN_IFNOT_SHIP_DTE)    AS CAN_IFNOT_SHIP_DTE 18190039
162500           ,COALESCE                                              18200039
162600             (X.ENT_NAME_DESC, Y.ENT_NAME_DESC,                   18210039
162700                        Z.ENT_NAME_DESC,                          18220039
162800                       AA.ENT_NAME_DESC)    AS ENT_NAME_DESC      18230039
162900           ,COALESCE                                              18240039
163000             (X.PLUS_ETA, Y.PLUS_ETA,                             18250039
163100                          Z.PLUS_ETA,                             18260039
163200                         AA.PLUS_ETA)       AS CALC_PLUS_ETA      18270039
163300           ,COALESCE                                              18280039
163400             (X.MINUS_ETA, Y.MINUS_ETA,                           18290039
163500                           Z.MINUS_ETA,                           18300039
163600                          AA.MINUS_ETA)     AS CALC_MINUS_ETA     18310039
163700           ,COALESCE                                              18320039
163800             (X.DCONSLR_RLSE_CDE, Y.DCONSLR_RLSE_CDE,             18330039
163900                     Z.DCONSLR_RLSE_CDE,                          18340039
164000                    AA.DCONSLR_RLSE_CDE)    AS DCONSLR_RLSE_CDE   18350039
164100           ,COALESCE                                              18360039
164200             (X.TYPE, Y.TYPE, Z.TYPE, AA.TYPE)     AS TYPE        18370039
164300                                                                  18380039
164400          FROM(                                                   18390039
164500               (SELECT DISTINCT                                   18400039
164600                      MIN(A.EST_AR_TMST) AS ETA                   18410039
164700                  ,   D.PO_NBR                                    18420039
164800                  ,   D.DEPT_NBR                                  18430039
164900                  ,   D.ENT_ID                                    18440039
165000                  ,   D.NEW_STR_PO_IND                            18450039
165100                  ,   E.DONT_SHIP_BEF_DTE                         18460039
165200                  ,   E.CAN_IFNOT_SHIP_DTE                        18470039
165300                  ,   F.ENT_NAME_DESC                             18480039
165400                  ,   DAYS(MIN(A.EST_AR_TMST))                    18490039
165500                        - DAYS (CURRENT DATE + 2 DAYS)            18500039
165600                               AS PLUS_ETA                        18510039
165700                  ,   DATE(MIN(A.EST_AR_TMST)) - 2 DAYS           18520039
165800                               AS MINUS_ETA                       18530039
165900                  ,   H.DCONSLR_RLSE_CDE                          18540039
166000                  ,   'CON' AS TYPE                               18550039
166100                                                                  18560039
166200                FROM                                              18570039
166300                                                                  18580039
166400                      TVHTRIP A                                   18590039
166500                   ,  TSHIPMT B                                   18600039
166600                   ,  TSHPTPO C                                   18610039
166700                   ,  TPURCHS D                                   18620039
166800                   ,  TPLNSHP E                                   18630039
166900                   ,  TENTNME F                                   18640039
167000                   ,  TVEHICL G                                   18650039
167100                   ,  TIMPORL H                                   18660039
167200                   ,  TMDSEAR J                                   18670039
167300                                                                  18680039
167400                WHERE                                             18690039
167500                       (D.DEPT_NBR BETWEEN :DK-DPT-NBR-BEG        18700039
167600                                      AND  :DK-DPT-NBR-END)       18710039
167700                                                                  18720039
167800                   AND D.VER_STATUS_CDE       = :PC-A             18730039
167900                   AND D.STATUS_CDE           IN ('AC', 'AP')     18740039
168000                   AND C.PO_NBR               = D.PO_NBR          18750039
168100                   AND D.PO_TYP_CDE IN ('IM', 'IE', 'IF')         18760039
168200                   AND B.SHIPT_ID             = C.SHIPT_ID        18770039
168300                   AND A.TRIP_ID              = B.TRIP_ID         18780039
168400                   AND (A.EST_AR_TMST  BETWEEN :DK-DB2-TMST-LOW   18790039
168500                                           AND :DK-DB2-TMST)      18800039
168600                                                                  18810039
168700                   AND E.PO_NBR               = C.PO_NBR          18820039
168800                   AND E.VER_STATUS_CDE       = :PC-A             18830039
168900                                                                  18840039
169000                   AND (F.ENT_ID              = D.ENT_ID          18850039
169100                        AND F.TYPE_CDE = :PC-04)                  18860039
169200                                                                  18870039
169300                   AND G.VEH_TYP_CDE         IN (:PC-VS, :PC-AV)  18880039
169400                   AND G.OWNER_SCAC_ID        = A.OWNER_SCAC_ID   18890039
169500                   AND G.VEH_NBR              = A.VEH_NBR         18900039
169600                   AND H.PO_NBR               = D.PO_NBR          18910039
169700                   AND H.VER_STATUS_CDE       = :PC-A             18920039
169800                   AND H.DCONSLR_RLSE_CDE    IN (:PC-S, :PC-N)    18930039
169900                                                                  18940039
170000                   AND (J.DEPT_NBR           = D.DEPT_NBR         18950039
170100                        AND J.DMA_NBR        = :DK-DMA-NBR        18960039
170200                        AND J.MDSELV_CDE     = 'DPT'              18970039
170300                        AND (CURRENT DATE BETWEEN J.STRT_DTE      18980039
170400                                              AND J.END_DTE)      18990039
170500                       )                                          19000039
170600                                                                  19010039
170700                   AND :PC-5 >                                    19020039
170800                     (SELECT MAX(Z.PRTY_CDE)                      19030039
170900                        FROM TTRIPST Y                            19040039
171000                           , TTRSTYP Z                            19050039
171100                       WHERE Y.TRIP_ID         = A.TRIP_ID        19060039
171200                       AND Y.TRIP_STATUS_CDE = Z.TRIP_STATUS_CDE  19070039
171300                      )                                           19080039
171400                                                                  19090039
171500                   AND :PC-5 >                                    19100039
171600                     (SELECT MAX(X.PRTY_CDE)                      19110039
171700                        FROM TSHIPST W                            19120039
171800                           , TSHSTYP X                            19130039
171900                       WHERE W.SHIPT_ID           = B.SHIPT_ID    19140039
172000                       AND W.SHIPT_STATUS_CDE                     19150039
172100                                     = X.SHIPT_STATUS_CDE         19160039
172200                      )                                           19170039
172300                                                                  19180039
172400                GROUP BY                                          19190039
172500                       D.PO_NBR                                   19200039
172600                    ,  D.DEPT_NBR                                 19210039
172700                    ,  D.ENT_ID                                   19220039
172800                    ,  D.NEW_STR_PO_IND                           19230039
172900                    ,  E.DONT_SHIP_BEF_DTE                        19240039
173000                    ,  E.CAN_IFNOT_SHIP_DTE                       19250039
173100                    ,  F.ENT_NAME_DESC                            19260039
173200                    ,  H.DCONSLR_RLSE_CDE                         19270039
173300               ) AS X                                             19280039
173400                                                                  19290039
173500          FULL JOIN                                               19300039
173600                                                                  19310039
173700               (SELECT DISTINCT                                   19320039
173800                      MIN(A.MOM_POE_DELY_TMST) AS ETA             19330039
173900                  ,   D.PO_NBR                                    19340039
174000                  ,   D.DEPT_NBR                                  19350039
174100                  ,   D.ENT_ID                                    19360039
174200                  ,   D.NEW_STR_PO_IND                            19370039
174300                  ,   E.DONT_SHIP_BEF_DTE                         19380039
174400                  ,   E.CAN_IFNOT_SHIP_DTE                        19390039
174500                  ,   F.ENT_NAME_DESC                             19400039
174600                  ,   DAYS(MIN(A.MOM_POE_DELY_TMST))              19410039
174700                        - DAYS (CURRENT DATE + 2 DAYS)            19420039
174800                               AS PLUS_ETA                        19430039
174900                  ,   DATE(MIN(A.MOM_POE_DELY_TMST)) - 2 DAYS     19440039
175000                               AS MINUS_ETA                       19450039
175100                  ,   I.DCONSLR_RLSE_CDE                          19460039
175200                  ,   'CMN' AS TYPE                               19470039
175300                                                                  19480039
175400                FROM                                              19490039
175500                      TIMCNTK A                                   19500039
175600                   ,  TIMCNPO B                                   19510039
175700                   ,  TPURCHS D                                   19520039
175800                   ,  TPLNSHP E                                   19530039
175900                   ,  TENTNME F                                   19540039
176000                   ,  TIMPORL H                                   19550039
176100                   ,  TIMCNRL I                                   19560039
176200                   ,  TMDSEAR J                                   19570039
176300                                                                  19580039
176400                WHERE                                             19590039
176500                       (D.DEPT_NBR BETWEEN :DK-DPT-NBR-BEG        19600039
176600                                      AND  :DK-DPT-NBR-END)       19610039
176700                   AND D.VER_STATUS_CDE  = :PC-A                  19620039
176800                   AND D.STATUS_CDE      IN ('AC', 'AP')          19630039
176900                   AND B.PO_NBR          = D.PO_NBR               19640039
177000                   AND D.PO_TYP_CDE IN ('IM', 'IE', 'IF')         19650039
177100                   AND A.CONTNR_ID       = B.CONTNR_ID            19660039
177200                   AND A.CONTNR_SEQ_NBR  = B.CONTNR_SEQ_NBR       19670039
177300                   AND A.MOM_TRIP_TYP_CDE IN ('O', 'A')           19680039
177400                   AND (A.MOM_POE_DELY_TMST                       19690039
177500                                      BETWEEN :DK-DB2-TMST-LOW    19700039
177600                                          AND :DK-DB2-TMST)       19710039
177700                   AND E.PO_NBR          = D.PO_NBR               19720039
177800                   AND E.VER_STATUS_CDE  = :PC-A                  19730039
177900                   AND (F.ENT_ID         = D.ENT_ID               19740039
178000                         AND F.TYPE_CDE = :PC-04)                 19750039
178100                   AND H.VER_STATUS_CDE  = :PC-A                  19760039
178200                   AND H.PO_NBR          = D.PO_NBR               19770039
178300                   AND H.DCONSLR_RLSE_CDE  = :PC-N                19780039
178400                   AND I.CONTNR_ID       = B.CONTNR_ID            19790039
178500                   AND I.CONTNR_SEQ_NBR  = B.CONTNR_SEQ_NBR       19800039
178600                   AND I.PO_NBR          = B.PO_NBR               19810039
178700                   AND I.DCONSLR_RLSE_CDE  IN (:PC-N, :PC-S)      19820039
178800                                                                  19830039
178900                   AND (J.DEPT_NBR           = D.DEPT_NBR         19840039
179000                        AND J.DMA_NBR        = :DK-DMA-NBR        19850039
179100                        AND J.MDSELV_CDE     = 'DPT'              19860039
179200                        AND (CURRENT DATE BETWEEN J.STRT_DTE      19870039
179300                                              AND J.END_DTE)      19880039
179400                       )                                          19890039
179500                                                                  19900039
179600                GROUP BY                                          19910039
179700                       D.PO_NBR                                   19920039
179800                    ,  D.DEPT_NBR                                 19930039
179900                    ,  D.ENT_ID                                   19940039
180000                    ,  D.NEW_STR_PO_IND                           19950039
180100                    ,  E.DONT_SHIP_BEF_DTE                        19960039
180200                    ,  E.CAN_IFNOT_SHIP_DTE                       19970039
180300                    ,  F.ENT_NAME_DESC                            19980039
180400                    ,  I.DCONSLR_RLSE_CDE                         19990039
180500               ) AS Y                                             20000039
180600          ON X.PO_NBR = Y.PO_NBR                                  20010039
180700                                                                  20020039
180800          FULL JOIN                                               20030039
180900                                                                  20040039
181000               (SELECT DISTINCT                                   20050039
181100                      MIN(A.MOM_POE_DELY_TMST) AS ETA             20060039
181200                  ,   D.PO_NBR                                    20070039
181300                  ,   D.DEPT_NBR                                  20080039
181400                  ,   D.ENT_ID                                    20090039
181500                  ,   D.NEW_STR_PO_IND                            20100039
181600                  ,   E.DONT_SHIP_BEF_DTE                         20110039
181700                  ,   E.CAN_IFNOT_SHIP_DTE                        20120039
181800                  ,   F.ENT_NAME_DESC                             20130039
181900                  ,   DAYS(MIN(E.DONT_SHIP_BEF_DTE))              20140039
182000                        - DAYS (CURRENT DATE + 4 DAYS)            20150039
182100                               AS PLUS_ETA                        20160039
182200                  ,   DATE(MIN(E.DONT_SHIP_BEF_DTE)) - 4 DAYS     20170039
182300                               AS MINUS_ETA                       20180039
182400                  ,   I.DCONSLR_RLSE_CDE                          20190039
182500                  ,   'CMN' AS TYPE                               20200039
182600                                                                  20210039
182700                FROM                                              20220039
182800                      TIMCNTK A                                   20230039
182900                   ,  TIMCNPO B                                   20240039
183000                   ,  TPURCHS D                                   20250039
183100                   ,  TPLNSHP E                                   20260039
183200                   ,  TENTNME F                                   20270039
183300                   ,  TIMCNRL I                                   20280039
183400                                                                  20290039
183500                WHERE                                             20300039
183600                       (D.DEPT_NBR BETWEEN :DK-DPT-NBR-BEG        20310039
183700                                      AND  :DK-DPT-NBR-END)       20320039
183800                   AND D.VER_STATUS_CDE  = :PC-A                  20330039
183900                   AND D.STATUS_CDE      IN ('AC', 'AP')          20340039
184000                   AND B.PO_NBR          = D.PO_NBR               20350039
184100                   AND D.PO_TYP_CDE IN ('LD', 'ST')               20360039
184200                   AND A.CONTNR_ID       = B.CONTNR_ID            20370039
184300                   AND A.CONTNR_SEQ_NBR  = B.CONTNR_SEQ_NBR       20380039
184400                   AND A.MOM_TRIP_TYP_CDE IN ('O', 'A')           20390039
184500                   AND (E.DONT_SHIP_BEF_DTE                       20400039
184600                                      BETWEEN :DK-DB2-DATE-LOW    20410039
184700                                          AND :DK-DB2-SHIP-DATE)  20420039
184800                                                                  20430039
184900                   AND E.PO_NBR          = B.PO_NBR               20440039
185000                   AND E.VER_STATUS_CDE  = :PC-A                  20450039
185100                                                                  20460039
185200                   AND (F.ENT_ID         = D.ENT_ID               20470039
185300                         AND F.TYPE_CDE = :PC-04)                 20480039
185400                   AND I.CONTNR_ID       = B.CONTNR_ID            20490039
185500                   AND I.CONTNR_SEQ_NBR  = B.CONTNR_SEQ_NBR       20500039
185600                   AND I.PO_NBR          = B.PO_NBR               20510039
185700                   AND I.DCONSLR_RLSE_CDE  IN (:PC-N, :PC-S)      20520039
185800                   AND NOT EXISTS                                 20530039
185900                            (SELECT 1                             20540039
186000                             FROM TIMPORL J                       20550039
186100                             WHERE J.PO_NBR = I.PO_NBR            20560039
186200                       AND J.DCONSLR_RLSE_CDE IN (:PC-Y, :PC-R))  20570039
186300                                                                  20580039
186400                GROUP BY                                          20590039
186500                       D.PO_NBR                                   20600039
186600                    ,  D.DEPT_NBR                                 20610039
186700                    ,  D.ENT_ID                                   20620039
186800                    ,  D.NEW_STR_PO_IND                           20630039
186900                    ,  E.DONT_SHIP_BEF_DTE                        20640039
187000                    ,  E.CAN_IFNOT_SHIP_DTE                       20650039
187100                    ,  F.ENT_NAME_DESC                            20660039
187200                    ,  I.DCONSLR_RLSE_CDE                         20670039
187300               ) AS Z                                             20680039
187400            ON COALESCE (X.PO_NBR , Y.PO_NBR) = Z.PO_NBR          20690039
187500                                                                  20700039
187600            FULL JOIN                                             20710039
187700                                                                  20720039
187800               (SELECT DISTINCT                                   20730039
187900                      MIN(A.EST_AR_TMST) AS ETA                   20740039
188000                  ,   D.PO_NBR                                    20750039
188100                  ,   D.DEPT_NBR                                  20760039
188200                  ,   D.ENT_ID                                    20770039
188300                  ,   D.NEW_STR_PO_IND                            20780039
188400                  ,   E.DONT_SHIP_BEF_DTE                         20790039
188500                  ,   E.CAN_IFNOT_SHIP_DTE                        20800039
188600                  ,   F.ENT_NAME_DESC                             20810039
188700                  ,   DAYS(MIN(E.DONT_SHIP_BEF_DTE))              20820039
188800                        - DAYS (CURRENT DATE + 4 DAYS)            20830039
188900                               AS PLUS_ETA                        20840039
189000                  ,   DATE(MIN(E.DONT_SHIP_BEF_DTE)) - 4 DAYS     20850039
189100                               AS MINUS_ETA                       20860039
189200                  ,   H.DCONSLR_RLSE_CDE                          20870039
189300                  ,   'CON' AS TYPE                               20880039
189400                                                                  20890039
189500                FROM                                              20900039
189600                                                                  20910039
189700                      TVHTRIP A                                   20920039
189800                   ,  TSHIPMT B                                   20930039
189900                   ,  TSHPTPO C                                   20940039
190000                   ,  TPURCHS D                                   20950039
190100                   ,  TPLNSHP E                                   20960039
190200                   ,  TENTNME F                                   20970039
190300                   ,  TVEHICL G                                   20980039
190400                   ,  TIMPORL H                                   20990039
190500                   ,  TMDSEAR J                                   21000039
190600                                                                  21010039
190700                WHERE                                             21020039
190800                       (D.DEPT_NBR BETWEEN :DK-DPT-NBR-BEG        21030039
190900                                      AND  :DK-DPT-NBR-END)       21040039
191000                                                                  21050039
191100                   AND D.VER_STATUS_CDE       = :PC-A             21060039
191200                   AND D.STATUS_CDE      IN ('AC', 'AP')          21070039
191300                   AND C.PO_NBR               = D.PO_NBR          21080039
191400                   AND D.PO_TYP_CDE IN ('LD', 'ST')               21090039
191500                   AND B.SHIPT_ID             = C.SHIPT_ID        21100039
191600                   AND A.TRIP_ID              = B.TRIP_ID         21110039
191700                   AND (E.DONT_SHIP_BEF_DTE                       21120039
191800                                      BETWEEN :DK-DB2-DATE-LOW    21130039
191900                                          AND :DK-DB2-SHIP-DATE)  21140039
192000                                                                  21150039
192100                   AND E.PO_NBR               = C.PO_NBR          21160039
192200                   AND E.VER_STATUS_CDE       = :PC-A             21170039
192300                                                                  21180039
192400                   AND (F.ENT_ID              = D.ENT_ID          21190039
192500                        AND F.TYPE_CDE = :PC-04)                  21200039
192600                                                                  21210039
192700                   AND G.VEH_TYP_CDE         IN (:PC-VS, :PC-AV)  21220039
192800                   AND G.OWNER_SCAC_ID        = A.OWNER_SCAC_ID   21230039
192900                   AND G.VEH_NBR              = A.VEH_NBR         21240039
193000                   AND H.PO_NBR               = D.PO_NBR          21250039
193100                   AND H.VER_STATUS_CDE       = :PC-A             21260039
193200                   AND H.DCONSLR_RLSE_CDE    IN (:PC-S, :PC-N)    21270039
193300                                                                  21280039
193400                   AND (J.DEPT_NBR           = D.DEPT_NBR         21290039
193500                        AND J.DMA_NBR        = :DK-DMA-NBR        21300039
193600                        AND J.MDSELV_CDE     = 'DPT'              21310039
193700                        AND (CURRENT DATE BETWEEN J.STRT_DTE      21320039
193800                                              AND J.END_DTE)      21330039
193900                       )                                          21340039
194000                                                                  21350039
194100                   AND :PC-5 >                                    21360039
194200                     (SELECT MAX(Z.PRTY_CDE)                      21370039
194300                        FROM TTRIPST Y                            21380039
194400                           , TTRSTYP Z                            21390039
194500                       WHERE Y.TRIP_ID         = A.TRIP_ID        21400039
194600                       AND Y.TRIP_STATUS_CDE = Z.TRIP_STATUS_CDE  21410039
194700                      )                                           21420039
194800                                                                  21430039
194900                   AND :PC-5 >                                    21440039
195000                     (SELECT MAX(X.PRTY_CDE)                      21450039
195100                        FROM TSHIPST W                            21460039
195200                           , TSHSTYP X                            21470039
195300                       WHERE W.SHIPT_ID           = B.SHIPT_ID    21480039
195400                       AND W.SHIPT_STATUS_CDE                     21490039
195500                                     = X.SHIPT_STATUS_CDE         21500039
195600                      )                                           21510039
195700                                                                  21520039
195800                GROUP BY                                          21530039
195900                       D.PO_NBR                                   21540039
196000                    ,  D.DEPT_NBR                                 21550039
196100                    ,  D.ENT_ID                                   21560039
196200                    ,  D.NEW_STR_PO_IND                           21570039
196300                    ,  E.DONT_SHIP_BEF_DTE                        21580039
196400                    ,  E.CAN_IFNOT_SHIP_DTE                       21590039
196500                    ,  F.ENT_NAME_DESC                            21600039
196600                    ,  H.DCONSLR_RLSE_CDE                         21610039
196700               ) AS AA                                            21620039
196800       ON COALESCE (X.PO_NBR , Y.PO_NBR, Z.PO_NBR) = AA.PO_NBR    21630039
196900                                                                  21640039
197000                                                                  21650039
197100                                                                  21660039
197200                                                                  21670039
197300                                                                  21680039
197400              )                                                   21690039
197500          ORDER BY                                                21700039
197600                MIN_ETA, PO_NBR                                   21710039
197700     END-EXEC.                                                    21720039
197800                                                                  21730039
197900*---------------------------------------------------------------* 21740039
198000*  CURSOR 6                                                     * 21750039
198100*                                                               * 21760039
198200*    CURSOR WHEN PO NUMBER IS ENTERED                           * 21770039
198300*    IMPORTS ONLY                                               * 21780039
198400*    THIS IS SIMILAR TO CURSOR4 EXCEPT THAT THE RESULTS ARE     * 21790039
198500*    LIMITED TO THE PO NUMBER ENTERED.                          * 21800039
198600*---------------------------------------------------------------* 21810039
198700                                                                  21820039
198800     EXEC SQL                                                     21830039
198900         DECLARE CURSOR6 CURSOR FOR                               21840039
199000          SELECT                                                  21850039
199100            COALESCE                                              21860039
199200             (X.ETA, Y.ETA, Z.ETA, AA.ETA)          AS MIN_ETA    21870039
199300           ,COALESCE                                              21880039
199400             (X.PO_NBR, Y.PO_NBR, Z.PO_NBR, AA.PO_NBR) AS PO_NBR  21890039
199500           ,COALESCE                                              21900039
199600             (X.DEPT_NBR, Y.DEPT_NBR,                             21910039
199700                          Z.DEPT_NBR, AA.DEPT_NBR)   AS DEPT_NBR  21920039
199800           ,COALESCE                                              21930039
199900             (X.ENT_ID, Y.ENT_ID, Z.ENT_ID, AA.ENT_ID) AS ENT_ID  21940039
200000           ,COALESCE                                              21950039
200100             (X.NEW_STR_PO_IND, Y.NEW_STR_PO_IND,                 21960039
200200                       Z.NEW_STR_PO_IND,                          21970039
200300                       AA.NEW_STR_PO_IND)    AS NEW_STR_PO_IND    21980039
200400           ,COALESCE                                              21990039
200500             (X.DONT_SHIP_BEF_DTE, Y.DONT_SHIP_BEF_DTE,           22000039
200600                    Z.DONT_SHIP_BEF_DTE,                          22010039
200700                   AA.DONT_SHIP_BEF_DTE)    AS DONT_SHIP_BEF_DTE  22020039
200800           ,COALESCE                                              22030039
200900             (X.CAN_IFNOT_SHIP_DTE, Y.CAN_IFNOT_SHIP_DTE,         22040039
201000                   Z.CAN_IFNOT_SHIP_DTE,                          22050039
201100                  AA.CAN_IFNOT_SHIP_DTE)    AS CAN_IFNOT_SHIP_DTE 22060039
201200           ,COALESCE                                              22070039
201300             (X.ENT_NAME_DESC, Y.ENT_NAME_DESC,                   22080039
201400                        Z.ENT_NAME_DESC,                          22090039
201500                       AA.ENT_NAME_DESC)    AS ENT_NAME_DESC      22100039
201600           ,COALESCE                                              22110039
201700             (X.PLUS_ETA, Y.PLUS_ETA,                             22120039
201800                          Z.PLUS_ETA,                             22130039
201900                         AA.PLUS_ETA)       AS CALC_PLUS_ETA      22140039
202000           ,COALESCE                                              22150039
202100             (X.MINUS_ETA, Y.MINUS_ETA,                           22160039
202200                           Z.MINUS_ETA,                           22170039
202300                          AA.MINUS_ETA)     AS CALC_MINUS_ETA     22180039
202400           ,COALESCE                                              22190039
202500             (X.DCONSLR_RLSE_CDE, Y.DCONSLR_RLSE_CDE,             22200039
202600                     Z.DCONSLR_RLSE_CDE,                          22210039
202700                    AA.DCONSLR_RLSE_CDE)    AS DCONSLR_RLSE_CDE   22220039
202800           ,COALESCE                                              22230039
202900             (X.TYPE, Y.TYPE, Z.TYPE, AA.TYPE)     AS TYPE        22240039
203000                                                                  22250039
203100          FROM(                                                   22260039
203200               (SELECT DISTINCT                                   22270039
203300                      MIN(A.EST_AR_TMST) AS ETA                   22280039
203400                  ,   D.PO_NBR                                    22290039
203500                  ,   D.DEPT_NBR                                  22300039
203600                  ,   D.ENT_ID                                    22310039
203700                  ,   D.NEW_STR_PO_IND                            22320039
203800                  ,   E.DONT_SHIP_BEF_DTE                         22330039
203900                  ,   E.CAN_IFNOT_SHIP_DTE                        22340039
204000                  ,   F.ENT_NAME_DESC                             22350039
204100                  ,   DAYS(MIN(A.EST_AR_TMST))                    22360039
204200                        - DAYS (CURRENT DATE + 2 DAYS)            22370039
204300                               AS PLUS_ETA                        22380039
204400                  ,   DATE(MIN(A.EST_AR_TMST)) - 2 DAYS           22390039
204500                               AS MINUS_ETA                       22400039
204600                  ,   H.DCONSLR_RLSE_CDE                          22410039
204700                  ,   'CON' AS TYPE                               22420039
204800                                                                  22430039
204900                FROM                                              22440039
205000                      TVHTRIP A                                   22450039
205100                   ,  TSHIPMT B                                   22460039
205200                   ,  TSHPTPO C                                   22470039
205300                   ,  TPURCHS D                                   22480039
205400                   ,  TPLNSHP E                                   22490039
205500                   ,  TENTNME F                                   22500039
205600                   ,  TVEHICL G                                   22510039
205700                   ,  TIMPORL H                                   22520039
205800                                                                  22530039
205900                WHERE                                             22540039
206000                       C.PO_NBR                 = :DK-PO-NUMBER   22550039
206100                   AND D.PO_NBR                 = C.PO_NBR        22560039
206200                   AND D.PO_TYP_CDE IN ('IM', 'IE', 'IF')         22570039
206300                   AND D.VER_STATUS_CDE         = :PC-A           22580039
206400                   AND D.STATUS_CDE      IN ('AC', 'AP')          22590039
206500                                                                  22600039
206600                                                                  22610039
206700                   AND B.SHIPT_ID               = C.SHIPT_ID      22620039
206800                   AND A.TRIP_ID                = B.TRIP_ID       22630039
206900                   AND (A.EST_AR_TMST  BETWEEN :DK-DB2-TMST-LOW   22640039
207000                                           AND :DK-DB2-TMST)      22650039
207100                                                                  22660039
207200                   AND E.PO_NBR                  = C.PO_NBR       22670039
207300                   AND E.VER_STATUS_CDE          = :PC-A          22680039
207400                                                                  22690039
207500                   AND (F.ENT_ID                 = D.ENT_ID       22700039
207600                                  AND F.TYPE_CDE = :PC-04)        22710039
207700                                                                  22720039
207800                   AND G.OWNER_SCAC_ID         = A.OWNER_SCAC_ID  22730039
207900                   AND G.VEH_NBR               = A.VEH_NBR        22740039
208000                   AND G.VEH_TYP_CDE         IN (:PC-VS, :PC-AV)  22750039
208100                                                                  22760039
208200                   AND H.PO_NBR                 = D.PO_NBR        22770039
208300                   AND H.VER_STATUS_CDE         = :PC-A           22780039
208400                   AND H.DCONSLR_RLSE_CDE    IN (:PC-S, :PC-N)    22790039
208500                                                                  22800039
208600                   AND :PC-5 >                                    22810039
208700                     (SELECT MAX(Z.PRTY_CDE)                      22820039
208800                        FROM TTRIPST Y                            22830039
208900                           , TTRSTYP Z                            22840039
209000                       WHERE Y.TRIP_ID         = A.TRIP_ID        22850039
209100                       AND Y.TRIP_STATUS_CDE = Z.TRIP_STATUS_CDE  22860039
209200                      )                                           22870039
209300                                                                  22880039
209400                   AND :PC-5 >                                    22890039
209500                     (SELECT MAX(X.PRTY_CDE)                      22900039
209600                        FROM TSHIPST W                            22910039
209700                           , TSHSTYP X                            22920039
209800                       WHERE W.SHIPT_ID           = B.SHIPT_ID    22930039
209900                       AND W.SHIPT_STATUS_CDE                     22940039
210000                                     = X.SHIPT_STATUS_CDE         22950039
210100                      )                                           22960039
210200                                                                  22970039
210300                GROUP BY                                          22980039
210400                       D.PO_NBR                                   22990039
210500                    ,  D.DEPT_NBR                                 23000039
210600                    ,  D.ENT_ID                                   23010039
210700                    ,  D.NEW_STR_PO_IND                           23020039
210800                    ,  E.DONT_SHIP_BEF_DTE                        23030039
210900                    ,  E.CAN_IFNOT_SHIP_DTE                       23040039
211000                    ,  F.ENT_NAME_DESC                            23050039
211100                    ,  H.DCONSLR_RLSE_CDE                         23060039
211200               ) AS X                                             23070039
211300                                                                  23080039
211400          FULL JOIN                                               23090039
211500                                                                  23100039
211600               (SELECT DISTINCT                                   23110039
211700                      MIN(A.MOM_POE_DELY_TMST) AS ETA             23120039
211800                  ,   D.PO_NBR                                    23130039
211900                  ,   D.DEPT_NBR                                  23140039
212000                  ,   D.ENT_ID                                    23150039
212100                  ,   D.NEW_STR_PO_IND                            23160039
212200                  ,   E.DONT_SHIP_BEF_DTE                         23170039
212300                  ,   E.CAN_IFNOT_SHIP_DTE                        23180039
212400                  ,   F.ENT_NAME_DESC                             23190039
212500                  ,   DAYS(MIN(A.MOM_POE_DELY_TMST))              23200039
212600                        - DAYS (CURRENT DATE + 2 DAYS)            23210039
212700                               AS PLUS_ETA                        23220039
212800                  ,   DATE(MIN(A.MOM_POE_DELY_TMST)) - 2 DAYS     23230039
212900                               AS MINUS_ETA                       23240039
213000                  ,   I.DCONSLR_RLSE_CDE                          23250039
213100                  ,   'CMN' AS TYPE                               23260039
213200                                                                  23270039
213300                FROM                                              23280039
213400                      TIMCNTK A                                   23290039
213500                   ,  TIMCNPO B                                   23300039
213600                   ,  TPURCHS D                                   23310039
213700                   ,  TPLNSHP E                                   23320039
213800                   ,  TENTNME F                                   23330039
213900                   ,  TIMPORL H                                   23340039
214000                   ,  TIMCNRL I                                   23350039
214100                                                                  23360039
214200                WHERE                                             23370039
214300                       B.PO_NBR          = :DK-PO-NUMBER          23380039
214400                   AND A.CONTNR_ID       = B.CONTNR_ID            23390039
214500                   AND A.CONTNR_SEQ_NBR  = B.CONTNR_SEQ_NBR       23400039
214600                   AND A.MOM_TRIP_TYP_CDE IN ('O', 'A')           23410039
214700                   AND (A.MOM_POE_DELY_TMST                       23420039
214800                                      BETWEEN :DK-DB2-TMST-LOW    23430039
214900                                          AND :DK-DB2-TMST)       23440039
215000                   AND D.PO_NBR          = B.PO_NBR               23450039
215100                   AND D.PO_TYP_CDE IN ('IM', 'IE', 'IF')         23460039
215200                   AND D.VER_STATUS_CDE  = :PC-A                  23470039
215300                   AND D.STATUS_CDE      IN ('AC', 'AP')          23480039
215400                   AND E.PO_NBR          = B.PO_NBR               23490039
215500                   AND E.VER_STATUS_CDE  = :PC-A                  23500039
215600                   AND (F.ENT_ID         = D.ENT_ID               23510039
215700                          AND F.TYPE_CDE = :PC-04)                23520039
215800                   AND H.VER_STATUS_CDE  = :PC-A                  23530039
215900                   AND H.PO_NBR          = D.PO_NBR               23540039
216000                   AND H.DCONSLR_RLSE_CDE  = :PC-N                23550039
216100                   AND I.CONTNR_ID       = B.CONTNR_ID            23560039
216200                   AND I.CONTNR_SEQ_NBR  = B.CONTNR_SEQ_NBR       23570039
216300                   AND I.PO_NBR          = B.PO_NBR               23580039
216400                   AND I.DCONSLR_RLSE_CDE  IN (:PC-N, :PC-S)      23590039
216500                                                                  23600039
216600                GROUP BY                                          23610039
216700                       D.PO_NBR                                   23620039
216800                    ,  D.DEPT_NBR                                 23630039
216900                    ,  D.ENT_ID                                   23640039
217000                    ,  D.NEW_STR_PO_IND                           23650039
217100                    ,  E.DONT_SHIP_BEF_DTE                        23660039
217200                    ,  E.CAN_IFNOT_SHIP_DTE                       23670039
217300                    ,  F.ENT_NAME_DESC                            23680039
217400                    ,  I.DCONSLR_RLSE_CDE                         23690039
217500               ) AS Y                                             23700039
217600          ON X.PO_NBR = Y.PO_NBR                                  23710039
217700                                                                  23720039
217800          FULL JOIN                                               23730039
217900                                                                  23740039
218000               (SELECT DISTINCT                                   23750039
218100                      MIN(A.MOM_POE_DELY_TMST) AS ETA             23760039
218200                  ,   D.PO_NBR                                    23770039
218300                  ,   D.DEPT_NBR                                  23780039
218400                  ,   D.ENT_ID                                    23790039
218500                  ,   D.NEW_STR_PO_IND                            23800039
218600                  ,   E.DONT_SHIP_BEF_DTE                         23810039
218700                  ,   E.CAN_IFNOT_SHIP_DTE                        23820039
218800                  ,   F.ENT_NAME_DESC                             23830039
218900                  ,   DAYS(MIN(E.DONT_SHIP_BEF_DTE))              23840039
219000                        - DAYS (CURRENT DATE + 4 DAYS)            23850039
219100                               AS PLUS_ETA                        23860039
219200                  ,   DATE(MIN(E.DONT_SHIP_BEF_DTE)) - 4 DAYS     23870039
219300                               AS MINUS_ETA                       23880039
219400                  ,   I.DCONSLR_RLSE_CDE                          23890039
219500                  ,   'CMN' AS TYPE                               23900039
219600                                                                  23910039
219700                FROM                                              23920039
219800                      TIMCNTK A                                   23930039
219900                   ,  TIMCNPO B                                   23940039
220000                   ,  TPURCHS D                                   23950039
220100                   ,  TPLNSHP E                                   23960039
220200                   ,  TENTNME F                                   23970039
220300                   ,  TIMCNRL I                                   23980039
220400                                                                  23990039
220500                WHERE                                             24000039
220600                       (D.DEPT_NBR BETWEEN :DK-DPT-NBR-BEG        24010039
220700                                      AND  :DK-DPT-NBR-END)       24020039
220800                   AND D.VER_STATUS_CDE  = :PC-A                  24030039
220900                   AND D.STATUS_CDE      IN ('AC', 'AP')          24040039
221000                   AND B.PO_NBR          = D.PO_NBR               24050039
221100                   AND D.PO_TYP_CDE IN ('LD', 'ST')               24060039
221200                   AND A.CONTNR_ID       = B.CONTNR_ID            24070039
221300                   AND A.CONTNR_SEQ_NBR  = B.CONTNR_SEQ_NBR       24080039
221400                   AND A.MOM_TRIP_TYP_CDE IN ('O', 'A')           24090039
221500                   AND (E.DONT_SHIP_BEF_DTE                       24100039
221600                                      BETWEEN :DK-DB2-DATE-LOW    24110039
221700                                          AND :DK-DB2-SHIP-DATE)  24120039
221800                                                                  24130039
221900                   AND E.PO_NBR          = B.PO_NBR               24140039
222000                   AND E.VER_STATUS_CDE  = :PC-A                  24150039
222100                                                                  24160039
222200                   AND (F.ENT_ID         = D.ENT_ID               24170039
222300                         AND F.TYPE_CDE = :PC-04)                 24180039
222400                   AND I.CONTNR_ID       = B.CONTNR_ID            24190039
222500                   AND I.CONTNR_SEQ_NBR  = B.CONTNR_SEQ_NBR       24200039
222600                   AND I.PO_NBR          = B.PO_NBR               24210039
222700                   AND I.DCONSLR_RLSE_CDE  IN (:PC-N, :PC-S)      24220039
222800                   AND NOT EXISTS                                 24230039
222900                            (SELECT 1                             24240039
223000                             FROM TIMPORL J                       24250039
223100                             WHERE J.PO_NBR = I.PO_NBR            24260039
223200                       AND J.DCONSLR_RLSE_CDE IN (:PC-Y, :PC-R))  24270039
223300                                                                  24280039
223400                GROUP BY                                          24290039
223500                       D.PO_NBR                                   24300039
223600                    ,  D.DEPT_NBR                                 24310039
223700                    ,  D.ENT_ID                                   24320039
223800                    ,  D.NEW_STR_PO_IND                           24330039
223900                    ,  E.DONT_SHIP_BEF_DTE                        24340039
224000                    ,  E.CAN_IFNOT_SHIP_DTE                       24350039
224100                    ,  F.ENT_NAME_DESC                            24360039
224200                    ,  I.DCONSLR_RLSE_CDE                         24370039
224300               ) AS Z                                             24380039
224400            ON COALESCE (X.PO_NBR , Y.PO_NBR) = Z.PO_NBR          24390039
224500                                                                  24400039
224600            FULL JOIN                                             24410039
224700                                                                  24420039
224800               (SELECT DISTINCT                                   24430039
224900                      MIN(A.EST_AR_TMST) AS ETA                   24440039
225000                  ,   D.PO_NBR                                    24450039
225100                  ,   D.DEPT_NBR                                  24460039
225200                  ,   D.ENT_ID                                    24470039
225300                  ,   D.NEW_STR_PO_IND                            24480039
225400                  ,   E.DONT_SHIP_BEF_DTE                         24490039
225500                  ,   E.CAN_IFNOT_SHIP_DTE                        24500039
225600                  ,   F.ENT_NAME_DESC                             24510039
225700                  ,   DAYS(MIN(E.DONT_SHIP_BEF_DTE))              24520039
225800                        - DAYS (CURRENT DATE + 4 DAYS)            24530039
225900                               AS PLUS_ETA                        24540039
226000                  ,   DATE(MIN(E.DONT_SHIP_BEF_DTE)) - 4 DAYS     24550039
226100                               AS MINUS_ETA                       24560039
226200                  ,   H.DCONSLR_RLSE_CDE                          24570039
226300                  ,   'CON' AS TYPE                               24580039
226400                                                                  24590039
226500                FROM                                              24600039
226600                      TVHTRIP A                                   24610039
226700                   ,  TSHIPMT B                                   24620039
226800                   ,  TSHPTPO C                                   24630039
226900                   ,  TPURCHS D                                   24640039
227000                   ,  TPLNSHP E                                   24650039
227100                   ,  TENTNME F                                   24660039
227200                   ,  TVEHICL G                                   24670039
227300                   ,  TIMPORL H                                   24680039
227400                                                                  24690039
227500                WHERE                                             24700039
227600                       C.PO_NBR                 = :DK-PO-NUMBER   24710039
227700                   AND D.PO_NBR                 = C.PO_NBR        24720039
227800                   AND D.PO_TYP_CDE IN ('LD', 'ST')               24730039
227900                   AND D.VER_STATUS_CDE         = :PC-A           24740039
228000                   AND D.STATUS_CDE      IN ('AC', 'AP')          24750039
228100                                                                  24760039
228200                                                                  24770039
228300                   AND B.SHIPT_ID               = C.SHIPT_ID      24780039
228400                   AND A.TRIP_ID                = B.TRIP_ID       24790039
228500                   AND (E.DONT_SHIP_BEF_DTE                       24800039
228600                                      BETWEEN :DK-DB2-DATE-LOW    24810039
228700                                          AND :DK-DB2-SHIP-DATE)  24820039
228800                   AND E.PO_NBR                  = C.PO_NBR       24830039
228900                   AND E.VER_STATUS_CDE          = :PC-A          24840039
229000                                                                  24850039
229100                   AND (F.ENT_ID                 = D.ENT_ID       24860039
229200                                  AND F.TYPE_CDE = :PC-04)        24870039
229300                                                                  24880039
229400                   AND G.OWNER_SCAC_ID         = A.OWNER_SCAC_ID  24890039
229500                   AND G.VEH_NBR               = A.VEH_NBR        24900039
229600                   AND G.VEH_TYP_CDE         IN (:PC-VS, :PC-AV)  24910039
229700                                                                  24920039
229800                   AND H.PO_NBR                 = D.PO_NBR        24930039
229900                   AND H.VER_STATUS_CDE         = :PC-A           24940039
230000                   AND H.DCONSLR_RLSE_CDE    IN (:PC-S, :PC-N)    24950039
230100                                                                  24960039
230200                   AND :PC-5 >                                    24970039
230300                     (SELECT MAX(Z.PRTY_CDE)                      24980039
230400                        FROM TTRIPST Y                            24990039
230500                           , TTRSTYP Z                            25000039
230600                       WHERE Y.TRIP_ID         = A.TRIP_ID        25010039
230700                       AND Y.TRIP_STATUS_CDE = Z.TRIP_STATUS_CDE  25020039
230800                      )                                           25030039
230900                                                                  25040039
231000                   AND :PC-5 >                                    25050039
231100                     (SELECT MAX(X.PRTY_CDE)                      25060039
231200                        FROM TSHIPST W                            25070039
231300                           , TSHSTYP X                            25080039
231400                       WHERE W.SHIPT_ID           = B.SHIPT_ID    25090039
231500                       AND W.SHIPT_STATUS_CDE                     25100039
231600                                     = X.SHIPT_STATUS_CDE         25110039
231700                      )                                           25120039
231800                                                                  25130039
231900                GROUP BY                                          25140039
232000                       D.PO_NBR                                   25150039
232100                    ,  D.DEPT_NBR                                 25160039
232200                    ,  D.ENT_ID                                   25170039
232300                    ,  D.NEW_STR_PO_IND                           25180039
232400                    ,  E.DONT_SHIP_BEF_DTE                        25190039
232500                    ,  E.CAN_IFNOT_SHIP_DTE                       25200039
232600                    ,  F.ENT_NAME_DESC                            25210039
232700                    ,  H.DCONSLR_RLSE_CDE                         25220039
232800               ) AS AA                                            25230039
232900      ON COALESCE (X.PO_NBR , Y.PO_NBR, Z.PO_NBR) = AA.PO_NBR     25240039
233000              )                                                   25250039
233100          ORDER BY                                                25260039
233200                MIN_ETA, PO_NBR                                   25270039
233300     END-EXEC.                                                    25280039
233400                                                                  25290039
233500*---------------------------------------------------------------* 25300039
233600*    STORE CURSOR TO VALIDATE THE STORE/DC RELATIONSHIP         * 25310039
233700*---------------------------------------------------------------* 25320039
233800                                                                  25330039
233900     EXEC SQL                                                     25340039
234000          DECLARE STORE-CSR  CURSOR                               25350039
234100          FOR SELECT DISTINCT                                     25360039
234200                  C.DEST_NBR,                                     25370039
234300                  D.STR_NBR,                                      25380039
234400                  B.DONT_SHIP_BEF_DTE                             25390039
234500          FROM                                                    25400039
234600                TPURITM A,                                        25410039
234700                TPLNSHP B,                                        25420039
234800                TALLPLN C,                                        25430039
234900                TMESTDS D                                         25440039
235000          WHERE                                                   25450039
235100                 A.PO_NBR         = :DK-PO-NUMBER                 25460039
235200            AND  A.VER_STATUS_CDE = :PC-A                         25470039
235300            AND  A.PO_NBR         = B.PO_NBR                      25480039
235400            AND  B.VER_STATUS_CDE = :PC-A                         25490039
235500            AND  B.STATUS_CDE NOT IN ('CA', 'CB')                 25500039
235600            AND  A.PO_NBR         = C.PO_NBR                      25510039
235700            AND  A.PO_LNE_NBR     = C.PO_LNE_NBR                  25520039
235800            AND  C.PO_NBR         = D.PO_NBR                      25530039
235900            AND  C.PO_LNE_NBR     = D.PO_LNE_NBR                  25540039
236000            AND  C.PLAN_NBR       = D.PLAN_NBR                    25550039
236100          ORDER BY                                                25560039
236200                2                                                 25570039
236300     END-EXEC.                                                    25580039
236400                                                                  25590039
236500*---------------------------------------------------------------* 25600039
236600* CONTAINER/RELEASE CURSOR TO IDENTIFY ALL CONTAINERS FOR A PO  * 25610039
236700*---------------------------------------------------------------* 25620039
236800                                                                  25630039
236900     EXEC SQL                                                     25640039
237000          DECLARE TIMCNRL_CSR  CURSOR                             25650039
237100          FOR SELECT DISTINCT                                     25660039
237200                   CONTNR_ID                                      25670039
237300                  ,CONTNR_SEQ_NBR                                 25680039
237400                  ,PO_NBR                                         25690039
237500                  ,DCONSLR_RLSE_CDE                               25700039
237600                  ,DCONSLR_REQR_DTE                               25710039
237700                  ,DCONSLR_ACTL_DTE                               25720039
237800                  ,DCONSLR_ACTL_TM                                25730039
237900                  ,CRE_TMST                                       25740039
238000                  ,CRE_BY_UID                                     25750039
238100                  ,LAST_UPD_TMST                                  25760039
238200                  ,LAST_UPD_BY_UID                                25770039
238300                  ,DCONSLR_ENT_ID                                 25780039
238400          FROM TIMCNRL A                                          25790039
238500              WHERE                                               25800039
238600                   A.PO_NBR       =  :DK-PO-NUMBER                25810039
238700       END-EXEC.                                                  25820039
238800                                                                  25830039
238900*                                                                 25840039
239000*                                                                 25850039
239100*  CURSOR DECLARATION TO OBTAIN PREPACK ID LEVEL INFORMATION FOR  25860039
239200*  PACK RECORDS.                                                  25870039
239300*                                                                 25880039
239400*                                                                 25890039
239500     EXEC SQL                                                     25900039
239600          DECLARE POPRPK_FOR_PCK_CUR CURSOR FOR                   25910039
239700           SELECT                                                 25920039
239800                  A.PO_PREPK_ID                                   25930039
239900                , A.INPK_UNT_QTY                                  25940039
240000                , A.OTPK_UNT_QTY                                  25950039
240100                , A.PREPK_DESC                                    25960039
240200                , A.PREPK_UPC_NBR                                 25970039
240300                , A.PK_SKU_NBR                                    25980039
240400             FROM                                                 25990039
240500                  TPOPRPK  A                                      26000039
240600             WHERE A.PO_NBR         = :PURCHS-PO-NBR              26010039
240700               AND A.PREPK_STAT_CDE = :PC-A                       26020039
240800             ORDER BY A.PO_PREPK_ID                               26030039
240900     END-EXEC.                                                    26040039
241000*                                                                 26050039
241100*                                                                 26060039
241200*  CURSOR DECLRATION TO OBTAIN E-COMMERCE PREPACK UPC LEVEL DATA  26070039
241300*                                                                 26080039
241400*                                                                 26090039
241500*-----------------------------------------------------------------26100039
241600* NOTE: CHECK FOR RV STATUS BECAUSE WE DO A SEPERATE              26110039
241700*       SPECIFIC MESSAGE 'UNCONFIRMED PACKS' AND DON'T WANT       26120039
241800*       TO DISPLAY THIS MESSAGE AS WELL.                          26130039
241900*-------------------------------------------------------------    26140039
242000     EXEC SQL                                                     26150039
242100          DECLARE E_COM_PACK_UPC_CUR CURSOR FOR                   26160039
242200           SELECT C.UPC_NBR                                       26170039
242300                 ,A.PO_LNE_NBR                                    26180039
242400             FROM                                                 26190039
242500                  TPURITM  A                                      26200039
242600                 ,XLT_SKU  B                                      26210039
242700                 ,XLT_UPC  C                                      26220039
242800                 ,TPOPRPK  D                                      26230039
242900             WHERE A.PO_NBR       = :PURITM-PO-NBR                26240039
243000               AND A.VER_STATUS_CDE = :PURITM-VER-STATUS-CDE      26250039
243100               AND A.STATUS_CDE  IN ('AC', 'AP', 'RV')            26260039
243200               AND A.PO_PREPK_ID  = :PURITM-PO-PREPK-ID           26270039
243300               AND B.ITM_NBR      = A.ITM_NBR                     26280039
243400               AND B.INTR_UPC_ID  = C.INTR_UPC_ID                 26290039
243500               AND C.UPC_TYP_CDE  = :XLT00006-UPC-TYP-CDE         26300039
243600               AND D.PO_PREPK_ID  = A.PO_PREPK_ID                 26310039
243700               AND D.PREPK_STAT_CDE  =  :POPRPK-PREPK-STAT-CDE    26320039
243800               AND D.PO_NBR       = A.PO_NBR                      26330039
243900             ORDER BY C.UPC_NBR                                   26340039
244000     END-EXEC.                                                    26350039
244100*                                                                 26360039
244200*                                                                 26370039
244300*  CURSOR DECLARATION TO OBTAIN PACK DC INFORMATION FOR           26380039
244400*  PURCHASE ORDER                                                 26390039
244500*                                                                 26400039
244600*-----------------------------------------------------------------26410039
244700* NOTE: CHECK FOR RV STATUS BECAUSE WE DO A SEPERATE              26420039
244800*       SPECIFIC MESSAGE 'UNCONFIRMED PACKS' AND DON'T WANT       26430039
244900*       TO DISPLAY THIS MESSAGE AS WELL.                          26440039
245000*-------------------------------------------------------------    26450039
245100     EXEC SQL                                                     26460039
245200          DECLARE PREPACK_DC_CUR CURSOR FOR                       26470039
245300           SELECT DISTINCT                                        26480039
245400              SUM (A.CURR_SPLIT_QTY) AS SUMSPLIT                  26490039
245500                 ,A.DEST_NBR                                      26500039
245600             FROM                                                 26510039
245700                  TALLPLN  A                                      26520039
245800                 ,TPURITM  B                                      26530039
245900             WHERE A.PO_NBR      =  :PURCHS-PO-NBR                26540039
246000               AND A.PO_NBR      =  B.PO_NBR                      26550039
246100               AND A.PO_LNE_NBR  =  B.PO_LNE_NBR                  26560039
246200               AND A.CURR_SPLIT_QTY > 0                           26570039
246300               AND B.VER_STATUS_CDE = :PC-A                       26580039
246400               AND B.STATUS_CDE IN ('AC', 'AP', 'RV')             26590039
246500               AND B.PO_PREPK_ID =  :POPRPK-PO-PREPK-ID           26600039
246600          GROUP BY A.DEST_NBR                                     26610039
246700          ORDER BY SUMSPLIT                                       26620039
246800                  ,A.DEST_NBR                                     26630039
246900     END-EXEC.                                                    26640039
247000                                                                  26650039
247100*                                                                 26660039
247200*                                                                 26670039
247300*  OBTAIN ALL UPCS FOR IMPORTS CON BULK PURCHASE ORDERS           26680039
247400*                                                                 26690039
247500*                                                                 26700039
247600     EXEC SQL                                                     26710039
247700          DECLARE BULK_UPC_CUR CURSOR FOR                         26720039
247800           SELECT                                                 26730039
247900                  LN.APP_PO_LNE_NBR                               26740039
248000                , LN.PO_LNE_NBR                                   26750039
248100                , SKU.SHRT_CLOR_DESC                              26760039
248200                , SKU.SIZE_DESC                                   26770039
248300                , SKU.NRF_CLOR_CDE                                26780039
248400                , SKU.SKU_DESC                                    26790039
248500                , VND.MAJ_CL_NBR                                  26800039
248600                , VND.SUB_CL_NBR                                  26810039
248700                , LN.ITM_NBR                                      26820039
248800                , LN.PO_NBR                                       26830039
248900                , LN.STATUS_CDE                                   26840039
249000                , LN.UNT_QTY                                      26850039
249100                , LN.PREPK_RATO_QTY                               26860039
249200                , UPC.UPC_NBR                                     26870039
249300             FROM                                                 26880039
249400                  TPURITM   LN                                    26890039
249500                 ,TPURCHS   PO                                    26900039
249600                 ,XLT_SKU   SKU                                   26910039
249700                 ,XLT_UPC   UPC                                   26920039
249800                 ,XLT_VND_STYL VND                                26930039
249900             WHERE LN.PO_NBR   =  :PURITM-PO-NBR                  26940039
250000               AND PO.PO_NBR   =  LN.PO_NBR                       26950039
250100               AND LN.VER_STATUS_CDE = :PURITM-VER-STATUS-CDE     26960039
250200               AND PO.VER_STATUS_CDE = :PURCHS-VER-STATUS-CDE     26970039
250300               AND SKU.ITM_NBR       = LN.ITM_NBR                 26980039
250400               AND SKU.INTR_UPC_ID   = UPC.INTR_UPC_ID            26990039
250500               AND UPC.UPC_TYP_CDE   = :XLT00006-UPC-TYP-CDE      27000039
250600               AND SKU.STYL_ID       = VND.STYL_ID                27010039
250700             ORDER BY LN.APP_PO_LNE_NBR                           27020039
250800     END-EXEC.                                                    27030039
250900                                                                  27040039
251000*                                                                 27050039
251100*                                                                 27060039
251200*  CURSOR DECLARATION TO OBTAIN ALL DISTRIBUTION CENTERS FOR UPCS 27070039
251300*  ON IMPORTS BULK PURCHASE ORDER.                                27080039
251400*                                                                 27090039
251500*                                                                 27100039
251600*-----------------------------------------------------------------27110039
251700* NOTE: CHECK FOR RV STATUS BECAUSE WE DO A SEPERATE              27120039
251800*       SPECIFIC MESSAGE 'UNCONFIRMED PACKS' AND DON'T WANT       27130039
251900*       TO DISPLAY THIS MESSAGE AS WELL.                          27140039
252000*-------------------------------------------------------------    27150039
252100     EXEC SQL                                                     27160039
252200          DECLARE DC_CUR CURSOR FOR                               27170039
252300           SELECT                                                 27180039
252400                  AL.DEST_NBR                                     27190039
252500                , AL.DC_SPLIT_QTY                                 27200039
252600                , AL.CURR_SPLIT_QTY                               27210039
252700                , AL.PLAN_NBR                                     27220039
252800             FROM                                                 27230039
252900                  TPURITM   LN                                    27240039
253000                , TALLPLN   AL                                    27250039
253100             WHERE AL.PO_NBR         = :PURITM-PO-NBR             27260039
253200               AND AL.PO_NBR         =  LN.PO_NBR                 27270039
253300               AND AL.CURR_SPLIT_QTY > 0                          27280039
253400               AND AL.PO_LNE_NBR     = :PURITM-PO-LNE-NBR         27290039
253500               AND AL.PO_LNE_NBR     =  LN.PO_LNE_NBR             27300039
253600               AND LN.VER_STATUS_CDE = :PC-A                      27310039
253700               AND LN.STATUS_CDE    IN ('AC', 'AP', 'RV')         27320039
253800             ORDER BY AL.CURR_SPLIT_QTY                           27330039
253900     END-EXEC.                                                    27340039
254000                                                                  27350039
254100*                                                                 27360039
254200*                                                                 27370039
254300*  CURSOR DECLARATION FOR MULTIPLE UPCS ON A PACK                 27380039
254400*                                                                 27390039
254500*                                                                 27400039
254600*-----------------------------------------------------------------27410039
254700* NOTE: CHECK FOR RV STATUS BECAUSE WE DO A SEPERATE              27420039
254800*       SPECIFIC MESSAGE 'UNCONFIRMED PACKS' AND DON'T WANT       27430039
254900*       TO DISPLAY THIS MESSAGE AS WELL.                          27440039
255000*-------------------------------------------------------------    27450039
255100*                                                                 27460039
255200*    EXEC SQL                                                     27470039
255300*         DECLARE MULTI_UPC_PACK_CUR CURSOR FOR                   27480039
255400*            SELECT DISTINCT                                      27490039
255500*                CNUP.PO_NBR                                      27500039
255600*               ,CNUP.CONTNR_ID                                   27510039
255700*               ,CNUP.CONTNR_SEQ_NBR                              27520039
255800*               ,CNUP.UPC_NBR                                     27530039
255900*               ,COUNT(*)                                         27540039
256000*            FROM                                                 27550039
256100*                TPURITM  PUR                                     27560039
256200*               ,TUPCSKU  SKU                                     27570039
256300*               ,TIMCNUP  CNUP                                    27580039
256400*            WHERE  CNUP.PO_NBR         = :PURCHS-PO-NBR          27590039
256500*              AND  PUR.PO_NBR          = CNUP.PO_NBR             27600039
256600*              AND  PUR.VER_STATUS_CDE  = :PC-A                   27610039
256700*              AND  PUR.STATUS_CDE     IN ('AC', 'AP', 'RV')      27620039
256800*              AND  SKU.ITEM_NBR        =  PUR.ITM_NBR            27630039
256900*              AND  SKU.UPC_NBR         =  CNUP.UPC_NBR           27640039
257000*            GROUP BY  CNUP.PO_NBR                                27650039
257100*                     ,CNUP.CONTNR_ID                             27660039
257200*                     ,CNUP.CONTNR_SEQ_NBR                        27670039
257300*                     ,CNUP.UPC_NBR                               27680039
257400*            ORDER BY  CNUP.PO_NBR                                27690039
257500*                     ,CNUP.CONTNR_ID                             27700039
257600*                     ,CNUP.CONTNR_SEQ_NBR                        27710039
257700*                     ,CNUP.UPC_NBR                               27720039
257800*    END-EXEC.                                                    27730039
257900*                                                                 27740039
258000*                                                                 27750039
258100*  CURSOR DECLARATION TO OBTAIN BULK UPCS FOR PURCHASE ORDER.     27760039
258200* (CMN ONLY)                                                      27770039
258300*                                                                 27780039
258400     EXEC SQL                                                     27790039
258500          DECLARE CMN_BULK_UPC_CUR CURSOR FOR                     27800039
258600           SELECT DISTINCT                                        27810039
258700                  CNUP.UPC_NBR                                    27820039
258800                 ,CNUP.ASN_PKGNG_CDE                              27830039
258900                 ,PUR.ITM_NBR                                     27840039
259000                , PUR.UNT_QTY                                     27850039
259100                , PUR.STATUS_CDE                                  27860039
259200             FROM TIMCNUP  CNUP                                   27870039
259300                 ,TPURITM  PUR                                    27880039
259400                 ,XLT_SKU  SKU                                    27890039
259500                 ,XLT_UPC  UPC                                    27900039
259600             WHERE CNUP.PO_NBR         = :IMCNUP-PO-NBR           27910039
259700               AND CNUP.UPC_NBR        =  UPC.UPC_NBR             27920039
259800               AND UPC.INTR_UPC_ID     =  SKU.INTR_UPC_ID         27930039
259900               AND SKU.ITM_NBR         =  PUR.ITM_NBR             27940039
260000               AND PUR.VER_STATUS_CDE  = :PURITM-VER-STATUS-CDE   27950039
260100               AND PUR.PO_NBR          =  CNUP.PO_NBR             27960039
260200             ORDER BY CNUP.UPC_NBR                                27970039
260300     END-EXEC.                                                    27980039
260400 EJECT                                                            27990039
260500                                                                  28000039
260600******************************************************************28010039
260700 LINKAGE SECTION.                                                 28020039
260800                                                                  28030039
260900 01  DFHCOMMAREA.                                                 28040039
261000     05  FILLER                         OCCURS  1 TO 4072 TIMES   28050039
261100                                        DEPENDING ON EIBCALEN.    28060039
261200         10  FILLER                     PIC X.                    28070039
261300                                                                  28080039
261400 EJECT                                                            28090039
261500 PROCEDURE DIVISION.                                              28100039
261600******************************************************************28110039
261700**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **28120039
261800**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **28130039
261900**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **28140039
262000******************************************************************28150039
262100 0000-MAIN-MODULE.                                                28160039
262200     INITIALIZE DP030-CICS-API-FIELDS.                            28170039
262300     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       28180039
262400     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          28190039
262500     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         28200039
262600     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       28210039
262700     MOVE LENGTH OF PO061AI        TO DP030-MAP-LENGTH (1).       28220039
262800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     28230039
262900     PERFORM 0001-CALL-CICS-ARCH-API.                             28240039
263000*                                                                 28250039
263100     PERFORM 1000-CONTROL-PROCESSING                              28260039
263200*                                                                 28270039
263300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     28280039
263400     PERFORM 0001-CALL-CICS-ARCH-API.                             28290039
263500                                                                  28300039
263600******************************************************************28310039
263700**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **28320039
263800**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **28330039
263900******************************************************************28340039
264000 0001-CALL-CICS-ARCH-API.                                         28350039
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      28360065
264200                                    DFHCOMMAREA                   28370065
264300                                    DP030-CICS-API-FIELDS         28380065
264400                                    DP020-STANDARD-COMMAREA       28390065
264500                                    PO061AI.                      28400065
264600*                                                                 28410039
264700     IF  DP030-RC-CALL-SUCCESSFUL                                 28420039
264800         CONTINUE                                                 28430039
264900     ELSE                                                         28440039
265000         SET DP013-NO-ROLLBACK                                    28450039
265100             DP013-XCTL-DISPLAY-RESTART                           28460039
265200             DP013-CICS-ABEND      TO TRUE                        28470039
265300         MOVE '0001-CALL-CICS-ARCH-API'                           28480039
265400                                   TO DP013-PARAGRAPH             28490039
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O28500065
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      28510065
265700         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      28520039
265800         PERFORM DP013-0000-PROCESS-ABEND                         28530039
265900     END-IF.                                                      28540039
266000*----------------------------------------------------------------*28550039
266100* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *28560039
266200* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *28570039
266300*                                                                *28580039
266400* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *28590039
266500*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *28600039
266600*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *28610039
266700*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *28620039
266800*----------------------------------------------------------------*28630039
266900                                                                  28640039
267000 1000-CONTROL-PROCESSING.                                         28650039
267100                                                                  28660039
267200     EVALUATE TRUE                                                28670039
267300         WHEN DP020-NEXT-ACT-INITIAL                              28680039
267400             INITIALIZE ASC-SPECIFIC-COMMAREA                     28690039
267500             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            28700039
267600                                      ASC-SEL-TERM-ID             28710039
267700             MOVE DP020-SRC-TASK-NUMBER                           28720039
267800                                   TO ASC-LIST-TASK-NUMBER        28730039
267900                                      ASC-SEL-TASK-NUMBER         28740039
268000             MOVE PC-LIST-QUEUE-SEQ                               28750039
268100                                   TO ASC-LIST-SEQ                28760039
268200             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 28770039
268300             PERFORM 1100-PROCESS-INTER-APPL-COMM                 28780039
268400***-----$TEMPLATE NOTE$-------------------------------------------28790039
268500*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,28800039
268600*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  28810039
268700*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.28820039
268800***---------------------------------------------------------------28830039
268900             IF  PS-COMMAREA-NOT-VALID                            28840039
269000***              MOVE PC-TSYMSG-99901                             28850039
269100***                                TO DP020-MSG-NUMBER            28860039
269200***              SET DP020-MSG-FATAL                              28870039
269300***                                TO TRUE                        28880039
269400                 SET DP020-NEXT-ACT-APPL-ERROR                    28890039
269500                                   TO TRUE                        28900039
269600             ELSE                                                 28910039
269700                 PERFORM 4000-BUILD-INITIAL-PANEL                 28920039
269800             END-IF                                               28930039
269900                                                                  28940039
270000         WHEN DP020-NEXT-ACT-READ-MAP                             28950039
270100             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        28960039
270200                                   TO PV-TOP-ITEM                 28970039
270300             PERFORM 2000-PROCESS-PANEL                           28980039
270400                                                                  28990039
270500         WHEN DP020-NEXT-ACT-RETURN                               29000039
270600             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        29010039
270700                                   TO PV-TOP-ITEM                 29020039
270800             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    29030039
270900***          PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 29040039
271000             PERFORM 2140-DESELECT-ALL-ITEMS                      29050039
271100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 29060039
271200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   29070039
271300                                                                  29080039
271400         WHEN OTHER                                               29090039
271500             SET DP013-LOGIC-ABEND TO TRUE                        29100039
271600             SET DP013-NO-ROLLBACK TO TRUE                        29110039
271700             MOVE '1000-CONTROL-PROCESSING'                       29120039
271800                                   TO DP013-PARAGRAPH             29130039
271900             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    29140039
272000                                   TO DP013-MESSAGE-TEXT(1)       29150039
272100             PERFORM DP013-0000-PROCESS-ABEND                     29160039
272200     END-EVALUATE.                                                29170039
272300                                                                  29180039
272400 EJECT                                                            29190039
272500*----------------------------------------------------------------*29200039
272600* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *29210039
272700* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *29220039
272800*----------------------------------------------------------------*29230039
272900                                                                  29240039
273000 1100-PROCESS-INTER-APPL-COMM.                                    29250039
273100                                                                  29260039
273200     SET PS-COMMAREA-VALID         TO TRUE.                       29270039
273300     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     29280039
273400     IF PO060-PO-NUMBER > ZEROES                                  29290039
273500         MOVE PO060-PO-NUMBER      TO DK-PO-NUMBER                29300039
273600         PERFORM 1140-VALIDATE-PO                                 29310039
273700         IF SQLCODE NOT = +0                                      29320039
273800             MOVE PC-TSYMSG-00083                                 29330039
273900                                   TO DP020-MSG-NUMBER            29340039
274000             SET PS-ERROR                                         29350039
274100                 PS-COMMAREA-NOT-VALID                            29360039
274200                 DP020-MSG-FATAL                                  29370039
274300                                   TO TRUE                        29380039
274400         END-IF                                                   29390039
274500     ELSE                                                         29400039
274600      IF PO060-DPT-NUMBER > '000' AND                             29410039
274700         PO060-DMM-NAME   > SPACES                                29420039
274800          MOVE PC-TSYMSG-00732                                    29430039
274900                                   TO DP020-MSG-NUMBER            29440039
275000          SET PS-ERROR                                            29450039
275100              PS-COMMAREA-NOT-VALID                               29460039
275200              DP020-MSG-FATAL      TO TRUE                        29470039
275300      ELSE                                                        29480039
275400       IF PO060-DMM-NAME > SPACES                                 29490039
275500           MOVE PO060-DMM-NAME     TO DK-DMM-NAME                 29500039
275600           PERFORM 1110-GET-WORKER-NBR                            29510039
275700           IF PS-ERROR                                            29520039
275800               MOVE PC-TSYMSG-00733                               29530039
275900                                   TO DP020-MSG-NUMBER            29540039
276000               SET PS-ERROR                                       29550039
276100                   PS-COMMAREA-NOT-VALID                          29560039
276200                   DP020-MSG-FATAL                                29570039
276300                                   TO TRUE                        29580039
276400           END-IF                                                 29590039
276500       END-IF                                                     29600039
276600       IF PO060-DPT-NUMBER > '000'                                29610039
276700           MOVE PO060-DPT-NUMBER   TO DK-DPT-NBR-BEG              29620039
276800                                      DK-DPT-NBR-END              29630039
276900                                      DK-DPT                      29640039
277000           PERFORM 1130-VALIDATE-DEPARTMENT                       29650039
277100           IF PS-ERROR                                            29660039
277200               MOVE PC-TSYMSG-00588                               29670039
277300                                   TO DP020-MSG-NUMBER            29680039
277400               SET PS-ERROR                                       29690039
277500                   PS-COMMAREA-NOT-VALID                          29700039
277600                   DP020-MSG-FATAL                                29710039
277700                                   TO TRUE                        29720039
277800           END-IF                                                 29730039
277900       ELSE                                                       29740039
278000           MOVE '000'              TO DK-DPT-NBR-BEG              29750039
278100                                      DK-DPT                      29760039
278200           MOVE '999'              TO DK-DPT-NBR-END              29770039
278300       END-IF                                                     29780039
278400      END-IF                                                      29790039
278500     END-IF.                                                      29800039
278600                                                                  29810039
278700     IF PS-NO-ERROR                                               29820039
278800         MOVE PO060-DPT-NUMBER     TO ASC-KEY-DPT                 29830039
278900         MOVE PO060-DAYS-RELEASE   TO ASC-KEY-RLSE-DAYS           29840039
279000                                      DK-RLSE-DAYS                29850039
279100         MOVE PO060-STATUS         TO ASC-KEY-STATUS              29860039
279200         MOVE PO060-DMM-NAME       TO ASC-KEY-DMM-NAME            29870039
279300                                      DK-DMM-NAME                 29880039
279400         MOVE PO060-PO-NUMBER      TO ASC-KEY-PO-NUMBER           29890039
279500                                      DK-PO-NUMBER                29900039
279600     END-IF.                                                      29910039
279700                                                                  29920039
279800 EJECT                                                            29930039
279900*----------------------------------------------------------------*29940039
280000*    GET THE WORKER NUMBER FOR THE DMM NAME ENTERED.             *29950039
280100*----------------------------------------------------------------*29960039
280200 1110-GET-WORKER-NBR.                                             29970039
280300                                                                  29980039
280400     PERFORM                                                      29990039
280500         WITH TEST AFTER                                          30000039
280600         VARYING PV-RETRY-COUNTER                                 30010039
280700         FROM 1 BY 1                                              30020039
280800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30030039
280900                   OR (SQLCODE = +100)                            30040039
281000                   OR (SQLCODE = ZERO))                           30050039
281100                                                                  30060039
281200         EXEC SQL                                                 30070039
281300             SELECT DISTINCT                                      30080039
281400                     A.OPERCO_NBR                                 30090039
281500                  ,  A.WORKER_NBR                                 30100039
281600                INTO :WORKER-OPERCO-NBR                           30110039
281700                  ,  :WORKER-NBR                                  30120039
281800                FROM  TWORKER A                                   30130039
281900                  ,   TRSPBAR B                                   30140039
282000               WHERE A.OPERCO_NBR = '03'                          30150039
282100                 AND A.LAST_NAME  = :DK-DMM-NAME                  30160039
282200                 AND A.WORKER_NBR = B.WORKER_NBR                  30170039
282300                 AND (CURRENT DATE BETWEEN B.WORKER_STRT_DTE AND  30180039
282400                      B.WORKER_END_DTE)                           30190039
282500                 AND B.RSPLVL_CDE = 'DMM'                         30200039
282600         END-EXEC                                                 30210039
282700                                                                  30220039
282800         EVALUATE TRUE                                            30230039
282900                 WHEN SQLCODE = +0                                30240039
283000                 MOVE WORKER-NBR   TO DK-WORKER-NBR               30250039
283100                 WHEN SQLCODE = +100                              30260039
283200                     SET PS-ERROR                                 30270039
283300                         DP030-OVERRIDE-GO                        30280039
283400                         DP020-MSG-FATAL                          30290039
283500                         DP020-NEXT-ACT-APPL-ERROR                30300039
283600                                   TO TRUE                        30310039
283700                 WHEN SQLCODE = -904                              30320039
283800                 WHEN SQLCODE = -913                              30330039
283900                     CONTINUE                                     30340039
284000                 WHEN SQLWARN0 NOT = SPACES                       30350039
284100                 WHEN SQLCODE < ZERO                              30360039
284200                 WHEN SQLCODE > ZERO                              30370039
284300                     MOVE '1110-GET-WORKER'                       30380039
284400                                   TO DP013-PARAGRAPH             30390039
284500                     MOVE 'GET WORKER'                            30400039
284600                                   TO DP013-MESSAGE-TEXT (1)      30410039
284700                     MOVE SQLCA    TO DP013-SQLCA                 30420039
284800                     MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (1)  30430039
284900                     SET DP013-DB2-ABEND                          30440039
285000                         DP013-XCTL-DISPLAY-RESTART TO TRUE       30450039
285100                     PERFORM DP013-0000-PROCESS-ABEND             30460039
285200             END-EVALUATE                                         30470039
285300     END-PERFORM.                                                 30480039
285400*                                                                 30490039
285500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        30500039
285600         MOVE '1110-GET-WORKER'    TO DP013-PARAGRAPH             30510039
285700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO GET DMA '   30520039
285800                                   TO DP013-MESSAGE-TEXT (1)      30530039
285900         MOVE SQLCA                TO DP013-SQLCA                 30540039
286000         MOVE 'TMDSEAR '           TO DP013-DB2-TABLE-NAME (1)    30550039
286100         SET DP013-DB2-ABEND                                      30560039
286200             DP013-XCTL-DISPLAY-RESTART                           30570039
286300                                   TO TRUE                        30580039
286400         PERFORM DP013-0000-PROCESS-ABEND                         30590039
286500     END-IF.                                                      30600039
286600*                                                                 30610039
286700     IF PS-NO-ERROR                                               30620039
286800         PERFORM 1120-GET-DMA-NBR.                                30630039
286900                                                                  30640039
287000 EJECT                                                            30650039
287100*----------------------------------------------------------------*30660039
287200*    GET THE DMA NUMBER                                          *30670039
287300*----------------------------------------------------------------*30680039
287400 1120-GET-DMA-NBR.                                                30690039
287500                                                                  30700039
287600     PERFORM                                                      30710039
287700         WITH TEST AFTER                                          30720039
287800         VARYING PV-RETRY-COUNTER                                 30730039
287900         FROM 1 BY 1                                              30740039
288000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30750039
288100                   OR (SQLCODE = +100)                            30760039
288200                   OR (SQLCODE = ZERO))                           30770039
288300         EXEC SQL                                                 30780039
288400             SELECT  DISTINCT                                     30790039
288500                     DMA_NBR                                      30800039
288600                INTO :MDSEAR-DMA-NBR                              30810039
288700                FROM  TMDSEAR A,                                  30820039
288800                      TRSPBAR B                                   30830039
288900                WHERE B.WORKER_NBR  = :DK-WORKER-NBR              30840039
289000                  AND B.MDSEAR_DKEY = A.MDSEAR_DKEY               30850039
289100                  AND A.MDSELV_CDE  = 'DMA'                       30860039
289200                  AND B.RSPLVL_CDE  = 'DMM'                       30870039
289300         END-EXEC                                                 30880039
289400                                                                  30890039
289500         EVALUATE TRUE                                            30900039
289600                 WHEN SQLCODE = +0                                30910039
289700                 MOVE MDSEAR-DMA-NBR TO DK-DMA-NBR                30920039
289800                                        ASC-DMA-NBR               30930039
289900                 WHEN SQLCODE = +100                              30940039
290000                     SET PS-ERROR                                 30950039
290100                         DP030-OVERRIDE-GO                        30960039
290200                         DP020-MSG-FATAL                          30970039
290300                         DP020-NEXT-ACT-APPL-ERROR                30980039
290400                                   TO TRUE                        30990039
290500                 WHEN SQLCODE = -904                              31000039
290600                 WHEN SQLCODE = -913                              31010039
290700                     CONTINUE                                     31020039
290800                 WHEN SQLWARN0 NOT = SPACES                       31030039
290900                 WHEN SQLCODE < ZERO                              31040039
291000                 WHEN SQLCODE > ZERO                              31050039
291100                     MOVE '1120-GET-DMA'                          31060039
291200                                   TO DP013-PARAGRAPH             31070039
291300                     MOVE 'GET DMA NUMBER'                        31080039
291400                                   TO DP013-MESSAGE-TEXT (1)      31090039
291500                     MOVE SQLCA    TO DP013-SQLCA                 31100039
291600                     MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (1)  31110039
291700                     SET DP013-DB2-ABEND                          31120039
291800                         DP013-XCTL-DISPLAY-RESTART TO TRUE       31130039
291900                     PERFORM DP013-0000-PROCESS-ABEND             31140039
292000             END-EVALUATE                                         31150039
292100     END-PERFORM.                                                 31160039
292200*                                                                 31170039
292300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31180039
292400         MOVE '1120-GET-DMA'       TO DP013-PARAGRAPH             31190039
292500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO GET DMA '   31200039
292600                                   TO DP013-MESSAGE-TEXT (1)      31210039
292700         MOVE SQLCA                TO DP013-SQLCA                 31220039
292800         MOVE 'TMDSEAR '           TO DP013-DB2-TABLE-NAME (1)    31230039
292900         SET DP013-DB2-ABEND                                      31240039
293000             DP013-XCTL-DISPLAY-RESTART                           31250039
293100                                   TO TRUE                        31260039
293200         PERFORM DP013-0000-PROCESS-ABEND                         31270039
293300     END-IF.                                                      31280039
293400 EJECT                                                            31290039
293500*----------------------------------------------------------------*31300039
293600* VALIDATE THE DEPARTMENT NUMBER ENTERED.                        *31310039
293700*----------------------------------------------------------------*31320039
293800 1130-VALIDATE-DEPARTMENT.                                        31330039
293900                                                                  31340039
294000     PERFORM                                                      31350039
294100         WITH TEST AFTER                                          31360039
294200         VARYING PV-RETRY-COUNTER                                 31370039
294300         FROM 1 BY 1                                              31380039
294400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31390039
294500                   OR (SQLCODE = ZERO))                           31400039
294600                   OR (PS-ERROR)                                  31410039
294700         EXEC SQL                                                 31420039
294800             SELECT  DEPT_NBR                                     31430039
294900                INTO :MDSEAR-DEPT-NBR                             31440039
295000                FROM  TMDSEAR                                     31450039
295100               WHERE OPERCO_NBR = '03'                            31460039
295200                 AND DEPT_NBR   = :DK-DPT                         31470039
295300                 AND MDSELV_CDE = 'DPT'                           31480039
295400                 AND (CURRENT DATE BETWEEN STRT_DTE AND END_DTE)  31490039
295500         END-EXEC                                                 31500039
295600                                                                  31510039
295700         EVALUATE TRUE                                            31520039
295800                 WHEN SQLCODE = +0                                31530039
295900                     CONTINUE                                     31540039
296000                 WHEN SQLCODE = +100                              31550039
296100                     SET PS-ERROR                                 31560039
296200                         DP030-OVERRIDE-GO                        31570039
296300                         DP020-MSG-FATAL                          31580039
296400                         DP020-NEXT-ACT-APPL-ERROR                31590039
296500                                   TO TRUE                        31600039
296600                 WHEN SQLCODE = -904                              31610039
296700                 WHEN SQLCODE = -913                              31620039
296800                     CONTINUE                                     31630039
296900                 WHEN SQLWARN0 NOT = SPACES                       31640039
297000                 WHEN SQLCODE < ZERO                              31650039
297100                 WHEN SQLCODE > ZERO                              31660039
297200                     MOVE '1130-VALIDATE-DEPARTMENT'              31670039
297300                                   TO DP013-PARAGRAPH             31680039
297400                     MOVE 'VALIDATE DEPARTMENT'                   31690039
297500                                   TO DP013-MESSAGE-TEXT (1)      31700039
297600                     MOVE SQLCA    TO DP013-SQLCA                 31710039
297700                     MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (1)  31720039
297800                     SET DP013-DB2-ABEND                          31730039
297900                         DP013-XCTL-DISPLAY-RESTART TO TRUE       31740039
298000                     PERFORM DP013-0000-PROCESS-ABEND             31750039
298100             END-EVALUATE                                         31760039
298200     END-PERFORM.                                                 31770039
298300*                                                                 31780039
298400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31790039
298500         MOVE '1130-VALIDATE-DPT'  TO DP013-PARAGRAPH             31800039
298600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO GET DPT '   31810039
298700                                   TO DP013-MESSAGE-TEXT (1)      31820039
298800         MOVE SQLCA                TO DP013-SQLCA                 31830039
298900         MOVE 'TMDSEAR '           TO DP013-DB2-TABLE-NAME (1)    31840039
299000         SET DP013-DB2-ABEND                                      31850039
299100             DP013-XCTL-DISPLAY-RESTART                           31860039
299200                                   TO TRUE                        31870039
299300         PERFORM DP013-0000-PROCESS-ABEND                         31880039
299400     END-IF.                                                      31890039
299500*                                                                 31900039
299600 EJECT                                                            31910039
299700*----------------------------------------------------------------*31920039
299800* VALIDATE THE PO NUMBER ENTERED                                 *31930039
299900*----------------------------------------------------------------*31940039
300000 1140-VALIDATE-PO.                                                31950039
300100                                                                  31960039
300200     PERFORM                                                      31970039
300300         WITH TEST AFTER                                          31980039
300400         VARYING PV-RETRY-COUNTER                                 31990039
300500         FROM 1 BY 1                                              32000039
300600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32010039
300700                   OR (SQLCODE = ZERO)                            32020039
300800                   OR (SQLCODE = +100))                           32030039
300900         EXEC SQL                                                 32040039
301000              SELECT PO_NBR                                       32050039
301100                INTO :PURCHS-PO-NBR                               32060039
301200                FROM TPURCHS                                      32070039
301300               WHERE PO_NBR         = :DK-PO-NUMBER               32080039
301400                 AND VER_STATUS_CDE = :PC-A                       32090039
301500                 AND PO_CATEG_CDE = 'MR'                          32100039
301600         END-EXEC                                                 32110039
301700                                                                  32120039
301800         EVALUATE TRUE                                            32130039
301900                 WHEN SQLCODE = +0                                32140039
302000                     CONTINUE                                     32150039
302100                 WHEN SQLCODE = +100                              32160039
302200                     SET PS-ERROR                                 32170039
302300                         DP030-OVERRIDE-GO                        32180039
302400                         DP020-MSG-FATAL                          32190039
302500                         DP020-NEXT-ACT-APPL-ERROR                32200039
302600                                   TO TRUE                        32210039
302700                 WHEN SQLCODE = -904                              32220039
302800                 WHEN SQLCODE = -913                              32230039
302900                     CONTINUE                                     32240039
303000                 WHEN SQLWARN0 NOT = SPACES                       32250039
303100                 WHEN SQLCODE < ZERO                              32260039
303200                 WHEN SQLCODE > ZERO                              32270039
303300                     MOVE '1140-VALIDATE-PO'                      32280039
303400                                   TO DP013-PARAGRAPH             32290039
303500                     MOVE 'VALIDATE PO'                           32300039
303600                                   TO DP013-MESSAGE-TEXT (1)      32310039
303700                     MOVE SQLCA    TO DP013-SQLCA                 32320039
303800                     MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)  32330039
303900                     SET DP013-DB2-ABEND                          32340039
304000                         DP013-XCTL-DISPLAY-RESTART TO TRUE       32350039
304100                     PERFORM DP013-0000-PROCESS-ABEND             32360039
304200             END-EVALUATE                                         32370039
304300     END-PERFORM.                                                 32380039
304400*                                                                 32390039
304500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        32400039
304600         MOVE '1140-VALIDATE-PO '  TO DP013-PARAGRAPH             32410039
304700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO GET PO  '   32420039
304800                                   TO DP013-MESSAGE-TEXT (1)      32430039
304900         MOVE SQLCA                TO DP013-SQLCA                 32440039
305000         MOVE 'TPURCHS '           TO DP013-DB2-TABLE-NAME (1)    32450039
305100         SET DP013-DB2-ABEND                                      32460039
305200             DP013-XCTL-DISPLAY-RESTART                           32470039
305300                                   TO TRUE                        32480039
305400         PERFORM DP013-0000-PROCESS-ABEND                         32490039
305500     END-IF.                                                      32500039
305600*----------------------------------------------------------------*32510039
305700* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *32520039
305800* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *32530039
305900* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *32540039
306000* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *32550039
306100* FUNCTION KEYS CAN GET THIS FAR.                                *32560039
306200*----------------------------------------------------------------*32570039
306300                                                                  32580039
306400 2000-PROCESS-PANEL.                                              32590039
306500     EVALUATE TRUE                                                32600039
306600         WHEN DP020-SRC-AID = DP016-CLEAR                         32610039
306700             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    32620039
306800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   32630039
306900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 32640039
307000                                                                  32650039
307100         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    32660039
307200             MOVE ASC-KEY-DPT      TO DK-DPT                      32670039
307300             IF DK-DPT = '000'                                    32680039
307400                 MOVE '000'        TO DK-DPT-NBR-BEG              32690039
307500                 MOVE '999'        TO DK-DPT-NBR-END              32700039
307600             ELSE                                                 32710039
307700                 MOVE DK-DPT       TO DK-DPT-NBR-BEG              32720039
307800                                      DK-DPT-NBR-END              32730039
307900             END-IF                                               32740039
308000             MOVE ASC-KEY-RLSE-DAYS                               32750039
308100                                   TO DK-RLSE-DAYS                32760039
308200             MOVE ASC-KEY-DMM-NAME TO DK-DMM-NAME                 32770039
308300             MOVE ASC-KEY-PO-NUMBER                               32780039
308400                                   TO DK-PO-NUMBER                32790039
308500             MOVE ASC-DMA-NBR      TO DK-DMA-NBR                  32800039
308600             PERFORM 2050-DELETE-LIST-QUEUE                       32810039
308700             PERFORM 4000-BUILD-INITIAL-PANEL                     32820039
308800                                                                  32830039
308900         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    32840039
309000             PERFORM 2140-DESELECT-ALL-ITEMS                      32850039
309100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 32860039
309200                                                                  32870039
309300         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  32880039
309400             PERFORM 2150-SELECT-ALL-ITEMS                        32890039
309500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 32900039
309600                                                                  32910039
309700         WHEN OTHER                                               32920039
309800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 32930039
309900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   32940039
310000             IF  PS-NO-ERROR                                      32950039
310100                 SET DP030-CONTINUE-GO                            32960039
310200                                 TO TRUE                          32970039
310300                 PERFORM 2100-CHECK-FUNCTION-KEY                  32980039
310400             ELSE                                                 32990039
310500                 SET DP030-OVERRIDE-GO                            33000039
310600                                 TO TRUE                          33010039
310700             END-IF                                               33020039
310800     END-EVALUATE.                                                33030039
310900 EJECT                                                            33040039
311000*----------------------------------------------------------------*33050039
311100*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *33060039
311200*----------------------------------------------------------------*33070039
311300 2050-DELETE-LIST-QUEUE.                                          33080039
311400                                                                  33090039
311500     EXEC CICS                                                    33100039
311600         DELETEQ TS                                               33110039
311700             QUEUE (ASC-LIST-QUEUE-NAME)                          33120039
311800             RESP  (PV-CICS-RESP)                                 33130039
311900     END-EXEC.                                                    33140039
312000                                                                  33150039
312100     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       33160039
312200        (PV-CICS-RESP = DFHRESP(QIDERR))                          33170039
312300         CONTINUE                                                 33180039
312400     ELSE                                                         33190039
312500         SET DP013-CICS-ABEND      TO TRUE                        33200039
312600         SET DP013-NO-ROLLBACK     TO TRUE                        33210039
312700                                                                  33220039
312800         MOVE '2050-DELETE-LIST-QUEUE'                            33230039
312900                                   TO DP013-PARAGRAPH             33240039
313000         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    33250039
313100                                   TO DP013-MESSAGE-TEXT (1)      33260039
313200         PERFORM DP013-0000-PROCESS-ABEND                         33270039
313300     END-IF.                                                      33280039
313400                                                                  33290039
313500     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  33300039
313600                                                                  33310039
313700 EJECT                                                            33320039
313800*----------------------------------------------------------------*33330039
313900* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*33340039
314000* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *33350039
314100* CICS ARCHITECTURE API.                                         *33360039
314200*----------------------------------------------------------------*33370039
314300 2100-CHECK-FUNCTION-KEY.                                         33380039
314400                                                                  33390039
314500     EVALUATE TRUE                                                33400039
314600         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  33410039
314700             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              33420039
314800                 INITIALIZE PO013-INTER-APPL-COMMAREA             33430039
314900                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                33440039
315000                                TO PO013-NUMBER-OF-SELECTED-ITEMS 33450039
315100                 PERFORM 5000-PREPARE-SEL-QUEUE                   33460039
315200             ELSE                                                 33470039
315300                 SET DP030-OVERRIDE-GO                            33480039
315400                                   TO TRUE                        33490039
315500                 MOVE PC-TSYMSG-00057                             33500039
315600                                   TO DP020-MSG-NUMBER            33510039
315700                 SET DP020-MSG-WARNING                            33520039
315800                                   TO TRUE                        33530039
315900             END-IF                                               33540039
316000                                                                  33550039
316100         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  33560039
316200             MOVE +1               TO PV-TOP-ITEM                 33570039
316300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 33580039
316400                                                                  33590039
316500         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   33600039
316600             PERFORM 2110-BROWSE-BACKWARD                         33610039
316700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 33620039
316800                                                                  33630039
316900         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   33640039
317000             PERFORM 2120-BROWSE-FORWARD                          33650039
317100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 33660039
317200                                                                  33670039
317300         WHEN DP020-SRC-AID = DP016-ENTER                         33680039
317400             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   33690039
317500             IF  PS-ERROR                                         33700039
317600                 CONTINUE                                         33710039
317700             ELSE                                                 33720039
317800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             33730039
317900             END-IF                                               33740039
318000                                                                  33750039
318100         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               33760039
318200             IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO               33770039
318300                                                                  33780039
318400                 PERFORM 2170-CHECK-RACF-ACCESS                   33790039
318500                                                                  33800039
318600                 IF DP008-ACCESS-DENIED                           33810039
318700*                    -- NO SECURITY CLEARANCE FOR FUNCTION --     33820039
318800                     MOVE PC-TSYMSG-01061                         33830039
318900                                       TO DP020-MSG-NUMBER        33840039
319000                     SET PS-ERROR                                 33850039
319100                         DP020-MSG-WARNING                        33860039
319200                         DP020-NEXT-ACT-APPL-ERROR                33870039
319300                                 TO TRUE                          33880039
319400                 ELSE                                             33890039
319500                 SET DP030-CONTINUE-GO                            33900039
319600                                   TO TRUE                        33910039
319700                 MOVE +1           TO ASC-BLK-SUB                 33920039
319800                 PERFORM 5100-WRITE-TEMP-STORAGE                  33930039
319900                 ADD +1            TO ASC-BLK-SUB                 33940039
320000                 PERFORM 5100-WRITE-TEMP-STORAGE                  33950039
320100                 PERFORM 7000-RELEASE-PO                          33960039
320200                         VARYING PV-ITEM                          33970039
320300                         FROM 1 BY 1                              33980039
320400                 UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN  33990039
320500                                                                  34000039
320600                 PERFORM 2140-DESELECT-ALL-ITEMS                  34010039
320700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             34020039
320800                                                                  34030039
320900                     IF ASC-KEY-STATUS = '4'                      34040039
321000                         MOVE PC-TSYMSG-01316                     34050039
321100                                   TO DP020-MSG-NUMBER            34060039
321200                     ELSE                                         34070039
321300                         MOVE PC-TSYMSG-00768                     34080039
321400                                   TO DP020-MSG-NUMBER            34090039
321500                     END-IF                                       34100039
321600                 END-IF                                           34110039
321700             ELSE                                                 34120039
321800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             34130039
321900                 SET DP030-OVERRIDE-GO                            34140039
322000                     DP020-MSG-WARNING                            34150039
322100                                   TO TRUE                        34160039
322200                 MOVE PC-TSYMSG-00057                             34170039
322300                                   TO DP020-MSG-NUMBER            34180039
322400             END-IF                                               34190039
322500                                                                  34200039
322600         WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               34210039
322700             IF ASC-NUMBER-OF-SELECTED-ITEMS = 1                  34220039
322800                PERFORM 5000-PREPARE-SEL-QUEUE                    34230039
322900***XXX                                                            34240039
323000***XXX          PERFORM 2140-DESELECT-ALL-ITEMS                   34250039
323100***XXX          PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              34260039
323200***XXX                                                            34270039
323300             ELSE                                                 34280039
323400                 IF ASC-NUMBER-OF-SELECTED-ITEMS = 0              34290039
323500                    SET DP030-OVERRIDE-GO TO TRUE                 34300039
323600                    MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER     34310039
323700                    SET DP020-MSG-WARNING TO TRUE                 34320039
323800                 ELSE                                             34330039
323900                    SET DP030-OVERRIDE-GO TO TRUE                 34340039
324000                    MOVE PC-TSYMSG-00047  TO DP020-MSG-NUMBER     34350039
324100                    SET DP020-MSG-WARNING TO TRUE                 34360039
324200                 END-IF                                           34370039
324300             END-IF                                               34380039
324400                                                                  34390039
324500         WHEN OTHER                                               34400039
324600             SET DP013-NO-ROLLBACK                                34410039
324700                 DP013-XCTL-DISPLAY-RESTART                       34420039
324800                 DP013-CICS-ABEND  TO TRUE                        34430039
324900             MOVE '2100-CHECK-FUNCTION-KEY'                       34440039
325000                                   TO DP013-PARAGRAPH             34450039
325100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      34460039
325200                                   TO DP013-MESSAGE-TEXT (1)      34470039
325300             PERFORM DP013-0000-PROCESS-ABEND                     34480039
325400     END-EVALUATE.                                                34490039
325500*                                                                 34500039
325600*----------------------------------------------------------------*34510039
325700*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *34520039
325800*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *34530039
325900*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *34540039
326000*    MESSAGE.                                                    *34550039
326100*----------------------------------------------------------------*34560039
326200                                                                  34570039
326300 2110-BROWSE-BACKWARD.                                            34580039
326400     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    34590039
326500         GIVING PV-TOP-ITEM.                                      34600039
326600*                                                                 34610039
326700     IF  ((PV-TOP-ITEM < +1)                                      34620039
326800       OR (PV-TOP-ITEM = +1))                                     34630039
326900         MOVE +1                   TO PV-TOP-ITEM                 34640039
327000*        -- TOP OF LIST --                                        34650039
327100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            34660039
327200         SET DP020-MSG-INFORMATIONAL TO TRUE                      34670039
327300     END-IF.                                                      34680039
327400                                                                  34690039
327500 EJECT                                                            34700039
327600*----------------------------------------------------------------*34710039
327700*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *34720039
327800*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *34730039
327900*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *34740039
328000*----------------------------------------------------------------*34750039
328100                                                                  34760039
328200 2120-BROWSE-FORWARD.                                             34770039
328300                                                                  34780039
328400     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              34790039
328500         GIVING PV-TOP-ITEM.                                      34800039
328600     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   34810039
328700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            34820039
328800                                   TO PV-TOP-ITEM                 34830039
328900*        -- BOTTOM OF LIST --                                     34840039
329000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            34850039
329100         SET DP020-MSG-INFORMATIONAL                              34860039
329200                                   TO TRUE                        34870039
329300     ELSE                                                         34880039
329400         COMPUTE PV-BOTTOM-ITEM =                                 34890039
329500             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 34900039
329600         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            34910039
329700*            -- BOTTOM OF LIST --                                 34920039
329800             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            34930039
329900             SET DP020-MSG-INFORMATIONAL                          34940039
330000                                   TO TRUE                        34950039
330100         END-IF                                                   34960039
330200     END-IF.                                                      34970039
330300 EJECT                                                            34980039
330400*----------------------------------------------------------------*34990039
330500*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *35000039
330600*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *35010039
330700*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *35020039
330800*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *35030039
330900*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *35040039
331000*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *35050039
331100*----------------------------------------------------------------*35060039
331200                                                                  35070039
331300 2130-CHECK-FOR-JUMP-BROWSE.                                      35080039
331400     SET PS-NO-ERROR               TO TRUE.                       35090039
331500     IF (ASC-START-ITEM-REQUEST = SPACE)                          35100039
331600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            35110039
331700                                   TO PV-TOP-ITEM                 35120039
331800     ELSE                                                         35130039
331900         MOVE ASC-START-ITEM-REQUEST                              35140039
332000                                   TO DP010I-UNEDITED-FIELD       35150039
332100         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       35160039
332200         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     35170039
332300         SET DP010I-NEGATIVE-NOT-ALLOWED                          35180039
332400                                   TO TRUE                        35190039
264220         CALL DP010I-NUMERIC-EDIT-ROUTINE                         35201062
264230                         USING DP010I-NUMERIC-EDIT-AREA           35202062
332600                                                                  35210039
332700         IF  NOT DP010I-ERROR-DETECTED                            35220039
332800             MOVE DP010I-NUMERIC-FIELD                            35230039
332900                                   TO  ASC-START-ITEM-REQUEST-N   35240039
333000             IF  ASC-START-ITEM-REQUEST-N > ZERO                  35250039
333100                 IF  ASC-START-ITEM-REQUEST-N >                   35260039
333200                                          ASC-NUMBER-OF-ITEMS-READ35270039
333300                     MOVE SPACE TO ASC-START-ITEM-REQUEST         35280039
333400                     COMPUTE PV-TOP-ITEM =                        35290039
333500                             ASC-NUMBER-OF-ITEMS-READ             35300039
333600                             - PC-ITEMS-PER-PANEL + 1             35310039
333700                     IF  PV-TOP-ITEM < +1                         35320039
333800                         MOVE +1   TO PV-TOP-ITEM                 35330039
333900                         MOVE PC-TSYMSG-00070                     35340039
334000                                   TO DP020-MSG-NUMBER            35350039
334100                         SET DP020-MSG-INFORMATIONAL              35360039
334200                                   TO TRUE                        35370039
334300                     END-IF                                       35380039
334400                 ELSE                                             35390039
334500                     MOVE ASC-START-ITEM-REQUEST-N                35400039
334600                                   TO PV-TOP-ITEM                 35410039
334700                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      35420039
334800                     COMPUTE PV-BOTTOM-ITEM =                     35430039
334900                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     35440039
335000                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ35450039
335100*                        -- BOTTOM OF LIST --                     35460039
335200                         MOVE PC-TSYMSG-00070                     35470039
335300                                   TO DP020-MSG-NUMBER            35480039
335400                         SET DP020-MSG-INFORMATIONAL              35490039
335500                                   TO TRUE                        35500039
335600                     END-IF                                       35510039
335700                 END-IF                                           35520039
335800             ELSE                                                 35530039
335900*                --- VALUE OUT OF RANGE ----                      35540039
336000                 MOVE PC-TSYMSG-00101                             35550039
336100                                   TO DP020-MSG-NUMBER            35560039
336200                 MOVE -1           TO ASTRTITL                    35570039
336300                 SET DP030-SET-CURSOR-APPL-1                      35580039
336400                                   TO TRUE                        35590039
336500                 MOVE DP015-REVERSE                               35600039
336600                                   TO ASTRTITH                    35610039
336700                 MOVE DP015-RED    TO ASTRTITC                    35620039
336800                 MOVE DP015-UNP-NUM-BRT-MDT                       35630039
336900                                   TO ASTRTITA                    35640039
337000                 SET DP020-MSG-FATAL                              35650039
337100                                   TO TRUE                        35660039
337200                 SET PS-ERROR      TO TRUE                        35670039
337300             END-IF                                               35680039
337400                                                                  35690039
337500         ELSE                                                     35700039
337600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            35710039
337700             MOVE -1               TO ASTRTITL                    35720039
337800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  35730039
337900             MOVE DP015-REVERSE    TO ASTRTITH                    35740039
338000             MOVE DP015-RED        TO ASTRTITC                    35750039
338100             MOVE DP015-UNP-NUM-BRT-MDT                           35760039
338200                                   TO ASTRTITA                    35770039
338300             SET DP020-MSG-FATAL   TO TRUE                        35780039
338400             SET PS-ERROR          TO TRUE                        35790039
338500         END-IF                                                   35800039
338600     END-IF.                                                      35810039
338700 EJECT                                                            35820039
338800*----------------------------------------------------------------*35830039
338900*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *35840039
339000*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *35850039
339100*----------------------------------------------------------------*35860039
339200 2140-DESELECT-ALL-ITEMS.                                         35870039
339300     MOVE +1                       TO ASC-BLK-SUB.                35880039
339400                                                                  35890039
339500     PERFORM 2141-CLEAR-SELECTED-INDS                             35900039
339600         VARYING ASC-ITEM-SUB                                     35910039
339700         FROM 1 BY 1                                              35920039
339800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 35930039
339900                                                                  35940039
340000     ADD +1                        TO ASC-BLK-SUB.                35950039
340100                                                                  35960039
340200     PERFORM 2141-CLEAR-SELECTED-INDS                             35970039
340300         VARYING ASC-ITEM-SUB                                     35980039
340400         FROM 1 BY 1                                              35990039
340500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 36000039
340600                                                                  36010039
340700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               36020039
340800                                   TO PV-LIST-ITEM-NUMBER.        36030039
340900                                                                  36040039
341000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            36050039
341100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    36060039
341200                                                                  36070039
341300     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     36080039
341400        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      36090039
341500         MOVE +1                   TO ASC-BLK-SUB                 36100039
341600                                                                  36110039
341700         PERFORM 5100-WRITE-TEMP-STORAGE                          36120039
341800                                                                  36130039
341900         MOVE +1                   TO PV-BLOCK-NUMBER             36140039
342000                                                                  36150039
342100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         36160039
342200             PV-FIRST-BLOCK-IN-ARRAY - 1                          36170039
342300                                                                  36180039
342400         PERFORM                                                  36190039
342500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       36200039
342600                                                                  36210039
342700             PERFORM 4410-READ-TEMP-STORAGE                       36220039
342800                                                                  36230039
342900             PERFORM 2141-CLEAR-SELECTED-INDS                     36240039
343000                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 36250039
343100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          36260039
343200                                                                  36270039
343300             PERFORM 5100-WRITE-TEMP-STORAGE                      36280039
343400                                                                  36290039
343500             ADD +1                TO PV-BLOCK-NUMBER             36300039
343600                                                                  36310039
343700         END-PERFORM                                              36320039
343800                                                                  36330039
343900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         36340039
344000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     36350039
344100                                                                  36360039
344200         PERFORM                                                  36370039
344300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       36380039
344400                   ASC-HIGHEST-BLOCK-WRITTEN                      36390039
344500                                                                  36400039
344600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          36410039
344700                                   TO PV-BLOCK-NUMBER             36420039
344800                                                                  36430039
344900             PERFORM 4410-READ-TEMP-STORAGE                       36440039
345000                                                                  36450039
345100             PERFORM 2141-CLEAR-SELECTED-INDS                     36460039
345200                 VARYING ASC-ITEM-SUB                             36470039
345300                 FROM 1 BY 1                                      36480039
345400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          36490039
345500                                                                  36500039
345600             PERFORM 5100-WRITE-TEMP-STORAGE                      36510039
345700                                                                  36520039
345800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      36530039
345900                                                                  36540039
346000         END-PERFORM                                              36550039
346100                                                                  36560039
346200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             36570039
346300                                   TO PV-BLOCK-NUMBER             36580039
346400                                                                  36590039
346500         PERFORM 4410-READ-TEMP-STORAGE                           36600039
346600     END-IF.                                                      36610039
346700                                                                  36620039
346800                                                                  36630039
346900     MOVE +0                       TO ASC-NUMBER-OF-SELECTED-ITEMS36640039
347000     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.36650039
347100     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  36660039
347200                                                                  36670039
347300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        36680039
347400                                                                  36690039
347500 EJECT                                                            36700039
347600*----------------------------------------------------------------*36710039
347700*    MARK EACH ITEM AS BEING NOT SELECTED.                       *36720039
347800*----------------------------------------------------------------*36730039
347900                                                                  36740039
348000 2141-CLEAR-SELECTED-INDS.                                        36750039
348100                                                                  36760039
348200     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           36770039
348300             NOT EQUAL ZERO                                       36780039
348400         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          36790039
348500             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          36800039
348600                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    36810039
348700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  36820039
348800                                   TO TRUE                        36830039
348900         END-IF                                                   36840039
349000     END-IF.                                                      36850039
349100                                                                  36860039
349200 EJECT                                                            36870039
349300*----------------------------------------------------------------*36880039
349400*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *36890039
349500*  FOR ALL ITEMS.                                                *36900039
349600*----------------------------------------------------------------*36910039
349700                                                                  36920039
349800 2150-SELECT-ALL-ITEMS.                                           36930039
349900                                                                  36940039
350000     MOVE +1                       TO ASC-BLK-SUB.                36950039
350100                                                                  36960039
350200     PERFORM 2151-SET-SELECTED-INDS                               36970039
350300         VARYING ASC-ITEM-SUB                                     36980039
350400         FROM 1 BY 1                                              36990039
350500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 37000039
350600                                                                  37010039
350700     ADD +1                        TO ASC-BLK-SUB.                37020039
350800                                                                  37030039
350900     PERFORM 2151-SET-SELECTED-INDS                               37040039
351000         VARYING ASC-ITEM-SUB                                     37050039
351100         FROM 1 BY 1                                              37060039
351200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 37070039
351300                                                                  37080039
351400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               37090039
351500                                   TO PV-LIST-ITEM-NUMBER.        37100039
351600                                                                  37110039
351700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            37120039
351800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    37130039
351900                                                                  37140039
352000     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     37150039
352100        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    37160039
352200         MOVE +1                   TO ASC-BLK-SUB                 37170039
352300                                                                  37180039
352400         PERFORM 5100-WRITE-TEMP-STORAGE                          37190039
352500                                                                  37200039
352600         MOVE +1                   TO PV-BLOCK-NUMBER             37210039
352700                                                                  37220039
352800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         37230039
352900             PV-FIRST-BLOCK-IN-ARRAY - 1                          37240039
353000                                                                  37250039
353100         PERFORM                                                  37260039
353200             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       37270039
353300                                                                  37280039
353400             PERFORM 4410-READ-TEMP-STORAGE                       37290039
353500                                                                  37300039
353600             PERFORM 2151-SET-SELECTED-INDS                       37310039
353700                 VARYING ASC-ITEM-SUB                             37320039
353800                 FROM 1 BY 1                                      37330039
353900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          37340039
354000                                                                  37350039
354100             PERFORM 5100-WRITE-TEMP-STORAGE                      37360039
354200                                                                  37370039
354300             ADD +1                TO PV-BLOCK-NUMBER             37380039
354400                                                                  37390039
354500         END-PERFORM                                              37400039
354600                                                                  37410039
354700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         37420039
354800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     37430039
354900                                                                  37440039
355000         PERFORM                                                  37450039
355100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       37460039
355200                   ASC-HIGHEST-BLOCK-WRITTEN                      37470039
355300                                                                  37480039
355400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          37490039
355500                                   TO PV-BLOCK-NUMBER             37500039
355600                                                                  37510039
355700             PERFORM 4410-READ-TEMP-STORAGE                       37520039
355800                                                                  37530039
355900             PERFORM 2151-SET-SELECTED-INDS                       37540039
356000                 VARYING ASC-ITEM-SUB                             37550039
356100                 FROM 1 BY 1                                      37560039
356200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          37570039
356300                                                                  37580039
356400             PERFORM 5100-WRITE-TEMP-STORAGE                      37590039
356500                                                                  37600039
356600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      37610039
356700                                                                  37620039
356800         END-PERFORM                                              37630039
356900                                                                  37640039
357000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             37650039
357100                                   TO PV-BLOCK-NUMBER             37660039
357200                                                                  37670039
357300         PERFORM 4410-READ-TEMP-STORAGE                           37680039
357400     END-IF.                                                      37690039
357500                                                                  37700039
357600                                                                  37710039
357700     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             37720039
357800                       ASC-NUMBER-OF-SELECTED-ITEMS.              37730039
357900                                                                  37740039
358000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        37750039
358100                                                                  37760039
358200 EJECT                                                            37770039
358300*----------------------------------------------------------------*37780039
358400*    MARK EACH ITEM AS BEING SELECTED.                           *37790039
358500*----------------------------------------------------------------*37800039
358600                                                                  37810039
358700 2151-SET-SELECTED-INDS.                                          37820039
358800                                                                  37830039
358900     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           37840039
359000             NOT EQUAL ZERO                                       37850039
359100         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             37860039
359200             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             37870039
359300                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        37880039
359400                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  37890039
359500                               TO  TRUE                           37900039
359600         END-IF                                                   37910039
359700     END-IF.                                                      37920039
359800/                                                                 37930039
359900 2170-CHECK-RACF-ACCESS.                                          37940039
360000     SET DP008-RSRC-TYPE-FUNC     TO TRUE                         37950039
360100     MOVE 'PODCSPLT'              TO DP008-FUNCTION-NAME          37960039
360200     SET DP008-ACCESS-TYPE-USE    TO TRUE                         37970039
360300                                                                  37980039
360400     EXEC CICS                                                    37990039
360500        LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                  38000039
360600             COMMAREA (DP008-SECURITY-COMMAREA)                   38010039
360700             LENGTH (DP008-SECURITY-COMMAREA-LENGTH)              38020039
360800     END-EXEC                                                     38030039
360900                                                                  38040039
361000     IF DP008-CALL-SUCCESSFUL                                     38050039
361100         CONTINUE                                                 38060039
361200     ELSE                                                         38070039
361300        MOVE '2170-CHECK-RACF-ACCESS'                             38080039
361400                              TO DP013-PARAGRAPH                  38090039
361500         MOVE 'UNABLE TO ACCESS CICS'                             38100039
361600                              TO DP013-MESSAGE-TEXT (1)           38110039
361700         MOVE SQLCA           TO DP013-SQLCA                      38120039
361800         SET DP013-DB2-ABEND                                      38130039
361900             DP013-XCTL-DISPLAY-RESTART                           38140039
362000                              TO TRUE                             38150039
362100         PERFORM DP013-0000-PROCESS-ABEND                         38160039
362200     END-IF.                                                      38170039
362300                                                                  38180039
362400 EJECT                                                            38190039
362500******************************************************************38200039
362600** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **38210039
362700** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **38220039
362800******************************************************************38230039
362900 2200-MOVE-SCREEN-TO-COMMAREA.                                    38240039
363000                                                                  38250039
363100     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             38260039
363200     MOVE +1                       TO PV-SUB.                     38270039
363300*                                                                 38280039
363400     PERFORM 3100-SET-SUBSCRIPTS.                                 38290039
363500     IF  ASTRTITL > ZERO                                          38300039
363600         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          38310039
363700     ELSE                                                         38320039
363800         IF  ASTRTITF = DP015-ERASE-EOF                           38330039
363900             INITIALIZE ASC-START-ITEM-REQUEST                    38340039
364000         END-IF                                                   38350039
364100     END-IF.                                                      38360039
364200     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          38370039
364300         VARYING PV-SUB                                           38380039
364400         FROM 1 BY 1                                              38390039
364500         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      38400039
364600******************************************************************38410039
364700** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**38420039
364800******************************************************************38430039
364900 2210-MOVE-LINES-TO-COMMAREA.                                     38440039
365000     IF  MR-SELECTL (PV-SUB) > ZERO                               38450039
365100         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             38460039
365200         MOVE MR-SELECTI (PV-SUB)                                 38470039
365300                                   TO ASC-TEMP-SELECTED-SW        38480039
365400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      38490039
365500     ELSE                                                         38500039
365600         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                38510039
365700                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     38520039
365800                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        38530039
365900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      38540039
366000         END-IF                                                   38550039
366100     END-IF.                                                      38560039
366200     ADD +1                        TO ASC-ITEM-SUB.               38570039
366300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        38580039
366400         ADD +1                    TO ASC-BLK-SUB                 38590039
366500         MOVE +1                   TO ASC-ITEM-SUB                38600039
366600     END-IF.                                                      38610039
366700******************************************************************38620039
366800** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **38630039
366900** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **38640039
367000******************************************************************38650039
367100 3000-EDIT-DATA-IN-COMMAREA.                                      38660039
367200                                                                  38670039
367300     SET PS-NO-ERROR               TO TRUE.                       38680039
367400     PERFORM 3200-RESET-ATTRIBUTES.                               38690039
367500     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     38700039
367600**                                                                38710039
367700* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              38720039
367800* EDITTING IS DONE FROM THE BOTTOM UP.                            38730039
367900**                                                                38740039
368000     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       38750039
368100         ASC-ITEMS-DISPLAYED - 1.                                 38760039
368200     PERFORM 3100-SET-SUBSCRIPTS.                                 38770039
368300     PERFORM 3300-EDIT-SELECTIONS                                 38780039
368400         VARYING PV-SUB                                           38790039
368500         FROM PV-SUB BY -1                                        38800039
368600         UNTIL PV-SUB < +1                                        38810039
368700*                                                                 38820039
368800     IF  PS-NO-ERROR                                              38830039
368900         PERFORM 3400-CHECK-RANGE-SEQUENCE                        38840039
369000     END-IF.                                                      38850039
369100*                                                                 38860039
369200     IF  ((PS-NO-ERROR)                                           38870039
369300       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   38880039
369400       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    38890039
369500             PERFORM 3500-MARK-RANGE-AS-SELECTED                  38900039
369600     END-IF.                                                      38910039
369700                                                                  38920039
369800****** EDIT THE SELECTIONS ********                               38930039
369900                                                                  38940039
370000     MOVE ASC-ITEMS-DISPLAYED TO PV-SUB.                          38950039
370100     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       38960039
370200         ASC-ITEMS-DISPLAYED - 1.                                 38970039
370300     PERFORM 3100-SET-SUBSCRIPTS.                                 38980039
370400     IF DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)                     38990039
370500         PERFORM 3600-EDIT-RELEASE                                39000039
370600                 VARYING PV-SUB FROM PV-SUB BY -1                 39010039
370700                 UNTIL PV-SUB < +1                                39020039
370800     END-IF.                                                      39030039
370900                                                                  39040039
371000 EJECT                                                            39050039
371100*----------------------------------------------------------------*39060039
371200*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *39070039
371300*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*39080039
371400*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *39090039
371500*                                                                *39100039
371600*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *39110039
371700*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *39120039
371800*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *39130039
371900*    US IN THE 2ND BLOCK OF THE ARRAY.                           *39140039
372000*----------------------------------------------------------------*39150039
372100                                                                  39160039
372200 3100-SET-SUBSCRIPTS.                                             39170039
372300                                                                  39180039
372400     COMPUTE ASC-ITEM-SUB =                                       39190039
372500         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        39200039
372600                                                                  39210039
372700     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         39220039
372800         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            39230039
372900                                                                  39240039
373000         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               39250039
373100     ELSE                                                         39260039
373200         MOVE +1                     TO ASC-BLK-SUB               39270039
373300     END-IF.                                                      39280039
373400******************************************************************39290039
373500** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **39300039
373600******************************************************************39310039
373700                                                                  39320039
373800 3200-RESET-ATTRIBUTES.                                           39330039
373900     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   39340039
374000     MOVE DP015-GREEN              TO ASTRTITC.                   39350039
374100     MOVE DP015-UNDERLINE          TO ASTRTITH.                   39360039
374200                                                                  39370039
374300     PERFORM                                                      39380039
374400         VARYING PV-SUB                                           39390039
374500         FROM 1 BY 1                                              39400039
374600         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        39410039
374700         MOVE DP015-UNP-ALP-NOR-OFF                               39420039
374800                                   TO MR-SELECTA (PV-SUB)         39430039
374900         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         39440039
375000         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         39450039
375100     END-PERFORM.                                                 39460039
375200                                                                  39470039
375300******************************************************************39480039
375400** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **39490039
375500** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **39500039
375600** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **39510039
375700** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **39520039
375800******************************************************************39530039
375900 3300-EDIT-SELECTIONS.                                            39540039
376000     EVALUATE TRUE                                                39550039
376100         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     39560039
376200             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         39570039
376300                 CONTINUE                                         39580039
376400         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         39590039
376500             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        39600039
376600                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   39610039
376700                 MOVE ASC-TEMP-SELECTED-SW                        39620039
376800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39630039
376900                                TO ASC-SELECTED-SW                39640039
377000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39650039
377100             END-IF                                               39660039
377200         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     39670039
377300                 = SPACE                                          39680039
377400             EVALUATE TRUE                                        39690039
377500                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       39700039
377600                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS39710039
377700                     MOVE SPACE TO ASC-SELECTED-SW                39720039
377800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39730039
377900                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        39740039
378000                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    39750039
378100                     MOVE SPACE TO ASC-SELECTED-SW                39760039
378200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39770039
378300                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          39780039
378400                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      39790039
378500                     MOVE SPACE TO ASC-SELECTED-SW                39800039
378600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39810039
378700             END-EVALUATE                                         39820039
378800         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           39830039
378900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            39840039
379000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    39850039
379100             END-IF                                               39860039
379200             PERFORM 3310-EDIT-RANGE                              39870039
379300         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             39880039
379400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            39890039
379500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    39900039
379600             END-IF                                               39910039
379700             PERFORM 3310-EDIT-RANGE                              39920039
379800         WHEN OTHER                                               39930039
379900             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           39940039
380000             SET DP020-MSG-FATAL    TO TRUE                       39950039
380100             MOVE -1                TO MR-SELECTL (PV-SUB)        39960039
380200             SET DP030-SET-CURSOR-APPL-1                          39970039
380300                                    TO TRUE                       39980039
380400             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        39990039
380500             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        40000039
380600             SET PS-ERROR TO TRUE                                 40010039
380700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            40020039
380800                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     40030039
380900                 MOVE SPACE         TO ASC-SELECTED-SW            40040039
381000                                        (ASC-BLK-SUB ASC-ITEM-SUB)40050039
381100             END-IF                                               40060039
381200     END-EVALUATE.                                                40070039
381300                                                                  40080039
381400     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 40090039
381500     SUBTRACT +1 FROM ASC-ITEM-SUB.                               40100039
381600     IF  ASC-ITEM-SUB < 1                                         40110039
381700         SUBTRACT +1 FROM ASC-BLK-SUB                             40120039
381800         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                40130039
381900     END-IF.                                                      40140039
382000******************************************************************40150039
382100** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **40160039
382200** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **40170039
382300** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**40180039
382400** THE ENDING.                                                  **40190039
382500******************************************************************40200039
382600 3310-EDIT-RANGE.                                                 40210039
382700     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                40220039
382800         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   40230039
382900             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)40240039
383000                                   TO ASC-SELECTED-SW             40250039
383100                                        (ASC-BLK-SUB ASC-ITEM-SUB)40260039
383200             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 40270039
383300         ELSE                                                     40280039
383400             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     40290039
383500                 CONTINUE                                         40300039
383600             ELSE                                                 40310039
383700*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        40320039
383800                 MOVE PC-TSYMSG-00054                             40330039
383900                                   TO DP020-MSG-NUMBER            40340039
384000                 SET DP020-MSG-FATAL                              40350039
384100                                   TO TRUE                        40360039
384200                 MOVE -1           TO MR-SELECTL (PV-SUB)         40370039
384300                 SET DP030-SET-CURSOR-APPL-1                      40380039
384400                                   TO TRUE                        40390039
384500                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         40400039
384600                 MOVE DP015-UNDERLINE                             40410039
384700                                   TO MR-SELECTH (PV-SUB)         40420039
384800                 SET PS-ERROR      TO TRUE                        40430039
384900             END-IF                                               40440039
385000         END-IF                                                   40450039
385100     ELSE                                                         40460039
385200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     40470039
385300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 40480039
385400                                   TO ASC-SELECTED-SW             40490039
385500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   40500039
385600             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   40510039
385700         ELSE                                                     40520039
385800             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       40530039
385900                 CONTINUE                                         40540039
386000             ELSE                                                 40550039
386100*                -- ONLY ONE END-OF-RANGE ALLOWED --              40560039
386200                 MOVE PC-TSYMSG-00055                             40570039
386300                                   TO DP020-MSG-NUMBER            40580039
386400                 SET DP020-MSG-FATAL                              40590039
386500                                   TO TRUE                        40600039
386600                 MOVE -1           TO MR-SELECTL (PV-SUB)         40610039
386700                 SET DP030-SET-CURSOR-APPL-1                      40620039
386800                                   TO TRUE                        40630039
386900                 SET PS-ERROR      TO TRUE                        40640039
387000             END-IF                                               40650039
387100         END-IF                                                   40660039
387200     END-IF.                                                      40670039
387300*                                                                 40680039
387400******************************************************************40690039
387500** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **40700039
387600** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **40710039
387700******************************************************************40720039
387800                                                                  40730039
387900 3400-CHECK-RANGE-SEQUENCE.                                       40740039
388000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       40750039
388100       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      40760039
388200       AND  ASC-START-OF-SELECTED-RANGE >                         40770039
388300                                         ASC-END-OF-SELECTED-RANGE40780039
388400*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                40790039
388500         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 40800039
388600         SET DP020-MSG-FATAL TO TRUE                              40810039
388700         SET PS-ERROR TO TRUE                                     40820039
388800         PERFORM 3410-POSITION-AT-ERROR                           40830039
388900     END-IF.                                                      40840039
389000                                                                  40850039
389100******************************************************************40860039
389200** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **40870039
389300** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **40880039
389400** SHOULD BE POSITIONED ON A RANGE ERROR.                       **40890039
389500******************************************************************40900039
389600 3410-POSITION-AT-ERROR.                                          40910039
389700     SET DP030-SET-CURSOR-APPL-1                                  40920039
389800                                   TO TRUE.                       40930039
389900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 40940039
390000                    - PV-TOP-ITEM + 1.                            40950039
390100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      40960039
390200         CONTINUE                                                 40970039
390300     ELSE                                                         40980039
390400         MOVE -1                   TO MR-SELECTL (PV-SUB)         40990039
390500         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         41000039
390600         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         41010039
390700     END-IF.                                                      41020039
390800*                                                                 41030039
390900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   41040039
391000                    - PV-TOP-ITEM + 1.                            41050039
391100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      41060039
391200         CONTINUE                                                 41070039
391300     ELSE                                                         41080039
391400         MOVE -1                   TO MR-SELECTL (PV-SUB)         41090039
391500         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         41100039
391600         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         41110039
391700     END-IF.                                                      41120039
391800 EJECT                                                            41130039
391900*----------------------------------------------------------------*41140039
392000*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *41150039
392100*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *41160039
392200*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *41170039
392300*----------------------------------------------------------------*41180039
392400                                                                  41190039
392500 3500-MARK-RANGE-AS-SELECTED.                                     41200039
392600     MOVE +1                       TO  ASC-BLK-SUB.               41210039
392700     PERFORM 3510-MARK-SELECTED-INDS                              41220039
392800         VARYING ASC-ITEM-SUB                                     41230039
392900         FROM 1 BY 1                                              41240039
393000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 41250039
393100                                                                  41260039
393200     ADD +1                        TO ASC-BLK-SUB.                41270039
393300     PERFORM 3510-MARK-SELECTED-INDS                              41280039
393400         VARYING ASC-ITEM-SUB                                     41290039
393500         FROM 1 BY 1                                              41300039
393600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 41310039
393700                                                                  41320039
393800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               41330039
393900                                   TO  PV-LIST-ITEM-NUMBER.       41340039
394000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            41350039
394100         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         41360039
394200               PC-ITEMS-PER-PANEL).                               41370039
394300                                                                  41380039
394400     MOVE ASC-START-OF-SELECTED-RANGE                             41390039
394500                                   TO PV-START-OF-SELECTED-RANGE. 41400039
394600     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            41410039
394700         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  41420039
394800               PC-ITEMS-PER-PANEL).                               41430039
394900                                                                  41440039
395000     MOVE ASC-END-OF-SELECTED-RANGE                               41450039
395100                                   TO  PV-END-OF-SELECTED-RANGE.  41460039
395200     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             41470039
395300         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    41480039
395400               PC-ITEMS-PER-PANEL).                               41490039
395500     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             41500039
395600         PV-FIRST-BLOCK-IN-ARRAY + 1.                             41510039
395700                                                                  41520039
395800     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    41530039
395900        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        41540039
396000         MOVE +1                   TO ASC-BLK-SUB                 41550039
396100         PERFORM 5100-WRITE-TEMP-STORAGE                          41560039
396200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         41570039
396300             PV-FIRST-BLOCK-IN-ARRAY - 1                          41580039
396400                                                                  41590039
396500         PERFORM                                                  41600039
396600             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      41610039
396700                   PV-PREV-BLOCK-IN-ARRAY                         41620039
396800             MOVE PV-FIRST-BLOCK-IN-RANGE                         41630039
396900                                   TO PV-BLOCK-NUMBER             41640039
397000             PERFORM 4410-READ-TEMP-STORAGE                       41650039
397100             PERFORM 3510-MARK-SELECTED-INDS                      41660039
397200                 VARYING ASC-ITEM-SUB                             41670039
397300                 FROM 1 BY 1                                      41680039
397400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          41690039
397500             PERFORM 5100-WRITE-TEMP-STORAGE                      41700039
397600             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     41710039
397700         END-PERFORM                                              41720039
397800                                                                  41730039
397900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         41740039
398000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     41750039
398100         PERFORM                                                  41760039
398200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       41770039
398300                   PV-LAST-BLOCK-IN-RANGE                         41780039
398400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          41790039
398500                                   TO PV-BLOCK-NUMBER             41800039
398600             PERFORM 4410-READ-TEMP-STORAGE                       41810039
398700             PERFORM 3510-MARK-SELECTED-INDS                      41820039
398800                 VARYING ASC-ITEM-SUB                             41830039
398900                 FROM 1 BY 1                                      41840039
399000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          41850039
399100             PERFORM 5100-WRITE-TEMP-STORAGE                      41860039
399200             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      41870039
399300         END-PERFORM                                              41880039
399400                                                                  41890039
399500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             41900039
399600                                   TO PV-BLOCK-NUMBER             41910039
399700         PERFORM 4410-READ-TEMP-STORAGE                           41920039
399800     END-IF.                                                      41930039
399900                                                                  41940039
400000     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 41950039
400100                                      ASC-END-OF-SELECTED-RANGE.  41960039
400200                                                                  41970039
400300 EJECT                                                            41980039
400400*----------------------------------------------------------------*41990039
400500* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *42000039
400600*----------------------------------------------------------------*42010039
400700                                                                  42020039
400800 3510-MARK-SELECTED-INDS.                                         42030039
400900                                                                  42040039
401000     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         42050039
401100                                ASC-ITEM-SUB) >                   42060039
401200         ASC-START-OF-SELECTED-RANGE)                             42070039
401300     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         42080039
401400                                ASC-ITEM-SUB) =                   42090039
401500         ASC-START-OF-SELECTED-RANGE)                             42100039
401600                                                                  42110039
401700         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     42120039
401800                                    ASC-ITEM-SUB) <               42130039
401900             ASC-END-OF-SELECTED-RANGE)                           42140039
402000         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     42150039
402100                                    ASC-ITEM-SUB) =               42160039
402200             ASC-END-OF-SELECTED-RANGE)                           42170039
402300                                                                  42180039
402400             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          42190039
402500                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   42200039
402600                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   42210039
402700                               TO TRUE                            42220039
402800                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              42230039
402900                               TO TRUE                            42240039
403000                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    42250039
403100             END-IF                                               42260039
403200         END-IF                                                   42270039
403300     END-IF.                                                      42280039
403400                                                                  42290039
403500 EJECT                                                            42300039
403600                                                                  42310039
403700*----------------------------------------------------------------*42320039
403800 3600-EDIT-RELEASE.                                               42330039
403900                                                                  42340039
404000     EVALUATE TRUE                                                42350039
404100         WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)               42360039
404200             MOVE ASC-PO-NUMBER-N (ASC-BLK-SUB ASC-ITEM-SUB)      42370039
404300                                 TO DK-PO-NUMBER                  42380039
404400             MOVE ASC-ENT-ID (ASC-BLK-SUB ASC-ITEM-SUB)           42390039
404500                                 TO PURCHS-ENT-ID                 42400039
404600             MOVE ASC-NEW-STR-PO-IND (ASC-BLK-SUB ASC-ITEM-SUB)   42410039
404700                                 TO PURCHS-NEW-STR-PO-IND         42420039
404800             MOVE ASC-DPT (ASC-BLK-SUB ASC-ITEM-SUB)              42430039
404900                                 TO PURCHS-DEPT-NBR               42440039
405000                 SET PS-VALID-STATUS TO TRUE                      42450039
405100                                                                  42460039
405200             IF ASC-KEY-STATUS = '4'                              42470039
405300                IF  ASC-STATUS  (ASC-BLK-SUB ASC-ITEM-SUB) =      42480039
405400                 PC-MSG-F-READY-FOR-REL                           42490039
405500                  OR PC-MSG-S-RDY-RLSE-OUTR-PCK1                  42500039
405600                    SET PS-VALID-STATUS     TO TRUE               42510039
405700                ELSE                                              42520039
405800                    SET PS-INVALID-STATUS   TO TRUE               42530039
405900             ELSE                                                 42540039
406000                 PERFORM 4325-READY-FOR-RELEASE                   42550039
406100                                 THRU 4325-EXIT                   42560039
406200                 IF PS-SPLITS-OK                                  42570039
406300                    SET PS-SHOW-PO TO TRUE                        42580039
406400                    MOVE PC-MSG-F-READY-FOR-REL                   42590039
406500                                        TO PV-STATUS-TEXT         42600039
406600                 END-IF                                           42610039
406700             END-IF                                               42620039
406800                                                                  42630039
406900             IF PS-INVALID-STATUS                                 42640039
407000                 IF ASC-KEY-STATUS = '4'                          42650039
407100                     MOVE PC-TSYMSG-00168                         42660039
407200                                     TO DP020-MSG-NUMBER          42670039
407300                     MOVE -1     TO MR-SELECTL (PV-SUB)           42680039
407400                     MOVE DP015-RED TO MR-SELECTC (PV-SUB)        42690039
407500                     MOVE DP015-REVERSE                           42700039
407600                                     TO MR-SELECTH (PV-SUB)       42710039
407700                     SET PS-ERROR                                 42720039
407800                         DP020-MSG-FATAL                          42730039
407900                         DP030-SET-CURSOR-APPL-1                  42740039
408000                                     TO TRUE                      42750039
408100                 ELSE                                             42760039
408200                     MOVE PC-TSYMSG-00754                         42770039
408300                                     TO DP020-MSG-NUMBER          42780039
408400                     MOVE -1     TO MR-SELECTL (PV-SUB)           42790039
408500                     MOVE DP015-RED TO MR-SELECTC (PV-SUB)        42800039
408600                     MOVE DP015-REVERSE                           42810039
408700                                     TO MR-SELECTH (PV-SUB)       42820039
408800                     SET PS-ERROR                                 42830039
408900                         DP020-MSG-FATAL                          42840039
409000                         DP030-SET-CURSOR-APPL-1                  42850039
409100                                     TO TRUE                      42860039
409200                 END-IF                                           42870039
409300             ELSE                                                 42880039
409400                 PERFORM 3700-CHECK-STORE-DC                      42890039
409500                 IF PS-INVALID-STATUS                             42900039
409600                     MOVE PC-TSYMSG-00748                         42910039
409700                                   TO DP020-MSG-NUMBER            42920039
409800                     MOVE -1       TO MR-SELECTL (PV-SUB)         42930039
409900                     MOVE DP015-RED                               42940039
410000                                   TO MR-SELECTC (PV-SUB)         42950039
410100                     MOVE DP015-REVERSE                           42960039
410200                                   TO MR-SELECTH (PV-SUB)         42970039
410300                     SET PS-ERROR                                 42980039
410400                         DP020-MSG-FATAL                          42990039
410500                         DP030-SET-CURSOR-APPL-1                  43000039
410600                                   TO TRUE                        43010039
410700                 ELSE                                             43020039
410800                     MOVE '*'          TO MR-REL (PV-SUB)         43030039
410900                                          ASC-REL                 43040039
411000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   43050039
411100                 END-IF                                           43060039
411200             END-IF                                               43070039
411300     END-EVALUATE.                                                43080039
411400                                                                  43090039
411500     SUBTRACT +1 FROM PV-ITEM-IN-USE                              43100039
411600                      ASC-ITEM-SUB.                               43110039
411700                                                                  43120039
411800     IF ASC-ITEM-SUB < 1                                          43130039
411900         SUBTRACT +1 FROM ASC-BLK-SUB                             43140039
412000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  43150039
412100     END-IF.                                                      43160039
412200                                                                  43170039
412300*----------------------------------------------------------------*43180039
412400* VALIDATE THAT THE STORE/DC RELATIONSHIP IS STILL VALID.        *43190039
412500*----------------------------------------------------------------*43200039
412600 3700-CHECK-STORE-DC.                                             43210039
412700                                                                  43220039
412800     SET ASC-ITEMS-LEFT-ON-DB                                     43230039
412900         PS-VALID-STATUS                                          43240039
413000                             TO TRUE.                             43250039
413100     PERFORM 3710-OPEN-STORE-CSR.                                 43260039
413200     PERFORM 3720-FETCH-STORE-CSR                                 43270039
413300             UNTIL ASC-NO-ITEMS-LEFT-ON-DB                        43280039
413400                   OR PS-INVALID-STATUS.                          43290039
413500     PERFORM 3730-CLOSE-STORE-CSR.                                43300039
413600                                                                  43310039
413700*----------------------------------------------------------------*43320039
413800*                                                                *43330039
413900*----------------------------------------------------------------*43340039
414000 3710-OPEN-STORE-CSR.                                             43350039
414100                                                                  43360039
414200     PERFORM                                                      43370039
414300         WITH TEST AFTER                                          43380039
414400         VARYING PV-RETRY-COUNTER                                 43390039
414500         FROM 1 BY 1                                              43400039
414600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43410039
414700                   OR (SQLCODE = ZERO))                           43420039
414800         EXEC SQL                                                 43430039
414900              OPEN STORE-CSR                                      43440039
415000         END-EXEC                                                 43450039
415100                                                                  43460039
415200         EVALUATE TRUE                                            43470039
415300             WHEN SQLCODE = ZERO                                  43480039
415400             WHEN SQLCODE = -904                                  43490039
415500             WHEN SQLCODE = -913                                  43500039
415600                 CONTINUE                                         43510039
415700             WHEN SQLWARN0 NOT = SPACES                           43520039
415800             WHEN SQLCODE < ZERO                                  43530039
415900             WHEN SQLCODE > ZERO                                  43540039
416000                 MOVE '3710-OPEN-STORE-CSR'                       43550039
416100                                   TO DP013-PARAGRAPH             43560039
416200                 MOVE 'OPEN STORE CURSOR'                         43570039
416300                                   TO DP013-MESSAGE-TEXT (1)      43580039
416400                 MOVE SQLCA        TO DP013-SQLCA                 43590039
416500                 MOVE 'TMESTDS '   TO DP013-DB2-TABLE-NAME (1)    43600039
416600                 MOVE 'TALLPLN '   TO DP013-DB2-TABLE-NAME (2)    43610039
416700                 MOVE 'XMT_LOC '   TO DP013-DB2-TABLE-NAME (3)    43620039
416800                 SET DP013-DB2-ABEND                              43630039
416900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           43640039
417000                 PERFORM DP013-0000-PROCESS-ABEND                 43650039
417100         END-EVALUATE                                             43660039
417200     END-PERFORM.                                                 43670039
417300*                                                                 43680039
417400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        43690039
417500         MOVE '3710-OPEN-STORE-CSR' TO DP013-PARAGRAPH            43700039
417600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   43710039
417700                                   TO DP013-MESSAGE-TEXT (1)      43720039
417800         MOVE SQLCA                TO DP013-SQLCA                 43730039
417900         MOVE 'TMESTDS '           TO DP013-DB2-TABLE-NAME (1)    43740039
418000         MOVE 'TALLPLN '           TO DP013-DB2-TABLE-NAME (2)    43750039
418100         MOVE 'XMT_LOC '           TO DP013-DB2-TABLE-NAME (3)    43760039
418200         SET DP013-DB2-ABEND                                      43770039
418300             DP013-XCTL-DISPLAY-RESTART                           43780039
418400                                   TO TRUE                        43790039
418500         PERFORM DP013-0000-PROCESS-ABEND                         43800039
418600     END-IF.                                                      43810039
418700*----------------------------------------------------------------*43820039
418800*                                                                *43830039
418900*----------------------------------------------------------------*43840039
419000 3720-FETCH-STORE-CSR.                                            43850039
419100     EXEC SQL                                                     43860039
419200          FETCH STORE-CSR                                         43870039
419300           INTO                                                   43880039
419400                :ALLPLN-DEST-NBR,                                 43890039
419500                :MESTDS-STR-NBR,                                  43900039
419600                :PLNSHP-DONT-SHIP-BEF-DTE                         43910039
419700     END-EXEC                                                     43920039
419800                                                                  43930039
419900     EVALUATE TRUE                                                43940039
420000         WHEN SQLCODE = ZERO                                      43950039
420100         WHEN SQLCODE = +100                                      43960039
420200              CONTINUE                                            43970039
420300         WHEN SQLWARN0 NOT = SPACE                                43980039
420400         WHEN SQLCODE NOT = ZERO                                  43990039
420500              MOVE '3720-FETCH-STORE-CSR'                         44000039
420600                               TO DP013-PARAGRAPH                 44010039
420700              MOVE 'FETCH STORE-CURSOR'                           44020039
420800                               TO DP013-MESSAGE-TEXT (1)          44030039
420900              MOVE SQLCA       TO DP013-SQLCA                     44040039
421000              SET DP013-DB2-ABEND                                 44050039
421100                               TO TRUE                            44060039
421200              PERFORM DP013-0000-PROCESS-ABEND                    44070039
421300     END-EVALUATE.                                                44080039
421400                                                                  44090039
421500     IF  SQLCODE EQUAL +100                                       44100039
421600         SET ASC-NO-ITEMS-LEFT-ON-DB                              44110039
421700                                   TO TRUE                        44120039
421800     ELSE                                                         44130039
421900         SET PS-VALID-STATUS       TO TRUE                        44140039
422000         PERFORM 3725-VALIDATE-DC                                 44150039
422100         IF PS-INVALID-STATUS                                     44160039
422200             MOVE PC-TSYMSG-00755  TO DP020-MSG-NUMBER            44170039
422300             MOVE -1               TO MR-SELECTL (PV-SUB)         44180039
422400             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         44190039
422500             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         44200039
422600             SET PS-ERROR                                         44210039
422700                 DP020-MSG-FATAL                                  44220039
422800                 DP030-SET-CURSOR-APPL-1                          44230039
422900                                   TO TRUE                        44240039
423000         END-IF                                                   44250039
423100     END-IF.                                                      44260039
423200*----------------------------------------------------------------*44270039
423300*                                                                *44280039
423400*----------------------------------------------------------------*44290039
423500 3725-VALIDATE-DC.                                                44300039
423600                                                                  44310039
423700     MOVE +0                       TO PV-DB2-COUNT1               44320039
423800                                      PV-DB2-COUNT2.              44330039
423900                                                                  44340039
424000     PERFORM                                                      44350039
424100         WITH TEST AFTER                                          44360039
424200         VARYING PV-RETRY-COUNTER                                 44370039
424300         FROM 1 BY 1                                              44380039
424400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               44390039
424500                   OR (SQLCODE = ZERO))                           44400039
424600         IF PURCHS-NEW-STR-PO-IND = PC-Y                          44410039
424700             EXEC SQL                                             44420039
424800             SELECT  COUNT (*)                                    44430039
424900                INTO :PV-DB2-COUNT1                               44440039
425000                FROM XMT_DC_LOC_ASGMT DLA1                        44450039
425100               WHERE DLA1.LOC_NBR = :MESTDS-STR-NBR               44460039
425200                 AND DLA1.DC_NBR  = :ALLPLN-DEST-NBR              44470039
425300                 AND DLA1.PO_STRT_DTE =                           44480039
425400                    (SELECT MAX(PO_STRT_DTE)                      44490039
425500                       FROM XMT_DC_LOC_ASGMT DLA2                 44500039
425600                      WHERE DLA2.PO_STRT_DTE <=                   44510039
425700                           :PLNSHP-DONT-SHIP-BEF-DTE              44520039
425800                        AND DLA1.LOC_NBR = DLA2.LOC_NBR)          44530039
425900*                AND DLA1.LOC_NBR NOT IN                          44540061
426000*                    ( SELECT A.LOC_NBR                           44550061
426100*                      FROM   XMT_LOC A                           44560061
426200*                            ,TSTVNDC B                           44570061
426300*                      WHERE A.LOC_NBR = B.STR_NBR                44580061
426400*                        AND ENT_ID = :PURCHS-ENT-ID              44590061
426500*                        AND (DEPT_NBR = '999'                    44600061
426600*                             OR DEPT_NBR = :PURCHS-DEPT-NBR)     44610061
426700*                        AND (:PLNSHP-DONT-SHIP-BEF-DTE BETWEEN   44620061
426800*                               EFF_BEG_DTE AND EFF_END_DTE ))    44630061
426900             END-EXEC                                             44640039
427000         ELSE                                                     44650039
427100             EXEC SQL                                             44660039
427200             SELECT  COUNT (*)                                    44670039
427300                INTO :PV-DB2-COUNT1                               44680039
427400                FROM XMT_DC_LOC_ASGMT DLA1                        44690039
427500               WHERE DLA1.LOC_NBR = :MESTDS-STR-NBR               44700039
427600                 AND DLA1.DC_NBR  = :ALLPLN-DEST-NBR              44710039
427700                 AND DLA1.PO_STRT_DTE =                           44720039
427800                    (SELECT MAX(PO_STRT_DTE)                      44730039
427900                       FROM XMT_DC_LOC_ASGMT DLA2                 44740039
428000                      WHERE DLA2.PO_STRT_DTE <=                   44750039
428100                           :PLNSHP-DONT-SHIP-BEF-DTE              44760039
428200                        AND DLA1.LOC_NBR = DLA2.LOC_NBR)          44770039
428300             END-EXEC                                             44780039
428400         END-IF                                                   44790039
428500                                                                  44800039
428600         EVALUATE TRUE                                            44810039
428700                 WHEN SQLCODE = +0                                44820039
428800                 WHEN SQLCODE = +100                              44830039
428900                 WHEN SQLCODE = -305                              44840039
429000                      CONTINUE                                    44850039
429100                 WHEN SQLCODE = -904                              44860039
429200                 WHEN SQLCODE = -913                              44870039
429300                     CONTINUE                                     44880039
429400                 WHEN SQLWARN0 NOT = SPACES                       44890039
429500                 WHEN SQLCODE < ZERO                              44900039
429600                 WHEN SQLCODE > ZERO                              44910039
429700                     MOVE '3650-CHECK-STORES'                     44920039
429800                                   TO DP013-PARAGRAPH             44930039
429900                     MOVE '              '                        44940039
430000                                   TO DP013-MESSAGE-TEXT (1)      44950039
430100                     MOVE SQLCA    TO DP013-SQLCA                 44960039
430200                     MOVE 'XMT_LOC ' TO DP013-DB2-TABLE-NAME (1)  44970039
430300                     SET DP013-DB2-ABEND                          44980039
430400                         DP013-XCTL-DISPLAY-RESTART TO TRUE       44990039
430500                     PERFORM DP013-0000-PROCESS-ABEND             45000039
430600             END-EVALUATE                                         45010039
430700     END-PERFORM.                                                 45020039
430800*                                                                 45030039
430900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        45040039
431000         MOVE '3725-VALIDATE-DC' TO DP013-PARAGRAPH               45050039
431100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO GET XMT_LOC'45060039
431200                                   TO DP013-MESSAGE-TEXT (1)      45070039
431300         MOVE SQLCA                TO DP013-SQLCA                 45080039
431400         MOVE 'XMT_LOC '           TO DP013-DB2-TABLE-NAME (1)    45090039
431500         SET DP013-DB2-ABEND                                      45100039
431600             DP013-XCTL-DISPLAY-RESTART                           45110039
431700                                   TO TRUE                        45120039
431800         PERFORM DP013-0000-PROCESS-ABEND                         45130039
431900     END-IF.                                                      45140039
432000*                                                                 45150039
432100     IF PURCHS-NEW-STR-PO-IND = PC-Y                              45160039
432200         MOVE 0 TO PV-DB2-COUNT2                                  45170061
432200     END-IF.                                                      45170161
432200*        PERFORM                                                  45171061
432300*            WITH TEST AFTER                                      45180061
432400*            VARYING PV-RETRY-COUNTER                             45190061
432500*            FROM 1 BY 1                                          45200061
432600*            UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)           45210061
432700*                      OR (SQLCODE = ZERO))                       45220061
432800*            EXEC SQL                                             45230061
432900*                SELECT COUNT (*)                                 45240061
433000*                   INTO :PV-DB2-COUNT2                           45250061
433100*                   FROM XMT_LOC A                                45260061
433200*                       ,TSTVNDC B                                45270061
433300*                  WHERE LOC_NBR = :MESTDS-STR-NBR                45280061
433400*                    AND A.LOC_NBR = B.STR_NBR                    45290061
433500*                    AND ENT_ID = :PURCHS-ENT-ID                  45300061
433600*                    AND (DEPT_NBR = '999'                        45310061
433700*                         OR DEPT_NBR = :PURCHS-DEPT-NBR)         45320061
433800*                    AND SHIP_TO_TMP_DC_NBR = :ALLPLN-DEST-NBR    45330061
433900*                    AND :PLNSHP-DONT-SHIP-BEF-DTE BETWEEN        45340061
434000*                         EFF_BEG_DTE AND EFF_END_DTE             45350061
434100*            END-EXEC                                             45360061
434200*                                                                 45370061
434300*            EVALUATE TRUE                                        45380061
434400*                    WHEN SQLCODE = +0                            45390061
434500*                    WHEN SQLCODE = +100                          45400061
434600*                    WHEN SQLCODE = -305                          45410061
434700*                        CONTINUE                                 45420061
434800*                    WHEN SQLCODE = -904                          45430061
434900*                    WHEN SQLCODE = -913                          45440061
435000*                        CONTINUE                                 45450061
435100*                    WHEN SQLWARN0 NOT = SPACES                   45460061
435200*                    WHEN SQLCODE < ZERO                          45470061
435300*                    WHEN SQLCODE > ZERO                          45480061
435400*                        MOVE '3725-VALIDATE-DC'                  45490061
435500*                                      TO DP013-PARAGRAPH         45500061
435600*                        MOVE SPACES   TO DP013-MESSAGE-TEXT (1)  45510061
435700*                        MOVE SQLCA    TO DP013-SQLCA             45520061
435800*                      MOVE 'XMT_LOC ' TO DP013-DB2-TABLE-NAME (1)45530061
435900*                      MOVE 'TSTVNDC ' TO DP013-DB2-TABLE-NAME (2)45540061
436000*                        SET DP013-DB2-ABEND                      45550061
436100*                            DP013-XCTL-DISPLAY-RESTART TO TRUE   45560061
436200*                        PERFORM DP013-0000-PROCESS-ABEND         45570061
436300*                END-EVALUATE                                     45580061
436400*        END-PERFORM                                              45590061
436500*                                                                 45600039
436600*        IF PV-RETRY-COUNTER > PC-MAX-RETRIES                     45610061
436700*            MOVE '3725-VALIDATE-DC' TO DP013-PARAGRAPH           45620061
436800*            MOVE 'MAXIMUM RETRIES EXCEEDED'                      45630061
436900*                                  TO DP013-MESSAGE-TEXT (1)      45640061
437000*            MOVE SQLCA            TO DP013-SQLCA                 45650061
437100*            MOVE 'XMT_LOC '       TO DP013-DB2-TABLE-NAME (1)    45660061
437200*            SET DP013-DB2-ABEND                                  45670061
437300*                DP013-XCTL-DISPLAY-RESTART                       45680061
437400*                                  TO TRUE                        45690061
437500*            PERFORM DP013-0000-PROCESS-ABEND                     45700061
437600*        END-IF                                                   45710061
437700*    END-IF.                                                      45720061
437800*                                                                 45730039
437900     IF PV-DB2-COUNT1 = 0                                         45740039
438000       AND PV-DB2-COUNT2 = 0                                      45750039
438100         SET PS-INVALID-STATUS     TO TRUE                        45760039
438200     END-IF.                                                      45770039
438300*----------------------------------------------------------------*45780039
438400*                                                                *45790039
438500*----------------------------------------------------------------*45800039
438600 3730-CLOSE-STORE-CSR.                                            45810039
438700     EXEC SQL                                                     45820039
438800          CLOSE STORE-CSR                                         45830039
438900     END-EXEC.                                                    45840039
439000*                                                                 45850039
439100     EVALUATE TRUE                                                45860039
439200         WHEN SQLCODE = ZERO                                      45870039
439300             CONTINUE                                             45880039
439400         WHEN SQLWARN0 NOT = SPACES                               45890039
439500         WHEN SQLCODE < ZERO                                      45900039
439600         WHEN SQLCODE > ZERO                                      45910039
439700             MOVE '3730-CLOSE-STORE-CSR'                          45920039
439800                               TO DP013-PARAGRAPH                 45930039
439900             MOVE 'CLOSE STORE CURSOR'                            45940039
440000                               TO DP013-MESSAGE-TEXT (1)          45950039
440100             MOVE SQLCA        TO DP013-SQLCA                     45960039
440200             MOVE 'TMESTDS '   TO DP013-DB2-TABLE-NAME (1)        45970039
440300             MOVE 'TALLPLN '   TO DP013-DB2-TABLE-NAME (2)        45980039
440400             MOVE 'XMT_LOC '   TO DP013-DB2-TABLE-NAME (3)        45990039
440500             SET DP013-DB2-ABEND                                  46000039
440600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               46010039
440700             PERFORM DP013-0000-PROCESS-ABEND                     46020039
440800     END-EVALUATE.                                                46030039
440900*----------------------------------------------------------------*46040039
441000*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *46050039
441100*    INITIALIZE ALL COUNTERS AND FLAGS.                          *46060039
441200*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *46070039
441300*    DISPLAY THE PANEL TO USER.                                  *46080039
441400*----------------------------------------------------------------*46090039
441500                                                                  46100039
441600 4000-BUILD-INITIAL-PANEL.                                        46110039
441700                                                                  46120039
441800     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            46130039
441900                                 ASC-BLOCK-ENTRIES (2).           46140039
442000     MOVE +1                 TO ASC-BLK-SUB.                      46150039
442100     SET ASC-ITEMS-LEFT-ON-DB                                     46160039
442200                             TO TRUE.                             46170039
442300                                                                  46180039
442400     MOVE +0                 TO ASC-ITEM-SUB                      46190039
442500                                ASC-NUMBER-OF-ITEMS-READ          46200039
442600                                ASC-NUMBER-OF-SELECTED-ITEMS      46210039
442700                                ASC-HIGHEST-BLOCK-WRITTEN         46220039
442800                                ASC-START-OF-SELECTED-RANGE       46230039
442900                                ASC-END-OF-SELECTED-RANGE         46240039
443000                                ASC-ITEM-AT-TOP-OF-PANEL.         46250039
443100                                                                  46260039
443200     PERFORM 4100-PREPARE-CURSOR                                  46270039
443300                                                                  46280039
443400     PERFORM 4010-OPEN-CURSOR.                                    46290039
443500                                                                  46300039
443600     PERFORM 4300-READ-ITEMS-FROM-DB.                             46310039
443700                                                                  46320039
443800     PERFORM 4020-CLOSE-CURSOR.                                   46330039
443900                                                                  46340039
444000     MOVE +1                   TO  PV-TOP-ITEM.                   46350039
444100     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          46360039
444200         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    46370039
444300         SET DP020-MSG-FATAL   TO  TRUE                           46380039
444400         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               46390039
444500     ELSE                                                         46400039
444600         MOVE -1               TO MR-SELECTL (1)                  46410039
444700         SET DP030-SET-CURSOR-APPL-1                              46420039
444800                               TO TRUE                            46430039
444900         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     46440039
445000     END-IF.                                                      46450039
445100 EJECT                                                            46460039
445200*----------------------------------------------------------------*46470039
445300*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *46480039
445400*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *46490039
445500*   USER.                                                        *46500039
445600*----------------------------------------------------------------*46510039
445700                                                                  46520039
445800 4010-OPEN-CURSOR.                                                46530039
445900     IF ASC-KEY-STATUS = '4'                                      46540039
446000         EXEC SQL                                                 46550039
446100             SELECT DISTINCT                                      46560039
446200                 CURRENT_TIMESTAMP + 2 DAYS                       46570039
446300                                   + :DK-RLSE-DAYS DAYS           46580039
446400                 INTO :DK-DB2-TMST                                46590039
446500                 FROM TCOCNTL                                     46600039
446600         END-EXEC                                                 46610039
446700                                                                  46620039
446800         EXEC SQL                                                 46630039
446900             SELECT DISTINCT                                      46640042
447000                 CURRENT_TIMESTAMP + 4 DAYS                       46650039
447100                                   + :DK-RLSE-DAYS DAYS           46660039
447200                 INTO :DK-DB2-SHIP-TMST                           46670039
447300                 FROM TCOCNTL                                     46680039
447400         END-EXEC                                                 46690039
447500                                                                  46700039
447600         EXEC SQL                                                 46710039
447700             SELECT DISTINCT                                      46720039
447800                 CURRENT_TIMESTAMP - 60 DAYS                      46730039
447900                 INTO :DK-DB2-TMST-LOW                            46740039
448000                 FROM TCOCNTL                                     46750039
448100         END-EXEC                                                 46760039
448200                                                                  46770039
448300         MOVE DK-DB2-TMST TO DK-DB2-DATE                          46780039
448400         MOVE DK-DB2-SHIP-TMST TO DK-DB2-SHIP-DATE                46790039
448500         MOVE DK-DB2-TMST-LOW TO DK-DB2-DATE-LOW                  46800039
448600     END-IF.                                                      46810039
448700                                                                  46820039
448800     PERFORM                                                      46830039
448900         WITH TEST AFTER                                          46840039
449000         VARYING PV-RETRY-COUNTER                                 46850039
449100         FROM 1 BY 1                                              46860039
449200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               46870039
449300                   OR (SQLCODE = ZERO))                           46880039
449400         EVALUATE TRUE                                            46890039
449500             WHEN ASC-CURSOR1                                     46900039
449600                 MOVE 'CURSOR:  CURSOR1'                          46910039
449700                                   TO DP013-MESSAGE-TEXT (2)      46920039
449800                 EXEC SQL                                         46930039
449900                      OPEN CURSOR1                                46940039
450000                 END-EXEC                                         46950039
450100                                                                  46960039
450200             WHEN ASC-CURSOR2                                     46970039
450300                 MOVE 'CURSOR:  CURSOR2'                          46980039
450400                                   TO DP013-MESSAGE-TEXT (2)      46990039
450500                 EXEC SQL                                         47000039
450600                      OPEN CURSOR2                                47010039
450700                 END-EXEC                                         47020039
450800                                                                  47030039
450900             WHEN ASC-CURSOR3                                     47040039
451000                 MOVE 'CURSOR:  CURSOR3'                          47050039
451100                                   TO DP013-MESSAGE-TEXT (2)      47060039
451200                 EXEC SQL                                         47070039
451300                      OPEN CURSOR3                                47080039
451400                 END-EXEC                                         47090039
451500                                                                  47100039
451600             WHEN ASC-CURSOR4                                     47110039
451700                 MOVE 'CURSOR:  CURSOR4'                          47120039
451800                                   TO DP013-MESSAGE-TEXT (2)      47130039
451900                                                                  47140039
452000                 EXEC SQL                                         47150039
452100                      OPEN CURSOR4                                47160039
452200                 END-EXEC                                         47170039
452300                                                                  47180039
452400             WHEN ASC-CURSOR5                                     47190039
452500                 MOVE 'CURSOR:  CURSOR5'                          47200039
452600                                   TO DP013-MESSAGE-TEXT (2)      47210039
452700                 EXEC SQL                                         47220039
452800                      OPEN CURSOR5                                47230039
452900                 END-EXEC                                         47240039
453000                                                                  47250039
453100             WHEN ASC-CURSOR6                                     47260039
453200                 MOVE 'CURSOR:  CURSOR6'                          47270039
453300                                   TO DP013-MESSAGE-TEXT (2)      47280039
453400                 EXEC SQL                                         47290039
453500                      OPEN CURSOR6                                47300039
453600                 END-EXEC                                         47310039
453700         END-EVALUATE                                             47320039
453800                                                                  47330039
453900         EVALUATE TRUE                                            47340039
454000             WHEN SQLCODE = ZERO                                  47350039
454100             WHEN SQLCODE = -904                                  47360039
454200             WHEN SQLCODE = -913                                  47370039
454300                 CONTINUE                                         47380039
454400             WHEN SQLWARN0 NOT = SPACES                           47390039
454500             WHEN SQLCODE < ZERO                                  47400039
454600             WHEN SQLCODE > ZERO                                  47410039
454700                 MOVE '4010-OPEN-CURSOR'                          47420039
454800                                   TO DP013-PARAGRAPH             47430039
454900                 MOVE 'OPEN CURSOR - '                            47440039
455000                                   TO DP013-MESSAGE-TEXT (1)      47450039
455100                 MOVE SQLCA        TO DP013-SQLCA                 47460039
455200                 MOVE 'TPURCHS '   TO DP013-DB2-TABLE-NAME (1)    47470039
455300                 SET DP013-DB2-ABEND                              47480039
455400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           47490039
455500                 PERFORM DP013-0000-PROCESS-ABEND                 47500039
455600         END-EVALUATE                                             47510039
455700     END-PERFORM.                                                 47520039
455800*                                                                 47530039
455900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        47540039
456000         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             47550039
456100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   47560039
456200                                   TO DP013-MESSAGE-TEXT (1)      47570039
456300         MOVE SQLCA                TO DP013-SQLCA                 47580039
456400         MOVE 'TPURCHS '           TO DP013-DB2-TABLE-NAME (1)    47590039
456500         SET DP013-DB2-ABEND                                      47600039
456600             DP013-XCTL-DISPLAY-RESTART                           47610039
456700                                   TO TRUE                        47620039
456800         PERFORM DP013-0000-PROCESS-ABEND                         47630039
456900     END-IF.                                                      47640039
457000                                                                  47650039
457100 EJECT                                                            47660039
457200*----------------------------------------------------------------*47670039
457300* CLOSE THE TMESSAGE CURSOR.                                     *47680039
457400*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *47690039
457500*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *47700039
457600*   USER.                                                        *47710039
457700*----------------------------------------------------------------*47720039
457800                                                                  47730039
457900 4020-CLOSE-CURSOR.                                               47740039
458000     EVALUATE TRUE                                                47750039
458100         WHEN ASC-CURSOR1                                         47760039
458200             EXEC SQL                                             47770039
458300                 CLOSE CURSOR1                                    47780039
458400             END-EXEC                                             47790039
458500                                                                  47800039
458600         WHEN ASC-CURSOR2                                         47810039
458700             EXEC SQL                                             47820039
458800                 CLOSE CURSOR2                                    47830039
458900             END-EXEC                                             47840039
459000                                                                  47850039
459100         WHEN ASC-CURSOR3                                         47860039
459200             EXEC SQL                                             47870039
459300                 CLOSE CURSOR3                                    47880039
459400             END-EXEC                                             47890039
459500                                                                  47900039
459600         WHEN ASC-CURSOR4                                         47910039
459700             EXEC SQL                                             47920039
459800                 CLOSE CURSOR4                                    47930039
459900             END-EXEC                                             47940039
460000                                                                  47950039
460100         WHEN ASC-CURSOR5                                         47960039
460200             EXEC SQL                                             47970039
460300                 CLOSE CURSOR5                                    47980039
460400             END-EXEC                                             47990039
460500                                                                  48000039
460600         WHEN ASC-CURSOR6                                         48010039
460700             EXEC SQL                                             48020039
460800                 CLOSE CURSOR6                                    48030039
460900             END-EXEC                                             48040039
461000     END-EVALUATE.                                                48050039
461100*                                                                 48060039
461200     EVALUATE TRUE                                                48070039
461300         WHEN SQLCODE = ZERO                                      48080039
461400             CONTINUE                                             48090039
461500         WHEN SQLWARN0 NOT = SPACES                               48100039
461600         WHEN SQLCODE < ZERO                                      48110039
461700         WHEN SQLCODE > ZERO                                      48120039
461800             MOVE '4020-CLOSE-CURSOR'                             48130039
461900                               TO DP013-PARAGRAPH                 48140039
462000             MOVE 'CLOSE CURSOR '                                 48150039
462100                               TO DP013-MESSAGE-TEXT (1)          48160039
462200             MOVE SQLCA        TO DP013-SQLCA                     48170039
462300             MOVE 'TPURCHS '   TO DP013-DB2-TABLE-NAME (1)        48180039
462400             SET DP013-DB2-ABEND                                  48190039
462500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               48200039
462600             PERFORM DP013-0000-PROCESS-ABEND                     48210039
462700     END-EVALUATE.                                                48220039
462800                                                                  48230039
462900 EJECT                                                            48240039
463000*----------------------------------------------------------------*48250039
463100*    SET UP THE HOST VARIABLES.                                  *48260039
463200*----------------------------------------------------------------*48270039
463300                                                                  48280039
463400 4100-PREPARE-CURSOR.                                             48290039
463500                                                                  48300039
463600     SET ASC-NO-CURSOR         TO TRUE.                           48310039
463700                                                                  48320039
463800     IF ASC-KEY-STATUS = '4'                                      48330039
463900         IF DK-PO-NUMBER > ZERO                                   48340039
464000              SET ASC-CURSOR6  TO TRUE                            48350039
464100         ELSE                                                     48360039
464200             IF DK-DMM-NAME > SPACES                              48370039
464300                 SET ASC-CURSOR5 TO TRUE                          48380039
464400             ELSE                                                 48390039
464500                 SET ASC-CURSOR4 TO TRUE                          48400039
464600             END-IF                                               48410039
464700         END-IF                                                   48420039
464800     ELSE                                                         48430039
464900         IF DK-PO-NUMBER > +0                                     48440039
465000             SET ASC-CURSOR3   TO TRUE                            48450039
465100         ELSE                                                     48460039
465200             IF DK-DMM-NAME > SPACES                              48470039
465300                 SET ASC-CURSOR2 TO TRUE                          48480039
465400             ELSE                                                 48490039
465500                 SET ASC-CURSOR1 TO TRUE                          48500039
465600             END-IF                                               48510039
465700         END-IF                                                   48520039
465800     END-IF.                                                      48530039
465900 EJECT                                                            48540039
466000*----------------------------------------------------------------*48550039
466100*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *48560039
466200*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *48570039
466300*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *48580039
466400*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *48590039
466500*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *48600039
466600*                                                                *48610039
466700*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *48620039
466800*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *48630039
466900*    UPON INITIALIZATION.                                        *48640039
467000*----------------------------------------------------------------*48650039
467100                                                                  48660039
467200 4300-READ-ITEMS-FROM-DB.                                         48670039
467300                                                                  48680039
467400     PERFORM                                                      48690039
467500         VARYING PV-READ-COUNT                                    48700039
467600         FROM 1 BY 1                                              48710039
467700         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    48720039
467800            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         48730039
467900                                                                  48740039
468000         MOVE SPACES      TO PV-EDIT-ERROR-ARRAY                  48750039
468100                             PS-PO-MSG-SWITCHES                   48760039
468200         INITIALIZE          PV-NBR-EDIT-ERRORS                   48770039
468300         SET PS-READY-FOR-REL  TO TRUE                            48780039
468400                                                                  48790039
468500         PERFORM 4310-FETCH                                       48800039
468600                                                                  48810039
468700         IF  ASC-ITEMS-LEFT-ON-DB                                 48820039
468800             PERFORM 4320-CHECK-STATUS                            48830039
468900             IF PS-SHOW-PO                                        48840039
469000                 PERFORM 4340-GET-MORE-SCREEN-DATA                48850039
469100                 IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL            48860039
469200                     ADD +1        TO ASC-ITEM-SUB                48870039
469300                 ELSE                                             48880039
469400                     ADD +1        TO ASC-BLK-SUB                 48890039
469500                     MOVE +1       TO ASC-ITEM-SUB                48900039
469600                                                                  48910039
469700                     IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY     48920039
469800                         MOVE +1   TO ASC-BLK-SUB                 48930039
469900                         SET ASC-BLOCK-MODIFIED (1)               48940039
470000                                   TO TRUE                        48950039
470100                         PERFORM 5100-WRITE-TEMP-STORAGE          48960039
470200                         MOVE ASC-BLOCK-ENTRIES                   48970039
470300                                   (PC-MAX-BLOCKS-IN-ARRAY)       48980039
470400                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 48990039
470500                         ADD +1    TO ASC-BLK-SUB                 49000039
470600                        INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)49010039
470700                         SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)  49020039
470800                                   TO TRUE                        49030039
470900                     END-IF                                       49040039
471000                 END-IF                                           49050039
471100                 ADD +1            TO ASC-NUMBER-OF-ITEMS-READ    49060039
471200                 MOVE ASC-NUMBER-OF-ITEMS-READ                    49070039
471300                                   TO ASC-LIST-ITEM-NUMBER        49080039
471400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  49090039
471500                 MOVE PURCHS-PO-NBR                               49100039
471600                                   TO ASC-PO-NUMBER-N             49110039
471700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49120039
471800                 MOVE PV-RLSE-DAYS                                49130039
471900                                   TO  ASC-RLSE-DAYS              49140039
472000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49150039
472100                 MOVE PV-RLSE-DATE                                49160039
472200                                   TO  ASC-RLSE-DATE              49170039
472300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49180039
472400                 MOVE PURCHS-DEPT-NBR                             49190039
472500                                   TO  ASC-DPT                    49200039
472600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49210039
472700                 MOVE ENTNME-ENT-NAME-DESC                        49220039
472800                                   TO  ASC-VENDOR                 49230039
472900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49240039
473000                 MOVE PV-DONT-SHIP-BEF-DTE                        49250039
473100                                   TO  ASC-SHIP-DATE              49260039
473200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49270039
473300                 MOVE PV-CAN-IFNOT-SHIP-DTE                       49280039
473400                                   TO  ASC-CAN-DATE               49290039
473500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49300039
473600                                                                  49310039
473700                 MOVE PV-STATUS-TEXT                              49320039
473800                                   TO  ASC-STATUS                 49330039
473900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49340039
474000*               **************************************************49350039
474100*               * IF IMPORT PO W/ MORE THAN ONE ERROR - OVERLAY  *49360039
474200*               * STATUS TEXT W/ PROMPT FOR F18 TO SHOW ALL ERRS *49370039
474300*               **************************************************49380039
474400                 IF ASC-KEY-STATUS = '4'                          49390039
474500                   IF PV-NBR-EDIT-ERRORS > +1                     49400039
474600                     MOVE PC-MULTI-MSGS                           49410039
474700                                   TO  ASC-STATUS                 49420039
474800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49430039
474900                   END-IF                                         49440039
475000                 END-IF                                           49450039
475100                                                                  49460039
475200** TKMA888 7/10/03 ********************************************** 49470039
475300* REMOVED 2 LINES                                                 49480039
475400*                MOVE PV-PO-LINES  TO  ASC-PO-LINES               49490039
475500*                                      (ASC-BLK-SUB ASC-ITEM-SUB) 49500039
475600** TKMA888 7/10/03 ********************************************** 49510039
475700                 MOVE PV-MAJ-CL    TO  ASC-MAJ-CLASS              49520039
475800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49530039
475900                 MOVE PV-SUB-CL    TO  ASC-SUB-CLASS              49540039
476000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49550039
476100                 MOVE PV-DCONSLR-RLSE-CDE                         49560039
476200                                   TO  ASC-DCONSLR-RLSE-CDE       49570039
476300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49580039
476400                 MOVE PURCHS-ENT-ID                               49590039
476500                                   TO  ASC-ENT-ID                 49600039
476600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49610039
476700                 MOVE PURCHS-NEW-STR-PO-IND                       49620039
476800                                   TO  ASC-NEW-STR-PO-IND         49630039
476900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49640039
477000                 MOVE PV-TYPE-CON-OR-CMN                          49650039
477100                                   TO  ASC-TYPE-CON-OR-CMN        49660039
477200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49670039
477300                 IF PS-THERE-ARE-CMN-MSGS                         49680039
477400                   MOVE PC-Y       TO  ASC-CMN-ERROR-IND          49690039
477500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49700039
477600                 ELSE                                             49710039
477700                   MOVE SPACES     TO  ASC-CMN-ERROR-IND          49720039
477800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49730039
477900                 END-IF                                           49740039
478000                 MOVE PV-EDIT-ERROR-ARRAY                         49750039
478100                                   TO  ASC-EDIT-ERROR-ARRAY       49760039
478200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49770039
478300                 MOVE PV-NBR-EDIT-ERRORS                          49780039
478400                                   TO  ASC-NBR-EDIT-ERRORS        49790039
478500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49800039
478600             END-IF                                               49810039
478700         END-IF                                                   49820039
478800     END-PERFORM.                                                 49830039
478900                                                                  49840039
479000     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          49850039
479100         MOVE +1               TO ASC-BLK-SUB                     49860039
479200         PERFORM 5100-WRITE-TEMP-STORAGE                          49870039
479300         ADD +1                TO ASC-BLK-SUB                     49880039
479400         PERFORM 5100-WRITE-TEMP-STORAGE                          49890039
479500                                                                  49900039
479600         MOVE 1                TO ASC-BLK-SUB                     49910039
479700                                  PV-BLOCK-NUMBER                 49920039
479800         PERFORM 4410-READ-TEMP-STORAGE                           49930039
479900         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             49940039
480000             MOVE 2            TO ASC-BLK-SUB                     49950039
480100                                  PV-BLOCK-NUMBER                 49960039
480200             PERFORM 4410-READ-TEMP-STORAGE                       49970039
480300         END-IF                                                   49980039
480400     END-IF.                                                      49990039
480500 EJECT                                                            50000039
480600*----------------------------------------------------------------*50010039
480700*    FETCH THE MESSAGE CURSOR.                                   *50020039
480800*----------------------------------------------------------------*50030039
480900                                                                  50040039
481000 4310-FETCH.                                                      50050039
481100                                                                  50060039
481200     EVALUATE TRUE                                                50070039
481300         WHEN ASC-CURSOR1                                         50080039
481400              EXEC SQL                                            50090039
481500                   FETCH CURSOR1                                  50100039
481600                   INTO  :PURCHS-PO-NBR,                          50110039
481700                         :PURCHS-EDI-IND,                         50120039
481800                         :PURCHS-DEPT-NBR,                        50130039
481900                         :PLNSHP-DONT-SHIP-BEF-DTE,               50140039
482000                         :PLNSHP-CAN-IFNOT-SHIP-DTE,              50150039
482100                         :ENTNME-ENT-NAME-DESC,                   50160039
482200                         :PV-RLSE-DAYS,                           50170039
482300                         :PV-DB2-RLSE-DATE                        50180039
482400                        ,:PURCHS-ENT-ID                           50190039
482500                        ,:PURCHS-NEW-STR-PO-IND                   50200039
482600              END-EXEC                                            50210039
482700                                                                  50220039
482800         WHEN ASC-CURSOR2                                         50230039
482900              EXEC SQL                                            50240039
483000                   FETCH CURSOR2                                  50250039
483100                   INTO  :PURCHS-PO-NBR,                          50260039
483200                         :PURCHS-EDI-IND,                         50270039
483300                         :PURCHS-DEPT-NBR,                        50280039
483400                         :PLNSHP-DONT-SHIP-BEF-DTE,               50290039
483500                         :PLNSHP-CAN-IFNOT-SHIP-DTE,              50300039
483600                         :ENTNME-ENT-NAME-DESC,                   50310039
483700                         :PV-RLSE-DAYS,                           50320039
483800                         :PV-DB2-RLSE-DATE                        50330039
483900                        ,:PURCHS-ENT-ID                           50340039
484000                        ,:PURCHS-NEW-STR-PO-IND                   50350039
484100              END-EXEC                                            50360039
484200                                                                  50370039
484300         WHEN ASC-CURSOR3                                         50380039
484400              EXEC SQL                                            50390039
484500                   FETCH CURSOR3                                  50400039
484600                   INTO  :PURCHS-PO-NBR,                          50410039
484700                         :PURCHS-EDI-IND,                         50420039
484800                         :PURCHS-DEPT-NBR,                        50430039
484900                         :PLNSHP-DONT-SHIP-BEF-DTE,               50440039
485000                         :PLNSHP-CAN-IFNOT-SHIP-DTE,              50450039
485100                         :ENTNME-ENT-NAME-DESC,                   50460039
485200                         :PV-RLSE-DAYS,                           50470039
485300                         :PV-DB2-RLSE-DATE                        50480039
485400                        ,:PURCHS-ENT-ID                           50490039
485500                        ,:PURCHS-NEW-STR-PO-IND                   50500039
485600              END-EXEC                                            50510039
485700                                                                  50520039
485800         WHEN ASC-CURSOR4                                         50530039
485900              EXEC SQL                                            50540039
486000                   FETCH CURSOR4                                  50550039
486100                   INTO  :PV-EST-AR-TMST                          50560039
486200                      ,  :PURCHS-PO-NBR                           50570039
486300                      ,  :PURCHS-DEPT-NBR                         50580039
486400                      ,  :PURCHS-ENT-ID                           50590039
486500                      ,  :PURCHS-NEW-STR-PO-IND                   50600039
486600                      ,  :PLNSHP-DONT-SHIP-BEF-DTE                50610039
486700                      ,  :PLNSHP-CAN-IFNOT-SHIP-DTE               50620039
486800                      ,  :ENTNME-ENT-NAME-DESC                    50630039
486900                      ,  :PV-RLSE-DAYS                            50640039
487000                      ,  :PV-DB2-RLSE-DATE                        50650039
487100                      ,  :PV-DCONSLR-RLSE-CDE                     50660039
487200                      ,  :PV-TYPE-CON-OR-CMN                      50670039
487300              END-EXEC                                            50680039
487400                                                                  50690039
487500         WHEN ASC-CURSOR5                                         50700039
487600              EXEC SQL                                            50710039
487700                   FETCH CURSOR5                                  50720039
487800                   INTO  :PV-EST-AR-TMST                          50730039
487900                      ,  :PURCHS-PO-NBR                           50740039
488000                      ,  :PURCHS-DEPT-NBR                         50750039
488100                      ,  :PURCHS-ENT-ID                           50760039
488200                      ,  :PURCHS-NEW-STR-PO-IND                   50770039
488300                      ,  :PLNSHP-DONT-SHIP-BEF-DTE                50780039
488400                      ,  :PLNSHP-CAN-IFNOT-SHIP-DTE               50790039
488500                      ,  :ENTNME-ENT-NAME-DESC                    50800039
488600                      ,  :PV-RLSE-DAYS                            50810039
488700                      ,  :PV-DB2-RLSE-DATE                        50820039
488800                      ,  :PV-DCONSLR-RLSE-CDE                     50830039
488900                      ,  :PV-TYPE-CON-OR-CMN                      50840039
489000              END-EXEC                                            50850039
489100                                                                  50860039
489200         WHEN ASC-CURSOR6                                         50870039
489300              EXEC SQL                                            50880039
489400                   FETCH CURSOR6                                  50890039
489500                   INTO  :PV-EST-AR-TMST                          50900039
489600                      ,  :PURCHS-PO-NBR                           50910039
489700                      ,  :PURCHS-DEPT-NBR                         50920039
489800                      ,  :PURCHS-ENT-ID                           50930039
489900                      ,  :PURCHS-NEW-STR-PO-IND                   50940039
490000                      ,  :PLNSHP-DONT-SHIP-BEF-DTE                50950039
490100                      ,  :PLNSHP-CAN-IFNOT-SHIP-DTE               50960039
490200                      ,  :ENTNME-ENT-NAME-DESC                    50970039
490300                      ,  :PV-RLSE-DAYS                            50980039
490400                      ,  :PV-DB2-RLSE-DATE                        50990039
490500                      ,  :PV-DCONSLR-RLSE-CDE                     51000039
490600                      ,  :PV-TYPE-CON-OR-CMN                      51010039
490700              END-EXEC                                            51020039
490800                                                                  51030039
490900     END-EVALUATE.                                                51040039
491000                                                                  51050039
491100     EVALUATE TRUE                                                51060039
491200         WHEN SQLCODE = ZERO                                      51070039
491300         WHEN SQLCODE = +100                                      51080039
491400              CONTINUE                                            51090039
491500         WHEN SQLWARN0 NOT = SPACE                                51100039
491600         WHEN SQLCODE NOT = ZERO                                  51110039
491700              MOVE '4310-FETCH-CURSOR'                            51120039
491800                               TO DP013-PARAGRAPH                 51130039
491900              MOVE 'FETCH CURSOR'                                 51140039
492000                               TO DP013-MESSAGE-TEXT (1)          51150039
492100              MOVE SQLCA       TO DP013-SQLCA                     51160039
492200              SET DP013-DB2-ABEND                                 51170039
492300                               TO TRUE                            51180039
492400              PERFORM DP013-0000-PROCESS-ABEND                    51190039
492500     END-EVALUATE.                                                51200039
492600                                                                  51210039
492700     IF  SQLCODE EQUAL +100                                       51220039
492800         SET ASC-NO-ITEMS-LEFT-ON-DB                              51230039
492900                                   TO TRUE                        51240039
493000     END-IF.                                                      51250039
493100                                                                  51260039
493200 EJECT                                                            51270039
493300*----------------------------------------------------------------*51280039
493400* VALIDATE THE PO MEETS THE STATUS CHOSEN BY THE USER.           *51290039
493500*----------------------------------------------------------------*51300039
493600 4320-CHECK-STATUS.                                               51310039
493700                                                                  51320039
493800     SET PS-SPLITS-OK          TO TRUE                            51330039
493900     SET PS-DONT-SHOW-PO       TO TRUE                            51340039
494000     MOVE PURCHS-PO-NBR        TO DK-PO-NUMBER                    51350039
494100                                                                  51360039
494200                                                                  51370039
494300     EVALUATE TRUE                                                51380039
494400                                                                  51390039
494500*  (REQUIRE DC SPLIT)                                             51400039
494600         WHEN ASC-KEY-STATUS = '1'                                51410039
494700             PERFORM 4325-READY-FOR-RELEASE                       51420039
494800                                 THRU 4325-EXIT                   51430039
494900             IF PS-SPLITS-NOT-OK                                  51440039
495000                 MOVE PC-MSG-D-REQ-DC-SPLIT                       51450039
495100                                TO PV-STATUS-TEXT                 51460039
495200                 SET PS-SHOW-PO TO TRUE                           51470039
495300             ELSE                                                 51480039
495400                 SET PS-DONT-SHOW-PO TO TRUE                      51490039
495500             END-IF                                               51500039
495600                                                                  51510039
495700*  (READY FOR RELEASE)                                            51520039
495800         WHEN ASC-KEY-STATUS = '2'                                51530039
495900             PERFORM 4325-READY-FOR-RELEASE                       51540039
496000                                 THRU 4325-EXIT                   51550039
496100             IF PS-SPLITS-OK                                      51560039
496200                 SET PS-SHOW-PO TO TRUE                           51570039
496300                 MOVE PC-MSG-F-READY-FOR-REL TO PV-STATUS-TEXT    51580039
496400             ELSE                                                 51590039
496500                 SET PS-DONT-SHOW-PO TO TRUE                      51600039
496600             END-IF                                               51610039
496700                                                                  51620039
496800*  (BOTH READY FOR RELEASE AND REQUIRE DC SPLIT)                  51630039
496900         WHEN ASC-KEY-STATUS = '3'                                51640039
497000             PERFORM 4325-READY-FOR-RELEASE                       51650039
497100                                 THRU 4325-EXIT                   51660039
497200             SET PS-SHOW-PO TO TRUE                               51670039
497300             IF PS-SPLITS-OK                                      51680039
497400                 MOVE PC-MSG-F-READY-FOR-REL TO PV-STATUS-TEXT    51690039
497500             ELSE                                                 51700039
497600                 MOVE PC-MSG-D-REQ-DC-SPLIT                       51710039
497700                                TO PV-STATUS-TEXT                 51720039
497800             END-IF                                               51730039
497900                                                                  51740039
498000* IMPORTS ONLY                                                    51750039
498100         WHEN ASC-KEY-STATUS = '4'                                51760039
498200             PERFORM 4331-CHECK-IF-ACTIVE-PO                      51770039
498300             PERFORM 4332-CHECK-IF-IMPORT                         51780039
498400             PERFORM 4334-CHECK-IF-ACTIVE-LINES                   51790039
498500             PERFORM 5854-IMPORTS-GET-PACKAGE-CODE                51800039
498600                                                                  51810039
498700             IF PS-MSG-B-ALREADY-SET                              51820039
498800               CONTINUE                                           51830039
498900             ELSE                                                 51840039
499000               IF PURCHS-PKGNG-CDE = PC-M OR PC-I OR PC-B         51850039
499100                                     OR PC-C OR PC-S              51860039
499200                  CONTINUE                                        51870039
499300               ELSE                                               51880039
499400                  MOVE PC-MSG-M-INVALID-PKGE-CD                   51890039
499500                            TO PV-STATUS-TEXT                     51900039
499600                  SET PS-READY-FOR-REL-NO  TO TRUE                51910039
499700                  IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS           51920039
499800                    ADD +1       TO PV-NBR-EDIT-ERRORS            51930039
499900                    MOVE PC-M                                     51940039
500000                       TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)       51950039
500100                  END-IF                                          51960039
500200               END-IF                                             51970039
500300             END-IF                                               51980039
500400                                                                  51990039
500500*            *----------------------------------------*           52000039
500600*            *         PREPACK PROCESSING             *           52010039
500700*            *----------------------------------------*           52020039
500800             IF PURCHS-PKGNG-CDE = PC-M  OR PC-I                  52030039
500900               PERFORM 4336-CHECK-UNCONFIRMED-PACKS               52040039
501000               IF PS-MSG-T-ALREADY-SET                            52050039
501100                  CONTINUE                                        52060039
501200               ELSE                                               52070039
501300                  PERFORM 4978-SELECT-UPCS-TIED                   52080039
501400               END-IF                                             52090039
501500*              *** SEE IF CMN PACKS HAVE SKUS                     52100039
501600               IF PV-TYPE-CON-OR-CMN = PC-CMN                     52110039
501700                 IF PS-MSG-X-ALREADY-SET                          52120039
501800                    CONTINUE                                      52130039
501900                 ELSE                                             52140039
502000*** RK              PERFORM 4520-SELECT-IMCNUP-PACK-SKUS          52150039
502100                    IF PS-MSG-X-ALREADY-SET                       52160039
502600                       PERFORM 4525-NO-PACK-SKU-CMN               52170040
502800                    END-IF                                        52180039
502900                 END-IF                                           52190039
503000               END-IF                                             52200039
503100*              *** SEE IF CMN PACKS HAVE UPCS                     52210039
503200               IF PV-TYPE-CON-OR-CMN = PC-CMN                     52220039
503300                 IF PS-MSG-Y-ALREADY-SET                          52230039
503400                    CONTINUE                                      52240039
503500                 ELSE                                             52250039
503600                    PERFORM 4530-SELECT-IMCNUP-PACK-UPCS          52260039
503700                   IF PS-MSG-Y-ALREADY-SET                        52270039
504200                      PERFORM 4535-NO-PACK-UPC-CMN                52280040
504400                   END-IF                                         52290039
504500                 END-IF                                           52300039
504600               END-IF                                             52310039
504700                                                                  52320039
504800*              *** MSG G IS PACKS W/ UNTIED LINES                 52330039
504900               IF PS-MSG-G-ALREADY-SET                            52340039
505000                 CONTINUE                                         52350039
505100               ELSE                                               52360039
505200                   PERFORM 4920-OPEN-PACK-CUR                     52370039
505300                   SET PS-EOC-PACK-CURSOR-NO  TO TRUE             52380039
505400                   PERFORM 4500-IMPORTS-PREPACK                   52390039
505500                       UNTIL PS-EOC-PACK-CURSOR                   52400039
505600                   PERFORM 4922-CLOSE-PACK-CUR                    52410039
505700               END-IF                                             52420039
505800             END-IF                                               52430039
505900*            *----------------------------------------*           52440039
506000                                                                  52450039
506100*            *----------------------------------------*           52460039
506200*            * BULK PROCESSING                        *           52470039
506300*            *----------------------------------------*           52480039
506400             IF PURCHS-PKGNG-CDE = PC-C OR PC-B OR PC-S           52490039
506500**RK           IF PV-TYPE-CON-OR-CMN = PC-CMN                     52500039
506600**RK             PERFORM 4970-SELECT-BULK-UPCS                    52510039
506700**RK           END-IF                                             52520039
506800               PERFORM 4550-IMPORTS-BULK                          52530039
506900             END-IF                                               52540039
507000*            *----------------------------------------*           52550039
507100                                                                  52560039
507200             IF PS-READY-FOR-REL                                  52570039
507300                MOVE PC-MSG-F-READY-FOR-REL                       52580039
507400                                      TO PV-STATUS-TEXT           52590039
507500                MOVE +1  TO PV-NBR-EDIT-ERRORS                    52600039
507600                MOVE PC-F                                         52610039
507700                     TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)         52620039
507800             ELSE                                                 52630039
507900                IF PV-NBR-EDIT-ERRORS = +1                        52640039
508000                  IF PV-STATUS-TEXT =                             52650039
508100                         PC-MSG-E-SKU-OTR-PCK-IMPORTS             52660039
508200                    MOVE PC-MSG-S-RDY-RLSE-OUTR-PCK1              52670039
508300                                          TO PV-STATUS-TEXT       52680039
508400                  END-IF                                          52690039
508500                END-IF                                            52700039
508600             END-IF                                               52710039
508700                                                                  52720039
508800             SET PS-SHOW-PO TO TRUE                               52730039
508900                                                                  52740039
509000                                                                  52750039
509100     END-EVALUATE.                                                52760039
509200/                                                                 52770039
509300*----------------------------------------------------------------*52780039
509400* CHECK TO SEE IF THE PO IS READY FOR RELEASE.                   *52790039
509500*----------------------------------------------------------------*52800039
509600 4325-READY-FOR-RELEASE.                                          52810039
509700                                                                  52820039
509800     MOVE ZERO                     TO PV-DB2-COUNT1               52830039
509900                                      PV-DB2-COUNT2.              52840039
510000                                                                  52850039
510100*  ARE THERE ANY LINES WHERE THE TALLPLN SPLIT QTYS DO NOT        52860039
510200*  EQUAL THE UNIT QTY ON THE LINE ITSELF.                         52870039
510300     PERFORM                                                      52880039
510400         WITH TEST AFTER                                          52890039
510500         VARYING PV-RETRY-COUNTER                                 52900039
510600         FROM 1 BY 1                                              52910039
510700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               52920039
510800                   OR (SQLCODE = ZERO))                           52930039
510900         EXEC SQL                                                 52940039
511000             SELECT  COUNT (*)                                    52950039
511100                INTO :PV-DB2-COUNT1                               52960039
511200                FROM  TPURITM A                                   52970039
511300               WHERE A.PO_NBR = :DK-PO-NUMBER                     52980039
511400                 AND A.VER_STATUS_CDE = :PC-A                     52990039
511500                 AND A.STATUS_CDE NOT IN ('CA', 'CB')             53000039
511600                 AND UNT_QTY <>                                   53010039
511700                    (SELECT SUM(CURR_SPLIT_QTY)                   53020039
511800                       FROM TALLPLN B                             53030039
511900                      WHERE A.PO_NBR     = B.PO_NBR               53040039
512000                        AND B.CURR_SPLIT_QTY > 0                  53050039
512100                        AND A.PO_LNE_NBR = B.PO_LNE_NBR)          53060039
512200         END-EXEC                                                 53070039
512300                                                                  53080039
512400         EVALUATE TRUE                                            53090039
512500                 WHEN SQLCODE = +0                                53100039
512600                     CONTINUE                                     53110039
512700                 WHEN SQLCODE = +100                              53120039
512800                 WHEN SQLCODE = -305                              53130039
512900                     CONTINUE                                     53140039
513000                 WHEN SQLCODE = -904                              53150039
513100                 WHEN SQLCODE = -913                              53160039
513200                     CONTINUE                                     53170039
513300                 WHEN SQLWARN0 NOT = SPACES                       53180039
513400                 WHEN SQLCODE < ZERO                              53190039
513500                 WHEN SQLCODE > ZERO                              53200039
513600                     MOVE '4325-GET-READY-FOR-RELEASE'            53210039
513700                                   TO DP013-PARAGRAPH             53220039
513800                     MOVE '              '                        53230039
513900                                   TO DP013-MESSAGE-TEXT (1)      53240039
514000                     MOVE SQLCA    TO DP013-SQLCA                 53250039
514100                     MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)  53260039
514200                     SET DP013-DB2-ABEND                          53270039
514300                         DP013-XCTL-DISPLAY-RESTART TO TRUE       53280039
514400                     PERFORM DP013-0000-PROCESS-ABEND             53290039
514500             END-EVALUATE                                         53300039
514600     END-PERFORM.                                                 53310039
514700*                                                                 53320039
514800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        53330039
514900         MOVE '4325-GET-READY-FOR-RELEASE' TO DP013-PARAGRAPH     53340039
515000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO GET TPURITM'53350039
515100                                   TO DP013-MESSAGE-TEXT (1)      53360039
515200         MOVE SQLCA                TO DP013-SQLCA                 53370039
515300         MOVE 'TPURITM '           TO DP013-DB2-TABLE-NAME (1)    53380039
515400         SET DP013-DB2-ABEND                                      53390039
515500             DP013-XCTL-DISPLAY-RESTART                           53400039
515600                                   TO TRUE                        53410039
515700         PERFORM DP013-0000-PROCESS-ABEND                         53420039
515800     END-IF.                                                      53430039
515900                                                                  53440039
516000     IF PV-DB2-COUNT1 > 0                                         53450039
516100         SET PS-INVALID-STATUS                                    53460039
516200             PS-SPLITS-NOT-OK    TO TRUE                          53470039
516300         GO TO 4325-EXIT                                          53480039
516400     END-IF.                                                      53490039
516500                                                                  53500039
516600*  ARE THERE ANY LINES WITH NO TALLPLN AT ALL?  ALL LINES         53510039
516700*  MUST HAVE ALLOCATIONS.                                         53520039
516800                                                                  53530039
516900     PERFORM                                                      53540039
517000         WITH TEST AFTER                                          53550039
517100         VARYING PV-RETRY-COUNTER                                 53560039
517200         FROM 1 BY 1                                              53570039
517300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               53580039
517400                   OR (SQLCODE = ZERO))                           53590039
517500         EXEC SQL                                                 53600039
517600             SELECT  COUNT (*)                                    53610039
517700                INTO :PV-DB2-COUNT2                               53620039
517800                FROM  TPURITM A                                   53630039
517900               WHERE A.PO_NBR         = :DK-PO-NUMBER             53640039
518000                 AND A.VER_STATUS_CDE = :PC-A                     53650039
518100                 AND A.STATUS_CDE NOT IN ('CA', 'CB')             53660039
518200                 AND NOT EXISTS                                   53670039
518300                    (SELECT *                                     53680039
518400                       FROM TALLPLN B                             53690039
518500                      WHERE A.PO_NBR     = B.PO_NBR               53700039
518600                        AND B.CURR_SPLIT_QTY > 0                  53710039
518700                        AND A.PO_LNE_NBR = B.PO_LNE_NBR)          53720039
518800         END-EXEC                                                 53730039
518900                                                                  53740039
519000         EVALUATE TRUE                                            53750039
519100                 WHEN SQLCODE = +0                                53760039
519200                     CONTINUE                                     53770039
519300                 WHEN SQLCODE = +100                              53780039
519400                 WHEN SQLCODE = -305                              53790039
519500                     CONTINUE                                     53800039
519600                 WHEN SQLCODE = -904                              53810039
519700                 WHEN SQLCODE = -913                              53820039
519800                     CONTINUE                                     53830039
519900                 WHEN SQLWARN0 NOT = SPACES                       53840039
520000                 WHEN SQLCODE < ZERO                              53850039
520100                 WHEN SQLCODE > ZERO                              53860039
520200                     MOVE '4325-GET-READY-FOR-RELEASE'            53870039
520300                                   TO DP013-PARAGRAPH             53880039
520400                     MOVE '2ND PERFORM   '                        53890039
520500                                   TO DP013-MESSAGE-TEXT (1)      53900039
520600                     MOVE SQLCA    TO DP013-SQLCA                 53910039
520700                     MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)  53920039
520800                     SET DP013-DB2-ABEND                          53930039
520900                         DP013-XCTL-DISPLAY-RESTART TO TRUE       53940039
521000                     PERFORM DP013-0000-PROCESS-ABEND             53950039
521100             END-EVALUATE                                         53960039
521200     END-PERFORM.                                                 53970039
521300*                                                                 53980039
521400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        53990039
521500         MOVE '4325-READY-FOR-RELEASE'  TO DP013-PARAGRAPH        54000039
521600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO GET TPURITM'54010039
521700                                   TO DP013-MESSAGE-TEXT (1)      54020039
521800         MOVE SQLCA                TO DP013-SQLCA                 54030039
521900         MOVE 'TPURITM '           TO DP013-DB2-TABLE-NAME (1)    54040039
522000         SET DP013-DB2-ABEND                                      54050039
522100             DP013-XCTL-DISPLAY-RESTART                           54060039
522200                                   TO TRUE                        54070039
522300         PERFORM DP013-0000-PROCESS-ABEND                         54080039
522400     END-IF.                                                      54090039
522500                                                                  54100039
522600     IF PV-DB2-COUNT2 > ZERO                                      54110039
522700         SET PS-INVALID-STATUS                                    54120039
522800             PS-SPLITS-NOT-OK    TO TRUE                          54130039
522900     END-IF.                                                      54140039
523000 4325-EXIT.                                                       54150039
523100     EXIT.                                                        54160039
523200                                                                  54170039
523300 EJECT                                                            54180039
523400*-------------------------------------------------------------    54190039
523500 4331-CHECK-IF-ACTIVE-PO.                                         54200039
523600                                                                  54210039
523700     EXEC SQL                                                     54220039
523800          SELECT A.STATUS_CDE                                     54230039
523900            INTO :PURCHS-STATUS-CDE                               54240039
524000            FROM TPURCHS A                                        54250039
524100           WHERE A.PO_NBR  = :DK-PO-NUMBER                        54260039
524200             AND A.VER_STATUS_CDE = :PC-A                         54270039
524300     END-EXEC                                                     54280039
524400                                                                  54290039
524500     EVALUATE TRUE                                                54300039
524600             WHEN SQLCODE = ZERO                                  54310039
524700                 CONTINUE                                         54320039
524800             WHEN SQLWARN0 NOT = SPACES                           54330039
524900                 MOVE '4331-CHECK-IF-ACTIVE-PO'                   54340039
525000                               TO DP013-PARAGRAPH                 54350039
525100                 MOVE 'SELECT FAILED '                            54360039
525200                               TO DP013-MESSAGE-TEXT (1)          54370039
525300                 MOVE SQLCA        TO DP013-SQLCA                 54380039
525400                 MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)      54390039
525500                 SET DP013-DB2-ABEND                              54400039
525600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           54410039
525700                 PERFORM DP013-0000-PROCESS-ABEND                 54420039
525800     END-EVALUATE.                                                54430039
525900                                                                  54440039
526000     SET PS-INVALID-STATUS TO TRUE.                               54450039
526100     EVALUATE TRUE                                                54460039
526200         WHEN SQLCODE  NOT  = ZERO                                54470039
526300           CONTINUE                                               54480039
526400                                                                  54490039
526500         WHEN PV-TYPE-CON-OR-CMN = PC-CMN                         54500039
526600           IF PURCHS-STATUS-CDE = 'AC' OR 'AP' OR 'CA' OR 'CM'    54510039
526700*************  5/26/2006 ADDED 'CB' TO THE IF STATEMENT           54520039
526800                                       OR 'CB'                    54530039
526900             SET PS-VALID-STATUS TO TRUE                          54540039
527000           END-IF                                                 54550039
527100                                                                  54560039
527200         WHEN PV-TYPE-CON-OR-CMN = PC-CON                         54570039
527300           IF PURCHS-STATUS-CDE = 'AC' OR 'AP'                    54580039
527400             SET PS-VALID-STATUS TO TRUE                          54590039
527500           END-IF                                                 54600039
527600     END-EVALUATE.                                                54610039
527700                                                                  54620039
527800     IF PS-INVALID-STATUS                                         54630039
527900         MOVE PC-MSG-A-INVALID-PO-STATUS                          54640039
528000                                 TO PV-STATUS-TEXT                54650039
528100         SET PS-READY-FOR-REL-NO  TO TRUE                         54660039
528200         IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS                    54670039
528300           ADD +1       TO PV-NBR-EDIT-ERRORS                     54680039
528400           MOVE PC-A                                              54690039
528500               TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)               54700039
528600         END-IF                                                   54710039
528700     END-IF.                                                      54720039
528800                                                                  54730039
528900*-----------------------------------------------------------      54740039
529000 4332-CHECK-IF-IMPORT.                                            54750039
529100     MOVE ZERO                     TO PV-DB2-COUNT1               54760039
529200                                                                  54770039
529300     EXEC SQL                                                     54780039
529400         SELECT      COUNT (*)                                    54790039
529500            INTO :PV-DB2-COUNT1                                   54800039
529600            FROM TPURCHS A                                        54810039
529700           WHERE A.PO_NBR             = :DK-PO-NUMBER             54820039
529800             AND A.VER_STATUS_CDE = :PC-A                         54830039
529900             AND A.PO_TYP_CDE IN ('IM', 'IE', 'IF', 'LD')         54840039
530000     END-EXEC                                                     54850039
530100                                                                  54860039
530200     EVALUATE TRUE                                                54870039
530300             WHEN SQLCODE = ZERO                                  54880039
530400                 CONTINUE                                         54890039
530500             WHEN SQLCODE = +100                                  54900039
530600             WHEN SQLCODE = -305                                  54910039
530700                 CONTINUE                                         54920039
530800             WHEN SQLCODE = -904                                  54930039
530900             WHEN SQLCODE = -913                                  54940039
531000                 CONTINUE                                         54950039
531100             WHEN SQLWARN0 NOT = SPACES                           54960039
531200             WHEN SQLCODE < ZERO                                  54970039
531300             WHEN SQLCODE > ZERO                                  54980039
531400                 MOVE '4332-CHECK-IF-IMPORT'                      54990039
531500                               TO DP013-PARAGRAPH                 55000039
531600                 MOVE '              '                            55010039
531700                               TO DP013-MESSAGE-TEXT (1)          55020039
531800                 MOVE SQLCA        TO DP013-SQLCA                 55030039
531900                 MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)      55040039
532000                 SET DP013-DB2-ABEND                              55050039
532100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           55060039
532200                 PERFORM DP013-0000-PROCESS-ABEND                 55070039
532300     END-EVALUATE.                                                55080039
532400                                                                  55090039
532500     IF PV-DB2-COUNT1 = ZERO                                      55100039
532600         MOVE PC-MSG-C-PO-IS-DOMESTIC TO PV-STATUS-TEXT           55110039
532700         SET PS-READY-FOR-REL-NO  TO TRUE                         55120039
532800         IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS                    55130039
532900           ADD +1       TO PV-NBR-EDIT-ERRORS                     55140039
533000           MOVE PC-C                                              55150039
533100               TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)               55160039
533200         END-IF                                                   55170039
533300     END-IF.                                                      55180039
533400                                                                  55190039
533500*-------------------------------------------------------------    55200039
533600 4334-CHECK-IF-ACTIVE-LINES.                                      55210039
533700                                                                  55220039
533800     INITIALIZE  PV-DB2-COUNT2.                                   55230039
533900                                                                  55240039
534000     EXEC SQL                                                     55250039
534100          SELECT COUNT (*)                                        55260039
534200            INTO :PV-DB2-COUNT2                                   55270039
534300            FROM TPURITM A                                        55280039
534400           WHERE A.PO_NBR          = :DK-PO-NUMBER                55290039
534500             AND A.VER_STATUS_CDE  = 'A'                          55300039
534600             AND A.STATUS_CDE   NOT IN ('CA', 'CB', 'CM')         55310039
534700     END-EXEC                                                     55320039
534800                                                                  55330039
534900     EVALUATE TRUE                                                55340039
535000             WHEN SQLCODE = ZERO                                  55350039
535100             WHEN SQLCODE = +100                                  55360039
535200             WHEN SQLCODE = -305                                  55370039
535300             WHEN SQLCODE = -904                                  55380039
535400             WHEN SQLCODE = -913                                  55390039
535500                 CONTINUE                                         55400039
535600             WHEN SQLCODE  NOT = ZERO                             55410039
535700             WHEN SQLWARN0 NOT = SPACES                           55420039
535800                 MOVE '4334-CHECK-IF-ACTIVE-LINES'                55430039
535900                               TO DP013-PARAGRAPH                 55440039
536000                 MOVE 'SELECT FAILED '                            55450039
536100                               TO DP013-MESSAGE-TEXT (1)          55460039
536200                 MOVE SQLCA        TO DP013-SQLCA                 55470039
536300                 MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)      55480039
536400                 SET DP013-DB2-ABEND                              55490039
536500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           55500039
536600                 PERFORM DP013-0000-PROCESS-ABEND                 55510039
536700     END-EVALUATE.                                                55520039
536800                                                                  55530039
536900                                                                  55540039
537000     IF PV-DB2-COUNT2 > ZERO                                      55550039
537100         CONTINUE                                                 55560039
537200     ELSE                                                         55570039
537300*---5/26/2006----------------------------------------------------*55580039
537400* WITH THE FOLLOWING IF STATEMENT A CHECK IS MADE TO DETERMINE    55590039
537500*   WHETHER THE DCONSLR_RLSE_CDE WAS EVER 'Y' OR 'R' FOR THIS PO  55600039
537600*   AND CONTAINER ON TAUCNRL. IF IT HAS BEEN, THEN IT CAN BE      55610039
537700*   CONSIDERED A VALID STATUS AND CAN BE RELEASED FROM THE SCREEN.55620039
537800*   THIS CHECK IS DONE FOR AN INVALID LINE STATUS                 55630039
537900*   IN THE PAST THE MESSAGE WOULD BE "INVALID LINE STATUS" ON THE 55640039
538000*   SCREEN, IN THIS CASE THE MESSAGE WILL BE CHANGED TO "READY    55650039
538100*   FOR RELEASE" SO THAT USER CAN RELEASE THE PO/CONTAINER FROM   55660039
538200*   THE SCREEN                                                    55670039
538300*---5/26/2006----------------------------------------------------*55680039
538400         INITIALIZE PS-CMN-Y-R-SW                                 55690039
538500         PERFORM 4335-CHECK-TAUCNRL                               55700039
538600         IF PS-CMN-Y-R-YES                                        55710039
538700             SET PS-VALID-STATUS         TO TRUE                  55720039
538800             SET PS-READY-FOR-REL        TO TRUE                  55730039
538900             MOVE PC-MSG-F-READY-FOR-REL TO PV-STATUS-TEXT        55740039
539000         ELSE                                                     55750039
539100*---5/26/2006-----------------------------------------------------55760039
539200             MOVE PC-MSG-B-INVALID-LINE-STATUS                    55770039
539300                                     TO PV-STATUS-TEXT            55780039
539400             SET PS-MSG-B-ALREADY-SET TO TRUE                     55790039
539500             SET PS-READY-FOR-REL-NO TO TRUE                      55800039
539600             IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS                55810039
539700               ADD +1   TO PV-NBR-EDIT-ERRORS                     55820039
539800               MOVE PC-B                                          55830039
539900                   TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)           55840039
540000             END-IF                                               55850039
540100         END-IF                                                   55860039
540200     END-IF.                                                      55870039
540300                                                                  55880039
540400*----------------------------------------------------------------*55890039
540500* CHECK IF AT ANY TIME IN THE PAST THE DCONSLR-RLSE-CDE WAS EVER  55900039
540600* A 'Y' OR 'R' INDICATING TRANSMISSION OR RETRANSMISSION.  IF A   55910039
540700* 'Y' OR 'R' IS PRESENT, SET THE PS-VALID-STATUS TO TRUE.         55920039
540800*----------------------------------------------------------------*55930039
540900 4335-CHECK-TAUCNRL.                                              55940039
541000     PERFORM                                                      55950039
541100         WITH TEST AFTER                                          55960039
541200         VARYING PV-RETRY-COUNTER                                 55970039
541300         FROM 1 BY 1                                              55980039
541400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               55990039
541500                   OR (SQLCODE = ZERO)                            56000039
541600                   OR (SQLCODE = +100)                            56010039
541700                   OR (SQLCODE = -811))                           56020039
541800         EXEC SQL                                                 56030039
541900             SELECT  A.DCONSLR_RLSE_CDE                           56040039
542000                INTO :AUCNRL-DCONSLR-RLSE-CDE                     56050039
542100                FROM  TAUCNRL A                                   56060039
542200               WHERE A.PO_NBR            = :DK-PO-NUMBER          56070039
542300                 AND A.DCONSLR_RLSE_CDE  IN ('Y', 'R')            56080039
542400         END-EXEC                                                 56090039
542500                                                                  56100039
542600         EVALUATE TRUE                                            56110039
542700             WHEN SQLCODE = +0                                    56120039
542800             WHEN SQLCODE = -811                                  56130039
542900                 SET PS-CMN-Y-R-YES          TO TRUE              56140039
543000             WHEN SQLCODE = +100                                  56150039
543100                 CONTINUE                                         56160039
543200             WHEN SQLWARN0 NOT = SPACES                           56170039
543300             WHEN SQLCODE < ZERO                                  56180039
543400             WHEN SQLCODE > ZERO                                  56190039
543500                 MOVE '4335-CHECK-TAUCNRL' TO DP013-PARAGRAPH     56200039
543600                 MOVE 'CHECK FOR  Y  OR  R'                       56210039
543700                               TO DP013-MESSAGE-TEXT (1)          56220039
543800                 STRING 'PO NUMBER ==>  '  DELIMITED BY SIZE      56230039
543900                       ASC-PO-NUMBER-N (ASC-BLK-SUB ASC-ITEM-SUB) 56240039
544000                                            DELIMITED BY SIZE     56250039
544100                      INTO DP013-MESSAGE-TEXT (2)                 56260039
544200                 STRING 'CONTAINER ==>  '  DELIMITED BY SIZE      56270039
544300                       IMCNRL-CONTNR-ID      DELIMITED BY SIZE    56280039
544400                      INTO DP013-MESSAGE-TEXT (3)                 56290039
544500                 MOVE SQLCA        TO DP013-SQLCA                 56300039
544600                 MOVE 'TAUCNRL ' TO DP013-DB2-TABLE-NAME (1)      56310039
544700                 SET DP013-DB2-ABEND                              56320039
544800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           56330039
544900                 PERFORM DP013-0000-PROCESS-ABEND                 56340039
545000             END-EVALUATE                                         56350039
545100     END-PERFORM.                                                 56360039
545200*                                                                 56370039
545300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        56380039
545400         MOVE '4335-CHECK-TAUCNRL' TO DP013-PARAGRAPH             56390039
545500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO GET TAUCNRL'56400039
545600                                   TO DP013-MESSAGE-TEXT (1)      56410039
545700         MOVE SQLCA                TO DP013-SQLCA                 56420039
545800         MOVE 'TAUCNRL '           TO DP013-DB2-TABLE-NAME (1)    56430039
545900         SET DP013-DB2-ABEND                                      56440039
546000             DP013-XCTL-DISPLAY-RESTART TO TRUE                   56450039
546100         PERFORM DP013-0000-PROCESS-ABEND                         56460039
546200     END-IF.                                                      56470039
546300                                                                  56480039
546400*-------------------------------------------------------------    56490039
546500 4336-CHECK-UNCONFIRMED-PACKS.                                    56500039
546600                                                                  56510039
546700     INITIALIZE  PV-DB2-COUNT4.                                   56520039
546800                                                                  56530039
546900     EXEC SQL                                                     56540039
547000          SELECT COUNT (*)                                        56550039
547100            INTO :PV-DB2-COUNT4                                   56560039
547200            FROM TPURITM A                                        56570039
547300           WHERE A.PO_NBR          = :DK-PO-NUMBER                56580039
547400             AND A.VER_STATUS_CDE  = 'A'                          56590039
547500             AND A.STATUS_CDE   = 'RV'                            56600039
547600     END-EXEC                                                     56610039
547700                                                                  56620039
547800     EVALUATE TRUE                                                56630039
547900             WHEN SQLCODE = ZERO                                  56640039
548000             WHEN SQLCODE = +100                                  56650039
548100             WHEN SQLCODE = -305                                  56660039
548200             WHEN SQLCODE = -904                                  56670039
548300             WHEN SQLCODE = -913                                  56680039
548400                 CONTINUE                                         56690039
548500             WHEN SQLCODE  NOT = ZERO                             56700039
548600             WHEN SQLWARN0 NOT = SPACES                           56710039
548700                 MOVE '4336-CHECK-UNCONFIRMED-PACKS'              56720039
548800                               TO DP013-PARAGRAPH                 56730039
548900                 MOVE 'SELECT FAILED '                            56740039
549000                               TO DP013-MESSAGE-TEXT (1)          56750039
549100                 MOVE SQLCA        TO DP013-SQLCA                 56760039
549200                 MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)      56770039
549300                 SET DP013-DB2-ABEND                              56780039
549400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           56790039
549500                 PERFORM DP013-0000-PROCESS-ABEND                 56800039
549600     END-EVALUATE.                                                56810039
549700                                                                  56820039
549800     IF PV-DB2-COUNT4 = ZERO                                      56830039
549900         CONTINUE                                                 56840039
550000     ELSE                                                         56850039
550100         MOVE PC-MSG-T-UNCONFIRMED-PACKS                          56860039
550200                                 TO PV-STATUS-TEXT                56870039
550300         SET PS-MSG-T-ALREADY-SET  TO TRUE                        56880039
550400         SET PS-READY-FOR-REL-NO   TO TRUE                        56890039
550500         IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS                    56900039
550600           ADD +1       TO PV-NBR-EDIT-ERRORS                     56910039
550700           MOVE PC-T                                              56920039
550800               TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)               56930039
550900         END-IF                                                   56940039
551000     END-IF.                                                      56950039
551100                                                                  56960039
551200 EJECT                                                            56970039
551300*----------------------------------------------------------------*56980039
551400* RETRIEVE THE REMAINING DATA FOR SCREEN DISPLAY.                *56990039
551500*----------------------------------------------------------------*57000039
551600 4340-GET-MORE-SCREEN-DATA.                                       57010039
551700                                                                  57020039
551800** TKMA888 7/10/03 ********************************************** 57030039
551900* REMOVED 1 LINES                                                 57040039
552000*    PERFORM 4350-COUNT-PO-LINES.                                 57050039
552100** TKMA888 7/10/03 ********************************************** 57060039
552200     PERFORM 4360-GET-CLASS.                                      57070039
552300                                                                  57080039
552400     MOVE PV-DB2-RLSE-DATE         TO PV-DB2-DATE.                57090039
552500     MOVE PV-DB2-DATE-MM           TO PV-DISPLAY-DATE-MM.         57100039
552600     MOVE PV-DB2-DATE-DD           TO PV-DISPLAY-DATE-DD.         57110039
552700     MOVE PV-DB2-DATE-YY           TO PV-DISPLAY-DATE-YY.         57120039
552800     MOVE PV-DISPLAY-DATE          TO PV-RLSE-DATE.               57130039
552900                                                                  57140039
553000     MOVE PLNSHP-DONT-SHIP-BEF-DTE TO PV-DB2-DATE.                57150039
553100     MOVE PV-DB2-DATE-MM           TO PV-DISPLAY-DATE-MM.         57160039
553200     MOVE PV-DB2-DATE-DD           TO PV-DISPLAY-DATE-DD.         57170039
553300     MOVE PV-DB2-DATE-YY           TO PV-DISPLAY-DATE-YY.         57180039
553400     MOVE PV-DISPLAY-DATE          TO PV-DONT-SHIP-BEF-DTE.       57190039
553500                                                                  57200039
553600     MOVE PLNSHP-CAN-IFNOT-SHIP-DTE TO PV-DB2-DATE.               57210039
553700     MOVE PV-DB2-DATE-MM           TO PV-DISPLAY-DATE-MM.         57220039
553800     MOVE PV-DB2-DATE-DD           TO PV-DISPLAY-DATE-DD.         57230039
553900     MOVE PV-DB2-DATE-YY           TO PV-DISPLAY-DATE-YY.         57240039
554000     MOVE PV-DISPLAY-DATE          TO PV-CAN-IFNOT-SHIP-DTE.      57250039
554100                                                                  57260039
554200 EJECT                                                            57270039
554300*----------------------------------------------------------------*57280039
554400* COUNT THE NUMBER OF PO LINES FOR THIS PO.                      *57290039
554500*----------------------------------------------------------------*57300039
554600 4350-COUNT-PO-LINES.                                             57310039
554700                                                                  57320039
554800     MOVE ZEROES                   TO PV-PO-LINES.                57330039
554900     MOVE +0                       TO PV-DB2-COUNT1.              57340039
555000                                                                  57350039
555100     PERFORM                                                      57360039
555200         WITH TEST AFTER                                          57370039
555300         VARYING PV-RETRY-COUNTER                                 57380039
555400         FROM 1 BY 1                                              57390039
555500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               57400039
555600                   OR (SQLCODE = ZERO))                           57410039
555700         EXEC SQL                                                 57420039
555800             SELECT  COUNT (*)                                    57430039
555900               INTO  :PV-DB2-COUNT1                               57440039
556000               FROM  TPURITM                                      57450039
556100              WHERE  PO_NBR         = :DK-PO-NUMBER               57460039
556200                AND  VER_STATUS_CDE = :PC-A                       57470039
556300                AND  STATUS_CDE NOT IN ('CA', 'CB')               57480039
556400         END-EXEC                                                 57490039
556500                                                                  57500039
556600         EVALUATE TRUE                                            57510039
556700                 WHEN SQLCODE = +0                                57520039
556800                     CONTINUE                                     57530039
556900                 WHEN SQLCODE = +100                              57540039
557000                     MOVE +0       TO PV-DB2-COUNT1               57550039
557100                 WHEN SQLCODE = -904                              57560039
557200                 WHEN SQLCODE = -913                              57570039
557300                     CONTINUE                                     57580039
557400                 WHEN SQLWARN0 NOT = SPACES                       57590039
557500                 WHEN SQLCODE < ZERO                              57600039
557600                 WHEN SQLCODE > ZERO                              57610039
557700                     MOVE '4330-GET-REQ-DC-SPLIT'                 57620039
557800                                   TO DP013-PARAGRAPH             57630039
557900                     MOVE '              '                        57640039
558000                                   TO DP013-MESSAGE-TEXT (1)      57650039
558100                     MOVE SQLCA    TO DP013-SQLCA                 57660039
558200                     MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)  57670039
558300                     SET DP013-DB2-ABEND                          57680039
558400                         DP013-XCTL-DISPLAY-RESTART TO TRUE       57690039
558500                     PERFORM DP013-0000-PROCESS-ABEND             57700039
558600             END-EVALUATE                                         57710039
558700     END-PERFORM.                                                 57720039
558800*                                                                 57730039
558900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        57740039
559000         MOVE '4330-GET-REQ-DC-SPLIT' TO DP013-PARAGRAPH          57750039
559100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO GET TPURITM'57760039
559200                                   TO DP013-MESSAGE-TEXT (1)      57770039
559300         MOVE SQLCA                TO DP013-SQLCA                 57780039
559400         MOVE 'TPURITM '           TO DP013-DB2-TABLE-NAME (1)    57790039
559500         SET DP013-DB2-ABEND                                      57800039
559600             DP013-XCTL-DISPLAY-RESTART                           57810039
559700                                   TO TRUE                        57820039
559800         PERFORM DP013-0000-PROCESS-ABEND                         57830039
559900     END-IF.                                                      57840039
560000                                                                  57850039
560100     MOVE PV-DB2-COUNT1            TO PV-PO-LINES.                57860039
560200                                                                  57870039
560300                                                                  57880039
560400*----------------------------------------------------------------*57890039
560500* FIND THE CLASS ON THE PO.                                      *57900039
560600*----------------------------------------------------------------*57910039
560700 4360-GET-CLASS.                                                  57920039
560800                                                                  57930039
560900     MOVE SPACES                   TO PV-SUB-CL.                  57940039
561000     MOVE SPACES                   TO PV-MAJ-CL.                  57950039
561100                                                                  57960039
561200     PERFORM 4370-MINOR-CLASS.                                    57970039
561300     IF PV-DB2-COUNT1 > 1                                         57980039
561400         PERFORM 4375-MAJOR-CLASS                                 57990039
561500         IF PV-DB2-COUNT1 > 1                                     58000039
561600             MOVE '**'             TO PV-SUB-CL                   58010039
561700             MOVE '**'             TO PV-MAJ-CL                   58020039
561800         ELSE                                                     58030039
561900             PERFORM 4380-GET-PURITM                              58040039
562000             MOVE '**'             TO PV-SUB-CL                   58050039
562100             MOVE XLT00004-MAJ-CL-NBR TO PV-MAJ-CLASS             58060039
562200         END-IF                                                   58070039
562300     ELSE                                                         58080039
562400         PERFORM 4380-GET-PURITM                                  58090039
562500         MOVE XLT00004-SUB-CL-NBR  TO PV-SUB-CLASS                58100039
562600         MOVE XLT00004-MAJ-CL-NBR  TO PV-MAJ-CLASS                58110039
562700     END-IF.                                                      58120039
562800                                                                  58130039
562900 EJECT                                                            58140039
563000*----------------------------------------------------------------*58150039
563100* DETERMINE IF THE PO HAS ONLY ONE MINOR CLASS.                  *58160039
563200*----------------------------------------------------------------*58170039
563300 4370-MINOR-CLASS.                                                58180039
563400                                                                  58190039
563500     MOVE +0                       TO PV-DB2-COUNT1.              58200039
563600     MOVE DK-PO-NUMBER             TO PURITM-PO-NBR.              58210039
563700     MOVE PC-A                     TO PURITM-VER-STATUS-CDE.      58220039
563800                                                                  58230039
563900     PERFORM                                                      58240039
564000         WITH TEST AFTER                                          58250039
564100         VARYING PV-RETRY-COUNTER                                 58260039
564200         FROM 1 BY 1                                              58270039
564300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               58280039
564400                   OR (SQLCODE = ZERO))                           58290039
564500         EXEC SQL                                                 58300039
564600             SELECT                                               58310039
564700             COUNT(DISTINCT(COALESCE(SUB_CL_NBR,DECIMAL(CL_NBR))))58320039
564800               INTO  :PV-DB2-COUNT1                               58330039
564900               FROM  TPURITM A                                    58340039
565000               LEFT OUTER JOIN                                    58350039
565100                     XLT_SKU S                                    58360039
565200               ON    A.ITM_NBR = S.ITM_NBR                        58370039
565300               LEFT OUTER JOIN                                    58380039
565400                     XLT_VND_STYL V                               58390039
565500               ON    S.STYL_ID = V.STYL_ID                        58400039
565600              WHERE  PO_NBR         = :PURITM-PO-NBR              58410039
565700                AND VER_STATUS_CDE  = :PURITM-VER-STATUS-CDE      58420039
565800         END-EXEC                                                 58430039
565900                                                                  58440039
566000         EVALUATE TRUE                                            58450039
566100                 WHEN SQLCODE = +0                                58460039
566200                     CONTINUE                                     58470039
566300                 WHEN SQLCODE = +100                              58480039
566400                     MOVE +0       TO PV-DB2-COUNT1               58490039
566500                 WHEN SQLCODE = -904                              58500039
566600                 WHEN SQLCODE = -913                              58510039
566700                     CONTINUE                                     58520039
566800                 WHEN SQLWARN0 NOT = SPACES                       58530039
566900                 WHEN SQLCODE < ZERO                              58540039
567000                 WHEN SQLCODE > ZERO                              58550039
567100                     MOVE '4370-MINOR-CLASS'                      58560039
567200                                   TO DP013-PARAGRAPH             58570039
567300                     MOVE '              '                        58580039
567400                                   TO DP013-MESSAGE-TEXT (1)      58590039
567500                     MOVE SQLCA    TO DP013-SQLCA                 58600039
567600                     MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)  58610039
567700                     MOVE 'XLT_SKU ' TO DP013-DB2-TABLE-NAME (2)  58620039
567800                     MOVE 'XLT_VND_STYL '                         58630039
567900                                     TO DP013-DB2-TABLE-NAME (3)  58640039
568000                     SET DP013-DB2-ABEND                          58650039
568100                         DP013-XCTL-DISPLAY-RESTART TO TRUE       58660039
568200                     PERFORM DP013-0000-PROCESS-ABEND             58670039
568300             END-EVALUATE                                         58680039
568400     END-PERFORM.                                                 58690039
568500*                                                                 58700039
568600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        58710039
568700         MOVE '4370-MINOR-CLASS'   TO DP013-PARAGRAPH             58720039
568800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO GET TPURITM'58730039
568900                                   TO DP013-MESSAGE-TEXT (1)      58740039
569000         MOVE SQLCA                TO DP013-SQLCA                 58750039
569100         MOVE 'TPURITM '           TO DP013-DB2-TABLE-NAME (1)    58760039
569200         MOVE 'XLT_SKU '           TO DP013-DB2-TABLE-NAME (2)    58770039
569300         MOVE 'XLT_VND_STYL '      TO DP013-DB2-TABLE-NAME (3)    58780039
569400         SET DP013-DB2-ABEND                                      58790039
569500             DP013-XCTL-DISPLAY-RESTART                           58800039
569600                                   TO TRUE                        58810039
569700         PERFORM DP013-0000-PROCESS-ABEND                         58820039
569800     END-IF.                                                      58830039
569900                                                                  58840039
570000 EJECT                                                            58850039
570100*----------------------------------------------------------------*58860039
570200* DETERMINE IF THE PO HAS ONLY ONE MAJOR CLASS.                  *58870039
570300*----------------------------------------------------------------*58880039
570400 4375-MAJOR-CLASS.                                                58890039
570500                                                                  58900039
570600     MOVE +0                       TO PV-DB2-COUNT1.              58910039
570700     MOVE DK-PO-NUMBER             TO PURITM-PO-NBR.              58920039
570800     MOVE PC-A                     TO PURITM-VER-STATUS-CDE       58930039
570900                                                                  58940039
571000     PERFORM                                                      58950039
571100         WITH TEST AFTER                                          58960039
571200         VARYING PV-RETRY-COUNTER                                 58970039
571300         FROM 1 BY 1                                              58980039
571400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               58990039
571500                   OR (SQLCODE = ZERO))                           59000039
571600         EXEC SQL                                                 59010039
571700             SELECT                                               59020039
571800                     COUNT(DISTINCT(COALESCE(MAJ_CL_NBR,          59030039
571900                             DECIMAL(SUBSTR(CL_NBR,1,1)||'0'))))  59040039
572000               INTO  :PV-DB2-COUNT1                               59050039
572100               FROM  TPURITM A                                    59060039
572200               LEFT OUTER JOIN                                    59070039
572300                     XLT_SKU S                                    59080039
572400               ON    A.ITM_NBR = S.ITM_NBR                        59090039
572500               LEFT OUTER JOIN                                    59100039
572600                     XLT_VND_STYL V                               59110039
572700               ON    S.STYL_ID = V.STYL_ID                        59120039
572800              WHERE  PO_NBR         = :PURITM-PO-NBR              59130039
572900                AND VER_STATUS_CDE  = :PURITM-VER-STATUS-CDE      59140039
573000         END-EXEC                                                 59150039
573100                                                                  59160039
573200         EVALUATE TRUE                                            59170039
573300                 WHEN SQLCODE = +0                                59180039
573400                     CONTINUE                                     59190039
573500                 WHEN SQLCODE = +100                              59200039
573600                     MOVE +0       TO PV-DB2-COUNT1               59210039
573700                 WHEN SQLCODE = -904                              59220039
573800                 WHEN SQLCODE = -913                              59230039
573900                     CONTINUE                                     59240039
574000                 WHEN SQLWARN0 NOT = SPACES                       59250039
574100                 WHEN SQLCODE < ZERO                              59260039
574200                 WHEN SQLCODE > ZERO                              59270039
574300                     MOVE '4375-MAJOR-CLASS'                      59280039
574400                                   TO DP013-PARAGRAPH             59290039
574500                     MOVE '              '                        59300039
574600                                   TO DP013-MESSAGE-TEXT (1)      59310039
574700                     MOVE SQLCA    TO DP013-SQLCA                 59320039
574800                     MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)  59330039
574900                     MOVE 'XLT_SKU ' TO DP013-DB2-TABLE-NAME (2)  59340039
575000                     MOVE 'XLT_VND_STYL '                         59350039
575100                                     TO DP013-DB2-TABLE-NAME (3)  59360039
575200                     SET DP013-DB2-ABEND                          59370039
575300                         DP013-XCTL-DISPLAY-RESTART TO TRUE       59380039
575400                     PERFORM DP013-0000-PROCESS-ABEND             59390039
575500             END-EVALUATE                                         59400039
575600     END-PERFORM.                                                 59410039
575700*                                                                 59420039
575800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        59430039
575900         MOVE '4375-MAJOR-CLASS'   TO DP013-PARAGRAPH             59440039
576000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO GET TPURITM'59450039
576100                                   TO DP013-MESSAGE-TEXT (1)      59460039
576200         MOVE SQLCA                TO DP013-SQLCA                 59470039
576300         MOVE 'TPURITM '           TO DP013-DB2-TABLE-NAME (1)    59480039
576400         MOVE 'XLT_SKU '           TO DP013-DB2-TABLE-NAME (2)    59490039
576500         MOVE 'XLT_VND_STYL '      TO DP013-DB2-TABLE-NAME (3)    59500039
576600         SET DP013-DB2-ABEND                                      59510039
576700             DP013-XCTL-DISPLAY-RESTART                           59520039
576800                                   TO TRUE                        59530039
576900         PERFORM DP013-0000-PROCESS-ABEND                         59540039
577000     END-IF.                                                      59550039
577100                                                                  59560039
577200*----------------------------------------------------------------*59570039
577300* GET THE FIRST PURCHASE ITEM ROW.                               *59580039
577400*----------------------------------------------------------------*59590039
577500 4380-GET-PURITM.                                                 59600039
577600                                                                  59610039
577700     MOVE DK-PO-NUMBER             TO PURITM-PO-NBR               59620039
577800     MOVE PC-A                     TO PURITM-VER-STATUS-CDE       59630039
577900                                                                  59640039
578000     PERFORM                                                      59650039
578100         WITH TEST AFTER                                          59660039
578200         VARYING PV-RETRY-COUNTER                                 59670039
578300         FROM 1 BY 1                                              59680039
578400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               59690039
578500                   OR (SQLCODE = ZERO)                            59700039
578600                   OR (SQLCODE = 100))                            59710039
578700         EXEC SQL                                                 59720039
578800             SELECT  DISTINCT COALESCE(MAJ_CL_NBR,                59730039
578900                              DECIMAL(SUBSTR(CL_NBR,1,1)||'0')),  59740039
579000                              COALESCE(SUB_CL_NBR,DECIMAL(CL_NBR))59750039
579100               INTO  :XLT00004-MAJ-CL-NBR,                        59760039
579200                     :XLT00004-SUB-CL-NBR                         59770039
579300               FROM  TPURITM PUR                                  59780039
579400               LEFT OUTER JOIN                                    59790039
579500                     XLT_SKU SKU                                  59800039
579600               ON    PUR.ITM_NBR = SKU.ITM_NBR                    59810039
579700               LEFT OUTER JOIN                                    59820039
579800                     XLT_VND_STYL VND                             59830039
579900               ON    SKU.STYL_ID = VND.STYL_ID                    59840039
580000              WHERE  PO_NBR         = :PURITM-PO-NBR              59850039
580100                AND  VER_STATUS_CDE = :PURITM-VER-STATUS-CDE      59860039
580200                AND  APP_PO_LNE_NBR =                             59870039
580300                (SELECT MIN(APP_PO_LNE_NBR)                       59880039
580400                  FROM TPURITM A                                  59890039
580500                  WHERE A.PO_NBR = :PURITM-PO-NBR                 59900039
580600                    AND A.VER_STATUS_CDE = :PURITM-VER-STATUS-CDE)59910039
580700         END-EXEC                                                 59920039
580800                                                                  59930039
580900         EVALUATE TRUE                                            59940039
581000                 WHEN SQLCODE = +0                                59950039
581100                 WHEN SQLCODE = +100                              59960039
581200                 WHEN SQLCODE = -904                              59970039
581300                 WHEN SQLCODE = -913                              59980039
581400                     CONTINUE                                     59990039
581500                 WHEN SQLWARN0 NOT = SPACES                       60000039
581600                 WHEN SQLCODE < ZERO                              60010039
581700                 WHEN SQLCODE > ZERO                              60020039
581800                     MOVE '4380-GET-PURITM'                       60030039
581900                                   TO DP013-PARAGRAPH             60040039
582000                     MOVE 'FAILED ORDER:'                         60050039
582100                                   TO DP013-MESSAGE-TEXT (1)      60060039
582200                     MOVE PURITM-PO-NBR                           60070039
582300                                   TO DP013-MESSAGE-TEXT (2)      60080039
582400                     MOVE SQLCA    TO DP013-SQLCA                 60090039
582500                     MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)  60100039
582600                     MOVE 'XLT_SKU ' TO DP013-DB2-TABLE-NAME (2)  60110039
582700                     MOVE 'XLT_VND_STYL'                          60120039
582800                                     TO DP013-DB2-TABLE-NAME (3)  60130039
582900                     SET DP013-DB2-ABEND                          60140039
583000                         DP013-XCTL-DISPLAY-RESTART TO TRUE       60150039
583100                     PERFORM DP013-0000-PROCESS-ABEND             60160039
583200             END-EVALUATE                                         60170039
583300     END-PERFORM.                                                 60180039
583400*                                                                 60190039
583500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        60200039
583600         MOVE '4380-GET-PURITM'    TO DP013-PARAGRAPH             60210039
583700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO GET TPURITM'60220039
583800                                   TO DP013-MESSAGE-TEXT (1)      60230039
583900         MOVE SQLCA                TO DP013-SQLCA                 60240039
584000         MOVE 'TPURITM '           TO DP013-DB2-TABLE-NAME (1)    60250039
584100         MOVE 'XLT_SKU '           TO DP013-DB2-TABLE-NAME (2)    60260039
584200         MOVE 'XLT_VND_STYL'       TO DP013-DB2-TABLE-NAME (3)    60270039
584300         SET DP013-DB2-ABEND                                      60280039
584400             DP013-XCTL-DISPLAY-RESTART                           60290039
584500                                   TO TRUE                        60300039
584600         PERFORM DP013-0000-PROCESS-ABEND                         60310039
584700     END-IF.                                                      60320039
584800                                                                  60330039
584900                                                                  60340039
585000*----------------------------------------------------------------*60350039
585100* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *60360039
585200*----------------------------------------------------------------*60370039
585300                                                                  60380039
585400 4400-MOVE-COMMAREA-TO-SCREEN.                                    60390039
585500     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             60400039
585600         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          60410039
585700         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          60420039
585800             MOVE +1    TO ASC-BLK-SUB                            60430039
585900             PERFORM 5100-WRITE-TEMP-STORAGE                      60440039
586000             ADD +1     TO ASC-BLK-SUB                            60450039
586100             PERFORM 5100-WRITE-TEMP-STORAGE                      60460039
586200             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             60470039
586300                 GIVING PV-BLOCK-NUMBER                           60480039
586400                 REMAINDER PV-REMAINDER                           60490039
586500             IF  PV-REMAINDER > ZERO                              60500039
586600                 ADD +1 TO PV-BLOCK-NUMBER                        60510039
586700             END-IF                                               60520039
586800             MOVE +1    TO ASC-BLK-SUB                            60530039
586900             PERFORM 4410-READ-TEMP-STORAGE                       60540039
587000             ADD +1     TO ASC-BLK-SUB                            60550039
587100                           PV-BLOCK-NUMBER                        60560039
587200             PERFORM 4410-READ-TEMP-STORAGE                       60570039
587300     END-IF.                                                      60580039
587400     MOVE +1            TO ASC-BLK-SUB.                           60590039
587500     COMPUTE ASC-ITEM-SUB =                                       60600039
587600         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              60610039
587700         + PC-ITEMS-PER-PANEL).                                   60620039
587800*                                                                 60630039
587900     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        60640039
588000         ADD +1         TO ASC-BLK-SUB                            60650039
588100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            60660039
588200     END-IF.                                                      60670039
588300*                                                                 60680039
588400     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           60690039
588500         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                60700039
588600     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        60710039
588700     PERFORM 4420-FORMAT-LIST-LINES                               60720039
588800         VARYING PV-SUB                                           60730039
588900         FROM PC-ITEMS-PER-PANEL BY -1                            60740039
589000         UNTIL PV-SUB < +1.                                       60750039
589100*                                                                 60760039
589200     COMPUTE ASC-ITEMS-DISPLAYED =                                60770039
589300         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          60780039
589400     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    60790039
589500                                      ASTRTITO.                   60800039
589600     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    60810039
589700     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    60820039
589800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            60830039
589900                                   TO ASELITO.                    60840039
590000*                                                                 60850039
590100     IF  DP020-MSG-NUMBER-X = SPACE                               60860039
590200         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  60870039
590300*            --- MORE ITEMS TO DISPLAY ----                       60880039
590400             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            60890039
590500             SET DP020-MSG-INFORMATIONAL TO TRUE                  60900039
590600         END-IF                                                   60910039
590700     END-IF.                                                      60920039
590800*----------------------------------------------------------------*60930039
590900*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *60940039
591000*----------------------------------------------------------------*60950039
591100                                                                  60960039
591200 4410-READ-TEMP-STORAGE.                                          60970039
591300                                                                  60980039
591400     EXEC CICS                                                    60990039
591500         READQ TS                                                 61000039
591600             QUEUE (ASC-LIST-QUEUE-NAME)                          61010039
591700             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               61020039
591800             ITEM  (PV-BLOCK-NUMBER)                              61030039
591900             RESP  (PV-CICS-RESP)                                 61040039
592000     END-EXEC.                                                    61050039
592100                                                                  61060039
592200     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       61070039
592300       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     61080039
592400         CONTINUE                                                 61090039
592500     ELSE                                                         61100039
592600         SET DP013-CICS-ABEND     TO TRUE                         61110039
592700         SET DP013-NO-ROLLBACK    TO TRUE                         61120039
592800         MOVE '4410-READ-TEMP-STORAGE'                            61130039
592900                                  TO DP013-PARAGRAPH              61140039
593000         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      61150039
593100                                  TO DP013-MESSAGE-TEXT(1)        61160039
593200         PERFORM DP013-0000-PROCESS-ABEND                         61170039
593300     END-IF.                                                      61180039
593400                                                                  61190039
593500     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             61200039
593600*                                                                 61210039
593700     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         61220039
593800         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               61230039
593900     END-IF.                                                      61240039
594000 EJECT                                                            61250039
594100*----------------------------------------------------------------*61260039
594200*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *61270039
594300*----------------------------------------------------------------*61280039
594400                                                                  61290039
594500 4420-FORMAT-LIST-LINES.                                          61300039
594600     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      61310039
594700         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                61320039
594800         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           61330039
594900         MOVE SPACE              TO MR-SELECTI (PV-SUB)           61340039
595000                                    MR-REL         (PV-SUB)       61350039
595100                                    MR-PO-NUMBER-X (PV-SUB)       61360039
595200                                    MR-RLSE-DAYS-X (PV-SUB)       61370039
595300                                    MR-RLSE-DATE   (PV-SUB)       61380039
595400                                    MR-DPT         (PV-SUB)       61390039
595500                                    MR-VENDOR      (PV-SUB)       61400039
595600                                    MR-SHIP-DATE   (PV-SUB)       61410039
595700                                    MR-CAN-DATE    (PV-SUB)       61420039
595800                                    MR-STATUS      (PV-SUB)       61430039
595900** TKMA888 7/10/03 ********************************************** 61440039
596000* REMOVED 1 LINE                                                  61450039
596100*                                   MR-PO-LINES-X  (PV-SUB)       61460039
596200** TKMA888 7/10/03 ********************************************** 61470039
596300                                    MR-SUB-CLASS   (PV-SUB)       61480039
596400                                    MR-MAJ-CLASS   (PV-SUB)       61490039
596500     ELSE                                                         61500039
596600         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      61510039
596700                                                   > SPACE        61520039
596800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 61530039
596900                                 TO MR-SELECTI (PV-SUB)           61540039
597000         ELSE                                                     61550039
597100             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      61560039
597200                                 TO MR-SELECTI (PV-SUB)           61570039
597300         END-IF                                                   61580039
597400*                                                                 61590039
597500         IF  DP030-SET-CURSOR-TRAILER                             61600039
597600             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)61610039
597700                 > SPACE)                                         61620039
597800               OR (PV-SUB = 1))                                   61630039
597900                SET DP030-SET-CURSOR-APPL-1 TO TRUE               61640039
598000                MOVE -1          TO MR-SELECTL (PV-SUB)           61650039
598100             END-IF                                               61660039
598200         END-IF                                                   61670039
598300*                                                                 61680039
598400         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           61690039
598500             MOVE ASC-REL       (ASC-BLK-SUB ASC-ITEM-SUB)        61700039
598600                                 TO MR-REL (PV-SUB)               61710039
598700             MOVE ASC-PO-NUMBER-N    (ASC-BLK-SUB ASC-ITEM-SUB)   61720039
598800                                 TO MR-PO-NUMBER (PV-SUB)         61730039
598900             MOVE ASC-RLSE-DAYS (ASC-BLK-SUB ASC-ITEM-SUB)        61740039
599000                                 TO MR-RLSE-DAYS (PV-SUB)         61750039
599100             MOVE ASC-RLSE-DATE (ASC-BLK-SUB ASC-ITEM-SUB)        61760039
599200                                 TO MR-RLSE-DATE (PV-SUB)         61770039
599300             MOVE ASC-DPT (ASC-BLK-SUB ASC-ITEM-SUB)              61780039
599400                                 TO MR-DPT (PV-SUB)               61790039
599500             MOVE ASC-VENDOR (ASC-BLK-SUB ASC-ITEM-SUB)           61800039
599600                                 TO MR-VENDOR (PV-SUB)            61810039
599700             MOVE ASC-SHIP-DATE (ASC-BLK-SUB ASC-ITEM-SUB)        61820039
599800                                 TO MR-SHIP-DATE (PV-SUB)         61830039
599900             MOVE ASC-CAN-DATE (ASC-BLK-SUB ASC-ITEM-SUB)         61840039
600000                                 TO MR-CAN-DATE (PV-SUB)          61850039
600100             MOVE ASC-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)           61860039
600200                                 TO MR-STATUS (PV-SUB)            61870039
600300             IF ASC-CMN-ERROR-IND                                 61880039
600400                      (ASC-BLK-SUB ASC-ITEM-SUB) = PC-Y           61890039
600500               MOVE DP015-PINK   TO MR-STATUSC (PV-SUB)           61900039
600600             ELSE                                                 61910039
600700               MOVE DP015-BLUE   TO MR-STATUSC (PV-SUB)           61920039
600800             END-IF                                               61930039
600900** TKMA888 7/10/03 ********************************************** 61940039
601000* REMOVED 2 LINES                                                 61950039
601100*            MOVE ASC-PO-LINES (ASC-BLK-SUB ASC-ITEM-SUB)         61960039
601200*                                TO MR-PO-LINES (PV-SUB)          61970039
601300** TKMA888 7/10/03 ********************************************** 61980039
601400             MOVE ASC-SUB-CLASS (ASC-BLK-SUB ASC-ITEM-SUB)        61990039
601500                                 TO MR-SUB-CLASS (PV-SUB)         62000039
601600             MOVE ASC-MAJ-CLASS (ASC-BLK-SUB ASC-ITEM-SUB)        62010039
601700                                 TO MR-MAJ-CLASS (PV-SUB)         62020039
601800         END-IF                                                   62030039
601900     END-IF.                                                      62040039
602000     SUBTRACT +1 FROM ASC-ITEM-SUB                                62050039
602100     IF  ASC-ITEM-SUB < + 1                                       62060039
602200         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  62070039
602300         MOVE +1                 TO ASC-BLK-SUB                   62080039
602400     END-IF.                                                      62090039
602500******************************************************************62100039
602600** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **62110039
602700** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **62120039
602800** ISSUE A WARNING.                                             **62130039
602900******************************************************************62140039
603000 4430-CHECK-FOR-BEGIN-AND-END.                                    62150039
603100     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       62160039
603200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     62170039
603300*            -- NO END-OF-RANGE SPECFIED ---                      62180039
603400             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            62190039
603500             SET DP020-MSG-WARNING TO TRUE                        62200039
603600             PERFORM 4431-POSITION-AT-WARNING                     62210039
603700         END-IF                                                   62220039
603800     ELSE                                                         62230039
603900         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     62240039
604000*            -- NO BEGINNING-OF-RANGE SPECFIED ---                62250039
604100             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            62260039
604200             SET DP020-MSG-WARNING TO TRUE                        62270039
604300             PERFORM 4431-POSITION-AT-WARNING                     62280039
604400         END-IF                                                   62290039
604500     END-IF.                                                      62300039
604600******************************************************************62310039
604700** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **62320039
604800** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **62330039
604900** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **62340039
605000** POSITION THE CURSOR THERE.                                   **62350039
605100******************************************************************62360039
605200 4431-POSITION-AT-WARNING.                                        62370039
605300     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 62380039
605400                    - PV-TOP-ITEM + 1.                            62390039
605500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      62400039
605600         CONTINUE                                                 62410039
605700     ELSE                                                         62420039
605800         SET DP030-SET-CURSOR-APPL-1                              62430039
605900                                   TO TRUE                        62440039
606000         MOVE -1                   TO MR-SELECTL (PV-SUB)         62450039
606100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         62460039
606200         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         62470039
606300     END-IF.                                                      62480039
606400*                                                                 62490039
606500     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   62500039
606600                    - PV-TOP-ITEM + 1.                            62510039
606700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      62520039
606800         CONTINUE                                                 62530039
606900     ELSE                                                         62540039
607000         SET DP030-SET-CURSOR-APPL-1                              62550039
607100                                   TO TRUE                        62560039
607200         MOVE -1                   TO MR-SELECTL (PV-SUB)         62570039
607300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         62580039
607400         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         62590039
607500     END-IF.                                                      62600039
607600                                                                  62610039
607700 EJECT                                                            62620039
607800                                                                  62630039
607900*----------------------------------------------------------------*62640039
608000* 4500 THRU 4999 PARAGRAPHS - NEW IMPORTS EDITS.                 *62650039
608100*----------------------------------------------------------------*62660039
608200*                                                                *62670039
608300*----------------------------------------------------------------*62680039
608400* EDIT IMPORTS PRE-PACK PURCASE ORDERS                           *62690039
608500*----------------------------------------------------------------*62700039
608600 4500-IMPORTS-PREPACK.                                            62710039
608700                                                                  62720039
608800     PERFORM 4924-FETCH-PACK-CUR.                                 62730039
608900                                                                  62740039
609000     IF PS-EOC-PACK-CURSOR                                        62750039
609100        CONTINUE                                                  62760039
609200     ELSE                                                         62770039
609300                                                                  62780039
609400        PERFORM 4910-OPEN-E-COM-PACK-UPC-CUR                      62790039
609500        SET PS-EOC-E-COM-PACK-UPC-CUR-NO TO TRUE                  62800039
609600        SET PS-PASSED-E-COM-CHECK        TO TRUE                  62810039
609700        PERFORM 4600-CHECK-PACK-FOR-E-COM                         62820039
609800           UNTIL PS-EOC-E-COM-PACK-UPC-CUR                        62830039
609900        PERFORM 4912-CLOSE-E-COM-PACK-UPC-CUR                     62840039
610000                                                                  62850039
610100        PERFORM 4982-COUNT-CANCELED-LINES                         62860039
610200        PERFORM 4984-COUNT-TOTAL-LINES                            62870039
610300                                                                  62880039
610400        EVALUATE TRUE                                             62890039
610500                                                                  62900039
610600          WHEN PV-TYPE-CON-OR-CMN = PC-CON                        62910039
610700                                                                  62920039
610800*           ** DON'T CHECK SPLITS IF ALL LINES CANCELED ***       62930039
610900            IF PV-TOTAL-LINES-PACK = PV-CANCELED-LINES-PACK       62940039
611000              CONTINUE                                            62950039
611100            ELSE                                                  62960039
611200                                                                  62970039
611300                PERFORM 4610-CON-PACK-EDITS                       62980039
611400                                                                  62990039
611500                SET PS-SELECT-PACK-SUM-OK-NO   TO TRUE            63000039
611600                PERFORM 4926-SELECT-PACK-SUM                      63010039
611700                                                                  63020039
611800                SET PS-COUNT-DCS-OK-NO  TO TRUE                   63030039
611900                IF PS-SELECT-PACK-SUM-OK                          63040039
612000                  PERFORM 4928-COUNT-DCS-FOR-PACK                 63050039
612100                END-IF                                            63060039
612200                                                                  63070039
612300*               ***********************************               63080039
612400*               * THE 1ST 3 CONDITIONS MUST BE    *               63090039
612500*               * TRUE TO EDIT DC SPLITS.         *               63100039
612600*               * MESSAGE I MEANS SPLITS ARE      *               63110039
612700*               * NOT DIVISIBLE BY OUTER PACK QTY *               63120039
612800*               ***********************************               63130039
612900                IF PS-SELECT-PACK-SUM-OK                          63140039
613000                  AND PS-COUNT-DCS-OK                             63150039
613100                  AND PV-PACK-UNITS-PER-CTN > 0                   63160039
613200                  AND NOT  PS-MSG-I-ALREADY-SET                   63170039
613300                                                                  63180039
613400                   PERFORM 4930-OPEN-PACK-DC-CURSOR               63190039
613500                   SET PS-DC-SPLIT-INFO-PRESENT-NO TO TRUE        63200039
613600                   SET PS-EOC-PREPACK-DC-CURSOR-NO TO TRUE        63210039
613700                   PERFORM 4510-IMPORTS-PACK-DCS UNTIL            63220039
613800                           PS-EOC-PREPACK-DC-CURSOR               63230039
613900                   PERFORM 4932-CLOSE-PACK-DC-CURSOR              63240039
614000                END-IF                                            63250039
614100            END-IF                                                63260039
614200                                                                  63270039
614300            PERFORM 4938-SELECT-PACK-UPCS                         63280039
614400                                                                  63290039
614500                                                                  63300039
614600          WHEN PV-TYPE-CON-OR-CMN = PC-CMN                        63310039
614700                                                                  63320039
614800              IF PS-MSG-W-ALREADY-SET                             63330039
614900                 CONTINUE                                         63340039
615000              ELSE                                                63350039
615100                 PERFORM 4540-SELECT-IMCNUP-PACK-ASN              63360039
615200                 IF PS-MSG-W-ALREADY-SET                          63370039
615700                    PERFORM 4545-PACK-HAS-EA-ERROR                63380040
615900                 END-IF                                           63390039
616000              END-IF                                              63400039
616100                                                                  63410039
616200*           ** DON'T CHECK SPLITS IF ALL LINES CANCELED ***       63420039
616300            IF PV-TOTAL-LINES-PACK = PV-CANCELED-LINES-PACK       63430039
616400              CONTINUE                                            63440039
616500            ELSE                                                  63450039
616600              PERFORM 4926-SELECT-PACK-SUM                        63460039
616700            END-IF                                                63470039
616800                                                                  63480039
616900        END-EVALUATE                                              63490039
617000                                                                  63500039
617100     END-IF.                                                      63510039
617200                                                                  63520039
617300*----------------------------------------------------------------*63530039
617400 4510-IMPORTS-PACK-DCS.                                           63540039
617500                                                                  63550039
617600     PERFORM 4934-FETCH-PACK-DC-CURSOR.                           63560039
617700                                                                  63570039
617800     IF PS-EOC-PREPACK-DC-CURSOR                                  63580039
617900        CONTINUE                                                  63590039
618000     ELSE                                                         63600039
618100                                                                  63610039
618200        EVALUATE PURCHS-PKGNG-CDE                                 63620039
618300                                                                  63630039
618400            WHEN PC-I                                             63640039
618500                INITIALIZE PV-REMAINDER                           63650039
618600                DIVIDE POPRPK-OTPK-UNT-QTY                        63660039
618700                  INTO PV-PDC-SPLIT-QTY                           63670039
618800                GIVING PV-DC-CART-CT                              63680039
618900                REMAINDER PV-REMAINDER                            63690039
619000                                                                  63700039
619100            WHEN PC-M                                             63710039
619200                INITIALIZE PV-REMAINDER                           63720039
619300                DIVIDE POPRPK-INPK-UNT-QTY                        63730039
619400                  INTO PV-PDC-SPLIT-QTY                           63740039
619500                GIVING PV-DC-CART-CT                              63750039
619600                REMAINDER PV-REMAINDER                            63760039
619700                                                                  63770039
619800        END-EVALUATE                                              63780039
619900                                                                  63790039
620000        IF PV-REMAINDER = ZERO                                    63800039
620100           CONTINUE                                               63810039
620200        ELSE                                                      63820039
620300           IF PS-MSG-I-ALREADY-SET                                63830039
620400              CONTINUE                                            63840039
620500           ELSE                                                   63850039
620600              SET PS-MSG-I-ALREADY-SET   TO TRUE                  63860039
620700              MOVE PC-MSG-I-SPLT-NOT-DVBL-OUTR                    63870039
620800                        TO PV-STATUS-TEXT                         63880039
620900              SET PS-READY-FOR-REL-NO  TO TRUE                    63890039
621000              IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS               63900039
621100                ADD +1       TO PV-NBR-EDIT-ERRORS                63910039
621200                MOVE PC-I                                         63920039
621300                   TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)           63930039
621400              END-IF                                              63940039
621500           END-IF                                                 63950039
621600                                                                  63960039
621700     END-IF.                                                      63970039
621800                                                                  63980039
621900*----------------------------------------------------------------*63990039
622000* IMPORTS PACK PROCESS                                            64000039
622100*----------------------------------------------------------------*64010039
622200 4520-SELECT-IMCNUP-PACK-SKUS.                                    64020039
622300                                                                  64030039
622400     MOVE ZERO   TO PV-DB2-COUNT6.                                64040039
622500                                                                  64050039
622600     EXEC SQL                                                     64060039
622700         SELECT COUNT (*)                                         64070039
622800           INTO :PV-DB2-COUNT6                                    64080039
622900           FROM TIMCNUP  A                                        64090039
623000               ,TPOPRPK  B                                        64100039
623100          WHERE A.PO_NBR         = :PURCHS-PO-NBR                 64110039
623200            AND B.PO_NBR         = A.PO_NBR                       64120039
623300            AND B.PK_SKU_NBR     = A.SKU_NBR                      64130039
623400     END-EXEC.                                                    64140039
623500                                                                  64150039
623600     EVALUATE TRUE                                                64160039
623700         WHEN SQLCODE = ZERO                                      64170039
623800         WHEN SQLCODE = -811                                      64180039
623900         WHEN SQLCODE = +100                                      64190039
624000           IF PV-DB2-COUNT6 = 0                                   64200039
624100              SET PS-MSG-X-ALREADY-SET   TO TRUE                  64210039
624200           END-IF                                                 64220039
624300                                                                  64230039
624400         WHEN SQLWARN0 NOT = SPACES                               64240039
624500         WHEN SQLCODE < ZERO                                      64250039
624600         WHEN SQLCODE > ZERO                                      64260039
624700             MOVE '4520-SELECT-IMCNUP-PACK-SKUS'                  64270039
624800                           TO DP013-PARAGRAPH                     64280039
624900             MOVE '              '                                64290039
625000                           TO DP013-MESSAGE-TEXT (1)              64300039
625100             MOVE SQLCA            TO DP013-SQLCA                 64310039
625200             MOVE 'TIMCNPO ' TO DP013-DB2-TABLE-NAME (1)          64320039
625300             MOVE 'TIMCNUP ' TO DP013-DB2-TABLE-NAME (2)          64330039
625400             SET DP013-DB2-ABEND                                  64340039
625500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               64350039
625600             PERFORM DP013-0000-PROCESS-ABEND                     64360039
625700                                                                  64370039
625800     END-EVALUATE.                                                64380039
625900                                                                  64390039
626000*----------------------------------------------------------------*64400039
626100 4525-NO-PACK-SKU-CMN.                                            64410039
626200                                                                  64420039
626300     SET PS-THERE-ARE-CMN-MSGS  TO TRUE.                          64430039
626400     MOVE PC-MSG-X-NO-PACK-SKU-CMN TO PV-STATUS-TEXT.             64440039
626500     SET PS-READY-FOR-REL-NO  TO TRUE.                            64450039
626600     IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS                        64460039
626700        ADD  +1     TO PV-NBR-EDIT-ERRORS                         64470039
626800        MOVE PC-X   TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)          64480039
626900     END-IF.                                                      64490039
627000                                                                  64500039
627100*----------------------------------------------------------------*64510039
627200 4530-SELECT-IMCNUP-PACK-UPCS.                                    64520039
627300                                                                  64530039
627400     MOVE ZERO   TO PV-DB2-COUNT5.                                64540039
627500                                                                  64550039
627600     EXEC SQL                                                     64560039
627700         SELECT COUNT (*)                                         64570039
627800           INTO :PV-DB2-COUNT5                                    64580039
627900           FROM TIMCNUP  A                                        64590039
628000               ,TPOPRPK  B                                        64600039
628100          WHERE A.PO_NBR         = :PURCHS-PO-NBR                 64610039
628200            AND B.PO_NBR         = A.PO_NBR                       64620039
628300            AND B.PREPK_UPC_NBR  = A.UPC_NBR                      64630039
628400     END-EXEC.                                                    64640039
628500                                                                  64650039
628600     EVALUATE TRUE                                                64660039
628700         WHEN SQLCODE = ZERO                                      64670039
628800         WHEN SQLCODE = -811                                      64680039
628900         WHEN SQLCODE = +100                                      64690039
629000           IF PV-DB2-COUNT5 = 0                                   64700039
629100              SET PS-MSG-Y-ALREADY-SET   TO TRUE                  64710039
629200           END-IF                                                 64720039
629300                                                                  64730039
629400         WHEN SQLWARN0 NOT = SPACES                               64740039
629500         WHEN SQLCODE < ZERO                                      64750039
629600         WHEN SQLCODE > ZERO                                      64760039
629700             MOVE '4530-SELECT-IMCNUP-PACK-UPCS'                  64770039
629800                           TO DP013-PARAGRAPH                     64780039
629900             MOVE '              '                                64790039
630000                           TO DP013-MESSAGE-TEXT (1)              64800039
630100             MOVE SQLCA            TO DP013-SQLCA                 64810039
630200             MOVE 'TIMCNPO ' TO DP013-DB2-TABLE-NAME (1)          64820039
630300             MOVE 'TIMCNUP ' TO DP013-DB2-TABLE-NAME (2)          64830039
630400             SET DP013-DB2-ABEND                                  64840039
630500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               64850039
630600             PERFORM DP013-0000-PROCESS-ABEND                     64860039
630700                                                                  64870039
630800     END-EVALUATE.                                                64880039
630900                                                                  64890039
631000*----------------------------------------------------------------*64900039
631100 4535-NO-PACK-UPC-CMN.                                            64910039
631200                                                                  64920039
631300     SET PS-THERE-ARE-CMN-MSGS  TO TRUE.                          64930039
631400     MOVE PC-MSG-Y-NO-PACK-UPC  TO PV-STATUS-TEXT.                64940039
631500     SET PS-READY-FOR-REL-NO  TO TRUE.                            64950039
631600     IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS                        64960039
631700        ADD  +1     TO PV-NBR-EDIT-ERRORS                         64970039
631800        MOVE PC-Y   TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)          64980039
631900     END-IF.                                                      64990039
632000                                                                  65000039
632100*----------------------------------------------------------------*65010039
632200 4540-SELECT-IMCNUP-PACK-ASN.                                     65020039
632300                                                                  65030039
632400     EXEC SQL                                                     65040039
632500         SELECT B.ASN_PKGNG_CDE                                   65050039
632600           INTO :IMCNUP-ASN-PKGNG-CDE                             65060039
632700           FROM TIMCNPO  A                                        65070039
632800               ,TIMCNUP  B                                        65080039
632900          WHERE A.PO_NBR         = :PURCHS-PO-NBR                 65090039
633000            AND B.PO_NBR         = A.PO_NBR                       65100039
633100            AND ASN_PKGNG_CDE    = 'EA'                           65110039
633200     END-EXEC.                                                    65120039
633300                                                                  65130039
633400     EVALUATE TRUE                                                65140039
633500         WHEN SQLCODE = +100                                      65150039
633600           CONTINUE                                               65160039
633700                                                                  65170039
633800         WHEN SQLCODE = ZERO                                      65180039
633900         WHEN SQLCODE = -811                                      65190039
634000             SET PS-MSG-W-ALREADY-SET   TO TRUE                   65200039
634100                                                                  65210039
634200         WHEN SQLWARN0 NOT = SPACES                               65220039
634300         WHEN SQLCODE < ZERO                                      65230039
634400         WHEN SQLCODE > ZERO                                      65240039
634500             MOVE '4540-SELECT-IMCNUP-PACK-ASN'                   65250039
634600                           TO DP013-PARAGRAPH                     65260039
634700             MOVE '              '                                65270039
634800                           TO DP013-MESSAGE-TEXT (1)              65280039
634900             MOVE SQLCA            TO DP013-SQLCA                 65290039
635000             MOVE 'TIMCNPO ' TO DP013-DB2-TABLE-NAME (1)          65300039
635100             MOVE 'TIMCNUP ' TO DP013-DB2-TABLE-NAME (2)          65310039
635200             SET DP013-DB2-ABEND                                  65320039
635300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               65330039
635400             PERFORM DP013-0000-PROCESS-ABEND                     65340039
635500                                                                  65350039
635600     END-EVALUATE.                                                65360039
635700                                                                  65370039
635800*----------------------------------------------------------------*65380039
635900 4545-PACK-HAS-EA-ERROR.                                          65390039
636000                                                                  65400039
636100     SET PS-THERE-ARE-CMN-MSGS  TO TRUE.                          65410039
636200     MOVE PC-MSG-W-PACK-HAS-EA-CMN  TO PV-STATUS-TEXT.            65420039
636300     SET PS-READY-FOR-REL-NO  TO TRUE.                            65430039
636400     IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS                        65440039
636500        ADD  +1     TO PV-NBR-EDIT-ERRORS                         65450039
636600        MOVE PC-W   TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)          65460039
636700     END-IF.                                                      65470039
636800                                                                  65480039
636900*----------------------------------------------------------------*65490039
637000* EDIT IMPORTS BULK PURCASE ORDERS.                              *65500039
637100*----------------------------------------------------------------*65510039
637200                                                                  65520039
637300 4550-IMPORTS-BULK.                                               65530039
637400                                                                  65540039
637500     PERFORM 4452-CHECK-SKU.                                      65550039
637600     IF PV-DB2-COUNT3 > ZERO                                      65560039
637700         MOVE PC-MSG-E-SKU-OTR-PCK-IMPORTS                        65570039
637800                       TO PV-STATUS-TEXT                          65580039
637900         SET PS-READY-FOR-REL-NO   TO TRUE                        65590039
638000         IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS                    65600039
638100           ADD +1       TO PV-NBR-EDIT-ERRORS                     65610039
638200           MOVE PC-E                                              65620039
638300               TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)               65630039
638400         END-IF                                                   65640039
638500     END-IF.                                                      65650039
638600                                                                  65660039
638700     EVALUATE TRUE                                                65670039
638800                                                                  65680039
638900       WHEN PV-TYPE-CON-OR-CMN = PC-CON                           65690039
639000                                                                  65700039
639100          SET PS-EOC-BULK-UPC-CUR-NO TO TRUE                      65710039
639200          PERFORM 4944-OPEN-BULK-UPC-CUR                          65720039
639300          PERFORM 4560-IMPORTS-CON-BULK-UPCS                      65730039
639400              UNTIL PS-EOC-BULK-UPC-CUR                           65740039
639500          PERFORM 4946-CLOSE-BULK-UPC-CUR                         65750039
639600                                                                  65760039
639700       WHEN PV-TYPE-CON-OR-CMN = PC-CMN                           65770039
639800                                                                  65780039
639900          SET PS-EOC-BULK-UPC-CUR-NO TO TRUE                      65790039
640000          PERFORM 4972-OPEN-CMN-BULK-UPC-CUR                      65800039
640100          PERFORM 4575-IMPORTS-CMN-BULK-UPCS                      65810039
640200              UNTIL PS-EOC-BULK-UPC-CUR                           65820039
640300          PERFORM 4974-CLOSE-CMN-BULK-UPC-CUR                     65830039
640400                                                                  65840039
640500     END-EVALUATE.                                                65850039
640600                                                                  65860039
640700*-----------------------------------------------------------      65870039
640800 4452-CHECK-SKU.                                                  65880039
640900                                                                  65890039
641000     MOVE ZERO                   TO PV-DB2-COUNT3                 65900039
641100     MOVE DK-PO-NUMBER           TO PURITM-PO-NBR                 65910039
641200     MOVE PC-A                   TO PURITM-VER-STATUS-CDE         65920039
641300     EXEC SQL                                                     65930039
641400         SELECT COUNT (*)                                         65940039
641500         INTO :PV-DB2-COUNT3                                      65950039
641600         FROM XLT_SKU A                                           65960039
641700         ,    TPURITM B                                           65970039
641800         WHERE                                                    65980039
641900                 B.PO_NBR           = :PURITM-PO-NBR              65990039
642000            AND  B.VER_STATUS_CDE   = :PURITM-VER-STATUS-CDE      66000039
642100            AND  A.ITM_NBR          = B.ITM_NBR                   66010039
642200            AND  A.OUTR_PK_QTY = 1                                66020039
642300     END-EXEC.                                                    66030039
642400                                                                  66040039
642500     EVALUATE TRUE                                                66050039
642600         WHEN SQLCODE = ZERO                                      66060039
642700         WHEN SQLCODE = -305                                      66070039
642800         WHEN SQLCODE = +100                                      66080039
642900         WHEN SQLCODE = -904                                      66090039
643000         WHEN SQLCODE = -913                                      66100039
643100             CONTINUE                                             66110039
643200         WHEN SQLWARN0 NOT = SPACES                               66120039
643300         WHEN SQLCODE < ZERO                                      66130039
643400         WHEN SQLCODE > ZERO                                      66140039
643500             MOVE '4452-CHECK-SKU'                                66150039
643600                           TO DP013-PARAGRAPH                     66160039
643700             MOVE '              '                                66170039
643800                           TO DP013-MESSAGE-TEXT (1)              66180039
643900             MOVE SQLCA            TO DP013-SQLCA                 66190039
644000             MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)          66200039
644100             MOVE 'XLT_SKU ' TO DP013-DB2-TABLE-NAME (2)          66210039
644200             SET DP013-DB2-ABEND                                  66220039
644300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               66230039
644400             PERFORM DP013-0000-PROCESS-ABEND                     66240039
644500     END-EVALUATE.                                                66250039
644600                                                                  66260039
644700*----------------------------------------------------------------*66270039
644800 4560-IMPORTS-CON-BULK-UPCS.                                      66280039
644900                                                                  66290039
645000     PERFORM 4948-FETCH-BULK-UPC-CUR                              66300039
645100                                                                  66310039
645200     IF PS-EOC-BULK-UPC-CUR                                       66320039
645300       CONTINUE                                                   66330039
645400     ELSE                                                         66340039
645500                                                                  66350039
645600       SET PS-THERE-ARE-E-COM-DCS-NO  TO TRUE                     66360039
645700       PERFORM 4916-CHECK-FOR-E-COM-DCS                           66370039
645800                                                                  66380039
645900       IF PS-THERE-ARE-E-COM-DCS                                  66390039
646000         SET PS-THIS-IS-E-COM-UPC-NO   TO TRUE                    66400039
646100         PERFORM 4918-SELECT-UPC-FROM-TWEBITM                     66410039
646200         IF PS-THIS-IS-E-COM-UPC                                  66420039
646300           CONTINUE                                               66430039
646400         ELSE                                                     66440039
646500            IF PS-MSG-H-ALREADY-SET                               66450039
646600               CONTINUE                                           66460039
646700            ELSE                                                  66470039
646800               SET PS-MSG-H-ALREADY-SET   TO TRUE                 66480039
646900               MOVE PC-MSG-H-NOT-E-COM-ITEM TO PV-STATUS-TEXT     66490039
647000               SET PS-READY-FOR-REL-NO  TO TRUE                   66500039
647100               IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS              66510039
647200                 ADD +1       TO PV-NBR-EDIT-ERRORS               66520039
647300                 MOVE PC-H                                        66530039
647400                     TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)         66540039
647500               END-IF                                             66550039
647600            END-IF                                                66560039
647700         END-IF                                                   66570039
647800       END-IF                                                     66580039
647900                                                                  66590039
648000                                                                  66600039
648100       SET PS-SKUS-FOUND             TO TRUE                      66610039
648200       INITIALIZE PV-UPC-CARTONS                                  66620039
648300       PERFORM 4950-SELECT-VEND-OUTR-PACK-QTY                     66630039
648400       IF PS-SKUS-FOUND-NO                                        66640039
648500             IF PS-MSG-L-ALREADY-SET                              66650039
648600                CONTINUE                                          66660039
648700             ELSE                                                 66670039
648800                SET PS-MSG-L-ALREADY-SET   TO TRUE                66680039
648900                MOVE PC-MSG-L-SKU-NOT-FOUND                       66690039
649000                          TO PV-STATUS-TEXT                       66700039
649100                SET PS-READY-FOR-REL-NO  TO TRUE                  66710039
649200                IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS             66720039
649300                  ADD +1       TO PV-NBR-EDIT-ERRORS              66730039
649400                  MOVE PC-L                                       66740039
649500                     TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)         66750039
649600                END-IF                                            66760039
649700             END-IF                                               66770039
649800       END-IF                                                     66780039
649900                                                                  66790039
650000       IF PURITM-STATUS-CDE = 'AC' OR 'AP'                        66800039
650100           SET PS-CURR-SPLIT-QTY-PRESENT-NO   TO TRUE             66810039
650200           PERFORM 4952-SUM-DC-SPLIT-QTY                          66820039
650300                                                                  66830039
650400           SET PS-COUNT-DCS-OK-NO      TO TRUE                    66840039
650500           PERFORM 4954-COUNT-DCS-FOR-BULK                        66850039
650600                                                                  66860039
650700           IF PS-CURR-SPLIT-QTY-PRESENT                           66870039
650800              AND PS-COUNT-DCS-OK                                 66880039
650900                PERFORM 4956-OPEN-DC-CURSOR                       66890039
651000                SET PS-EOC-DC-CURSOR-NO TO TRUE                   66900039
651100                PERFORM 4570-IMPORTS-CON-BULK-DCS                 66910039
651200                  UNTIL  PS-EOC-DC-CURSOR                         66920039
651300                     OR  PS-MSG-I-ALREADY-SET                     66930039
651400                PERFORM 4958-CLOSE-DC-CURSOR                      66940039
651500           END-IF                                                 66950039
651600       END-IF                                                     66960039
651700                                                                  66970039
651800     END-IF.                                                      66980039
651900                                                                  66990039
652000*----------------------------------------------------------------*67000039
652100 4570-IMPORTS-CON-BULK-DCS.                                       67010039
652200                                                                  67020039
652300     PERFORM 4960-FETCH-DC-CURSOR.                                67030039
652400                                                                  67040039
652500     IF PS-EOC-DC-CURSOR                                          67050039
652600        CONTINUE                                                  67060039
652700     ELSE                                                         67070039
652800        INITIALIZE PV-REMAINDER                                   67080039
652900        IF XLT00003-OUTR-PK-QTY = ZERO                            67090039
653000          CONTINUE                                                67100039
653100        ELSE                                                      67110039
653200          DIVIDE XLT00003-OUTR-PK-QTY INTO                        67120039
653300            ALLPLN-CURR-SPLIT-QTY     GIVING                      67130039
653400            PV-DC-CART-CT                                         67140039
653500            REMAINDER PV-REMAINDER                                67150039
653600        END-IF                                                    67160039
653700        IF PV-REMAINDER = ZERO                                    67170039
653800           CONTINUE                                               67180039
653900        ELSE                                                      67190039
654000           SET PS-MSG-I-ALREADY-SET   TO TRUE                     67200039
654100           MOVE PC-MSG-I-SPLT-NOT-DVBL-OUTR                       67210039
654200                     TO PV-STATUS-TEXT                            67220039
654300           SET PS-READY-FOR-REL-NO  TO TRUE                       67230039
654400           IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS                  67240039
654500             ADD +1       TO PV-NBR-EDIT-ERRORS                   67250039
654600             MOVE PC-I                                            67260039
654700                TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)              67270039
654800           END-IF                                                 67280039
654900     END-IF.                                                      67290039
655000                                                                  67300039
655100*----------------------------------------------------------------*67310039
655200 4575-IMPORTS-CMN-BULK-UPCS.                                      67320039
655300                                                                  67330039
655400     PERFORM 4976-FETCH-CMN-BULK-UPC-CUR.                         67340039
655500                                                                  67350039
655600     IF PS-EOC-BULK-UPC-CUR                                       67360039
655700        CONTINUE                                                  67370039
655800     ELSE                                                         67380039
655900       SET PS-SKUS-FOUND             TO TRUE                      67390039
656000       INITIALIZE PV-UPC-CARTONS                                  67400039
656100       PERFORM 4950-SELECT-VEND-OUTR-PACK-QTY                     67410039
656200                                                                  67420039
656300       IF IMCNUP-ASN-PKGNG-CDE = 'AS'                             67430039
656900         PERFORM 4580-BULK-HAS-AS-ERROR                           67440040
657100       END-IF                                                     67450039
657200                                                                  67460039
657300***    IF PS-SKUS-FOUND-NO                                        67470039
657900***       IF PS-MSG-N-ALREADY-SET                                 67480040
658000***          CONTINUE                                             67490040
658100***       ELSE                                                    67500040
658200***          SET PS-THERE-ARE-CMN-MSGS  TO TRUE                   67510040
658300***          SET PS-MSG-N-ALREADY-SET   TO TRUE                   67520040
658400***          MOVE PC-MSG-N-SKU-NOT-FND-CMN                        67530040
658500***                       TO PV-STATUS-TEXT                       67540039
658600***          SET PS-READY-FOR-REL-NO  TO TRUE                     67550040
658700***          IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS                67560040
658800***             ADD +1       TO PV-NBR-EDIT-ERRORS                67570040
658900***             MOVE PC-N                                         67580040
659000***                  TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)         67590039
659100***          END-IF                                               67600040
659200***       END-IF                                                  67610040
659500***    END-IF                                                     67620039
659600                                                                  67630039
659700       IF PURITM-STATUS-CDE = 'AC' OR 'AP'                        67640039
659800         PERFORM 4952-SUM-DC-SPLIT-QTY                            67650039
659900       END-IF                                                     67660039
660000                                                                  67670039
660100     END-IF.                                                      67680039
660200                                                                  67690039
660300*----------------------------------------------------------------*67700039
660400 4580-BULK-HAS-AS-ERROR.                                          67710039
660500                                                                  67720039
660600     IF PS-MSG-Z-ALREADY-SET                                      67730039
660700        CONTINUE                                                  67740039
660800     ELSE                                                         67750039
660900        SET PS-THERE-ARE-CMN-MSGS  TO TRUE                        67760039
661000        SET PS-MSG-Z-ALREADY-SET   TO TRUE                        67770039
661100        MOVE PC-MSG-Z-BULK-HAS-AS-CMN                             67780039
661200                  TO PV-STATUS-TEXT                               67790039
661300        SET PS-READY-FOR-REL-NO  TO TRUE                          67800039
661400        IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS                     67810039
661500          ADD +1       TO PV-NBR-EDIT-ERRORS                      67820039
661600          MOVE PC-Z                                               67830039
661700             TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)                 67840039
661800        END-IF                                                    67850039
661900     END-IF.                                                      67860039
662000                                                                  67870039
662100*----------------------------------------------------------------*67880039
662200 4600-CHECK-PACK-FOR-E-COM.                                       67890039
662300                                                                  67900039
662400     PERFORM 4914-FETCH-E-COM-PACK-UPC-CUR.                       67910039
662500                                                                  67920039
662600     IF PS-EOC-E-COM-PACK-UPC-CUR                                 67930039
662700                                                                  67940039
662800        EVALUATE TRUE                                             67950039
662900                                                                  67960039
663000           WHEN PV-TTL-E-COM-PACK-UPCS = ZERO                     67970039
663100             AND PV-TTL-BAD-PACK-UPCS = ZERO                      67980039
663200           WHEN PV-TTL-E-COM-PACK-UPCS  = PV-TTL-PACK-UPCS        67990039
663300                                                                  68000039
663400             SET PS-PASSED-E-COM-CHECK TO TRUE                    68010039
663500                                                                  68020039
663600           WHEN OTHER                                             68030039
663700                                                                  68040039
663800             IF PS-MSG-H-ALREADY-SET                              68050039
663900                CONTINUE                                          68060039
664000             ELSE                                                 68070039
664100                SET PS-MSG-H-ALREADY-SET   TO TRUE                68080039
664200                MOVE PC-MSG-H-NOT-E-COM-ITEM TO PV-STATUS-TEXT    68090039
664300                SET PS-READY-FOR-REL-NO  TO TRUE                  68100039
664400                IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS             68110039
664500                  ADD +1       TO PV-NBR-EDIT-ERRORS              68120039
664600                  MOVE PC-H                                       68130039
664700                      TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)        68140039
664800                END-IF                                            68150039
664900             END-IF                                               68160039
665000                                                                  68170039
665100        END-EVALUATE                                              68180039
665200                                                                  68190039
665300        INITIALIZE  PV-TTL-E-COM-PACK-UPCS                        68200039
665400        INITIALIZE  PV-TTL-PACK-UPCS                              68210039
665500        INITIALIZE  PV-TTL-BAD-PACK-UPCS                          68220039
665600                                                                  68230039
665700     ELSE                                                         68240039
665800                                                                  68250039
665900       ADD +1   TO PV-TTL-PACK-UPCS                               68260039
666000       SET PS-THERE-ARE-E-COM-DCS-NO  TO TRUE                     68270039
666100       PERFORM 4916-CHECK-FOR-E-COM-DCS                           68280039
666200                                                                  68290039
666300       IF PS-THERE-ARE-E-COM-DCS                                  68300039
666400          SET PS-THIS-IS-E-COM-UPC-NO  TO TRUE                    68310039
666500          PERFORM 4918-SELECT-UPC-FROM-TWEBITM                    68320039
666600             IF PS-THIS-IS-E-COM-UPC                              68330039
666700               ADD +1   TO PV-TTL-E-COM-PACK-UPCS                 68340039
666800             ELSE                                                 68350039
666900               ADD +1   TO PV-TTL-BAD-PACK-UPCS                   68360039
667000             END-IF                                               68370039
667100       END-IF                                                     68380039
667200                                                                  68390039
667300     END-IF.                                                      68400039
667400                                                                  68410039
667500*-----------------------------------------------------------------68420039
667600 4610-CON-PACK-EDITS.                                             68430039
667700                                                                  68440039
667800     EVALUATE PURCHS-PKGNG-CDE                                    68450039
667900         WHEN PC-I                                                68460039
668000             MOVE POPRPK-OTPK-UNT-QTY TO                          68470039
668100                  PV-PACK-UNITS-PER-CTN                           68480039
668200         WHEN PC-M                                                68490039
668300             MOVE POPRPK-INPK-UNT-QTY TO                          68500039
668400                  PV-PACK-UNITS-PER-CTN                           68510039
668500     END-EVALUATE.                                                68520039
668600                                                                  68530039
668700     PERFORM 4936-SUM-PACK-UNITS.                                 68540039
668800     IF PV-PACK-UNITS-PER-CTN  = ZERO                             68550039
668900       PERFORM 4612-ZERO-OUTR-PACK-ERROR                          68560039
669000     ELSE                                                         68570039
669100         INITIALIZE PV-REMAINDER                                  68580039
669200         DIVIDE PV-PACK-UNITS-PER-CTN INTO                        68590039
669300                PV-TOTAL-PACK-UNITS GIVING                        68600039
669400                PV-PACK-CART-CT                                   68610039
669500                REMAINDER PV-REMAINDER                            68620039
669600     END-IF.                                                      68630039
669700                                                                  68640039
669800     IF PV-REMAINDER = ZERO                                       68650039
669900       CONTINUE                                                   68660039
670000     ELSE                                                         68670039
670100        IF PS-MSG-J-ALREADY-SET                                   68680039
670200           CONTINUE                                               68690039
670300        ELSE                                                      68700039
670400            SET PS-MSG-J-ALREADY-SET   TO TRUE                    68710039
670500            MOVE PC-MSG-J-UNTS-BY-PCK-NOT-EVEN                    68720039
670600                      TO PV-STATUS-TEXT                           68730039
670700            SET PS-READY-FOR-REL-NO  TO TRUE                      68740039
670800            IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS                 68750039
670900              ADD +1       TO PV-NBR-EDIT-ERRORS                  68760039
671000              MOVE PC-J                                           68770039
671100                    TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)          68780039
671200            END-IF                                                68790039
671300        END-IF                                                    68800039
671400     END-IF.                                                      68810039
671500                                                                  68820039
671600     IF POPRPK-PK-SKU-NBR IS ZERO                                 68830039
671700        IF PS-MSG-Q-ALREADY-SET                                   68840039
671800           CONTINUE                                               68850039
671900        ELSE                                                      68860039
672000            SET PS-MSG-Q-ALREADY-SET   TO TRUE                    68870039
672100            MOVE PC-MSG-Q-NO-PACK-SKU                             68880039
672200                      TO PV-STATUS-TEXT                           68890039
672300            SET PS-READY-FOR-REL-NO  TO TRUE                      68900039
672400            IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS                 68910039
672500              ADD +1       TO PV-NBR-EDIT-ERRORS                  68920039
672600              MOVE PC-Q                                           68930039
672700                    TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)          68940039
672800            END-IF                                                68950039
672900        END-IF                                                    68960039
673000     END-IF.                                                      68970039
673100                                                                  68980039
673200     IF POPRPK-PREPK-UPC-NBR IS ZERO                              68990039
673300        IF PS-MSG-1-ALREADY-SET                                   69000039
673400           CONTINUE                                               69010039
673500        ELSE                                                      69020039
673600            SET PS-MSG-1-ALREADY-SET   TO TRUE                    69030039
673700            MOVE PC-MSG-1-NO-PACK-UPC                             69040039
673800                      TO PV-STATUS-TEXT                           69050039
673900            SET PS-READY-FOR-REL-NO  TO TRUE                      69060039
674000            IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS                 69070039
674100              ADD +1       TO PV-NBR-EDIT-ERRORS                  69080039
674200              MOVE PC-1                                           69090039
674300                    TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)          69100039
674400            END-IF                                                69110039
674500        END-IF                                                    69120039
674600     END-IF.                                                      69130039
674700                                                                  69140039
674800*-----------------------------------------------------------------69150039
674900 4612-ZERO-OUTR-PACK-ERROR.                                       69160039
675000                                                                  69170039
675100     IF PS-MSG-R-ALREADY-SET                                      69180039
675200        CONTINUE                                                  69190039
675300     ELSE                                                         69200039
675400        SET PS-MSG-R-ALREADY-SET   TO TRUE                        69210039
675500        MOVE PC-MSG-R-OUTPK-UNITS-ZERO                            69220039
675600               TO PV-STATUS-TEXT                                  69230039
675700        SET PS-READY-FOR-REL-NO  TO TRUE                          69240039
675800        IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS                     69250039
675900          ADD +1       TO PV-NBR-EDIT-ERRORS                      69260039
676000          MOVE PC-R                                               69270039
676100               TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)               69280039
676200        END-IF                                                    69290039
676300     END-IF.                                                      69300039
676400                                                                  69310039
676500     INITIALIZE PV-PACK-CART-CT.                                  69320039
676600                                                                  69330039
676700*-----------------------------------------------------------------69340039
676800 4620-CHECK-RACF-ACCESS-CMN.                                      69350039
676900                                                                  69360039
677000     SET DP008-RSRC-TYPE-FUNC     TO TRUE.                        69370039
677100     MOVE 'TRERRMSG'              TO DP008-FUNCTION-NAME.         69380039
677200     SET DP008-ACCESS-TYPE-USE    TO TRUE.                        69390039
677300                                                                  69400039
677400     EXEC CICS                                                    69410039
677500        LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                  69420039
677600             COMMAREA (DP008-SECURITY-COMMAREA)                   69430039
677700             LENGTH (DP008-SECURITY-COMMAREA-LENGTH)              69440039
677800     END-EXEC.                                                    69450039
677900                                                                  69460039
678000     IF DP008-CALL-SUCCESSFUL                                     69470039
678100         CONTINUE                                                 69480039
678200     ELSE                                                         69490039
678300        MOVE '4620-CHECK-RACF-ACCESS-CMN'                         69500039
678400                              TO DP013-PARAGRAPH                  69510039
678500         MOVE 'UNABLE TO ACCESS CICS'                             69520039
678600                              TO DP013-MESSAGE-TEXT (1)           69530039
678700         MOVE SQLCA           TO DP013-SQLCA                      69540039
678800         SET DP013-DB2-ABEND                                      69550039
678900             DP013-XCTL-DISPLAY-RESTART                           69560039
679000                              TO TRUE                             69570039
679100         PERFORM DP013-0000-PROCESS-ABEND                         69580039
679200     END-IF.                                                      69590039
679300                                                                  69600039
679400*-----------------------------------------------------------------69610039
679500 4910-OPEN-E-COM-PACK-UPC-CUR.                                    69620039
679600                                                                  69630039
679700     MOVE PURCHS-PO-NBR       TO PURITM-PO-NBR                    69640039
679800     MOVE PC-A                TO PURITM-VER-STATUS-CDE            69650039
679900                                 POPRPK-PREPK-STAT-CDE            69660039
680000     MOVE POPRPK-PO-PREPK-ID  TO PURITM-PO-PREPK-ID               69670039
680100     MOVE PC-I                TO XLT00006-UPC-TYP-CDE             69680039
680200                                                                  69690039
680300     EXEC SQL                                                     69700039
680400         OPEN E_COM_PACK_UPC_CUR                                  69710039
680500     END-EXEC.                                                    69720039
680600                                                                  69730039
680700     EVALUATE TRUE                                                69740039
680800         WHEN SQLWARN0 NOT EQUAL SPACE                            69750039
680900         WHEN SQLCODE NOT EQUAL ZERO                              69760039
681000             MOVE '4910-OPEN-E-COM-PACK-UPC-CUR'                  69770039
681100                                      TO DP013-PARAGRAPH          69780039
681200             MOVE 'UNSUCCESSFUL OPEN ' TO DP013-MESSAGE-TEXT (1)  69790039
681300             MOVE SQLCA TO DP013-SQLCA                            69800039
681400             MOVE '        ' TO DP013-DB2-TABLE-NAME (1)          69810039
681500                SET DP013-DB2-ABEND                               69820039
681600                    DP013-XCTL-DISPLAY-RESTART TO TRUE            69830039
681700             PERFORM DP013-0000-PROCESS-ABEND                     69840039
681800                                                                  69850039
681900     END-EVALUATE.                                                69860039
682000*-----------------------------------------------------------------69870039
682100 4912-CLOSE-E-COM-PACK-UPC-CUR.                                   69880039
682200                                                                  69890039
682300     EXEC SQL                                                     69900039
682400         CLOSE E_COM_PACK_UPC_CUR                                 69910039
682500     END-EXEC.                                                    69920039
682600                                                                  69930039
682700     EVALUATE TRUE                                                69940039
682800         WHEN SQLWARN0 NOT EQUAL SPACE                            69950039
682900         WHEN SQLCODE NOT EQUAL ZERO                              69960039
683000             MOVE '4912-CLOSE-E-COM-PACK-UPC-CUR'                 69970039
683100                                      TO DP013-PARAGRAPH          69980039
683200             MOVE 'UNSUCCESSFUL CLOSE' TO DP013-MESSAGE-TEXT (1)  69990039
683300             MOVE SQLCA TO DP013-SQLCA                            70000039
683400             MOVE '        ' TO DP013-DB2-TABLE-NAME (1)          70010039
683500                SET DP013-DB2-ABEND                               70020039
683600                    DP013-XCTL-DISPLAY-RESTART TO TRUE            70030039
683700             PERFORM DP013-0000-PROCESS-ABEND                     70040039
683800                                                                  70050039
683900     END-EVALUATE.                                                70060039
684000                                                                  70070039
684100*-----------------------------------------------------------------70080039
684200 4914-FETCH-E-COM-PACK-UPC-CUR.                                   70090039
684300                                                                  70100039
684400     EXEC SQL                                                     70110039
684500          FETCH E_COM_PACK_UPC_CUR                                70120039
684600          INTO                                                    70130039
684700               :XLT00006-UPC-NBR                                  70140039
684800              ,:PURITM-PO-LNE-NBR                                 70150039
684900     END-EXEC.                                                    70160039
685000                                                                  70170039
685100     EVALUATE TRUE                                                70180039
685200         WHEN SQLCODE = ZERO                                      70190039
685300             CONTINUE                                             70200039
685400                                                                  70210039
685500         WHEN SQLCODE = +100                                      70220039
685600              SET PS-EOC-E-COM-PACK-UPC-CUR  TO TRUE              70230039
685700                                                                  70240039
685800         WHEN SQLWARN0 NOT EQUAL SPACE                            70250039
685900         WHEN SQLCODE NOT EQUAL ZERO                              70260039
686000             MOVE '4914-FETCH-E-COM-PACK-UPC-CUR'                 70270039
686100                                      TO DP013-PARAGRAPH          70280039
686200             MOVE 'UNSUCCESSFUL FETCH'                            70290039
686300                              TO DP013-MESSAGE-TEXT (1)           70300039
686400             MOVE SQLCA TO DP013-SQLCA                            70310039
686500             MOVE '        '  TO DP013-DB2-TABLE-NAME (1)         70320039
686600                SET DP013-DB2-ABEND                               70330039
686700                    DP013-XCTL-DISPLAY-RESTART TO TRUE            70340039
686800             PERFORM DP013-0000-PROCESS-ABEND                     70350039
686900     END-EVALUATE.                                                70360039
687000                                                                  70370039
687100*-----------------------------------------------------------------70380039
687200* NOTE: CHECK FOR RV STATUS BECAUSE WE DO A SEPERATE              70390039
687300*       SPECIFIC MESSAGE 'UNCONFIRMED PACKS' AND DON'T WANT       70400039
687400*       TO DISPLAY THIS MESSAGE AS WELL.                          70410039
687500*-------------------------------------------------------------    70420039
687600 4916-CHECK-FOR-E-COM-DCS.                                        70430039
687700*                                                                 70440039
687800     INITIALIZE PV-NBR-OF-E-COM-DCS.                              70450039
687900     MOVE PURCHS-PO-NBR TO PURITM-PO-NBR                          70460039
688000     MOVE PC-A          TO PURITM-VER-STATUS-CDE                  70470039
688100*                                                                 70480039
688200     EXEC SQL                                                     70490039
688300           SELECT                                                 70500039
688400                   COUNT(*)                                       70510039
688500             INTO                                                 70520039
688600                  :PV-NBR-OF-E-COM-DCS                            70530039
688700             FROM                                                 70540039
688800                XLT_SKU   SKU                                     70550039
688900                 ,XLT_UPC   UPC                                   70560039
689000                 ,TPURITM   PUR                                   70570039
689100                 ,TALLPLN   AL                                    70580039
689100                 ,XMT_LOC   LOC                                   70590051
689200             WHERE UPC.UPC_NBR        = :XLT00006-UPC-NBR         70600039
689300               AND SKU.INTR_UPC_ID    =  UPC.INTR_UPC_ID          70610039
689400               AND PUR.ITM_NBR        =  SKU.ITM_NBR              70620039
689500               AND PUR.PO_NBR         = :PURITM-PO-NBR            70630039
689600               AND PUR.PO_LNE_NBR     = :PURITM-PO-LNE-NBR        70640039
689700               AND PUR.VER_STATUS_CDE = :PURITM-VER-STATUS-CDE    70650039
689800               AND PUR.STATUS_CDE     IN ('AC', 'AP', 'RV')       70660039
689900               AND AL.PO_LNE_NBR      =  PUR.PO_LNE_NBR           70670039
690000               AND AL.PO_NBR          =  PUR.PO_NBR               70680039
690100               AND AL.DEST_NBR        =  LOC.LOC_NBR              70690050
690100               AND LOC.LOC_TYP_CDE    =  'DC'                     70700050
690100               AND LOC.E_BUS_IND      =  'Y'                      70710050
690200               AND AL.CURR_SPLIT_QTY  >  0                        70720039
690300     END-EXEC                                                     70730039
690400                                                                  70740039
690500     EVALUATE TRUE                                                70750039
690600         WHEN SQLCODE = ZERO                                      70760039
690700         WHEN SQLCODE = -811                                      70770039
690800            IF PV-NBR-OF-E-COM-DCS > 0                            70780039
690900              SET PS-THERE-ARE-E-COM-DCS  TO TRUE                 70790039
691000            END-IF                                                70800039
691100                                                                  70810039
691200         WHEN SQLCODE = +100                                      70820039
691300              CONTINUE                                            70830039
691400                                                                  70840039
691500         WHEN SQLWARN0 NOT EQUAL SPACE                            70850039
691600         WHEN SQLCODE NOT EQUAL ZERO                              70860039
691700             MOVE '4916-CHECK-FOR-E-COM-DCS'                      70870039
691800                                      TO DP013-PARAGRAPH          70880039
691900             MOVE 'UNSUCCESSFUL SELECT'                           70890039
692000                              TO DP013-MESSAGE-TEXT (1)           70900039
692100             MOVE SQLCA TO DP013-SQLCA                            70910039
692200             MOVE '        '  TO DP013-DB2-TABLE-NAME (1)         70920039
692300                SET DP013-DB2-ABEND                               70930039
692400                    DP013-XCTL-DISPLAY-RESTART TO TRUE            70940039
692500             PERFORM DP013-0000-PROCESS-ABEND                     70950039
692600     END-EVALUATE.                                                70960039
692700                                                                  70970039
692800*-----------------------------------------------------------------70980039
692900* NOTE: CHECK FOR RV STATUS BECAUSE WE DO A SEPERATE              70990039
693000*       SPECIFIC MESSAGE 'UNCONFIRMED PACKS' AND DON'T WANT       71000039
693100*       TO DISPLAY THIS MESSAGE AS WELL.                          71010039
693200* SPECIAL NOTE :  TWEBITM AND TPURCHS TABLE ARE NOT REPLACED BY   71020039
693300*                 LOGISTICS DOMAIN TABLES BECAUSE OF PERFORMANCE  71030039
693400*                 ISSUES.                                         71040039
693500*-------------------------------------------------------------    71050039
693600 4918-SELECT-UPC-FROM-TWEBITM.                                    71060039
693700*                                                                 71070039
693800     INITIALIZE PV-NBR-OF-E-COM-ROWS.                             71080039
693900     MOVE PURCHS-PO-NBR       TO PURITM-PO-NBR                    71090039
694000     MOVE PC-A                TO PURITM-VER-STATUS-CDE            71100039
694100                                                                  71110039
694200     EXEC SQL                                                     71120039
694300           SELECT COUNT (*)                                       71130039
694400           INTO   :PV-NBR-OF-E-COM-ROWS                           71140039
694500           FROM TUPCPLS A                                         71150039
694600              , TWEBITM B                                         71160039
694700              , TUPCSKU   SKU                                     71170039
694800              , TPURITM   PUR                                     71180039
694900           WHERE SKU.UPC_NBR          = :XLT00006-UPC-NBR         71190039
695000               AND PUR.ITM_NBR        =  SKU.ITEM_NBR             71200039
695100               AND PUR.PO_NBR         = :PURITM-PO-NBR            71210039
695200               AND PUR.VER_STATUS_CDE = :PURITM-VER-STATUS-CDE    71220039
695300               AND PUR.STATUS_CDE    IN ('AC', 'AP', 'RV')        71230039
695400               AND A.ITM_NBR          =  PUR.ITM_NBR              71240039
695500               AND A.OPERCO_NBR       = '03'                      71250039
695600               AND A.STR_NBR          = 0                         71260039
695700               AND ((A.EFF_BEG_TMST <= CURRENT_TIMESTAMP AND      71270039
695800                       A.EFF_END_TMST IS NULL) OR                 71280039
695900                      (A.EFF_BEG_TMST <= CURRENT_TIMESTAMP AND    71290039
696000                       A.EFF_END_TMST  > CURRENT_TIMESTAMP))      71300039
696100               AND A.UPC_ID        = B.INTR_UPC_ID                71310039
696200               AND (B.EFF_BEG_TMST <= CURRENT_TIMESTAMP AND       71320039
696300                         B.EFF_END_TMST IS NULL)                  71330039
696400     END-EXEC                                                     71340039
696500                                                                  71350039
696600     EVALUATE TRUE                                                71360039
696700         WHEN SQLCODE = ZERO                                      71370039
696800         WHEN SQLCODE = -811                                      71380039
696900            IF PV-NBR-OF-E-COM-ROWS > ZERO                        71390039
697000              SET PS-THIS-IS-E-COM-UPC    TO TRUE                 71400039
697100            END-IF                                                71410039
697200                                                                  71420039
697300         WHEN SQLCODE = +100                                      71430039
697400              CONTINUE                                            71440039
697500                                                                  71450039
697600         WHEN SQLWARN0 NOT EQUAL SPACE                            71460039
697700         WHEN SQLCODE NOT EQUAL ZERO                              71470039
697800             MOVE '4918-SELECT-UPC-FROM-TWEBITM'                  71480039
697900                                      TO DP013-PARAGRAPH          71490039
698000             MOVE 'UNSUCCESSFUL SELECT'                           71500039
698100                              TO DP013-MESSAGE-TEXT (1)           71510039
698200             MOVE SQLCA TO DP013-SQLCA                            71520039
698300             MOVE 'TUPCPLS '  TO DP013-DB2-TABLE-NAME (1)         71530039
698400             MOVE 'TWEBITM '  TO DP013-DB2-TABLE-NAME (2)         71540039
698500             MOVE 'TUPCSKU '  TO DP013-DB2-TABLE-NAME (3)         71550039
698600             MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (4)         71560039
698700                SET DP013-DB2-ABEND                               71570039
698800                    DP013-XCTL-DISPLAY-RESTART TO TRUE            71580039
698900             PERFORM DP013-0000-PROCESS-ABEND                     71590039
699000     END-EVALUATE.                                                71600039
699100                                                                  71610039
699200*-----------------------------------------------------------------71620039
699300 4920-OPEN-PACK-CUR.                                              71630039
699400                                                                  71640039
699500     EXEC SQL                                                     71650039
699600          OPEN POPRPK_FOR_PCK_CUR                                 71660039
699700     END-EXEC.                                                    71670039
699800                                                                  71680039
699900     EVALUATE TRUE                                                71690039
700000         WHEN SQLWARN0 NOT EQUAL SPACE                            71700039
700100         WHEN SQLCODE NOT EQUAL ZERO                              71710039
700200             MOVE '4920-OPEN-PACK-CUR'                            71720039
700300                                      TO DP013-PARAGRAPH          71730039
700400             MOVE 'UNSUCCESSFUL OPEN'                             71740039
700500                              TO DP013-MESSAGE-TEXT (1)           71750039
700600             MOVE SQLCA TO DP013-SQLCA                            71760039
700700             MOVE 'TPOPRPK'  TO DP013-DB2-TABLE-NAME (1)          71770039
700800             SET DP013-DB2-ABEND                                  71780039
700900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               71790039
701000             PERFORM DP013-0000-PROCESS-ABEND                     71800039
701100     END-EVALUATE.                                                71810039
701200                                                                  71820039
701300*-----------------------------------------------------------------71830039
701400 4922-CLOSE-PACK-CUR.                                             71840039
701500                                                                  71850039
701600     EXEC SQL                                                     71860039
701700         CLOSE POPRPK_FOR_PCK_CUR                                 71870039
701800     END-EXEC.                                                    71880039
701900                                                                  71890039
702000     EVALUATE TRUE                                                71900039
702100         WHEN SQLWARN0 NOT EQUAL SPACE                            71910039
702200         WHEN SQLCODE NOT EQUAL ZERO                              71920039
702300             MOVE '4922-CLOSE-PACK-CUR'                           71930039
702400                                      TO DP013-PARAGRAPH          71940039
702500             MOVE 'UNSUCCESSFUL CLOSE'                            71950039
702600                              TO DP013-MESSAGE-TEXT (1)           71960039
702700             MOVE SQLCA TO DP013-SQLCA                            71970039
702800             MOVE 'TPOPRPK'  TO DP013-DB2-TABLE-NAME (1)          71980039
702900             SET DP013-DB2-ABEND                                  71990039
703000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               72000039
703100             PERFORM DP013-0000-PROCESS-ABEND                     72010039
703200     END-EVALUATE.                                                72020039
703300                                                                  72030039
703400*-----------------------------------------------------------------72040039
703500 4924-FETCH-PACK-CUR.                                             72050039
703600                                                                  72060039
703700     EXEC SQL                                                     72070039
703800          FETCH POPRPK_FOR_PCK_CUR                                72080039
703900          INTO                                                    72090039
704000               :POPRPK-PO-PREPK-ID                                72100039
704100             , :POPRPK-INPK-UNT-QTY                               72110039
704200             , :POPRPK-OTPK-UNT-QTY                               72120039
704300             , :POPRPK-PREPK-DESC                                 72130039
704400             , :POPRPK-PREPK-UPC-NBR                              72140039
704500             , :POPRPK-PK-SKU-NBR                                 72150039
704600     END-EXEC.                                                    72160039
704700                                                                  72170039
704800     EVALUATE TRUE                                                72180039
704900         WHEN SQLCODE = ZERO                                      72190039
705000             CONTINUE                                             72200039
705100                                                                  72210039
705200         WHEN SQLCODE = +100                                      72220039
705300              SET PS-EOC-PACK-CURSOR TO TRUE                      72230039
705400                                                                  72240039
705500         WHEN SQLWARN0 NOT EQUAL SPACE                            72250039
705600         WHEN SQLCODE NOT EQUAL ZERO                              72260039
705700             MOVE '4924-FETCH-PACK-CUR'                           72270039
705800                                      TO DP013-PARAGRAPH          72280039
705900             MOVE 'UNSUCCESSFUL FETCH'                            72290039
706000                              TO DP013-MESSAGE-TEXT (1)           72300039
706100             MOVE SQLCA TO DP013-SQLCA                            72310039
706200             MOVE 'TPOPRPK'  TO DP013-DB2-TABLE-NAME (1)          72320039
706300             SET DP013-DB2-ABEND                                  72330039
706400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               72340039
706500             PERFORM DP013-0000-PROCESS-ABEND                     72350039
706600     END-EVALUATE.                                                72360039
706700                                                                  72370039
706800*-----------------------------------------------------------------72380039
706900* NOTE: CHECK FOR RV STATUS BECAUSE WE DO A SEPERATE              72390039
707000*       SPECIFIC MESSAGE 'UNCONFIRMED PACKS' AND DON'T WANT       72400039
707100*       TO DISPLAY THIS MESSAGE AS WELL.                          72410039
707200*-------------------------------------------------------------    72420039
707300 4926-SELECT-PACK-SUM.                                            72430039
707400                                                                  72440039
707500     EXEC SQL                                                     72450039
707600           SELECT                                                 72460039
707700                  SUM (A.CURR_SPLIT_QTY)                          72470039
707800             INTO                                                 72480039
707900                  :PV-TOTAL-PACK-SPLIT-QTY                        72490039
708000             FROM                                                 72500039
708100                  TALLPLN  A                                      72510039
708200                 ,TPURITM  B                                      72520039
708300                                                                  72530039
708400             WHERE A.PO_NBR      =  :PURCHS-PO-NBR                72540039
708500               AND A.PO_NBR      =  B.PO_NBR                      72550039
708600               AND A.PO_LNE_NBR  =  B.PO_LNE_NBR                  72560039
708700               AND A.CURR_SPLIT_QTY  > 0                          72570039
708800               AND B.PO_PREPK_ID =  :POPRPK-PO-PREPK-ID           72580039
708900               AND B.VER_STATUS_CDE = :PC-A                       72590039
709000               AND B.STATUS_CDE IN ('AC', 'AP', 'RV')             72600039
709100     END-EXEC.                                                    72610039
709200                                                                  72620039
709300     EVALUATE TRUE                                                72630039
709400         WHEN SQLCODE = ZERO AND PV-TOTAL-PACK-SPLIT-QTY > 0      72640039
709500           SET PS-SELECT-PACK-SUM-OK     TO TRUE                  72650039
709600                                                                  72660039
709700         WHEN SQLCODE = ZERO AND PV-TOTAL-PACK-SPLIT-QTY = 0      72670039
709800         WHEN SQLCODE = +100                                      72680039
709900         WHEN SQLCODE = -305                                      72690039
710000             IF PS-MSG-D-ALREADY-SET                              72700039
710100                CONTINUE                                          72710039
710200             ELSE                                                 72720039
710300                SET PS-MSG-D-ALREADY-SET   TO TRUE                72730039
710400                MOVE PC-MSG-D-REQ-DC-SPLIT                        72740039
710500                          TO PV-STATUS-TEXT                       72750039
710600                SET PS-READY-FOR-REL-NO  TO TRUE                  72760039
710700                IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS             72770039
710800                  ADD +1       TO PV-NBR-EDIT-ERRORS              72780039
710900                  MOVE PC-D                                       72790039
711000                     TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)         72800039
711100                END-IF                                            72810039
711200             END-IF                                               72820039
711300                                                                  72830039
711400                                                                  72840039
711500         WHEN SQLWARN0 NOT EQUAL SPACE                            72850039
711600         WHEN SQLCODE NOT EQUAL ZERO                              72860039
711700             MOVE '4926-SELECT-PACK-SUM'                          72870039
711800                                      TO DP013-PARAGRAPH          72880039
711900             MOVE 'UNSUCCESSFUL SELECT'                           72890039
712000                              TO DP013-MESSAGE-TEXT (1)           72900039
712100             MOVE SQLCA TO DP013-SQLCA                            72910039
712200             MOVE '       '  TO DP013-DB2-TABLE-NAME (1)          72920039
712300             SET DP013-DB2-ABEND                                  72930039
712400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               72940039
712500             PERFORM DP013-0000-PROCESS-ABEND                     72950039
712600     END-EVALUATE.                                                72960039
712700                                                                  72970039
712800******************************************************************72980039
712900* COUNT THE DCS FOR THIS PACK.                                   *72990039
713000******************************************************************73000039
713100*-----------------------------------------------------------------73010039
713200* NOTE: CHECK FOR RV STATUS BECAUSE WE DO A SEPERATE              73020039
713300*       SPECIFIC MESSAGE 'UNCONFIRMED PACKS' AND DON'T WANT       73030039
713400*       TO DISPLAY THIS MESSAGE AS WELL.                          73040039
713500*-------------------------------------------------------------    73050039
713600 4928-COUNT-DCS-FOR-PACK.                                         73060039
713700                                                                  73070039
713800     EXEC SQL                                                     73080039
713900           SELECT                                                 73090039
714000                  COUNT(DISTINCT A.DEST_NBR)                      73100039
714100             INTO                                                 73110039
714200                  :PV-TOTAL-NBR-OF-DCS                            73120039
714300             FROM                                                 73130039
714400                  TALLPLN  A                                      73140039
714500                 ,TPURITM  B                                      73150039
714600                                                                  73160039
714700             WHERE A.PO_NBR      =  :PURCHS-PO-NBR                73170039
714800               AND A.PO_NBR      =  B.PO_NBR                      73180039
714900               AND A.PO_LNE_NBR  =  B.PO_LNE_NBR                  73190039
715000               AND A.CURR_SPLIT_QTY  > 0                          73200039
715100               AND B.PO_PREPK_ID =  :POPRPK-PO-PREPK-ID           73210039
715200               AND B.VER_STATUS_CDE = :PC-A                       73220039
715300               AND B.STATUS_CDE IN ('AC', 'AP', 'RV')             73230039
715400     END-EXEC.                                                    73240039
715500                                                                  73250039
715600     EVALUATE TRUE                                                73260039
715700         WHEN SQLCODE = ZERO AND PV-TOTAL-NBR-OF-DCS  > 0         73270039
715800*          ***************************************************    73280039
715900*          * IF THERE ARE MORE DCS THAN CARTONS - SEND MESSAGE    73290039
716000*          ***************************************************    73300039
716100           IF PV-PACK-CART-CT  < PV-TOTAL-NBR-OF-DCS              73310039
716200             IF PS-MSG-K-ALREADY-SET                              73320039
716300                CONTINUE                                          73330039
716400             ELSE                                                 73340039
716500                SET PS-MSG-K-ALREADY-SET   TO TRUE                73350039
716600                MOVE PC-MSG-K-CARTS-LESS-THAN-DCS                 73360039
716700                          TO PV-STATUS-TEXT                       73370039
716800                SET PS-READY-FOR-REL-NO  TO TRUE                  73380039
716900                IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS             73390039
717000                  ADD +1       TO PV-NBR-EDIT-ERRORS              73400039
717100                  MOVE PC-K                                       73410039
717200                     TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)         73420039
717300                END-IF                                            73430039
717400             END-IF                                               73440039
717500           ELSE                                                   73450039
717600             SET PS-COUNT-DCS-OK           TO TRUE                73460039
717700           END-IF                                                 73470039
717800                                                                  73480039
717900         WHEN SQLCODE = +100                                      73490039
718000         WHEN SQLCODE = -305                                      73500039
718100             IF PS-MSG-D-ALREADY-SET                              73510039
718200                CONTINUE                                          73520039
718300             ELSE                                                 73530039
718400                SET PS-MSG-D-ALREADY-SET   TO TRUE                73540039
718500                MOVE PC-MSG-D-REQ-DC-SPLIT                        73550039
718600                          TO PV-STATUS-TEXT                       73560039
718700                SET PS-READY-FOR-REL-NO  TO TRUE                  73570039
718800                IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS             73580039
718900                  ADD +1       TO PV-NBR-EDIT-ERRORS              73590039
719000                  MOVE PC-D                                       73600039
719100                     TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)         73610039
719200                END-IF                                            73620039
719300             END-IF                                               73630039
719400                                                                  73640039
719500                                                                  73650039
719600         WHEN SQLWARN0 NOT EQUAL SPACE                            73660039
719700         WHEN SQLCODE NOT EQUAL ZERO                              73670039
719800             MOVE '4928-COUNT-DCS-FOR-PACK'                       73680039
719900                                      TO DP013-PARAGRAPH          73690039
720000             MOVE 'UNSUCCESSFUL SELECT'                           73700039
720100                              TO DP013-MESSAGE-TEXT (1)           73710039
720200             MOVE SQLCA TO DP013-SQLCA                            73720039
720300             MOVE '       '  TO DP013-DB2-TABLE-NAME (1)          73730039
720400             SET DP013-DB2-ABEND                                  73740039
720500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               73750039
720600             PERFORM DP013-0000-PROCESS-ABEND                     73760039
720700     END-EVALUATE.                                                73770039
720800                                                                  73780039
720900*---------------------------------------------------------------  73790039
721000 4930-OPEN-PACK-DC-CURSOR.                                        73800039
721100                                                                  73810039
721200     EXEC SQL                                                     73820039
721300          OPEN PREPACK_DC_CUR                                     73830039
721400     END-EXEC.                                                    73840039
721500                                                                  73850039
721600     EVALUATE TRUE                                                73860039
721700         WHEN SQLWARN0 NOT EQUAL SPACE                            73870039
721800         WHEN SQLCODE NOT EQUAL ZERO                              73880039
721900             MOVE '4930-OPEN-PACK-DC-CURSOR'                      73890039
722000                                      TO DP013-PARAGRAPH          73900039
722100             MOVE 'UNSUCCESSFUL OPEN'                             73910039
722200                              TO DP013-MESSAGE-TEXT (1)           73920039
722300             MOVE SQLCA TO DP013-SQLCA                            73930039
722400             MOVE '       '  TO DP013-DB2-TABLE-NAME (1)          73940039
722500             SET DP013-DB2-ABEND                                  73950039
722600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               73960039
722700             PERFORM DP013-0000-PROCESS-ABEND                     73970039
722800     END-EVALUATE.                                                73980039
722900                                                                  73990039
723000*---------------------------------------------------------------- 74000039
723100 4932-CLOSE-PACK-DC-CURSOR.                                       74010039
723200                                                                  74020039
723300     EXEC SQL                                                     74030039
723400         CLOSE PREPACK_DC_CUR                                     74040039
723500     END-EXEC.                                                    74050039
723600                                                                  74060039
723700     EVALUATE TRUE                                                74070039
723800         WHEN SQLWARN0 NOT EQUAL SPACE                            74080039
723900         WHEN SQLCODE NOT EQUAL ZERO                              74090039
724000             MOVE '4932-CLOSE-PACK-DC-CURSOR'                     74100039
724100                                      TO DP013-PARAGRAPH          74110039
724200             MOVE 'UNSUCCESSFUL CLOSE'                            74120039
724300                              TO DP013-MESSAGE-TEXT (1)           74130039
724400             MOVE SQLCA TO DP013-SQLCA                            74140039
724500             MOVE '       '  TO DP013-DB2-TABLE-NAME (1)          74150039
724600             SET DP013-DB2-ABEND                                  74160039
724700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               74170039
724800             PERFORM DP013-0000-PROCESS-ABEND                     74180039
724900     END-EVALUATE.                                                74190039
725000                                                                  74200039
725100*-----------------------------------------------------------------74210039
725200 4934-FETCH-PACK-DC-CURSOR.                                       74220039
725300                                                                  74230039
725400     EXEC SQL                                                     74240039
725500          FETCH PREPACK_DC_CUR                                    74250039
725600          INTO                                                    74260039
725700               :PV-PDC-SPLIT-QTY                                  74270039
725800             , :ALLPLN-DEST-NBR                                   74280039
725900     END-EXEC.                                                    74290039
726000                                                                  74300039
726100     EVALUATE TRUE                                                74310039
726200         WHEN SQLCODE = ZERO                                      74320039
726300             SET PS-DC-SPLIT-INFO-PRESENT TO TRUE                 74330039
726400                                                                  74340039
726500         WHEN SQLCODE = +100                                      74350039
726600              SET PS-EOC-PREPACK-DC-CURSOR TO TRUE                74360039
726700              IF PS-DC-SPLIT-INFO-PRESENT                         74370039
726800                  CONTINUE                                        74380039
726900              ELSE                                                74390039
727000                 IF PS-MSG-D-ALREADY-SET                          74400039
727100                    CONTINUE                                      74410039
727200                 ELSE                                             74420039
727300                    SET PS-MSG-D-ALREADY-SET   TO TRUE            74430039
727400                    MOVE PC-MSG-D-REQ-DC-SPLIT                    74440039
727500                              TO PV-STATUS-TEXT                   74450039
727600                    SET PS-READY-FOR-REL-NO  TO TRUE              74460039
727700                    IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS         74470039
727800                      ADD +1       TO PV-NBR-EDIT-ERRORS          74480039
727900                      MOVE PC-D                                   74490039
728000                         TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)     74500039
728100                    END-IF                                        74510039
728200                 END-IF                                           74520039
728300              END-IF                                              74530039
728400                                                                  74540039
728500         WHEN SQLWARN0 NOT EQUAL SPACE                            74550039
728600         WHEN SQLCODE NOT EQUAL ZERO                              74560039
728700             MOVE '4934-FETCH-PACK-DC-CURSOR'                     74570039
728800                                      TO DP013-PARAGRAPH          74580039
728900             MOVE 'UNSUCCESSFUL FETCH'                            74590039
729000                              TO DP013-MESSAGE-TEXT (1)           74600039
729100             MOVE SQLCA TO DP013-SQLCA                            74610039
729200             MOVE '       '  TO DP013-DB2-TABLE-NAME (1)          74620039
729300             SET DP013-DB2-ABEND                                  74630039
729400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               74640039
729500             PERFORM DP013-0000-PROCESS-ABEND                     74650039
729600     END-EVALUATE.                                                74660039
729700                                                                  74670039
729800*-----------------------------------------------------------------74680039
729900* NOTE: CHECK FOR RV STATUS BECAUSE WE DO A SEPERATE              74690039
730000*       SPECIFIC MESSAGE 'UNCONFIRMED PACKS' AND DON'T WANT       74700039
730100*       TO DISPLAY THIS MESSAGE AS WELL.                          74710039
730200*-------------------------------------------------------------    74720039
730300 4936-SUM-PACK-UNITS.                                             74730039
730400                                                                  74740039
730500     INITIALIZE PV-TOTAL-PACK-UNITS.                              74750039
730600                                                                  74760039
730700     EXEC SQL                                                     74770039
730800           SELECT                                                 74780039
730900                  SUM (A.UNT_QTY)                                 74790039
731000             INTO                                                 74800039
731100                  :PV-TOTAL-PACK-UNITS                            74810039
731200             FROM                                                 74820039
731300                  TPURITM  A                                      74830039
731400             WHERE A.PO_NBR         = :PURCHS-PO-NBR              74840039
731500               AND A.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID         74850039
731600               AND A.VER_STATUS_CDE = :PC-A                       74860039
731700               AND A.STATUS_CDE IN ('AC', 'AP', 'RV')             74870039
731800     END-EXEC.                                                    74880039
731900                                                                  74890039
732000     EVALUATE TRUE                                                74900039
732100         WHEN SQLCODE = ZERO                                      74910039
732200             CONTINUE                                             74920039
732300                                                                  74930039
732400         WHEN SQLCODE = +100                                      74940039
732500         WHEN SQLCODE = -305                                      74950039
732600             MOVE ZEROES TO PV-TOTAL-PACK-UNITS                   74960039
732700                                                                  74970039
732800         WHEN SQLWARN0 NOT EQUAL SPACE                            74980039
732900         WHEN SQLCODE NOT EQUAL ZERO                              74990039
733000             MOVE '4936-SUM-PACK-UNITS'                           75000039
733100                                      TO DP013-PARAGRAPH          75010039
733200             MOVE 'UNSUCCESSFUL SELECT'                           75020039
733300                              TO DP013-MESSAGE-TEXT (1)           75030039
733400             MOVE SQLCA TO DP013-SQLCA                            75040039
733500             MOVE 'TPURITM'  TO DP013-DB2-TABLE-NAME (1)          75050039
733600             SET DP013-DB2-ABEND                                  75060039
733700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               75070039
733800             PERFORM DP013-0000-PROCESS-ABEND                     75080039
733900     END-EVALUATE.                                                75090039
734000                                                                  75100039
734100*-----------------------------------------------------------------75110039
734200 4938-SELECT-PACK-UPCS.                                           75120039
734300                                                                  75130039
734400     MOVE PURCHS-PO-NBR      TO PURITM-PO-NBR                     75140039
734500     MOVE PC-A               TO PURITM-VER-STATUS-CDE             75150039
734600     MOVE POPRPK-PO-PREPK-ID TO PURITM-PO-PREPK-ID                75160039
734700     MOVE PC-I               TO XLT00006-UPC-TYP-CDE              75170039
734800                                                                  75180039
734900     EXEC SQL                                                     75190039
735000           SELECT                                                 75200039
735100                  COUNT(DISTINCT B.UPC_NBR)                       75210039
735200             INTO                                                 75220039
735300                  :PV-TOTAL-NBR-OF-UPCS                           75230039
735400             FROM                                                 75240039
735500                  TPURITM  A                                      75250039
735600                 ,XLT_UPC  B                                      75260039
735700                 ,XLT_SKU  C                                      75270039
735800             WHERE A.PO_NBR         = :PURITM-PO-NBR              75280039
735900               AND A.VER_STATUS_CDE = :PURITM-VER-STATUS-CDE      75290039
736000               AND A.PO_PREPK_ID    = :PURITM-PO-PREPK-ID         75300039
736100               AND C.ITM_NBR        =  A.ITM_NBR                  75310039
736200               AND B.INTR_UPC_ID    =  C.INTR_UPC_ID              75320039
736300               AND B.UPC_TYP_CDE    = :XLT00006-UPC-TYP-CDE       75330039
736400     END-EXEC.                                                    75340039
736500                                                                  75350039
736600     EVALUATE TRUE                                                75360039
736700         WHEN SQLCODE = ZERO AND PV-TOTAL-NBR-OF-UPCS > 0         75370039
736800             CONTINUE                                             75380039
736900                                                                  75390039
737000         WHEN SQLCODE = +100                                      75400039
737100         WHEN SQLCODE = ZERO AND PV-TOTAL-NBR-OF-UPCS = 0         75410039
737200                IF PS-MSG-O-ALREADY-SET                           75420039
737300                   CONTINUE                                       75430039
737400                ELSE                                              75440039
737500                   SET PS-MSG-O-ALREADY-SET   TO TRUE             75450039
737600                   MOVE PC-MSG-O-NO-UPCS-FOR-PACK                 75460039
737700                             TO PV-STATUS-TEXT                    75470039
737800                   SET PS-READY-FOR-REL-NO  TO TRUE               75480039
737900                   IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS          75490039
738000                     ADD +1       TO PV-NBR-EDIT-ERRORS           75500039
738100                     MOVE PC-O                                    75510039
738200                        TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)      75520039
738300                   END-IF                                         75530039
738400                END-IF                                            75540039
738500                                                                  75550039
738600         WHEN SQLWARN0 NOT EQUAL SPACE                            75560039
738700         WHEN SQLCODE NOT EQUAL ZERO                              75570039
738800                MOVE '4938-SELECT-PACK-UPCS'                      75580039
738900                                         TO DP013-PARAGRAPH       75590039
739000                MOVE 'UNSUCCESSFUL SELECT'                        75600039
739100                                 TO DP013-MESSAGE-TEXT (1)        75610039
739200                MOVE SQLCA TO DP013-SQLCA                         75620039
739300                MOVE '       '  TO DP013-DB2-TABLE-NAME (1)       75630039
739400                SET DP013-DB2-ABEND                               75640039
739500                    DP013-XCTL-DISPLAY-RESTART TO TRUE            75650039
739600                PERFORM DP013-0000-PROCESS-ABEND                  75660039
739700     END-EVALUATE.                                                75670039
739800                                                                  75680039
739900*--------------------------------------------------------------   75690039
740000 4944-OPEN-BULK-UPC-CUR.                                          75700039
740100                                                                  75710039
740200     MOVE PURCHS-PO-NBR  TO PURITM-PO-NBR                         75720039
740300     MOVE PC-A           TO PURITM-VER-STATUS-CDE                 75730039
740400                            PURCHS-VER-STATUS-CDE                 75740039
740500     MOVE PC-I           TO XLT00006-UPC-TYP-CDE                  75750039
740600                                                                  75760039
740700     EXEC SQL                                                     75770039
740800          OPEN BULK_UPC_CUR                                       75780039
740900     END-EXEC.                                                    75790039
741000                                                                  75800039
741100     EVALUATE TRUE                                                75810039
741200         WHEN SQLWARN0 NOT EQUAL SPACE                            75820039
741300         WHEN SQLCODE NOT EQUAL ZERO                              75830039
741400                MOVE '4944-OPEN-BULK-UPC-CUR'                     75840039
741500                                         TO DP013-PARAGRAPH       75850039
741600                MOVE 'UNSUCCESSFUL OPEN'                          75860039
741700                                 TO DP013-MESSAGE-TEXT (1)        75870039
741800                MOVE SQLCA TO DP013-SQLCA                         75880039
741900                MOVE '       '  TO DP013-DB2-TABLE-NAME (1)       75890039
742000                SET DP013-DB2-ABEND                               75900039
742100                    DP013-XCTL-DISPLAY-RESTART TO TRUE            75910039
742200                PERFORM DP013-0000-PROCESS-ABEND                  75920039
742300     END-EVALUATE.                                                75930039
742400                                                                  75940039
742500*                                                                 75950039
742600*-----------------------------------------------------------------75960039
742700 4946-CLOSE-BULK-UPC-CUR.                                         75970039
742800                                                                  75980039
742900     EXEC SQL                                                     75990039
743000         CLOSE BULK_UPC_CUR                                       76000039
743100     END-EXEC.                                                    76010039
743200                                                                  76020039
743300     EVALUATE TRUE                                                76030039
743400         WHEN SQLWARN0 NOT EQUAL SPACE                            76040039
743500         WHEN SQLCODE NOT EQUAL ZERO                              76050039
743600                MOVE '4946-CLOSE-BULK-UPC-CUR'                    76060039
743700                                         TO DP013-PARAGRAPH       76070039
743800                MOVE 'UNSUCCESSFUL CLOSE'                         76080039
743900                                 TO DP013-MESSAGE-TEXT (1)        76090039
744000                MOVE SQLCA TO DP013-SQLCA                         76100039
744100                MOVE '       '  TO DP013-DB2-TABLE-NAME (1)       76110039
744200                SET DP013-DB2-ABEND                               76120039
744300                    DP013-XCTL-DISPLAY-RESTART TO TRUE            76130039
744400                PERFORM DP013-0000-PROCESS-ABEND                  76140039
744500     END-EVALUATE.                                                76150039
744600                                                                  76160039
744700*                                                                 76170039
744800*------------------------------------------------------------     76180039
744900 4948-FETCH-BULK-UPC-CUR.                                         76190039
745000                                                                  76200039
745100     EXEC SQL                                                     76210039
745200          FETCH BULK_UPC_CUR                                      76220039
745300          INTO                                                    76230039
745400                  :PURITM-APP-PO-LNE-NBR                          76240039
745500                , :PURITM-PO-LNE-NBR                              76250039
745600                , :XLT00003-SHRT-CLOR-DESC                        76260039
745700                , :XLT00003-SIZE-DESC                             76270039
745800                , :XLT00003-NRF-CLOR-CDE                          76280039
745900                , :XLT00003-SKU-DESC                              76290039
746000                , :XLT00004-MAJ-CL-NBR                            76300039
746100                , :XLT00004-SUB-CL-NBR                            76310039
746200                , :PURITM-ITM-NBR                                 76320039
746300                , :PURITM-PO-NBR                                  76330039
746400                , :PURITM-STATUS-CDE                              76340039
746500                , :PURITM-UNT-QTY                                 76350039
746600                , :PURITM-PREPK-RATO-QTY                          76360039
746700                , :XLT00006-UPC-NBR                               76370039
746800     END-EXEC.                                                    76380039
746900                                                                  76390039
747000     EVALUATE TRUE                                                76400039
747100         WHEN SQLCODE = ZERO                                      76410039
747200             SET PS-LINES-ON-TPURITM TO TRUE                      76420039
747300                                                                  76430039
747400         WHEN SQLCODE = +100                                      76440039
747500              IF PS-LINES-ON-TPURITM                              76450039
747600                  CONTINUE                                        76460039
747700              ELSE                                                76470039
747800                IF PS-MSG-P-ALREADY-SET                           76480039
747900                   CONTINUE                                       76490039
748000                ELSE                                              76500039
748100                   SET PS-MSG-P-ALREADY-SET   TO TRUE             76510039
748200                   MOVE PC-MSG-P-NO-UPCS-FOR-PO                   76520039
748300                             TO PV-STATUS-TEXT                    76530039
748400                   SET PS-READY-FOR-REL-NO  TO TRUE               76540039
748500                   IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS          76550039
748600                     ADD +1       TO PV-NBR-EDIT-ERRORS           76560039
748700                     MOVE PC-P                                    76570039
748800                        TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)      76580039
748900                   END-IF                                         76590039
749000                END-IF                                            76600039
749100              END-IF                                              76610039
749200                                                                  76620039
749300              SET PS-EOC-BULK-UPC-CUR TO TRUE                     76630039
749400                                                                  76640039
749500         WHEN SQLWARN0 NOT EQUAL SPACE                            76650039
749600         WHEN SQLCODE NOT EQUAL ZERO                              76660039
749700                MOVE '4948-FETCH-BULK-UPC-CUR'                    76670039
749800                                         TO DP013-PARAGRAPH       76680039
749900                MOVE 'UNSUCCESSFUL FETCH'                         76690039
750000                                 TO DP013-MESSAGE-TEXT (1)        76700039
750100                MOVE SQLCA TO DP013-SQLCA                         76710039
750200                MOVE '       '  TO DP013-DB2-TABLE-NAME (1)       76720039
750300                SET DP013-DB2-ABEND                               76730039
750400                    DP013-XCTL-DISPLAY-RESTART TO TRUE            76740039
750500                PERFORM DP013-0000-PROCESS-ABEND                  76750039
750600     END-EVALUATE.                                                76760039
750700                                                                  76770039
750800*-----------------------------------------------------------------76780039
750900 4950-SELECT-VEND-OUTR-PACK-QTY.                                  76790039
751000*                                                                 76800039
751100     MOVE PURITM-ITM-NBR TO XLT00003-ITM-NBR                      76810039
751200                                                                  76820039
751300     EXEC SQL                                                     76830039
751400           SELECT                                                 76840039
751500                  OUTR_PK_QTY                                     76850039
751600             INTO                                                 76860039
751700                  :XLT00003-OUTR-PK-QTY                           76870039
751800             FROM                                                 76880039
751900                  XLT_SKU                                         76890039
752000             WHERE ITM_NBR  =  :XLT00003-ITM-NBR                  76900039
752100     END-EXEC                                                     76910039
752200                                                                  76920039
752300     EVALUATE TRUE                                                76930039
752400         WHEN SQLCODE = ZERO                                      76940039
752500             IF XLT00003-OUTR-PK-QTY = ZERO                       76950039
752600               IF PS-MSG-R-ALREADY-SET                            76960039
752700                  CONTINUE                                        76970039
752800               ELSE                                               76980039
752900                  SET PS-MSG-R-ALREADY-SET   TO TRUE              76990039
753000                  MOVE PC-MSG-R-OUTPK-UNITS-ZERO                  77000039
753100                            TO PV-STATUS-TEXT                     77010039
753200                  SET PS-READY-FOR-REL-NO  TO TRUE                77020039
753300                  IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS           77030039
753400                    ADD +1       TO PV-NBR-EDIT-ERRORS            77040039
753500                    MOVE PC-R                                     77050039
753600                       TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)       77060039
753700                  END-IF                                          77070039
753800               END-IF                                             77080039
753900             ELSE                                                 77090039
754000                 DIVIDE XLT00003-OUTR-PK-QTY                      77100039
754100                   INTO PURITM-UNT-QTY                            77110039
754200                 GIVING PV-UPC-CARTONS   ROUNDED                  77120039
754300             END-IF                                               77130039
754400                                                                  77140039
754500         WHEN SQLCODE = +100                                      77150039
754600             MOVE 0 TO XLT00003-OUTR-PK-QTY                       77160039
754700             SET PS-SKUS-FOUND-NO          TO TRUE                77170039
754800                                                                  77180039
754900         WHEN SQLWARN0 NOT EQUAL SPACE                            77190039
755000         WHEN SQLCODE NOT EQUAL ZERO                              77200039
755100                MOVE '4950-SELECT-VEND-OUTR-PACK-QTY'             77210039
755200                                         TO DP013-PARAGRAPH       77220039
755300                MOVE 'UNSUCCESSFUL SELECT'                        77230039
755400                                 TO DP013-MESSAGE-TEXT (1)        77240039
755500                MOVE SQLCA TO DP013-SQLCA                         77250039
755600                MOVE 'XLT_SKU    '  TO DP013-DB2-TABLE-NAME (1)   77260039
755700                SET DP013-DB2-ABEND                               77270039
755800                    DP013-XCTL-DISPLAY-RESTART TO TRUE            77280039
755900                PERFORM DP013-0000-PROCESS-ABEND                  77290039
756000     END-EVALUATE.                                                77300039
756100                                                                  77310039
756200*-----------------------------------------------------------------77320039
756300* NOTE: CHECK FOR RV STATUS BECAUSE WE DO A SEPERATE              77330039
756400*       SPECIFIC MESSAGE 'UNCONFIRMED PACKS' AND DON'T WANT       77340039
756500*       TO DISPLAY THIS MESSAGE AS WELL.                          77350039
756600*-------------------------------------------------------------    77360039
756700 4952-SUM-DC-SPLIT-QTY.                                           77370039
756800*                                                                 77380039
756900     EXEC SQL                                                     77390039
757000           SELECT                                                 77400039
757100                  SUM (AL.CURR_SPLIT_QTY)                         77410039
757200             INTO                                                 77420039
757300                  :PV-TOTAL-CURR-SPLIT-QTY                        77430039
757400             FROM                                                 77440039
757500                  TALLPLN   AL                                    77450039
757600                , TPURITM   PUR                                   77460039
757700             WHERE AL.PO_NBR          = :PURCHS-PO-NBR            77470039
757800               AND AL.CURR_SPLIT_QTY  > 0                         77480039
757900               AND PUR.PO_NBR         =  AL.PO_NBR                77490039
758000               AND PUR.ITM_NBR        = :PURITM-ITM-NBR           77500039
758100               AND PUR.PO_LNE_NBR     =  AL.PO_LNE_NBR            77510039
758200               AND PUR.VER_STATUS_CDE = :PC-A                     77520039
758300               AND PUR.STATUS_CDE    IN ('AC', 'AP', 'RV')        77530039
758400     END-EXEC                                                     77540039
758500                                                                  77550039
758600     EVALUATE TRUE                                                77560039
758700         WHEN SQLCODE = ZERO AND PV-TOTAL-CURR-SPLIT-QTY = ZERO   77570039
758800         WHEN SQLCODE = -305                                      77580039
758900         WHEN SQLCODE = +100                                      77590039
759000             IF PS-MSG-D-ALREADY-SET                              77600039
759100                CONTINUE                                          77610039
759200             ELSE                                                 77620039
759300                SET PS-MSG-D-ALREADY-SET   TO TRUE                77630039
759400                MOVE PC-MSG-D-REQ-DC-SPLIT                        77640039
759500                          TO PV-STATUS-TEXT                       77650039
759600                SET PS-READY-FOR-REL-NO  TO TRUE                  77660039
759700                IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS             77670039
759800                  ADD +1       TO PV-NBR-EDIT-ERRORS              77680039
759900                  MOVE PC-D                                       77690039
760000                     TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)         77700039
760100                END-IF                                            77710039
760200             END-IF                                               77720039
760300                                                                  77730039
760400         WHEN SQLCODE = ZERO                                      77740039
760500             SET PS-CURR-SPLIT-QTY-PRESENT TO TRUE                77750039
760600                                                                  77760039
760700         WHEN SQLWARN0 NOT EQUAL SPACE                            77770039
760800         WHEN SQLCODE NOT EQUAL ZERO                              77780039
760900                MOVE '4952-SUM-DC-SPLIT-QTY'                      77790039
761000                                         TO DP013-PARAGRAPH       77800039
761100                MOVE 'UNSUCCESSFUL SELECT'                        77810039
761200                                 TO DP013-MESSAGE-TEXT (1)        77820039
761300                MOVE SQLCA TO DP013-SQLCA                         77830039
761400                MOVE '       '  TO DP013-DB2-TABLE-NAME (1)       77840039
761500                SET DP013-DB2-ABEND                               77850039
761600                    DP013-XCTL-DISPLAY-RESTART TO TRUE            77860039
761700                PERFORM DP013-0000-PROCESS-ABEND                  77870039
761800     END-EVALUATE.                                                77880039
761900                                                                  77890039
762000*-----------------------------------------------------------------77900039
762100* NOTE: CHECK FOR RV STATUS BECAUSE WE DO A SEPERATE              77910039
762200*       SPECIFIC MESSAGE 'UNCONFIRMED PACKS' AND DON'T WANT       77920039
762300*       TO DISPLAY THIS MESSAGE AS WELL.                          77930039
762400*-------------------------------------------------------------    77940039
762500 4954-COUNT-DCS-FOR-BULK.                                         77950039
762600*                                                                 77960039
762700     EXEC SQL                                                     77970039
762800           SELECT                                                 77980039
762900                  COUNT(DISTINCT AL.DEST_NBR)                     77990039
763000             INTO                                                 78000039
763100                  :PV-TOTAL-NBR-OF-DCS                            78010039
763200             FROM                                                 78020039
763300                  TALLPLN   AL                                    78030039
763400                , TPURITM   LN                                    78040039
763500             WHERE AL.PO_NBR         = :PURCHS-PO-NBR             78050039
763600               AND AL.PO_NBR         =  LN.PO_NBR                 78060039
763700               AND AL.PO_LNE_NBR     = :PURITM-PO-LNE-NBR         78070039
763800               AND AL.PO_LNE_NBR     =  LN.PO_LNE_NBR             78080039
763900               AND AL.CURR_SPLIT_QTY > 0                          78090039
764000               AND LN.VER_STATUS_CDE = :PC-A                      78100039
764100               AND LN.STATUS_CDE    IN ('AC', 'AP', 'RV')         78110039
764200     END-EXEC                                                     78120039
764300                                                                  78130039
764400     EVALUATE TRUE                                                78140039
764500         WHEN SQLCODE = ZERO                                      78150039
764600*          ***************************************************    78160039
764700*          * IF THERE ARE MORE DCS THAN CARTONS, WE'VE GOT A      78170039
764800*          * PROBLEM AND WE DON'T WANT TO SEND THE SPLIT.         78180039
764900*          ***************************************************    78190039
765000           IF PV-UPC-CARTONS  <  PV-TOTAL-NBR-OF-DCS              78200039
765100             IF PS-MSG-K-ALREADY-SET                              78210039
765200                CONTINUE                                          78220039
765300             ELSE                                                 78230039
765400                SET PS-MSG-K-ALREADY-SET   TO TRUE                78240039
765500                MOVE PC-MSG-K-CARTS-LESS-THAN-DCS                 78250039
765600                          TO PV-STATUS-TEXT                       78260039
765700                SET PS-READY-FOR-REL-NO  TO TRUE                  78270039
765800                IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS             78280039
765900                  ADD +1       TO PV-NBR-EDIT-ERRORS              78290039
766000                  MOVE PC-K                                       78300039
766100                     TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)         78310039
766200                END-IF                                            78320039
766300             END-IF                                               78330039
766400           ELSE                                                   78340039
766500             SET PS-COUNT-DCS-OK         TO TRUE                  78350039
766600           END-IF                                                 78360039
766700                                                                  78370039
766800         WHEN SQLCODE = +100                                      78380039
766900         WHEN SQLCODE = -305                                      78390039
767000             IF PS-MSG-D-ALREADY-SET                              78400039
767100                CONTINUE                                          78410039
767200             ELSE                                                 78420039
767300                SET PS-MSG-D-ALREADY-SET   TO TRUE                78430039
767400                MOVE PC-MSG-D-REQ-DC-SPLIT                        78440039
767500                          TO PV-STATUS-TEXT                       78450039
767600                SET PS-READY-FOR-REL-NO  TO TRUE                  78460039
767700                IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS             78470039
767800                  ADD +1       TO PV-NBR-EDIT-ERRORS              78480039
767900                  MOVE PC-D                                       78490039
768000                     TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)         78500039
768100                END-IF                                            78510039
768200             END-IF                                               78520039
768300                                                                  78530039
768400         WHEN SQLWARN0 NOT EQUAL SPACE                            78540039
768500         WHEN SQLCODE NOT EQUAL ZERO                              78550039
768600                MOVE '4954-COUNT-DCS-FOR-BULK'                    78560039
768700                                         TO DP013-PARAGRAPH       78570039
768800                MOVE 'UNSUCCESSFUL SELECT'                        78580039
768900                                 TO DP013-MESSAGE-TEXT (1)        78590039
769000                MOVE SQLCA TO DP013-SQLCA                         78600039
769100                MOVE '       '  TO DP013-DB2-TABLE-NAME (1)       78610039
769200                SET DP013-DB2-ABEND                               78620039
769300                    DP013-XCTL-DISPLAY-RESTART TO TRUE            78630039
769400                PERFORM DP013-0000-PROCESS-ABEND                  78640039
769500     END-EVALUATE.                                                78650039
769600                                                                  78660039
769700*-----------------------------------------------------------------78670039
769800 4956-OPEN-DC-CURSOR.                                             78680039
769900                                                                  78690039
770000     EXEC SQL                                                     78700039
770100          OPEN DC_CUR                                             78710039
770200     END-EXEC.                                                    78720039
770300                                                                  78730039
770400     EVALUATE TRUE                                                78740039
770500         WHEN SQLWARN0 NOT EQUAL SPACE                            78750039
770600         WHEN SQLCODE NOT EQUAL ZERO                              78760039
770700                MOVE '4956-OPEN-DC-CURSOR'                        78770039
770800                                         TO DP013-PARAGRAPH       78780039
770900                MOVE 'UNSUCCESSFUL OPEN'                          78790039
771000                                 TO DP013-MESSAGE-TEXT (1)        78800039
771100                MOVE SQLCA TO DP013-SQLCA                         78810039
771200                MOVE '       '  TO DP013-DB2-TABLE-NAME (1)       78820039
771300                SET DP013-DB2-ABEND                               78830039
771400                    DP013-XCTL-DISPLAY-RESTART TO TRUE            78840039
771500                PERFORM DP013-0000-PROCESS-ABEND                  78850039
771600     END-EVALUATE.                                                78860039
771700                                                                  78870039
771800*                                                                 78880039
771900*-----------------------------------------------------------------78890039
772000 4958-CLOSE-DC-CURSOR.                                            78900039
772100                                                                  78910039
772200     EXEC SQL                                                     78920039
772300         CLOSE DC_CUR                                             78930039
772400     END-EXEC.                                                    78940039
772500                                                                  78950039
772600     EVALUATE TRUE                                                78960039
772700         WHEN SQLWARN0 NOT EQUAL SPACE                            78970039
772800         WHEN SQLCODE NOT EQUAL ZERO                              78980039
772900                MOVE '4958-CLOSE-DC-CURSOR'                       78990039
773000                                         TO DP013-PARAGRAPH       79000039
773100                MOVE 'UNSUCCESSFUL CLOSE'                         79010039
773200                                 TO DP013-MESSAGE-TEXT (1)        79020039
773300                MOVE SQLCA TO DP013-SQLCA                         79030039
773400                MOVE '       '  TO DP013-DB2-TABLE-NAME (1)       79040039
773500                SET DP013-DB2-ABEND                               79050039
773600                    DP013-XCTL-DISPLAY-RESTART TO TRUE            79060039
773700                PERFORM DP013-0000-PROCESS-ABEND                  79070039
773800     END-EVALUATE.                                                79080039
773900                                                                  79090039
774000*                                                                 79100039
774100*-----------------------------------------------------------------79110039
774200 4960-FETCH-DC-CURSOR.                                            79120039
774300                                                                  79130039
774400     EXEC SQL                                                     79140039
774500          FETCH DC_CUR                                            79150039
774600          INTO                                                    79160039
774700                  :ALLPLN-DEST-NBR                                79170039
774800                , :ALLPLN-DC-SPLIT-QTY                            79180039
774900                , :ALLPLN-CURR-SPLIT-QTY                          79190039
775000                , :ALLPLN-PLAN-NBR                                79200039
775100     END-EXEC.                                                    79210039
775200                                                                  79220039
775300     EVALUATE TRUE                                                79230039
775400         WHEN SQLCODE = ZERO                                      79240039
775500             SET PS-DC-SPLIT-INFO-PRESENT TO TRUE                 79250039
775600                                                                  79260039
775700         WHEN SQLCODE = +100                                      79270039
775800              IF PS-DC-SPLIT-INFO-PRESENT                         79280039
775900                  CONTINUE                                        79290039
776000              ELSE                                                79300039
776100                IF PS-MSG-D-ALREADY-SET                           79310039
776200                   CONTINUE                                       79320039
776300                ELSE                                              79330039
776400                   SET PS-MSG-D-ALREADY-SET   TO TRUE             79340039
776500                   MOVE PC-MSG-D-REQ-DC-SPLIT                     79350039
776600                             TO PV-STATUS-TEXT                    79360039
776700                   SET PS-READY-FOR-REL-NO  TO TRUE               79370039
776800                   IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS          79380039
776900                     ADD +1       TO PV-NBR-EDIT-ERRORS           79390039
777000                     MOVE PC-D                                    79400039
777100                        TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)      79410039
777200                   END-IF                                         79420039
777300                END-IF                                            79430039
777400              END-IF                                              79440039
777500                                                                  79450039
777600              SET PS-EOC-DC-CURSOR TO TRUE                        79460039
777700                                                                  79470039
777800         WHEN SQLWARN0 NOT EQUAL SPACE                            79480039
777900         WHEN SQLCODE NOT EQUAL ZERO                              79490039
778000                MOVE '4960-FETCH-DC-CURSOR'                       79500039
778100                                         TO DP013-PARAGRAPH       79510039
778200                MOVE 'UNSUCCESSFUL FETCH'                         79520039
778300                                 TO DP013-MESSAGE-TEXT (1)        79530039
778400                MOVE SQLCA TO DP013-SQLCA                         79540039
778500                MOVE 'TALLPLN'  TO DP013-DB2-TABLE-NAME (1)       79550039
778600                SET DP013-DB2-ABEND                               79560039
778700                    DP013-XCTL-DISPLAY-RESTART TO TRUE            79570039
778800                PERFORM DP013-0000-PROCESS-ABEND                  79580039
778900     END-EVALUATE.                                                79590039
779000                                                                  79600039
779100*--------------------------------------------------------------   79610039
779200*4962-OPEN-MULTI-PACK-CUR.                                        79620039
779300*                                                                 79630039
779400*    EXEC SQL                                                     79640039
779500*         OPEN  MULTI_UPC_PACK_CUR                                79650039
779600*    END-EXEC.                                                    79660039
779700*                                                                 79670039
779800*    EVALUATE TRUE                                                79680039
779900*                                                                 79690039
780000*        WHEN SQLWARN0 NOT EQUAL SPACE                            79700039
780100*        WHEN SQLCODE NOT EQUAL ZERO                              79710039
780200*               MOVE '4962-OPEN-MULTI-PACK-CUR'                   79720039
780300*                                        TO DP013-PARAGRAPH       79730039
780400*               MOVE 'UNSUCCESSFUL OPEN'                          79740039
780500*                                TO DP013-MESSAGE-TEXT (1)        79750039
780600*               MOVE SQLCA TO DP013-SQLCA                         79760039
780700*               MOVE '       '  TO DP013-DB2-TABLE-NAME (1)       79770039
780800*               SET DP013-DB2-ABEND                               79780039
780900*                   DP013-XCTL-DISPLAY-RESTART TO TRUE            79790039
781000*               PERFORM DP013-0000-PROCESS-ABEND                  79800039
781100*    END-EVALUATE.                                                79810039
781200*                                                                 79820039
781300******************************************************************79830039
781400*4964-CLOSE-MULTI-PACK-CUR.                                       79840039
781500*                                                                 79850039
781600*    EXEC SQL                                                     79860039
781700*        CLOSE  MULTI_UPC_PACK_CUR                                79870039
781800*    END-EXEC.                                                    79880039
781900*                                                                 79890039
782000*    EVALUATE TRUE                                                79900039
782100*                                                                 79910039
782200*        WHEN SQLWARN0 NOT EQUAL SPACE                            79920039
782300*        WHEN SQLCODE NOT EQUAL ZERO                              79930039
782400*               MOVE '4964-CLOSE-MULTI-PACK-CUR'                  79940039
782500*                                        TO DP013-PARAGRAPH       79950039
782600*               MOVE 'UNSUCCESSFUL CLOSE'                         79960039
782700*                                TO DP013-MESSAGE-TEXT (1)        79970039
782800*               MOVE SQLCA TO DP013-SQLCA                         79980039
782900*               MOVE '       '  TO DP013-DB2-TABLE-NAME (1)       79990039
783000*               SET DP013-DB2-ABEND                               80000039
783100*                   DP013-XCTL-DISPLAY-RESTART TO TRUE            80010039
783200*               PERFORM DP013-0000-PROCESS-ABEND                  80020039
783300*    END-EVALUATE.                                                80030039
783400*                                                                 80040039
783500******************************************************************80050039
783600*4966-FETCH-MULTI-PACK-CUR.                                       80060039
783700*                                                                 80070039
783800*    EXEC SQL                                                     80080039
783900*         FETCH MULTI_UPC_PACK_CUR                                80090039
784000*         INTO :IMCNUP-PO-NBR                                     80100039
784100*             ,:IMCNUP-CONTNR-ID                                  80110039
784200*             ,:IMCNUP-CONTNR-SEQ-NBR                             80120039
784300*             ,:IMCNUP-UPC-NBR                                    80130039
784400*             ,:PV-MULTI-UPC-ROWS                                 80140039
784500*    END-EXEC.                                                    80150039
784600*                                                                 80160039
784700*    EVALUATE TRUE                                                80170039
784800*                                                                 80180039
784900*        WHEN SQLCODE = ZERO                                      80190039
785000*           CONTINUE                                              80200039
785100*                                                                 80210039
785200*        WHEN SQLCODE = +100                                      80220039
785300*           SET PS-EOC-MULTI-PACK-CUR  TO  TRUE                   80230039
785400*                                                                 80240039
785500*        WHEN SQLWARN0 NOT EQUAL SPACE                            80250039
785600*        WHEN SQLCODE NOT EQUAL ZERO                              80260039
785700*               MOVE '4966-FETCH-MULTI-PACK-CUR'                  80270039
785800*                                        TO DP013-PARAGRAPH       80280039
785900*               MOVE 'UNSUCCESSFUL FETCH'                         80290039
786000*                                TO DP013-MESSAGE-TEXT (1)        80300039
786100*               MOVE SQLCA TO DP013-SQLCA                         80310039
786200*               MOVE '       '  TO DP013-DB2-TABLE-NAME (1)       80320039
786300*               SET DP013-DB2-ABEND                               80330039
786400*                   DP013-XCTL-DISPLAY-RESTART TO TRUE            80340039
786500*               PERFORM DP013-0000-PROCESS-ABEND                  80350039
786600*    END-EVALUATE.                                                80360039
786700*                                                                 80370039
786800*-----------------------------------------------------------------80380039
786900 4970-SELECT-BULK-UPCS.                                           80390039
787000                                                                  80400039
787100     MOVE PURCHS-PO-NBR      TO PURITM-PO-NBR                     80410039
787200     MOVE PC-A               TO PURITM-VER-STATUS-CDE             80420039
787300     MOVE PC-I               TO XLT00006-UPC-TYP-CDE              80430039
787400                                                                  80440039
787500     EXEC SQL                                                     80450039
787600           SELECT                                                 80460039
787700                  COUNT(DISTINCT D.UPC_NBR)                       80470039
787800             INTO                                                 80480039
787900                  :PV-TOTAL-NBR-OF-UPCS                           80490039
788000             FROM                                                 80500039
788100                  TPURITM  A                                      80510039
788200                 ,XLT_UPC  B                                      80520039
788300                 ,XLT_SKU  C                                      80530039
788400                 ,TIMCNUP  D                                      80540039
788500             WHERE A.PO_NBR          =  :PURITM-PO-NBR            80550039
788600               AND A.VER_STATUS_CDE  = :PURITM-VER-STATUS-CDE     80560039
788700               AND C.ITM_NBR         = A.ITM_NBR                  80570039
788800               AND B.INTR_UPC_ID     = C.INTR_UPC_ID              80580039
788900               AND B.UPC_TYP_CDE     = :XLT00006-UPC-TYP-CDE      80590039
789000               AND D.UPC_NBR         = B.UPC_NBR                  80600039
789100               AND D.PO_NBR       = A.PO_NBR                      80610039
789200     END-EXEC.                                                    80620039
789300                                                                  80630039
789400     EVALUATE TRUE                                                80640039
789500         WHEN SQLCODE = ZERO                                      80650039
789600           AND PV-TOTAL-NBR-OF-UPCS  > 0                          80660039
789700             CONTINUE                                             80670039
789800                                                                  80680039
789900         WHEN SQLCODE = ZERO                                      80690039
790000           AND PV-TOTAL-NBR-OF-UPCS  = 0                          80700039
790100         WHEN SQLCODE = +100                                      80710039
790700            IF PS-MSG-U-ALREADY-SET                               80720040
790800               CONTINUE                                           80730040
790900            ELSE                                                  80740040
791000               SET PS-THERE-ARE-CMN-MSGS  TO TRUE                 80750040
791100               SET PS-MSG-U-ALREADY-SET   TO TRUE                 80760040
791200               MOVE PC-MSG-U-NO-UPCS-FOR-PO-CMN                   80770040
791300                         TO PV-STATUS-TEXT                        80780040
791400               SET PS-READY-FOR-REL-NO  TO TRUE                   80790040
791500               IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS              80800040
791600                 ADD +1       TO PV-NBR-EDIT-ERRORS               80810040
791700                 MOVE PC-U                                        80820040
791800                    TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)          80830040
791900               END-IF                                             80840040
792000            END-IF                                                80850040
792300         WHEN SQLWARN0 NOT EQUAL SPACE                            80860039
792400         WHEN SQLCODE NOT EQUAL ZERO                              80870039
792500                MOVE '4970-SELECT-BULK-UPCS'                      80880039
792600                                         TO DP013-PARAGRAPH       80890039
792700                MOVE 'UNSUCCESSFUL SELECT'                        80900039
792800                                 TO DP013-MESSAGE-TEXT (1)        80910039
792900                MOVE SQLCA TO DP013-SQLCA                         80920039
793000                MOVE '       '  TO DP013-DB2-TABLE-NAME (1)       80930039
793100                SET DP013-DB2-ABEND                               80940039
793200                    DP013-XCTL-DISPLAY-RESTART TO TRUE            80950039
793300                PERFORM DP013-0000-PROCESS-ABEND                  80960039
793400     END-EVALUATE.                                                80970039
793500                                                                  80980039
793600*-----------------------------------------------------------------80990039
793700 4972-OPEN-CMN-BULK-UPC-CUR.                                      81000039
793800                                                                  81010039
793900     MOVE PURCHS-PO-NBR TO IMCNUP-PO-NBR.                         81020039
794000     MOVE PC-A          TO PURITM-VER-STATUS-CDE.                 81030039
794100                                                                  81040039
794200     EXEC SQL                                                     81050039
794300          OPEN CMN_BULK_UPC_CUR                                   81060039
794400     END-EXEC.                                                    81070039
794500                                                                  81080039
794600     EVALUATE TRUE                                                81090039
794700         WHEN SQLWARN0 NOT EQUAL SPACE                            81100039
794800         WHEN SQLCODE NOT EQUAL ZERO                              81110039
794900                MOVE '4972-OPEN-CMN-BULK-UPC-CUR'                 81120039
795000                                         TO DP013-PARAGRAPH       81130039
795100                MOVE 'UNSUCCESSFUL OPEN'                          81140039
795200                                 TO DP013-MESSAGE-TEXT (1)        81150039
795300                MOVE SQLCA TO DP013-SQLCA                         81160039
795400                MOVE '       '  TO DP013-DB2-TABLE-NAME (1)       81170039
795500                SET DP013-DB2-ABEND                               81180039
795600                    DP013-XCTL-DISPLAY-RESTART TO TRUE            81190039
795700                PERFORM DP013-0000-PROCESS-ABEND                  81200039
795800     END-EVALUATE.                                                81210039
795900                                                                  81220039
796000*                                                                 81230039
796100*-----------------------------------------------------------------81240039
796200 4974-CLOSE-CMN-BULK-UPC-CUR.                                     81250039
796300                                                                  81260039
796400     EXEC SQL                                                     81270039
796500         CLOSE CMN_BULK_UPC_CUR                                   81280039
796600     END-EXEC.                                                    81290039
796700                                                                  81300039
796800     EVALUATE TRUE                                                81310039
796900         WHEN SQLWARN0 NOT EQUAL SPACE                            81320039
797000         WHEN SQLCODE NOT EQUAL ZERO                              81330039
797100                MOVE '4974-CLOSE-CMN-BULK-UPC-CUR'                81340039
797200                                         TO DP013-PARAGRAPH       81350039
797300                MOVE 'UNSUCCESSFUL CLOSE'                         81360039
797400                                 TO DP013-MESSAGE-TEXT (1)        81370039
797500                MOVE SQLCA TO DP013-SQLCA                         81380039
797600                MOVE '       '  TO DP013-DB2-TABLE-NAME (1)       81390039
797700                SET DP013-DB2-ABEND                               81400039
797800                    DP013-XCTL-DISPLAY-RESTART TO TRUE            81410039
797900                PERFORM DP013-0000-PROCESS-ABEND                  81420039
798000     END-EVALUATE.                                                81430039
798100                                                                  81440039
798200*                                                                 81450039
798300*-----------------------------------------------------------------81460039
798400 4976-FETCH-CMN-BULK-UPC-CUR.                                     81470039
798500                                                                  81480039
798600     EXEC SQL                                                     81490039
798700          FETCH CMN_BULK_UPC_CUR                                  81500039
798800          INTO    :IMCNUP-UPC-NBR                                 81510039
798900                , :IMCNUP-ASN-PKGNG-CDE                           81520039
799000                , :PURITM-ITM-NBR                                 81530039
799100                , :PURITM-UNT-QTY                                 81540039
799200                , :PURITM-STATUS-CDE                              81550039
799300     END-EXEC.                                                    81560039
799400                                                                  81570039
799500     EVALUATE TRUE                                                81580039
799600         WHEN SQLCODE = ZERO                                      81590039
799700             CONTINUE                                             81600039
799800                                                                  81610039
799900         WHEN SQLCODE = +100                                      81620039
800000                                                                  81630039
800100              SET PS-EOC-BULK-UPC-CUR TO TRUE                     81640039
800200                                                                  81650039
800300         WHEN SQLWARN0 NOT EQUAL SPACE                            81660039
800400         WHEN SQLCODE NOT EQUAL ZERO                              81670039
800500                MOVE '4976-FETCH-CMN-BULK-UPC-CUR'                81680039
800600                                         TO DP013-PARAGRAPH       81690039
800700                MOVE 'UNSUCCESSFUL FETCH'                         81700039
800800                                 TO DP013-MESSAGE-TEXT (1)        81710039
800900                MOVE SQLCA TO DP013-SQLCA                         81720039
801000                MOVE '       '  TO DP013-DB2-TABLE-NAME (1)       81730039
801100                SET DP013-DB2-ABEND                               81740039
801200                    DP013-XCTL-DISPLAY-RESTART TO TRUE            81750039
801300                PERFORM DP013-0000-PROCESS-ABEND                  81760039
801400     END-EVALUATE.                                                81770039
801500                                                                  81780039
801600*-----------------------------------------------------------------81790039
801700* NOTE: CHECK FOR RV STATUS BECAUSE WE DO A SEPERATE              81800039
801800*       SPECIFIC MESSAGE 'UNCONFIRMED PACKS' AND DON'T WANT       81810039
801900*       TO DISPLAY THIS MESSAGE AS WELL.                          81820039
802000*-------------------------------------------------------------    81830039
802100 4978-SELECT-UPCS-TIED.                                           81840039
802200                                                                  81850039
802300     EXEC SQL                                                     81860039
802400         SELECT A.PO_NBR                                          81870039
802500           INTO :PURITM-PO-NBR                                    81880039
802600           FROM TPURITM  A                                        81890039
802700          WHERE A.PO_NBR         = :PURCHS-PO-NBR                 81900039
802800            AND A.VER_STATUS_CDE = :PC-A                          81910039
802900            AND A.STATUS_CDE    IN ('AC', 'AP', 'RV')             81920039
803000            AND A.PO_PREPK_ID    =  0                             81930039
803100     END-EXEC                                                     81940039
803200                                                                  81950039
803300     EVALUATE TRUE                                                81960039
803400         WHEN SQLCODE = ZERO                                      81970039
803500         WHEN SQLCODE = -811                                      81980039
803600              MOVE PC-MSG-G-UPCS-NOT-TIED TO PV-STATUS-TEXT       81990039
803700              SET PS-MSG-G-ALREADY-SET TO TRUE                    82000039
803800              SET PS-READY-FOR-REL-NO  TO TRUE                    82010039
803900              IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS               82020039
804000                ADD +1       TO PV-NBR-EDIT-ERRORS                82030039
804100                MOVE PC-G                                         82040039
804200                    TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)          82050039
804300              END-IF                                              82060039
804400                                                                  82070039
804500         WHEN SQLCODE = +100                                      82080039
804600             CONTINUE                                             82090039
804700                                                                  82100039
804800         WHEN SQLWARN0 NOT EQUAL SPACE                            82110039
804900         WHEN SQLCODE NOT EQUAL ZERO                              82120039
805000            MOVE '4978-SELECT-UPCS-TIED' TO DP013-PARAGRAPH       82130039
805100            MOVE 'UNSUCCESSFUL SELECT' TO DP013-MESSAGE-TEXT (1)  82140039
805200            MOVE SQLCA TO DP013-SQLCA                             82150039
805300            MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)           82160039
805400            SET DP013-DB2-ABEND                                   82170039
805500                DP013-XCTL-DISPLAY-RESTART TO TRUE                82180039
805600            PERFORM DP013-0000-PROCESS-ABEND                      82190039
805700     END-EVALUATE.                                                82200039
805800                                                                  82210039
805900*----------------------------------------------------------------*82220039
806000 4980-TRANSPORTATION-ERROR.                                       82230039
806100                                                                  82240039
806200     IF PS-MSG-V-ALREADY-SET                                      82250039
806300       CONTINUE                                                   82260039
806400     ELSE                                                         82270039
806500         SET PS-MSG-V-ALREADY-SET   TO TRUE                       82280039
806600         MOVE PC-MSG-V-TRANSPORTATION-ERR                         82290039
806700                                   TO PV-STATUS-TEXT              82300039
806800         SET PS-READY-FOR-REL-NO  TO TRUE                         82310039
806900         IF PV-NBR-EDIT-ERRORS < PC-MAX-ERRORS                    82320039
807000           ADD +1       TO PV-NBR-EDIT-ERRORS                     82330039
807100           MOVE PC-V                                              82340039
807200                TO PV-ERROR-CDE (PV-NBR-EDIT-ERRORS)              82350039
807300         END-IF                                                   82360039
807400     END-IF.                                                      82370039
807500                                                                  82380039
807600*-----------------------------------------------------------------82390039
807700 4982-COUNT-CANCELED-LINES.                                       82400039
807800                                                                  82410039
807900     INITIALIZE PV-CANCELED-LINES-PACK                            82420039
808000                                                                  82430039
808100     EXEC SQL                                                     82440039
808200           SELECT                                                 82450039
808300                  COUNT(DISTINCT A.PO_LNE_NBR)                    82460039
808400             INTO                                                 82470039
808500                  :PV-CANCELED-LINES-PACK                         82480039
808600             FROM                                                 82490039
808700                  TPURITM  A                                      82500039
808800                                                                  82510039
808900             WHERE A.PO_NBR      =  :PURCHS-PO-NBR                82520039
809000               AND A.PO_PREPK_ID =  :POPRPK-PO-PREPK-ID           82530039
809100               AND A.VER_STATUS_CDE = :PC-A                       82540039
809200               AND A.STATUS_CDE IN ('CA', 'CB', 'CM')             82550039
809300     END-EXEC.                                                    82560039
809400                                                                  82570039
809500     EVALUATE TRUE                                                82580039
809600         WHEN SQLCODE = ZERO                                      82590039
809700         WHEN SQLCODE = +100                                      82600039
809800             CONTINUE                                             82610039
809900                                                                  82620039
810000         WHEN SQLWARN0 NOT EQUAL SPACE                            82630039
810100         WHEN SQLCODE NOT EQUAL ZERO                              82640039
810200             MOVE '4982-COUNT-CANCELED-LINES'                     82650039
810300                                      TO DP013-PARAGRAPH          82660039
810400             MOVE 'UNSUCCESSFUL SELECT'                           82670039
810500                              TO DP013-MESSAGE-TEXT (1)           82680039
810600             MOVE SQLCA TO DP013-SQLCA                            82690039
810700             MOVE '       '  TO DP013-DB2-TABLE-NAME (1)          82700039
810800             SET DP013-DB2-ABEND                                  82710039
810900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               82720039
811000             PERFORM DP013-0000-PROCESS-ABEND                     82730039
811100     END-EVALUATE.                                                82740039
811200                                                                  82750039
811300*-----------------------------------------------------------------82760039
811400 4984-COUNT-TOTAL-LINES.                                          82770039
811500                                                                  82780039
811600     INITIALIZE PV-TOTAL-LINES-PACK                               82790039
811700                                                                  82800039
811800     EXEC SQL                                                     82810039
811900           SELECT                                                 82820039
812000                  COUNT(DISTINCT A.PO_LNE_NBR)                    82830039
812100             INTO                                                 82840039
812200                  :PV-TOTAL-LINES-PACK                            82850039
812300             FROM                                                 82860039
812400                  TPURITM  A                                      82870039
812500                                                                  82880039
812600             WHERE A.PO_NBR      =  :PURCHS-PO-NBR                82890039
812700               AND A.PO_PREPK_ID =  :POPRPK-PO-PREPK-ID           82900039
812800               AND A.VER_STATUS_CDE = :PC-A                       82910039
812900     END-EXEC.                                                    82920039
813000                                                                  82930039
813100     EVALUATE TRUE                                                82940039
813200         WHEN SQLCODE = ZERO                                      82950039
813300         WHEN SQLCODE = +100                                      82960039
813400             CONTINUE                                             82970039
813500                                                                  82980039
813600         WHEN SQLWARN0 NOT EQUAL SPACE                            82990039
813700         WHEN SQLCODE NOT EQUAL ZERO                              83000039
813800             MOVE '4984-COUNT-TOTAL-LINES'                        83010039
813900                                      TO DP013-PARAGRAPH          83020039
814000             MOVE 'UNSUCCESSFUL SELECT'                           83030039
814100                              TO DP013-MESSAGE-TEXT (1)           83040039
814200             MOVE SQLCA TO DP013-SQLCA                            83050039
814300             MOVE '       '  TO DP013-DB2-TABLE-NAME (1)          83060039
814400             SET DP013-DB2-ABEND                                  83070039
814500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               83080039
814600             PERFORM DP013-0000-PROCESS-ABEND                     83090039
814700     END-EVALUATE.                                                83100039
814800                                                                  83110039
814900 EJECT                                                            83120039
815000*----------------------------------------------------------------*83130039
815100* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *83140039
815200* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *83150039
815300* FOR THE SELECTED ITEMS QUEUE.                                  *83160039
815400*                                                                *83170039
815500* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *83180039
815600* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *83190039
815700* THE ARRAY IS FULL.                                             *83200039
815800*----------------------------------------------------------------*83210039
815900                                                                  83220039
816000 5000-PREPARE-SEL-QUEUE.                                          83230039
816100                                                                  83240039
816200     MOVE +1                   TO  ASC-BLK-SUB.                   83250039
816300     PERFORM 5100-WRITE-TEMP-STORAGE.                             83260039
816400     ADD +1                    TO  ASC-BLK-SUB.                   83270039
816500     PERFORM 5100-WRITE-TEMP-STORAGE.                             83280039
816600                                                                  83290039
816700     MOVE ASC-SEL-QUEUE-NAME   TO  PO013-SEL-QUEUE-NAME.          83300039
816800     PERFORM 6010-DELETE-SEL-QUEUE.                               83310039
816900                                                                  83320039
817000     SET ASC-UPDATE-TSQ        TO  TRUE.                          83330039
817100                                                                  83340039
817200     SET PO062-IDX             TO  1.                             83350039
817300     MOVE ZERO                 TO PO013-NUMBER-OF-TS-ITEMS.       83360039
817400     INITIALIZE PO062-SELECTED-ITEM-ARRAY.                        83370039
817500                                                                  83380039
817600     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           83390039
817700             VARYING PV-ITEM                                      83400039
817800             FROM 1 BY 1                                          83410039
817900             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     83420039
818000                                                                  83430039
818100     IF  PO062-IDX > 1                                            83440039
818200         PERFORM 5205-WRITE-SEL-QUEUE                             83450039
818300         ADD +1                TO PO013-NUMBER-OF-TS-ITEMS        83460039
818400     END-IF.                                                      83470039
818500 EJECT                                                            83480039
818600*----------------------------------------------------------------*83490039
818700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *83500039
818800*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *83510039
818900*----------------------------------------------------------------*83520039
819000                                                                  83530039
819100 5100-WRITE-TEMP-STORAGE.                                         83540039
819200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     83550039
819300                                   TO PV-LIST-ITEM-NUMBER.        83560039
819400     COMPUTE PV-BLOCK-NUMBER =                                    83570039
819500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    83580039
819600                                                                  83590039
819700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             83600039
819800     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             83610039
819900         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      83620039
820000             PERFORM 5105-REWRITE-ASC-LISTQ                       83630039
820100         END-IF                                                   83640039
820200     ELSE                                                         83650039
820300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       83660039
820400         ASC-HIGHEST-BLOCK-WRITTEN + 1                            83670039
820500         PERFORM 5110-WRITE-ASC-LISTQ                             83680039
820600         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   83690039
820700     END-IF.                                                      83700039
820800                                                                  83710039
820900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             83720039
821000******************************************************************83730039
821100** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **83740039
821200** SPECIFIC COMMAREA.                                           **83750039
821300******************************************************************83760039
821400 5105-REWRITE-ASC-LISTQ.                                          83770039
821500     EXEC CICS                                                    83780039
821600         WRITEQ TS                                                83790039
821700             QUEUE (ASC-LIST-QUEUE-NAME)                          83800039
821800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               83810039
821900             ITEM  (PV-BLOCK-NUMBER)                              83820039
822000             REWRITE                                              83830039
822100             RESP  (PV-CICS-RESP)                                 83840039
822200     END-EXEC.                                                    83850039
822300                                                                  83860039
822400     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           83870039
822500         CONTINUE                                                 83880039
822600     ELSE                                                         83890039
822700         SET DP013-CICS-ABEND            TO TRUE                  83900039
822800         SET DP013-NO-ROLLBACK           TO TRUE                  83910039
822900         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       83920039
823000         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     83930039
823100                                         TO DP013-MESSAGE-TEXT(1) 83940039
823200         PERFORM DP013-0000-PROCESS-ABEND                         83950039
823300     END-IF.                                                      83960039
823400                                                                  83970039
823500******************************************************************83980039
823600** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **83990039
823700** SPECIFIC COMMAREA.                                           **84000039
823800******************************************************************84010039
823900 5110-WRITE-ASC-LISTQ.                                            84020039
824000     EXEC CICS                                                    84030039
824100         WRITEQ TS                                                84040039
824200             QUEUE (ASC-LIST-QUEUE-NAME)                          84050039
824300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               84060039
824400             ITEM  (PV-BLOCK-NUMBER)                              84070039
824500             RESP  (PV-CICS-RESP)                                 84080039
824600     END-EXEC.                                                    84090039
824700     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      84100039
824800         SET DP013-CICS-ABEND      TO TRUE                        84110039
824900         SET DP013-NO-ROLLBACK     TO TRUE                        84120039
825000         MOVE '5110-WRITE-ASC-LISTQ'                              84130039
825100                                   TO DP013-PARAGRAPH             84140039
825200         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           84150039
825300                                   TO DP013-MESSAGE-TEXT(1)       84160039
825400         PERFORM DP013-0000-PROCESS-ABEND                         84170039
825500     END-IF.                                                      84180039
825600 EJECT                                                            84190039
825700*----------------------------------------------------------------*84200039
825800* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *84210039
825900* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *84220039
826000*----------------------------------------------------------------*84230039
826100                                                                  84240039
826200 5200-FILL-SEL-QUEUE-RECORD.                                      84250039
826300                                                                  84260039
826400     PERFORM 6112-READ-LIST-QUEUE.                                84270039
826500                                                                  84280039
826600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       84290039
826700         PERFORM                                                  84300039
826800         VARYING LQW-IDX                                          84310039
826900         FROM 1 BY 1                                              84320039
827000         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            84330039
827100           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          84340039
827200                                                                  84350039
827300             IF  LQW-SELECT (LQW-IDX)                             84360039
827400                                                                  84370039
827500               IF DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)           84380039
827600                 MOVE 1         TO TR061-NUMBER-OF-SELECTED-ITEMS 84390039
827700                 MOVE LQW-PO-NUMBER (LQW-IDX)                     84400039
827800                                TO TR061-PO-NBR                   84410039
827900                 MOVE LQW-NBR-EDIT-ERRORS                         84420039
828000                                      (LQW-IDX)                   84430039
828100                                TO TR061-NBR-EDIT-ERRORS          84440039
828200                 MOVE LQW-EDIT-ERROR-ARRAY                        84450039
828300                                      (LQW-IDX)                   84460039
828400                                TO TR061-EDIT-ERROR-ARRAY         84470039
828500                 SET PS-FOUND-SELECTED-PO   TO TRUE               84480039
828600                 PERFORM 5205-WRITE-SEL-QUEUE                     84490039
828700                 SET LQW-IDX TO PC-ITEMS-PER-PANEL                84500039
828800                 SET LQW-IDX UP BY 1                              84510039
828900               ELSE                                               84520039
829000                                                                  84530039
829100                 MOVE LQW-PO-NUMBER (LQW-IDX)                     84540039
829200                                TO PO062-PO-NUMBER (PO062-IDX)    84550039
829300                 SET PO062-IDX UP BY 1                            84560039
829400                 IF  PO062-IDX > PO062-MAX-ITEMS                  84570039
829500                     PERFORM 5205-WRITE-SEL-QUEUE                 84580039
829600                     ADD +1        TO PO013-NUMBER-OF-TS-ITEMS    84590039
829700                     INITIALIZE PO062-SELECTED-ITEM-ARRAY         84600039
829800                     SET PO062-IDX TO  1                          84610039
829900                 END-IF                                           84620039
830000               END-IF                                             84630039
830100             END-IF                                               84640039
830200         END-PERFORM                                              84650039
830300     END-IF.                                                      84660039
830400                                                                  84670039
830500*----------------------------------------------------------------*84680039
830600*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *84690039
830700*----------------------------------------------------------------*84700039
830800                                                                  84710039
830900 5205-WRITE-SEL-QUEUE.                                            84720039
831000                                                                  84730039
831100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            84740039
831200                                   TO PO062-SELECTED-ITEMS.       84750039
831300                                                                  84760039
831400     EXEC CICS                                                    84770039
831500          WRITEQ TS                                               84780039
831600              QUEUE (ASC-SEL-QUEUE-NAME)                          84790039
831700              FROM  (PO062-PO-SELECT-RECORD)                      84800039
831800              ITEM  (PV-SEL-QUEUE-ITEM)                           84810039
831900              RESP  (PV-CICS-RESP)                                84820039
832000     END-EXEC.                                                    84830039
832100                                                                  84840039
832200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          84850039
832300         CONTINUE                                                 84860039
832400     ELSE                                                         84870039
832500         SET DP013-CICS-ABEND      TO TRUE                        84880039
832600         SET DP013-NO-ROLLBACK     TO TRUE                        84890039
832700         MOVE '5205-WRITE-SEL-QUEUE'                              84900039
832800                                   TO DP013-PARAGRAPH             84910039
832900         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          84920039
833000                                   TO DP013-MESSAGE-TEXT(1)       84930039
833100         PERFORM DP013-0000-PROCESS-ABEND                         84940039
833200     END-IF.                                                      84950039
833300 EJECT                                                            84960039
833400*----------------------------------------------------------------*84970039
833500*  ENQUE THE TRANSIENT DATA QUEUE                                *84980039
833600*----------------------------------------------------------------*84990039
833700 5730-TD-QUEUE-ENQ.                                               85000039
833800                                                                  85010039
833900     EXEC CICS ENQ                                                85020039
834000          RESOURCE (TD-QUEUE-NAME)                                85030039
834100          LENGTH   (TD-Q-NAME-LENGTH)                             85040039
834200          RESP     (PV-CICS-RESP)                                 85050039
834300     END-EXEC.                                                    85060039
834400                                                                  85070039
834500     IF PV-CICS-RESP NOT = DFHRESP(NORMAL)                        85080039
834600         SET DP013-LOGIC-ABEND     TO TRUE                        85090039
834700         SET DP013-NO-ROLLBACK     TO TRUE                        85100039
834800         MOVE '5730-TD-QUEUE-ENQ'  TO DP013-PARAGRAPH             85110039
834900         MOVE PV-CICS-RESP         TO DP013-MESSAGE-TEXT (1)      85120039
835000         MOVE 'ERROR ENQUEING TD'                                 85130039
835100                                   TO DP013-MESSAGE-TEXT (2)      85140039
835200         PERFORM DP013-0000-PROCESS-ABEND                         85150039
835300     END-IF.                                                      85160039
835400                                                                  85170039
835500*----------------------------------------------------------------*85180039
835600*  WRITE A JCL LINE TO THE TRANSIENT DATE QUEUE                  *85190039
835700*----------------------------------------------------------------*85200039
835800 5740-WRITE-TRANS-DATA-LINE.                                      85210039
835900                                                                  85220039
836000     EXEC CICS WRITEQ TD                                          85230039
836100          QUEUE    (TD-QUEUE-NAME)                                85240039
836200          FROM     (TD-JCL-LINE)                                  85250039
836300          LENGTH   (TD-JCL-LINE-LENGTH)                           85260039
836400          RESP     (PV-CICS-RESP)                                 85270039
836500     END-EXEC.                                                    85280039
836600                                                                  85290039
836700     IF PV-CICS-RESP NOT = DFHRESP(NORMAL)                        85300039
836800         SET DP013-LOGIC-ABEND     TO TRUE                        85310039
836900         SET DP013-NO-ROLLBACK     TO TRUE                        85320039
837000         MOVE '5740-WRITE-TRANS-DATA-LINE'                        85330039
837100                                   TO DP013-PARAGRAPH             85340039
837200         MOVE PV-CICS-RESP         TO DP013-MESSAGE-TEXT (1)      85350039
837300         MOVE 'ERROR WRITEING TRANS DATA LINE'                    85360039
837400                                   TO DP013-MESSAGE-TEXT (2)      85370039
837500         PERFORM DP013-0000-PROCESS-ABEND                         85380039
837600     END-IF.                                                      85390039
837700                                                                  85400039
837800*----------------------------------------------------------------*85410039
837900*  DENQUE THE TRANSIENT DATA QUEUE                               *85420039
838000*----------------------------------------------------------------*85430039
838100 5750-TD-QUEUE-DEQ.                                               85440039
838200                                                                  85450039
838300     EXEC CICS DEQ                                                85460039
838400          RESOURCE (TD-QUEUE-NAME)                                85470039
838500          LENGTH   (TD-Q-NAME-LENGTH)                             85480039
838600          RESP     (PV-CICS-RESP)                                 85490039
838700     END-EXEC.                                                    85500039
838800                                                                  85510039
838900     IF PV-CICS-RESP NOT = DFHRESP(NORMAL)                        85520039
839000         SET DP013-LOGIC-ABEND     TO TRUE                        85530039
839100         SET DP013-NO-ROLLBACK     TO TRUE                        85540039
839200         MOVE '5750-TD-QUEUE-DEQ'  TO DP013-PARAGRAPH             85550039
839300         MOVE PV-CICS-RESP         TO DP013-MESSAGE-TEXT (1)      85560039
839400         MOVE 'ERROR DENQUEING TD'                                85570039
839500                                   TO DP013-MESSAGE-TEXT (2)      85580039
839600         PERFORM DP013-0000-PROCESS-ABEND                         85590039
839700     END-IF.                                                      85600039
839800                                                                  85610039
839900 5830-SUBMIT-REPORT.                                              85620039
840000                                                                  85630039
840100     PERFORM 5840-GET-USER-SYSTEM.                                85640039
840200     PERFORM 5850-GET-PACKAGE-CODE.                               85650039
840300     IF PV-CIT1-CICS                                              85660039
840400         MOVE PV-USER-ID           TO PV-TEST-JOB-USER-ID         85670039
840500                                      PC-TEST-NOTIFY-ID           85680039
840600         MOVE PV-TEST-JOB          TO JL-JOB-NAME                 85690039
840700         MOVE PC-TEST-CLASS        TO JL-JCL-CLASS                85700039
840800         MOVE PC-TEST-LIBSRCH      TO JL-JCL-LIBSRCH              85710039
840900         MOVE PC-TEST-JOB-PARM     TO JL-JCL-JOB-PARM             85720039
841000         MOVE PC-TEST-JOBLIB       TO JL-JCL-JOBLIB               85730039
841100*        MOVE PC-TEST-JOBOUT1      TO JL-JCL-OUTPUT1              85740039
841200         MOVE PC-TEST-JOBOUT2A     TO JL-JCL-OUTPUT1              85750039
841300         MOVE PC-TEST-JOBOUT2C     TO JL-JCL-OUTPUT2              85760039
841400         MOVE PC-TEST-JOBOUT3      TO JL-JCL-OUTPUT3              85770039
841500         MOVE PC-TEST-JOBOUT3      TO JL-JCL-OUTPUT4              85780039
841600           IF PURCHS-PKGNG-CDE = PC-M OR PC-I                     85790039
841700               MOVE PC-TEST-PROC-SI-PK                            85800039
841800                                   TO JL-JCL-PROC                 85810039
841900           ELSE                                                   85820039
842000               MOVE PC-TEST-PROC-SI                               85830039
842100                                   TO JL-JCL-PROC                 85840039
842200           END-IF                                                 85850039
842300     ELSE                                                         85860039
842400       IF PV-CIQA-CICS                                            85870039
842500         CONTINUE                                                 85880039
842600       ELSE                                                       85890039
842700         PERFORM 7100-BUYER-INFORMATION                           85900039
842800         MOVE PC-PROD-CLASS        TO JL-JCL-CLASS                85910039
842900         MOVE PC-PROD-LIBSRCH      TO JL-JCL-LIBSRCH              85920039
843000         MOVE PC-PROD-JOB-PARM     TO JL-JCL-JOB-PARM             85930039
843100         MOVE PC-PROD-JOBLIB       TO JL-JCL-JOBLIB               85940039
843200         MOVE PC-PROD-JOBOUT1      TO JL-JCL-OUTPUT1              85950039
843300         MOVE PC-PROD-JOBOUT2      TO JL-JCL-OUTPUT2              85960039
843400         MOVE PC-PROD-JOBOUT3      TO JL-JCL-OUTPUT3              85970039
843500         MOVE PC-PROD-JOBOUT4      TO JL-JCL-OUTPUT4              85980039
843600         MOVE PC-PROD-JOB-POK902   TO JL-JOB-NAME                 85990039
843700           IF PURCHS-PKGNG-CDE = PC-M OR PC-I                     86000039
843800               MOVE PC-PROD-PROC-SI-PK                            86010039
843900                                   TO JL-JCL-PROC                 86020039
844000           ELSE                                                   86030039
844100               MOVE PC-PROD-PROC-SI                               86040039
844200                                   TO JL-JCL-PROC                 86050039
844300           END-IF                                                 86060039
844400       END-IF                                                     86070039
844500     END-IF.                                                      86080039
844600                                                                  86090039
844700                                                                  86100039
844800     MOVE LQW-PO-NUMBER (LQW-IDX)  TO JL-PO-NBR.                  86110039
844900     MOVE 'BY'                     TO JL-PRINT-TYPE-BY.           86120039
845000     MOVE 'VN'                     TO JL-PRINT-TYPE-VN.           86130039
845100                                                                  86140039
845200     PERFORM 5730-TD-QUEUE-ENQ.                                   86150039
845300     PERFORM                                                      86160039
845400         VARYING JL-LINE-INDEX                                    86170039
845500         FROM 1 BY 1                                              86180039
845600         UNTIL JL-LINE-INDEX > 18                                 86190039
845700             MOVE JL-JCL-LINE (JL-LINE-INDEX)                     86200039
845800                                   TO TD-JCL-LINE                 86210039
845900             PERFORM 5740-WRITE-TRANS-DATA-LINE                   86220039
846000     END-PERFORM.                                                 86230039
846100     PERFORM 5750-TD-QUEUE-DEQ.                                   86240039
846200                                                                  86250039
846300 EJECT                                                            86260039
846400                                                                  86270039
846500 5840-GET-USER-SYSTEM.                                            86280039
846600                                                                  86290039
846700     EXEC CICS ASSIGN                                             86300039
846800          SYSID    (PV-SYSTEM-ID)                                 86310039
846900          USERID   (PV-USER-ID)                                   86320039
847000          RESP     (PV-CICS-RESP)                                 86330039
847100     END-EXEC.                                                    86340039
847200                                                                  86350039
847300     IF PV-CICS-RESP NOT = DFHRESP(NORMAL)                        86360039
847400         SET DP013-LOGIC-ABEND     TO TRUE                        86370039
847500         SET DP013-NO-ROLLBACK     TO TRUE                        86380039
847600         MOVE '5840-GET-USER-SYSTEM'   TO DP013-PARAGRAPH         86390039
847700         MOVE PV-CICS-RESP         TO DP013-MESSAGE-TEXT (1)      86400039
847800         MOVE 'ERROR GETTING USER SYSTEM'                         86410039
847900                                   TO DP013-MESSAGE-TEXT (2)      86420039
848000         PERFORM DP013-0000-PROCESS-ABEND                         86430039
848100     END-IF.                                                      86440039
848200                                                                  86450039
848300 5850-GET-PACKAGE-CODE.                                           86460039
848400                                                                  86470039
848500     EXEC SQL                                                     86480039
848600         SELECT PKGNG_CDE                                         86490039
848700         INTO :PURCHS-PKGNG-CDE                                   86500039
848800         FROM TPURCHS                                             86510039
848900         WHERE PO_NBR = :DK-PO-NUMBER                             86520039
849000         AND VER_STATUS_CDE = :PC-A                               86530039
849100     END-EXEC.                                                    86540039
849200     EVALUATE TRUE                                                86550039
849300       WHEN SQLCODE = ZEROS                                       86560039
849400         CONTINUE                                                 86570039
849500       WHEN SQLCODE = -904                                        86580039
849600       WHEN SQLCODE = -911                                        86590039
849700       WHEN SQLCODE = -913                                        86600039
849800            MOVE PC-TSYMSG-00984      TO DP020-MSG-NUMBER         86610039
849900            SET PS-ERROR                                          86620039
850000                DP020-NEXT-ACT-APPL-ERROR                         86630039
850100                DP020-MSG-FATAL                                   86640039
850200                    TO TRUE                                       86650039
850300            MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1)   86660039
850400            PERFORM 0001-CALL-CICS-ARCH-API                       86670039
850500       WHEN OTHER                                                 86680039
850600            MOVE '5850-GET-PACKAGE-CODE' TO DP013-PARAGRAPH       86690039
850700            MOVE 'UNSUCCESSFUL SELECT PKG CODE' TO                86700039
850800                                            DP013-MESSAGE-TEXT (1)86710039
850900            MOVE SQLCA TO DP013-SQLCA                             86720039
851000            MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)           86730039
851100            SET DP013-DB2-ABEND                                   86740039
851200                DP013-XCTL-DISPLAY-RESTART TO TRUE                86750039
851300                                                                  86760039
851400            PERFORM DP013-0000-PROCESS-ABEND                      86770039
851500     END-EVALUATE.                                                86780039
851600*-----------------------------------------------------------------86790039
851700 5854-IMPORTS-GET-PACKAGE-CODE.                                   86800039
851800                                                                  86810039
851900     EXEC SQL                                                     86820039
852000         SELECT PKGNG_CDE                                         86830039
852100         INTO :PURCHS-PKGNG-CDE                                   86840039
852200         FROM TPURCHS                                             86850039
852300         WHERE PO_NBR = :DK-PO-NUMBER                             86860039
852400         AND VER_STATUS_CDE = :PC-A                               86870039
852500     END-EXEC.                                                    86880039
852600     EVALUATE TRUE                                                86890039
852700       WHEN SQLCODE = ZEROS                                       86900039
852800         CONTINUE                                                 86910039
852900       WHEN SQLCODE = -811                                        86920039
853000       WHEN SQLCODE = +100                                        86930039
853100         MOVE SPACES TO PURCHS-PKGNG-CDE                          86940039
853200       WHEN SQLCODE = -904                                        86950039
853300       WHEN SQLCODE = -911                                        86960039
853400       WHEN SQLCODE = -913                                        86970039
853500            MOVE PC-TSYMSG-00984      TO DP020-MSG-NUMBER         86980039
853600            SET PS-ERROR                                          86990039
853700                DP020-NEXT-ACT-APPL-ERROR                         87000039
853800                DP020-MSG-FATAL                                   87010039
853900                    TO TRUE                                       87020039
854000            MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1)   87030039
854100            PERFORM 0001-CALL-CICS-ARCH-API                       87040039
854200       WHEN OTHER                                                 87050039
854300            MOVE '5854-IMPORTS-GET-PACKAGE-CODE'                  87060039
854400                                         TO DP013-PARAGRAPH       87070039
854500            MOVE 'UNSUCCESSFUL SELECT PKG CODE' TO                87080039
854600                                            DP013-MESSAGE-TEXT (1)87090039
854700            MOVE SQLCA TO DP013-SQLCA                             87100039
854800            MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)           87110039
854900            SET DP013-DB2-ABEND                                   87120039
855000                DP013-XCTL-DISPLAY-RESTART TO TRUE                87130039
855100                                                                  87140039
855200            PERFORM DP013-0000-PROCESS-ABEND                      87150039
855300     END-EVALUATE.                                                87160039
855400                                                                  87170039
855500******************************************************************87180039
855600** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **87190039
855700** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **87200039
855800** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **87210039
855900** THE USER.                                                    **87220039
856000******************************************************************87230039
856100 6000-REFRESH-PANEL-FROM-TEMP.                                    87240039
856200     IF  ASC-UPDATE-TSQ                                           87250039
856300         SET ASC-NO-TSQ-UPDATE TO TRUE                            87260039
856400         MOVE ZERO                 TO PV-SAVE-ITEM                87270039
856500                                      PV-SEL-QUEUE-ITEM           87280039
856600         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        87290039
856700                                   TO PV-HOLD-SELECTED-ITEMS      87300039
856800         MOVE +1                   TO PV-ITEMS-PROCESSED          87310039
856900         PERFORM 6100-UPDATE-TSQ                                  87320039
857000             UNTIL PV-ITEMS-PROCESSED >                           87330039
857100                                     ASC-NUMBER-OF-SELECTED-ITEMS 87340039
857200         PERFORM 6010-DELETE-SEL-QUEUE                            87350039
857300         INITIALIZE ASC-BLOCK-ENTRIES (1)                         87360039
857400                    ASC-BLOCK-ENTRIES (2)                         87370039
857500     END-IF.                                                      87380039
857600                                                                  87390039
857700*----------------------------------------------------------------*87400039
857800*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *87410039
857900*----------------------------------------------------------------*87420039
858000 6010-DELETE-SEL-QUEUE.                                           87430039
858100                                                                  87440039
858200     EXEC CICS                                                    87450039
858300         DELETEQ TS                                               87460039
858400             QUEUE (ASC-SEL-QUEUE-NAME)                           87470039
858500             RESP  (PV-CICS-RESP)                                 87480039
858600     END-EXEC.                                                    87490039
858700*                                                                 87500039
858800     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      87510039
858900        (PV-CICS-RESP = DFHRESP(QIDERR)))                         87520039
859000         CONTINUE                                                 87530039
859100     ELSE                                                         87540039
859200         SET DP013-CICS-ABEND TO TRUE                             87550039
859300         SET DP013-NO-ROLLBACK TO TRUE                            87560039
859400         MOVE '6010-DELETE-SEL-QUEUE'                             87570039
859500                        TO DP013-PARAGRAPH                        87580039
859600         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         87590039
859700                        TO DP013-MESSAGE-TEXT (1)                 87600039
859800         PERFORM DP013-0000-PROCESS-ABEND                         87610039
859900     END-IF.                                                      87620039
860000                                                                  87630039
860100*----------------------------------------------------------------*87640039
860200*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *87650039
860300*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *87660039
860400*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *87670039
860500*    THE TEMP QUEUE.                                             *87680039
860600*----------------------------------------------------------------*87690039
860700                                                                  87700039
860800 6100-UPDATE-TSQ.                                                 87710039
860900                                                                  87720039
861000     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             87730039
861100     PERFORM 6105-READ-SEL-QUEUE.                                 87740039
861200     PERFORM                                                      87750039
861300         VARYING PO062-IDX                                        87760039
861400         FROM 1 BY 1                                              87770039
861500         UNTIL ((PV-ITEMS-PROCESSED >                             87780039
861600                              PV-HOLD-SELECTED-ITEMS)             87790039
861700         OR (PO062-IDX GREATER THAN PO062-MAX-ITEMS))             87800039
861800         PERFORM 6110-PROCESS-ITEMS                               87810039
861900         ADD +1                TO PV-ITEMS-PROCESSED              87820039
862000     END-PERFORM.                                                 87830039
862100     PERFORM 6111-WRITE-LIST-QUEUE.                               87840039
862200*----------------------------------------------------------------*87850039
862300*    READ THE LIST QUEUE RECORD.                                 *87860039
862400*----------------------------------------------------------------*87870039
862500                                                                  87880039
862600 6105-READ-SEL-QUEUE.                                             87890039
862700                                                                  87900039
862800     EXEC CICS                                                    87910039
862900          READQ TS                                                87920039
863000              QUEUE (ASC-SEL-QUEUE-NAME)                          87930039
863100              INTO  (PO062-PO-SELECT-RECORD)                      87940039
863200              ITEM  (PV-SEL-QUEUE-ITEM)                           87950039
863300              RESP  (PV-CICS-RESP)                                87960039
863400     END-EXEC.                                                    87970039
863500*                                                                 87980039
863600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          87990039
863700         CONTINUE                                                 88000039
863800     ELSE                                                         88010039
863900         SET DP013-CICS-ABEND      TO  TRUE                       88020039
864000         SET DP013-NO-ROLLBACK     TO  TRUE                       88030039
864100         MOVE '6105-READ-SEL-QUEUE'                               88040039
864200                                   TO  DP013-PARAGRAPH            88050039
864300         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           88060039
864400                                   TO  DP013-MESSAGE-TEXT(1)      88070039
864500         PERFORM DP013-0000-PROCESS-ABEND                         88080039
864600     END-IF.                                                      88090039
864700 EJECT                                                            88100039
864800*----------------------------------------------------------------*88110039
864900*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*88120039
865000*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*88130039
865100*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *88140039
865200*----------------------------------------------------------------*88150039
865300                                                                  88160039
865400 6110-PROCESS-ITEMS.                                              88170039
865500                                                                  88180039
865600     COMPUTE PV-ITEM = 1 + ((PO062-ITEM (PO062-IDX) - 1)          88190039
865700                     / PC-ITEMS-PER-PANEL).                       88200039
865800                                                                  88210039
865900     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           88220039
866000         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          88230039
866100             PERFORM 6111-WRITE-LIST-QUEUE                        88240039
866200         END-IF                                                   88250039
866300         MOVE PV-ITEM          TO PV-SAVE-ITEM                    88260039
866400                                                                  88270039
866500         PERFORM 6112-READ-LIST-QUEUE                             88280039
866600         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               88290039
866700             CONTINUE                                             88300039
866800         END-IF                                                   88310039
866900     END-IF.                                                      88320039
867000                                                                  88330039
867100     COMPUTE PV-SUB = (PO062-ITEM (PO062-IDX)                     88340039
867200                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              88350039
867300     SET LQW-DESELECT (PV-SUB) TO    TRUE                         88360039
867400     MOVE LQW-SELECTED-SW (PV-SUB)                                88370039
867500                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  88380039
867600                                                                  88390039
867700     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                88400039
867800                                                                  88410039
867900*----------------------------------------------------------------*88420039
868000*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *88430039
868100*----------------------------------------------------------------*88440039
868200                                                                  88450039
868300 6111-WRITE-LIST-QUEUE.                                           88460039
868400                                                                  88470039
868500     EXEC CICS                                                    88480039
868600         WRITEQ TS                                                88490039
868700             QUEUE (ASC-LIST-QUEUE-NAME)                          88500039
868800             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     88510039
868900             ITEM  (PV-SAVE-ITEM)                                 88520039
869000             REWRITE                                              88530039
869100             RESP  (PV-CICS-RESP)                                 88540039
869200     END-EXEC.                                                    88550039
869300*                                                                 88560039
869400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          88570039
869500         CONTINUE                                                 88580039
869600     ELSE                                                         88590039
869700         SET DP013-CICS-ABEND  TO  TRUE                           88600039
869800         SET DP013-NO-ROLLBACK TO  TRUE                           88610039
869900         MOVE '6111-WRITE-LIST-QUEUE'                             88620039
870000                               TO  DP013-PARAGRAPH                88630039
870100         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  88640039
870200                               TO  DP013-MESSAGE-TEXT(1)          88650039
870300         PERFORM DP013-0000-PROCESS-ABEND                         88660039
870400     END-IF.                                                      88670039
870500                                                                  88680039
870600 EJECT                                                            88690039
870700*----------------------------------------------------------------*88700039
870800*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*88710039
870900*----------------------------------------------------------------*88720039
871000                                                                  88730039
871100 6112-READ-LIST-QUEUE.                                            88740039
871200                                                                  88750039
871300     EXEC CICS                                                    88760039
871400         READQ TS                                                 88770039
871500             QUEUE (ASC-LIST-QUEUE-NAME)                          88780039
871600             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     88790039
871700             ITEM  (PV-ITEM)                                      88800039
871800             RESP  (PV-CICS-RESP)                                 88810039
871900     END-EXEC.                                                    88820039
872000*                                                                 88830039
872100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          88840039
872200         CONTINUE                                                 88850039
872300     ELSE                                                         88860039
872400         SET DP013-CICS-ABEND        TO TRUE                      88870039
872500         SET DP013-NO-ROLLBACK       TO TRUE                      88880039
872600         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           88890039
872700         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    88900039
872800                                     TO DP013-MESSAGE-TEXT(1)     88910039
872900         PERFORM DP013-0000-PROCESS-ABEND                         88920039
873000     END-IF.                                                      88930039
873100                                                                  88940039
873200******************************************************************88950039
873300* RELEASE THE SELECTED PURCHASE ORDERS                            88960039
873400******************************************************************88970039
873500                                                                  88980039
873600 7000-RELEASE-PO.                                                 88990039
873700                                                                  89000039
873800     PERFORM 6112-READ-LIST-QUEUE.                                89010039
873900                                                                  89020039
874000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       89030039
874100         PERFORM                                                  89040039
874200         VARYING LQW-IDX                                          89050039
874300         FROM 1 BY 1                                              89060039
874400         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            89070039
874500           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          89080039
874600               IF LQW-SELECT (LQW-IDX)                            89090039
874700                   IF ASC-KEY-STATUS = '4'                        89100039
874800                     CONTINUE                                     89110039
874900                   ELSE                                           89120039
875000                     PERFORM 5830-SUBMIT-REPORT                   89130039
875100                   END-IF                                         89140039
875200                   MOVE LQW-PO-NUMBER (LQW-IDX)                   89150039
875300                                   TO DK-PO-NUMBER                89160039
875400                   IF ASC-KEY-STATUS = '4'                        89170039
875500                      IF LQW-DCONSLR-RLSE-CDE (LQW-IDX) = PC-X    89180039
875600                         CONTINUE                                 89190039
875700                      ELSE                                        89200039
875800                         PERFORM 7050-SET-REXMIT-RLSE-IND         89210039
875900                      END-IF                                      89220039
876000                   ELSE                                           89230039
876100                      PERFORM 7050-SET-REXMIT-RLSE-IND            89240039
876200                   END-IF                                         89250039
876300               END-IF                                             89260039
876400         END-PERFORM                                              89270039
876500     END-IF.                                                      89280039
876600                                                                  89290039
876700 EJECT                                                            89300039
876800******************************************************************89310039
876900* SET THE EDI-REXMIT-IND TO 'R' IN ORDER TO TRANSMIT ALLOCATIONS  89320039
877000* FOR DOMESTIC ORDERS.  FOR IMPORT ORDERS SET DCONSLR_RLSE_CDE    89330039
877100* TO 'D' ON EITHER TIMPORL FOR PO LEVEL SPLITS OR TIMCNRL FOR     89340039
877200* CONTAINER LEVEL SPLITS.  THIS WILL REMOVE THE PO FROM THE       89350039
877300* SCREEN ONCE SPLITS ARE ENTERED FOR IMPORT ORDERS.               89360039
877400******************************************************************89370039
877500 7050-SET-REXMIT-RLSE-IND.                                        89380039
877600                                                                  89390039
877700     IF ASC-KEY-STATUS = '4'                                      89400039
877800        EVALUATE LQW-TYPE-CON-OR-CMN (LQW-IDX)                    89410039
877900          WHEN PC-CON                                             89420039
878000             PERFORM 7052-SELECT-TIMPORL                          89430039
878100** AHP **                                                         89440039
878200             IF IMPORL-DCONSLR-RLSE-CDE = ('Y' OR 'R')            89450039
878300                 MOVE PC-TSYMSG-03416                             89460039
878400                                   TO DP020-MSG-NUMBER            89470039
878500                 SET DP020-MSG-WARNING TO TRUE                    89480039
878600             ELSE                                                 89490039
878700                 PERFORM 7054-INACTIVATE-TIMPORL                  89500039
878800                 MOVE PC-D TO IMPORL-DCONSLR-RLSE-CDE             89510039
878900                 ADD  +1 TO IMPORL-VER-NBR                        89520039
879000                 PERFORM 7060-INSERT-TIMPORL                      89530039
879100             END-IF                                               89540039
879200** AHP **                                                         89550039
879300                                                                  89560039
879400          WHEN PC-CMN                                             89570039
879500             SET PS-EOC-TIMCNRL-NO TO TRUE                        89580039
879600             PERFORM 7070-OPEN-TIMCNRL-CSR                        89590039
879700             PERFORM 7075-FETCH-TIMCNRL-CSR                       89600039
879800             PERFORM 7065-PROCESS-TIMCNRL                         89610039
879900               UNTIL PS-EOC-TIMCNRL                               89620039
880000          WHEN OTHER                                              89630039
880100             DISPLAY '** PARAGRAPH = 7050-SET-REXMIT-RLSE-IND **' 89640039
880200             DISPLAY '** BUT NEITHER A CON OR A CMN           **' 89650039
880300        END-EVALUATE                                              89660039
880400     ELSE                                                         89670039
880500         MOVE PC-Y TO PURCHS-RLSE-IND                             89680039
880600         PERFORM 7094-GET-EDI-IND                                 89690039
880700         IF PURCHS-EDI-IND = PC-Y                                 89700039
880800           MOVE PC-R TO PURCHS-EDI-REXMIT-IND                     89710039
880900           PERFORM 7095-UPDATE-TPURCHS-EDI                        89720039
881000         ELSE                                                     89730039
881100           PERFORM 7096-UPDATE-TPURCHS-NOEDI                      89740039
881200         END-IF                                                   89750039
881300     END-IF.                                                      89760039
881400                                                                  89770039
881500*----------------------------------------------------------------*89780039
881600 7052-SELECT-TIMPORL.                                             89790039
881700                                                                  89800039
881800         EXEC SQL                                                 89810039
881900             SELECT PO_NBR                                        89820039
882000                  , VER_NBR                                       89830039
882100                  , VER_STATUS_CDE                                89840039
882200                  , CONSLR_RLSE_CDE                               89850039
882300                  , CONSLR_REQR_DTE                               89860039
882400                  , CONSLR_ACTL_DTE                               89870039
882500                  , CONSLR_ACTL_TM                                89880039
882600                  , CSTM_BKR_RLSE_CDE                             89890039
882700                  , CSTM_BKR_REQR_DTE                             89900039
882800                  , CSTM_BKR_ACTL_DTE                             89910039
882900                  , CSTM_BKR_ACTL_TM                              89920039
883000                  , TKT_PRTR_RLSE_CDE                             89930039
883100                  , TKT_PRTR_REQR_DTE                             89940039
883200                  , TKT_PRTR_ACTL_DTE                             89950039
883300                  , TKT_PRTR_ACTL_TM                              89960039
883400                  , DCONSLR_RLSE_CDE                              89970039
883500                  , DCONSLR_REQR_DTE                              89980039
883600                  , DCONSLR_ACTL_DTE                              89990039
883700                  , DCONSLR_ACTL_TM                               90000039
883800                  , LAST_UPD_TMST                                 90010039
883900                  , LAST_UPD_BY_UID                               90020039
884000                  , DCONSLR_ENT_ID                                90030039
884100             INTO  :IMPORL-PO-NBR                                 90040039
884200                  ,:IMPORL-VER-NBR                                90050039
884300                  ,:IMPORL-VER-STATUS-CDE                         90060039
884400                  ,:IMPORL-CONSLR-RLSE-CDE                        90070039
884500                  ,:IMPORL-CONSLR-REQR-DTE                        90080039
884600                  ,:IMPORL-CONSLR-ACTL-DTE                        90090039
884700                  ,:IMPORL-CONSLR-ACTL-TM                         90100039
884800                  ,:IMPORL-CSTM-BKR-RLSE-CDE                      90110039
884900                  ,:IMPORL-CSTM-BKR-REQR-DTE                      90120039
885000                  ,:IMPORL-CSTM-BKR-ACTL-DTE                      90130039
885100                  ,:IMPORL-CSTM-BKR-ACTL-TM                       90140039
885200                  ,:IMPORL-TKT-PRTR-RLSE-CDE                      90150039
885300                  ,:IMPORL-TKT-PRTR-REQR-DTE                      90160039
885400                  ,:IMPORL-TKT-PRTR-ACTL-DTE                      90170039
885500                  ,:IMPORL-TKT-PRTR-ACTL-TM                       90180039
885600                  ,:IMPORL-DCONSLR-RLSE-CDE                       90190039
885700                  ,:IMPORL-DCONSLR-REQR-DTE                       90200039
885800                  ,:IMPORL-DCONSLR-ACTL-DTE                       90210039
885900                  ,:IMPORL-DCONSLR-ACTL-TM                        90220039
886000                  ,:IMPORL-LAST-UPD-TMST                          90230039
886100                  ,:IMPORL-LAST-UPD-BY-UID                        90240039
886200                  ,:IMPORL-DCONSLR-ENT-ID                         90250039
886300             FROM  TIMPORL                                        90260039
886400             WHERE PO_NBR         = :DK-PO-NUMBER                 90270039
886500                AND VER_STATUS_CDE  = :PC-A                       90280039
886600         END-EXEC                                                 90290039
886700                                                                  90300039
886800     EVALUATE TRUE                                                90310039
886900         WHEN SQLCODE = ZERO                                      90320039
887000             CONTINUE                                             90330039
887100                                                                  90340039
887200         WHEN SQLWARN0 NOT EQUAL SPACE                            90350039
887300         WHEN SQLCODE NOT EQUAL ZERO                              90360039
887400                 MOVE '7052-SELECT-TIMPORL'                       90370039
887500                               TO DP013-PARAGRAPH                 90380039
887600                 MOVE 'UNSUCCESSFUL SELECT'                       90390039
887700                               TO DP013-MESSAGE-TEXT (1)          90400039
887800                 MOVE SQLCA    TO DP013-SQLCA                     90410039
887900                 MOVE 'TIMPORL '                                  90420039
888000                               TO DP013-DB2-TABLE-NAME (1)        90430039
888100                 SET DP013-DB2-ABEND                              90440039
888200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           90450039
888300                 PERFORM DP013-0000-PROCESS-ABEND                 90460039
888400     END-EVALUATE.                                                90470039
888500                                                                  90480039
888600*-----------------------------------------------------------------90490039
888700 7054-INACTIVATE-TIMPORL.                                         90500039
888800                                                                  90510039
888900         EXEC SQL                                                 90520039
889000             UPDATE TIMPORL                                       90530039
889100                SET VER_STATUS_CDE     = :PC-I                    90540039
889200             WHERE PO_NBR         = :DK-PO-NUMBER                 90550039
889300                AND VER_STATUS_CDE  = :PC-A                       90560039
889400         END-EXEC                                                 90570039
889500                                                                  90580039
889600     EVALUATE TRUE                                                90590039
889700         WHEN SQLCODE = ZERO                                      90600039
889800             CONTINUE                                             90610039
889900                                                                  90620039
890000         WHEN SQLWARN0 NOT EQUAL SPACE                            90630039
890100         WHEN SQLCODE NOT EQUAL ZERO                              90640039
890200                 MOVE '7054-INACTIVATE-IMPORL'                    90650039
890300                               TO DP013-PARAGRAPH                 90660039
890400                 MOVE 'UNSUCCESSFUL UPDATE'                       90670039
890500                               TO DP013-MESSAGE-TEXT (1)          90680039
890600                 MOVE SQLCA    TO DP013-SQLCA                     90690039
890700                 MOVE 'TIMPORL '                                  90700039
890800                               TO DP013-DB2-TABLE-NAME (1)        90710039
890900                 SET DP013-DB2-ABEND                              90720039
891000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           90730039
891100                 PERFORM DP013-0000-PROCESS-ABEND                 90740039
891200     END-EVALUATE.                                                90750039
891300                                                                  90760039
891400*----------------------------------------------------------------*90770039
891500 7060-INSERT-TIMPORL.                                             90780039
891600                                                                  90790039
891700         EXEC SQL                                                 90800039
891800             INSERT INTO TIMPORL                                  90810039
891900                   (PO_NBR                                        90820039
892000                  , VER_NBR                                       90830039
892100                  , VER_STATUS_CDE                                90840039
892200                  , CONSLR_RLSE_CDE                               90850039
892300                  , CONSLR_REQR_DTE                               90860039
892400                  , CONSLR_ACTL_DTE                               90870039
892500                  , CONSLR_ACTL_TM                                90880039
892600                  , CSTM_BKR_RLSE_CDE                             90890039
892700                  , CSTM_BKR_REQR_DTE                             90900039
892800                  , CSTM_BKR_ACTL_DTE                             90910039
892900                  , CSTM_BKR_ACTL_TM                              90920039
893000                  , TKT_PRTR_RLSE_CDE                             90930039
893100                  , TKT_PRTR_REQR_DTE                             90940039
893200                  , TKT_PRTR_ACTL_DTE                             90950039
893300                  , TKT_PRTR_ACTL_TM                              90960039
893400                  , DCONSLR_RLSE_CDE                              90970039
893500                  , DCONSLR_REQR_DTE                              90980039
893600                  , DCONSLR_ACTL_DTE                              90990039
893700                  , DCONSLR_ACTL_TM                               91000039
893800                  , LAST_UPD_TMST                                 91010039
893900                  , LAST_UPD_BY_UID                               91020039
894000                  , DCONSLR_ENT_ID)                               91030039
894100            VALUES (:IMPORL-PO-NBR                                91040039
894200                  , :IMPORL-VER-NBR                               91050039
894300                  , :IMPORL-VER-STATUS-CDE                        91060039
894400                  , :IMPORL-CONSLR-RLSE-CDE                       91070039
894500                  , :IMPORL-CONSLR-REQR-DTE                       91080039
894600                  , :IMPORL-CONSLR-ACTL-DTE                       91090039
894700                  , :IMPORL-CONSLR-ACTL-TM                        91100039
894800                  , :IMPORL-CSTM-BKR-RLSE-CDE                     91110039
894900                  , :IMPORL-CSTM-BKR-REQR-DTE                     91120039
895000                  , :IMPORL-CSTM-BKR-ACTL-DTE                     91130039
895100                  , :IMPORL-CSTM-BKR-ACTL-TM                      91140039
895200                  , :IMPORL-TKT-PRTR-RLSE-CDE                     91150039
895300                  , :IMPORL-TKT-PRTR-REQR-DTE                     91160039
895400                  , :IMPORL-TKT-PRTR-ACTL-DTE                     91170039
895500                  , :IMPORL-TKT-PRTR-ACTL-TM                      91180039
895600                  , :IMPORL-DCONSLR-RLSE-CDE                      91190039
895700                  , :IMPORL-DCONSLR-REQR-DTE                      91200039
895800                  , :IMPORL-DCONSLR-ACTL-DTE                      91210039
895900                  , :IMPORL-DCONSLR-ACTL-TM                       91220039
896000                  ,  CURRENT_TIMESTAMP                            91230039
896100                  , :PC-CURRENT-PROGRAM-NAME                      91240039
896200                  , :IMPORL-DCONSLR-ENT-ID)                       91250039
896300         END-EXEC                                                 91260039
896400                                                                  91270039
896500     EVALUATE TRUE                                                91280039
896600         WHEN SQLCODE = ZERO                                      91290039
896700             CONTINUE                                             91300039
896800                                                                  91310039
896900         WHEN SQLWARN0 NOT EQUAL SPACE                            91320039
897000         WHEN SQLCODE NOT EQUAL ZERO                              91330039
897100                 MOVE '7060-INSERT-TIMPORL'                       91340039
897200                               TO DP013-PARAGRAPH                 91350039
897300                 MOVE 'UNSUCCESSFUL INSERT'                       91360039
897400                               TO DP013-MESSAGE-TEXT (1)          91370039
897500                 MOVE SQLCA    TO DP013-SQLCA                     91380039
897600                 MOVE 'TIMPORL '                                  91390039
897700                               TO DP013-DB2-TABLE-NAME (1)        91400039
897800                 SET DP013-DB2-ABEND                              91410039
897900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           91420039
898000                 PERFORM DP013-0000-PROCESS-ABEND                 91430039
898100                                                                  91440039
898200     END-EVALUATE.                                                91450039
898300                                                                  91460039
898400                                                                  91470039
898500 EJECT                                                            91480039
898600                                                                  91490039
898700*----------------------------------------------------------------*91500039
898800* PROCESS ALL TIMCNRL ROWS FOR PO UPDATING DCONSLR RLSE CDE      *91510039
898900*----------------------------------------------------------------*91520039
899000 7065-PROCESS-TIMCNRL.                                            91530039
899100                                                                  91540039
899200** AHP **                                                         91550039
899300     IF IMCNRL-DCONSLR-RLSE-CDE = ('Y' OR 'R')                    91560039
899400         MOVE PC-TSYMSG-03416                                     91570039
899500                           TO DP020-MSG-NUMBER                    91580039
899600         SET DP020-MSG-WARNING TO TRUE                            91590039
899700     ELSE                                                         91600039
899800                                                                  91610039
899900         PERFORM 7086-MOVE-IMCNRL-FOR-AUDIT                       91620039
900000                                                                  91630039
900100         SET PS-CREATE-TAUCNRL-NO TO TRUE                         91640039
900200         MOVE PC-D TO IMCNRL-DCONSLR-RLSE-CDE                     91650039
900300         PERFORM 7087-UPDATE-TIMCNRL                              91660039
900400         IF PS-CREATE-TAUCNRL                                     91670039
900500             PERFORM 7088-CREATE-IMCNRL-AUDIT-TRAIL               91680039
900600         END-IF                                                   91690039
900700     END-IF                                                       91700039
900800** AHP **                                                         91710039
900900                                                                  91720039
901000     PERFORM 7075-FETCH-TIMCNRL-CSR.                              91730039
901100                                                                  91740039
901200*----------------------------------------------------------------*91750039
901300*                                                                *91760039
901400*----------------------------------------------------------------*91770039
901500 7070-OPEN-TIMCNRL-CSR.                                           91780039
901600                                                                  91790039
901700     PERFORM                                                      91800039
901800         WITH TEST AFTER                                          91810039
901900         VARYING PV-RETRY-COUNTER                                 91820039
902000         FROM 1 BY 1                                              91830039
902100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               91840039
902200                   OR (SQLCODE = ZERO))                           91850039
902300         EXEC SQL                                                 91860039
902400              OPEN TIMCNRL_CSR                                    91870039
902500         END-EXEC                                                 91880039
902600                                                                  91890039
902700         EVALUATE TRUE                                            91900039
902800             WHEN SQLCODE = ZERO                                  91910039
902900             WHEN SQLCODE = -904                                  91920039
903000             WHEN SQLCODE = -913                                  91930039
903100                 CONTINUE                                         91940039
903200             WHEN SQLWARN0 NOT = SPACES                           91950039
903300             WHEN SQLCODE < ZERO                                  91960039
903400             WHEN SQLCODE > ZERO                                  91970039
903500                 MOVE '7070-OPEN-TIMCNRL-CSR'                     91980039
903600                                   TO DP013-PARAGRAPH             91990039
903700                 MOVE 'OPEN STORE CURSOR'                         92000039
903800                                   TO DP013-MESSAGE-TEXT (1)      92010039
903900                 MOVE SQLCA        TO DP013-SQLCA                 92020039
904000                 MOVE 'TIMCNRL '   TO DP013-DB2-TABLE-NAME (1)    92030039
904100                 SET DP013-DB2-ABEND                              92040039
904200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           92050039
904300                 PERFORM DP013-0000-PROCESS-ABEND                 92060039
904400         END-EVALUATE                                             92070039
904500     END-PERFORM.                                                 92080039
904600*                                                                 92090039
904700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        92100039
904800         MOVE '7070-OPEN-TIMCNRL-CSR' TO DP013-PARAGRAPH          92110039
904900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   92120039
905000                                   TO DP013-MESSAGE-TEXT (1)      92130039
905100         MOVE SQLCA                TO DP013-SQLCA                 92140039
905200         MOVE 'TIMCNRL '           TO DP013-DB2-TABLE-NAME (1)    92150039
905300         SET DP013-DB2-ABEND                                      92160039
905400             DP013-XCTL-DISPLAY-RESTART                           92170039
905500                                   TO TRUE                        92180039
905600         PERFORM DP013-0000-PROCESS-ABEND                         92190039
905700     END-IF.                                                      92200039
905800*----------------------------------------------------------------*92210039
905900*                                                                *92220039
906000*----------------------------------------------------------------*92230039
906100 7075-FETCH-TIMCNRL-CSR.                                          92240039
906200     EXEC SQL                                                     92250039
906300          FETCH TIMCNRL_CSR                                       92260039
906400           INTO                                                   92270039
906500             :IMCNRL-CONTNR-ID                                    92280039
906600            ,:IMCNRL-CONTNR-SEQ-NBR                               92290039
906700            ,:IMCNRL-PO-NBR                                       92300039
906800            ,:IMCNRL-DCONSLR-RLSE-CDE                             92310039
906900            ,:IMCNRL-DCONSLR-REQR-DTE                             92320039
907000            ,:IMCNRL-DCONSLR-ACTL-DTE                             92330039
907100            ,:IMCNRL-DCONSLR-ACTL-TM                              92340039
907200            ,:IMCNRL-CRE-TMST                                     92350039
907300            ,:IMCNRL-CRE-BY-UID                                   92360039
907400            ,:IMCNRL-LAST-UPD-TMST                                92370039
907500            ,:IMCNRL-LAST-UPD-BY-UID                              92380039
907600            ,:IMCNRL-DCONSLR-ENT-ID                               92390039
907700     END-EXEC                                                     92400039
907800                                                                  92410039
907900     EVALUATE TRUE                                                92420039
908000         WHEN SQLCODE = ZERO                                      92430039
908100             CONTINUE                                             92440039
908200         WHEN SQLCODE = +100                                      92450039
908300              PERFORM 7080-CLOSE-TIMCNRL-CSR                      92460039
908400              SET PS-EOC-TIMCNRL                                  92470039
908500                               TO TRUE                            92480039
908600         WHEN SQLWARN0 NOT = SPACE                                92490039
908700         WHEN SQLCODE NOT = ZERO                                  92500039
908800              MOVE '7075-FETCH-TIMCNRL-CSR'                       92510039
908900                               TO DP013-PARAGRAPH                 92520039
909000              MOVE 'FETCH TIMCNRL-CURSOR'                         92530039
909100                               TO DP013-MESSAGE-TEXT (1)          92540039
909200              MOVE 'TIMCNRL '                                     92550039
909300                               TO DP013-DB2-TABLE-NAME (1)        92560039
909400              MOVE SQLCA       TO DP013-SQLCA                     92570039
909500              SET DP013-DB2-ABEND                                 92580039
909600                  DP013-XCTL-DISPLAY-RESTART                      92590039
909700                               TO TRUE                            92600039
909800              PERFORM DP013-0000-PROCESS-ABEND                    92610039
909900     END-EVALUATE.                                                92620039
910000                                                                  92630039
910100  EJECT                                                           92640039
910200*----------------------------------------------------------------*92650039
910300 7080-CLOSE-TIMCNRL-CSR.                                          92660039
910400*----------------------------------------------------------------*92670039
910500     EXEC SQL                                                     92680039
910600          CLOSE TIMCNRL_CSR                                       92690039
910700     END-EXEC.                                                    92700039
910800*                                                                 92710039
910900     EVALUATE TRUE                                                92720039
911000         WHEN SQLCODE = ZERO                                      92730039
911100             CONTINUE                                             92740039
911200         WHEN SQLWARN0 NOT = SPACES                               92750039
911300         WHEN SQLCODE < ZERO                                      92760039
911400         WHEN SQLCODE > ZERO                                      92770039
911500             MOVE '7080-CLOSE-TIMCNRL-CSR'                        92780039
911600                               TO DP013-PARAGRAPH                 92790039
911700             MOVE 'CLOSE TIMCNRL CURSOR'                          92800039
911800                               TO DP013-MESSAGE-TEXT (1)          92810039
911900             MOVE SQLCA        TO DP013-SQLCA                     92820039
912000             MOVE 'TIMCNRL '   TO DP013-DB2-TABLE-NAME (1)        92830039
912100             SET DP013-DB2-ABEND                                  92840039
912200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               92850039
912300             PERFORM DP013-0000-PROCESS-ABEND                     92860039
912400     END-EVALUATE.                                                92870039
912500*                                                                *92880039
912600*----------------------------------------------------------------*92890039
912700* SELECT IMCNRL ROW INTO AUDIT HOST VARIABLES.                   *92900039
912800*----------------------------------------------------------------*92910039
912900 7086-MOVE-IMCNRL-FOR-AUDIT.                                      92920039
913000                                                                  92930039
913100      MOVE IMCNRL-CONTNR-ID        TO                             92940039
913200                   AUCNRL-CONTNR-ID                               92950039
913300      MOVE IMCNRL-CONTNR-SEQ-NBR   TO                             92960039
913400                   AUCNRL-CONTNR-SEQ-NBR                          92970039
913500      MOVE IMCNRL-PO-NBR           TO                             92980039
913600                   AUCNRL-PO-NBR                                  92990039
913700      MOVE IMCNRL-DCONSLR-RLSE-CDE TO                             93000039
913800                   AUCNRL-DCONSLR-RLSE-CDE                        93010039
913900      MOVE IMCNRL-DCONSLR-REQR-DTE TO                             93020039
914000                   AUCNRL-DCONSLR-REQR-DTE                        93030039
914100      MOVE IMCNRL-DCONSLR-ACTL-DTE TO                             93040039
914200                   AUCNRL-DCONSLR-ACTL-DTE                        93050039
914300      MOVE IMCNRL-DCONSLR-ACTL-TM  TO                             93060039
914400                   AUCNRL-DCONSLR-ACTL-TM                         93070039
914500      MOVE IMCNRL-CRE-TMST         TO                             93080039
914600                   AUCNRL-CRE-TMST                                93090039
914700      MOVE IMCNRL-CRE-BY-UID       TO                             93100039
914800                   AUCNRL-CRE-BY-UID                              93110039
914900      MOVE IMCNRL-LAST-UPD-TMST    TO                             93120039
915000                   AUCNRL-LAST-UPD-TMST                           93130039
915100      MOVE IMCNRL-LAST-UPD-BY-UID  TO                             93140039
915200                   AUCNRL-LAST-UPD-BY-UID.                        93150039
915300      MOVE IMCNRL-DCONSLR-ENT-ID   TO                             93160039
915400                   AUCNRL-DCONSLR-ENT-ID.                         93170039
915500*                                                                 93180039
915600******************************************************************93190039
915700 7087-UPDATE-TIMCNRL.                                             93200039
915800                                                                  93210039
915900                                                                  93220039
916000     PERFORM                                                      93230039
916100         WITH TEST AFTER                                          93240039
916200         VARYING PV-RETRY-COUNTER                                 93250039
916300         FROM 1 BY 1                                              93260039
916400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               93270039
916500                   OR (SQLCODE = ZERO)                            93280039
916600                   OR (SQLCODE = 100))                            93290039
916700                                                                  93300039
916800         EXEC SQL                                                 93310039
916900             UPDATE TIMCNRL                                       93320039
917000                SET                                               93330039
917100                   DCONSLR_RLSE_CDE = :IMCNRL-DCONSLR-RLSE-CDE    93340039
917200                 , LAST_UPD_TMST    = (CURRENT_TIMESTAMP)         93350039
917300                 , LAST_UPD_BY_UID  = :PC-CURRENT-PROGRAM-NAME    93360039
917400              WHERE CONTNR_ID       = :IMCNRL-CONTNR-ID           93370039
917500                AND CONTNR_SEQ_NBR  = :IMCNRL-CONTNR-SEQ-NBR      93380039
917600                AND PO_NBR          = :IMCNRL-PO-NBR              93390039
917700                AND DCONSLR_RLSE_CDE IN('S','N')                  93400039
917800         END-EXEC                                                 93410039
917900                                                                  93420039
918000         EVALUATE TRUE                                            93430039
918100                 WHEN SQLCODE = +0                                93440039
918200                    SET PS-CREATE-TAUCNRL TO TRUE                 93450039
918300                 WHEN SQLCODE = +100                              93460039
918400                 WHEN SQLCODE = -904                              93470039
918500                 WHEN SQLCODE = -913                              93480039
918600                     CONTINUE                                     93490039
918700                 WHEN SQLWARN0 NOT = SPACES                       93500039
918800                 WHEN SQLCODE < ZERO                              93510039
918900                 WHEN SQLCODE > ZERO                              93520039
919000                     MOVE '7087-UPDATE-TIMCNRL'                   93530039
919100                                   TO DP013-PARAGRAPH             93540039
919200                     MOVE '              '                        93550039
919300                                   TO DP013-MESSAGE-TEXT (1)      93560039
919400                     MOVE SQLCA    TO DP013-SQLCA                 93570039
919500                        MOVE 'TIMCNRL '                           93580039
919600                                   TO DP013-DB2-TABLE-NAME (1)    93590039
919700                     SET DP013-DB2-ABEND                          93600039
919800                         DP013-XCTL-DISPLAY-RESTART TO TRUE       93610039
919900                     PERFORM DP013-0000-PROCESS-ABEND             93620039
920000             END-EVALUATE                                         93630039
920100     END-PERFORM.                                                 93640039
920200*                                                                 93650039
920300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        93660039
920400         MOVE '7087-UPDATE-TIMCNRL' TO DP013-PARAGRAPH            93670039
920500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     93680039
920600                                   TO DP013-MESSAGE-TEXT (1)      93690039
920700         MOVE SQLCA                TO DP013-SQLCA                 93700039
920800         MOVE 'TIMCNRL '           TO DP013-DB2-TABLE-NAME (1)    93710039
920900         SET DP013-DB2-ABEND                                      93720039
921000             DP013-XCTL-DISPLAY-RESTART                           93730039
921100                                   TO TRUE                        93740039
921200         PERFORM DP013-0000-PROCESS-ABEND                         93750039
921300     END-IF.                                                      93760039
921400                                                                  93770039
921500 EJECT                                                            93780039
921600*                                                                 93790039
921700*----------------------------------------------------------------*93800039
921800* INSERT A COPY OF THE IMCNRL ROW TO THE AUDIT TRAIL TABLE       *93810039
921900* AFTER UPDATING THE TIMCNRL TABLE.                              *93820039
922000*----------------------------------------------------------------*93830039
922100 7088-CREATE-IMCNRL-AUDIT-TRAIL.                                  93840039
922200*----------------------------------------------------------------*93850039
922300                                                                  93860039
922400         EXEC SQL                                                 93870039
922500             INSERT INTO TAUCNRL                                  93880039
922600                   (CONTNR_ID                                     93890039
922700                   ,CONTNR_SEQ_NBR                                93900039
922800                   ,PO_NBR                                        93910039
922900                   ,DCONSLR_RLSE_CDE                              93920039
923000                   ,DCONSLR_REQR_DTE                              93930039
923100                   ,DCONSLR_ACTL_DTE                              93940039
923200                   ,DCONSLR_ACTL_TM                               93950039
923300                   ,CRE_TMST                                      93960039
923400                   ,CRE_BY_UID                                    93970039
923500                   ,AUD_FUNC_CDE                                  93980039
923600                   ,AUD_TMST                                      93990039
923700                   ,LAST_UPD_TMST                                 94000039
923800                   ,LAST_UPD_BY_UID                               94010039
923900                   ,DCONSLR_ENT_ID)                               94020039
924000            VALUES (:AUCNRL-CONTNR-ID                             94030039
924100                   ,:AUCNRL-CONTNR-SEQ-NBR                        94040039
924200                   ,:AUCNRL-PO-NBR                                94050039
924300                   ,:AUCNRL-DCONSLR-RLSE-CDE                      94060039
924400                   ,:AUCNRL-DCONSLR-REQR-DTE                      94070039
924500                   ,:AUCNRL-DCONSLR-ACTL-DTE                      94080039
924600                   ,:AUCNRL-DCONSLR-ACTL-TM                       94090039
924700                   ,:AUCNRL-CRE-TMST                              94100039
924800                   ,:AUCNRL-CRE-BY-UID                            94110039
924900                   ,:PC-U                                         94120039
925000                   , CURRENT_TIMESTAMP                            94130039
925100                   ,:AUCNRL-LAST-UPD-TMST                         94140039
925200                   ,:AUCNRL-LAST-UPD-BY-UID                       94150039
925300                   ,:AUCNRL-DCONSLR-ENT-ID)                       94160039
925400         END-EXEC                                                 94170039
925500                                                                  94180039
925600     EVALUATE TRUE                                                94190039
925700         WHEN SQLCODE = ZERO                                      94200039
925800             CONTINUE                                             94210039
925900                                                                  94220039
926000         WHEN SQLWARN0 NOT EQUAL SPACE                            94230039
926100         WHEN SQLCODE NOT EQUAL ZERO                              94240039
926200             DISPLAY '** ABEND **'                                94250039
926300             DISPLAY '** PROGRAM = POKCS061 **'                   94260039
926400         DISPLAY '** PARAGRAPH = 7088-CREATE-IMCNRL-AUDIT-TRAIL**'94270039
926500             DISPLAY '** CONTNR_ID      = ' AUCNRL-CONTNR-ID      94280039
926600             DISPLAY '** CONTNR_SEQ_NBR = ' AUCNRL-CONTNR-SEQ-NBR 94290039
926700             DISPLAY '** PO_NBR         = ' AUCNRL-PO-NBR         94300039
926800             MOVE '7088-CREATE-IMCNRL-AUDIT-TRAIL'                94310039
926900                           TO DP013-PARAGRAPH                     94320039
927000             MOVE '              '                                94330039
927100                           TO DP013-MESSAGE-TEXT (1)              94340039
927200             MOVE SQLCA    TO DP013-SQLCA                         94350039
927300             MOVE 'TAUCNRL '                                      94360039
927400                           TO DP013-DB2-TABLE-NAME (1)            94370039
927500             SET DP013-DB2-ABEND                                  94380039
927600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               94390039
927700             PERFORM DP013-0000-PROCESS-ABEND                     94400039
927800     END-EVALUATE.                                                94410039
927900*-                                                              -*94420039
928000*----------------------------------------------------------------*94430039
928100 7094-GET-EDI-IND.                                                94440039
928200*----------------------------------------------------------------*94450039
928300     PERFORM                                                      94460039
928400         WITH TEST AFTER                                          94470039
928500         VARYING PV-RETRY-COUNTER                                 94480039
928600         FROM 1 BY 1                                              94490039
928700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               94500039
928800                   OR (SQLCODE = ZERO)                            94510039
928900                   OR (SQLCODE = 100))                            94520039
929000                                                                  94530039
929100         EXEC SQL                                                 94540039
929200              SELECT EDI_IND                                      94550039
929300              INTO :PURCHS-EDI-IND                                94560039
929400              FROM TPURCHS                                        94570039
929500               WHERE PO_NBR         = :DK-PO-NUMBER               94580039
929600                 AND VER_STATUS_CDE = :PC-A                       94590039
929700         END-EXEC                                                 94600039
929800                                                                  94610039
929900         EVALUATE TRUE                                            94620039
930000                 WHEN SQLCODE = +0                                94630039
930100                 WHEN SQLCODE = +100                              94640039
930200                 WHEN SQLCODE = -904                              94650039
930300                 WHEN SQLCODE = -913                              94660039
930400                     CONTINUE                                     94670039
930500                 WHEN SQLWARN0 NOT = SPACES                       94680039
930600                 WHEN SQLCODE < ZERO                              94690039
930700                 WHEN SQLCODE > ZERO                              94700039
930800                     MOVE '7094-GET-EDI-IND'                      94710039
930900                                   TO DP013-PARAGRAPH             94720039
931000                     MOVE '              '                        94730039
931100                                   TO DP013-MESSAGE-TEXT (1)      94740039
931200                     MOVE SQLCA    TO DP013-SQLCA                 94750039
931300                        MOVE 'TPURCHS '                           94760039
931400                                   TO DP013-DB2-TABLE-NAME (1)    94770039
931500                     SET DP013-DB2-ABEND                          94780039
931600                         DP013-XCTL-DISPLAY-RESTART TO TRUE       94790039
931700                     PERFORM DP013-0000-PROCESS-ABEND             94800039
931800             END-EVALUATE                                         94810039
931900     END-PERFORM.                                                 94820039
932000*                                                                 94830039
932100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        94840039
932200         MOVE '7094-GET-EDI-IND' TO DP013-PARAGRAPH               94850039
932300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     94860039
932400                                   TO DP013-MESSAGE-TEXT (1)      94870039
932500         MOVE SQLCA                TO DP013-SQLCA                 94880039
932600         MOVE 'TPURCHS '           TO DP013-DB2-TABLE-NAME (1)    94890039
932700         SET DP013-DB2-ABEND                                      94900039
932800             DP013-XCTL-DISPLAY-RESTART                           94910039
932900                                   TO TRUE                        94920039
933000         PERFORM DP013-0000-PROCESS-ABEND                         94930039
933100     END-IF.                                                      94940039
933200                                                                  94950039
933300 EJECT                                                            94960039
933400*----------------------------------------------------------------*94970039
933500 7095-UPDATE-TPURCHS-EDI.                                         94980039
933600*----------------------------------------------------------------*94990039
933700     PERFORM                                                      95000039
933800         WITH TEST AFTER                                          95010039
933900         VARYING PV-RETRY-COUNTER                                 95020039
934000         FROM 1 BY 1                                              95030039
934100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               95040039
934200                   OR (SQLCODE = ZERO)                            95050039
934300                   OR (SQLCODE = 100))                            95060039
934400                                                                  95070039
934500         EXEC SQL                                                 95080039
934600              UPDATE TPURCHS                                      95090039
934700                 SET EDI_REXMIT_IND  = :PURCHS-EDI-REXMIT-IND     95100039
934800                  ,  EDI_REXMIT_TMST = CURRENT_TIMESTAMP          95110039
934900                  ,  RLSE_IND        = :PURCHS-RLSE-IND           95120039
935000                  ,  RLSE_DTE        = CURRENT DATE               95130039
935100               WHERE PO_NBR         = :DK-PO-NUMBER               95140039
935200                 AND EDI_IND        = 'Y'                         95150039
935300                 AND VER_STATUS_CDE = :PC-A                       95160039
935400                 AND PO_CATEG_CDE   = 'MR'                        95170039
935500         END-EXEC                                                 95180039
935600                                                                  95190039
935700         EVALUATE TRUE                                            95200039
935800                 WHEN SQLCODE = +0                                95210039
935900                 WHEN SQLCODE = +100                              95220039
936000                 WHEN SQLCODE = -904                              95230039
936100                 WHEN SQLCODE = -913                              95240039
936200                     CONTINUE                                     95250039
936300                 WHEN SQLWARN0 NOT = SPACES                       95260039
936400                 WHEN SQLCODE < ZERO                              95270039
936500                 WHEN SQLCODE > ZERO                              95280039
936600                     MOVE '7095-UPDATE-TPURCHS-EDI'               95290039
936700                                   TO DP013-PARAGRAPH             95300039
936800                     MOVE '              '                        95310039
936900                                   TO DP013-MESSAGE-TEXT (1)      95320039
937000                     MOVE SQLCA    TO DP013-SQLCA                 95330039
937100                        MOVE 'TPURCHS '                           95340039
937200                                   TO DP013-DB2-TABLE-NAME (1)    95350039
937300                     SET DP013-DB2-ABEND                          95360039
937400                         DP013-XCTL-DISPLAY-RESTART TO TRUE       95370039
937500                     PERFORM DP013-0000-PROCESS-ABEND             95380039
937600             END-EVALUATE                                         95390039
937700     END-PERFORM.                                                 95400039
937800*                                                                 95410039
937900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        95420039
938000         MOVE '7095-UPDATE-TPURCHS-EDI' TO DP013-PARAGRAPH        95430039
938100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     95440039
938200                                   TO DP013-MESSAGE-TEXT (1)      95450039
938300         MOVE SQLCA                TO DP013-SQLCA                 95460039
938400         MOVE 'TPURCHS '           TO DP013-DB2-TABLE-NAME (1)    95470039
938500         SET DP013-DB2-ABEND                                      95480039
938600             DP013-XCTL-DISPLAY-RESTART                           95490039
938700                                   TO TRUE                        95500039
938800         PERFORM DP013-0000-PROCESS-ABEND                         95510039
938900     END-IF.                                                      95520039
939000                                                                  95530039
939100 EJECT                                                            95540039
939200*----------------------------------------------------------------*95550039
939300 7096-UPDATE-TPURCHS-NOEDI.                                       95560039
939400*----------------------------------------------------------------*95570039
939500     PERFORM                                                      95580039
939600         WITH TEST AFTER                                          95590039
939700         VARYING PV-RETRY-COUNTER                                 95600039
939800         FROM 1 BY 1                                              95610039
939900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               95620039
940000                   OR (SQLCODE = ZERO)                            95630039
940100                   OR (SQLCODE = 100))                            95640039
940200                                                                  95650039
940300         EXEC SQL                                                 95660039
940400              UPDATE TPURCHS                                      95670039
940500                 SET RLSE_IND        = :PURCHS-RLSE-IND           95680039
940600                  ,  RLSE_DTE        = CURRENT DATE               95690039
940700               WHERE PO_NBR         = :DK-PO-NUMBER               95700039
940800                 AND VER_STATUS_CDE = :PC-A                       95710039
940900                 AND PO_CATEG_CDE   = 'MR'                        95720039
941000         END-EXEC                                                 95730039
941100                                                                  95740039
941200         EVALUATE TRUE                                            95750039
941300                 WHEN SQLCODE = +0                                95760039
941400                 WHEN SQLCODE = +100                              95770039
941500                 WHEN SQLCODE = -904                              95780039
941600                 WHEN SQLCODE = -913                              95790039
941700                     CONTINUE                                     95800039
941800                 WHEN SQLWARN0 NOT = SPACES                       95810039
941900                 WHEN SQLCODE < ZERO                              95820039
942000                 WHEN SQLCODE > ZERO                              95830039
942100                     MOVE '7096-UPDATE-TPURCHS-NOEDI'             95840039
942200                                   TO DP013-PARAGRAPH             95850039
942300                     MOVE '              '                        95860039
942400                                   TO DP013-MESSAGE-TEXT (1)      95870039
942500                     MOVE SQLCA    TO DP013-SQLCA                 95880039
942600                        MOVE 'TPURCHS '                           95890039
942700                                   TO DP013-DB2-TABLE-NAME (1)    95900039
942800                     SET DP013-DB2-ABEND                          95910039
942900                         DP013-XCTL-DISPLAY-RESTART TO TRUE       95920039
943000                     PERFORM DP013-0000-PROCESS-ABEND             95930039
943100             END-EVALUATE                                         95940039
943200     END-PERFORM.                                                 95950039
943300*                                                                 95960039
943400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        95970039
943500         MOVE '7096-UPDATE-TPURCHS-NOEDI' TO DP013-PARAGRAPH      95980039
943600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     95990039
943700                                   TO DP013-MESSAGE-TEXT (1)      96000039
943800         MOVE SQLCA                TO DP013-SQLCA                 96010039
943900         MOVE 'TPURCHS '           TO DP013-DB2-TABLE-NAME (1)    96020039
944000         SET DP013-DB2-ABEND                                      96030039
944100             DP013-XCTL-DISPLAY-RESTART                           96040039
944200                                   TO TRUE                        96050039
944300         PERFORM DP013-0000-PROCESS-ABEND                         96060039
944400     END-IF.                                                      96070039
944500                                                                  96080039
944600 EJECT                                                            96090039
944700*----------------------------------------------------------------*96100039
944800* RETRIEVE BUYER INFORMATION TO DISPLAY ON BANNER PAGE           *96110039
944900*----------------------------------------------------------------*96120039
945000                                                                  96130039
945100 7100-BUYER-INFORMATION.                                          96140039
945200                                                                  96150039
945300     MOVE LQW-DPT (LQW-IDX) TO PV-DEPT-NBR.                       96160039
945400     PERFORM 7200-GET-BUYER-NUMBER.                               96170039
945500     PERFORM 7300-GET-BUYER-NAME.                                 96180039
945600     MOVE PV-BUYER-NAME TO PV-BYR-NAME                            96190039
945700                           PV-PROD-BYR-NAME.                      96200039
945800     MOVE PV-BUYER-NUMBER TO PV-BYR-NBR.                          96210039
945900     MOVE PV-BUYER TO PV-PROD-BYR-NAME-NO.                        96220039
946000                                                                  96230039
946100*----------------------------------------------------------------*96240039
946200* GET BUYER NUMBER FROM TMDSEAR                                  *96250039
946300*----------------------------------------------------------------*96260039
946400                                                                  96270039
946500 7200-GET-BUYER-NUMBER.                                           96280039
946600                                                                  96290039
946700     EXEC SQL                                                     96300039
946800         SELECT BYR_NBR,                                          96310039
946900                MDSEAR_DKEY                                       96320039
947000           INTO :MDSEAR-BYR-NBR,                                  96330039
947100                :MDSEAR-DKEY                                      96340039
947200           FROM TMDSEAR                                           96350039
947300          WHERE OPERCO_NBR = '03'                                 96360039
947400            AND MDSELV_CDE = 'DPT'                                96370039
947500            AND CURRENT DATE BETWEEN STRT_DTE AND END_DTE         96380039
947600            AND DEPT_NBR = :PV-DEPT-NBR                           96390039
947700     END-EXEC.                                                    96400039
947800                                                                  96410039
947900     EVALUATE TRUE                                                96420039
948000         WHEN SQLCODE = ZERO                                      96430039
948100             MOVE MDSEAR-BYR-NBR  TO PV-BUYER-NUMBER              96440039
948200         WHEN SQLCODE = +100                                      96450039
948300             MOVE SPACES          TO PV-BUYER-NUMBER              96460039
948400             MOVE ZEROES          TO MDSEAR-DKEY                  96470039
948500         WHEN SQLCODE = -904                                      96480039
948600         WHEN SQLCODE = -911                                      96490039
948700         WHEN SQLCODE = -913                                      96500039
948800              MOVE PC-TSYMSG-00984      TO DP020-MSG-NUMBER       96510039
948900              SET PS-ERROR                                        96520039
949000                  DP020-NEXT-ACT-APPL-ERROR                       96530039
949100                  DP020-MSG-FATAL                                 96540039
949200                      TO TRUE                                     96550039
949300              MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1) 96560039
949400              PERFORM 0001-CALL-CICS-ARCH-API                     96570039
949500         WHEN SQLWARN0 NOT = SPACES                               96580039
949600         WHEN SQLCODE  NOT = ZERO                                 96590039
949700              MOVE '7200-GET-BUYER-NUMBER' TO DP013-PARAGRAPH     96600039
949800              MOVE 'UNSUCCESSFUL SELECT BUYER NUMBER' TO          96610039
949900                                            DP013-MESSAGE-TEXT (1)96620039
950000              MOVE SQLCA TO DP013-SQLCA                           96630039
950100              MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (1)         96640039
950200              SET DP013-DB2-ABEND                                 96650039
950300                  DP013-XCTL-DISPLAY-RESTART TO TRUE              96660039
950400                                                                  96670039
950500              PERFORM DP013-0000-PROCESS-ABEND                    96680039
950600     END-EVALUATE.                                                96690039
950700                                                                  96700039
950800*----------------------------------------------------------------*96710039
950900* GET BUYER NAME FROM TRSPBAR                                    *96720039
951000*----------------------------------------------------------------*96730039
951100                                                                  96740039
951200 7300-GET-BUYER-NAME.                                             96750039
951300                                                                  96760039
951400     MOVE SPACES         TO PV-BUYER-NAME.                        96770039
951500                                                                  96780039
951600     EXEC SQL                                                     96790039
951700          SELECT DISTINCT(WORKER_LAST_NAME), WORKER_FIR_NAME      96800039
951800            INTO :RSPBAR-WORKER-LAST-NAME,                        96810039
951900                 :RSPBAR-WORKER-FIR-NAME                          96820039
952000          FROM TRSPBAR                                            96830039
952100          WHERE MDSEAR_DKEY = :MDSEAR-DKEY                        96840039
952200            AND RSPLVL_CDE  = 'BYR'                               96850039
952300            AND CURRENT DATE BETWEEN WORKER_STRT_DTE AND          96860039
952400                                     WORKER_END_DTE               96870039
952500     END-EXEC.                                                    96880039
952600                                                                  96890039
952700     EVALUATE TRUE                                                96900039
952800       WHEN SQLCODE = ZEROS                                       96910039
085400         INSPECT RSPBAR-WORKER-FIR-NAME  REPLACING ALL            96920054
085400                 '''' BY '_'                                      96930054
085400         INSPECT RSPBAR-WORKER-LAST-NAME REPLACING ALL            96940054
085400                 '''' BY '_'                                      96950054
952900         STRING RSPBAR-WORKER-FIR-NAME  DELIMITED BY ' '          96960039
953000                ' '                     DELIMITED BY SIZE         96970039
953100                RSPBAR-WORKER-LAST-NAME DELIMITED BY SIZE         96980039
953200                                     INTO PV-BUYER-NAME           96990039
953300       WHEN SQLCODE = +100                                        97000039
953400           MOVE SPACES TO PV-BUYER-NAME                           97010039
953500       WHEN SQLCODE = -904                                        97020039
953600       WHEN SQLCODE = -911                                        97030039
953700       WHEN SQLCODE = -913                                        97040039
953800            MOVE PC-TSYMSG-00984      TO DP020-MSG-NUMBER         97050039
953900            SET PS-ERROR                                          97060039
954000                DP020-NEXT-ACT-APPL-ERROR                         97070039
954100                DP020-MSG-FATAL                                   97080039
954200                    TO TRUE                                       97090039
954300            MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1)   97100039
954400            PERFORM 0001-CALL-CICS-ARCH-API                       97110039
954500       WHEN OTHER                                                 97120039
954600            MOVE '7300-GET-BUYER-NAME  ' TO DP013-PARAGRAPH       97130039
954700            MOVE 'UNSUCCESSFUL SELECT BUYER NAME' TO              97140039
954800                                            DP013-MESSAGE-TEXT (1)97150039
954900            MOVE SQLCA TO DP013-SQLCA                             97160039
955000            MOVE 'TRSPBAR ' TO DP013-DB2-TABLE-NAME (1)           97170039
955100            SET DP013-DB2-ABEND                                   97180039
955200                DP013-XCTL-DISPLAY-RESTART TO TRUE                97190039
955300                                                                  97200039
955400            PERFORM DP013-0000-PROCESS-ABEND                      97210039
955500     END-EVALUATE.                                                97220039
955600*----------------------------------------------------------------*97230039
955700*    ABEND PROCESSOR MODULE                                      *97240039
955800*----------------------------------------------------------------*97250039
955900                                                                  97260039
956000     COPY DPPD013.                                                97270039
