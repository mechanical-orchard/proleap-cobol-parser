000100 IDENTIFICATION DIVISION.                                         00010002
000200 PROGRAM-ID.   VNKUP029.                                          00020006
000300 AUTHOR.       NEHA BAGRODIA                                      00030006
000400 INSTALLATION. KOHLS DEPARTMENT STORES.                           00040004
000500 DATE-WRITTEN. FEBRUARY 2016.                                     00050006
000600 DATE-COMPILED.                                                   00060002
000700                                                                  00070002
000800******************************************************************00080002
000900*    COBOL 2  WITH DB2 SQL                                       *00090002
000910*                                                                *00091002
000920*    LOAD VNT_VND_EXC_RPT TABLE.                                  00092020
000930*                                                                *00093002
000940******************************************************************00094002
000950*                                                                *00095002
000960*    THIS PROGRAM WILL READ A VENDOR EXTRACT FILE AND LOAD       *00096006
000970*    VNT_VND_EXC_RPT TABLE.                                      *00097006
000990*                                                                *00099002
001000******************************************************************00100002
001100*                                                                *00110002
001200*  DB2:                                                          *00120002
001300*  1. VNT_VND_EXC_RPT VENDOR EXTRACT REP TBL DCLGEN(VNT00009) *   00130008
001320*                                                                *00132002
001330*  INPUT:                                                        *00133002
001340*  1. VENDOR EXTRACT FILE                COPYBOOK VNRD006        *00134006
001350*                                                                *00135002
001360******************************************************************00136002
001370* CHANGE LOG:                                                    *00137002
001380*                                                                *00138002
001390* DATE  02/16/2016                                               *00139006
001400*     CHANGE MADE: INITIAL IMPLEMENTATION                        *00140002
001500*     MADE BY: NEHA BAGRODIA           WR/IR #: XXXXXXXX          00150006
001600******************************************************************00160002
001700                                                                  00170002
001800 ENVIRONMENT DIVISION.                                            00180002
001900                                                                  00190002
002000 INPUT-OUTPUT SECTION.                                            00200002
002100 FILE-CONTROL.                                                    00210002
002200                                                                  00220002
002300     SELECT VENDOR-EXTRACT-FILE                                   00230006
002400         ASSIGN TO INP01.                                         00240002
002500                                                                  00250002
002600 DATA DIVISION.                                                   00260002
002700 FILE SECTION.                                                    00270002
002800                                                                  00280002
002900 FD  VENDOR-EXTRACT-FILE                                          00290006
003000     RECORDING MODE IS F                                          00300002
003100     LABEL RECORDS ARE STANDARD                                   00310002
003200     BLOCK CONTAINS 0 RECORDS                                     00320002
003300     RECORD CONTAINS 382 CHARACTERS                               00330006
003400     DATA RECORD IS VENDOR-EXTRACT-RECORD.                        00340006
003500                                                                  00350002
003600 01  VENDOR-EXTRACT-RECORD            PIC X(382).                 00360006
003700                                                                  00370002
003800/                                                                 00380002
003900 WORKING-STORAGE SECTION.                                         00390002
004000                                                                  00400002
004100 01  PV-PROGRAM-VARIABLES.                                        00410002
004110     05  PV-CURRENT-PARAGRAPH        PIC X(30) VALUE SPACES.      00411007
004200     05  PV-COUNT-INPUT-ROWS         PIC 9(07) VALUE ZEROS.       00420002
004400     05  PV-COUNT-INSERTED-ROWS      PIC 9(07) VALUE ZEROS.       00440006
004500     05  PV-COUNT-DELETED-ROWS      PIC 9(07) VALUE ZEROS.        00450014
004510     05  PV-COUNT-COMMITS            PIC 9(07) VALUE ZEROS.       00451005
004610     05  PV-MAX-RETRIES              PIC S9(04) VALUE +3 COMP.    00461007
004620     05  PV-RETRY-COUNT              PIC S9(04) VALUE +0 COMP.    00462014
004700                                                                  00470002
004800 01  PC-PROGRAM-CONSTANTS.                                        00480002
004900     05  PC-PROGRAM-NAME             PIC X(08)  VALUE 'VNKUP029'. 00490006
005000                                                                  00500002
005100 01  PS-PROGRAM-SWITCHES.                                         00510002
005200     05  PS-END-OF-INPUT-IND         PIC X(01)  VALUE 'N'.        00520002
005300         88  END-OF-INPUT                       VALUE 'Y'.        00530002
005400                                                                  00540002
005500                                                                  00550002
005600                                                                  00560002
005601     COPY DPWS004.                                                00560102
005602                                                                  00560202
005603******************************************************************00560302
005604*  INPUT FILE RECORD LAYOUT                                      *00560402
005605******************************************************************00560502
005606     COPY VNRD006.                                                00560606
005607                                                                  00560702
005608******************************************************************00560802
005609*  COMMUNICATIONS AREA2 FOR DB2                                  *00560902
005610******************************************************************00561002
005620     COPY SQLCA2.                                                 00562002
005630                                                                  00563002
005640     EXEC SQL                                                     00564002
005650          INCLUDE SQLCA                                           00565002
005660     END-EXEC.                                                    00566002
005670                                                                  00567002
005680******************************************************************00568002
005690*  VNT_VND_EXC_RPT TABLE                                         *00569008
005700******************************************************************00570002
005800     EXEC SQL                                                     00580002
005900          INCLUDE VNT00009                                        00590008
006000     END-EXEC.                                                    00600002
006100                                                                  00610002
006360******************************************************************00636002
006370*  ABEND DATA AREAS                                              *00637002
006380******************************************************************00638002
006390 01  ABEND-CODE                      PIC S9(4)  VALUE ZEROS       00639002
006400                                                COMP SYNC.        00640002
006500     88  AC-BAD-DATA                            VALUE +4003.      00650002
006600     88  AC-DB2-ERROR                           VALUE +4013.      00660002
006700     88  AC-DATE-ERROR                          VALUE +4019.      00670002
006800                                                                  00680002
006900 01  ABEND-AREAS.                                                 00690002
007000     05  AA-ABEND-LIT                PIC X(40)  VALUE             00700002
007100             '*****       ABEND'.                                 00710002
007200     05  AA-PROGRAM-LIT              PIC X(40)  VALUE             00720002
007300             '*****   PROGRAM: VNKUP029'.                         00730006
007400     05  AA-PARAGRAPH-LIT.                                        00740002
007500         10  FILLER                  PIC X(17)  VALUE             00750002
007600             '***** PARAGRAPH: '.                                 00760002
007700         10  AA-PARAGRAPH-NAME       PIC X(35)  VALUE SPACES.     00770002
007800     05  AA-MESSAGE-LINE-1.                                       00780002
007900         10  FILLER                  PIC X(06)  VALUE '*****'.    00790002
008000         10  AA-MESSAGE-1            PIC X(127) VALUE SPACES.     00800002
008100     05  AA-MESSAGE-LINE-2.                                       00810002
008200         10  FILLER                  PIC X(06)  VALUE '*****'.    00820002
008300         10  AA-MESSAGE-2            PIC X(127) VALUE SPACES.     00830002
008400     05  AA-DB2-ERROR-LIT            PIC X(40)  VALUE             00840002
008500             '*****    DB2 ERROR'.                                00850002
008600     05  AA-DB2-OPERATION-LIT.                                    00860002
008700         10  FILLER                  PIC X(17)  VALUE             00870002
008800             '***** OPERATION: '.                                 00880002
008900         10  AA-DB2-OPERATION.                                    00890002
009000             15  AA-DB2-OP-1         PIC X(25)  VALUE SPACES.     00900002
009100             15  AA-DB2-OP-2         PIC X(25)  VALUE SPACES.     00910002
009200     05  AA-DB2-TABLE-1              PIC X(18)  VALUE SPACES.     00920002
009300     05  AA-DB2-TABLE-2              PIC X(18)  VALUE SPACES.     00930002
009400     05  AA-DB2-TABLE-3              PIC X(18)  VALUE SPACES.     00940002
009500     05  AA-DB2-TABLE-4              PIC X(18)  VALUE SPACES.     00950002
009600                                                                  00960002
009700 PROCEDURE DIVISION.                                              00970002
009800                                                                  00980002
009900 A100-MAINLINE.                                                   00990002
010000                                                                  01000002
010100     PERFORM B100-INITIALIZATION.                                 01010002
010200                                                                  01020002
010300     PERFORM B200-INSERT-VENDOR                                   01030006
010400         UNTIL END-OF-INPUT.                                      01040002
010500                                                                  01050002
010600     PERFORM B300-END-OF-JOB.                                     01060002
010700                                                                  01070002
010800     GOBACK.                                                      01080002
010900        EJECT                                                     01090002
011000                                                                  01100002
011100******************************************************************01110002
011200*    OPEN INPUT FILE, INITIALIZE DCLGEN                           01120006
011500******************************************************************01150002
011600 B100-INITIALIZATION.                                             01160002
011700                                                                  01170002
011800     DISPLAY '* PROGRAM VNKUP029 STARTING *'.                     01180006
011900                                                                  01190002
012000     OPEN INPUT VENDOR-EXTRACT-FILE.                              01200006
012300                                                                  01230002
012310     INITIALIZE PV-PROGRAM-VARIABLES.                             01231014
012400     PERFORM R100-DELT-EXTRACT-FILE.                              01240012
012401     PERFORM U300-COMMIT.                                         01240113
012402                                                                  01240213
012410     PERFORM R100-READ-EXTRACT-FILE.                              01241012
012500                                                                  01250002
012600     IF  END-OF-INPUT                                             01260002
012700         DISPLAY '*******************************'                01270002
012800         DISPLAY '* NO INPUT RECORDS TO PROCESS *'                01280002
012900         DISPLAY '*******************************'                01290002
013000     END-IF.                                                      01300002
013100                                                                  01310002
014344******************************************************************01434402
014345*     END JOB                                                    *01434502
014346******************************************************************01434602
014350 B300-END-OF-JOB.                                                 01435002
014360                                                                  01436002
014370     CLOSE VENDOR-EXTRACT-FILE.                                   01437006
014380                                                                  01438002
014390     DISPLAY 'DELETE COUNT =     ' PV-COUNT-DELETED-ROWS.         01439017
014400     DISPLAY 'INPUT COUNT =     ' PV-COUNT-INPUT-ROWS.            01440017
014600     DISPLAY 'INSERT COUNT =    ' PV-COUNT-INSERTED-ROWS.         01460006
014610     DISPLAY 'COMMIT COUNT =    ' PV-COUNT-COMMITS.               01461005
014700                                                                  01470002
014701******************************************************************01470112
014702*  R100-DELT-EXTRACT-FILE                                         01470212
014703******************************************************************01470312
014704 R100-DELT-EXTRACT-FILE.                                          01470412
014705                                                                  01470512
014706     PERFORM                                                      01470612
014707         WITH TEST AFTER                                          01470712
014708         VARYING PV-RETRY-COUNT FROM 1 BY 1                       01470812
014709           UNTIL (PV-RETRY-COUNT > PV-MAX-RETRIES)                01470914
014710              OR (SQLCODE         = +000)                         01471012
014711              OR (SQLCODE         = +100)                         01471112
014712                                                                  01471212
014713           EXEC SQL                                               01471312
014714             DELETE FROM VNT_VND_EXC_RPT                          01471412
014715           END-EXEC                                               01471512
014716                                                                  01471612
014717     EVALUATE TRUE                                                01471712
014718         WHEN SQLCODE = ZERO                                      01471812
014719              ADD SQLERRD(3)         TO PV-COUNT-DELETED-ROWS     01471912
014721         WHEN SQLCODE = +1403                                     01472118
014722         WHEN SQLCODE = +100                                      01472218
014723         WHEN SQLCODE = -911                                      01472318
014724         WHEN SQLCODE = -913                                      01472418
014725              CONTINUE                                            01472518
014726         WHEN OTHER                                               01472618
014727              MOVE PV-CURRENT-PARAGRAPH TO AA-PARAGRAPH-NAME      01472718
014728              MOVE 'ERROR DELETING RECORD'                        01472818
014729                                        TO AA-DB2-OPERATION       01472918
014730              MOVE 'VNT_VND_EXC_RPT'    TO AA-DB2-TABLE-1         01473018
014731              MOVE SPACES               TO AA-DB2-TABLE-2         01473118
014732                                           AA-DB2-TABLE-3         01473218
014733              PERFORM Z998-DB2-ABEND                              01473318
014734     END-EVALUATE                                                 01473418
014735     END-PERFORM.                                                 01473518
014736                                                                  01473618
014747******************************************************************01474712
014748*  B200-INSERT-VENDOR                                            *01474812
014749******************************************************************01474907
014750 B200-INSERT-VENDOR.                                              01475007
014751                                                                  01475107
014752        IF PV-COUNT-INPUT-ROWS > 1                                01475215
014760           PERFORM U100-INSERT-VENDOR-EXTRACT-TBL                 01476015
014770           PERFORM U300-COMMIT                                    01477015
014780           PERFORM R100-READ-EXTRACT-FILE                         01478015
014781        ELSE                                                      01478115
014782           PERFORM R100-READ-EXTRACT-FILE                         01478215
014783        END-IF.                                                   01478315
014784                                                                  01478413
014790 EJECT.                                                           01479007
014800******************************************************************01480002
014900*    READ INPUT FILE                                             *01490002
015000******************************************************************01500002
015100 R100-READ-EXTRACT-FILE.                                          01510006
015200                                                                  01520002
015300     READ VENDOR-EXTRACT-FILE INTO VN006-REPT-AREA                01530006
015400         AT END SET END-OF-INPUT TO TRUE.                         01540002
015500                                                                  01550002
015600     IF  END-OF-INPUT                                             01560002
015700         CONTINUE                                                 01570002
015800     ELSE                                                         01580002
015900         ADD +1 TO PV-COUNT-INPUT-ROWS                            01590002
016000     END-IF.                                                      01600002
016100                                                                  01610002
019100******************************************************************01910002
019200*     INSERT A ROW INTO VNT_VND_EXC_RPT TABLE                    *01920006
019201******************************************************************01920102
019202 U100-INSERT-VENDOR-EXTRACT-TBL.                                  01920206
019203                                                                  01920302
019204     MOVE 'U100-INSERT-VENDOR-EXTRACT-TBL' TO                     01920407
019205                                      PV-CURRENT-PARAGRAPH.       01920507
019206     INITIALIZE DCLVNT00009.                                      01920609
019207                                                                  01920709
019208     SET VN006-INDX TO 1.                                         01920811
019209                                                                  01920911
019210     MOVE VN006-GMA-NBR             TO VNT00009-GMA-NBR.          01921009
019211     MOVE VN006-DMA-NBR             TO VNT00009-DMA-NBR.          01921109
019212     MOVE VN006-ENT-NAME-DESC       TO VNT00009-ENT-NM-DESC.      01921209
019213     MOVE VN006-ENT-ID              TO VNT00009-ENT-ID.           01921309
019214     MOVE VN006-DUN-NBR             TO VNT00009-VND-NBR.          01921409
019215     MOVE VN006-DEPT-NBR            TO VNT00009-DEPT-NBR.         01921509
019216     MOVE VN006-DESC                TO VNT00009-DEPT-DESC.        01921609
019217     MOVE VN006-NEW-DEPT-ADD-SW     TO VNT00009-NW-DEPT-CDE.      01921709
019218     MOVE VN006-NEW-VNDR-ADD-SW     TO VNT00009-NW-VND-CDE.       01921809
019219     MOVE VN006-VND-DEPT-STAT-CD    TO VNT00009-VND-DEPT-STAT-CDE.01921909
019220     MOVE VN006-STATUS-CDE          TO VNT00009-VND-STAT-CDE.     01922009
019221     MOVE VN006-GMM-WORKER-FIR-NAME TO VNT00009-GMM-FRST-NM.      01922109
019222     MOVE VN006-GMM-WORKER-LAST-NAME TO VNT00009-GMM-LAST-NM.     01922209
019223     MOVE VN006-DMM-WORKER-FIR-NAME  TO VNT00009-DMM-FRST-NM.     01922309
019224     MOVE VN006-DMM-WORKER-LAST-NAME TO VNT00009-DMM-LAST-NM.     01922409
019225     MOVE VN006-RCPT-GRO-COST-AMT   TO VNT00009-RCPT-GRO-COST-AMT.01922509
019226     MOVE VN006-PYMNT-TERMS-DESC    TO VNT00009-PAYT-TRMS-DESC.   01922609
019227     MOVE VN006-NEW-STR-DAYS-QTY    TO VNT00009-NW-STR-DAYS-QTY.  01922709
019228     MOVE VN006-NEW-DISCOUNT-PCT    TO VNT00009-NW-DISC-PCT.      01922809
019229     MOVE VN006-MOS-DISCOUNT-PCT    TO VNT00009-MOS-DISC-PCT.     01922909
019230     MOVE VN006-TRD-DISCOUNT-PCT    TO VNT00009-TRD-DISC-PCT.     01923009
019231     MOVE VN006-BRD-DISCOUNT-PCT    TO VNT00009-BRDCST-DISC-PCT.  01923109
019232     MOVE VN006-COOP-DISCOUNT-PCT   TO VNT00009-COOP-DISC-PCT.    01923209
019233     MOVE VN006-PRFT-DISCOUNT-PCT   TO VNT00009-PRFT-DISC-PCT.    01923309
019234     MOVE VN006-TBL-TWR-DAYS-QTY    TO VNT00009-TBL-TWR-DAYS-QTY. 01923409
019235     MOVE VN006-BRDL-DISCOUNT-PCT   TO VNT00009-BRDL-DISC-PCT.    01923509
019236     MOVE VN006-LATE-SHIP-CHARGE-PCT TO VNT00009-LTE-SHIP-CHRG-PCT01923609
019237     MOVE VN006-BYR-NBR             TO VNT00009-BYR-NBR.          01923709
019238     MOVE VN006-BYR-WORKER-FIR-NAME TO VNT00009-BYR-FRST-NM.      01923809
019239     MOVE VN006-BYR-WORKER-LAST-NAME TO VNT00009-BYR-LAST-NM.     01923909
019240     MOVE VN006-AP-TRN-CDE(VN006-INDX) TO                         01924010
019241                                  VNT00009-OFF-INVC-1-AP-TRN-CDE. 01924110
019242     MOVE VN006-DISCOUNT-PCT(VN006-INDX) TO                       01924210
019243                                  VNT00009-OFF-INVC-1-DISC-PCT.   01924310
019244     MOVE VN006-PSTG-FRQ-CDE(VN006-INDX) TO                       01924410
019245                                  VNT00009-OFF-INVC-1-FRQ-CDE.    01924510
019246     MOVE VN006-DED-DISC-IND(VN006-INDX) TO                       01924610
019247                                  VNT00009-OFF-INVC-1-DISC-IND.   01924710
019248     MOVE VN006-DED-RTV-IND(VN006-INDX) TO                        01924810
019249                                  VNT00009-OFF-INVC-1-RTV-IND.    01924910
019250     SET VN006-INDX UP BY 1.                                      01925010
019251     MOVE VN006-AP-TRN-CDE(VN006-INDX) TO                         01925110
019252                                  VNT00009-OFF-INVC-2-AP-TRN-CDE. 01925210
019253     MOVE VN006-DISCOUNT-PCT(VN006-INDX) TO                       01925310
019260                                  VNT00009-OFF-INVC-2-DISC-PCT.   01926010
019261     MOVE VN006-PSTG-FRQ-CDE(VN006-INDX) TO                       01926110
019262                                  VNT00009-OFF-INVC-2-FRQ-CDE.    01926210
019263     MOVE VN006-DED-DISC-IND(VN006-INDX) TO                       01926310
019264                                  VNT00009-OFF-INVC-2-DISC-IND.   01926410
019265     MOVE VN006-DED-RTV-IND(VN006-INDX) TO                        01926510
019266                                  VNT00009-OFF-INVC-2-RTV-IND.    01926610
019267     SET VN006-INDX UP BY 1.                                      01926710
019268     MOVE VN006-AP-TRN-CDE(VN006-INDX) TO                         01926810
019269                                  VNT00009-OFF-INVC-3-AP-TRN-CDE. 01926910
019270     MOVE VN006-DISCOUNT-PCT(VN006-INDX) TO                       01927010
019271                                  VNT00009-OFF-INVC-3-DISC-PCT.   01927110
019272     MOVE VN006-PSTG-FRQ-CDE(VN006-INDX) TO                       01927210
019273                                  VNT00009-OFF-INVC-3-FRQ-CDE.    01927310
019274     MOVE VN006-DED-DISC-IND(VN006-INDX) TO                       01927410
019275                                  VNT00009-OFF-INVC-3-DISC-IND.   01927510
019276     MOVE VN006-DED-RTV-IND(VN006-INDX) TO                        01927610
019277                                  VNT00009-OFF-INVC-3-RTV-IND.    01927710
019278     SET VN006-INDX UP BY 1.                                      01927810
019279     MOVE VN006-AP-TRN-CDE(VN006-INDX) TO                         01927910
019280                                  VNT00009-OFF-INVC-4-AP-TRN-CDE. 01928010
019281     MOVE VN006-DISCOUNT-PCT(VN006-INDX) TO                       01928110
019282                                  VNT00009-OFF-INVC-4-DISC-PCT.   01928210
019283     MOVE VN006-PSTG-FRQ-CDE(VN006-INDX) TO                       01928310
019284                                  VNT00009-OFF-INVC-4-FRQ-CDE.    01928410
019285     MOVE VN006-DED-DISC-IND(VN006-INDX) TO                       01928510
019286                                  VNT00009-OFF-INVC-4-DISC-IND.   01928610
019287     MOVE VN006-DED-RTV-IND(VN006-INDX) TO                        01928710
019288                                  VNT00009-OFF-INVC-4-RTV-IND.    01928810
019289                                                                  01928910
019297          EXEC SQL                                                01929710
019298            INSERT INTO VNT_VND_EXC_RPT                           01929810
019299            (GMA_NBR                                              01929910
019300            ,DMA_NBR                                              01930010
019301            ,ENT_NM_DESC                                          01930110
019302            ,ENT_ID                                               01930210
019303            ,VND_NBR                                              01930310
019304            ,DEPT_NBR                                             01930410
019305            ,DEPT_DESC                                            01930510
019306            ,NW_DEPT_CDE                                          01930610
019307            ,NW_VND_CDE                                           01930710
019308            ,VND_DEPT_STAT_CDE                                    01930810
019309            ,VND_STAT_CDE                                         01930910
019310            ,GMM_FRST_NM                                          01931010
019311            ,GMM_LAST_NM                                          01931110
019312            ,DMM_FRST_NM                                          01931210
019313            ,DMM_LAST_NM                                          01931310
019314            ,RCPT_GRO_COST_AMT                                    01931410
019315            ,PAYT_TRMS_DESC                                       01931510
019316            ,NW_STR_DAYS_QTY                                      01931610
019317            ,NW_DISC_PCT                                          01931710
019318            ,MOS_DISC_PCT                                         01931810
019319            ,TRD_DISC_PCT                                         01931910
019320            ,BRDCST_DISC_PCT                                      01932010
019321            ,COOP_DISC_PCT                                        01932110
019322            ,PRFT_DISC_PCT                                        01932210
019323            ,TBL_TWR_DAYS_QTY                                     01932310
019324            ,BRDL_DISC_PCT                                        01932410
019325            ,LTE_SHIP_CHRG_PCT                                    01932510
019326            ,BYR_NBR                                              01932610
019327            ,BYR_FRST_NM                                          01932710
019328            ,BYR_LAST_NM                                          01932810
019329            ,OFF_INVC_1_AP_TRN_CDE                                01932910
019330            ,OFF_INVC_1_DISC_PCT                                  01933010
019331            ,OFF_INVC_1_FRQ_CDE                                   01933110
019332            ,OFF_INVC_1_DISC_IND                                  01933210
019333            ,OFF_INVC_1_RTV_IND                                   01933310
019334            ,OFF_INVC_2_AP_TRN_CDE                                01933410
019335            ,OFF_INVC_2_DISC_PCT                                  01933510
019336            ,OFF_INVC_2_FRQ_CDE                                   01933610
019337            ,OFF_INVC_2_DISC_IND                                  01933710
019338            ,OFF_INVC_2_RTV_IND                                   01933810
019339            ,OFF_INVC_3_AP_TRN_CDE                                01933910
019340            ,OFF_INVC_3_DISC_PCT                                  01934010
019341            ,OFF_INVC_3_FRQ_CDE                                   01934110
019342            ,OFF_INVC_3_DISC_IND                                  01934210
019343            ,OFF_INVC_3_RTV_IND                                   01934310
019344            ,OFF_INVC_4_AP_TRN_CDE                                01934410
019345            ,OFF_INVC_4_DISC_PCT                                  01934510
019346            ,OFF_INVC_4_FRQ_CDE                                   01934610
019347            ,OFF_INVC_4_DISC_IND                                  01934710
019348            ,OFF_INVC_4_RTV_IND)                                  01934810
019349           VALUES                                                 01934910
019350            (:VNT00009-GMA-NBR                                    01935010
019351            ,:VNT00009-DMA-NBR                                    01935110
019352            ,:VNT00009-ENT-NM-DESC                                01935210
019353            ,:VNT00009-ENT-ID                                     01935310
019354            ,:VNT00009-VND-NBR                                    01935410
019355            ,:VNT00009-DEPT-NBR                                   01935510
019356            ,:VNT00009-DEPT-DESC                                  01935610
019357            ,:VNT00009-NW-DEPT-CDE                                01935710
019358            ,:VNT00009-NW-VND-CDE                                 01935810
019359            ,:VNT00009-VND-DEPT-STAT-CDE                          01935910
019360            ,:VNT00009-VND-STAT-CDE                               01936010
019361            ,:VNT00009-GMM-FRST-NM                                01936110
019362            ,:VNT00009-GMM-LAST-NM                                01936210
019363            ,:VNT00009-DMM-FRST-NM                                01936310
019364            ,:VNT00009-DMM-LAST-NM                                01936410
019365            ,:VNT00009-RCPT-GRO-COST-AMT                          01936510
019366            ,:VNT00009-PAYT-TRMS-DESC                             01936610
019367            ,:VNT00009-NW-STR-DAYS-QTY                            01936710
019368            ,:VNT00009-NW-DISC-PCT                                01936810
019369            ,:VNT00009-MOS-DISC-PCT                               01936910
019370            ,:VNT00009-TRD-DISC-PCT                               01937010
019371            ,:VNT00009-BRDCST-DISC-PCT                            01937110
019372            ,:VNT00009-COOP-DISC-PCT                              01937210
019373            ,:VNT00009-PRFT-DISC-PCT                              01937310
019374            ,:VNT00009-TBL-TWR-DAYS-QTY                           01937410
019375            ,:VNT00009-BRDL-DISC-PCT                              01937510
019376            ,:VNT00009-LTE-SHIP-CHRG-PCT                          01937610
019377            ,:VNT00009-BYR-NBR                                    01937710
019378            ,:VNT00009-BYR-FRST-NM                                01937810
019379            ,:VNT00009-BYR-LAST-NM                                01937910
019380            ,:VNT00009-OFF-INVC-1-AP-TRN-CDE                      01938010
019381            ,:VNT00009-OFF-INVC-1-DISC-PCT                        01938110
019382            ,:VNT00009-OFF-INVC-1-FRQ-CDE                         01938210
019383            ,:VNT00009-OFF-INVC-1-DISC-IND                        01938310
019384            ,:VNT00009-OFF-INVC-1-RTV-IND                         01938410
019385            ,:VNT00009-OFF-INVC-2-AP-TRN-CDE                      01938510
019386            ,:VNT00009-OFF-INVC-2-DISC-PCT                        01938610
019387            ,:VNT00009-OFF-INVC-2-FRQ-CDE                         01938710
019388            ,:VNT00009-OFF-INVC-2-DISC-IND                        01938810
019389            ,:VNT00009-OFF-INVC-2-RTV-IND                         01938910
019390            ,:VNT00009-OFF-INVC-3-AP-TRN-CDE                      01939010
019391            ,:VNT00009-OFF-INVC-3-DISC-PCT                        01939110
019392            ,:VNT00009-OFF-INVC-3-FRQ-CDE                         01939210
019393            ,:VNT00009-OFF-INVC-3-DISC-IND                        01939310
019394            ,:VNT00009-OFF-INVC-3-RTV-IND                         01939410
019395            ,:VNT00009-OFF-INVC-4-AP-TRN-CDE                      01939510
019396            ,:VNT00009-OFF-INVC-4-DISC-PCT                        01939610
019397            ,:VNT00009-OFF-INVC-4-FRQ-CDE                         01939710
019398            ,:VNT00009-OFF-INVC-4-DISC-IND                        01939810
019399            ,:VNT00009-OFF-INVC-4-RTV-IND)                        01939910
019400         END-EXEC.                                                01940010
019401                                                                  01940110
019402     EVALUATE TRUE                                                01940210
019403         WHEN SQLCODE = ZERO                                      01940310
019404              ADD 1                  TO PV-COUNT-INSERTED-ROWS    01940410
019405         WHEN SQLWARN0 NOT = SPACES                               01940510
019406         WHEN SQLCODE  NOT = ZERO                                 01940610
019407              MOVE PV-CURRENT-PARAGRAPH TO AA-PARAGRAPH-NAME      01940710
019408              MOVE 'ERROR INSERTING RECORD'                       01940810
019409                                        TO AA-DB2-OPERATION       01940910
019410              MOVE 'VNT_VND_EXC_RPT'    TO AA-DB2-TABLE-1         01941010
019411              MOVE SPACES               TO AA-DB2-TABLE-2         01941110
019412                                           AA-DB2-TABLE-3         01941210
019420              PERFORM Z998-DB2-ABEND                              01942010
019500     END-EVALUATE.                                                01950007
019510*    END-PERFORM.                                                 01951007
021332                                                                  02133202
021333 U300-COMMIT.                                                     02133304
021334     EXEC SQL                                                     02133404
021335         COMMIT                                                   02133504
021336     END-EXEC.                                                    02133604
021337                                                                  02133704
021339     EVALUATE TRUE                                                02133904
021340         WHEN SQLCODE = ZERO                                      02134004
021341              ADD +1 TO PV-COUNT-COMMITS                          02134105
021342         WHEN SQLWARN0 NOT = SPACES                               02134204
021343         WHEN SQLCODE  NOT = ZERO                                 02134304
021344              MOVE 'U300-COMMIT'           TO AA-PARAGRAPH-NAME   02134404
021345              MOVE 'UNSUCCESSFUL COMMIT'   TO AA-DB2-OPERATION    02134504
021346              MOVE 'VNT_VND_EXC_RPT'       TO AA-DB2-TABLE-1      02134607
021347              PERFORM Z998-DB2-ABEND                              02134704
021348     END-EVALUATE.                                                02134804
021359*----------------------------------------------------------------*02135902
021360*    ABEND ROUTINE FOR DB2 ERRORS                                *02136002
021361*----------------------------------------------------------------*02136102
021362 Z998-DB2-ABEND.                                                  02136202
021363                                                                  02136302
021364     DISPLAY '*** DB2 ERROR '.                                    02136407
021366     DISPLAY AA-ABEND-LIT.                                        02136602
021367     DISPLAY AA-DB2-ERROR-LIT.                                    02136702
021368     DISPLAY AA-PROGRAM-LIT.                                      02136802
021370     DISPLAY AA-PARAGRAPH-LIT.                                    02137002
021380     DISPLAY AA-DB2-OPERATION-LIT.                                02138002
021390     DISPLAY AA-DB2-TABLE-1.                                      02139002
021400     DISPLAY AA-DB2-TABLE-2.                                      02140002
021500     DISPLAY AA-DB2-TABLE-3.                                      02150002
021600     DISPLAY AA-DB2-TABLE-4.                                      02160002
021700     SET AC-DB2-ERROR TO TRUE.                                    02170002
021800                                                                  02180002
021900     COPY DPPD004.                                                02190002
022000                                                                  02200002
022100     CALL 'ILBOABN0' USING ABEND-CODE.                            02210002
022200                                                                  02220002
