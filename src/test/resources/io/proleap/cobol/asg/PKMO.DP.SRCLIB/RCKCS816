000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    RCKCS816.                                         00040000
000500 AUTHOR.        DEANNA BRANTNER.                                  00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  SEPTEMBER, 2002                                   00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    E816 - RECEIVER/WORK ORDER UPDATE                          * 00110000
001200*                                                               * 00120000
001300*    THIS PROGRAM IS PART OF THE RECEIVING SIMPLIFICATION       * 00130000
001400*    PROJECT.  IT WILL BE CODED TO TAKE THE ASSOCIATE TO THE    * 00140000
001500*    TROUBLE LIST SCREEN, SPECIAL INSTRUCTION SCREEN, AND THE   * 00150000
001600*    CONFIRM LINE SCREEN.  THIS SCREEN WILL ALSO ALLOW THEM     * 00160000
001700*    TO CONFIRM A RECEIVER, UPDATE A RECEIVER, HOT COMPLETE,    * 00170000
001800*    START, RESTART, ADD, OR UPDATE A WORK ORDER.               * 00180000
001900*                                                               * 00190000
002000*    SEE DOCUMENTATION FOR EXPLANATION OF CURSOR POSITIONING    * 00200000
002100*                                                               * 00210000
002110*---------------------------------------------------------------* 00211000
002120* DATE  06/28/2010                                              * 00212000
002130*  CHANGE MADE: ADDED REPLENISHMENT INDICATOR(WHSE_RPLNT_IND)   * 00213000
002140*  DISPLAY IN SCREEN IF WHSE_RPLNT_IND = Y, ELSE SPACE          * 00214000
002150*  CHANGES ARE TAGGED AS CLT 06/28/2010                         * 00215000
002160*---------------------------------------------------------------* 00216000
002161* MAINTENANCE:                                                  * 00216100
002162*    JACK KRAMER 02/05/2014   CHG0069538                        * 00216201
002163*      MTK PROJECT - PACKAGE CODE CHANGES.                      * 00216301
002164*        CHANGES IN PARAGRAPH:                                  * 00216401
002165*            4300-READ-ITEMS-FROM-DB                            * 00216501
002166*        NEW PARAGRAPHS:                                        * 00216601
002167*            4600-CHECK-TRECITM                                 * 00216701
002168*            4610-CHECK-PTL-PREPK-TRECITM                       * 00216801
002169*            4620-CHECK-PTL-PREPK-TPURITM                       * 00216901
002170*            4630-CHECK-PTL-BULK-TRECITM                        * 00217001
002171*            4640-CHECK-PTL-BULK-TPURITM                        * 00217101
002172*---------------------------------------------------------------* 00217201
002173* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00217311
002174* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00217412
002175* MAKING THE CALL DYNAMIC VS STATIC.                              00217512
002176*---------------------------------------------------------------* 00217612
002178 ENVIRONMENT DIVISION.                                            00217800
002179 DATA DIVISION.                                                   00217900
002180                                                                  00218000
002181 WORKING-STORAGE SECTION.                                         00218100
002182                                                                  00218200
002183 01  DN-DB2-NULL-INDICATORS.                                      00218300
002184     05  DN-TKT-FMT-ID                PIC S9(04)   COMP VALUE +0. 00218400
002185     05  DN-TKT-FMT-ID-MAX            PIC S9(04)   COMP VALUE +0. 00218500
002190     05  DN-TKT-FMT-ID-MIN            PIC S9(04)   COMP VALUE +0. 00219000
002200     05  DN-TKT-DESC                  PIC S9(04)   COMP VALUE +0. 00220000
002300                                                                  00230000
002400 01  WO-DB2-KEYS.                                                 00240000
002500     05  WO-OPER-UNT-ID               PIC S9(04)   COMP VALUE +0. 00250000
002600                                                                  00260000
002700 01  DK-DB2-KEYS.                                                 00270000
002800     05  DK-EXP-CRTN-CNT              PIC S9(09)   COMP VALUE +0. 00280000
002900     05  DK-ACT-CRTN-CNT              PIC S9(09)   COMP VALUE +0. 00290000
003000     05  DK-DMG-CRTN-CNT              PIC S9(09)   COMP VALUE +0. 00300000
003100     05  DK-OPER-SET-ID               PIC S9(04)   COMP VALUE +0. 00310000
003200     05  DK-OPER-SET                  PIC  Z(03).                 00320000
003300     05  DK-TRIP-ID                   PIC S9(09)   COMP VALUE +0. 00330000
003400     05  DK-PO-NBR                    PIC S9(09)   COMP VALUE +0. 00340000
003500     05  DK-RCVR-NBR                  PIC S9(09)   COMP VALUE +0. 00350000
003600     05  DK-ENT-ID                    PIC S9(09)   COMP VALUE +0. 00360000
003700     05  DK-STATUS-CDE                PIC X(02)    VALUE SPACES.  00370000
003800     05  DK-STORE-NMBR                PIC X(03)    VALUE SPACES.  00380000
003900     05  DK-PO-RCVR-NBR.                                          00390000
004000         10  DK-PO                    PIC ZZZZZZZ9 VALUE ZEROES.  00400000
004100         10  FILLER                   PIC X(1)     VALUE '-'.     00410000
004200         10  DK-RCVR                  PIC 9999     VALUE ZEROES.  00420000
004300     05  DK-AGRMT-TYP-ID              PIC X(01)    VALUE SPACES.  00430000
004400     05  DK-TYP-CDE                   PIC S9(04)   VALUE +0  COMP.00440000
004500     05  DK-TKT-FMT-ID                PIC X(06)    VALUE SPACES.  00450000
004600     05  DK-TKT-FMT-ID-MIN            PIC X(06)    VALUE SPACES.  00460000
004700     05  DK-TKT-FMT-ID-MAX            PIC X(06)    VALUE SPACES.  00470000
004800     05  DK-TKT-DESC                  PIC X(20)    VALUE SPACES.  00480000
004900     05  DK-TKT-DESC-MIN              PIC X(20)    VALUE SPACES.  00490000
005000     05  DK-TKT-DESC-MAX              PIC X(20)    VALUE SPACES.  00500000
005100     05  DK-ORD-NBR                   PIC S9(09) COMP VALUE +0.   00510000
005200     05  DK-REC-SEQ-NBR               PIC S9(09)  COMP.           00520000
005300                                                                  00530000
005400 01  PA-PROGRAM-ACCUMULATORS.                                     00540000
005500     05  PA-INVOICED-COUNT            PIC S9(09) VALUE +0         00550000
005600                                                 COMP-3.          00560000
005700     05  PA-AP-VERIFIED-COUNT           PIC S9(09) VALUE +0       00570000
005800                                                   COMP-3.        00580000
005900                                                                  00590000
006000 01  PC-PROGRAM-CONSTANTS.                                        00600000
006100     05  PC-LOCATION-MODULE        PIC  X(08)   VALUE             00610000
006200                                                    'XLKUT071'.   00620000
006300     05  PC-UNTS-WRKD-PGRM-NAME    PIC  X(08) VALUE 'PCKCS756'.   00630000
006400     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'RC816A  '.  00640000
006500     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'RCKM816 '.  00650000
006600     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'RCKCS816'.  00660000
006700     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00670000
006800     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00680000
006900     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00690000
007000     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00700000
007100     05  PC-SUSPEND-LIST-FORMAT    PIC  X(01)  VALUE '3'.         00710000
007200     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +03          00720000
007300                                                    COMP SYNC.    00730000
007400     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00740000
007500                                                    COMP SYNC.    00750000
007600     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00760000
007700                                                    COMP-3.       00770000
007800     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +7           00780000
007900                                                    COMP SYNC.    00790000
008000     05  PC-MAX-RETRIES            PIC S9(03)  VALUE +3           00800000
008100                                                    COMP-3.       00810000
008200     05  PC-ADD                    PIC  X(03)  VALUE 'ADD'.       00820000
008300     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00830000
008400     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00840000
008500     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00850000
008600     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00860000
008700     05  PC-VERIFIED               PIC  X(20)  VALUE 'VERIFIED'.  00870000
008800     05  PC-VERIF-ADJ              PIC  X(20)  VALUE              00880000
008900                                                'VERIFIED(ADJ)'.  00890000
009000     05  PC-DB2-DEFAULT-TMST       PIC  X(26)  VALUE              00900000
009100                               '9999-09-09-09.09.09.999999'.      00910000
009200     05  PC-DB2-DUMMY-TMST         PIC  X(26)  VALUE              00920000
009300                               '9999-09-09-09.09.09.000000'.      00930000
009400     05  PC-DEF-DATE               PIC  X(10)  VALUE '9999-09-09'.00940000
009500     05  PC-M                      PIC  X(1)  VALUE 'M'.          00950000
009600                                                                  00960000
009700*----------------------------------------------------------------*00970000
009800*  SYSTEM MESSAGES                                               *00980000
009900*----------------------------------------------------------------*00990000
010000*   00005 = INVALID VALUE                                        *01000000
010100*   00008 = MUST BE NUMERIC                                      *01010000
010200*   00045 - INVALID FUNCTION KEY.                                *01020000
010300*   00046 - DATA NOT CHANGED; NO UPDATE PERFORMED.               *01030000
010400*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01040000
010500*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01050000
010600*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01060000
010700*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01070000
010800*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01080000
010900*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01090000
011000*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01100000
011100*   00059 = UPDATE SUCCESSFUL                                    *01110000
011200*   00069 - TOP OF LIST                                          *01120000
011300*   00070 - BOTTOM OF LIST                                       *01130000
011400*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01140000
011500*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01150000
011600*   00279 - MORE ITEMS TO DISPLAY                                *01160000
011700*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01170000
011800*   01197 = VERIFICATION SUCCESSFUL                              *01180000
011900*   01634 = CANNOT UPDATE DURING PHYSICAL INVENTORY              *01190000
012000*   01730 = RECEIVER HAS NOT ARRIVED                             *01200000
012100*   01762 = NO FULLCASE PIECES TO CONFIRM                        *01210000
012200*   01804 = CONFIRMATION COMPLETED                               *01220000
012300*   01806 = UNABLE TO VERIFY DUE TO RCVR LEVEL TROUBLE           *01230000
012400*   01809 = LINE HAS ALREADY BEEN CONFIRMED                      *01240000
012500*   02155 = RECEIPT LINE(S) FOR RECEIVER HAVE ALREADY BEEN VERIFI*01250000
012600*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01260000
012700*   02252 = UPDATE REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S*01270000
012800*   03023 = RECEIVER MUST BE UPDATED BEFORE PERFORMING THIS FUNCT*01280000
012900*   03024 = MULTIPLE SHIPMENTS EXISTS FOR THIS RCVR - CALL SUPERV*01290000
012910*   03815 = CURR OPER DOES NOT MATCH SIGN ON OPER- CANT UPDATE   *01291006
013000*   99901 = INVALID COMMAND WAS ENTERED                          *01300000
013100*----------------------------------------------------------------*01310000
013200     05  PC-TSYMSG-NUMBERS.                                       01320000
013300         10  PC-TSYMSG-00004            PIC  9(05)  VALUE 00004.  01330000
013400         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01340000
013500         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  01350000
013600         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01360000
013700         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01370000
013800         10  PC-TSYMSG-00046            PIC  9(05)  VALUE 00046.  01380000
013900         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  01390000
014000         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01400000
014100         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01410000
014200         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01420000
014300         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01430000
014400         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01440000
014500         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01450000
014600         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01460000
014700         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  01470000
014800         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01480000
014900         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01490000
015000         10  PC-TSYMSG-00083            PIC  9(05)  VALUE 00083.  01500000
015100         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01510000
015200         10  PC-TSYMSG-00148            PIC  9(05)  VALUE 00148.  01520000
015300         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01530000
015400         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01540000
015500         10  PC-TSYMSG-00810            PIC  9(05)  VALUE 00810.  01550000
015600         10  PC-TSYMSG-00908            PIC  9(05)  VALUE 00908.  01560000
015700         10  PC-TSYMSG-00909            PIC  9(05)  VALUE 00909.  01570000
015800         10  PC-TSYMSG-00910            PIC  9(05)  VALUE 00910.  01580000
015900         10  PC-TSYMSG-00914            PIC  9(05)  VALUE 00914.  01590000
016000         10  PC-TSYMSG-00915            PIC  9(05)  VALUE 00915.  01600000
016100         10  PC-TSYMSG-00916            PIC  9(05)  VALUE 00916.  01610000
016200         10  PC-TSYMSG-00917            PIC  9(05)  VALUE 00917.  01620000
016300         10  PC-TSYMSG-00918            PIC  9(05)  VALUE 00918.  01630000
016400         10  PC-TSYMSG-00919            PIC  9(05)  VALUE 00919.  01640000
016500         10  PC-TSYMSG-00920            PIC  9(05)  VALUE 00920.  01650000
016600         10  PC-TSYMSG-00921            PIC  9(05)  VALUE 00921.  01660000
016700         10  PC-TSYMSG-00922            PIC  9(05)  VALUE 00922.  01670000
016800         10  PC-TSYMSG-00924            PIC  9(05)  VALUE 00924.  01680000
016900         10  PC-TSYMSG-00925            PIC  9(05)  VALUE 00925.  01690000
017000         10  PC-TSYMSG-00926            PIC  9(05)  VALUE 00926.  01700000
017100         10  PC-TSYMSG-00954            PIC  9(05)  VALUE 00954.  01710000
017200         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01720000
017300         10  PC-TSYMSG-00987            PIC  9(05)  VALUE 00987.  01730000
017400         10  PC-TSYMSG-01057            PIC  9(05)  VALUE 01057.  01740000
017500         10  PC-TSYMSG-01058            PIC  9(05)  VALUE 01058.  01750000
017600         10  PC-TSYMSG-01089            PIC  9(05)  VALUE 01089.  01760000
017700         10  PC-TSYMSG-01197            PIC  9(05)  VALUE 01197.  01770000
017800         10  PC-TSYMSG-01634            PIC  9(05)  VALUE 01634.  01780000
017900         10  PC-TSYMSG-01730            PIC  9(05)  VALUE 01730.  01790000
018000         10  PC-TSYMSG-01762            PIC  9(05)  VALUE 01762.  01800000
018100         10  PC-TSYMSG-01803            PIC  9(05)  VALUE 01803.  01810000
018200         10  PC-TSYMSG-01804            PIC  9(05)  VALUE 01804.  01820000
018300         10  PC-TSYMSG-01806            PIC  9(05)  VALUE 01806.  01830000
018400         10  PC-TSYMSG-01809            PIC  9(05)  VALUE 01809.  01840000
018500         10  PC-TSYMSG-02155            PIC  9(05)  VALUE 02155.  01850000
018600         10  PC-TSYMSG-02252            PIC  9(05)  VALUE 02252.  01860000
018700         10  PC-TSYMSG-02832            PIC  9(05)  VALUE 02832.  01870000
018800         10  PC-TSYMSG-02833            PIC  9(05)  VALUE 02833.  01880000
018900         10  PC-TSYMSG-02835            PIC  9(05)  VALUE 02835.  01890000
019000         10  PC-TSYMSG-02977            PIC  9(05)  VALUE 02977.  01900000
019100         10  PC-TSYMSG-03019            PIC  9(05)  VALUE 03019.  01910000
019200         10  PC-TSYMSG-03020            PIC  9(05)  VALUE 03020.  01920000
019300         10  PC-TSYMSG-03023            PIC  9(05)  VALUE 03023.  01930000
019400         10  PC-TSYMSG-03024            PIC  9(05)  VALUE 03024.  01940000
019500         10  PC-TSYMSG-03085            PIC  9(05)  VALUE 03085.  01950000
019600         10  PC-TSYMSG-03086            PIC  9(05)  VALUE 03086.  01960000
019610         10  PC-TSYMSG-03815            PIC  9(05)  VALUE 03815.  01961007
019700         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01970000
019800                                                                  01980000
019900 01  PS-PROGRAM-SWITCHES.                                         01990000
020000     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'N'.    02000000
020100         88  PS-NO-ERROR                            VALUE 'N'.    02010000
020200         88  PS-ERROR                               VALUE 'Y'.    02020000
020300     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    02030000
020400         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    02040000
020500         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    02050000
020600     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02060000
020700         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02070000
020800         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02080000
020900     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    02090000
021000         88  PS-LIST-END                            VALUE 'Y'.    02100000
021100         88  PS-NO-LIST-END                         VALUE 'N'.    02110000
021200     05  PS-DC-RCPNTS-SW                PIC  X(01)  VALUE 'N'.    02120000
021300         88  PS-DC-RCPNTS                           VALUE 'Y'.    02130000
021400         88  PS-NO-DC-RCPNTS                        VALUE 'N'.    02140000
021500     05  PS-AN-RCPNTS-SW                PIC  X(01)  VALUE 'N'.    02150000
021600         88  PS-AN-RCPNTS                           VALUE 'Y'.    02160000
021700         88  PS-NO-AN-RCPNTS                        VALUE 'N'.    02170000
021800     05  PS-TOSOPFA-CURSOR-SW           PIC  X(01)  VALUE 'N'.    02180000
021900         88  PS-EOF-TOSOPFA-CSR                     VALUE 'Y'.    02190000
022000     05  PS-TRECITM-CURSOR-SW           PIC  X(01)  VALUE 'N'.    02200000
022100         88  PS-EOF-TRECITM-CSR                     VALUE 'Y'.    02210000
022400     05  PS-INSTRUCTION-SW              PIC  X(01)  VALUE 'N'.    02240000
022500         88  PS-FIRST-INSTRUCTION                   VALUE 'Y'.    02250000
022600     05  PS-CHECK-NEXT-SW               PIC  X(01)  VALUE 'N'.    02260000
022700         88  PS-CHECK-NEXT                          VALUE 'Y'.    02270000
022800         88  PS-DONT-CHECK-NEXT                     VALUE 'N'.    02280000
022900     05  PS-ZERO-LEVEL-WO-SW            PIC  X(01)  VALUE 'N'.    02290000
023000         88  PS-ZERO-LEVEL-WO-COMPLETE              VALUE 'Y'.    02300000
023100         88  PS-ZERO-LEVEL-WO-NOT-COMPLETE          VALUE 'N'.    02310000
023200     05  PS-CITM-FOUND-SW               PIC  X(01)  VALUE 'N'.    02320000
023300         88  PS-CITM-FOUND                          VALUE 'Y'.    02330000
023400         88  PS-NO-CITM-FOUND                       VALUE 'N'.    02340000
023500     05  PS-PRETIC-FOUND-SW             PIC  X(01)  VALUE 'N'.    02350000
023600         88  PS-PRETIC-FOUND                        VALUE 'Y'.    02360000
023700         88  PS-NO-PRETIC-FOUND                     VALUE 'N'.    02370000
023800     05  PS-PRESENTATION-SW             PIC  X(01)  VALUE ' '.    02380000
023900         88  PS-PRESENTATION-DONE                   VALUE 'Y'.    02390000
024000     05  PS-TICKET-SW                   PIC  X(01)  VALUE ' '.    02400000
024100         88  PS-TICKET-DONE                         VALUE 'Y'.    02410000
024200     05  PS-BOXID-SW                    PIC  X(01)  VALUE ' '.    02420000
024300         88  PS-BOXID-DONE                          VALUE 'Y'.    02430000
024400     05  PS-PRICE-SW                    PIC  X(01)  VALUE ' '.    02440000
024500         88  PS-PRICE-DONE                          VALUE 'Y'.    02450000
024600     05  PS-EDIT-PASS-SW                PIC  X(01)  VALUE '0'.    02460000
024700         88  PS-ANY-EDIT                            VALUE '0'.    02470000
024800         88  PS-INITIAL-EDIT                        VALUE '1'.    02480000
024900         88  PS-EDIT-BEFORE-MOVE                    VALUE '2'.    02490000
025000     05  PS-BLOCK-ERROR-SW               PIC  X(01) VALUE 'Y'.    02500000
025100         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    02510000
025200         88  PS-BLOCK-ERROR                         VALUE 'N'.    02520000
025300     05  PS-FREIGHT-BILL-SW             PIC  X(01)  VALUE 'N'.    02530000
025400         88  PS-FREIGHT-BILL-EXISTS                 VALUE 'Y'.    02540000
025500         88  PS-NO-FREIGHT-BILL                     VALUE 'N'.    02550000
025600     05  PS-REQUIRE-CLERK-SW            PIC  X(01)  VALUE 'N'.    02560000
025700         88  PS-REQUIRE-CLERK-YES                   VALUE 'Y'.    02570000
025800         88  PS-REQUIRE-CLERK-NO                    VALUE 'N'.    02580000
025900     05  PS-TRECITM-FOUND-SW            PIC  X(01)  VALUE 'N'.    02590000
026000         88  PS-TRECITM-FOUND-NO                    VALUE 'N'.    02600000
026100         88  PS-TRECITM-FOUND-YES                   VALUE 'Y'.    02610000
026110     05  PS-PACK-TO-LIGHT-SW            PIC  X(01)  VALUE 'N'.    02611000
026120         88  PS-PACK-TO-LIGHT-NO                    VALUE 'N'.    02612000
026130         88  PS-PACK-TO-LIGHT-YES                   VALUE 'Y'.    02613000
026140     05  PS-SEASET-CHECK-SW             PIC  X(01)  VALUE 'N'.    02614000
026150         88  PS-SEASET-CHECK-YES                    VALUE 'Y'.    02615000
026160         88  PS-SEASET-CHECK-NO                     VALUE 'N'.    02616000
026170                                                                  02617000
026180 01  PV-PROGRAM-VARIABLES.                                        02618000
026190     05  PV-PPCBEF-QTY                  PIC  S9(9)  COMP.         02619000
026200     05  PV-PPCAFT-QTY                  PIC  S9(9)  COMP.         02620000
026300     05  PV-ERROR-MSG.                                            02630000
026400         10  FILLER                     PIC X(3) VALUE 'PO:'.     02640002
026410         10  PV-ERROR-OPER-UNT-ID       PIC ZZZ.                  02641002
026420         10  FILLER                     PIC X(1) VALUE '-'.       02642002
026500         10  PV-ERROR-PO                PIC 9(9).                 02650002
026600         10  FILLER                     PIC X(1) VALUE '-'.       02660002
026700         10  PV-ERROR-SEQ               PIC 999.                  02670002
026800         10  FILLER                     PIC X(6) VALUE '  '.      02680002
027000         10  PV-PRICE-CHG-HOLD          PIC X(05).                02700000
027100                                                                  02710000
027200     05  PV-TRLR-ERROR-MSG.                                       02720000
027300         10  FILLER                   PIC X(3) VALUE 'PO:'.       02730002
027310         10  PV-TRLR-ERROR-OPER-UNT-ID PIC ZZZ.                   02731002
027320         10  FILLER                   PIC X(1) VALUE '-'.         02732002
027400         10  PV-TRLR-ERROR-PO         PIC 9(9).                   02740002
027500         10  FILLER                   PIC X(1) VALUE '-'.         02750002
027600         10  PV-TRLR-ERROR-SEQ        PIC 999.                    02760002
027900         10  FILLER                   PIC X(11)                   02790002
027910                                          VALUE ' SCAC/TRLR:'.    02791002
028000         10  PV-TRLR-ERROR-SCAC       PIC X(04).                  02800000
028100         10  FILLER                   PIC X(1) VALUE '/'.         02810002
028200         10  PV-TRLR-ERROR-TRLR       PIC X(10).                  02820000
028300                                                                  02830000
028400     05  PV-FREIGHT-COUNT              PIC S9(04) VALUE ZERO COMP.02840000
028500     05  PV-ORIGINAL-BLOCK              PIC S9(04)  VALUE +0      02850000
028600                                                    COMP SYNC.    02860000
028700     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      02870000
028800     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      02880000
028900                                                                  02890000
029000     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  02900000
029100                                        COMP SYNC.                02910000
029200     05  PV-SUB                         PIC S9(04)  VALUE +0      02920000
029300                                                    COMP SYNC.    02930000
029400     05  PV-SUB2                        PIC S9(04)  VALUE +0      02940000
029500                                                    COMP SYNC.    02950000
029600     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02960000
029700                                                    COMP SYNC.    02970000
029800     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02980000
029900                                                    COMP-3.       02990000
030000     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      03000000
030100                                                    COMP-3.       03010000
030200     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      03020000
030300                                                    COMP-3.       03030000
030400     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      03040000
030500                                                    COMP-3.       03050000
030600     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      03060000
030700                                                    COMP-3.       03070000
030800     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      03080000
030900                                                    COMP-3.       03090000
031000     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      03100000
031100                                                    COMP-3.       03110000
031200     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      03120000
031300                                                    COMP SYNC.    03130000
031400     05  PV-BLK                         PIC S9(04)  VALUE +0      03140000
031500                                                    COMP SYNC.    03150000
031600     05  PV-HOLD-BLK                    PIC S9(04)  VALUE +0      03160000
031700                                                    COMP SYNC.    03170000
031800     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      03180000
031900                                                    COMP SYNC.    03190000
032000     05  PV-ITEM                        PIC S9(04)  VALUE +0      03200000
032100                                                    COMP SYNC.    03210000
032200     05  PV-ITM                         PIC S9(04)  VALUE +0      03220000
032300                                                    COMP SYNC.    03230000
032400     05  PV-HOLD-ITEM                   PIC S9(04)  VALUE +0      03240000
032500                                                    COMP SYNC.    03250000
032600     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      03260000
032700                                                    COMP SYNC.    03270000
032800     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      03280000
032900                                                    COMP SYNC.    03290000
033000     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      03300000
033100                                                    COMP SYNC.    03310000
033200     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      03320000
033300                                                    COMP SYNC.    03330000
033400     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      03340000
033500                                                    COMP SYNC.    03350000
033600     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03360000
033700                                                    COMP SYNC.    03370000
033800     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03380000
033900                                                    COMP SYNC.    03390000
034000     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      03400000
034100                                                    COMP SYNC.    03410000
034200     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      03420000
034300                                                    COMP SYNC.    03430000
034400     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      03440000
034500                                                    COMP SYNC.    03450000
034600     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      03460000
034700                                                    COMP SYNC.    03470000
034800     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      03480000
034900                                                    COMP SYNC.    03490000
035000     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      03500000
035100                                                    COMP SYNC.    03510000
035200     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      03520000
035300                                                    COMP.         03530000
035400     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      03540000
035500                                                    COMP.         03550000
035600     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      03560000
035700                                                    COMP.         03570000
035800     05  PV-SOFT-ABORT-MSG.                                       03580000
035900         10  FILLER            PIC X(12) VALUE ' CEKCS603 - '.    03590000
036000         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       03600000
036100         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    03610000
036200         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    03620000
036300         10  PV-SOFT-PARAGRAPH PIC X(30).                         03630000
036400     05  PV-PARAGRAPH                 PIC X(30) VALUE SPACES.     03640000
036500     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     03650000
036600                                                     COMP SYNC.   03660000
036700     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 03670000
036800     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 03680000
036900     05  PV-CICS-MSG-HOLD.                                        03690000
037000         10  FILLER                      PIC  X(01)  VALUE SPACE. 03700000
037100         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 03710000
037200     05  PV-CICS-MSG-HOLD2.                                       03720000
037300         10  FILLER                      PIC  X(01)  VALUE SPACE. 03730000
037400         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 03740000
037500                                                                  03750000
037600     05  PV-DB2-DATE.                                             03760000
037700         10  PV-DB2-CC                  PIC X(02).                03770000
037800         10  PV-DB2-YY                  PIC X(02).                03780000
037900         10  FILLER                     PIC X(01).                03790000
038000         10  PV-DB2-MM                  PIC X(02).                03800000
038100         10  FILLER                     PIC X(01).                03810000
038200         10  PV-DB2-DD                  PIC X(02).                03820000
038300         10  FILLER                     PIC X(01).                03830000
038400         10  PV-DB2-HH                  PIC X(02).                03840000
038500         10  FILLER                     PIC X(01).                03850000
038600         10  PV-DB2-MN                  PIC X(02).                03860000
038700         10  FILLER                     PIC X(01).                03870000
038800         10  PV-DB2-SS                  PIC X(09).                03880000
038900     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0      03890000
039000                                                    COMP-3.       03900000
039100     05  PV-NULL-IND                    PIC S9(04)  VALUE +0      03910000
039200                                                    COMP.         03920000
039300     05  PV-ONE                         PIC S9(09) COMP.          03930000
039400     05  PV-DB2-COUNT-ACTL-SCN          PIC S9(04)  VALUE +0 COMP.03940000
039500     05  PV-KEY-LINE-NBR                PIC S9(04)  COMP.         03950000
039600     05  PV-WO-INSTR-SEQ-NBR            PIC S9(04)  VALUE +0 COMP.03960000
039700     05  PV-WO-STOP-COUNT               PIC S9(04)  VALUE +0 COMP.03970000
039800     05  PV-DB2-COUNT-HANG              PIC S9(04)  VALUE +0 COMP.03980000
039900     05  PV-DB2-COUNT-FOLD              PIC S9(04)  VALUE +0 COMP.03990000
040000     05  PV-DB2-COUNT-MIXED             PIC S9(04)  VALUE +0 COMP.04000000
040100     05  PV-DB2-COUNT-TROUBLE           PIC S9(04)  VALUE +0 COMP.04010000
040200     05  PV-WORK-ORD-INSTR-MAX          PIC S9(04)  COMP.         04020000
040300     05  PV-WORK-ORD-INSTR-MAX-START    PIC  X(05)  VALUE SPACES. 04030000
040400     05  PV-WORK-ORD-INSTR-SELECTED     PIC S9(04)  COMP.         04040000
040500     05  PV-START-DATE                  PIC  X(05).               04050000
040600     05  PV-STOP-DATE                   PIC  X(05).               04060000
040700     05  PV-PREV-START-DATE             PIC  X(05).               04070000
040800     05  PV-PREV-STOP-DATE              PIC  X(05).               04080000
040900     05  PV-NEXT-START-DATE             PIC  X(05).               04090000
041000     05  PV-NEXT-INSTR-SEQ              PIC S9(04) COMP.          04100000
041100     05  PV-STATUS-CDE                  PIC  X(02).               04110000
041200     05  PV-DUMMY-TMST                  PIC  X(26)  VALUE         04120000
041300         '9998-09-09-09.09.09.999999'.                            04130000
041400     05  PV-CURRENT-TMST                PIC  X(26).               04140000
041500/                                                                 04150000
041600     05  PV-DISPLAY-PO                PIC  9(8)   VALUE ZEROS.    04160000
041700     05  PV-DISPLAY-RCVR              PIC  9(8)   VALUE ZEROS.    04170000
041800     05  PV-DISPLAY-LINE              PIC  9(8)   VALUE ZEROS.    04180000
041900     05  PV-DISPLAY-OPER              PIC  9(4)   VALUE ZEROS.    04190000
042000     05  PV-DISPLAY-SQL-CODE          PIC  9999-  VALUE ZEROS.    04200000
042100     05  PV-DISPLAY-CICS-RESP         PIC  999999999-             04210000
042200                                                  VALUE ZEROS.    04220000
042300                                                                  04230000
042400     05  PV-ERROR-ORD-NBR                PIC  9(08)  VALUE ZEROS. 04240000
042500     05  PV-ERROR-RCVR-SEQ-NBR           PIC  9(04)  VALUE ZEROS. 04250000
042600     05  PV-ERROR-ORD-LNE-NBR            PIC  9(04)  VALUE ZEROS. 04260000
042700     05  PV-ERROR-STR-NBR                PIC  9(04)  VALUE ZEROS. 04270000
042800     05  PV-ERROR-STATUS                 PIC  X(01)  VALUE SPACE. 04280000
042900     05  PV-ERROR-SOURCE                 PIC  X(02)  VALUE SPACE. 04290000
043000                                                                  04300000
043100                                                                  04310000
043200     05  PV-ORD-NBR-DISPLAY              PIC  9(08)  VALUE ZEROES.04320000
043300     05  PV-REC-SEQ-NBR-DISPLAY          PIC  9(04)  VALUE ZEROES.04330000
043400     05  PV-ORD-LNE-NBR-DISPLAY          PIC  9(04)  VALUE ZEROES.04340000
043500     05  PV-OPER-UNT-ID-DISPLAY          PIC  9(04)  VALUE ZEROES.04350000
043600     05  PV-STORE-NBR-DISPLAY            PIC  9(04)  VALUE ZEROES.04360000
043700     05  PV-FCLTY-ID-DISPLAY             PIC  9(04)  VALUE ZEROES.04370000
043800     05  PV-ID-NBR-DISPLAY               PIC  X(04)  VALUE SPACES.04380000
043900     05  PV-DEPT-NBR-PIC9                PIC  9(03)  VALUE ZEROES.04390000
043901                                                                  04390107
043910     05  PV-CURR-OPER-UNT-ID             PIC  S9(4) COMP.         04391007
044000                                                                  04400000
044100*                                                                 04410000
044200                                                                  04420000
044300*---------------------------------------------------------------* 04430000
044400*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 04440000
044500*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           * 04450000
044600*   APPLICATION-SPECIFIC COMMAREA.                              * 04460000
044700*---------------------------------------------------------------* 04470000
044800 01  LQW-LIST-QUEUE-WORK-AREA.                                    04480000
044900     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  04490000
045000     05  LQW-ITEM-ENTRIES               OCCURS 03 TIMES           04500000
045100                                        INDEXED BY LQW-IDX.       04510000
045200         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       04520000
045300         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               04530000
045400         10  LQW-SELECTED-SW            PIC  X(01).               04540000
045500             88  LQW-SELECT                         VALUE 'S'.    04550000
045600             88  LQW-DESELECT                       VALUE ' '.    04560000
045700         10  LQW-ACTION                 PIC  X(03).               04570000
045800         10  LQW-SEQ                    PIC  9(04).               04580000
045900         10  LQW-INSTRCT-DESC           PIC  X(23).               04590000
046000         10  LQW-LOC-CODE               PIC  X(05).               04600000
046100         10  LQW-DATE-STRT              PIC  X(05).               04610000
046200         10  LQW-TIME-STRT              PIC  X(05).               04620000
046300         10  LQW-DATE-COMP              PIC  X(05).               04630000
046400         10  LQW-TIME-COMP              PIC  X(05).               04640000
046500         10  LQW-WO-INSTR-SEQ-NBR       PIC  9(04).               04650000
046600                                                                  04660000
046700*-----------------------------------------------------------------04670000
046800*  COPYBOOK FOR LOGISTIC MODULE XLKUT001                          04680000
046900*-----------------------------------------------------------------04690000
047000     COPY XLWS001.                                                04700000
047100                                                                  04710000
047200*-----------------------------------------------------------------04720000
047300*  COPYBOOK FOR VERIFY/CONFIRM MODULES                            04730000
047400*  NO LONGER NEEDED DUE TO AUTO-VERIFICATION PROJECT. 9/2003      04740000
047500*-----------------------------------------------------------------04750000
047600*    COPY RCWS072.                                                04760000
047700                                                                  04770000
047800*-----------------------------------------------------------------04780000
047900*  COPYBOOK FOR TCENPPC CURSOR                                    04790000
048000*-----------------------------------------------------------------04800000
048100     COPY PEWS049.                                                04810000
048200                                                                  04820000
048300*---------------------------------------------------------------* 04830000
048400*  RECORD LAYOUT 'INSERT AUDIT MODULE'  RCKCS290                * 04840000
048500*---------------------------------------------------------------* 04850000
048600     COPY RCWS031.                                                04860000
048700                                                                  04870000
048800*----------------------------------------------------------------*04880000
048900*    COMMAREA FOR SEASONAL SET AND FIXT ID MODULE (PCKUT025)      04890000
049000*----------------------------------------------------------------*04900000
049100     COPY PCWS240.                                                04910000
049200                                                                  04920001
049300*-----------------------------------------------------------------04930000
049400* COMMAREA FOR XLKUT086 - PERM PRICE MODULE                       04940000
049500*-----------------------------------------------------------------04950000
049600     COPY XLWS086.                                                04960000
049700                                                                  04970001
049710*---------------------------------------------------------------* 04971001
049800*    AUTO-VE MODULE RCKUT127                                      04980000
049810*---------------------------------------------------------------* 04981001
049900     COPY RCWS040.                                                04990000
050000                                                                  05000001
050010*---------------------------------------------------------------* 05001001
050100* COPY BOOK FOR CALLED MODULE PCKCS756                            05010000
050110*---------------------------------------------------------------* 05011001
050200     COPY PCWS238.                                                05020000
050300                                                                  05030001
050800*---------------------------------------------------------------* 05080000
050900*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 05090000
051000*---------------------------------------------------------------* 05100000
051100     COPY RCWS816.                                                05110000
051200     COPY PCWS017.                                                05120000
051300     COPY RCWS817.                                                05130000
051400                                                                  05140000
051500*---------------------------------------------------------------* 05150000
051600*    MAP LAYOUT                                                 * 05160000
051700*---------------------------------------------------------------* 05170000
051800     COPY RCKM816.                                                05180000
051900                                                                  05190000
052000 01  MR-OCCURS-LAYOUT                   REDEFINES  RC816AO.       05200000
052100* CLT 06/28/2010 START                                            05210000
052200     05  FILLER                         PIC X(422).               05220000
052300* CLT 06/28/2010 END   412 TO 422                                 05230000
052400     05  MR-SCROLL-AREA                 OCCURS 03 TIMES.          05240000
052500         10  MR-SELECTL                 PIC S9(04) COMP.          05250000
052600         10  MR-SELECTA                 PIC  X(01).               05260000
052700         10  MR-SELECTC                 PIC  X(01).               05270000
052800         10  MR-SELECTH                 PIC  X(01).               05280000
052900         10  MR-SELECT                  PIC  X(01).               05290000
053000                                                                  05300000
053700         10  MR-SEQL                    PIC S9(04) COMP.          05370000
053800         10  MR-SEQA                    PIC  X(01).               05380000
053900         10  MR-SEQC                    PIC  X(01).               05390000
054000         10  MR-SEQH                    PIC  X(01).               05400000
054100         10  MR-SEQ-X                   PIC  X(04).               05410000
054200         10  MR-SEQ-N REDEFINES MR-SEQ-X.                         05420000
054300             15  MR-SEQ                 PIC  ZZZ9.                05430000
054400                                                                  05440000
054500         10  MR-INSTRCT-DESCL           PIC S9(04) COMP.          05450000
054600         10  MR-INSTRCT-DESCA           PIC  X(01).               05460000
054700         10  MR-INSTRCT-DESCC           PIC  X(01).               05470000
054800         10  MR-INSTRCT-DESCH           PIC  X(01).               05480000
054900         10  MR-INSTRCT-DESC            PIC  X(23).               05490000
055000                                                                  05500000
055100         10  MR-LOC-CODEL               PIC S9(04) COMP.          05510000
055200         10  MR-LOC-CODEA               PIC  X(01).               05520000
055300         10  MR-LOC-CODEC               PIC  X(01).               05530000
055400         10  MR-LOC-CODEH               PIC  X(01).               05540000
055500         10  MR-LOC-CODE                PIC  X(05).               05550000
055600                                                                  05560000
055700         10  MR-DATE-STRTL              PIC S9(04) COMP.          05570000
055800         10  MR-DATE-STRTA              PIC  X(01).               05580000
055900         10  MR-DATE-STRTC              PIC  X(01).               05590000
056000         10  MR-DATE-STRTH              PIC  X(01).               05600000
056100         10  MR-DATE-STRT               PIC  X(05).               05610000
056200                                                                  05620000
056300         10  MR-TIME-STRTL              PIC S9(04) COMP.          05630000
056400         10  MR-TIME-STRTA              PIC  X(01).               05640000
056500         10  MR-TIME-STRTC              PIC  X(01).               05650000
056600         10  MR-TIME-STRTH              PIC  X(01).               05660000
056700         10  MR-TIME-STRT               PIC  X(05).               05670000
056800                                                                  05680000
056900         10  MR-DATE-COMPL              PIC S9(04) COMP.          05690000
057000         10  MR-DATE-COMPA              PIC  X(01).               05700000
057100         10  MR-DATE-COMPC              PIC  X(01).               05710000
057200         10  MR-DATE-COMPH              PIC  X(01).               05720000
057300         10  MR-DATE-COMP               PIC  X(05).               05730000
057400                                                                  05740000
057500         10  MR-TIME-COMPL              PIC S9(04) COMP.          05750000
057600         10  MR-TIME-COMPA              PIC  X(01).               05760000
057700         10  MR-TIME-COMPC              PIC  X(01).               05770000
057800         10  MR-TIME-COMPH              PIC  X(01).               05780000
057900         10  MR-TIME-COMP               PIC  X(05).               05790000
058000                                                                  05800000
058100                                                                  05810000
058200*----------------------------------------------------------------*05820000
058300**  SECURITY SUBROUTINE PARAMETERS                                05830000
058400*----------------------------------------------------------------*05840000
058500     COPY DPWS008.                                                05850000
058600                                                                  05860000
058700*                                                                 05870000
058800***************************************************************** 05880000
058900*   XLWS071 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 05890000
059000*             LOCATION MODULE (XLKUT071)                        * 05900000
059100***************************************************************** 05910000
059200     COPY XLWS071.                                                05920000
059300                                                                  05930000
059400*---------------------------------------------------------------* 05940000
059500*    ATTRIBUTE SETTINGS COPYBOOK.                               * 05950000
059600*---------------------------------------------------------------* 05960000
059700     COPY DPWS015.                                                05970000
059800                                                                  05980000
059900*---------------------------------------------------------------* 05990000
060000*    FUNCTION KEYS COPYBOOK.                                    * 06000000
060100*---------------------------------------------------------------* 06010000
060200     COPY DPWS016.                                                06020000
060300                                                                  06030000
060400*---------------------------------------------------------------* 06040000
060500*    NUMERIC EDIT LAYOUT.                                       * 06050000
060600*---------------------------------------------------------------* 06060000
060700     COPY DPWS010I.                                               06070000
060800                                                                  06080000
060900******************************************************************06090012
061000** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **06100012
061010** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **06101012
061100******************************************************************06110012
061200     COPY DPWS030.                                                06120000
061210     COPY DPWS930.                                                06121012
061300                                                                  06130000
061400*---------------------------------------------------------------* 06140000
061500*    STANDARD COMMAREA.                                         * 06150000
061600*---------------------------------------------------------------* 06160000
061700     COPY DPWS020.                                                06170000
061800     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                06180000
061900                                                                  06190000
062000*---------------------------------------------------------------* 06200000
062100* INTER-APPLICATION COMMAREA.                                   * 06210000
062200*---------------------------------------------------------------* 06220000
062300         10  INTER-APPL-COMM-AREA       PIC X(200).               06230000
062400     COPY RCWS815.                                                06240000
062500     COPY RCWS012.                                                06250000
062600     COPY RCWS015.                                                06260000
062700     COPY POWS017.                                                06270000
062800     COPY PCWS000.                                                06280000
062900                                                                  06290000
063000*---------------------------------------------------------------* 06300000
063100*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 06310000
063200*---------------------------------------------------------------* 06320000
063300         10  ASC-SPECIFIC-COMMAREA.                               06330000
063400             15  ASC-PO-NBR                PIC S9(09) COMP.       06340000
063500             15  ASC-RCVR-SEQ-NBR          PIC S9(09) COMP.       06350000
063600* CLT 06/28/2010 START                                            06360000
063700             15  ASC-REPLEN-IND            PIC X.                 06370000
063800* CLT 06/28/2010 END                                              06380000
063900             15  ASC-WORK-ORD-SEQ-NBR      PIC S9(04) COMP.       06390000
064000             15  ASC-LINE-NBR              PIC S9(04) COMP.       06400000
064100             15  ASC-SCAC                  PIC  X(04).            06410000
064200             15  ASC-TRIP-ID               PIC S9(09) COMP.       06420000
064300             15  ASC-VENDOR                PIC  X(20).            06430000
064400             15  ASC-TRLR-NBR              PIC  X(10).            06440000
064500             15  ASC-STATUS                PIC  X(02).            06450000
064600             15  ASC-WKORIN-TMST           PIC  X(26).            06460000
064700             15  ASC-TROUBLE               PIC  X(20).            06470000
064800             15  ASC-SPCL-INSTRCT          PIC  X(14).            06480000
064900             15  ASC-PRESENTATION          PIC  X(20).            06490000
065000             15  ASC-HANGER                PIC  X(01).            06500000
065100             15  ASC-TICKET                PIC  X(20).            06510000
065200             15  ASC-NEWSTORE              PIC  X(01).            06520000
065300             15  ASC-RTV                   PIC  X(01).            06530000
065400             15  ASC-PRETICKET             PIC  X(01).            06540000
065500             15  ASC-PKGNG-CDE             PIC  X(01).            06550000
065600             15  ASC-SET-NAME              PIC  X(05).            06560000
065700             15  ASC-CLERK                 PIC  X(03).            06570000
065800             15  ASC-BOX-ID-N              PIC  9(03).            06580000
065900             15  ASC-BOX-ID-X  REDEFINES ASC-BOX-ID-N.            06590000
066000                 20  ASC-BOX-ID            PIC  X(03).            06600000
066100             15  ASC-PACKAGE               PIC  X(01).            06610000
066200             15  ASC-PRICE-CHG             PIC  X(05).            06620000
066300             15  ASC-OPER-SET-X            PIC  X(03).            06630000
066400             15  ASC-OPER-SET-N REDEFINES ASC-OPER-SET-X.         06640000
066500                 20  ASC-OPER-SET          PIC  9(03).            06650000
066600             15  ASC-OPER-SET-NAME         PIC  X(20).            06660000
066700             15  ASC-EXP-CRTN-CNT-X        PIC  X(05).            06670000
066800             15  ASC-EXP-CRTN-CNT-N REDEFINES ASC-EXP-CRTN-CNT-X. 06680000
066900                 20  ASC-EXP-CRTN-CNT      PIC  9(05).            06690000
067000             15  ASC-ACT-CRTN-CNT-X        PIC  X(05).            06700000
067100             15  ASC-ACT-CRTN-CNT-N REDEFINES ASC-ACT-CRTN-CNT-X. 06710000
067200                 20  ASC-ACT-CRTN-CNT      PIC  9(05).            06720000
067300             15  ASC-DMG-CRTN-CNT-X        PIC  X(05).            06730000
067400             15  ASC-DMG-CRTN-CNT-N REDEFINES ASC-DMG-CRTN-CNT-X. 06740000
067500                 20  ASC-DMG-CRTN-CNT      PIC  9(05).            06750000
067600             15  ASC-SCN-CRTN-CNT-X        PIC  X(05).            06760000
067700             15  ASC-SCN-CRTN-CNT-N REDEFINES ASC-SCN-CRTN-CNT-X. 06770000
067800                 20  ASC-SCN-CRTN-CNT      PIC  9(05).            06780000
067900             15  ASC-LOC-CODE-1-1          PIC  X(05).            06790000
068000             15  ASC-LOC-CODE-1-2          PIC  X(05).            06800000
068100             15  ASC-LOC-CODE-1-3          PIC  X(05).            06810000
068200             15  ASC-VRFD-DATE             PIC  X(05).            06820000
068300             15  ASC-VRFD-TIME             PIC  X(05).            06830000
068400             15  ASC-VRFD-USER-ID          PIC  X(08).            06840000
068500             15  ASC-PCS-INVCD             PIC X(07).             06850000
068600             15  ASC-PCS-INVCD-N REDEFINES ASC-PCS-INVCD          06860000
068700                                           PIC 9(07).             06870000
068800             15  ASC-PCS-VERFD             PIC X(07).             06880000
068900             15  ASC-PCS-VERFD-N REDEFINES ASC-PCS-VERFD          06890000
069000                                           PIC 9(07).             06900000
069100             15  ASC-PACK-BY-ST-IND        PIC X(01).             06910000
069200                 88  ASC-PACK-BY-ST      VALUE 'Y'.               06920000
069300                 88  ASC-NOT-PACK-BY-ST  VALUE ' ', 'N'.          06930000
069400             15  ASC-UCC128-SW            PIC  X(01).             06940000
069500                 88  ASC-UCC128-YES      VALUE 'Y'.               06950000
069600                 88  ASC-UCC128-NO       VALUE ' '.               06960000
069700             15  ASC-ARRIVED-SW            PIC X(01).             06970000
069800                 88  ASC-RECEIVER-ARRIVED      VALUE 'Y'.         06980000
069900                 88  ASC-RECEIVER-NOT-ARRIVED  VALUE 'N'.         06990000
070000             15  ASC-OPER-UNT-ID           PIC S9(04) COMP.       07000000
070100             15  ASC-WO-OPER-UNT-ID        PIC S9(04) COMP.       07010000
070200             15  ASC-FCLTY-ID              PIC S9(04) COMP.       07020000
070300             15  ASC-WRKORD-STATUS         PIC  X(02).            07030000
070400             15  ASC-TKT-FMT-ID            PIC  X(06).            07040000
070500             15  ASC-ITM-NBR               PIC S9(15)V COMP-3.    07050000
070600             15  ASC-STATUS-OLD            PIC  X(02).            07060000
070700             15  ASC-OPER-SET-OLD          PIC  9(03).            07070000
070800             15  ASC-CLERK-OLD             PIC  X(03).            07080000
070900             15  ASC-ACT-CRTN-CNT-OLD      PIC  9(05).            07090000
071000             15  ASC-DMG-CRTN-CNT-OLD      PIC  9(05).            07100000
071100             15  ASC-MULT-SHIP-SW          PIC  X(01).            07110000
071200                 88  ASC-MULT-SHIP          VALUE 'Y'.            07120000
071300             15  ASC-TKT-DESC              PIC X(20).             07130000
071400                                                                  07140000
071500             15  ASC-BLK-SUB            PIC S9(04) COMP SYNC.     07150000
071600             15  ASC-ITEM-SUB           PIC S9(04) COMP SYNC.     07160000
071700             15  ASC-NUMBER-OF-ITEMS-READ                         07170000
071800                                        PIC S9(09) COMP-3.        07180000
071900             15  ASC-NUMBER-OF-SELECTED-ITEMS                     07190000
072000                                        PIC S9(09) COMP-3.        07200000
072100             15  ASC-ITEMS-DISPLAYED    PIC S9(03) COMP-3.        07210000
072200             15  ASC-ITEM-AT-TOP-OF-PANEL                         07220000
072300                                        PIC S9(09) COMP-3.        07230000
072400             15  ASC-ITEM-AT-BOT-OF-PANEL    PIC S9(09) COMP-3.   07240000
072500             15  ASC-HIGHEST-BLOCK-WRITTEN   PIC S9(04) COMP SYNC.07250000
072600             15  ASC-START-OF-SELECTED-RANGE PIC S9(09) COMP-3.   07260000
072700             15  ASC-END-OF-SELECTED-RANGE   PIC S9(09) COMP-3.   07270000
072800             15  ASC-ITEMS-LEFT-INDICATOR    PIC X(01).           07280000
072900                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     07290000
073000                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     07300000
073100             15  ASC-TEMP-QUEUE-UPDATE-SW    PIC X(01).           07310000
073200                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     07320000
073300                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     07330000
073400             15  ASC-LIST-QUEUE-NAME.                             07340000
073500                 20  ASC-LIST-TERM-ID        PIC X(04).           07350000
073600                 20  ASC-LIST-TASK-NUMBER    PIC S9(05) COMP-3.   07360000
073700                 20  ASC-LIST-SEQ            PIC 9(01).           07370000
073800             15  ASC-CONFIRM-SW          PIC  X(01).              07380000
073900                 88  ASC-NO-CONFIRM                  VALUE '0'.   07390000
074000                 88  ASC-HOT-COMPL-CONFIRM           VALUE '1'.   07400000
074100                 88  ASC-RESTRT-WO-CONFIRM           VALUE '2'.   07410000
074200                 88  ASC-ACT-CNT-ZERO-F17-CONFIRM    VALUE '3'.   07420000
074300                 88  ASC-ACT-CNT-ZERO-F19-CONFIRM    VALUE '4'.   07430000
074400                 88  ASC-ACT-CNT-ZERO-F15-CONFIRM    VALUE '5'.   07440000
074500             15  ASC-RCVG-CLERK-SW           PIC  X(01).          07450000
074600                 88  ASC-CLERK-UPDATED                  VALUE 'Y'.07460000
074700                 88  ASC-CLERK-NOT-UPDATED              VALUE 'N'.07470000
074800             15  ASC-ACTL-CRTNS-SW           PIC  X(01).          07480000
074900                 88  ASC-ACTL-CRTNS-UPDATED             VALUE 'Y'.07490000
075000                 88  ASC-ACTL-CRTNS-NOT-UPDATED         VALUE 'N'.07500000
075100                                                                  07510000
075200             15  ASC-START-ITEM-REQUEST.                          07520000
075300                 20  ASC-START-ITEM-REQUEST-N PIC 9(05).          07530000
075400                                                                  07540000
075500             15  ASC-SEL-SUB                 PIC S9(04) COMP.     07550000
075600             15  ASC-SEL-ITEM                PIC S9(04) COMP.     07560000
075700             15  ASC-USE-SELECTION-QUEUE-IND PIC X(01).           07570000
075800                 88  ASC-USE-SELECTION-QUEUE    VALUE 'Y'.        07580000
075900             15  ASC-PREV-SEL-QUEUE-NAME     PIC X(08).           07590000
076000             15  ASC-SEL-QUEUE-NAME.                              07600000
076100                 20  ASC-SEL-TERM-ID         PIC X(04).           07610000
076200                 20  ASC-SEL-TASK-NUMBER     PIC S9(05) COMP-3.   07620000
076300                 20  ASC-SEL-SEQ             PIC 9(01).           07630000
076400             15  ASC-SEL-QUEUE-NAME2.                             07640000
076500                 20  ASC-SEL-TERM-ID2        PIC  X(04).          07650000
076600                 20  ASC-SEL-TASK-NUMBER2    PIC S9(05)   COMP-3. 07660000
076700                 20  ASC-SEL-SEQ2            PIC  9(01).          07670000
076800             15  ASC-CRTN-CNT-CHG-SW         PIC X(01).           07680000
076900                 88  ASC-CRTN-CNT-CHG-YES              VALUE 'Y'. 07690000
077000                 88  ASC-CRTN-CNT-CHG-NO               VALUE 'N'. 07700000
077100             15  ASC-CURSOR-POSITION-IND     PIC 9(02).           07710000
077200                 88  ASC-CSR-CLEAR                     VALUE 0.   07720000
077300                 88  ASC-CSR-OPERSET                   VALUE 1.   07730000
077400                 88  ASC-CSR-CLERK                     VALUE 2.   07740000
077500                 88  ASC-CSR-ACT-CTN                   VALUE 3.   07750000
077600                 88  ASC-CSR-DMG-CTN                   VALUE 4.   07760000
077700                 88  ASC-CSR-START-ITEM                VALUE 5.   07770000
077800                 88  ASC-CSR-SELECT-1                  VALUE 6.   07780000
077900                 88  ASC-CSR-SELECT-2                  VALUE 7.   07790000
078000                 88  ASC-CSR-SELECT-3                  VALUE 8.   07800000
078100                 88  ASC-CSR-LOC-1                     VALUE 9.   07810000
078200                 88  ASC-CSR-LOC-2                     VALUE 10.  07820000
078300                 88  ASC-CSR-LOC-3                     VALUE 11.  07830000
078400                                                                  07840000
078500                                                                  07850000
078600             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05) COMP-3.     07860000
078700             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                07870000
078800                 20  ASC-BLOCK-MODIFIED-SW                        07880000
078900                                        PIC X(01).                07890000
079000                     88  ASC-BLOCK-NOT-MODIFIED     VALUE 'N'.    07900000
079100                     88  ASC-BLOCK-MODIFIED         VALUE 'Y'.    07910000
079200                                                                  07920000
079300                 20  ASC-ITEM-ARRAY.                              07930000
079400                     25  ASC-ITEM-ENTRIES OCCURS 03 TIMES.        07940000
079500                         30  ASC-LIST-ITEM-NUMBER                 07950000
079600                                        PIC S9(09)  COMP-3.       07960000
079700                         30  ASC-TEMP-SELECTED-SW                 07970000
079800                                        PIC X(01).                07980000
079900                             88  ASC-VALID-SELECT   VALUE ' '     07990000
080000                                                          'S'     08000000
080100                                                          'B'     08010000
080200                                                          'E'.    08020000
080300                             88  ASC-TEMP-NO-SELECT VALUE ' '.    08030000
080400                             88  ASC-TEMP-SELECT    VALUE 'S'.    08040000
080500                             88  ASC-TEMP-BEGIN     VALUE 'B'.    08050000
080600                             88  ASC-TEMP-END       VALUE 'E'.    08060000
080700                         30  ASC-SELECTED-SW                      08070000
080800                                        PIC X(01).                08080000
080900                             88  ASC-NO-SELECT      VALUE ' '.    08090000
081000                             88  ASC-SELECT         VALUE 'S'.    08100000
081100                             88  ASC-BEGIN          VALUE 'B'.    08110000
081200                             88  ASC-END            VALUE 'E'.    08120000
081300                         30  ASC-ACTION            PIC X(03).     08130000
081400                         30  ASC-SEQ               PIC 9(04).     08140000
081500                         30  ASC-INSTRCT-DESC      PIC X(23).     08150000
081600                         30  ASC-LOC-CODE          PIC X(05).     08160000
081700                         30  ASC-DATE-STRT         PIC X(05).     08170000
081800                         30  ASC-TIME-STRT         PIC X(05).     08180000
081900                         30  ASC-DATE-COMP         PIC X(05).     08190000
082000                         30  ASC-TIME-COMP         PIC X(05).     08200000
082100                         30  ASC-WO-INSTR-SEQ-NBR  PIC 9(04).     08210000
082200                                                                  08220000
082300*---------------------------------------------------------------* 08230000
082400*    ABEND PROCESSING COPYBOOK.                                 * 08240000
082500*---------------------------------------------------------------* 08250000
082600     COPY DPWS013.                                                08260000
082700                                                                  08270000
083500*---------------------------------------------------------------* 08350000
083600*    DB2 AREA FOR SYSDUMMY TABLE                                  08360000
083700*---------------------------------------------------------------* 08370000
083800     EXEC SQL                                                     08380000
083900          INCLUDE SYSDUMMY                                        08390000
084000     END-EXEC.                                                    08400000
084100                                                                  08410000
084200*---------------------------------------------------------------* 08420000
084300*    DB2 AREA FOR TAUSHPO TABLE                                   08430000
084400*---------------------------------------------------------------* 08440000
084500     EXEC SQL                                                     08450000
084600          INCLUDE TAUSHPO                                         08460000
084700     END-EXEC.                                                    08470000
084800                                                                  08480000
084900*---------------------------------------------------------------* 08490000
085000*    DB2 AREA FOR TOSOPFA TABLE                                   08500000
085100*---------------------------------------------------------------* 08510000
085200     EXEC SQL                                                     08520000
085300          INCLUDE TOSOPFA                                         08530000
085400     END-EXEC.                                                    08540000
085500                                                                  08550000
085600*---------------------------------------------------------------* 08560000
085700*    DB2 AREA FOR TOPRSET TABLE                                   08570000
085800*---------------------------------------------------------------* 08580000
085900     EXEC SQL                                                     08590000
086000          INCLUDE TOPRSET                                         08600000
086100     END-EXEC.                                                    08610000
086200                                                                  08620000
086300*---------------------------------------------------------------* 08630000
086400*    DB2 AREA FOR TTRBNTF TABLE                                   08640000
086500*---------------------------------------------------------------* 08650000
086600     EXEC SQL                                                     08660000
086700          INCLUDE TTRBNTF                                         08670000
086800     END-EXEC.                                                    08680000
086900                                                                  08690000
087000*---------------------------------------------------------------* 08700000
087100*    DB2 AREA FOR THE TTRBRSN TABLE                               08710000
087200*---------------------------------------------------------------* 08720000
087300     EXEC SQL                                                     08730000
087400          INCLUDE TTRBRSN                                         08740000
087500     END-EXEC.                                                    08750000
087600                                                                  08760000
087700*---------------------------------------------------------------* 08770000
087800*    DB2 AREA FOR THE TVHTRIP TABLE                               08780000
087900*---------------------------------------------------------------* 08790000
088000     EXEC SQL                                                     08800000
088100          INCLUDE TVHTRIP                                         08810000
088200     END-EXEC.                                                    08820000
088300                                                                  08830000
088400*---------------------------------------------------------------* 08840000
088500*    DB2 AREA FOR THE TSHIPMT TABLE                               08850000
088600*---------------------------------------------------------------* 08860000
088700     EXEC SQL                                                     08870000
088800          INCLUDE TSHIPMT                                         08880000
088900     END-EXEC.                                                    08890000
089000                                                                  08900000
089100*---------------------------------------------------------------* 08910000
089200*    DB2 AREA FOR THE TSHPTPO TABLE                               08920000
089300*---------------------------------------------------------------* 08930000
089400     EXEC SQL                                                     08940000
089500          INCLUDE TSHPTPO                                         08950000
089600     END-EXEC.                                                    08960000
089700                                                                  08970000
089800*---------------------------------------------------------------* 08980000
089900*    DB2 AREA FOR THE TSHUNLO TABLE                               08990000
090000*---------------------------------------------------------------* 09000000
090100     EXEC SQL                                                     09010000
090200          INCLUDE TSHUNLO                                         09020000
090300     END-EXEC.                                                    09030000
090400                                                                  09040000
090500*---------------------------------------------------------------* 09050000
090600*    DB2 AREA FOR THE TPOINST TABLE                               09060000
090700*---------------------------------------------------------------* 09070000
090800     EXEC SQL                                                     09080000
090900          INCLUDE TPOINST                                         09090000
091000     END-EXEC.                                                    09100000
091100                                                                  09110000
091200*---------------------------------------------------------------* 09120000
091300*    DB2 AREA FOR THE TPKSLIP TABLE                               09130000
091400*---------------------------------------------------------------* 09140000
091500     EXEC SQL                                                     09150000
091600          INCLUDE TPKSLIP                                         09160000
091700     END-EXEC.                                                    09170000
091800                                                                  09180000
091900*---------------------------------------------------------------* 09190000
092000*    DB2 AREA FOR THE TINPKSU TABLE                               09200000
092100*---------------------------------------------------------------* 09210000
092200     EXEC SQL                                                     09220000
092300          INCLUDE TINPKSU                                         09230000
092400     END-EXEC.                                                    09240000
092500                                                                  09250000
092600*---------------------------------------------------------------* 09260000
092700*    DB2 AREA FOR THE TINSTCD TABLE                               09270000
092800*---------------------------------------------------------------* 09280000
092900     EXEC SQL                                                     09290000
093000          INCLUDE TINSTCD                                         09300000
093100     END-EXEC.                                                    09310000
093200                                                                  09320000
093300*---------------------------------------------------------------* 09330000
093400*    DB2 AREA FOR TINRCCD TABLE                                   09340000
093500*---------------------------------------------------------------* 09350000
093600     EXEC SQL                                                     09360000
093700          INCLUDE TINRCCD                                         09370000
093800     END-EXEC.                                                    09380000
093900                                                                  09390000
094000*---------------------------------------------------------------* 09400000
094100*    DB2 AREA FOR TRECEIV TABLE                                   09410000
094200*---------------------------------------------------------------* 09420000
094300     EXEC SQL                                                     09430000
094400          INCLUDE TRECEIV                                         09440000
094500     END-EXEC.                                                    09450000
094600                                                                  09460000
094700*---------------------------------------------------------------* 09470000
094800*    DB2 AREA FOR TPURCHS TABLE                                   09480000
094900*---------------------------------------------------------------* 09490000
095000     EXEC SQL                                                     09500000
095100          INCLUDE TPURCHS                                         09510000
095200     END-EXEC.                                                    09520000
095300                                                                  09530000
095400*---------------------------------------------------------------* 09540000
095500*    DB2 AREA FOR TPURITM TABLE                                   09550000
095600*---------------------------------------------------------------* 09560000
095700     EXEC SQL                                                     09570000
095800          INCLUDE TPURITM                                         09580000
095900     END-EXEC.                                                    09590000
096000                                                                  09600000
096010*---------------------------------------------------------------* 09601000
096020*    DB2 AREA FOR THE PURCHASE ORDER PREPACK TABLE              * 09602000
096030*---------------------------------------------------------------* 09603000
096040     EXEC SQL                                                     09604000
096050          INCLUDE TPOPRPK                                         09605000
096060     END-EXEC.                                                    09606000
096070                                                                  09607000
096080*---------------------------------------------------------------* 09608000
096090*    DB2 AREA FOR TRECITM TABLE                                   09609000
096100*---------------------------------------------------------------* 09610000
096200     EXEC SQL                                                     09620000
096300          INCLUDE TRECITM                                         09630000
096400     END-EXEC.                                                    09640000
096500                                                                  09650000
096600*---------------------------------------------------------------* 09660000
096700*    DB2 AREA FOR TRECDIS TABLE                                   09670000
096800*---------------------------------------------------------------* 09680000
096900     EXEC SQL                                                     09690000
097000          INCLUDE TRECDIS                                         09700000
097100     END-EXEC.                                                    09710000
097200                                                                  09720000
097300*---------------------------------------------------------------* 09730000
097400*    DB2 AREA FOR TDISTHD TABLE                                   09740000
097500*---------------------------------------------------------------* 09750000
097600     EXEC SQL                                                     09760000
097700          INCLUDE TDISTHD                                         09770000
097800     END-EXEC.                                                    09780000
097900                                                                  09790000
098000*----------------------------------------------------------------*09800000
098100*    DB2 AREA FOR WORK ORDER TABLE                               *09810000
098200*----------------------------------------------------------------*09820000
098300     EXEC SQL                                                     09830000
098400          INCLUDE TWRKORD                                         09840000
098500     END-EXEC.                                                    09850000
098600                                                                  09860000
098700*----------------------------------------------------------------*09870000
098800*    DB2 AREA FOR WORK ORDER INSTRUCTION TABLE                   *09880000
098900*----------------------------------------------------------------*09890000
099000     EXEC SQL                                                     09900000
099100          INCLUDE TWKORIN                                         09910000
099200     END-EXEC.                                                    09920000
099300                                                                  09930000
099400*----------------------------------------------------------------*09940000
099500*    DB2 DCLGEN FOR PO AGREEMENT TABLE                            09950000
099600*----------------------------------------------------------------*09960000
099700     EXEC SQL                                                     09970000
099800          INCLUDE TPOAGMT                                         09980000
099900     END-EXEC.                                                    09990000
100000                                                                  10000000
100100*----------------------------------------------------------------*10010000
100200*    DB2 DCLGEN FOR PO TOPERT TABLE                               10020000
100300*----------------------------------------------------------------*10030000
100400     EXEC SQL                                                     10040000
100500          INCLUDE TOPERAT                                         10050000
100600     END-EXEC.                                                    10060000
100700                                                                  10070000
102200*----------------------------------------------------------------*10220000
102300*    DB2 DCLGEN FOR TPTKREQ TABLE                                 10230000
102400*----------------------------------------------------------------*10240000
102500     EXEC SQL                                                     10250000
102600          INCLUDE TPTKREQ                                         10260000
102700     END-EXEC.                                                    10270000
102800                                                                  10280000
102900*----------------------------------------------------------------*10290000
103000*    DB2 DCLGEN FOR TPTKLNE TABLE                                 10300000
103100*----------------------------------------------------------------*10310000
103200     EXEC SQL                                                     10320000
103300          INCLUDE TPTKLNE                                         10330000
103400     END-EXEC.                                                    10340000
103500                                                                  10350000
103600*----------------------------------------------------------------*10360000
103700*    DB2 DCLGEN FOR TTKTFMT TABLE                                 10370000
103800*----------------------------------------------------------------*10380000
103900     EXEC SQL                                                     10390000
104000          INCLUDE TTKTFMT                                         10400000
104100     END-EXEC.                                                    10410000
104200                                                                  10420001
104300*    DB2 DCLGEN FOR TRIP STATUS TABLE                             10430000
104400     EXEC SQL                                                     10440000
104500          INCLUDE TTRIPST                                         10450000
104600     END-EXEC.                                                    10460000
104700                                                                  10470001
104800*----------------------------------------------------------------*10480000
104900*    DB2 DCLGEN FOR TKRPRPM TABLE                                 10490000
105000*----------------------------------------------------------------*10500000
105100     EXEC SQL                                                     10510000
105200          INCLUDE TKRPRPM                                         10520000
105300     END-EXEC.                                                    10530000
105400                                                                  10540000
105500*---------------------------------------------------------------* 10550000
105600*    DB2 AREA FOR COMMUNICATIONS                                * 10560000
105700*---------------------------------------------------------------* 10570000
105800     EXEC SQL                                                     10580000
105900          INCLUDE SQLCA                                           10590000
106000     END-EXEC.                                                    10600000
106100                                                                  10610000
106200*---------------------------------------------------------------* 10620000
106300*  CURSOR TO LIST WORK ORDERS FOR PO/RCVR                      *  10630000
106400*---------------------------------------------------------------* 10640000
106500                                                                  10650000
106600     EXEC SQL                                                     10660000
106700          DECLARE LIST-CSR CURSOR                                 10670000
106800          FOR SELECT                                              10680000
106900                O.OPER_DESC                                       10690000
107000              , W.SCREEN_SEQ_NBR                                  10700000
107100              , W.FCLTY_AREA_ID                                   10710000
107200              , W.EXPTED_CART_CNT                                 10720000
107300              , W.ACTL_CART_CNT                                   10730000
107400              , W.STRT_TMST                                       10740000
107500              , W.STOP_TMST                                       10750000
107600              , W.WO_INSTR_SEQ_NBR                                10760000
107700              , W.LNE_LOC_CDE                                     10770000
107800          FROM  TOPERAT O                                         10780000
107900              , TWKORIN W                                         10790000
108000          WHERE                                                   10800000
108100                W.ORD_NBR          =  :ASC-PO-NBR                 10810000
108200            AND W.RCVR_SEQ_NBR     =  :ASC-RCVR-SEQ-NBR           10820000
108400            AND W.ORD_LNE_NBR      =  0                           10840000
108500            AND W.VER_STATUS_CDE   =  'A'                         10850000
108600            AND W.OPER_ID          =  O.OPER_ID                   10860000
108700          ORDER BY                                                10870000
108800                W.SCREEN_SEQ_NBR                                  10880000
108900     END-EXEC.                                                    10890000
109000                                                                  10900000
109100*---------------------------------------------------------------* 10910000
109200*    ZEROLINE UPDATE CURSOR.                                    * 10920000
109300*---------------------------------------------------------------* 10930000
109400     EXEC SQL                                                     10940000
109500          DECLARE ZEROLINE CURSOR                                 10950000
109600          FOR  SELECT                                             10960000
109700               ORD_NBR                                            10970000
109800              ,RCVR_SEQ_NBR                                       10980000
109900              ,ORD_LNE_NBR                                        10990000
110000              ,WORK_ORD_SEQ_NBR                                   11000000
110100              ,OPER_UNT_ID                                        11010000
110200              ,FCLTY_ID                                           11020000
110300              ,WO_INSTR_SEQ_NBR                                   11030000
110400              ,CRE_TMST                                           11040000
110500              ,VER_STATUS_CDE                                     11050000
110600              ,CRE_UID_ID                                         11060000
110700              ,OPER_ID                                            11070000
110800              ,FCLTY_AREA_ID                                      11080000
110900              ,PRC_FCLTY_AREA_ID                                  11090000
111000              ,EXPTED_CART_CNT                                    11100000
111100              ,ACTL_CART_CNT                                      11110000
111200              ,ALLOC_IND                                          11120000
111300              ,REPACK_IND                                         11130000
111400              ,STRT_TMST                                          11140000
111500              ,STOP_TMST                                          11150000
111600              ,SCREEN_SEQ_NBR                                     11160000
111700              ,LNE_LOC_CDE                                        11170000
111800              ,REC_SEL_IND                                        11180000
111900          FROM TWKORIN                                            11190000
112000          WHERE  ORD_NBR          =  :ASC-PO-NBR                  11200000
112100            AND  RCVR_SEQ_NBR     =  :ASC-RCVR-SEQ-NBR            11210000
112200            AND  ORD_LNE_NBR      =  0                            11220000
112500            AND  VER_STATUS_CDE   =  'A'                          11250000
112600            AND  STOP_TMST        >  :PV-DUMMY-TMST               11260000
112700          FOR UPDATE OF                                           11270000
112800               REC_SEL_IND                                        11280000
112900             , STOP_TMST                                          11290000
113000             , STRT_TMST                                          11300000
113100             , CRE_UID_ID                                         11310000
113200      END-EXEC.                                                   11320000
113300                                                                  11330000
113400*---------------------------------------------------------------* 11340000
113500*  CURSOR TO LIST COLUMNS FOR A OPERATION SET                   * 11350000
113600*---------------------------------------------------------------* 11360000
113700     EXEC SQL                                                     11370000
113800          DECLARE TOSOPFA-CSR CURSOR FOR                          11380000
113900           SELECT OPER_SET_ID                                     11390000
114000                 ,OPER_ID                                         11400000
114100                 ,OPER_UNT_ID                                     11410000
114200                 ,FCLTY_ID                                        11420000
114300                 ,FCLTY_AREA_ID                                   11430000
114400                 ,PRC_FCLTY_AREA_ID                               11440000
114500                 ,SCRN_SEQ_NBR                                    11450000
114600           FROM   TOSOPFA                                         11460000
114700           WHERE  OPER_SET_ID    = :DK-OPER-SET-ID                11470000
114800             AND  OPER_UNT_ID    = :ASC-OPER-UNT-ID               11480000
114900             AND  VER_STATUS_CDE = 'A'                            11490000
115000           ORDER BY SCRN_SEQ_NBR                                  11500000
115100     END-EXEC.                                                    11510000
115200                                                                  11520000
115300*---------------------------------------------------------------* 11530000
115400*  CURSOR TO RETRIEVE ITEM NUMBER FROM TRECITM                 *  11540000
115500*---------------------------------------------------------------* 11550000
115600     EXEC SQL                                                     11560000
115700          DECLARE TRECITM-CSR CURSOR FOR                          11570000
115800           SELECT ITM_NBR                                         11580000
115900           FROM   TRECITM                                         11590000
116000           WHERE  ORD_NBR        = :ASC-PO-NBR                    11600000
116100             AND  REC_SEQ_NBR    = :ASC-RCVR-SEQ-NBR              11610000
116200             AND  VER_STATUS_CDE = 'A'                            11620000
116300           ORDER BY ORD_LNE_NBR                                   11630000
116400     END-EXEC.                                                    11640000
116500                                                                  11650000
118700*-----------------------------------------------------------------11870000
118800 LINKAGE SECTION.                                                 11880000
118900*-----------------------------------------------------------------11890000
119000 01  DFHCOMMAREA.                                                 11900000
119100     05  FILLER                         OCCURS  1 TO 4072 TIMES   11910000
119200                                        DEPENDING ON EIBCALEN.    11920000
119300         10  FILLER                     PIC X.                    11930000
119400                                                                  11940000
119500*---------------------------------------------------------------* 11950000
119600 PROCEDURE DIVISION.                                              11960000
119700*---------------------------------------------------------------* 11970000
119800*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 11980000
119900*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 11990000
120000*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 12000000
120100*---------------------------------------------------------------* 12010000
120200 0000-MAIN-MODULE.                                                12020000
120300     INITIALIZE DP030-CICS-API-FIELDS.                            12030000
120400                                                                  12040000
120500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       12050000
120600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          12060000
120700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         12070000
120800                                                                  12080000
120900     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       12090000
121000                                                                  12100000
121100     MOVE LENGTH OF RC816AI        TO DP030-MAP-LENGTH (1).       12110000
121200     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     12120000
121300     PERFORM 0001-CALL-CICS-ARCH-API.                             12130000
121400                                                                  12140000
121500     PERFORM 1000-CONTROL-PROCESSING                              12150000
121600                                                                  12160000
121700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     12170000
121800     PERFORM 0001-CALL-CICS-ARCH-API.                             12180000
121900                                                                  12190000
122000*---------------------------------------------------------------* 12200000
122100*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 12210000
122200*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 12220000
122300*---------------------------------------------------------------* 12230000
122400 0001-CALL-CICS-ARCH-API.                                         12240000
122510     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      12251012
122600                                    DFHCOMMAREA                   12260012
122700                                    DP030-CICS-API-FIELDS         12270012
122800                                    DP020-STANDARD-COMMAREA       12280012
122900                                    RC816AI.                      12290012
123000                                                                  12300000
123100     IF DP030-RC-CALL-SUCCESSFUL OR                               12310000
123200        DP030-RC-APPL-ERROR                                       12320000
123300         CONTINUE                                                 12330000
123400     ELSE                                                         12340000
123500         SET DP013-NO-ROLLBACK                                    12350000
123600             DP013-XCTL-DISPLAY-RESTART                           12360000
123700             DP013-CICS-ABEND      TO TRUE                        12370000
123800         MOVE '0001-CALL-CICS-ARCH-API'                           12380000
123900                                   TO DP013-PARAGRAPH             12390000
123920         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O12392012
123930-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      12393012
124200         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      12420000
124300         PERFORM DP013-0000-PROCESS-ABEND                         12430000
124400     END-IF.                                                      12440000
124500                                                                  12450000
124600*----------------------------------------------------------------*12460000
124700* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *12470000
124800* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *12480000
124900*                                                                *12490000
125000* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *12500000
125100*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *12510000
125200*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *12520000
125300*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *12530000
125400*----------------------------------------------------------------*12540000
125500 1000-CONTROL-PROCESSING.                                         12550000
125600                                                                  12560000
125700     EVALUATE TRUE                                                12570000
125800         WHEN DP030-RC-APPL-ERROR                                 12580000
125900             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         12590000
126000             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                12600000
126100             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 12610000
126200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12620000
126300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12630000
126400                                                                  12640000
126500         WHEN DP020-NEXT-ACT-INITIAL                              12650000
126600             INITIALIZE ASC-SPECIFIC-COMMAREA                     12660000
126700             SET ASC-NO-CONFIRM TO TRUE                           12670000
126800             SET ASC-CLERK-NOT-UPDATED TO TRUE                    12680000
126900             SET ASC-ACTL-CRTNS-NOT-UPDATED TO TRUE               12690000
127000             MOVE EIBTRMID      TO ASC-LIST-TERM-ID               12700000
127100                                   ASC-SEL-TERM-ID                12710000
127200             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   12720000
127300                                           ASC-SEL-TASK-NUMBER    12730000
127400             MOVE PC-LIST-QUEUE-SEQ TO ASC-LIST-SEQ               12740000
127500             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 12750000
127600             PERFORM 1100-PROCESS-INTER-APPL-COMM                 12760000
127700             IF  PS-COMMAREA-NOT-VALID                            12770000
127800                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            12780000
127900             ELSE                                                 12790000
128000                 PERFORM 4000-BUILD-INITIAL-PANEL                 12800000
128100                 PERFORM 3600-SAVE-SCREEN-FIELDS                  12810000
128200             END-IF                                               12820000
128300                                                                  12830000
128400         WHEN DP020-NEXT-ACT-READ-MAP                             12840000
128500             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         12850000
128600             PERFORM 2000-PROCESS-PANEL                           12860000
128700                                                                  12870000
128800         WHEN DP020-NEXT-ACT-RETURN                               12880000
128900             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         12890000
129000             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    12900000
129100             PERFORM 2050-DELETE-LIST-QUEUE                       12910000
129200             PERFORM 4000-BUILD-INITIAL-PANEL                     12920000
129300             PERFORM 3600-SAVE-SCREEN-FIELDS                      12930000
129400                                                                  12940000
129500         WHEN OTHER                                               12950000
129600             SET DP013-LOGIC-ABEND TO TRUE                        12960000
129700             SET DP013-NO-ROLLBACK TO TRUE                        12970000
129800             MOVE '1000-CONTROL-PROCESSING'                       12980000
129900                                   TO DP013-PARAGRAPH             12990000
130000             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    13000000
130100                                   TO DP013-MESSAGE-TEXT(1)       13010000
130200             PERFORM DP013-0000-PROCESS-ABEND                     13020000
130300     END-EVALUATE.                                                13030000
130400                                                                  13040000
130500*----------------------------------------------------------------*13050000
130600* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA               *13060000
130700*----------------------------------------------------------------*13070000
130800 1100-PROCESS-INTER-APPL-COMM.                                    13080000
130900                                                                  13090000
131000     SET PS-COMMAREA-VALID         TO TRUE.                       13100000
131100     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     13110000
131200     EVALUATE TRUE                                                13120000
131300     WHEN DP020-INT-APPL-FORMAT-IND = PC-LIST-FORMAT              13130000
131400         IF  RC815-NUMBER-OF-SELECTED-ITEMS > ZERO                13140000
131500             SET ASC-USE-SELECTION-QUEUE TO TRUE                  13150000
131600             MOVE RC815-NUMBER-OF-SELECTED-ITEMS                  13160000
131700                                   TO ASC-NUMBER-OF-SELECTED-ITEMS13170000
131800             MOVE RC815-NUMBER-OF-TS-ITEMS                        13180000
131900                                   TO ASC-NUMBER-OF-TS-ITEMS      13190000
132000             MOVE RC815-SEL-QUEUE-NAME  TO ASC-SEL-QUEUE-NAME     13200000
132100             MOVE RC815-SCAC-CDE        TO ASC-SCAC               13210000
132200             MOVE RC815-TRLR-NBR        TO ASC-TRLR-NBR           13220000
132300             MOVE RC815-TRIP-ID         TO ASC-TRIP-ID            13230000
132400             PERFORM 1120-PREPARE-LIST-ENTRY                      13240000
132500         ELSE                                                     13250000
132600             MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER             13260000
132700             SET DP020-MSG-WARNING                                13270000
132800                 DP020-NEXT-ACT-APPL-ERROR TO TRUE                13280000
132900         END-IF                                                   13290000
133000     WHEN DP020-INT-APPL-FORMAT-IND = PC-SUSPEND-LIST-FORMAT      13300000
133100         IF  RC815-NUMBER-OF-SELECTED-ITEMS > ZERO                13310000
133200             SET ASC-USE-SELECTION-QUEUE TO TRUE                  13320000
133300             MOVE RC815-NUMBER-OF-SELECTED-ITEMS                  13330000
133400                                   TO ASC-NUMBER-OF-SELECTED-ITEMS13340000
133500             MOVE RC815-NUMBER-OF-TS-ITEMS                        13350000
133600                                   TO ASC-NUMBER-OF-TS-ITEMS      13360000
133700             MOVE RC815-SEL-QUEUE-NAME  TO ASC-PREV-SEL-QUEUE-NAME13370000
134100             PERFORM 1120A-PREPARE-LIST-ENTRY                     13410000
134200         ELSE                                                     13420000
134300             MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER             13430000
134400             SET DP020-MSG-WARNING                                13440000
134500                 DP020-NEXT-ACT-APPL-ERROR TO TRUE                13450000
134600         END-IF                                                   13460000
134700     END-EVALUATE.                                                13470000
134800                                                                  13480000
134900*----------------------------------------------------------------*13490000
135000*    ENTRY IS FROM A LIST.  GET THE RECEIVER NUMBER FROM THE     *13500000
135100*    TEMP STORAGE QUEUE PASSED FROM THE LIST.                    *13510000
135200*----------------------------------------------------------------*13520000
135300 1120-PREPARE-LIST-ENTRY.                                         13530000
135400                                                                  13540000
135500     MOVE RC816-MAX-ITEMS          TO ASC-SEL-SUB.                13550000
135600     MOVE ZERO                     TO ASC-SEL-ITEM.               13560000
135700     PERFORM 1130-GET-NEXT-RECORD.                                13570000
135800                                                                  13580000
135810*----------------------------------------------------------------*13581001
135811*                                                                *13581101
135820*----------------------------------------------------------------*13582001
135900 1120A-PREPARE-LIST-ENTRY.                                        13590000
136000                                                                  13600000
136100     MOVE RC817-MAX-ITEMS          TO ASC-SEL-SUB.                13610000
136200     MOVE ZERO                     TO ASC-SEL-ITEM.               13620000
136300     PERFORM 1130A-GET-NEXT-RECORD.                               13630000
136400                                                                  13640000
136500*----------------------------------------------------------------*13650000
136600*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*13660000
136700*----------------------------------------------------------------*13670000
136800 1130-GET-NEXT-RECORD.                                            13680000
136900                                                                  13690000
137000     ADD +1                        TO ASC-SEL-SUB.                13700000
137100     IF  ASC-SEL-SUB > RC816-MAX-ITEMS                            13710000
137200         ADD +1                    TO ASC-SEL-ITEM                13720000
137300         MOVE +1                   TO ASC-SEL-SUB                 13730000
137400     END-IF.                                                      13740000
137500                                                                  13750000
137600     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                13760000
137700         PERFORM 9100-READ-SEL-QUEUE                              13770000
137800         IF  RC816-ITEM (ASC-SEL-SUB) > ZERO                      13780000
137900             MOVE RC816-PO-NBR (ASC-SEL-SUB)    TO ASC-PO-NBR     13790000
138000             MOVE RC816-RCVR-NBR (ASC-SEL-SUB)                    13800000
138100                                  TO ASC-RCVR-SEQ-NBR             13810000
138200             MOVE RC816-VENDOR (ASC-SEL-SUB)    TO ASC-VENDOR     13820000
138300             MOVE RC816-PKG-CODE (ASC-SEL-SUB)  TO ASC-PACKAGE    13830000
138400             SET RC816-INQ (ASC-SEL-SUB)        TO TRUE           13840000
138500             PERFORM 9200-REWRITE-SEL-QUEUE                       13850000
138600         ELSE                                                     13860000
138700             SUBTRACT +1 FROM ASC-SEL-SUB                         13870000
138800*            --- BOTTOM OF LIST ---                               13880000
138900             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            13890000
139000             SET DP020-MSG-INFORMATIONAL                          13900000
139100                 PS-LIST-END           TO TRUE                    13910000
139200                                                                  13920000
139300         END-IF                                                   13930000
139400     ELSE                                                         13940000
139500         SUBTRACT +1 FROM ASC-SEL-ITEM                            13950000
139600         MOVE RC816-MAX-ITEMS      TO ASC-SEL-SUB                 13960000
139700         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            13970000
139800         SET DP020-MSG-INFORMATIONAL                              13980000
139900             PS-LIST-END           TO TRUE                        13990000
140000     END-IF.                                                      14000000
140100                                                                  14010000
140200 1130A-GET-NEXT-RECORD.                                           14020000
140300                                                                  14030000
140400     ADD +1                        TO ASC-SEL-SUB.                14040000
140500     IF  ASC-SEL-SUB > RC817-MAX-ITEMS                            14050000
140600         ADD +1                    TO ASC-SEL-ITEM                14060000
140700         MOVE +1                   TO ASC-SEL-SUB                 14070000
140800     END-IF.                                                      14080000
140900                                                                  14090000
141000     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                14100000
141100         PERFORM 9100A-READ-SEL-QUEUE                             14110000
141200         IF  RC817-ITEM (ASC-SEL-SUB) > ZERO                      14120000
141300             MOVE RC817-PO-NBR (ASC-SEL-SUB)    TO ASC-PO-NBR     14130000
141400             MOVE RC817-RCVR-NBR (ASC-SEL-SUB)                    14140000
141500                              TO ASC-RCVR-SEQ-NBR                 14150000
141600             MOVE RC817-VENDOR (ASC-SEL-SUB)    TO ASC-VENDOR     14160000
141700             MOVE RC817-PKG-CODE (ASC-SEL-SUB)  TO ASC-PACKAGE    14170000
141800             MOVE RC817-SCAC-CDE (ASC-SEL-SUB)  TO ASC-SCAC       14180000
141900             MOVE RC817-TRLR-NBR (ASC-SEL-SUB)  TO ASC-TRLR-NBR   14190000
142000             MOVE RC817-TRIP-ID (ASC-SEL-SUB)   TO ASC-TRIP-ID    14200000
142100             SET RC817-INQ (ASC-SEL-SUB)        TO TRUE           14210000
142200             PERFORM 9200A-REWRITE-SEL-QUEUE                      14220000
142300         ELSE                                                     14230000
142400             SUBTRACT +1 FROM ASC-SEL-SUB                         14240000
142500*            --- BOTTOM OF LIST ---                               14250000
142600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            14260000
142700             SET DP020-MSG-INFORMATIONAL                          14270000
142800                 PS-LIST-END           TO TRUE                    14280000
142900                                                                  14290000
143000         END-IF                                                   14300000
143100     ELSE                                                         14310000
143200         SUBTRACT +1 FROM ASC-SEL-ITEM                            14320000
143300         MOVE RC817-MAX-ITEMS      TO ASC-SEL-SUB                 14330000
143400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            14340000
143500         SET DP020-MSG-INFORMATIONAL                              14350000
143600             PS-LIST-END           TO TRUE                        14360000
143700     END-IF.                                                      14370000
143800                                                                  14380000
143900*----------------------------------------------------------------*14390000
144000*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *14400000
144100*    PROCESSED.                                                  *14410000
144200*----------------------------------------------------------------*14420000
144300 1140-GET-PREV-RECORD.                                            14430000
144400                                                                  14440000
144500     SUBTRACT +1 FROM ASC-SEL-SUB.                                14450000
144600                                                                  14460000
144700     IF  ASC-SEL-SUB < +1                                         14470000
144800         SUBTRACT +1 FROM ASC-SEL-ITEM                            14480000
144900         MOVE RC816-MAX-ITEMS     TO ASC-SEL-SUB                  14490000
145000     END-IF.                                                      14500000
145100                                                                  14510000
145200     IF  ASC-SEL-ITEM > ZERO                                      14520000
145300         PERFORM 9100-READ-SEL-QUEUE                              14530000
145400         MOVE RC816-PO-NBR(ASC-SEL-SUB)     TO ASC-PO-NBR         14540000
145500         MOVE RC816-RCVR-NBR(ASC-SEL-SUB)   TO ASC-RCVR-SEQ-NBR   14550000
145600         MOVE RC816-VENDOR (ASC-SEL-SUB)    TO ASC-VENDOR         14560000
145700         MOVE RC816-PKG-CODE (ASC-SEL-SUB)  TO ASC-PACKAGE        14570000
145800         SET RC816-INQ (ASC-SEL-SUB)        TO TRUE               14580000
145900         PERFORM 9200-REWRITE-SEL-QUEUE                           14590000
146000     ELSE                                                         14600000
146100         MOVE +1                  TO ASC-SEL-ITEM                 14610000
146200                                     ASC-SEL-SUB                  14620000
146300         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             14630000
146400         SET DP020-MSG-INFORMATIONAL                              14640000
146500             PS-LIST-END           TO TRUE                        14650000
146600     END-IF.                                                      14660000
146700                                                                  14670000
146800*----------------------------------------------------------------*14680000
146900* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *14690000
147000* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *14700000
147100* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *14710000
147200* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *14720000
147300* FUNCTION KEYS CAN GET THIS FAR.                                *14730000
147400*----------------------------------------------------------------*14740000
147500 2000-PROCESS-PANEL.                                              14750000
147600     SET ASC-CSR-CLEAR    TO TRUE                                 14760000
147700     EVALUATE TRUE                                                14770000
147800         WHEN DP020-SRC-AID = DP016-CLEAR                         14780000
147900             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    14790000
148000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   14800000
148100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14810000
148200*F5                                                               14820000
148300         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    14830000
148400             PERFORM 2050-DELETE-LIST-QUEUE                       14840000
148500             PERFORM 4000-BUILD-INITIAL-PANEL                     14850000
148600             PERFORM 3600-SAVE-SCREEN-FIELDS                      14860000
148700                                                                  14870000
148800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             14880000
148900             IF  ASC-USE-SELECTION-QUEUE                          14890000
149000                 IF DP020-INT-APPL-FORMAT-IND =                   14900000
149100                                         PC-SUSPEND-LIST-FORMAT   14910000
149200                     PERFORM 1130A-GET-NEXT-RECORD                14920000
149300                 ELSE                                             14930000
149400                     PERFORM 1130-GET-NEXT-RECORD                 14940000
149500                 END-IF                                           14950000
149600                 IF PS-LIST-END                                   14960000
149700                     MOVE SPACES TO ASC-PRESENTATION              14970000
149800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         14980000
149900                     SET PS-NO-LIST-END TO TRUE                   14990000
150000                 ELSE                                             15000000
150100                     MOVE SPACES TO ASC-PRESENTATION              15010000
150200                     PERFORM 2050-DELETE-LIST-QUEUE               15020000
150300                     PERFORM 3200-RESET-ATTRIBUTES                15030000
150400                     PERFORM 4000-BUILD-INITIAL-PANEL             15040000
150500                     PERFORM 3600-SAVE-SCREEN-FIELDS              15050000
150600                 END-IF                                           15060000
150700              ELSE                                                15070000
150800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15080000
150900*                --- BOTTOM OF LIST ---                           15090000
151000                 MOVE PC-TSYMSG-00070                             15100000
151100                                   TO DP020-MSG-NUMBER            15110000
151200                 SET DP020-MSG-INFORMATIONAL                      15120000
151300                                   TO TRUE                        15130000
151400             END-IF                                               15140000
151500                                                                  15150000
151600         WHEN OTHER                                               15160000
151700             IF DP020-FK-CONFIRM(DP020-SRC-AID) OR                15170000
151800                DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID) OR         15180000
151900                DP020-SRC-AID = DP016-ENTER                       15190000
152000                 CONTINUE                                         15200000
152100             ELSE                                                 15210000
152200                 PERFORM 3600-SAVE-SCREEN-FIELDS                  15220000
152300             END-IF                                               15230000
152400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 15240000
152500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   15250000
152600             IF  PS-NO-ERROR                                      15260000
152700                 SET DP030-CONTINUE-GO TO TRUE                    15270000
152800                 PERFORM 2100-CHECK-FUNCTION-KEY                  15280000
152900             ELSE                                                 15290000
153100                 SET DP030-OVERRIDE-GO TO TRUE                    15310000
153200             END-IF                                               15320000
153300     END-EVALUATE.                                                15330000
153400                                                                  15340000
153500*----------------------------------------------------------------*15350000
153600*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *15360000
153700*----------------------------------------------------------------*15370000
153800 2050-DELETE-LIST-QUEUE.                                          15380000
153900                                                                  15390000
154000     EXEC CICS                                                    15400000
154100         DELETEQ TS                                               15410000
154200           QUEUE (ASC-LIST-QUEUE-NAME)                            15420000
154300            RESP (PV-CICS-RESP)                                   15430000
154400     END-EXEC.                                                    15440000
154500                                                                  15450000
154600     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       15460000
154700        (PV-CICS-RESP = DFHRESP(QIDERR))                          15470000
154800         CONTINUE                                                 15480000
154900     ELSE                                                         15490000
155000         SET DP013-CICS-ABEND      TO TRUE                        15500000
155100         SET DP013-NO-ROLLBACK     TO TRUE                        15510000
155200                                                                  15520000
155300         MOVE '2050-DELETE-LIST-QUEUE'                            15530000
155400                                   TO DP013-PARAGRAPH             15540000
155500         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    15550000
155600                                   TO DP013-MESSAGE-TEXT (1)      15560000
155700         PERFORM DP013-0000-PROCESS-ABEND                         15570000
155800     END-IF.                                                      15580000
155900                                                                  15590000
156000     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  15600000
156100                                                                  15610000
156200*----------------------------------------------------------------*15620000
156300* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*15630000
156400* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *15640000
156500* CICS ARCHITECTURE API.                                         *15650000
156600*----------------------------------------------------------------*15660000
156700 2100-CHECK-FUNCTION-KEY.                                         15670000
156800                                                                  15680000
156900     EVALUATE TRUE                                                15690000
157000* F13 - TROUBLE LIST SCREEN                                       15700000
157100         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              15710000
157200             PERFORM 2106-GET-OPER-UNT-ID                         15720000
157300             INITIALIZE RC012-INTER-APPL-COMMAREA                 15730000
157400             MOVE ASC-PO-NBR          TO RC012-PO-NBR             15740000
157500             MOVE ASC-RCVR-SEQ-NBR    TO RC012-REC-SEQ-NBR        15750000
157600             MOVE RECEIV-OPER-UNT-ID  TO RC012-OPER-UNT-ID        15760000
157700             MOVE ASC-FCLTY-ID        TO RC012-FCLTY-ID           15770000
157800                                                                  15780000
157900* F14 - SPECIAL INSTRUCTION SCREEN                                15790000
158000         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              15800000
158100             INITIALIZE PO017-INTER-APPL-COMMAREA                 15810000
158200             MOVE ASC-PO-NBR TO PO017-PO-NBR                      15820000
158300                                                                  15830000
158400* F15 - UPDATE RECEIVER                                           15840000
158500         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              15850000
158600             IF ASC-RECEIVER-ARRIVED                              15860000
158700                 PERFORM 2800-CHECK-UPDT-FIELDS                   15870000
158800                 IF PS-NO-ERROR                                   15880000
158900                     IF  ASC-ACT-CNT-ZERO-F15-CONFIRM             15890000
159000                         MOVE PC-TSYMSG-03019  TO DP020-MSG-NUMBER15900000
159100                         SET DP020-MSG-WARNING TO TRUE            15910000
159200                         SET DP030-OVERRIDE-GO TO TRUE            15920000
159300                     ELSE                                         15930000
159400                         PERFORM 2810-UPDTE-CHGD-FIELDS           15940000
159500                         PERFORM 2050-DELETE-LIST-QUEUE           15950000
159700                         SET ASC-CSR-LOC-1     TO TRUE            15970000
159800                         PERFORM 4000-BUILD-INITIAL-PANEL         15980000
159900                         PERFORM 3200-RESET-ATTRIBUTES            15990000
160000                         SET DP020-MSG-INFORMATIONAL TO TRUE      16000000
160100                         MOVE PC-TSYMSG-00059  TO DP020-MSG-NUMBER16010000
160200                         SET DP030-SET-CURSOR-APPL-1 TO TRUE      16020000
160300                     END-IF                                       16030000
160400                 ELSE                                             16040000
160600                     PERFORM 4401-CURSOR-POSITION                 16060000
160700                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          16070000
160800                 END-IF                                           16080000
160900             ELSE                                                 16090000
161000                 MOVE PC-TSYMSG-01057  TO DP020-MSG-NUMBER        16100000
161100                 SET DP020-MSG-WARNING TO TRUE                    16110000
161200                 SET DP030-OVERRIDE-GO TO TRUE                    16120000
161300             END-IF                                               16130000
161400                                                                  16140000
161500* F16 - VERIFY PACK                                               16150000
161600         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              16160000
161700             IF ASC-PKGNG-CDE = 'M' OR                            16170000
161800                ASC-PKGNG-CDE = 'I'                               16180000
161900                 PERFORM 2106-GET-OPER-UNT-ID                     16190000
162000                 INITIALIZE RC012-INTER-APPL-COMMAREA             16200000
162100                 MOVE ASC-PO-NBR          TO RC012-PO-NBR         16210000
162200                 MOVE ASC-RCVR-SEQ-NBR    TO RC012-REC-SEQ-NBR    16220000
162300                 MOVE RECEIV-OPER-UNT-ID  TO RC012-OPER-UNT-ID    16230000
162400                 MOVE ASC-FCLTY-ID        TO RC012-FCLTY-ID       16240000
162500                 MOVE ZERO                TO RC012-PO-LNE-NBR     16250000
162600                 PERFORM 2107-SELECT-FACILITY                     16260000
162700             ELSE                                                 16270000
162800                 MOVE PC-TSYMSG-03086  TO DP020-MSG-NUMBER        16280000
162900                 SET DP020-MSG-WARNING TO TRUE                    16290000
163000                 SET DP030-OVERRIDE-GO TO TRUE                    16300000
163100             END-IF                                               16310000
163200                                                                  16320000
163300* F17 - CONFIRM LINE                                              16330000
163400         WHEN DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)               16340000
163500             IF ASC-RECEIVER-ARRIVED                              16350000
163600                 IF ASC-OPER-SET-X  = SPACES                      16360000
163700                     SET PS-ERROR                                 16370000
163800                     DP020-MSG-FATAL             TO TRUE          16380000
163900                     MOVE PC-TSYMSG-02977      TO DP020-MSG-NUMBER16390000
164000                     MOVE DP015-PRO-NOR-OFF      TO AOPERA        16400000
164100                     MOVE DP015-BLUE             TO AOPERC        16410000
164200                     MOVE DP015-REVERSE          TO AOPERH        16420000
164400                     SET ASC-CSR-OPERSET   TO TRUE                16440000
164500                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          16450000
164600                     SET DP030-OVERRIDE-GO       TO TRUE          16460000
164700                 ELSE                                             16470000
164800                     IF ASC-PACK-BY-ST                            16480000
164900                         MOVE PC-TSYMSG-01803  TO DP020-MSG-NUMBER16490000
165000                         MOVE -1               TO MR-SELECTL(1)   16500000
165100                         SET DP030-SET-CURSOR-APPL-1 TO TRUE      16510000
165200                         SET DP020-MSG-FATAL         TO TRUE      16520000
165300                         SET PS-ERROR                TO TRUE      16530000
165400                         SET DP030-OVERRIDE-GO       TO TRUE      16540000
165500                     ELSE                                         16550000
167100                             IF ASC-ACT-CRTN-CNT = ZEROES         16710000
167200                                 SET ASC-ACT-CNT-ZERO-F17-CONFIRM 16720000
167300                                                           TO TRUE16730000
167400                                 MOVE PC-TSYMSG-03019 TO          16740000
167500                                                  DP020-MSG-NUMBER16750000
167600                                 SET DP020-MSG-WARNING TO TRUE    16760000
167700                                 SET DP030-OVERRIDE-GO TO TRUE    16770000
167800                             ELSE                                 16780000
167900                                PERFORM 2106-GET-OPER-UNT-ID      16790000
168000                              INITIALIZE RC015-INTER-APPL-COMMAREA16800000
168100                                 MOVE RECEIV-OPER-UNT-ID TO       16810000
168200                                                 RC015-OPER-UNT-ID16820000
168300                                 MOVE ASC-FCLTY-ID  TO            16830000
168400                                                    RC015-FCLTY-ID16840000
168500                                 MOVE ASC-PO-NBR TO RC015-PO-NBR  16850000
168600                                 MOVE ASC-RCVR-SEQ-NBR TO         16860000
168700                                                 RC015-REC-SEQ-NBR16870000
168800                             END-IF                               16880000
168900                     END-IF                                       16890000
169000                 END-IF                                           16900000
169100             ELSE                                                 16910000
169200                 MOVE PC-TSYMSG-01057  TO DP020-MSG-NUMBER        16920000
169300                 SET DP020-MSG-WARNING TO TRUE                    16930000
169400                 SET DP030-OVERRIDE-GO TO TRUE                    16940000
169500             END-IF                                               16950000
169600                                                                  16960000
169700* F18 - HOT COMPLETE                                              16970000
169800         WHEN DP020-FK-LOCAL-FUNC-06(DP020-SRC-AID)               16980000
169900             IF ASC-RECEIVER-ARRIVED                              16990000
170000                 IF ASC-WRKORD-STATUS = 'CM'                      17000000
170100                     SET DP030-OVERRIDE-GO TO TRUE                17010000
170200                     SET PS-ERROR          TO TRUE                17020000
170300                     MOVE PC-TSYMSG-00910  TO DP020-MSG-NUMBER    17030000
170400                     SET DP020-MSG-FATAL   TO TRUE                17040000
170500                 ELSE                                             17050000
170600                     IF  ASC-LINE-NBR NOT = ZERO                  17060000
170700                         SET DP030-OVERRIDE-GO TO TRUE            17070000
170800                         MOVE PC-TSYMSG-00908  TO DP020-MSG-NUMBER17080000
170900                         SET DP020-MSG-FATAL   TO TRUE            17090000
171000                         SET PS-ERROR          TO TRUE            17100000
171100                     ELSE                                         17110000
171200                         IF  ASC-NUMBER-OF-SELECTED-ITEMS = ZERO  17120000
171300                             SET DP030-OVERRIDE-GO TO TRUE        17130000
171400                             MOVE PC-TSYMSG-00057  TO             17140000
171500                                                  DP020-MSG-NUMBER17150000
171600                             SET DP020-MSG-WARNING TO TRUE        17160000
171700                             SET PS-ERROR          TO TRUE        17170000
171800                         ELSE                                     17180000
171900***   PRESS F2 TO CONFIRM REQUEST                                 17190000
172000                             SET ASC-HOT-COMPL-CONFIRM TO TRUE    17200000
172100                             MOVE PC-TSYMSG-00004  TO             17210000
172200                                                  DP020-MSG-NUMBER17220000
172300                             SET DP020-MSG-WARNING TO TRUE        17230000
172400                             SET DP030-OVERRIDE-GO TO TRUE        17240000
172500                        END-IF                                    17250000
172600                    END-IF                                        17260000
172700                END-IF                                            17270000
172800             ELSE                                                 17280000
172900                 MOVE PC-TSYMSG-01057  TO DP020-MSG-NUMBER        17290000
173000                 SET DP020-MSG-WARNING TO TRUE                    17300000
173100                 SET DP030-OVERRIDE-GO TO TRUE                    17310000
173200             END-IF                                               17320000
173300                                                                  17330000
173400* F19 - VERIFY LINE                                               17340000
173500         WHEN DP020-FK-LOCAL-FUNC-11(DP020-SRC-AID)               17350000
173600             IF ASC-PKGNG-CDE = 'M' OR                            17360000
173700                ASC-PKGNG-CDE = 'I'                               17370000
173800                 MOVE PC-TSYMSG-03085  TO DP020-MSG-NUMBER        17380000
173900                 SET DP020-MSG-WARNING TO TRUE                    17390000
174000                 SET DP030-OVERRIDE-GO TO TRUE                    17400000
174100             ELSE                                                 17410000
174200             PERFORM 2105-CHECK-FREIGHT-BILL                      17420000
174300             IF PS-NO-FREIGHT-BILL                                17430000
174400                 SET PS-ERROR                                     17440000
174500                     DP020-MSG-FATAL         TO TRUE              17450000
174600                 MOVE PC-TSYMSG-01058  TO DP020-MSG-NUMBER        17460000
174700                 SET DP030-OVERRIDE-GO       TO TRUE              17470000
174800             ELSE                                                 17480000
174900                 IF ASC-RECEIVER-ARRIVED                          17490000
175000                     IF ASC-OPER-SET-X  = SPACES                  17500000
175100                         SET PS-ERROR                             17510000
175200                         DP020-MSG-FATAL             TO TRUE      17520000
175300                         MOVE PC-TSYMSG-02977 TO  DP020-MSG-NUMBER17530000
175400                         MOVE DP015-PRO-NOR-OFF      TO AOPERA    17540000
175500                         MOVE DP015-BLUE             TO AOPERC    17550000
175600                         MOVE DP015-REVERSE          TO AOPERH    17560000
175800                         SET ASC-CSR-OPERSET   TO TRUE            17580000
175900                         SET DP030-SET-CURSOR-APPL-1 TO TRUE      17590000
176000                         SET DP030-OVERRIDE-GO       TO TRUE      17600000
176100                     ELSE                                         17610000
177600                             IF ASC-ACT-CRTN-CNT = ZEROES         17760000
177700                                 SET ASC-ACT-CNT-ZERO-F19-CONFIRM 17770000
177800                                                           TO TRUE17780000
177900                                 MOVE PC-TSYMSG-03019 TO          17790000
178000                                                  DP020-MSG-NUMBER17800000
178100                                 SET DP020-MSG-WARNING TO TRUE    17810000
178200                                 SET DP030-OVERRIDE-GO TO TRUE    17820000
178300                             ELSE                                 17830000
178400                                  PERFORM 2106-GET-OPER-UNT-ID    17840000
178500                                  INITIALIZE                      17850000
178600                                         RC012-INTER-APPL-COMMAREA17860000
178700                                 MOVE RECEIV-OPER-UNT-ID TO       17870000
178800                                                 RC012-OPER-UNT-ID17880000
178900                                 MOVE ASC-FCLTY-ID  TO            17890000
179000                                                    RC012-FCLTY-ID17900000
179100                                 MOVE ASC-PO-NBR   TO RC012-PO-NBR17910000
179200                                 MOVE ASC-RCVR-SEQ-NBR TO         17920000
179300                                                 RC012-REC-SEQ-NBR17930000
179400                                 MOVE ASC-PACK-BY-ST-IND TO       17940000
179500                                               RC012-PACK-BY-ST-SW17950000
179600                             END-IF                               17960000
179700*                        END-IF                                   17970000
179800                     END-IF                                       17980000
179900                 ELSE                                             17990000
180000                     MOVE PC-TSYMSG-01057  TO DP020-MSG-NUMBER    18000000
180100                     SET DP020-MSG-WARNING TO TRUE                18010000
180200                     SET DP030-OVERRIDE-GO TO TRUE                18020000
180300                 END-IF                                           18030000
180400             END-IF                                               18040000
180500             END-IF                                               18050000
180600                                                                  18060000
180700* F21 - START A WORK ORDER                                        18070000
180800         WHEN DP020-FK-LOCAL-FUNC-07(DP020-SRC-AID)               18080000
180900             IF ASC-RECEIVER-ARRIVED                              18090000
181000                 IF ASC-STATUS = 'VE'                             18100000
181100                     SET DP030-OVERRIDE-GO TO TRUE                18110000
181200                     MOVE PC-TSYMSG-00910  TO DP020-MSG-NUMBER    18120000
181300                     SET DP020-MSG-FATAL   TO TRUE                18130000
181400                 ELSE                                             18140000
181500                     IF WKORIN-ORD-LNE-NBR = ZERO                 18150000
181600                         SET PS-ZERO-LEVEL-WO-COMPLETE TO TRUE    18160000
181700                     ELSE                                         18170000
181800                         SET PS-ZERO-LEVEL-WO-NOT-COMPLETE TO TRUE18180000
181900                     END-IF                                       18190000
182000                     IF PS-ZERO-LEVEL-WO-COMPLETE                 18200000
182100                         COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +   18210000
182200                                          ASC-ITEMS-DISPLAYED - 1 18220000
182300                         PERFORM 2500-PROCESS-START               18230000
182400                     ELSE                                         18240000
182500                         SET DP030-OVERRIDE-GO TO TRUE            18250000
182600                         MOVE PC-TSYMSG-00810  TO DP020-MSG-NUMBER18260000
182700                         SET DP020-MSG-FATAL   TO TRUE            18270000
182800                     END-IF                                       18280000
182900                 END-IF                                           18290000
183000             ELSE                                                 18300000
183100                 MOVE PC-TSYMSG-01057  TO DP020-MSG-NUMBER        18310000
183200                 SET DP020-MSG-WARNING TO TRUE                    18320000
183300                 SET DP030-OVERRIDE-GO TO TRUE                    18330000
183400             END-IF                                               18340000
183500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18350000
183600                                                                  18360000
183700* F22 - RESTART A WORK ORDER                                      18370000
183800         WHEN DP020-FK-LOCAL-FUNC-08(DP020-SRC-AID)               18380000
183900         WHEN DP020-FK-CONFIRM(DP020-SRC-AID)                     18390000
184000             IF ASC-RECEIVER-ARRIVED                              18400000
184100                 IF ASC-NO-CONFIRM OR ASC-RESTRT-WO-CONFIRM       18410000
184200                      COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +      18420000
184300                                          ASC-ITEMS-DISPLAYED - 1 18430000
184400                      PERFORM 2600-PROCESS-RESTART                18440000
184600                 ELSE                                             18460000
184700                     IF ASC-HOT-COMPL-CONFIRM                     18470000
184800                         MOVE 18   TO DP020-SRC-AID               18480000
184900                         MOVE 'T'  TO DP020-FK-ACTION             18490000
185000                                                  (DP020-SRC-AID) 18500000
185100                         MOVE '1'  TO DP020-INT-APPL-FORMAT-IND   18510000
185200                         MOVE ASC-PO-NBR      TO  PC000-PO-NBR-N  18520000
185300                         MOVE ASC-RCVR-SEQ-NBR                    18530000
185400                                           TO  PC000-REC-SEQ-NBR-N18540000
185500                       MOVE ASC-WORK-ORD-SEQ-NBR TO PC000-WO-NBR-N18550000
185600                         MOVE ASC-FCLTY-ID  TO  PC000-FACILITY-ID 18560000
185700                         MOVE ASC-NUMBER-OF-SELECTED-ITEMS        18570000
185800                                           TO PC017-SELECTED-ITEMS18580000
185900                         PERFORM 5001-PREPARE-SEL-QUEUE           18590000
186000                         IF PS-ERROR                              18600000
186100                             SET DP030-OVERRIDE-GO TO TRUE        18610000
186200                             SET DP020-MSG-FATAL   TO TRUE        18620000
186300                         ELSE                                     18630000
186400                             PERFORM 2700-GET-MAX-WO-INSTR        18640000
186500                             IF  PV-WORK-ORD-INSTR-MAX =          18650000
186600                                     PV-WORK-ORD-INSTR-SELECTED   18660000
186700                                 AND PV-WORK-ORD-INSTR-MAX-START >18670000
186800                                                            SPACES18680000
186900                                    CONTINUE                      18690000
187000                             ELSE                                 18700000
187100                                 MOVE PC-TSYMSG-00909  TO         18710000
187200                                                  DP020-MSG-NUMBER18720000
187300                                 SET DP020-MSG-FATAL              18730000
187400                                     DP030-OVERRIDE-GO TO TRUE    18740000
187500                             END-IF                               18750000
187600                         END-IF                                   18760000
187700                     ELSE                                         18770000
187800                         IF ASC-ACT-CNT-ZERO-F17-CONFIRM          18780000
187900                             MOVE 17   TO DP020-SRC-AID           18790000
188000                             MOVE 'S'  TO                         18800000
188100                                   DP020-FK-ACTION (DP020-SRC-AID)18810000
188200                            MOVE '2'  TO DP020-INT-APPL-FORMAT-IND18820000
188300                            PERFORM 2106-GET-OPER-UNT-ID          18830000
188400                            INITIALIZE RC015-INTER-APPL-COMMAREA  18840000
188500                            MOVE RECEIV-OPER-UNT-ID TO            18850000
188600                                                 RC015-OPER-UNT-ID18860000
188700                            MOVE ASC-FCLTY-ID TO RC015-FCLTY-ID   18870000
188800                            MOVE ASC-PO-NBR   TO RC015-PO-NBR     18880000
188900                            MOVE ASC-RCVR-SEQ-NBR                 18890000
189000                                          TO RC015-REC-SEQ-NBR    18900000
189100                         ELSE                                     18910000
189200                             IF ASC-ACT-CNT-ZERO-F19-CONFIRM      18920000
189300                                 MOVE 19   TO DP020-SRC-AID       18930000
189400                                 MOVE 'U'  TO                     18940000
189500                                   DP020-FK-ACTION (DP020-SRC-AID)18950000
189600                             MOVE '2' TO DP020-INT-APPL-FORMAT-IND18960000
189700                             PERFORM 2106-GET-OPER-UNT-ID         18970000
189800                             INITIALIZE  RC012-INTER-APPL-COMMAREA18980000
189900                             MOVE RECEIV-OPER-UNT-ID TO           18990000
190000                                                 RC012-OPER-UNT-ID19000000
190100                               MOVE ASC-FCLTY-ID TO RC012-FCLTY-ID19010000
190200                                 MOVE ASC-PO-NBR  TO RC012-PO-NBR 19020000
190300                            MOVE ASC-RCVR-SEQ-NBR                 19030000
190400                                           TO RC012-REC-SEQ-NBR   19040000
190500                                 MOVE ASC-PACK-BY-ST-IND TO       19050000
190600                                               RC012-PACK-BY-ST-SW19060000
190700                             ELSE                                 19070000
190800                                 IF ASC-ACT-CNT-ZERO-F15-CONFIRM  19080000
190900                                    PERFORM 2810-UPDTE-CHGD-FIELDS19090000
191000                                  PERFORM 4000-BUILD-INITIAL-PANEL19100000
191100                                    PERFORM 3200-RESET-ATTRIBUTES 19110000
191200                                    PERFORM 5002-PREPARE-SEL-QUEUE19120000
191300                                    SET DP020-MSG-INFORMATIONAL TO19130000
191400                                                              TRUE19140000
191500                                     MOVE PC-TSYMSG-00059 TO      19150000
191600                                                  DP020-MSG-NUMBER19160000
191800                                    SET ASC-CSR-OPERSET   TO TRUE 19180000
191900                                    SET DP030-SET-CURSOR-APPL-1 TO19190000
192000                                                              TRUE19200000
192100                                 END-IF                           19210000
192200                             END-IF                               19220000
192300                         END-IF                                   19230000
192400                     END-IF                                       19240000
192500                     SET ASC-NO-CONFIRM TO TRUE                   19250000
192600                 END-IF                                           19260000
192700             ELSE                                                 19270000
192800                 MOVE PC-TSYMSG-01057  TO DP020-MSG-NUMBER        19280000
192900                 SET DP020-MSG-WARNING TO TRUE                    19290000
193000                 SET DP030-OVERRIDE-GO TO TRUE                    19300000
193100             END-IF                                               19310000
193200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 19320000
193300                                                                  19330000
193400* F23 - ADD WORK ORDER                                            19340000
193500         WHEN DP020-FK-LOCAL-FUNC-09(DP020-SRC-AID)               19350000
193600             IF ASC-RECEIVER-ARRIVED                              19360000
193700                  IF  ASC-WRKORD-STATUS = 'CM'                    19370000
193800                      SET DP030-OVERRIDE-GO TO TRUE               19380000
193900                      MOVE PC-TSYMSG-00910  TO DP020-MSG-NUMBER   19390000
194000                      SET DP020-MSG-FATAL   TO TRUE               19400000
194100                  ELSE                                            19410000
194200                      IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO     19420000
194300                          MOVE ASC-NUMBER-OF-SELECTED-ITEMS       19430000
194400                                           TO PC017-SELECTED-ITEMS19440000
194500                          PERFORM 5001-PREPARE-SEL-QUEUE          19450000
194600                          PERFORM 4400-MOVE-COMMAREA-TO-SCREEN    19460000
194700                          IF  PS-ERROR                            19470000
194800                              SET DP030-OVERRIDE-GO  TO TRUE      19480000
194900                              SET DP020-MSG-FATAL    TO TRUE      19490000
195000                          END-IF                                  19500000
195100                      ELSE                                        19510000
195200                          SET DP030-OVERRIDE-GO    TO TRUE        19520000
195300                          MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER19530000
195400                          SET DP020-MSG-WARNING    TO TRUE        19540000
195500                      END-IF                                      19550000
195600                  END-IF                                          19560000
195700             ELSE                                                 19570000
195800                 MOVE PC-TSYMSG-01057  TO DP020-MSG-NUMBER        19580000
195900                 SET DP020-MSG-WARNING TO TRUE                    19590000
196000                 SET DP030-OVERRIDE-GO TO TRUE                    19600000
196100             END-IF                                               19610000
196200                                                                  19620000
196300* F24 - UPDATE WORK ORDER'S LOC CODE                              19630000
196400         WHEN DP020-FK-LOCAL-FUNC-10(DP020-SRC-AID)               19640000
196500             IF ASC-RECEIVER-ARRIVED                              19650000
196600                 IF  ASC-WRKORD-STATUS = 'CM'                     19660000
196700                      SET DP030-OVERRIDE-GO TO TRUE               19670000
196800                      MOVE PC-TSYMSG-00910  TO DP020-MSG-NUMBER   19680000
196900                      SET DP020-MSG-FATAL   TO TRUE               19690000
197000                      SET PS-ERROR          TO TRUE               19700000
197100                  ELSE                                            19710000
197200                      IF  ASC-NUMBER-OF-SELECTED-ITEMS = ZERO     19720000
197300                          SET DP030-OVERRIDE-GO    TO TRUE        19730000
197400                          MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER19740000
197500                          SET DP020-MSG-WARNING    TO TRUE        19750000
197600                          SET PS-ERROR             TO TRUE        19760000
197700                      ELSE                                        19770000
197800                          IF PS-NO-ERROR                          19780000
197900                              PERFORM 5000-PREPARE-SEL-QUEUE      19790000
198000                              PERFORM 3200-RESET-ATTRIBUTES       19800000
198100                              PERFORM 4401-CURSOR-POSITION        19810000
198200                          ELSE                                    19820000
198300                               SET PS-ERROR          TO TRUE      19830000
198400                               MOVE PC-TSYMSG-00924 TO            19840000
198500                                                  DP020-MSG-NUMBER19850000
198600                              SET DP020-MSG-FATAL   TO TRUE       19860000
198700                              SET DP030-OVERRIDE-GO TO TRUE       19870000
198800                          END-IF                                  19880000
198900                      END-IF                                      19890000
199000                  END-IF                                          19900000
199100             ELSE                                                 19910000
199200                 MOVE PC-TSYMSG-01057  TO DP020-MSG-NUMBER        19920000
199300                 SET DP020-MSG-WARNING TO TRUE                    19930000
199400                 SET DP030-OVERRIDE-GO TO TRUE                    19940000
199500             END-IF                                               19950000
199600                                                                  19960000
199700*                                                                 19970000
199800* F6 - FIRST PAGE                                                 19980000
199900         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  19990000
200000             MOVE +1               TO PV-TOP-ITEM                 20000000
200100             PERFORM 3200-RESET-ATTRIBUTES                        20010000
200200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 20020000
200300                                                                  20030000
200400*                                                                 20040000
200500* F7 - PREVIOUS PAGE                                              20050000
200600         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   20060000
200700             PERFORM 2110-BROWSE-BACKWARD                         20070000
200800             PERFORM 3200-RESET-ATTRIBUTES                        20080000
200900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 20090000
201000                                                                  20100000
201100*                                                                 20110000
201200* F8 - NEXT PAGE                                                  20120000
201300         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   20130000
201400             PERFORM 2120-BROWSE-FORWARD                          20140000
201500             PERFORM 3200-RESET-ATTRIBUTES                        20150000
201600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 20160000
201700                                                                  20170000
201800*                                                                 20180000
201900* ENTER KEY                                                       20190000
202000         WHEN DP020-SRC-AID = DP016-ENTER                         20200000
202100                                                                  20210000
202200* DMH - 10/09/03 BEGIN                                            20220000
202300* DMH        CONTINUE                                             20230000
202400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 20240000
202500* DMH - 10/09/03 END                                              20250000
202600                                                                  20260000
203400         WHEN OTHER                                               20340000
203500             MOVE PC-TSYMSG-00045  TO DP020-MSG-NUMBER            20350000
203600             SET DP020-MSG-WARNING TO TRUE                        20360000
203700             SET DP030-OVERRIDE-GO TO TRUE                        20370000
204600     END-EVALUATE.                                                20460000
204700                                                                  20470000
204800*----------------------------------------------------------------*20480000
204900*    ENSURE THAT A FREIGHT BILL EXISTS FOR THIS PO/RCVR.          20490000
205000*----------------------------------------------------------------*20500000
205100 2105-CHECK-FREIGHT-BILL.                                         20510000
205200     MOVE ZERO   TO PV-FREIGHT-COUNT                              20520000
205300                                                                  20530000
205400     EXEC SQL                                                     20540000
205700         SELECT B.PO_NBR                                          20570000
205800         INTO  :SHPTPO-PO-NBR                                     20580000
205900         FROM TSHIPMT A                                           20590000
206000         ,    TSHPTPO B                                           20600000
206100         WHERE B.PO_NBR      = :ASC-PO-NBR                        20610000
206200           AND B.REC_SEQ_NBR = :ASC-RCVR-SEQ-NBR                  20620000
206300           AND A.SHIPT_ID    = B.SHIPT_ID                         20630000
206400           AND A.PRO_NBR    <> ' '                                20640000
206500         FETCH FIRST 1 ROW ONLY                                   20650000
206600     END-EXEC                                                     20660000
206700                                                                  20670000
206800     EVALUATE TRUE                                                20680000
206900         WHEN SQLCODE = ZERO                                      20690000
206910         WHEN SQLCODE = -811                                      20691000
206970             SET PS-FREIGHT-BILL-EXISTS  TO TRUE                  20697000
206980         WHEN SQLCODE = +100                                      20698000
206990                 SET PS-NO-FREIGHT-BILL      TO TRUE              20699000
207000         WHEN SQLCODE = -904                                      20700000
207100         WHEN SQLCODE = -911                                      20710000
207200         WHEN SQLCODE = -913                                      20720000
207300              PERFORM 9900A-SOFT-ABORT                            20730000
207400         WHEN SQLWARN0 NOT = SPACE                                20740000
207500         WHEN SQLCODE NOT = ZERO                                  20750000
207600              MOVE '2105-CHECK-FREIGHT-BILL'   TO DP013-PARAGRAPH 20760000
207700              MOVE 'CHECK FOR FREIGHT BILL '                      20770000
207800                                   TO DP013-MESSAGE-TEXT (1)      20780000
207900              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 20790000
208000              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               20800000
208100              MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID        20810000
208200              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      20820000
208300              MOVE SQLCA           TO DP013-SQLCA                 20830000
208400              MOVE 'TSHIPMT '      TO DP013-DB2-TABLE-NAME (1)    20840000
208500              SET DP013-DB2-ABEND  TO TRUE                        20850000
208600              PERFORM DP013-0000-PROCESS-ABEND                    20860000
208700     END-EVALUATE.                                                20870000
208800                                                                  20880000
208900*----------------------------------------------------------------*20890000
209000*    RETRIEVE OPER UNIT ID FOR F19 KEY                            20900000
209100*----------------------------------------------------------------*20910000
209200 2106-GET-OPER-UNT-ID.                                            20920000
209300     MOVE ZERO   TO PV-FREIGHT-COUNT                              20930000
209400                                                                  20940000
209500     EXEC SQL                                                     20950000
209600         SELECT OPER_UNT_ID                                       20960000
209700         INTO :RECEIV-OPER-UNT-ID                                 20970000
209800         FROM TRECEIV                                             20980000
209900         WHERE ORD_NBR         = :ASC-PO-NBR                      20990000
210000           AND REC_SEQ_NBR     = :ASC-RCVR-SEQ-NBR                21000000
210100           AND VER_STATUS_CDE  =  'A'                             21010000
210200     END-EXEC                                                     21020000
210300                                                                  21030000
210400     EVALUATE TRUE                                                21040000
210500         WHEN SQLCODE = ZERO                                      21050000
210600             CONTINUE                                             21060000
210700         WHEN SQLCODE = +100                                      21070000
210800         WHEN SQLCODE = -904                                      21080000
210900         WHEN SQLCODE = -911                                      21090000
211000         WHEN SQLCODE = -913                                      21100000
211100              PERFORM 9900A-SOFT-ABORT                            21110000
211200         WHEN SQLWARN0 NOT = SPACE                                21120000
211300         WHEN SQLCODE NOT = ZERO                                  21130000
211400              MOVE '2106-GET-OPER-UNT-ID'   TO DP013-PARAGRAPH    21140000
211500              MOVE 'FOR PF19 KEY'  TO DP013-MESSAGE-TEXT (1)      21150000
211600              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 21160000
211700              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               21170000
211800              MOVE RECEIV-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID     21180000
211900              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      21190000
212000              MOVE SQLCA           TO DP013-SQLCA                 21200000
212100              MOVE 'TRECEIV '      TO DP013-DB2-TABLE-NAME (1)    21210000
212200              SET DP013-DB2-ABEND  TO TRUE                        21220000
212300              PERFORM DP013-0000-PROCESS-ABEND                    21230000
212400     END-EVALUATE.                                                21240000
212410                                                                  21241001
212420                                                                  21242001
212500***************************************************************   21250000
212600* GET FACILITY NAME                                               21260000
212700* LOCATION HIERARCY DOMAIN TABLE XL00010 REPLACES TFACLTY TABLE   21270000
212800***************************************************************   21280000
212900 2107-SELECT-FACILITY.                                            21290000
213000                                                                  21300000
213100     MOVE ASC-OPER-UNT-ID         TO  DK-OPER-SET-ID.             21310000
213200                                                                  21320000
213300     INITIALIZE XL071-COMMAREA-REC.                               21330000
213400     MOVE DK-OPER-SET-ID  TO XL071-LOCATION-NUMBER.               21340000
213500                                                                  21350000
213600     CALL XL071-LOCATION-MODULE USING                             21360000
213700                                    DFHEIBLK                      21370000
213800                                    XL071-COMMAREA                21380000
213900                                    XL071-COMMAREA-REC.           21390000
214000                                                                  21400000
214100     EVALUATE TRUE                                                21410000
214200         WHEN XL071-NO-ERRORS                                     21420000
214300                 MOVE XL071-LOC-NM                                21430000
214400                                   TO RC012-FCLTY-NME             21440000
214500         WHEN XL071-LOC-NOT-FOUND                                 21450000
214600                 MOVE 'FACILITY NAME NOT FOUND' TO                21460000
214700                                  XL071-LOC-NM                    21470000
214800         WHEN OTHER                                               21480000
214900              INITIALIZE PV-CICS-MSG-AREA                         21490000
215000              STRING ' RCKCS816 - CALL XLKUT071 -'                21500000
215100                     ' SQLCODE=' XL071-SQLCODE                    21510000
215200                     ' TABLE='   XL071-DB2-TABLE                  21520000
215300                                              DELIMITED BY SIZE   21530000
215400                                         INTO PV-CICS-MSG-AREA    21540000
215500              PERFORM 9900-WRITE-CICS-LOG                         21550000
215600                                                                  21560000
215700              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              21570000
215800              PERFORM 9900A-SOFT-ABORT                            21580000
215900     END-EVALUATE.                                                21590000
216000                                                                  21600000
216100 2108-GET-BEFORE-PRICE-CHG-DAYS.                                  21610000
216200      EXEC SQL                                                    21620000
216300          SELECT FUNC_QTY                                         21630000
216400            INTO  :PV-PPCBEF-QTY                                  21640000
216500            FROM TKRPRPM                                          21650000
216600           WHERE SYS_PRC_FUNC_CDE = 'PPCBEF'                      21660000
216700             AND LOC_ID           =  90                           21670000
216800             AND INTFC_SYS_CDE    = 'KHL'                         21680000
216900             WITH UR                                              21690000
217000      END-EXEC.                                                   21700000
217100                                                                  21710000
217200      EVALUATE TRUE                                               21720000
217300          WHEN SQLCODE = +0                                       21730000
217400*TEST ONLY    DISPLAY 'PARM PPCBEF VALUE = ' PV-PPCBEF-QTY        21740000
217500              CONTINUE                                            21750000
217600          WHEN SQLCODE = +100                                     21760000
217700              CONTINUE                                            21770000
217800          WHEN OTHER                                              21780000
217900              SET PS-ERROR    TO TRUE                             21790000
218000              MOVE '2108-GET-BEFORE-PRICE-CHG-DAYS'               21800000
218100                  TO DP013-PARAGRAPH                              21810000
218200              MOVE 'CHECKING PARM TABLE' TO DP013-MESSAGE-TEXT (1)21820000
218300              MOVE SQLCA   TO DP013-SQLCA                         21830000
218400              MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)         21840000
218500              SET DP013-DB2-ABEND                                 21850000
218600                  DP013-XCTL-DISPLAY-RESTART TO TRUE              21860000
218700              PERFORM DP013-0000-PROCESS-ABEND                    21870000
218800      END-EVALUATE.                                               21880000
218900                                                                  21890000
219000 2109-GET-AFTER-PRICE-CHG-DAYS.                                   21900000
219100      EXEC SQL                                                    21910000
219200          SELECT FUNC_QTY                                         21920000
219300            INTO  :PV-PPCAFT-QTY                                  21930000
219400            FROM TKRPRPM                                          21940000
219500           WHERE SYS_PRC_FUNC_CDE = 'PPCAFT'                      21950000
219600             AND LOC_ID           =  90                           21960000
219700             AND INTFC_SYS_CDE    = 'KHL'                         21970000
219800             WITH UR                                              21980000
219900      END-EXEC.                                                   21990000
220000                                                                  22000000
220100      EVALUATE TRUE                                               22010000
220200          WHEN SQLCODE = +0                                       22020000
220300*TEST ONLY    DISPLAY 'PARM PPCAFT VALUE = ' PV-PPCAFT-QTY        22030000
220400              CONTINUE                                            22040000
220500          WHEN SQLCODE = +100                                     22050000
220600              CONTINUE                                            22060000
220700          WHEN OTHER                                              22070000
220800              SET PS-ERROR    TO TRUE                             22080000
220900              MOVE '2109-GET-AFTER-PRICE-CHG-DAYS'                22090000
221000                  TO DP013-PARAGRAPH                              22100000
221100              MOVE 'CHECKING PARM TABLE' TO DP013-MESSAGE-TEXT (1)22110000
221200              MOVE SQLCA   TO DP013-SQLCA                         22120000
221300              MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)         22130000
221400              SET DP013-DB2-ABEND                                 22140000
221500                  DP013-XCTL-DISPLAY-RESTART TO TRUE              22150000
221600              PERFORM DP013-0000-PROCESS-ABEND                    22160000
221700      END-EVALUATE.                                               22170000
221800                                                                  22180000
221900*                                                                 22190000
222000*----------------------------------------------------------------*22200000
222100*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *22210000
222200*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *22220000
222300*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *22230000
222400*    MESSAGE.                                                    *22240000
222500*----------------------------------------------------------------*22250000
222600 2110-BROWSE-BACKWARD.                                            22260000
222700                                                                  22270000
222800     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    22280000
222900         GIVING PV-TOP-ITEM.                                      22290000
223000                                                                  22300000
223100     IF  ((PV-TOP-ITEM < +1)                                      22310000
223200       OR (PV-TOP-ITEM = +1))                                     22320000
223300         MOVE +1                   TO PV-TOP-ITEM                 22330000
223400*        -- TOP OF LIST --                                        22340000
223500         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            22350000
223600         SET DP020-MSG-INFORMATIONAL                              22360000
223700                                   TO TRUE                        22370000
223800     END-IF.                                                      22380000
223900                                                                  22390000
224000*----------------------------------------------------------------*22400000
224100*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *22410000
224200*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *22420000
224300*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *22430000
224400*----------------------------------------------------------------*22440000
224500 2120-BROWSE-FORWARD.                                             22450000
224600                                                                  22460000
224700     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              22470000
224800         GIVING PV-TOP-ITEM.                                      22480000
224900                                                                  22490000
225000     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   22500000
225100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            22510000
225200                                   TO PV-TOP-ITEM                 22520000
225300*        -- BOTTOM OF LIST --                                     22530000
225400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            22540000
225500         SET DP020-MSG-INFORMATIONAL                              22550000
225600                                   TO TRUE                        22560000
225700     ELSE                                                         22570000
225800         COMPUTE PV-BOTTOM-ITEM =                                 22580000
225900             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 22590000
226000         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            22600000
226100*            -- BOTTOM OF LIST --                                 22610000
226200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            22620000
226300             SET DP020-MSG-INFORMATIONAL                          22630000
226400                                   TO TRUE                        22640000
226500         END-IF                                                   22650000
226600     END-IF.                                                      22660000
226700                                                                  22670000
226800*----------------------------------------------------------------*22680000
226900*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *22690000
227000*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *22700000
227100*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *22710000
227200*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *22720000
227300*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *22730000
227400*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *22740000
227500*----------------------------------------------------------------*22750000
227600 2130-CHECK-FOR-JUMP-BROWSE.                                      22760000
227700                                                                  22770000
227800     SET PS-NO-ERROR               TO TRUE.                       22780000
227900     IF (ASC-START-ITEM-REQUEST = SPACE)                          22790000
228000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            22800000
228100                                   TO PV-TOP-ITEM                 22810000
228200     ELSE                                                         22820000
228300         MOVE ASC-START-ITEM-REQUEST                              22830000
228400                                   TO DP010I-UNEDITED-FIELD       22840000
228500         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       22850000
228600         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     22860000
228700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  22870000
228810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         22881011
228820              USING DP010I-NUMERIC-EDIT-AREA                      22882011
228900                                                                  22890000
229000         IF  NOT DP010I-ERROR-DETECTED                            22900000
229100             MOVE DP010I-NUMERIC-FIELD                            22910000
229200                                   TO ASC-START-ITEM-REQUEST-N    22920000
229300             IF  ASC-START-ITEM-REQUEST-N > ZERO                  22930000
229400                 IF  ASC-START-ITEM-REQUEST-N >                   22940000
229500                                          ASC-NUMBER-OF-ITEMS-READ22950000
229600                     MOVE SPACE TO ASC-START-ITEM-REQUEST         22960000
229700                     COMPUTE PV-TOP-ITEM =                        22970000
229800                             ASC-NUMBER-OF-ITEMS-READ             22980000
229900                             - PC-ITEMS-PER-PANEL + 1             22990000
230000                     IF  PV-TOP-ITEM < +1                         23000000
230100                         MOVE +1   TO PV-TOP-ITEM                 23010000
230200                         MOVE PC-TSYMSG-00070                     23020000
230300                                   TO DP020-MSG-NUMBER            23030000
230400                         SET DP020-MSG-INFORMATIONAL              23040000
230500                                   TO TRUE                        23050000
230600                     ELSE                                         23060000
230700                         MOVE  PV-TOP-ITEM                        23070000
230800                           TO  ASC-START-ITEM-REQUEST-N           23080000
230900                     END-IF                                       23090000
231000                 ELSE                                             23100000
231100                     MOVE ASC-START-ITEM-REQUEST-N                23110000
231200                                   TO PV-TOP-ITEM                 23120000
231300                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      23130000
231400                     COMPUTE PV-BOTTOM-ITEM =                     23140000
231500                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     23150000
231600                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ23160000
231700                         SUBTRACT  PV-TOP-ITEM                    23170000
231800                             FROM  ASC-NUMBER-OF-ITEMS-READ       23180000
231900                           GIVING  ASC-ITEMS-DISPLAYED            23190000
232000                         MOVE  ASC-NUMBER-OF-ITEMS-READ           23200000
232100                           TO  PV-BOTTOM-ITEM                     23210000
232200*                        -- BOTTOM OF LIST --                     23220000
232300                         MOVE PC-TSYMSG-00070                     23230000
232400                                   TO DP020-MSG-NUMBER            23240000
232500                         SET DP020-MSG-INFORMATIONAL  TO TRUE     23250000
232600                     END-IF                                       23260000
232700                 END-IF                                           23270000
232800             ELSE                                                 23280000
232900*                --- VALUE OUT OF RANGE ----                      23290000
233000                 MOVE PC-TSYMSG-00101                             23300000
233100                                   TO DP020-MSG-NUMBER            23310000
233300                 SET ASC-CSR-START-ITEM TO TRUE                   23330000
233400                 SET DP030-SET-CURSOR-APPL-1                      23340000
233500                                   TO TRUE                        23350000
233600                 MOVE DP015-REVERSE TO ASTRTITH                   23360000
233700                 MOVE DP015-RED     TO ASTRTITC                   23370000
233800                 MOVE DP015-UNP-NUM-BRT-MDT                       23380000
233900                                   TO ASTRTITA                    23390000
234000                 SET DP020-MSG-FATAL TO TRUE                      23400000
234100                 SET PS-ERROR        TO TRUE                      23410000
234200             END-IF                                               23420000
234300                                                                  23430000
234400         ELSE                                                     23440000
234500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            23450000
234700             SET ASC-CSR-START-ITEM TO TRUE                       23470000
234800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  23480000
234900             MOVE DP015-REVERSE    TO ASTRTITH                    23490000
235000             MOVE DP015-RED        TO ASTRTITC                    23500000
235100             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               23510000
235200             SET DP020-MSG-FATAL   TO TRUE                        23520000
235300             SET PS-ERROR          TO TRUE                        23530000
235400         END-IF                                                   23540000
235500     END-IF.                                                      23550000
235600                                                                  23560000
235700*----------------------------------------------------------------*23570000
235800*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *23580000
235900*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *23590000
236000*----------------------------------------------------------------*23600000
236100 2140-DESELECT-ALL-ITEMS.                                         23610000
236200                                                                  23620000
236300     MOVE +1                       TO ASC-BLK-SUB.                23630000
236400                                                                  23640000
236500     PERFORM 2141-CLEAR-SELECTED-INDS                             23650000
236600         VARYING ASC-ITEM-SUB                                     23660000
236700         FROM 1 BY 1                                              23670000
236800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23680000
236900                                                                  23690000
237000     ADD +1                        TO ASC-BLK-SUB.                23700000
237100                                                                  23710000
237200     PERFORM 2141-CLEAR-SELECTED-INDS                             23720000
237300         VARYING ASC-ITEM-SUB                                     23730000
237400         FROM 1 BY 1                                              23740000
237500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23750000
237600                                                                  23760000
237700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               23770000
237800                                   TO PV-LIST-ITEM-NUMBER.        23780000
237900                                                                  23790000
238000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            23800000
238100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    23810000
238200                                                                  23820000
238300     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     23830000
238400        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      23840000
238500         MOVE +1                   TO ASC-BLK-SUB                 23850000
238600                                                                  23860000
238700         PERFORM 5100-WRITE-TEMP-STORAGE                          23870000
238800                                                                  23880000
238900         MOVE +1                   TO PV-BLOCK-NUMBER             23890000
239000                                                                  23900000
239100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         23910000
239200             PV-FIRST-BLOCK-IN-ARRAY - 1                          23920000
239300                                                                  23930000
239400         PERFORM                                                  23940000
239500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       23950000
239600                                                                  23960000
239700             PERFORM 4410-READ-TEMP-STORAGE                       23970000
239800                                                                  23980000
239900             PERFORM 2141-CLEAR-SELECTED-INDS                     23990000
240000                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 24000000
240100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24010000
240200                                                                  24020000
240300             PERFORM 5100-WRITE-TEMP-STORAGE                      24030000
240400                                                                  24040000
240500             ADD +1                TO PV-BLOCK-NUMBER             24050000
240600                                                                  24060000
240700         END-PERFORM                                              24070000
240800                                                                  24080000
240900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         24090000
241000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     24100000
241100                                                                  24110000
241200         PERFORM                                                  24120000
241300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       24130000
241400                   ASC-HIGHEST-BLOCK-WRITTEN                      24140000
241500                                                                  24150000
241600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          24160000
241700                                   TO PV-BLOCK-NUMBER             24170000
241800                                                                  24180000
241900             PERFORM 4410-READ-TEMP-STORAGE                       24190000
242000                                                                  24200000
242100             PERFORM 2141-CLEAR-SELECTED-INDS                     24210000
242200                 VARYING ASC-ITEM-SUB                             24220000
242300                 FROM 1 BY 1                                      24230000
242400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24240000
242500                                                                  24250000
242600             PERFORM 5100-WRITE-TEMP-STORAGE                      24260000
242700                                                                  24270000
242800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      24280000
242900                                                                  24290000
243000         END-PERFORM                                              24300000
243100                                                                  24310000
243200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             24320000
243300                                   TO PV-BLOCK-NUMBER             24330000
243400                                                                  24340000
243500         PERFORM 4410-READ-TEMP-STORAGE                           24350000
243600     END-IF.                                                      24360000
243700                                                                  24370000
243800                                                                  24380000
243900     MOVE +0                      TO ASC-NUMBER-OF-SELECTED-ITEMS.24390000
244000     MOVE +0                      TO ASC-START-OF-SELECTED-RANGE. 24400000
244100     MOVE +0                      TO ASC-END-OF-SELECTED-RANGE.   24410000
244200                                                                  24420000
244300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        24430000
244400                                                                  24440000
244500*----------------------------------------------------------------*24450000
244600*    MARK EACH ITEM AS BEING NOT SELECTED.                       *24460000
244700*----------------------------------------------------------------*24470000
244800 2141-CLEAR-SELECTED-INDS.                                        24480000
244900                                                                  24490000
245000     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          24500000
245100             NOT EQUAL ZERO                                       24510000
245200         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          24520000
245300             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          24530000
245400                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    24540000
245500                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  24550000
245600                                   TO TRUE                        24560000
245700         END-IF                                                   24570000
245800     END-IF.                                                      24580000
245900                                                                  24590000
246000*----------------------------------------------------------------*24600000
246100*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *24610000
246200*  FOR ALL ITEMS.                                                *24620000
246300*----------------------------------------------------------------*24630000
246400 2150-SELECT-ALL-ITEMS.                                           24640000
246500                                                                  24650000
246600     MOVE +1                       TO ASC-BLK-SUB.                24660000
246700                                                                  24670000
246800     PERFORM 2151-SET-SELECTED-INDS                               24680000
246900         VARYING ASC-ITEM-SUB                                     24690000
247000         FROM 1 BY 1                                              24700000
247100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 24710000
247200                                                                  24720000
247300     ADD +1                        TO ASC-BLK-SUB.                24730000
247400                                                                  24740000
247500     PERFORM 2151-SET-SELECTED-INDS                               24750000
247600         VARYING ASC-ITEM-SUB                                     24760000
247700         FROM 1 BY 1                                              24770000
247800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 24780000
247900                                                                  24790000
248000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               24800000
248100                                   TO PV-LIST-ITEM-NUMBER.        24810000
248200                                                                  24820000
248300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            24830000
248400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    24840000
248500                                                                  24850000
248600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     24860000
248700        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    24870000
248800         MOVE +1                   TO ASC-BLK-SUB                 24880000
248900                                                                  24890000
249000         PERFORM 5100-WRITE-TEMP-STORAGE                          24900000
249100                                                                  24910000
249200         MOVE +1                   TO PV-BLOCK-NUMBER             24920000
249300                                                                  24930000
249400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         24940000
249500             PV-FIRST-BLOCK-IN-ARRAY - 1                          24950000
249600                                                                  24960000
249700         PERFORM                                                  24970000
249800             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       24980000
249900                                                                  24990000
250000             PERFORM 4410-READ-TEMP-STORAGE                       25000000
250100                                                                  25010000
250200             PERFORM 2151-SET-SELECTED-INDS                       25020000
250300                 VARYING ASC-ITEM-SUB                             25030000
250400                 FROM 1 BY 1                                      25040000
250500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          25050000
250600                                                                  25060000
250700             PERFORM 5100-WRITE-TEMP-STORAGE                      25070000
250800                                                                  25080000
250900             ADD +1                TO PV-BLOCK-NUMBER             25090000
251000         END-PERFORM                                              25100000
251100                                                                  25110000
251200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         25120000
251300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     25130000
251400                                                                  25140000
251500         PERFORM                                                  25150000
251600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       25160000
251700                   ASC-HIGHEST-BLOCK-WRITTEN                      25170000
251800                                                                  25180000
251900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          25190000
252000                                   TO PV-BLOCK-NUMBER             25200000
252100                                                                  25210000
252200             PERFORM 4410-READ-TEMP-STORAGE                       25220000
252300                                                                  25230000
252400             PERFORM 2151-SET-SELECTED-INDS                       25240000
252500                 VARYING ASC-ITEM-SUB                             25250000
252600                 FROM 1 BY 1                                      25260000
252700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          25270000
252800                                                                  25280000
252900             PERFORM 5100-WRITE-TEMP-STORAGE                      25290000
253000                                                                  25300000
253100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      25310000
253200         END-PERFORM                                              25320000
253300                                                                  25330000
253400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             25340000
253500                                   TO PV-BLOCK-NUMBER             25350000
253600                                                                  25360000
253700         PERFORM 4410-READ-TEMP-STORAGE                           25370000
253800     END-IF.                                                      25380000
253900                                                                  25390000
254000     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             25400000
254100          ASC-NUMBER-OF-SELECTED-ITEMS.                           25410000
254200                                                                  25420000
254300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        25430000
254400                                                                  25440000
254500*----------------------------------------------------------------*25450000
254600*    MARK EACH ITEM AS BEING SELECTED.                           *25460000
254700*----------------------------------------------------------------*25470000
254800 2151-SET-SELECTED-INDS.                                          25480000
254900                                                                  25490000
255000     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           25500000
255100             NOT EQUAL ZERO                                       25510000
255200         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             25520000
255300             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             25530000
255400                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        25540000
255500                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  25550000
255600                                   TO TRUE                        25560000
255700         END-IF                                                   25570000
255800     END-IF.                                                      25580000
255900                                                                  25590000
256000*----------------------------------------------------------------*25600000
256100*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *25610000
256200*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *25620000
256300*----------------------------------------------------------------*25630000
256400 2200-MOVE-SCREEN-TO-COMMAREA.                                    25640000
256500                                                                  25650000
256600     IF  AOPERL > ZERO                                            25660000
256700         MOVE AOPERI              TO ASC-OPER-SET-X               25670000
256800     ELSE                                                         25680000
256900         IF  AOPERF = DP015-ERASE-EOF                             25690000
257000             MOVE SPACES           TO ASC-OPER-SET-X              25700000
257100         END-IF                                                   25710000
257200     END-IF.                                                      25720000
257300                                                                  25730000
257400     IF  ARCVCLKL > ZERO                                          25740000
257500         MOVE ARCVCLKI              TO ASC-CLERK                  25750000
257600     ELSE                                                         25760000
257700         IF  ARCVCLKF  = DP015-ERASE-EOF                          25770000
257800             MOVE SPACES           TO ASC-CLERK                   25780000
257900         END-IF                                                   25790000
258000     END-IF.                                                      25800000
258100                                                                  25810000
258200     IF  AACTCTNL > ZERO                                          25820000
258300         MOVE AACTCTNI             TO ASC-ACT-CRTN-CNT-X          25830000
258400     ELSE                                                         25840000
258500         IF  AACTCTNF = DP015-ERASE-EOF                           25850000
258600             MOVE SPACES           TO ASC-ACT-CRTN-CNT-X          25860000
258700         END-IF                                                   25870000
258800     END-IF.                                                      25880000
258900                                                                  25890000
259000     IF  ADMGCTNL > ZERO                                          25900000
259100         MOVE ADMGCTNI             TO ASC-DMG-CRTN-CNT-X          25910000
259200     ELSE                                                         25920000
259300         IF  ADMGCTNF = DP015-ERASE-EOF                           25930000
259400             MOVE SPACES           TO ASC-DMG-CRTN-CNT-X          25940000
259500         END-IF                                                   25950000
259600     END-IF.                                                      25960000
259700                                                                  25970000
259800     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             25980000
259900     MOVE +1                       TO PV-SUB.                     25990000
260000                                                                  26000000
260100     PERFORM 3100-SET-SUBSCRIPTS.                                 26010000
260200                                                                  26020000
260300     IF  ASTRTITL > ZERO                                          26030000
260400         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      26040000
260500     ELSE                                                         26050000
260600         IF  ASTRTITF = DP015-ERASE-EOF                           26060000
260700             INITIALIZE ASC-START-ITEM-REQUEST                    26070000
260800         END-IF                                                   26080000
260900     END-IF.                                                      26090000
261000                                                                  26100000
261100     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          26110000
261200         VARYING PV-SUB                                           26120000
261300         FROM 1 BY 1                                              26130000
261400         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      26140000
261500                                                                  26150000
261600*----------------------------------------------------------------*26160000
261700*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *26170000
261800*----------------------------------------------------------------*26180000
261900 2210-MOVE-LINES-TO-COMMAREA.                                     26190000
262000                                                                  26200000
262100     IF  MR-SELECTL (PV-SUB) > ZERO                               26210000
262200         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             26220000
262300         MOVE MR-SELECT  (PV-SUB)   TO ASC-TEMP-SELECTED-SW       26230000
262400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      26240000
262500     ELSE                                                         26250000
262600         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                26260000
262700             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         26270000
262800             MOVE SPACE            TO ASC-TEMP-SELECTED-SW        26280000
262900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      26290000
263000         END-IF                                                   26300000
263100     END-IF.                                                      26310000
263200                                                                  26320000
263300     IF  MR-LOC-CODEL (PV-SUB) > ZERO                             26330000
263400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)  TO TRUE            26340000
263500         MOVE MR-LOC-CODE (PV-SUB)   TO ASC-LOC-CODE              26350000
263600                                       (ASC-BLK-SUB, ASC-ITEM-SUB)26360000
263700     ELSE                                                         26370000
263800         IF MR-LOC-CODEA (PV-SUB) = DP015-ERASE-EOF               26380000
263900             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         26390000
264000             MOVE SPACE TO ASC-LOC-CODE(ASC-BLK-SUB, ASC-ITEM-SUB)26400000
264100         END-IF                                                   26410000
264200     END-IF.                                                      26420000
264300                                                                  26430000
264400     ADD +1                        TO ASC-ITEM-SUB.               26440000
264500                                                                  26450000
264600     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        26460000
264700         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     26470000
264800             COMPUTE PV-BLOCK-NUMBER  =                           26480000
264900                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         26490000
265000                    PC-ITEMS-PER-PANEL                            26500000
265100             PERFORM 5105-REWRITE-ASC-LISTQ                       26510000
265200         END-IF                                                   26520000
265300         ADD +1                    TO ASC-BLK-SUB                 26530000
265400         MOVE +1                   TO ASC-ITEM-SUB                26540000
265500         IF ASC-BLK-SUB  > PC-MAX-BLOCKS-IN-ARRAY                 26550000
265600             MOVE +1                   TO ASC-BLK-SUB             26560000
265700             INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)           26570000
265800             IF PV-BLOCK-NUMBER = 0                               26580000
265900                COMPUTE PV-BLOCK-NUMBER  =                        26590000
266000                   1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /      26600000
266100                       PC-ITEMS-PER-PANEL                         26610000
266200             END-IF                                               26620000
266300             PERFORM 4410-READ-TEMP-STORAGE                       26630000
266400         END-IF                                                   26640000
266500     ELSE                                                         26650000
266600     IF  PV-SUB = ASC-ITEMS-DISPLAYED                             26660000
266700         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     26670000
266800             COMPUTE PV-BLOCK-NUMBER  =                           26680000
266900                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         26690000
267000                    PC-ITEMS-PER-PANEL                            26700000
267100             PERFORM 5105-REWRITE-ASC-LISTQ                       26710000
267200         END-IF                                                   26720000
267300     END-IF.                                                      26730000
267400                                                                  26740000
267500*----------------------------------------------------------------*26750000
267600*  UPDATE THE WORK ORDER WITH THE NEW OPER SET ID                *26760000
267700*----------------------------------------------------------------*26770000
267800 2300-UPDATE-TWRKORD.                                             26780000
267900                                                                  26790000
268000     EXEC SQL                                                     26800000
268100       UPDATE TWRKORD                                             26810000
268200          SET OPER_SET_ID    = :WRKORD-OPER-SET-ID                26820000
268300       WHERE  ORD_NBR        = :ASC-PO-NBR                        26830000
268400         AND  RCVR_SEQ_NBR   = :ASC-RCVR-SEQ-NBR                  26840000
268600         AND  VER_STATUS_CDE = 'A'                                26860000
268700     END-EXEC                                                     26870000
268800                                                                  26880000
268900     EVALUATE TRUE                                                26890000
269000         WHEN SQLCODE = +0                                        26900000
269100         WHEN SQLCODE = -904                                      26910000
269200         WHEN SQLCODE = -913                                      26920000
269300             CONTINUE                                             26930000
269400                                                                  26940000
269500         WHEN SQLWARN0 NOT = SPACES                               26950000
269600         WHEN SQLCODE < +0                                        26960000
269700         WHEN SQLCODE > +0                                        26970000
269800             MOVE '2300-UPDATE-TWRKORD' TO DP013-PARAGRAPH        26980000
269900             MOVE 'UPDATE OPER SET ID ON TWRKORD'                 26990000
270000                                  TO DP013-MESSAGE-TEXT(1)        27000000
270100             MOVE ASC-PO-NBR      TO PV-ERROR-PO                  27010000
270200             MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ                27020000
270300             MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)       27030000
270400             MOVE SQLCA           TO DP013-SQLCA                  27040000
270500             MOVE 'TWRKORD'       TO DP013-DB2-TABLE-NAME (1)     27050000
270600             SET DP013-DB2-ABEND                                  27060000
270700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               27070000
270800             PERFORM DP013-0000-PROCESS-ABEND                     27080000
270900     END-EVALUATE.                                                27090000
271000                                                                  27100000
271100*----------------------------------------------------------------*27110000
271200*  DELETE ALL THE ZERO LINE NUMBER WORK ORDER INSTRUCTIONS       *27120000
271300*----------------------------------------------------------------*27130000
271400 2350-DELETE-TWKORIN.                                             27140000
271500                                                                  27150000
271600     EXEC SQL                                                     27160000
271700       DELETE FROM TWKORIN                                        27170000
271800       WHERE  ORD_NBR          = :ASC-PO-NBR                      27180000
271900         AND  RCVR_SEQ_NBR     = :ASC-RCVR-SEQ-NBR                27190000
272100         AND  ORD_LNE_NBR      = 0                                27210000
272200         AND  WORK_ORD_SEQ_NBR = 1                                27220000
272300     END-EXEC.                                                    27230000
272400                                                                  27240000
272500     EVALUATE TRUE                                                27250000
272600         WHEN SQLCODE = +0                                        27260000
272700         WHEN SQLCODE = +100                                      27270000
272800         WHEN SQLCODE = -904                                      27280000
272900         WHEN SQLCODE = -913                                      27290000
273000             CONTINUE                                             27300000
273100                                                                  27310000
273200         WHEN SQLWARN0 NOT = SPACES                               27320000
273300         WHEN SQLCODE < +0                                        27330000
273400         WHEN SQLCODE > +0                                        27340000
273500             MOVE '2350-DELETE-TWKORIN' TO DP013-PARAGRAPH        27350000
273600             MOVE 'DELETE ZERO LINE NBR WORK ORDER INSTR '        27360000
273700                                          TO DP013-MESSAGE-TEXT(1)27370000
273800             MOVE ASC-PO-NBR      TO PV-ERROR-PO                  27380000
273900             MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ                27390000
274000             MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)       27400000
274100             MOVE SQLCA           TO DP013-SQLCA                  27410000
274200             MOVE 'TWKORIN'       TO DP013-DB2-TABLE-NAME (1)     27420000
274300             SET DP013-DB2-ABEND                                  27430000
274400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               27440000
274500             PERFORM DP013-0000-PROCESS-ABEND                     27450000
274600     END-EVALUATE.                                                27460000
274700                                                                  27470000
274800*----------------------------------------------------------------*27480000
274900* OPEN THE TOSOPFA CURSOR                                        *27490000
275000*----------------------------------------------------------------*27500000
275100 2360-OPEN-TOSOPFA-CSR.                                           27510000
275200                                                                  27520000
275300     EXEC SQL                                                     27530000
275400          OPEN TOSOPFA-CSR                                        27540000
275500     END-EXEC.                                                    27550000
275600                                                                  27560000
275700     EVALUATE TRUE                                                27570000
275800         WHEN SQLCODE = +0                                        27580000
275900         WHEN SQLCODE = -904                                      27590000
276000         WHEN SQLCODE = -913                                      27600000
276100              CONTINUE                                            27610000
276200         WHEN SQLWARN0 NOT = SPACE                                27620000
276300         WHEN SQLCODE  NOT = +0                                   27630000
276400              MOVE '2360-OPEN-TOSOPFA-CSR' TO DP013-PARAGRAPH     27640000
276500              MOVE 'OPEN TOSOPFA CURSOR'                          27650000
276600                                   TO DP013-MESSAGE-TEXT (1)      27660000
276700              MOVE SQLCA       TO DP013-SQLCA                     27670000
276800              MOVE 'TOSOPFA'   TO DP013-DB2-TABLE-NAME (1)        27680000
276900              SET DP013-DB2-ABEND  TO TRUE                        27690000
277000              PERFORM DP013-0000-PROCESS-ABEND                    27700000
277100     END-EVALUATE.                                                27710000
277200                                                                  27720000
277300*----------------------------------------------------------------*27730000
277400*    FETCH A TOSOPFA ROW                                         *27740000
277500*----------------------------------------------------------------*27750000
277600 2365-FETCH-TOSOPFA-CSR.                                          27760000
277700                                                                  27770000
277800     EXEC SQL                                                     27780000
277900          FETCH TOSOPFA-CSR                                       27790000
278000          INTO :OSOPFA-OPER-SET-ID                                27800000
278100              ,:OSOPFA-OPER-ID                                    27810000
278200              ,:OSOPFA-OPER-UNT-ID                                27820000
278300              ,:OSOPFA-FCLTY-ID                                   27830000
278400              ,:OSOPFA-FCLTY-AREA-ID                              27840000
278500              ,:OSOPFA-PRC-FCLTY-AREA-ID                          27850000
278600              ,:OSOPFA-SCRN-SEQ-NBR                               27860000
278700     END-EXEC.                                                    27870000
278800                                                                  27880000
278900     EVALUATE TRUE                                                27890000
279000         WHEN SQLCODE = +0                                        27900000
279100              CONTINUE                                            27910000
279200                                                                  27920000
279300         WHEN SQLCODE = +100                                      27930000
279400              SET PS-EOF-TOSOPFA-CSR TO TRUE                      27940000
279500                                                                  27950000
279600         WHEN SQLWARN0 NOT = SPACE                                27960000
279700         WHEN SQLCODE < +0                                        27970000
279800         WHEN SQLCODE > +0                                        27980000
279900              MOVE '2365-FETCH-TOSOPFA-CSR' TO DP013-PARAGRAPH    27990000
280000              MOVE 'FETCH TOSOPFA CURSOR'                         28000000
280100                                   TO DP013-MESSAGE-TEXT (1)      28010000
280200              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 28020000
280300              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               28030000
280400              MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID        28040000
280500              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      28050000
280600              MOVE SQLCA           TO DP013-SQLCA                 28060000
280700              MOVE 'TOSOPFA'       TO DP013-DB2-TABLE-NAME (1)    28070000
280800              SET DP013-DB2-ABEND  TO TRUE                        28080000
280900              PERFORM DP013-0000-PROCESS-ABEND                    28090000
281000     END-EVALUATE.                                                28100000
281100                                                                  28110000
281200*----------------------------------------------------------------*28120000
281300* CLOSE THE TOSOPFA CURSOR                                       *28130000
281400*----------------------------------------------------------------*28140000
281500 2370-CLOSE-TOSOPFA-CSR.                                          28150000
281600                                                                  28160000
281700     EXEC SQL                                                     28170000
281800          CLOSE TOSOPFA-CSR                                       28180000
281900     END-EXEC.                                                    28190000
282000                                                                  28200000
282100     EVALUATE TRUE                                                28210000
282200         WHEN SQLCODE = +0                                        28220000
282300              CONTINUE                                            28230000
282400         WHEN SQLWARN0 NOT = SPACE                                28240000
282500         WHEN SQLCODE  NOT = +0                                   28250000
282600              MOVE '2370-CLOSE-TOSOPFA-CSR' TO DP013-PARAGRAPH    28260000
282700              MOVE 'CLOSE TOSOPFA CURSOR'                         28270000
282800                                   TO DP013-MESSAGE-TEXT (1)      28280000
282900              MOVE SQLCA           TO DP013-SQLCA                 28290000
283000              MOVE 'TOSOPFA'       TO DP013-DB2-TABLE-NAME (1)    28300000
283100              SET DP013-DB2-ABEND  TO TRUE                        28310000
283200              PERFORM DP013-0000-PROCESS-ABEND                    28320000
283300     END-EVALUATE.                                                28330000
283400                                                                  28340000
283500*----------------------------------------------------------------*28350000
283600* BUILD NEW WORK ORDER INSTRUCTION                                28360000
283700*----------------------------------------------------------------*28370000
283800 2375-BUILD-WORK-ORDER-INSTR.                                     28380000
283900                                                                  28390000
284000     INITIALIZE DCLTWKORIN.                                       28400000
284100                                                                  28410000
284200     MOVE ASC-PO-NBR               TO WKORIN-ORD-NBR.             28420000
284300     MOVE ASC-RCVR-SEQ-NBR         TO WKORIN-RCVR-SEQ-NBR.        28430000
284400     MOVE +1                       TO WKORIN-WORK-ORD-SEQ-NBR.    28440000
284500     ADD +1                        TO PV-WO-INSTR-SEQ-NBR.        28450000
284600     MOVE PV-WO-INSTR-SEQ-NBR      TO WKORIN-WO-INSTR-SEQ-NBR.    28460000
284700     MOVE 'A'                      TO WKORIN-VER-STATUS-CDE.      28470000
284800                                                                  28480000
284900* DMH - ADDED 11/04/08 BEGIN                                      28490000
285100     MOVE ASC-OPER-UNT-ID          TO WKORIN-OPER-UNT-ID.         28510000
285200* DMH - ADDED 11/04/08 END                                        28520000
285300                                                                  28530000
285310     MOVE ASC-FCLTY-ID             TO WKORIN-FCLTY-ID.            28531000
285320     MOVE OSOPFA-OPER-ID           TO WKORIN-OPER-ID.             28532000
285330     MOVE OSOPFA-FCLTY-AREA-ID     TO WKORIN-FCLTY-AREA-ID.       28533000
285340     MOVE OSOPFA-PRC-FCLTY-AREA-ID TO WKORIN-PRC-FCLTY-AREA-ID.   28534000
285350     MOVE OSOPFA-SCRN-SEQ-NBR      TO WKORIN-SCREEN-SEQ-NBR.      28535000
285360     IF  PS-FIRST-INSTRUCTION                                     28536000
285370         MOVE 'N'                  TO PS-INSTRUCTION-SW           28537000
285380         MOVE ASC-EXP-CRTN-CNT     TO DK-EXP-CRTN-CNT             28538000
285390         MOVE DK-EXP-CRTN-CNT      TO WKORIN-EXPTED-CART-CNT      28539000
285400         MOVE ASC-ACT-CRTN-CNT     TO DK-ACT-CRTN-CNT             28540000
285500         MOVE DK-ACT-CRTN-CNT      TO WKORIN-ACTL-CART-CNT        28550000
285600     END-IF.                                                      28560000
285700     MOVE 'N'                      TO WKORIN-ALLOC-IND            28570000
285800                                      WKORIN-REPACK-IND.          28580000
285900     MOVE '9999-09-09-09.09.09.999999' TO WKORIN-STRT-TMST        28590000
286000                                          WKORIN-STOP-TMST.       28600000
286100                                                                  28610000
286200     PERFORM 2380-INACTIVATE-TWKORIN.                             28620000
286300     PERFORM 2385-INSERT-TWKORIN.                                 28630000
286400                                                                  28640000
286500*----------------------------------------------------------------*28650000
286600*  INACTIVATE A ROW IN TWKORIN                                    28660000
286700*----------------------------------------------------------------*28670000
286800 2380-INACTIVATE-TWKORIN.                                         28680000
286900                                                                  28690000
287000     EXEC SQL                                                     28700000
287100          UPDATE TWKORIN                                          28710000
287200             SET VER_STATUS_CDE      =  'I'                       28720000
287300           WHERE ORD_NBR             =  :WKORIN-ORD-NBR           28730000
287400             AND RCVR_SEQ_NBR        =  :WKORIN-RCVR-SEQ-NBR      28740000
287500             AND ORD_LNE_NBR         =  :WKORIN-ORD-LNE-NBR       28750000
287600             AND WORK_ORD_SEQ_NBR    =  :WKORIN-WORK-ORD-SEQ-NBR  28760000
287700             AND WO_INSTR_SEQ_NBR    =  :WKORIN-WO-INSTR-SEQ-NBR  28770000
287800             AND VER_STATUS_CDE      =  'A'                       28780000
287900     END-EXEC.                                                    28790000
288000                                                                  28800000
288100     EVALUATE TRUE                                                28810000
288200         WHEN SQLCODE = ZERO                                      28820000
288300         WHEN SQLCODE = +100                                      28830000
288400              CONTINUE                                            28840000
288500         WHEN SQLWARN0 NOT = SPACES                               28850000
288600         WHEN SQLCODE NOT EQUAL ZERO                              28860000
288700              MOVE '2380-INACTIVATE-TWKORIN' TO DP013-PARAGRAPH   28870000
288800              MOVE '"LOGICAL" DELETE; SET STATUS TO I'            28880000
288900                                       TO DP013-MESSAGE-TEXT (1)  28890000
289000              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 28900000
289100              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               28910000
289200              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      28920000
289300              MOVE SQLCA           TO DP013-SQLCA                 28930000
289400              MOVE 'TWKORIN'       TO DP013-DB2-TABLE-NAME (1)    28940000
289500              SET DP013-DB2-ABEND                                 28950000
289600                  DP013-XCTL-DISPLAY-RESTART TO TRUE              28960000
289700              PERFORM DP013-0000-PROCESS-ABEND                    28970000
289800     END-EVALUATE.                                                28980000
289900                                                                  28990000
290000*----------------------------------------------------------------*29000000
290100*  INSERT A ROW INTO TWKORIN                                      29010000
290200*----------------------------------------------------------------*29020000
290300 2385-INSERT-TWKORIN.                                             29030000
290400                                                                  29040000
290500     EXEC SQL                                                     29050000
290600          INSERT INTO TWKORIN                                     29060000
290700                 ( ORD_NBR                                        29070000
290800                  ,RCVR_SEQ_NBR                                   29080000
290900                  ,ORD_LNE_NBR                                    29090000
291000                  ,WORK_ORD_SEQ_NBR                               29100000
291100                  ,OPER_UNT_ID                                    29110000
291200                  ,FCLTY_ID                                       29120000
291300                  ,WO_INSTR_SEQ_NBR                               29130000
291400                  ,CRE_TMST                                       29140000
291500                  ,VER_STATUS_CDE                                 29150000
291600                  ,CRE_UID_ID                                     29160000
291700                  ,OPER_ID                                        29170000
291800                  ,FCLTY_AREA_ID                                  29180000
291900                  ,PRC_FCLTY_AREA_ID                              29190000
292000                  ,EXPTED_CART_CNT                                29200000
292100                  ,ACTL_CART_CNT                                  29210000
292200                  ,ALLOC_IND                                      29220000
292300                  ,REPACK_IND                                     29230000
292400                  ,STRT_TMST                                      29240000
292500                  ,STOP_TMST                                      29250000
292600                  ,SCREEN_SEQ_NBR                                 29260000
292700                  ,LNE_LOC_CDE                                    29270000
292800                  ,REC_SEL_IND )                                  29280000
292900          VALUES ( :WKORIN-ORD-NBR                                29290000
293000                  ,:WKORIN-RCVR-SEQ-NBR                           29300000
293100                  ,:WKORIN-ORD-LNE-NBR                            29310000
293200                  ,:WKORIN-WORK-ORD-SEQ-NBR                       29320000
293300                  ,:WKORIN-OPER-UNT-ID                            29330000
293400                  ,:WKORIN-FCLTY-ID                               29340000
293500                  ,:WKORIN-WO-INSTR-SEQ-NBR                       29350000
293600                  ,CURRENT TIMESTAMP                              29360000
293700                  ,:WKORIN-VER-STATUS-CDE                         29370000
293800                  ,:DP020-USERID                                  29380000
293900                  ,:WKORIN-OPER-ID                                29390000
294000                  ,:WKORIN-FCLTY-AREA-ID                          29400000
294100                  ,:WKORIN-PRC-FCLTY-AREA-ID                      29410000
294200                  ,:WKORIN-EXPTED-CART-CNT                        29420000
294300                  ,:WKORIN-ACTL-CART-CNT                          29430000
294400                  ,:WKORIN-ALLOC-IND                              29440000
294500                  ,:WKORIN-REPACK-IND                             29450000
294600                  ,:WKORIN-STRT-TMST                              29460000
294700                  ,:WKORIN-STOP-TMST                              29470000
294800                  ,:WKORIN-SCREEN-SEQ-NBR                         29480000
294900                  ,:WKORIN-LNE-LOC-CDE                            29490000
295000                  ,:WKORIN-REC-SEL-IND )                          29500000
295100     END-EXEC.                                                    29510000
295200                                                                  29520000
295300     EVALUATE TRUE                                                29530000
295400         WHEN SQLCODE = +0                                        29540000
295500         WHEN SQLCODE = -904                                      29550000
295600         WHEN SQLCODE = -913                                      29560000
295700             CONTINUE                                             29570000
295800                                                                  29580000
295900         WHEN SQLWARN0 NOT = SPACE                                29590000
296000         WHEN SQLCODE < +0                                        29600000
296100         WHEN SQLCODE > +0                                        29610000
296200             MOVE '2385-INSERT-TWKORIN' TO DP013-PARAGRAPH        29620000
296300             MOVE 'INSERT ON WORK ORDER INSTRUCTION TABLE'        29630000
296400                                 TO DP013-MESSAGE-TEXT (1)        29640000
296500             MOVE SQLCA      TO DP013-SQLCA                       29650000
296600             MOVE ASC-PO-NBR      TO PV-ERROR-PO                  29660000
296700             MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ                29670000
296800             MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)       29680000
296900             MOVE 'TWKORIN'  TO DP013-DB2-TABLE-NAME (1)          29690000
297000                 SET DP013-DB2-ABEND                              29700000
297100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           29710000
297200             PERFORM DP013-0000-PROCESS-ABEND                     29720000
297300     END-EVALUATE.                                                29730000
297400                                                                  29740000
297500*----------------------------------------------------------------*29750000
297600*    FIRST, FIND THE ITEM SELECTED.                              *29760000
297700*    NEXT, VALIDATE THAT IT CAN BE STARTED.                      *29770000
297800*    IF OK, UPDATE TWKORIN, THE MAP, AND ASC WITH NEW INFO.      *29780000
297900*----------------------------------------------------------------*29790000
298000 2500-PROCESS-START.                                              29800000
298100     MOVE HIGH-VALUES           TO PV-START-DATE                  29810000
298200                                    PV-PREV-START-DATE            29820000
298300                                    PV-PREV-STOP-DATE.            29830000
298400     PERFORM VARYING PV-SUB                                       29840000
298500         FROM ASC-ITEM-SUB BY -1                                  29850000
298600         UNTIL PV-SUB < +1                                        29860000
298700                                                                  29870000
298800         EVALUATE TRUE                                            29880000
298900             WHEN ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)          29890000
299000                  MOVE ASC-DATE-STRT (ASC-BLK-SUB ASC-ITEM-SUB)   29900000
299100                                    TO PV-START-DATE              29910000
299200                  MOVE PV-SUB   TO PV-SUB2                        29920000
299300                  SUBTRACT PC-ITEMS-PER-PANEL FROM  PV-SUB        29930000
299400             WHEN OTHER                                           29940000
299500                  SUBTRACT +1 FROM ASC-ITEM-SUB                   29950000
299600                  IF  ASC-ITEM-SUB < 1                            29960000
299700                      SUBTRACT +1 FROM ASC-BLK-SUB                29970000
299800                      MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB     29980000
299900                  END-IF                                          29990000
300000         END-EVALUATE                                             30000000
300100     END-PERFORM.                                                 30010000
300200                                                                  30020000
300300     IF  ASC-ITEM-SUB GREATER THAN 1                              30030000
300400         COMPUTE PV-ITM  = ASC-ITEM-SUB - 1                       30040000
300500         MOVE ASC-DATE-COMP (ASC-BLK-SUB PV-ITM)                  30050000
300600                                     TO PV-PREV-STOP-DATE         30060000
300700         MOVE ASC-DATE-STRT (ASC-BLK-SUB PV-ITM)                  30070000
300800                                     TO PV-PREV-START-DATE        30080000
300900         MOVE ASC-BLK-SUB            TO PV-HOLD-BLK               30090000
301000         MOVE PV-ITM                 TO PV-HOLD-ITEM              30100000
301100     ELSE                                                         30110000
301200         IF  ASC-BLK-SUB GREATER THAN 1                           30120000
301300             COMPUTE PV-BLK = ASC-BLK-SUB - 1                     30130000
301400             MOVE ASC-DATE-COMP (PV-BLK PC-ITEMS-PER-PANEL)       30140000
301500                                     TO PV-PREV-STOP-DATE         30150000
301600             MOVE ASC-DATE-STRT (PV-BLK PC-ITEMS-PER-PANEL)       30160000
301700                                     TO PV-PREV-START-DATE        30170000
301800             MOVE PV-BLK             TO PV-HOLD-BLK               30180000
301900             MOVE PC-ITEMS-PER-PANEL TO PV-HOLD-ITEM              30190000
302000         END-IF                                                   30200000
302100     END-IF.                                                      30210000
302200                                                                  30220000
302300     IF  PV-START-DATE EQUAL HIGH-VALUES                          30230000
302400         MOVE PC-TSYMSG-00057   TO DP020-MSG-NUMBER               30240000
302500         SET DP020-MSG-FATAL                                      30250000
302600             PS-ERROR           TO TRUE                           30260000
302700     ELSE                                                         30270000
302800         IF  PV-START-DATE NOT = SPACES                           30280000
302900             MOVE PC-TSYMSG-00914  TO DP020-MSG-NUMBER            30290000
303000             SET DP020-MSG-FATAL                                  30300000
303100                 PS-ERROR       TO TRUE                           30310000
303200             MOVE -1            TO MR-SELECTL (PV-SUB2)           30320000
303300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  30330000
303400             MOVE DP015-RED     TO MR-SELECTC (PV-SUB2)           30340000
303500             MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB2)           30350000
303600         END-IF                                                   30360000
303700     END-IF.                                                      30370000
303800                                                                  30380000
303900     IF  PV-PREV-STOP-DATE EQUAL SPACES                           30390000
304000         IF  PV-PREV-START-DATE EQUAL SPACES                      30400000
304100             MOVE PC-TSYMSG-00915 TO DP020-MSG-NUMBER             30410000
304200             SET DP020-MSG-FATAL                                  30420000
304300                 PS-ERROR       TO TRUE                           30430000
304400             MOVE -1            TO MR-SELECTL (PV-SUB2)           30440000
304500             SET DP030-SET-CURSOR-APPL-1  TO TRUE                 30450000
304600             MOVE DP015-RED     TO MR-SELECTC (PV-SUB2)           30460000
304700             MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB2)           30470000
304800         ELSE                                                     30480000
304900             IF (ASC-BLK-SUB EQUAL 1                              30490000
305000             AND ASC-ITEM-SUB EQUAL 1)                            30500000
305100                 CONTINUE                                         30510000
305200             ELSE                                                 30520000
305300                 MOVE ASC-BLK-SUB   TO PV-BLK                     30530000
305400                 MOVE ASC-ITEM-SUB  TO PV-ITM                     30540000
305500                 MOVE PV-HOLD-BLK   TO ASC-BLK-SUB                30550000
305600                 MOVE PV-HOLD-ITEM  TO ASC-ITEM-SUB               30560000
305700                                       PV-SUB2                    30570000
305800                 PERFORM 2540-STOP-INSTRUCTION                    30580000
305900                 MOVE PV-BLK        TO ASC-BLK-SUB                30590000
306000                 MOVE PV-ITM        TO ASC-ITEM-SUB               30600000
306100                                       PV-SUB2                    30610000
306200             END-IF                                               30620000
306300         END-IF                                                   30630000
306400     END-IF.                                                      30640000
306500                                                                  30650000
306600     IF  PS-ERROR                                                 30660000
306700         CONTINUE                                                 30670000
306800     ELSE                                                         30680000
306900         PERFORM 2501-START-INSTRUCTION                           30690000
307000     END-IF.                                                      30700000
307100     IF  PS-ERROR                                                 30710000
307200         CONTINUE                                                 30720000
307300     ELSE                                                         30730000
307400         SET ASC-TEMP-NO-SELECT (1, 1)                            30740000
307500             ASC-TEMP-NO-SELECT (1, 2)                            30750000
307600             ASC-TEMP-NO-SELECT (1, 3)                            30760000
307700                                      TO TRUE                     30770000
307800     END-IF.                                                      30780000
307810                                                                  30781001
307820                                                                  30782001
307900*----------------------------------------------------------------*30790000
308000*    UPDATE THE ROW, ASC, AND MAP.                               *30800000
308100*----------------------------------------------------------------*30810000
308200 2501-START-INSTRUCTION.                                          30820000
308300     MOVE ASC-WO-INSTR-SEQ-NBR (ASC-BLK-SUB ASC-ITEM-SUB)         30830000
308400                                TO WKORIN-WO-INSTR-SEQ-NBR.       30840000
308500     PERFORM 2505-UPDATE-TWKORIN.                                 30850000
308600     IF  SQLCODE EQUAL ZERO                                       30860000
308700         PERFORM 2507-GET-TWKORIN                                 30870000
308800         IF  SQLCODE EQUAL ZERO                                   30880000
308900             MOVE WKORIN-STRT-TMST TO PV-DB2-DATE                 30890000
309000             IF  PV-DB2-CC = '99'                                 30900000
309100                 MOVE SPACES       TO ASC-DATE-STRT               30910000
309200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 30920000
309300                                       ASC-TIME-STRT              30930000
309400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 30940000
309500                 MOVE ASC-DATE-STRT (ASC-BLK-SUB ASC-ITEM-SUB)    30950000
309600                     TO  MR-DATE-STRT (PV-SUB2)                   30960000
309700                 MOVE ASC-TIME-STRT (ASC-BLK-SUB ASC-ITEM-SUB)    30970000
309800                     TO  MR-TIME-STRT (PV-SUB2)                   30980000
309900             ELSE                                                 30990000
310000                 STRING PV-DB2-MM      DELIMITED BY SIZE          31000000
310100                        '/'            DELIMITED BY SIZE          31010000
310200                        PV-DB2-DD      DELIMITED BY SIZE          31020000
310300                    INTO ASC-DATE-STRT (ASC-BLK-SUB ASC-ITEM-SUB) 31030000
310400                 MOVE ASC-DATE-STRT (ASC-BLK-SUB ASC-ITEM-SUB)    31040000
310500                     TO  MR-DATE-STRT (PV-SUB2)                   31050000
310600                 STRING PV-DB2-HH       DELIMITED BY SIZE         31060000
310700                        ':'             DELIMITED BY SIZE         31070000
310800                        PV-DB2-MN       DELIMITED BY SIZE         31080000
310900                    INTO ASC-TIME-STRT (ASC-BLK-SUB ASC-ITEM-SUB) 31090000
311000                 MOVE ASC-TIME-STRT (ASC-BLK-SUB ASC-ITEM-SUB)    31100000
311100                     TO  MR-TIME-STRT (PV-SUB2)                   31110000
311200             END-IF                                               31120000
311300                                                                  31130000
311400*            REFRAIN FROM PUTTING THE CURSOR ON AN EMPTY SPACE    31140000
311500             EVALUATE TRUE                                        31150000
311600             WHEN PV-SUB2 = 1                                     31160000
311700                 IF ASC-SEQ (1, 2) = ZERO                         31170000
311800                     SET ASC-CSR-LOC-1     TO TRUE                31180000
311900                 ELSE                                             31190000
312000                     SET ASC-CSR-LOC-2     TO TRUE                31200000
312100                 END-IF                                           31210000
312200             WHEN PV-SUB2 = 2                                     31220000
312300                 IF ASC-SEQ (1, 3) = ZERO                         31230000
312400                     SET ASC-CSR-LOC-2     TO TRUE                31240000
312500                 ELSE                                             31250000
312600                     SET ASC-CSR-LOC-3     TO TRUE                31260000
312700                 END-IF                                           31270000
312800             WHEN PV-SUB2 = 3                                     31280000
312900                 SET ASC-CSR-LOC-3     TO TRUE                    31290000
313000             END-EVALUATE                                         31300000
313100                                                                  31310000
313300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  31330000
313400             MOVE PC-TSYMSG-00925 TO DP020-MSG-NUMBER             31340000
313500             SET DP020-MSG-INFORMATIONAL TO TRUE                  31350000
313600             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          31360000
313700         END-IF                                                   31370000
313800     END-IF.                                                      31380000
313900                                                                  31390000
314000 2505-UPDATE-TWKORIN.                                             31400000
314100                                                                  31410000
314200     EXEC SQL                                                     31420000
314300          UPDATE TWKORIN                                          31430000
314400          SET    STRT_TMST        =   CURRENT TIMESTAMP           31440000
314500          WHERE                                                   31450000
314600                 ORD_NBR          =  :ASC-PO-NBR                  31460000
314700          AND    RCVR_SEQ_NBR     =  :ASC-RCVR-SEQ-NBR            31470000
314800          AND    ORD_LNE_NBR      =  :ASC-LINE-NBR                31480000
314900          AND    WORK_ORD_SEQ_NBR =  :ASC-WORK-ORD-SEQ-NBR        31490000
315200          AND    WO_INSTR_SEQ_NBR =  :WKORIN-WO-INSTR-SEQ-NBR     31520000
315300          AND    VER_STATUS_CDE   =  'A'                          31530000
315400     END-EXEC.                                                    31540000
315500                                                                  31550000
315600     EVALUATE TRUE                                                31560000
315700         WHEN SQLCODE = ZERO                                      31570000
315800              CONTINUE                                            31580000
315900         WHEN SQLCODE = -904                                      31590000
316000         WHEN SQLCODE = -911                                      31600000
316100         WHEN SQLCODE = -913                                      31610000
316200              PERFORM 9900A-SOFT-ABORT                            31620000
316300         WHEN SQLWARN0 NOT = SPACE                                31630000
316400         WHEN SQLCODE NOT = ZERO                                  31640000
316500              MOVE '2505-UPDATE-TWKORIN' TO DP013-PARAGRAPH       31650000
316600              MOVE 'UPDATE START TIMESTAMP'                       31660000
316700                               TO DP013-MESSAGE-TEXT (1)          31670000
316800              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 31680000
316900              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               31690000
317000              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      31700000
317100              MOVE SQLCA       TO DP013-SQLCA                     31710000
317200              MOVE 'TWKORIN '  TO DP013-DB2-TABLE-NAME (1)        31720000
317300              SET DP013-DB2-ABEND     TO TRUE                     31730000
317400              PERFORM DP013-0000-PROCESS-ABEND                    31740000
317500     END-EVALUATE.                                                31750000
317600                                                                  31760000
317700 2507-GET-TWKORIN.                                                31770000
317800                                                                  31780000
317900     EXEC SQL                                                     31790000
318000          SELECT STRT_TMST                                        31800000
318100          INTO   :WKORIN-STRT-TMST                                31810000
318200          FROM   TWKORIN                                          31820000
318300          WHERE  ORD_NBR          =  :ASC-PO-NBR                  31830000
318400          AND    RCVR_SEQ_NBR     =  :ASC-RCVR-SEQ-NBR            31840000
318500          AND    ORD_LNE_NBR      =  0                            31850000
318600          AND    WORK_ORD_SEQ_NBR =  :ASC-WORK-ORD-SEQ-NBR        31860000
318900          AND    WO_INSTR_SEQ_NBR =  :WKORIN-WO-INSTR-SEQ-NBR     31890000
319000          AND    VER_STATUS_CDE   =  'A'                          31900000
319100     END-EXEC.                                                    31910000
319200                                                                  31920000
319300     EVALUATE TRUE                                                31930000
319400         WHEN SQLCODE = ZERO                                      31940000
319500              CONTINUE                                            31950000
319600         WHEN SQLCODE = -904                                      31960000
319700         WHEN SQLCODE = -911                                      31970000
319800         WHEN SQLCODE = -913                                      31980000
319900              PERFORM 9900A-SOFT-ABORT                            31990000
320000         WHEN SQLWARN0 NOT = SPACE                                32000000
320100         WHEN SQLCODE NOT = ZERO                                  32010000
320200              MOVE '2507-GET-TWKORIN'   TO DP013-PARAGRAPH        32020000
320300              MOVE 'GET START TIMESTAMP AFTER UPDATE'             32030000
320400                               TO DP013-MESSAGE-TEXT (1)          32040000
320500              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 32050000
320600              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               32060000
320700              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      32070000
320800              MOVE SQLCA       TO DP013-SQLCA                     32080000
320900              MOVE 'TWKORIN '  TO DP013-DB2-TABLE-NAME (1)        32090000
321000              SET DP013-DB2-ABEND  TO TRUE                        32100000
321100              PERFORM DP013-0000-PROCESS-ABEND                    32110000
321200     END-EVALUATE.                                                32120000
321300                                                                  32130000
321400*----------------------------------------------------------------*32140000
321500*    UPDATE THE ROW, ASC, AND MAP.                               *32150000
321600*    IF THIS IS THE LAST INSTRUCTION, ENSURE THEY CAN'T STOP     *32160000
321700*    IT UNLESS A TRANSCRIPTION HAS OCCURRED.  THIS IS DETERMINED *32170000
321800*    BY THE EXISTANCE OF A ROW ON TRECDIS.                       *32180000
321900*----------------------------------------------------------------*32190000
322000 2540-STOP-INSTRUCTION.                                           32200000
322100                                                                  32210000
322200     IF (ASC-LINE-NBR NOT EQUAL ZERO                              32220000
322300     AND ASC-SEQ (ASC-BLK-SUB ASC-ITEM-SUB) EQUAL                 32230000
322400         ASC-NUMBER-OF-ITEMS-READ)                                32240000
322500         PERFORM 2545-COUNT-TRECDIS                               32250000
322600         PERFORM 2555-CHECK-FOR-TROUBLE                           32260000
322700                                                                  32270000
322800         EVALUATE TRUE                                            32280000
322900             WHEN PV-DB2-COUNT EQUAL ZERO                         32290000
323000                  MOVE PC-TSYMSG-00918 TO DP020-MSG-NUMBER        32300000
323100                  MOVE -1       TO MR-SELECTL (PV-SUB2)           32310000
323200                  SET DP030-SET-CURSOR-APPL-1                     32320000
323300                     PS-ERROR                                     32330000
323400                     DP020-MSG-FATAL TO TRUE                      32340000
323500                  MOVE DP015-RED     TO MR-SELECTC (PV-SUB2)      32350000
323600                  MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB2)      32360000
323700             WHEN PV-DB2-COUNT-TROUBLE GREATER THAN ZERO          32370000
323800                  MOVE PC-TSYMSG-00919 TO DP020-MSG-NUMBER        32380000
323900                  MOVE -1       TO MR-SELECTL (PV-SUB2)           32390000
324000                  SET DP030-SET-CURSOR-APPL-1                     32400000
324100                     PS-ERROR                                     32410000
324200                     DP020-MSG-FATAL  TO TRUE                     32420000
324300                  MOVE DP015-RED      TO MR-SELECTC (PV-SUB2)     32430000
324400                  MOVE DP015-REVERSE  TO MR-SELECTH (PV-SUB2)     32440000
324500             WHEN OTHER                                           32450000
324600                  PERFORM 2560-CONTINUE-STOP                      32460000
324700         END-EVALUATE                                             32470000
324800     ELSE                                                         32480000
324900         PERFORM 2550-CHECK-FOR-NON-ZERO                          32490000
325000     END-IF.                                                      32500000
325100                                                                  32510000
325200 2545-COUNT-TRECDIS.                                              32520000
325300     MOVE ZERO            TO PV-DB2-COUNT.                        32530000
325400     EXEC SQL                                                     32540000
325500          SELECT COUNT(*)                                         32550000
325600          INTO  :PV-DB2-COUNT :PV-NULL-IND                        32560000
325700          FROM  TRECDIS                                           32570000
325800          WHERE ORD_NBR            =  :ASC-PO-NBR                 32580000
325900          AND   ORD_LNE_NBR        =  :ASC-LINE-NBR               32590000
326000          AND   REC_SEQ_NBR        =  :ASC-RCVR-SEQ-NBR           32600000
326100          AND   OPER_UNT_ID        =  :ASC-OPER-UNT-ID            32610000
326200          AND   FCLTY_ID           =  :ASC-FCLTY-ID               32620000
326400     END-EXEC.                                                    32640000
326500                                                                  32650000
326600     EVALUATE TRUE                                                32660000
326700         WHEN SQLCODE = ZERO                                      32670000
326800         WHEN SQLCODE = +100                                      32680000
326900              CONTINUE                                            32690000
327000         WHEN SQLCODE = -904                                      32700000
327100         WHEN SQLCODE = -911                                      32710000
327200         WHEN SQLCODE = -913                                      32720000
327300              PERFORM 9900A-SOFT-ABORT                            32730000
327400         WHEN SQLWARN0 NOT = SPACE                                32740000
327500         WHEN SQLCODE NOT = ZERO                                  32750000
327600              MOVE '2545-COUNT-TRECDIS' TO DP013-PARAGRAPH        32760000
327700              MOVE 'COUNT NUMBER OF RECEIPT DISTRIBUTION ROWS'    32770000
327800                               TO DP013-MESSAGE-TEXT (1)          32780000
327900              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 32790000
328000              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               32800000
328100              MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID        32810000
328200              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      32820000
328300              MOVE SQLCA       TO DP013-SQLCA                     32830000
328400              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        32840000
328500              SET DP013-DB2-ABEND  TO TRUE                        32850000
328600              PERFORM DP013-0000-PROCESS-ABEND                    32860000
328700     END-EVALUATE.                                                32870000
328800                                                                  32880000
328900 2550-CHECK-FOR-NON-ZERO.                                         32890000
329000                                                                  32900000
329100     PERFORM 2565-SELECT-TRECEIV.                                 32910000
329200                                                                  32920000
329300     IF (ASC-NUMBER-OF-ITEMS-READ EQUAL                           32930000
329400         ASC-SEQ (ASC-BLK-SUB ASC-ITEM-SUB)                       32940000
329500     AND RECEIV-PACK-BY-ST-IND NOT EQUAL 'Y')                     32950000
329600         PERFORM 2570-COUNT-NON-LNE-ZEROS                         32960000
329700         IF  PV-DB2-COUNT GREATER THAN ZERO                       32970000
329800             PERFORM 2560-CONTINUE-STOP                           32980000
329900         ELSE                                                     32990000
330000             MOVE PC-TSYMSG-00920  TO DP020-MSG-NUMBER            33000000
330100             SET DP020-MSG-FATAL                                  33010000
330200                 PS-ERROR          TO TRUE                        33020000
330300         END-IF                                                   33030000
330400     ELSE                                                         33040000
330500         PERFORM 2560-CONTINUE-STOP                               33050000
330600     END-IF.                                                      33060000
330700                                                                  33070000
330800 2555-CHECK-FOR-TROUBLE.                                          33080000
330900     MOVE ZERO                   TO PV-DB2-COUNT-TROUBLE.         33090000
331000     EXEC SQL                                                     33100000
331100          SELECT COUNT(*)                                         33110000
331200          INTO  :PV-DB2-COUNT-TROUBLE :PV-NULL-IND                33120000
331300          FROM   TTRBNTF A                                        33130000
331400                ,TTRBRSN B                                        33140000
331500          WHERE A.PO_NBR           =  :ASC-PO-NBR                 33150000
331600          AND  (A.PO_LNE_NBR       =  :ASC-LINE-NBR               33160000
331700          AND   B.TRBL_LVL_IND       <> 'M')                      33170000
331800          AND   A.REC_SEQ_NBR      =  :ASC-RCVR-SEQ-NBR           33180000
331900          AND   A.OPER_UNT_ID      =  :ASC-OPER-UNT-ID            33190000
332000          AND   A.FCLTY_ID         =  :ASC-FCLTY-ID               33200000
332100          AND   B.TRBL_RSN_CDE     =  A.TRBL_RSN_CDE              33210000
332200          AND ((A.RESOLVED_IND    IN ('N', 'R', 'I')              33220000
332300          AND   B.NOTIF_IND        =  'T')                        33230000
332400          OR    A.TRBL_RSN_CDE     =  803)                        33240000
332500     END-EXEC.                                                    33250000
332600                                                                  33260000
332700     EVALUATE TRUE                                                33270000
332800         WHEN SQLCODE = ZERO                                      33280000
332900         WHEN SQLCODE = +100                                      33290000
333000              CONTINUE                                            33300000
333100         WHEN SQLCODE = -904                                      33310000
333200         WHEN SQLCODE = -911                                      33320000
333300         WHEN SQLCODE = -913                                      33330000
333400              PERFORM 9900A-SOFT-ABORT                            33340000
333500         WHEN SQLWARN0 NOT = SPACE                                33350000
333600         WHEN SQLCODE NOT = ZERO                                  33360000
333700              MOVE '2555-CHECK-FOR-TROUBLE' TO DP013-PARAGRAPH    33370000
333800              MOVE 'COUNT UNRESOLVED TROUBLE ROWS'                33380000
333900                                    TO DP013-MESSAGE-TEXT (1)     33390000
334000              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 33400000
334100              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               33410000
334200              MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID        33420000
334300              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      33430000
334400              MOVE SQLCA       TO DP013-SQLCA                     33440000
334500              SET DP013-DB2-ABEND    TO TRUE                      33450000
334600              PERFORM DP013-0000-PROCESS-ABEND                    33460000
334700     END-EVALUATE.                                                33470000
334800                                                                  33480000
334900     IF  PV-DB2-COUNT-TROUBLE EQUAL ZERO                          33490000
335000         PERFORM 2571-CHECK-PO-LEVEL                              33500000
335100     END-IF.                                                      33510000
335200                                                                  33520000
335300*----------------------------------------------------------------*33530000
335400*    HERE IS THE ACTUAL STOP INSTRUCTION LOGIC.                  *33540000
335500*----------------------------------------------------------------*33550000
335600 2560-CONTINUE-STOP.                                              33560000
335700                                                                  33570000
335800     MOVE ASC-WO-INSTR-SEQ-NBR (ASC-BLK-SUB ASC-ITEM-SUB)         33580000
335900                                TO WKORIN-WO-INSTR-SEQ-NBR.       33590000
336000     MOVE ASC-FCLTY-ID          TO WKORIN-FCLTY-AREA-ID.          33600000
336100                                                                  33610000
336200     PERFORM 2572-COUNT-TWKORIN.                                  33620000
336300                                                                  33630000
336400     IF  SQLCODE EQUAL ZERO                                       33640000
336500         PERFORM 2574-GET-TWKORIN                                 33650000
336600         IF  SQLCODE EQUAL ZERO                                   33660000
336700             MOVE WKORIN-STOP-TMST TO PV-DB2-DATE                 33670000
336800             IF  PV-DB2-CC = '99'                                 33680000
336900                 MOVE SPACES       TO ASC-DATE-COMP               33690000
337000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 33700000
337100                                       ASC-TIME-COMP              33710000
337200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 33720000
337300                 MOVE ASC-DATE-COMP (ASC-BLK-SUB ASC-ITEM-SUB)    33730000
337400                                TO MR-DATE-COMP (PV-SUB2)         33740000
337500                 MOVE ASC-TIME-COMP (ASC-BLK-SUB ASC-ITEM-SUB)    33750000
337600                                TO MR-TIME-COMP (PV-SUB2)         33760000
337700             ELSE                                                 33770000
337800                 STRING PV-DB2-MM      DELIMITED BY SIZE          33780000
337900                        '/'            DELIMITED BY SIZE          33790000
338000                        PV-DB2-DD      DELIMITED BY SIZE          33800000
338100                    INTO ASC-DATE-COMP (ASC-BLK-SUB ASC-ITEM-SUB) 33810000
338200                 MOVE ASC-DATE-COMP (ASC-BLK-SUB ASC-ITEM-SUB)    33820000
338300                                TO MR-DATE-COMP (PV-SUB2)         33830000
338400                 STRING PV-DB2-HH       DELIMITED BY SIZE         33840000
338500                        ':'             DELIMITED BY SIZE         33850000
338600                        PV-DB2-MN       DELIMITED BY SIZE         33860000
338700                    INTO ASC-TIME-COMP (ASC-BLK-SUB ASC-ITEM-SUB) 33870000
338800                 MOVE ASC-TIME-COMP (ASC-BLK-SUB ASC-ITEM-SUB)    33880000
338900                                TO MR-TIME-COMP (PV-SUB2)         33890000
339000             END-IF                                               33900000
339100             MOVE PC-TSYMSG-00921 TO DP020-MSG-NUMBER             33910000
339200             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          33920000
339300                                                                  33930000
339400             IF  ASC-SEQ (ASC-BLK-SUB ASC-ITEM-SUB) EQUAL         33940000
339500                 ASC-NUMBER-OF-ITEMS-READ                         33950000
339600                 PERFORM 2575-SET-STATUS                          33960000
339700             END-IF                                               33970000
339800         END-IF                                                   33980000
339900     END-IF.                                                      33990000
340000                                                                  34000000
340100*----------------------------------------------------------------*34010000
340200*    GET THE CURRENT ROW FOR PROCESSING.                         *34020000
340300*----------------------------------------------------------------*34030000
340400 2565-SELECT-TRECEIV.                                             34040000
340500                                                                  34050000
340600     EXEC SQL                                                     34060000
340700          SELECT  PACK_BY_ST_IND                                  34070000
340800          INTO :RECEIV-PACK-BY-ST-IND                             34080000
340900          FROM  TRECEIV                                           34090000
341000          WHERE ORD_NBR            =  :ASC-PO-NBR                 34100000
341100          AND   REC_SEQ_NBR        =  :ASC-RCVR-SEQ-NBR           34110000
341400          AND   VER_STATUS_CDE     =  'A'                         34140000
341500     END-EXEC.                                                    34150000
341600                                                                  34160000
341700     EVALUATE TRUE                                                34170000
341800         WHEN SQLCODE = ZERO                                      34180000
341900         WHEN SQLCODE = +100                                      34190000
342000              CONTINUE                                            34200000
342100         WHEN SQLCODE = -904                                      34210000
342200         WHEN SQLCODE = -911                                      34220000
342300         WHEN SQLCODE = -913                                      34230000
342400              PERFORM 9900A-SOFT-ABORT                            34240000
342500         WHEN SQLWARN0 NOT = SPACE                                34250000
342600         WHEN SQLCODE NOT = ZERO                                  34260000
342700              MOVE '2565-SELECT-TRECEIV' TO DP013-PARAGRAPH       34270000
342800              MOVE 'SELECT TRECEIV' TO DP013-MESSAGE-TEXT (1)     34280000
342900              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 34290000
343000              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               34300000
343100              MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID        34310000
343200              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      34320000
343300              MOVE SQLCA           TO DP013-SQLCA                 34330000
343400              MOVE 'TRECEIV '      TO DP013-DB2-TABLE-NAME (1)    34340000
343500              SET DP013-DB2-ABEND  TO TRUE                        34350000
343600              PERFORM DP013-0000-PROCESS-ABEND                    34360000
343700     END-EVALUATE.                                                34370000
343800                                                                  34380000
343900 2570-COUNT-NON-LNE-ZEROS.                                        34390000
344000                                                                  34400000
344100     MOVE +0 TO PV-DB2-COUNT                                      34410000
344200                                                                  34420000
344300     EXEC SQL                                                     34430000
344400         SELECT COUNT(*)                                          34440000
344500          INTO  :PV-DB2-COUNT :PV-NULL-IND                        34450000
344600          FROM  TWRKORD                                           34460000
344700          WHERE ORD_NBR          =  :ASC-PO-NBR                   34470000
344800            AND ORD_LNE_NBR      >  0                             34480000
344900            AND RCVR_SEQ_NBR     =  :ASC-RCVR-SEQ-NBR             34490000
345200            AND VER_STATUS_CDE   =  'A'                           34520000
345300     END-EXEC.                                                    34530000
345400                                                                  34540000
345500     EVALUATE TRUE                                                34550000
345600         WHEN SQLCODE = +0                                        34560000
345700         WHEN SQLCODE = +100                                      34570000
345800         WHEN SQLCODE = -305                                      34580000
345900              CONTINUE                                            34590000
346000         WHEN SQLCODE = -904                                      34600000
346100         WHEN SQLCODE = -911                                      34610000
346200         WHEN SQLCODE = -913                                      34620000
346300              PERFORM 9900A-SOFT-ABORT                            34630000
346400         WHEN SQLWARN0 NOT = SPACE                                34640000
346500         WHEN SQLCODE NOT = ZERO                                  34650000
346600              MOVE '2570-COUNT-NON-LNE-ZEROS'                     34660000
346700                                   TO DP013-PARAGRAPH             34670000
346800              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 34680000
346900              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               34690000
347000              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      34700000
347100              MOVE SQLCA           TO DP013-SQLCA                 34710000
347200              MOVE 'TWRKORD '      TO DP013-DB2-TABLE-NAME (2)    34720000
347300              SET DP013-DB2-ABEND  TO TRUE                        34730000
347400              PERFORM DP013-0000-PROCESS-ABEND                    34740000
347500     END-EVALUATE.                                                34750000
347600                                                                  34760000
347700 2571-CHECK-PO-LEVEL.                                             34770000
347800                                                                  34780000
347900     MOVE ZERO                   TO PV-DB2-COUNT-TROUBLE.         34790000
348000     EXEC SQL                                                     34800000
348100          SELECT COUNT(*)                                         34810000
348200          INTO  :PV-DB2-COUNT-TROUBLE :PV-NULL-IND                34820000
348300          FROM   TTRBNTF A                                        34830000
348400                ,TTRBRSN B                                        34840000
348500          WHERE A.PO_NBR           =  :ASC-PO-NBR                 34850000
348600           AND  A.PO_LNE_NBR       =  0                           34860000
348700           AND  A.PREPK_ID         =  0                           34870000
348800           AND  A.REC_SEQ_NBR      =  :ASC-RCVR-SEQ-NBR           34880000
348900           AND  A.OPER_UNT_ID      =  :ASC-OPER-UNT-ID            34890000
349000           AND  A.FCLTY_ID         =  :ASC-FCLTY-ID               34900000
349100           AND  A.TRBL_RSN_CDE    <>  998                         34910000
349200           AND  A.TRBL_RSN_CDE    <>  999                         34920000
349300           AND  B.TRBL_RSN_CDE     =  A.TRBL_RSN_CDE              34930000
349400           AND ((A.RESOLVED_IND    IN ('N', 'I',  'R')            34940000
349500           AND  B.NOTIF_IND        =  'T')                        34950000
349600           OR   B.TRBL_RSN_CDE     =  803)                        34960000
349700     END-EXEC.                                                    34970000
349800                                                                  34980000
349900     EVALUATE TRUE                                                34990000
350000         WHEN SQLCODE = ZERO                                      35000000
350100         WHEN SQLCODE = +100                                      35010000
350200              CONTINUE                                            35020000
350300         WHEN SQLCODE = -904                                      35030000
350400         WHEN SQLCODE = -911                                      35040000
350500         WHEN SQLCODE = -913                                      35050000
350600              PERFORM 9900A-SOFT-ABORT                            35060000
350700         WHEN SQLWARN0 NOT = SPACE                                35070000
350800         WHEN SQLCODE NOT = ZERO                                  35080000
350900              MOVE '2571-CHECK-PO-LEVEL'  TO DP013-PARAGRAPH      35090000
351000              MOVE 'COUNT UNRESOLVED TROUBLE ROWS: PO LEVEL'      35100000
351100                                   TO DP013-MESSAGE-TEXT (1)      35110000
351200              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 35120000
351300              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               35130000
351400              MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID        35140000
351500              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      35150000
351600              MOVE SQLCA           TO DP013-SQLCA                 35160000
351700              SET DP013-DB2-ABEND  TO TRUE                        35170000
351800              PERFORM DP013-0000-PROCESS-ABEND                    35180000
351900     END-EVALUATE.                                                35190000
352000                                                                  35200000
352001*----------------------------------------------------------------*35200101
352010**   SEE ANY OF THE NEXT AREA'S INSTRUCTIONS HAVE A REC_SEL_IND.  35201001
352020**   OF 'S' IF SO, SET THE CURRENT REC_SEL_IND TO 'S' TOO.        35202001
352021*----------------------------------------------------------------*35202101
352100 2572-COUNT-TWKORIN.                                              35210000
352200                                                                  35220000
352600     MOVE +0 TO PV-DB2-COUNT                                      35260000
352700                                                                  35270000
352800     EXEC SQL                                                     35280000
352900          SELECT COUNT(*)                                         35290000
353000          INTO   :PV-DB2-COUNT :PV-NULL-IND                       35300000
353100          FROM   TWKORIN                                          35310000
353200          WHERE                                                   35320000
353300                 ORD_NBR            =  :ASC-PO-NBR                35330000
353400          AND    RCVR_SEQ_NBR       =  :ASC-RCVR-SEQ-NBR          35340000
353700          AND    FCLTY_AREA_ID      =  :WKORIN-FCLTY-AREA-ID      35370000
353800          AND    VER_STATUS_CDE     =  'A'                        35380000
353900          AND    REC_SEL_IND        =  'S'                        35390000
354000     END-EXEC.                                                    35400000
354100                                                                  35410000
354200     EVALUATE TRUE                                                35420000
354300         WHEN SQLCODE = ZERO                                      35430000
354400         WHEN SQLCODE = +100                                      35440000
354500         WHEN SQLCODE = -305                                      35450000
354600              CONTINUE                                            35460000
354700         WHEN SQLCODE = -904                                      35470000
354800         WHEN SQLCODE = -911                                      35480000
354900         WHEN SQLCODE = -913                                      35490000
355000              PERFORM 9900A-SOFT-ABORT                            35500000
355100         WHEN SQLWARN0 NOT = SPACE                                35510000
355200         WHEN SQLCODE NOT = ZERO                                  35520000
355300              MOVE '2572-COUNT-TWKORIN' TO DP013-PARAGRAPH        35530000
355400              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 35540000
355500              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               35550000
355600              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      35560000
355700              MOVE SQLCA       TO DP013-SQLCA                     35570000
355800              MOVE 'TWKORIN '  TO DP013-DB2-TABLE-NAME (1)        35580000
355900              SET DP013-DB2-ABEND  TO TRUE                        35590000
356000              PERFORM DP013-0000-PROCESS-ABEND                    35600000
356100     END-EVALUATE.                                                35610000
356200     IF PV-DB2-COUNT = +0                                         35620000
356300         MOVE SPACE       TO WKORIN-REC-SEL-IND                   35630000
356400     ELSE                                                         35640000
356500         MOVE 'S'         TO WKORIN-REC-SEL-IND                   35650000
356600     END-IF.                                                      35660000
356700                                                                  35670000
356800     PERFORM 2573-FINISH-UPDATE.                                  35680000
356900                                                                  35690000
357000 2573-FINISH-UPDATE.                                              35700000
357100                                                                  35710000
357200     EXEC SQL                                                     35720000
357300          UPDATE TWKORIN                                          35730000
357400          SET    REC_SEL_IND      =  :WKORIN-REC-SEL-IND          35740000
357500               , CRE_UID_ID       =  :PC-CURRENT-PROGRAM-NAME     35750000
357600               , STOP_TMST        =   CURRENT TIMESTAMP           35760000
357700          WHERE                                                   35770000
357800                 ORD_NBR          =  :ASC-PO-NBR                  35780000
357900          AND    RCVR_SEQ_NBR     =  :ASC-RCVR-SEQ-NBR            35790000
358000          AND    ORD_LNE_NBR      =  :ASC-LINE-NBR                35800000
358100          AND    WORK_ORD_SEQ_NBR =  :ASC-WORK-ORD-SEQ-NBR        35810000
358400          AND    WO_INSTR_SEQ_NBR =  :WKORIN-WO-INSTR-SEQ-NBR     35840000
358500          AND    VER_STATUS_CDE   =  'A'                          35850000
358600     END-EXEC.                                                    35860000
358700                                                                  35870000
358800     EVALUATE TRUE                                                35880000
358900         WHEN SQLCODE = ZERO                                      35890000
359000         WHEN SQLCODE = +100                                      35900000
359100              CONTINUE                                            35910000
359200         WHEN SQLCODE = -904                                      35920000
359300         WHEN SQLCODE = -911                                      35930000
359400         WHEN SQLCODE = -913                                      35940000
359500              PERFORM 9900A-SOFT-ABORT                            35950000
359600         WHEN SQLWARN0 NOT = SPACE                                35960000
359700         WHEN SQLCODE NOT = ZERO                                  35970000
359800              MOVE '2573-FINISH-UPDATE'    TO DP013-PARAGRAPH     35980000
359900              MOVE 'UPDATE STOP TIMESTAMP'                        35990000
360000                               TO DP013-MESSAGE-TEXT (1)          36000000
360100              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 36010000
360200              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               36020000
360300              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      36030000
360400              MOVE SQLCA       TO DP013-SQLCA                     36040000
360500              MOVE 'TWKORIN '  TO DP013-DB2-TABLE-NAME (1)        36050000
360600              SET DP013-DB2-ABEND  TO TRUE                        36060000
360700              PERFORM DP013-0000-PROCESS-ABEND                    36070000
360800     END-EVALUATE.                                                36080000
360900                                                                  36090000
361000 2574-GET-TWKORIN.                                                36100000
361100                                                                  36110000
361200     EXEC SQL                                                     36120000
361300          SELECT STOP_TMST                                        36130000
361400                ,SCREEN_SEQ_NBR                                   36140000
361500          INTO   :WKORIN-STOP-TMST                                36150000
361600                ,:WKORIN-SCREEN-SEQ-NBR                           36160000
361700          FROM                                                    36170000
361800                 TWKORIN                                          36180000
361900          WHERE                                                   36190000
362000                 ORD_NBR          =  :ASC-PO-NBR                  36200000
362100          AND    RCVR_SEQ_NBR     =  :ASC-RCVR-SEQ-NBR            36210000
362200          AND    ORD_LNE_NBR      =  :ASC-LINE-NBR                36220000
362300          AND    WORK_ORD_SEQ_NBR =  :ASC-WORK-ORD-SEQ-NBR        36230000
362600          AND    WO_INSTR_SEQ_NBR =  :WKORIN-WO-INSTR-SEQ-NBR     36260000
362700          AND    VER_STATUS_CDE   =  'A'                          36270000
362800     END-EXEC.                                                    36280000
362900                                                                  36290000
363000     EVALUATE TRUE                                                36300000
363100         WHEN SQLCODE = ZERO                                      36310000
363200              CONTINUE                                            36320000
363300         WHEN SQLCODE = -904                                      36330000
363400         WHEN SQLCODE = -911                                      36340000
363500         WHEN SQLCODE = -913                                      36350000
363600              PERFORM 9900A-SOFT-ABORT                            36360000
363700         WHEN SQLWARN0 NOT = SPACE                                36370000
363800         WHEN SQLCODE NOT = ZERO                                  36380000
363900              MOVE '2574-GET-TWKORIN'  TO DP013-PARAGRAPH         36390000
364000              MOVE 'GET STOP TIMESTAMP AFTER UPDATE'              36400000
364100                               TO DP013-MESSAGE-TEXT (1)          36410000
364200              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 36420000
364300              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               36430000
364400              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      36440000
364500              MOVE SQLCA       TO DP013-SQLCA                     36450000
364600              MOVE 'TWKORIN '  TO DP013-DB2-TABLE-NAME (1)        36460000
364700              SET DP013-DB2-ABEND   TO TRUE                       36470000
364800              PERFORM DP013-0000-PROCESS-ABEND                    36480000
364900     END-EVALUATE.                                                36490000
365000                                                                  36500000
365100*----------------------------------------------------------------*36510000
365200*    ALL INSTRUCTIONS HAVE BEEN COMPLETED.  SET THE PROPER       *36520000
365300*    STATUS ON ALL TABLES.                                       *36530000
365400*----------------------------------------------------------------*36540000
365500 2575-SET-STATUS.                                                 36550000
365600                                                                  36560000
365700     PERFORM 2578-COMPLETE-WORK-ORDER.                            36570000
365800     IF  ASC-LINE-NBR NOT EQUAL ZERO                              36580000
365900         PERFORM 2577-SET-ALL-STATUSES                            36590000
366000     ELSE                                                         36600000
366100         PERFORM 2576-UPDATE-REC-STATUS                           36610000
366200     END-IF.                                                      36620000
366300                                                                  36630000
366400 2576-UPDATE-REC-STATUS.                                          36640000
366500                                                                  36650000
366600     PERFORM 2565-SELECT-TRECEIV.                                 36660000
366700                                                                  36670000
366800     IF RECEIV-PACK-BY-ST-IND = 'Y'                               36680000
366900         MOVE '2576-UPDATE-REC-STATUS' TO PV-PARAGRAPH            36690000
367000         PERFORM 2580-LINK-AUDIT-MODULE                           36700000
367100         PERFORM 2581-UPDATE-TRECEIV                              36710000
367200                                                                  36720000
367300******** SHUT DOWN ALL NON-ZERO WORK ORDER INSTRUCTIONS AND SET   36730000
367400******** THE WORK ORDERS TO 'CM'.                                 36740000
367500         PERFORM 2582-COMPLETE-TWRKORD                            36750000
367600         PERFORM 2583-COMPLETE-TWKORIN                            36760000
367700     END-IF.                                                      36770000
367800                                                                  36780000
367900*----------------------------------------------------------------*36790000
368000*    IT IS NOT A ZERO LINE NUMBER SO SET THE PROPER STATUS ON    *36800000
368100*    ALL TABLES.                                                 *36810000
368200*----------------------------------------------------------------*36820000
368300 2577-SET-ALL-STATUSES.                                           36830000
368400                                                                  36840000
368500     PERFORM 2584-COUNT-TWRKORD.                                  36850000
368600     IF  PV-DB2-COUNT EQUAL ZERO                                  36860000
368700         PERFORM 2585-COUNT-TWKORIN                               36870000
368800         IF  PV-DB2-COUNT EQUAL ZERO                              36880000
368900             MOVE '2577-SET-ALL-STATUSES'  TO PV-PARAGRAPH        36890000
369000             PERFORM 2580-LINK-AUDIT-MODULE                       36900000
369100             PERFORM 2581-UPDATE-TRECEIV                          36910000
369200             PERFORM 2586-COUNT-ZEROLINE-INSTR                    36920000
369300             IF  PV-WO-STOP-COUNT > ZERO                          36930000
369400                 PERFORM 2587-SELECT-ZEROLINE-WRKORD              36940000
369500                 PERFORM 2588-UPDATE-WKORIN-DATES                 36950000
369600             END-IF                                               36960000
369700         END-IF                                                   36970000
369800     END-IF.                                                      36980000
369900                                                                  36990000
370000*----------------------------------------------------------------*37000000
370100*    SET THE STATUS CODE TO COMPLETE FOR THIS WORK ORDER.        *37010000
370200*    RATHER THAN JUST UPDATING THE "CURRENT" ROW, WE MUST        *37020000
370300*    SET THE VER_STATUS_CODE TO INACTIVE, AND INSERT A NEW       *37030000
370400*    ROW WITH THE PROPER STATUS CODE.                            *37040000
370500*----------------------------------------------------------------*37050000
370600 2578-COMPLETE-WORK-ORDER.                                        37060000
370700                                                                  37070000
370800     PERFORM 2579-UPDATE-TWRKORD.                                 37080000
370900     MOVE 'CM'     TO ASC-STATUS.                                 37090000
371000                                                                  37100000
371100*----------------------------------------------------------------*37110000
371200*    CHANGE THE CURRENT ROW TO NOT ACTIVE.                       *37120000
371300*----------------------------------------------------------------*37130000
371400 2579-UPDATE-TWRKORD.                                             37140000
371500                                                                  37150000
371600     EXEC SQL                                                     37160000
371700          UPDATE  TWRKORD                                         37170000
371800          SET   STAT_CDE           =  'CM'                        37180000
371900              , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    37190000
372000          WHERE                                                   37200000
372100                ORD_NBR            =  :ASC-PO-NBR                 37210000
372200          AND   ORD_LNE_NBR        =  :ASC-LINE-NBR               37220000
372300          AND   RCVR_SEQ_NBR       =  :ASC-RCVR-SEQ-NBR           37230000
372400          AND   WORK_ORD_SEQ_NBR   =  :ASC-WORK-ORD-SEQ-NBR       37240000
372700          AND   VER_STATUS_CDE     =  'A'                         37270000
372800     END-EXEC.                                                    37280000
372900                                                                  37290000
373000     EVALUATE TRUE                                                37300000
373100         WHEN SQLCODE = ZERO                                      37310000
373200         WHEN SQLCODE = +100                                      37320000
373300              CONTINUE                                            37330000
373400         WHEN SQLCODE = -904                                      37340000
373500         WHEN SQLCODE = -911                                      37350000
373600         WHEN SQLCODE = -913                                      37360000
373700              PERFORM 9900A-SOFT-ABORT                            37370000
373800         WHEN SQLWARN0 NOT = SPACE                                37380000
373900         WHEN SQLCODE NOT = ZERO                                  37390000
374000              MOVE '2579-UPDATE-TWRKORD'  TO DP013-PARAGRAPH      37400000
374100              MOVE 'UPDATE TWRKORD STATUS CODE'                   37410000
374200                               TO DP013-MESSAGE-TEXT (1)          37420000
374300              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 37430000
374400              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               37440000
374500              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      37450000
374600              MOVE SQLCA       TO DP013-SQLCA                     37460000
374700              MOVE 'TWRKORD'   TO DP013-DB2-TABLE-NAME (1)        37470000
374800              SET DP013-DB2-ABEND  TO TRUE                        37480000
374900              PERFORM DP013-0000-PROCESS-ABEND                    37490000
375000     END-EVALUATE.                                                37500000
375100                                                                  37510000
375200*----------------------------------------------------------------*37520000
375300*    LINK TO AUDIT MODULE * RCKCS290                             *37530000
375400*----------------------------------------------------------------*37540000
375500 2580-LINK-AUDIT-MODULE.                                          37550000
375600                                                                  37560000
375700     MOVE 'V'               TO RC031-TABLE-TO-AUDIT.              37570000
375800     MOVE 'B'               TO RC031-AUD-TYP-CDE.                 37580000
375900     MOVE 'U'               TO RC031-AUD-FUNC-CDE.                37590000
376000     MOVE ASC-OPER-UNT-ID   TO RC031-OPER-UNT-ID.                 37600000
376100     MOVE ASC-FCLTY-ID      TO RC031-FCLTY-ID.                    37610000
376200     MOVE ASC-PO-NBR        TO RC031-PO-NBR.                      37620000
376300     MOVE ASC-RCVR-SEQ-NBR  TO RC031-REC-SEQ-NBR.                 37630000
376400                                                                  37640000
376500     EXEC CICS                                                    37650000
376600          LINK PROGRAM  (RC031-AUDIT-PGM-NAME)                    37660000
376700          COMMAREA (RC031-FIELDS)                                 37670000
376800          LENGTH   (RC031-COMMAREA-LENGTH)                        37680000
376900     END-EXEC.                                                    37690000
377000                                                                  37700000
377100     EVALUATE TRUE                                                37710000
377200         WHEN RC031-CALL-SUCCESSFUL                               37720000
377300             CONTINUE                                             37730000
377400         WHEN OTHER                                               37740000
377500             MOVE '2580-LINK-AUDIT-MODULE' TO DP013-PARAGRAPH     37750000
377600             MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'                37760000
377700                                 TO DP013-MESSAGE-TEXT (1)        37770000
377800             MOVE RC031-RETURN-DESC TO DP013-MESSAGE-TEXT (2)     37780000
377900             STRING  'CALLED FROM ' PV-PARAGRAPH                  37790000
378000                                  DELIMITED BY SIZE               37800000
378100                                  INTO DP013-MESSAGE-TEXT (3)     37810000
378200             MOVE RC031-SQLCA    TO DP013-SQLCA                   37820000
378300             SET DP013-DB2-ABEND                                  37830000
378400                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              37840000
378500             PERFORM DP013-0000-PROCESS-ABEND                     37850000
378600     END-EVALUATE.                                                37860000
378700                                                                  37870000
378800*----------------------------------------------------------------*37880000
378900*    CHANGE THE CURRENT ROW TO NOT ACTIVE.                       *37890000
379000*----------------------------------------------------------------*37900000
379100 2581-UPDATE-TRECEIV.                                             37910000
379200                                                                  37920000
379300     EXEC SQL                                                     37930000
379400          UPDATE TRECEIV                                          37940000
379500          SET   STATUS_CDE         =  'CM'                        37950000
379600               ,VER_STATUS_CDE     =  'A'                         37960000
379700               ,UPD_TMST           =  CURRENT TIMESTAMP           37970000
379800               ,UPD_UID            =  :DP020-USERID               37980000
379900               ,UPD_PGM_ID         =  :PC-CURRENT-PROGRAM-NAME    37990000
380000          WHERE                                                   38000000
380100                ORD_NBR            =  :ASC-PO-NBR                 38010000
380200          AND   REC_SEQ_NBR        =  :ASC-RCVR-SEQ-NBR           38020000
380500          AND   VER_STATUS_CDE     =  'A'                         38050000
380600          AND   STATUS_CDE         =  'IP'                        38060000
380700     END-EXEC.                                                    38070000
380800                                                                  38080000
380900     EVALUATE TRUE                                                38090000
381000         WHEN SQLCODE = ZERO                                      38100000
381100         WHEN SQLCODE = +100                                      38110000
381200              CONTINUE                                            38120000
381300         WHEN SQLCODE = -904                                      38130000
381400         WHEN SQLCODE = -911                                      38140000
381500         WHEN SQLCODE = -913                                      38150000
381600              PERFORM 9900A-SOFT-ABORT                            38160000
381700         WHEN SQLWARN0 NOT = SPACE                                38170000
381800         WHEN SQLCODE NOT = ZERO                                  38180000
381900              MOVE '2581-UPDATE-TRECEIV'  TO DP013-PARAGRAPH      38190000
382000              MOVE 'UPDATE TRECEIV STATUS CODE'                   38200000
382100                               TO DP013-MESSAGE-TEXT (1)          38210000
382200              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 38220000
382300              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               38230000
382400              MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID        38240000
382500              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      38250000
382600              MOVE SQLCA       TO DP013-SQLCA                     38260000
382700              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        38270000
382800              SET DP013-DB2-ABEND    TO TRUE                      38280000
382900              PERFORM DP013-0000-PROCESS-ABEND                    38290000
383000     END-EVALUATE.                                                38300000
383100                                                                  38310000
383200 2582-COMPLETE-TWRKORD.                                           38320000
383300                                                                  38330000
383400     EXEC SQL                                                     38340000
383500          UPDATE  TWRKORD                                         38350000
383600          SET   CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    38360000
383700              , STAT_CDE           =  'CM'                        38370000
383800          WHERE ORD_NBR            =  :ASC-PO-NBR                 38380000
383900          AND   ORD_LNE_NBR        >  0                           38390000
384000          AND   RCVR_SEQ_NBR       =  :ASC-RCVR-SEQ-NBR           38400000
384300          AND   VER_STATUS_CDE     =  'A'                         38430000
384400     END-EXEC.                                                    38440000
384500                                                                  38450000
384600     EVALUATE TRUE                                                38460000
384700         WHEN SQLCODE = ZERO                                      38470000
384800         WHEN SQLCODE = +100                                      38480000
384900              CONTINUE                                            38490000
385000         WHEN SQLCODE = -904                                      38500000
385100         WHEN SQLCODE = -911                                      38510000
385200         WHEN SQLCODE = -913                                      38520000
385300              PERFORM 9900A-SOFT-ABORT                            38530000
385400         WHEN SQLWARN0 NOT = SPACE                                38540000
385500         WHEN SQLCODE NOT = ZERO                                  38550000
385600              MOVE '2582-COMPLETE-TWRKORD'  TO DP013-PARAGRAPH    38560000
385700              MOVE 'SET THE STATUS TO COMPLETE FOR ALL TWRKORD'   38570000
385800                               TO DP013-MESSAGE-TEXT (1)          38580000
385900              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 38590000
386000              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               38600000
386100              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      38610000
386200              MOVE SQLCA       TO DP013-SQLCA                     38620000
386300              MOVE 'TWRKORD '  TO DP013-DB2-TABLE-NAME (1)        38630000
386400              SET DP013-DB2-ABEND       TO TRUE                   38640000
386500              PERFORM DP013-0000-PROCESS-ABEND                    38650000
386600     END-EVALUATE.                                                38660000
386700                                                                  38670000
386800 2583-COMPLETE-TWKORIN.                                           38680000
386900                                                                  38690000
387000     EXEC SQL                                                     38700000
387100          UPDATE  TWKORIN                                         38710000
387200          SET   STRT_TMST          =  CURRENT TIMESTAMP           38720000
387300              , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    38730000
387400          WHERE ORD_NBR            =  :ASC-PO-NBR                 38740000
387500          AND   ORD_LNE_NBR        >  0                           38750000
387600          AND   RCVR_SEQ_NBR       =  :ASC-RCVR-SEQ-NBR           38760000
387900          AND   VER_STATUS_CDE     =  'A'                         38790000
388000          AND   STRT_TMST          >  CURRENT TIMESTAMP           38800000
388100     END-EXEC.                                                    38810000
388200                                                                  38820000
388300     EVALUATE TRUE                                                38830000
388400         WHEN SQLCODE = ZERO                                      38840000
388500         WHEN SQLCODE = +100                                      38850000
388600              CONTINUE                                            38860000
388700         WHEN SQLCODE = -904                                      38870000
388800         WHEN SQLCODE = -911                                      38880000
388900         WHEN SQLCODE = -913                                      38890000
389000              PERFORM 9900A-SOFT-ABORT                            38900000
389100         WHEN SQLWARN0 NOT = SPACE                                38910000
389200         WHEN SQLCODE NOT = ZERO                                  38920000
389300              MOVE '2583-COMPLETE-TWKORIN' TO DP013-PARAGRAPH     38930000
389400              MOVE 'SET THE START TIMESTAMP FOR ALL TWKORIN'      38940000
389500                               TO DP013-MESSAGE-TEXT (1)          38950000
389600              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 38960000
389700              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               38970000
389800              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      38980000
389900              MOVE SQLCA       TO DP013-SQLCA                     38990000
390000              MOVE 'TWKORIN '  TO DP013-DB2-TABLE-NAME (1)        39000000
390100              SET DP013-DB2-ABEND   TO TRUE                       39010000
390200              PERFORM DP013-0000-PROCESS-ABEND                    39020000
390300     END-EVALUATE.                                                39030000
390400                                                                  39040000
390500     EXEC SQL                                                     39050000
390600          UPDATE  TWKORIN                                         39060000
390700          SET   STOP_TMST          =  CURRENT TIMESTAMP           39070000
390800              , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    39080000
390900          WHERE ORD_NBR            =  :ASC-PO-NBR                 39090000
391000          AND   ORD_LNE_NBR        >  0                           39100000
391100          AND   RCVR_SEQ_NBR       =  :ASC-RCVR-SEQ-NBR           39110000
391400          AND   VER_STATUS_CDE     =  'A'                         39140000
391500          AND   STOP_TMST          >  CURRENT TIMESTAMP           39150000
391600     END-EXEC.                                                    39160000
391700                                                                  39170000
391800     EVALUATE TRUE                                                39180000
391900         WHEN SQLCODE = ZERO                                      39190000
392000         WHEN SQLCODE = +100                                      39200000
392100              CONTINUE                                            39210000
392200         WHEN SQLCODE = -904                                      39220000
392300         WHEN SQLCODE = -911                                      39230000
392400         WHEN SQLCODE = -913                                      39240000
392500              PERFORM 9900A-SOFT-ABORT                            39250000
392600         WHEN SQLWARN0 NOT = SPACE                                39260000
392700         WHEN SQLCODE NOT = ZERO                                  39270000
392800              MOVE '2583-COMPLETE-TWKORIN' TO DP013-PARAGRAPH     39280000
392900              MOVE 'SET THE STOP TIMESTAMP FOR ALL TWKORIN'       39290000
393000                               TO DP013-MESSAGE-TEXT (1)          39300000
393100              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 39310000
393200              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               39320000
393300              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      39330000
393400              MOVE SQLCA       TO DP013-SQLCA                     39340000
393500              MOVE 'TWKORIN '  TO DP013-DB2-TABLE-NAME (1)        39350000
393600              SET DP013-DB2-ABEND TO TRUE                         39360000
393700              PERFORM DP013-0000-PROCESS-ABEND                    39370000
393800     END-EVALUATE.                                                39380000
393900                                                                  39390000
394000*----------------------------------------------------------------*39400000
394100*    SEE IF THERE ARE ANY OTHER ORDERS TO COMPLETE.              *39410000
394200*----------------------------------------------------------------*39420000
394300 2584-COUNT-TWRKORD.                                              39430000
394400                                                                  39440000
394500     MOVE ZERO            TO PV-DB2-COUNT.                        39450000
394600     EXEC SQL                                                     39460000
394700          SELECT COUNT(*)                                         39470000
394800          INTO  :PV-DB2-COUNT :PV-NULL-IND                        39480000
394900          FROM  TWRKORD                                           39490000
395000          WHERE ORD_NBR            =  :ASC-PO-NBR                 39500000
395100          AND   ORD_LNE_NBR        =  :ASC-LINE-NBR               39510000
395200          AND   RCVR_SEQ_NBR       =  :ASC-RCVR-SEQ-NBR           39520000
395500          AND   STAT_CDE          <>  'CM'                        39550000
395600          AND   VER_STATUS_CDE     =  'A'                         39560000
395700     END-EXEC.                                                    39570000
395800                                                                  39580000
395900     EVALUATE TRUE                                                39590000
396000         WHEN SQLCODE = ZERO                                      39600000
396100         WHEN SQLCODE = +100                                      39610000
396200              CONTINUE                                            39620000
396300         WHEN SQLCODE = -904                                      39630000
396400         WHEN SQLCODE = -911                                      39640000
396500         WHEN SQLCODE = -913                                      39650000
396600              PERFORM 9900A-SOFT-ABORT                            39660000
396700         WHEN SQLWARN0 NOT = SPACE                                39670000
396800         WHEN SQLCODE NOT = ZERO                                  39680000
396900              MOVE '2584-COUNT-TWRKORD' TO DP013-PARAGRAPH        39690000
397000              MOVE 'COUNT NUMBER OF WORK ORDERS NOT COMPLETE'     39700000
397100                               TO DP013-MESSAGE-TEXT (1)          39710000
397200              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 39720000
397300              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               39730000
397400              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      39740000
397500              MOVE SQLCA       TO DP013-SQLCA                     39750000
397600              MOVE 'TWRKORD '  TO DP013-DB2-TABLE-NAME (1)        39760000
397700              SET DP013-DB2-ABEND   TO TRUE                       39770000
397800              PERFORM DP013-0000-PROCESS-ABEND                    39780000
397900     END-EVALUATE.                                                39790000
398000                                                                  39800000
398100*----------------------------------------------------------------*39810000
398200*    SEE IF THERE ARE ANY OTHER ORDERS TO COMPLETE.              *39820000
398300*----------------------------------------------------------------*39830000
398400 2585-COUNT-TWKORIN.                                              39840000
398500                                                                  39850000
398600     MOVE ZERO            TO PV-DB2-COUNT.                        39860000
398700     EXEC SQL                                                     39870000
398800          SELECT COUNT(*)                                         39880000
398900          INTO  :PV-DB2-COUNT :PV-NULL-IND                        39890000
399000          FROM  TWKORIN                                           39900000
399100          WHERE  ORD_NBR            =  :ASC-PO-NBR                39910000
399200            AND  RCVR_SEQ_NBR       =  :ASC-RCVR-SEQ-NBR          39920000
399500            AND  ORD_LNE_NBR        >  0                          39950000
399600            AND  VER_STATUS_CDE     =  'A'                        39960000
399700            AND (STOP_TMST          =  :PC-DB2-DEFAULT-TMST       39970000
399800             OR  STOP_TMST          =  :PC-DB2-DUMMY-TMST)        39980000
399900     END-EXEC.                                                    39990000
400000                                                                  40000000
400100     EVALUATE TRUE                                                40010000
400200         WHEN SQLCODE = ZERO                                      40020000
400300         WHEN SQLCODE = +100                                      40030000
400400              CONTINUE                                            40040000
400500         WHEN SQLCODE = -904                                      40050000
400600         WHEN SQLCODE = -911                                      40060000
400700         WHEN SQLCODE = -913                                      40070000
400800              PERFORM 9900A-SOFT-ABORT                            40080000
400900         WHEN SQLWARN0 NOT = SPACE                                40090000
401000         WHEN SQLCODE NOT = ZERO                                  40100000
401100              MOVE '2585-COUNT-TWKORIN' TO DP013-PARAGRAPH        40110000
401200              MOVE 'COUNT NUMBER OF WORK ORDERS NOT COMPLETE'     40120000
401300                               TO DP013-MESSAGE-TEXT (1)          40130000
401400              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 40140000
401500              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               40150000
401600              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      40160000
401700              MOVE SQLCA       TO DP013-SQLCA                     40170000
401800              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        40180000
401900              SET DP013-DB2-ABEND   TO TRUE                       40190000
402000              PERFORM DP013-0000-PROCESS-ABEND                    40200000
402100     END-EVALUATE.                                                40210000
402200                                                                  40220000
402300 2586-COUNT-ZEROLINE-INSTR.                                       40230000
402400                                                                  40240000
402500     MOVE ZERO            TO PV-WO-STOP-COUNT.                    40250000
402600     EXEC SQL                                                     40260000
402700          SELECT  COUNT(*)                                        40270000
402800          INTO  :PV-WO-STOP-COUNT :PV-NULL-IND                    40280000
402900          FROM  TWKORIN                                           40290000
403000          WHERE                                                   40300000
403100                ORD_NBR            =  :ASC-PO-NBR                 40310000
403200          AND   ORD_LNE_NBR        =  0                           40320000
403300          AND   RCVR_SEQ_NBR       =  :ASC-RCVR-SEQ-NBR           40330000
403600          AND   VER_STATUS_CDE     =  'A'                         40360000
403700          AND   DATE(STOP_TMST)    =  DATE(:PC-DEF-DATE)          40370000
403800     END-EXEC.                                                    40380000
403900                                                                  40390000
404000     EVALUATE TRUE                                                40400000
404100         WHEN SQLCODE = ZERO                                      40410000
404200         WHEN SQLCODE = +100                                      40420000
404300              CONTINUE                                            40430000
404400         WHEN SQLCODE = -904                                      40440000
404500         WHEN SQLCODE = -911                                      40450000
404600         WHEN SQLCODE = -913                                      40460000
404700              PERFORM 9900A-SOFT-ABORT                            40470000
404800         WHEN SQLWARN0 NOT = SPACE                                40480000
404900         WHEN SQLCODE NOT = ZERO                                  40490000
405000              MOVE '2586-COUNT-ZEROLINE-INSTR'  TO DP013-PARAGRAPH40500000
405100              MOVE 'COUNT NUMBER OF 0 LINE INSTR NOT COMPLETE'    40510000
405200                               TO DP013-MESSAGE-TEXT (1)          40520000
405300              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 40530000
405400              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               40540000
405500              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      40550000
405600              MOVE SQLCA       TO DP013-SQLCA                     40560000
405700              MOVE 'TWKORIN '  TO DP013-DB2-TABLE-NAME (1)        40570000
405800              SET DP013-DB2-ABEND    TO TRUE                      40580000
405900              PERFORM DP013-0000-PROCESS-ABEND                    40590000
406000     END-EVALUATE.                                                40600000
406100                                                                  40610000
406200 2587-SELECT-ZEROLINE-WRKORD.                                     40620000
406300                                                                  40630000
406400     EXEC SQL                                                     40640000
406500          SELECT   ACTL_CART_CNT                                  40650000
406600            INTO :WRKORD-ACTL-CART-CNT                            40660000
406700            FROM  TWRKORD                                         40670000
406800          WHERE ORD_NBR            =  :ASC-PO-NBR                 40680000
406900          AND   ORD_LNE_NBR        =  0                           40690000
407000          AND   RCVR_SEQ_NBR       =  :ASC-RCVR-SEQ-NBR           40700000
407100          AND   WORK_ORD_SEQ_NBR   =  :ASC-WORK-ORD-SEQ-NBR       40710000
407400          AND   VER_STATUS_CDE     =  'A'                         40740000
407500     END-EXEC.                                                    40750000
407600                                                                  40760000
407700     EVALUATE TRUE                                                40770000
407800         WHEN SQLCODE = ZERO                                      40780000
407900         WHEN SQLCODE = +100                                      40790000
408000              CONTINUE                                            40800000
408100         WHEN SQLCODE = -904                                      40810000
408200         WHEN SQLCODE = -911                                      40820000
408300         WHEN SQLCODE = -913                                      40830000
408400              PERFORM 9900A-SOFT-ABORT                            40840000
408500         WHEN SQLWARN0 NOT = SPACE                                40850000
408600         WHEN SQLCODE NOT = ZERO                                  40860000
408700              MOVE '2587-SELECT-ZEROLINE-WRKOR' TO DP013-PARAGRAPH40870000
408800              MOVE 'SELECT TWRKORD'                               40880000
408900                               TO DP013-MESSAGE-TEXT (1)          40890000
409000              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 40900000
409100              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               40910000
409200              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      40920000
409300              MOVE SQLCA       TO DP013-SQLCA                     40930000
409400              MOVE 'TWRKORD'   TO DP013-DB2-TABLE-NAME (1)        40940000
409500              SET DP013-DB2-ABEND     TO TRUE                     40950000
409600              PERFORM DP013-0000-PROCESS-ABEND                    40960000
409700     END-EVALUATE.                                                40970000
409800                                                                  40980000
409900*----------------------------------------------------------------*40990000
410000*    STEP THROUGH ALL ROWS RETURNED FROM THE CURSOR.             *41000000
410100*    UPDATE THE TWRKORD ROW TO COMPLETE.                         *41010000
410200*----------------------------------------------------------------*41020000
410300 2588-UPDATE-WKORIN-DATES.                                        41030000
410400                                                                  41040000
410500     PERFORM 2590-OPEN-WKORIN-CSR.                                41050000
410600     IF  SQLCODE EQUAL ZERO                                       41060000
410700         PERFORM 2591-PROCESS-WKORIN-UPDATES                      41070000
410800             UNTIL SQLCODE NOT EQUAL ZERO                         41080000
410900         PERFORM 2595-CLOSE-WKORIN-CSR                            41090000
411000         MOVE ASC-LINE-NBR    TO PV-KEY-LINE-NBR                  41100000
411100         MOVE ZERO            TO ASC-LINE-NBR                     41110000
411200         MOVE ASC-STATUS      TO PV-STATUS-CDE                    41120000
411300         PERFORM 2578-COMPLETE-WORK-ORDER                         41130000
411400         MOVE PV-KEY-LINE-NBR   TO ASC-LINE-NBR                   41140000
411500         MOVE PV-STATUS-CDE     TO ASC-STATUS                     41150000
411600     END-IF.                                                      41160000
411700                                                                  41170000
411800*----------------------------------------------------------------*41180000
411900*    HERE WE OPEN THE ZEROLINE CURSOR.                           *41190000
412000*----------------------------------------------------------------*41200000
412100 2590-OPEN-WKORIN-CSR.                                            41210000
412200                                                                  41220000
412300     EXEC SQL                                                     41230000
412400          OPEN ZEROLINE                                           41240000
412500     END-EXEC.                                                    41250000
412600                                                                  41260000
412700     EVALUATE TRUE                                                41270000
412800         WHEN SQLCODE = ZERO                                      41280000
412900         WHEN SQLCODE = +100                                      41290000
413000              CONTINUE                                            41300000
413100         WHEN SQLCODE = -904                                      41310000
413200         WHEN SQLCODE = -911                                      41320000
413300         WHEN SQLCODE = -913                                      41330000
413400              PERFORM 9900A-SOFT-ABORT                            41340000
413500         WHEN SQLWARN0 NOT = SPACES                               41350000
413600         WHEN SQLCODE < ZERO                                      41360000
413700         WHEN SQLCODE > ZERO                                      41370000
413800             MOVE '2590-OPEN-WKORIN-CSR'  TO DP013-PARAGRAPH      41380000
413900             MOVE 'OPEN ZEROLINE CURSOR - '                       41390000
414000                                   TO DP013-MESSAGE-TEXT (1)      41400000
414100             MOVE SQLCA        TO DP013-SQLCA                     41410000
414200             MOVE 'TWKORIN '   TO DP013-DB2-TABLE-NAME (1)        41420000
414300                 SET DP013-DB2-ABEND                              41430000
414400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           41440000
414500                 PERFORM DP013-0000-PROCESS-ABEND                 41450000
414600     END-EVALUATE.                                                41460000
414700                                                                  41470000
414800*----------------------------------------------------------------*41480000
414900*    FETCH, UPDATE, AND INSERT.                                  *41490000
415000*----------------------------------------------------------------*41500000
415100 2591-PROCESS-WKORIN-UPDATES.                                     41510000
415200                                                                  41520000
415300     PERFORM 2592-FETCH-ZEROLINE.                                 41530000
415400     IF  SQLCODE EQUAL ZERO                                       41540000
415500         IF  WKORIN-STRT-TMST GREATER PV-DUMMY-TMST               41550000
415600             EXEC SQL                                             41560000
415700                  SET :WKORIN-STRT-TMST = CURRENT TIMESTAMP       41570000
415800             END-EXEC                                             41580000
415900         END-IF                                                   41590000
416000         EXEC SQL                                                 41600000
416100              SET :WKORIN-STOP-TMST = CURRENT TIMESTAMP           41610000
416200         END-EXEC                                                 41620000
416300         PERFORM 2593-UPDATE-ZEROLINE                             41630000
416400     END-IF.                                                      41640000
416500                                                                  41650000
416600 2592-FETCH-ZEROLINE.                                             41660000
416700                                                                  41670000
416800     EXEC SQL                                                     41680000
416900          FETCH ZEROLINE                                          41690000
417000          INTO :WKORIN-ORD-NBR                                    41700000
417100             , :WKORIN-RCVR-SEQ-NBR                               41710000
417200             , :WKORIN-ORD-LNE-NBR                                41720000
417300             , :WKORIN-WORK-ORD-SEQ-NBR                           41730000
417400             , :WKORIN-OPER-UNT-ID                                41740000
417500             , :WKORIN-FCLTY-ID                                   41750000
417600             , :WKORIN-WO-INSTR-SEQ-NBR                           41760000
417700             , :WKORIN-CRE-TMST                                   41770000
417800             , :WKORIN-VER-STATUS-CDE                             41780000
417900             , :WKORIN-CRE-UID-ID                                 41790000
418000             , :WKORIN-OPER-ID                                    41800000
418100             , :WKORIN-FCLTY-AREA-ID                              41810000
418200             , :WKORIN-PRC-FCLTY-AREA-ID                          41820000
418300             , :WKORIN-EXPTED-CART-CNT                            41830000
418400             , :WKORIN-ACTL-CART-CNT                              41840000
418500             , :WKORIN-ALLOC-IND                                  41850000
418600             , :WKORIN-REPACK-IND                                 41860000
418700             , :WKORIN-STRT-TMST                                  41870000
418800             , :WKORIN-STOP-TMST                                  41880000
418900             , :WKORIN-SCREEN-SEQ-NBR                             41890000
419000             , :WKORIN-LNE-LOC-CDE                                41900000
419100             , :WKORIN-REC-SEL-IND                                41910000
419200     END-EXEC.                                                    41920000
419300                                                                  41930000
419400     EVALUATE TRUE                                                41940000
419500         WHEN SQLCODE = ZERO                                      41950000
419600         WHEN SQLCODE = +100                                      41960000
419700              CONTINUE                                            41970000
419800         WHEN SQLCODE = -904                                      41980000
419900         WHEN SQLCODE = -911                                      41990000
420000         WHEN SQLCODE = -913                                      42000000
420100              PERFORM 9900A-SOFT-ABORT                            42010000
420200         WHEN SQLWARN0 NOT = SPACE                                42020000
420300         WHEN SQLCODE NOT = ZERO                                  42030000
420400              MOVE '2592-FETCH-ZEROLINE' TO DP013-PARAGRAPH       42040000
420500              MOVE 'FETCH ZEROLINE CUROSR'                        42050000
420600                               TO DP013-MESSAGE-TEXT (1)          42060000
420700              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 42070000
420800              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               42080000
420900              MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID        42090000
421000              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      42100000
421100              MOVE SQLCA       TO DP013-SQLCA                     42110000
421200              MOVE 'TWKORIN '  TO DP013-DB2-TABLE-NAME (1)        42120000
421300              SET DP013-DB2-ABEND  TO TRUE                        42130000
421400              PERFORM DP013-0000-PROCESS-ABEND                    42140000
421500     END-EVALUATE.                                                42150000
421600                                                                  42160000
421700 2593-UPDATE-ZEROLINE.                                            42170000
421800                                                                  42180000
421900     EXEC SQL                                                     42190000
422000          UPDATE TWKORIN                                          42200000
422100          SET   STOP_TMST         =  :WKORIN-STOP-TMST            42210000
422200              , STRT_TMST         =  :WKORIN-STRT-TMST            42220000
422300              , CRE_UID_ID        =  :PC-CURRENT-PROGRAM-NAME     42230000
422400          WHERE                                                   42240000
422500                CURRENT OF ZEROLINE                               42250000
422600     END-EXEC.                                                    42260000
422700                                                                  42270000
422800     EVALUATE TRUE                                                42280000
422900         WHEN SQLCODE = ZERO                                      42290000
423000              CONTINUE                                            42300000
423100         WHEN SQLCODE = -904                                      42310000
423200         WHEN SQLCODE = -911                                      42320000
423300         WHEN SQLCODE = -913                                      42330000
423400              PERFORM 9900A-SOFT-ABORT                            42340000
423500         WHEN SQLWARN0 NOT = SPACE                                42350000
423600         WHEN SQLCODE NOT = ZERO                                  42360000
423700              MOVE '2593-UPDATE-ZEROLINE' TO DP013-PARAGRAPH      42370000
423800              MOVE 'UPDATE START/STOP TIMESTAMPS'                 42380000
423900                               TO DP013-MESSAGE-TEXT (1)          42390000
424000              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 42400000
424100              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               42410000
424200              MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID        42420000
424300              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      42430000
424400              MOVE SQLCA       TO DP013-SQLCA                     42440000
424500              MOVE 'TWKORIN '  TO DP013-DB2-TABLE-NAME (1)        42450000
424600              SET DP013-DB2-ABEND    TO TRUE                      42460000
424700              PERFORM DP013-0000-PROCESS-ABEND                    42470000
424800     END-EVALUATE.                                                42480000
424900                                                                  42490000
425000 2595-CLOSE-WKORIN-CSR.                                           42500000
425100                                                                  42510000
425200     EXEC SQL                                                     42520000
425300          CLOSE ZEROLINE                                          42530000
425400     END-EXEC.                                                    42540000
425500                                                                  42550000
425600     EVALUATE TRUE                                                42560000
425700         WHEN SQLCODE = ZERO                                      42570000
425800         WHEN SQLCODE = +100                                      42580000
425900              CONTINUE                                            42590000
426000         WHEN SQLCODE = -904                                      42600000
426100         WHEN SQLCODE = -911                                      42610000
426200         WHEN SQLCODE = -913                                      42620000
426300              PERFORM 9900A-SOFT-ABORT                            42630000
426400         WHEN SQLWARN0 NOT = SPACES                               42640000
426500         WHEN SQLCODE < ZERO                                      42650000
426600         WHEN SQLCODE > ZERO                                      42660000
426700              MOVE '2595-CLOSE-WKORIN-CSR' TO DP013-PARAGRAPH     42670000
426800              MOVE 'CLOSE ZEROLINE CURSOR - '                     42680000
426900                                   TO DP013-MESSAGE-TEXT (1)      42690000
427000              MOVE SQLCA       TO DP013-SQLCA                     42700000
427100              MOVE 'TWKORIN '  TO DP013-DB2-TABLE-NAME (1)        42710000
427200              SET DP013-DB2-ABEND                                 42720000
427300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           42730000
427400              PERFORM DP013-0000-PROCESS-ABEND                    42740000
427500     END-EVALUATE.                                                42750000
427600                                                                  42760000
427700*----------------------------------------------------------------*42770000
427800*    UPDATE THE ROW, ASC, AND MAP.                               *42780000
427900*    REMOVE THE STOP DATE AND TIME FROM THE SELECTED LINE        *42790000
428000*    ALSO REMOVE THE START AND STOP DATE AND TIME FROM ALL LINES *42800000
428100*    WITH A HIGHER SEQUENCE NUMBER THAN THE LINE SELECTED        *42810000
428200*    UPDATE THE STATUS OF TRECEIV TO 'IP' IF IT IS 'CM'          *42820000
428300*    UPDATE THE STATUS OF TWRKORD TO 'IP' IF IT IS 'CM'          *42830000
428400*----------------------------------------------------------------*42840000
428500 2600-PROCESS-RESTART.                                            42850000
428600                                                                  42860000
428700     MOVE HIGH-VALUES           TO PV-START-DATE                  42870000
428800                                   PV-STOP-DATE                   42880000
428900                                   PV-NEXT-START-DATE.            42890000
429000     PERFORM VARYING PV-SUB                                       42900000
429100         FROM ASC-ITEM-SUB BY -1                                  42910000
429200         UNTIL PV-SUB < +1                                        42920000
429300                                                                  42930000
429400         EVALUATE TRUE                                            42940000
429500             WHEN ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)          42950000
429600                  MOVE ASC-DATE-STRT(ASC-BLK-SUB ASC-ITEM-SUB)    42960000
429700                                TO PV-START-DATE                  42970000
429800                  MOVE ASC-DATE-COMP(ASC-BLK-SUB ASC-ITEM-SUB)    42980000
429900                                TO PV-STOP-DATE                   42990000
430000                  MOVE PV-SUB   TO PV-SUB2                        43000000
430200                  SUBTRACT PC-ITEMS-PER-PANEL  FROM  PV-SUB       43020000
430300             WHEN OTHER                                           43030000
430400                  SUBTRACT +1 FROM ASC-ITEM-SUB                   43040000
430500                  IF  ASC-ITEM-SUB < 1                            43050000
430600                      SUBTRACT +1 FROM ASC-BLK-SUB                43060000
430700                      MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB     43070000
430800                  END-IF                                          43080000
430900         END-EVALUATE                                             43090000
431000     END-PERFORM.                                                 43100000
431100                                                                  43110000
431200     IF  PV-START-DATE EQUAL HIGH-VALUES                          43120000
431300         MOVE PC-TSYMSG-00057   TO DP020-MSG-NUMBER               43130000
431400         SET DP020-MSG-FATAL                                      43140000
431500             PS-ERROR           TO TRUE                           43150000
431600     ELSE                                                         43160000
431700         IF  PV-START-DATE EQUAL SPACES                           43170000
431800             MOVE PC-TSYMSG-00916   TO DP020-MSG-NUMBER           43180000
431900             SET DP020-MSG-FATAL                                  43190000
432000                 PS-ERROR           TO TRUE                       43200000
432200             SET DP030-SET-CURSOR-APPL-1  TO TRUE                 43220000
432300             MOVE DP015-RED        TO MR-SELECTC (PV-SUB2)        43230000
432400             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB2)        43240000
432500         ELSE                                                     43250000
432600             IF PV-STOP-DATE EQUAL SPACES                         43260000
432700**  'THE RESTART FUNCTION CAN ONLY BE USED ON INSTRUCTIONS THAT   43270000
432800**   ARE STOPPED'                                                 43280000
432900                MOVE PC-TSYMSG-02832  TO DP020-MSG-NUMBER         43290000
433000                SET DP020-MSG-FATAL                               43300000
433100                    PS-ERROR          TO TRUE                     43310000
433300                SET DP030-SET-CURSOR-APPL-1   TO TRUE             43330000
433400                MOVE DP015-RED        TO MR-SELECTC (PV-SUB2)     43340000
433500                MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB2)     43350000
433600         END-IF                                                   43360000
433700     END-IF.                                                      43370000
433800                                                                  43380000
433900     IF PS-ERROR                                                  43390000
434000         CONTINUE                                                 43400000
434100     ELSE                                                         43410000
434200         MOVE ASC-WO-INSTR-SEQ-NBR (ASC-BLK-SUB ASC-ITEM-SUB)     43420000
434300                                    TO WKORIN-WO-INSTR-SEQ-NBR    43430000
434400                                       PV-WO-INSTR-SEQ-NBR        43440000
434500         PERFORM 2660-COUNT-TWKORIN                               43450000
434600         IF  SQLCODE EQUAL ZERO                                   43460000
434700             IF PV-DB2-COUNT > 0                                  43470000
434800**  ONLY THE LATEST STOPPED INSTRUCTION CAN BE RESTARTED          43480000
434900                 MOVE PC-TSYMSG-02833  TO DP020-MSG-NUMBER        43490000
435000                 SET DP020-MSG-FATAL                              43500000
435100                     PS-ERROR       TO TRUE                       43510000
435300                 SET DP030-SET-CURSOR-APPL-1   TO TRUE            43530000
435400                 MOVE DP015-RED     TO MR-SELECTC (PV-SUB2)       43540000
435500                 MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB2)       43550000
435600             END-IF                                               43560000
435700         END-IF                                                   43570000
435800     END-IF.                                                      43580000
435900                                                                  43590000
436000     IF PS-ERROR                                                  43600000
436100         CONTINUE                                                 43610000
436200     ELSE                                                         43620000
436300         IF DP020-FK-LOCAL-FUNC-08(DP020-SRC-AID)                 43630000
436400***   PRESS F2 TO CONFIRM REQUEST                                 43640000
436500             SET ASC-RESTRT-WO-CONFIRM  TO TRUE                   43650000
436600             MOVE PC-TSYMSG-00004 TO DP020-MSG-NUMBER             43660000
436700             SET DP020-MSG-WARNING TO TRUE                        43670000
436800         ELSE                                                     43680000
436900             PERFORM 2605-PROCESS-NEXT-INSTRUCTION                43690000
437000             PERFORM 2610-RESTART-INSTRUCTION                     43700000
437100             MOVE SPACES       TO ASC-TIME-COMP                   43710000
437200                                  (ASC-BLK-SUB ASC-ITEM-SUB)      43720000
437300                                   MR-TIME-COMP (PV-SUB2)         43730000
437400                                  ASC-DATE-COMP                   43740000
437500                                  (ASC-BLK-SUB ASC-ITEM-SUB)      43750000
437600                                   MR-DATE-COMP (PV-SUB2)         43760000
437800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  43780000
437900** DMH 7/27  MOVE 'IP'             TO ASC-STATUS                  43790000
438000             MOVE PC-TSYMSG-02835  TO DP020-MSG-NUMBER            43800000
438100             SET DP020-MSG-INFORMATIONAL TO TRUE                  43810000
438200             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          43820000
438300             SET ASC-NO-CONFIRM                  TO TRUE          43830000
438400     END-IF.                                                      43840000
438500                                                                  43850000
438600     EVALUATE PV-SUB2                                             43860000
438700     WHEN 1                                                       43870000
438800         SET ASC-CSR-SELECT-1         TO TRUE                     43880000
438900     WHEN 2                                                       43890000
439000         SET ASC-CSR-SELECT-2         TO TRUE                     43900000
439100     WHEN 3                                                       43910000
439200         SET ASC-CSR-SELECT-3         TO TRUE                     43920000
439300     END-EVALUATE.                                                43930000
439400                                                                  43940000
439500 2605-PROCESS-NEXT-INSTRUCTION.                                   43950000
439600     IF  ASC-ITEM-SUB LESS THAN PC-ITEMS-PER-PANEL                43960000
439700         COMPUTE PV-ITM  = ASC-ITEM-SUB + 1                       43970000
439800         MOVE ASC-DATE-STRT (ASC-BLK-SUB PV-ITM)                  43980000
439900                                TO PV-NEXT-START-DATE             43990000
440000         MOVE ASC-WO-INSTR-SEQ-NBR (ASC-BLK-SUB PV-ITM)           44000000
440100                                TO PV-NEXT-INSTR-SEQ              44010000
440200         MOVE ASC-BLK-SUB       TO PV-HOLD-BLK                    44020000
440300         MOVE PV-ITM            TO PV-HOLD-ITEM                   44030000
440400     ELSE                                                         44040000
440500         IF  ASC-BLK-SUB EQUAL TO 1                               44050000
440600             COMPUTE PV-BLK = ASC-BLK-SUB + 1                     44060000
440700             MOVE ASC-DATE-STRT (PV-BLK 1)                        44070000
440800                                TO PV-NEXT-START-DATE             44080000
440900             MOVE PV-BLK        TO PV-HOLD-BLK                    44090000
441000             MOVE PC-ITEMS-PER-PANEL                              44100000
441100                                TO PV-HOLD-ITEM                   44110000
441200             MOVE ASC-WO-INSTR-SEQ-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 44120000
441300                                TO PV-NEXT-INSTR-SEQ              44130000
441400             ADD +1 TO PV-NEXT-INSTR-SEQ                          44140000
441500         END-IF                                                   44150000
441600     END-IF.                                                      44160000
441700                                                                  44170000
441800     IF  PV-NEXT-START-DATE NOT EQUAL SPACES                      44180000
441900         MOVE ASC-BLK-SUB   TO PV-BLK                             44190000
442000         MOVE ASC-ITEM-SUB  TO PV-ITM                             44200000
442100         MOVE PV-HOLD-BLK   TO ASC-BLK-SUB                        44210000
442200         MOVE PV-HOLD-ITEM  TO ASC-ITEM-SUB                       44220000
442300                               PV-SUB2                            44230000
442400         PERFORM 2690-CHG-START-TWRKORD                           44240000
442500         IF SQLCODE = ZERO                                        44250000
442600             MOVE SPACES       TO ASC-TIME-STRT                   44260000
442700                                  (ASC-BLK-SUB ASC-ITEM-SUB)      44270000
442800                                   MR-TIME-STRT (PV-SUB2)         44280000
442900                                  ASC-DATE-STRT                   44290000
443000                                  (ASC-BLK-SUB ASC-ITEM-SUB)      44300000
443100                                   MR-DATE-STRT (PV-SUB2)         44310000
443200         END-IF                                                   44320000
443300         MOVE PV-BLK        TO ASC-BLK-SUB                        44330000
443400         MOVE PV-ITM        TO ASC-ITEM-SUB                       44340000
443500                               PV-SUB2                            44350000
443600     END-IF.                                                      44360000
443700                                                                  44370000
443800 2610-RESTART-INSTRUCTION.                                        44380000
443900     PERFORM 2650-UPDATE-TWKORIN.                                 44390000
444000     PERFORM 2620-SELECT-TRECEIV.                                 44400000
444100     IF SQLCODE EQUAL ZERO AND RECEIV-STATUS-CDE = 'CM'           44410000
444200         MOVE '2610-RESTART-INSTRUCTION' TO PV-PARAGRAPH          44420000
444300         PERFORM 2580-LINK-AUDIT-MODULE                           44430000
444400         PERFORM 2630-UPDATE-TRECEIV                              44440000
444500     END-IF.                                                      44450000
444600     PERFORM 2670-UPDATE-TWRKORD.                                 44460000
444700     IF ASC-LINE-NBR = 0                                          44470000
444800         PERFORM 2680-UPDATE-ALL-TWRKORD                          44480000
444900     END-IF.                                                      44490000
445000                                                                  44500000
445100     IF  PS-ERROR                                                 44510000
445200         CONTINUE                                                 44520000
445300     ELSE                                                         44530000
445400         SET ASC-TEMP-NO-SELECT (1, 1)                            44540000
445500             ASC-TEMP-NO-SELECT (1, 2)                            44550000
445600             ASC-TEMP-NO-SELECT (1, 3)                            44560000
445700                                      TO TRUE                     44570000
445800     END-IF.                                                      44580000
445810                                                                  44581001
445820                                                                  44582001
445900*----------------------------------------------------------------*44590000
446000*    CHANGE THE CURRENT ROW TO IN PROCESS.                       *44600000
446100*----------------------------------------------------------------*44610000
446200 2620-SELECT-TRECEIV.                                             44620000
446300                                                                  44630000
446400     EXEC SQL                                                     44640000
446500          SELECT STATUS_CDE                                       44650000
446600          INTO  :RECEIV-STATUS-CDE                                44660000
446700          FROM  TRECEIV                                           44670000
446800          WHERE ORD_NBR            =  :ASC-PO-NBR                 44680000
446900          AND   REC_SEQ_NBR        =  :ASC-RCVR-SEQ-NBR           44690000
447200          AND   VER_STATUS_CDE     =  'A'                         44720000
447300     END-EXEC.                                                    44730000
447400                                                                  44740000
447500     EVALUATE TRUE                                                44750000
447600         WHEN SQLCODE = ZERO                                      44760000
447700         WHEN SQLCODE = +100                                      44770000
447800              CONTINUE                                            44780000
447900         WHEN SQLCODE = -904                                      44790000
448000         WHEN SQLCODE = -911                                      44800000
448100         WHEN SQLCODE = -913                                      44810000
448200              PERFORM 9900A-SOFT-ABORT                            44820000
448300         WHEN SQLWARN0 NOT = SPACE                                44830000
448400         WHEN SQLCODE NOT = ZERO                                  44840000
448500              MOVE '2620-SELECT-TRECEIV' TO DP013-PARAGRAPH       44850000
448600              MOVE 'SELECT TRECEIV STATUS CODE'                   44860000
448700                               TO DP013-MESSAGE-TEXT (1)          44870000
448800              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 44880000
448900              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               44890000
449000              MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID        44900000
449100              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      44910000
449200              MOVE SQLCA       TO DP013-SQLCA                     44920000
449300              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        44930000
449400              SET DP013-DB2-ABEND  TO TRUE                        44940000
449500              PERFORM DP013-0000-PROCESS-ABEND                    44950000
449600     END-EVALUATE.                                                44960000
449700                                                                  44970000
449800*----------------------------------------------------------------*44980000
449900*    CHANGE THE CURRENT ROW TO IN PROCESS.                       *44990000
450000*----------------------------------------------------------------*45000000
450100 2630-UPDATE-TRECEIV.                                             45010000
450200                                                                  45020000
450300     EXEC SQL                                                     45030000
450400          UPDATE  TRECEIV                                         45040000
450500          SET   STATUS_CDE         =  'IP'                        45050000
450600               ,VER_STATUS_CDE     =  'A'                         45060000
450700               ,UPD_TMST           =  CURRENT TIMESTAMP           45070000
450800               ,UPD_UID            =  :DP020-USERID               45080000
450900               ,UPD_PGM_ID         =  :PC-CURRENT-PROGRAM-NAME    45090000
451000          WHERE                                                   45100000
451100                ORD_NBR            =  :ASC-PO-NBR                 45110000
451200          AND   REC_SEQ_NBR        =  :ASC-RCVR-SEQ-NBR           45120000
451500          AND   VER_STATUS_CDE     =  'A'                         45150000
451600          AND   STATUS_CDE         =  'CM'                        45160000
451700     END-EXEC.                                                    45170000
451800                                                                  45180000
451900     EVALUATE TRUE                                                45190000
452000         WHEN SQLCODE = ZERO                                      45200000
452100         WHEN SQLCODE = +100                                      45210000
452200              CONTINUE                                            45220000
452300         WHEN SQLCODE = -904                                      45230000
452400         WHEN SQLCODE = -911                                      45240000
452500         WHEN SQLCODE = -913                                      45250000
452600              PERFORM 9900A-SOFT-ABORT                            45260000
452700         WHEN SQLWARN0 NOT = SPACE                                45270000
452800         WHEN SQLCODE NOT = ZERO                                  45280000
452900              MOVE '2652-UPDATE-TRECEIV' TO DP013-PARAGRAPH       45290000
453000              MOVE 'UPDATE TRECEIV STATUS CODE'                   45300000
453100                               TO DP013-MESSAGE-TEXT (1)          45310000
453200              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 45320000
453300              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               45330000
453400              MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID        45340000
453500              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      45350000
453600              MOVE SQLCA       TO DP013-SQLCA                     45360000
453700              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        45370000
453800              SET DP013-DB2-ABEND  TO TRUE                        45380000
453900              PERFORM DP013-0000-PROCESS-ABEND                    45390000
454000     END-EVALUATE.                                                45400000
454100                                                                  45410000
454200 2650-UPDATE-TWKORIN.                                             45420000
454300                                                                  45430000
454400     EXEC SQL                                                     45440000
454500          UPDATE TWKORIN                                          45450000
454600          SET    STOP_TMST        =   :PC-DB2-DEFAULT-TMST        45460000
454700          WHERE                                                   45470000
454800                 ORD_NBR          =  :ASC-PO-NBR                  45480000
454900          AND    RCVR_SEQ_NBR     =  :ASC-RCVR-SEQ-NBR            45490000
455000          AND    ORD_LNE_NBR      =  :ASC-LINE-NBR                45500000
455100          AND    WORK_ORD_SEQ_NBR =  :ASC-WORK-ORD-SEQ-NBR        45510000
455400          AND    WO_INSTR_SEQ_NBR =  :WKORIN-WO-INSTR-SEQ-NBR     45540000
455500          AND    VER_STATUS_CDE   =  'A'                          45550000
455600     END-EXEC.                                                    45560000
455700                                                                  45570000
455800     EVALUATE TRUE                                                45580000
455900         WHEN SQLCODE = ZERO                                      45590000
456000              CONTINUE                                            45600000
456100         WHEN SQLCODE = -904                                      45610000
456200         WHEN SQLCODE = -911                                      45620000
456300         WHEN SQLCODE = -913                                      45630000
456400              PERFORM 9900A-SOFT-ABORT                            45640000
456500         WHEN SQLWARN0 NOT = SPACE                                45650000
456600         WHEN SQLCODE NOT = ZERO                                  45660000
456700              MOVE '2650-UPDATE-TWKORIN' TO DP013-PARAGRAPH       45670000
456800              MOVE 'UPDATE STOP TIMESTAMP'                        45680000
456900                               TO DP013-MESSAGE-TEXT (1)          45690000
457000              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 45700000
457100              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               45710000
457200              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      45720000
457300              MOVE SQLCA       TO DP013-SQLCA                     45730000
457400              MOVE 'TWKORIN '  TO DP013-DB2-TABLE-NAME (1)        45740000
457500              SET DP013-DB2-ABEND TO TRUE                         45750000
457600              PERFORM DP013-0000-PROCESS-ABEND                    45760000
457700     END-EVALUATE.                                                45770000
457800                                                                  45780000
457900 2660-COUNT-TWKORIN.                                              45790000
458000                                                                  45800000
458100     MOVE +0 TO PV-DB2-COUNT                                      45810000
458200                                                                  45820000
458300     EXEC SQL                                                     45830000
458400         SELECT COUNT(*)                                          45840000
458500          INTO  :PV-DB2-COUNT                                     45850000
458600          FROM  TWKORIN                                           45860000
458700          WHERE  ORD_NBR          =  :ASC-PO-NBR                  45870000
458800            AND  ORD_LNE_NBR      =  :ASC-LINE-NBR                45880000
458900            AND  RCVR_SEQ_NBR     =  :ASC-RCVR-SEQ-NBR            45890000
459000            AND  WORK_ORD_SEQ_NBR =  :ASC-WORK-ORD-SEQ-NBR        45900000
459300            AND  WO_INSTR_SEQ_NBR >  :WKORIN-WO-INSTR-SEQ-NBR     45930000
459400            AND (STOP_TMST        <> :PC-DB2-DEFAULT-TMST         45940000
459500            AND  STOP_TMST        <> :PC-DB2-DUMMY-TMST)          45950000
459600            AND VER_STATUS_CDE   =  'A'                           45960000
459700     END-EXEC.                                                    45970000
459800                                                                  45980000
459900     EVALUATE TRUE                                                45990000
460000         WHEN SQLCODE = +0                                        46000000
460100         WHEN SQLCODE = +100                                      46010000
460200         WHEN SQLCODE = -305                                      46020000
460300              CONTINUE                                            46030000
460400         WHEN SQLCODE = -904                                      46040000
460500         WHEN SQLCODE = -911                                      46050000
460600         WHEN SQLCODE = -913                                      46060000
460700              PERFORM 9900A-SOFT-ABORT                            46070000
460800         WHEN SQLWARN0 NOT = SPACE                                46080000
460900         WHEN SQLCODE NOT = ZERO                                  46090000
461000              MOVE '2660-COUNT-TWKORIN' TO DP013-PARAGRAPH        46100000
461100              MOVE 'COUNT ROWS'    TO DP013-MESSAGE-TEXT (1)      46110000
461200              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 46120000
461300              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               46130000
461400              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      46140000
461500              MOVE SQLCA           TO DP013-SQLCA                 46150000
461600              MOVE 'TWKORIN '      TO DP013-DB2-TABLE-NAME (1)    46160000
461700              SET DP013-DB2-ABEND  TO TRUE                        46170000
461800              PERFORM DP013-0000-PROCESS-ABEND                    46180000
461900     END-EVALUATE.                                                46190000
462000                                                                  46200000
462100 2670-UPDATE-TWRKORD.                                             46210000
462200                                                                  46220000
462300     EXEC SQL                                                     46230000
462400          UPDATE  TWRKORD                                         46240000
462500          SET   STAT_CDE           =  'IP'                        46250000
462600              , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    46260000
462700          WHERE                                                   46270000
462800                ORD_NBR            =  :ASC-PO-NBR                 46280000
462900          AND   ORD_LNE_NBR        =  :ASC-LINE-NBR               46290000
463000          AND   RCVR_SEQ_NBR       =  :ASC-RCVR-SEQ-NBR           46300000
463100          AND   WORK_ORD_SEQ_NBR   =  :ASC-WORK-ORD-SEQ-NBR       46310000
463400          AND   VER_STATUS_CDE     =  'A'                         46340000
463500     END-EXEC.                                                    46350000
463600                                                                  46360000
463700     EVALUATE TRUE                                                46370000
463800         WHEN SQLCODE = ZERO                                      46380000
463900         WHEN SQLCODE = +100                                      46390000
464000              CONTINUE                                            46400000
464100         WHEN SQLCODE = -904                                      46410000
464200         WHEN SQLCODE = -911                                      46420000
464300         WHEN SQLCODE = -913                                      46430000
464400              PERFORM 9900A-SOFT-ABORT                            46440000
464500         WHEN SQLWARN0 NOT = SPACE                                46450000
464600         WHEN SQLCODE NOT = ZERO                                  46460000
464700              MOVE '2670-UPDATE-TWRKORD'  TO DP013-PARAGRAPH      46470000
464800              MOVE 'UPDATE TWRKORD STATUS CODE'                   46480000
464900                                   TO DP013-MESSAGE-TEXT (1)      46490000
465000              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 46500000
465100              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               46510000
465200              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      46520000
465300              MOVE SQLCA           TO DP013-SQLCA                 46530000
465400              MOVE 'TWRKORD'       TO DP013-DB2-TABLE-NAME (1)    46540000
465500              SET DP013-DB2-ABEND  TO TRUE                        46550000
465600              PERFORM DP013-0000-PROCESS-ABEND                    46560000
465700     END-EVALUATE.                                                46570000
465800                                                                  46580000
465900 2680-UPDATE-ALL-TWRKORD.                                         46590000
466000                                                                  46600000
466100     EXEC SQL                                                     46610000
466200          UPDATE  TWRKORD                                         46620000
466300          SET   CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    46630000
466400              , STAT_CDE           =  'IP'                        46640000
466500          WHERE                                                   46650000
466600                ORD_NBR            =  :ASC-PO-NBR                 46660000
466700          AND   ORD_LNE_NBR        >  0                           46670000
466800          AND   RCVR_SEQ_NBR       =  :ASC-RCVR-SEQ-NBR           46680000
467100          AND   VER_STATUS_CDE     =  'A'                         46710000
467200     END-EXEC.                                                    46720000
467300                                                                  46730000
467400     EVALUATE TRUE                                                46740000
467500         WHEN SQLCODE = ZERO                                      46750000
467600         WHEN SQLCODE = +100                                      46760000
467700              CONTINUE                                            46770000
467800         WHEN SQLCODE = -904                                      46780000
467900         WHEN SQLCODE = -911                                      46790000
468000         WHEN SQLCODE = -913                                      46800000
468100              PERFORM 9900A-SOFT-ABORT                            46810000
468200         WHEN SQLWARN0 NOT = SPACE                                46820000
468300         WHEN SQLCODE NOT = ZERO                                  46830000
468400              MOVE '2680-UPDATE-ALL-TWRKORD' TO DP013-PARAGRAPH   46840000
468500              MOVE 'SET THE STATUS TO IN PROCESS FOR ALL TWRKORD' 46850000
468600                               TO DP013-MESSAGE-TEXT (1)          46860000
468700              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 46870000
468800              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               46880000
468900              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      46890000
469000              MOVE SQLCA       TO DP013-SQLCA                     46900000
469100              MOVE 'TWRKORD '  TO DP013-DB2-TABLE-NAME (1)        46910000
469200              SET DP013-DB2-ABEND  TO TRUE                        46920000
469300              PERFORM DP013-0000-PROCESS-ABEND                    46930000
469400     END-EVALUATE.                                                46940000
469500                                                                  46950000
469600 2690-CHG-START-TWRKORD.                                          46960000
469700     EXEC SQL                                                     46970000
469800          UPDATE  TWKORIN                                         46980000
469900          SET   STRT_TMST          =  :PC-DB2-DEFAULT-TMST        46990000
470000              , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    47000000
470100          WHERE                                                   47010000
470200                ORD_NBR            =  :ASC-PO-NBR                 47020000
470300          AND   ORD_LNE_NBR        =  :ASC-LINE-NBR               47030000
470400          AND   RCVR_SEQ_NBR       =  :ASC-RCVR-SEQ-NBR           47040000
470500          AND   WORK_ORD_SEQ_NBR   =  :ASC-WORK-ORD-SEQ-NBR       47050000
470600          AND   WO_INSTR_SEQ_NBR   =  :PV-NEXT-INSTR-SEQ          47060000
470900          AND   VER_STATUS_CDE     =  'A'                         47090000
471000     END-EXEC.                                                    47100000
471100                                                                  47110000
471200     EVALUATE TRUE                                                47120000
471300         WHEN SQLCODE = ZERO                                      47130000
471400         WHEN SQLCODE = +100                                      47140000
471500              CONTINUE                                            47150000
471600         WHEN SQLCODE = -904                                      47160000
471700         WHEN SQLCODE = -911                                      47170000
471800         WHEN SQLCODE = -913                                      47180000
471900              PERFORM 9900A-SOFT-ABORT                            47190000
472000         WHEN SQLWARN0 NOT = SPACE                                47200000
472100         WHEN SQLCODE NOT = ZERO                                  47210000
472200              MOVE '2690-CHG-START-TWRKORD'  TO DP013-PARAGRAPH   47220000
472300              MOVE 'SET THE START TIMESTAMP FOR NEXT TWKORIN'     47230000
472400                               TO DP013-MESSAGE-TEXT (1)          47240000
472500              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 47250000
472600              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               47260000
472700              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      47270000
472800              MOVE SQLCA       TO DP013-SQLCA                     47280000
472900              MOVE 'TWKORIN '  TO DP013-DB2-TABLE-NAME (1)        47290000
473000              SET DP013-DB2-ABEND  TO TRUE                        47300000
473100              PERFORM DP013-0000-PROCESS-ABEND                    47310000
473200     END-EVALUATE.                                                47320000
473300                                                                  47330000
473400*----------------------------------------------------------------*47340000
473500*    GET THE MAXIMUM WORK ORDER INSTRUCTION SEQUENCE NUMBER      *47350000
473600*----------------------------------------------------------------*47360000
473700 2700-GET-MAX-WO-INSTR.                                           47370000
473800                                                                  47380000
473900     EXEC SQL                                                     47390000
474000          SELECT MAX(WO_INSTR_SEQ_NBR)                            47400000
474100            INTO :PV-WORK-ORD-INSTR-MAX :PV-NULL-IND              47410000
474200            FROM TWKORIN                                          47420000
474300           WHERE ORD_NBR          =  :ASC-PO-NBR                  47430000
474400             AND RCVR_SEQ_NBR     =  :ASC-RCVR-SEQ-NBR            47440000
474500             AND ORD_LNE_NBR      =  :ASC-LINE-NBR                47450000
474600             AND WORK_ORD_SEQ_NBR =  :ASC-WORK-ORD-SEQ-NBR        47460000
474800             AND VER_STATUS_CDE   =  'A'                          47480000
474900     END-EXEC.                                                    47490000
475000                                                                  47500000
475100     EVALUATE TRUE                                                47510000
475200         WHEN SQLCODE = ZERO                                      47520000
475300         WHEN SQLCODE = +100                                      47530000
475400              CONTINUE                                            47540000
475500         WHEN SQLCODE = -904                                      47550000
475600         WHEN SQLCODE = -911                                      47560000
475700         WHEN SQLCODE = -913                                      47570000
475800               PERFORM 9900A-SOFT-ABORT                           47580000
475900         WHEN SQLWARN0 NOT = SPACES                               47590000
476000         WHEN SQLCODE < ZERO                                      47600000
476100         WHEN SQLCODE > ZERO                                      47610000
476200              MOVE '2700-GET-MAX-WO-INSTR' TO DP013-PARAGRAPH     47620000
476300              MOVE 'GET MAX WO INSTRUCTION SEQ NBR'               47630000
476400                                   TO DP013-MESSAGE-TEXT(1)       47640000
476500              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 47650000
476600              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               47660000
476700              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      47670000
476800              MOVE SQLCA           TO DP013-SQLCA                 47680000
476900              MOVE 'TWKORIN'       TO DP013-DB2-TABLE-NAME (1)    47690000
477000              SET DP013-DB2-ABEND                                 47700000
477100                  DP013-XCTL-DISPLAY-RESTART TO TRUE              47710000
477200              PERFORM DP013-0000-PROCESS-ABEND                    47720000
477300     END-EVALUATE.                                                47730000
477400                                                                  47740000
477500*----------------------------------------------------------------*47750000
477600*    CHECK ALL THE INPUT FIELDS TO SEE IF THEY CAN BE UPDATED     47760000
477700*----------------------------------------------------------------*47770000
477800 2800-CHECK-UPDT-FIELDS.                                          47780000
477900                                                                  47790000
478000     EXEC SQL                                                     47800000
478100         SELECT  STATUS_CDE                                       47810000
478110              ,  CURR_OPER_UNT_ID                                 47811007
478200           INTO :RECEIV-STATUS-CDE                                47820000
478210              , :PV-CURR-OPER-UNT-ID                              47821007
478300           FROM  TRECEIV                                          47830000
478400          WHERE ORD_NBR        = :ASC-PO-NBR                      47840000
478500            AND REC_SEQ_NBR    = :ASC-RCVR-SEQ-NBR                47850000
478600            AND VER_STATUS_CDE = 'A'                              47860000
478700      END-EXEC.                                                   47870000
478800                                                                  47880000
478900      EVALUATE TRUE                                               47890000
479000         WHEN SQLCODE = +0                                        47900000
479100             MOVE RECEIV-STATUS-CDE  TO ASC-STATUS                47910000
479200         WHEN OTHER                                               47920000
479300             MOVE SPACES             TO ASC-STATUS                47930000
479400      END-EVALUATE.                                               47940000
479500*                                                                 47950007
479510*** 8/24/20 BEGIN                                                 47951007
479520*                                                                 47952007
479521     IF PS-NO-ERROR                                               47952107
479522         IF  PV-CURR-OPER-UNT-ID = DP020-LOCATION-NBR             47952209
479523             CONTINUE                                             47952307
479524         ELSE                                                     47952407
479525             SET PS-ERROR                                         47952507
479526             DP020-MSG-FATAL             TO TRUE                  47952607
479527             MOVE PC-TSYMSG-03815        TO DP020-MSG-NUMBER      47952707
479528             MOVE PV-CURR-OPER-UNT-ID    TO DP020-MSG-TEXT        47952807
479531             MOVE DP015-REVERSE          TO ARCVCLKH              47953108
479532                                            AOPERH                47953208
479533                                            AACTCTNH              47953310
479534                                            ADMGCTNH              47953410
479535             MOVE DP015-RED              TO ARCVCLKC              47953510
479536                                            AOPERC                47953610
479537                                            AACTCTNC              47953710
479538                                            ADMGCTNC              47953810
479539             MOVE DP015-PRO-NOR-OFF      TO ARCVCLKA              47953910
479540                                            AOPERA                47954010
479541                                            AACTCTNA              47954110
479542                                            ADMGCTNA              47954210
479543             SET ASC-CSR-ACT-CTN         TO TRUE                  47954310
479544             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  47954410
479545         END-IF                                                   47954510
479546     END-IF.                                                      47954610
479550*                                                                 47955007
479560*** 8/24/20 BEGIN                                                 47956007
479570*                                                                 47957007
479600     SET PS-REQUIRE-CLERK-NO          TO TRUE                     47960000
479700     IF PS-NO-ERROR                                               47970000
479800         IF ASC-WRKORD-STATUS  = 'CM' AND                         47980000
479900            ASC-OPER-SET NOT = ASC-OPER-SET-OLD                   47990000
480000                SET PS-ERROR                                      48000000
480100                DP020-MSG-FATAL             TO TRUE               48010000
480200                MOVE PC-TSYMSG-02977        TO DP020-MSG-NUMBER   48020000
480300                MOVE DP015-PRO-NOR-OFF      TO AOPERA             48030000
480400                MOVE DP015-BLUE             TO AOPERC             48040000
480600                SET ASC-CSR-ACT-CTN         TO TRUE               48060000
480700                SET DP030-SET-CURSOR-APPL-1 TO TRUE               48070000
480800         ELSE                                                     48080000
480900             IF ASC-OPER-SET-X  = SPACES                          48090000
481000                 SET PS-ERROR                                     48100000
481100                     DP020-MSG-FATAL           TO TRUE            48110000
481200                 MOVE PC-TSYMSG-02977      TO DP020-MSG-NUMBER    48120000
481300                 MOVE DP015-PRO-NOR-OFF    TO AOPERA              48130000
481400                 MOVE DP015-BLUE           TO AOPERC              48140000
481600                 SET ASC-CSR-ACT-CTN         TO TRUE              48160000
481700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              48170000
481800             END-IF                                               48180000
481900         END-IF                                                   48190000
482000     END-IF.                                                      48200000
482100                                                                  48210000
482200     IF PS-NO-ERROR                                               48220000
482300         IF ASC-UCC128-YES                                        48230000
482400             PERFORM 4568-GET-SCN-COUNT                           48240000
482500             IF PS-NO-ERROR                                       48250000
482600                 IF ASC-ACT-CRTN-CNT > ZERO                       48260000
482700                  IF ASC-ACT-CRTN-CNT < ASC-SCN-CRTN-CNT          48270000
482800                     MOVE PC-TSYMSG-03020      TO DP020-MSG-NUMBER48280000
483000                     SET ASC-CSR-ACT-CTN         TO TRUE          48300000
483100                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          48310000
483200                     MOVE DP015-REVERSE          TO AACTCTNH      48320000
483300                     MOVE DP015-RED              TO AACTCTNC      48330000
483400                     MOVE DP015-UNP-NUM-BRT-MDT  TO AACTCTNA      48340000
483500                     SET DP020-MSG-FATAL         TO TRUE          48350000
483600                     SET PS-ERROR                TO TRUE          48360000
483700                  END-IF                                          48370000
483800                 END-IF                                           48380000
483900             ELSE                                                 48390000
484000                 IF ASC-ACT-CRTN-CNT < ASC-DMG-CRTN-CNT           48400000
484100                     MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER48410000
484300                     SET ASC-CSR-ACT-CTN         TO TRUE          48430000
484400                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          48440000
484500                     MOVE DP015-REVERSE          TO AACTCTNH      48450000
484600                                                    ADMGCTNH      48460000
484700                     MOVE DP015-RED              TO AACTCTNC      48470000
484800                                                    ADMGCTNC      48480000
484900                     MOVE DP015-UNP-NUM-BRT-MDT  TO AACTCTNA      48490000
485000                                                    ADMGCTNA      48500000
485100                     SET DP020-MSG-FATAL         TO TRUE          48510000
485200                     SET PS-ERROR                TO TRUE          48520000
485300                 END-IF                                           48530000
485400             END-IF                                               48540000
485500         END-IF                                                   48550000
485600     END-IF.                                                      48560000
485700                                                                  48570000
485800     IF PS-NO-ERROR                                               48580000
485900         IF ASC-ACT-CRTN-CNT-OLD = ASC-ACT-CRTN-CNT               48590000
486000                 AND ASC-DMG-CRTN-CNT-OLD = ASC-DMG-CRTN-CNT      48600000
486100             CONTINUE                                             48610000
486200         ELSE                                                     48620000
486300             IF ASC-CLERK = SPACES                                48630000
486400                 SET PS-REQUIRE-CLERK-YES TO TRUE                 48640000
486500             END-IF                                               48650000
486600         END-IF                                                   48660000
486700     END-IF                                                       48670000
486800                                                                  48680000
486900     IF PS-NO-ERROR                                               48690000
487100         IF PS-REQUIRE-CLERK-YES                                  48710000
487200             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      48720000
487400             SET ASC-CSR-CLERK            TO TRUE                 48740000
487500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  48750000
487600             MOVE DP015-REVERSE          TO ARCVCLKH              48760000
487700             MOVE DP015-RED              TO ARCVCLKC              48770000
487800             MOVE DP015-UNP-ALP-BRT-MDT  TO ARCVCLKA              48780000
487900             SET DP020-MSG-FATAL         TO TRUE                  48790000
488000             SET PS-ERROR                TO TRUE                  48800000
488100         END-IF                                                   48810000
488200     END-IF.                                                      48820000
488300     IF PS-NO-ERROR                                               48830000
488400         IF ASC-ACT-CRTN-CNT = ZEROES                             48840000
488500             SET ASC-ACT-CNT-ZERO-F15-CONFIRM  TO TRUE            48850000
488600         ELSE                                                     48860000
488700             MOVE ZERO TO  ASC-CONFIRM-SW                         48870000
488800         END-IF                                                   48880000
488900     END-IF.                                                      48890000
489000                                                                  48900000
489100*----------------------------------------------------------------*48910000
489200*    UPDATE INPUT FIELDS                                          48920000
489300*----------------------------------------------------------------*48930000
489400 2810-UPDTE-CHGD-FIELDS.                                          48940000
489500     IF  ASC-OPER-SET     > (SPACES OR ZEROES)                    48950000
489600     AND ASC-OPER-SET-OLD = (SPACES OR ZEROES)                    48960000
489700          PERFORM 2840-BUILD-ZERO-LINE-WORK-ORD                   48970000
489800     ELSE                                                         48980000
489900         IF  ASC-OPER-SET NOT = ASC-OPER-SET-OLD                  48990000
490000         AND ASC-OPER-SET     = (SPACES OR ZEROES)                49000000
490100             SET PS-ERROR                                         49010000
490200             DP020-MSG-FATAL             TO TRUE                  49020000
490300             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      49030000
490400             MOVE DP015-UNP-ALP-NOR-OFF  TO AOPERA                49040000
490500             MOVE DP015-RED              TO AOPERC                49050000
490700             SET ASC-CSR-OPERSET   TO TRUE                        49070000
490800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  49080000
490900         ELSE                                                     49090000
491000             IF  ASC-OPER-SET NOT = ASC-OPER-SET-OLD              49100000
491100                 MOVE ASC-OPER-SET    TO WRKORD-OPER-SET-ID       49110000
491200                                         ASC-OPER-SET-OLD         49120000
491300                 MOVE ASC-OPER-UNT-ID TO WRKORD-OPER-UNT-ID       49130000
491400                 PERFORM 2300-UPDATE-TWRKORD                      49140000
491500                 PERFORM 2350-DELETE-TWKORIN                      49150000
491600                 MOVE 'N'          TO PS-TOSOPFA-CURSOR-SW        49160000
491700                 MOVE 'Y'          TO PS-INSTRUCTION-SW           49170000
491800                 PERFORM 2360-OPEN-TOSOPFA-CSR                    49180000
491900                 PERFORM 2365-FETCH-TOSOPFA-CSR                   49190000
492000                 PERFORM UNTIL PS-EOF-TOSOPFA-CSR                 49200000
492100                      PERFORM 2375-BUILD-WORK-ORDER-INSTR         49210000
492200                      PERFORM 2365-FETCH-TOSOPFA-CSR              49220000
492300                 END-PERFORM                                      49230000
492400                 PERFORM 2370-CLOSE-TOSOPFA-CSR                   49240000
492600             END-IF                                               49260000
492700         END-IF                                                   49270000
492800     END-IF.                                                      49280000
492900                                                                  49290000
493000     IF PS-NO-ERROR                                               49300000
493100         IF  ASC-ACT-CRTN-CNT   = ASC-ACT-CRTN-CNT-OLD            49310000
493200         AND ASC-CLERK          = ASC-CLERK-OLD                   49320000
493300             CONTINUE                                             49330000
493400         ELSE                                                     49340000
493500             SET ASC-ACTL-CRTNS-UPDATED TO TRUE                   49350000
493600             SET ASC-CLERK-UPDATED TO TRUE                        49360000
493700             MOVE '2810-UPDTE-CHGD-FIELDS' TO PV-PARAGRAPH        49370000
493800             PERFORM 2580-LINK-AUDIT-MODULE                       49380000
493900                                                                  49390000
494000             MOVE ASC-ACT-CRTN-CNT   TO DK-ACT-CRTN-CNT           49400000
494100             MOVE DK-ACT-CRTN-CNT    TO RECEIV-ACTL-CART-CNT      49410000
494200             MOVE ASC-CLERK          TO RECEIV-RCVG-CLERK-INIT-ID 49420000
494300                                                                  49430000
494400             EXEC SQL                                             49440000
494500                 UPDATE TRECEIV                                   49450000
494600                  SET                                             49460000
494700                    ACTL_CART_CNT      =  :RECEIV-ACTL-CART-CNT   49470000
494800                   ,RCVG_CLERK_INIT_ID =                          49480000
494900                                      :RECEIV-RCVG-CLERK-INIT-ID  49490000
495000                   ,UPD_TMST           =  CURRENT TIMESTAMP       49500000
495100                   ,UPD_UID            =  :DP020-USERID           49510000
495200                   ,UPD_PGM_ID         =  :PC-CURRENT-PROGRAM-NAME49520000
495500               WHERE ORD_NBR        = :ASC-PO-NBR                 49550000
495600                 AND REC_SEQ_NBR    = :ASC-RCVR-SEQ-NBR           49560000
495700                 AND VER_STATUS_CDE = 'A'                         49570000
495800             END-EXEC                                             49580000
495900                                                                  49590000
496000             EVALUATE TRUE                                        49600000
496100                 WHEN SQLCODE = +0                                49610000
496200                 WHEN SQLCODE = -904                              49620000
496300                 WHEN SQLCODE = -913                              49630000
496400                     CONTINUE                                     49640000
496500                 WHEN SQLWARN0 NOT = SPACES                       49650000
496600                 WHEN SQLCODE < +0                                49660000
496700                 WHEN SQLCODE > +0                                49670000
496800                     MOVE '2810-UPDTE-CHGD-FLD' TO DP013-PARAGRAPH49680000
496900                     MOVE 'UPDATE ACT AND CLERK INFO '            49690000
497000                                          TO DP013-MESSAGE-TEXT(1)49700000
497100                     MOVE ASC-PO-NBR      TO PV-ERROR-PO          49710000
497200                     MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ        49720000
497300                     MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID 49730000
497400                     MOVE PV-ERROR-MSG   TO DP013-MESSAGE-TEXT (2)49740000
497500                     MOVE SQLCA        TO DP013-SQLCA             49750000
497600                     MOVE 'TRECEIV'    TO DP013-DB2-TABLE-NAME (1)49760000
497700                     SET DP013-DB2-ABEND                          49770000
497800                         DP013-XCTL-DISPLAY-RESTART TO TRUE       49780000
497900                     PERFORM DP013-0000-PROCESS-ABEND             49790000
498000             END-EVALUATE                                         49800000
498100         END-IF                                                   49810000
498200     END-IF.                                                      49820000
498300                                                                  49830000
498400     IF PS-NO-ERROR                                               49840000
498500         IF  (ASC-ACT-CRTN-CNT NOT = ASC-ACT-CRTN-CNT-OLD         49850000
498600                   OR ASC-CRTN-CNT-CHG-YES)                       49860000
498700             IF ASC-STATUS = 'VE'                                 49870000
498800                 PERFORM 8000-UPDATE-UNITS-WRKD                   49880000
498900             END-IF                                               49890000
499000             SET ASC-CRTN-CNT-CHG-NO TO TRUE                      49900000
499100         END-IF                                                   49910000
499200     END-IF.                                                      49920000
499300                                                                  49930000
499400     IF  ASC-DMG-CRTN-CNT  = ASC-DMG-CRTN-CNT-OLD                 49940000
499500     AND ASC-ACT-CRTN-CNT  = ASC-ACT-CRTN-CNT-OLD                 49950000
499600         CONTINUE                                                 49960000
499700     ELSE                                                         49970000
499800         SET ASC-ACTL-CRTNS-UPDATED TO TRUE                       49980000
499900         MOVE ASC-DMG-CRTN-CNT     TO DK-DMG-CRTN-CNT             49990000
500000         MOVE DK-DMG-CRTN-CNT      TO SHPTPO-DMG-CART-CNT         50000000
500100         MOVE ASC-ACT-CRTN-CNT     TO DK-ACT-CRTN-CNT             50010000
500200         MOVE DK-ACT-CRTN-CNT      TO SHPTPO-ACTL-CART-CNT        50020000
500300         PERFORM 2820-UPDATE-TSHPTPO                              50030000
500400         PERFORM 2830-AUDIT-TSHPTPO                               50040000
500500         MOVE RECEIV-ACTL-CART-CNT    TO ASC-ACT-CRTN-CNT-OLD     50050000
500600     END-IF.                                                      50060000
500700                                                                  50070000
500800*----------------------------------------------------------------*50080000
500900*  UPDATE THE ACTUAL AND DAMAGED CARTON COUNT                     50090000
501000*----------------------------------------------------------------*50100000
501100 2820-UPDATE-TSHPTPO.                                             50110000
501200                                                                  50120000
501300     EXEC SQL                                                     50130000
501400       UPDATE TSHPTPO                                             50140000
501500          SET ACTL_CART_CNT    = :SHPTPO-ACTL-CART-CNT            50150000
501600             ,DMG_CART_CNT     = :SHPTPO-DMG-CART-CNT             50160000
501700             ,LAST_UPD_PGM_ID  = :PC-CURRENT-PROGRAM-NAME         50170000
501800             ,LAST_UPD_DTE     = CURRENT DATE                     50180000
501900             ,LAST_UPD_TIME    = CURRENT TIME                     50190000
502000             ,LAST_UPD_USER_ID = :DP020-USERID                    50200000
502100       WHERE  PO_NBR          = :ASC-PO-NBR                       50210000
502200         AND  REC_SEQ_NBR     = :ASC-RCVR-SEQ-NBR                 50220000
502300         AND  PRIM_SHIPT_IND  = 'Y'                               50230000
502400     END-EXEC.                                                    50240000
502500                                                                  50250000
502600     EVALUATE TRUE                                                50260000
502700         WHEN SQLCODE = +0                                        50270000
502800         WHEN SQLCODE = -904                                      50280000
502900         WHEN SQLCODE = -913                                      50290000
503000             CONTINUE                                             50300000
503100                                                                  50310000
503200         WHEN SQLWARN0 NOT = SPACES                               50320000
503300         WHEN SQLCODE < +0                                        50330000
503400         WHEN SQLCODE > +0                                        50340000
503500             MOVE '2820-UPDATE-TSHPTPO' TO DP013-PARAGRAPH        50350000
503600             MOVE 'UPDATE CARTON COUNTS ON TSHPTPO'               50360000
503700                                         TO DP013-MESSAGE-TEXT(1) 50370000
503800             MOVE ASC-PO-NBR      TO PV-ERROR-PO                  50380000
503900             MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ                50390000
504000             MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID         50400000
504100             MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)       50410000
504200             MOVE SQLCA        TO DP013-SQLCA                     50420000
504300             MOVE 'TSHPTPO'    TO DP013-DB2-TABLE-NAME (1)        50430000
504400             SET DP013-DB2-ABEND                                  50440000
504500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               50450000
504600             PERFORM DP013-0000-PROCESS-ABEND                     50460000
504700     END-EVALUATE.                                                50470000
504800                                                                  50480000
504900 2830-AUDIT-TSHPTPO.                                              50490000
505000                                                                  50500000
505100     INITIALIZE DCLTAUSHPO.                                       50510000
505200                                                                  50520000
505300     EXEC SQL                                                     50530000
505400          SELECT SHIPT_ID                                         50540000
505500                ,PO_NBR                                           50550000
505600                ,REC_SEQ_NBR                                      50560000
505700                ,EXPTED_CART_CNT                                  50570000
505800                ,ACTL_CART_CNT                                    50580000
505900                ,DMG_CART_CNT                                     50590000
506000                ,PKSL_IND                                         50600000
506100                ,VEND_NAME                                        50610000
506200                ,FRGT_CHG_AMT                                     50620000
506300                ,LAST_UPD_PGM_ID                                  50630000
506400                ,CRE_USER_ID                                      50640000
506500                ,CARR_CART_CT                                     50650000
506600                ,CARR_LAST_UPD_DTE                                50660000
506700                ,CARR_LAST_UPD_TIME                               50670000
506800                ,VEND_CART_CT                                     50680000
506900                ,VEND_LAST_UPD_DTE                                50690000
507000                ,VEND_LAST_UPD_TIME                               50700000
507100                ,CRE_TMST                                         50710000
507200                ,LAST_UPD_DTE                                     50720000
507300                ,LAST_UPD_TIME                                    50730000
507400                ,LAST_UPD_USER_ID                                 50740000
507500                ,PRIM_SHIPT_IND                                   50750000
507600                ,SPLT_XMIT_IND                                    50760000
507700                ,SPLT_XMIT_DTE                                    50770000
507800                ,SPLT_XMIT_TM                                     50780000
507900            INTO :SHPTPO-SHIPT-ID                                 50790000
508000                ,:SHPTPO-PO-NBR                                   50800000
508100                ,:SHPTPO-REC-SEQ-NBR                              50810000
508200                ,:SHPTPO-EXPTED-CART-CNT                          50820000
508300                ,:SHPTPO-ACTL-CART-CNT                            50830000
508400                ,:SHPTPO-DMG-CART-CNT                             50840000
508500                ,:SHPTPO-PKSL-IND                                 50850000
508600                ,:SHPTPO-VEND-NAME                                50860000
508700                ,:SHPTPO-FRGT-CHG-AMT                             50870000
508800                ,:SHPTPO-LAST-UPD-PGM-ID                          50880000
508900                ,:SHPTPO-CRE-USER-ID                              50890000
509000                ,:SHPTPO-CARR-CART-CT                             50900000
509100                ,:SHPTPO-CARR-LAST-UPD-DTE                        50910000
509200                ,:SHPTPO-CARR-LAST-UPD-TIME                       50920000
509300                ,:SHPTPO-VEND-CART-CT                             50930000
509400                ,:SHPTPO-VEND-LAST-UPD-DTE                        50940000
509500                ,:SHPTPO-VEND-LAST-UPD-TIME                       50950000
509600                ,:SHPTPO-CRE-TMST                                 50960000
509700                ,:SHPTPO-LAST-UPD-DTE                             50970000
509800                ,:SHPTPO-LAST-UPD-TIME                            50980000
509900                ,:SHPTPO-LAST-UPD-USER-ID                         50990000
510000                ,:SHPTPO-PRIM-SHIPT-IND                           51000000
510100                ,:SHPTPO-SPLT-XMIT-IND                            51010000
510200                ,:SHPTPO-SPLT-XMIT-DTE                            51020000
510300                ,:SHPTPO-SPLT-XMIT-TM                             51030000
510400            FROM TSHPTPO                                          51040000
510500           WHERE PO_NBR          = :ASC-PO-NBR                    51050000
510600             AND REC_SEQ_NBR     = :ASC-RCVR-SEQ-NBR              51060000
510700             AND PRIM_SHIPT_IND  = 'Y'                            51070000
510800     END-EXEC                                                     51080000
510900                                                                  51090000
511000     EVALUATE TRUE                                                51100000
511100         WHEN SQLCODE = +0                                        51110000
511200         WHEN SQLCODE = -904                                      51120000
511300         WHEN SQLCODE = -913                                      51130000
511400              CONTINUE                                            51140000
511500                                                                  51150000
511600         WHEN SQLWARN0 NOT = SPACES                               51160000
511700         WHEN SQLCODE < +0                                        51170000
511800         WHEN SQLCODE > +0                                        51180000
511900             MOVE '2830-AUDIT-TSHPTPO'  TO DP013-PARAGRAPH        51190000
512000             MOVE 'UNSUCCESSFUL SELECT ON TSHPTPO  '              51200000
512100                                  TO DP013-MESSAGE-TEXT (1)       51210000
512200             MOVE ASC-PO-NBR      TO PV-ERROR-PO                  51220000
512300             MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ                51230000
512400             MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID         51240000
512500             MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)       51250000
512600             MOVE SQLCA      TO DP013-SQLCA                       51260000
512700             MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME (1)          51270000
512800             SET DP013-DB2-ABEND                                  51280000
512900                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              51290000
513000             PERFORM DP013-0000-PROCESS-ABEND                     51300000
513100     END-EVALUATE.                                                51310000
513200                                                                  51320000
513300     MOVE 'U'                     TO AUSHPO-TRN-CDE               51330000
513400                                                                  51340000
513500     EXEC SQL                                                     51350000
513600         INSERT  INTO TAUSHPO                                     51360000
513700                (SHIPT_ID                                         51370000
513800                ,PO_NBR                                           51380000
513900                ,REC_SEQ_NBR                                      51390000
514000                ,EXPTED_CART_CNT                                  51400000
514100                ,ACTL_CART_CNT                                    51410000
514200                ,DMG_CART_CNT                                     51420000
514300                ,PKSL_IND                                         51430000
514400                ,VEND_NAME                                        51440000
514500                ,FRGT_CHG_AMT                                     51450000
514600                ,LAST_UPD_PGM_ID                                  51460000
514700                ,CRE_USER_ID                                      51470000
514800                ,CARR_CART_CT                                     51480000
514900                ,CARR_LAST_UPD_DTE                                51490000
515000                ,CARR_LAST_UPD_TIME                               51500000
515100                ,VEND_CART_CT                                     51510000
515200                ,VEND_LAST_UPD_DTE                                51520000
515300                ,VEND_LAST_UPD_TIME                               51530000
515400                ,CRE_TMST                                         51540000
515500                ,LAST_UPD_DTE                                     51550000
515600                ,LAST_UPD_TIME                                    51560000
515700                ,LAST_UPD_USER_ID                                 51570000
515800                ,PRIM_SHIPT_IND                                   51580000
515900                ,SPLT_XMIT_IND                                    51590000
516000                ,SPLT_XMIT_DTE                                    51600000
516100                ,SPLT_XMIT_TM                                     51610000
516200                ,TRN_CDE )                                        51620000
516300        VALUES  (:SHPTPO-SHIPT-ID                                 51630000
516400                ,:SHPTPO-PO-NBR                                   51640000
516500                ,:SHPTPO-REC-SEQ-NBR                              51650000
516600                ,:SHPTPO-EXPTED-CART-CNT                          51660000
516700                ,:SHPTPO-ACTL-CART-CNT                            51670000
516800                ,:SHPTPO-DMG-CART-CNT                             51680000
516900                ,:SHPTPO-PKSL-IND                                 51690000
517000                ,:SHPTPO-VEND-NAME                                51700000
517100                ,:SHPTPO-FRGT-CHG-AMT                             51710000
517200                ,:SHPTPO-LAST-UPD-PGM-ID                          51720000
517300                ,:SHPTPO-CRE-USER-ID                              51730000
517400                ,:SHPTPO-CARR-CART-CT                             51740000
517500                ,:SHPTPO-CARR-LAST-UPD-DTE                        51750000
517600                ,:SHPTPO-CARR-LAST-UPD-TIME                       51760000
517700                ,:SHPTPO-VEND-CART-CT                             51770000
517800                ,:SHPTPO-VEND-LAST-UPD-DTE                        51780000
517900                ,:SHPTPO-VEND-LAST-UPD-TIME                       51790000
518000                ,:SHPTPO-CRE-TMST                                 51800000
518100                ,:SHPTPO-LAST-UPD-DTE                             51810000
518200                ,:SHPTPO-LAST-UPD-TIME                            51820000
518300                ,:SHPTPO-LAST-UPD-USER-ID                         51830000
518400                ,:SHPTPO-PRIM-SHIPT-IND                           51840000
518500                ,:SHPTPO-SPLT-XMIT-IND                            51850000
518600                ,:SHPTPO-SPLT-XMIT-DTE                            51860000
518700                ,:SHPTPO-SPLT-XMIT-TM                             51870000
518800                ,:AUSHPO-TRN-CDE )                                51880000
518900     END-EXEC.                                                    51890000
519000                                                                  51900000
519100     EVALUATE TRUE                                                51910000
519200         WHEN SQLCODE = +0                                        51920000
519300         WHEN SQLCODE = -904                                      51930000
519400         WHEN SQLCODE = -913                                      51940000
519500             CONTINUE                                             51950000
519600                                                                  51960000
519700         WHEN SQLWARN0 NOT = SPACES                               51970000
519800         WHEN SQLCODE < +0                                        51980000
519900         WHEN SQLCODE > +0                                        51990000
520000             MOVE '2830-AUDIT-TSHPTPO'  TO DP013-PARAGRAPH        52000000
520100             MOVE 'INSERT A ROW ON TAUSHPO'                       52010000
520200                                   TO DP013-MESSAGE-TEXT(1)       52020000
520300             MOVE ASC-PO-NBR      TO PV-ERROR-PO                  52030000
520400             MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ                52040000
520500             MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID         52050000
520600             MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)       52060000
520700             MOVE SQLCA        TO DP013-SQLCA                     52070000
520800             MOVE 'TAUSHPO'    TO DP013-DB2-TABLE-NAME (1)        52080000
520900             SET DP013-DB2-ABEND                                  52090000
521000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               52100000
521100             PERFORM DP013-0000-PROCESS-ABEND                     52110000
521200     END-EVALUATE.                                                52120000
521300                                                                  52130000
521400 2840-BUILD-ZERO-LINE-WORK-ORD.                                   52140000
521500                                                                  52150000
521600     INITIALIZE DCLTWRKORD.                                       52160000
521700                                                                  52170000
521800     MOVE ASC-PO-NBR             TO WRKORD-ORD-NBR.               52180000
521900     MOVE ASC-RCVR-SEQ-NBR       TO WRKORD-RCVR-SEQ-NBR.          52190000
522000     MOVE ASC-OPER-UNT-ID        TO WRKORD-OPER-UNT-ID.           52200000
522100     MOVE ASC-FCLTY-ID           TO WRKORD-FCLTY-ID.              52210000
522200     MOVE +1                     TO WRKORD-WORK-ORD-SEQ-NBR.      52220000
522300     MOVE ASC-ACT-CRTN-CNT       TO DK-ACT-CRTN-CNT.              52230000
522400     MOVE DK-ACT-CRTN-CNT        TO WRKORD-ACTL-CART-CNT.         52240000
522500     MOVE ASC-EXP-CRTN-CNT       TO DK-EXP-CRTN-CNT.              52250000
522600     MOVE DK-EXP-CRTN-CNT        TO WRKORD-EXPTED-CART-CNT.       52260000
522700     MOVE 'A'                    TO WRKORD-VER-STATUS-CDE.        52270000
522800     MOVE 'IP'                   TO WRKORD-STAT-CDE.              52280000
522900     MOVE 'N'                    TO WRKORD-WORK-ORD-DISTR-IND.    52290000
523000     MOVE ASC-OPER-SET           TO WRKORD-OPER-SET-ID.           52300000
523100                                                                  52310000
523800     MOVE +0                     TO PV-WO-INSTR-SEQ-NBR.          52380000
523900     MOVE 'N'                    TO PS-TOSOPFA-CURSOR-SW.         52390000
524000     MOVE 'Y'                    TO PS-INSTRUCTION-SW.            52400000
524100     PERFORM 2360-OPEN-TOSOPFA-CSR.                               52410000
524200     PERFORM 2365-FETCH-TOSOPFA-CSR.                              52420000
524300                                                                  52430000
524400     PERFORM UNTIL PS-EOF-TOSOPFA-CSR                             52440000
524500        PERFORM 2375-BUILD-WORK-ORDER-INSTR                       52450000
524600        PERFORM 2365-FETCH-TOSOPFA-CSR                            52460000
524700     END-PERFORM.                                                 52470000
524800                                                                  52480000
524900     PERFORM 2370-CLOSE-TOSOPFA-CSR.                              52490000
525000                                                                  52500000
525100 2850-INACTIVATE-TWRKORD.                                         52510000
525200                                                                  52520000
525300         EXEC SQL                                                 52530000
525400           UPDATE TWRKORD                                         52540000
525500              SET VER_STATUS_CDE   =  'I'                         52550000
525600           WHERE ORD_NBR           = :WRKORD-ORD-NBR              52560000
525700            AND  RCVR_SEQ_NBR      = :WRKORD-RCVR-SEQ-NBR         52570000
525800            AND  ORD_LNE_NBR       = :WRKORD-ORD-LNE-NBR          52580000
525900            AND  WORK_ORD_SEQ_NBR  = :WRKORD-WORK-ORD-SEQ-NBR     52590000
526200         END-EXEC.                                                52620000
526300                                                                  52630000
526400         EVALUATE TRUE                                            52640000
526500             WHEN SQLCODE = +0                                    52650000
526600             WHEN SQLCODE = +100                                  52660000
526700                 CONTINUE                                         52670000
526800             WHEN SQLWARN0 NOT = SPACES                           52680000
526900             WHEN SQLCODE < +0                                    52690000
527000             WHEN SQLCODE > +0                                    52700000
527100                 MOVE '2850-INACTIVATE-TWRKORD' TO DP013-PARAGRAPH52710000
527200                 MOVE 'UPDATE VER STATUS CODE ON TWRKORD'         52720000
527300                                   TO DP013-MESSAGE-TEXT(1)       52730000
527400                 MOVE ASC-PO-NBR      TO PV-ERROR-PO              52740000
527500                 MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ            52750000
527600                 MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID     52760000
527700                 MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)   52770000
527800                 MOVE SQLCA        TO DP013-SQLCA                 52780000
527900                 MOVE 'TWRKORD'    TO DP013-DB2-TABLE-NAME (1)    52790000
528000                 SET DP013-DB2-ABEND                              52800000
528100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           52810000
528200                 PERFORM DP013-0000-PROCESS-ABEND                 52820000
528300         END-EVALUATE.                                            52830000
528400                                                                  52840000
528500 2860-INSERT-TWRKORD.                                             52850000
528600                                                                  52860000
528700     EXEC SQL                                                     52870000
528800          INSERT INTO TWRKORD                                     52880000
528900                 ( ORD_NBR                                        52890000
529000                  ,RCVR_SEQ_NBR                                   52900000
529100                  ,ORD_LNE_NBR                                    52910000
529200                  ,WORK_ORD_SEQ_NBR                               52920000
529300                  ,OPER_UNT_ID                                    52930000
529400                  ,FCLTY_ID                                       52940000
529500                  ,CRE_TMST                                       52950000
529600                  ,VER_STATUS_CDE                                 52960000
529700                  ,CRE_UID_ID                                     52970000
529800                  ,EXPTED_CART_CNT                                52980000
529900                  ,ACTL_CART_CNT                                  52990000
530000                  ,EXPTED_ITM_CNT                                 53000000
530100                  ,ACTL_ITM_CNT                                   53010000
530200                  ,STAT_CDE                                       53020000
530300                  ,WORK_ORD_DISTR_IND                             53030000
530400                  ,OPER_SET_ID )                                  53040000
530500          VALUES ( :WRKORD-ORD-NBR                                53050000
530600                  ,:WRKORD-RCVR-SEQ-NBR                           53060000
530700                  ,:WRKORD-ORD-LNE-NBR                            53070000
530800                  ,:WRKORD-WORK-ORD-SEQ-NBR                       53080000
530900                  ,:WRKORD-OPER-UNT-ID                            53090000
531000                  ,:WRKORD-FCLTY-ID                               53100000
531100                  ,CURRENT TIMESTAMP                              53110000
531200                  ,:WRKORD-VER-STATUS-CDE                         53120000
531300                  ,:DP020-USERID                                  53130000
531400                  ,:WRKORD-EXPTED-CART-CNT                        53140000
531500                  ,:WRKORD-ACTL-CART-CNT                          53150000
531600                  ,:WRKORD-EXPTED-ITM-CNT                         53160000
531700                  ,:WRKORD-ACTL-ITM-CNT                           53170000
531800                  ,:WRKORD-STAT-CDE                               53180000
531900                  ,:WRKORD-WORK-ORD-DISTR-IND                     53190000
532000                  ,:WRKORD-OPER-SET-ID )                          53200000
532100     END-EXEC.                                                    53210000
532200                                                                  53220000
532300     EVALUATE TRUE                                                53230000
532400         WHEN SQLCODE = +0                                        53240000
532500         WHEN SQLCODE = -904                                      53250000
532600         WHEN SQLCODE = -913                                      53260000
532700             CONTINUE                                             53270000
532800                                                                  53280000
532900         WHEN SQLWARN0 NOT = SPACE                                53290000
533000         WHEN SQLCODE < +0                                        53300000
533100         WHEN SQLCODE > +0                                        53310000
533200             MOVE '2860-INSERT-TWRKORD' TO DP013-PARAGRAPH        53320000
533300             MOVE 'INSERT ON WORK ORDER TABLE'                    53330000
533400                                 TO DP013-MESSAGE-TEXT (1)        53340000
533500             MOVE ASC-PO-NBR      TO PV-ERROR-PO                  53350000
533600             MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ                53360000
533700             MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID         53370000
533800             MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)       53380000
533900             MOVE SQLCA      TO DP013-SQLCA                       53390000
534000             MOVE 'TWRKORD'  TO DP013-DB2-TABLE-NAME (1)          53400000
534100             SET DP013-DB2-ABEND                                  53410000
534200                 DP013-XCTL-DISPLAY-RESTART   TO TRUE             53420000
534300             PERFORM DP013-0000-PROCESS-ABEND                     53430000
534400     END-EVALUATE.                                                53440000
534500                                                                  53450000
534600*----------------------------------------------------------------*53460000
534700*    CHECK ACT CRTN CNT AND RECV CLERK FOR UPDATES                53470000
534800*    CHECK THAT ACT CRTN CNT IS EQUAL TO EXP CRTN CNT             53480000
534900*    CHECK THAT NO LINES HAVE BEEN VERIFIED OR CONFIRMED          53490000
535000*----------------------------------------------------------------*53500000
535100 2900-CHECK-4-VALID-INFO.                                         53510000
535200     IF PS-NO-ERROR                                               53520000
535300         IF ASC-ACT-CRTN-CNT = ASC-EXP-CRTN-CNT                   53530000
535400             IF ASC-CLERK  = SPACES                               53540000
535500                 MOVE PC-TSYMSG-03023  TO DP020-MSG-NUMBER        53550000
535700                 SET ASC-CSR-CLERK            TO TRUE             53570000
535800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              53580000
535900                 MOVE DP015-REVERSE          TO ARCVCLKH          53590000
536000                 MOVE DP015-RED              TO ARCVCLKC          53600000
536100                 MOVE DP015-UNP-ALP-BRT-MDT  TO ARCVCLKA          53610000
536200                 SET DP020-MSG-FATAL         TO TRUE              53620000
536300                 SET PS-ERROR                TO TRUE              53630000
536400             END-IF                                               53640000
536500         END-IF                                                   53650000
536600     END-IF.                                                      53660000
536700     IF PS-NO-ERROR                                               53670000
536800         IF ASC-ACT-CRTN-CNT NOT = ASC-EXP-CRTN-CNT               53680000
536900            MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER         53690000
537100            SET ASC-CSR-ACT-CTN         TO TRUE                   53710000
537200            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   53720000
537300            MOVE DP015-REVERSE          TO AACTCTNH               53730000
537400            MOVE DP015-RED              TO AACTCTNC               53740000
537500            MOVE DP015-UNP-NUM-BRT-MDT  TO AACTCTNA               53750000
537600            SET DP020-MSG-FATAL         TO TRUE                   53760000
537700            SET PS-ERROR                TO TRUE                   53770000
537800         END-IF                                                   53780000
537900     END-IF.                                                      53790000
538000                                                                  53800000
538100     IF PS-NO-ERROR                                               53810000
538200         EXEC SQL                                                 53820000
538300             SELECT 1                                             53830000
538400               INTO :PV-ONE                                       53840000
538500               FROM SYSIBM.SYSDUMMY1 X                            53850000
538600              WHERE  EXISTS (SELECT 1                             53860000
538700                   FROM TRECITM                                   53870000
538800                  WHERE ORD_NBR     = :ASC-PO-NBR                 53880000
538900                    AND REC_SEQ_NBR = :ASC-RCVR-SEQ-NBR           53890000
539000                    AND STATUS_CDE  = 'VE'                        53900000
539100                    AND X.IBMREQD > '')                           53910000
539200         END-EXEC                                                 53920000
539300                                                                  53930000
539400         EVALUATE TRUE                                            53940000
539500             WHEN SQLCODE = +0                                    53950000
539600                 IF ASC-PACK-BY-ST                                53960000
539700                     MOVE PC-TSYMSG-02155  TO DP020-MSG-NUMBER    53970000
539800                     MOVE -1                     TO MR-SELECTL (1)53980000
539900                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          53990000
540000                     SET DP020-MSG-FATAL         TO TRUE          54000000
540100                     SET PS-ERROR                TO TRUE          54010000
540200                 ELSE                                             54020000
540300                     MOVE PC-TSYMSG-01809  TO DP020-MSG-NUMBER    54030000
540400                     MOVE -1                     TO MR-SELECTL (1)54040000
540500                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          54050000
540600                     SET DP020-MSG-FATAL         TO TRUE          54060000
540700                     SET PS-ERROR                TO TRUE          54070000
540800                 END-IF                                           54080000
540900             WHEN OTHER                                           54090000
541000                 IF ASC-NOT-PACK-BY-ST                            54100000
541100                     PERFORM 2910-CHECK-TOT-CART-CNT              54110000
541200                 END-IF                                           54120000
541300         END-EVALUATE                                             54130000
541400     END-IF.                                                      54140000
541500                                                                  54150000
541600*----------------------------------------------------------------*54160000
541700*    CHECK THAT TOT-CART-CNT > 0                                  54170000
541800*----------------------------------------------------------------*54180000
541900 2910-CHECK-TOT-CART-CNT.                                         54190000
542000                                                                  54200000
542100     EXEC SQL                                                     54210000
542200         SELECT 1                                                 54220000
542300           INTO :PV-ONE                                           54230000
542400           FROM SYSIBM.SYSDUMMY1 X                                54240000
542500          WHERE  EXISTS (SELECT 1                                 54250000
542600               FROM TDISTHD                                       54260000
542700              WHERE ORD_NBR       = :ASC-PO-NBR                   54270000
542800                AND RCVR_SEQ_NBR  = :ASC-RCVR-SEQ-NBR             54280000
542900                AND TOT_CART_CNT > 0                              54290000
543000                AND X.IBMREQD > '')                               54300000
543100       END-EXEC.                                                  54310000
543200                                                                  54320000
543300       EVALUATE TRUE                                              54330000
543400         WHEN SQLCODE = +0                                        54340000
543500             PERFORM 2920-CHECK-FCSE-CNFRMN-TMST                  54350000
543600         WHEN OTHER                                               54360000
543700             MOVE PC-TSYMSG-01762  TO DP020-MSG-NUMBER            54370000
543800             MOVE -1                     TO MR-SELECTL (1)        54380000
543900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  54390000
544000             SET DP020-MSG-FATAL         TO TRUE                  54400000
544100             SET PS-ERROR                TO TRUE                  54410000
544200     END-EVALUATE.                                                54420000
544300                                                                  54430000
544400*----------------------------------------------------------------*54440000
544500*    CHECK THAT FCSE-CNFRMN-TMST <> 9'S                           54450000
544600*----------------------------------------------------------------*54460000
544700 2920-CHECK-FCSE-CNFRMN-TMST.                                     54470000
544800                                                                  54480000
544900     EXEC SQL                                                     54490000
545000         SELECT 1                                                 54500000
545100           INTO :PV-ONE                                           54510000
545200           FROM SYSIBM.SYSDUMMY1 X                                54520000
545300          WHERE  EXISTS (SELECT 1                                 54530000
545400               FROM TDISTHD                                       54540000
545500              WHERE ORD_NBR       = :ASC-PO-NBR                   54550000
545600                AND RCVR_SEQ_NBR  = :ASC-RCVR-SEQ-NBR             54560000
545700                AND FCSE_CNFRMN_TMST <> :PC-DB2-DEFAULT-TMST      54570000
545800                AND X.IBMREQD > '')                               54580000
545900       END-EXEC.                                                  54590000
546000                                                                  54600000
546100       EVALUATE TRUE                                              54610000
546200         WHEN SQLCODE = +0                                        54620000
546300             MOVE PC-TSYMSG-01809  TO DP020-MSG-NUMBER            54630000
546400             MOVE -1                     TO MR-SELECTL (1)        54640000
546500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  54650000
546600             SET DP020-MSG-FATAL         TO TRUE                  54660000
546700             SET PS-ERROR                TO TRUE                  54670000
546800         WHEN OTHER                                               54680000
546900             CONTINUE                                             54690000
547000     END-EVALUATE.                                                54700000
547100                                                                  54710000
559000*----------------------------------------------------------------*55900000
559100*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *55910000
559200*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *55920000
559300*----------------------------------------------------------------*55930000
559400 3000-EDIT-DATA-IN-COMMAREA.                                      55940000
559500     SET PS-NO-ERROR               TO TRUE.                       55950000
559600                                                                  55960000
559900     IF ASC-OPER-SET-X >  SPACES  OR ASC-OPER-SET > ZEROES        55990000
560000         MOVE ASC-OPER-SET           TO DP010I-UNEDITED-FIELD     56000000
560100         MOVE LENGTH OF ASC-OPER-SET TO DP010I-MAXIMUM-DIGITS     56010000
560200         MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS   56020000
560300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  56030000
560410         CALL DP010I-NUMERIC-EDIT-ROUTINE                         56041011
560420              USING DP010I-NUMERIC-EDIT-AREA                      56042011
560500         IF  DP010I-ERROR-DETECTED                                56050000
560600             SET PS-ERROR                                         56060000
560700             DP020-MSG-FATAL             TO TRUE                  56070000
560800             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      56080000
560900             MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA                56090000
561000             MOVE DP015-RED              TO AOPERC                56100000
561100             MOVE DP015-REVERSE          TO AOPERH                56110000
561200             SET ASC-CSR-OPERSET   TO TRUE                        56120000
561300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  56130000
561400         ELSE                                                     56140000
561500             MOVE DP010I-NUMERIC-FIELD TO DK-OPER-SET-ID          56150000
561600                                          ASC-OPER-SET            56160000
561700             MOVE ASC-OPER-SET         TO DK-OPER-SET             56170000
561800             MOVE DK-OPER-SET          TO AOPERO                  56180000
561900             PERFORM 3010-VALIDATE-OPER-SET                       56190000
562000             IF SQLCODE = +100                                    56200000
562100                 SET PS-ERROR                                     56210000
562200                     DP020-MSG-FATAL         TO TRUE              56220000
562300                 MOVE PC-TSYMSG-00987        TO DP020-MSG-NUMBER  56230000
562400                 MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA            56240000
562500                 MOVE DP015-RED              TO AOPERC            56250000
562600                 MOVE DP015-REVERSE          TO AOPERH            56260000
562700                 SET ASC-CSR-OPERSET   TO TRUE                    56270000
562800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              56280000
562900             ELSE                                                 56290000
563000                 MOVE OPRSET-OPER-SET-DESC   TO ASC-OPER-SET-NAME 56300000
563100                                                AOPRNMEO          56310000
563200             END-IF                                               56320000
563300         END-IF                                                   56330000
563400     ELSE                                                         56340000
563500         PERFORM 4560-GET-OPER-SET-INFO                           56350000
563600     END-IF.                                                      56360000
563700                                                                  56370000
563800     IF  PS-NO-ERROR                                              56380000
563900         IF  ASC-ACT-CRTN-CNT   > ZEROES OR SPACES                56390000
564000             MOVE ASC-ACT-CRTN-CNT      TO DP010I-UNEDITED-FIELD  56400000
564100             MOVE LENGTH OF ASC-ACT-CRTN-CNT                      56410000
564200                                    TO DP010I-MAXIMUM-DIGITS      56420000
564300             MOVE ZERO                  TO DP010I-MAXIMUM-DECIMALS56430000
564400             SET  DP010I-NEGATIVE-NOT-ALLOWED TO TRUE             56440000
564510             CALL DP010I-NUMERIC-EDIT-ROUTINE                     56451011
564520                  USING DP010I-NUMERIC-EDIT-AREA                  56452011
564600             IF  DP010I-ERROR-DETECTED                            56460000
564700                 SET PS-ERROR                                     56470000
564800                     DP020-MSG-FATAL         TO TRUE              56480000
564900                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  56490000
565000                 MOVE DP015-UNP-ALP-BRT-OFF  TO AACTCTNA          56500000
565100                 MOVE DP015-RED              TO AACTCTNC          56510000
565200                 MOVE DP015-REVERSE          TO AACTCTNH          56520000
565300                 SET ASC-CSR-ACT-CTN         TO TRUE              56530000
565400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              56540000
565500            ELSE                                                  56550000
565600                 MOVE DP010I-NUMERIC-FIELD TO ASC-ACT-CRTN-CNT    56560000
565700                 MOVE ASC-ACT-CRTN-CNT     TO AACTCTNO            56570000
565800             END-IF                                               56580000
565900         END-IF                                                   56590000
566000     END-IF.                                                      56600000
566100                                                                  56610000
566200     IF  PS-NO-ERROR                                              56620000
566300         IF  ASC-DMG-CRTN-CNT  > ZEROES OR SPACES                 56630000
566400             MOVE ASC-DMG-CRTN-CNT      TO DP010I-UNEDITED-FIELD  56640000
566500             MOVE LENGTH OF ASC-DMG-CRTN-CNT                      56650000
566600                                    TO DP010I-MAXIMUM-DIGITS      56660000
566700             MOVE ZERO                  TO DP010I-MAXIMUM-DECIMALS56670000
566800             SET  DP010I-NEGATIVE-NOT-ALLOWED TO TRUE             56680000
566910             CALL DP010I-NUMERIC-EDIT-ROUTINE                     56691011
566920                  USING DP010I-NUMERIC-EDIT-AREA                  56692011
567000             IF  DP010I-ERROR-DETECTED                            56700000
567100                 SET PS-ERROR                                     56710000
567200                     DP020-MSG-FATAL         TO TRUE              56720000
567300                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  56730000
567400                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADMGCTNA          56740000
567500                 MOVE DP015-RED              TO ADMGCTNC          56750000
567600                 MOVE DP015-REVERSE          TO ADMGCTNH          56760000
567700                 SET ASC-CSR-DMG-CTN         TO TRUE              56770000
567800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              56780000
567900            ELSE                                                  56790000
568000                 MOVE DP010I-NUMERIC-FIELD TO ASC-DMG-CRTN-CNT    56800000
568100                 MOVE ASC-DMG-CRTN-CNT     TO ADMGCTNO            56810000
568200            END-IF                                                56820000
568300         END-IF                                                   56830000
568400     END-IF.                                                      56840000
568500                                                                  56850000
568600     IF  PS-NO-ERROR                                              56860000
568700     AND ASC-ACT-CRTN-CNT > SPACES OR ZEROES                      56870000
568800         IF  ASC-ACT-CRTN-CNT > ASC-ACT-CRTN-CNT-OLD              56880000
568900             IF  ASC-CLERK = SPACES                               56890000
569000                 SET PS-ERROR                                     56900000
569100                     DP020-MSG-FATAL        TO TRUE               56910000
569200                 MOVE PC-TSYMSG-00007       TO DP020-MSG-NUMBER   56920000
569300                 MOVE DP015-UNP-ALP-BRT-OFF TO ARCVCLKA           56930000
569400                 MOVE DP015-RED             TO ARCVCLKC           56940000
569500                 MOVE DP015-REVERSE         TO ARCVCLKH           56950000
569600                 SET ASC-CSR-CLERK            TO TRUE             56960000
569700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              56970000
569800                 PERFORM 4401-CURSOR-POSITION                     56980000
569900             END-IF                                               56990000
570000         END-IF                                                   57000000
570100     END-IF.                                                      57010000
570200                                                                  57020000
570300     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     57030000
570400**                                                                57040000
570500* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              57050000
570600* EDITTING IS DONE FROM THE BOTTOM UP.                            57060000
570700**                                                                57070000
570800     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       57080000
570900         ASC-ITEMS-DISPLAYED - 1.                                 57090000
571000                                                                  57100000
571100     PERFORM 3100-SET-SUBSCRIPTS.                                 57110000
571200     PERFORM 3300-EDIT-SELECTIONS                                 57120000
571300         VARYING PV-SUB                                           57130000
571400         FROM PV-SUB BY -1                                        57140000
571500         UNTIL PV-SUB < +1                                        57150000
571600                                                                  57160000
572100     IF  PS-NO-ERROR                                              57210000
572200         PERFORM 3400-CHECK-RANGE-SEQUENCE                        57220000
572300     END-IF.                                                      57230000
572400                                                                  57240000
572500     IF  ((PS-NO-ERROR)                                           57250000
572600       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   57260000
572700       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    57270000
572800             PERFORM 3500-MARK-RANGE-AS-SELECTED                  57280000
572900     END-IF.                                                      57290000
573000                                                                  57300000
573100*----------------------------------------------------------------*57310000
573200*   3005-EDIT-COMMAREA-BLOCKS                                    *57320000
573300*----------------------------------------------------------------*57330000
573400 3005-EDIT-COMMAREA-BLOCKS.                                       57340000
573500     MOVE +1                       TO PV-BLOCK-NUMBER.            57350000
573600     MOVE +1                       TO ASC-BLK-SUB.                57360000
573700     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               57370000
573800                                                                  57380000
573900     COMPUTE PV-BLOCK-NUMBER  =                                   57390000
574000        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 57400000
574100            PC-ITEMS-PER-PANEL.                                   57410000
574200                                                                  57420000
574300     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          57430000
574400                                                                  57440000
574500     EVALUATE TRUE                                                57450000
574600         WHEN PS-EDIT-BEFORE-MOVE                                 57460000
574700              COMPUTE PV-ITEMS-HOLD  =                            57470000
574800                  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +           57480000
574900                  PC-ITEMS-PER-PANEL - 1                          57490000
575000                                                                  57500000
575100              IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ      57510000
575200                  SUBTRACT  ASC-NUMBER-OF-ITEMS-READ              57520000
575300                      FROM  PV-ITEMS-HOLD                         57530000
575400                    GIVING  PV-ITEMS-DIFF                         57540000
575500                  SUBTRACT  PV-ITEMS-DIFF                         57550000
575600                      FROM  PC-ITEMS-PER-PANEL                    57560000
575700                    GIVING  PV-ITEMS-HOLD                         57570000
575800                  MOVE  PV-ITEMS-HOLD  TO  PV-SUB                 57580000
575900                                           ASC-ITEM-SUB           57590000
576000                                           ASC-ITEMS-DISPLAYED    57600000
576100              ELSE                                                57610000
576200                  MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB             57620000
576300                  MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB       57630000
576400              END-IF                                              57640000
576500              PERFORM 3300-EDIT-SELECTIONS                        57650000
576600                  VARYING PV-SUB                                  57660000
576700                     FROM PV-SUB BY -1                            57670000
576800                    UNTIL PV-SUB < +1                             57680000
576900                                                                  57690000
577000              MOVE +1               TO ASC-BLK-SUB                57700000
577100              PERFORM 5105-REWRITE-ASC-LISTQ                      57710000
577200                                                                  57720000
577300         WHEN OTHER                                               57730000
577400             PERFORM                                              57740000
577500               UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN  57750000
577600                  OR PS-ERROR                                     57760000
577700                  OR PS-BLOCK-ERROR                               57770000
577800                                                                  57780000
577900                     COMPUTE PV-ITEMS-HOLD  =                     57790000
578000                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        57800000
578100                     PC-ITEMS-PER-PANEL - 1                       57810000
578200                                                                  57820000
578300                 IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ   57830000
578400                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           57840000
578500                         FROM  PV-ITEMS-HOLD                      57850000
578600                       GIVING  PV-ITEMS-DIFF                      57860000
578700                     SUBTRACT  PV-ITEMS-DIFF                      57870000
578800                         FROM  PC-ITEMS-PER-PANEL                 57880000
578900                       GIVING  PV-ITEMS-HOLD                      57890000
579000                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              57900000
579100                                              ASC-ITEM-SUB        57910000
579200                                              ASC-ITEMS-DISPLAYED 57920000
579300                 ELSE                                             57930000
579400                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          57940000
579500                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    57950000
579600                 END-IF                                           57960000
579700                 PERFORM 3300-EDIT-SELECTIONS                     57970000
579800                     VARYING PV-SUB                               57980000
579900                        FROM PV-SUB BY -1                         57990000
580000                       UNTIL PV-SUB < +1                          58000000
580100                                                                  58010000
580200                 MOVE +1               TO ASC-BLK-SUB             58020000
580300                                                                  58030000
580400                 PERFORM 5105-REWRITE-ASC-LISTQ                   58040000
580500                                                                  58050000
580600                 MOVE +1                TO ASC-BLK-SUB            58060000
580700                                                                  58070000
580800                 IF  PS-BLOCK-ERROR                               58080000
580900                     SET  PS-ERROR     TO TRUE                    58090000
581000                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    58100000
581100                                       TO PV-TOP-ITEM             58110000
581200                 ELSE                                             58120000
581300                     ADD  +1            TO PV-BLOCK-NUMBER        58130000
581400                     IF  PV-BLOCK-NUMBER >                        58140000
581500                         ASC-HIGHEST-BLOCK-WRITTEN                58150000
581600                         MOVE +2        TO ASC-BLK-SUB            58160000
581700                         PERFORM 4410-READ-TEMP-STORAGE           58170000
581800                         MOVE +1        TO ASC-BLK-SUB            58180000
581900                     ELSE                                         58190000
582000                         PERFORM 4410-READ-TEMP-STORAGE           58200000
582100                         ADD  +1        TO PV-BLOCK-NUMBER        58210000
582200                         MOVE +2        TO ASC-BLK-SUB            58220000
582300                         PERFORM 4410-READ-TEMP-STORAGE           58230000
582400                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        58240000
582500                         MOVE +1        TO ASC-BLK-SUB            58250000
582600                     END-IF                                       58260000
582700                 END-IF                                           58270000
582800             END-PERFORM                                          58280000
582900                                                                  58290000
583000             IF  PV-ORIGINAL-BLOCK  = +1    OR                    58300000
583100                 PS-ERROR                   OR                    58310000
583200                 PS-BLOCK-ERROR                                   58320000
583300                 CONTINUE                                         58330000
583400             ELSE                                                 58340000
583500                 MOVE +1                 TO PV-BLOCK-NUMBER       58350000
583600                 MOVE +1                 TO ASC-BLK-SUB           58360000
583700                 MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB          58370000
583800                 MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED   58380000
583900                 PERFORM 4410-READ-TEMP-STORAGE                   58390000
584000                                                                  58400000
584100                 PERFORM                                          58410000
584200                     UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK    58420000
584300                        OR PS-ERROR                               58430000
584400                        OR PS-BLOCK-ERROR                         58440000
584500                                                                  58450000
584600                     COMPUTE PV-ITEMS-HOLD  =                     58460000
584700                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    58470000
584800                         PC-ITEMS-PER-PANEL - 1                   58480000
584900                                                                  58490000
585000                     IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ 58500000
585100                         SUBTRACT  ASC-NUMBER-OF-ITEMS-READ       58510000
585200                            FROM  PV-ITEMS-HOLD                   58520000
585300                           GIVING  PV-ITEMS-DIFF                  58530000
585400                         SUBTRACT  PV-ITEMS-DIFF                  58540000
585500                             FROM  PC-ITEMS-PER-PANEL             58550000
585600                           GIVING  PV-ITEMS-HOLD                  58560000
585700                         MOVE  PV-ITEMS-HOLD TO PV-SUB            58570000
585800                                                 ASC-ITEM-SUB     58580000
585900                                               ASC-ITEMS-DISPLAYED58590000
586000                     ELSE                                         58600000
586100                         MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB      58610000
586200                         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB58620000
586300                     END-IF                                       58630000
586400                     PERFORM 3300-EDIT-SELECTIONS                 58640000
586500                         VARYING PV-SUB                           58650000
586600                            FROM PV-SUB BY -1                     58660000
586700                           UNTIL PV-SUB < +1                      58670000
586800                                                                  58680000
586900                     MOVE +1               TO ASC-BLK-SUB         58690000
587000                                                                  58700000
587100                     PERFORM 5105-REWRITE-ASC-LISTQ               58710000
587200                                                                  58720000
587300                     MOVE +1                TO ASC-BLK-SUB        58730000
587400                                                                  58740000
587500                     IF  PS-BLOCK-ERROR                           58750000
587600                         SET  PS-ERROR     TO TRUE                58760000
587700                         MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)58770000
587800                                           TO PV-TOP-ITEM         58780000
587900                     ELSE                                         58790000
588000                         ADD  +1            TO PV-BLOCK-NUMBER    58800000
588100                         IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK  58810000
588200                             MOVE +2        TO ASC-BLK-SUB        58820000
588300                             PERFORM 4410-READ-TEMP-STORAGE       58830000
588400                             MOVE +1        TO ASC-BLK-SUB        58840000
588500                         ELSE                                     58850000
588600                             PERFORM 4410-READ-TEMP-STORAGE       58860000
588700                             ADD  +1        TO PV-BLOCK-NUMBER    58870000
588800                             MOVE +2        TO ASC-BLK-SUB        58880000
588900                             PERFORM 4410-READ-TEMP-STORAGE       58890000
589000                             SUBTRACT +1  FROM PV-BLOCK-NUMBER    58900000
589100                             MOVE +1        TO ASC-BLK-SUB        58910000
589200                         END-IF                                   58920000
589300                     END-IF                                       58930000
589400                 END-PERFORM                                      58940000
589500             END-IF                                               58950000
589600     END-EVALUATE.                                                58960000
589700                                                                  58970000
589800*----------------------------------------------------------------*58980000
589900*  DETERMINE IF THE OPER SET ENTERED IS VALID                     58990000
590000*----------------------------------------------------------------*59000000
590100 3010-VALIDATE-OPER-SET.                                          59010000
590200                                                                  59020000
590300     EXEC SQL                                                     59030000
590400        SELECT  OPER_SET_DESC                                     59040000
590500          INTO :OPRSET-OPER-SET-DESC                              59050000
590600          FROM  TOPRSET                                           59060000
590700         WHERE  OPER_SET_ID    = :DK-OPER-SET-ID                  59070000
590800           AND  VER_STATUS_CDE = 'A'                              59080000
590900           AND  OPER_UNT_ID    = :ASC-OPER-UNT-ID                 59090000
591000           AND  FCLTY_ID       = :ASC-FCLTY-ID                    59100000
591100     END-EXEC.                                                    59110000
591200                                                                  59120000
591300     EVALUATE TRUE                                                59130000
591400         WHEN SQLCODE = +0                                        59140000
591500         WHEN SQLCODE = +100                                      59150000
591600         WHEN SQLCODE = -904                                      59160000
591700         WHEN SQLCODE = -913                                      59170000
591800             CONTINUE                                             59180000
591900         WHEN OTHER                                               59190000
592000             MOVE SPACES  TO OPRSET-OPER-SET-DESC                 59200000
592100     END-EVALUATE.                                                59210000
592200                                                                  59220000
592300*----------------------------------------------------------------*59230000
592400*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *59240000
592500*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*59250000
592600*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *59260000
592700*                                                                *59270000
592800*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *59280000
592900*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *59290000
593000*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *59300000
593100*    US IN THE 2ND BLOCK OF THE ARRAY.                           *59310000
593200*----------------------------------------------------------------*59320000
593300 3100-SET-SUBSCRIPTS.                                             59330000
593400                                                                  59340000
593500     COMPUTE ASC-ITEM-SUB =                                       59350000
593600         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        59360000
593700                                                                  59370000
593800     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         59380000
593900         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            59390000
594000                                                                  59400000
594100         MOVE PC-MAX-BLOCKS-IN-ARRAY                              59410000
594200                                   TO ASC-BLK-SUB                 59420000
594300     ELSE                                                         59430000
594400         MOVE +1                   TO ASC-BLK-SUB                 59440000
594500     END-IF.                                                      59450000
594600                                                                  59460000
594700*----------------------------------------------------------------*59470000
594800*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *59480000
594900*----------------------------------------------------------------*59490000
595000 3200-RESET-ATTRIBUTES.                                           59500000
595100                                                                  59510000
595200     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   59520000
595300     MOVE DP015-GREEN              TO ASTRTITC.                   59530000
595400     MOVE DP015-UNDERLINE          TO ASTRTITH.                   59540000
595500                                                                  59550000
595600                                                                  59560000
595700     PERFORM 3201-CHECK-AUTOVE                                    59570000
595800     IF RC040-AUTO-VE-YES                                         59580000
595900         PERFORM 3201A-PROTECT-AUTOVE                             59590000
596000         PERFORM 3201C-PROTECT-THE-REST                           59600000
596100     ELSE                                                         59610000
596300         PERFORM 3201A-PROTECT-AUTOVE                             59630000
596400         PERFORM 3201C-PROTECT-THE-REST                           59640000
596500     END-IF.                                                      59650000
596600                                                                  59660000
596700*----------------------------------------------------------------*59670000
596800*  CHECK IF THE PO FOR THE DC IS AUTOVE                           59680000
596900*----------------------------------------------------------------*59690000
597000 3201-CHECK-AUTOVE.                                               59700000
597100                                                                  59710000
597200     INITIALIZE RC040-FIELDS.                                     59720000
597300     MOVE ASC-PO-NBR                  TO RC040-PO-NBR             59730000
597400     MOVE ASC-RCVR-SEQ-NBR            TO RC040-PO-RCVR            59740000
597500                                                                  59750000
597600     IF ASC-RCVR-SEQ-NBR > ZERO                                   59760000
597700        SET RC040-RCVR-EXISTS         TO TRUE                     59770000
597800     ELSE                                                         59780000
597900        SET RC040-NO-RCVR-EXISTS      TO TRUE                     59790000
598000     END-IF                                                       59800000
598100                                                                  59810000
598200     MOVE ASC-OPER-UNT-ID             TO RC040-SIGNON-LOCATION.   59820000
598300                                                                  59830000
598400     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  59840000
598500                                        RC040-COMMAREA            59850000
598600                                        RC040-FIELDS.             59860000
598700                                                                  59870000
598800     EVALUATE TRUE                                                59880000
598900         WHEN RC040-SUCCESSFUL                                    59890000
599000             CONTINUE                                             59900000
599100         WHEN OTHER                                               59910000
599200             PERFORM 3202-VALIDATE-RECEIVER                       59920000
599300     END-EVALUATE.                                                59930000
599400                                                                  59940000
599500 3201A-PROTECT-AUTOVE.                                            59950000
599600     PERFORM 7000-TRIP-STATUS.                                    59960000
599700     IF TRIPST-TRIP-STATUS-CDE = 'ET' AND ASC-STATUS = 'VE'       59970000
599800         MOVE DP015-PRO-NOR-OFF       TO AACTCTNA                 59980000
599900                                         ADMGCTNA                 59990000
600000         MOVE DP015-BLUE              TO AACTCTNC                 60000000
600100                                         ADMGCTNC                 60010000
600200         MOVE DP015-HL-OFF            TO AACTCTNH                 60020000
600300                                         ADMGCTNH                 60030000
600400         MOVE DP015-UNP-ALP-NOR-OFF   TO ARCVCLKA                 60040000
600500         MOVE DP015-GREEN             TO ARCVCLKC                 60050000
600600         MOVE DP015-UNDERLINE         TO ARCVCLKH                 60060000
600700         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     60070000
600800     ELSE                                                         60080000
600900         IF ASC-RECEIVER-NOT-ARRIVED                              60090000
601100             MOVE DP015-PRO-NOR-OFF   TO AACTCTNA                 60110000
601200                                         ADMGCTNA                 60120000
601300                                         ARCVCLKA                 60130000
601400             MOVE DP015-BLUE          TO AACTCTNC                 60140000
601500                                         ADMGCTNC                 60150000
601600                                         ARCVCLKC                 60160000
601700             MOVE DP015-HL-OFF        TO AACTCTNH                 60170000
601800                                         ADMGCTNH                 60180000
601900                                         ARCVCLKH                 60190000
602000             MOVE -1                  TO MR-SELECTL(1)            60200000
602100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  60210000
602200         ELSE                                                     60220000
602300             MOVE DP015-UNP-ALP-NOR-OFF TO ARCVCLKA               60230000
602400             MOVE DP015-UNP-NUM-NOR-OFF TO AACTCTNA               60240000
602500                                           ADMGCTNA               60250000
602600             MOVE DP015-GREEN         TO AACTCTNC                 60260000
602700                                         ADMGCTNC                 60270000
602800                                         ARCVCLKC                 60280000
602900             MOVE DP015-UNDERLINE     TO ARCVCLKH                 60290000
603000                                         ADMGCTNH                 60300000
603100                                         AACTCTNH                 60310000
603200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  60320000
603300         END-IF                                                   60330000
603400     END-IF.                                                      60340000
603500                                                                  60350000
603600 3201B-PROTECT-NORMAL.                                            60360000
603700                                                                  60370000
603800     IF ASC-STATUS  = 'VE' OR ASC-RECEIVER-NOT-ARRIVED            60380000
604100         MOVE DP015-PRO-NOR-OFF       TO AACTCTNA                 60410000
604200                                         ADMGCTNA                 60420000
604400         MOVE DP015-BLUE              TO AACTCTNC                 60440000
604500                                         ADMGCTNC                 60450000
604700         MOVE DP015-HL-OFF            TO ADMGCTNH                 60470000
604800                                         AACTCTNH                 60480000
604900         MOVE -1                      TO MR-SELECTL(1)            60490000
605000         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     60500000
605100     ELSE                                                         60510000
605200         MOVE DP015-UNP-ALP-NOR-OFF   TO ARCVCLKA                 60520000
605300         MOVE DP015-UNP-NUM-NOR-OFF   TO AACTCTNA                 60530000
605400                                         ADMGCTNA                 60540000
605500         MOVE DP015-GREEN             TO ARCVCLKC                 60550000
605600                                         AACTCTNC                 60560000
605700                                         ADMGCTNC                 60570000
605800         MOVE DP015-UNDERLINE         TO ARCVCLKH                 60580000
605900                                         AACTCTNH                 60590000
606000                                         ADMGCTNH                 60600000
606100         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     60610000
606200     END-IF.                                                      60620000
606300                                                                  60630000
606400 3201C-PROTECT-THE-REST.                                          60640000
606500     IF ASC-STATUS  = 'VE' OR ASC-RECEIVER-NOT-ARRIVED            60650000
606700         MOVE DP015-PRO-NOR-OFF       TO AOPERA                   60670000
606800         MOVE DP015-BLUE              TO AOPERC                   60680000
606900         MOVE DP015-HL-OFF            TO AOPERH                   60690000
607000         MOVE -1                      TO MR-SELECTL (1)           60700000
607100         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     60710000
607200                                                                  60720000
607300         PERFORM                                                  60730000
607400             VARYING PV-SUB                                       60740000
607500                 FROM 1 BY 1                                      60750000
607600                 UNTIL PV-SUB > ASC-ITEMS-DISPLAYED               60760000
607700             MOVE DP015-PRO-NOR-OFF     TO MR-LOC-CODEA (PV-SUB)  60770000
607800             MOVE DP015-BLUE            TO MR-LOC-CODEC (PV-SUB)  60780000
607900             MOVE DP015-HL-OFF          TO MR-LOC-CODEH (PV-SUB)  60790000
608000             MOVE DP015-UNP-ALP-NOR-OFF TO MR-SELECTA   (PV-SUB)  60800000
608100             MOVE DP015-GREEN           TO MR-SELECTC   (PV-SUB)  60810000
608200             MOVE DP015-UNDERLINE       TO MR-SELECTH   (PV-SUB)  60820000
608300         END-PERFORM                                              60830000
608400                                                                  60840000
608500     ELSE                                                         60850000
608600                                                                  60860000
608700         MOVE DP015-UNP-ALP-NOR-OFF   TO AOPERA                   60870000
608800         MOVE DP015-UNP-NUM-NOR-OFF   TO ADMGCTNA                 60880000
608900         MOVE DP015-GREEN             TO AOPERC                   60890000
609000                                         ADMGCTNC                 60900000
609100         MOVE DP015-UNDERLINE         TO AOPERH                   60910000
609200                                         ADMGCTNH                 60920000
609300                                                                  60930000
609400         PERFORM                                                  60940000
609500             VARYING PV-SUB                                       60950000
609600                 FROM 1 BY 1                                      60960000
609700                 UNTIL PV-SUB > ASC-ITEMS-DISPLAYED               60970000
609800             MOVE DP015-UNP-ALP-NOR-OFF TO MR-SELECTA   (PV-SUB)  60980000
609900                                           MR-LOC-CODEA (PV-SUB)  60990000
610000             MOVE DP015-GREEN         TO MR-SELECTC   (PV-SUB)    61000000
610100                                         MR-LOC-CODEC (PV-SUB)    61010000
610200             MOVE DP015-UNDERLINE     TO MR-SELECTH   (PV-SUB)    61020000
610300                                         MR-LOC-CODEH (PV-SUB)    61030000
610400         END-PERFORM                                              61040000
610500                                                                  61050000
610600         IF ASC-CLERK  = SPACES                                   61060000
610700             MOVE DP015-YELLOW        TO ARCVCLKC                 61070000
610800         END-IF                                                   61080000
610900         IF ASC-LOC-CODE (1, 1) = SPACES                          61090000
611000             MOVE DP015-YELLOW        TO MR-LOC-CODEC (1)         61100000
611100          END-IF                                                  61110000
611200                                                                  61120000
611300         IF ASC-LOC-CODE (1, 2) = SPACES                          61130000
611400             MOVE DP015-YELLOW        TO MR-LOC-CODEC (2)         61140000
611500         END-IF                                                   61150000
611600                                                                  61160000
611700         IF ASC-LOC-CODE (1, 3) = SPACES                          61170000
611800             MOVE DP015-YELLOW        TO MR-LOC-CODEC (3)         61180000
611900         END-IF                                                   61190000
612000                                                                  61200000
612100         IF ASC-ACT-CRTN-CNT = ZERO OR SPACES                     61210000
612200             MOVE DP015-YELLOW        TO AACTCTNC                 61220000
612300             MOVE DP015-UNP-NUM-BRT-MDT  TO AACTCTNA              61230000
612400         END-IF                                                   61240000
612500                                                                  61250000
612600      END-IF.                                                     61260000
612700/                                                                 61270000
612800 3202-VALIDATE-RECEIVER.                                          61280000
612900     EXEC SQL                                                     61290000
613000          SELECT   CURR_OPER_UNT_ID                               61300000
613100            INTO  :RECEIV-CURR-OPER-UNT-ID                        61310000
613200            FROM                                                  61320000
613300                  TRECEIV                                         61330000
613400            WHERE ORD_NBR           = :ASC-PO-NBR                 61340000
613500              AND REC_SEQ_NBR       = :ASC-RCVR-SEQ-NBR           61350000
613600              AND VER_STATUS_CDE    = 'A'                         61360000
613700     END-EXEC.                                                    61370000
613800                                                                  61380000
613900     EVALUATE TRUE                                                61390000
614000         WHEN SQLCODE = ZERO                                      61400000
614100             IF RECEIV-CURR-OPER-UNT-ID > 0                       61410000
614200                CONTINUE                                          61420000
614300             ELSE                                                 61430000
614400                SET PS-ERROR             TO TRUE                  61440000
614500                SET DP020-MSG-FATAL      TO TRUE                  61450000
614600                MOVE PC-TSYMSG-00954     TO DP020-MSG-NUMBER      61460000
614700                SET  DP030-SET-CURSOR-APPL-1 TO TRUE              61470000
614800             END-IF                                               61480000
614801         WHEN SQLCODE = +100                                      61480100
614802                SET PS-ERROR             TO TRUE                  61480200
614803                SET DP020-MSG-FATAL      TO TRUE                  61480300
614804                MOVE PC-TSYMSG-00954     TO DP020-MSG-NUMBER      61480400
614805                SET  DP030-SET-CURSOR-APPL-1 TO TRUE              61480500
614806         WHEN SQLCODE = -904                                      61480600
614807         WHEN SQLCODE = -911                                      61480700
614808         WHEN SQLCODE = -913                                      61480800
614809                SET PS-ERROR             TO TRUE                  61480900
614810                SET DP020-MSG-FATAL      TO TRUE                  61481000
614811                MOVE PC-TSYMSG-00954     TO DP020-MSG-NUMBER      61481100
614812                SET  DP030-SET-CURSOR-APPL-1 TO TRUE              61481200
614813         WHEN SQLWARN0 NOT = SPACES                               61481300
614814         WHEN SQLCODE  NOT = ZERO                                 61481400
614815             MOVE '3202-VALIDATE-RECEIVER'  TO DP013-PARAGRAPH    61481500
614816             MOVE 'CALL TO RCKUT127'  TO DP013-MESSAGE-TEXT(1)    61481600
614817             STRING 'MSG - '                                      61481700
614818                     RC040-CRA-RET-MSG   DELIMITED BY SIZE        61481800
614819                              INTO DP013-MESSAGE-TEXT (2)         61481900
614820              MOVE ASC-PO-NBR      TO PV-TRLR-ERROR-PO            61482000
614821              MOVE ASC-RCVR-SEQ-NBR TO PV-TRLR-ERROR-SEQ          61482100
614822              MOVE ASC-OPER-UNT-ID TO PV-TRLR-ERROR-OPER-UNT-ID   61482200
614823              MOVE ASC-SCAC        TO PV-TRLR-ERROR-SCAC          61482300
614824              MOVE ASC-TRLR-NBR    TO PV-TRLR-ERROR-TRLR          61482400
614825              MOVE PV-TRLR-ERROR-MSG  TO DP013-MESSAGE-TEXT (3)   61482500
614826              MOVE RC040-SQLCA    TO DP013-SQLCA                  61482600
614827              SET DP013-DB2-ABEND                                 61482700
614828                  DP013-ROLLBACK                                  61482800
614829                  DP013-XCTL-DISPLAY-RESTART                      61482900
614830                                      TO TRUE                     61483000
614831                  PERFORM DP013-0000-PROCESS-ABEND                61483100
614832     END-EVALUATE.                                                61483200
614833                                                                  61483301
614834*----------------------------------------------------------------*61483400
614835*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *61483500
614836*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *61483600
614837*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *61483700
614838*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *61483800
614839*----------------------------------------------------------------*61483900
614840 3300-EDIT-SELECTIONS.                                            61484000
614841                                                                  61484100
614850     EVALUATE TRUE                                                61485000
614860         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     61486000
614870             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         61487000
614880                 CONTINUE                                         61488000
614890                                                                  61489000
614900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     61490000
615000              = SPACES AND                                        61500000
615100               ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         61510000
615200              = SPACES                                            61520000
615300                 CONTINUE                                         61530000
615400                                                                  61540000
615500         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         61550000
615600             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        61560000
615700                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS61570000
615800                 MOVE ASC-TEMP-SELECTED-SW                        61580000
615900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   61590000
616000                                   TO ASC-SELECTED-SW             61600000
616100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   61610000
616200             END-IF                                               61620000
616300                                                                  61630000
616400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     61640000
616500                 = SPACE                                          61650000
616600             EVALUATE TRUE                                        61660000
616700                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       61670000
616800                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS61680000
616900                     MOVE SPACE    TO ASC-SELECTED-SW             61690000
617000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   61700000
617100                                                                  61710000
617200                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        61720000
617300                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE 61730000
617400                     MOVE SPACE    TO ASC-SELECTED-SW             61740000
617500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   61750000
617600                                                                  61760000
617700                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          61770000
617800                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   61780000
617900                     MOVE SPACE    TO ASC-SELECTED-SW             61790000
618000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   61800000
618100             END-EVALUATE                                         61810000
618200                                                                  61820000
618300         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           61830000
618400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            61840000
618500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    61850000
618600             END-IF                                               61860000
618700             PERFORM 3310-EDIT-RANGE                              61870000
618800                                                                  61880000
618900         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             61890000
619000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            61900000
619100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    61910000
619200             END-IF                                               61920000
619300             PERFORM 3310-EDIT-RANGE                              61930000
619400                                                                  61940000
619500         WHEN OTHER                                               61950000
619600             IF DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID) OR         61960000
619700                ASC-ACT-CNT-ZERO-F15-CONFIRM                      61970000
619800                 CONTINUE                                         61980000
619900             ELSE                                                 61990000
620000                 MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER        62000000
620100                 SET DP020-MSG-FATAL   TO TRUE                    62010000
620200                 MOVE -1               TO MR-SELECTL (PV-SUB)     62020000
620300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              62030000
620400                 MOVE DP015-RED        TO MR-SELECTC (PV-SUB)     62040000
620500                 MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)     62050000
620600                 SET PS-ERROR          TO TRUE                    62060000
620700                 IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        62070000
620800                     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS 62080000
620900                     MOVE SPACE        TO ASC-SELECTED-SW         62090000
621000                                        (ASC-BLK-SUB ASC-ITEM-SUB)62100000
621100                 END-IF                                           62110000
621200             END-IF                                               62120000
621300     END-EVALUATE.                                                62130000
621400                                                                  62140000
621500     SUBTRACT +1 FROM PV-ITEM-IN-USE.                             62150000
621600     SUBTRACT +1 FROM ASC-ITEM-SUB.                               62160000
621700                                                                  62170000
621800     IF  ASC-ITEM-SUB < 1                                         62180000
622000         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                62200000
622100     END-IF.                                                      62210000
622200                                                                  62220000
622300*----------------------------------------------------------------*62230000
622400*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *62240000
622500*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *62250000
622600*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *62260000
622700*  THE ENDING.                                                   *62270000
622800*----------------------------------------------------------------*62280000
622900 3310-EDIT-RANGE.                                                 62290000
623000                                                                  62300000
623100     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                62310000
623200         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   62320000
623300             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)62330000
623400                                   TO ASC-SELECTED-SW             62340000
623500                                        (ASC-BLK-SUB ASC-ITEM-SUB)62350000
623600             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 62360000
623700         ELSE                                                     62370000
623800             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     62380000
623900                 CONTINUE                                         62390000
624000             ELSE                                                 62400000
624100*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        62410000
624200                 MOVE PC-TSYMSG-00054                             62420000
624300                                   TO DP020-MSG-NUMBER            62430000
624400                 SET DP020-MSG-FATAL                              62440000
624500                                   TO TRUE                        62450000
624600                 MOVE -1           TO MR-SELECTL (PV-SUB)         62460000
624700                 SET DP030-SET-CURSOR-APPL-1                      62470000
624800                                   TO TRUE                        62480000
624900                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         62490000
625000                 MOVE DP015-UNDERLINE                             62500000
625100                                   TO MR-SELECTH (PV-SUB)         62510000
625200                 SET PS-ERROR      TO TRUE                        62520000
625300             END-IF                                               62530000
625400         END-IF                                                   62540000
625500     ELSE                                                         62550000
625600         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     62560000
625700             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 62570000
625800                                   TO ASC-SELECTED-SW             62580000
625900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   62590000
626000             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   62600000
626100         ELSE                                                     62610000
626200             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       62620000
626300                 CONTINUE                                         62630000
626400             ELSE                                                 62640000
626500*                -- ONLY ONE END-OF-RANGE ALLOWED --              62650000
626600                 MOVE PC-TSYMSG-00055                             62660000
626700                                   TO DP020-MSG-NUMBER            62670000
626800                 SET DP020-MSG-FATAL                              62680000
626900                                   TO TRUE                        62690000
627000                 MOVE -1           TO MR-SELECTL (PV-SUB)         62700000
627100                 SET DP030-SET-CURSOR-APPL-1                      62710000
627200                                   TO TRUE                        62720000
627300                 SET PS-ERROR      TO TRUE                        62730000
627400             END-IF                                               62740000
627500         END-IF                                                   62750000
627600     END-IF.                                                      62760000
627700                                                                  62770000
627800*----------------------------------------------------------------*62780000
627900*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *62790000
628000*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *62800000
628100*----------------------------------------------------------------*62810000
628200 3400-CHECK-RANGE-SEQUENCE.                                       62820000
628300                                                                  62830000
628400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       62840000
628500       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      62850000
628600       AND  ASC-START-OF-SELECTED-RANGE >                         62860000
628700                                         ASC-END-OF-SELECTED-RANGE62870000
628800*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                62880000
628900         MOVE PC-TSYMSG-00052      TO DP020-MSG-NUMBER            62890000
629000         SET DP020-MSG-FATAL       TO TRUE                        62900000
629100         SET PS-ERROR              TO TRUE                        62910000
629200         PERFORM 3410-POSITION-AT-ERROR                           62920000
629300     END-IF.                                                      62930000
629400                                                                  62940000
629500*----------------------------------------------------------------*62950000
629600*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *62960000
629700*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *62970000
629800*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *62980000
629900*----------------------------------------------------------------*62990000
630000 3410-POSITION-AT-ERROR.                                          63000000
630100                                                                  63010000
630200     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       63020000
630300                                                                  63030000
630400     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 63040000
630500                    - PV-TOP-ITEM + 1.                            63050000
630600                                                                  63060000
630700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      63070000
630800         CONTINUE                                                 63080000
630900     ELSE                                                         63090000
631000         MOVE -1                   TO MR-SELECTL (PV-SUB)         63100000
631100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         63110000
631200         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         63120000
631300     END-IF.                                                      63130000
631400                                                                  63140000
631500     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   63150000
631600                    - PV-TOP-ITEM + 1.                            63160000
631700                                                                  63170000
631800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      63180000
631900         CONTINUE                                                 63190000
632000     ELSE                                                         63200000
632100         MOVE -1                   TO MR-SELECTL (PV-SUB)         63210000
632200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         63220000
632300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         63230000
632400     END-IF.                                                      63240000
632500                                                                  63250000
632600*----------------------------------------------------------------*63260000
632700*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *63270000
632800*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *63280000
632900*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *63290000
633000*----------------------------------------------------------------*63300000
633100 3500-MARK-RANGE-AS-SELECTED.                                     63310000
633200                                                                  63320000
633300     MOVE +1                       TO ASC-BLK-SUB.                63330000
633400                                                                  63340000
633500     PERFORM 3510-MARK-SELECTED-INDS                              63350000
633600         VARYING ASC-ITEM-SUB                                     63360000
633700         FROM 1 BY 1                                              63370000
633800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 63380000
633900                                                                  63390000
634000     ADD +1                        TO ASC-BLK-SUB.                63400000
634100                                                                  63410000
634200     PERFORM 3510-MARK-SELECTED-INDS                              63420000
634300         VARYING ASC-ITEM-SUB                                     63430000
634400         FROM 1 BY 1                                              63440000
634500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 63450000
634600                                                                  63460000
634700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               63470000
634800                                   TO PV-LIST-ITEM-NUMBER.        63480000
634900                                                                  63490000
635000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            63500000
635100         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         63510000
635200               PC-ITEMS-PER-PANEL).                               63520000
635300                                                                  63530000
635400     MOVE ASC-START-OF-SELECTED-RANGE                             63540000
635500                                   TO PV-START-OF-SELECTED-RANGE. 63550000
635600                                                                  63560000
635700     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            63570000
635800         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  63580000
635900               PC-ITEMS-PER-PANEL).                               63590000
636000                                                                  63600000
636100     MOVE ASC-END-OF-SELECTED-RANGE                               63610000
636200                                   TO PV-END-OF-SELECTED-RANGE.   63620000
636300                                                                  63630000
636400     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             63640000
636500         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    63650000
636600               PC-ITEMS-PER-PANEL).                               63660000
636700                                                                  63670000
636800     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             63680000
636900         PV-FIRST-BLOCK-IN-ARRAY + 1.                             63690000
637000                                                                  63700000
637100     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    63710000
637200        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        63720000
637300         MOVE +1                   TO ASC-BLK-SUB                 63730000
637400         PERFORM 5100-WRITE-TEMP-STORAGE                          63740000
637500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         63750000
637600             PV-FIRST-BLOCK-IN-ARRAY - 1                          63760000
637700                                                                  63770000
637800         PERFORM                                                  63780000
637900             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      63790000
638000                   PV-PREV-BLOCK-IN-ARRAY                         63800000
638100             MOVE PV-FIRST-BLOCK-IN-RANGE                         63810000
638200                                   TO PV-BLOCK-NUMBER             63820000
638300             PERFORM 4410-READ-TEMP-STORAGE                       63830000
638400             PERFORM 3510-MARK-SELECTED-INDS                      63840000
638500                 VARYING ASC-ITEM-SUB                             63850000
638600                 FROM 1 BY 1                                      63860000
638700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          63870000
638800             PERFORM 5100-WRITE-TEMP-STORAGE                      63880000
638900             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     63890000
639000         END-PERFORM                                              63900000
639100                                                                  63910000
639200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         63920000
639300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     63930000
639400         PERFORM                                                  63940000
639500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       63950000
639600                   PV-LAST-BLOCK-IN-RANGE                         63960000
639700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          63970000
639800                                   TO PV-BLOCK-NUMBER             63980000
639900             PERFORM 4410-READ-TEMP-STORAGE                       63990000
640000             PERFORM 3510-MARK-SELECTED-INDS                      64000000
640100                 VARYING ASC-ITEM-SUB                             64010000
640200                 FROM 1 BY 1                                      64020000
640300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          64030000
640400             PERFORM 5100-WRITE-TEMP-STORAGE                      64040000
640500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      64050000
640600         END-PERFORM                                              64060000
640700                                                                  64070000
640800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             64080000
640900                                   TO PV-BLOCK-NUMBER             64090000
641000         PERFORM 4410-READ-TEMP-STORAGE                           64100000
641100     END-IF.                                                      64110000
641200                                                                  64120000
641300     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 64130000
641400                                      ASC-END-OF-SELECTED-RANGE.  64140000
641500                                                                  64150000
641600*----------------------------------------------------------------*64160000
641700* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *64170000
641800*----------------------------------------------------------------*64180000
641900 3510-MARK-SELECTED-INDS.                                         64190000
642000                                                                  64200000
642100     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         64210000
642200         ASC-START-OF-SELECTED-RANGE)                             64220000
642300     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         64230000
642400         ASC-START-OF-SELECTED-RANGE)                             64240000
642500                                                                  64250000
642600         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     64260000
642700             ASC-END-OF-SELECTED-RANGE)                           64270000
642800         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     64280000
642900             ASC-END-OF-SELECTED-RANGE)                           64290000
643000                                                                  64300000
643100             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          64310000
643200                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   64320000
643300                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   64330000
643400                                   TO TRUE                        64340000
643500                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              64350000
643600                                   TO TRUE                        64360000
643700                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS64370000
643800             END-IF                                               64380000
643900         END-IF                                                   64390000
644000     END-IF.                                                      64400000
644100                                                                  64410000
644200*----------------------------------------------------------------*64420000
644300*    SAVE SCREEN FIELDS FOR LATER COMPARISONS                    *64430000
644400*----------------------------------------------------------------*64440000
644500 3600-SAVE-SCREEN-FIELDS.                                         64450000
644600     MOVE ASC-STATUS            TO  ASC-STATUS-OLD.               64460000
644700     MOVE ASC-OPER-SET          TO  ASC-OPER-SET-OLD.             64470000
644800     MOVE ASC-CLERK             TO  ASC-CLERK-OLD.                64480000
644900     MOVE ASC-ACT-CRTN-CNT      TO  ASC-ACT-CRTN-CNT-OLD.         64490000
645000     MOVE ASC-DMG-CRTN-CNT      TO  ASC-DMG-CRTN-CNT-OLD.         64500000
645100     MOVE ASC-LOC-CODE (1, 1)   TO  ASC-LOC-CODE-1-1.             64510000
645200     MOVE ASC-LOC-CODE (1, 2)   TO  ASC-LOC-CODE-1-2.             64520000
645300     MOVE ASC-LOC-CODE (1, 3)   TO  ASC-LOC-CODE-1-3.             64530000
645400                                                                  64540000
645500*----------------------------------------------------------------*64550000
645600*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *64560000
645700*    INITIALIZE ALL COUNTERS AND FLAGS.                          *64570000
645800*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *64580000
645900*    DISPLAY THE PANEL TO USER.                                  *64590000
646000*----------------------------------------------------------------*64600000
646100 4000-BUILD-INITIAL-PANEL.                                        64610000
646200                                                                  64620000
646300     INITIALIZE ASC-BLOCK-ENTRIES (1)                             64630000
646400                ASC-BLOCK-ENTRIES (2).                            64640000
646500                                                                  64650000
646600     MOVE +1                       TO ASC-BLK-SUB.                64660000
646700                                                                  64670000
646800     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       64680000
646900                                                                  64690000
647000     MOVE +0                       TO ASC-ITEM-SUB                64700000
647100                                      ASC-NUMBER-OF-ITEMS-READ    64710000
647200                                      ASC-NUMBER-OF-SELECTED-ITEMS64720000
647300                                      ASC-HIGHEST-BLOCK-WRITTEN   64730000
647400                                      ASC-START-OF-SELECTED-RANGE 64740000
647500                                      ASC-END-OF-SELECTED-RANGE   64750000
647600                                      ASC-ITEM-AT-TOP-OF-PANEL.   64760000
647700                                                                  64770000
647800     PERFORM 4100-PREPARE-CURSOR.                                 64780000
647900     PERFORM 4010-OPEN-CURSOR.                                    64790000
648000     PERFORM 4300-READ-ITEMS-FROM-DB.                             64800000
648100     PERFORM 4020-CLOSE-CURSOR.                                   64810000
648200                                                                  64820000
648300     MOVE +1                       TO PV-TOP-ITEM.                64830000
648400                                                                  64840000
649200         MOVE +1                     TO ASC-BLK-SUB               64920000
649300                                        PV-BLOCK-NUMBER.          64930000
649400         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                    64940000
649600                                                                  64960000
649700*----------------------------------------------------------------*64970000
649800* OPEN THE RCVR CURSOR.                                          *64980000
649900*----------------------------------------------------------------*64990000
650000 4010-OPEN-CURSOR.                                                65000000
650100                                                                  65010000
650200     PERFORM                                                      65020000
650300         WITH TEST AFTER                                          65030000
650400         VARYING PV-RETRY-COUNTER                                 65040000
650500         FROM 1 BY 1                                              65050000
650600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               65060000
650700            OR (SQLCODE = +0))                                    65070000
650800                                                                  65080000
650900         EXEC SQL                                                 65090000
651000             OPEN LIST-CSR                                        65100000
651100         END-EXEC                                                 65110000
651200                                                                  65120000
651300         EVALUATE TRUE                                            65130000
651400             WHEN SQLCODE = +0                                    65140000
651500                  CONTINUE                                        65150000
651600             WHEN SQLCODE = -904                                  65160000
651700             WHEN SQLCODE = -913                                  65170000
651800                  CONTINUE                                        65180000
651900             WHEN SQLWARN0 NOT = SPACE                            65190000
652000             WHEN SQLCODE  NOT = +0                               65200000
652100                  MOVE '4010-OPEN-CURSOR'                         65210000
652200                                   TO DP013-PARAGRAPH             65220000
652300                  MOVE 'OPEN LIST-CSR CURSOR'                     65230000
652400                                   TO DP013-MESSAGE-TEXT (1)      65240000
652500                  MOVE SQLCA       TO DP013-SQLCA                 65250000
652600                  MOVE 'TWKORIN'   TO DP013-DB2-TABLE-NAME (1)    65260000
652700                  SET DP013-DB2-ABEND                             65270000
652800                                   TO TRUE                        65280000
652900                  PERFORM DP013-0000-PROCESS-ABEND                65290000
653000         END-EVALUATE                                             65300000
653100     END-PERFORM.                                                 65310000
653200                                                                  65320000
653300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        65330000
653400                 AND SQLCODE NOT = ZERO                           65340000
653500         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             65350000
653600         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              65360000
653700                                   TO DP013-MESSAGE-TEXT (1)      65370000
653800         MOVE SQLCA                TO DP013-SQLCA                 65380000
653900         SET DP013-DB2-ABEND       TO TRUE                        65390000
654000         PERFORM DP013-0000-PROCESS-ABEND                         65400000
654100     END-IF.                                                      65410000
654200                                                                  65420000
654300*----------------------------------------------------------------*65430000
654400* CLOSE THE CURSOR                                                65440000
654500*----------------------------------------------------------------*65450000
654600 4020-CLOSE-CURSOR.                                               65460000
654700                                                                  65470000
654800     EXEC SQL                                                     65480000
654900         CLOSE LIST-CSR                                           65490000
655000     END-EXEC.                                                    65500000
655100                                                                  65510000
655200     EVALUATE TRUE                                                65520000
655300         WHEN SQLCODE = +0                                        65530000
655400              CONTINUE                                            65540000
655500         WHEN SQLWARN0 NOT = SPACE                                65550000
655600         WHEN SQLCODE  NOT = +0                                   65560000
655700              MOVE '4020-CLOSE-CURSOR'                            65570000
655800                                   TO DP013-PARAGRAPH             65580000
655900              MOVE 'CLOSE LIST-CSR CURSOR'                        65590000
656000                                   TO DP013-MESSAGE-TEXT (1)      65600000
656100              MOVE SQLCA           TO DP013-SQLCA                 65610000
656200              MOVE 'TWKORIN'       TO DP013-DB2-TABLE-NAME (1)    65620000
656300              SET DP013-DB2-ABEND  TO TRUE                        65630000
656400              PERFORM DP013-0000-PROCESS-ABEND                    65640000
656500     END-EVALUATE.                                                65650000
656600                                                                  65660000
656700*----------------------------------------------------------------*65670000
656800*    DEPENDING ON WHAT WAS PASSED IN THE COMMAREA, SETUP THE     *65680000
656900*    DB2 KEYS IN PREPARATION FOR THE OPEN CURSROR.               *65690000
657000*----------------------------------------------------------------*65700000
657100 4100-PREPARE-CURSOR.                                             65710000
657200                                                                  65720000
657300     MOVE ASC-PO-NBR              TO DK-PO-NBR.                   65730000
657400     MOVE ASC-RCVR-SEQ-NBR        TO DK-RCVR-NBR.                 65740000
657500     MOVE 0                       TO ASC-LINE-NBR.                65750000
657600     PERFORM 4500-GET-VERIFIED-INFO.                              65760000
657700     PERFORM 4560-GET-OPER-SET-INFO.                              65770000
657800     PERFORM 4565-GET-CARTON-INFO.                                65780000
657900                                                                  65790000
658000*----------------------------------------------------------------*65800000
658100*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *65810000
658200*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *65820000
658300*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *65830000
658400*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *65840000
658500*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *65850000
658600*                                                                *65860000
658700*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *65870000
658800*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *65880000
658900*    UPON INITIALIZATION.                                        *65890000
659000*----------------------------------------------------------------*65900000
659100 4300-READ-ITEMS-FROM-DB.                                         65910000
659200                                                                  65920000
659300     PERFORM                                                      65930000
659400         VARYING PV-READ-COUNT                                    65940000
659500         FROM 1 BY 1                                              65950000
659600         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    65960000
659700            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         65970000
659800                                                                  65980000
659900         PERFORM 4310-FETCH                                       65990000
660000                                                                  66000000
660100         IF  ASC-ITEMS-LEFT-ON-DB                                 66010000
660200             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                66020000
660300                 ADD +1            TO ASC-ITEM-SUB                66030000
660400             ELSE                                                 66040000
660500                 ADD +1            TO ASC-BLK-SUB                 66050000
660600                 MOVE +1           TO ASC-ITEM-SUB                66060000
660700                                                                  66070000
660800                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         66080000
660900                     MOVE +1       TO ASC-BLK-SUB                 66090000
661000                     SET ASC-BLOCK-MODIFIED (1)                   66100000
661100                                   TO TRUE                        66110000
661200                     PERFORM 5100-WRITE-TEMP-STORAGE              66120000
661300                     MOVE ASC-BLOCK-ENTRIES                       66130000
661400                               (PC-MAX-BLOCKS-IN-ARRAY)           66140000
661500                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 66150000
661600                     ADD +1        TO ASC-BLK-SUB                 66160000
661700                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   66170000
661800                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      66180000
661900                                   TO TRUE                        66190000
662000                 END-IF                                           66200000
662100             END-IF                                               66210000
662200             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    66220000
662300             MOVE ASC-NUMBER-OF-ITEMS-READ                        66230000
662400                                   TO ASC-LIST-ITEM-NUMBER        66240000
662500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  66250000
662600             STRING OPERAT-OPER-DESC     DELIMITED BY '  '        66260000
662700                    ' '                  DELIMITED BY SIZE        66270000
662800                    WKORIN-FCLTY-AREA-ID DELIMITED BY SIZE        66280000
662900                                 INTO  ASC-INSTRCT-DESC           66290000
663000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 66300000
663100             MOVE WKORIN-SCREEN-SEQ-NBR TO                        66310000
663200                               ASC-SEQ (ASC-BLK-SUB ASC-ITEM-SUB) 66320000
663300             MOVE WKORIN-LNE-LOC-CDE TO                           66330000
663400                          ASC-LOC-CODE (ASC-BLK-SUB ASC-ITEM-SUB) 66340000
663500             MOVE WKORIN-WO-INSTR-SEQ-NBR TO                      66350000
663600                  ASC-WO-INSTR-SEQ-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 66360000
663700                                                                  66370000
663800             MOVE WKORIN-STRT-TMST TO PV-DB2-DATE                 66380000
663900             IF  PV-DB2-CC = '99'                                 66390000
664000                 MOVE SPACES       TO ASC-DATE-STRT               66400000
664100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 66410000
664200                                       ASC-TIME-STRT              66420000
664300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 66430000
664400             ELSE                                                 66440000
664500                 STRING PV-DB2-MM      DELIMITED BY SIZE          66450000
664600                        '/'            DELIMITED BY SIZE          66460000
664700                        PV-DB2-DD      DELIMITED BY SIZE          66470000
664800                    INTO ASC-DATE-STRT (ASC-BLK-SUB ASC-ITEM-SUB) 66480000
664900                 STRING PV-DB2-HH       DELIMITED BY SIZE         66490000
665000                        ':'             DELIMITED BY SIZE         66500000
665100                        PV-DB2-MN       DELIMITED BY SIZE         66510000
665200                    INTO ASC-TIME-STRT (ASC-BLK-SUB ASC-ITEM-SUB) 66520000
665300             END-IF                                               66530000
665400             MOVE WKORIN-STOP-TMST TO PV-DB2-DATE                 66540000
665500             IF  PV-DB2-CC = '99'                                 66550000
665600                 MOVE SPACES       TO ASC-DATE-COMP               66560000
665700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 66570000
665800                                       ASC-TIME-COMP              66580000
665900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 66590000
666000             ELSE                                                 66600000
666100                 STRING PV-DB2-MM      DELIMITED BY SIZE          66610000
666200                        '/'            DELIMITED BY SIZE          66620000
666300                        PV-DB2-DD      DELIMITED BY SIZE          66630000
666400                    INTO ASC-DATE-COMP (ASC-BLK-SUB ASC-ITEM-SUB) 66640000
666500                 STRING PV-DB2-HH       DELIMITED BY SIZE         66650000
666600                        ':'             DELIMITED BY SIZE         66660000
666700                        PV-DB2-MN       DELIMITED BY SIZE         66670000
666800                    INTO ASC-TIME-COMP (ASC-BLK-SUB ASC-ITEM-SUB) 66680000
666900             END-IF                                               66690000
667000         END-IF                                                   66700000
667100     END-PERFORM.                                                 66710000
667200                                                                  66720000
667300     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          66730000
667400         MOVE +1                   TO ASC-BLK-SUB                 66740000
667500         PERFORM 5100-WRITE-TEMP-STORAGE                          66750000
667600         ADD +1                    TO ASC-BLK-SUB                 66760000
667700         PERFORM 5100-WRITE-TEMP-STORAGE                          66770000
667800         MOVE 1                    TO ASC-BLK-SUB                 66780000
667900                                      PV-BLOCK-NUMBER             66790000
668100         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             66810000
668200             MOVE 2                TO ASC-BLK-SUB                 66820000
668300                                      PV-BLOCK-NUMBER             66830000
668400             PERFORM 4410-READ-TEMP-STORAGE                       66840000
668500         END-IF                                                   66850000
668600     END-IF.                                                      66860000
668700                                                                  66870000
668800*----------------------------------------------------------------*66880000
668900*    FETCH A ROW                                                  66890000
669000*----------------------------------------------------------------*66900000
669100 4310-FETCH.                                                      66910000
669200                                                                  66920000
669300     EXEC SQL                                                     66930000
669400          FETCH  LIST-CSR                                         66940000
669500          INTO  :OPERAT-OPER-DESC                                 66950000
669600              , :WKORIN-SCREEN-SEQ-NBR                            66960000
669700              , :WKORIN-FCLTY-AREA-ID                             66970000
669800              , :WKORIN-EXPTED-CART-CNT                           66980000
669900              , :WKORIN-ACTL-CART-CNT                             66990000
670000              , :WKORIN-STRT-TMST                                 67000000
670100              , :WKORIN-STOP-TMST                                 67010000
670200              , :WKORIN-WO-INSTR-SEQ-NBR                          67020000
670300              , :WKORIN-LNE-LOC-CDE                               67030000
670400     END-EXEC.                                                    67040000
670500                                                                  67050000
670600     EVALUATE TRUE                                                67060000
670700         WHEN SQLCODE = +0                                        67070000
670800              IF  WKORIN-LNE-LOC-CDE EQUAL LOW-VALUE              67080000
670900                  MOVE SPACES      TO WKORIN-LNE-LOC-CDE          67090000
671000              END-IF                                              67100000
671100         WHEN SQLCODE = +100                                      67110000
671200              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 67120000
671300         WHEN SQLWARN0 NOT = SPACE                                67130000
671400         WHEN SQLCODE < +0                                        67140000
671500         WHEN SQLCODE > +0                                        67150000
671600              MOVE '4310-FETCH-CURSOR'                            67160000
671700                                   TO DP013-PARAGRAPH             67170000
671800              MOVE 'FETCH LIST CURSOR'                            67180000
671900                                   TO DP013-MESSAGE-TEXT (1)      67190000
672000              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 67200000
672100              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               67210000
672200              MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID        67220000
672300              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      67230000
672400              MOVE SQLCA           TO DP013-SQLCA                 67240000
672500              MOVE 'TWKORIN'       TO DP013-DB2-TABLE-NAME (1)    67250000
672600              SET DP013-DB2-ABEND  TO TRUE                        67260000
672700              PERFORM DP013-0000-PROCESS-ABEND                    67270000
672800     END-EVALUATE.                                                67280000
672900                                                                  67290000
673000*----------------------------------------------------------------*67300000
673100* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *67310000
673200*----------------------------------------------------------------*67320000
673300 4400-MOVE-COMMAREA-TO-SCREEN.                                    67330000
673400                                                                  67340000
673500     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             67350000
673600         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          67360000
673700         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          67370000
673800             MOVE +1               TO ASC-BLK-SUB                 67380000
673900             PERFORM 5100-WRITE-TEMP-STORAGE                      67390000
674000             ADD +1                TO ASC-BLK-SUB                 67400000
674100             PERFORM 5100-WRITE-TEMP-STORAGE                      67410000
674200             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             67420000
674300                 GIVING PV-BLOCK-NUMBER                           67430000
674400                 REMAINDER PV-REMAINDER                           67440000
674500             IF  PV-REMAINDER > ZERO                              67450000
674600                 ADD +1            TO PV-BLOCK-NUMBER             67460000
674700             END-IF                                               67470000
674800             MOVE +1               TO ASC-BLK-SUB                 67480000
674900             PERFORM 4410-READ-TEMP-STORAGE                       67490000
675000             ADD +1                TO ASC-BLK-SUB                 67500000
675100                                      PV-BLOCK-NUMBER             67510000
675200             PERFORM 4410-READ-TEMP-STORAGE                       67520000
675300     END-IF.                                                      67530000
675400                                                                  67540000
675500     MOVE +1                       TO ASC-BLK-SUB.                67550000
675600                                                                  67560000
675700     COMPUTE ASC-ITEM-SUB =                                       67570000
675800         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              67580000
675900         + PC-ITEMS-PER-PANEL).                                   67590000
676000                                                                  67600000
676100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        67610000
676200         ADD +1                    TO ASC-BLK-SUB                 67620000
676300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            67630000
676400     END-IF.                                                      67640000
676500                                                                  67650000
676600     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           67660000
676700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                67670000
676800                                                                  67680000
676900     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        67690000
677000     PERFORM 4420-FORMAT-LIST-LINES                               67700000
677100         VARYING PV-SUB                                           67710000
677200         FROM PC-ITEMS-PER-PANEL BY -1                            67720000
677300         UNTIL PV-SUB < +1.                                       67730000
677400                                                                  67740000
677500     COMPUTE ASC-ITEMS-DISPLAYED =                                67750000
677600         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          67760000
677700                                                                  67770000
677800     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    67780000
677900                                      ASTRTITO.                   67790000
678000                                                                  67800000
678100     MOVE ASC-ITEM-AT-BOT-OF-PANEL     TO AENDITO.                67810000
678200     MOVE ASC-NUMBER-OF-ITEMS-READ     TO ATOTITO.                67820000
678400                                                                  67840000
678500     MOVE ASC-PO-NBR            TO DK-PO.                         67850000
678600     MOVE ASC-RCVR-SEQ-NBR      TO DK-RCVR.                       67860000
678700     MOVE DK-PO-RCVR-NBR        TO APORCVRO.                      67870000
678800* CLT 06/28/2010 START                                            67880000
678900     PERFORM 4537-REPLENISHMENT-IND.                              67890000
679000     IF ASC-REPLEN-IND = 'Y'                                      67900000
679100         MOVE 'RPLEN'           TO AREPLENO                       67910000
679200     ELSE                                                         67920000
679300         MOVE SPACES            TO AREPLENO                       67930000
679400     END-IF.                                                      67940000
679500* CLT 06/28/2010 END                                              67950000
679600     MOVE ASC-SCAC              TO ASCACO.                        67960000
679700     MOVE ASC-TRIP-ID           TO ATRIPIDO.                      67970000
679800     MOVE ASC-VENDOR            TO AVENDORO.                      67980000
679900     MOVE ASC-TRLR-NBR          TO ATRLRNOO.                      67990000
680000     MOVE ASC-PACKAGE           TO APKGO.                         68000000
680100*** DMH 10/09/2003 - BEGIN                                        68010000
680200     MOVE ASC-OPER-SET          TO AOPERO.                        68020000
680300*** DMH 10/09/2003 - END                                          68030000
680400**GET VERIFIED INFO                                               68040000
680500     MOVE ASC-VRFD-DATE     TO AVFDDATO.                          68050000
680600     MOVE ASC-VRFD-TIME     TO AVFDTMEO.                          68060000
680610     MOVE ASC-VRFD-USER-ID  TO AVFDBYO.                           68061000
680620     MOVE ASC-CLERK         TO ARCVCLKO.                          68062000
680630     MOVE ASC-STATUS        TO ASTATUSO.                          68063000
680640     MOVE ASC-HANGER        TO AHANGRSO.                          68064000
680650     MOVE ASC-PRETICKET     TO APRETKTO.                          68065000
680651                                                                  68065101
680660**GET TROUBLE INFO                                                68066000
680670     PERFORM 4510-CHECK-IF-IN-TROUBLE.                            68067000
680680     IF ASC-TROUBLE  > SPACE                                      68068000
680690         MOVE DP015-RED         TO ATRBRSNC                       68069000
680700     ELSE                                                         68070000
680800         MOVE DP015-BLUE        TO ATRBRSNC                       68080000
680900     END-IF                                                       68090000
681000     MOVE ASC-TROUBLE           TO ATRBRSNO.                      68100000
681010                                                                  68101001
681100**GET RECIPIENT INFO                                              68110000
681200     PERFORM 4515-CHECK-4-SPCL-INSTRCT.                           68120000
681300     IF PS-DC-RCPNTS                                              68130000
681400         MOVE 'DC ONLY       '  TO ASC-SPCL-INSTRCT               68140000
681500         MOVE ASC-SPCL-INSTRCT  TO ASPCLINO                       68150000
681600         MOVE DP015-RED         TO ASPCLINC                       68160000
681700     ELSE                                                         68170000
681800         MOVE '              ' TO ASC-SPCL-INSTRCT                68180000
681900         MOVE '              ' TO ASPCLINO                        68190000
682000         MOVE DP015-BLUE       TO ASPCLINC                        68200000
682100     END-IF                                                       68210000
682200     MOVE ' ' TO PS-DC-RCPNTS-SW.                                 68220000
682300                                                                  68230001
682400**GET PRESENTATION, TICKET, BOX-ID, AND PRICE INFO                68240000
682500     PERFORM 4520-CHECK-4-PRSNTATN.                               68250000
682600     PERFORM 4580-GET-TICKET-TYPE.                                68260000
682700     MOVE ASC-TKT-DESC      TO ASC-TICKET.                        68270000
682800     MOVE ASC-PRESENTATION  TO APRSNTNO.                          68280000
682900     MOVE ASC-TICKET        TO ATKTTYPO.                          68290000
683000     MOVE ASC-BOX-ID        TO ABOXIDO.                           68300000
683100*LMM                                                              68310000
683200     IF PV-PRICE-CHG-HOLD > SPACES                                68320000
683300        MOVE PV-PRICE-CHG-HOLD TO ASC-PRICE-CHG                   68330000
683400     ELSE                                                         68340000
683500        CONTINUE                                                  68350000
683600     END-IF                                                       68360000
683700                                                                  68370000
683800     MOVE ASC-PRICE-CHG     TO APRCHGO.                           68380000
683900     IF ASC-PRESENTATION = 'HANG                '                 68390000
684000         MOVE DP015-RED     TO APRSNTNC                           68400000
684100                               AHANGRSC                           68410000
684200     ELSE                                                         68420000
685300                 MOVE DP015-BLUE    TO APRSNTNC                   68530000
685400                                       AHANGRSC                   68540000
685700     END-IF                                                       68570000
685800     IF ASC-PRICE-CHG NOT = SPACES                                68580000
685900         MOVE DP015-RED     TO APRCHGC                            68590000
686000     ELSE                                                         68600000
686100         MOVE DP015-BLUE    TO APRCHGC                            68610000
686200     END-IF                                                       68620000
686210                                                                  68621001
686300**GET NEW STORE INFO                                              68630000
686400     PERFORM 4535-GET-NEWSTORE-INFO.                              68640000
686800         MOVE DP015-BLUE    TO ANEWSTRC                           68680000
687000     MOVE ASC-NEWSTORE      TO ANEWSTRO.                          68700000
687010                                                                  68701001
687100**GET RTV INFO                                                    68710000
687200     PERFORM 4540-GET-RTV-INFO.                                   68720000
687300     IF ASC-RTV = 'Y'                                             68730000
687400         MOVE DP015-RED     TO ARTVC                              68740000
687500     ELSE                                                         68750000
687600         MOVE DP015-BLUE    TO ARTVC                              68760000
687700     END-IF.                                                      68770000
687800     MOVE ASC-RTV           TO ARTVO.                             68780000
687810                                                                  68781001
687900**GET SET NAME INFO                                               68790000
688000     PERFORM 4550-GET-SET-NAME-INFO.                              68800000
688100     IF PC240-NO-SEASONAL-SET-FOUND                               68810000
688200     OR PC240-DIVERT-PFX-NBR = ZEROES                             68820000
688300        SET PS-SEASET-CHECK-NO TO TRUE                            68830000
688400     ELSE                                                         68840000
688500        IF ASC-PKGNG-CDE = 'I'                                    68850000
688600           IF PC240-DIVERT-PFX-NBR > ZEROES                       68860000
688700              MOVE DP015-RED     TO ASETNMC                       68870000
688800           ELSE                                                   68880000
688900              IF ASC-SET-NAME = 'T & T' OR                        68890000
689000                 ASC-SET-NAME = 'T&T'                             68900000
689100                 MOVE DP015-RED     TO ASETNMC                    68910000
689200              ELSE                                                68920000
689300                 MOVE DP015-BLUE    TO ASETNMC                    68930000
689400              END-IF                                              68940000
689500           END-IF                                                 68950000
689600        ELSE                                                      68960000
689700           IF ASC-PKGNG-CDE = 'M'                                 68970000
689710              PERFORM 4600-CHECK-TRECITM                          68971000
689720              IF PS-TRECITM-FOUND-YES                             68972000
689730                 PERFORM 4610-CHECK-PTL-PREPK-TRECITM             68973000
689740                 IF PS-PACK-TO-LIGHT-YES                          68974000
689750                    IF PC240-DIVERT-PFX-NBR > ZEROES              68975000
689760                       MOVE DP015-RED     TO ASETNMC              68976000
689770                    ELSE                                          68977000
689780                       IF ASC-SET-NAME = 'T & T' OR               68978000
689790                          ASC-SET-NAME = 'T&T'                    68979000
689800                          MOVE DP015-RED  TO ASETNMC              68980000
689801                       ELSE                                       68980100
689802                          MOVE DP015-BLUE TO ASETNMC              68980200
689803                       END-IF                                     68980300
689804                    END-IF                                        68980400
689805                 END-IF                                           68980500
689806              ELSE                                                68980600
689807                 PERFORM 4620-CHECK-PTL-PREPK-TPURITM             68980700
689808                 IF PS-PACK-TO-LIGHT-YES                          68980800
689809                    IF PC240-DIVERT-PFX-NBR > ZEROES              68980900
689810                       MOVE DP015-RED     TO ASETNMC              68981000
689811                    ELSE                                          68981100
689812                       IF ASC-SET-NAME = 'T & T' OR               68981200
689813                          ASC-SET-NAME = 'T&T'                    68981300
689814                          MOVE DP015-RED  TO ASETNMC              68981400
689815                       ELSE                                       68981500
689816                          MOVE DP015-BLUE TO ASETNMC              68981600
689817                       END-IF                                     68981700
689818                    END-IF                                        68981800
689819                 END-IF                                           68981900
689820              END-IF                                              68982000
689821           ELSE                                                   68982100
689822              IF ASC-PKGNG-CDE = 'B'                              68982200
689823                 PERFORM 4600-CHECK-TRECITM                       68982300
689824                 IF PS-TRECITM-FOUND-YES                          68982400
689825                    PERFORM 4630-CHECK-PTL-BULK-TRECITM           68982500
689826                    IF PS-PACK-TO-LIGHT-YES                       68982600
689827                       IF PC240-DIVERT-PFX-NBR > ZEROES           68982700
689828                          MOVE DP015-RED     TO ASETNMC           68982800
689829                       ELSE                                       68982900
689830                          IF ASC-SET-NAME = 'T & T' OR            68983000
689831                             ASC-SET-NAME = 'T&T'                 68983100
689832                             MOVE DP015-RED  TO ASETNMC           68983200
689833                          ELSE                                    68983300
689834                             MOVE DP015-BLUE TO ASETNMC           68983400
689835                          END-IF                                  68983500
689836                       END-IF                                     68983600
689837                    END-IF                                        68983700
689838                 ELSE                                             68983800
689839                    PERFORM 4640-CHECK-PTL-BULK-TPURITM           68983900
689840                    IF PS-PACK-TO-LIGHT-YES                       68984000
689841                       IF PC240-DIVERT-PFX-NBR > ZEROES           68984100
689842                          MOVE DP015-RED    TO ASETNMC            68984200
689843                       ELSE                                       68984300
689844                          IF ASC-SET-NAME = 'T & T' OR            68984400
689845                            ASC-SET-NAME = 'T&T'                  68984500
689846                            MOVE DP015-RED  TO ASETNMC            68984600
689847                          ELSE                                    68984700
689848                            MOVE DP015-BLUE TO ASETNMC            68984800
689849                          END-IF                                  68984900
689850                       END-IF                                     68985000
689860                    END-IF                                        68986000
689861                 END-IF                                           68986100
689862              END-IF                                              68986200
689863           END-IF                                                 68986300
689864        END-IF                                                    68986400
689865     END-IF.                                                      68986500
689866     MOVE ASC-SET-NAME      TO ASETNMO.                           68986600
689867                                                                  68986701
689868**GET OPER SET INFO                                               68986800
689869     MOVE ASC-OPER-SET      TO DK-OPER-SET.                       68986900
689870     MOVE DK-OPER-SET       TO AOPERO.                            68987000
689871     MOVE ASC-OPER-SET-NAME TO AOPRNMEO.                          68987100
689872                                                                  68987201
689880**GET CARTON INFO                                                 68988000
689890     MOVE ASC-EXP-CRTN-CNT  TO AEXPCTNO.                          68989000
689900     MOVE ASC-ACT-CRTN-CNT  TO AACTCTNO.                          68990000
690000     MOVE ASC-DMG-CRTN-CNT  TO ADMGCTNO.                          69000000
690100     PERFORM 3200-RESET-ATTRIBUTES.                               69010000
690200     IF ASC-WRKORD-STATUS = 'CM'                                  69020000
690300         MOVE DP015-BLUE             TO AOPERC                    69030000
690400         MOVE DP015-HL-OFF           TO AOPERH                    69040000
690500         MOVE DP015-PRO-NOR-OFF      TO AOPERA                    69050000
690600     END-IF.                                                      69060000
690610                                                                  69061001
690700**GET PIECES INFO                                                 69070000
690800     PERFORM 4570-GET-PIECES-INFO.                                69080000
690900     MOVE ASC-PCS-INVCD-N   TO APCINVCO.                          69090000
691000     MOVE ASC-PCS-VERFD-N   TO APCSVFDO.                          69100000
691010                                                                  69101001
691100**CHECK FOR MULTIPLE SHIPMENTS                                    69110000
691200     PERFORM 4575-GET-SHIPMNT-INFO.                               69120000
691300     IF ASC-MULT-SHIP                                             69130000
691400        MOVE DP015-REVERSE     TO AACTCTNH                        69140000
691500                                  ADMGCTNH                        69150000
691600        MOVE DP015-BLUE        TO AACTCTNC                        69160000
691700                                  ADMGCTNC                        69170000
691800        MOVE DP015-PRO-NOR-OFF TO AACTCTNA                        69180000
691900                                  ADMGCTNA                        69190000
692000        MOVE PC-TSYMSG-03024   TO DP020-MSG-NUMBER                69200000
692100        SET  DP020-MSG-WARNING TO TRUE                            69210000
692200     END-IF.                                                      69220000
692300                                                                  69230000
692400     IF  DP020-MSG-NUMBER-X = SPACE                               69240000
692500         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  69250000
692600*            --- MORE ITEMS TO DISPLAY ----                       69260000
692700             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            69270000
692800             SET DP020-MSG-INFORMATIONAL                          69280000
692900                                   TO TRUE                        69290000
693000         END-IF                                                   69300000
693100     END-IF.                                                      69310000
693200                                                                  69320000
693400         PERFORM 4401-CURSOR-POSITION.                            69340000
693500                                                                  69350001
693600 4401-CURSOR-POSITION.                                            69360000
693700     EVALUATE TRUE                                                69370000
693800         WHEN ASC-CSR-OPERSET                                     69380000
693900             MOVE -1                  TO AOPERL                   69390000
694000         WHEN ASC-CSR-CLERK                                       69400000
694100             MOVE -1                  TO ARCVCLKL                 69410000
694200         WHEN ASC-CSR-ACT-CTN                                     69420000
694300             MOVE -1                  TO AACTCTNL                 69430000
694400         WHEN ASC-CSR-DMG-CTN                                     69440000
694500             MOVE -1                  TO ADMGCTNL                 69450000
694600         WHEN ASC-CSR-START-ITEM                                  69460000
694700             MOVE -1                  TO ASTRTITL                 69470000
694800         WHEN ASC-CSR-SELECT-1                                    69480000
694900             MOVE -1                  TO MR-SELECTL(1)            69490000
695000             MOVE 'S'              TO ASC-TEMP-SELECTED-SW (1, 1) 69500000
695100                                      MR-SELECT (1)               69510000
695200         WHEN ASC-CSR-SELECT-2                                    69520000
695300             MOVE -1                  TO MR-SELECTL(2)            69530000
695400             MOVE 'S'              TO ASC-TEMP-SELECTED-SW (1, 2) 69540000
695500                                      MR-SELECT (2)               69550000
695600         WHEN ASC-CSR-SELECT-3                                    69560000
695700             MOVE -1                  TO MR-SELECTL(3)            69570000
695800             MOVE 'S'              TO ASC-TEMP-SELECTED-SW (1, 3) 69580000
695900                                      MR-SELECT (3)               69590000
696000         WHEN ASC-CSR-LOC-1                                       69600000
696100             MOVE -1                  TO MR-LOC-CODEL(1)          69610000
696200             MOVE 'S'              TO ASC-TEMP-SELECTED-SW (1, 1) 69620000
696300                                      MR-SELECT (1)               69630000
696400         WHEN ASC-CSR-LOC-2                                       69640000
696500             MOVE -1                  TO MR-LOC-CODEL(2)          69650000
696600             MOVE 'S'              TO ASC-TEMP-SELECTED-SW (1, 2) 69660000
696700                                      MR-SELECT (2)               69670000
696800         WHEN ASC-CSR-LOC-3                                       69680000
696900             MOVE -1                  TO MR-LOC-CODEL(3)          69690000
697000             MOVE 'S'              TO ASC-TEMP-SELECTED-SW (1, 3) 69700000
697100                                      MR-SELECT (3)               69710000
697200                                                                  69720000
697300         WHEN OTHER                                               69730000
697400             MOVE -1                  TO AOPERL                   69740000
697500     END-EVALUATE.                                                69750000
697600                                                                  69760000
697700*----------------------------------------------------------------*69770000
697800*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *69780000
697900*----------------------------------------------------------------*69790000
698000 4410-READ-TEMP-STORAGE.                                          69800000
698100                                                                  69810000
698200     EXEC CICS                                                    69820000
698300         READQ TS                                                 69830000
698400             QUEUE (ASC-LIST-QUEUE-NAME)                          69840000
698500             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               69850000
698600             ITEM  (PV-BLOCK-NUMBER)                              69860000
698700             RESP  (PV-CICS-RESP)                                 69870000
698800     END-EXEC.                                                    69880000
698900                                                                  69890000
699000     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       69900000
699100       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     69910000
699200         CONTINUE                                                 69920000
699300     ELSE                                                         69930000
699400         SET DP013-CICS-ABEND      TO TRUE                        69940000
699500         SET DP013-NO-ROLLBACK     TO TRUE                        69950000
699600         MOVE '4410-READ-TEMP-STORAGE'                            69960000
699700                                   TO DP013-PARAGRAPH             69970000
699800         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      69980000
699900                                   TO DP013-MESSAGE-TEXT(1)       69990000
700000         PERFORM DP013-0000-PROCESS-ABEND                         70000000
700100     END-IF.                                                      70010000
700200                                                                  70020000
700300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      70030000
700400                                   TO TRUE.                       70040000
700500                                                                  70050000
700600     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         70060000
700700         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               70070000
700800     END-IF.                                                      70080000
700900                                                                  70090000
701000*----------------------------------------------------------------*70100000
701100*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *70110000
701200*----------------------------------------------------------------*70120000
701300 4420-FORMAT-LIST-LINES.                                          70130000
701400                                                                  70140000
701500     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      70150000
701600         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                70160000
701700         MOVE DP015-ASK-DRK-OFF    TO MR-SELECTA   (PV-SUB)       70170000
701800                                      MR-LOC-CODEA (PV-SUB)       70180000
701900         MOVE DP015-HL-OFF       TO MR-SELECTH   (PV-SUB)         70190000
702000                                    MR-LOC-CODEH (PV-SUB)         70200000
702100         MOVE SPACE              TO MR-SELECT       (PV-SUB)      70210000
702300                                    MR-SEQ-X        (PV-SUB)      70230000
702400                                    MR-INSTRCT-DESC (PV-SUB)      70240000
702500                                    MR-LOC-CODE     (PV-SUB)      70250000
702600                                    MR-DATE-STRT    (PV-SUB)      70260000
702700                                    MR-TIME-STRT    (PV-SUB)      70270000
702800                                    MR-DATE-COMP    (PV-SUB)      70280000
702900                                    MR-TIME-COMP    (PV-SUB)      70290000
703000     ELSE                                                         70300000
703100         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      70310000
703200                                                   > SPACE        70320000
703400             MOVE SPACES                                          70340000
703500                                   TO MR-SELECT  (PV-SUB)         70350000
703600         ELSE                                                     70360000
703800             MOVE SPACES                                          70380000
703900                                   TO MR-SELECT  (PV-SUB)         70390000
704000         END-IF                                                   70400000
704100                                                                  70410000
705000                                                                  70500000
705100         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           70510000
705200             MOVE SPACE    TO MR-SELECT (PV-SUB)                  70520000
705500             MOVE ASC-SEQ (ASC-BLK-SUB ASC-ITEM-SUB)              70550000
705600                                            TO MR-SEQ (PV-SUB)    70560000
705700             MOVE ASC-INSTRCT-DESC (ASC-BLK-SUB ASC-ITEM-SUB)     70570000
705800                                   TO MR-INSTRCT-DESC (PV-SUB)    70580000
705900             MOVE ASC-LOC-CODE (ASC-BLK-SUB ASC-ITEM-SUB)         70590000
706000                                       TO MR-LOC-CODE (PV-SUB)    70600000
706100             MOVE ASC-DATE-STRT (ASC-BLK-SUB ASC-ITEM-SUB)        70610000
706200                                      TO MR-DATE-STRT (PV-SUB)    70620000
706300             MOVE ASC-TIME-STRT (ASC-BLK-SUB ASC-ITEM-SUB)        70630000
706400                                      TO MR-TIME-STRT (PV-SUB)    70640000
706500             MOVE ASC-DATE-COMP (ASC-BLK-SUB ASC-ITEM-SUB)        70650000
706600                                      TO MR-DATE-COMP (PV-SUB)    70660000
706700             MOVE ASC-TIME-COMP (ASC-BLK-SUB ASC-ITEM-SUB)        70670000
706800                                      TO MR-TIME-COMP (PV-SUB)    70680000
706900         END-IF                                                   70690000
707000     END-IF.                                                      70700000
707100                                                                  70710000
707200     SUBTRACT +1 FROM ASC-ITEM-SUB.                               70720000
707300                                                                  70730000
707400     IF  ASC-ITEM-SUB < + 1                                       70740000
707500         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                70750000
707600         MOVE +1                   TO ASC-BLK-SUB                 70760000
707700     END-IF.                                                      70770000
707800                                                                  70780000
707900*----------------------------------------------------------------*70790000
708000*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *70800000
708100*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *70810000
708200*  ISSUE A WARNING.                                              *70820000
708300*----------------------------------------------------------------*70830000
708400 4430-CHECK-FOR-BEGIN-AND-END.                                    70840000
708500                                                                  70850000
708600     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       70860000
708700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     70870000
708800*            -- NO END-OF-RANGE SPECFIED ---                      70880000
708900             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            70890000
709000             SET DP020-MSG-WARNING TO TRUE                        70900000
709100             PERFORM 4431-POSITION-AT-WARNING                     70910000
709200         END-IF                                                   70920000
709300     ELSE                                                         70930000
709400         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     70940000
709500*            -- NO BEGINNING-OF-RANGE SPECFIED ---                70950000
709600             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            70960000
709700             SET DP020-MSG-WARNING TO TRUE                        70970000
709800             PERFORM 4431-POSITION-AT-WARNING                     70980000
709900         END-IF                                                   70990000
710000     END-IF.                                                      71000000
710100                                                                  71010000
710200*----------------------------------------------------------------*71020000
710300*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *71030000
710400*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *71040000
710500*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *71050000
710600*  POSITION THE CURSOR THERE.                                    *71060000
710700*----------------------------------------------------------------*71070000
710800 4431-POSITION-AT-WARNING.                                        71080000
710900                                                                  71090000
711000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 71100000
711100                    - PV-TOP-ITEM + 1.                            71110000
711200                                                                  71120000
711300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      71130000
711400         CONTINUE                                                 71140000
711500     ELSE                                                         71150000
711600         SET DP030-SET-CURSOR-APPL-1                              71160000
711700                                   TO TRUE                        71170000
711800         MOVE -1                   TO MR-SELECTL (PV-SUB)         71180000
711900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         71190000
712000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         71200000
712100     END-IF.                                                      71210000
712200                                                                  71220000
712300     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   71230000
712400                    - PV-TOP-ITEM + 1.                            71240000
712500                                                                  71250000
712600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      71260000
712700         CONTINUE                                                 71270000
712800     ELSE                                                         71280000
712900         SET DP030-SET-CURSOR-APPL-1                              71290000
713000                                   TO TRUE                        71300000
713100         MOVE -1                   TO MR-SELECTL (PV-SUB)         71310000
713200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         71320000
713300         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         71330000
713400     END-IF.                                                      71340000
713500                                                                  71350000
713600*----------------------------------------------------------------*71360000
713700* GET VERIFIED INFORMATION                                        71370000
713800*----------------------------------------------------------------*71380000
713900 4500-GET-VERIFIED-INFO.                                          71390000
714000     MOVE ASC-PO-NBR              TO DK-PO-NBR.                   71400000
714100     MOVE ASC-RCVR-SEQ-NBR        TO DK-RCVR-NBR.                 71410000
714200                                                                  71420000
714300     EXEC SQL                                                     71430000
714400         SELECT  VERFYD_TMST                                      71440000
714500                ,VRFD_USR_ID                                      71450000
714600                ,STATUS_CDE                                       71460000
714700                ,PACK_BY_ST_IND                                   71470000
714800                ,CURR_OPER_UNT_ID                                 71480000
714900                ,CURR_FCLTY_ID                                    71490000
715000                ,RCVG_CLERK_INIT_ID                               71500000
715100                ,GOH_IND                                          71510000
715200                ,PRE_TKT_IND                                      71520000
715300                ,REC_TMST                                         71530000
715400                ,PKGNG_CDE                                        71540000
715500                ,OPER_UNT_ID                                      71550000
715600           INTO :RECEIV-VERFYD-TMST                               71560000
715700               ,:RECEIV-VRFD-USR-ID                               71570000
715800               ,:RECEIV-STATUS-CDE                                71580000
715900               ,:RECEIV-PACK-BY-ST-IND                            71590000
716000               ,:RECEIV-CURR-OPER-UNT-ID                          71600000
716100               ,:RECEIV-CURR-FCLTY-ID                             71610000
716200               ,:RECEIV-RCVG-CLERK-INIT-ID                        71620000
716300               ,:RECEIV-GOH-IND                                   71630000
716400               ,:RECEIV-PRE-TKT-IND                               71640000
716500               ,:RECEIV-REC-TMST                                  71650000
716600               ,:RECEIV-PKGNG-CDE                                 71660000
716700               ,:RECEIV-OPER-UNT-ID                               71670000
716800           FROM  TRECEIV                                          71680000
716900          WHERE ORD_NBR        = :DK-PO-NBR                       71690000
717000            AND REC_SEQ_NBR    = :DK-RCVR-NBR                     71700000
717100            AND VER_STATUS_CDE = 'A'                              71710000
717200      END-EXEC.                                                   71720000
717300                                                                  71730000
717400      EVALUATE TRUE                                               71740000
717500         WHEN SQLCODE = +0                                        71750000
717600             MOVE RECEIV-VRFD-USR-ID        TO ASC-VRFD-USER-ID   71760000
717700             MOVE RECEIV-PACK-BY-ST-IND     TO ASC-PACK-BY-ST-IND 71770000
717800             MOVE RECEIV-CURR-OPER-UNT-ID   TO ASC-OPER-UNT-ID    71780000
717900             MOVE RECEIV-CURR-FCLTY-ID      TO ASC-FCLTY-ID       71790000
718000             MOVE RECEIV-RCVG-CLERK-INIT-ID TO ASC-CLERK          71800000
718100             MOVE RECEIV-STATUS-CDE         TO ASC-STATUS         71810000
718200             MOVE RECEIV-GOH-IND            TO ASC-HANGER         71820000
718300             MOVE RECEIV-PRE-TKT-IND        TO ASC-PRETICKET      71830000
718400             MOVE RECEIV-PKGNG-CDE          TO ASC-PKGNG-CDE      71840000
718500             MOVE RECEIV-OPER-UNT-ID        TO ASC-WO-OPER-UNT-ID 71850000
718600             IF  RECEIV-REC-TMST  = '9999-09-09-09.09.09.999999'  71860000
718700                 SET  ASC-RECEIVER-NOT-ARRIVED  TO  TRUE          71870000
718800             ELSE                                                 71880000
718900                 SET ASC-RECEIVER-ARRIVED       TO TRUE           71890000
719000             END-IF                                               71900000
719100             IF  RECEIV-VERFYD-TMST = '9999-09-09-09.09.09.999999'71910000
719200                 MOVE SPACES         TO ASC-VRFD-DATE             71920000
719300                 MOVE SPACES         TO ASC-VRFD-TIME             71930000
719400             ELSE                                                 71940000
719500                 MOVE RECEIV-VERFYD-TMST   TO PV-DB2-DATE         71950000
719600                     STRING PV-DB2-MM      DELIMITED BY SIZE      71960000
719700                            '/'            DELIMITED BY SIZE      71970000
719800                            PV-DB2-DD      DELIMITED BY SIZE      71980000
719900                                      INTO ASC-VRFD-DATE          71990000
720000                     STRING PV-DB2-HH       DELIMITED BY SIZE     72000000
720100                            ':'             DELIMITED BY SIZE     72010000
720200                            PV-DB2-MN       DELIMITED BY SIZE     72020000
720300                                      INTO ASC-VRFD-TIME          72030000
720400             END-IF                                               72040000
720500         WHEN OTHER                                               72050000
720600             MOVE SPACES           TO ASC-VRFD-DATE               72060000
720700                                      ASC-VRFD-TIME               72070000
720800                                      ASC-VRFD-USER-ID            72080000
720900                                      ASC-PACK-BY-ST-IND          72090000
721000                                      ASC-CLERK                   72100000
721100                                      ASC-STATUS                  72110000
721200                                      ASC-HANGER                  72120000
721300                                      ASC-PRETICKET               72130000
721400                                      ASC-PKGNG-CDE               72140000
721500             MOVE ZEROES           TO ASC-OPER-UNT-ID             72150000
721600                                      ASC-FCLTY-ID                72160000
721700      END-EVALUATE.                                               72170000
721800                                                                  72180000
721900*----------------------------------------------------------------*72190000
722000* CHECK IF TROUBLE NOTIFICATION EXISTS FOR THE PO #/RECV SEQ #.  *72200000
722100*----------------------------------------------------------------*72210000
722200 4510-CHECK-IF-IN-TROUBLE.                                        72220000
722300     EXEC SQL                                                     72230000
722400         SELECT B.TRBL_LONG_DESC                                  72240000
722500          INTO :TRBRSN-TRBL-LONG-DESC                             72250000
722600          FROM  TTRBNTF A                                         72260000
722700               ,TTRBRSN B                                         72270000
722800          WHERE  A.PO_NBR           =  :ASC-PO-NBR                72280000
722900          AND    A.REC_SEQ_NBR      =  :ASC-RCVR-SEQ-NBR          72290000
723200          AND    B.TRBL_RSN_CDE     =  A.TRBL_RSN_CDE             72320000
723300          AND  ((A.RESOLVED_IND    IN  ('N','I','R')              72330000
723400          AND    B.NOTIF_IND        =  'T')                       72340000
723500           OR    B.TRBL_RSN_CDE     =  803)                       72350000
723600     END-EXEC.                                                    72360000
723700                                                                  72370000
723800     EVALUATE TRUE                                                72380000
723900         WHEN SQLCODE = +0                                        72390000
724000         WHEN SQLCODE = -811                                      72400000
724100             MOVE TRBRSN-TRBL-LONG-DESC TO ASC-TROUBLE            72410000
724200         WHEN OTHER                                               72420000
724300             MOVE SPACES                TO ASC-TROUBLE            72430000
724400     END-EVALUATE.                                                72440000
724500                                                                  72450000
724600*----------------------------------------------------------------*72460000
724700* CHECK FOR ANY SPECIAL INSTRUCTION RECIPIENTS                    72470000
724800*----------------------------------------------------------------*72480000
724900 4515-CHECK-4-SPCL-INSTRCT.                                       72490000
725000                                                                  72500000
725100     EXEC SQL                                                     72510000
725200         SELECT  B.INSTR_DESC                                     72520000
725300            INTO :INSTCD-INSTR-DESC                               72530000
725400            FROM  TPOINST A                                       72540000
725500                 ,TINSTCD B                                       72550000
725600         WHERE A.PO_NBR    = :ASC-PO-NBR                          72560000
725700           AND A.RECIP_CDE = 'DC'                                 72570000
725800           AND A.INSTR_NBR = B.INSTR_NBR                          72580000
725900     END-EXEC.                                                    72590000
726000                                                                  72600000
726100     EVALUATE TRUE                                                72610000
726200         WHEN SQLCODE = +0                                        72620000
726300         WHEN SQLCODE = -811                                      72630000
726400             SET PS-DC-RCPNTS      TO TRUE                        72640000
726500         WHEN OTHER                                               72650000
726600             SET PS-NO-DC-RCPNTS   TO TRUE                        72660000
726700     END-EVALUATE.                                                72670000
726800                                                                  72680000
728600                                                                  72860000
728700*----------------------------------------------------------------*72870000
728800* CHECK FOR PRESENTATION INFORMATION                              72880000
728900*----------------------------------------------------------------*72890000
729000 4520-CHECK-4-PRSNTATN.                                           72900000
729100     PERFORM 4521-OPEN-TRECITM-CSR.                               72910000
729200*LMM                                                              72920000
729300     INITIALIZE PV-PRICE-CHG-HOLD                                 72930000
729400     PERFORM 4522-FETCH-TRECITM-CSR UNTIL                         72940000
729500                 PS-EOF-TRECITM-CSR.                              72950000
729600     PERFORM 4524-CLOSE-TRECITM-CSR.                              72960000
729700     MOVE 'N' TO PS-TRECITM-CURSOR-SW.                            72970000
729800     MOVE SPACES TO  PS-PRESENTATION-SW                           72980000
730000                     PS-BOXID-SW                                  73000000
730100                     PS-PRICE-SW.                                 73010000
730200                                                                  73020000
730300*----------------------------------------------------------------*73030000
730400* OPEN THE TRECITM CURSOR                                        *73040000
730500*----------------------------------------------------------------*73050000
730600 4521-OPEN-TRECITM-CSR.                                           73060000
730700                                                                  73070000
730800     EXEC SQL                                                     73080000
730900          OPEN TRECITM-CSR                                        73090000
731000     END-EXEC.                                                    73100000
731100                                                                  73110000
731200     EVALUATE TRUE                                                73120000
731300         WHEN SQLCODE = +0                                        73130000
731400         WHEN SQLCODE = -904                                      73140000
731500         WHEN SQLCODE = -913                                      73150000
731600              CONTINUE                                            73160000
731700         WHEN SQLWARN0 NOT = SPACE                                73170000
731800         WHEN SQLCODE  NOT = +0                                   73180000
731900              MOVE '4521-OPEN-TRECITM-CSR' TO DP013-PARAGRAPH     73190000
732000              MOVE 'OPEN TRECITM CURSOR'                          73200000
732100                                   TO DP013-MESSAGE-TEXT (1)      73210000
732200              MOVE SQLCA       TO DP013-SQLCA                     73220000
732300              MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)        73230000
732400              SET DP013-DB2-ABEND  TO TRUE                        73240000
732500              PERFORM DP013-0000-PROCESS-ABEND                    73250000
732600     END-EVALUATE.                                                73260000
732700                                                                  73270000
732800*----------------------------------------------------------------*73280000
732900*    FETCH A TRECITM ROW                                         *73290000
733000*----------------------------------------------------------------*73300000
733100 4522-FETCH-TRECITM-CSR.                                          73310000
733200                                                                  73320000
733300     EXEC SQL                                                     73330000
733400          FETCH TRECITM-CSR                                       73340000
733500          INTO :RECITM-ITM-NBR                                    73350000
733600     END-EXEC.                                                    73360000
733700                                                                  73370000
733800     EVALUATE TRUE                                                73380000
733900         WHEN SQLCODE = +0                                        73390000
734000             PERFORM 4523-CALL-ITM-ACCESS-DOMAIN                  73400000
734100             IF PS-PRESENTATION-DONE AND                          73410000
734200*               PS-TICKET-DONE       AND                          73420000
734300                PS-BOXID-DONE        AND                          73430000
734400                PS-PRICE-DONE                                     73440000
734500                    SET PS-EOF-TRECITM-CSR TO TRUE                73450000
734600             END-IF                                               73460000
734700         WHEN SQLCODE = +100                                      73470000
734800              SET PS-EOF-TRECITM-CSR TO TRUE                      73480000
734900         WHEN SQLWARN0 NOT = SPACE                                73490000
735000         WHEN SQLCODE < +0                                        73500000
735100         WHEN SQLCODE > +0                                        73510000
735200              MOVE '4522-FETCH-TRECITM-CSR' TO DP013-PARAGRAPH    73520000
735300              MOVE 'FETCH TRECITM CURSOR'                         73530000
735400                                   TO DP013-MESSAGE-TEXT (1)      73540000
735500              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 73550000
735600              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               73560000
735700              MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID        73570000
735800              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      73580000
735900              MOVE SQLCA           TO DP013-SQLCA                 73590000
736000              MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (1)    73600000
736100              SET DP013-DB2-ABEND  TO TRUE                        73610000
736200              PERFORM DP013-0000-PROCESS-ABEND                    73620000
736300     END-EVALUATE.                                                73630000
736400                                                                  73640000
736500*----------------------------------------------------------------*73650000
736600* CALL LOGISTICS ITEM ACCESS MODULE (XLKUT001)                   *73660000
736700*----------------------------------------------------------------*73670000
736800 4523-CALL-ITM-ACCESS-DOMAIN.                                     73680000
736900      INITIALIZE XL001-ITEM-COMMAREA.                             73690000
737000      MOVE RECITM-ITM-NBR   TO XL001-KEY-ITM-NBR.                 73700000
737100                                                                  73710000
737200      SET  XL001-BY-ITEM                                          73720000
737300           XL001-SELECT-VND-STYL                                  73730000
737400           XL001-SELECT-SKU      TO TRUE.                         73740000
737500                                                                  73750000
737600      CALL XL001-VSM-PGM USING DFHEIBLK                           73760000
737700                               XL001-COMMAREA                     73770000
737800                               XL001-ITEM-COMMAREA.               73780000
737900                                                                  73790000
738000      EVALUATE TRUE                                               73800000
738100          WHEN XL001-SUCCESSFUL                                   73810000
738200              PERFORM 4525-CHECK-PRESENTATION                     73820000
738300              PERFORM 4526-CHECK-TICKET-BOXID                     73830000
738400*             PERFORM 4527-CHECK-PRICE                            73840000
738500              PERFORM 2108-GET-BEFORE-PRICE-CHG-DAYS              73850000
738600              PERFORM 2109-GET-AFTER-PRICE-CHG-DAYS               73860000
738700              PERFORM 4527-CALL-PRICE-CHANGE-MODULE               73870000
738800                                                                  73880000
738900          WHEN XL001-SQL-ERROR                                    73890000
739000              MOVE SPACES            TO ASC-PRESENTATION          73900000
739200                                        ASC-BOX-ID                73920000
739300                                        ASC-PRICE-CHG             73930000
739400              SET PS-EOF-TRECITM-CSR TO TRUE                      73940000
739500         END-EVALUATE.                                            73950000
739600                                                                  73960000
739700*----------------------------------------------------------------*73970000
739800* CLOSE THE TRECITM CURSOR                                       *73980000
739900*----------------------------------------------------------------*73990000
740000 4524-CLOSE-TRECITM-CSR.                                          74000000
740100                                                                  74010000
740200     EXEC SQL                                                     74020000
740300          CLOSE TRECITM-CSR                                       74030000
740400     END-EXEC.                                                    74040000
740500                                                                  74050000
740600     EVALUATE TRUE                                                74060000
740700         WHEN SQLCODE = +0                                        74070000
740800              CONTINUE                                            74080000
740900         WHEN SQLWARN0 NOT = SPACE                                74090000
741000         WHEN SQLCODE  NOT = +0                                   74100000
741100              MOVE '4524-CLOSE-TRECITM-CSR' TO DP013-PARAGRAPH    74110000
741200              MOVE 'CLOSE TRECITM CURSOR'                         74120000
741300                                   TO DP013-MESSAGE-TEXT (1)      74130000
741400              MOVE SQLCA           TO DP013-SQLCA                 74140000
741500              MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (1)    74150000
741600              SET DP013-DB2-ABEND  TO TRUE                        74160000
741700              PERFORM DP013-0000-PROCESS-ABEND                    74170000
741800     END-EVALUATE.                                                74180000
741900                                                                  74190000
742000*----------------------------------------------------------------*74200000
742100* CHECK PRESENTATION INFORMATION                                  74210000
742200*----------------------------------------------------------------*74220000
742300 4525-CHECK-PRESENTATION.                                         74230000
742400     IF PS-PRESENTATION-DONE                                      74240000
742500         CONTINUE                                                 74250000
742600     ELSE                                                         74260000
742700         IF XL001-HNG-FOLD-CDE = 'M'                              74270000
742800             MOVE XL001-HNG-FOLD-DESC TO ASC-PRESENTATION         74280000
742900             SET PS-PRESENTATION-DONE TO TRUE                     74290000
743000         ELSE                                                     74300000
743100             IF XL001-HNG-FOLD-CDE = 'H'                          74310000
743200                 IF ASC-PRESENTATION = SPACES                     74320000
743300                     MOVE XL001-HNG-FOLD-DESC TO ASC-PRESENTATION 74330000
743400                 ELSE                                             74340000
743500                     IF ASC-PRESENTATION NOT = XL001-HNG-FOLD-DESC74350000
743600                        MOVE 'MIXED         ' TO  ASC-PRESENTATION74360000
743700                        SET PS-PRESENTATION-DONE TO TRUE          74370000
743800                     ELSE                                         74380000
743900                        MOVE XL001-HNG-FOLD-DESC TO               74390000
744000                                                  ASC-PRESENTATION74400000
744100                     END-IF                                       74410000
744200                 END-IF                                           74420000
744300             ELSE                                                 74430000
744400                 IF XL001-HNG-FOLD-CDE = 'F'                      74440000
744500                     IF ASC-PRESENTATION = SPACES                 74450000
744600                         MOVE XL001-HNG-FOLD-DESC TO              74460000
744700                                                  ASC-PRESENTATION74470000
744800                     ELSE                                         74480000
744900                         IF ASC-PRESENTATION NOT =                74490000
745000                                               XL001-HNG-FOLD-DESC74500000
745100                             MOVE 'MIXED         ' TO             74510000
745200                                                  ASC-PRESENTATION74520000
745300                             SET PS-PRESENTATION-DONE TO TRUE     74530000
745400                         ELSE                                     74540000
745500                             MOVE XL001-HNG-FOLD-DESC TO          74550000
745600                                                  ASC-PRESENTATION74560000
745700                         END-IF                                   74570000
745800                     END-IF                                       74580000
745900                 ELSE                                             74590000
746000                     MOVE XL001-HNG-FOLD-DESC TO  ASC-PRESENTATION74600000
746100                 END-IF                                           74610000
746200             END-IF                                               74620000
746300         END-IF                                                   74630000
746400     END-IF.                                                      74640000
746500                                                                  74650000
746600*----------------------------------------------------------------*74660000
746700* CHECK TICKET AND BOX ID INFORMATION                             74670000
746800*----------------------------------------------------------------*74680000
746900 4526-CHECK-TICKET-BOXID.                                         74690000
748000     IF PS-BOXID-DONE                                             74800000
748100         CONTINUE                                                 74810000
748200     ELSE                                                         74820000
748300         IF XL001-STKR-NBR = ZEROES                               74830000
748400             MOVE SPACES         TO ASC-BOX-ID                    74840000
748500         ELSE                                                     74850000
748600             MOVE XL001-STKR-NBR TO ASC-BOX-ID-N                  74860000
748700             SET PS-BOXID-DONE   TO TRUE                          74870000
748800         END-IF                                                   74880000
748900     END-IF.                                                      74890000
749000                                                                  74900000
749100*----------------------------------------------------------------*74910000
749200* CALL PERM PRICE CHANGE MODULE XLKUT086 - GET PRICE INFO        *74920000
749300*----------------------------------------------------------------*74930000
749400 4527-CALL-PRICE-CHANGE-MODULE.                                   74940000
749500                                                                  74950000
749600     INITIALIZE XL086-PR-CHG-COMMAREA.                            74960000
749700     MOVE XL001-ITM-NBR TO XL086-KEY-ITM-NBR                      74970000
749800     MOVE XL001-SKU-NBR TO XL086-KEY-SKU-NBR                      74980000
749900     MOVE PV-PPCBEF-QTY TO XL086-KEY-BEFORE-DAYS                  74990000
750000     MOVE PV-PPCAFT-QTY TO XL086-KEY-AFTER-DAYS                   75000000
750100                                                                  75010000
750200     CALL XL086-PR-CHG-PGM USING DFHEIBLK                         75020000
750300                                 XL086-COMMAREA                   75030000
750400                                 XL086-PR-CHG-COMMAREA.           75040000
750500*LMM                                                              75050000
750600     EVALUATE TRUE                                                75060000
750700        WHEN XL086-SUCCESSFUL                                     75070000
750800           IF XL086-PPC-DOC-FOUND                                 75080000
750900              MOVE XL086-EFF-DTE(6:5)    TO ASC-PRICE-CHG         75090000
751000                                            PV-PRICE-CHG-HOLD     75100000
751100              SET PS-PRICE-DONE          TO TRUE                  75110000
751200           ELSE                                                   75120000
751300              MOVE SPACES                TO ASC-PRICE-CHG         75130000
751400           END-IF                                                 75140000
751500        WHEN XL086-SQL-ERROR                                      75150000
751600           MOVE SPACES                   TO ASC-PRICE-CHG         75160000
751700     END-EVALUATE.                                                75170000
751800/                                                                 75180000
751900                                                                  75190000
761700*----------------------------------------------------------------*76170000
761800* GET NEW STORE INFORMATION                                       76180000
761900*----------------------------------------------------------------*76190000
762000 4535-GET-NEWSTORE-INFO.                                          76200000
762100                                                                  76210000
762200     EXEC SQL                                                     76220000
762300          SELECT NEW_STR_PO_IND                                   76230000
762400           INTO :PURCHS-NEW-STR-PO-IND                            76240000
762500            FROM TPURCHS                                          76250000
762600           WHERE PO_NBR         = :ASC-PO-NBR                     76260000
762700             AND VER_STATUS_CDE = 'A'                             76270000
762800             AND PO_CATEG_CDE   = 'MR'                            76280000
762900       END-EXEC.                                                  76290000
763000                                                                  76300000
763100       EVALUATE TRUE                                              76310000
763200         WHEN SQLCODE = +0                                        76320000
763300             MOVE PURCHS-NEW-STR-PO-IND TO ASC-NEWSTORE           76330000
763400         WHEN OTHER                                               76340000
763500             MOVE SPACES                TO ASC-NEWSTORE           76350000
763600     END-EVALUATE.                                                76360000
763700                                                                  76370000
763800* CLT 06/28/2010 START                                            76380000
763900*----------------------------------------------------------------*76390000
764000* GET REPLENISHMENT INDICATOR                                     76400000
764100*----------------------------------------------------------------*76410000
764200 4537-REPLENISHMENT-IND.                                          76420000
764300                                                                  76430000
764400     EXEC SQL                                                     76440000
764500          SELECT WHSE_RPLNT_IND                                   76450000
764600           INTO :PURCHS-WHSE-RPLNT-IND                            76460000
764700            FROM TPURCHS                                          76470000
764800           WHERE PO_NBR         = :ASC-PO-NBR                     76480000
764900             AND VER_STATUS_CDE = 'A'                             76490000
765000       END-EXEC.                                                  76500000
765100                                                                  76510000
765200       EVALUATE TRUE                                              76520000
765300         WHEN SQLCODE = +0                                        76530000
765400             MOVE PURCHS-WHSE-RPLNT-IND TO ASC-REPLEN-IND         76540000
765500         WHEN OTHER                                               76550000
765600             MOVE SPACES                TO ASC-REPLEN-IND         76560000
765700     END-EVALUATE.                                                76570000
765800                                                                  76580000
765900* CLT 06/28/2010 END                                              76590000
766000*----------------------------------------------------------------*76600000
766100* GET RTV INFORMATION                                             76610000
766200*----------------------------------------------------------------*76620000
766201 4540-GET-RTV-INFO.                                               76620100
766202                                                                  76620200
766203     EXEC SQL                                                     76620300
766204         SELECT 1                                                 76620400
766205           INTO :PV-ONE                                           76620500
766206           FROM SYSIBM.SYSDUMMY1 X                                76620600
766207          WHERE  EXISTS (SELECT 1                                 76620700
766208               FROM TRECITM                                       76620800
766209              WHERE ORD_NBR     = :ASC-PO-NBR                     76620900
766210                AND REC_SEQ_NBR = :ASC-RCVR-SEQ-NBR               76621000
766220                AND RTV_IND     = 'Y'                             76622000
766230                AND X.IBMREQD > '')                               76623000
766240       END-EXEC.                                                  76624000
766250                                                                  76625000
766260       EVALUATE TRUE                                              76626000
766270         WHEN SQLCODE = +0                                        76627000
766280             MOVE 'Y'           TO ASC-RTV                        76628000
766290         WHEN OTHER                                               76629000
766300             MOVE SPACES        TO ASC-RTV                        76630000
766400     END-EVALUATE.                                                76640000
766500                                                                  76650000
766600*----------------------------------------------------------------*76660000
766700* GET SET NAME INFORMATION                                        76670000
766800*----------------------------------------------------------------*76680000
766900 4550-GET-SET-NAME-INFO.                                          76690000
767000                                                                  76700000
767100     INITIALIZE PC240-ITEM-COMMAREA.                              76710000
767200     MOVE ASC-PO-NBR             TO PC240-KEY-PO.                 76720000
767300     SET PC240-SET-NAME-ONLY     TO TRUE.                         76730000
767400                                                                  76740000
767500     CALL PC240-VSM-PGM USING DFHEIBLK                            76750000
767600                              PC240-COMMAREA                      76760000
767700                              PC240-ITEM-COMMAREA                 76770000
767800     EVALUATE TRUE                                                76780000
767900         WHEN PC240-SUCCESSFUL                                    76790000
768000             IF PC240-NO-SEASONAL-SET-FOUND                       76800000
768100                 MOVE SPACES              TO ASC-SET-NAME         76810000
768200             ELSE                                                 76820000
768300                MOVE PC240-SEASET-SHRT-NM TO ASC-SET-NAME         76830000
768400             END-IF                                               76840000
768500                                                                  76850000
768600         WHEN OTHER                                               76860000
768700             MOVE SPACES               TO ASC-SET-NAME            76870000
768800     END-EVALUATE.                                                76880000
768900                                                                  76890000
769000*----------------------------------------------------------------*76900000
769100* GET OPER SET INFORMATION                                        76910000
769200*--------------------------------------------------------------*  76920000
769300 4560-GET-OPER-SET-INFO.                                          76930000
769400                                                                  76940000
769500     EXEC SQL                                                     76950000
769600          SELECT B.OPER_SET_ID                                    76960000
769700                ,B.STAT_CDE                                       76970000
769800                ,B.WORK_ORD_SEQ_NBR                               76980000
769900                ,C.OPER_SET_DESC                                  76990000
770000            INTO :WRKORD-OPER-SET-ID                              77000000
770100                ,:WRKORD-STAT-CDE                                 77010000
770200                ,:WRKORD-WORK-ORD-SEQ-NBR                         77020000
770300                ,:OPRSET-OPER-SET-DESC                            77030000
770400            FROM TRECEIV A                                        77040000
770500                ,TWRKORD B                                        77050000
770600                ,TOPRSET C                                        77060000
770700             WHERE  A.ORD_NBR        = :ASC-PO-NBR                77070000
770800               AND  A.REC_SEQ_NBR    = :ASC-RCVR-SEQ-NBR          77080000
770900               AND  B.ORD_LNE_NBR    = 0                          77090000
771000               AND  A.VER_STATUS_CDE = 'A'                        77100000
771100               AND  B.VER_STATUS_CDE = 'A'                        77110000
771300               AND  A.FCLTY_ID       = B.FCLTY_ID                 77130000
771400               AND  A.ORD_NBR        = B.ORD_NBR                  77140000
771500               AND  A.REC_SEQ_NBR    = B.RCVR_SEQ_NBR             77150000
771600               AND  B.OPER_SET_ID    = C.OPER_SET_ID              77160000
771700               AND  C.OPER_UNT_ID    = A.CURR_OPER_UNT_ID         77170000
771800       END-EXEC.                                                  77180000
771900                                                                  77190000
772000       EVALUATE TRUE                                              77200000
772100         WHEN SQLCODE = +0                                        77210000
772200            MOVE WRKORD-OPER-SET-ID      TO ASC-OPER-SET          77220000
772300            MOVE WRKORD-STAT-CDE         TO ASC-WRKORD-STATUS     77230000
772400            MOVE WRKORD-WORK-ORD-SEQ-NBR TO ASC-WORK-ORD-SEQ-NBR  77240000
772500            MOVE OPRSET-OPER-SET-DESC    TO ASC-OPER-SET-NAME     77250000
772600         WHEN SQLCODE = -811                                      77260000
772700            PERFORM 4561-GET-OPER-SET-INFO                        77270000
772800         WHEN OTHER                                               77280000
772900             MOVE ZEROES               TO ASC-WORK-ORD-SEQ-NBR    77290000
773000                                          ASC-OPER-SET            77300000
773100             MOVE SPACES               TO ASC-OPER-SET-NAME       77310000
773200                                          ASC-WRKORD-STATUS       77320000
773300      END-EVALUATE.                                               77330000
773400                                                                  77340000
773500*----------------------------------------------------------------*77350000
773600* GET OPER SET INFORMATION                                        77360000
773700*--------------------------------------------------------------*  77370000
773800 4561-GET-OPER-SET-INFO.                                          77380000
773900                                                                  77390000
774000     EXEC SQL                                                     77400000
774100          SELECT B.OPER_SET_ID                                    77410000
774200                ,B.STAT_CDE                                       77420000
774300                ,B.WORK_ORD_SEQ_NBR                               77430000
774400                ,C.OPER_SET_DESC                                  77440000
774500            INTO :WRKORD-OPER-SET-ID                              77450000
774600                ,:WRKORD-STAT-CDE                                 77460000
774700                ,:WRKORD-WORK-ORD-SEQ-NBR                         77470000
774800                ,:OPRSET-OPER-SET-DESC                            77480000
774900            FROM TRECEIV A                                        77490000
775000                ,TWRKORD B                                        77500000
775100                ,TOPRSET C                                        77510000
775200             WHERE  A.OPER_UNT_ID    = :ASC-WO-OPER-UNT-ID        77520000
775300               AND  A.FCLTY_ID       = :ASC-FCLTY-ID              77530000
775400               AND  A.ORD_NBR        = :ASC-PO-NBR                77540000
775500               AND  A.REC_SEQ_NBR    = :ASC-RCVR-SEQ-NBR          77550000
775600               AND  B.ORD_LNE_NBR    = 0                          77560000
775700               AND  A.VER_STATUS_CDE = 'A'                        77570000
775800               AND  B.VER_STATUS_CDE = 'A'                        77580000
776000               AND  A.FCLTY_ID       = B.FCLTY_ID                 77600000
776100               AND  A.ORD_NBR        = B.ORD_NBR                  77610000
776200               AND  A.REC_SEQ_NBR    = B.RCVR_SEQ_NBR             77620000
776300               AND  B.OPER_SET_ID    = C.OPER_SET_ID              77630000
776400               AND  C.OPER_UNT_ID    = A.CURR_OPER_UNT_ID         77640000
776500       END-EXEC.                                                  77650000
776600                                                                  77660000
776700       EVALUATE TRUE                                              77670000
776800         WHEN SQLCODE = +0                                        77680000
776900            MOVE WRKORD-OPER-SET-ID      TO ASC-OPER-SET          77690000
777000            MOVE WRKORD-STAT-CDE         TO ASC-WRKORD-STATUS     77700000
777100            MOVE WRKORD-WORK-ORD-SEQ-NBR TO ASC-WORK-ORD-SEQ-NBR  77710000
777200            MOVE OPRSET-OPER-SET-DESC    TO ASC-OPER-SET-NAME     77720000
777300         WHEN SQLCODE = -811                                      77730000
777400            MOVE WRKORD-OPER-SET-ID      TO ASC-OPER-SET          77740000
777500            MOVE WRKORD-STAT-CDE         TO ASC-WRKORD-STATUS     77750000
777600            MOVE WRKORD-WORK-ORD-SEQ-NBR TO ASC-WORK-ORD-SEQ-NBR  77760000
777700            MOVE OPRSET-OPER-SET-DESC    TO ASC-OPER-SET-NAME     77770000
777800         WHEN OTHER                                               77780000
777900             MOVE ZEROES               TO ASC-WORK-ORD-SEQ-NBR    77790000
778000                                          ASC-OPER-SET            77800000
778100             MOVE SPACES               TO ASC-OPER-SET-NAME       77810000
778200                                          ASC-WRKORD-STATUS       77820000
778300      END-EVALUATE.                                               77830000
778400                                                                  77840000
778500*----------------------------------------------------------------*77850000
778600* GET CARTON INFORMATION                                          77860000
778700*----------------------------------------------------------------*77870000
778800 4565-GET-CARTON-INFO.                                            77880000
778900     MOVE ASC-TRIP-ID  TO  DK-TRIP-ID.                            77890000
779000                                                                  77900000
779100     EXEC SQL                                                     77910000
779200          SELECT SUM(DMG_CART_CNT)                                77920000
779300            INTO :SHPTPO-DMG-CART-CNT                             77930000
779400             FROM TSHPTPO                                         77940000
779500            WHERE PO_NBR      = :ASC-PO-NBR                       77950000
779600              AND REC_SEQ_NBR = :ASC-RCVR-SEQ-NBR                 77960000
779700       END-EXEC.                                                  77970000
779800                                                                  77980000
779900       EVALUATE TRUE                                              77990000
780000         WHEN SQLCODE = +0                                        78000000
780100             MOVE SHPTPO-DMG-CART-CNT    TO ASC-DMG-CRTN-CNT      78010000
780200         WHEN OTHER                                               78020000
780300             MOVE ZEROES                 TO ASC-DMG-CRTN-CNT      78030000
780400      END-EVALUATE.                                               78040000
780500                                                                  78050000
780600      EXEC SQL                                                    78060000
780700          SELECT  EXPTED_CART_CNT                                 78070000
780800                 ,ACTL_CART_CNT                                   78080000
780900          INTO  :RECEIV-EXPTED-CART-CNT                           78090000
781000               ,:RECEIV-ACTL-CART-CNT                             78100000
781100          FROM   TRECEIV                                          78110000
781200             WHERE ORD_NBR       = :ASC-PO-NBR                    78120000
781300               AND REC_SEQ_NBR   = :ASC-RCVR-SEQ-NBR              78130000
781400      END-EXEC.                                                   78140000
781500                                                                  78150000
781600       EVALUATE TRUE                                              78160000
781700         WHEN SQLCODE = +0                                        78170000
781800             MOVE RECEIV-EXPTED-CART-CNT TO ASC-EXP-CRTN-CNT      78180000
781900             MOVE RECEIV-ACTL-CART-CNT   TO ASC-ACT-CRTN-CNT      78190000
782000         WHEN OTHER                                               78200000
782100             MOVE ZEROES                 TO ASC-EXP-CRTN-CNT      78210000
782200                                            ASC-ACT-CRTN-CNT      78220000
782300      END-EVALUATE.                                               78230000
782400                                                                  78240000
782500      SET ASC-CRTN-CNT-CHG-NO  TO TRUE                            78250000
782600      PERFORM 4567-CHECK-IF-UCC128                                78260000
782700      IF ASC-UCC128-YES                                           78270000
782900          IF ASC-ACT-CRTN-CNT = 0                                 78290000
783000              PERFORM 4568-GET-SCN-COUNT                          78300000
783100              IF ASC-SCN-CRTN-CNT > ZERO                          78310000
783200                 MOVE DP015-YELLOW           TO AACTCTNC          78320000
783300                 MOVE DP015-UNP-NUM-BRT-MDT  TO AACTCTNA          78330000
783400                 MOVE ASC-SCN-CRTN-CNT TO ASC-ACT-CRTN-CNT        78340000
783500                 SET ASC-CRTN-CNT-CHG-YES TO TRUE                 78350000
783600              END-IF                                              78360000
783700          END-IF                                                  78370000
783800      END-IF.                                                     78380000
783900                                                                  78390000
784000*----------------------------------------------------------------*78400000
784100* CHECK TO SEE IF PO/RCVR IS UCC128                               78410000
784200*----------------------------------------------------------------*78420000
784300 4567-CHECK-IF-UCC128.                                            78430000
784400      EXEC SQL                                                    78440000
784500          SELECT B.PO_NBR                                         78450000
784600          INTO  :INPKSU-PO-NBR                                    78460000
784700          FROM   TINPKSU A                                        78470000
784800             ,   TPKSLIP B                                        78480000
784900         WHERE B.PO_NBR       = :ASC-PO-NBR                       78490000
785000           AND B.REC_SEQ_NBR  = :ASC-RCVR-SEQ-NBR                 78500000
785100           AND A.PO_NBR       = B.PO_NBR                          78510000
785200           AND A.SEQ_NBR      = B.SEQ_NBR                         78520000
785300         FETCH FIRST 1 ROW ONLY                                   78530000
785400      END-EXEC.                                                   78540000
785500                                                                  78550000
785600       EVALUATE TRUE                                              78560000
785700         WHEN SQLCODE = +0                                        78570000
785800             SET ASC-UCC128-YES   TO TRUE                         78580000
785900         WHEN OTHER                                               78590000
786000             CONTINUE                                             78600000
786100      END-EVALUATE.                                               78610000
786200                                                                  78620000
786300*----------------------------------------------------------------*78630000
786400* GET COUNT OF SCANNED CARTONS                                    78640000
786500*----------------------------------------------------------------*78650000
786600 4568-GET-SCN-COUNT.                                              78660000
786700     MOVE ZEROES TO PV-DB2-COUNT.                                 78670000
786800                                                                  78680000
786900     EXEC SQL                                                     78690000
787000         SELECT COUNT(*)                                          78700000
787100         INTO  :PV-DB2-COUNT                                      78710000
787200         FROM  TPKSLIP A,                                         78720000
787300               TINPKSU B,                                         78730000
787400               TSHUNLO C                                          78740000
787500         WHERE A.PO_NBR       = :ASC-PO-NBR                       78750000
787600           AND A.REC_SEQ_NBR  = :ASC-RCVR-SEQ-NBR                 78760000
787700           AND A.PO_NBR       = B.PO_NBR                          78770000
787800           AND A.SEQ_NBR      = B.SEQ_NBR                         78780000
787900           AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                    78790000
788000           AND C.TRIP_ID      = :ASC-TRIP-ID                      78800000
788100           AND A.VER_STAT_CDE = 'A'                               78810000
788200     END-EXEC.                                                    78820000
788300                                                                  78830000
788400     EVALUATE TRUE                                                78840000
788500         WHEN SQLCODE = +0                                        78850000
788600             MOVE PV-DB2-COUNT      TO ASC-SCN-CRTN-CNT           78860000
788700         WHEN OTHER                                               78870000
788800             MOVE ZEROES            TO ASC-SCN-CRTN-CNT           78880000
788900      END-EVALUATE.                                               78890000
789000                                                                  78900000
789100*----------------------------------------------------------------*78910000
789200* GET PIECES INFORMATION                                          78920000
789300*----------------------------------------------------------------*78930000
789400 4570-GET-PIECES-INFO.                                            78940000
789500     INITIALIZE PA-INVOICED-COUNT                                 78950000
789600                PA-AP-VERIFIED-COUNT.                             78960000
789700                                                                  78970000
789800     EXEC SQL                                                     78980000
789900         SELECT  SUM(EXPTED_ITM_QTY)                              78990000
790000                ,SUM(AP_VERIFY_ITM_QTY)                           79000000
790100           INTO :PA-INVOICED-COUNT    :PV-NULL-IND                79010000
790200               ,:PA-AP-VERIFIED-COUNT :PV-NULL-IND                79020000
790300           FROM  TRECDIS                                          79030000
790400         WHERE ORD_NBR        = :ASC-PO-NBR                       79040000
790500           AND REC_SEQ_NBR    = :ASC-RCVR-SEQ-NBR                 79050000
790700       END-EXEC.                                                  79070000
790800                                                                  79080000
790900       EVALUATE TRUE                                              79090000
791000         WHEN SQLCODE = +0                                        79100000
791100             MOVE PA-INVOICED-COUNT        TO ASC-PCS-INVCD-N     79110000
791200             IF  ASC-STATUS = 'VE'                                79120000
791300                 MOVE PA-AP-VERIFIED-COUNT TO ASC-PCS-VERFD-N     79130000
791400             ELSE                                                 79140000
791500                 MOVE ZEROES               TO ASC-PCS-VERFD-N     79150000
791600             END-IF                                               79160000
791700         WHEN OTHER                                               79170000
791800             MOVE ZEROES                 TO ASC-PCS-INVCD-N       79180000
791900                                            ASC-PCS-VERFD-N       79190000
792000      END-EVALUATE.                                               79200000
792100                                                                  79210000
792200*----------------------------------------------------------------*79220000
792300*    GET SHIPMENT INFO                                           *79230000
792400*----------------------------------------------------------------*79240000
792500 4575-GET-SHIPMNT-INFO.                                           79250000
792600                                                                  79260000
792700     MOVE 'N' TO ASC-MULT-SHIP-SW.                                79270000
792800                                                                  79280000
792900      EXEC SQL                                                    79290000
793000         SELECT  A.DMG_CART_CNT                                   79300000
793100                ,C.OWNER_SCAC_ID                                  79310000
793200                ,B.PRO_NBR                                        79320000
793300           INTO :SHPTPO-DMG-CART-CNT                              79330000
793400               ,:VHTRIP-OWNER-SCAC-ID                             79340000
793500               ,:SHIPMT-PRO-NBR                                   79350000
793600           FROM  TSHPTPO A                                        79360000
793700                ,TSHIPMT B                                        79370000
793800                ,TVHTRIP C                                        79380000
793900           WHERE A.PO_NBR        = :ASC-PO-NBR                    79390000
794000             AND A.REC_SEQ_NBR   = :ASC-RCVR-SEQ-NBR              79400000
794100             AND A.SHIPT_ID      = B.SHIPT_ID                     79410000
794200             AND B.TRIP_ID       = C.TRIP_ID                      79420000
794300      END-EXEC.                                                   79430000
794400                                                                  79440000
794500      EVALUATE TRUE                                               79450000
794600          WHEN SQLCODE = +0                                       79460000
794700          WHEN SQLCODE = +100                                     79470000
794800          WHEN SQLCODE = -904                                     79480000
794900          WHEN SQLCODE = -913                                     79490000
795000              CONTINUE                                            79500000
795100                                                                  79510000
795200          WHEN SQLCODE = -811                                     79520000
795300             SET ASC-MULT-SHIP TO TRUE                            79530000
795400      END-EVALUATE.                                               79540000
795500                                                                  79550000
795600*----------------------------------------------------------------*79560000
795700*    GET TICKET TYPE  (FROM PROGRAM RCKCS223)                    *79570000
795800*----------------------------------------------------------------*79580000
795900 4580-GET-TICKET-TYPE.                                            79590000
796000     PERFORM 4581-SELECT-ONE-TKT-FMT.                             79600000
796100     IF ASC-TKT-FMT-ID = SPACE                                    79610000
796200         SET PS-NO-CITM-FOUND TO TRUE                             79620000
796300     ELSE                                                         79630000
796400         IF ASC-TKT-DESC = 'MULTIPLE'                             79640000
796500             SET PS-CITM-FOUND TO TRUE                            79650000
796600         ELSE                                                     79660000
796700             PERFORM 4583-GET-TKT-DESC                            79670000
796800             SET PS-CITM-FOUND TO TRUE                            79680000
796900         END-IF                                                   79690000
797000     END-IF.                                                      79700000
797100     IF PS-NO-CITM-FOUND                                          79710000
797200         PERFORM 4582-SELECT-PRETIC-TKT-FMT                       79720000
797300           IF PS-PRETIC-FOUND                                     79730000
797400               CONTINUE                                           79740000
797500           ELSE                                                   79750000
797600               PERFORM 4584-GET-ITM-NBR                           79760000
797700               IF SQLCODE = ZERO                                  79770000
797800                   PERFORM 4585-GET-TKT-TYPE-DESC                 79780000
797900               END-IF                                             79790000
798000          END-IF                                                  79800000
798100     END-IF.                                                      79810000
798110                                                                  79811001
798120                                                                  79812001
798200 4581-SELECT-ONE-TKT-FMT.                                         79820000
798300     EXEC SQL                                                     79830000
798400         SELECT MIN(TKT_FMT_ID)                                   79840000
798500              , MAX(TKT_FMT_ID)                                   79850000
798600             INTO :DK-TKT-FMT-ID-MIN  :DN-TKT-FMT-ID-MIN          79860000
798700                 ,:DK-TKT-FMT-ID-MAX  :DN-TKT-FMT-ID-MAX          79870000
798800             FROM                                                 79880000
798900              TRECITM                                             79890000
799000              WHERE                                               79900000
799100                  ORD_NBR =     :ASC-PO-NBR                       79910000
799200              AND REC_SEQ_NBR = :ASC-RCVR-SEQ-NBR                 79920000
799300      END-EXEC                                                    79930000
799400         EVALUATE TRUE                                            79940000
799500             WHEN SQLCODE = +0                                    79950000
799600                  IF  DN-TKT-FMT-ID-MIN = -1                      79960000
799700                      MOVE SPACES        TO ASC-TKT-FMT-ID        79970000
799800                      SET PS-NO-CITM-FOUND TO TRUE                79980000
799900                  ELSE                                            79990000
800000                      IF DK-TKT-FMT-ID-MIN =                      80000000
800100                            DK-TKT-FMT-ID-MAX                     80010000
800200                            MOVE DK-TKT-FMT-ID-MIN                80020000
800300                                         TO DK-TKT-FMT-ID         80030000
800400                                            ASC-TKT-FMT-ID        80040000
800500                            MOVE SPACES  TO ASC-TKT-DESC          80050000
800600                            SET PS-CITM-FOUND TO TRUE             80060000
800700                        ELSE                                      80070000
800800                            MOVE 'MULTIPLE' TO ASC-TKT-DESC       80080000
800900                                               ASC-TKT-FMT-ID     80090000
801000                            SET PS-CITM-FOUND TO TRUE             80100000
801100                  END-IF                                          80110000
801200             END-IF                                               80120000
801300             WHEN SQLCODE = +100                                  80130000
801400                  MOVE SPACES            TO ASC-TKT-FMT-ID        80140000
801500                  SET PS-NO-CITM-FOUND TO TRUE                    80150000
801600             WHEN SQLCODE = -904                                  80160000
801700             WHEN SQLCODE = -913                                  80170000
801800                  CONTINUE                                        80180000
801900             WHEN SQLWARN0 NOT = SPACES                           80190000
802000             WHEN SQLCODE < +0                                    80200000
802100             WHEN SQLCODE > +0                                    80210000
802200                 MOVE '4581-SELECT-TICKET-TYPE'                   80220000
802300                                                TO DP013-PARAGRAPH80230000
802400                 MOVE 'UNSUCCESSFUL SELECT ON TRECITM TABLE'      80240000
802500                                  TO DP013-MESSAGE-TEXT (1)       80250000
802600                  MOVE ASC-PO-NBR      TO PV-ERROR-PO             80260000
802700                  MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ           80270000
802800                  MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID    80280000
802900                  MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)  80290000
803000                  MOVE SQLCA      TO DP013-SQLCA                  80300000
803100                  MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)     80310000
803200                  SET DP013-DB2-ABEND                             80320000
803300                      DP013-XCTL-DISPLAY-RESTART                  80330000
803400                                  TO TRUE                         80340000
803500                  PERFORM DP013-0000-PROCESS-ABEND                80350000
803600     END-EVALUATE.                                                80360000
803610                                                                  80361001
803620                                                                  80362001
803700 4582-SELECT-PRETIC-TKT-FMT.                                      80370000
803800     EXEC SQL                                                     80380000
803900         SELECT MIN(TKT_DESC)                                     80390000
804000              , MAX(TKT_DESC)                                     80400000
804100             INTO :DK-TKT-DESC-MIN  :DN-TKT-DESC                  80410000
804200                , :DK-TKT-DESC-MAX  :DN-TKT-DESC                  80420000
804300             FROM                                                 80430000
804400              TPTKREQ A                                           80440000
804500            , TPTKLNE B                                           80450000
804600              WHERE                                               80460000
804700                   A.PO_NBR      =     :ASC-PO-NBR                80470000
804800              AND  A.PO_REQ_NBR  =   B.PO_REQ_NBR                 80480000
804900      END-EXEC                                                    80490000
805000         EVALUATE TRUE                                            80500000
805100             WHEN SQLCODE = +0                                    80510000
805200                  IF  DN-TKT-DESC   = -1                          80520000
805300                      MOVE SPACES        TO ASC-TKT-DESC          80530000
805400                      SET PS-NO-PRETIC-FOUND TO TRUE              80540000
805500                  ELSE                                            80550000
805600                      IF DK-TKT-DESC-MIN =                        80560000
805700                                  DK-TKT-DESC-MAX                 80570000
805800                          MOVE DK-TKT-DESC-MIN                    80580000
805900                                         TO ASC-TKT-DESC          80590000
806000                          SET PS-PRETIC-FOUND TO TRUE             80600000
806100                      ELSE                                        80610000
806200                          MOVE 'MULTIPLE' TO ASC-TKT-DESC         80620000
806300                          SET PS-PRETIC-FOUND TO TRUE             80630000
806400                      END-IF                                      80640000
806500                  END-IF                                          80650000
806600                                                                  80660000
806700             WHEN SQLCODE = +100                                  80670000
806800                  MOVE SPACES            TO ASC-TKT-DESC          80680000
806900                  SET PS-NO-PRETIC-FOUND TO TRUE                  80690000
807000                                                                  80700000
807100             WHEN SQLCODE = -904                                  80710000
807200             WHEN SQLCODE = -913                                  80720000
807300                  CONTINUE                                        80730000
807400                                                                  80740000
807500             WHEN SQLWARN0 NOT = SPACES                           80750000
807600             WHEN SQLCODE < +0                                    80760000
807700             WHEN SQLCODE > +0                                    80770000
807800                  MOVE '4582-SELECT-PRETIC-TKT-FMT'               80780000
807900                                  TO DP013-PARAGRAPH              80790000
808000                  MOVE 'UNSUCCESSFUL SELECT ON TPTKREQ TABLE'     80800000
808100                                  TO DP013-MESSAGE-TEXT (1)       80810000
808200                  MOVE ASC-PO-NBR      TO PV-ERROR-PO             80820000
808300                  MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ           80830000
808400                  MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID    80840000
808500                  MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)  80850000
808600                  MOVE SQLCA      TO DP013-SQLCA                  80860000
808700                  MOVE 'TPTKREQ ' TO DP013-DB2-TABLE-NAME (1)     80870000
808800                  SET DP013-DB2-ABEND                             80880000
808900                      DP013-XCTL-DISPLAY-RESTART                  80890000
809000                                  TO TRUE                         80900000
809100                  PERFORM DP013-0000-PROCESS-ABEND                80910000
809200     END-EVALUATE.                                                80920000
809210                                                                  80921001
809220                                                                  80922001
809300 4583-GET-TKT-DESC.                                               80930000
809400      EXEC SQL                                                    80940000
809500          SELECT TKT_FMT_DESC                                     80950000
809600            INTO :TKTFMT-TKT-FMT-DESC                             80960000
809700            FROM TTKTFMT                                          80970000
809800           WHERE TKT_FMT_ID   = :DK-TKT-FMT-ID                    80980000
809900           FETCH FIRST 1 ROW ONLY                                 80990000
810000     END-EXEC                                                     81000000
810100                                                                  81010000
810200     EVALUATE TRUE                                                81020000
810300           WHEN SQLCODE = +0                                      81030000
810400             MOVE TKTFMT-TKT-FMT-DESC TO ASC-TKT-DESC             81040000
810500           WHEN SQLCODE = +100                                    81050000
810600                  MOVE SPACES    TO ASC-TKT-DESC                  81060000
810700             WHEN SQLCODE = -904                                  81070000
810800             WHEN SQLCODE = -911                                  81080000
810900             WHEN SQLCODE = -913                                  81090000
811000                  CONTINUE                                        81100000
811100             WHEN SQLWARN0 NOT = SPACES                           81110000
811200             WHEN SQLCODE  NOT = ZERO                             81120000
811300                  MOVE '4583-GET-TKT-DESC'                        81130000
811400                                 TO DP013-PARAGRAPH               81140000
811500                  MOVE 'UNSUCCESSFUL SELECT OF TTKTFMT'           81150000
811600                                 TO DP013-MESSAGE-TEXT (1)        81160000
811700                  MOVE ASC-PO-NBR      TO PV-ERROR-PO             81170000
811800                  MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ           81180000
811900                  MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID    81190000
812000                  MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)  81200000
812100                  MOVE SQLCA     TO DP013-SQLCA                   81210000
812200                  MOVE 'TTKTFMT' TO DP013-DB2-TABLE-NAME (1)      81220000
812300                  SET DP013-DB2-ABEND                             81230000
812400                      DP013-XCTL-DISPLAY-RESTART                  81240000
812500                                 TO TRUE                          81250000
812600                  PERFORM DP013-0000-PROCESS-ABEND                81260000
812700         END-EVALUATE.                                            81270000
812710                                                                  81271001
812800*----------------------------------------------------------------*81280000
812900*    GET THE ITEM NUMBER                                         *81290000
813000*----------------------------------------------------------------*81300000
813100 4584-GET-ITM-NBR.                                                81310000
813200*LMM                                                              81320000
813300     MOVE ASC-PO-NBR TO DK-PO-NBR                                 81330000
813400                                                                  81340000
813500     PERFORM                                                      81350000
813600         WITH TEST AFTER                                          81360000
813700         VARYING PV-RETRY-COUNTER                                 81370000
813800         FROM 1 BY 1                                              81380000
813900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               81390000
814000             OR (SQLCODE = +0)                                    81400000
814100             OR (SQLCODE = +100))                                 81410000
814200                                                                  81420000
814300         EXEC SQL                                                 81430000
814400              SELECT ITM_NBR                                      81440000
814500                INTO :PURITM-ITM-NBR                              81450000
814600                FROM TPURITM A                                    81460000
814700               WHERE A.PO_NBR         = :DK-PO-NBR                81470000
814800                 AND A.VER_STATUS_CDE = 'A'                       81480000
814900                 AND A.PO_LNE_NBR =                               81490000
815000                  (SELECT MIN(B.PO_LNE_NBR)                       81500000
815100                    FROM TPURITM B                                81510000
815200                   WHERE B.PO_NBR = A.PO_NBR                      81520000
815300                     AND B.VER_STATUS_CDE = 'A')                  81530000
815400         END-EXEC                                                 81540000
815500                                                                  81550000
815600         EVALUATE TRUE                                            81560000
815700             WHEN SQLCODE = +0                                    81570000
815800                  CONTINUE                                        81580000
815900             WHEN SQLCODE = +100                                  81590000
816000                 MOVE SPACES TO ASC-TKT-DESC                      81600000
816100             WHEN SQLCODE = -904                                  81610000
816200             WHEN SQLCODE = -913                                  81620000
816300                  CONTINUE                                        81630000
816400             WHEN SQLWARN0 NOT = SPACES                           81640000
816500             WHEN SQLCODE < +0                                    81650000
816600             WHEN SQLCODE > +0                                    81660000
816700                  MOVE '4584-GET-ITM-NBR'                         81670000
816800                                  TO DP013-PARAGRAPH              81680000
816900                  MOVE 'UNSUCCESSFUL SELECT ON TPURITM'           81690000
817000                                  TO DP013-MESSAGE-TEXT (1)       81700000
817100                  MOVE ASC-PO-NBR      TO PV-ERROR-PO             81710000
817200                  MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ           81720000
817300                  MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID    81730000
817400                  MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)  81740000
817500                  MOVE SQLCA      TO DP013-SQLCA                  81750000
817600                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)     81760000
817700                  SET DP013-DB2-ABEND                             81770000
817800                      DP013-XCTL-DISPLAY-RESTART TO TRUE          81780000
817900                  PERFORM DP013-0000-PROCESS-ABEND                81790000
818000         END-EVALUATE                                             81800000
818100     END-PERFORM.                                                 81810000
818200                                                                  81820000
818300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        81830000
818400             AND (SQLCODE = -904 OR -913)                         81840000
818500         MOVE '4584-GET-ITM-NBR ' TO DP013-PARAGRAPH              81850000
818600         MOVE 'MAX RETRIES EXCEEDED ON SELECT TPURITM'            81860000
818700                                  TO DP013-MESSAGE-TEXT (1)       81870000
818800         MOVE ASC-PO-NBR      TO PV-ERROR-PO                      81880000
818900         MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ                    81890000
819000         MOVE ASC-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID             81900000
819100         MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)           81910000
819200         MOVE SQLCA               TO DP013-SQLCA                  81920000
819300         MOVE 'TPURITM '          TO DP013-DB2-TABLE-NAME (1)     81930000
819400         SET DP013-DB2-ABEND                                      81940000
819500             DP013-XCTL-DISPLAY-RESTART TO TRUE                   81950000
819600         PERFORM DP013-0000-PROCESS-ABEND                         81960000
819700     END-IF.                                                      81970000
819800                                                                  81980000
819900 4585-GET-TKT-TYPE-DESC.                                          81990000
820000     INITIALIZE XL001-COMMAREA                                    82000000
820100     SET XL001-BY-ITEM                                            82010000
820200         XL001-SELECT-VND-STYL                                    82020000
820300                              TO TRUE                             82030000
820400     MOVE PURITM-ITM-NBR      TO XL001-KEY-ITM-NBR                82040000
820500     CALL XL001-VSM-PGM USING DFHEIBLK                            82050000
820600                              XL001-COMMAREA                      82060000
820700                              XL001-ITEM-COMMAREA                 82070000
820800     EVALUATE TRUE                                                82080000
820900         WHEN XL001-SUCCESSFUL                                    82090000
821000             MOVE XL001-TKT-TYP-DESC TO ASC-TKT-DESC              82100000
821100         WHEN XL001-SKU-SQLCODE NOT = ZERO                        82110000
821200             IF XL001-SKU-SQLCODE = +100                          82120000
821300                 MOVE SPACES       TO ASC-TKT-DESC                82130000
821400             ELSE                                                 82140000
821500                 SET PS-ERROR TO TRUE                             82150000
821600                 MOVE SPACES       TO ASC-TKT-DESC                82160000
821700                 MOVE 'XLV_SKU' TO DP013-DB2-TABLE-NAME (1)       82170000
821800                 MOVE XL001-SKU-SQLCODE TO SQLCODE                82180000
821900             END-IF                                               82190000
822000         WHEN XL001-VND-STYL-SQLCODE NOT = ZERO                   82200000
822100             IF XL001-VND-STYL-SQLCODE = +100                     82210000
822200                 MOVE SPACES       TO ASC-TKT-DESC                82220000
822300             ELSE                                                 82230000
822400                 SET PS-ERROR TO TRUE                             82240000
822500                 MOVE SPACES       TO ASC-TKT-DESC                82250000
822600                 MOVE 'XLV_VND_STYL' TO DP013-DB2-TABLE-NAME (1)  82260000
822700                 MOVE XL001-VND-STYL-SQLCODE TO SQLCODE           82270000
822800             END-IF                                               82280000
822900     END-EVALUATE.                                                82290000
823000                                                                  82300001
823300*----------------------------------------------------------------*82330000
823400* CHECK FOR TRECITM                                              *82340000
823500*----------------------------------------------------------------*82350000
823600 4600-CHECK-TRECITM.                                              82360000
823700                                                                  82370000
823800     EXEC SQL                                                     82380000
823810         SELECT ORD_NBR                                           82381000
823820         INTO   :DK-ORD-NBR                                       82382000
823830         FROM   TRECITM                                           82383000
823840         WHERE ORD_NBR        = :DK-PO-NBR                        82384000
823850           AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                   82385000
823860           AND VER_STATUS_CDE = 'A'                               82386000
823870           FETCH FIRST 1 ROW ONLY                                 82387000
823880     END-EXEC.                                                    82388000
823890       EVALUATE TRUE                                              82389000
823891         WHEN SQLCODE = +0                                        82389100
823892         WHEN SQLCODE = -811                                      82389200
823893             SET PS-TRECITM-FOUND-YES TO TRUE                     82389300
823894         WHEN SQLCODE = +100                                      82389400
823895             SET PS-TRECITM-FOUND-NO  TO TRUE                     82389500
823896       END-EVALUATE.                                              82389600
823897                                                                  82389700
823898*----------------------------------------------------------------*82389800
823899* CHECK FOR PACK-TO-LIGHT PREPACK ON TRECITM                     *82389900
823900*----------------------------------------------------------------*82390000
823901 4610-CHECK-PTL-PREPK-TRECITM.                                    82390100
823902                                                                  82390200
823903     EXEC SQL                                                     82390300
823904         SELECT ORD_NBR                                           82390400
823905         INTO   :DK-ORD-NBR                                       82390500
823906         FROM   TRECITM                                           82390600
823907         WHERE ORD_NBR        = :DK-PO-NBR                        82390700
823908           AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                   82390800
823909           AND VER_STATUS_CDE = 'A'                               82390900
823910           AND PREPK_DRV_LNE_CDE = 'A'                            82391000
823911           AND CASE_PACK_QTY     > 1                              82391100
823912           FETCH FIRST 1 ROW ONLY                                 82391200
823913     END-EXEC.                                                    82391300
823914       EVALUATE TRUE                                              82391400
823915         WHEN SQLCODE = +0                                        82391500
823916         WHEN SQLCODE = -811                                      82391600
823917             SET PS-PACK-TO-LIGHT-YES TO TRUE                     82391700
823918         WHEN SQLCODE = +100                                      82391800
823919             SET PS-PACK-TO-LIGHT-NO  TO TRUE                     82391900
823920       END-EVALUATE.                                              82392000
823921*----------------------------------------------------------------*82392100
823922* CHECK FOR PACK-TO-LIGHT PREPACK ON TPURITM                     *82392200
823923*----------------------------------------------------------------*82392300
823924 4620-CHECK-PTL-PREPK-TPURITM.                                    82392400
823925                                                                  82392500
823926     EXEC SQL                                                     82392600
823927         SELECT A.PO_NBR                                          82392700
823928         INTO   :DK-ORD-NBR                                       82392800
823929         FROM   TPURITM A                                         82392900
823930            ,   TPOPRPK B                                         82393000
823931         WHERE A.PO_NBR            = :DK-PO-NBR                   82393100
823932           AND A.VER_STATUS_CDE    = 'A'                          82393200
823933           AND B.PO_NBR            = A.PO_NBR                     82393300
823934           AND B.PO_PREPK_ID       = A.PO_PREPK_ID                82393400
823935           AND B.PREPK_TYP_CDE     = 'I'                          82393500
823936           FETCH FIRST 1 ROW ONLY                                 82393600
823937     END-EXEC.                                                    82393700
823938       EVALUATE TRUE                                              82393800
823939         WHEN SQLCODE = +0                                        82393900
823940         WHEN SQLCODE = -811                                      82394000
823941             SET PS-PACK-TO-LIGHT-YES TO TRUE                     82394100
823942         WHEN SQLCODE = +100                                      82394200
823943             SET PS-PACK-TO-LIGHT-NO  TO TRUE                     82394300
823944       END-EVALUATE.                                              82394400
823945                                                                  82394500
823946*----------------------------------------------------------------*82394600
823947* CHECK FOR PACK-TO-LIGHT BULK ON TRECITM                     *   82394700
823948*----------------------------------------------------------------*82394800
823949 4630-CHECK-PTL-BULK-TRECITM.                                     82394900
823950                                                                  82395000
823951     EXEC SQL                                                     82395100
823952         SELECT ORD_NBR                                           82395200
823953         INTO   :DK-ORD-NBR                                       82395300
823954         FROM   TRECITM                                           82395400
823955         WHERE ORD_NBR        = :DK-PO-NBR                        82395500
823956           AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                   82395600
823957           AND VER_STATUS_CDE = 'A'                               82395700
823958           AND CASE_PACK_QTY  > INNR_PACK_QTY                     82395800
823959           FETCH FIRST 1 ROW ONLY                                 82395900
823960     END-EXEC.                                                    82396000
823961       EVALUATE TRUE                                              82396100
823962         WHEN SQLCODE = +0                                        82396200
823963         WHEN SQLCODE = -811                                      82396300
823964             SET PS-PACK-TO-LIGHT-YES TO TRUE                     82396400
823965         WHEN SQLCODE = +100                                      82396500
823966             SET PS-PACK-TO-LIGHT-NO  TO TRUE                     82396600
823967       END-EVALUATE.                                              82396700
823968                                                                  82396800
823969*----------------------------------------------------------------*82396900
823970* CHECK FOR PACK-TO-LIGHT BULK ON TPURITM                     *   82397000
823971*----------------------------------------------------------------*82397100
823972 4640-CHECK-PTL-BULK-TPURITM.                                     82397200
823973                                                                  82397300
823974     EXEC SQL                                                     82397400
823975         SELECT PO_NBR                                            82397500
823976         INTO   :DK-ORD-NBR                                       82397600
823977         FROM  TPURITM                                            82397700
823978         WHERE PO_NBR         = :DK-PO-NBR                        82397800
823979           AND VER_STATUS_CDE = 'A'                               82397900
823980           AND OUTR_PK_QTY    > INNR_PK_QTY                       82398000
823981           FETCH FIRST 1 ROW ONLY                                 82398100
823982     END-EXEC.                                                    82398200
823983       EVALUATE TRUE                                              82398300
823984         WHEN SQLCODE = +0                                        82398400
823985         WHEN SQLCODE = -811                                      82398500
823986             SET PS-PACK-TO-LIGHT-YES TO TRUE                     82398600
823987         WHEN SQLCODE = +100                                      82398700
823988             SET PS-PACK-TO-LIGHT-NO  TO TRUE                     82398800
823989       END-EVALUATE.                                              82398900
823990                                                                  82399000
824000*----------------------------------------------------------------*82400000
824100* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *82410000
824200* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *82420000
824300* FOR THE SELECTED ITEMS QUEUE.                                  *82430000
824400*                                                                *82440000
824500* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *82450000
824600* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *82460000
824700* THE ARRAY IS FULL.                                             *82470000
824800*----------------------------------------------------------------*82480000
824900 5000-PREPARE-SEL-QUEUE.                                          82490000
825000                                                                  82500000
825100     INITIALIZE DCLTWKORIN.                                       82510000
825200                                                                  82520000
825300     IF ASC-LOC-CODE (1, 1) NOT = ASC-LOC-CODE-1-1                82530000
825400         MOVE ASC-LOC-CODE (1, 1)  TO WKORIN-LNE-LOC-CDE          82540000
825500         MOVE ASC-WO-INSTR-SEQ-NBR (1, 1) TO                      82550000
825600                                           WKORIN-WO-INSTR-SEQ-NBR82560000
825700         PERFORM 5300-UPDATE-LOC-CODE                             82570000
825800         MOVE ASC-LOC-CODE (1, 1)  TO ASC-LOC-CODE-1-1            82580000
825900                                      MR-LOC-CODE(1)              82590000
826000         MOVE 1                       TO PV-SUB2                  82600000
826100         SET ASC-TEMP-NO-SELECT (1, 1)                            82610000
826200             ASC-NO-SELECT (1, 1)     TO TRUE                     82620000
826300         MOVE SPACE                   TO MR-SELECT(1)             82630000
826400     END-IF.                                                      82640000
826500     IF ASC-LOC-CODE (1, 2) NOT = ASC-LOC-CODE-1-2                82650000
826600         MOVE ASC-LOC-CODE (1, 2)  TO WKORIN-LNE-LOC-CDE          82660000
826700         MOVE ASC-WO-INSTR-SEQ-NBR (1, 2) TO                      82670000
826800                                           WKORIN-WO-INSTR-SEQ-NBR82680000
826900         PERFORM 5300-UPDATE-LOC-CODE                             82690000
827000         MOVE ASC-LOC-CODE (1, 2)  TO ASC-LOC-CODE-1-2            82700000
827100                                      MR-LOC-CODE(2)              82710000
827200         MOVE SPACE                   TO MR-SELECT(2)             82720000
827300         SET ASC-TEMP-NO-SELECT (1, 2)                            82730000
827400             ASC-NO-SELECT (1, 2)     TO TRUE                     82740000
827500         MOVE 2                       TO PV-SUB2                  82750000
827600     END-IF.                                                      82760000
827700     IF ASC-LOC-CODE (1, 3) NOT = ASC-LOC-CODE-1-3                82770000
827800         MOVE ASC-LOC-CODE (1, 3)  TO WKORIN-LNE-LOC-CDE          82780000
827900         MOVE ASC-WO-INSTR-SEQ-NBR (1, 3) TO                      82790000
828000                                           WKORIN-WO-INSTR-SEQ-NBR82800000
828100         PERFORM 5300-UPDATE-LOC-CODE                             82810000
828200         MOVE ASC-LOC-CODE (1, 3)  TO ASC-LOC-CODE-1-3            82820000
828300                                      MR-LOC-CODE(3)              82830000
828400         MOVE SPACE                   TO MR-SELECT(3)             82840000
828500         SET ASC-TEMP-NO-SELECT (1, 3)                            82850000
828600             ASC-NO-SELECT (1, 3)     TO TRUE                     82860000
828700         MOVE 3                       TO PV-SUB2                  82870000
828800     END-IF.                                                      82880000
828900                                                                  82890000
829000     IF PV-SUB2 > ZERO                                            82900000
829100         EVALUATE PV-SUB2                                         82910000
829200         WHEN 1                                                   82920000
829300             SET ASC-CSR-SELECT-1     TO TRUE                     82930000
829400         WHEN 2                                                   82940000
829500             SET ASC-CSR-SELECT-2     TO TRUE                     82950000
829600         WHEN 3                                                   82960000
829700             SET ASC-CSR-SELECT-3     TO TRUE                     82970000
829800         END-EVALUATE                                             82980000
830000     ELSE                                                         83000000
830100         SET ASC-CSR-CLERK            TO TRUE                     83010000
830300     END-IF.                                                      83030000
830400                                                                  83040000
830500     IF DP020-INT-APPL-FORMAT-IND = PC-SUSPEND-LIST-FORMAT        83050000
830600         PERFORM 9100A-READ-SEL-QUEUE                             83060000
830700         SET RC817-UPD (ASC-SEL-SUB) TO TRUE                      83070000
830800         PERFORM 9200A-REWRITE-SEL-QUEUE                          83080000
830900     ELSE                                                         83090000
831000         PERFORM 9100-READ-SEL-QUEUE                              83100000
831100         SET RC816-UPD (ASC-SEL-SUB) TO TRUE                      83110000
831200         PERFORM 9200-REWRITE-SEL-QUEUE                           83120000
831300     END-IF.                                                      83130000
831400                                                                  83140000
831500                                                                  83150000
831600                                                                  83160000
831700*---------------------------------------------------------------  83170000
831800 5001-PREPARE-SEL-QUEUE.                                          83180000
831900                                                                  83190000
832000     MOVE +1          TO ASC-BLK-SUB.                             83200000
832100     PERFORM 8100-WRITE-TEMP-STORAGE.                             83210000
832200     ADD +1                        TO ASC-BLK-SUB.                83220000
832300     PERFORM 8100-WRITE-TEMP-STORAGE.                             83230000
832400                                                                  83240000
832600     MOVE ASC-WO-OPER-UNT-ID       TO PC000-OPERATING-UNIT-ID.    83260000
832700     MOVE ASC-FCLTY-ID             TO PC000-FACILITY-ID.          83270000
832800     MOVE ASC-SEL-QUEUE-NAME2      TO PC000-SEL-QUEUE-NAME.       83280000
832900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            83290000
833000                                TO PC000-NUMBER-OF-SELECTED-ITEMS.83300000
833100     PERFORM 6011-DELETE-SEL-QUEUE.                               83310000
833200                                                                  83320000
833300     SET ASC-UPDATE-TSQ            TO TRUE.                       83330000
833400                                                                  83340000
833500     SET PC017-IDX                 TO 1.                          83350000
833600     MOVE ZERO                     TO PC000-NUMBER-OF-TS-ITEMS.   83360000
833700     INITIALIZE PC017-SELECTED-ITEM-ARRAY.                        83370000
833800                                                                  83380000
833900     PERFORM 5201-FILL-SEL-QUEUE-RECORD                           83390000
834000             VARYING PV-ITEM                                      83400000
834100             FROM 1 BY 1                                          83410000
834200             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     83420000
834300                                                                  83430000
834400     IF  PC017-IDX > 1                                            83440000
834500         PERFORM 5206-WRITE-SEL-QUEUE                             83450000
834600         ADD +1                    TO PC000-NUMBER-OF-TS-ITEMS    83460000
834700     END-IF.                                                      83470000
834800                                                                  83480000
834900*----------------------------------------------------------------*83490000
835000* NEED TO PASS OPER UNT ID TO HOT COMPLETE PROGRAM PCKCS161.     *83500000
835100*----------------------------------------------------------------*83510000
835200 5001A-GET-WO-OPER-UNT-ID.                                        83520000
835300     EXEC SQL                                                     83530000
835400          SELECT OPER_UNT_ID                                      83540000
835500            INTO :WRKORD-OPER-UNT-ID                              83550000
835600            FROM TWRKORD                                          83560000
835700           WHERE ORD_NBR         = :ASC-PO-NBR                    83570000
835800             AND RCVR_SEQ_NBR    = :ASC-RCVR-SEQ-NBR              83580000
835900             AND ORD_LNE_NBR     = 0                              83590000
836000             AND VER_STATUS_CDE  = 'A'                            83600000
836100             AND FCLTY_ID        = :ASC-FCLTY-ID                  83610000
836200       END-EXEC.                                                  83620000
836300                                                                  83630000
836400       EVALUATE TRUE                                              83640000
836500         WHEN SQLCODE = +0                                        83650000
836600            MOVE WRKORD-OPER-UNT-ID    TO ASC-WO-OPER-UNT-ID      83660000
836700         WHEN OTHER                                               83670000
836800             MOVE ZEROES               TO ASC-WO-OPER-UNT-ID      83680000
836900      END-EVALUATE.                                               83690000
837000                                                                  83700000
837100*----------------------------------------------------------------*83710000
837200* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *83720000
837300* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *83730000
837400* FOR THE SELECTED ITEMS QUEUE.                                  *83740000
837500*                                                                *83750000
837600* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *83760000
837700* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *83770000
837800* THE ARRAY IS FULL.                                             *83780000
837900*----------------------------------------------------------------*83790000
838000 5002-PREPARE-SEL-QUEUE.                                          83800000
838100                                                                  83810000
838400     PERFORM 9100-READ-SEL-QUEUE.                                 83840000
838500                                                                  83850000
838600     SET RC816-UPD (ASC-SEL-SUB) TO TRUE.                         83860000
838700     IF ASC-STATUS NOT = ASC-STATUS-OLD                           83870000
838800         MOVE ASC-STATUS         TO RC816-PO-STATUS (ASC-SEL-SUB) 83880000
838900     END-IF.                                                      83890000
839000     IF ASC-ACTL-CRTNS-UPDATED                                    83900000
839100         MOVE ASC-ACT-CRTN-CNT   TO RC816-ACTL-CART-COUNT         83910000
839200                                                    (ASC-SEL-SUB) 83920000
839300     END-IF.                                                      83930000
839400                                                                  83940000
839500     PERFORM 9200-REWRITE-SEL-QUEUE.                              83950000
839600                                                                  83960000
839700 5003-PREPARE-SEL-QUEUE.                                          83970000
839800                                                                  83980000
840100     PERFORM 9100A-READ-SEL-QUEUE.                                84010000
840200                                                                  84020000
840300     SET RC817-UPD (ASC-SEL-SUB) TO TRUE.                         84030000
840400                                                                  84040000
840500     PERFORM 9200A-REWRITE-SEL-QUEUE.                             84050000
840600                                                                  84060000
840700*----------------------------------------------------------------*84070000
840800*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *84080000
840900*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *84090000
841000*----------------------------------------------------------------*84100000
841100 5100-WRITE-TEMP-STORAGE.                                         84110000
841200                                                                  84120000
841300     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     84130000
841400                                   TO PV-LIST-ITEM-NUMBER.        84140000
841500     COMPUTE PV-BLOCK-NUMBER =                                    84150000
841600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    84160000
841700                                                                  84170000
841800     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             84180000
841900     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             84190000
842000         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      84200000
842100             PERFORM 5105-REWRITE-ASC-LISTQ                       84210000
842200         END-IF                                                   84220000
842300     ELSE                                                         84230000
842400         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       84240000
842500         ASC-HIGHEST-BLOCK-WRITTEN + 1                            84250000
842600         PERFORM 5110-WRITE-ASC-LISTQ                             84260000
842700         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   84270000
842800     END-IF.                                                      84280000
842900                                                                  84290000
843000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             84300000
843100                                                                  84310000
843200*----------------------------------------------------------------*84320000
843300*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *84330000
843400*  SPECIFIC COMMAREA.                                            *84340000
843500*----------------------------------------------------------------*84350000
843600 5105-REWRITE-ASC-LISTQ.                                          84360000
843700                                                                  84370000
843800     EXEC CICS                                                    84380000
843900         WRITEQ TS                                                84390000
844000             QUEUE (ASC-LIST-QUEUE-NAME)                          84400000
844100             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               84410000
844200             ITEM  (PV-BLOCK-NUMBER)                              84420000
844300             REWRITE                                              84430000
844400             RESP  (PV-CICS-RESP)                                 84440000
844500     END-EXEC.                                                    84450000
844600                                                                  84460000
844700     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           84470000
844800         CONTINUE                                                 84480000
844900     ELSE                                                         84490000
845000         SET DP013-CICS-ABEND      TO TRUE                        84500000
845100         SET DP013-NO-ROLLBACK     TO TRUE                        84510000
845200         MOVE '5105-REWRITE-ASC-LISTQ'                            84520000
845300                                   TO DP013-PARAGRAPH             84530000
845400         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     84540000
845500                                   TO DP013-MESSAGE-TEXT(1)       84550000
845510                                                                  84551004
845520         MOVE ASC-PO-NBR           TO PV-ERROR-PO                 84552004
845530         MOVE ASC-RCVR-SEQ-NBR     TO PV-ERROR-SEQ                84553004
845540         MOVE ASC-OPER-UNT-ID      TO PV-ERROR-OPER-UNT-ID        84554004
845550         MOVE PV-ERROR-MSG         TO DP013-MESSAGE-TEXT (2)      84555004
845560                                                                  84556004
845600         PERFORM DP013-0000-PROCESS-ABEND                         84560000
845700     END-IF.                                                      84570000
845800                                                                  84580000
845900*----------------------------------------------------------------*84590000
846000*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *84600000
846100*  SPECIFIC COMMAREA.                                            *84610000
846200*----------------------------------------------------------------*84620000
846300 5110-WRITE-ASC-LISTQ.                                            84630000
846400                                                                  84640000
846500     EXEC CICS                                                    84650000
846600         WRITEQ TS                                                84660000
846700             QUEUE (ASC-LIST-QUEUE-NAME)                          84670000
846800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               84680000
846900             ITEM  (PV-BLOCK-NUMBER)                              84690000
847000             RESP  (PV-CICS-RESP)                                 84700000
847100     END-EXEC.                                                    84710000
847200                                                                  84720000
847300     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      84730000
847400         SET DP013-CICS-ABEND      TO TRUE                        84740000
847500         SET DP013-NO-ROLLBACK     TO TRUE                        84750000
847600         MOVE '5110-WRITE-ASC-LISTQ'                              84760000
847700                                   TO DP013-PARAGRAPH             84770000
847800         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           84780000
847900                                   TO DP013-MESSAGE-TEXT(1)       84790000
847910                                                                  84791005
847920         MOVE ASC-PO-NBR           TO PV-ERROR-PO                 84792005
847930         MOVE ASC-RCVR-SEQ-NBR     TO PV-ERROR-SEQ                84793005
847940         MOVE ASC-OPER-UNT-ID      TO PV-ERROR-OPER-UNT-ID        84794005
847950         MOVE PV-ERROR-MSG         TO DP013-MESSAGE-TEXT (2)      84795005
847960                                                                  84796005
848000         PERFORM DP013-0000-PROCESS-ABEND                         84800000
848100     END-IF.                                                      84810000
848200                                                                  84820000
848300*----------------------------------------------------------------*84830000
848400* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *84840000
848500* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *84850000
848600*----------------------------------------------------------------*84860000
848700 5201-FILL-SEL-QUEUE-RECORD.                                      84870000
848800                                                                  84880000
848900     PERFORM 8112-READ-LIST-QUEUE.                                84890000
849000                                                                  84900000
849100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       84910000
849200         PERFORM                                                  84920000
849300         VARYING LQW-IDX                                          84930000
849400         FROM 1 BY 1                                              84940000
849500         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            84950000
849600           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          84960000
849700                                                                  84970000
849800             IF  PS-CHECK-NEXT                                    84980000
849900                 SET PS-DONT-CHECK-NEXT TO TRUE                   84990000
850000                 EVALUATE TRUE                                    85000000
850100                 WHEN DP020-FK-LOCAL-FUNC-09(DP020-SRC-AID)       85010000
850200                     IF  LQW-DATE-STRT (LQW-IDX) > SPACES         85020000
850300                         SET PS-ERROR  TO TRUE                    85030000
850400                         MOVE PC-TSYMSG-00922  TO DP020-MSG-NUMBER85040000
850500                     END-IF                                       85050000
850600                 END-EVALUATE                                     85060000
850700             END-IF                                               85070000
850800                                                                  85080000
850900             IF  LQW-SELECT (LQW-IDX)                             85090000
851000                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              85100000
851100                                         TO PC017-ITEM (PC017-IDX)85110000
851200                 MOVE LQW-SEQ (LQW-IDX)  TO PC017-SCREEN-SEQ-NBR  85120000
851300                                                       (PC017-IDX)85130000
851400                 MOVE LQW-WO-INSTR-SEQ-NBR (LQW-IDX)              85140000
851500                             TO PC017-WO-INSTR-SEQ-NBR (PC017-IDX)85150000
851600                                PV-WORK-ORD-INSTR-SELECTED        85160000
851700                 MOVE LQW-DATE-STRT (LQW-IDX)                     85170000
851800                                    TO PV-WORK-ORD-INSTR-MAX-START85180000
851900                 MOVE ASC-EXP-CRTN-CNT                            85190000
852000                                TO PC017-EXPECTED-CTNS (PC017-IDX)85200000
852100                 MOVE ASC-ACT-CRTN-CNT                            85210000
852200                                 TO PC017-ACTUAL-CTNS  (PC017-IDX)85220000
852300                 MOVE SPACE        TO PC017-ACTION-SW (PC017-IDX) 85230000
852400                 SET PC017-IDX UP BY 1                            85240000
852500                 IF  PC017-IDX > PC017-MAX-ITEMS                  85250000
852600                     PERFORM 5206-WRITE-SEL-QUEUE                 85260000
852700                     ADD +1        TO PC000-NUMBER-OF-TS-ITEMS    85270000
852800                     INITIALIZE PC017-SELECTED-ITEM-ARRAY         85280000
852900                     SET PC017-IDX TO 1                           85290000
853000                 END-IF                                           85300000
853100                 SET PS-CHECK-NEXT TO TRUE                        85310000
853200             END-IF                                               85320000
853300         END-PERFORM                                              85330000
853400     END-IF.                                                      85340000
853500                                                                  85350000
853600*----------------------------------------------------------------*85360000
853700*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *85370000
853800*----------------------------------------------------------------*85380000
853900 5206-WRITE-SEL-QUEUE.                                            85390000
854000                                                                  85400000
854100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            85410000
854200                                   TO PC017-SELECTED-ITEMS.       85420000
854300     MOVE ASC-PO-NBR               TO PC017-PO-NBR.               85430000
854400     MOVE ASC-RCVR-SEQ-NBR         TO PC017-RCVR-SEQ-NBR.         85440000
854500     MOVE ASC-WORK-ORD-SEQ-NBR     TO PC017-WORK-ORD-SEQ-NBR.     85450000
854600     MOVE ZERO                     TO PC017-LINE-NBR.             85460000
854700                                                                  85470000
854800     EXEC CICS                                                    85480000
854900          WRITEQ TS                                               85490000
855000              QUEUE (ASC-SEL-QUEUE-NAME2)                         85500000
855100              FROM  (PC017-TS-SEL-REC)                            85510000
855200              ITEM  (PV-SEL-QUEUE-ITEM)                           85520000
855300              RESP  (PV-CICS-RESP)                                85530000
855400     END-EXEC.                                                    85540000
855500                                                                  85550000
855600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          85560000
855700         CONTINUE                                                 85570000
855800     ELSE                                                         85580000
855900         SET DP013-CICS-ABEND      TO TRUE                        85590000
856000         SET DP013-NO-ROLLBACK     TO TRUE                        85600000
856100         MOVE '5206-WRITE-SEL-QUEUE'                              85610000
856200                                   TO DP013-PARAGRAPH             85620000
856300         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          85630000
856400                                   TO DP013-MESSAGE-TEXT(1)       85640000
856401                                                                  85640105
856410         MOVE ASC-PO-NBR           TO PV-ERROR-PO                 85641005
856420         MOVE ASC-RCVR-SEQ-NBR     TO PV-ERROR-SEQ                85642005
856430         MOVE ASC-OPER-UNT-ID      TO PV-ERROR-OPER-UNT-ID        85643005
856440         MOVE PV-ERROR-MSG         TO DP013-MESSAGE-TEXT (2)      85644005
856450                                                                  85645005
856500         PERFORM DP013-0000-PROCESS-ABEND                         85650000
856600     END-IF.                                                      85660000
856700                                                                  85670000
856800*----------------------------------------------------------------*85680000
856900*  UPDATE THE WORK ORDER'S LOC CODE                               85690000
857000*----------------------------------------------------------------*85700000
857100 5300-UPDATE-LOC-CODE.                                            85710000
857200     EXEC SQL                                                     85720000
857300        UPDATE TWKORIN                                            85730000
857400          SET LNE_LOC_CDE       =  :WKORIN-LNE-LOC-CDE            85740000
857500        WHERE ORD_NBR           =  :ASC-PO-NBR                    85750000
857600          AND RCVR_SEQ_NBR      =  :ASC-RCVR-SEQ-NBR              85760000
857700          AND ORD_LNE_NBR       =  0                              85770000
857900          AND WORK_ORD_SEQ_NBR  =  :ASC-WORK-ORD-SEQ-NBR          85790000
858000          AND WO_INSTR_SEQ_NBR  =  :WKORIN-WO-INSTR-SEQ-NBR       85800000
858100          AND VER_STATUS_CDE    =  'A'                            85810000
858200     END-EXEC.                                                    85820000
858300                                                                  85830000
858400     EVALUATE TRUE                                                85840000
858500         WHEN SQLCODE = ZERO                                      85850000
858600         WHEN SQLCODE = +100                                      85860000
858700         WHEN SQLCODE = -904                                      85870000
858800         WHEN SQLCODE = -913                                      85880000
858900             MOVE PC-TSYMSG-02252        TO DP020-MSG-NUMBER      85890000
859000             SET DP020-MSG-INFORMATIONAL TO TRUE                  85900000
859100         WHEN SQLWARN0 NOT = SPACES                               85910000
859200         WHEN SQLCODE NOT EQUAL ZERO                              85920000
859300              MOVE '5300-UPDATE-LOC-CODE'  TO DP013-PARAGRAPH     85930000
859400              MOVE 'UPDATE VIA TRUE UPDATE'                       85940000
859500                                   TO DP013-MESSAGE-TEXT (1)      85950000
859600              MOVE ASC-PO-NBR      TO PV-ERROR-PO                 85960000
859700              MOVE ASC-RCVR-SEQ-NBR TO PV-ERROR-SEQ               85970000
859800              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      85980000
859900              MOVE SQLCA           TO DP013-SQLCA                 85990000
860000              MOVE 'TWKORIN'       TO DP013-DB2-TABLE-NAME (1)    86000000
860100              SET DP013-DB2-ABEND                                 86010000
860200                  DP013-XCTL-DISPLAY-RESTART  TO TRUE             86020000
860300              PERFORM DP013-0000-PROCESS-ABEND                    86030000
860400     END-EVALUATE.                                                86040000
860500                                                                  86050000
860600*----------------------------------------------------------------*86060000
860700*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *86070000
860800*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *86080000
860900*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *86090000
861000*  THE USER.                                                     *86100000
861100*----------------------------------------------------------------*86110000
861200 6000-REFRESH-PANEL-FROM-TEMP.                                    86120000
861300                                                                  86130000
861400     IF  ASC-UPDATE-TSQ                                           86140000
861500         SET ASC-NO-TSQ-UPDATE     TO TRUE                        86150000
861600         MOVE ZERO                 TO PV-SAVE-ITEM                86160000
861700                                      PV-SEL-QUEUE-ITEM           86170000
861800         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        86180000
861900                                   TO PV-HOLD-SELECTED-ITEMS      86190000
862000         PERFORM 6100-UPDATE-TSQ                                  86200000
862100             UNTIL PV-ITEMS-PROCESSED >                           86210000
862200                                     ASC-NUMBER-OF-SELECTED-ITEMS 86220000
862400         INITIALIZE ASC-BLOCK-ENTRIES (1)                         86240000
862500                    ASC-BLOCK-ENTRIES (2)                         86250000
862600     END-IF.                                                      86260000
862700                                                                  86270000
862800*----------------------------------------------------------------*86280000
862900*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *86290000
863000*----------------------------------------------------------------*86300000
863100 6010-DELETE-SEL-QUEUE.                                           86310000
863200                                                                  86320000
863300     EXEC CICS                                                    86330000
863400         DELETEQ TS                                               86340000
863500             QUEUE (ASC-SEL-QUEUE-NAME)                           86350000
863600             RESP  (PV-CICS-RESP)                                 86360000
863700     END-EXEC.                                                    86370000
863800                                                                  86380000
863900     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      86390000
864000         (PV-CICS-RESP = DFHRESP(QIDERR)))                        86400000
864100         CONTINUE                                                 86410000
864200     ELSE                                                         86420000
864300         SET DP013-CICS-ABEND      TO TRUE                        86430000
864400         SET DP013-NO-ROLLBACK     TO TRUE                        86440000
864500         MOVE '6010-DELETE-SEL-QUEUE'                             86450000
864600                                   TO DP013-PARAGRAPH             86460000
864700         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         86470000
864800                                   TO DP013-MESSAGE-TEXT (1)      86480000
864900         PERFORM DP013-0000-PROCESS-ABEND                         86490000
865000     END-IF.                                                      86500000
865100                                                                  86510000
865200*----------------------------------------------------------------*86520000
865300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *86530000
865400*----------------------------------------------------------------*86540000
865500 6011-DELETE-SEL-QUEUE.                                           86550000
865600                                                                  86560000
865700     EXEC CICS                                                    86570000
865800         DELETEQ TS                                               86580000
865900             QUEUE (ASC-SEL-QUEUE-NAME2)                          86590000
866000             RESP  (PV-CICS-RESP)                                 86600000
866100     END-EXEC.                                                    86610000
866200                                                                  86620000
866300     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      86630000
866400        (PV-CICS-RESP = DFHRESP(QIDERR)))                         86640000
866500         CONTINUE                                                 86650000
866600     ELSE                                                         86660000
866700         SET DP013-CICS-ABEND TO TRUE                             86670000
866800         SET DP013-NO-ROLLBACK TO TRUE                            86680000
866900         MOVE '6011-DELETE-SEL-QUEUE'                             86690000
867000                        TO DP013-PARAGRAPH                        86700000
867100         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         86710000
867200                        TO DP013-MESSAGE-TEXT (1)                 86720000
867300         PERFORM DP013-0000-PROCESS-ABEND                         86730000
867400     END-IF.                                                      86740000
867500                                                                  86750000
867600*----------------------------------------------------------------*86760000
867700*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *86770000
867800*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *86780000
867900*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *86790000
868000*    THE TEMP QUEUE.                                             *86800000
868100*----------------------------------------------------------------*86810000
868200 6100-UPDATE-TSQ.                                                 86820000
868300                                                                  86830000
868400     ADD 1                         TO PV-SEL-QUEUE-ITEM.          86840000
868500     PERFORM 6105-READ-SEL-QUEUE.                                 86850000
868600                                                                  86860000
868700     PERFORM                                                      86870000
868800         VARYING RC816-IDX                                        86880000
868900         FROM 1 BY 1                                              86890000
869000         UNTIL ((PV-ITEMS-PROCESSED >                             86900000
869100                              PV-HOLD-SELECTED-ITEMS)             86910000
869200         OR (RC816-IDX GREATER THAN RC816-MAX-ITEMS))             86920000
869300         IF  RC816-ACTION-SW (RC816-IDX) > SPACE                  86930000
869400             PERFORM 6110-PROCESS-ITEMS                           86940000
869500         END-IF                                                   86950000
869600         ADD +1                    TO PV-ITEMS-PROCESSED          86960000
869700     END-PERFORM.                                                 86970000
869800                                                                  86980000
869900     PERFORM 6111-WRITE-LIST-QUEUE.                               86990000
870000                                                                  87000000
870100*----------------------------------------------------------------*87010000
870200*    READ THE LIST QUEUE RECORD.                                 *87020000
870300*----------------------------------------------------------------*87030000
870400 6105-READ-SEL-QUEUE.                                             87040000
870500                                                                  87050000
870600     EXEC CICS                                                    87060000
870700          READQ TS                                                87070000
870800              QUEUE (ASC-SEL-QUEUE-NAME)                          87080000
870900              INTO  (RC816-SELECT-RECORD)                         87090000
871000              ITEM  (PV-SEL-QUEUE-ITEM)                           87100000
871100              RESP  (PV-CICS-RESP)                                87110000
871200     END-EXEC.                                                    87120000
871300                                                                  87130000
871400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          87140000
871500         CONTINUE                                                 87150000
871600     ELSE                                                         87160000
871700         SET DP013-CICS-ABEND      TO TRUE                        87170000
871800         SET DP013-NO-ROLLBACK     TO TRUE                        87180000
871900         MOVE '6105-READ-SEL-QUEUE'                               87190000
872000                                   TO DP013-PARAGRAPH             87200000
872100         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           87210000
872200                                   TO DP013-MESSAGE-TEXT(1)       87220000
872201                                                                  87220104
872210         MOVE ASC-PO-NBR           TO PV-ERROR-PO                 87221004
872220         MOVE ASC-RCVR-SEQ-NBR     TO PV-ERROR-SEQ                87222004
872230         MOVE ASC-OPER-UNT-ID      TO PV-ERROR-OPER-UNT-ID        87223004
872240         MOVE PV-ERROR-MSG         TO DP013-MESSAGE-TEXT (2)      87224004
872250                                                                  87225004
872300         PERFORM DP013-0000-PROCESS-ABEND                         87230000
872400     END-IF.                                                      87240000
872500                                                                  87250000
872600*----------------------------------------------------------------*87260000
872700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*87270000
872800*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*87280000
872900*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *87290000
873000*----------------------------------------------------------------*87300000
873100 6110-PROCESS-ITEMS.                                              87310000
873200                                                                  87320000
873300     COMPUTE PV-ITEM = 1 + ((RC816-ITEM (RC816-IDX) - 1)          87330000
873400                     / PC-ITEMS-PER-PANEL).                       87340000
873500                                                                  87350000
873600     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           87360000
873700         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          87370000
873800             PERFORM 6111-WRITE-LIST-QUEUE                        87380000
873900         END-IF                                                   87390000
874000         MOVE PV-ITEM              TO PV-SAVE-ITEM                87400000
874100                                                                  87410000
874200         PERFORM 6112-READ-LIST-QUEUE                             87420000
874300         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               87430000
874400             CONTINUE                                             87440000
874500         END-IF                                                   87450000
874600     END-IF.                                                      87460000
874700                                                                  87470000
874800     COMPUTE PV-SUB = (RC816-ITEM (RC816-IDX)                     87480000
874900                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              87490000
875000                                                                  87500000
875100     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       87510000
875200     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        87520000
875300                                     (PV-SUB).                    87530000
875400     EVALUATE TRUE                                                87540000
875500         WHEN RC816-INQ (RC816-IDX)                               87550000
875600              MOVE PC-INQ          TO LQW-ACTION (PV-SUB)         87560000
875700                                                                  87570000
875800         WHEN RC816-UPD (RC816-IDX)                               87580000
875900              MOVE PC-UPD          TO LQW-ACTION (PV-SUB)         87590000
876000                                                                  87600000
876100         WHEN RC816-DEL (RC816-IDX)                               87610000
876200              MOVE PC-DEL          TO LQW-ACTION (PV-SUB)         87620000
876300                                                                  87630000
876400         WHEN RC816-ERR (RC816-IDX)                               87640000
876500              MOVE PC-ERR          TO LQW-ACTION (PV-SUB)         87650000
876600     END-EVALUATE.                                                87660000
876700                                                                  87670000
876800     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                87680000
876900                                                                  87690000
877000*----------------------------------------------------------------*87700000
877100*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *87710000
877200*----------------------------------------------------------------*87720000
877300 6111-WRITE-LIST-QUEUE.                                           87730000
877400                                                                  87740000
877500     EXEC CICS                                                    87750000
877600         WRITEQ TS                                                87760000
877700             QUEUE (ASC-LIST-QUEUE-NAME)                          87770000
877800             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     87780000
877900             ITEM  (PV-SAVE-ITEM)                                 87790000
878000             REWRITE                                              87800000
878100             RESP  (PV-CICS-RESP)                                 87810000
878200     END-EXEC.                                                    87820000
878300                                                                  87830000
878400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          87840000
878500     OR  PV-CICS-RESP = DFHRESP (ITEMERR)                         87850000
878600         CONTINUE                                                 87860000
878700     ELSE                                                         87870000
878800         SET DP013-CICS-ABEND      TO TRUE                        87880000
878900         SET DP013-NO-ROLLBACK     TO TRUE                        87890000
879000         MOVE '6111-WRITE-LIST-QUEUE'                             87900000
879100                                   TO DP013-PARAGRAPH             87910000
879200         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  87920000
879300                                   TO DP013-MESSAGE-TEXT(1)       87930000
879400         PERFORM DP013-0000-PROCESS-ABEND                         87940000
879500     END-IF.                                                      87950000
879600                                                                  87960000
879700*----------------------------------------------------------------*87970000
879800*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*87980000
879900*----------------------------------------------------------------*87990000
880000 6112-READ-LIST-QUEUE.                                            88000000
880100                                                                  88010000
880200     EXEC CICS                                                    88020000
880300         READQ TS                                                 88030000
880400             QUEUE (ASC-LIST-QUEUE-NAME)                          88040000
880500             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     88050000
880600             ITEM  (PV-ITEM)                                      88060000
880700             RESP  (PV-CICS-RESP)                                 88070000
880800     END-EXEC.                                                    88080000
880900                                                                  88090000
881000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          88100000
881100         CONTINUE                                                 88110000
881200     ELSE                                                         88120000
881300         SET DP013-CICS-ABEND      TO TRUE                        88130000
881400         SET DP013-NO-ROLLBACK     TO TRUE                        88140000
881500         MOVE '6112-READ-LIST-QUEUE'                              88150000
881600                                   TO DP013-PARAGRAPH             88160000
881700         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    88170000
881800                                   TO DP013-MESSAGE-TEXT(1)       88180000
881900         PERFORM DP013-0000-PROCESS-ABEND                         88190000
882000     END-IF.                                                      88200000
882100                                                                  88210000
882200 7000-TRIP-STATUS.                                                88220000
882300     MOVE SPACES                      TO TRIPST-TRIP-STATUS-CDE   88230000
882400     EXEC SQL                                                     88240000
882500         SELECT                                                   88250000
882600             B.TRIP_STATUS_CDE                                    88260000
882700         INTO                                                     88270000
882800             :TRIPST-TRIP-STATUS-CDE                              88280000
882900         FROM   TVHTRIP A                                         88290000
883000             ,  TTRIPST B                                         88300000
883100         WHERE A.OWNER_SCAC_ID   = :ASC-SCAC                      88310000
883200             AND A.VEH_NBR       = :ASC-TRLR-NBR                  88320000
883300             AND B.OPER_UNT_ID   = :ASC-OPER-UNT-ID               88330000
883400             AND A.TRIP_ID       = :ASC-TRIP-ID                   88340000
883500             AND B.FCLTY_ID      = 1                              88350000
883600             AND A.TRIP_ID       = B.TRIP_ID                      88360000
883700             AND TIMESTAMP(B.STATUS_DTE, B.STATUS_TME)    =       88370000
883800                 (SELECT MAX                                      88380000
883900                      (TIMESTAMP(D.STATUS_DTE, D.STATUS_TME))     88390000
884000                         FROM TTRIPST D                           88400000
884100                        WHERE D.TRIP_ID       = A.TRIP_ID)        88410000
884200     END-EXEC.                                                    88420000
884300                                                                  88430000
884400                                                                  88440000
884500     EVALUATE TRUE                                                88450000
884600         WHEN SQLCODE = ZERO                                      88460000
884700         WHEN SQLCODE = +100                                      88470000
884800             CONTINUE                                             88480000
884900         WHEN SQLCODE = -904                                      88490000
885000         WHEN SQLCODE = -911                                      88500000
885100         WHEN SQLCODE = -913                                      88510000
885200              PERFORM 9900A-SOFT-ABORT                            88520000
885300         WHEN SQLWARN0 NOT = SPACE                                88530000
885400         WHEN SQLCODE NOT = ZERO                                  88540000
885500              MOVE '7000-TRIP-STATUS'   TO DP013-PARAGRAPH        88550000
885600              MOVE 'FIND TRIP CURRENT STATUS '                    88560000
885700                                   TO DP013-MESSAGE-TEXT (1)      88570000
885800              MOVE ASC-PO-NBR      TO PV-TRLR-ERROR-PO            88580000
885900              MOVE ASC-RCVR-SEQ-NBR TO PV-TRLR-ERROR-SEQ          88590000
886000              MOVE ASC-OPER-UNT-ID TO PV-TRLR-ERROR-OPER-UNT-ID   88600000
886100              MOVE ASC-SCAC        TO PV-TRLR-ERROR-SCAC          88610000
886200              MOVE ASC-TRLR-NBR    TO PV-TRLR-ERROR-TRLR          88620000
886300              MOVE PV-TRLR-ERROR-MSG  TO DP013-MESSAGE-TEXT (2)   88630000
886400              MOVE SQLCA           TO DP013-SQLCA                 88640000
886500              MOVE 'TVHTRIP '      TO DP013-DB2-TABLE-NAME (1)    88650000
886600              MOVE 'TTRIPST '      TO DP013-DB2-TABLE-NAME (2)    88660000
886700              SET DP013-DB2-ABEND  TO TRUE                        88670000
886800              PERFORM DP013-0000-PROCESS-ABEND                    88680000
886900     END-EVALUATE.                                                88690000
887000                                                                  88700001
887001*---------------------------------------------------------------* 88700101
887010* THIS WILL CALL PCKCS756 WHICH WILL UPDATE THE TABLES FOR UNITS  88701001
887020* WORKED OR VERIFIED                                              88702001
887030*---------------------------------------------------------------* 88703001
887100 8000-UPDATE-UNITS-WRKD.                                          88710000
887400                                                                  88740000
887800     MOVE ASC-PO-NBR                  TO PC238-PO-NBR             88780000
887900     MOVE ASC-RCVR-SEQ-NBR            TO PC238-RCVR-SEQ-NBR       88790000
888000     MOVE ASC-OPER-UNT-ID             TO PC238-WRKD-OPER-UNT-ID   88800000
888100     MOVE ZEROES                      TO PC238-PO-LNE-NBR         88810000
888200     MOVE 'W'                         TO PC238-TRANS-TYPE-CDE     88820000
888300                                                                  88830000
888400     EXEC SQL                                                     88840000
888500         SET :PV-CURRENT-TMST =  CURRENT TIMESTAMP                88850000
888600     END-EXEC.                                                    88860000
888700     MOVE PV-CURRENT-TMST             TO PC238-WRKD-TMST.         88870000
888800                                                                  88880000
888900     MOVE 'A'                         TO PC238-VERIFY-TYPE-CDE.   88890000
889000                                                                  88900000
889100     MOVE LENGTH OF PC238-COMM-AREA   TO PV-COMMAREA-LENGTH.      88910000
889200                                                                  88920000
889300     EXEC CICS                                                    88930000
889400         LINK                                                     88940000
889500             PROGRAM   (PC-UNTS-WRKD-PGRM-NAME)                   88950000
889600             COMMAREA  (PC238-COMM-AREA)                          88960000
889700             LENGTH    (PV-COMMAREA-LENGTH)                       88970000
889800             RESP      (PV-CICS-RESPONSE)                         88980000
889900     END-EXEC.                                                    88990000
890000                                                                  89000000
890100     EVALUATE TRUE                                                89010000
890200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 89020000
890300              EVALUATE TRUE                                       89030000
890400                  WHEN PC238-MOD-SUCCESSFUL                       89040000
890500                       CONTINUE                                   89050000
890600                 WHEN PC238-MOD-UNSUCCESSFUL                      89060000
890700                     SET PS-ERROR     TO TRUE                     89070000
890800                     PERFORM 8000A-MOD-UNSUCCESSFUL               89080000
890900             END-EVALUATE                                         89090000
891000                                                                  89100000
891100         WHEN OTHER                                               89110000
891200             STRING ' PCKCS780 - '      DELIMITED BY SIZE         89120000
891300                    ' 8000-UPDATE-UNITS-WRKD '                    89130000
891400                                        DELIMITED BY SIZE         89140000
891500                    ' KEY INFO - '      DELIMITED BY SIZE         89150000
891600                    PV-DISPLAY-PO       DELIMITED BY SIZE         89160000
891700                    ' - '               DELIMITED BY SIZE         89170000
891800                    PV-DISPLAY-RCVR     DELIMITED BY SIZE         89180000
891900                    ' - '               DELIMITED BY SIZE         89190000
892000                    PV-DISPLAY-LINE     DELIMITED BY SIZE         89200000
892100                                  INTO PV-CICS-MSG-AREA           89210000
892200             PERFORM 9900-WRITE-CICS-LOG                          89220000
892300             PERFORM 9900A-SOFT-ABORT                             89230000
892400     END-EVALUATE.                                                89240000
892500                                                                  89250001
892600 8000A-MOD-UNSUCCESSFUL.                                          89260000
892700                                                                  89270000
892800     MOVE PC238-PO-NBR              TO PV-DISPLAY-PO.             89280000
892900     MOVE PC238-RCVR-SEQ-NBR        TO PV-DISPLAY-RCVR.           89290000
893000     MOVE PC238-PO-LNE-NBR          TO PV-DISPLAY-LINE.           89300000
893100     MOVE PC238-WRKD-OPER-UNT-ID    TO PV-DISPLAY-OPER.           89310000
893200     MOVE PC238-BAD-SQL-CDE         TO PV-DISPLAY-SQL-CODE        89320000
893300                                       SQLCODE.                   89330000
893400                                                                  89340000
893500     IF  PC238-MOD-BAD-TMST                                       89350000
893600         STRING ' PCKCS780 - '      DELIMITED BY SIZE             89360000
893700                ' 6000-UPDATE-UNITS-WRKD '                        89370000
893800                                    DELIMITED BY SIZE             89380000
893900                ' BAD TIMESTAMP '   DELIMITED BY SIZE             89390000
894000                PC238-WRKD-TMST     DELIMITED BY SIZE             89400000
894100                             INTO PV-CICS-MSG-AREA                89410000
894200         PERFORM 9900-WRITE-CICS-LOG                              89420000
894300         STRING ' PCKCS780 - '      DELIMITED BY SIZE             89430000
894400                ' 6000-UPDATE-UNITS-WRKD '                        89440000
894500                                    DELIMITED BY SIZE             89450000
894600                ' KEY INFO - '      DELIMITED BY SIZE             89460000
894700                PV-DISPLAY-PO       DELIMITED BY SIZE             89470000
894800                ' - '               DELIMITED BY SIZE             89480000
894900                PV-DISPLAY-RCVR     DELIMITED BY SIZE             89490000
895000                ' - '               DELIMITED BY SIZE             89500000
895100                PV-DISPLAY-LINE     DELIMITED BY SIZE             89510000
895200                             INTO PV-CICS-MSG-AREA                89520000
895300         PERFORM 9900-WRITE-CICS-LOG                              89530000
895400         PERFORM 9900A-SOFT-ABORT                                 89540000
895500     ELSE                                                         89550000
895600     IF  PC238-MOD-BAD-OPER                                       89560000
895700         STRING ' PCKCS780 - '      DELIMITED BY SIZE             89570000
895800                ' 6000-UPDATE-UNITS-WRKD '                        89580000
895900                                    DELIMITED BY SIZE             89590000
896000                ' BAD OPER UNIT '   DELIMITED BY SIZE             89600000
896100                PV-DISPLAY-OPER     DELIMITED BY SIZE             89610000
896200                             INTO PV-CICS-MSG-AREA                89620000
896300         PERFORM 9900-WRITE-CICS-LOG                              89630000
896400         STRING ' PCKCS780 - '      DELIMITED BY SIZE             89640000
896500                ' 6000-UPDATE-UNITS-WRKD '                        89650000
896600                                    DELIMITED BY SIZE             89660000
896700                ' KEY INFO - '      DELIMITED BY SIZE             89670000
896800                PV-DISPLAY-PO       DELIMITED BY SIZE             89680000
896900                ' - '               DELIMITED BY SIZE             89690000
897000                PV-DISPLAY-RCVR     DELIMITED BY SIZE             89700000
897100                ' - '               DELIMITED BY SIZE             89710000
897200                PV-DISPLAY-LINE     DELIMITED BY SIZE             89720000
897300                             INTO PV-CICS-MSG-AREA                89730000
897400         PERFORM 9900-WRITE-CICS-LOG                              89740000
897500         PERFORM 9900A-SOFT-ABORT                                 89750000
897600     ELSE                                                         89760000
897700     IF  PC238-MOD-BAD-TRANS-TYPE                                 89770000
897800         STRING ' PCKCS780 - '      DELIMITED BY SIZE             89780000
897900                ' 6000-UPDATE-UNITS-WRKD '                        89790000
898000                                    DELIMITED BY SIZE             89800000
898100                ' BAD TRAN TYPE '   DELIMITED BY SIZE             89810000
898200                PC238-TRANS-TYPE-CDE                              89820000
898300                                    DELIMITED BY SIZE             89830000
898400                             INTO PV-CICS-MSG-AREA                89840000
898500         PERFORM 9900-WRITE-CICS-LOG                              89850000
898600         STRING ' PCKCS780 - '      DELIMITED BY SIZE             89860000
898700                ' 6000-UPDATE-UNITS-WRKD '                        89870000
898800                                    DELIMITED BY SIZE             89880000
898900                ' KEY INFO - '      DELIMITED BY SIZE             89890000
899000                PV-DISPLAY-PO       DELIMITED BY SIZE             89900000
899100                ' - '               DELIMITED BY SIZE             89910000
899200                PV-DISPLAY-RCVR     DELIMITED BY SIZE             89920000
899300                ' - '               DELIMITED BY SIZE             89930000
899400                PV-DISPLAY-LINE     DELIMITED BY SIZE             89940000
899500                             INTO PV-CICS-MSG-AREA                89950000
899600         PERFORM 9900-WRITE-CICS-LOG                              89960000
899700         PERFORM 9900A-SOFT-ABORT                                 89970000
899800     ELSE                                                         89980000
899900     IF  PC238-MOD-BAD-PO                                         89990000
900000         STRING ' PCKCS780 - '      DELIMITED BY SIZE             90000000
900100                ' 6000-UPDATE-UNITS-WRKD '                        90010000
900200                                    DELIMITED BY SIZE             90020000
900300                ' BAD PO NUMBER '   DELIMITED BY SIZE             90030000
900400                PV-DISPLAY-PO       DELIMITED BY SIZE             90040000
900500                             INTO PV-CICS-MSG-AREA                90050000
900600         PERFORM 9900-WRITE-CICS-LOG                              90060000
900700         STRING ' PCKCS780 - '      DELIMITED BY SIZE             90070000
900800                ' 6000-UPDATE-UNITS-WRKD '                        90080000
900900                                    DELIMITED BY SIZE             90090000
901000                ' KEY INFO - '      DELIMITED BY SIZE             90100000
901100                PV-DISPLAY-PO       DELIMITED BY SIZE             90110000
901200                ' - '               DELIMITED BY SIZE             90120000
901300                PV-DISPLAY-RCVR     DELIMITED BY SIZE             90130000
901400                ' - '               DELIMITED BY SIZE             90140000
901500                PV-DISPLAY-LINE     DELIMITED BY SIZE             90150000
901600                             INTO PV-CICS-MSG-AREA                90160000
901700         PERFORM 9900-WRITE-CICS-LOG                              90170000
901800         PERFORM 9900A-SOFT-ABORT                                 90180000
901900     ELSE                                                         90190000
902000     IF  PC238-MOD-BAD-RCVR                                       90200000
902100         STRING ' PCKCS780 - '      DELIMITED BY SIZE             90210000
902200                ' 6000-UPDATE-UNITS-WRKD '                        90220000
902300                                    DELIMITED BY SIZE             90230000
902400                ' BAD RCVR NBR  '   DELIMITED BY SIZE             90240000
902500                PV-DISPLAY-RCVR     DELIMITED BY SIZE             90250000
902600                             INTO PV-CICS-MSG-AREA                90260000
902700         PERFORM 9900-WRITE-CICS-LOG                              90270000
902800         STRING ' PCKCS780 - '      DELIMITED BY SIZE             90280000
902900                ' 6000-UPDATE-UNITS-WRKD '                        90290000
903000                                    DELIMITED BY SIZE             90300000
903100                ' KEY INFO - '      DELIMITED BY SIZE             90310000
903200                PV-DISPLAY-PO       DELIMITED BY SIZE             90320000
903300                ' - '               DELIMITED BY SIZE             90330000
903400                PV-DISPLAY-RCVR     DELIMITED BY SIZE             90340000
903500                ' - '               DELIMITED BY SIZE             90350000
903600                PV-DISPLAY-LINE     DELIMITED BY SIZE             90360000
903700                             INTO PV-CICS-MSG-AREA                90370000
903800         PERFORM 9900-WRITE-CICS-LOG                              90380000
903900         PERFORM 9900A-SOFT-ABORT                                 90390000
904000     ELSE                                                         90400000
904100     IF  PC238-MOD-BAD-LINE                                       90410000
904200         STRING ' PCKCS780 - '      DELIMITED BY SIZE             90420000
904300                ' 6000-UPDATE-UNITS-WRKD '                        90430000
904400                                    DELIMITED BY SIZE             90440000
904500                ' BAD LINE NBR  '   DELIMITED BY SIZE             90450000
904600                PV-DISPLAY-LINE     DELIMITED BY SIZE             90460000
904700                             INTO PV-CICS-MSG-AREA                90470000
904800         PERFORM 9900-WRITE-CICS-LOG                              90480000
904900         STRING ' PCKCS780 - '      DELIMITED BY SIZE             90490000
905000                ' 6000-UPDATE-UNITS-WRKD '                        90500000
905100                                    DELIMITED BY SIZE             90510000
905200                ' KEY INFO - '      DELIMITED BY SIZE             90520000
905300                PV-DISPLAY-PO       DELIMITED BY SIZE             90530000
905400                ' - '               DELIMITED BY SIZE             90540000
905500                PV-DISPLAY-RCVR     DELIMITED BY SIZE             90550000
905600                ' - '               DELIMITED BY SIZE             90560000
905700                PV-DISPLAY-LINE     DELIMITED BY SIZE             90570000
905800                             INTO PV-CICS-MSG-AREA                90580000
905900         PERFORM 9900-WRITE-CICS-LOG                              90590000
906000         PERFORM 9900A-SOFT-ABORT                                 90600000
906100     ELSE                                                         90610000
906200     IF  PC238-MOD-BAD-NO-SHIFT                                   90620000
906300         STRING ' PCKCS780 - '      DELIMITED BY SIZE             90630000
906400                ' 6000-UPDATE-UNITS-WRKD '                        90640000
906500                                    DELIMITED BY SIZE             90650000
906600                ' SHIFT NOT FOUND ' DELIMITED BY SIZE             90660000
906700                PC238-WRKD-TMST     DELIMITED BY SIZE             90670000
906800                ' FOR OPER '        DELIMITED BY SIZE             90680000
906900                PV-DISPLAY-OPER     DELIMITED BY SIZE             90690000
907000                             INTO PV-CICS-MSG-AREA                90700000
907100         PERFORM 9900-WRITE-CICS-LOG                              90710000
907200         STRING ' PCKCS780 - '      DELIMITED BY SIZE             90720000
907300                ' 6000-UPDATE-UNITS-WRKD '                        90730000
907400                                    DELIMITED BY SIZE             90740000
907500                ' KEY INFO - '      DELIMITED BY SIZE             90750000
907600                PV-DISPLAY-PO       DELIMITED BY SIZE             90760000
907700                ' - '               DELIMITED BY SIZE             90770000
907800                PV-DISPLAY-RCVR     DELIMITED BY SIZE             90780000
907900                ' - '               DELIMITED BY SIZE             90790000
908000                PV-DISPLAY-LINE     DELIMITED BY SIZE             90800000
908100                             INTO PV-CICS-MSG-AREA                90810000
908200         PERFORM 9900-WRITE-CICS-LOG                              90820000
908300         PERFORM 9900A-SOFT-ABORT                                 90830000
908400     ELSE                                                         90840000
908500         STRING ' PCKCS780 - '      DELIMITED BY SIZE             90850000
908600                ' 6000-UPDATE-UNITS-WRKD '                        90860000
908700                                    DELIMITED BY SIZE             90870000
908800                ' DB ERROR - SQL CODE '                           90880000
908900                                    DELIMITED BY SIZE             90890000
909000                PV-DISPLAY-SQL-CODE DELIMITED BY SIZE             90900000
909100                ' FUNC: '           DELIMITED BY SIZE             90910000
909200                PC238-BAD-TABLE-FUNCTION                          90920000
909300                                    DELIMITED BY SIZE             90930000
909400                ' TABLE: '          DELIMITED BY SIZE             90940000
909500                PC238-BAD-TABLE-NAME                              90950000
909600                                    DELIMITED BY SIZE             90960000
909700                             INTO PV-CICS-MSG-AREA                90970000
909800         PERFORM 9900-WRITE-CICS-LOG                              90980000
909900         STRING ' PCKCS780 - '      DELIMITED BY SIZE             90990000
910000                ' 6000-UPDATE-UNITS-WRKD '                        91000000
910100                                    DELIMITED BY SIZE             91010000
910200                ' KEY INFO - '      DELIMITED BY SIZE             91020000
910300                PV-DISPLAY-PO       DELIMITED BY SIZE             91030000
910400                ' - '               DELIMITED BY SIZE             91040000
910500                PV-DISPLAY-RCVR     DELIMITED BY SIZE             91050000
910600                ' - '               DELIMITED BY SIZE             91060000
910700                PV-DISPLAY-LINE     DELIMITED BY SIZE             91070000
910800                             INTO PV-CICS-MSG-AREA                91080000
910900         PERFORM 9900-WRITE-CICS-LOG                              91090000
911000         PERFORM 9900A-SOFT-ABORT                                 91100000
911100     END-IF                                                       91110000
911200     END-IF                                                       91120000
911300     END-IF                                                       91130000
911400     END-IF                                                       91140000
911500     END-IF                                                       91150000
911600     END-IF                                                       91160000
911700     END-IF.                                                      91170000
911800                                                                  91180000
917700*-----------------------------------------------------------------91770000
917710*                                                                -91771001
917720*-----------------------------------------------------------------91772001
917800 8100-WRITE-TEMP-STORAGE.                                         91780000
917900                                                                  91790000
918000     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     91800000
918100                                   TO PV-LIST-ITEM-NUMBER.        91810000
918200     COMPUTE PV-BLOCK-NUMBER =                                    91820000
918300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    91830000
918400                                                                  91840000
918500     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             91850000
918600     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             91860000
918700         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      91870000
918800             PERFORM 8105-REWRITE-ASC-LISTQ                       91880000
918900         END-IF                                                   91890000
919000     ELSE                                                         91900000
919100         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       91910000
919200         ASC-HIGHEST-BLOCK-WRITTEN + 1                            91920000
919300         PERFORM 8110-WRITE-ASC-LISTQ                             91930000
919400         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   91940000
919500     END-IF.                                                      91950000
919600                                                                  91960000
919700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             91970000
919800                                                                  91980000
919900*----------------------------------------------------------------*91990000
920000** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **92000000
920100** SPECIFIC COMMAREA.                                           **92010000
920200*----------------------------------------------------------------*92020000
920300 8105-REWRITE-ASC-LISTQ.                                          92030000
920400                                                                  92040000
920500     EXEC CICS                                                    92050000
920600         WRITEQ TS                                                92060000
920700             QUEUE (ASC-LIST-QUEUE-NAME)                          92070000
920800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               92080000
920900             ITEM  (PV-BLOCK-NUMBER)                              92090000
921000             REWRITE                                              92100000
921100             RESP  (PV-CICS-RESP)                                 92110000
921200     END-EXEC.                                                    92120000
921300                                                                  92130000
921400     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           92140000
921500         CONTINUE                                                 92150000
921600     ELSE                                                         92160000
921700         SET DP013-CICS-ABEND            TO TRUE                  92170000
921800         SET DP013-NO-ROLLBACK           TO TRUE                  92180000
921900         MOVE '8105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       92190000
922000         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     92200000
922100                                         TO DP013-MESSAGE-TEXT(1) 92210000
922110                                                                  92211004
922120         MOVE ASC-PO-NBR           TO PV-ERROR-PO                 92212004
922130         MOVE ASC-RCVR-SEQ-NBR     TO PV-ERROR-SEQ                92213004
922140         MOVE ASC-OPER-UNT-ID      TO PV-ERROR-OPER-UNT-ID        92214004
922150         MOVE PV-ERROR-MSG         TO DP013-MESSAGE-TEXT (2)      92215004
922160                                                                  92216004
922200         PERFORM DP013-0000-PROCESS-ABEND                         92220000
922300     END-IF.                                                      92230000
922400                                                                  92240000
922500*----------------------------------------------------------------*92250000
922600** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **92260000
922700** SPECIFIC COMMAREA.                                           **92270000
922800*----------------------------------------------------------------*92280000
922900 8110-WRITE-ASC-LISTQ.                                            92290000
923000                                                                  92300000
923100     EXEC CICS                                                    92310000
923200         WRITEQ TS                                                92320000
923300             QUEUE (ASC-LIST-QUEUE-NAME)                          92330000
923400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               92340000
923500             ITEM  (PV-BLOCK-NUMBER)                              92350000
923600             RESP  (PV-CICS-RESP)                                 92360000
923700     END-EXEC.                                                    92370000
923800     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      92380000
923900         SET DP013-CICS-ABEND      TO TRUE                        92390000
924000         SET DP013-NO-ROLLBACK     TO TRUE                        92400000
924100         MOVE '8110-WRITE-ASC-LISTQ'                              92410000
924200                                   TO DP013-PARAGRAPH             92420000
924300         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           92430000
924400                                   TO DP013-MESSAGE-TEXT(1)       92440000
924410                                                                  92441005
924420         MOVE ASC-PO-NBR           TO PV-ERROR-PO                 92442005
924430         MOVE ASC-RCVR-SEQ-NBR     TO PV-ERROR-SEQ                92443005
924440         MOVE ASC-OPER-UNT-ID      TO PV-ERROR-OPER-UNT-ID        92444005
924450         MOVE PV-ERROR-MSG         TO DP013-MESSAGE-TEXT (2)      92445005
924460                                                                  92446005
924500         PERFORM DP013-0000-PROCESS-ABEND                         92450000
924600     END-IF.                                                      92460000
924700                                                                  92470000
924800*----------------------------------------------------------------*92480000
924900*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*92490000
925000*----------------------------------------------------------------*92500000
925100 8112-READ-LIST-QUEUE.                                            92510000
925200                                                                  92520000
925300     EXEC CICS                                                    92530000
925400         READQ TS                                                 92540000
925500             QUEUE (ASC-LIST-QUEUE-NAME)                          92550000
925600             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     92560000
925700             ITEM  (PV-ITEM)                                      92570000
925800             RESP  (PV-CICS-RESP)                                 92580000
925900     END-EXEC.                                                    92590000
926000                                                                  92600000
926100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          92610000
926200         CONTINUE                                                 92620000
926300     ELSE                                                         92630000
926400         SET DP013-CICS-ABEND        TO TRUE                      92640000
926500         SET DP013-NO-ROLLBACK       TO TRUE                      92650000
926600         MOVE '8112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           92660000
926700         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    92670000
926800                                     TO DP013-MESSAGE-TEXT(1)     92680000
926900         PERFORM DP013-0000-PROCESS-ABEND                         92690000
927000     END-IF.                                                      92700000
927100                                                                  92710000
927200*----------------------------------------------------------------*92720000
927300*    READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE     *92730000
927400*----------------------------------------------------------------*92740000
927500 9100-READ-SEL-QUEUE.                                             92750000
927600     EXEC CICS                                                    92760000
927700         READQ TS                                                 92770000
927800             QUEUE (ASC-SEL-QUEUE-NAME)                           92780000
927900             INTO  (RC816-SELECT-RECORD)                          92790000
928000             ITEM  (ASC-SEL-ITEM)                                 92800000
928100             RESP  (PV-CICS-RESP)                                 92810000
928200     END-EXEC.                                                    92820000
928300                                                                  92830000
928400     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       92840000
928500         CONTINUE                                                 92850000
928600     ELSE                                                         92860000
928700         SET DP013-LOGIC-ABEND                                    92870000
928800             DP013-NO-ROLLBACK     TO TRUE                        92880000
928900         MOVE '9100-READ-SEL-QUEUE'                               92890000
929000                                   TO DP013-PARAGRAPH             92900000
929100         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   92910000
929200                                   TO DP013-MESSAGE-TEXT (1)      92920000
929210                                                                  92921004
929220         MOVE ASC-PO-NBR           TO PV-ERROR-PO                 92922004
929230         MOVE ASC-RCVR-SEQ-NBR     TO PV-ERROR-SEQ                92923004
929240         MOVE ASC-OPER-UNT-ID      TO PV-ERROR-OPER-UNT-ID        92924004
929250         MOVE PV-ERROR-MSG         TO DP013-MESSAGE-TEXT (2)      92925004
929260                                                                  92926004
929300         PERFORM DP013-0000-PROCESS-ABEND                         92930000
929400     END-IF.                                                      92940000
929500                                                                  92950000
929600 9100A-READ-SEL-QUEUE.                                            92960000
929700     EXEC CICS                                                    92970000
929800         READQ TS                                                 92980000
929900             QUEUE (ASC-PREV-SEL-QUEUE-NAME)                      92990000
930000             INTO  (RC817-SELECT-RECORD)                          93000000
930100             ITEM  (ASC-SEL-ITEM)                                 93010000
930200             RESP  (PV-CICS-RESP)                                 93020000
930300     END-EXEC.                                                    93030000
930400                                                                  93040000
930500     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       93050000
930600         CONTINUE                                                 93060000
930700     ELSE                                                         93070000
930800         SET DP013-LOGIC-ABEND                                    93080000
930900             DP013-NO-ROLLBACK     TO TRUE                        93090000
931000         MOVE '9100A-READ-SEL-QUEUE'                              93100000
931100                                   TO DP013-PARAGRAPH             93110000
931200         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   93120000
931300                                   TO DP013-MESSAGE-TEXT (1)      93130000
931310                                                                  93131004
931320         MOVE ASC-PO-NBR           TO PV-ERROR-PO                 93132004
931330         MOVE ASC-RCVR-SEQ-NBR     TO PV-ERROR-SEQ                93133004
931340         MOVE ASC-OPER-UNT-ID      TO PV-ERROR-OPER-UNT-ID        93134004
931350         MOVE PV-ERROR-MSG         TO DP013-MESSAGE-TEXT (2)      93135004
931360                                                                  93136004
931400         PERFORM DP013-0000-PROCESS-ABEND                         93140000
931500     END-IF.                                                      93150000
931600                                                                  93160000
931700*----------------------------------------------------------------*93170000
931800*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *93180000
931900*----------------------------------------------------------------*93190000
932000 9200-REWRITE-SEL-QUEUE.                                          93200000
932100     EXEC CICS                                                    93210000
932200          WRITEQ TS                                               93220000
932300              QUEUE  (ASC-SEL-QUEUE-NAME)                         93230000
932400              FROM   (RC816-SELECT-RECORD)                        93240000
932500              ITEM   (ASC-SEL-ITEM)                               93250000
932600              RESP   (PV-CICS-RESP)                               93260000
932700              REWRITE                                             93270000
932800     END-EXEC.                                                    93280000
932900                                                                  93290000
933000     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   93300000
933100         SET DP013-CICS-ABEND                                     93310000
933200             DP013-NO-ROLLBACK     TO TRUE                        93320000
933300         MOVE '9200-REWRITE-SEL-QUEUE'                            93330000
933400                                   TO DP013-PARAGRAPH             93340000
933500         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   93350000
933600                                   TO DP013-MESSAGE-TEXT (1)      93360000
933610                                                                  93361005
933620         MOVE ASC-PO-NBR           TO PV-ERROR-PO                 93362005
933630         MOVE ASC-RCVR-SEQ-NBR     TO PV-ERROR-SEQ                93363005
933640         MOVE ASC-OPER-UNT-ID      TO PV-ERROR-OPER-UNT-ID        93364005
933650         MOVE PV-ERROR-MSG         TO DP013-MESSAGE-TEXT (2)      93365005
933660                                                                  93366005
933700         PERFORM DP013-0000-PROCESS-ABEND                         93370000
933800     END-IF.                                                      93380000
933810                                                                  93381001
933900 9200A-REWRITE-SEL-QUEUE.                                         93390000
934000     EXEC CICS                                                    93400000
934100          WRITEQ TS                                               93410000
934200              QUEUE  (ASC-PREV-SEL-QUEUE-NAME)                    93420000
934300              FROM   (RC817-SELECT-RECORD)                        93430000
934400              ITEM   (ASC-SEL-ITEM)                               93440000
934500              RESP   (PV-CICS-RESP)                               93450000
934600              REWRITE                                             93460000
934700     END-EXEC.                                                    93470000
934800                                                                  93480000
934900     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   93490000
935000         SET DP013-CICS-ABEND                                     93500000
935100             DP013-NO-ROLLBACK     TO TRUE                        93510000
935200         MOVE '9200A-REWRITE-SEL-QUEUE'                           93520000
935300                                   TO DP013-PARAGRAPH             93530000
935400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   93540000
935500                                   TO DP013-MESSAGE-TEXT (1)      93550000
935600         PERFORM DP013-0000-PROCESS-ABEND                         93560000
935700     END-IF.                                                      93570000
935800                                                                  93580000
935900 9900-WRITE-CICS-LOG.                                             93590000
936000                                                                  93600000
936100     MOVE LENGTH OF PV-CICS-MSG-AREA                              93610000
936200          TO PV-COMMAREA-LENGTH                                   93620000
936300                                                                  93630000
936400     EXEC CICS                                                    93640000
936500         WRITEQ TD                                                93650000
936600             QUEUE  ('CSSL')                                      93660000
936700             FROM   (PV-CICS-MSG-AREA)                            93670000
936800             LENGTH (PV-COMMAREA-LENGTH)                          93680000
936900             RESP   (PV-CICS-RESP)                                93690000
937000     END-EXEC.                                                    93700000
937100                                                                  93710000
937200     MOVE SPACES TO PV-CICS-MSG-AREA.                             93720000
937210                                                                  93721001
937300*----------------------------------------------------------------*93730000
937400*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *93740000
937500*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *93750000
937600*----------------------------------------------------------------*93760000
937700 9900A-SOFT-ABORT.                                                93770000
937800                                                                  93780000
937900     EXEC CICS SYNCPOINT                                          93790000
938000          ROLLBACK                                                93800000
938100     END-EXEC.                                                    93810000
938200                                                                  93820000
938300     SET  PS-ERROR                                                93830000
938400          PS-SOFT-ABORT-ERROR                                     93840000
938500          DP020-MSG-FATAL       TO  TRUE.                         93850000
938600                                                                  93860000
938700                                                                  93870000
938800*----------------------------------------------------------------*93880001
938810*                                                                *93881001
938820*----------------------------------------------------------------*93882001
938900 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  93890000
939000                                                                  93900000
939100     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           93910000
939200     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          93920000
939300     INITIALIZE DP013-SRC-TASK-NUMBER                             93930000
939400                DP013-STACK.                                      93940000
939500     SET DP013-LINK-RETURN            TO TRUE.                    93950000
939600                                                                  93960000
939700     EXEC CICS                                                    93970000
939800         LINK                                                     93980000
939900             PROGRAM   (DP013-NAME)                               93990000
940000             COMMAREA  (DP013-PARAMETERS)                         94000000
940100             LENGTH    (DP013-LENGTH)                             94010000
940200     END-EXEC.                                                    94020000
940300                                                                  94030001
940400*----------------------------------------------------------------*94040000
940500*    ABEND PROCESSOR MODULE                                      *94050000
940600*----------------------------------------------------------------*94060000
940700     COPY DPPD013.                                                94070000
