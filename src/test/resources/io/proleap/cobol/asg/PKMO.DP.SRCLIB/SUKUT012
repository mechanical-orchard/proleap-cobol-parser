000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKUT012.                                00050000
000600 AUTHOR.                 MICHAEL WALTERS.                         00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            SEPTEMBER, 1997.                         00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*       THIS PROGRAM WILL CREATE THE PACK-BY-STORE AUDIT SUMARY   00120000
001300*  EXTRACT FILE TO FEED INTO SUKRP009 -- (SUKUT015 & SUKRP010 ARE 00130000
001400*  THE BULK/CASE PACK COUNTERPARTS)                               00140000
001500******************************************************************00150000
001500***************************************************************** 00160000
001600*  CHANGED 10/05/09 BY SAURABH DUDDALWAR                        * 00170000
001700*   CHANGES ARE DONE TO HANDLE DATA CONTENTION ERRORS IN THE    * 00180000
001800*            PROGRAM WHILE REPORT GENERATION.                   * 00190000
      *  CHANGED 11/19/13 BY SHOBHIT BAIJAL                           * 00200000
      *   PR# 5148D  ADD A NEW RFID ERROR RECORD TO BE USED FOR RFID  * 00210000
      *            AUDIT REPORTING                                    * 00220000
      *  CHANGED 12/26/13 BY RAMYA SREEDHAREN                         * 00230000
      *   PR# 5148D  ADDED NEW LOGIC TO DISPLAY TOTAL UNITS AUDITED   * 00240000
      *              FOR RFID AUDIT                                   * 00250000
      *  CHANGED 01/10/14 BY RAMYA SREEDHAREN                         * 00260000
      *   PR# 5148D  ADDED NEW LOGIC FOR RFID-NO-TICKET ERRORS        * 00270000
      *              FOR RFID AUDIT                                   * 00280000
      *  CHANGED 03/21/14 BY SHOBHIT BAIJAL                           * 00290000
      *   PR# 5148D  UPDATED LOGIC TO CALCULATE UPC MISPACK (VILN 38) * 00300000
      *              USE RFID QTY IF NON ZERO ELSE USE SCANNED QTY.   * 00310000
      *  CHANGED 03/28/14 BY SHOBHIT BAIJAL                           * 00320000
      *   PR# 5148D  ADDED LOGIC FOR SUMMING UPC MISPACK SEPARATELY   * 00330000
      *              BASED ON THE LOGIC PUT IN ON 03/21.              * 00340000
      *  CHANGED 04/10/14 BY SHOBHIT BAIJAL                           * 00341000
      *   PR# 5148D  ADDED LOGIC FOR COUNTING RFID UPC MISPACK EVEN   * 00342000
      *              WHEN THE QUANTITIES ON DB ARE 0.                 * 00343000
001900***************************************************************** 00350000
001600                                                                  00360000
001700******************************************************************00370000
001800 ENVIRONMENT DIVISION.                                            00380000
001900******************************************************************00390000
002000                                                                  00400000
002100 CONFIGURATION SECTION.                                           00410000
002200                                                                  00420000
002300 SOURCE-COMPUTER.        IBM-3090.                                00430000
002400 OBJECT-COMPUTER.        IBM-3090.                                00440000
002500                                                                  00450000
002600 INPUT-OUTPUT SECTION.                                            00460000
002700                                                                  00470000
002800 FILE-CONTROL.                                                    00480000
002900                                                                  00490000
003000     SELECT OS-VND-OVER-SHORT-FILE                                00500000
003100         ASSIGN TO INP01.                                         00510000
003200                                                                  00520000
003300     SELECT OS-RCVR-OVER-SHORT-FILE                               00530000
003400         ASSIGN TO INP02.                                         00540000
                                                                        00550000
      *SB 11/19/13 - BEGIN PR#5148D                                     00560000
           SELECT CARDIN-AUDIT-NBR-FILE                                 00570000
               ASSIGN TO CARDIN.                                        00580000
      *SB 11/19/13 - END PR#5148D                                       00590000
003500                                                                  00600000
003600     SELECT AS-AUDIT-SUM-EXTRACT-FILE                             00610000
003700         ASSIGN TO OUT01.                                         00620000
003800                                                                  00630000
003900******************************************************************00640000
004000 DATA DIVISION.                                                   00650000
004100******************************************************************00660000
004200                                                                  00670000
004300 FILE SECTION.                                                    00680000
004400                                                                  00690000
004500 FD  OS-VND-OVER-SHORT-FILE                                       00700000
004600     RECORDING MODE IS F                                          00710000
004700     LABEL RECORDS ARE STANDARD                                   00720000
004800     BLOCK CONTAINS 0 RECORDS.                                    00730000
004900 01  OS-VND-OVER-SHORT-RECORD            PIC  X(200).             00740000
005000                                                                  00750000
005100 FD  OS-RCVR-OVER-SHORT-FILE                                      00760000
005200     RECORDING MODE IS F                                          00770000
005300     LABEL RECORDS ARE STANDARD                                   00780000
005400     BLOCK CONTAINS 0 RECORDS.                                    00790000
005500 01  OS-RCVR-OVER-SHORT-RECORD           PIC  X(200).             00800000
005600                                                                  00810000
      *SB 11/19/13 - BEGIN PR#5148D                                     00820000
       FD  CARDIN-AUDIT-NBR-FILE                                        00830000
           LABEL RECORDS ARE STANDARD                                   00840000
           RECORDING MODE IS F                                          00850000
           BLOCK CONTAINS 0 RECORDS                                     00860000
           RECORD CONTAINS 80 CHARACTERS.                               00870000
       01  CC-RECORD                           PIC X(80).               00880000
      *SB 11/19/13 - END PR#5148D                                       00890000
                                                                        00900000
005700 FD  AS-AUDIT-SUM-EXTRACT-FILE                                    00910000
005800     RECORDING MODE IS F                                          00920000
005900     LABEL RECORDS ARE STANDARD                                   00930000
006000     BLOCK CONTAINS 0 RECORDS.                                    00940000
006100 01  AS-AUDIT-SUM-EXTRACT-REC          PIC  X(200).               00950000
006200                                                                  00960000
006300                                                                  00970000
006400******************************************************************00980000
006500 WORKING-STORAGE SECTION.                                         00990000
006600******************************************************************01000000
006700                                                                  01010000
006800* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01020000
006900*  RECORD LAYOUT FOR THE VENDOR OVER/SHORT FILE                   01030000
007000* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01040000
007100 01  SU003-COPYBOOK.                                              01050000
007200     COPY SURD003.                                                01060000
007300                                                                  01070000
007400* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01080000
007500*  RECORD LAYOUT FOR THE RECEIVER OVER/SHORT FILE               * 01090000
007600* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01100000
007700 01  SU004-COPYBOOK.                                              01110000
007800     COPY SURD004.                                                01120000
007900                                                                  01130000
      *SB 11/19/13 - BEGIN PR#5148D                                     01140000
008000* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01150000
008100*  RECORD LAYOUT FOR THE REPORT EXTRACT FILE                    * 01160000
008200* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01170000
       01  CC-CARDIN.                                                   01180000
           05  CC-AUDIT-CNTL-NBR           PIC 9(09).                   01190000
           05  CC-CARTON-ID                PIC 9(18).                   01200000
           05  CC-SYSTEM-MANUAL-AUDIT      PIC X(01).                   01210000
               88  CC-SYSTEM-GENERATED-AUDIT    VALUE 'S'.              01220000
               88  CC-MANUAL-GENERATED-AUDIT    VALUE 'M'.              01230000
           05  CC-RFID-QC-AUDIT-IND        PIC X(01).                   01240000
               88  CC-RFID-AUDIT                VALUE 'R'.              01250000
               88  CC-QC-AUDIT                  VALUE 'S'.              01260000
           05  CC-RFID-QC-AUD-CMB-IND      PIC X(01).                   01270000
               88  CC-RFID-AUD-ONLY             VALUE 'R'.              01280000
               88  CC-QC-AUD-ONLY               VALUE 'S'.              01290000
               88  CC-QC-AND-RFID-AUD           VALUE 'B'.              01300000
      *SB 11/19/13 - END PR#5148D                                       01310000
                                                                        01320000
008000* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01330000
008100*  RECORD LAYOUT FOR THE REPORT EXTRACT FILE                    * 01340000
008200* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01350000
008300     COPY SURD005.                                                01360000
008400                                                                  01370000
008510*----------------------------------------------------------------*01380000
008520*  COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE  WR # 21361  *01390000
008530*----------------------------------------------------------------*01400000
008540     COPY XLWS001.                                                01410000
008550*----------------------------------------------------------------*01420000
008560* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *01430000
008570*----------------------------------------------------------------*01440000
008580                                                                  01450000
008600* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01460000
008700*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'                      01470000
008800* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01480000
008900     COPY DPWS004.                                                01490000
009000                                                                  01500000
009100 01  ABEND-CODE                          PIC S9(04) VALUE +0      01510000
009200                                                     COMP SYNC.   01520000
009300                                                                  01530000
009400 01  PC-CONSTANTS.                                                01540000
009500     05  PC-ZERO                         PIC  9(01)  VALUE 0.     01550000
009600     05  PC-ONE                          PIC  9(01)  VALUE 1.     01560000
009700     05  PC-TWO                          PIC  9(01)  VALUE 2.     01570000
009800     05  PC-THREE                        PIC  9(01)  VALUE 3.     01580000
009900     05  PC-FOUR                         PIC  9(01)  VALUE 4.     01590000
010000     05  PC-EIGHT                        PIC  9(01)  VALUE 8.     01600000
010100     05  PC-NINE                         PIC  9(01)  VALUE 9.     01610000
010200     05  PC-E                            PIC  X(01)  VALUE 'E'.   01620000
010300     05  PC-KOHLS-OPERATING-COMPANY      PIC  X(02)  VALUE '03'.  01630000
010400     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        01640000
010500         'SUKUT012'.                                              01650000
010600     05  PC-CURRENT-JOB-NAME             PIC  X(08)  VALUE        01660000
010700         'SUK900C '.                                              01670000
010800     05  PC-PICKING-VILNS.                                        01680000
010900         10  PC-STYLE-SUB-VILN           PIC S9(4)   COMP         01690000
011000                                                     VALUE 9.     01700000
011100         10  PC-NO-DC-OTR-VILN           PIC S9(4)   COMP         01710000
011200                                                     VALUE 10.    01720000
011300         10  PC-NO-PBS-ALLOC-VILN        PIC S9(4)   COMP         01730000
011400                                                     VALUE 11.    01740000
011500         10  PC-DMGD-MDSE-VILN           PIC S9(4)   COMP         01750000
011600                                                     VALUE 20.    01760000
011700     05  PC-TICKETING-VILNS.                                      01770000
011800         10  PC-NO-BARCODE-VILN          PIC S9(4)   COMP         01780000
011900                                                     VALUE 3.     01790000
012000         10  PC-DMGD-BARCODE-VILN        PIC S9(4)   COMP         01800000
012100                                                     VALUE 4.     01810000
012200         10  PC-NO-UPC-VILN              PIC S9(4)   COMP         01820000
012300                                                     VALUE 5.     01830000
012400         10  PC-UPC-NOT-FOUND-VILN       PIC S9(4)   COMP         01840000
012500                                                     VALUE 6.     01850000
012600         10  PC-SKU-NOT-FOUND-VILN       PIC S9(4)   COMP         01860000
012700                                                     VALUE 7.     01870000
012800         10  PC-NO-TAG-TICKET-VILN       PIC S9(4)   COMP         01880000
012900                                                     VALUE 8.     01890000
013000         10  PC-WRONG-DEPT-TKT-VILN      PIC S9(4)   COMP         01900000
013100                                                     VALUE 13.    01910000
013200         10  PC-WRONG-RETAIL-TKT-VILN    PIC S9(4)   COMP         01920000
013300                                                     VALUE 14.    01930000
013400         10  PC-WRONG-COLOR-TKT-VILN     PIC S9(4)   COMP         01940000
013500                                                     VALUE 15.    01950000
013600         10  PC-WRONG-SIZE-TKT-VILN      PIC S9(4)   COMP         01960000
013700                                                     VALUE 16.    01970000
013800         10  PC-WRONG-RETAIL-MDSE-VILN   PIC S9(4)   COMP         01980000
013900                                                     VALUE 17.    01990000
014000         10  PC-WRONG-COLOR-MDSE-VILN    PIC S9(4)   COMP         02000000
014100                                                     VALUE 18.    02010000
014200         10  PC-WRONG-SIZE-MDSE-VILN     PIC S9(4)   COMP         02020000
014300                                                     VALUE 19.    02030000
014400         10  PC-WRONG-CLASS-TKT-VILN     PIC S9(4)   COMP         02040000
014500                                                     VALUE 21.    02050000
014600         10  PC-WRONG-SKU-TKT-VILN       PIC S9(4)   COMP         02060000
014700                                                     VALUE 22.    02070000
014800         10  PC-SIZE-STRIP-MDSE-VILN     PIC S9(4)   COMP         02080000
014900                                                     VALUE 23.    02090000
015000         10  PC-WRONG-STYLE-TKT-VILN     PIC S9(4)   COMP         02100000
015100                                                     VALUE 24.    02110000
015200         10  PC-WRONG-STYLE-MDSE-VILN    PIC S9(4)   COMP         02120000
015300                                                     VALUE 25.    02130000
015400         10  PC-WRG-BOX-ID               PIC S9(4)   COMP         02140000
015500                                                     VALUE 26.    02150000
015600         10  PC-WRG-TKT-MDSE-OK-VILN     PIC S9(4)   COMP         02160000
015700                                                     VALUE 27.    02170000
015800         10  PC-NO-TAG-VILN              PIC S9(4)   COMP         02180000
015900                                                     VALUE 28.    02190000
      *SB 11/19/13 - BEGIN PR#5148D                                     02200000
013100     05  PC-RFID-VILNS.                                           02210000
013400         10  PC-RFID-UPC-MISPCK          PIC S9(4)   COMP         02220000
013500                                                     VALUE 38.    02230000
013400         10  PC-RFID-TKT-CLR             PIC S9(4)   COMP         02240000
013500                                                     VALUE 39.    02250000
013600         10  PC-RFID-TKT-SIZE            PIC S9(4)   COMP         02260000
013700                                                     VALUE 40.    02270000
013800         10  PC-RFID-TKT-STYLE           PIC S9(4)   COMP         02280000
013900                                                     VALUE 41.    02290000
014000         10  PC-RFID-NO-TICKET           PIC S9(4)   COMP         02300000
014100                                                     VALUE 42.    02310000
      *SB 11/19/13 - END PR#5148D                                       02320000
016000                                                                  02330000
016100 01  CK-CURRENT-KEY-AREA.                                         02340000
016200     05  CK-BUYER-NBR                    PIC  X(03)  VALUE SPACES.02350000
016300     05  CK-STATUS-CHG-DTE               PIC  X(10)  VALUE SPACES.02360000
016400     05  CK-DEPT-NBR                     PIC  X(03)  VALUE SPACES.02370000
016500     05  CK-VND-NBR                      PIC  X(09)  VALUE SPACES.02380000
016600     05  CK-DFCT-ORD-ID                  PIC  X(06)  VALUE SPACES.02390000
016700                                                                  02400000
016800 01  DA-DISPLAY-AREAS.                                            02410000
016900     05  DA-SORT-RECORD-COUNT            PIC  ZZZ,ZZZ,ZZ9         02420000
017000                                                     VALUE ZERO.  02430000
017100                                                                  02440000
017200 01  PS-PROGRAM-SWITCHES.                                         02450000
017300     05  PS-END-OF-TICKETING-CURSOR-IND  PIC  X(01)  VALUE 'N'.   02460000
017400         88  PS-END-OF-TICKETING-CURSOR              VALUE 'Y'.   02470000
017500         88  PS-NOT-END-OF-TICKETING-CURSOR          VALUE 'N'.   02480000
017600     05  PS-END-OF-PICKING-CURSOR-IND    PIC  X(01)  VALUE 'N'.   02490000
017700         88  PS-END-OF-PICKING-CURSOR                VALUE 'Y'.   02500000
017800         88  PS-NOT-END-OF-PICKING-CURSOR            VALUE 'N'.   02510000
      *SB 11/19/13 - BEGIN PR#5148D                                     02520000
019000     05  PS-END-OF-RFID-CURSOR-IND       PIC  X(01)  VALUE 'N'.   02530000
019100         88  PS-END-OF-RFID-CURSOR                   VALUE 'Y'.   02540000
019200         88  PS-NOT-END-OF-RFID-CURSOR               VALUE 'N'.   02550000
           05  PS-END-OF-CARDIN-SW             PIC  X(01)  VALUE 'N'.   02560000
               88  PS-END-OF-CARDIN-FILE                   VALUE 'Y'.   02570000
               88  PS-NOT-END-OF-CARDIN-FILE               VALUE 'N'.   02580000
      *SB 11/19/13 - END PR#5148D                                       02590000
017900     05  PS-EOF-VND-OVER-SHORT-IND       PIC  X(01)  VALUE 'N'.   02600000
018000         88  PS-EOF-VND-OVER-SHORT                   VALUE 'Y'.   02610000
018100         88  PS-NOT-EOF-VND-OVER-SHORT               VALUE 'N'.   02620000
018200     05  PS-EOF-RCVR-OVER-SHORT-IND      PIC  X(01)  VALUE 'N'.   02630000
018300         88  PS-EOF-RCVR-OVER-SHORT                  VALUE 'Y'.   02640000
018400         88  PS-NOT-EOF-RCVR-OVER-SHORT              VALUE 'N'.   02650000
018500     05  PS-CREATE-OVER-IND              PIC  X(01)  VALUE 'N'.   02660000
018600         88  PS-CREATE-OVER                          VALUE 'Y'.   02670000
018700         88  PS-DONT-CREATE-OVER                     VALUE 'N'.   02680000
018800     05  PS-USE-FILE-IND                 PIC  X(01)  VALUE 'V'.   02690000
018900         88  PS-USE-VND-OS-ONLY                      VALUE 'V'.   02700000
019000         88  PS-USE-RCVR-OS-ONLY                     VALUE 'R'.   02710000
019100         88  PS-USE-BOTH-FILES                       VALUE 'B'.   02720000
019200                                                                  02730000
019300                                                                  02740000
019410*----------------------------------------------------------------*02750000
019420* REMOVED DK-SKU-NBR-DEPT, DK-SKU-NBR-CLASS AND      WR # 21361  *02760000
019430* DK-SKU-NBR-SEQ. DK-SKU-NBR HAVE BEEN REDECLARED AS 9(8)        *02770000
019440*----------------------------------------------------------------*02780000
019450 01  DK-DB2-KEY-VALUE.                                            02790000
019500     05  DK-AUD-CNTL-NBR                 PIC S9(09) COMP.         02800000
019600     05  DK-PO-NBR                       PIC S9(09) COMP.         02810000
019700     05  DK-REC-SEQ-NBR                  PIC S9(09) COMP.         02820000
019800     05  DK-STORE-NBR                    PIC S9(04) COMP.         02830000
020210     05  DK-SKU-NBR                      PIC  9(08) VALUE ZEROS.  02840000
020300     05  DK-SCAN-TMST                    PIC  X(26).              02850000
020310*----------------------------------------------------------------*02860000
020320* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *02870000
020330*----------------------------------------------------------------*02880000
020400                                                                  02890000
020500 01  PV-PROGRAM-VARIABLES.                                        02900000
020600     05  PV-HOLD-AUD-CNTL-NBR            PIC S9(09) COMP.         02910000
020700     05  PV-HOLD-PO-NBR                  PIC S9(09) COMP.         02920000
020800     05  PV-HOLD-REC-SEQ-NBR             PIC S9(09) COMP.         02930000
020900     05  PV-HOLD-STORE-NBR               PIC S9(04) COMP.         02940000
021000     05  PV-DB2-COUNT                    PIC S9(09)  VALUE +0     02950000
TE1100                                                     COMP.        02960000
      *SB 01/10/14 - BEGIN PR#5148D                                     02970000
023700     05  PV-RFID-COUNT                   PIC S9(09)  VALUE +0     02980000
023800                                                     COMP.        02990000
023700     05  PV-RFID-TGD-QTY                PIC S9(09)  VALUE +0      03000000
023800                                                     COMP.        03010000
      *SB 01/10/14 - END PR#5148D                                       03020000
021200     05  PV-HOLD-TMST                    PIC  X(26)  VALUE SPACES.03030000
021300     05  PV-CURR-TMST                    PIC  X(26)  VALUE SPACES.03040000
021400     05  PV-CURR-DEPT                    PIC  X(03)  VALUE SPACES.03050000
021500     05  PV-PREV-DEPT                    PIC  X(03)  VALUE SPACES.03060000
021600     05  PV-FIELD-NAME                   PIC  X(30)  VALUE SPACES.03070000
021700     05  PV-COMMIT-TMST                  PIC  X(26)  VALUE SPACES.03080000
021800     05  PV-SORT-RETURN                  PIC  9(02)  VALUE ZERO.  03090000
021900     05  PV-DISPLAY-COMP                 PIC  9(18).              03100000
022000     05  PV-UNITS-TRNSCRBD               PIC S9(09) COMP.         03110000
022100     05  PV-DETAIL-PAGE-COUNT            PIC S9(04)  VALUE +0     03120000
022200                                                     COMP SYNC.   03130000
022300     05  PV-DETAIL-LINE-COUNT            PIC S9(04)  VALUE +0     03140000
022400                                                     COMP.        03150000
022500     05  PV-SUM-PAGE-COUNT               PIC S9(04)  VALUE +0     03160000
022600                                                     COMP.        03170000
022700     05  PV-SUM-LINE-COUNT               PIC S9(04)  VALUE +0     03180000
022800                                                     COMP.        03190000
022900     05  PV-ADVANCE-COUNT                PIC S9(04)  VALUE +0     03200000
023000                                                     COMP.        03210000
023100     05  PV-TOTAL-APPROVED-DOLLARS       PIC S9(09)V9(02)         03220000
023200                                                     VALUE +0     03230000
023300                                                     COMP-3.      03240000
023400     05  PV-TOTAL-DECLINED-DOLLARS       PIC S9(09)V9(02)         03250000
023500                                                     VALUE +0     03260000
023600                                                     COMP-3.      03270000
023700     05  PV-TOTAL-APPROVED-REFERRALS     PIC  9(09)  VALUE ZEROS  03280000
023800                                                     COMP-3.      03290000
023900     05  PV-TOTAL-DECLINED-REFERRALS     PIC  9(09)  VALUE ZEROS  03300000
024000                                                     COMP-3.      03310000
024100     05  PV-DOLLARS                      PIC  9(04)V9(02)         03320000
024200                                                     VALUE ZEROS. 03330000
024300                                                                  03340000
024400     05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACE. 03350000
024500     05  PV-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE. 03360000
024600     05  PV-DB2-OPER-UNT-ID              PIC  X(03).              03370000
024700     05  PV-START-DATE.                                           03380000
024800         10  PV-START-MONTH              PIC  9(02).              03390000
024900         10  FILLER                      PIC  X(01) VALUE '/'.    03400000
025000         10  PV-START-DAY                PIC  9(02).              03410000
025100         10  FILLER                      PIC  X(01) VALUE '/'.    03420000
025200         10  PV-START-CENTURY            PIC  9(02).              03430000
025300         10  PV-START-YEAR               PIC  9(02).              03440000
025400     05  PV-END-DATE.                                             03450000
025500         10  PV-END-MONTH                PIC  9(02).              03460000
025600         10  FILLER                      PIC  X(01) VALUE '/'.    03470000
025700         10  PV-END-DAY                  PIC  9(02).              03480000
025800         10  FILLER                      PIC  X(01) VALUE '/'.    03490000
025900         10  PV-END-CENTURY              PIC  9(02).              03500000
026000         10  PV-END-YEAR                 PIC  9(02).              03510000
026100     05  PV-WORK-DATE.                                            03520000
026200         10  PV-WORK-MONTH               PIC  9(02).              03530000
026300         10  FILLER                      PIC  X(01) VALUE '/'.    03540000
026400         10  PV-WORK-DAY                 PIC  9(02).              03550000
026500         10  FILLER                      PIC  X(01) VALUE '/'.    03560000
026600         10  PV-WORK-YEAR                PIC  9(02).              03570000
026700     05  PV-AUDIT-TYPE                   PIC  X(02)  VALUE SPACE. 03580000
026800         88  PV-100-AUDIT-CHECK          VALUE '01'.              03590000
026900         88  PV-SPOT-AUDIT-CHECK         VALUE '02'.              03600000
027000         88  PV-REWORK-AUDIT-CHECK       VALUE '03'.              03610000
027100     05  PV-AUDIT-STATUS                 PIC  X(02)  VALUE SPACE. 03620000
027200         88  PV-AUDIT-INPROCESS          VALUE 'IP'.              03630000
027300         88  PV-AUDIT-COMPLETE           VALUE 'CM'.              03640000
027400         88  PV-AUDIT-POSTPONE           VALUE 'PP'.              03650000
027410*----------------------------------------------------------------*03660000
027420* ADDED NEW VARIABLES                          ** WR # 21361     *03670000
027430*----------------------------------------------------------------*03680000
027440     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  03690000
027441     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     03700000
027442                                                   COMP SYNC.     03710000
027450     05  PV-ABEND.                                                03720000
027460         10  PV-ABEND-MESSAGE-TEXT   PIC  X(40)    VALUE SPACES.  03730000
027470         10  PV-SQLCODE              PIC  S9(9)    VALUE ZEROES.  03740000
027480         10  PV-DB2-VIEW-NAME        PIC  X(10)    VALUE SPACES.  03750000
027490*----------------------------------------------------------------*03760000
027491* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *03770000
027492*----------------------------------------------------------------*03780000
027500                                                                  03790000
027600 01  SD-SYSTEM-DATE.                                              03800000
027700     05  SD-SYSTEM-YEAR                  PIC  9(02)  VALUE ZEROS. 03810000
027800     05  SD-SYSTEM-MONTH                 PIC  9(02)  VALUE ZEROS. 03820000
027900     05  SD-SYSTEM-DAY                   PIC  9(02)  VALUE ZEROS. 03830000
028000                                                                  03840000
028100*                                                                 03850000
028200******************************************************************03860000
028300*  DB2 COMMUNICATION AREA.                                        03870000
028400******************************************************************03880000
028500     EXEC SQL                                                     03890000
028600          INCLUDE SQLCA                                           03900000
028700     END-EXEC.                                                    03910000
028800*                                                                 03920000
028900*                                                                 03930000
029000******************************************************************03940000
029100*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE SHIPPING UNIT     03950000
029200*  AUDIT TRANSATIONS TABLE                                        03960000
029300******************************************************************03970000
029400     EXEC SQL                                                     03980000
029500          INCLUDE TSUATRN                                         03990000
029600     END-EXEC.                                                    04000000
029700*                                                                 04010000
029800*                                                                 04020000
029900******************************************************************04030000
030000*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE SHIPPING UNIT     04040000
030100*  AUDIT CONTENT TABLE                                            04050000
030200******************************************************************04060000
030300     EXEC SQL                                                     04070000
030400          INCLUDE TSUAUPC                                         04080000
030500     END-EXEC.                                                    04090000
030600*                                                                 04100000
030700*                                                                 04110000
030800******************************************************************04120000
030900*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE SHIPPING UNIT     04130000
031000*  AUDIT EXCEPTIONS TABLE                                         04140000
031100******************************************************************04150000
031200     EXEC SQL                                                     04160000
031300          INCLUDE TSUEXCP                                         04170000
031400     END-EXEC.                                                    04180000
031500                                                                  04190000
031600 EJECT                                                            04200000
031700******************************************************************04210000
031800*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE                   04220000
031900******************************************************************04230000
032000     EXEC SQL                                                     04240000
032100          INCLUDE TRECDIS                                         04250000
032200     END-EXEC.                                                    04260000
032300                                                                  04270000
032400                                                                  04280000
032500******************************************************************04290000
032600*  DB2 TABLE COBOL WORKING STORAGE AREA                           04300000
032700******************************************************************04310000
032800     EXEC SQL                                                     04320000
032900          INCLUDE TUPCSKU                                         04330000
033000     END-EXEC.                                                    04340000
033100                                                                  04350000
033200                                                                  04360000
033300***************************************************************** 04370000
033400******************************************************************04380000
033500*  DB2 TABLE COBOL WORKING STORAGE AREA                           04390000
033600******************************************************************04400000
033700     EXEC SQL                                                     04410000
033800          INCLUDE TSK                                             04420000
033900     END-EXEC.                                                    04430000
034000                                                                  04440000
034100 EJECT                                                            04450000
034200***************************************************************** 04460000
034300*    DECLARE PICKING CURSOR -- THIS CURSOR WILL RETRIEVE ALL      04470000
034400*    THE PICKING EXCEPTIONS FOR A CERTAIN AUDIT/RECEIVER/STORE    04480000
034500***************************************************************** 04490000
034600     EXEC SQL                                                     04500000
034700         DECLARE PICKING_CURSOR CURSOR FOR                        04510000
034800         SELECT                                                   04520000
034900                 C.UPC_NBR                                        04530000
035000              ,  C.SCN_TMST                                       04540000
035100              ,  C.VILN_GP_SEQ_NBR                                04550000
      *VSH 02/01/14 - BEGIN PR#5148D                                    04560000
038900*             ,  COUNT(*)                                         04570000
038900              ,  SUM(B.SCND_UNT_QTY)                              04580000
      *VSH 02/01/14 - END PR#5148D                                      04590000
035300         FROM                                                     04600000
035400                TSUATRN A                                         04610000
035500             ,  TSUAUPC B                                         04620000
035600             ,  TSUEXCP C                                         04630000
035700         WHERE                                                    04640000
035800             A.AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR                04650000
035900         AND A.DEST_OPER_UNT_ID = :DK-STORE-NBR                   04660000
036000         AND A.TRN_NBR          = :DK-PO-NBR                      04670000
036100         AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR                 04680000
036200         AND A.AUD_CNTL_NBR     = B.AUD_CNTL_NBR                  04690000
036300         AND A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID                  04700000
036400         AND B.AUD_CNTL_NBR     = C.AUD_CNTL_NBR                  04710000
036500         AND B.SHIPT_UNT_ID     = C.SHIPT_UNT_ID                  04720000
036600         AND B.UPC_NBR          = C.UPC_NBR                       04730000
036700         AND B.SCN_TMST         = C.SCN_TMST                      04740000
036800         AND B.SCN_TYP_CDE     <> :PC-E                           04750000
036900         AND C.VILN_GP_SEQ_NBR IN (                               04760000
037000              :PC-STYLE-SUB-VILN                                  04770000
037100             ,:PC-NO-DC-OTR-VILN                                  04780000
037200             ,:PC-NO-PBS-ALLOC-VILN                               04790000
037300             ,:PC-DMGD-MDSE-VILN )                                04800000
037400        GROUP BY C.VILN_GP_SEQ_NBR                                04810000
037500              ,  C.UPC_NBR                                        04820000
037600              ,  C.SCN_TMST                                       04830000
037700     END-EXEC.                                                    04840000
037800                                                                  04850000
037900***************************************************************** 04860000
038000*    DECLARE TICKETING CURSOR -- THIS CURSOR WILL RETRIEVE ALL    04870000
038100*    THE TICKETING EXCEPTIONS FOR A CERTAIN AUDIT/RCVR/STORE      04880000
038200***************************************************************** 04890000
038300     EXEC SQL                                                     04900000
038400         DECLARE TICKETING_CURSOR CURSOR FOR                      04910000
038500         SELECT                                                   04920000
038600                 C.UPC_NBR                                        04930000
038700              ,  C.SCN_TMST                                       04940000
038800              ,  C.VILN_GP_SEQ_NBR                                04950000
      *VSH 02/01/14 - BEGIN PR#5148D                                    04960000
038900*             ,  COUNT(*)                                         04970000
038900              ,  SUM(B.SCND_UNT_QTY)                              04980000
      *VSH 02/01/14 - END PR#5148D                                      04990000
039000         FROM                                                     05000000
039100                TSUATRN A                                         05010000
039200             ,  TSUAUPC B                                         05020000
039300             ,  TSUEXCP C                                         05030000
039400         WHERE                                                    05040000
039500             A.AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR                05050000
039600         AND A.DEST_OPER_UNT_ID = :DK-STORE-NBR                   05060000
039700         AND A.TRN_NBR          = :DK-PO-NBR                      05070000
039800         AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR                 05080000
039900         AND A.AUD_CNTL_NBR     = B.AUD_CNTL_NBR                  05090000
040000         AND A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID                  05100000
040100         AND B.AUD_CNTL_NBR     = C.AUD_CNTL_NBR                  05110000
040200         AND B.SHIPT_UNT_ID     = C.SHIPT_UNT_ID                  05120000
040300         AND B.UPC_NBR          = C.UPC_NBR                       05130000
040400         AND B.SCN_TMST         = C.SCN_TMST                      05140000
040500         AND B.SCN_TYP_CDE     <> :PC-E                           05150000
040600         AND C.VILN_GP_SEQ_NBR IN  (                              05160000
040700              :PC-NO-BARCODE-VILN                                 05170000
040800             ,:PC-DMGD-BARCODE-VILN                               05180000
040900             ,:PC-NO-UPC-VILN                                     05190000
041000             ,:PC-UPC-NOT-FOUND-VILN                              05200000
041100             ,:PC-SKU-NOT-FOUND-VILN                              05210000
041200             ,:PC-NO-TAG-TICKET-VILN                              05220000
041300             ,:PC-WRONG-DEPT-TKT-VILN                             05230000
041400             ,:PC-WRONG-RETAIL-TKT-VILN                           05240000
041500             ,:PC-WRONG-COLOR-TKT-VILN                            05250000
041600             ,:PC-WRONG-SIZE-TKT-VILN                             05260000
041700             ,:PC-WRONG-RETAIL-MDSE-VILN                          05270000
041800             ,:PC-WRONG-COLOR-MDSE-VILN                           05280000
041900             ,:PC-WRONG-SIZE-MDSE-VILN                            05290000
042000             ,:PC-WRONG-CLASS-TKT-VILN                            05300000
042100             ,:PC-SIZE-STRIP-MDSE-VILN                            05310000
042200             ,:PC-WRONG-SKU-TKT-VILN                              05320000
042300             ,:PC-WRONG-STYLE-TKT-VILN                            05330000
042400             ,:PC-WRONG-STYLE-MDSE-VILN                           05340000
042600             ,:PC-WRG-TKT-MDSE-OK-VILN                            05350000
042500             ,:PC-WRG-BOX-ID                                      05360000
042700             ,:PC-NO-TAG-VILN)                                    05370000
042800        GROUP BY C.VILN_GP_SEQ_NBR                                05380000
042900              ,  C.UPC_NBR                                        05390000
043000              ,  C.SCN_TMST                                       05400000
043100     END-EXEC.                                                    05410000
                                                                        05420000
      *SB 11/19/13 - BEGIN PR#5148D                                     05430000
037900***************************************************************** 05440000
038000*    DECLARE RFID CURSOR -- THIS CURSOR WILL RETRIEVE ALL THE     05450000
038100*    RFID EXCEPTIONS FOR A CERTAIN AUDIT/RCVR/STORE               05460000
038200***************************************************************** 05470000
038300     EXEC SQL                                                     05480000
038400         DECLARE RFID_CURSOR CURSOR FOR                           05490000
038500         SELECT                                                   05500000
038600                 C.UPC_NBR                                        05510000
038700              ,  C.SCN_TMST                                       05520000
038800              ,  C.VILN_GP_SEQ_NBR                                05530000
                    ,  SUM(SCND_UNT_QTY)                                05540000
                    ,  SUM(RFID_TGD_QTY)                                05550000
039000         FROM                                                     05560000
039100                TSUATRN A                                         05570000
039200             ,  TSUAUPC B                                         05580000
039300             ,  TSUEXCP C                                         05590000
039400         WHERE                                                    05600000
039500             A.AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR                05610000
039600         AND A.DEST_OPER_UNT_ID = :DK-STORE-NBR                   05620000
039700         AND A.TRN_NBR          = :DK-PO-NBR                      05630000
039800         AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR                 05640000
039900         AND A.AUD_CNTL_NBR     = B.AUD_CNTL_NBR                  05650000
040000         AND A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID                  05660000
040100         AND B.AUD_CNTL_NBR     = C.AUD_CNTL_NBR                  05670000
040200         AND B.SHIPT_UNT_ID     = C.SHIPT_UNT_ID                  05680000
040300         AND B.UPC_NBR          = C.UPC_NBR                       05690000
040400         AND B.SCN_TMST         = C.SCN_TMST                      05700000
               AND C.SCN_TMST         >= A.UNT_AUD_STRT_TMST            05710000
040500         AND B.SCN_TYP_CDE     <> :PC-E                           05720000
040600         AND C.VILN_GP_SEQ_NBR IN  (                              05730000
040800              :PC-RFID-UPC-MISPCK                                 05740000
040800             ,:PC-RFID-TKT-CLR                                    05750000
040900             ,:PC-RFID-TKT-SIZE                                   05760000
041000             ,:PC-RFID-TKT-STYLE)                                 05770000
042800        GROUP BY C.VILN_GP_SEQ_NBR                                05780000
042900              ,  C.UPC_NBR                                        05790000
043000              ,  C.SCN_TMST                                       05800000
                                                                        05810000
                                                                        05820000
              UNION                                                     05830000
                                                                        05840000
038500        (SELECT                                                   05850000
038600                 C.UPC_NBR                                        05860000
038700              ,  C.SCN_TMST                                       05870000
038800              ,  C.VILN_GP_SEQ_NBR                                05880000
                    ,  SUM(SCND_UNT_QTY)                                05890000
                    ,  SUM(RFID_TGD_QTY)                                05900000
039000         FROM                                                     05910000
039100                TSUATRN A                                         05920000
039200             ,  TSUAUPC B                                         05930000
039300             ,  TSUEXCP C                                         05940000
039400         WHERE                                                    05950000
039500             A.AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR                05960000
039600         AND A.DEST_OPER_UNT_ID = :DK-STORE-NBR                   05970000
039700         AND A.TRN_NBR          = :DK-PO-NBR                      05980000
039800         AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR                 05990000
039900         AND A.AUD_CNTL_NBR     = B.AUD_CNTL_NBR                  06000000
040000         AND A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID                  06010000
040100         AND B.AUD_CNTL_NBR     = C.AUD_CNTL_NBR                  06020000
040200         AND B.SHIPT_UNT_ID     = C.SHIPT_UNT_ID                  06030000
040300         AND B.UPC_NBR          = C.UPC_NBR                       06040000
040400         AND B.SCN_TMST         = C.SCN_TMST                      06050000
               AND C.SCN_TMST         >= A.UNT_AUD_STRT_TMST            06060000
040500         AND B.SCN_TYP_CDE      = :PC-E                           06070000
040600         AND C.VILN_GP_SEQ_NBR  = :PC-RFID-NO-TICKET              06080000
042800        GROUP BY C.VILN_GP_SEQ_NBR                                06090000
042900              ,  C.UPC_NBR                                        06100000
043000              ,  C.SCN_TMST                                       06110000
                )                                                       06120000
043100     END-EXEC.                                                    06130000
      *SB 11/19/13 - END PR#5148D                                       06140000
043200 EJECT                                                            06150000
043300                                                                  06160000
043400* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 06170000
043500 PROCEDURE DIVISION.                                              06180000
043600* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 06190000
043700                                                                  06200000
043800******************************************************************06210000
043900*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    06220000
044000******************************************************************06230000
044100 0000-PROGRAM-MAINLINE.                                           06240000
044200                                                                  06250000
044300     PERFORM 1000-INITIALIZE.                                     06260000
044400                                                                  06270000
044500     PERFORM 2000-CREATE-FILE                                     06280000
044600         UNTIL PS-EOF-VND-OVER-SHORT                              06290000
044700           AND PS-EOF-RCVR-OVER-SHORT                             06300000
044800                                                                  06310000
044900     PERFORM 9000-EOJ-ROUTINE.                                    06320000
045000     STOP RUN.                                                    06330000
045100*0000-EXIT.                                                       06340000
045200                                                                  06350000
045300******************************************************************06360000
045400*  1000-INITIALIZE                                                06370000
045500*       - ACCEPTS, EDITS, AND DISPLAYS THE CONTROL CARD.          06380000
045600*       - OPEN ALL INPUT/OUTPUT FILES                             06390000
045700*       - SELECT ALL HEADER INFORMATION                           06400000
045800******************************************************************06410000
045900 1000-INITIALIZE.                                                 06420000
046000                                                                  06430000
046100     INITIALIZE SU005-EXTRACT-RECORD.                             06440000
046200                                                                  06450000
046300     SET SU005-PBS-AUDIT           TO TRUE.                       06460000
      *SB 11/19/13 - BEGIN PR#5148D                                     06470000
           SET PS-NOT-END-OF-CARDIN-FILE TO TRUE.                       06480000
      *SB 11/19/13 - END PR#5148D                                       06490000
046400**                                                                06500000
046500     OPEN INPUT  OS-VND-OVER-SHORT-FILE                           06510000
046600                 OS-RCVR-OVER-SHORT-FILE                          06520000
      *SB 11/19/13 - BEGIN PR#5148D                                     06530000
                       CARDIN-AUDIT-NBR-FILE                            06540000
      *SB 11/19/13 - END PR#5148D                                       06550000
046700          OUTPUT AS-AUDIT-SUM-EXTRACT-FILE                        06560000
046800                                                                  06570000
046900     SET  PS-NOT-EOF-VND-OVER-SHORT        TO TRUE.               06580000
047000     SET  PS-NOT-EOF-RCVR-OVER-SHORT       TO TRUE.               06590000
047100                                                                  06600000
047200     PERFORM 8000-READ-VND-OVER-SHORT.                            06610000
047300     PERFORM 8001-READ-RCVR-OVER-SHORT.                           06620000
      *SB 11/19/13 - BEGIN PR#5148D                                     06630000
           PERFORM 8200-READ-CARDIN-FILE.                               06640000
           IF PS-END-OF-CARDIN-FILE                                     06650000
              DISPLAY '** SUKUT012 ABEND **'                            06660000
              DISPLAY '** CARDIN (AUDIT NUMBER) FILE IS EMPTY **'       06670000
              MOVE +4019                  TO PV-ABEND-CODE              06680000
              CALL 'ILBOABN0' USING PV-ABEND-CODE                       06690000
           END-IF.                                                      06700000
      *SB 11/19/13 - END PR#5148D                                       06710000
047400                                                                  06720000
047500                                                                  06730000
047600******************************************************************06740000
047700* 2000-CREATE-FILE -- THE OVER/SHORT INPUT FILES ARE SORTED/SUMMED06750000
047800*   BY AUDIT/RECEIVER/STORE NUMBER.  FOR EACH STORE, FILL IN THE  06760000
047900*   VENDOR AND/OR RECEIVER OVER/SHORT (2001 WILL DETERMINE IF BOTH06770000
048000*   ARE CREATED OR JUST ONE -- DEPENDS IF THERE IS A MATCHING     06780000
048100*   RECORD ON BOTH FILES) AND DETERMINE IF THERE WERE ANY OTHER   06790000
048200*   PICKING ERRORS TO RECORD.  WRITE THE CURRENT RECORD TO THE    06800000
048300*   EXTRACT FILE (WHICH WILL BE THE PICKING TYPE) AND THEN        06810000
048400*   DETERMINE IF THERE ARE ANY TICKETING ERRORS, AND WRITE THE    06820000
048500*   CURRENT RECORD TO THE EXRACT FILE (WHICH WILL BE THE TICKETING06830000
048600*   TYPE).                                                        06840000
048700******************************************************************06850000
048800 2000-CREATE-FILE.                                                06860000
048900                                                                  06870000
049000*    -DETERMINE WHICH FILE IS CURRENT                             06880000
049100     PERFORM 2001-SET-UP-HOLD-FIELDS.                             06890000
049200                                                                  06900000
049300*    -GET THE TOTAL UNITS TRANSRIBED FOR THIS STORE               06910000
049400     PERFORM 2300-GET-UNITS-TRNSCRBD.                             06920000
049500                                                                  06930000
049600*    -GET THE TOTAL UNITS AUDITED FOR THIS STORE                  06940000
049700     PERFORM 2400-GET-UNITS-AUDITED.                              06950000
049800                                                                  06960000
049900*    -CREATE THE PICKING RECORD (INCLUDING OVER/SHORT AMTS)       06970000
050000*    -READS OF THE OVER/SHORT FILES ARE DONE HERE...              06980000
050100     PERFORM 2100-SET-UP-PICKING-RECORD                           06990000
           IF (CC-MANUAL-GENERATED-AUDIT AND                            07000000
              (CC-QC-AUD-ONLY OR CC-QC-AND-RFID-AUD)) OR                07010000
              (CC-SYSTEM-GENERATED-AUDIT AND CC-QC-AUDIT)               07020000
050200        PERFORM 8100-WRITE-EXTRACT-FILE                           07030000
050300                                                                  07040000
050400*    -CREATE THE TICKETING RECORD                                 07050000
050500        PERFORM 2200-SET-UP-TICKETING-RECORD                      07060000
050600        PERFORM 8100-WRITE-EXTRACT-FILE                           07070000
           END-IF.                                                      07080000
050700                                                                  07090000
      *SB 11/19/13 - BEGIN PR#5148D                                     07100000
050400*    -CREATE THE RFID RECORD                                      07110000
           IF (CC-MANUAL-GENERATED-AUDIT AND                            07120000
              (CC-RFID-AUD-ONLY OR CC-QC-AND-RFID-AUD)) OR              07130000
              (CC-SYSTEM-GENERATED-AUDIT AND CC-RFID-AUDIT)             07140000
050500        PERFORM 2250-SET-UP-RFID-RECORD                           07150000
050600        PERFORM 8100-WRITE-EXTRACT-FILE                           07160000
           END-IF.                                                      07170000
      *SB 11/19/13 - END PR#5148D                                       07180000
050700                                                                  07190000
050800                                                                  07200000
050900******************************************************************07210000
051000* 2001-SET-UP-HOLD-FIELDS.                                       *07220000
051100* PROCESS:  THIS PARAGRAPH WILL SET-UP THE HOLD FIELDS WITH THE  *07230000
051200* KEY DATA FROM THE FILE WITH THE SMALLEST VALUES                *07240000
051300******************************************************************07250000
051400 2001-SET-UP-HOLD-FIELDS.                                         07260000
051500                                                                  07270000
051600     EVALUATE TRUE                                                07280000
051700*      MOVE THE SMALLER AUDIT RECORD TO THE HOLD FIELDS           07290000
051800       WHEN SU003-AUD-CNTL-NBR <  SU004-AUD-CNTL-NBR              07300000
051900          PERFORM 2003-MOVE-VND-OS-FIELDS                         07310000
052000          SET PS-USE-VND-OS-ONLY      TO TRUE                     07320000
052100                                                                  07330000
052200       WHEN SU003-AUD-CNTL-NBR >  SU004-AUD-CNTL-NBR              07340000
052300          PERFORM 2004-MOVE-RCVR-OS-FIELDS                        07350000
052400          SET PS-USE-RCVR-OS-ONLY     TO TRUE                     07360000
052500                                                                  07370000
052600* -OR- MOVE THE SMALLER PO RECORD TO THE HOLD FIELDS              07380000
052700       WHEN SU003-PO-NBR < SU004-PO-NBR                           07390000
052800          PERFORM 2003-MOVE-VND-OS-FIELDS                         07400000
052900          SET PS-USE-VND-OS-ONLY      TO TRUE                     07410000
053000                                                                  07420000
053100       WHEN SU003-PO-NBR > SU004-PO-NBR                           07430000
053200          PERFORM 2004-MOVE-RCVR-OS-FIELDS                        07440000
053300          SET PS-USE-RCVR-OS-ONLY     TO TRUE                     07450000
053400                                                                  07460000
053500* -OR- MOVE THE SMALLER RECEVIER RECORD TO THE HOLD FIELDS        07470000
053600       WHEN SU003-REC-SEQ-NBR < SU004-REC-SEQ-NBR                 07480000
053700          PERFORM 2003-MOVE-VND-OS-FIELDS                         07490000
053800          SET PS-USE-VND-OS-ONLY      TO TRUE                     07500000
053900                                                                  07510000
054000       WHEN SU003-REC-SEQ-NBR > SU004-REC-SEQ-NBR                 07520000
054100          PERFORM 2004-MOVE-RCVR-OS-FIELDS                        07530000
054200          SET PS-USE-RCVR-OS-ONLY     TO TRUE                     07540000
054300                                                                  07550000
054400* -OR- MOVE THE SMALLER STORE RECORD TO THE HOLD FIELDS           07560000
054500       WHEN SU003-DEST-OPER-UNT-ID < SU004-DEST-OPER-UNT-ID       07570000
054600          PERFORM 2003-MOVE-VND-OS-FIELDS                         07580000
054700          SET PS-USE-VND-OS-ONLY      TO TRUE                     07590000
054800                                                                  07600000
054900       WHEN SU003-DEST-OPER-UNT-ID > SU004-DEST-OPER-UNT-ID       07610000
055000          PERFORM 2004-MOVE-RCVR-OS-FIELDS                        07620000
055100          SET PS-USE-RCVR-OS-ONLY     TO TRUE                     07630000
055200                                                                  07640000
055300* -OR- IF THE SAME RECORD, MOVE EITHER -- IT DOSEN'T MATTER       07650000
055400       WHEN OTHER                                                 07660000
055500          PERFORM 2003-MOVE-VND-OS-FIELDS                         07670000
055600          SET PS-USE-BOTH-FILES       TO TRUE                     07680000
055700     END-EVALUATE.                                                07690000
055800                                                                  07700000
055900                                                                  07710000
056000******************************************************************07720000
056100* 2003-MOVE-VND-OS-FIELDS.                                       *07730000
056200******************************************************************07740000
056300 2003-MOVE-VND-OS-FIELDS.                                         07750000
056400     MOVE SU003-AUD-CNTL-NBR        TO PV-HOLD-AUD-CNTL-NBR.      07760000
056500     MOVE SU003-PO-NBR              TO PV-HOLD-PO-NBR.            07770000
056600     MOVE SU003-REC-SEQ-NBR         TO PV-HOLD-REC-SEQ-NBR.       07780000
056700     MOVE SU003-DEST-OPER-UNT-ID    TO PV-HOLD-STORE-NBR.         07790000
056800                                                                  07800000
056900                                                                  07810000
057000******************************************************************07820000
057100* 2004-MOVE-RCVR-OS-FIELDS.                                      *07830000
057200******************************************************************07840000
057300 2004-MOVE-RCVR-OS-FIELDS.                                        07850000
057400     MOVE SU004-AUD-CNTL-NBR        TO PV-HOLD-AUD-CNTL-NBR.      07860000
057500     MOVE SU004-PO-NBR              TO PV-HOLD-PO-NBR.            07870000
057600     MOVE SU004-REC-SEQ-NBR         TO PV-HOLD-REC-SEQ-NBR.       07880000
057700     MOVE SU004-DEST-OPER-UNT-ID    TO PV-HOLD-STORE-NBR.         07890000
057800                                                                  07900000
057900                                                                  07910000
058000******************************************************************07920000
058100* 2100-SET-UP-PICKING RECORD.                                    *07930000
058200* PROCESS:  CHECK IF APPLICBLE OVER/SHORT ERRORS EXISTS...IF SO, *07940000
058300* SET-UP FIELDS, AND CHECK FOR ANY OTHER PICKING ERROR BEFORE    *07950000
058400* WRITING TO A FILE.                                             *07960000
058500******************************************************************07970000
058600 2100-SET-UP-PICKING-RECORD.                                      07980000
058700                                                                  07990000
058800     INITIALIZE SU005-PICKING-ERROR-RECORD                        08000000
058900                SU005-TOT-UNITS-IN-ERROR.                         08010000
059000     SET SU005-PICKING-ERRORS           TO TRUE.                  08020000
059100                                                                  08030000
059200     MOVE PV-HOLD-AUD-CNTL-NBR          TO SU005-AUD-CNTL-NBR.    08040000
059300     MOVE PV-HOLD-PO-NBR                TO SU005-PO-NBR.          08050000
059400     MOVE PV-HOLD-REC-SEQ-NBR           TO SU005-REC-SEQ-NBR.     08060000
059500     MOVE PV-HOLD-STORE-NBR             TO SU005-DEST-OPER-UNT-ID.08070000
059600                                                                  08080000
059700*    IF THE CURRENT RECORD IS ONLY FROM THE VENDOR OVER/SHORT FILE08090000
059800*    OR IF THERE ARE MATCHING RECORDS ON BOTH FILES...            08100000
059900     IF PS-USE-VND-OS-ONLY OR PS-USE-BOTH-FILES                   08110000
060000                                                                  08120000
060100*      ..ACCUMULATE THE OVER/SHORT UNTIL A NEW KEY OR END OF FILE 08130000
060200**                                                                08140000
060300*      LOOP WILL SPIN THROUGH EACH SKU WITHIN EACH CARTON FOR THE 08150000
060400*      CURRENT STORE.  THIS IS NEEDED BECAUSE AND ITEM COULD BE   08160000
060500*      IN TWO DIFFERENT CARTONS, AND COULD BE SHORT ONE IN THE 1ST08170000
060600*      CARTON, AND OVER ON IN THE 2ND.  COMBINED WE GOT ALL THE   08180000
060700*      ITEMS WE NEED, BUT AT THE CARTON LEVEL, THERE IS 1 OVER AND08190000
060800*      1 SHORT -- THESE ERRORS NEED TO BE REPORTED.               08200000
060900       PERFORM UNTIL SU003-AUD-CNTL-NBR > PV-HOLD-AUD-CNTL-NBR    08210000
061000           OR  SU003-PO-NBR           > PV-HOLD-PO-NBR            08220000
061100           OR  SU003-REC-SEQ-NBR      > PV-HOLD-REC-SEQ-NBR       08230000
061200           OR  SU003-DEST-OPER-UNT-ID > PV-HOLD-STORE-NBR         08240000
061300           OR  PS-EOF-VND-OVER-SHORT                              08250000
061400                                                                  08260000
061500*        IF THE QUANTITY AUDITED IS MORE THAN EXPECTED, ADD THE   08270000
061600*        DIFFERENCE TO THE "OVER" BUCKET                          08280000
061700         IF SU003-QTY-EXP < SU003-QTY-AUD                         08290000
061800*            ACCULULATE VENDOR-OVER FIELD                         08300000
061900             MOVE 'SU005-VENDOR-OVER'     TO PV-FIELD-NAME        08310000
062000             COMPUTE SU005-VENDOR-OVER =                          08320000
062100                   ( SU005-VENDOR-OVER +                          08330000
062200                   ( SU003-QTY-AUD - SU003-QTY-EXP))              08340000
062300             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      08350000
062400             END-COMPUTE                                          08360000
062500                                                                  08370000
062600*            ... AND ADD THE QUANTITY TO THE TOTAL ERROR FIELD    08380000
062700             MOVE 'SU005-TOT-PIC-ERR'     TO PV-FIELD-NAME        08390000
062800             COMPUTE SU005-TOT-PIC-ERR =                          08400000
062900                   ( SU005-TOT-PIC-ERR +                          08410000
063000                   ( SU003-QTY-AUD - SU003-QTY-EXP))              08420000
063100             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      08430000
063200             END-COMPUTE                                          08440000
063300         END-IF                                                   08450000
063400                                                                  08460000
063500*        IF A VENDOR SHORTAGE...                                  08470000
063600         IF SU003-QTY-EXP > SU003-QTY-AUD                         08480000
063700*            ... SETUP VENDOR-SHORT FIELD                         08490000
063800             MOVE 'SU005-VENDOR-SHORT'    TO PV-FIELD-NAME        08500000
063900             COMPUTE SU005-VENDOR-SHORT =                         08510000
064000                   ( SU005-VENDOR-SHORT +                         08520000
064100                   ( SU003-QTY-EXP - SU003-QTY-AUD ))             08530000
064200             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      08540000
064300             END-COMPUTE                                          08550000
064400                                                                  08560000
064500*            ... AND ADD THE QUANTITY TO THE TOTAL ERROR FIELD    08570000
064600             MOVE 'SU005-TOT-PIC-ERR'     TO PV-FIELD-NAME        08580000
064700             COMPUTE SU005-TOT-PIC-ERR =                          08590000
064800                   ( SU005-TOT-PIC-ERR +                          08600000
064900                   ( SU003-QTY-EXP - SU003-QTY-AUD ))             08610000
065000             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      08620000
065100             END-COMPUTE                                          08630000
065200         END-IF                                                   08640000
065300                                                                  08650000
065400*        AND ADD THE UNITS IN ERROR QUANTITY TO THE UNITS         08660000
065500*        IN ERROR FIELDS                                          08670000
065600         MOVE 'SU005-TOT-UNITS-IN-PIC-ERR'                        08680000
065700                                          TO PV-FIELD-NAME        08690000
065800         COMPUTE SU005-TOT-UNITS-IN-PIC-ERR =                     08700000
065900                 SU005-TOT-UNITS-IN-PIC-ERR +                     08710000
066000                 SU003-PICK-ERR-CNT                               08720000
066100         ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR          08730000
066200         END-COMPUTE                                              08740000
066300                                                                  08750000
066400         MOVE 'SU005-TOT-UNITS-IN-ERROR'                          08760000
066500                                          TO PV-FIELD-NAME        08770000
066600         COMPUTE SU005-TOT-UNITS-IN-ERROR   =                     08780000
066700                 SU005-TOT-UNITS-IN-ERROR   +                     08790000
066800                 SU003-UNT-ERR-CNT-COMBO                          08800000
066900         ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR          08810000
067000         END-COMPUTE                                              08820000
067100                                                                  08830000
067200*        READ THE NEXT VENDOR OVER/SHORT RECORD                   08840000
067300         PERFORM 8000-READ-VND-OVER-SHORT                         08850000
067400       END-PERFORM                                                08860000
067500     END-IF.                                                      08870000
067600                                                                  08880000
067700                                                                  08890000
067800*    IF THE CURRENT RECORD IS ONLY FROM THE RECEIVER OVER/SORT    08900000
067900*    FILE, OR IF THERE ARE MATCHING RECORDS ON BOTH FILES, CHECK  08910000
068000*    TO SEE IF THERE IS AN OVERAGE, OR A SHORTAGE                 08920000
068100     IF PS-USE-RCVR-OS-ONLY OR PS-USE-BOTH-FILES                  08930000
068200                                                                  08940000
068300*      ..ACCUMULATE THE OVER/SHORT UNTIL A NEW KEY OR END OF FILE 08950000
068400*                                                                 08960000
068500*      THIS SECTION WILL SPIN THROUGH EACH SKU THAT SHOULD BE ON  08970000
068600*      THIS RECEIVER FOR THIS STORE.  THIS IS NEEDED BECAUSE THE  08980000
068700*      STORE COULD BE OVER WITH ONE SKU, AND UNDER WITH ANOTHER.  08990000
068800*      TOGETHER WE GOT THE CORRECT NUMBER, BUT IT SHOULD BE       09000000
068900*      REPORTED AS 1 OVER AND 1 SHORT.                            09010000
069000       PERFORM UNTIL SU004-AUD-CNTL-NBR > PV-HOLD-AUD-CNTL-NBR    09020000
069100           OR  SU004-PO-NBR           > PV-HOLD-PO-NBR            09030000
069200           OR  SU004-REC-SEQ-NBR      > PV-HOLD-REC-SEQ-NBR       09040000
069300           OR  SU004-DEST-OPER-UNT-ID > PV-HOLD-STORE-NBR         09050000
069400           OR  PS-EOF-RCVR-OVER-SHORT                             09060000
069500                                                                  09070000
069600*        IF THE QUANTITY AUDITED IS MORE THAN RECEIVED, IT IS     09080000
069700*        AN OVERAGE (IF THE EXPECTED IS 0, THEN CHECK TO SEE IF A 09090000
069800*        STYLE SUB HAS ALREADY BEEN CREATED...SKIP IF SO          09100000
069900         IF SU004-QTY-RECV < SU004-QTY-AUD                        09110000
070000             SET PS-CREATE-OVER               TO TRUE             09120000
070100             IF SU004-QTY-RECV > 0                                09130000
070200                 PERFORM 2150-CHECK-FOR-STYLE-SUB                 09140000
070300             END-IF                                               09150000
070400                                                                  09160000
070500             IF PS-CREATE-OVER                                    09170000
070600*            ... SETUP RECEIVER-OVERAGE-FIELD                     09180000
070700                 MOVE 'SU005-RECEIVER-OVER'   TO PV-FIELD-NAME    09190000
070800                 COMPUTE SU005-RECEIVER-OVER =                    09200000
070900                       ( SU005-RECEIVER-OVER +                    09210000
071000                       ( SU004-QTY-AUD - SU004-QTY-RECV ) )       09220000
071100                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  09230000
071200                 END-COMPUTE                                      09240000
071300                                                                  09250000
071400*            ... AND ADD THE QUANTITY TO THE TOTAL ERROR FIELD    09260000
071500                 MOVE 'SU005-TOT-PIC-ERR'     TO PV-FIELD-NAME    09270000
071600                 COMPUTE SU005-TOT-PIC-ERR =                      09280000
071700                       ( SU005-TOT-PIC-ERR +                      09290000
071800                       ( SU004-QTY-AUD - SU004-QTY-RECV ))        09300000
071900                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  09310000
072000                 END-COMPUTE                                      09320000
072100                                                                  09330000
072200             END-IF                                               09340000
072300         END-IF                                                   09350000
072400                                                                  09360000
072500*        IF A RECEIVER SHORTAGE                                   09370000
072600         IF SU004-QTY-RECV > SU004-QTY-AUD                        09380000
072700*            ... SETUP RECEIVER-SHORTAGE-FIELD                    09390000
072800             MOVE 'SU005-RECEIVER-SHORT'   TO PV-FIELD-NAME       09400000
072900             COMPUTE SU005-RECEIVER-SHORT =                       09410000
073000                   ( SU005-RECEIVER-SHORT +                       09420000
073100                   ( SU004-QTY-RECV - SU004-QTY-AUD ))            09430000
073200             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      09440000
073300             END-COMPUTE                                          09450000
073400                                                                  09460000
073500*            ... AND ADD THE QUANTITY TO THE TOTAL ERROR FIELD    09470000
073600             MOVE 'SU005-TOT-PIC-ERR'     TO PV-FIELD-NAME        09480000
073700             COMPUTE SU005-TOT-PIC-ERR =                          09490000
073800                   ( SU005-TOT-PIC-ERR +                          09500000
073900                   ( SU004-QTY-RECV - SU004-QTY-AUD ))            09510000
074000             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      09520000
074100             END-COMPUTE                                          09530000
074200         END-IF                                                   09540000
074300                                                                  09550000
074400*        ADD THE QUANTITY TO THE TOTAL UNITS IN ERROR FIELD       09560000
074500         MOVE 'SU005-TOT-UNITS-IN-PIC-ERR'                        09570000
074600                                      TO PV-FIELD-NAME            09580000
074700         COMPUTE SU005-TOT-UNITS-IN-PIC-ERR =                     09590000
074800                 SU005-TOT-UNITS-IN-PIC-ERR +                     09600000
074900                 SU004-PICK-ERR-CNT                               09610000
075000         ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR          09620000
075100         END-COMPUTE                                              09630000
075200                                                                  09640000
075300         MOVE 'SU005-TOT-UNITS-IN-ERROR'                          09650000
075400                                          TO PV-FIELD-NAME        09660000
075500         COMPUTE SU005-TOT-UNITS-IN-ERROR   =                     09670000
075600                 SU005-TOT-UNITS-IN-ERROR   +                     09680000
075700                 SU004-UNT-ERR-CNT-COMBO                          09690000
075800         ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR          09700000
075900         END-COMPUTE                                              09710000
076000                                                                  09720000
076100*        READ THE NEXT RECEIVER OVER/SHORT RECORD                 09730000
076200         PERFORM 8001-READ-RCVR-OVER-SHORT                        09740000
076300       END-PERFORM                                                09750000
076400     END-IF.                                                      09760000
076500                                                                  09770000
076600*    CHECK FOR ANY OTHER PICKING EXCEPTIONS                       09780000
076700     PERFORM 3000-CHECK-PICKING-ERRORS.                           09790000
076800                                                                  09800000
076900                                                                  09810000
077000******************************************************************09820000
077100* 2150-CHECK-FOR-STYLE-SUB.                                      *09830000
077200* PROCESS:  CHECK TO SEE IF THIS SCAN PRODUCED A STYLE SUB ERROR *09840000
077300******************************************************************09850000
077400 2150-CHECK-FOR-STYLE-SUB.                                        09860000
077500                                                                  09870000
077600     MOVE SU004-AUD-CNTL-NBR      TO DK-AUD-CNTL-NBR.             09880000
077700     MOVE SU004-SCN-TMST          TO DK-SCAN-TMST.                09890000
077800     MOVE SU004-SKU-NMBR          TO DK-SKU-NBR.                  09900000
077900                                                                  09910000
077910*----------------------------------------------------------------*09920000
077920*                                               **   WR # 21361  *09930000
077940* ADDED CODE TO CALL XLKUT001                                    *09940000
077941* SQL STATEMENT CHANGED TO ADD XL001-UPC-NBR IN THE WHERE CLAUSE.*09950000
077950*----------------------------------------------------------------*09960000
077960     IF DK-SKU-NBR >= 0                                           09970000
077970        PERFORM 2160-CALL-XLKUT-DOMAIN-PGM                        09980000
077980     ELSE                                                         09990000
077990        PERFORM 9999-SQL-ABEND.                                   10000000
080001                                                                  10010000
080010     EXEC SQL                                                     10020000
080020         SELECT                                                   10030000
080030               A.VILN_GP_SEQ_NBR                                  10040000
080040         INTO                                                     10050000
080050               :SUEXCP-VILN-GP-SEQ-NBR                            10060000
080060         FROM                                                     10070000
080070               TSUEXCP A                                          10080000
080091         WHERE                                                    10090000
080092               A.AUD_CNTL_NBR        = :DK-AUD-CNTL-NBR           10100000
080093           AND A.SHIPT_UNT_ID        >  0                         10110000
080094           AND A.UPC_NBR             = :XL001-UPC-NBR             10120000
080095           AND A.SCN_TMST            = :DK-SCAN-TMST              10130000
080096           AND A.VILN_GP_CDE         = 'VA'                       10140000
080097           AND A.VILN_GP_SEQ_NBR     IN (9, 10, 11)               10150000
080102     END-EXEC.                                                    10160000
080103*----------------------------------------------------------------*10170000
080104* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *10180000
080105*----------------------------------------------------------------*10190000
080110                                                                  10200000
080200     EVALUATE TRUE                                                10210000
080300         WHEN SQLCODE = ZERO                                      10220000
080400         WHEN SQLCODE = -811                                      10230000
080500            SET PS-DONT-CREATE-OVER   TO TRUE                     10240000
080600                                                                  10250000
080700         WHEN SQLCODE = +100                                      10260000
080800            SET PS-CREATE-OVER        TO TRUE                     10270000
080900                                                                  10280000
081000         WHEN SQLWARN0 NOT EQUAL SPACE                            10290000
081100         WHEN SQLCODE NOT EQUAL ZERO                              10300000
081200             DISPLAY 'DK-AUD-CNTL-NBR: '                          10310000
081300                     DK-AUD-CNTL-NBR                              10320000
081400             DISPLAY 'DK-SCAN-TMST: '                             10330000
081500                      DK-SCAN-TMST                                10340000
081600             DISPLAY 'DK-SKU-NBR: ' DK-SKU-NBR                    10350000
081700             MOVE '2150-CHECK-FOR-STYLE-SUB'                      10360000
081800                               TO  PV-PARAGRAPH-NAME              10370000
081900             PERFORM 9999-SQL-ABEND                               10380000
082000     END-EVALUATE.                                                10390000
082100                                                                  10400000
082200*----------------------------------------------------------------*10410000
082210*                                               **   WR # 21361  *10420000
082220* CODE FOR ACCESSING LOGISTICS DOMAIN ITEM ACCESS MODULE         *10430000
082230*----------------------------------------------------------------*10440000
082240 2160-CALL-XLKUT-DOMAIN-PGM.                                      10450000
082250                                                                  10460000
082260     INITIALIZE XL001-ITEM-COMMAREA                               10470000
082270     MOVE '7010-SELECT-SKU-BY-SKU'                                10480000
082280                               TO PV-ABEND-PARAGRAPH.             10490000
082290     MOVE DK-SKU-NBR           TO XL001-KEY-SKU.                  10500000
082292                                                                  10510000
082293     SET  XL001-SELECT-SKU                                        10520000
082294          XL001-SELECT-UPC                                        10530000
082295          XL001-BY-NUMERIC-SKU TO TRUE.                           10540000
082296                                                                  10550000
082297     CALL XL001-VSM-PGM USING  XL001-ITEM-COMMAREA.               10560000
082298                                                                  10570000
082299     EVALUATE TRUE                                                10580000
082300         WHEN XL001-SKU-CONTENTION                                10590000
082301              MOVE '2160-CALL-XLKUT-DOMAIN-PGM'                   10600000
082302                                     TO PV-ABEND-PARAGRAPH        10610000
082303              MOVE 'XL001-SKU-CONTENTION'                         10620000
082304                                     TO PV-ABEND-MESSAGE-TEXT     10630000
082305              MOVE XL001-SKU-SQLCODE TO PV-SQLCODE                10640000
082306              MOVE 'XLV_SKU'         TO PV-DB2-VIEW-NAME          10650000
082307              PERFORM 9200-PROCESS-ABEND                          10660000
082308         WHEN XL001-SKU-SQLCODE = +0                              10670000
082309              PERFORM 2165-SELECT-UPC                             10680000
082310         WHEN OTHER                                               10690000
082311              MOVE '2160-CALL-XLKUT-DOMAIN-PGM'                   10700000
082312                                     TO PV-ABEND-PARAGRAPH        10710000
082315              MOVE XL001-SKU-SQLCODE TO PV-SQLCODE                10720000
082316              MOVE 'XLV_SKU'         TO PV-DB2-VIEW-NAME          10730000
082317              PERFORM 9200-PROCESS-ABEND                          10740000
082318     END-EVALUATE.                                                10750000
082319* CODE ADDED TO RETRIEVE  UPC NUMBER - WR # 21361                 10760000
082320 2165-SELECT-UPC.                                                 10770000
082321     EVALUATE TRUE                                                10780000
082322         WHEN XL001-UPC-CONTENTION                                10790000
082323              MOVE '7300-SELECT-UPC'                              10800000
082324                                     TO PV-ABEND-PARAGRAPH        10810000
082325              MOVE 'XL001-UPC-CONTENTION'                         10820000
082326                                     TO PV-ABEND-MESSAGE-TEXT     10830000
082327              MOVE XL001-SKU-SQLCODE TO PV-SQLCODE                10840000
082328              MOVE 'XLV_UPC'         TO PV-DB2-VIEW-NAME          10850000
082329              PERFORM 9200-PROCESS-ABEND                          10860000
082330         WHEN XL001-UPC-SQLCODE = +0                              10870000
082331              CONTINUE                                            10880000
082332         WHEN OTHER                                               10890000
082333              MOVE '2160-CALL-XLKUT-DOMAIN-PGM'                   10900000
082334                                     TO PV-ABEND-PARAGRAPH        10910000
082335              MOVE XL001-SKU-SQLCODE TO PV-SQLCODE                10920000
082336              MOVE 'XLV_UPC'         TO PV-DB2-VIEW-NAME          10930000
082337              PERFORM 9200-PROCESS-ABEND                          10940000
082338     END-EVALUATE.                                                10950000
082339*----------------------------------------------------------------*10960000
082340* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *10970000
082341*----------------------------------------------------------------*10980000
082350******************************************************************10990000
082400* 2200-SET-UP-TICKETING-RECORD.                                  *11000000
082500* PROCESS:  SELECT ANY OTHER TICKETING ERRORS                     11010000
082600******************************************************************11020000
082700 2200-SET-UP-TICKETING-RECORD.                                    11030000
082800                                                                  11040000
082900     INITIALIZE SU005-TICKETING-ERROR-RECORD.                     11050000
083000     SET SU005-TICKETING-ERRORS         TO TRUE.                  11060000
083100                                                                  11070000
083200     MOVE PV-HOLD-AUD-CNTL-NBR          TO SU005-AUD-CNTL-NBR     11080000
083300     MOVE PV-HOLD-PO-NBR                TO SU005-PO-NBR           11090000
083400     MOVE PV-HOLD-REC-SEQ-NBR           TO SU005-REC-SEQ-NBR      11100000
083500     MOVE PV-HOLD-STORE-NBR             TO SU005-DEST-OPER-UNT-ID 11110000
083600                                                                  11120000
083700*    CHECK FOR ANY OTHER TICKETING-ERRORS                         11130000
083800     PERFORM 3100-CHECK-TICKETING-ERRORS.                         11140000
083900                                                                  11150000
      *SB 11/19/13 - BEGIN PR#5148D                                     11160000
082350******************************************************************11170000
082400* 2250-SET-UP-RFID-RECORD.                                       *11180000
082500* PROCESS:  SELECT ANY OTHER RFID ERRORS                          11190000
082600******************************************************************11200000
082700 2250-SET-UP-RFID-RECORD.                                         11210000
082800                                                                  11220000
082900     INITIALIZE SU005-RFID-ERROR-RECORD.                          11230000
083000     SET SU005-RFID-ERRORS         TO TRUE.                       11240000
083100                                                                  11250000
083200     MOVE PV-HOLD-AUD-CNTL-NBR          TO SU005-AUD-CNTL-NBR     11260000
083300     MOVE PV-HOLD-PO-NBR                TO SU005-PO-NBR           11270000
083400     MOVE PV-HOLD-REC-SEQ-NBR           TO SU005-REC-SEQ-NBR      11280000
083500     MOVE PV-HOLD-STORE-NBR             TO SU005-DEST-OPER-UNT-ID 11290000
083600                                                                  11300000
049600*    -GET THE TOTAL UNITS AUDITED FOR THIS STORE                  11310000
049700        PERFORM 2450-GET-UNITS-AUDITED.                           11320000
                                                                        11330000
083700*    CHECK FOR ANY OTHER RFID-ERRORS                              11340000
083800     PERFORM 3200-CHECK-RFID-ERRORS.                              11350000
      *SB 11/19/13 - END PR#5148D                                       11360000
083900                                                                  11370000
084000                                                                  11380000
084100******************************************************************11390000
084200* 2300-GET-UNITS-TRNSCRBD.                                       *11400000
084300*  THIS PROCEDURE WILL GET THE TOTAL NUMBER OF UNITS TRASNCRIBED *11410000
084400*  FOR THIS STORE/RECEIVER                                       *11420000
084500******************************************************************11430000
084600 2300-GET-UNITS-TRNSCRBD.                                         11440000
084700                                                                  11450000
084800     MOVE PV-HOLD-PO-NBR                TO DK-PO-NBR              11460000
084900     MOVE PV-HOLD-REC-SEQ-NBR           TO DK-REC-SEQ-NBR         11470000
085000     MOVE PV-HOLD-STORE-NBR             TO DK-STORE-NBR           11480000
085100                                                                  11490000
085200     EXEC SQL                                                     11500000
085300         SELECT                                                   11510000
085400               SUM(EXPTED_ITM_QTY)                                11520000
085500         INTO                                                     11530000
085600               :SU005-UNITS-TRNSCRBD                              11540000
085700         FROM                                                     11550000
085800               TRECDIS A                                          11560000
085900         WHERE                                                    11570000
086000               A.ORD_NBR        = :DK-PO-NBR                      11580000
086100           AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 11590000
086200           AND A.STR_NBR        = :DK-STORE-NBR                   11600000
086300           AND A.VER_STATUS_CDE = 'A'                             11610000
086400     END-EXEC.                                                    11620000
086500                                                                  11630000
086600     EVALUATE TRUE                                                11640000
086700         WHEN SQLCODE = ZERO                                      11650000
086800              CONTINUE                                            11660000
086900                                                                  11670000
087000         WHEN SQLCODE = +100                                      11680000
087100         WHEN SQLCODE = -305                                      11690000
087200              MOVE +0          TO SU005-UNITS-TRNSCRBD            11700000
087300                                                                  11710000
087400         WHEN SQLWARN0 NOT EQUAL SPACE                            11720000
087500         WHEN SQLCODE NOT EQUAL ZERO                              11730000
087600              MOVE '2300-GET-UNITS-TRNSCRBD'                      11740000
087700                               TO  PV-PARAGRAPH-NAME              11750000
087800              MOVE 'SELECT TRECDIS'                               11760000
087900                               TO  PV-DB2-OPERATION-ATTEMPTED     11770000
088000              DISPLAY 'PO NBR:       ' DK-PO-NBR                  11780000
088100              DISPLAY 'REC SEQ NBR:  ' DK-REC-SEQ-NBR             11790000
088200              DISPLAY 'STORE NBR:    ' DK-STORE-NBR               11800000
088300              PERFORM 9999-SQL-ABEND                              11810000
088400     END-EVALUATE.                                                11820000
088500                                                                  11830000
088600                                                                  11840000
088700******************************************************************11850000
088800* 2400-GET-UNITS-AUDITED.                                        *11860000
088900*  THIS PROCEDURE WILL GET THE TOTAL NUMBER OF UNITS AUDITED     *11870000
089000*  FOR THIS STORE/RECEIVER                                       *11880000
089100******************************************************************11890000
089200 2400-GET-UNITS-AUDITED.                                          11900000
089300                                                                  11910000
089400     MOVE PV-HOLD-AUD-CNTL-NBR          TO DK-AUD-CNTL-NBR        11920000
089500     MOVE PV-HOLD-PO-NBR                TO DK-PO-NBR              11930000
089600     MOVE PV-HOLD-REC-SEQ-NBR           TO DK-REC-SEQ-NBR         11940000
089700     MOVE PV-HOLD-STORE-NBR             TO DK-STORE-NBR           11950000
089800                                                                  11960000
089900     EXEC SQL                                                     11970000
090000         SELECT                                                   11980000
090100               SUM(SCND_UNT_QTY)                                  11990000
090200         INTO                                                     12000000
090300               :SU005-UNITS-AUDITED                               12010000
090400         FROM                                                     12020000
090500               TSUAUPC A                                          12030000
090600            ,  TSUATRN B                                          12040000
090700         WHERE                                                    12050000
090800               B.TRN_NBR           = :DK-PO-NBR                   12060000
090900           AND B.REC_SEQ_NBR       = :DK-REC-SEQ-NBR              12070000
091000           AND B.DEST_OPER_UNT_ID  = :DK-STORE-NBR                12080000
091100           AND B.AUD_CNTL_NBR      = :DK-AUD-CNTL-NBR             12090000
091200           AND B.AUD_CNTL_NBR      = A.AUD_CNTL_NBR               12100000
091300           AND B.SHIPT_UNT_ID      = A.SHIPT_UNT_ID               12110000
091400           AND A.SCN_TYP_CDE      <> :PC-E                        12120000
091500     END-EXEC.                                                    12130000
091600                                                                  12140000
091700     EVALUATE TRUE                                                12150000
091800         WHEN SQLCODE = ZERO                                      12160000
091900              CONTINUE                                            12170000
092000                                                                  12180000
092100         WHEN SQLCODE = +100                                      12190000
092200         WHEN SQLCODE = -305                                      12200000
092300              MOVE +0          TO SU005-UNITS-AUDITED             12210000
092400                                                                  12220000
092500         WHEN SQLWARN0 NOT EQUAL SPACE                            12230000
092600         WHEN SQLCODE NOT EQUAL ZERO                              12240000
092700              MOVE '2400-GET-UNITS-AUDITED'                       12250000
092800                               TO  PV-PARAGRAPH-NAME              12260000
092900              MOVE 'SELECT FROM TSUATRN, TSUAUPC'                 12270000
093000                               TO  PV-DB2-OPERATION-ATTEMPTED     12280000
093100              DISPLAY 'PO NBR:      ' DK-PO-NBR                   12290000
093200              DISPLAY 'REC SEQ NBR: ' DK-REC-SEQ-NBR              12300000
093300              DISPLAY 'STORE NBR:   ' DK-STORE-NBR                12310000
093400              DISPLAY 'AUD CNTL NBR:' DK-AUD-CNTL-NBR             12320000
093500              PERFORM 9999-SQL-ABEND                              12330000
093600     END-EVALUATE.                                                12340000
093700*                                                                 12350000
      *SB 12/26/13 - BEGIN PR#5148D                                     12360000
093700*                                                                 12370000
088700******************************************************************12380000
088800* 2450-GET-UNITS-AUDITED.                                        *12390000
088900*  THIS PROCEDURE WILL GET THE TOTAL NUMBER OF UNITS AUDITED     *12400000
089000*  FOR THIS STORE/RECEIVER                                       *12410000
089100******************************************************************12420000
089200 2450-GET-UNITS-AUDITED.                                          12430000
089300                                                                  12440000
089400     MOVE PV-HOLD-AUD-CNTL-NBR          TO DK-AUD-CNTL-NBR        12450000
089500     MOVE PV-HOLD-PO-NBR                TO DK-PO-NBR              12460000
089600     MOVE PV-HOLD-REC-SEQ-NBR           TO DK-REC-SEQ-NBR         12470000
089700     MOVE PV-HOLD-STORE-NBR             TO DK-STORE-NBR           12480000
089800                                                                  12490000
089900     EXEC SQL                                                     12500000
090000         SELECT                                                   12510000
090100               SUM(RFID_TGD_QTY)                                  12520000
090200         INTO                                                     12530000
090300               :SU005-UNITS-AUDITED                               12540000
090400         FROM                                                     12550000
090500               TSUAUPC A                                          12560000
090600            ,  TSUATRN B                                          12570000
090700         WHERE                                                    12580000
090800               B.TRN_NBR           = :DK-PO-NBR                   12590000
090900           AND B.REC_SEQ_NBR       = :DK-REC-SEQ-NBR              12600000
091000           AND B.DEST_OPER_UNT_ID  = :DK-STORE-NBR                12610000
091100           AND B.AUD_CNTL_NBR      = :DK-AUD-CNTL-NBR             12620000
091200           AND B.AUD_CNTL_NBR      = A.AUD_CNTL_NBR               12630000
091300           AND B.SHIPT_UNT_ID      = A.SHIPT_UNT_ID               12640000
091400           AND A.SCN_TYP_CDE      <> :PC-E                        12650000
091500     END-EXEC.                                                    12660000
091600                                                                  12670000
091700     EVALUATE TRUE                                                12680000
091800         WHEN SQLCODE = ZERO                                      12690000
091900              CONTINUE                                            12700000
092000                                                                  12710000
092100         WHEN SQLCODE = +100                                      12720000
092200         WHEN SQLCODE = -305                                      12730000
092300              MOVE +0          TO SU005-UNITS-AUDITED             12740000
092400                                                                  12750000
092500         WHEN SQLWARN0 NOT EQUAL SPACE                            12760000
092600         WHEN SQLCODE NOT EQUAL ZERO                              12770000
092700              MOVE '2450-GET-UNITS-AUDITED'                       12780000
092800                               TO  PV-PARAGRAPH-NAME              12790000
092900              MOVE 'SELECT FROM TSUATRN, TSUAUPC'                 12800000
093000                               TO  PV-DB2-OPERATION-ATTEMPTED     12810000
093100              DISPLAY 'PO NBR:      ' DK-PO-NBR                   12820000
093200              DISPLAY 'REC SEQ NBR: ' DK-REC-SEQ-NBR              12830000
093300              DISPLAY 'STORE NBR:   ' DK-STORE-NBR                12840000
093400              DISPLAY 'AUD CNTL NBR:' DK-AUD-CNTL-NBR             12850000
093500              PERFORM 9999-SQL-ABEND                              12860000
093600     END-EVALUATE.                                                12870000
                                                                        12880000
095300     EXEC SQL                                                     12890000
095400         SELECT SUM(SCND_UNT_QTY) - SUM(RFID_TGD_QTY)             12900000
095500         INTO  :PV-RFID-TGD-QTY                                   12910000
095600         FROM   TSUAUPC A                                         12920000
095600               ,TSUEXCP B                                         12930000
                     ,TSUATRN C                                         12940000
095700         WHERE                                                    12950000
                   C.TRN_NBR           = :DK-PO-NBR                     12960000
               AND C.REC_SEQ_NBR       = :DK-REC-SEQ-NBR                12970000
               AND C.DEST_OPER_UNT_ID  = :DK-STORE-NBR                  12980000
               AND C.AUD_CNTL_NBR      = :DK-AUD-CNTL-NBR               12990000
               AND C.AUD_CNTL_NBR      = A.AUD_CNTL_NBR                 13000000
               AND C.SHIPT_UNT_ID      = A.SHIPT_UNT_ID                 13010000
096000         AND A.SCN_TYP_CDE       = 'E'                            13020000
096000         AND A.SCN_TMST          = B.SCN_TMST                     13030000
               AND B.VILN_GP_CDE       = 'VA'                           13040000
096000         AND B.VILN_GP_SEQ_NBR   = 42                             13050000
095800         AND A.AUD_CNTL_NBR      = B.AUD_CNTL_NBR                 13060000
095900         AND A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID                 13070000
               AND B.SCN_TMST         >= C.UNT_AUD_STRT_TMST            13080000
096100     END-EXEC.                                                    13090000
                                                                        13100000
091700     EVALUATE TRUE                                                13110000
091800         WHEN SQLCODE = ZERO                                      13120000
091900              ADD PV-RFID-TGD-QTY TO SU005-UNITS-AUDITED          13130000
092100         WHEN SQLCODE = +100                                      13140000
092200         WHEN SQLCODE = -305                                      13150000
092300              CONTINUE                                            13160000
092400                                                                  13170000
092500         WHEN SQLWARN0 NOT EQUAL SPACE                            13180000
092600         WHEN SQLCODE NOT EQUAL ZERO                              13190000
092700              MOVE '2450-GET-UNITS-AUDITED'                       13200000
092800                               TO  PV-PARAGRAPH-NAME              13210000
092900              MOVE 'SELECT FROM TSUATRN, TSUAUPC, TSUEXCP'        13220000
093000                               TO  PV-DB2-OPERATION-ATTEMPTED     13230000
093100              DISPLAY 'PO NBR:      ' DK-PO-NBR                   13240000
093200              DISPLAY 'REC SEQ NBR: ' DK-REC-SEQ-NBR              13250000
093300              DISPLAY 'STORE NBR:   ' DK-STORE-NBR                13260000
093400              DISPLAY 'AUD CNTL NBR:' DK-AUD-CNTL-NBR             13270000
093500              PERFORM 9999-SQL-ABEND                              13280000
093600     END-EVALUATE.                                                13290000
      *SB 12/26/13 - END PR#5148D                                       13300000
093800******************************************************************13310000
093900* 3000-CHECK-PICKING-ERRORS.                                     *13320000
094000*  THIS PROCEDURE WILL GET ALL THE UNITS WITH PICKING EXCEPTIONS *13330000
094100*  AND ADD THE QUANTITY TO THE APPROPRIATE BUCKET ON THE OUTPUT  *13340000
094200*  FILE                                                          *13350000
094300******************************************************************13360000
094400 3000-CHECK-PICKING-ERRORS.                                       13370000
094500                                                                  13380000
094600     MOVE PV-HOLD-AUD-CNTL-NBR          TO DK-AUD-CNTL-NBR        13390000
094700     MOVE PV-HOLD-PO-NBR                TO DK-PO-NBR              13400000
094800     MOVE PV-HOLD-REC-SEQ-NBR           TO DK-REC-SEQ-NBR         13410000
094900     MOVE PV-HOLD-STORE-NBR             TO DK-STORE-NBR           13420000
095000     INITIALIZE PV-HOLD-TMST.                                     13430000
095100                                                                  13440000
095200     PERFORM 7000-OPEN-PICKING-CURSOR.                            13450000
095300     PERFORM 7020-FETCH-PICKING-CURSOR.                           13460000
095400                                                                  13470000
095500     PERFORM UNTIL PS-END-OF-PICKING-CURSOR                       13480000
095600*        ADD THE QUANTITY TO THE APPROPRIATE BUCKET               13490000
095700         EVALUATE SUEXCP-VILN-GP-SEQ-NBR                          13500000
095800           WHEN PC-STYLE-SUB-VILN                                 13510000
095900           WHEN PC-NO-DC-OTR-VILN                                 13520000
096000           WHEN PC-NO-PBS-ALLOC-VILN                              13530000
096100               MOVE 'SU005-STYLE-SUB'     TO PV-FIELD-NAME        13540000
096200               COMPUTE SU005-STYLE-SUB =                          13550000
096300                       SU005-STYLE-SUB + PV-DB2-COUNT             13560000
096400               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    13570000
096500               END-COMPUTE                                        13580000
096600                                                                  13590000
096700           WHEN PC-DMGD-MDSE-VILN                                 13600000
096800               MOVE 'SU005-DAMAGED-UNITS'  TO PV-FIELD-NAME       13610000
096900               COMPUTE SU005-DAMAGED-UNITS =                      13620000
097000                       SU005-DAMAGED-UNITS + PV-DB2-COUNT         13630000
097100               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    13640000
097200               END-COMPUTE                                        13650000
097300         END-EVALUATE                                             13660000
097400                                                                  13670000
097500*        INCREMENT THE TOTAL ERROR QUANTITY                       13680000
097600*        ADD +1                    TO SU005-TOT-PIC-ERR           13690000
097600         ADD PV-DB2-COUNT          TO SU005-TOT-PIC-ERR           13700000
097700                                                                  13710000
097800*        NOTHING IS DONE WITH THE UNITS IN ERROR FIELD...FOR P    13720000
097900*        PICKING ERRORS, THIS FIELDS IS CALCULATED ALREADY (FROM  13730000
098000*        THE OVER/SHORT PROCESSESSING THAT OCCURRED EARLIER IN    13740000
098100*        THE JOB.                                                 13750000
098200                                                                  13760000
098300         PERFORM 7020-FETCH-PICKING-CURSOR                        13770000
098400     END-PERFORM.                                                 13780000
098500                                                                  13790000
098600     PERFORM 7010-CLOSE-PICKING-CURSOR.                           13800000
098700*                                                                 13810000
098800                                                                  13820000
098900*                                                                 13830000
099000******************************************************************13840000
099100* 3100-CHECK-TICKETING-ERRORS.                                   *13850000
099200*  THIS PROCEDURE WILL GET ALL THE UNITS WITH TICKETING          *13860000
099300*  EXCEPTION AND ADD THE QUANTITY TO THE APPROPRIATE BUCKET       13870000
099400*  ON THE OUTPUT FILE.                                           *13880000
099500******************************************************************13890000
099600 3100-CHECK-TICKETING-ERRORS.                                     13900000
099700                                                                  13910000
099800     MOVE PV-HOLD-AUD-CNTL-NBR          TO DK-AUD-CNTL-NBR        13920000
099900     MOVE PV-HOLD-PO-NBR                TO DK-PO-NBR              13930000
100000     MOVE PV-HOLD-REC-SEQ-NBR           TO DK-REC-SEQ-NBR         13940000
100100     MOVE PV-HOLD-STORE-NBR             TO DK-STORE-NBR           13950000
100200     INITIALIZE PV-HOLD-TMST.                                     13960000
100300                                                                  13970000
100400     PERFORM 7100-OPEN-TICKETING-CURSOR.                          13980000
100500     PERFORM 7120-FETCH-TICKETING-CURSOR.                         13990000
100600                                                                  14000000
100700     PERFORM UNTIL PS-END-OF-TICKETING-CURSOR                     14010000
100800*    ADD THE QUANTITY TO THE APPROPRIATE BUCKET                   14020000
100900         EVALUATE SUEXCP-VILN-GP-SEQ-NBR                          14030000
101000           WHEN PC-NO-BARCODE-VILN                                14040000
101100               MOVE 'SU005-NO-BARCODE'     TO PV-FIELD-NAME       14050000
101200               COMPUTE SU005-NO-BARCODE =                         14060000
101300                       SU005-NO-BARCODE      + PV-DB2-COUNT       14070000
101400               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    14080000
101500               END-COMPUTE                                        14090000
101600                                                                  14100000
101700           WHEN PC-DMGD-BARCODE-VILN                              14110000
101800               MOVE 'SU005-DAMAGED-BARCODE' TO PV-FIELD-NAME      14120000
101900               COMPUTE SU005-DAMAGED-BARCODE =                    14130000
102000                       SU005-DAMAGED-BARCODE + PV-DB2-COUNT       14140000
102100               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    14150000
102200               END-COMPUTE                                        14160000
102300                                                                  14170000
102400           WHEN PC-NO-UPC-VILN                                    14180000
102500               MOVE 'SU005-NO-UPC'          TO PV-FIELD-NAME      14190000
102600               COMPUTE SU005-NO-UPC =                             14200000
102700                       SU005-NO-UPC          + PV-DB2-COUNT       14210000
102800               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    14220000
102900               END-COMPUTE                                        14230000
103000                                                                  14240000
103100           WHEN PC-UPC-NOT-FOUND-VILN                             14250000
103200               MOVE 'SU005-WRONG-UPC'       TO PV-FIELD-NAME      14260000
103300               COMPUTE SU005-WRONG-UPC =                          14270000
103400                       SU005-WRONG-UPC       + PV-DB2-COUNT       14280000
103500               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    14290000
103600               END-COMPUTE                                        14300000
103700                                                                  14310000
103800           WHEN PC-SKU-NOT-FOUND-VILN                             14320000
103900           WHEN PC-WRONG-DEPT-TKT-VILN                            14330000
104000           WHEN PC-WRONG-RETAIL-TKT-VILN                          14340000
104100           WHEN PC-WRONG-COLOR-TKT-VILN                           14350000
104200           WHEN PC-WRONG-SIZE-TKT-VILN                            14360000
104300           WHEN PC-WRONG-CLASS-TKT-VILN                           14370000
104400           WHEN PC-WRONG-SKU-TKT-VILN                             14380000
104500           WHEN PC-WRONG-STYLE-TKT-VILN                           14390000
104600           WHEN PC-WRONG-STYLE-MDSE-VILN                          14400000
104800           WHEN PC-WRG-TKT-MDSE-OK-VILN                           14410000
104800           WHEN PC-WRG-BOX-ID                                     14420000
104900           WHEN PC-NO-TAG-VILN                                    14430000
105000               MOVE 'SU005-WRONG-TICKET'    TO PV-FIELD-NAME      14440000
105100               COMPUTE SU005-WRONG-TICKET =                       14450000
105200                       SU005-WRONG-TICKET    + PV-DB2-COUNT       14460000
105300               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    14470000
105400               END-COMPUTE                                        14480000
105500                                                                  14490000
105600           WHEN PC-NO-TAG-TICKET-VILN                             14500000
105700               MOVE 'SU005-MISSING-TICKET'   TO PV-FIELD-NAME     14510000
105800               COMPUTE SU005-MISSING-TICKET =                     14520000
105900                       SU005-MISSING-TICKET  + PV-DB2-COUNT       14530000
106000               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    14540000
106100               END-COMPUTE                                        14550000
106200                                                                  14560000
106300           WHEN PC-WRONG-RETAIL-MDSE-VILN                         14570000
106400           WHEN PC-WRONG-COLOR-MDSE-VILN                          14580000
106500           WHEN PC-WRONG-SIZE-MDSE-VILN                           14590000
106600           WHEN PC-SIZE-STRIP-MDSE-VILN                           14600000
106700               MOVE 'SU005-WRONG-LABEL' TO PV-FIELD-NAME          14610000
106800               COMPUTE SU005-WRONG-LABEL =                        14620000
106900                       SU005-WRONG-LABEL +                        14630000
107000                       PV-DB2-COUNT                               14640000
107100               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    14650000
107200               END-COMPUTE                                        14660000
107300                                                                  14670000
107400         END-EVALUATE                                             14680000
107500                                                                  14690000
107600*        INCREMENT THE TOTAL TICKETING ERROR QUANTITY             14700000
107700*        ADD +1                    TO SU005-TOT-TIC-ERR           14710000
107700         ADD PV-DB2-COUNT          TO SU005-TOT-TIC-ERR           14720000
107800                                                                  14730000
107900*        IF THIS IS A NEW UNIT (DIFFERENT SCANS) INCREMENT THE    14740000
108000*        TOTAL UNITS IN TICKETING ERROR QUANTITY                  14750000
108100         IF SUEXCP-SCN-TMST NOT EQUAL PV-HOLD-TMST                14760000
108200*            ADD +1                TO SU005-TOT-UNITS-IN-TIC-ERR  14770000
108200             ADD PV-DB2-COUNT      TO SU005-TOT-UNITS-IN-TIC-ERR  14780000
108300             MOVE SUEXCP-SCN-TMST  TO PV-HOLD-TMST                14790000
108400         END-IF                                                   14800000
108500                                                                  14810000
108600         PERFORM 7120-FETCH-TICKETING-CURSOR                      14820000
108700     END-PERFORM.                                                 14830000
108800                                                                  14840000
108900     PERFORM 7110-CLOSE-TICKETING-CURSOR.                         14850000
109000*                                                                 14860000
      *SB 11/19/13 - BEGIN PR#5148D                                     14870000
098900*                                                                 14880000
099000******************************************************************14890000
099100* 3200-CHECK-RFID-ERRORS.                                        *14900000
099200*  THIS PROCEDURE WILL GET ALL THE UNITS WITH RFID EXCEPTION     *14910000
099300*  AND ADD THE QUANTITY TO THE APPROPRIATE BUCKET ON THE OUTPUT  *14920000
099400*  FILE.                                                         *14930000
099500******************************************************************14940000
099600 3200-CHECK-RFID-ERRORS.                                          14950000
099700                                                                  14960000
099800     MOVE PV-HOLD-AUD-CNTL-NBR          TO DK-AUD-CNTL-NBR        14970000
099900     MOVE PV-HOLD-PO-NBR                TO DK-PO-NBR              14980000
100000     MOVE PV-HOLD-REC-SEQ-NBR           TO DK-REC-SEQ-NBR         14990000
100100     MOVE PV-HOLD-STORE-NBR             TO DK-STORE-NBR           15000000
100200     INITIALIZE PV-HOLD-TMST.                                     15010000
100300                                                                  15020000
100400     PERFORM 7200-OPEN-RFID-CURSOR.                               15030000
100500     PERFORM 7220-FETCH-RFID-CURSOR.                              15040000
100600                                                                  15050000
100700     PERFORM UNTIL PS-END-OF-RFID-CURSOR                          15060000
100800*    ADD THE QUANTITY TO THE APPROPRIATE BUCKET                   15070000
100900         EVALUATE SUEXCP-VILN-GP-SEQ-NBR                          15080000
101700           WHEN PC-RFID-UPC-MISPCK                                15090000
101800               MOVE 'SU005-WRG-TKT-NO-EPC-LOGO' TO PV-FIELD-NAME  15100000
      *SB 04/10/14 - BEGIN PR#5148D                                     15110000
      *SB 03/21/14 - BEGIN PR#5148D                                     15111000
      *              IF PV-RFID-COUNT > 0                               15120000
101900*                 COMPUTE SU005-WRG-TKT-NO-EPC-LOGO =             15130000
102000*                      SU005-WRG-TKT-NO-EPC-LOGO + PV-RFID-COUNT  15140000
102100*                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR 15150000
102200*                 END-COMPUTE                                     15160000
      *              ELSE                                               15170000
101900*                 COMPUTE SU005-WRG-TKT-NO-EPC-LOGO =             15180000
102000*                      SU005-WRG-TKT-NO-EPC-LOGO + PV-DB2-COUNT   15190000
102100*                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR 15200000
102200*                 END-COMPUTE                                     15210000
      *              END-IF                                             15220000
      *SB 03/21/14 - END   PR#5148D                                     15230000
101900                  COMPUTE SU005-WRG-TKT-NO-EPC-LOGO =             15230100
102000                       SU005-WRG-TKT-NO-EPC-LOGO + 1              15230200
102100                  ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR 15230300
102200                  END-COMPUTE                                     15230400
      *SB 04/10/14 - END   PR#5148D                                     15231000
102300                                                                  15240000
101700           WHEN PC-RFID-TKT-CLR                                   15250000
101800               MOVE 'SU005-WRG-RFID-TKT-CLR'    TO PV-FIELD-NAME  15260000
101900               COMPUTE SU005-WRG-RFID-TKT-CLR    =                15270000
102000                       SU005-WRG-RFID-TKT-CLR    + PV-RFID-COUNT  15280000
102100               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    15290000
102200               END-COMPUTE                                        15300000
102300                                                                  15310000
102400           WHEN PC-RFID-TKT-SIZE                                  15320000
102500               MOVE 'SU005-WRG-RFID-TKT-SIZE'    TO PV-FIELD-NAME 15330000
102600               COMPUTE SU005-WRG-RFID-TKT-SIZE   =                15340000
102700                       SU005-WRG-RFID-TKT-SIZE   + PV-RFID-COUNT  15350000
102800               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    15360000
102900               END-COMPUTE                                        15370000
103000                                                                  15380000
103100           WHEN PC-RFID-TKT-STYLE                                 15390000
103200               MOVE 'SU005-WRG-RFID-TKT-STYLE'   TO PV-FIELD-NAME 15400000
103300               COMPUTE SU005-WRG-RFID-TKT-STYLE  =                15410000
103400                       SU005-WRG-RFID-TKT-STYLE  + PV-RFID-COUNT  15420000
103500               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    15430000
103600               END-COMPUTE                                        15440000
103700                                                                  15450000
103800           WHEN PC-RFID-NO-TICKET                                 15460000
105000               MOVE 'SU005-NO-RFID-TICKET'   TO PV-FIELD-NAME     15470000
126300               COMPUTE PV-DB2-COUNT =                             15480000
126400                       PV-DB2-COUNT - PV-RFID-COUNT               15490000
126500               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    15500000
126600               END-COMPUTE                                        15510000
105100               COMPUTE SU005-NO-RFID-TICKET  =                    15520000
105200                       SU005-NO-RFID-TICKET  + PV-DB2-COUNT       15530000
105300               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    15540000
105400               END-COMPUTE                                        15550000
105500                                                                  15560000
107400         END-EVALUATE                                             15570000
107500                                                                  15580000
107600*        INCREMENT THE TOTAL TICKETING ERROR QUANTITY             15590000
123800         EVALUATE SUEXCP-VILN-GP-SEQ-NBR                          15600000
126100             WHEN PC-RFID-NO-TICKET                               15610000
130700              ADD PV-DB2-COUNT      TO SU005-TOT-RFID-ERR         15620000
      *SB 04/10/14 - BEGIN PR#5148D                                     15621000
      *SB 03/28/14 - BEGIN PR#5148D                                     15630000
101700           WHEN PC-RFID-UPC-MISPCK                                15640000
      *               IF PV-RFID-COUNT > 0                              15650000
101900*                  ADD PV-RFID-COUNT  TO SU005-TOT-RFID-ERR       15660000
      *               ELSE                                              15670000
      *                  ADD PV-DB2-COUNT   TO SU005-TOT-RFID-ERR       15680000
      *               END-IF                                            15690000
      *SB 03/21/14 - END   PR#5148D                                     15700000
                         ADD 1              TO SU005-TOT-RFID-ERR       15700100
      *SB 04/10/14 - END   PR#5148D                                     15701000
126100             WHEN OTHER                                           15710000
ASTE00                  ADD PV-RFID-COUNT TO SU005-TOT-RFID-ERR         15720000
130400         END-EVALUATE                                             15730000
107800                                                                  15740000
107900*        IF THIS IS A NEW UNIT (DIFFERENT SCANS) INCREMENT THE    15750000
108000*        TOTAL UNITS IN TICKETING ERROR QUANTITY                  15760000
108100         IF SUEXCP-SCN-TMST NOT EQUAL PV-HOLD-TMST                15770000
123800            EVALUATE SUEXCP-VILN-GP-SEQ-NBR                       15780000
126100             WHEN PC-RFID-NO-TICKET                               15790000
130700                  ADD PV-DB2-COUNT  TO SU005-TOT-UNITS-IN-RFID-ERR15800000
      *SB 04/10/14 - BEGIN PR#5148D                                     15801000
      *SB 03/28/14 - BEGIN PR#5148D                                     15810000
101700*            WHEN PC-RFID-UPC-MISPCK                              15820000
      *               IF PV-RFID-COUNT > 0                              15830000
101900*                  ADD PV-RFID-COUNT  TO                          15840000
      *                                     SU005-TOT-UNITS-IN-RFID-ERR 15841000
      *               ELSE                                              15850000
      *                  ADD PV-DB2-COUNT   TO                          15860000
      *                                     SU005-TOT-UNITS-IN-RFID-ERR 15861000
      *               END-IF                                            15870000
      *SB 03/21/14 - END   PR#5148D                                     15880000
      *SB 04/10/14 - END   PR#5148D                                     15881000
126100             WHEN OTHER                                           15890000
108200                  ADD PV-RFID-COUNT TO SU005-TOT-UNITS-IN-RFID-ERR15900000
130400            END-EVALUATE                                          15910000
108300            MOVE SUEXCP-SCN-TMST  TO PV-HOLD-TMST                 15920000
108400         END-IF                                                   15930000
108500                                                                  15940000
108600         PERFORM 7220-FETCH-RFID-CURSOR                           15950000
108700     END-PERFORM.                                                 15960000
108800                                                                  15970000
108900     PERFORM 7210-CLOSE-RFID-CURSOR.                              15980000
109000*                                                                 15990000
      *SB 11/19/13 - END PR#5148D                                       16000000
109100*                                                                 16010000
109200******************************************************************16020000
109300* 7000-OPEN-PICKING-CURSOR.                                      *16030000
109400*  THIS PROCEDURE WILL OPEN THE PICKING CURSOR.                   16040000
109500******************************************************************16050000
109600 7000-OPEN-PICKING-CURSOR.                                        16060000
109700                                                                  16070000
109800     EXEC SQL                                                     16080000
109900          OPEN PICKING_CURSOR                                     16090000
110000     END-EXEC.                                                    16100000
110100                                                                  16110000
110200     EVALUATE TRUE                                                16120000
110300         WHEN SQLCODE = ZERO                                      16130000
110400              SET PS-NOT-END-OF-PICKING-CURSOR                    16140000
110500                               TO  TRUE                           16150000
110600         WHEN SQLWARN0 NOT EQUAL SPACE                            16160000
110700         WHEN SQLCODE NOT EQUAL ZERO                              16170000
110800              MOVE '7000-OPEN-PICKING-CURSOR'                     16180000
110900                               TO  PV-PARAGRAPH-NAME              16190000
111000              MOVE 'OPEN PICKING_CURSOR'                          16200000
111100                               TO  PV-DB2-OPERATION-ATTEMPTED     16210000
111200              DISPLAY 'AUD CNTL NBR:  ' DK-AUD-CNTL-NBR           16220000
111300              DISPLAY 'STORE NBR:     ' DK-STORE-NBR              16230000
111400              DISPLAY 'PO NUMBER:     ' DK-PO-NBR                 16240000
111500              DISPLAY 'REC SEQ NBR:   ' DK-REC-SEQ-NBR            16250000
111600              PERFORM 9999-SQL-ABEND                              16260000
111700     END-EVALUATE.                                                16270000
111800*                                                                 16280000
111900******************************************************************16290000
112000* 7010-CLOSE-PICKING-CURSOR.                                     *16300000
112100*  THIS PROCEDURE WILL CLOSE THE PICKING_CURSOR.                  16310000
112200******************************************************************16320000
112300 7010-CLOSE-PICKING-CURSOR.                                       16330000
112400                                                                  16340000
112500     EXEC SQL                                                     16350000
112600         CLOSE PICKING_CURSOR                                     16360000
112700     END-EXEC.                                                    16370000
112800                                                                  16380000
112900     EVALUATE TRUE                                                16390000
113000         WHEN SQLWARN0 NOT EQUAL SPACE                            16400000
113100         WHEN SQLCODE NOT EQUAL ZERO                              16410000
113200              MOVE '7010-CLOSE-PICKING-CURSOR'                    16420000
113300                               TO  PV-PARAGRAPH-NAME              16430000
113400              MOVE 'CLOSE PICKING_CURSOR'                         16440000
113500                               TO  PV-DB2-OPERATION-ATTEMPTED     16450000
113600              PERFORM 9999-SQL-ABEND                              16460000
113700     END-EVALUATE.                                                16470000
113800                                                                  16480000
113900*                                                                 16490000
114000******************************************************************16500000
114100* 7020-FETCH-PICKING-CURSOR                                      *16510000
114200*  THIS PROCEDURE WILL FETCH THE PICKING-CURSOR.                  16520000
114300******************************************************************16530000
114400 7020-FETCH-PICKING-CURSOR.                                       16540000
114500                                                                  16550000
114600     EXEC SQL                                                     16560000
114700          FETCH PICKING_CURSOR                                    16570000
114800          INTO                                                    16580000
114900                 :SUEXCP-UPC-NBR                                  16590000
115000               , :SUEXCP-SCN-TMST                                 16600000
115100               , :SUEXCP-VILN-GP-SEQ-NBR                          16610000
115200               , :PV-DB2-COUNT                                    16620000
115300     END-EXEC.                                                    16630000
115400                                                                  16640000
115500     EVALUATE TRUE                                                16650000
115600         WHEN SQLCODE = ZERO                                      16660000
115700              CONTINUE                                            16670000
115800                                                                  16680000
115900         WHEN SQLCODE = +100                                      16690000
116000         WHEN SQLCODE = -305                                      16700000
116100              SET PS-END-OF-PICKING-CURSOR                        16710000
116200                               TO  TRUE                           16720000
116300                                                                  16730000
116400         WHEN SQLWARN0 NOT EQUAL SPACE                            16740000
116500         WHEN SQLCODE NOT EQUAL ZERO                              16750000
116600              MOVE '7020-FETCH-PICKING-CURSOR'                    16760000
116700                               TO  PV-PARAGRAPH-NAME              16770000
116800              MOVE 'FETCH PICKING_CURSOR'                         16780000
116900                               TO  PV-DB2-OPERATION-ATTEMPTED     16790000
117000              PERFORM 9999-SQL-ABEND                              16800000
117100     END-EVALUATE.                                                16810000
117200                                                                  16820000
117300*                                                                 16830000
117400******************************************************************16840000
117500* 7100-OPEN-TICKETING-CURSOR.                                    *16850000
117600*  THIS PROCEDURE WILL OPEN THE TICKETING CURSOR.                 16860000
117700******************************************************************16870000
117800 7100-OPEN-TICKETING-CURSOR.                                      16880000
117900                                                                  16890000
118000     EXEC SQL                                                     16900000
118100          OPEN TICKETING_CURSOR                                   16910000
118200     END-EXEC.                                                    16920000
118300                                                                  16930000
118400     EVALUATE TRUE                                                16940000
118500         WHEN SQLCODE = ZERO                                      16950000
118600              SET PS-NOT-END-OF-TICKETING-CURSOR                  16960000
118700                               TO  TRUE                           16970000
118800         WHEN SQLWARN0 NOT EQUAL SPACE                            16980000
118900         WHEN SQLCODE NOT EQUAL ZERO                              16990000
119000              MOVE '7100-OPEN-TICKETING-CURSOR'                   17000000
119100                               TO  PV-PARAGRAPH-NAME              17010000
119200              MOVE 'OPEN TICKETING_CURSOR'                        17020000
119300                               TO  PV-DB2-OPERATION-ATTEMPTED     17030000
119400              DISPLAY 'AUD CNTL NBR: ' DK-AUD-CNTL-NBR            17040000
119500              DISPLAY 'STORE NBR:    ' DK-STORE-NBR               17050000
119600              DISPLAY 'PO NBR:       ' DK-PO-NBR                  17060000
119700              DISPLAY 'REC SEQ NBR:  ' DK-REC-SEQ-NBR             17070000
119800              PERFORM 9999-SQL-ABEND                              17080000
119900     END-EVALUATE.                                                17090000
120000*                                                                 17100000
120100******************************************************************17110000
120200* 7110-CLOSE-TICKETING-CURSOR.                                   *17120000
120300*  THIS PROCEDURE WILL CLOSE THE TICKETING_CURSOR.                17130000
120400******************************************************************17140000
120500 7110-CLOSE-TICKETING-CURSOR.                                     17150000
120600                                                                  17160000
120700     EXEC SQL                                                     17170000
120800         CLOSE TICKETING_CURSOR                                   17180000
120900     END-EXEC.                                                    17190000
121000                                                                  17200000
121100     EVALUATE TRUE                                                17210000
121200         WHEN SQLWARN0 NOT EQUAL SPACE                            17220000
121300         WHEN SQLCODE NOT EQUAL ZERO                              17230000
121400              MOVE '7110-CLOSE-TICKETING-CURSOR'                  17240000
121500                               TO  PV-PARAGRAPH-NAME              17250000
121600              MOVE 'CLOSE TICKETING_CURSOR'                       17260000
121700                               TO  PV-DB2-OPERATION-ATTEMPTED     17270000
121800              PERFORM 9999-SQL-ABEND                              17280000
121900     END-EVALUATE.                                                17290000
122000                                                                  17300000
122100*                                                                 17310000
122200******************************************************************17320000
122300* 7120-FETCH-TICKETING-CURSOR                                    *17330000
122400*  THIS PROCEDURE WILL FETCH THE TICKETING-CURSOR.                17340000
122500******************************************************************17350000
122600 7120-FETCH-TICKETING-CURSOR.                                     17360000
122700                                                                  17370000
122800     EXEC SQL                                                     17380000
122900          FETCH TICKETING_CURSOR                                  17390000
123000          INTO                                                    17400000
123100                 :SUEXCP-UPC-NBR                                  17410000
123200               , :SUEXCP-SCN-TMST                                 17420000
123300               , :SUEXCP-VILN-GP-SEQ-NBR                          17430000
123400               , :PV-DB2-COUNT                                    17440000
123500     END-EXEC.                                                    17450000
123600                                                                  17460000
123700     EVALUATE TRUE                                                17470000
123800         WHEN SQLCODE = ZERO                                      17480000
123900              CONTINUE                                            17490000
124000                                                                  17500000
124100         WHEN SQLCODE = +100                                      17510000
124200         WHEN SQLCODE = -305                                      17520000
124300              SET PS-END-OF-TICKETING-CURSOR                      17530000
124400                               TO  TRUE                           17540000
124500                                                                  17550000
124600         WHEN SQLWARN0 NOT EQUAL SPACE                            17560000
124700         WHEN SQLCODE NOT EQUAL ZERO                              17570000
124800              MOVE '7120-FETCH-TICKETING-CURSOR'                  17580000
124900                               TO  PV-PARAGRAPH-NAME              17590000
125000              MOVE 'FETCH TICKETING_CURSOR'                       17600000
125100                               TO  PV-DB2-OPERATION-ATTEMPTED     17610000
125200              PERFORM 9999-SQL-ABEND                              17620000
125300     END-EVALUATE.                                                17630000
125400                                                                  17640000
117300*                                                                 17650000
      *SB 11/19/13 - BEGIN PR#5148D                                     17660000
117400******************************************************************17670000
117500* 7200-OPEN-RFID-CURSOR.                                         *17680000
117600*  THIS PROCEDURE WILL OPEN THE RFID CURSOR.                      17690000
117700******************************************************************17700000
117800 7200-OPEN-RFID-CURSOR.                                           17710000
117900                                                                  17720000
118000     EXEC SQL                                                     17730000
118100          OPEN RFID_CURSOR                                        17740000
118200     END-EXEC.                                                    17750000
118300                                                                  17760000
118400     EVALUATE TRUE                                                17770000
118500         WHEN SQLCODE = ZERO                                      17780000
118600              SET PS-NOT-END-OF-RFID-CURSOR                       17790000
118700                               TO  TRUE                           17800000
118800         WHEN SQLWARN0 NOT EQUAL SPACE                            17810000
118900         WHEN SQLCODE NOT EQUAL ZERO                              17820000
119000              MOVE '7200-OPEN-RFID-CURSOR'                        17830000
119100                               TO  PV-PARAGRAPH-NAME              17840000
119200              MOVE 'OPEN RFID_CURSOR'                             17850000
119300                               TO  PV-DB2-OPERATION-ATTEMPTED     17860000
119400              DISPLAY 'AUD CNTL NBR: ' DK-AUD-CNTL-NBR            17870000
119500              DISPLAY 'STORE NBR:    ' DK-STORE-NBR               17880000
119600              DISPLAY 'PO NBR:       ' DK-PO-NBR                  17890000
119700              DISPLAY 'REC SEQ NBR:  ' DK-REC-SEQ-NBR             17900000
119800              PERFORM 9999-SQL-ABEND                              17910000
119900     END-EVALUATE.                                                17920000
120000*                                                                 17930000
120100******************************************************************17940000
120200* 7210-CLOSE-RFID-CURSOR                                         *17950000
120300*  THIS PROCEDURE WILL CLOSE THE RFID_CURSOR.                     17960000
120400******************************************************************17970000
120500 7210-CLOSE-RFID-CURSOR.                                          17980000
120600                                                                  17990000
120700     EXEC SQL                                                     18000000
120800         CLOSE RFID_CURSOR                                        18010000
120900     END-EXEC.                                                    18020000
121000                                                                  18030000
121100     EVALUATE TRUE                                                18040000
121200         WHEN SQLWARN0 NOT EQUAL SPACE                            18050000
121300         WHEN SQLCODE NOT EQUAL ZERO                              18060000
121400              MOVE '7210-CLOSE-RFID-CURSOR'                       18070000
121500                               TO  PV-PARAGRAPH-NAME              18080000
121600              MOVE 'CLOSE RFID_CURSOR'                            18090000
121700                               TO  PV-DB2-OPERATION-ATTEMPTED     18100000
121800              PERFORM 9999-SQL-ABEND                              18110000
121900     END-EVALUATE.                                                18120000
122000                                                                  18130000
122100*                                                                 18140000
122200******************************************************************18150000
122300* 7220-FETCH-RFID-CURSOR                                         *18160000
122400*  THIS PROCEDURE WILL FETCH THE RFID-CURSOR.                     18170000
122500******************************************************************18180000
122600 7220-FETCH-RFID-CURSOR.                                          18190000
122700                                                                  18200000
122800     EXEC SQL                                                     18210000
122900          FETCH RFID_CURSOR                                       18220000
123000          INTO                                                    18230000
123100                 :SUEXCP-UPC-NBR                                  18240000
123200               , :SUEXCP-SCN-TMST                                 18250000
123300               , :SUEXCP-VILN-GP-SEQ-NBR                          18260000
123400               , :PV-DB2-COUNT                                    18270000
147500               , :PV-RFID-COUNT                                   18280000
123500     END-EXEC.                                                    18290000
123600                                                                  18300000
123700     EVALUATE TRUE                                                18310000
123800         WHEN SQLCODE = ZERO                                      18320000
123900              CONTINUE                                            18330000
124000                                                                  18340000
124100         WHEN SQLCODE = +100                                      18350000
124200         WHEN SQLCODE = -305                                      18360000
124300              SET PS-END-OF-RFID-CURSOR                           18370000
124400                               TO  TRUE                           18380000
124500                                                                  18390000
124600         WHEN SQLWARN0 NOT EQUAL SPACE                            18400000
124700         WHEN SQLCODE NOT EQUAL ZERO                              18410000
124800              MOVE '7220-FETCH-RFID-CURSOR'                       18420000
124900                               TO  PV-PARAGRAPH-NAME              18430000
125000              MOVE 'FETCH RFID_CURSOR'                            18440000
125100                               TO  PV-DB2-OPERATION-ATTEMPTED     18450000
125200              PERFORM 9999-SQL-ABEND                              18460000
125300     END-EVALUATE.                                                18470000
      *SB 11/19/13 - END PR#5148D                                       18480000
125400                                                                  18490000
125500*                                                                 18500000
125600******************************************************************18510000
125700* 8000-READ-VND-OVER-SHORT.                                       18520000
125800*    READ THE VENDOR OVER/SHORT FILE -- THIS FILE WILL BE USED AS 18530000
125900*  THE DRIVER OF THE EXTRACT                                      18540000
126000******************************************************************18550000
126100 8000-READ-VND-OVER-SHORT.                                        18560000
126200     READ OS-VND-OVER-SHORT-FILE                                  18570000
126300        INTO SU003-EXTRACT-RECORD                                 18580000
126400     AT END                                                       18590000
126500        SET PS-EOF-VND-OVER-SHORT        TO TRUE                  18600000
126600        MOVE +999999999                  TO SU003-AUD-CNTL-NBR    18610000
126700     END-READ.                                                    18620000
126800                                                                  18630000
126900*                                                                 18640000
127000******************************************************************18650000
127100* 8001-READ-RCVR-OVER-SHORT.                                      18660000
127200******************************************************************18670000
127300 8001-READ-RCVR-OVER-SHORT.                                       18680000
127400     READ OS-RCVR-OVER-SHORT-FILE                                 18690000
127500        INTO SU004-EXTRACT-RECORD                                 18700000
127600     AT END                                                       18710000
127700        SET PS-EOF-RCVR-OVER-SHORT       TO TRUE                  18720000
127800        MOVE +999999999                  TO SU004-AUD-CNTL-NBR    18730000
127900     END-READ.                                                    18740000
128000                                                                  18750000
128100*                                                                 18760000
128200******************************************************************18770000
128300* 8100-WRITE-EXTRACT-FILE.                                        18780000
128400******************************************************************18790000
128500 8100-WRITE-EXTRACT-FILE.                                         18800000
128600     WRITE AS-AUDIT-SUM-EXTRACT-REC                               18810000
128700        FROM SU005-EXTRACT-RECORD.                                18820000
128800                                                                  18830000
128900                                                                  18840000
      *SB 11/19/13 - BEGIN PR#5148D                                     18850000
       8200-READ-CARDIN-FILE.                                           18860000
      ******************************************************************18870000
                                                                        18880000
           READ CARDIN-AUDIT-NBR-FILE INTO CC-CARDIN                    18890000
              AT END                                                    18900000
                 SET PS-END-OF-CARDIN-FILE TO TRUE.                     18910000
                                                                        18920000
           IF PS-END-OF-CARDIN-FILE                                     18930000
               CONTINUE                                                 18940000
           ELSE                                                         18950000
               DISPLAY 'AUDIT NBR IS : ' CC-AUDIT-CNTL-NBR              18960000
               DISPLAY 'CARTON ID IS : ' CC-CARTON-ID                   18970000
           END-IF.                                                      18980000
      *SB 11/19/13 - END PR#5148D                                       18990000
                                                                        19000000
129000******************************************************************19010000
129100* 9000-EOJ-ROUTINE - PRINTS A GRAND TOTAL, AND CLOSES THE DRIVER  19020000
129200* CURSOR AND THE REPORT FILE.                                     19030000
129300******************************************************************19040000
129400 9000-EOJ-ROUTINE.                                                19050000
129500                                                                  19060000
129600     CLOSE  OS-VND-OVER-SHORT-FILE                                19070000
129700            OS-RCVR-OVER-SHORT-FILE                               19080000
      *SB 11/19/13 - BEGIN PR#5148D                                     19090000
                  CARDIN-AUDIT-NBR-FILE                                 19100000
      *SB 11/19/13 - END PR#5148D                                       19110000
129800            AS-AUDIT-SUM-EXTRACT-FILE.                            19120000
129900                                                                  19130000
130000                                                                  19140000
130100******************************************************************19150000
130200* 9100-FIELD-OVERFLOW-ERROR - IF ON OF THE ACCUMULATOR FIELDS    *19160000
130300* ROLLS OVER (IE THE NUMBER IS TOO BIG TO FIT) THIS PARAGRAPH    *19170000
130400* WILL ABEND THE PROGRAM                                         *19180000
130500******************************************************************19190000
130600 9100-FIELD-OVERFLOW-ERROR.                                       19200000
130700     DISPLAY '** ABEND     **'.                                   19210000
130800     DISPLAY '** PROGRAM   ** = SUKUT012'.                        19220000
130900     DISPLAY '** PROGRAM ACCUMULATOR OVERFLOW ERROR **'.          19230000
131000     DISPLAY '** THE DATA CREATES A TOTALS VALUE LARGER THAN '.   19240000
131100     DISPLAY '** THE FIELD SET-UP TO HANDLE IT.  INCREASE THE'.   19250000
131200     DISPLAY '** THE FOLLOWING FIELD WAS TOO SMALL: '.            19260000
131300     DISPLAY PV-FIELD-NAME.                                       19270000
131400                                                                  19280000
131500     MOVE +4004 TO ABEND-CODE.                                    19290000
131600     CALL 'ILBOABN0' USING ABEND-CODE.                            19300000
131700                                                                  19310000
131710*----------------------------------------------------------------*19320000
131720*                                               ** WR # 21361    *19330000
131730* ADDED CODE TO DISPLAY MESSAGES,WHEN ABEND OCCURS FROM          *19340000
131740* LOGISTICS DOMAIN ITEM ACCESS MODULE.                           *19350000
131750*----------------------------------------------------------------*19360000
131760 9200-PROCESS-ABEND.                                              19370000
131770                                                                  19380000
      * SND 10/2009  DATA CONTENTION CHANGES START                      19390000
           IF SQLCODE                  = -904 OR -911 OR -913           19400000
              MOVE +4050               TO RETURN-CODE                   19410000
              STOP RUN                                                  19420000
           ELSE                                                         19430000
              PERFORM 9210-ABEND-PROGRAM                                19440000
           END-IF.                                                      19450000
      *                                                                 19460000
      *9200-EXIT.                                                       19470000
      *                                                                 19480000
      * SND 10/2009  DATA CONTENTION CHANGES END                        19490000
       9210-ABEND-PROGRAM.                                              19500000
131780     DISPLAY '** ABEND **       ** = SQLERROR'.                   19510000
131790     DISPLAY '** PROGRAM        ** = SUKUT012'.                   19520000
131791     DISPLAY '** ABEND PARAGRAPH **  ' PV-ABEND-PARAGRAPH.        19530000
131792     DISPLAY '** ERROR MESSAGE   **  ' PV-ABEND-MESSAGE-TEXT.     19540000
131793     DISPLAY '** SQLCODE         **  ' PV-SQLCODE.                19550000
131794     DISPLAY '** VIEW  NAME      **  ' PV-DB2-VIEW-NAME.          19560000
131795     MOVE +4013 TO PV-ABEND-CODE.                                 19570000
131796     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         19580000
131797*----------------------------------------------------------------*19590000
131798* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *19600000
131799*----------------------------------------------------------------*19610000
131800******************************************************************19620000
131900* 9999-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE *    19630000
132000* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS. *               19640000
132100******************************************************************19650000
132200 9999-SQL-ABEND.                                                  19660000
      *                                                                 19670000
      * SND 10/2009  DATA CONTENTION CHANGES START                      19680000
           IF SQLCODE                  = -904 OR -911 OR -913           19690000
              MOVE +4050               TO RETURN-CODE                   19700000
              STOP RUN                                                  19710000
           ELSE                                                         19720000
              PERFORM Z999-ABEND-PROGRAM                                19730000
           END-IF.                                                      19740000
      *                                                                 19750000
      *9999-EXIT.                                                       19760000
      *                                                                 19770000
      * SND 10/2009  DATA CONTENTION CHANGES END                        19780000
       Z999-ABEND-PROGRAM.                                              19790000
132300     DISPLAY '** ABEND      **'.                                  19800000
132400     DISPLAY '** PROGRAM    ** = SUKUT012'.                       19810000
132500     DISPLAY '** PARAGRAPH  ** = ' PV-PARAGRAPH-NAME.             19820000
132600     DISPLAY '** OPERATION  ** = ' PV-DB2-OPERATION-ATTEMPTED.    19830000
132700                                                                  19840000
132800******************************************************************19850000
132900* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *19860000
133000* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *19870000
133100* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *19880000
133200* FORMAT.                                                        *19890000
133300******************************************************************19900000
133400     COPY DPPD004.                                                19910000
133600                                                                  19920000
133700     MOVE +4013 TO ABEND-CODE.                                    19930000
133800     CALL 'ILBOABN0' USING ABEND-CODE.                            19940000
133900*9999-EXIT.                                                       19950000
