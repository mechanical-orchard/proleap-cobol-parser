000100 IDENTIFICATION DIVISION.                                         00010000
000200*************************************************************     00020099
000300 PROGRAM-ID.    PXKUT090.                                         00030099
000400 AUTHOR.        TOM PRIMEAU.                                      00040099
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050099
000600 DATE-WRITTEN.  APRIL 2007.                                       00060099
000700 DATE-COMPILED.                                                   00070099
000800*************************************************************     00080099
000900* THIS PROGRAM READS THE UNLOADED BMC FILE WHERE THE              00090099
001000* PXT_MOS_SKU_STR EFF_BEG_DTE IS LESS THAN CURRENT DATE           00100099
001100* AND XST_SKU SKU_NBR IS EQUAL TO THE PXT_MOS_SKU_STR SKU_NBR.    00110099
001200* IT USES THE INTR_UPC_ID AS THE KEY TO XST_SKU_LOC TABLE.        00120099
001300* IT THEN DOES A STORE LOOKUP PROCESS RETURNS A 'FOUND'           00130099
001400* OR 'NOT FOUND' FLAG AS WELL AS A LOC_STAT_CDE.                  00140099
001500* BASED ON WHETHER THE LOC_STAT_CDE IS A '20', '25', OR '30',     00150099
001600* EITHER A 'SAVE' OR 'BYPASS' FILE IS WRITTEN.                    00160099
001700*************************************************************     00170099
      *-------------------------------------------------------------*           
      * DATE: 07/06/2016                                            *           
      * WR/IR#: CHG0145948                                   *                  
      * PROGRAMMER:  COGNIZANT                                      *           
      * DESCRIPTION: MODIFIED PROGRAM TO CHECK PX032-MOS-END-DATE               
      *              AND MOVE SPACES IF IT HAS EITHER LOW OR HIGH               
      *              VALUES.                                                    
      *-------------------------------------------------------------*           
001800 ENVIRONMENT DIVISION.                                            00180099
001900*************************************************************     00190099
002000 CONFIGURATION SECTION.                                           00200099
002100                                                                  00210099
002200 INPUT-OUTPUT SECTION.                                            00220099
002300                                                                  00230099
002400 FILE-CONTROL.                                                    00240099
002500                                                                  00250099
002600     SELECT IN-VALID-FILE                                         00260099
002700         ASSIGN TO INP01.                                         00270099
002800                                                                  00280099
002900     SELECT SAVE-SKU-FILE                                         00290099
003000         ASSIGN TO OUT01.                                         00300099
003100                                                                  00310099
003200     SELECT BYPASS-SKU-FILE                                       00320099
003300         ASSIGN TO OUT02.                                         00330099
003400                                                                  00340099
003500 DATA DIVISION.                                                   00350099
003600                                                                  00360099
003700 FILE SECTION.                                                    00370099
003800                                                                  00380099
003900 FD  IN-VALID-FILE                                                00390099
004000     RECORDING MODE F                                             00400099
004100     LABEL RECORDS ARE STANDARD                                   00410099
004200     BLOCK CONTAINS 0 RECORDS.                                    00420099
004300 01  IN-VALID-RECORD                     PIC  X(37).              00430099
004400                                                                  00440099
004500 FD  SAVE-SKU-FILE                                                00450099
004600     RECORDING MODE F                                             00460099
004700     LABEL RECORDS ARE STANDARD                                   00470099
004800     BLOCK CONTAINS 0 RECORDS.                                    00480099
004900 01  SAVE-SKU-RECORD                     PIC  X(27).              00490099
005000                                                                  00500099
005100 FD  BYPASS-SKU-FILE                                              00510099
005200     RECORDING MODE F                                             00520099
005300     LABEL RECORDS ARE STANDARD                                   00530099
005400     BLOCK CONTAINS 0 RECORDS.                                    00540099
005500 01  BYPASS-SKU-RECORD                   PIC  X(27).              00550099
005600                                                                  00560099
005700                                                                  00570099
005800 WORKING-STORAGE SECTION.                                         00580099
005900                                                                  00590099
006000**DATE FIELDS                                                     00600099
006100                                                                  00610099
006200                                                                  00620099
006300 01  DF-WORK-DATE                     PIC  X(26).                 00630099
006400 01  DF-WORK-DATE-R   REDEFINES   DF-WORK-DATE.                   00640099
006500     05  DF-DATE-1-10                 PIC  X(10).                 00650099
006600     05  DF-DATE-11-26                PIC  X(16).                 00660099
006700                                                                  00670099
006800 01  DF-END-DATE                      PIC  X(26).                 00680099
006900 01  DF-WORK-END-DATE-R   REDEFINES   DF-END-DATE.                00690099
007000     05  DF-END-DATE-1-10             PIC  X(10).                 00700099
007100     05  DF-END-DATE-11-26            PIC  X(16).                 00710099
007200                                                                  00720099
007300****************************************************************  00730099
007400**PROGRAM ACCUMULATORS                                            00740099
007500****************************************************************  00750099
007600 01  PA-PROGRAM-ACCUMULATORS.                                     00760099
007700     05  PA-TOT-RECS-READ             PIC 9(13) VALUE ZEROS.      00770099
007800     05  PA-TOT-BYPASS                PIC 9(13) VALUE ZEROS.      00780099
007900     05  PA-TOT-SAVE                  PIC 9(13) VALUE ZEROS.      00790099
008000                                                                  00800099
008100****************************************************************  00810099
008200**PROGRAM VARIABLES.                                              00820099
008300****************************************************************  00830099
008400 01  PV-PROGRAM-VARIABLES.                                        00840099
008500     05  PV-PARAGRAPH-NAME            PIC  X(30) VALUE SPACE.     00850099
008600     05  PV-OPERATION-MSG-1           PIC  X(40) VALUE SPACE.     00860099
008700     05  PV-OPERATION-MSG-2           PIC  X(40) VALUE SPACE.     00870099
008800     05  PV-OPERATION-MSG             PIC  X(30) VALUE SPACE.     00880099
008900     05  PV-DB2-OPERATION             PIC  X(30) VALUE SPACE.     00890099
009000     05  PV-EVENT-DATE                PIC  X(10) VALUE SPACE.     00900099
009100     05  PV-SQL-SUB                   PIC S9(04) COMP             00910099
009200                                                 VALUE +0.        00920099
009300     05  PV-SAVE-SKU-NBR              PIC S9(08) COMP-3           00930099
009400                                                 VALUE +0.        00940099
009500                                                                  00950099
009600****************************************************************  00960099
009700**PROGRAM SWITCHES.                                               00970099
009800*****-**********************************************************  00980099
009900 01  PS-PROGRAM-SWITCHES.                                         00990000
010000     05  PS-END-OF-FILE-SW            PIC  X(01) VALUE 'N'.       01000000
010100         88 PS-END-OF-FILE-N                     VALUE 'N'.       01010000
010200         88 PS-END-OF-FILE-Y                     VALUE 'Y'.       01020000
010300     05  PS-SKU-FOUND-SW              PIC  X(01) VALUE ' '.       01030099
010400         88 PS-SKU-NOT-FOUND-N                   VALUE 'N'.       01040099
010500         88 PS-SKU-FOUND-Y                       VALUE 'Y'.       01050000
010600     05  PS-SKU-STORE-FOUND-SW        PIC  X(01) VALUE ' '.       01060099
010700         88 PS-SKU-STORE-FOUND-N                 VALUE 'N'.       01070099
010800         88 PS-SKU-STORE-FOUND-Y                 VALUE 'Y'.       01080000
010900     05  PS-SKUS-UNMATCHED-SW         PIC  X(01) VALUE 'N'.       01090099
011000         88 PS-SKUS-UNMATCHED-N                  VALUE 'N'.       01100099
011100         88 PS-SKUS-UNMATCHED-Y                  VALUE 'Y'.       01110000
011200                                                                  01120099
011300****************************************************************  01130099
011400**PROGRAM CONSTANTS.                                              01140099
011500****************************************************************  01150099
011600 01  PC-PROGRAM-CONSTANTS.                                        01160099
011700     05  PC-CURRENT-PROGRAM-NAME      PIC  X(08) VALUE 'PXKUT090'.01170099
011800     05  PC-MAX-RETRIES               PIC S9(004) COMP            01180099
011900                                                 VALUE +5.        01190099
012000                                                                  01200099
012100****************************************************************  01210099
012200**ABEND INFORMATION                                               01220099
012300****************************************************************  01230099
012400 01  AC-ABEND-CODE                    PIC S9(04) VALUE ZERO       01240099
012500                                                 COMP SYNC.       01250099
012600     88  AC-DB2-ERROR                            VALUE +4013.     01260099
012700     88  AC-CONTROL-CARD-ERROR                   VALUE +4003.     01270099
012800                                                                  01280099
012900************************************************************      01290099
013000* PX036-MOS-EXTRACT-RECORD.                                       01300099
013100************************************************************      01310099
013200     COPY PXRD036.                                                01320099
013300                                                                  01330099
013400************************************************************      01340099
013500* PX032-MOS-OUTPUT-RECORD.                                        01350099
013600************************************************************      01360099
013700     COPY PXRD032.                                                01370099
013800                                                                  01380099
013900***************************************************************** 01390000
014000*  ABEND ROUTINE INFORMATION                                      01400000
014100***************************************************************** 01410099
014200     COPY DPWS900.                                                01420000
014300                                                                  01430099
014400***************************************************************** 01440000
014500*  ABEND ROUTINE INFORMATION                                      01450000
014600***************************************************************** 01460099
014700     COPY DPWS004.                                                01470000
014800                                                                  01480099
014900******************************************************************01490099
015000*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)             01500099
015100******************************************************************01510099
015200     COPY DPWS500.                                                01520099
015300                                                                  01530099
015400************************************************************      01540099
015500* DB2 MESSAGE AREA                                                01550099
015600************************************************************      01560099
015700     COPY SQLCA2.                                                 01570099
015800                                                                  01580099
015900************************************************************      01590099
016000* DB2 COMMUNICATIONS AREA                                         01600099
016100************************************************************      01610099
016200     EXEC SQL                                                     01620099
016300       INCLUDE SQLCA                                              01630099
016400     END-EXEC.                                                    01640099
016500                                                                  01650099
016600************************************************************      01660099
016700* DB2 TABLE XST_SKU_LOC (XST00008)                                01670099
016800************************************************************      01680099
016900     EXEC SQL                                                     01690099
017000       INCLUDE XST00008                                           01700099
017100     END-EXEC.                                                    01710099
017200                                                                  01720099
017300************************************************************      01730099
017400* DB2 TABLE XST_SKU (XST00010)                                    01740099
017500************************************************************      01750099
017600     EXEC SQL                                                     01760099
017700       INCLUDE XST00010                                           01770099
017800     END-EXEC.                                                    01780099
017900                                                                  01790099
018000****************************************************************  01800000
018100 PROCEDURE DIVISION.                                              01810000
018200******************************************************************01820000
018300 0000-MAINLINE.                                                   01830000
018400     PERFORM 1000-HOUSEKEEPING.                                   01840000
018500                                                                  01850099
018600     PERFORM 2000-PROCESS-INPUT-FILE                              01860099
018700         UNTIL PS-END-OF-FILE-Y.                                  01870000
018800                                                                  01880099
018900     PERFORM 9000-END-OF-JOB.                                     01890000
019000                                                                  01900000
019100     STOP RUN.                                                    01910000
019200                                                                  01920000
019300****************************************************************  01930000
019400*     OPEN FILES, READ IN AND VALIDATE CONTROL DATE.              01940000
019500****************************************************************  01950000
019600 1000-HOUSEKEEPING.                                               01960000
019700     OPEN INPUT  IN-VALID-FILE                                    01970000
019800          OUTPUT SAVE-SKU-FILE                                    01980099
019900                 BYPASS-SKU-FILE.                                 01990099
020000                                                                  02000099
020100     PERFORM 5000-READ-INPUT-FILE.                                02010099
020200                                                                  02020000
020300     IF PS-END-OF-FILE-Y                                          02030000
020400         DISPLAY SPACES                                           02040099
020500         DISPLAY ALL '*'                                          02050099
020600         DISPLAY '  INPUT FILE IS EMPTY '                         02060099
020700         DISPLAY ALL '*'                                          02070099
020800         DISPLAY SPACES                                           02080099
020900     END-IF.                                                      02090099
021000                                                                  02100099
021100***************************************************************   02110099
021200* PROCESS INPUT FILE                                              02120099
021300*  IF XST00008-LOC-SKU-STAT-CDE ='30' WRITE TO BYPASS-SKU-FILE.   02130099
021400*  IF XST00008-LOC-SKU-STAT-CDE ='20' WRITE TO SAVE-SKU-FILE.     02140099
021500*  IF XST00008-LOC-SKU-STAT-CDE ='25' AND LOC ZERO                02150099
021600*                                     WRITE TO BYPASS-SKU-FILE    02160099
021700*  IF XST00008-LOC-SKU-STAT-CDE ='25' AND LOC ZERO                02170099
021800*                                     WRITE TO SAVE-SKU-FILE      02180099
021900***************************************************************   02190099
022000                                                                  02200099
022100 2000-PROCESS-INPUT-FILE.                                         02210099
022200     SET PS-SKUS-UNMATCHED-N TO TRUE.                             02220099
022300     MOVE SPACES TO PS-SKU-FOUND-SW.                              02230099
022400     MOVE PX036-SKU-NBR TO PV-SAVE-SKU-NBR.                       02240099
022430                                                                  02243099
022500     PERFORM 2200-LOOKUP-STORE.                                   02250099
023104     IF PS-SKU-FOUND-Y                                            02270099
023106       EVALUATE XST00008-LOC-SKU-STAT-CDE                                 
023107          WHEN '30'                                                       
023108              PERFORM 3000-BYPASS-SKU                                     
023109                UNTIL PS-SKUS-UNMATCHED-Y                                 
023110                                                                          
023400          WHEN '25'                                                       
023500              PERFORM 3200-PROCESS-SKU-BY-STORE                           
023600                UNTIL PS-SKUS-UNMATCHED-Y                                 
023800                                                                          
024000          WHEN OTHER                                                      
024100              PERFORM 3400-SAVE-SKU                                       
024200                UNTIL PS-SKUS-UNMATCHED-Y                                 
024210       END-EVALUATE                                                       
024300     END-IF.                                                              
024400                                                                          
024500     IF PS-SKU-NOT-FOUND-N                                                
024600         PERFORM 3000-BYPASS-SKU                                          
024700         UNTIL PS-SKUS-UNMATCHED-Y                                        
024800     END-IF.                                                              
024900                                                                  02490099
030110******************************************************************03011099
030120* LOOKUP SKU STAT CODE.                                           03012099
030140******************************************************************03014099
030150 2200-LOOKUP-STORE.                                               03015099
030160     INITIALIZE DCLXST00008.                                      03016099
030170                                                                  03017099
030180     PERFORM                                                      03018099
030190         WITH TEST AFTER                                          03019099
030191         VARYING PV-SQL-SUB                                       03019199
030192         FROM 1 BY 1                                              03019299
030193         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 03019399
030194                   OR  SQLCODE = 0                                03019499
030195                   OR  SQLCODE = +100)                            03019599
030196                                                                  03019699
030197         EXEC SQL                                                 03019799
030198           SELECT A.LOC_SKU_STAT_CDE                                      
030199                 ,A.LOC_NBR                                               
030200                 ,A.BEG_TMST                                              
030201           INTO   :XST00008-LOC-SKU-STAT-CDE                      03020099
030202                 ,:XST00008-LOC-NBR                               03020199
030203                 ,:XST00008-BEG-TMST                                      
030204           FROM   XST_SKU_LOC  A                                  03020299
030205                 ,XST_SKU      B                                  03020399
030206           WHERE B.SKU_NBR       = :PX036-SKU-NBR                 03020499
030207             AND B.INTR_UPC_ID   = A.INTR_UPC_ID                  03020599
030208             AND A.LOC_NBR       =  0                             03020799
030209             AND A.END_TMST     IS  NULL                          03020899
030210           WITH UR                                                03020999
030211         END-EXEC                                                 03021099
030212                                                                  03021199
030213         EVALUATE TRUE                                            03021299
030214             WHEN SQLCODE = 0                                     03021399
030215                 SET PS-SKU-FOUND-Y TO TRUE                       03021499
030216             WHEN SQLCODE = +100                                  03021599
030217                 SET PS-SKU-NOT-FOUND-N TO TRUE                   03021699
030218             WHEN SQLCODE = -911                                  03021799
030219                 CONTINUE                                         03021899
030220             WHEN SQLWARN NOT = SPACES                            03021999
030221             WHEN SQLCODE NOT = ZERO                              03022099
030222                 MOVE '2200-LOOKUP-STORE         '                03022199
030223                                      TO PV-PARAGRAPH-NAME        03022299
030224                 MOVE 'SELECT XST_SKU_LOC '                       03022399
030225                                      TO PV-DB2-OPERATION         03022499
030226                 PERFORM 9999-SQL-ABEND                           03022599
030227         END-EVALUATE                                             03022699
030228     END-PERFORM.                                                 03022799
030229                                                                  03022899
030230     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         03022999
030231       MOVE '2200-LOOKUP-STORE'                                   03023099
030232                             TO  PV-PARAGRAPH-NAME                03023199
030233       MOVE '2200- SELECT RETRIES EXCEEDED'                       03023299
030234                              TO  PV-DB2-OPERATION                03023399
030235       PERFORM 9999-SQL-ABEND                                     03023499
030236     END-IF.                                                      03023599
030237                                                                  03023699
030240****************************************************************  03024000
030300**    BYPASS SKU                                                  03030099
030400****************************************************************  03040000
030500 3000-BYPASS-SKU.                                                 03050099
030600     PERFORM 7000-WRITE-BYPASS-SKUS-FILE.                         03060099
030700                                                                  03070099
030800     IF PS-END-OF-FILE-N                                          03080099
030900         PERFORM 5000-READ-INPUT-FILE                             03090099
031000         IF PX036-SKU-NBR NOT = PV-SAVE-SKU-NBR                   03100099
031100             SET PS-SKUS-UNMATCHED-Y TO TRUE                      03110099
031200         END-IF                                                   03120099
031300     END-IF.                                                      03130099
031400                                                                  03140099
031500****************************************************************  03150000
031600**    PROCESS SKU BY STORE                                        03160000
031700****************************************************************  03170000
031800 3200-PROCESS-SKU-BY-STORE.                                       03180099
031900     MOVE ' ' TO PS-SKU-STORE-FOUND-SW.                           03190099
032602     PERFORM 4000-SELECT-SKU-BY-UPC.                              03200099
032603                                                                  03210099
032604     IF PS-SKU-STORE-FOUND-Y                                      03220099
032605         PERFORM 7000-WRITE-BYPASS-SKUS-FILE                      03230099
032606     END-IF.                                                      03240099
032607                                                                  03250000
032608     IF PS-SKU-STORE-FOUND-N                                      03260099
032700         PERFORM 6000-WRITE-SAVE-SKUS-FILE                        03270099
032800     END-IF.                                                      03280099
032900                                                                  03290000
033000     IF PS-END-OF-FILE-N                                          03300000
033100         PERFORM 5000-READ-INPUT-FILE                             03310099
033200       IF PX036-SKU-NBR NOT = PV-SAVE-SKU-NBR                     03320099
033300           SET PS-SKUS-UNMATCHED-Y TO TRUE                        03330099
033400       END-IF                                                     03340099
033500     END-IF.                                                      03350099
033600                                                                  03360000
033700****************************************************************  03370099
033800**    SAVE RECORD                                                 03380099
033900****************************************************************  03390099
034000 3400-SAVE-SKU.                                                   03400099
034100     PERFORM 6000-WRITE-SAVE-SKUS-FILE.                           03410099
034200                                                                  03420099
034300     IF PS-END-OF-FILE-N                                          03430099
034400         PERFORM 5000-READ-INPUT-FILE                             03440099
034500         IF PX036-SKU-NBR NOT = PV-SAVE-SKU-NBR                   03450099
034600             SET PS-SKUS-UNMATCHED-Y TO TRUE                      03460099
034700         END-IF                                                   03470099
034800     END-IF.                                                      03480099
034900                                                                  03490099
035000******************************************************************03500099
035100* SELECT SKU BY INTR UPC INDICATOR                                03510099
035200******************************************************************03520099
035300 4000-SELECT-SKU-BY-UPC.                                          03530099
035400     INITIALIZE DCLXST00008.                                      03540099
035500     INITIALIZE DCLXST00010.                                      03550099
035600                                                                  03560099
035700     PERFORM                                                      03570099
035800         WITH TEST AFTER                                          03580099
035900         VARYING PV-SQL-SUB                                       03590099
036000         FROM 1 BY 1                                              03600099
036100         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 03610099
036200                   OR  SQLCODE = 0                                03620099
036300                   OR  SQLCODE = +100)                            03630099
036400                                                                  03640099
036500         EXEC SQL                                                 03650099
036600           SELECT LOC_SKU_STAT_CDE                                03660099
036700                 ,BEG_TMST                                        03670099
036800           INTO   :XST00008-LOC-SKU-STAT-CDE                      03680099
036900                 ,:XST00008-BEG-TMST                              03690099
037000           FROM   XST_SKU      A                                  03700099
037100                 ,XST_SKU_LOC  B                                  03710099
037200           WHERE A.SKU_NBR       = :PX036-SKU-NBR                 03720099
037300             AND A.INTR_UPC_ID   = B.INTR_UPC_ID                  03730099
037400             AND B.LOC_NBR     = :PX036-STR-NBR                   03740099
037500             AND B.END_TMST      IS NULL                          03750099
037600           WITH UR                                                03760099
037700         END-EXEC                                                 03770099
037800                                                                  03780099
037900         EVALUATE TRUE                                            03790099
038000             WHEN SQLCODE = 0                                     03800099
038100                 SET PS-SKU-STORE-FOUND-Y TO TRUE                 03810099
038200             WHEN SQLCODE = +100                                  03820099
038300                 SET PS-SKU-STORE-FOUND-N TO TRUE                 03830099
038400             WHEN SQLCODE = -911                                  03840099
038500                 CONTINUE                                         03850099
038600             WHEN SQLWARN NOT = SPACES                            03860099
038700             WHEN SQLCODE NOT = ZERO                              03870099
038800                 MOVE '4000-SELECT-SKU-BY-STORE '                 03880099
038900                                      TO PV-PARAGRAPH-NAME        03890099
039000                 MOVE 'SELECT XST_SKU  '                          03900099
039100                                      TO PV-DB2-OPERATION         03910099
039200                 PERFORM 9999-SQL-ABEND                           03920099
039300         END-EVALUATE                                             03930099
039400     END-PERFORM.                                                 03940099
039500                                                                  03950099
039600     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         03960099
039700       MOVE '4000-SELECT-SKU-BY-STORE '                           03970099
039800                             TO  PV-PARAGRAPH-NAME                03980099
039900       MOVE '4000- SELECT RETRIES EXCEEDED'                       03990099
040000                              TO  PV-DB2-OPERATION                04000099
040100       PERFORM 9999-SQL-ABEND                                     04010099
040200     END-IF.                                                      04020099
040300                                                                  04030000
040400****************************************************************  04040000
040500*     READ INPUT FILE.                                            04050000
040600****************************************************************  04060000
040700 5000-READ-INPUT-FILE.                                            04070000
040800     READ IN-VALID-FILE INTO PX036-MOS-EXTRACT-RECORD             04080099
040900        AT END                                                    04090000
041000           SET PS-END-OF-FILE-Y      TO TRUE                      04100000
041100           SET PS-SKUS-UNMATCHED-Y   TO TRUE                      04110099
041200     END-READ.                                                    04120000
041300                                                                  04130099
041400     IF PS-END-OF-FILE-N                                          04140000
041500         ADD 1 TO PA-TOT-RECS-READ                                04150099
041600     END-IF.                                                      04160099
041700                                                                  04170099
041800****************************************************************  04180000
041900**    6000-WRITE-SAVE-SKUS-FILE.                                  04190099
042000**    WRITE VALID OUTPUT FILE WHICH CONSISTS OF RECORDS TO BE     04200099
042100**    TO BE DELETED.                                              04210099
042200**    TAKES THE EFFECTIVE DATE FROM THE INPUT FILE AND SENDS IT   04220099
042300**    IT TO THE KOHLS DATE ROUTINE WHERE THE MOS END DATE         04230099
042400**    IS FORMATTED BY SUBTRACTING '1' FROM THE BEG. DATE.         04240099
042500****************************************************************  04250099
042600 6000-WRITE-SAVE-SKUS-FILE.                                       04260099
042700     INITIALIZE PX032-VALID-MOS-ITEMS.                            04270099
042800                                                                  04280099
042900*    MOVE PX036-EFF-BEG-DTE TO DF-WORK-DATE.                      04290099
042910     MOVE XST00008-BEG-TMST(1:10) TO DF-WORK-DATE.                        
043000     PERFORM 9999-DATE-ROUTINE-DECR-DAYS.                         04300099
043200     MOVE DF-END-DATE-1-10 TO PX032-MOS-END-DATE.                 04320099
PXTEST     IF PX032-MOS-END-DATE  =  LOW-VALUES OR HIGH-VALUES          04310099
PXTEST        MOVE SPACES TO PX032-MOS-END-DATE                                 
PXTEST     END-IF.                                                              
043300     MOVE PX036-STR-NBR TO PX032-LOC-NBR.                         04330099
043400     MOVE PX036-SKU-NBR    TO PX032-SKU-NBR.                      04340099
043500     MOVE PX036-EFF-BEG-DTE TO PX032-MOS-EFF-DATE.                04350099
043600     WRITE SAVE-SKU-RECORD FROM PX032-VALID-MOS-ITEMS.            04360099
043700     ADD 1 TO  PA-TOT-SAVE.                                       04370099
043800                                                                  04380099
043900****************************************************************  04390099
044000**    7000-WRITE-BYPASS-SKUS-FILE.                                04400099
044100**    WRITE INVALID OUTPUT FILE WHICH CONSISTS OF RECORDS TO BE   04410099
044200**    BYPASSED.                                                   04420099
044300****************************************************************  04430099
044400 7000-WRITE-BYPASS-SKUS-FILE.                                     04440099
044500     INITIALIZE PX032-VALID-MOS-ITEMS.                            04450099
044600                                                                  04460099
044700     MOVE PX036-STR-NBR TO PX032-LOC-NBR.                         04470099
044800     MOVE PX036-SKU-NBR    TO PX032-SKU-NBR.                      04480099
044900     MOVE PX036-EFF-BEG-DTE TO PX032-MOS-EFF-DATE.                04490099
045000     WRITE BYPASS-SKU-RECORD FROM PX032-VALID-MOS-ITEMS.          04500099
045100     ADD 1 TO  PA-TOT-BYPASS.                                     04510099
045200                                                                  04520099
045300****************************************************************  04530099
045400*     CLOSE FILES.                                                04540099
045500****************************************************************  04550099
045600 9000-END-OF-JOB.                                                 04560099
045700     CLOSE IN-VALID-FILE                                          04570099
045800           SAVE-SKU-FILE                                          04580099
045900           BYPASS-SKU-FILE.                                       04590099
046000                                                                  04600099
046100     DISPLAY ' '.                                                 04610099
046200     DISPLAY '*********************************************'.     04620099
046300     DISPLAY '    PXKUT090 SUMMARY STATISTICS              '      04630099
046400     DISPLAY '*********************************************'.     04640099
046500     DISPLAY 'INPUT RECORDS READ........: ' PA-TOT-RECS-READ      04650099
046600     DISPLAY 'SKU RECORDS BYPASSED......: ' PA-TOT-BYPASS         04660099
046700     DISPLAY 'OUTPUT RECS SAVED.........: ' PA-TOT-SAVE           04670099
046800     DISPLAY '*********************************************'.     04680099
046900                                                                  04690000
047000******************************************************************04700099
047100*    KOHLS DATE ROUTINE                                           04710099
047200******************************************************************04720099
047300 9999-DATE-ROUTINE-DECR-DAYS.                                     04730099
047400     MOVE '9999-DATE-ROUTINE-INCR-DAYS' TO PV-PARAGRAPH-NAME.     04740099
047500                                                                  04750099
047600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              04760099
047700                                                                  04770099
047800     SET DPG51-FISCAL-454-CALENDAR   TO TRUE.                     04780099
047900     SET DPG51-DECREMENT-DATE        TO TRUE.                     04790099
048000     SET DPG52-LK-DTE-ISO-FMT        TO TRUE.                     04800099
048100     MOVE 1                          TO DPG51-INCR-DECR-DAYS-9.   04810099
048200     MOVE DF-DATE-1-10               TO DPG52-LK-DATE-INPUT.      04820099
048300     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                04830099
048400                                             DPG52                04840099
048500                                             DPG53                04850099
048600                                             DPG54                04860099
048700                                             DPG55                04870099
048800                                             DPG56.               04880099
048900     EVALUATE TRUE                                                04890099
049000        WHEN DPG54-NO-ERROR                                       04900099
049100             MOVE DPG55-DB2-ISO-DATE-FMT                          04910099
049200               TO DF-END-DATE-1-10                                04920099
049300        WHEN OTHER                                                04930099
049400             DISPLAY 'ERROR ROUTINE ABEND'                        04940099
049500     END-EVALUATE.                                                04950099
049600                                                                  04960099
049700******************************************************************04970000
049800*     SQL ABEND PARAGRAPH.                                        04980000
049900******************************************************************04990000
050000 9999-SQL-ABEND.                                                  05000000
050100     DISPLAY '** ABEND     **'.                                   05010000
050200     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        05020000
050300     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              05030000
050400     DISPLAY '** OPERATION ** = ' PV-OPERATION-MSG.               05040000
050500                                                                  05050000
050600******************************************************************05060000
050700* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     05070000
050800* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      05080000
050900******************************************************************05090000
051000     COPY DPPD004.                                                05100000
051100     SET AC-DB2-ERROR TO TRUE.                                    05110000
051200     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         05120000
