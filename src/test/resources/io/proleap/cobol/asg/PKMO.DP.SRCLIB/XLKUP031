000100 IDENTIFICATION DIVISION.                                         00010003
000200 PROGRAM-ID.    XLKUP031.                                         00020003
000300 AUTHOR.        JOE LAROSA.                                       00030003
000400 DATE-WRITTEN.  NOVEMBER, 2003.                                   00040003
000500****************************************************************  00050003
000600*    L O C A T I O N   D O M A I N   S Y N C / E X T R A C T      00060027
000700*                                                                 00070027
000800* THIS PROGRAM COMPARES TWELVE SETS OF FILES, CREATING A          00080003
000900* COMBINED OUTFILE OF THE DIFFERENCES BETWEEN EACH SET OF FILES.  00090003
001000* THE PROGRAM WILL COMPARE FILES EXTRACTED FROM RMS AGAINST LIKE  00100038
001100* FILES EXTRACTED FROM THE DB2 LOCATION DOMAIN TABLES.            00110038
001200* (EACH SET OF FILES CORRESPONDS TO A DB2 LOCATION DOMAIN TABLE)  00120027
001300*                                                                 00130027
001400* DIFFERENCES BETWEEN THE RMS & DB2 FILES WILL BE WRITTEN TO AN   00140003
001500* OUTPUT FILE AS EITHER AN ADD, DELETE OR UPDATE RECORD.          00150003
001600****************************************************************  00160003
001700 ENVIRONMENT DIVISION.                                            00170003
001800 INPUT-OUTPUT SECTION.                                            00180003
001900                                                                  00190003
002000 FILE-CONTROL.                                                    00200003
002100     SELECT RMS-TERR-FILE        ASSIGN TO INP01.                 00210008
002200     SELECT DB2-TERR-FILE        ASSIGN TO INP02.                 00220008
002300                                                                  00230003
002400     SELECT RMS-REGN-FILE        ASSIGN TO INP03.                 00240008
002500     SELECT DB2-REGN-FILE        ASSIGN TO INP04.                 00250008
002600                                                                  00260003
002700     SELECT RMS-DIST-FILE        ASSIGN TO INP05.                 00270008
002800     SELECT DB2-DIST-FILE        ASSIGN TO INP06.                 00280008
002900                                                                  00290003
003000     SELECT RMS-DC-LOC-FILE      ASSIGN TO INP07.                 00300008
003100     SELECT DB2-DC-LOC-FILE      ASSIGN TO INP08.                 00310008
003200                                                                  00320003
003300     SELECT RMS-LOC-TYP-FILE     ASSIGN TO INP09.                 00330008
003400     SELECT DB2-LOC-TYP-FILE     ASSIGN TO INP10.                 00340008
003500                                                                  00350003
003600     SELECT RMS-STZC-FILE        ASSIGN TO INP11.                 00360008
003700     SELECT DB2-STZC-FILE        ASSIGN TO INP12.                 00370008
003800                                                                  00380003
003900     SELECT RMS-STR-FMT-FILE     ASSIGN TO INP13.                 00390008
004000     SELECT DB2-STR-FMT-FILE     ASSIGN TO INP14.                 00400008
004100                                                                  00410003
004200     SELECT RMS-STR-MBSHP-FILE   ASSIGN TO INP15.                 00420008
004300     SELECT DB2-STR-MBSHP-FILE   ASSIGN TO INP16.                 00430008
004400                                                                  00440003
004500     SELECT RMS-STR-TYP-FILE     ASSIGN TO INP17.                 00450008
004600     SELECT DB2-STR-TYP-FILE     ASSIGN TO INP18.                 00460008
004700                                                                  00470003
004800     SELECT RMS-STR-GRP-FILE     ASSIGN TO INP19.                 00480008
004900     SELECT DB2-STR-GRP-FILE     ASSIGN TO INP20.                 00490008
005000                                                                  00500003
005100     SELECT RMS-STR-DTE-FILE     ASSIGN TO INP21.                 00510008
005200     SELECT DB2-STR-DTE-FILE     ASSIGN TO INP22.                 00520008
005300                                                                  00530003
005400     SELECT RMS-LOCMSTR-FILE     ASSIGN TO INP23.                 00540009
005500     SELECT RMS-LOC-WHS-FILE     ASSIGN TO INP24.                 00550009
005600     SELECT RMS-OUTLOC-FILE      ASSIGN TO INP25.                 00560009
005700     SELECT DB2-LOCMSTR-FILE     ASSIGN TO INP26.                 00570009
005800                                                                  00580003
005900     SELECT OUTPUT-FILE          ASSIGN TO OUT01.                 00590008
006000                                                                  00600003
006100****************************************************************  00610003
006200 DATA DIVISION.                                                   00620003
006300 FILE SECTION.                                                    00630003
006400                                                                  00640003
006500 FD  RMS-TERR-FILE                                                00650003
006600     LABEL RECORDS ARE STANDARD                                   00660003
006700     RECORDING MODE IS F                                          00670003
006800     BLOCK CONTAINS 0 RECORDS.                                    00680003
006900 01  RMS-TERR-FILE-REC           PIC X(57).                       00690008
007000                                                                  00700004
007100 FD  DB2-TERR-FILE                                                00710003
007200     LABEL RECORDS ARE STANDARD                                   00720003
007300     RECORDING MODE IS F                                          00730003
007400     BLOCK CONTAINS 0 RECORDS.                                    00740003
007500 01  DB2-TERR-FILE-REC           PIC X(55).                       00750008
007600                                                                  00760004
007700 FD  RMS-REGN-FILE                                                00770003
007800     LABEL RECORDS ARE STANDARD                                   00780003
007900     RECORDING MODE IS F                                          00790003
008000     BLOCK CONTAINS 0 RECORDS.                                    00800003
008100 01  RMS-REGN-FILE-REC           PIC X(62).                       00810008
008200                                                                  00820003
008300 FD  DB2-REGN-FILE                                                00830003
008400     LABEL RECORDS ARE STANDARD                                   00840003
008500     RECORDING MODE IS F                                          00850003
008600     BLOCK CONTAINS 0 RECORDS.                                    00860003
008700 01  DB2-REGN-FILE-REC           PIC X(58).                       00870008
008800                                                                  00880003
008900 FD  RMS-DIST-FILE                                                00890003
009000     LABEL RECORDS ARE STANDARD                                   00900003
009100     RECORDING MODE IS F                                          00910003
009200     BLOCK CONTAINS 0 RECORDS.                                    00920003
009300 01  RMS-DIST-FILE-REC           PIC X(62).                       00930008
009400                                                                  00940003
009500 FD  DB2-DIST-FILE                                                00950003
009600     LABEL RECORDS ARE STANDARD                                   00960003
009700     RECORDING MODE IS F                                          00970003
009800     BLOCK CONTAINS 0 RECORDS.                                    00980003
009900 01  DB2-DIST-FILE-REC           PIC X(58).                       00990008
010000                                                                  01000003
010100 FD  RMS-DC-LOC-FILE                                              01010003
010200     LABEL RECORDS ARE STANDARD                                   01020003
010300     RECORDING MODE IS F                                          01030003
010400     BLOCK CONTAINS 0 RECORDS.                                    01040003
010500 01  RMS-DC-LOC-FILE-REC         PIC X(30).                       01050008
010600                                                                  01060003
010700 FD  DB2-DC-LOC-FILE                                              01070003
010800     LABEL RECORDS ARE STANDARD                                   01080003
010900     RECORDING MODE IS F                                          01090003
011000     BLOCK CONTAINS 0 RECORDS.                                    01100003
011100 01  DB2-DC-LOC-FILE-REC         PIC X(25).                       01110019
011200                                                                  01120003
011300 FD  RMS-LOC-TYP-FILE                                             01130003
011400     LABEL RECORDS ARE STANDARD                                   01140003
011500     RECORDING MODE IS F                                          01150003
011600     BLOCK CONTAINS 0 RECORDS.                                    01160003
011700 01  RMS-LOC-TYP-FILE-REC        PIC X(34).                       01170008
011800                                                                  01180003
011900 FD  DB2-LOC-TYP-FILE                                             01190003
012000     LABEL RECORDS ARE STANDARD                                   01200003
012100     RECORDING MODE IS F                                          01210003
012200     BLOCK CONTAINS 0 RECORDS.                                    01220003
012300 01  DB2-LOC-TYP-FILE-REC        PIC X(32).                       01230008
012400                                                                  01240003
012500 FD  RMS-STZC-FILE                                                01250003
012600     LABEL RECORDS ARE STANDARD                                   01260003
012700     RECORDING MODE IS F                                          01270003
012800     BLOCK CONTAINS 0 RECORDS.                                    01280003
012900 01  RMS-STZC-FILE-REC           PIC X(34).                       01290008
013000                                                                  01300003
013100 FD  DB2-STZC-FILE                                                01310003
013200     LABEL RECORDS ARE STANDARD                                   01320003
013300     RECORDING MODE IS F                                          01330003
013400     BLOCK CONTAINS 0 RECORDS.                                    01340003
013500 01  DB2-STZC-FILE-REC           PIC X(33).                       01350008
013600                                                                  01360003
013700 FD  RMS-STR-FMT-FILE                                             01370003
013800     LABEL RECORDS ARE STANDARD                                   01380003
013900     RECORDING MODE IS F                                          01390003
014000     BLOCK CONTAINS 0 RECORDS.                                    01400003
014100 01  RMS-STR-FMT-FILE-REC        PIC X(35).                       01410008
014200                                                                  01420003
014300 FD  DB2-STR-FMT-FILE                                             01430003
014400     LABEL RECORDS ARE STANDARD                                   01440003
014500     RECORDING MODE IS F                                          01450003
014600     BLOCK CONTAINS 0 RECORDS.                                    01460003
014700 01  DB2-STR-FMT-FILE-REC        PIC X(33).                       01470008
014800                                                                  01480003
014900 FD  RMS-STR-MBSHP-FILE                                           01490003
015000     LABEL RECORDS ARE STANDARD                                   01500003
015100     RECORDING MODE IS F                                          01510003
015200     BLOCK CONTAINS 0 RECORDS.                                    01520003
015300 01  RMS-STR-MBSHP-FILE-REC      PIC X(35).                       01530008
015400                                                                  01540003
015500 FD  DB2-STR-MBSHP-FILE                                           01550003
015600     LABEL RECORDS ARE STANDARD                                   01560003
015700     RECORDING MODE IS F                                          01570003
015800     BLOCK CONTAINS 0 RECORDS.                                    01580003
015900 01  DB2-STR-MBSHP-FILE-REC      PIC X(27).                       01590020
016000                                                                  01600003
016100 FD  RMS-STR-TYP-FILE                                             01610003
016200     LABEL RECORDS ARE STANDARD                                   01620003
016300     RECORDING MODE IS F                                          01630003
016400     BLOCK CONTAINS 0 RECORDS.                                    01640003
016500 01  RMS-STR-TYP-FILE-REC        PIC X(35).                       01650008
016600                                                                  01660003
016700 FD  DB2-STR-TYP-FILE                                             01670003
016800     LABEL RECORDS ARE STANDARD                                   01680003
016900     RECORDING MODE IS F                                          01690003
017000     BLOCK CONTAINS 0 RECORDS.                                    01700003
017100 01  DB2-STR-TYP-FILE-REC        PIC X(32).                       01710008
017200                                                                  01720003
017300 FD  RMS-STR-GRP-FILE                                             01730003
017400     LABEL RECORDS ARE STANDARD                                   01740003
017500     RECORDING MODE IS F                                          01750003
017600     BLOCK CONTAINS 0 RECORDS.                                    01760003
017700 01  RMS-STR-GRP-FILE-REC        PIC X(43).                       01770008
017800                                                                  01780003
017900 FD  DB2-STR-GRP-FILE                                             01790003
018000     LABEL RECORDS ARE STANDARD                                   01800003
018100     RECORDING MODE IS F                                          01810003
018200     BLOCK CONTAINS 0 RECORDS.                                    01820003
018300 01  DB2-STR-GRP-FILE-REC        PIC X(39).                       01830020
018400                                                                  01840003
018500 FD  RMS-STR-DTE-FILE                                             01850003
018600     LABEL RECORDS ARE STANDARD                                   01860003
018700     RECORDING MODE IS F                                          01870003
018800     BLOCK CONTAINS 0 RECORDS.                                    01880003
018900 01  RMS-STR-DTE-FILE-REC        PIC X(41).                       01890008
019000                                                                  01900003
019100 FD  DB2-STR-DTE-FILE                                             01910003
019200     LABEL RECORDS ARE STANDARD                                   01920003
019300     RECORDING MODE IS F                                          01930003
019400     BLOCK CONTAINS 0 RECORDS.                                    01940003
019500 01  DB2-STR-DTE-FILE-REC        PIC X(31).                       01950021
019600                                                                  01960003
019700 FD  RMS-LOCMSTR-FILE                                             01970009
019800     LABEL RECORDS ARE STANDARD                                   01980003
019900     RECORDING MODE IS F                                          01990003
020000     BLOCK CONTAINS 0 RECORDS.                                    02000003
020100 01  RMS-LOCMSTR-FILE-REC        PIC X(687).                      02010009
020200                                                                  02020003
020300 FD  RMS-LOC-WHS-FILE                                             02030009
020400     LABEL RECORDS ARE STANDARD                                   02040009
020500     RECORDING MODE IS F                                          02050009
020600     BLOCK CONTAINS 0 RECORDS.                                    02060009
020700 01  RMS-LOC-WHS-FILE-REC        PIC X(192).                      02070009
020800                                                                  02080009
020900 FD  RMS-OUTLOC-FILE                                              02090009
021000     LABEL RECORDS ARE STANDARD                                   02100009
021100     RECORDING MODE IS F                                          02110009
021200     BLOCK CONTAINS 0 RECORDS.                                    02120009
021300 01  RMS-OUTLOC-FILE-REC         PIC X(194).                      02130009
021400                                                                  02140009
021500 FD  DB2-LOCMSTR-FILE                                             02150009
021600     LABEL RECORDS ARE STANDARD                                   02160003
021700     RECORDING MODE IS F                                          02170054
021800     BLOCK CONTAINS 0 RECORDS.                                    02180003
021900 01  DB2-LOCMSTR-FILE-REC        PIC X(713).                      02190025
022000                                                                  02200003
022100 FD  OUTPUT-FILE                                                  02210003
022200     LABEL RECORDS ARE STANDARD                                   02220003
022300     RECORDING MODE IS F                                          02230003
022400     BLOCK CONTAINS 0 RECORDS.                                    02240003
022500 01  OUTPUT-FILE-REC             PIC X(900).                      02250008
022600                                                                  02260003
022700****************************************************************  02270003
022800 WORKING-STORAGE SECTION.                                         02280003
022900                                                                  02290003
023000 01  WS-WORKING-STOAGE-VALUE     PIC X(35)  VALUE                 02300016
023100                          '*** WORKING STORAGE STARTS HERE ***'.  02310016
023200 01  PS-PROGRAM-SWITCHES.                                         02320016
023300     05  PS-EMPTY-FILE-SW        PIC X(01)  VALUE 'N'.            02330032
023400         88  PS-EMPTY-FILE-YES              VALUE 'Y'.            02340032
023500         88  PS-EMPTY-FILE-NO               VALUE 'N'.            02350032
023600     05  PS-EOF-RMS-SW           PIC X(01)  VALUE 'N'.            02360032
023700         88  PS-EOF-RMS-YES                 VALUE 'Y'.            02370032
023800         88  PS-EOF-RMS-NO                  VALUE 'N'.            02380032
023900     05  PS-EOF-DB2-SW           PIC X(01)  VALUE 'N'.            02390008
024000         88  PS-EOF-DB2-YES                 VALUE 'Y'.            02400008
024100         88  PS-EOF-DB2-NO                  VALUE 'N'.            02410008
024200                                                                  02420003
024300 01  PC-PROGRAM-CONSTANTS.                                        02430003
024400     05  PC-PROGRAM-NAME         PIC X(08)  VALUE 'XLKUP031'.     02440008
024500                                                                  02450003
024600 01  CONTROL-CARD-DATA.                                           02460033
024700     05  CC-PROGRAM-NAME         PIC X(01)  VALUE SPACES.         02470033
024800         88  CC-NIGHTLY-MAINT               VALUE '1'.            02480033
024900         88  CC-DATA-INTEGRITY              VALUE '2'.            02490033
025000     05  CC-FILLER               PIC X(79)  VALUE SPACES.         02500033
025100                                                                  02510033
025200 01  PV-PROGRAM-VARIABLES.                                        02520003
025300     05  PV-PARAGRAPH-NAME       PIC X(30)  VALUE SPACES.         02530012
025400     05  PV-REPLT-STR-NBR        PIC 9(04).                       02540025
025500     05  PV-DIST-NBR             PIC 9(04).                       02550047
025600     05  PV-STR-FMT-CDE          PIC 9(04).                       02560047
025700     05  PV-LOC-MEDN-AGE-NBR     PIC 99.99.                       02570048
025800     05  FILLER REDEFINES PV-LOC-MEDN-AGE-NBR.                    02580048
025900         10  PV-LOC-MEDN-AGE-1   PIC 99.                          02590048
026000         10  PV-LOC-MEDN-AGE-D   PIC X.                           02600048
026100         10  PV-LOC-MEDN-AGE-2   PIC 99.                          02610048
026200     05  PV-POS-RGST-BNK-QTY     PIC 9(03).                       02620047
026300     05  PV-TOT-SLG-SQ-FTG-QTY   PIC 9(08).                       02630047
026400     05  PV-TOT-SQ-FTG-QTY       PIC 9(08).                       02640047
026500     05  PV-STP-ORD-DAYS-QTY     PIC 9(03).                       02650047
026600     05  PV-STRT-ORD-DAYS-QTY    PIC 9(03).                       02660047
026700     05  PV-EST-HH-INCM-AMT      PIC 9(11).                       02670047
026800     05  PV-DIRNS-TXT.                                            02680049
026900         10 PV-DIRNS-TXT-LEN     PIC S9(4) COMP.                  02690049
027000         10 PV-DIRNS-TXT-TEXT    PIC  X(255).                     02700049
P42541*    05  PV-COMPARE-LOC          PIC 9(04).                       02710056
027200     05  PV-DISPLAY-LOC          PIC 9(04).                       02720028
027300     05  PV-DC-NBR               PIC 9(06).                       02730043
027400     05  PV-EFF-STR-GP-ID        PIC 9(10).                       02740045
027500                                                                  02750003
P42541*01  HL-HOLD-LOC-TABLE.                                           02760055
P42541*    05  HL-HOLD-LOC-ENTRY OCCURS 999 INDEXED BY HL-IDX.          02770055
P42541*        10  HL-HOLD-LOC-NBR     PIC 9(04).                       02780055
027900                                                                  02790012
028000 01  PA-PROGRAM-ACCUMULATORS.                                     02800004
028100     05  PA-TERR-ISRT-COUNT      PIC 9(07).                       02810008
028200     05  PA-TERR-UPD-COUNT       PIC 9(07).                       02820008
028300     05  PA-TERR-DEL-COUNT       PIC 9(07).                       02830008
028400     05  PA-REGN-ISRT-COUNT      PIC 9(07).                       02840008
028500     05  PA-REGN-UPD-COUNT       PIC 9(07).                       02850008
028600     05  PA-REGN-DEL-COUNT       PIC 9(07).                       02860008
028700     05  PA-DIST-ISRT-COUNT      PIC 9(07).                       02870008
028800     05  PA-DIST-UPD-COUNT       PIC 9(07).                       02880008
028900     05  PA-DIST-DEL-COUNT       PIC 9(07).                       02890008
029000     05  PA-DCLOC-ISRT-COUNT     PIC 9(07).                       02900008
029100     05  PA-DCLOC-UPD-COUNT      PIC 9(07).                       02910008
029200     05  PA-DCLOC-DEL-COUNT      PIC 9(07).                       02920008
029300     05  PA-LOC-TYP-ISRT-COUNT   PIC 9(07).                       02930008
029400     05  PA-LOC-TYP-UPD-COUNT    PIC 9(07).                       02940008
029500     05  PA-LOC-TYP-DEL-COUNT    PIC 9(07).                       02950008
029600     05  PA-STDTMZN-ISRT-COUNT   PIC 9(07).                       02960008
029700     05  PA-STDTMZN-UPD-COUNT    PIC 9(07).                       02970008
029800     05  PA-STDTMZN-DEL-COUNT    PIC 9(07).                       02980008
029900     05  PA-STR-FMT-ISRT-COUNT   PIC 9(07).                       02990008
030000     05  PA-STR-FMT-UPD-COUNT    PIC 9(07).                       03000008
030100     05  PA-STR-FMT-DEL-COUNT    PIC 9(07).                       03010008
030200     05  PA-STR-MBSHP-ISRT-COUNT PIC 9(07).                       03020008
030300     05  PA-STR-MBSHP-UPD-COUNT  PIC 9(07).                       03030008
030400     05  PA-STR-MBSHP-DEL-COUNT  PIC 9(07).                       03040008
030500     05  PA-STR-TYP-ISRT-COUNT   PIC 9(07).                       03050008
030600     05  PA-STR-TYP-UPD-COUNT    PIC 9(07).                       03060008
030700     05  PA-STR-TYP-DEL-COUNT    PIC 9(07).                       03070008
030800     05  PA-STR-GRP-ISRT-COUNT   PIC 9(07).                       03080008
030900     05  PA-STR-GRP-UPD-COUNT    PIC 9(07).                       03090008
031000     05  PA-STR-GRP-DEL-COUNT    PIC 9(07).                       03100008
031100     05  PA-STR-DTE-ISRT-COUNT   PIC 9(07).                       03110008
031200     05  PA-STR-DTE-UPD-COUNT    PIC 9(07).                       03120008
031300     05  PA-STR-DTE-DEL-COUNT    PIC 9(07).                       03130008
031400     05  PA-LOCMSTR-ISRT-COUNT   PIC 9(07).                       03140010
031500     05  PA-LOCMSTR-UPD-COUNT    PIC 9(07).                       03150010
031600     05  PA-LOCMSTR-DEL-COUNT    PIC 9(07).                       03160010
031700     05  PA-LOC-WHS-ISRT-COUNT   PIC 9(07).                       03170010
031800     05  PA-LOC-WHS-UPD-COUNT    PIC 9(07).                       03180010
031900     05  PA-LOC-WHS-DEL-COUNT    PIC 9(07).                       03190010
032000     05  PA-OUTLOC-ISRT-COUNT    PIC 9(07).                       03200010
032100     05  PA-OUTLOC-UPD-COUNT     PIC 9(07).                       03210010
032200     05  PA-OUTLOC-DEL-COUNT     PIC 9(07).                       03220010
032300                                                                  03230003
032400******************************************************************03240003
032500* LAYOUTS OF INPUT FILES.                                         03250003
032600******************************************************************03260003
032700*XLT_LOC                                                          03270003
032800     COPY HORD013.                                                03280004
032900     COPY HORD014.                                                03290004
033000     COPY HORD015.                                                03300004
033100                                                                  03310004
033200     COPY XLRD040.                                                03320045
033300                                                                  03330003
033400*XLT_TERR                                                         03340003
033500     COPY HORD010.                                                03350004
033600                                                                  03360004
033700     EXEC SQL                                                     03370003
033800         INCLUDE XLT00011                                         03380003
033900     END-EXEC.                                                    03390003
034000                                                                  03400003
034100*XLT_REGN                                                         03410003
034200     COPY HORD011.                                                03420004
034300                                                                  03430004
034400     EXEC SQL                                                     03440003
034500         INCLUDE XLT00012                                         03450003
034600     END-EXEC.                                                    03460003
034700                                                                  03470003
034800*XLT_DIST                                                         03480003
034900     COPY HORD012.                                                03490004
035000                                                                  03500004
035100     EXEC SQL                                                     03510003
035200         INCLUDE XLT00013                                         03520003
035300     END-EXEC.                                                    03530003
035400                                                                  03540003
035500*XLT_DC_LOC_ASGMT                                                 03550003
035600     COPY HORD016.                                                03560004
035700                                                                  03570004
035800     COPY XLRD041.                                                03580045
035900                                                                  03590003
036000*XLT_LOC_TYP_CDE                                                  03600003
036100     COPY HORD021.                                                03610004
036200                                                                  03620004
036300     EXEC SQL                                                     03630003
036400         INCLUDE XLT00015                                         03640003
036500     END-EXEC.                                                    03650003
036600                                                                  03660003
036700*XLT_STD_TM_ZN_CDE                                                03670003
036800     COPY HORD020.                                                03680004
036900                                                                  03690004
037000     EXEC SQL                                                     03700003
037100         INCLUDE XLT00016                                         03710003
037200     END-EXEC.                                                    03720003
037300                                                                  03730003
037400*XLT_STR_FMT_CDE                                                  03740003
037500     COPY HORD022.                                                03750004
037600                                                                  03760004
037700     EXEC SQL                                                     03770003
037800         INCLUDE XLT00017                                         03780003
037900     END-EXEC.                                                    03790003
038000                                                                  03800003
038100*XLT_STR_GP_MBSHP                                                 03810003
038200     COPY HORD019.                                                03820004
038300                                                                  03830004
038400     EXEC SQL                                                     03840003
038500         INCLUDE XLT00018                                         03850003
038600     END-EXEC.                                                    03860003
038700                                                                  03870003
038800*XLT_STR_GP_TYP                                                   03880003
038900     COPY HORD017.                                                03890004
039000                                                                  03900004
039100     EXEC SQL                                                     03910003
039200         INCLUDE XLT00019                                         03920003
039300     END-EXEC.                                                    03930003
039400                                                                  03940003
039500*XLT_STR_GP                                                       03950003
039600     COPY HORD018.                                                03960004
039700                                                                  03970004
039800     COPY XLRD042.                                                03980045
039900                                                                  03990003
040000*XLT_STR_GP_DTE                                                   04000003
040100     COPY HORD023.                                                04010004
040200                                                                  04020004
040300     COPY XLRD043.                                                04030045
040400                                                                  04040003
040500                                                                  04050003
040600     EXEC SQL                                                     04060003
040700         INCLUDE SQLCA                                            04070003
040800     END-EXEC.                                                    04080003
040900                                                                  04090003
041000******************************************************************04100003
041100* COPYBOOK OF OUTPUT FILE.                                        04110003
041200******************************************************************04120003
041300     COPY XLRD037.                                                04130005
041400                                                                  04140003
041500/*****************************************************************04150003
041600 PROCEDURE DIVISION.                                              04160003
041700                                                                  04170003
041800     PERFORM 1000-INITIALIZATION.                                 04180004
041900                                                                  04190004
042000*CHECK IF ANY EMPTY RMS FILES (ERROR MESSAGE).                    04200032
042100     SET PS-EMPTY-FILE-NO TO TRUE.                                04210032
042200     PERFORM 8000-READ-INP01-FILE.                                04220032
042300     PERFORM 8020-READ-INP03-FILE.                                04230032
042400     PERFORM 8040-READ-INP05-FILE.                                04240032
042500     PERFORM 8060-READ-INP07-FILE.                                04250032
042600     PERFORM 8080-READ-INP09-FILE.                                04260032
042700     PERFORM 8100-READ-INP11-FILE.                                04270032
042800     PERFORM 8120-READ-INP13-FILE.                                04280032
042900     PERFORM 8140-READ-INP15-FILE.                                04290032
043000     PERFORM 8160-READ-INP17-FILE.                                04300032
043100     PERFORM 8180-READ-INP19-FILE.                                04310032
043200     PERFORM 8200-READ-INP21-FILE.                                04320032
043300     PERFORM 8220-READ-INP23-FILE.                                04330032
043400     PERFORM 8240-READ-INP24-FILE.                                04340032
043500     PERFORM 8250-READ-INP25-FILE.                                04350032
043600     IF PS-EMPTY-FILE-YES                                         04360032
043700         PERFORM 1100-CLOSE-INPUT-FILES                           04370032
043800         MOVE 4095 TO RETURN-CODE                                 04380032
043900         PERFORM 9999-TERMINATE                                   04390032
044000         GOBACK.                                                  04400032
044100                                                                  04410032
044200*COMPARE TERR.                                                    04420032
044300     SET PS-EOF-RMS-NO TO TRUE.                                   04430004
044400     SET PS-EOF-DB2-NO TO TRUE.                                   04440004
044500     PERFORM 8010-READ-INP02-FILE.                                04450004
044600     PERFORM 2000-PROCESS-TERR                                    04460006
044700       UNTIL PS-EOF-RMS-YES                                       04470004
044800          OR PS-EOF-DB2-YES.                                      04480004
044900                                                                  04490003
045000     IF PS-EOF-RMS-YES                                            04500004
045100         PERFORM 2010-PROCESS-INP02                               04510004
045200           UNTIL PS-EOF-DB2-YES                                   04520004
045300     ELSE                                                         04530003
045400         PERFORM 2020-PROCESS-INP01                               04540004
045500           UNTIL PS-EOF-RMS-YES                                   04550004
045600     END-IF.                                                      04560003
045700                                                                  04570003
045800     CLOSE RMS-TERR-FILE                                          04580004
045900           DB2-TERR-FILE.                                         04590004
046000                                                                  04600004
046100*COMPARE REGN.                                                    04610003
046200     SET PS-EOF-RMS-NO TO TRUE.                                   04620004
046300     SET PS-EOF-DB2-NO TO TRUE.                                   04630004
046400     PERFORM 8030-READ-INP04-FILE.                                04640004
046500     PERFORM 2100-PROCESS-REGN                                    04650006
046600       UNTIL PS-EOF-RMS-YES                                       04660004
046700          OR PS-EOF-DB2-YES.                                      04670004
046800                                                                  04680004
046900     IF PS-EOF-RMS-YES                                            04690004
047000         PERFORM 2110-PROCESS-INP04                               04700004
047100           UNTIL PS-EOF-DB2-YES                                   04710004
047200     ELSE                                                         04720004
047300         PERFORM 2120-PROCESS-INP03                               04730004
047400           UNTIL PS-EOF-RMS-YES                                   04740004
047500     END-IF.                                                      04750004
047600                                                                  04760004
047700     CLOSE RMS-REGN-FILE                                          04770004
047800           DB2-REGN-FILE.                                         04780004
047900                                                                  04790003
048000*COMPARE DIST.                                                    04800003
048100     SET PS-EOF-RMS-NO TO TRUE.                                   04810004
048200     SET PS-EOF-DB2-NO TO TRUE.                                   04820004
048300     PERFORM 8050-READ-INP06-FILE.                                04830004
048400     PERFORM 2200-PROCESS-DIST                                    04840006
048500       UNTIL PS-EOF-RMS-YES                                       04850004
048600          OR PS-EOF-DB2-YES.                                      04860004
048700                                                                  04870004
048800     IF PS-EOF-RMS-YES                                            04880004
048900         PERFORM 2210-PROCESS-INP06                               04890004
049000           UNTIL PS-EOF-DB2-YES                                   04900004
049100     ELSE                                                         04910004
049200         PERFORM 2220-PROCESS-INP05                               04920004
049300           UNTIL PS-EOF-RMS-YES                                   04930004
049400     END-IF.                                                      04940004
049500                                                                  04950004
049600     CLOSE RMS-DIST-FILE                                          04960005
049700           DB2-DIST-FILE.                                         04970005
049800                                                                  04980003
049900*COMPARE DC-LOC-ASGMT.                                            04990006
050000     SET PS-EOF-RMS-NO TO TRUE.                                   05000006
050100     SET PS-EOF-DB2-NO TO TRUE.                                   05010006
050200     PERFORM 8070-READ-INP08-FILE.                                05020006
050300     PERFORM 2300-PROCESS-DC-LOC                                  05030006
050400       UNTIL PS-EOF-RMS-YES                                       05040006
050500          OR PS-EOF-DB2-YES.                                      05050006
050600                                                                  05060006
050700     IF PS-EOF-RMS-YES                                            05070006
050800         PERFORM 2310-PROCESS-INP08                               05080006
050900           UNTIL PS-EOF-DB2-YES                                   05090006
051000     ELSE                                                         05100006
051100         PERFORM 2320-PROCESS-INP07                               05110006
051200           UNTIL PS-EOF-RMS-YES                                   05120006
051300     END-IF.                                                      05130006
051400                                                                  05140006
051500     CLOSE RMS-DC-LOC-FILE                                        05150006
051600           DB2-DC-LOC-FILE.                                       05160006
051700                                                                  05170006
051800*COMPARE LOC-TYP-CDE.                                             05180006
051900     SET PS-EOF-RMS-NO TO TRUE.                                   05190006
052000     SET PS-EOF-DB2-NO TO TRUE.                                   05200006
052100     PERFORM 8090-READ-INP10-FILE.                                05210006
052200     PERFORM 2400-PROCESS-LOC-TYP                                 05220006
052300       UNTIL PS-EOF-RMS-YES                                       05230006
052400          OR PS-EOF-DB2-YES.                                      05240006
052500                                                                  05250006
052600     IF PS-EOF-RMS-YES                                            05260006
052700         PERFORM 2410-PROCESS-INP10                               05270006
052800           UNTIL PS-EOF-DB2-YES                                   05280006
052900     ELSE                                                         05290006
053000         PERFORM 2420-PROCESS-INP09                               05300006
053100           UNTIL PS-EOF-RMS-YES                                   05310006
053200     END-IF.                                                      05320006
053300                                                                  05330006
053400     CLOSE RMS-LOC-TYP-FILE                                       05340006
053500           DB2-LOC-TYP-FILE.                                      05350006
053600                                                                  05360006
053700*COMPARE STD-TM-ZN-CDE.                                           05370006
053800     SET PS-EOF-RMS-NO TO TRUE.                                   05380006
053900     SET PS-EOF-DB2-NO TO TRUE.                                   05390006
054000     PERFORM 8110-READ-INP12-FILE.                                05400006
054100     PERFORM 2500-PROCESS-STDTMZN                                 05410006
054200       UNTIL PS-EOF-RMS-YES                                       05420006
054300          OR PS-EOF-DB2-YES.                                      05430006
054400                                                                  05440006
P42541*    IF PS-EOF-RMS-YES                                            05450055
P42541*        PERFORM 2510-PROCESS-INP12                               05460055
P42541*          UNTIL PS-EOF-DB2-YES                                   05470055
P42541*    ELSE                                                         05480055
P42541*        PERFORM 2520-PROCESS-INP11                               05490055
P42541*          UNTIL PS-EOF-RMS-YES                                   05500055
P42541*    END-IF.                                                      05510055
P42541                                                                  05511055
P42541     IF PS-EOF-DB2-YES                                            05512055
P42541         PERFORM 2520-PROCESS-INP11                               05513055
P42541           UNTIL PS-EOF-RMS-YES                                   05514055
P42541     END-IF.                                                      05515055
055200                                                                  05520006
055300     CLOSE RMS-STZC-FILE                                          05530006
055400           DB2-STZC-FILE.                                         05540006
055500                                                                  05550006
055600*COMPARE STR-FMT-CDE.                                             05560006
055700     SET PS-EOF-RMS-NO TO TRUE.                                   05570006
055800     SET PS-EOF-DB2-NO TO TRUE.                                   05580006
055900     PERFORM 8130-READ-INP14-FILE.                                05590006
056000     PERFORM 2600-PROCESS-STR-FMT                                 05600006
056100       UNTIL PS-EOF-RMS-YES                                       05610006
056200          OR PS-EOF-DB2-YES.                                      05620006
056300                                                                  05630006
056400     IF PS-EOF-RMS-YES                                            05640006
056500         PERFORM 2610-PROCESS-INP14                               05650006
056600           UNTIL PS-EOF-DB2-YES                                   05660006
056700     ELSE                                                         05670006
056800         PERFORM 2620-PROCESS-INP13                               05680006
056900           UNTIL PS-EOF-RMS-YES                                   05690006
057000     END-IF.                                                      05700006
057100                                                                  05710006
057200     CLOSE RMS-STR-FMT-FILE                                       05720006
057300           DB2-STR-FMT-FILE.                                      05730006
057400                                                                  05740006
057500*COMPARE STR-GP-MBSHP.                                            05750007
057600     SET PS-EOF-RMS-NO TO TRUE.                                   05760007
057700     SET PS-EOF-DB2-NO TO TRUE.                                   05770007
057800     PERFORM 8150-READ-INP16-FILE.                                05780007
057900     PERFORM 2700-PROCESS-STR-MBSHP                               05790007
058000       UNTIL PS-EOF-RMS-YES                                       05800007
058100          OR PS-EOF-DB2-YES.                                      05810007
058200                                                                  05820007
058300     IF PS-EOF-RMS-YES                                            05830007
058400         PERFORM 2710-PROCESS-INP16                               05840007
058500           UNTIL PS-EOF-DB2-YES                                   05850007
058600     ELSE                                                         05860007
058700         PERFORM 2720-PROCESS-INP15                               05870007
058800           UNTIL PS-EOF-RMS-YES                                   05880007
058900     END-IF.                                                      05890007
059000                                                                  05900007
059100     CLOSE RMS-STR-MBSHP-FILE                                     05910007
059200           DB2-STR-MBSHP-FILE.                                    05920007
059300                                                                  05930007
059400*COMPARE STR-GP-TYP.                                              05940007
059500     SET PS-EOF-RMS-NO TO TRUE.                                   05950008
059600     SET PS-EOF-DB2-NO TO TRUE.                                   05960008
059700     PERFORM 8170-READ-INP18-FILE.                                05970008
059800     PERFORM 2800-PROCESS-STR-TYP                                 05980008
059900       UNTIL PS-EOF-RMS-YES                                       05990008
060000          OR PS-EOF-DB2-YES.                                      06000008
060100                                                                  06010008
060200     IF PS-EOF-RMS-YES                                            06020008
060300         PERFORM 2810-PROCESS-INP18                               06030008
060400           UNTIL PS-EOF-DB2-YES                                   06040008
060500     ELSE                                                         06050008
060600         PERFORM 2820-PROCESS-INP17                               06060008
060700           UNTIL PS-EOF-RMS-YES                                   06070008
060800     END-IF.                                                      06080008
060900                                                                  06090008
061000     CLOSE RMS-STR-TYP-FILE                                       06100008
061100           DB2-STR-TYP-FILE.                                      06110008
061200                                                                  06120008
061300*COMPARE STR-GP.                                                  06130007
061400     SET PS-EOF-RMS-NO TO TRUE.                                   06140008
061500     SET PS-EOF-DB2-NO TO TRUE.                                   06150008
061600     PERFORM 8190-READ-INP20-FILE.                                06160008
061700     PERFORM 2900-PROCESS-STR-GRP                                 06170008
061800       UNTIL PS-EOF-RMS-YES                                       06180008
061900          OR PS-EOF-DB2-YES.                                      06190008
062000                                                                  06200008
062100     IF PS-EOF-RMS-YES                                            06210008
062200         PERFORM 2910-PROCESS-INP20                               06220008
062300           UNTIL PS-EOF-DB2-YES                                   06230008
062400     ELSE                                                         06240008
062500         PERFORM 2920-PROCESS-INP19                               06250008
062600           UNTIL PS-EOF-RMS-YES                                   06260008
062700     END-IF.                                                      06270008
062800                                                                  06280008
062900     CLOSE RMS-STR-GRP-FILE                                       06290008
063000           DB2-STR-GRP-FILE.                                      06300008
063100                                                                  06310008
063200*COMPARE STR-GP-DTE.                                              06320007
063300     SET PS-EOF-RMS-NO TO TRUE.                                   06330009
063400     SET PS-EOF-DB2-NO TO TRUE.                                   06340009
063500     PERFORM 8210-READ-INP22-FILE.                                06350009
063600     PERFORM 3000-PROCESS-STR-DTE                                 06360009
063700       UNTIL PS-EOF-RMS-YES                                       06370009
063800          OR PS-EOF-DB2-YES.                                      06380009
063900                                                                  06390009
064000     IF PS-EOF-RMS-YES                                            06400009
064100         PERFORM 3010-PROCESS-INP22                               06410009
064200           UNTIL PS-EOF-DB2-YES                                   06420009
064300     ELSE                                                         06430009
064400         PERFORM 3020-PROCESS-INP21                               06440009
064500           UNTIL PS-EOF-RMS-YES                                   06450009
064600     END-IF.                                                      06460009
064700                                                                  06470009
064800     CLOSE RMS-STR-DTE-FILE                                       06480009
064900           DB2-STR-DTE-FILE.                                      06490009
065000                                                                  06500009
065100*COMPARE STR-LOCATION.                                            06510010
P42541*    INITIALIZE HL-HOLD-LOC-TABLE.                                06520055
P42541*    SET HL-IDX TO 1.                                             06530055
065400                                                                  06540012
065500     OPEN INPUT DB2-LOCMSTR-FILE.                                 06550012
065600     SET PS-EOF-RMS-NO TO TRUE.                                   06560010
065700     SET PS-EOF-DB2-NO TO TRUE.                                   06570010
065800     PERFORM 8230-READ-INP26-FILE.                                06580010
065900     PERFORM 3100-PROCESS-LOCMSTR                                 06590010
066000       UNTIL PS-EOF-RMS-YES                                       06600010
066100          OR PS-EOF-DB2-YES.                                      06610010
066200                                                                  06620010
P42541*    IF PS-EOF-RMS-YES                                            06630055
P42541*        PERFORM 3110-PROCESS-INP26                               06640055
P42541*          UNTIL PS-EOF-DB2-YES                                   06650055
P42541*    ELSE                                                         06660055
P42541*        PERFORM 3120-PROCESS-INP23                               06670055
P42541*          UNTIL PS-EOF-RMS-YES                                   06680055
P42541*    END-IF.                                                      06690055
P42541                                                                  06691055
P42541     IF PS-EOF-DB2-YES                                            06692055
P42541         PERFORM 3120-PROCESS-INP23                               06693055
P42541           UNTIL PS-EOF-RMS-YES                                   06694055
P42541     END-IF.                                                      06695055
067000                                                                  06700010
067100     CLOSE RMS-LOCMSTR-FILE                                       06710010
067200           DB2-LOCMSTR-FILE.                                      06720010
067300                                                                  06730010
067400*COMPARE STR-WAREHOUSE.                                           06740010
067500     OPEN INPUT DB2-LOCMSTR-FILE.                                 06750012
067600     SET PS-EOF-RMS-NO TO TRUE.                                   06760012
067700     SET PS-EOF-DB2-NO TO TRUE.                                   06770012
067800     PERFORM 8230-READ-INP26-FILE.                                06780012
067900     PERFORM 3200-PROCESS-LOC-WHS                                 06790012
068000       UNTIL PS-EOF-RMS-YES                                       06800012
068100          OR PS-EOF-DB2-YES.                                      06810012
068200                                                                  06820012
P42541*    IF PS-EOF-RMS-YES                                            06830055
P42541*        PERFORM 3210-PROCESS-INP26                               06840055
P42541*          UNTIL PS-EOF-DB2-YES                                   06850055
P42541*    ELSE                                                         06860055
P42541*        PERFORM 3220-PROCESS-INP24                               06870055
P42541*          UNTIL PS-EOF-RMS-YES                                   06880055
P42541*    END-IF.                                                      06890055
P42541                                                                  06891055
P42541     IF PS-EOF-DB2-YES                                            06892055
P42541         PERFORM 3220-PROCESS-INP24                               06893055
P42541           UNTIL PS-EOF-RMS-YES                                   06894055
P42541     END-IF.                                                      06895055
069000                                                                  06900012
069100     CLOSE RMS-LOC-WHS-FILE                                       06910012
069200           DB2-LOCMSTR-FILE.                                      06920012
069300                                                                  06930010
069400*COMPARE STR-OUTSIDE.                                             06940010
069500     OPEN INPUT DB2-LOCMSTR-FILE.                                 06950013
069600     SET PS-EOF-RMS-NO TO TRUE.                                   06960013
069700     SET PS-EOF-DB2-NO TO TRUE.                                   06970013
069800     PERFORM 8230-READ-INP26-FILE.                                06980013
069900     PERFORM 3300-PROCESS-OUTLOC                                  06990013
070000       UNTIL PS-EOF-RMS-YES                                       07000013
070100          OR PS-EOF-DB2-YES.                                      07010013
070200                                                                  07020013
P42541*    IF PS-EOF-RMS-YES                                            07030055
P42541*        PERFORM 3310-PROCESS-INP26                               07040055
P42541*          UNTIL PS-EOF-DB2-YES                                   07050055
P42541*    ELSE                                                         07060055
P42541*        PERFORM 3320-PROCESS-INP25                               07070055
P42541*          UNTIL PS-EOF-RMS-YES                                   07080055
P42541*    END-IF.                                                      07090055
P42541                                                                  07091055
P42541     IF PS-EOF-DB2-YES                                            07092055
P42541         PERFORM 3320-PROCESS-INP25                               07093055
P42541           UNTIL PS-EOF-RMS-YES                                   07094055
P42541     END-IF.                                                      07095055
071000                                                                  07100013
071100     CLOSE RMS-OUTLOC-FILE                                        07110013
071200           DB2-LOCMSTR-FILE.                                      07120013
071300                                                                  07130007
071400*COMPLETE LOCATION PROCESSING.                                    07140013
P42541*    PERFORM 7100-DLT-FROM-LOC-TABLE.                             07150055
071600                                                                  07160013
071700*FINISH PROCESSING.                                               07170013
071800     PERFORM 9999-TERMINATE.                                      07180003
071900                                                                  07190003
072000     GOBACK.                                                      07200003
072100                                                                  07210003
072200******************************************************************07220003
072300*             I N I T I A L I Z A T I O N                        *07230004
072400******************************************************************07240003
072500 1000-INITIALIZATION.                                             07250004
072600     MOVE '1000-INITIALIZATION           ' TO PV-PARAGRAPH-NAME.  07260008
072700                                                                  07270004
072800*OPEN FILES.                                                      07280004
072900     OPEN INPUT  RMS-TERR-FILE                                    07290004
073000                 DB2-TERR-FILE                                    07300004
073100                 RMS-REGN-FILE                                    07310004
073200                 DB2-REGN-FILE                                    07320004
073300                 RMS-DIST-FILE                                    07330004
073400                 DB2-DIST-FILE                                    07340004
073500                 RMS-DC-LOC-FILE                                  07350004
073600                 DB2-DC-LOC-FILE                                  07360004
073700                 RMS-LOC-TYP-FILE                                 07370004
073800                 DB2-LOC-TYP-FILE                                 07380004
073900                 RMS-STZC-FILE                                    07390004
074000                 DB2-STZC-FILE                                    07400004
074100                 RMS-STR-FMT-FILE                                 07410004
074200                 DB2-STR-FMT-FILE                                 07420004
074300                 RMS-STR-MBSHP-FILE                               07430004
074400                 DB2-STR-MBSHP-FILE                               07440004
074500                 RMS-STR-TYP-FILE                                 07450004
074600                 DB2-STR-TYP-FILE                                 07460004
074700                 RMS-STR-GRP-FILE                                 07470004
074800                 DB2-STR-GRP-FILE                                 07480004
074900                 RMS-STR-DTE-FILE                                 07490004
075000                 DB2-STR-DTE-FILE                                 07500004
075100                 RMS-LOCMSTR-FILE                                 07510009
075200                 RMS-LOC-WHS-FILE                                 07520009
075300                 RMS-OUTLOC-FILE                                  07530009
075400          OUTPUT OUTPUT-FILE.                                     07540004
075500                                                                  07550004
075600*SET COUNTERS TO ZERO.                                            07560004
075700     INITIALIZE PA-PROGRAM-ACCUMULATORS.                          07570004
075800                                                                  07580004
075900*READ SYSIN CONTROL CARD.                                         07590033
076000     ACCEPT CONTROL-CARD-DATA FROM SYSIN.                         07600033
076100                                                                  07610033
076200******************************************************************07620032
076300 1100-CLOSE-INPUT-FILES.                                          07630032
076400     MOVE '1100-CLOSE-INPUT-FILES        ' TO PV-PARAGRAPH-NAME.  07640032
076500                                                                  07650032
076600     CLOSE RMS-TERR-FILE                                          07660032
076700           DB2-TERR-FILE                                          07670032
076800           RMS-REGN-FILE                                          07680032
076900           DB2-REGN-FILE                                          07690032
077000           RMS-DIST-FILE                                          07700032
077100           DB2-DIST-FILE                                          07710032
077200           RMS-DC-LOC-FILE                                        07720032
077300           DB2-DC-LOC-FILE                                        07730032
077400           RMS-LOC-TYP-FILE                                       07740032
077500           DB2-LOC-TYP-FILE                                       07750032
077600           RMS-STZC-FILE                                          07760032
077700           DB2-STZC-FILE                                          07770032
077800           RMS-STR-FMT-FILE                                       07780032
077900           DB2-STR-FMT-FILE                                       07790032
078000           RMS-STR-MBSHP-FILE                                     07800032
078100           DB2-STR-MBSHP-FILE                                     07810032
078200           RMS-STR-TYP-FILE                                       07820032
078300           DB2-STR-TYP-FILE                                       07830032
078400           RMS-STR-GRP-FILE                                       07840032
078500           DB2-STR-GRP-FILE                                       07850032
078600           RMS-STR-DTE-FILE                                       07860032
078700           DB2-STR-DTE-FILE                                       07870032
078800           RMS-LOCMSTR-FILE                                       07880032
078900           RMS-LOC-WHS-FILE                                       07890032
079000           RMS-OUTLOC-FILE.                                       07900032
079100                                                                  07910032
079200******************************************************************07920004
079300*         P R O C E S S   T E R R I T O R Y                      *07930004
079400******************************************************************07940004
079500 2000-PROCESS-TERR.                                               07950006
079600     MOVE '2000-PROCESS-TERR             ' TO PV-PARAGRAPH-NAME.  07960008
079700                                                                  07970003
079800     IF HO010-TERR-NBR = XLT00011-TERR-NBR                        07980004
079900         IF HO010-TERR-NM = XLT00011-TERR-NM                      07990004
080000           AND HO010-TERR-MGR-NM = XLT00011-TERR-MGR-NM           08000004
080100             PERFORM 8000-READ-INP01-FILE                         08010004
080200             PERFORM 8010-READ-INP02-FILE                         08020004
080300         ELSE                                                     08030003
080400             INITIALIZE XL037-TRANS-REC                           08040005
080500             MOVE '2'  TO XL037-ACTION-TYPE                       08050035
080600             MOVE 'D'  TO XL037-RECORD-TYPE                       08060012
080700             MOVE '16' TO XL037-SORT-SEQUENCE                     08070036
080800                                                                  08080005
080900             MOVE HO010-TERR-NBR    TO XL037-TERR-NBR             08090005
081000             MOVE HO010-TERR-NM     TO XL037-TERR-NM              08100005
081100             MOVE HO010-TERR-MGR-NM TO XL037-TERR-MGR-NM          08110005
081200                                                                  08120005
081300             PERFORM 9000-WRITE-OUTPUT-REC                        08130003
081400             ADD 1 TO PA-TERR-UPD-COUNT                           08140004
081500                                                                  08150005
081600             PERFORM 8000-READ-INP01-FILE                         08160004
081700             PERFORM 8010-READ-INP02-FILE                         08170004
081800     ELSE                                                         08180003
081900     IF HO010-TERR-NBR > XLT00011-TERR-NBR                        08190004
082000         PERFORM 2010-PROCESS-INP02                               08200004
082100     ELSE                                                         08210003
082200     IF XLT00011-TERR-NBR > HO010-TERR-NBR                        08220004
082300         PERFORM 2020-PROCESS-INP01                               08230004
082400     END-IF                                                       08240003
082500     END-IF                                                       08250003
082600     END-IF.                                                      08260003
082700                                                                  08270003
082800******************************************************************08280003
082900 2010-PROCESS-INP02.                                              08290004
083000     MOVE '2010-PROCESS-INP02            ' TO PV-PARAGRAPH-NAME.  08300008
083100                                                                  08310003
083200     INITIALIZE XL037-TRANS-REC.                                  08320005
083300                                                                  08330005
083400     MOVE '3'  TO XL037-ACTION-TYPE.                              08340035
083500     MOVE 'D'  TO XL037-RECORD-TYPE.                              08350012
083600     MOVE '33' TO XL037-SORT-SEQUENCE.                            08360036
083700                                                                  08370005
083800     MOVE XLT00011-TERR-NBR TO XL037-TERR-NBR.                    08380005
083900                                                                  08390003
084000     PERFORM 9000-WRITE-OUTPUT-REC.                               08400003
084100     ADD 1 TO PA-TERR-DEL-COUNT.                                  08410004
084200                                                                  08420003
084300     PERFORM 8010-READ-INP02-FILE.                                08430004
084400                                                                  08440003
084500******************************************************************08450003
084600 2020-PROCESS-INP01.                                              08460004
084700     MOVE '2020-PROCESS-INP01            ' TO PV-PARAGRAPH-NAME.  08470008
084800                                                                  08480003
084900     INITIALIZE XL037-TRANS-REC.                                  08490005
085000                                                                  08500005
085100     MOVE '1'  TO XL037-ACTION-TYPE.                              08510035
085200     MOVE 'D'  TO XL037-RECORD-TYPE.                              08520012
085300     MOVE '04' TO XL037-SORT-SEQUENCE.                            08530036
085400                                                                  08540005
085500     MOVE HO010-TERR-NBR    TO XL037-TERR-NBR.                    08550005
085600     MOVE HO010-TERR-NM     TO XL037-TERR-NM.                     08560005
085700     MOVE HO010-TERR-MGR-NM TO XL037-TERR-MGR-NM.                 08570005
085800                                                                  08580003
085900     PERFORM 9000-WRITE-OUTPUT-REC.                               08590003
086000     ADD 1 TO PA-TERR-ISRT-COUNT.                                 08600004
086100                                                                  08610003
086200     PERFORM 8000-READ-INP01-FILE.                                08620004
086300                                                                  08630003
086400******************************************************************08640004
086500*                P R O C E S S   R E G I O N                     *08650004
086600******************************************************************08660004
086700 2100-PROCESS-REGN.                                               08670006
086800     MOVE '2100-PROCESS-REGN             ' TO PV-PARAGRAPH-NAME.  08680008
086900                                                                  08690004
087000     IF HO011-REGN-NBR = XLT00012-REGN-NBR                        08700004
087100         IF HO011-REGN-TERR-NBR  = XLT00012-TERR-NBR              08710004
087200           AND HO011-REGN-NM     = XLT00012-REGN-NM               08720004
087300           AND HO011-REGN-MGR-NM = XLT00012-REGN-MGR-NM           08730004
087400             PERFORM 8020-READ-INP03-FILE                         08740004
087500             PERFORM 8030-READ-INP04-FILE                         08750004
087600         ELSE                                                     08760004
087700             INITIALIZE XL037-TRANS-REC                           08770005
087800             MOVE '2'  TO XL037-ACTION-TYPE                       08780035
087900             MOVE 'E'  TO XL037-RECORD-TYPE                       08790012
088000             MOVE '17' TO XL037-SORT-SEQUENCE                     08800036
088100                                                                  08810005
088200             MOVE HO011-REGN-NBR      TO XL037-REGN-NBR           08820005
088300             MOVE HO011-REGN-NM       TO XL037-REGN-NM            08830005
088400             MOVE HO011-REGN-MGR-NM   TO XL037-REGN-MGR-NM        08840005
088500             MOVE HO011-REGN-TERR-NBR TO XL037-REGN-TERR-NBR      08850005
088600                                                                  08860005
088700             PERFORM 9000-WRITE-OUTPUT-REC                        08870004
088800             ADD 1 TO PA-REGN-UPD-COUNT                           08880004
088900                                                                  08890005
089000             PERFORM 8020-READ-INP03-FILE                         08900004
089100             PERFORM 8030-READ-INP04-FILE                         08910004
089200     ELSE                                                         08920004
089300     IF HO011-REGN-NBR > XLT00012-REGN-NBR                        08930004
089400         PERFORM 2110-PROCESS-INP04                               08940004
089500     ELSE                                                         08950004
089600     IF XLT00012-REGN-NBR > HO011-REGN-NBR                        08960004
089700         PERFORM 2120-PROCESS-INP03                               08970004
089800     END-IF                                                       08980004
089900     END-IF                                                       08990004
090000     END-IF.                                                      09000004
090100                                                                  09010004
090200******************************************************************09020004
090300 2110-PROCESS-INP04.                                              09030004
090400     MOVE '2110-PROCESS-INP04            ' TO PV-PARAGRAPH-NAME.  09040008
090500                                                                  09050004
090600     INITIALIZE XL037-TRANS-REC.                                  09060005
090700                                                                  09070005
090800     MOVE '3'  TO XL037-ACTION-TYPE.                              09080035
090900     MOVE 'E'  TO XL037-RECORD-TYPE.                              09090012
091000     MOVE '32' TO XL037-SORT-SEQUENCE.                            09100036
091100                                                                  09110005
091200     MOVE XLT00012-REGN-NBR TO XL037-REGN-NBR.                    09120005
091300                                                                  09130005
091400     PERFORM 9000-WRITE-OUTPUT-REC.                               09140004
091500     ADD 1 TO PA-REGN-DEL-COUNT.                                  09150004
091600                                                                  09160004
091700     PERFORM 8030-READ-INP04-FILE.                                09170004
091800                                                                  09180004
091900******************************************************************09190004
092000 2120-PROCESS-INP03.                                              09200004
092100     MOVE '2120-PROCESS-INP03            ' TO PV-PARAGRAPH-NAME.  09210008
092200                                                                  09220004
092300     INITIALIZE XL037-TRANS-REC.                                  09230005
092400                                                                  09240005
092500     MOVE '1'  TO XL037-ACTION-TYPE.                              09250035
092600     MOVE 'E'  TO XL037-RECORD-TYPE.                              09260012
092700     MOVE '05' TO XL037-SORT-SEQUENCE.                            09270036
092800                                                                  09280005
092900     MOVE HO011-REGN-NBR      TO XL037-REGN-NBR.                  09290005
093000     MOVE HO011-REGN-NM       TO XL037-REGN-NM.                   09300005
093100     MOVE HO011-REGN-MGR-NM   TO XL037-REGN-MGR-NM.               09310005
093200     MOVE HO011-REGN-TERR-NBR TO XL037-REGN-TERR-NBR.             09320005
093300                                                                  09330004
093400     PERFORM 9000-WRITE-OUTPUT-REC.                               09340004
093500     ADD 1 TO PA-REGN-ISRT-COUNT.                                 09350004
093600                                                                  09360004
093700     PERFORM 8020-READ-INP03-FILE.                                09370004
093800                                                                  09380004
093900******************************************************************09390004
094000*             P R O C E S S   D I S T R I C T                    *09400004
094100******************************************************************09410004
094200 2200-PROCESS-DIST.                                               09420006
094300     MOVE '2200-PROCESS-DIST             ' TO PV-PARAGRAPH-NAME.  09430008
094400                                                                  09440004
094500     IF HO012-DIST-NBR = XLT00013-DIST-NBR                        09450004
094600         IF HO012-DIST-REGN-NBR  = XLT00013-REGN-NBR              09460004
094700           AND HO012-DIST-NM     = XLT00013-DIST-NM               09470004
094800           AND HO012-DIST-MGR-NM = XLT00013-DIST-MGR-NM           09480004
094900             PERFORM 8040-READ-INP05-FILE                         09490004
095000             PERFORM 8050-READ-INP06-FILE                         09500004
095100         ELSE                                                     09510004
095200             INITIALIZE XL037-TRANS-REC                           09520005
095300             MOVE '2'  TO XL037-ACTION-TYPE                       09530035
095400             MOVE 'F'  TO XL037-RECORD-TYPE                       09540012
095500             MOVE '18' TO XL037-SORT-SEQUENCE                     09550036
095600                                                                  09560005
095700             MOVE HO012-DIST-NBR      TO XL037-DIST-NBR           09570005
095800             MOVE HO012-DIST-NM       TO XL037-DIST-NM            09580005
095900             MOVE HO012-DIST-MGR-NM   TO XL037-DIST-MGR-NM        09590005
096000             MOVE HO012-DIST-REGN-NBR TO XL037-DIST-REGN-NBR      09600005
096100                                                                  09610005
096200             PERFORM 9000-WRITE-OUTPUT-REC                        09620004
096300             ADD 1 TO PA-DIST-UPD-COUNT                           09630004
096400                                                                  09640005
096500             PERFORM 8040-READ-INP05-FILE                         09650004
096600             PERFORM 8050-READ-INP06-FILE                         09660004
096700     ELSE                                                         09670004
096800     IF HO012-DIST-NBR > XLT00013-DIST-NBR                        09680004
096900         PERFORM 2210-PROCESS-INP06                               09690004
097000     ELSE                                                         09700004
097100     IF XLT00013-DIST-NBR > HO012-DIST-NBR                        09710004
097200         PERFORM 2220-PROCESS-INP05                               09720004
097300     END-IF                                                       09730004
097400     END-IF                                                       09740004
097500     END-IF.                                                      09750004
097600                                                                  09760004
097700******************************************************************09770004
097800 2210-PROCESS-INP06.                                              09780004
097900     MOVE '2210-PROCESS-INP06            ' TO PV-PARAGRAPH-NAME.  09790008
098000                                                                  09800004
098100     INITIALIZE XL037-TRANS-REC.                                  09810005
098200                                                                  09820005
098300     MOVE '3'  TO XL037-ACTION-TYPE.                              09830035
098400     MOVE 'F'  TO XL037-RECORD-TYPE.                              09840012
098500     MOVE '31' TO XL037-SORT-SEQUENCE.                            09850036
098600                                                                  09860005
098700     MOVE XLT00013-DIST-NBR TO XL037-DIST-NBR.                    09870005
098800                                                                  09880004
098900     PERFORM 9000-WRITE-OUTPUT-REC.                               09890004
099000     ADD 1 TO PA-DIST-DEL-COUNT.                                  09900004
099100                                                                  09910004
099200     PERFORM 8050-READ-INP06-FILE.                                09920004
099300                                                                  09930004
099400******************************************************************09940004
099500 2220-PROCESS-INP05.                                              09950004
099600     MOVE '2220-PROCESS-INP05            ' TO PV-PARAGRAPH-NAME.  09960008
099700                                                                  09970004
099800     INITIALIZE XL037-TRANS-REC.                                  09980005
099900                                                                  09990005
100000     MOVE '1'  TO XL037-ACTION-TYPE.                              10000035
100100     MOVE 'F'  TO XL037-RECORD-TYPE.                              10010012
100200     MOVE '06' TO XL037-SORT-SEQUENCE.                            10020036
100300                                                                  10030005
100400     MOVE HO012-DIST-NBR      TO XL037-DIST-NBR.                  10040005
100500     MOVE HO012-DIST-NM       TO XL037-DIST-NM.                   10050005
100600     MOVE HO012-DIST-MGR-NM   TO XL037-DIST-MGR-NM.               10060005
100700     MOVE HO012-DIST-REGN-NBR TO XL037-DIST-REGN-NBR.             10070005
100800                                                                  10080004
100900     PERFORM 9000-WRITE-OUTPUT-REC.                               10090004
101000     ADD 1 TO PA-DIST-ISRT-COUNT.                                 10100004
101100                                                                  10110004
101200     PERFORM 8040-READ-INP05-FILE.                                10120004
101300                                                                  10130004
101400******************************************************************10140006
101500*   P R O C E S S   D C   L O C A T I O N   A S S I G N M E N T  *10150006
101600******************************************************************10160006
101700 2300-PROCESS-DC-LOC.                                             10170006
101800     MOVE '2300-PROCESS-DC-LOC           ' TO PV-PARAGRAPH-NAME.  10180008
101900                                                                  10190006
102000     IF (HO016-DCLOC-LOC-NBR = XL041-LOC-NBR                      10200046
102100       AND HO016-DCLOC-EFF-BEG-DTE  = XL041-EFF-BEG-DTE)          10210046
102200         MOVE XL041-DC-NBR TO PV-DC-NBR                           10220046
102300         IF (HO016-DCLOC-DC-NBR = PV-DC-NBR)                      10230042
102400          AND ((HO016-DCLOC-PO-STRT-DTE = XL041-PO-STRT-DTE)      10240046
102500           OR (HO016-DCLOC-PO-STRT-DTE = SPACES AND               10250042
102600               XL041-PO-STRT-DTE = LOW-VALUES))                   10260046
102700             PERFORM 8060-READ-INP07-FILE                         10270006
102800             PERFORM 8070-READ-INP08-FILE                         10280006
102900         ELSE                                                     10290006
103000***          DISPLAY 'RMS DT = ' HO016-DCLOC-PO-STRT-DTE          10300047
103100***                  ' / DB2 DT = ' XL041-PO-STRT-DTE             10310047
103200***          DISPLAY 'RMS LOC = ' HO016-DCLOC-DC-NBR              10320047
103300***                  ' / DB2 LOC = ' PV-DC-NBR                    10330047
103400             INITIALIZE XL037-TRANS-REC                           10340006
103500             MOVE '2'  TO XL037-ACTION-TYPE                       10350035
103600             MOVE 'H'  TO XL037-RECORD-TYPE                       10360012
103700             MOVE '20' TO XL037-SORT-SEQUENCE                     10370036
103800                                                                  10380006
103900             MOVE HO016-DCLOC-LOC-NBR TO XL037-DCLOC-LOC-NBR      10390006
104000             MOVE HO016-DCLOC-EFF-BEG-DTE                         10400006
104100               TO XL037-DCLOC-EFF-BEG-DTE                         10410006
104200             MOVE HO016-DCLOC-PO-STRT-DTE                         10420006
104300               TO XL037-DCLOC-PO-STRT-DTE                         10430006
104400             MOVE HO016-DCLOC-DC-NBR  TO XL037-DCLOC-DC-NBR       10440006
104500                                                                  10450006
104600             PERFORM 9000-WRITE-OUTPUT-REC                        10460006
104700             ADD 1 TO PA-DCLOC-UPD-COUNT                          10470006
104800                                                                  10480006
104900             PERFORM 8060-READ-INP07-FILE                         10490006
105000             PERFORM 8070-READ-INP08-FILE                         10500006
105100     ELSE                                                         10510006
105200     IF (HO016-DCLOC-LOC-NBR > XL041-LOC-NBR)                     10520046
105300       OR (HO016-DCLOC-LOC-NBR = XL041-LOC-NBR                    10530046
105400        AND HO016-DCLOC-EFF-BEG-DTE > XL041-EFF-BEG-DTE)          10540046
105500         PERFORM 2310-PROCESS-INP08                               10550006
105600     ELSE                                                         10560006
105700     IF (XL041-LOC-NBR > HO016-DCLOC-LOC-NBR)                     10570046
105800       OR (XL041-LOC-NBR = HO016-DCLOC-LOC-NBR                    10580046
105900        AND XL041-EFF-BEG-DTE > HO016-DCLOC-EFF-BEG-DTE)          10590046
106000         PERFORM 2320-PROCESS-INP07                               10600006
106100     END-IF                                                       10610006
106200     END-IF                                                       10620006
106300     END-IF.                                                      10630006
106400                                                                  10640006
106500******************************************************************10650006
106600 2310-PROCESS-INP08.                                              10660006
106700     MOVE '2310-PROCESS-INP08            ' TO PV-PARAGRAPH-NAME.  10670008
106800                                                                  10680006
106900     INITIALIZE XL037-TRANS-REC.                                  10690006
107000                                                                  10700006
107100     MOVE '3'  TO XL037-ACTION-TYPE.                              10710035
107200     MOVE 'H'  TO XL037-RECORD-TYPE.                              10720012
107300     MOVE '29' TO XL037-SORT-SEQUENCE.                            10730036
107400                                                                  10740006
107500     MOVE XL041-LOC-NBR     TO XL037-DCLOC-LOC-NBR.               10750046
107600     MOVE XL041-EFF-BEG-DTE TO XL037-DCLOC-EFF-BEG-DTE.           10760046
107700                                                                  10770006
107800     PERFORM 9000-WRITE-OUTPUT-REC.                               10780006
107900     ADD 1 TO PA-DCLOC-DEL-COUNT.                                 10790006
108000                                                                  10800006
108100     PERFORM 8070-READ-INP08-FILE.                                10810006
108200                                                                  10820006
108300******************************************************************10830006
108400 2320-PROCESS-INP07.                                              10840006
108500     MOVE '2320-PROCESS-INP07            ' TO PV-PARAGRAPH-NAME.  10850008
108600                                                                  10860006
108700     INITIALIZE XL037-TRANS-REC.                                  10870006
108800                                                                  10880006
108900     MOVE '1'  TO XL037-ACTION-TYPE.                              10890035
109000     MOVE 'H'  TO XL037-RECORD-TYPE.                              10900012
109100     MOVE '08' TO XL037-SORT-SEQUENCE.                            10910036
109200                                                                  10920006
109300     MOVE HO016-DCLOC-LOC-NBR     TO XL037-DCLOC-LOC-NBR.         10930006
109400     MOVE HO016-DCLOC-EFF-BEG-DTE TO XL037-DCLOC-EFF-BEG-DTE.     10940006
109500     MOVE HO016-DCLOC-PO-STRT-DTE TO XL037-DCLOC-PO-STRT-DTE.     10950006
109600     MOVE HO016-DCLOC-DC-NBR      TO XL037-DCLOC-DC-NBR.          10960006
109700                                                                  10970006
109800     PERFORM 9000-WRITE-OUTPUT-REC.                               10980006
109900     ADD 1 TO PA-DCLOC-ISRT-COUNT.                                10990006
110000                                                                  11000006
110100     PERFORM 8060-READ-INP07-FILE.                                11010006
110200                                                                  11020006
110300******************************************************************11030006
110400*          P R O C E S S   L O C A T I O N   T Y P E             *11040006
110500******************************************************************11050006
110600 2400-PROCESS-LOC-TYP.                                            11060006
110700     MOVE '2400-PROCESS-LOC-TYP          ' TO PV-PARAGRAPH-NAME.  11070008
110800                                                                  11080006
110900     IF HO021-LOC-TYP-CDE = XLT00015-LOC-TYP-CDE                  11090006
111000         IF HO021-LOC-TYP-DESC = XLT00015-LOC-TYP-DESC            11100006
111100             PERFORM 8080-READ-INP09-FILE                         11110006
111200             PERFORM 8090-READ-INP10-FILE                         11120006
111300         ELSE                                                     11130006
111400             INITIALIZE XL037-TRANS-REC                           11140006
111500             MOVE '2'  TO XL037-ACTION-TYPE                       11150035
111600             MOVE 'A'  TO XL037-RECORD-TYPE                       11160012
111700             MOVE '13' TO XL037-SORT-SEQUENCE                     11170036
111800                                                                  11180006
111900             MOVE HO021-LOC-TYP-CDE  TO XL037-LOC-TYP-CDE         11190006
112000             MOVE HO021-LOC-TYP-DESC TO XL037-LOC-TYP-DESC        11200006
112100                                                                  11210006
112200             PERFORM 9000-WRITE-OUTPUT-REC                        11220006
112300             ADD 1 TO PA-LOC-TYP-UPD-COUNT                        11230006
112400                                                                  11240006
112500             PERFORM 8080-READ-INP09-FILE                         11250006
112600             PERFORM 8090-READ-INP10-FILE                         11260006
112700     ELSE                                                         11270006
112800     IF HO021-LOC-TYP-CDE > XLT00015-LOC-TYP-CDE                  11280006
112900         PERFORM 2410-PROCESS-INP10                               11290006
113000     ELSE                                                         11300006
113100     IF XLT00015-LOC-TYP-CDE > HO021-LOC-TYP-CDE                  11310006
113200         PERFORM 2420-PROCESS-INP09                               11320006
113300     END-IF                                                       11330006
113400     END-IF                                                       11340006
113500     END-IF.                                                      11350006
113600                                                                  11360006
113700******************************************************************11370006
113800 2410-PROCESS-INP10.                                              11380006
113900     MOVE '2410-PROCESS-INP10            ' TO PV-PARAGRAPH-NAME.  11390008
114000                                                                  11400006
114100     INITIALIZE XL037-TRANS-REC.                                  11410006
114200                                                                  11420006
114300     MOVE '3'  TO XL037-ACTION-TYPE.                              11430035
114400     MOVE 'A'  TO XL037-RECORD-TYPE.                              11440012
114500     MOVE '36' TO XL037-SORT-SEQUENCE.                            11450036
114600                                                                  11460006
114700     MOVE XLT00015-LOC-TYP-CDE TO XL037-LOC-TYP-CDE.              11470006
114800                                                                  11480006
114900     PERFORM 9000-WRITE-OUTPUT-REC.                               11490006
115000     ADD 1 TO PA-LOC-TYP-DEL-COUNT.                               11500006
115100                                                                  11510006
115200     PERFORM 8090-READ-INP10-FILE.                                11520006
115300                                                                  11530006
115400******************************************************************11540006
115500 2420-PROCESS-INP09.                                              11550006
115600     MOVE '2420-PROCESS-INP09            ' TO PV-PARAGRAPH-NAME.  11560008
115700                                                                  11570006
115800     INITIALIZE XL037-TRANS-REC.                                  11580006
115900                                                                  11590006
116000     MOVE '1'  TO XL037-ACTION-TYPE.                              11600035
116100     MOVE 'A'  TO XL037-RECORD-TYPE.                              11610012
116200     MOVE '01' TO XL037-SORT-SEQUENCE.                            11620036
116300                                                                  11630006
116400     MOVE HO021-LOC-TYP-CDE  TO XL037-LOC-TYP-CDE.                11640006
116500     MOVE HO021-LOC-TYP-DESC TO XL037-LOC-TYP-DESC.               11650006
116600                                                                  11660006
116700     PERFORM 9000-WRITE-OUTPUT-REC.                               11670006
116800     ADD 1 TO PA-LOC-TYP-ISRT-COUNT.                              11680006
116900                                                                  11690006
117000     PERFORM 8080-READ-INP09-FILE.                                11700006
117100                                                                  11710006
117200******************************************************************11720006
117300*          P R O C E S S   S T D   T I M E   Z O N E             *11730006
117400******************************************************************11740006
117500 2500-PROCESS-STDTMZN.                                            11750006
117600     MOVE '2500-PROCESS-STDTMZN          ' TO PV-PARAGRAPH-NAME.  11760008
117700                                                                  11770006
117800     IF HO020-TM-ZN-CDE = XLT00016-STD-TM-ZN-CDE                  11780006
117900         IF HO020-TM-ZN-DESC   = XLT00016-STD-TM-ZN-DESC          11790006
118000             PERFORM 8100-READ-INP11-FILE                         11800006
118100             PERFORM 8110-READ-INP12-FILE                         11810006
118200         ELSE                                                     11820006
118300             INITIALIZE XL037-TRANS-REC                           11830006
118400             MOVE '2'  TO XL037-ACTION-TYPE                       11840035
118500             MOVE 'B'  TO XL037-RECORD-TYPE                       11850012
118600             MOVE '14' TO XL037-SORT-SEQUENCE                     11860036
118700                                                                  11870006
118800             MOVE HO020-TM-ZN-CDE  TO XL037-STD-TM-ZN-CDE         11880006
118900             MOVE HO020-TM-ZN-DESC TO XL037-STD-TM-ZN-DESC        11890006
119000                                                                  11900006
119100             PERFORM 9000-WRITE-OUTPUT-REC                        11910006
119200             ADD 1 TO PA-STDTMZN-UPD-COUNT                        11920006
119300                                                                  11930006
119400             PERFORM 8100-READ-INP11-FILE                         11940006
119500             PERFORM 8110-READ-INP12-FILE                         11950006
119600     ELSE                                                         11960006
119700     IF HO020-TM-ZN-CDE > XLT00016-STD-TM-ZN-CDE                  11970006
P42541*        PERFORM 2510-PROCESS-INP12                               11980055
P42541         PERFORM 8110-READ-INP12-FILE                             11981055
119900     ELSE                                                         11990006
120000     IF XLT00016-STD-TM-ZN-CDE > HO020-TM-ZN-CDE                  12000006
120100         PERFORM 2520-PROCESS-INP11                               12010006
120200     END-IF                                                       12020006
120300     END-IF                                                       12030006
120400     END-IF.                                                      12040006
120500                                                                  12050006
120600******************************************************************12060006
P42541*2510-PROCESS-INP12.                                              12070055
P42541*    MOVE '2510-PROCESS-INP12            ' TO PV-PARAGRAPH-NAME.  12080055
P42541*                                                                 12090055
P42541*    INITIALIZE XL037-TRANS-REC.                                  12100055
P42541*                                                                 12110055
P42541*    MOVE '3'  TO XL037-ACTION-TYPE.                              12120055
P42541*    MOVE 'B'  TO XL037-RECORD-TYPE.                              12130055
P42541*    MOVE '35' TO XL037-SORT-SEQUENCE.                            12140055
P42541*                                                                 12150055
P42541*    MOVE XLT00016-STD-TM-ZN-CDE TO XL037-STD-TM-ZN-CDE.          12160055
P42541*                                                                 12170055
P42541*    PERFORM 9000-WRITE-OUTPUT-REC.                               12180055
P42541*    ADD 1 TO PA-STDTMZN-DEL-COUNT.                               12190055
P42541*                                                                 12200055
P42541*    PERFORM 8110-READ-INP12-FILE.                                12210055
P42541*                                                                 12220055
122300******************************************************************12230006
122400 2520-PROCESS-INP11.                                              12240006
122500     MOVE '2520-PROCESS-INP11            ' TO PV-PARAGRAPH-NAME.  12250008
122600                                                                  12260006
122700     INITIALIZE XL037-TRANS-REC.                                  12270006
122800                                                                  12280006
122900     MOVE '1'  TO XL037-ACTION-TYPE.                              12290035
123000     MOVE 'B'  TO XL037-RECORD-TYPE.                              12300012
123100     MOVE '02' TO XL037-SORT-SEQUENCE.                            12310036
123200                                                                  12320006
123300     MOVE HO020-TM-ZN-CDE  TO XL037-STD-TM-ZN-CDE.                12330006
123400     MOVE HO020-TM-ZN-DESC TO XL037-STD-TM-ZN-DESC.               12340006
123500                                                                  12350006
123600     PERFORM 9000-WRITE-OUTPUT-REC.                               12360006
123700     ADD 1 TO PA-STDTMZN-ISRT-COUNT.                              12370006
123800                                                                  12380006
123900     PERFORM 8100-READ-INP11-FILE.                                12390006
124000                                                                  12400006
124100******************************************************************12410006
124200*          P R O C E S S   S T O R E   F O R M A T               *12420006
124300******************************************************************12430006
124400 2600-PROCESS-STR-FMT.                                            12440006
124500     MOVE '2600-PROCESS-STR-FMT          ' TO PV-PARAGRAPH-NAME.  12450008
124600                                                                  12460006
124700     MOVE HO022-STR-FMT-CDE TO PV-STR-FMT-CDE.                    12470007
124800     IF PV-STR-FMT-CDE = XLT00017-STR-FMT-CDE                     12480007
124900         IF HO022-STR-FMT-DESC = XLT00017-STR-FMT-DESC            12490006
125000             PERFORM 8120-READ-INP13-FILE                         12500006
125100             PERFORM 8130-READ-INP14-FILE                         12510006
125200         ELSE                                                     12520006
125300             INITIALIZE XL037-TRANS-REC                           12530006
125400             MOVE '2'  TO XL037-ACTION-TYPE                       12540035
125500             MOVE 'C'  TO XL037-RECORD-TYPE                       12550012
125600             MOVE '15' TO XL037-SORT-SEQUENCE                     12560036
125700                                                                  12570006
125800             MOVE PV-STR-FMT-CDE     TO XL037-STR-FMT-CDE         12580007
125900             MOVE HO022-STR-FMT-DESC TO XL037-STR-FMT-DESC        12590006
126000                                                                  12600006
126100             PERFORM 9000-WRITE-OUTPUT-REC                        12610006
126200             ADD 1 TO PA-STR-FMT-UPD-COUNT                        12620006
126300                                                                  12630006
126400             PERFORM 8120-READ-INP13-FILE                         12640006
126500             PERFORM 8130-READ-INP14-FILE                         12650006
126600     ELSE                                                         12660006
126700     IF PV-STR-FMT-CDE > XLT00017-STR-FMT-CDE                     12670007
126800         PERFORM 2610-PROCESS-INP14                               12680006
126900     ELSE                                                         12690006
127000     IF XLT00017-STR-FMT-CDE > PV-STR-FMT-CDE                     12700007
127100         PERFORM 2620-PROCESS-INP13                               12710006
127200     END-IF                                                       12720006
127300     END-IF                                                       12730006
127400     END-IF.                                                      12740006
127500                                                                  12750006
127600******************************************************************12760006
127700 2610-PROCESS-INP14.                                              12770006
127800     MOVE '2610-PROCESS-INP14            ' TO PV-PARAGRAPH-NAME.  12780008
127900                                                                  12790006
128000     INITIALIZE XL037-TRANS-REC.                                  12800006
128100                                                                  12810006
128200     MOVE '3'  TO XL037-ACTION-TYPE.                              12820035
128300     MOVE 'C'  TO XL037-RECORD-TYPE.                              12830012
128400     MOVE '34' TO XL037-SORT-SEQUENCE.                            12840036
128500                                                                  12850006
128600     MOVE XLT00017-STR-FMT-CDE TO XL037-STR-FMT-CDE.              12860006
128700                                                                  12870006
128800     PERFORM 9000-WRITE-OUTPUT-REC.                               12880006
128900     ADD 1 TO PA-STR-FMT-DEL-COUNT.                               12890006
129000                                                                  12900006
129100     PERFORM 8130-READ-INP14-FILE.                                12910006
129200                                                                  12920006
129300******************************************************************12930006
129400 2620-PROCESS-INP13.                                              12940006
129500     MOVE '2620-PROCESS-INP13            ' TO PV-PARAGRAPH-NAME.  12950008
129600                                                                  12960006
129700     INITIALIZE XL037-TRANS-REC.                                  12970006
129800                                                                  12980006
129900     MOVE '1'  TO XL037-ACTION-TYPE.                              12990035
130000     MOVE 'C'  TO XL037-RECORD-TYPE.                              13000012
130100     MOVE '03' TO XL037-SORT-SEQUENCE.                            13010036
130200                                                                  13020006
130300     MOVE HO022-STR-FMT-CDE  TO PV-STR-FMT-CDE.                   13030007
130400     MOVE PV-STR-FMT-CDE     TO XL037-STR-FMT-CDE.                13040007
130500     MOVE HO022-STR-FMT-DESC TO XL037-STR-FMT-DESC.               13050006
130600                                                                  13060006
130700     PERFORM 9000-WRITE-OUTPUT-REC.                               13070006
130800     ADD 1 TO PA-STR-FMT-ISRT-COUNT.                              13080006
130900                                                                  13090006
131000     PERFORM 8120-READ-INP13-FILE.                                13100006
131100                                                                  13110006
131200******************************************************************13120007
131300*          P R O C E S S   M E M B E R S H I P                   *13130007
131400******************************************************************13140007
131500 2700-PROCESS-STR-MBSHP.                                          13150007
131600     MOVE '2700-PROCESS-STR-MBSHP        ' TO PV-PARAGRAPH-NAME.  13160008
131700                                                                  13170007
131800     IF HO019-STR-NBR = XLT00018-LOC-NBR                          13180007
131900       AND HO019-STR-GP-TYP-CDE  = XLT00018-STR-GP-TYP-CDE        13190007
132000       AND HO019-STR-GP-ID       = XLT00018-STR-GP-ID             13200007
132100       AND HO019-STR-EFF-BEG-DTE = XLT00018-EFF-BEG-DTE           13210007
132200         IF ((HO019-STR-EFF-END-DTE = XLT00018-EFF-END-DTE)       13220042
132300           OR (HO019-STR-EFF-END-DTE = SPACES                     13230042
132400            AND XLT00018-EFF-END-DTE = LOW-VALUES))               13240042
132500             PERFORM 8140-READ-INP15-FILE                         13250007
132600             PERFORM 8150-READ-INP16-FILE                         13260007
132700         ELSE                                                     13270007
132800***          DISPLAY ' RMS MBSHP = ' HO019-STR-EFF-END-DTE        13280042
132900***                  ' / DB2 MBSHP = ' XLT00018-EFF-END-DTE       13290042
133000             INITIALIZE XL037-TRANS-REC                           13300007
133100             MOVE '2'  TO XL037-ACTION-TYPE                       13310035
133200             MOVE 'L'  TO XL037-RECORD-TYPE                       13320012
133300             MOVE '24' TO XL037-SORT-SEQUENCE                     13330036
133400                                                                  13340007
133500             MOVE HO019-STR-GP-TYP-CDE                            13350007
133600                                  TO XL037-SGM-STR-GP-TYP-CDE     13360039
133700             MOVE HO019-STR-GP-ID TO XL037-SGM-STR-GP-ID          13370007
133800             MOVE HO019-STR-NBR   TO XL037-SGM-LOC-NBR            13380039
133900             MOVE HO019-STR-EFF-BEG-DTE                           13390007
134000                                  TO XL037-SGM-EFF-BEG-DTE        13400039
134100             MOVE HO019-STR-EFF-END-DTE                           13410007
134200                                  TO XL037-SGM-EFF-END-DTE        13420039
134300                                                                  13430007
134400             PERFORM 9000-WRITE-OUTPUT-REC                        13440007
134500             ADD 1 TO PA-STR-MBSHP-UPD-COUNT                      13450007
134600                                                                  13460007
134700             PERFORM 8140-READ-INP15-FILE                         13470007
134800             PERFORM 8150-READ-INP16-FILE                         13480007
134900     ELSE                                                         13490007
135000     IF (HO019-STR-GP-TYP-CDE   > XLT00018-STR-GP-TYP-CDE)        13500008
135100       OR (HO019-STR-GP-TYP-CDE = XLT00018-STR-GP-TYP-CDE         13510007
135200        AND HO019-STR-GP-ID     > XLT00018-STR-GP-ID)             13520007
135300       OR (HO019-STR-GP-TYP-CDE = XLT00018-STR-GP-TYP-CDE         13530007
135400        AND HO019-STR-GP-ID     = XLT00018-STR-GP-ID              13540007
135500        AND HO019-STR-NBR       > XLT00018-LOC-NBR)               13550007
135600       OR (HO019-STR-GP-TYP-CDE = XLT00018-STR-GP-TYP-CDE         13560007
135700        AND HO019-STR-GP-ID     = XLT00018-STR-GP-ID              13570007
135800        AND HO019-STR-NBR       = XLT00018-LOC-NBR                13580007
135900        AND HO019-STR-EFF-BEG-DTE > XLT00018-EFF-BEG-DTE)         13590007
136000         PERFORM 2710-PROCESS-INP16                               13600007
136100     ELSE                                                         13610007
136200     IF (XLT00018-STR-GP-TYP-CDE > HO019-STR-GP-TYP-CDE)          13620007
136300       OR (XLT00018-STR-GP-TYP-CDE = HO019-STR-GP-TYP-CDE         13630007
136400        AND XLT00018-STR-GP-ID  > HO019-STR-GP-ID)                13640007
136500       OR (XLT00018-STR-GP-TYP-CDE = HO019-STR-GP-TYP-CDE         13650007
136600        AND XLT00018-STR-GP-ID  = HO019-STR-GP-ID                 13660007
136700        AND XLT00018-LOC-NBR    > HO019-STR-NBR)                  13670007
136800       OR (XLT00018-STR-GP-TYP-CDE = HO019-STR-GP-TYP-CDE         13680007
136900        AND XLT00018-STR-GP-ID  = HO019-STR-GP-ID                 13690007
137000        AND XLT00018-LOC-NBR    = HO019-STR-NBR                   13700007
137100        AND XLT00018-EFF-BEG-DTE > HO019-STR-EFF-BEG-DTE)         13710007
137200         PERFORM 2720-PROCESS-INP15                               13720008
137300     END-IF                                                       13730007
137400     END-IF                                                       13740007
137500     END-IF.                                                      13750007
137600                                                                  13760007
137700******************************************************************13770007
137800 2710-PROCESS-INP16.                                              13780008
137900     MOVE '2710-PROCESS-INP16            ' TO PV-PARAGRAPH-NAME.  13790008
138000                                                                  13800007
138100     INITIALIZE XL037-TRANS-REC.                                  13810007
138200                                                                  13820007
138300     MOVE '3'  TO XL037-ACTION-TYPE.                              13830035
138400     MOVE 'L'  TO XL037-RECORD-TYPE.                              13840012
138500     MOVE '25' TO XL037-SORT-SEQUENCE.                            13850036
138600                                                                  13860007
138700     MOVE XLT00018-LOC-NBR        TO XL037-SGM-LOC-NBR.           13870008
138800     MOVE XLT00018-STR-GP-TYP-CDE TO XL037-SGM-STR-GP-TYP-CDE.    13880008
138900     MOVE XLT00018-STR-GP-ID      TO XL037-SGM-STR-GP-ID.         13890008
139000     MOVE XLT00018-EFF-BEG-DTE    TO XL037-SGM-EFF-BEG-DTE.       13900008
139100                                                                  13910008
139200     PERFORM 9000-WRITE-OUTPUT-REC.                               13920007
139300     ADD 1 TO PA-STR-MBSHP-DEL-COUNT.                             13930008
139400                                                                  13940007
139500     PERFORM 8150-READ-INP16-FILE.                                13950008
139600                                                                  13960007
139700******************************************************************13970007
139800 2720-PROCESS-INP15.                                              13980008
139900     MOVE '2720-PROCESS-INP15            ' TO PV-PARAGRAPH-NAME.  13990008
140000                                                                  14000007
140100     INITIALIZE XL037-TRANS-REC.                                  14010007
140200                                                                  14020007
140300     MOVE '1'  TO XL037-ACTION-TYPE.                              14030035
140400     MOVE 'L'  TO XL037-RECORD-TYPE.                              14040012
140500     MOVE '12' TO XL037-SORT-SEQUENCE.                            14050036
140600                                                                  14060007
140700     MOVE HO019-STR-NBR         TO XL037-SGM-LOC-NBR.             14070008
140800     MOVE HO019-STR-GP-TYP-CDE  TO XL037-SGM-STR-GP-TYP-CDE.      14080008
140900     MOVE HO019-STR-GP-ID       TO XL037-SGM-STR-GP-ID.           14090008
141000     MOVE HO019-STR-EFF-BEG-DTE TO XL037-SGM-EFF-BEG-DTE.         14100008
141100     MOVE HO019-STR-EFF-END-DTE TO XL037-SGM-EFF-END-DTE.         14110008
141200                                                                  14120008
141300     PERFORM 9000-WRITE-OUTPUT-REC.                               14130007
141400     ADD 1 TO PA-STR-MBSHP-ISRT-COUNT.                            14140008
141500                                                                  14150007
141600     PERFORM 8140-READ-INP15-FILE.                                14160008
141700                                                                  14170007
141800******************************************************************14180008
141900*          P R O C E S S   G R O U P   T Y P E                   *14190008
142000******************************************************************14200008
142100 2800-PROCESS-STR-TYP.                                            14210008
142200     MOVE '2800-PROCESS-STR-TYP          ' TO PV-PARAGRAPH-NAME.  14220008
142300                                                                  14230008
142400     IF HO017-SGT-STR-TYP-CDE = XLT00019-STR-GP-TYP-CDE           14240008
142500         IF HO017-SGT-STR-GP-CTG-NM = XLT00019-STR-GP-TYP-NM      14250008
142600             PERFORM 8160-READ-INP17-FILE                         14260008
142700             PERFORM 8170-READ-INP18-FILE                         14270008
142800         ELSE                                                     14280008
142900             INITIALIZE XL037-TRANS-REC                           14290008
143000             MOVE '2'  TO XL037-ACTION-TYPE                       14300035
143100             MOVE 'I'  TO XL037-RECORD-TYPE                       14310012
143200             MOVE '21' TO XL037-SORT-SEQUENCE                     14320036
143300                                                                  14330008
143400             MOVE HO017-SGT-STR-TYP-CDE TO XL037-STR-GP-TYP-CDE   14340008
143500             MOVE HO017-SGT-STR-GP-CTG-NM TO XL037-STR-GP-TYP-NM  14350008
143600                                                                  14360008
143700             PERFORM 9000-WRITE-OUTPUT-REC                        14370008
143800             ADD 1 TO PA-STR-TYP-UPD-COUNT                        14380008
143900                                                                  14390008
144000             PERFORM 8160-READ-INP17-FILE                         14400008
144100             PERFORM 8170-READ-INP18-FILE                         14410008
144200     ELSE                                                         14420008
144300     IF HO017-SGT-STR-TYP-CDE > XLT00019-STR-GP-TYP-CDE           14430008
144400         PERFORM 2810-PROCESS-INP18                               14440008
144500     ELSE                                                         14450008
144600     IF XLT00019-STR-GP-TYP-CDE > HO017-SGT-STR-TYP-CDE           14460008
144700         PERFORM 2820-PROCESS-INP17                               14470008
144800     END-IF                                                       14480008
144900     END-IF                                                       14490008
145000     END-IF.                                                      14500008
145100                                                                  14510008
145200******************************************************************14520008
145300 2810-PROCESS-INP18.                                              14530008
145400     MOVE '2810-PROCESS-INP18            ' TO PV-PARAGRAPH-NAME.  14540008
145500                                                                  14550008
145600     INITIALIZE XL037-TRANS-REC.                                  14560008
145700                                                                  14570008
145800     MOVE '3'  TO XL037-ACTION-TYPE.                              14580035
145900     MOVE 'I'  TO XL037-RECORD-TYPE.                              14590012
146000     MOVE '28' TO XL037-SORT-SEQUENCE.                            14600036
146100                                                                  14610008
146200     MOVE XLT00019-STR-GP-TYP-CDE TO XL037-STR-GP-TYP-CDE.        14620008
146300                                                                  14630008
146400     PERFORM 9000-WRITE-OUTPUT-REC.                               14640008
146500     ADD 1 TO PA-STR-TYP-DEL-COUNT.                               14650008
146600                                                                  14660008
146700     PERFORM 8170-READ-INP18-FILE.                                14670008
146800                                                                  14680008
146900******************************************************************14690008
147000 2820-PROCESS-INP17.                                              14700008
147100     MOVE '2820-PROCESS-INP17            ' TO PV-PARAGRAPH-NAME.  14710008
147200                                                                  14720008
147300     INITIALIZE XL037-TRANS-REC.                                  14730008
147400                                                                  14740008
147500     MOVE '1'  TO XL037-ACTION-TYPE.                              14750035
147600     MOVE 'I'  TO XL037-RECORD-TYPE.                              14760012
147700     MOVE '09' TO XL037-SORT-SEQUENCE.                            14770036
147800                                                                  14780008
147900     MOVE HO017-SGT-STR-TYP-CDE   TO XL037-STR-GP-TYP-CDE.        14790008
148000     MOVE HO017-SGT-STR-GP-CTG-NM TO XL037-STR-GP-TYP-NM.         14800008
148100                                                                  14810008
148200     PERFORM 9000-WRITE-OUTPUT-REC.                               14820008
148300     ADD 1 TO PA-STR-TYP-ISRT-COUNT.                              14830008
148400                                                                  14840008
148500     PERFORM 8160-READ-INP17-FILE.                                14850008
148600                                                                  14860008
148700******************************************************************14870008
148800*          P R O C E S S   S T O R E   G R O U P                 *14880008
148900******************************************************************14890008
149000 2900-PROCESS-STR-GRP.                                            14900008
149100     MOVE '2900-PROCESS-STR-GRP          ' TO PV-PARAGRAPH-NAME.  14910008
149200                                                                  14920008
149300     IF HO018-SGD-STR-GP-TYP-CDE = XL042-STR-GP-TYP-CDE           14930046
149400       AND HO018-SGD-STR-GP-ID   = XL042-STR-GP-ID                14940046
149500         IF HO018-SGD-GP-NM = XL042-STR-GP-NM                     14950046
149600           AND ((HO018-SGD-ST-CDE = XL042-ST-CDE)                 14960046
149700            OR (HO018-SGD-ST-CDE = SPACES AND                     14970042
149800                XL042-ST-CDE = LOW-VALUES))                       14980046
149900           AND ((HO018-SGD-RPT-FLSH-SLS-IND                       14990042
150000                                 = XL042-RPT-FLSH-SLS-IND)        15000046
150100            OR (HO018-SGD-RPT-FLSH-SLS-IND = SPACES AND           15010042
150200                XL042-RPT-FLSH-SLS-IND = LOW-VALUES))             15020046
150300             PERFORM 8180-READ-INP19-FILE                         15030008
150400             PERFORM 8190-READ-INP20-FILE                         15040008
150500         ELSE                                                     15050008
150600***          DISPLAY ' RMS NM = ' HO018-SGD-GP-NM                 15060047
150700***                  ' / DB2 NM = ' XL042-STR-GP-NM               15070047
150800***          DISPLAY ' RMS ST = ' HO018-SGD-ST-CDE                15080047
150900***                  ' / DB2 ST = ' XL042-ST-CDE                  15090047
151000***          DISPLAY ' RMS IND = ' HO018-SGD-RPT-FLSH-SLS-IND     15100047
151100***                  ' / DB2 IND = ' XL042-RPT-FLSH-SLS-IND       15110047
151200             INITIALIZE XL037-TRANS-REC                           15120008
151300             MOVE '2'  TO XL037-ACTION-TYPE                       15130035
151400             MOVE 'J'  TO XL037-RECORD-TYPE                       15140012
151500             MOVE '22' TO XL037-SORT-SEQUENCE                     15150036
151600                                                                  15160008
151700             MOVE HO018-SGD-STR-GP-TYP-CDE                        15170008
151800               TO XL037-SG-STR-GP-TYP-CDE                         15180008
151900             MOVE HO018-SGD-STR-GP-ID TO XL037-SG-STR-GP-ID       15190008
152000             MOVE HO018-SGD-GP-NM     TO XL037-SG-STR-GP-NM       15200008
152100             MOVE HO018-SGD-ST-CDE    TO XL037-SG-ST-CDE          15210008
152200             MOVE HO018-SGD-RPT-FLSH-SLS-IND                      15220008
152300               TO XL037-SG-RPT-FLSH-SLS-IND                       15230008
152400                                                                  15240008
152500             PERFORM 9000-WRITE-OUTPUT-REC                        15250008
152600             ADD 1 TO PA-STR-GRP-UPD-COUNT                        15260008
152700                                                                  15270008
152800             PERFORM 8180-READ-INP19-FILE                         15280008
152900             PERFORM 8190-READ-INP20-FILE                         15290008
153000     ELSE                                                         15300008
153100     IF (HO018-SGD-STR-GP-TYP-CDE > XL042-STR-GP-TYP-CDE)         15310046
153200       OR (HO018-SGD-STR-GP-TYP-CDE = XL042-STR-GP-TYP-CDE        15320046
153300        AND HO018-SGD-STR-GP-ID > XL042-STR-GP-ID)                15330046
153400         PERFORM 2910-PROCESS-INP20                               15340008
153500     ELSE                                                         15350008
153600     IF (XL042-STR-GP-TYP-CDE > HO018-SGD-STR-GP-TYP-CDE)         15360046
153700       OR (XL042-STR-GP-TYP-CDE = HO018-SGD-STR-GP-TYP-CDE        15370046
153800        AND XL042-STR-GP-ID > HO018-SGD-STR-GP-ID)                15380046
153900         PERFORM 2920-PROCESS-INP19                               15390008
154000     END-IF                                                       15400008
154100     END-IF                                                       15410008
154200     END-IF.                                                      15420008
154300                                                                  15430008
154400******************************************************************15440008
154500 2910-PROCESS-INP20.                                              15450008
154600     MOVE '2910-PROCESS-INP20            ' TO PV-PARAGRAPH-NAME.  15460008
154700                                                                  15470008
154800     INITIALIZE XL037-TRANS-REC.                                  15480008
154900                                                                  15490008
155000     MOVE '3'  TO XL037-ACTION-TYPE.                              15500035
155100     MOVE 'J'  TO XL037-RECORD-TYPE.                              15510012
155200     MOVE '27' TO XL037-SORT-SEQUENCE.                            15520036
155300                                                                  15530008
155400     MOVE XL042-STR-GP-TYP-CDE TO XL037-SG-STR-GP-TYP-CDE.        15540046
155500     MOVE XL042-STR-GP-ID      TO XL037-SG-STR-GP-ID.             15550046
155600                                                                  15560008
155700     PERFORM 9000-WRITE-OUTPUT-REC.                               15570008
155800     ADD 1 TO PA-STR-GRP-DEL-COUNT.                               15580008
155900                                                                  15590008
156000     PERFORM 8190-READ-INP20-FILE.                                15600008
156100                                                                  15610008
156200******************************************************************15620008
156300 2920-PROCESS-INP19.                                              15630008
156400     MOVE '2920-PROCESS-INP19            ' TO PV-PARAGRAPH-NAME.  15640008
156500                                                                  15650008
156600     INITIALIZE XL037-TRANS-REC.                                  15660008
156700                                                                  15670008
156800     MOVE '1'  TO XL037-ACTION-TYPE.                              15680035
156900     MOVE 'J'  TO XL037-RECORD-TYPE.                              15690012
157000     MOVE '10' TO XL037-SORT-SEQUENCE.                            15700036
157100                                                                  15710008
157200     MOVE HO018-SGD-STR-GP-TYP-CDE   TO XL037-SG-STR-GP-TYP-CDE.  15720008
157300     MOVE HO018-SGD-STR-GP-ID        TO XL037-SG-STR-GP-ID.       15730008
157400     MOVE HO018-SGD-GP-NM            TO XL037-SG-STR-GP-NM.       15740008
157500     MOVE HO018-SGD-ST-CDE           TO XL037-SG-ST-CDE.          15750008
157600     MOVE HO018-SGD-RPT-FLSH-SLS-IND TO XL037-SG-RPT-FLSH-SLS-IND.15760008
157700                                                                  15770008
157800     PERFORM 9000-WRITE-OUTPUT-REC.                               15780008
157900     ADD 1 TO PA-STR-GRP-ISRT-COUNT.                              15790008
158000                                                                  15800008
158100     PERFORM 8180-READ-INP19-FILE.                                15810008
158200                                                                  15820008
158300******************************************************************15830009
158400*          P R O C E S S   S T O R E   D A T E                   *15840009
158500******************************************************************15850009
158600 3000-PROCESS-STR-DTE.                                            15860009
158700     MOVE '3000-PROCESS-STR-DTE          ' TO PV-PARAGRAPH-NAME.  15870009
158800                                                                  15880009
158900     IF HO023-PZD-GP-ID     = XL043-STR-GP-TYP-CDE                15890046
159000       AND HO023-PZD-ZNE-ID = XL043-STR-GP-ID                     15900046
159100       AND HO023-PZD-EFF-STRT-DTE = XL043-EFF-BEG-DTE             15910046
159200         MOVE XL043-EFF-STR-GP-ID TO PV-EFF-STR-GP-ID             15920046
159300         IF HO023-PZD-STR-GP-ID = PV-EFF-STR-GP-ID                15930042
159400           AND ((HO023-PZD-EFF-END-DTE = XL043-EFF-END-DTE)       15940046
159500            OR (HO023-PZD-EFF-END-DTE = SPACES                    15950042
159600            AND XL043-EFF-END-DTE = LOW-VALUES))                  15960046
159700             PERFORM 8200-READ-INP21-FILE                         15970009
159800             PERFORM 8210-READ-INP22-FILE                         15980009
159900         ELSE                                                     15990009
160000***          DISPLAY ' RMS DT = ' HO023-PZD-EFF-END-DTE           16000042
160100***                  ' / DB2 DT = ' XL043-EFF-END-DTE             16010046
160200***          DISPLAY ' RMS ID = ' HO023-PZD-STR-GP-ID             16020047
160300***                  ' / DB2 ID = ' PV-EFF-STR-GP-ID              16030047
160400             INITIALIZE XL037-TRANS-REC                           16040009
160500             MOVE '2'  TO XL037-ACTION-TYPE                       16050035
160600             MOVE 'K'  TO XL037-RECORD-TYPE                       16060012
160700             MOVE '23' TO XL037-SORT-SEQUENCE                     16070036
160800                                                                  16080009
160900             MOVE HO023-PZD-GP-ID                                 16090009
161000               TO XL037-SGD-STR-GP-TYP-CDE                        16100009
161100             MOVE HO023-PZD-ZNE-ID                                16110009
161200               TO XL037-SGD-STR-GP-ID                             16120009
161300             MOVE HO023-PZD-EFF-STRT-DTE                          16130009
161400               TO XL037-SGD-EFF-BEG-DTE                           16140009
161500             MOVE HO023-PZD-EFF-END-DTE                           16150009
161600               TO XL037-SGD-EFF-END-DTE                           16160009
161700             MOVE HO023-PZD-STR-GP-ID                             16170009
161800               TO XL037-SGD-EFF-STR-GP-ID                         16180009
161900                                                                  16190009
162000             PERFORM 9000-WRITE-OUTPUT-REC                        16200009
162100             ADD 1 TO PA-STR-DTE-UPD-COUNT                        16210009
162200                                                                  16220009
162300             PERFORM 8200-READ-INP21-FILE                         16230009
162400             PERFORM 8210-READ-INP22-FILE                         16240009
162500     ELSE                                                         16250009
162600     IF (HO023-PZD-GP-ID > XL043-STR-GP-TYP-CDE)                  16260046
162700       OR (HO023-PZD-GP-ID = XL043-STR-GP-TYP-CDE                 16270046
162800        AND HO023-PZD-ZNE-ID > XL043-STR-GP-ID)                   16280046
162900       OR (HO023-PZD-GP-ID = XL043-STR-GP-TYP-CDE                 16290046
163000        AND HO023-PZD-ZNE-ID = XL043-STR-GP-ID                    16300046
163100        AND HO023-PZD-EFF-STRT-DTE > XL043-EFF-BEG-DTE)           16310046
163200         PERFORM 3010-PROCESS-INP22                               16320009
163300     ELSE                                                         16330009
163400     IF (XL043-STR-GP-TYP-CDE > HO023-PZD-GP-ID)                  16340046
163500       OR (XL043-STR-GP-TYP-CDE = HO023-PZD-GP-ID                 16350046
163600        AND XL043-STR-GP-ID     > HO023-PZD-ZNE-ID)               16360046
163700       OR (XL043-STR-GP-TYP-CDE = HO023-PZD-GP-ID                 16370046
163800        AND XL043-STR-GP-ID     = HO023-PZD-ZNE-ID                16380046
163900        AND XL043-EFF-BEG-DTE   > HO023-PZD-EFF-STRT-DTE)         16390046
164000         PERFORM 3020-PROCESS-INP21                               16400009
164100     END-IF                                                       16410009
164200     END-IF                                                       16420009
164300     END-IF.                                                      16430009
164400                                                                  16440009
164500******************************************************************16450009
164600 3010-PROCESS-INP22.                                              16460009
164700     MOVE '3010-PROCESS-INP22            ' TO PV-PARAGRAPH-NAME.  16470009
164800                                                                  16480009
164900     INITIALIZE XL037-TRANS-REC.                                  16490009
165000                                                                  16500009
165100     MOVE '3'  TO XL037-ACTION-TYPE.                              16510035
165200     MOVE 'K'  TO XL037-RECORD-TYPE.                              16520012
165300     MOVE '26' TO XL037-SORT-SEQUENCE.                            16530036
165400                                                                  16540009
165500     MOVE XL043-STR-GP-TYP-CDE TO XL037-SGD-STR-GP-TYP-CDE.       16550046
165600     MOVE XL043-STR-GP-ID      TO XL037-SGD-STR-GP-ID.            16560046
165700     MOVE XL043-EFF-BEG-DTE    TO XL037-SGD-EFF-BEG-DTE.          16570046
165800                                                                  16580009
165900     PERFORM 9000-WRITE-OUTPUT-REC.                               16590009
166000     ADD 1 TO PA-STR-DTE-DEL-COUNT.                               16600009
166100                                                                  16610009
166200     PERFORM 8210-READ-INP22-FILE.                                16620009
166300                                                                  16630009
166400******************************************************************16640009
166500 3020-PROCESS-INP21.                                              16650009
166600     MOVE '3020-PROCESS-INP21            ' TO PV-PARAGRAPH-NAME.  16660009
166700                                                                  16670009
166800     INITIALIZE XL037-TRANS-REC.                                  16680009
166900                                                                  16690009
167000     MOVE '1'  TO XL037-ACTION-TYPE.                              16700035
167100     MOVE 'K'  TO XL037-RECORD-TYPE.                              16710012
167200     MOVE '11' TO XL037-SORT-SEQUENCE.                            16720036
167300                                                                  16730009
167400     MOVE HO023-PZD-GP-ID        TO XL037-SGD-STR-GP-TYP-CDE.     16740009
167500     MOVE HO023-PZD-ZNE-ID       TO XL037-SGD-STR-GP-ID.          16750009
167600     MOVE HO023-PZD-EFF-STRT-DTE TO XL037-SGD-EFF-BEG-DTE.        16760009
167700     MOVE HO023-PZD-EFF-END-DTE  TO XL037-SGD-EFF-END-DTE.        16770009
167800     MOVE HO023-PZD-STR-GP-ID    TO XL037-SGD-EFF-STR-GP-ID.      16780009
167900                                                                  16790009
168000     PERFORM 9000-WRITE-OUTPUT-REC.                               16800009
168100     ADD 1 TO PA-STR-DTE-ISRT-COUNT.                              16810009
168200                                                                  16820009
168300     PERFORM 8200-READ-INP21-FILE.                                16830009
168400                                                                  16840009
168500******************************************************************16850011
168600*            P R O C E S S   L O C A T I O N                     *16860011
168700******************************************************************16870011
168800 3100-PROCESS-LOCMSTR.                                            16880011
168900     MOVE '3100-PROCESS-LOCMSTR          ' TO PV-PARAGRAPH-NAME.  16890011
169000                                                                  16900011
169100     IF XL040-REPLT-STR-NBR > ZEROES                              16910046
169200         MOVE XL040-REPLT-STR-NBR TO PV-REPLT-STR-NBR             16920046
169300     ELSE                                                         16930025
169400         MOVE ZEROES TO PV-REPLT-STR-NBR                          16940025
169500     END-IF.                                                      16950025
169600     IF XL040-DIST-NBR NUMERIC                                    16960046
169700         MOVE XL040-DIST-NBR TO PV-DIST-NBR                       16970046
169800     ELSE                                                         16980025
169900         MOVE ZEROES TO PV-DIST-NBR                               16990025
170000     END-IF.                                                      17000025
170100     IF XL040-STR-FMT-CDE NUMERIC                                 17010047
170200         MOVE XL040-STR-FMT-CDE TO PV-STR-FMT-CDE                 17020047
170300     ELSE                                                         17030047
170400         MOVE ZEROES TO PV-STR-FMT-CDE                            17040047
170500     END-IF.                                                      17050047
170600     IF XL040-MEDN-AGE-NBR NUMERIC                                17060047
170700         MOVE XL040-MEDN-AGE-NBR TO PV-LOC-MEDN-AGE-NBR           17070047
170800     ELSE                                                         17080047
170900         MOVE ZEROES TO PV-LOC-MEDN-AGE-NBR                       17090047
171000     END-IF.                                                      17100047
171100     IF XL040-POS-RGST-BNK-QTY NUMERIC                            17110047
171200         MOVE XL040-POS-RGST-BNK-QTY TO PV-POS-RGST-BNK-QTY       17120047
171300     ELSE                                                         17130047
171400         MOVE ZEROES TO PV-POS-RGST-BNK-QTY                       17140047
171500     END-IF.                                                      17150047
171600     IF XL040-TOT-SLG-SQ-FTG-QTY NUMERIC                          17160047
171700         MOVE XL040-TOT-SLG-SQ-FTG-QTY TO PV-TOT-SLG-SQ-FTG-QTY   17170047
171800     ELSE                                                         17180047
171900         MOVE ZEROES TO PV-TOT-SLG-SQ-FTG-QTY                     17190047
172000     END-IF.                                                      17200047
172100     IF XL040-TOT-SQ-FTG-QTY NUMERIC                              17210047
172200         MOVE XL040-TOT-SQ-FTG-QTY TO PV-TOT-SQ-FTG-QTY           17220047
172300     ELSE                                                         17230047
172400         MOVE ZEROES TO PV-TOT-SQ-FTG-QTY                         17240047
172500     END-IF.                                                      17250047
172600     IF XL040-STP-ORD-DAYS-QTY NUMERIC                            17260047
172700         MOVE XL040-STP-ORD-DAYS-QTY TO PV-STP-ORD-DAYS-QTY       17270047
172800     ELSE                                                         17280047
172900         MOVE ZEROES TO PV-STP-ORD-DAYS-QTY                       17290047
173000     END-IF.                                                      17300047
173100     IF XL040-STRT-ORD-DAYS-QTY NUMERIC                           17310047
173200         MOVE XL040-STRT-ORD-DAYS-QTY TO PV-STRT-ORD-DAYS-QTY     17320047
173300     ELSE                                                         17330047
173400         MOVE ZEROES TO PV-STRT-ORD-DAYS-QTY                      17340047
173500     END-IF.                                                      17350047
173600     IF XL040-EST-HH-INCM-AMT NUMERIC                             17360047
173700         MOVE XL040-EST-HH-INCM-AMT TO PV-EST-HH-INCM-AMT         17370047
173800     ELSE                                                         17380047
173900         MOVE ZEROES TO PV-EST-HH-INCM-AMT                        17390047
174000     END-IF.                                                      17400047
174100                                                                  17410049
174200     MOVE XL040-DIRNS-TXT TO PV-DIRNS-TXT.                        17420049
174300     IF PV-DIRNS-TXT-LEN = ZEROES                                 17430049
174400         MOVE SPACES TO PV-DIRNS-TXT-TEXT                         17440049
174500     ELSE                                                         17450049
174600         INSPECT PV-DIRNS-TXT-TEXT                                17460049
174700                 REPLACING ALL LOW-VALUES BY SPACES               17470049
174800     END-IF.                                                      17480049
174900                                                                  17490025
175000     IF HO013-LOC-NBR = XL040-LOC-NBR                             17500046
175100         IF HO013-LOC-REPLT-STR-NBR    = PV-REPLT-STR-NBR         17510025
175200           AND HO013-LOC-DIST-NBR      = PV-DIST-NBR              17520025
175300           AND HO013-LOC-TYP-CDE       = XL040-LOC-TYP-CDE        17530046
175400           AND HO013-LOC-NM            = XL040-LOC-NM             17540046
175500           AND HO013-LOC-5-ABBR-NM     = XL040-LOC-5-ABBR-NM      17550046
175600           AND HO013-LOC-LNE-1-ADDR    = XL040-LNE-1-ADDR         17560046
175700           AND HO013-LOC-LNE-2-ADDR    = XL040-LNE-2-ADDR         17570046
175800           AND HO013-LOC-CITY          = XL040-CTY-NM             17580046
175900           AND HO013-LOC-ST-CDE        = XL040-ST-CDE             17590046
176000           AND HO013-LOC-ZIP-10-CDE    = XL040-ZIP-10-CDE         17600046
176100           AND HO013-LOC-OPEN-DATE     = XL040-OPN-DTE            17610046
176200           AND HO013-LOC-CLOSE-DATE    = XL040-CLO-DTE            17620046
176300           AND ((HO013-LOC-LOC-10-ABBR-NM = XL040-LOC-10-ABBR-NM) 17630048
176400             OR (HO013-LOC-LOC-10-ABBR-NM = SPACES AND            17640048
176500                 XL040-LOC-10-ABBR-NM = LOW-VALUES))              17650048
176600           AND ((HO013-LOC-PHONE-NUMBER = XL040-PHN-NBR)          17660048
176700             OR (HO013-LOC-PHONE-NUMBER = SPACES AND              17670048
176800                 XL040-PHN-NBR = LOW-VALUES))                     17680048
176900           AND ((HO013-LOC-MGR-NM = XL040-MGR-NM)                 17690048
177000             OR (HO013-LOC-MGR-NM = SPACES AND                    17700048
177100                 XL040-MGR-NM = LOW-VALUES))                      17710048
177200           AND ((HO013-LOC-FINCL-CLO-DTE = XL040-FINCL-CLO-DTE)   17720048
177300             OR (HO013-LOC-FINCL-CLO-DTE = '9999-09-09' AND       17730048
177400                 XL040-FINCL-CLO-DTE = LOW-VALUES))               17740048
177500           AND ((HO013-LOC-MN-SLS-INCL-DTE                        17750048
177600                 = XL040-MN-SLS-INCL-DTE)                         17760048
177700             OR (HO013-LOC-MN-SLS-INCL-DTE = '9999-09-09' AND     17770048
177800                 XL040-MN-SLS-INCL-DTE = LOW-VALUES))             17780048
177900           AND ((HO013-LOC-YR-SLS-INCL-DTE                        17790048
178000                 = XL040-YR-SLS-INCL-DTE)                         17800048
178100             OR (HO013-LOC-YR-SLS-INCL-DTE = '9999-09-09' AND     17810048
178200                 XL040-YR-SLS-INCL-DTE = LOW-VALUES))             17820048
178300           AND ((HO013-LOC-OCPNC-DTE = XL040-OCPNC-DTE)           17830048
178400             OR (HO013-LOC-OCPNC-DTE = '9999-09-09' AND           17840048
178500                 XL040-OCPNC-DTE = LOW-VALUES))                   17850048
178600* START ************************************************ WR23954  17860051
178600*          AND (HO013-LOC-POS-RGST-BNK-QTY                        17860153
178600           AND (ZEROES                                            17861053
178600* END ************************************************** WR23954  17862051
178700                = PV-POS-RGST-BNK-QTY)                            17870048
178800           AND ((HO013-LOC-DST-IND = XL040-DST-IND)               17880048
178900             OR (HO013-LOC-DST-IND = SPACES AND                   17890048
179000                 XL040-DST-IND = LOW-VALUES))                     17900048
179100           AND ((HO013-LOC-E-BUS-IND = XL040-E-BUS-IND)           17910048
179200             OR (HO013-LOC-E-BUS-IND = SPACES AND                 17920048
179300                 XL040-E-BUS-IND = LOW-VALUES))                   17930048
179400           AND (HO013-LOC-FMT-CDE = PV-STR-FMT-CDE)               17940048
179500           AND ((HO013-LOC-STD-TM-ZN-CDE = XL040-STD-TM-ZN-CDE)   17950048
179600             OR (HO013-LOC-STD-TM-ZN-CDE = SPACES AND             17960048
179700                 XL040-STD-TM-ZN-CDE = LOW-VALUES))               17970048
179800           AND ((HO013-LOC-SLS-INCL-DTE-CDE                       17980048
179900                 = XL040-SLS-INCL-DTE-CDE)                        17990048
180000             OR (HO013-LOC-SLS-INCL-DTE-CDE = SPACES AND          18000048
180100                 XL040-SLS-INCL-DTE-CDE = LOW-VALUES))            18010048
180200           AND HO013-LOC-TOT-SLG-SQ-FTG-QTY                       18020048
180300               = PV-TOT-SLG-SQ-FTG-QTY                            18030048
180400           AND HO013-LOC-TOT-SQ-FTG-QTY = PV-TOT-SQ-FTG-QTY       18040048
180500           AND HO013-LOC-STP-ORD-DAYS-QTY                         18050048
180600               = PV-STP-ORD-DAYS-QTY                              18060048
180700           AND HO013-LOC-STRT-ORD-DAYS-QTY                        18070048
180800               = PV-STRT-ORD-DAYS-QTY                             18080048
180900           AND ((HO013-LOC-ACQR-DTE = XL040-ACQR-DTE)             18090048
181000             OR (HO013-LOC-ACQR-DTE = '9999-09-09' AND            18100048
181100                 XL040-ACQR-DTE = LOW-VALUES))                    18110048
181200           AND ((HO013-LOC-REMDL-DTE = XL040-RMDL-DTE)            18120048
181300             OR (HO013-LOC-REMDL-DTE = '9999-09-09' AND           18130048
181400                 XL040-RMDL-DTE = LOW-VALUES))                    18140048
181500           AND ((HO013-LOC-MEDN-AGE-NBR-RDF                       18150048
181600                 = PV-LOC-MEDN-AGE-NBR)                           18160048
181700             OR (HO013-LOC-MEDN-AGE-NBR = SPACES AND              18170048
181800                 PV-LOC-MEDN-AGE-1 = ZEROES AND                   18180048
181900                 PV-LOC-MEDN-AGE-2 = ZEROES))                     18190048
182000           AND HO013-LOC-EST-HH-INCM-AMT                          18200048
182100               = PV-EST-HH-INCM-AMT                               18210048
182200           AND ((HO013-LOC-QTR-SLS-INCL-DTE                       18220048
182300                 = XL040-QTR-SLS-INCL-DTE)                        18230048
182400             OR (HO013-LOC-QTR-SLS-INCL-DTE = '9999-09-09' AND    18240048
182500                 XL040-QTR-SLS-INCL-DTE = LOW-VALUES))            18250048
182600           AND ((HO013-LOC-SEA-SLS-INCL-DTE                       18260048
182700                 = XL040-SEA-SLS-INCL-DTE)                        18270048
182800             OR (HO013-LOC-SEA-SLS-INCL-DTE = '9999-09-09' AND    18280048
182900                 XL040-SEA-SLS-INCL-DTE = LOW-VALUES))            18290048
183000           AND ((HO013-LOC-EXTD-MALL-NM  = XL040-EXTD-MALL-NM)    18300048
183100             OR (HO013-LOC-EXTD-MALL-NM = SPACES AND              18310048
183200                 XL040-EXTD-MALL-NM = LOW-VALUES))                18320048
183300           AND ((HO013-LOC-GRND-OPN-DTE  = XL040-GRND-OPN-DTE)    18330048
183400             OR (HO013-LOC-GRND-OPN-DTE = '9999-09-09' AND        18340048
183500                 XL040-GRND-OPN-DTE = LOW-VALUES))                18350048
183600           AND HO013-LOC-DIRNS-TXT     = PV-DIRNS-TXT-TEXT        18360050
183700           AND ((HO013-LOC-IN-STR-PRCHG-IND                       18370048
183800                 = XL040-IN-STR-PRCHG-IND)                        18380048
183900             OR (HO013-LOC-IN-STR-PRCHG-IND = SPACES AND          18390048
184000                 XL040-IN-STR-PRCHG-IND = LOW-VALUES))            18400048
184100           AND ((HO013-LOC-PRCHG-IND = XL040-PRCHG-CRE-IND)       18410048
184200             OR (HO013-LOC-PRCHG-IND = SPACES AND                 18420048
184300                 XL040-PRCHG-CRE-IND = LOW-VALUES))               18430048
184400             PERFORM 8220-READ-INP23-FILE                         18440011
184500             PERFORM 8230-READ-INP26-FILE                         18450011
184600         ELSE                                                     18460011
184700*JPL                                                              18470047
184800*            DISPLAY ' RMS REP-STR = ' HO013-LOC-REPLT-STR-NBR    18480050
184900*                  ' / DB2 REP-STR = ' PV-REPLT-STR-NBR           18490050
185000*            DISPLAY ' RMS DST-NBR = ' HO013-LOC-DIST-NBR         18500050
185100*                  ' / DB2 DST-NBR = ' PV-DIST-NBR                18510050
185200*            DISPLAY ' RMS LOC-TYP = ' HO013-LOC-TYP-CDE          18520050
185300*                  ' / DB2 LOC-TYP = ' XL040-LOC-TYP-CDE          18530050
185400*            DISPLAY ' RMS LOC-NME = ' HO013-LOC-NM               18540050
185500*                  ' / DB2 LOC-NME = ' XL040-LOC-NM               18550050
185600*            DISPLAY ' RMS 5-ABBR  = ' HO013-LOC-5-ABBR-NM        18560050
185700*                  ' / DB2 5-ABBR  = ' XL040-LOC-5-ABBR-NM        18570050
185800*            DISPLAY ' RMS ADDR 1  = ' HO013-LOC-LNE-1-ADDR       18580050
185900*                  ' / DB2 ADDR 1  = ' XL040-LNE-1-ADDR           18590050
186000*            DISPLAY ' RMS ADDR 2  = ' HO013-LOC-LNE-2-ADDR       18600050
186100*                  ' / DB2 ADDR 2  = ' XL040-LNE-2-ADDR           18610050
186200*            DISPLAY ' RMS CITY    = ' HO013-LOC-CITY             18620050
186300*                  ' / DB2 CITY    = ' XL040-CTY-NM               18630050
186400*            DISPLAY ' RMS STATE   = ' HO013-LOC-ST-CDE           18640050
186500*                  ' / DB2 STATE   = ' XL040-ST-CDE               18650050
186600*            DISPLAY ' RMS ZIP10   = ' HO013-LOC-ZIP-10-CDE       18660050
186700*                  ' / DB2 ZIP10   = ' XL040-ZIP-10-CDE           18670050
186800*            DISPLAY ' RMS OPN DT  = ' HO013-LOC-OPEN-DATE        18680050
186900*                  ' / DB2 OPN DT  = ' XL040-OPN-DTE              18690050
187000*            DISPLAY ' RMS CLO DT  = ' HO013-LOC-CLOSE-DATE       18700050
187100*                  ' / DB2 CLO DT  = ' XL040-CLO-DTE              18710050
187200*            DISPLAY ' RMS 10-ABBR = ' HO013-LOC-LOC-10-ABBR-NM   18720050
187300*                  ' / DB2 10-ABBR = ' XL040-LOC-10-ABBR-NM       18730050
187400*            DISPLAY ' RMS PHONE   = ' HO013-LOC-PHONE-NUMBER     18740050
187500*                  ' / DB2 PHONE   = ' XL040-PHN-NBR              18750050
187600*            DISPLAY ' RMS MGR-NM  = ' HO013-LOC-MGR-NM           18760050
187700*                  ' / DB2 MGR-NM  = ' XL040-MGR-NM               18770050
187800*            DISPLAY ' RMS FIN DT  = ' HO013-LOC-FINCL-CLO-DTE    18780050
187900*                  ' / DB2 FIN DT  = ' XL040-FINCL-CLO-DTE        18790050
188000*            DISPLAY ' RMS MN DTE  = ' HO013-LOC-MN-SLS-INCL-DTE  18800050
188100*                  ' / DB2 MN DTE  = ' XL040-MN-SLS-INCL-DTE      18810050
188200*            DISPLAY ' RMS YR DTE  = ' HO013-LOC-YR-SLS-INCL-DTE  18820050
188300*                  ' / DB2 YR DTE  = ' XL040-YR-SLS-INCL-DTE      18830050
188400*            DISPLAY ' RMS OCPNCDT = ' HO013-LOC-OCPNC-DTE        18840050
188500*                  ' / DB2 OCPNCDT = ' XL040-OCPNC-DTE            18850050
188800*            DISPLAY ' RMS DST IND = ' HO013-LOC-DST-IND          18880050
188900*                  ' / DB2 DST IND = ' XL040-DST-IND              18890050
189000*            DISPLAY ' RMS EBUSIND = ' HO013-LOC-E-BUS-IND        18900050
189100*                  ' / DB2 EBUSIND = ' XL040-E-BUS-IND            18910050
189200*            DISPLAY ' RMS FMT CDE = ' HO013-LOC-FMT-CDE          18920050
189300*                  ' / DB2 FMT CDE = ' XL040-STR-FMT-CDE          18930050
189400*            DISPLAY ' RMS TM ZN   = ' HO013-LOC-STD-TM-ZN-CDE    18940050
189500*                  ' / DB2 TM ZN   = ' XL040-STD-TM-ZN-CDE        18950050
189600*            DISPLAY ' RMS DTE CDE = ' HO013-LOC-SLS-INCL-DTE-CDE 18960050
189700*                  ' / DB2 DTE CDE = ' XL040-SLS-INCL-DTE-CDE     18970050
189800*          DISPLAY ' RMS SLG QTY = ' HO013-LOC-TOT-SLG-SQ-FTG-QTY 18980050
189900*                  ' / DB2 SLG QTY = ' XL040-TOT-SLG-SQ-FTG-QTY   18990050
190000*            DISPLAY ' RMS SQ QTY  = ' HO013-LOC-TOT-SQ-FTG-QTY   19000050
190100*                  ' / DB2 SQ QTY  = ' XL040-TOT-SQ-FTG-QTY       19010050
190200*            DISPLAY ' RMS STP QTY = ' HO013-LOC-STP-ORD-DAYS-QTY 19020050
190300*                  ' / DB2 STP QTY = ' XL040-STP-ORD-DAYS-QTY     19030050
190400*            DISPLAY ' RMS STRTQTY = ' HO013-LOC-STRT-ORD-DAYS-QTY19040050
190500*                  ' / DB2 STRTQTY = ' XL040-STRT-ORD-DAYS-QTY    19050050
190600*            DISPLAY ' RMS ACQR DT = ' HO013-LOC-ACQR-DTE         19060050
190700*                  ' / DB2 ACQR DT = ' XL040-ACQR-DTE             19070050
190800*            DISPLAY ' RMS RMDL DT = ' HO013-LOC-REMDL-DTE        19080050
190900*                  ' / DB2 RMDL DT = ' XL040-RMDL-DTE             19090050
191000*            DISPLAY ' RMS MEDNAGE = ' HO013-LOC-MEDN-AGE-NBR-RDF 19100050
191100*                  ' / DB2 MEDNAGE = ' PV-LOC-MEDN-AGE-NBR        19110050
191200*            DISPLAY ' RMS EST HH  = ' HO013-LOC-EST-HH-INCM-AMT  19120050
191300*                  ' / DB2 EST HH  = ' XL040-EST-HH-INCM-AMT      19130050
191400*            DISPLAY ' RMS QTR DT  = ' HO013-LOC-QTR-SLS-INCL-DTE 19140050
191500*                  ' / DB2 QTR DT  = ' XL040-QTR-SLS-INCL-DTE     19150050
191600*            DISPLAY ' RMS SEA DT  = ' HO013-LOC-SEA-SLS-INCL-DTE 19160050
191700*                  ' / DB2 SEA DT  = ' XL040-SEA-SLS-INCL-DTE     19170050
191800*            DISPLAY ' RMS MALL NM = ' HO013-LOC-EXTD-MALL-NM     19180050
191900*                  ' / DB2 MALL NM = ' XL040-EXTD-MALL-NM         19190050
192000*            DISPLAY ' RMS OPEN DT = ' HO013-LOC-GRND-OPN-DTE     19200050
192100*                  ' / DB2 OPEN DT = ' XL040-GRND-OPN-DTE         19210050
192200*            DISPLAY ' RMS DIR TXT = ' HO013-LOC-DIRNS-TXT        19220050
192300*                  ' / DB2 DIR TXT = ' XL040-DIRNS-TXT-TEXT       19230050
192400*            DISPLAY ' RMS STR PRC = ' HO013-LOC-IN-STR-PRCHG-IND 19240050
192500*                  ' / DB2 STR PRC = ' XL040-IN-STR-PRCHG-IND     19250050
192600*            DISPLAY ' RMS PRC IND = ' HO013-LOC-PRCHG-IND        19260050
192700*                  ' / DB2 PRC IND = ' XL040-PRCHG-CRE-IND        19270050
192800             INITIALIZE XL037-TRANS-REC                           19280047
192900             MOVE '2'  TO XL037-ACTION-TYPE                       19290035
193000             MOVE 'G'  TO XL037-RECORD-TYPE                       19300012
193100             MOVE '19' TO XL037-SORT-SEQUENCE                     19310036
193200                                                                  19320011
193300             MOVE HO013-LOC-NBR        TO XL037-LOC-NBR           19330012
193400             MOVE HO013-LOC-REPLT-STR-NBR                         19340012
193500                                       TO XL037-LOC-REPLT-STR-NBR 19350012
193600             MOVE HO013-LOC-DIST-NBR   TO XL037-LOC-DIST-NBR      19360012
193700             MOVE HO013-LOC-TYP-CDE    TO XL037-LOC-LOC-TYP-CDE   19370012
193800             MOVE HO013-LOC-NM         TO XL037-LOC-NM            19380012
193900             MOVE HO013-LOC-5-ABBR-NM  TO XL037-LOC-5-ABBR-NM     19390012
194000             MOVE HO013-LOC-LNE-1-ADDR TO XL037-LOC-LNE-1-ADDR    19400012
194100             MOVE HO013-LOC-LNE-2-ADDR TO XL037-LOC-LNE-2-ADDR    19410012
194200             MOVE HO013-LOC-CITY       TO XL037-LOC-CTY-NME       19420012
194300             MOVE HO013-LOC-ST-CDE     TO XL037-LOC-ST-CDE        19430012
194400             MOVE HO013-LOC-ZIP-10-CDE TO XL037-LOC-ZIP-10-CDE    19440012
194500             MOVE HO013-LOC-OPEN-DATE  TO XL037-LOC-OPN-DTE       19450012
194600             MOVE HO013-LOC-CLOSE-DATE TO XL037-LOC-CLO-DTE       19460012
194700             MOVE HO013-LOC-LOC-10-ABBR-NM                        19470012
194800                                    TO XL037-LOC-LOC-10-ABBR-NM   19480012
194900             MOVE HO013-LOC-PHONE-NUMBER TO XL037-LOC-PHN-NBR     19490012
195000             MOVE HO013-LOC-MGR-NM  TO XL037-LOC-MGR-NM           19500012
195100             MOVE HO013-LOC-FINCL-CLO-DTE                         19510012
195200                                    TO XL037-LOC-FINCL-CLO-DTE    19520012
195300             MOVE HO013-LOC-MN-SLS-INCL-DTE                       19530012
195400                                    TO XL037-LOC-MN-SLS-INCL-DTE  19540012
195500             MOVE HO013-LOC-YR-SLS-INCL-DTE                       19550012
195600                                    TO XL037-LOC-YR-SLS-INCL-DTE  19560012
195700             MOVE HO013-LOC-OCPNC-DTE TO XL037-LOC-OCPNC-DTE      19570012
178600* START ************************************************ WR23954  19571051
195800*            MOVE HO013-LOC-POS-RGST-BNK-QTY                      19580053
195800             MOVE ZEROES                                          19581053
178600* END ************************************************** WR23954  19582051
195900                                    TO XL037-LOC-POS-RGST-BNK-QTY 19590012
196000             MOVE HO013-LOC-DST-IND TO XL037-LOC-DST-IND          19600012
196100             MOVE HO013-LOC-E-BUS-IND TO XL037-LOC-E-BUS-IND      19610012
196200             MOVE HO013-LOC-FMT-CDE TO XL037-LOC-STR-FMT-CDE      19620012
196300             MOVE HO013-LOC-STD-TM-ZN-CDE                         19630012
196400                                    TO XL037-LOC-STD-TM-ZN-CDE    19640012
196500             MOVE HO013-LOC-SLS-INCL-DTE-CDE                      19650012
196600                                    TO XL037-LOC-SLS-INCL-DTE-CDE 19660012
196700             MOVE HO013-LOC-TOT-SLG-SQ-FTG-QTY                    19670012
196800                                   TO XL037-LOC-TOT-SLG-SQ-FTG-QTY19680012
196900             MOVE HO013-LOC-TOT-SQ-FTG-QTY                        19690012
197000                                   TO XL037-LOC-TOT-SQ-FTG-QTY    19700012
197100             MOVE HO013-LOC-STP-ORD-DAYS-QTY                      19710012
197200                                    TO XL037-LOC-STP-ORD-DAYS-QTY 19720012
197300             MOVE HO013-LOC-STRT-ORD-DAYS-QTY                     19730012
197400                                    TO XL037-LOC-STRT-ORD-DAYS-QTY19740012
197500             MOVE HO013-LOC-ACQR-DTE     TO XL037-LOC-ACQR-DTE    19750012
197600             MOVE HO013-LOC-REMDL-DTE    TO XL037-LOC-RMDL-DTE    19760012
197700             MOVE HO013-LOC-MEDN-AGE-NBR TO XL037-LOC-MEDN-AGE-NBR19770012
197800             MOVE HO013-LOC-EST-HH-INCM-AMT                       19780012
197900                                    TO XL037-LOC-EST-HH-INCM-AMT  19790012
198000             MOVE HO013-LOC-QTR-SLS-INCL-DTE                      19800012
198100                                    TO XL037-LOC-QTR-SLS-INCL-DTE 19810012
198200             MOVE HO013-LOC-SEA-SLS-INCL-DTE                      19820012
198300                                    TO XL037-LOC-SEA-SLS-INCL-DTE 19830012
198400             MOVE HO013-LOC-EXTD-MALL-NM TO XL037-LOC-EXTD-MALL-NM19840012
198500             MOVE HO013-LOC-GRND-OPN-DTE TO XL037-LOC-GRND-OPN-DTE19850012
198600             MOVE HO013-LOC-DIRNS-TXT    TO XL037-LOC-DIRNS-TXT   19860049
198700             MOVE HO013-LOC-IN-STR-PRCHG-IND                      19870012
198800                                    TO XL037-LOC-IN-STR-PRCHG-IND 19880012
198900             MOVE HO013-LOC-PRCHG-IND TO XL037-LOC-PRCHG-CRE-IND  19890012
199000                                                                  19900011
199100             PERFORM 9000-WRITE-OUTPUT-REC                        19910011
199200             ADD 1 TO PA-LOCMSTR-UPD-COUNT                        19920011
199300                                                                  19930011
199400             PERFORM 8220-READ-INP23-FILE                         19940011
199500             PERFORM 8230-READ-INP26-FILE                         19950011
199600     ELSE                                                         19960011
199700     IF HO013-LOC-NBR > XL040-LOC-NBR                             19970046
P42541*        PERFORM 3110-PROCESS-INP26                               19980055
P42541         PERFORM 8230-READ-INP26-FILE                             19981055
199900     ELSE                                                         19990011
200000     IF XL040-LOC-NBR > HO013-LOC-NBR                             20000046
200100         PERFORM 3120-PROCESS-INP23                               20010011
200200     END-IF                                                       20020011
200300     END-IF                                                       20030011
200400     END-IF.                                                      20040011
200500                                                                  20050011
200600******************************************************************20060011
P42541*3110-PROCESS-INP26.                                              20070055
P42541*    MOVE '3110-PROCESS-INP26            ' TO PV-PARAGRAPH-NAME.  20080055
P42541*                                                                 20090055
P42541*    MOVE XL040-LOC-NBR TO PV-COMPARE-LOC.                        20100055
201100***  DISPLAY '3110- LOAD HOLD TABLE FROM XLT - ' PV-COMPARE-LOC.  20110047
P42541*                                                                 20120055
201300*TABLE POSSIBLE DELETES UNTIL ALL THREE RMS LOC FILES PROCESSED.  20130012
P42541*    MOVE XL040-LOC-NBR TO HL-HOLD-LOC-NBR (HL-IDX).              20140055
P42541*    SET HL-IDX UP BY 1.                                          20150055
P42541*                                                                 20160055
P42541*    PERFORM 8230-READ-INP26-FILE.                                20170055
P42541*                                                                 20180055
201900******************************************************************20190011
202000 3120-PROCESS-INP23.                                              20200011
202100     MOVE '3120-PROCESS-INP23            ' TO PV-PARAGRAPH-NAME.  20210011
202200                                                                  20220011
202300     INITIALIZE XL037-TRANS-REC.                                  20230011
202400                                                                  20240011
202500     MOVE '1'  TO XL037-ACTION-TYPE.                              20250035
202600     MOVE 'G'  TO XL037-RECORD-TYPE.                              20260012
202700     MOVE '07' TO XL037-SORT-SEQUENCE.                            20270036
202800                                                                  20280011
202900     MOVE HO013-LOC-NBR             TO XL037-LOC-NBR.             20290012
203000     MOVE HO013-LOC-REPLT-STR-NBR   TO XL037-LOC-REPLT-STR-NBR.   20300012
203100     MOVE HO013-LOC-DIST-NBR        TO XL037-LOC-DIST-NBR.        20310012
203200     MOVE HO013-LOC-TYP-CDE         TO XL037-LOC-LOC-TYP-CDE.     20320012
203300     MOVE HO013-LOC-NM              TO XL037-LOC-NM.              20330012
203400     MOVE HO013-LOC-5-ABBR-NM       TO XL037-LOC-5-ABBR-NM.       20340012
203500     MOVE HO013-LOC-LNE-1-ADDR      TO XL037-LOC-LNE-1-ADDR.      20350012
203600     MOVE HO013-LOC-LNE-2-ADDR      TO XL037-LOC-LNE-2-ADDR.      20360012
203700     MOVE HO013-LOC-CITY            TO XL037-LOC-CTY-NME.         20370012
203800     MOVE HO013-LOC-ST-CDE          TO XL037-LOC-ST-CDE.          20380012
203900     MOVE HO013-LOC-ZIP-10-CDE      TO XL037-LOC-ZIP-10-CDE.      20390012
204000     MOVE HO013-LOC-OPEN-DATE       TO XL037-LOC-OPN-DTE.         20400012
204100     MOVE HO013-LOC-CLOSE-DATE      TO XL037-LOC-CLO-DTE.         20410012
204200     MOVE HO013-LOC-LOC-10-ABBR-NM  TO XL037-LOC-LOC-10-ABBR-NM.  20420012
204300     MOVE HO013-LOC-PHONE-NUMBER    TO XL037-LOC-PHN-NBR.         20430012
204400     MOVE HO013-LOC-MGR-NM          TO XL037-LOC-MGR-NM.          20440012
204500     MOVE HO013-LOC-FINCL-CLO-DTE   TO XL037-LOC-FINCL-CLO-DTE.   20450012
204600     MOVE HO013-LOC-MN-SLS-INCL-DTE TO XL037-LOC-MN-SLS-INCL-DTE. 20460012
204700     MOVE HO013-LOC-YR-SLS-INCL-DTE TO XL037-LOC-YR-SLS-INCL-DTE. 20470012
204800     MOVE HO013-LOC-OCPNC-DTE       TO XL037-LOC-OCPNC-DTE.       20480012
178600* START ************************************************ WR23954  20481051
204900*    MOVE HO013-LOC-POS-RGST-BNK-QTY                              20490053
204900     MOVE ZEROES                                                  20491053
178600* END ************************************************** WR23954  20492051
205000                                    TO XL037-LOC-POS-RGST-BNK-QTY.20500012
205100     MOVE HO013-LOC-DST-IND         TO XL037-LOC-DST-IND.         20510012
205200     MOVE HO013-LOC-E-BUS-IND       TO XL037-LOC-E-BUS-IND.       20520012
205300     MOVE HO013-LOC-FMT-CDE         TO XL037-LOC-STR-FMT-CDE.     20530012
205400     MOVE HO013-LOC-STD-TM-ZN-CDE   TO XL037-LOC-STD-TM-ZN-CDE.   20540012
205500     MOVE HO013-LOC-SLS-INCL-DTE-CDE                              20550012
205600                                    TO XL037-LOC-SLS-INCL-DTE-CDE.20560012
205700     MOVE HO013-LOC-TOT-SLG-SQ-FTG-QTY                            20570012
205800       TO XL037-LOC-TOT-SLG-SQ-FTG-QTY.                           20580012
205900     MOVE HO013-LOC-TOT-SQ-FTG-QTY  TO XL037-LOC-TOT-SQ-FTG-QTY.  20590012
206000     MOVE HO013-LOC-STP-ORD-DAYS-QTY                              20600012
206100                                    TO XL037-LOC-STP-ORD-DAYS-QTY.20610012
206200     MOVE HO013-LOC-STRT-ORD-DAYS-QTY                             20620012
206300       TO XL037-LOC-STRT-ORD-DAYS-QTY.                            20630012
206400     MOVE HO013-LOC-ACQR-DTE        TO XL037-LOC-ACQR-DTE.        20640012
206500     MOVE HO013-LOC-REMDL-DTE       TO XL037-LOC-RMDL-DTE.        20650012
206600     MOVE HO013-LOC-MEDN-AGE-NBR    TO XL037-LOC-MEDN-AGE-NBR.    20660012
206700     MOVE HO013-LOC-EST-HH-INCM-AMT TO XL037-LOC-EST-HH-INCM-AMT. 20670012
206800     MOVE HO013-LOC-QTR-SLS-INCL-DTE                              20680012
206900                                    TO XL037-LOC-QTR-SLS-INCL-DTE.20690012
207000     MOVE HO013-LOC-SEA-SLS-INCL-DTE                              20700012
207100                                    TO XL037-LOC-SEA-SLS-INCL-DTE.20710012
207200     MOVE HO013-LOC-EXTD-MALL-NM    TO XL037-LOC-EXTD-MALL-NM.    20720012
207300     MOVE HO013-LOC-GRND-OPN-DTE    TO XL037-LOC-GRND-OPN-DTE.    20730012
207400     MOVE HO013-LOC-DIRNS-TXT       TO XL037-LOC-DIRNS-TXT.       20740049
207500     MOVE HO013-LOC-IN-STR-PRCHG-IND                              20750012
207600                                    TO XL037-LOC-IN-STR-PRCHG-IND.20760012
207700     MOVE HO013-LOC-PRCHG-IND       TO XL037-LOC-PRCHG-CRE-IND.   20770012
207800                                                                  20780011
207900     PERFORM 9000-WRITE-OUTPUT-REC.                               20790011
208000     ADD 1 TO PA-LOCMSTR-ISRT-COUNT.                              20800011
208100                                                                  20810011
208200     PERFORM 8220-READ-INP23-FILE.                                20820011
208300                                                                  20830011
208400******************************************************************20840012
208500*            P R O C E S S   W A R E H O U S E                   *20850012
208600******************************************************************20860012
208700 3200-PROCESS-LOC-WHS.                                            20870012
208800     MOVE '3200-PROCESS-LOC-WHS          ' TO PV-PARAGRAPH-NAME.  20880012
208900                                                                  20890012
209000     IF HO014-WH-NBR = XL040-LOC-NBR                              20900046
209100*REMOVE FROM 'DELETE' TABLE                                       20910031
P42541*        MOVE HO014-WH-NBR TO PV-COMPARE-LOC                      20920056
P42541*        PERFORM 7000-CHECK-LOC-TABLE                             20930055
209400*CHECK FOR 'UPDATE'                                               20940031
209500         IF HO014-WH-TYP-CDE       = XL040-LOC-TYP-CDE            20950046
209600           AND HO014-WH-NM         = XL040-LOC-NM                 20960046
209700           AND HO014-WH-5-ABBR-NM  = XL040-LOC-5-ABBR-NM          20970046
209800           AND HO014-WH-LNE-1-ADDR = XL040-LNE-1-ADDR             20980046
209900           AND HO014-WH-LNE-2-ADDR = XL040-LNE-2-ADDR             20990046
210000           AND HO014-WH-CITY       = XL040-CTY-NM                 21000046
210100           AND HO014-WH-ST-CDE     = XL040-ST-CDE                 21010046
210200           AND HO014-WH-ZIP-10-CDE = XL040-ZIP-10-CDE             21020046
210300           AND HO014-WH-OPEN-DATE  = XL040-OPN-DTE                21030046
210400           AND HO014-WH-CLOSE-DATE = XL040-CLO-DTE                21040046
210500*          AND HO014-WH-10-ABBR-NM = XL040-LOC-10-ABBR-NM         21050048
210600           AND ((HO014-WH-10-ABBR-NM = XL040-LOC-10-ABBR-NM)      21060048
210700             OR (HO014-WH-10-ABBR-NM = SPACES AND                 21070048
210800                 XL040-LOC-10-ABBR-NM = LOW-VALUES))              21080048
210900*          AND HO014-WH-OCPNC-DTE  = XL040-OCPNC-DTE              21090048
211000           AND ((HO014-WH-OCPNC-DTE = XL040-OCPNC-DTE)            21100048
211100             OR (HO014-WH-OCPNC-DTE = '9999-09-09' AND            21110048
211200                 XL040-OCPNC-DTE = LOW-VALUES))                   21120048
211300*          AND HO014-WH-DST-IND    = XL040-DST-IND                21130048
211400           AND ((HO014-WH-DST-IND = XL040-DST-IND)                21140048
211500             OR (HO014-WH-DST-IND = SPACES AND                    21150048
211600                 XL040-DST-IND = LOW-VALUES))                     21160048
211700*          AND HO014-WH-E-BUS-IND  = XL040-E-BUS-IND              21170048
211800           AND ((HO014-WH-E-BUS-IND = XL040-E-BUS-IND)            21180048
211900             OR (HO014-WH-E-BUS-IND = SPACES AND                  21190048
212000                 XL040-E-BUS-IND = LOW-VALUES))                   21200048
212100*          AND HO014-WH-IN-STR-PRCHG-IND                          21210048
212200*                                  = XL040-IN-STR-PRCHG-IND       21220048
212300           AND ((HO014-WH-IN-STR-PRCHG-IND                        21230048
212400                 = XL040-IN-STR-PRCHG-IND)                        21240048
212500             OR (HO014-WH-IN-STR-PRCHG-IND = SPACES AND           21250048
212600                 XL040-IN-STR-PRCHG-IND = LOW-VALUES))            21260048
212700*          AND HO014-WH-PRCHG-IND  = XL040-PRCHG-CRE-IND          21270048
212800           AND ((HO014-WH-PRCHG-IND = XL040-PRCHG-CRE-IND)        21280048
212900             OR (HO014-WH-PRCHG-IND = SPACES AND                  21290048
213000                 XL040-PRCHG-CRE-IND = LOW-VALUES))               21300048
213100*JPL       AND HO014-WH-DC-NBR     = ????                         21310012
213200             PERFORM 8240-READ-INP24-FILE                         21320012
213300             PERFORM 8230-READ-INP26-FILE                         21330012
213400         ELSE                                                     21340012
213500             INITIALIZE XL037-TRANS-REC                           21350012
213600             MOVE '2'  TO XL037-ACTION-TYPE                       21360035
213700             MOVE 'M'  TO XL037-RECORD-TYPE                       21370018
213800             MOVE '19' TO XL037-SORT-SEQUENCE                     21380036
213900                                                                  21390012
214000             MOVE HO014-WH-NBR        TO XL037-LOC-NBR            21400012
214100             MOVE HO014-WH-TYP-CDE    TO XL037-LOC-LOC-TYP-CDE    21410012
214200             MOVE HO014-WH-NM         TO XL037-LOC-NM             21420012
214300             MOVE HO014-WH-5-ABBR-NM  TO XL037-LOC-5-ABBR-NM      21430012
214400             MOVE HO014-WH-LNE-1-ADDR TO XL037-LOC-LNE-1-ADDR     21440012
214500             MOVE HO014-WH-LNE-2-ADDR TO XL037-LOC-LNE-2-ADDR     21450012
214600             MOVE HO014-WH-CITY       TO XL037-LOC-CTY-NME        21460012
214700             MOVE HO014-WH-ST-CDE     TO XL037-LOC-ST-CDE         21470012
214800             MOVE HO014-WH-ZIP-10-CDE TO XL037-LOC-ZIP-10-CDE     21480012
214900             MOVE HO014-WH-OPEN-DATE  TO XL037-LOC-OPN-DTE        21490012
215000             MOVE HO014-WH-CLOSE-DATE TO XL037-LOC-CLO-DTE        21500012
215100             MOVE HO014-WH-10-ABBR-NM TO XL037-LOC-LOC-10-ABBR-NM 21510012
215200             MOVE HO014-WH-OCPNC-DTE  TO XL037-LOC-OCPNC-DTE      21520012
215300             MOVE HO014-WH-DST-IND    TO XL037-LOC-DST-IND        21530012
215400             MOVE HO014-WH-E-BUS-IND  TO XL037-LOC-E-BUS-IND      21540012
215500             MOVE HO014-WH-IN-STR-PRCHG-IND                       21550012
215600               TO XL037-LOC-IN-STR-PRCHG-IND                      21560012
215700             MOVE HO014-WH-PRCHG-IND  TO XL037-LOC-PRCHG-CRE-IND  21570012
215800*JPL         MOVE HO014-WH-DC-NBR     TO ????                     21580012
215900                                                                  21590012
216000             PERFORM 9000-WRITE-OUTPUT-REC                        21600012
216100             ADD 1 TO PA-LOC-WHS-UPD-COUNT                        21610012
216200                                                                  21620012
216300             PERFORM 8240-READ-INP24-FILE                         21630012
216400             PERFORM 8230-READ-INP26-FILE                         21640012
216500     ELSE                                                         21650012
216600     IF HO014-WH-NBR  > XL040-LOC-NBR                             21660046
P42541*        PERFORM 3210-PROCESS-INP26                               21670055
P42541         PERFORM 8230-READ-INP26-FILE                             21671055
216800     ELSE                                                         21680012
216900     IF XL040-LOC-NBR > HO014-WH-NBR                              21690046
217000         PERFORM 3220-PROCESS-INP24                               21700012
217100     END-IF                                                       21710012
217200     END-IF                                                       21720012
217300     END-IF.                                                      21730012
217400                                                                  21740012
217500******************************************************************21750013
P42541*3210-PROCESS-INP26.                                              21760057
P42541*    MOVE '3210-PROCESS-INP26            ' TO PV-PARAGRAPH-NAME.  21770057
P42541*                                                                 21780057
P42541*COMPARE TO PV-HOLD-TABLE.                                        21790057
P42541*    MOVE HO014-WH-NBR TO PV-COMPARE-LOC.                         21800057
P42541*    PERFORM 7000-CHECK-LOC-TABLE.                                21810057
P42541*                                                                 21820057
P42541*    PERFORM 8230-READ-INP26-FILE.                                21830057
P42541*                                                                 21840057
218500******************************************************************21850012
218600 3220-PROCESS-INP24.                                              21860012
218700     MOVE '3220-PROCESS-INP24            ' TO PV-PARAGRAPH-NAME.  21870012
218800                                                                  21880012
218900     INITIALIZE XL037-TRANS-REC.                                  21890012
219000                                                                  21900012
219100     MOVE '1'  TO XL037-ACTION-TYPE.                              21910035
219200     MOVE 'M'  TO XL037-RECORD-TYPE.                              21920018
219300     MOVE '07' TO XL037-SORT-SEQUENCE.                            21930036
219400                                                                  21940012
219500     MOVE HO014-WH-NBR        TO XL037-LOC-NBR.                   21950012
219600     MOVE HO014-WH-TYP-CDE    TO XL037-LOC-LOC-TYP-CDE.           21960012
219700     MOVE HO014-WH-NM         TO XL037-LOC-NM.                    21970012
219800     MOVE HO014-WH-5-ABBR-NM  TO XL037-LOC-5-ABBR-NM.             21980012
219900     MOVE HO014-WH-LNE-1-ADDR TO XL037-LOC-LNE-1-ADDR.            21990012
220000     MOVE HO014-WH-LNE-2-ADDR TO XL037-LOC-LNE-2-ADDR.            22000012
220100     MOVE HO014-WH-CITY       TO XL037-LOC-CTY-NME.               22010012
220200     MOVE HO014-WH-ST-CDE     TO XL037-LOC-ST-CDE.                22020012
220300     MOVE HO014-WH-ZIP-10-CDE TO XL037-LOC-ZIP-10-CDE.            22030012
220400     MOVE HO014-WH-OPEN-DATE  TO XL037-LOC-OPN-DTE.               22040012
220500     MOVE HO014-WH-CLOSE-DATE TO XL037-LOC-CLO-DTE.               22050012
220600     MOVE HO014-WH-10-ABBR-NM TO XL037-LOC-LOC-10-ABBR-NM.        22060012
220700     MOVE HO014-WH-OCPNC-DTE  TO XL037-LOC-OCPNC-DTE.             22070012
220800     MOVE HO014-WH-DST-IND    TO XL037-LOC-DST-IND.               22080012
220900     MOVE HO014-WH-E-BUS-IND  TO XL037-LOC-E-BUS-IND.             22090012
221000     MOVE HO014-WH-IN-STR-PRCHG-IND                               22100012
221100                              TO XL037-LOC-IN-STR-PRCHG-IND.      22110012
221200     MOVE HO014-WH-PRCHG-IND  TO XL037-LOC-PRCHG-CRE-IND.         22120012
221300*JPL MOVE HO014-WH-DC-NBR     TO ????                             22130012
221400                                                                  22140012
221500     PERFORM 9000-WRITE-OUTPUT-REC.                               22150012
221600     ADD 1 TO PA-LOC-WHS-ISRT-COUNT.                              22160012
221700                                                                  22170012
221800     PERFORM 8240-READ-INP24-FILE.                                22180012
221900                                                                  22190012
222000******************************************************************22200013
222100*           P R O C E S S   O U T S I D E   L O C S              *22210013
222200******************************************************************22220013
222300 3300-PROCESS-OUTLOC.                                             22230013
222400     MOVE '3300-PROCESS-OUTLOC           ' TO PV-PARAGRAPH-NAME.  22240013
222500                                                                  22250013
222600     IF HO015-OUTLC-ID-2-5 = XL040-LOC-NBR                        22260046
222700*REMOVE FROM 'DELETE' TABLE                                       22270031
P42541*        MOVE HO015-OUTLC-ID-2-5 TO PV-COMPARE-LOC                22280056
P42541*        PERFORM 7000-CHECK-LOC-TABLE                             22290055
223000*CHECK FOR 'UPDATE'                                               22300031
223100         IF HO015-OTLC-TYPE          = XL040-LOC-TYP-CDE          22310046
223200           AND HO015-OTLC-DESC       = XL040-LOC-NM               22320046
223300           AND HO015-OTLC-LOC-5-ABBR-NM                           22330013
223400                                     = XL040-LOC-5-ABBR-NM        22340046
223500           AND HO015-OTLC-LNE-1-ADDR = XL040-LNE-1-ADDR           22350046
223600           AND HO015-OTLC-LNE-2-ADDR = XL040-LNE-2-ADDR           22360046
223700           AND HO015-OTLC-CTY-NM     = XL040-CTY-NM               22370046
223800           AND HO015-OTLC-ST-CDE     = XL040-ST-CDE               22380046
223900           AND HO015-OTLC-ZIP-10-CDE = XL040-ZIP-10-CDE           22390046
224000           AND HO015-OTLC-OPN-DTE    = XL040-OPN-DTE              22400046
224100           AND HO015-OTLC-CLO-DTE    = XL040-CLO-DTE              22410046
224200*          AND HO015-OTLC-PHN-NBR    = XL040-PHN-NBR              22420048
224300           AND ((HO015-OTLC-PHN-NBR = XL040-PHN-NBR)              22430048
224400             OR (HO015-OTLC-PHN-NBR = SPACES AND                  22440048
224500                 XL040-PHN-NBR = LOW-VALUES))                     22450048
224600             PERFORM 8250-READ-INP25-FILE                         22460013
224700             PERFORM 8230-READ-INP26-FILE                         22470013
224800         ELSE                                                     22480013
224900             INITIALIZE XL037-TRANS-REC                           22490013
225000             MOVE '2'  TO XL037-ACTION-TYPE                       22500035
225100             MOVE 'N'  TO XL037-RECORD-TYPE                       22510018
225200             MOVE '19' TO XL037-SORT-SEQUENCE                     22520036
225300                                                                  22530013
225400             MOVE HO015-OUTLC-ID-2-5    TO XL037-LOC-NBR          22540013
225500             MOVE HO015-OTLC-TYPE       TO XL037-LOC-LOC-TYP-CDE  22550013
225600             MOVE HO015-OTLC-DESC       TO XL037-LOC-NM           22560013
225700             MOVE HO015-OTLC-LOC-5-ABBR-NM                        22570013
225800                                        TO XL037-LOC-5-ABBR-NM    22580013
225900             MOVE HO015-OTLC-LNE-1-ADDR TO XL037-LOC-LNE-1-ADDR   22590013
226000             MOVE HO015-OTLC-LNE-2-ADDR TO XL037-LOC-LNE-2-ADDR   22600013
226100             MOVE HO015-OTLC-CTY-NM     TO XL037-LOC-CTY-NME      22610013
226200             MOVE HO015-OTLC-ST-CDE     TO XL037-LOC-ST-CDE       22620013
226300             MOVE HO015-OTLC-ZIP-10-CDE TO XL037-LOC-ZIP-10-CDE   22630013
226400             MOVE HO015-OTLC-OPN-DTE    TO XL037-LOC-OPN-DTE      22640013
226500             MOVE HO015-OTLC-CLO-DTE    TO XL037-LOC-CLO-DTE      22650013
226600             MOVE HO015-OTLC-PHN-NBR    TO XL037-LOC-PHN-NBR      22660013
226700                                                                  22670013
226800             PERFORM 9000-WRITE-OUTPUT-REC                        22680013
226900             ADD 1 TO PA-OUTLOC-UPD-COUNT                         22690013
227000                                                                  22700013
227100             PERFORM 8250-READ-INP25-FILE                         22710013
227200             PERFORM 8230-READ-INP26-FILE                         22720013
227300     ELSE                                                         22730013
227400     IF HO015-OUTLC-ID-2-5 > XL040-LOC-NBR                        22740046
P42541*        PERFORM 3310-PROCESS-INP26                               22750055
P42541         PERFORM 8230-READ-INP26-FILE                             22751055
227600     ELSE                                                         22760013
227700     IF XL040-LOC-NBR > HO015-OUTLC-ID-2-5                        22770046
227800         PERFORM 3320-PROCESS-INP25                               22780013
227900     END-IF                                                       22790013
228000     END-IF                                                       22800013
228100     END-IF.                                                      22810013
228200                                                                  22820013
228300******************************************************************22830013
P42541*3310-PROCESS-INP26.                                              22840055
P42541*    MOVE '3310-PROCESS-INP26            ' TO PV-PARAGRAPH-NAME.  22850055
P42541*                                                                 22860055
228700*COMPARE TO PV-HOLD-TABLE.                                        22870013
P42541*    MOVE HO015-OUTLC-ID-2-5 TO PV-COMPARE-LOC.                   22880055
P42541*    PERFORM 7000-CHECK-LOC-TABLE.                                22890055
P42541*                                                                 22900055
P42541*    PERFORM 8230-READ-INP26-FILE.                                22910055
P42541*                                                                 22920055
229300******************************************************************22930013
229400 3320-PROCESS-INP25.                                              22940014
229500     MOVE '3320-PROCESS-INP25            ' TO PV-PARAGRAPH-NAME.  22950014
229600                                                                  22960013
229700     INITIALIZE XL037-TRANS-REC.                                  22970013
229800                                                                  22980013
229900     MOVE '1'  TO XL037-ACTION-TYPE.                              22990035
230000     MOVE 'N'  TO XL037-RECORD-TYPE.                              23000018
230100     MOVE '07' TO XL037-SORT-SEQUENCE.                            23010036
230200                                                                  23020013
230300     MOVE HO015-OUTLC-ID-2-5       TO XL037-LOC-NBR.              23030013
230400     MOVE HO015-OTLC-TYPE          TO XL037-LOC-LOC-TYP-CDE.      23040013
230500     MOVE HO015-OTLC-DESC          TO XL037-LOC-NM.               23050013
230600     MOVE HO015-OTLC-LOC-5-ABBR-NM TO XL037-LOC-5-ABBR-NM.        23060013
230700     MOVE HO015-OTLC-LNE-1-ADDR    TO XL037-LOC-LNE-1-ADDR.       23070013
230800     MOVE HO015-OTLC-LNE-2-ADDR    TO XL037-LOC-LNE-2-ADDR.       23080013
230900     MOVE HO015-OTLC-CTY-NM        TO XL037-LOC-CTY-NME.          23090013
231000     MOVE HO015-OTLC-ST-CDE        TO XL037-LOC-ST-CDE.           23100013
231100     MOVE HO015-OTLC-ZIP-10-CDE    TO XL037-LOC-ZIP-10-CDE.       23110013
231200     MOVE HO015-OTLC-OPN-DTE       TO XL037-LOC-OPN-DTE.          23120013
231300     MOVE HO015-OTLC-CLO-DTE       TO XL037-LOC-CLO-DTE.          23130013
231400     MOVE HO015-OTLC-PHN-NBR       TO XL037-LOC-PHN-NBR.          23140013
231500                                                                  23150013
231600     PERFORM 9000-WRITE-OUTPUT-REC.                               23160013
231700     ADD 1 TO PA-OUTLOC-ISRT-COUNT.                               23170015
231800                                                                  23180013
231900     PERFORM 8250-READ-INP25-FILE.                                23190013
232000                                                                  23200013
232100******************************************************************23210013
232200******************************************************************23220012
P42541*7000-CHECK-LOC-TABLE.                                            23230055
P42541*                                                                 23240055
232500*RMS LOCATIONS CONSIST OF THREE INPUT FILES.  THE LOCATIONS FROM  23250013
232600*THE DB2 LOCATION FILE ARE TABLED & THEN REMOVED AS THE LOCATION  23260013
232700*IS FOUND ON THE PV-HOLD-TABLE.  ANY REMAINING LOCATIONS, AFTER   23270013
232800*ALL THREE RMS INPUT FILES ARE PROCESSED, WILL BE DELETED.        23280013
232900***  DISPLAY ' 7000- PV-COMPARE-LOC = ' PV-COMPARE-LOC            23290047
P42541*    SET HL-IDX TO 1                                              23300055
P42541*    SEARCH HL-HOLD-LOC-ENTRY                                     23310055
P42541*      AT END                                                     23320055
233300***      DISPLAY '       ==> LOCATION NOT ON TABLE <== '          23330047
P42541*        CONTINUE                                                 23340055
P42541*                                                                 23350055
P42541*      WHEN HL-HOLD-LOC-NBR (HL-IDX) = PV-COMPARE-LOC             23360055
P42541*          MOVE ZEROES TO HL-HOLD-LOC-NBR (HL-IDX)                23370055
P42541*                                                                 23380055
P42541*    END-SEARCH.                                                  23390055
P42541*                                                                 23400055
234100******************************************************************23410015
P42541*7100-DLT-FROM-LOC-TABLE.                                         23420055
P42541*                                                                 23430055
P42541*    SET HL-IDX TO 1.                                             23440055
P42541*                                                                 23450055
P42541*    PERFORM                                                      23460055
P42541*      UNTIL HL-IDX > 900                                         23470055
P42541*                                                                 23480055
P42541*        IF HL-HOLD-LOC-NBR (HL-IDX) > ZEROES                     23490055
P42541*            INITIALIZE XL037-TRANS-REC                           23500055
P42541*                                                                 23510055
P42541*            MOVE '3'  TO XL037-ACTION-TYPE                       23520055
P42541*            MOVE 'G'  TO XL037-RECORD-TYPE                       23530055
P42541*            MOVE '30' TO XL037-SORT-SEQUENCE                     23540055
P42541*                                                                 23550055
P42541*            MOVE HL-HOLD-LOC-NBR (HL-IDX) TO XL037-LOC-NBR       23560055
P42541*                                                                 23570055
P42541*            PERFORM 9000-WRITE-OUTPUT-REC                        23580055
P42541*            ADD 1 TO PA-LOCMSTR-DEL-COUNT                        23590055
P42541*        END-IF                                                   23600055
P42541*                                                                 23610055
P42541*        SET HL-IDX UP BY 1                                       23620055
P42541*    END-PERFORM.                                                 23630055
P42541*                                                                 23640055
236500******************************************************************23650012
236600*            I N P U T   F I L E   R E A D S                     *23660004
236700******************************************************************23670004
236800 8000-READ-INP01-FILE.                                            23680004
236900     MOVE '8000-READ-INP01-FILE          ' TO PV-PARAGRAPH-NAME.  23690008
237000                                                                  23700003
237100     READ RMS-TERR-FILE INTO HO010-TERRITORY-DATA                 23710004
237200       AT END                                                     23720003
237300         SET PS-EMPTY-FILE-YES TO TRUE                            23730032
237400         SET PS-EOF-RMS-YES    TO TRUE.                           23740032
237500                                                                  23750003
237600******************************************************************23760003
237700 8010-READ-INP02-FILE.                                            23770004
237800     MOVE '8010-READ-INP02-FILE          ' TO PV-PARAGRAPH-NAME.  23780008
237900                                                                  23790003
238000     READ DB2-TERR-FILE INTO DCLXLT00011                          23800004
238100       AT END                                                     23810003
238200         SET PS-EOF-DB2-YES TO TRUE.                              23820004
238300                                                                  23830003
238400******************************************************************23840003
238500 8020-READ-INP03-FILE.                                            23850004
238600     MOVE '8020-READ-INP03-FILE          ' TO PV-PARAGRAPH-NAME.  23860008
238700                                                                  23870004
238800     READ RMS-REGN-FILE INTO HO011-REGION-DATA                    23880004
238900       AT END                                                     23890004
239000         SET PS-EMPTY-FILE-YES TO TRUE                            23900032
239100         SET PS-EOF-RMS-YES    TO TRUE.                           23910032
239200                                                                  23920004
239300******************************************************************23930004
239400 8030-READ-INP04-FILE.                                            23940004
239500     MOVE '8030-READ-INP04-FILE          ' TO PV-PARAGRAPH-NAME.  23950008
239600                                                                  23960004
239700     READ DB2-REGN-FILE INTO DCLXLT00012                          23970004
239800       AT END                                                     23980004
239900         SET PS-EOF-DB2-YES TO TRUE.                              23990004
240000                                                                  24000004
240100******************************************************************24010004
240200 8040-READ-INP05-FILE.                                            24020004
240300     MOVE '8040-READ-INP05-FILE          ' TO PV-PARAGRAPH-NAME.  24030008
240400                                                                  24040004
240500     READ RMS-DIST-FILE INTO HO012-DISTRICT-DATA                  24050004
240600       AT END                                                     24060004
240700         SET PS-EMPTY-FILE-YES TO TRUE                            24070032
240800         SET PS-EOF-RMS-YES    TO TRUE.                           24080032
240900                                                                  24090004
241000******************************************************************24100004
241100 8050-READ-INP06-FILE.                                            24110004
241200     MOVE '8050-READ-INP06-FILE          ' TO PV-PARAGRAPH-NAME.  24120008
241300                                                                  24130004
241400     READ DB2-DIST-FILE INTO DCLXLT00013                          24140004
241500       AT END                                                     24150004
241600         SET PS-EOF-DB2-YES TO TRUE.                              24160004
241700                                                                  24170004
241800******************************************************************24180006
241900 8060-READ-INP07-FILE.                                            24190006
242000     MOVE '8060-READ-INP07-FILE          ' TO PV-PARAGRAPH-NAME.  24200008
242100                                                                  24210006
242200     READ RMS-DC-LOC-FILE INTO HO016-DCLOCASG-DATA                24220006
242300       AT END                                                     24230006
242400         SET PS-EMPTY-FILE-YES TO TRUE                            24240032
242500         SET PS-EOF-RMS-YES    TO TRUE.                           24250032
242600                                                                  24260006
242700******************************************************************24270006
242800 8070-READ-INP08-FILE.                                            24280006
242900     MOVE '8070-READ-INP08-FILE          ' TO PV-PARAGRAPH-NAME.  24290008
243000                                                                  24300006
243100     READ DB2-DC-LOC-FILE INTO DCLXL041                           24310046
243200       AT END                                                     24320006
243300         SET PS-EOF-DB2-YES TO TRUE.                              24330006
243400                                                                  24340006
243500******************************************************************24350006
243600 8080-READ-INP09-FILE.                                            24360006
243700     MOVE '8080-READ-INP09-FILE          ' TO PV-PARAGRAPH-NAME.  24370008
243800                                                                  24380006
243900     READ RMS-LOC-TYP-FILE INTO HO021-LOCATION-TYPE-DATA          24390006
244000       AT END                                                     24400006
244100         SET PS-EMPTY-FILE-YES TO TRUE                            24410032
244200         SET PS-EOF-RMS-YES    TO TRUE.                           24420032
244300                                                                  24430006
244400******************************************************************24440006
244500 8090-READ-INP10-FILE.                                            24450006
244600     MOVE '8090-READ-INP10-FILE          ' TO PV-PARAGRAPH-NAME.  24460008
244700                                                                  24470006
244800     READ DB2-LOC-TYP-FILE INTO DCLXLT00015                       24480006
244900       AT END                                                     24490006
245000         SET PS-EOF-DB2-YES TO TRUE.                              24500006
245100                                                                  24510006
245200******************************************************************24520006
245300 8100-READ-INP11-FILE.                                            24530006
245400     MOVE '8100-READ-INP11-FILE          ' TO PV-PARAGRAPH-NAME.  24540008
245500                                                                  24550006
245600     READ RMS-STZC-FILE INTO HO020-TIME-ZONE-DATA                 24560006
245700       AT END                                                     24570006
245800         SET PS-EMPTY-FILE-YES TO TRUE                            24580032
245900         SET PS-EOF-RMS-YES    TO TRUE.                           24590032
246000                                                                  24600006
246100******************************************************************24610006
246200 8110-READ-INP12-FILE.                                            24620006
246300     MOVE '8110-READ-INP12-FILE          ' TO PV-PARAGRAPH-NAME.  24630008
246400                                                                  24640006
246500     READ DB2-STZC-FILE INTO DCLXLT00016                          24650006
246600       AT END                                                     24660006
246700         SET PS-EOF-DB2-YES TO TRUE.                              24670006
246800                                                                  24680006
246900******************************************************************24690006
247000 8120-READ-INP13-FILE.                                            24700006
247100     MOVE '8120-READ-INP13-FILE          ' TO PV-PARAGRAPH-NAME.  24710008
247200                                                                  24720006
247300     READ RMS-STR-FMT-FILE INTO HO022-STORE-FORMAT-DATA           24730006
247400       AT END                                                     24740006
247500         SET PS-EMPTY-FILE-YES TO TRUE                            24750032
247600         SET PS-EOF-RMS-YES    TO TRUE.                           24760032
247700                                                                  24770006
247800******************************************************************24780006
247900 8130-READ-INP14-FILE.                                            24790006
248000     MOVE '8130-READ-INP14-FILE          ' TO PV-PARAGRAPH-NAME.  24800008
248100                                                                  24810006
248200     READ DB2-STR-FMT-FILE INTO DCLXLT00017                       24820006
248300       AT END                                                     24830006
248400         SET PS-EOF-DB2-YES TO TRUE.                              24840006
248500                                                                  24850006
248600******************************************************************24860007
248700 8140-READ-INP15-FILE.                                            24870007
248800     MOVE '8140-READ-INP15-FILE          ' TO PV-PARAGRAPH-NAME.  24880008
248900                                                                  24890007
249000     READ RMS-STR-MBSHP-FILE INTO HO019-STR-GP-MBRSHP-DATA        24900007
249100       AT END                                                     24910007
249200         SET PS-EMPTY-FILE-YES TO TRUE                            24920032
249300         SET PS-EOF-RMS-YES    TO TRUE.                           24930032
249400                                                                  24940007
249500******************************************************************24950007
249600 8150-READ-INP16-FILE.                                            24960007
249700     MOVE '8150-READ-INP16-FILE          ' TO PV-PARAGRAPH-NAME.  24970008
249800                                                                  24980007
249900     READ DB2-STR-MBSHP-FILE INTO DCLXLT00018                     24990007
250000       AT END                                                     25000007
250100         SET PS-EOF-DB2-YES TO TRUE.                              25010007
250200                                                                  25020007
250300******************************************************************25030008
250400 8160-READ-INP17-FILE.                                            25040008
250500     MOVE '8160-READ-INP17-FILE          ' TO PV-PARAGRAPH-NAME.  25050008
250600                                                                  25060008
250700     READ RMS-STR-TYP-FILE INTO HO017-STR-GP-TYPE-DATA            25070008
250800       AT END                                                     25080008
250900         SET PS-EMPTY-FILE-YES TO TRUE                            25090032
251000         SET PS-EOF-RMS-YES    TO TRUE.                           25100032
251100                                                                  25110008
251200******************************************************************25120008
251300 8170-READ-INP18-FILE.                                            25130008
251400     MOVE '8170-READ-INP18-FILE          ' TO PV-PARAGRAPH-NAME.  25140008
251500                                                                  25150008
251600     READ DB2-STR-TYP-FILE INTO DCLXLT00019                       25160008
251700       AT END                                                     25170008
251800         SET PS-EOF-DB2-YES TO TRUE.                              25180008
251900                                                                  25190008
252000******************************************************************25200008
252100 8180-READ-INP19-FILE.                                            25210008
252200     MOVE '8180-READ-INP19-FILE          ' TO PV-PARAGRAPH-NAME.  25220008
252300                                                                  25230008
252400     READ RMS-STR-GRP-FILE INTO HO018-STR-GP-DATA                 25240008
252500       AT END                                                     25250008
252600         SET PS-EMPTY-FILE-YES TO TRUE                            25260032
252700         SET PS-EOF-RMS-YES    TO TRUE.                           25270032
252800                                                                  25280008
252900******************************************************************25290008
253000 8190-READ-INP20-FILE.                                            25300008
253100     MOVE '8190-READ-INP20-FILE          ' TO PV-PARAGRAPH-NAME.  25310008
253200                                                                  25320008
253300     READ DB2-STR-GRP-FILE INTO DCLXL042                          25330046
253400       AT END                                                     25340008
253500         SET PS-EOF-DB2-YES TO TRUE.                              25350008
253600                                                                  25360008
253700******************************************************************25370009
253800 8200-READ-INP21-FILE.                                            25380009
253900     MOVE '8200-READ-INP21-FILE          ' TO PV-PARAGRAPH-NAME.  25390009
254000                                                                  25400009
254100     READ RMS-STR-DTE-FILE INTO HO023-PRICE-ZNE-DTE-DATA          25410009
254200       AT END                                                     25420009
254300         SET PS-EMPTY-FILE-YES TO TRUE                            25430032
254400         SET PS-EOF-RMS-YES    TO TRUE.                           25440032
254500                                                                  25450009
254600******************************************************************25460009
254700 8210-READ-INP22-FILE.                                            25470009
254800     MOVE '8210-READ-INP22-FILE          ' TO PV-PARAGRAPH-NAME.  25480009
254900                                                                  25490009
255000     READ DB2-STR-DTE-FILE INTO DCLXL043                          25500046
255100       AT END                                                     25510009
255200         SET PS-EOF-DB2-YES TO TRUE.                              25520009
255300                                                                  25530009
255400******************************************************************25540011
255500 8220-READ-INP23-FILE.                                            25550011
255600     MOVE '8220-READ-INP23-FILE          ' TO PV-PARAGRAPH-NAME.  25560011
255700                                                                  25570011
255800     READ RMS-LOCMSTR-FILE INTO HO013-LOCATION-DATA               25580011
255900       AT END                                                     25590011
256000         SET PS-EMPTY-FILE-YES TO TRUE                            25600032
256100         SET PS-EOF-RMS-YES    TO TRUE.                           25610032
256200                                                                  25620011
256300******************************************************************25630011
256400 8230-READ-INP26-FILE.                                            25640011
256500     MOVE '8230-READ-INP26-FILE          ' TO PV-PARAGRAPH-NAME.  25650011
256600                                                                  25660011
256700     READ DB2-LOCMSTR-FILE INTO DCLXL040                          25670046
256800       AT END                                                     25680011
256900         SET PS-EOF-DB2-YES TO TRUE.                              25690011
257000                                                                  25700011
257100******************************************************************25710012
257200 8240-READ-INP24-FILE.                                            25720012
257300     MOVE '8240-READ-INP24-FILE          ' TO PV-PARAGRAPH-NAME.  25730012
257400                                                                  25740012
257500     READ RMS-LOC-WHS-FILE INTO HO014-WH-DATA                     25750012
257600       AT END                                                     25760012
257700         SET PS-EMPTY-FILE-YES TO TRUE                            25770032
257800         SET PS-EOF-RMS-YES    TO TRUE.                           25780032
257900                                                                  25790012
258000******************************************************************25800013
258100 8250-READ-INP25-FILE.                                            25810013
258200     MOVE '8250-READ-INP25-FILE          ' TO PV-PARAGRAPH-NAME.  25820013
258300                                                                  25830013
258400     READ RMS-OUTLOC-FILE INTO HO015-OUTLOC-DATA                  25840013
258500       AT END                                                     25850013
258600         SET PS-EMPTY-FILE-YES TO TRUE                            25860032
258700         SET PS-EOF-RMS-YES    TO TRUE.                           25870032
258800                                                                  25880013
258900******************************************************************25890004
259000******************************************************************25900004
259100 9000-WRITE-OUTPUT-REC.                                           25910003
259200                                                                  25920003
259300     WRITE OUTPUT-FILE-REC FROM XL037-TRANS-REC.                  25930005
259400                                                                  25940033
259500     IF CC-DATA-INTEGRITY                                         25950033
259600         MOVE 4094 TO RETURN-CODE                                 25960034
259700     END-IF.                                                      25970033
259800                                                                  25980003
259900******************************************************************25990003
260000*                 E N D   O F   J O B                            *26000004
260100******************************************************************26010004
260200 9999-TERMINATE.                                                  26020003
260300     MOVE '9999-TERMINATE                ' TO PV-PARAGRAPH-NAME.  26030008
260400                                                                  26040003
260500     CLOSE OUTPUT-FILE.                                           26050003
260600                                                                  26060003
260700     DISPLAY ' '.                                                 26070027
260800     DISPLAY '************************'.                          26080003
260900     DISPLAY '******* XLKUP031 *******'.                          26090003
261000     DISPLAY '************************'.                          26100003
261100     DISPLAY ' '.                                                 26110004
261200     DISPLAY 'TERRITORY INSERTS = ' PA-TERR-ISRT-COUNT.           26120027
261300     DISPLAY 'TERRITORY DELETES = ' PA-TERR-DEL-COUNT.            26130027
261400     DISPLAY 'TERRITORY UPDATES = ' PA-TERR-UPD-COUNT.            26140027
261500     DISPLAY ' '.                                                 26150004
261600     DISPLAY 'REGION INSERTS    = ' PA-REGN-ISRT-COUNT.           26160027
261700     DISPLAY 'REGION DELETES    = ' PA-REGN-DEL-COUNT.            26170027
261800     DISPLAY 'REGION UPDATES    = ' PA-REGN-UPD-COUNT.            26180027
261900     DISPLAY ' '.                                                 26190006
262000     DISPLAY 'DISTRICT INSERTS  = ' PA-DIST-ISRT-COUNT.           26200027
262100     DISPLAY 'DISTRICT DELETES  = ' PA-DIST-DEL-COUNT.            26210027
262200     DISPLAY 'DISTRICT UPDATES  = ' PA-DIST-UPD-COUNT.            26220027
262300     DISPLAY ' '.                                                 26230006
262400     DISPLAY '------------------------'.                          26240008
262500     DISPLAY ' '.                                                 26250008
262600     DISPLAY 'DCLOC ASGMT INSERTS  = ' PA-DCLOC-ISRT-COUNT.       26260027
262700     DISPLAY 'DCLOC ASGMT DELETES  = ' PA-DCLOC-DEL-COUNT.        26270027
262800     DISPLAY 'DCLOC ASGMT UPDATES  = ' PA-DCLOC-UPD-COUNT.        26280027
262900     DISPLAY ' '.                                                 26290006
263000     DISPLAY 'LOCATION TYP INSERTS = ' PA-LOC-TYP-ISRT-COUNT.     26300027
263100     DISPLAY 'LOCATION TYP DELETES = ' PA-LOC-TYP-DEL-COUNT.      26310027
263200     DISPLAY 'LOCATION TYP UPDATES = ' PA-LOC-TYP-UPD-COUNT.      26320027
263300     DISPLAY ' '.                                                 26330006
263400     DISPLAY 'TIME ZONE INSERTS    = ' PA-STDTMZN-ISRT-COUNT.     26340027
263500     DISPLAY 'TIME ZONE DELETES    = ' PA-STDTMZN-DEL-COUNT.      26350027
263600     DISPLAY 'TIME ZONE UPDATES    = ' PA-STDTMZN-UPD-COUNT.      26360027
263700     DISPLAY ' '.                                                 26370006
263800     DISPLAY 'STORE FORMAT INSERTS = ' PA-STR-FMT-ISRT-COUNT      26380027
263900     DISPLAY 'STORE FORMAT DELETES = ' PA-STR-FMT-DEL-COUNT.      26390027
264000     DISPLAY 'STORE FORMAT UPDATES = ' PA-STR-FMT-UPD-COUNT.      26400027
264100     DISPLAY ' '.                                                 26410006
264200     DISPLAY '------------------------'.                          26420008
264300     DISPLAY ' '.                                                 26430008
264400     DISPLAY 'STR MBRSHP INSERTS  = ' PA-STR-MBSHP-ISRT-COUNT     26440027
264500     DISPLAY 'STR MBRSHP DELETES  = ' PA-STR-MBSHP-DEL-COUNT.     26450027
264600     DISPLAY 'STR MBRSHP UPDATES  = ' PA-STR-MBSHP-UPD-COUNT.     26460027
264700     DISPLAY ' '.                                                 26470008
264800     DISPLAY 'STR GRP TYP INSERTS = ' PA-STR-TYP-ISRT-COUNT       26480027
264900     DISPLAY 'STR GRP TYP DELETES = ' PA-STR-TYP-DEL-COUNT.       26490027
265000     DISPLAY 'STR GRP TYP UPDATES = ' PA-STR-TYP-UPD-COUNT.       26500027
265100     DISPLAY ' '.                                                 26510008
265200     DISPLAY 'STORE GROUP INSERTS = ' PA-STR-GRP-ISRT-COUNT       26520027
265300     DISPLAY 'STORE GROUP DELETES = ' PA-STR-GRP-DEL-COUNT.       26530027
265400     DISPLAY 'STORE GROUP UPDATES = ' PA-STR-GRP-UPD-COUNT.       26540027
265500     DISPLAY ' '.                                                 26550008
265600     DISPLAY 'STORE DATE INSERTS  = ' PA-STR-DTE-ISRT-COUNT       26560027
265700     DISPLAY 'STORE DATE DELETES  = ' PA-STR-DTE-DEL-COUNT.       26570027
265800     DISPLAY 'STORE DATE UPDATES  = ' PA-STR-DTE-UPD-COUNT.       26580027
265900     DISPLAY ' '.                                                 26590008
266000     DISPLAY '------------------------'.                          26600008
266100     DISPLAY ' '.                                                 26610008
266200     DISPLAY 'STORE LOC INSERTS   = ' PA-LOCMSTR-ISRT-COUNT       26620027
266300     DISPLAY 'STORE LOC UPDATES   = ' PA-LOCMSTR-UPD-COUNT.       26630027
266400     DISPLAY ' '.                                                 26640010
266500     DISPLAY 'WAREHSE LOC INSERTS = ' PA-LOC-WHS-ISRT-COUNT       26650027
266600     DISPLAY 'WAREHSE LOC UPDATES = ' PA-LOC-WHS-UPD-COUNT.       26660027
266700     DISPLAY ' '.                                                 26670010
266800     DISPLAY 'OUTSIDE LOC INSERTS = ' PA-OUTLOC-ISRT-COUNT        26680027
266900     DISPLAY 'OUTSIDE LOC UPDATES = ' PA-OUTLOC-UPD-COUNT.        26690027
267000     DISPLAY ' '.                                                 26700015
267100     DISPLAY 'LOCATION DELETES    = ' PA-LOCMSTR-DEL-COUNT.       26710027
267200     DISPLAY ' '.                                                 26720010
267300     DISPLAY '************************'.                          26730003
267400                                                                  26740003
267500******************************************************************26750003
267600******************************************************************26760003
