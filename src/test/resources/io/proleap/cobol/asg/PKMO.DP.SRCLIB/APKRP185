000100 IDENTIFICATION DIVISION.                                         00010010
000200 PROGRAM-ID.     APKRP185.                                        00020010
000300 AUTHOR.         JILL JUEL                                        00030010
000400 DATE-WRITTEN.   08/26/1999.                                      00040010
000500 DATE-COMPILED.                                                   00050010
000600*************************************************************     00060010
000700*    COBOL II WITH SQL                                      *     00070010
000800*************************************************************     00080010
000900*        DAILY TOTAL OF JOURNALIZED RECEIPTS REPORT         *     00090010
001000*************************************************************     00100010
001100*                                                           *     00110010
001200*    THIS PROGRAM WILL CALCULATE THE TOTAL COST AND         *     00120010
001300*    RETAIL OF THE JOURNALIZED RECEIPTS AND PRINT THESE     *     00130010
001400*    TOTALS ON A REPORT.                                    *     00140010
001500*                                                           *     00150010
001600* DB2                                                       *     00160010
001700*  1. TAPCNTL                                               *     00170010
001800*                                                           *     00180010
001900* INPUT:                                                    *     00190010
002000*  1. JOURNALIZED RECEIPT TRANSACTIONS           APRD105    *     00200014
002300*                                                           *     00230010
002400* OUTPUT:                                                   *     00240010
002500*  1. REPORT                                                *     00250010
002600*                                                           *     00260010
002700* MODIFICATIONS:                                            *     00270010
002800*  10/11/1999 REMOVED COPYBOOK DPWS500 - NOT USED.          *     00280010
002900*         BY: L SCHALLHORN                       WR 06041   *     00290010
003000*                                                           *     00300010
003100*  01/26/2001 INCREASED THE SIZE OF THE REPORT DISPLAY FOR  *     00310010
003200*             THE RETAIL AND GROSS DOLLAR AMOUNTS TO CORRECT*     00320010
003300*             TRUNCATION OF THE FIRST DIGIT.                *     00330010
003400*         BY: MIKE BESKE                         WR 20704   *     00340010
003500*                                                           *     00350010
003600*  07/20/2001 INCREASED THE LRECL OF INPUT FILE, AND ALSO   *     00360010
003700*             CHANGED THE NAME OF IT TO JRNLD-RECEIPTS TO   *     00370010
003800*             ADD CLARITY TO THE PROGRAM.  THE LRECL WAS    *     00380010
003900*             CHANGED BECAUSE COPYBOOK APRD045 WAS          *     00390010
004000*             INCREASED TO 500.                             *     00400010
004100*         BY: ALEXIS KEIKER                      WR 22467   *     00410010
004200*                                                           *     00420010
004300*  05/16/2002                                               *     00430010
004400*    CHANGE MADE:  NI-SKU CHANGES.  RECOMPILE FROM PRODUCTION     00440010
004500*    TO INCORPORATE CHANGES TO COPYBOOK APRD045.            *     00450010
004600*  MADE BY:  KEVIN CATLIN                   WR/IR #: 21278  *     00460010
004700*                                                           *     00470010
004800*   DATE  09/17/2003                                        *     00480011
004900*       CHANGE MADE: RECOMPILE FROM PRODUCTION TO PICK UP   *     00490011
005000*       CHANGE TO COPYBOOK APRD045.                         *     00500011
005100*       MADE BY: MIKE BESKE              WR/IR #: WR21316   *     00510011
005110*                                                           *     00511014
005120*   DATE  02/17/2005                                        *     00512014
005130*       CHANGE MADE: CHANGED PROGRAM TO USE APRD105 AS      *     00513014
005140*       INPUT INSTEAD OF APRD045.  THIS CHANGE WILL REDUCE  *     00514014
005141*       ROUNDING DISCREPANCIES IN DAILY BALANCING BECAUSE   *     00514114
005142*       THE APRD105 COST FIELD EXTENDS TO 3 DIGITS AFTER    *     00514214
005143*       THE DECIMAL POINT.                                  *     00514314
005150*       MADE BY: NANCY EILBES            WR/IR #: WR28327   *     00515014
005200*                                                           *     00520011
005300*************************************************************     00530010
005400   EJECT                                                          00540010
005500 ENVIRONMENT DIVISION.                                            00550010
005600                                                                  00560010
005700 CONFIGURATION SECTION.                                           00570010
005800 SOURCE-COMPUTER.    IBM-3090.                                    00580010
005900 OBJECT-COMPUTER.    IBM-3090.                                    00590010
006000                                                                  00600010
006100 INPUT-OUTPUT SECTION.                                            00610010
006200                                                                  00620010
006300 FILE-CONTROL.                                                    00630010
006400     SELECT JRNLD-RECEIPTS-FILE     ASSIGN TO INP01.              00640010
006500     SELECT REPORT-FILE             ASSIGN TO RPT01.              00650010
006600                                                                  00660010
006700 EJECT                                                            00670010
006800 DATA DIVISION.                                                   00680010
006900 FILE SECTION.                                                    00690010
007000                                                                  00700010
007100                                                                  00710010
007200 FD  JRNLD-RECEIPTS-FILE                                          00720010
007300     RECORDING MODE IS F                                          00730010
007400     LABEL RECORDS ARE STANDARD                                   00740010
007500     BLOCK CONTAINS 0 RECORDS                                     00750010
007600     DATA RECORD IS JRNLD-RECEIPTS-REC.                           00760010
007700 01  JRNLD-RECEIPTS-REC.                                          00770010
007800     05  FILLER                           PIC  X(200).            00780013
007900                                                                  00790010
008000 FD  REPORT-FILE                                                  00800010
008100     RECORDING MODE IS F                                          00810010
008200     LABEL RECORDS ARE STANDARD                                   00820010
008300     BLOCK CONTAINS 0 RECORDS                                     00830010
008400     DATA RECORD IS REPORT-REC.                                   00840010
008500 01  REPORT-REC.                                                  00850010
008600     05  FILLER                           PIC  X(132).            00860010
008700                                                                  00870010
008800 EJECT                                                            00880010
008900 WORKING-STORAGE SECTION.                                         00890010
009000                                                                  00900010
009100 01  PC-PROGRAM-CONSTANTS.                                        00910010
009200     05  PC-PROGRAM-NAME         PIC  X(08)  VALUE 'APKRP185'.    00920010
009300                                                                  00930010
009400 01  PS-PROGRAM-SWITCHES.                                         00940010
009500     05  PS-JRNLD-RECEIPTS-EOF-SW PIC X(01) VALUE 'N'.            00950010
009600         88  JRNLD-RECEIPTS-EOF             VALUE 'Y'.            00960010
009700                                                                  00970010
009800 01  DATE-WORKAREA.                                               00980010
009900     05  DB2-DATE                PIC  X(10)  VALUE SPACES.        00990010
010000     05  FILLER REDEFINES DB2-DATE.                               01000010
010100         10  DB2-DATE-YEAR       PIC  X(04).                      01010010
010200         10  FILLER              PIC  X(01).                      01020010
010300         10  DB2-DATE-MONTH      PIC  X(02).                      01030010
010400         10  FILLER              PIC  X(01).                      01040010
010500         10  DB2-DATE-DAY        PIC  X(02).                      01050010
010600     05  PV-CURRENT-DATE             PIC X(08).                   01060010
010700     05  FILLER REDEFINES PV-CURRENT-DATE.                        01070010
010800         10 PV-CURRENT-DATE-YEAR     PIC X(04).                   01080010
010900         10 PV-CURRENT-DATE-MM       PIC X(02).                   01090010
011000         10 PV-CURRENT-DATE-DD       PIC X(02).                   01100010
011100     05  PV-CURRENT-TIME             PIC X(06).                   01110010
011200     05  FILLER REDEFINES PV-CURRENT-TIME.                        01120010
011300         10 PV-CURRENT-TIME-HH       PIC X(02).                   01130010
011400         10 PV-CURRENT-TIME-MM       PIC X(02).                   01140010
011500         10 PV-CURRENT-TIME-SS       PIC X(02).                   01150010
011600     05  DISPLAY-CURRENT-DATE.                                    01160010
011700         10 DISPLAY-DATE-MM          PIC X(02).                   01170010
011800         10 FILLER                   PIC X(01)   VALUE '-'.       01180010
011900         10 DISPLAY-DATE-DD          PIC X(02).                   01190010
012000         10 FILLER                   PIC X(01)   VALUE '-'.       01200010
012100         10 DISPLAY-DATE-YEAR        PIC X(04).                   01210010
012200     05  DISPLAY-CURRENT-TIME.                                    01220010
012300         10 DISPLAY-TIME-HH          PIC X(02).                   01230010
012400         10 FILLER                   PIC X(01)   VALUE ':'.       01240010
012500         10 DISPLAY-TIME-MM          PIC X(02).                   01250010
012600         10 FILLER                   PIC X(01)   VALUE ':'.       01260010
012700         10 DISPLAY-TIME-SS          PIC X(02).                   01270010
012800                                                                  01280010
012900 01  PV-ACCUMULATORS.                                             01290010
013000     05  ACCUM-GROSS-COST        PIC S9(15)V999 VALUE ZERO.       01300013
013100     05  ACCUM-RETAIL-AMT        PIC S9(15)V99 VALUE ZERO.        01310010
013200                                                                  01320010
013300 01  PC-PROGRAM-COUNTERS.                                         01330010
013400     05  PC-TRAN-IN              PIC S9(5)     VALUE ZERO         01340010
013500                                               COMP-3.            01350010
013600                                                                  01360010
013700 EJECT                                                            01370010
013800                                                                  01380010
013900*----------------------------------------------------------------*01390010
014000*  RECORD LAYOUT FOR RECEIPTS EXTRACT FILE                       *01400013
014100*----------------------------------------------------------------*01410010
014200     COPY APRD105.                                                01420013
014300 EJECT                                                            01430010
014400                                                                  01440010
014500*----------------------------------------------------------------*01450010
014600*  STANDARD REPORT HEADER LAYOUT                                 *01460010
014700*----------------------------------------------------------------*01470010
014800     COPY DPWS132O.                                               01480010
015000                                                                  01500010
015100 EJECT                                                            01510010
015200                                                                  01520010
015300 01  REPORT-HEADER1.                                              01530010
015400     05  FILLER                  PIC  X(58) VALUE SPACES.         01540010
015500     05  FILLER                  PIC  X(16) VALUE                 01550010
015600             'ACCOUNTS PAYABLE'.                                  01560010
015700     05  FILLER                  PIC  X(58) VALUE SPACES.         01570010
015800                                                                  01580010
015900 01  REPORT-HEADER2.                                              01590010
016000     05  FILLER                  PIC  X(51) VALUE SPACES.         01600010
016100     05  FILLER                  PIC  X(30) VALUE                 01610010
016200             'TOTAL OF RECEIPTS JOURNALIZED '.                    01620010
016300     05  FILLER                  PIC  X(51) VALUE SPACES.         01630010
016400                                                                  01640010
016500 01  REPORT-HEADER3.                                              01650010
016600     05  FILLER                  PIC  X(59) VALUE SPACES.         01660010
016700     05  FILLER                  PIC  X(03) VALUE 'FOR'.          01670010
016800     05  FILLER                  PIC  X(01) VALUE SPACES.         01680010
016900     05  REPORT-MONTH            PIC  X(02) VALUE SPACES.         01690010
017000     05  FILLER                  PIC  X(01) VALUE '/'.            01700010
017100     05  REPORT-DAY              PIC  X(02) VALUE SPACES.         01710010
017200     05  FILLER                  PIC  X(01) VALUE '/'.            01720010
017300     05  REPORT-YEAR             PIC  X(04) VALUE SPACES.         01730010
017400     05  FILLER                  PIC  X(59) VALUE SPACES.         01740010
017500                                                                  01750010
017600 01  REPORT-COLUMN-HDR1.                                          01760010
017700     05  FILLER                  PIC   X(51) VALUE SPACES.        01770010
017800     05  FILLER                  PIC   X(10) VALUE 'GROSS COST'.  01780010
017900     05  FILLER                  PIC   X(10) VALUE SPACES.        01790010
018000     05  FILLER                  PIC   X(10) VALUE 'RETAIL AMT'.  01800010
018100     05  FILLER                  PIC   X(51) VALUE SPACES.        01810010
018200                                                                  01820010
018300 01  REPORT-DETAIL-LINE.                                          01830010
018400     05  FILLER                  PIC   X(47)   VALUE SPACES.      01840010
018500     05  DL-GRO-COST-AMT         PIC   -,---,---,--9.99.          01850010
018600     05  FILLER                  PIC   X(06)   VALUE SPACES.      01860010
018700     05  DL-RETL-AMT             PIC   -,---,---,--9.99.          01870010
018800     05  FILLER                  PIC   X(47)   VALUE SPACES.      01880010
018900                                                                  01890010
019000 01  REPORT-END-OF-REPORT-LINE.                                   01900010
019100     05  FILLER                  PIC   X(52)   VALUE ALL '*'.     01910010
019200     05  FILLER                  PIC   X(28)   VALUE              01920010
019300             '   END OF REPORT APKRP185   '.                      01930010
019400     05  FILLER                  PIC   X(52)   VALUE ALL '*'.     01940010
019500                                                                  01950010
019600 EJECT                                                            01960010
019700                                                                  01970010
019800*--------------------------------------------------------------*  01980010
019900*     TAPCNTL DCLGEN                                           *  01990010
020000*--------------------------------------------------------------*  02000010
020100     EXEC SQL                                                     02010010
020200         INCLUDE TAPCNTL                                          02020010
020300     END-EXEC.                                                    02030010
020400 EJECT                                                            02040010
020500                                                                  02050010
020600*--------------------------------------------------------------*  02060010
020700*  COMMUNICATIONS AREA2 FOR DB2                                *  02070010
020800*--------------------------------------------------------------*  02080010
020900     COPY SQLCA2.                                                 02090010
021000                                                                  02100010
021100*--------------------------------------------------------------*  02110010
021200*     SQL COMMUNICATIONS AREA DCLGEN                           *  02120010
021300*--------------------------------------------------------------*  02130010
021400     EXEC SQL                                                     02140010
021500         INCLUDE SQLCA                                            02150010
021600     END-EXEC.                                                    02160010
021700 EJECT                                                            02170010
021800                                                                  02180010
021900*----------------------------------------------------------------*02190010
022000*  ABEND DATA AREAS                                              *02200010
022100*----------------------------------------------------------------*02210010
022200                                                                  02220010
022300** WORKING STORAGE FOR ABEND PROCESSING                           02230010
022400 01  ABEND-CODE                PIC S9(04)  VALUE ZERO COMP SYNC.  02240010
022500     88  AC-BAD-DATA                       VALUE +4003.           02250010
022600     88  AC-DB2-ERROR                      VALUE +4013.           02260010
022700     88  AC-UNSUCCESSFUL-SELECT            VALUE +4015.           02270010
022800     88  AC-DATE-ERROR                     VALUE +4019.           02280010
022900                                                                  02290010
023000 01  ABEND-AREAS.                                                 02300010
023100     05  AA-ABEND-LIT          PIC  X(40)  VALUE                  02310010
023200             '*****       ABEND'.                                 02320010
023300     05  AA-PROGRAM-LIT        PIC  X(40)  VALUE                  02330010
023400             '*****   PROGRAM: APKRP185'.                         02340010
023500     05  AA-PARAGRAPH-LIT.                                        02350010
023600         10  FILLER            PIC  X(17)  VALUE                  02360010
023700             '***** PARAGRAPH: '.                                 02370010
023800         10  AA-PARAGRAPH-NAME PIC  X(35)  VALUE SPACES.          02380010
023900     05  AA-MESSAGE-LINE.                                         02390010
024000         10  FILLER            PIC  X(06)  VALUE '*****'.         02400010
024100         10  AA-MESSAGE        PIC  X(127) VALUE SPACES.          02410010
024200         10  FILLER REDEFINES AA-MESSAGE.                         02420010
024300             15 AA-MESSAGE-1   PIC  X(45).                        02430010
024400             15 AA-MESSAGE-2   PIC  X(45).                        02440010
024500             15 AA-MESSAGE-3   PIC  X(37).                        02450010
024600     05  AA-DB2-ERROR-LIT      PIC  X(40)  VALUE                  02460010
024700             '*****    DB2 ERROR'.                                02470010
024800     05  AA-DB2-OPERATION-LIT.                                    02480010
024900         10  FILLER            PIC  X(17)  VALUE                  02490010
025000             '***** OPERATION: '.                                 02500010
025100         10  AA-DB2-OPERATION.                                    02510010
025200             15  AA-DB2-OP-1   PIC  X(25)  VALUE SPACES.          02520010
025300             15  AA-DB2-OP-2   PIC  X(25)  VALUE SPACES.          02530010
025400     05  AA-DB2-TABLE-1        PIC  X(08)  VALUE SPACES.          02540010
025500     05  AA-DB2-TABLE-2        PIC  X(08)  VALUE SPACES.          02550010
025600     05  AA-DB2-TABLE-3        PIC  X(08)  VALUE SPACES.          02560010
025700 EJECT                                                            02570010
025800                                                                  02580010
025900     COPY DPWS004.                                                02590010
026000 EJECT                                                            02600010
026200 PROCEDURE DIVISION.                                              02620010
026400 A100-MAINLINE.                                                   02640010
026500                                                                  02650010
026600     PERFORM B100-INITIALIZATION.                                 02660010
026700                                                                  02670010
026800     PERFORM B200-PROCESS-TRANSACTIONS.                           02680010
026900                                                                  02690010
027000     PERFORM B300-END-PROGRAM.                                    02700010
027100                                                                  02710010
027200     GOBACK.                                                      02720010
027300 EJECT                                                            02730010
027400******************************************************************02740010
027500*    INITIALIZATION PROCESSING                                   *02750010
027600******************************************************************02760010
027700 B100-INITIALIZATION.                                             02770010
027800     DISPLAY ' '.                                                 02780010
027900     DISPLAY '*****************  APKRP185  *******************'.  02790010
028000                                                                  02800010
028100     MOVE FUNCTION CURRENT-DATE (1:8)  TO PV-CURRENT-DATE.        02810010
028200     MOVE FUNCTION CURRENT-DATE (9:6)  TO PV-CURRENT-TIME.        02820010
028300     MOVE PV-CURRENT-DATE-YEAR  TO DISPLAY-DATE-YEAR.             02830010
028400     MOVE PV-CURRENT-DATE-MM    TO DISPLAY-DATE-MM.               02840010
028500     MOVE PV-CURRENT-DATE-DD    TO DISPLAY-DATE-DD.               02850010
028600     MOVE PV-CURRENT-TIME-HH    TO DISPLAY-TIME-HH.               02860010
028700     MOVE PV-CURRENT-TIME-MM    TO DISPLAY-TIME-MM.               02870010
028800     MOVE PV-CURRENT-TIME-SS    TO DISPLAY-TIME-SS.               02880010
028900                                                                  02890010
029000     DISPLAY 'RUN-DATE = ' DISPLAY-CURRENT-DATE                   02900010
029100          '   RUN-TIME = ' DISPLAY-CURRENT-TIME.                  02910010
029200                                                                  02920010
029300     OPEN INPUT  JRNLD-RECEIPTS-FILE                              02930010
029400          OUTPUT REPORT-FILE.                                     02940010
029500                                                                  02950010
029600     INITIALIZE PV-ACCUMULATORS.                                  02960010
029700                                                                  02970010
029800     MOVE FUNCTION CURRENT-DATE(1:4)  TO DP132O-RUN-YEAR.         02980010
029900     MOVE FUNCTION CURRENT-DATE(5:2)  TO DP132O-RUN-MONTH.        02990010
030000     MOVE FUNCTION CURRENT-DATE(7:2)  TO DP132O-RUN-DAY.          03000010
030100                                                                  03010010
030200     MOVE FUNCTION CURRENT-DATE(9:2)  TO DP132O-RUN-HOUR.         03020010
030300     MOVE FUNCTION CURRENT-DATE(11:2) TO DP132O-RUN-MINUTE.       03030010
030400     MOVE PC-PROGRAM-NAME             TO DP132O-PROGRAM-NAME.     03040010
030500     MOVE 1                           TO DP132O-REPORT-NUMBER.    03050010
030600                                                                  03060010
030700     PERFORM S100-SELECT-BATCH-PROCESS-DATE.                      03070010
030800     MOVE APCNTL-BTCH-PRC-DTE         TO DB2-DATE.                03080010
030900     MOVE DB2-DATE-MONTH              TO REPORT-MONTH.            03090010
031000     MOVE DB2-DATE-DAY                TO REPORT-DAY.              03100010
031100     MOVE DB2-DATE-YEAR               TO REPORT-YEAR.             03110010
031200                                                                  03120010
031300     PERFORM R100-READ-JRNLD-RECEIPTS-FILE.                       03130010
031400                                                                  03140010
031500     PERFORM W100-WRITE-HEADERS.                                  03150010
031600                                                                  03160010
031700 EJECT                                                            03170010
031800                                                                  03180010
031900******************************************************************03190010
032000*  ACCUMULATES THE GROSS COST AND RETAIL AMOUNT FOR EACH         *03200010
032100*  RECORD ON THE TRANSACTION FILE AND WRITES THE TOTAL.          *03210010
032200******************************************************************03220010
032300 B200-PROCESS-TRANSACTIONS.                                       03230010
032400                                                                  03240010
032500     PERFORM UNTIL JRNLD-RECEIPTS-EOF                             03250010
032600         ADD AP105-TOTAL-COST   TO ACCUM-GROSS-COST               03260013
032610         IF AP105-PI-GP-QTY > +1                                  03261013
032620         AND AP105-PI-GP-RTL-AMT > ZERO                           03262013
032630             COMPUTE ACCUM-RETAIL-AMT = ACCUM-RETAIL-AMT +        03263013
032640                (AP105-NR-NON-INVC-UNT-QTY *                      03264013
032650                (AP105-PI-GP-RTL-AMT / AP105-PI-GP-QTY))          03265013
032660         ELSE                                                     03266013
032670             COMPUTE ACCUM-RETAIL-AMT = ACCUM-RETAIL-AMT +        03267013
032680             (AP105-NR-NON-INVC-UNT-QTY * AP105-PI-UNT-RTL-PR-AMT)03268013
032690         END-IF                                                   03269013
032800         PERFORM R100-READ-JRNLD-RECEIPTS-FILE                    03280010
032900     END-PERFORM.                                                 03290010
033000                                                                  03300010
033100     COMPUTE ACCUM-GROSS-COST = ACCUM-GROSS-COST + .005.          03310013
033101                                                                  03310113
033110     MOVE ACCUM-GROSS-COST TO DL-GRO-COST-AMT                     03311013
033200     MOVE ACCUM-RETAIL-AMT TO DL-RETL-AMT                         03320010
033300     WRITE REPORT-REC FROM REPORT-DETAIL-LINE AFTER 2.            03330010
033400 EJECT                                                            03340010
033500                                                                  03350010
033600******************************************************************03360010
033700*    ENDING PROCESSING                                           *03370010
033800******************************************************************03380010
033900 B300-END-PROGRAM.                                                03390010
034000                                                                  03400010
034100     WRITE REPORT-REC FROM REPORT-END-OF-REPORT-LINE AFTER 3.     03410010
034200                                                                  03420010
034300     DISPLAY '**********************************************'     03430010
034400     DISPLAY 'PROGRAM NAME = APKRP185'                            03440010
034500     DISPLAY 'TRAN RECORDS IN = ' PC-TRAN-IN.                     03450010
034600     DISPLAY '**********************************************'     03460010
034700                                                                  03470010
034800     CLOSE JRNLD-RECEIPTS-FILE                                    03480010
034900           REPORT-FILE.                                           03490010
035000 EJECT                                                            03500010
035100                                                                  03510010
035200******************************************************************03520010
035300*  READ JOURNALIZED RECEIPTS FILE (APRD045) *                     03530010
035400******************************************************************03540010
035500 R100-READ-JRNLD-RECEIPTS-FILE.                                   03550010
035600                                                                  03560010
035700     READ JRNLD-RECEIPTS-FILE INTO AP105-RECORD                   03570013
035800        AT END                                                    03580010
035900            SET JRNLD-RECEIPTS-EOF TO TRUE                        03590010
036000        NOT AT END                                                03600010
036100            ADD 1 TO PC-TRAN-IN                                   03610010
036200     END-READ.                                                    03620010
036300                                                                  03630010
036400 EJECT                                                            03640010
036500******************************************************************03650010
036600*  SELECT BATCH PROCESS DATE FROM TAPCNTL TABLE                  *03660010
036700******************************************************************03670010
036800 S100-SELECT-BATCH-PROCESS-DATE.                                  03680010
036900     EXEC SQL                                                     03690010
037000         SELECT  BTCH_PRC_DTE                                     03700010
037100           INTO :APCNTL-BTCH-PRC-DTE                              03710010
037200           FROM TAPCNTL                                           03720010
037300     END-EXEC.                                                    03730010
037400                                                                  03740010
037500     EVALUATE TRUE                                                03750010
037600         WHEN SQLCODE = ZERO                                      03760010
037700              CONTINUE                                            03770010
037800         WHEN OTHER                                               03780010
037900             SET AC-UNSUCCESSFUL-SELECT TO TRUE                   03790010
038000             MOVE 'S100-SELECT-BATCH-PROCESS-DATE'                03800010
038100                                        TO AA-PARAGRAPH-NAME      03810010
038200             MOVE 'UNSUCCESSFUL SELECT' TO AA-DB2-OPERATION       03820010
038300             MOVE 'TAPCNTL'             TO AA-DB2-TABLE-1         03830010
038400             MOVE SPACES                TO AA-DB2-TABLE-2         03840010
038500             MOVE SPACES                TO AA-DB2-TABLE-3         03850010
038600             PERFORM Z998-DB2-ABEND                               03860010
038700     END-EVALUATE.                                                03870010
038800 EJECT                                                            03880010
038900                                                                  03890010
039000******************************************************************03900010
039100*  WRITES THE HEADINGS LINE OF THE DAILY TOTAL OF JOURNALIZED    *03910010
039200*  RECEIPTS REPORT.                                              *03920010
039300******************************************************************03930010
039400 W100-WRITE-HEADERS.                                              03940010
039500     MOVE 1 TO DP132O-PAGE-NUMBER.                                03950010
039600     WRITE REPORT-REC FROM DP132O-STANDRD-HEADER-132-COLS         03960010
039700           AFTER PAGE.                                            03970010
039800                                                                  03980010
039900     WRITE REPORT-REC FROM REPORT-HEADER1     AFTER 1.            03990010
040000     WRITE REPORT-REC FROM REPORT-HEADER2     AFTER 1.            04000010
040100     WRITE REPORT-REC FROM REPORT-HEADER3     AFTER 1.            04010010
040200     WRITE REPORT-REC FROM REPORT-COLUMN-HDR1 AFTER 2.            04020010
040300                                                                  04030010
040400 EJECT                                                            04040010
040500******************************************************************04050010
040600*     DB2 ABEND ROUTINE                                           04060010
040700******************************************************************04070010
040800 Z998-DB2-ABEND.                                                  04080010
040900     DISPLAY '**** APKRP185 ABENDING ****'                        04090010
041000                                                                  04100010
041100     CLOSE JRNLD-RECEIPTS-FILE                                    04110010
041200           REPORT-FILE.                                           04120010
041300                                                                  04130010
041400     DISPLAY AA-ABEND-LIT.                                        04140010
041500     DISPLAY AA-DB2-ERROR-LIT.                                    04150010
041600     DISPLAY AA-PROGRAM-LIT.                                      04160010
041700     DISPLAY AA-PARAGRAPH-LIT.                                    04170010
041800     DISPLAY AA-DB2-OPERATION-LIT.                                04180010
041900     DISPLAY AA-DB2-TABLE-1.                                      04190010
042000     DISPLAY AA-DB2-TABLE-2.                                      04200010
042100     DISPLAY AA-DB2-TABLE-3.                                      04210010
042200     SET AC-DB2-ERROR TO TRUE.                                    04220010
042300                                                                  04230010
042400     COPY DPPD004.                                                04240010
042500                                                                  04250010
042600     CALL 'ILBOABN0' USING ABEND-CODE.                            04260010
042700 EJECT                                                            04270010
