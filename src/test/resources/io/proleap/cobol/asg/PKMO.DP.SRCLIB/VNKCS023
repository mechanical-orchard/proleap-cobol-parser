000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    VNKCS023.                                         00020000
000300 AUTHOR.        MIKE BESKE.                                       00030000
000400 DATE-WRITTEN.  FEBRUARY 2001.                                    00040000
000500***************************************************************** 00050000
000600*    COBOL II WITH DB2                                          * 00060000
000700***************************************************************** 00070000
000800*  RMS SUPPLIER INTERFACE DATA COLLECTION PROGRAM.              * 00080000
000900*                                                               * 00090000
001000*  THE PURPOSE OF THIS PROGRAM IS TO DETERMINE IF ALL OF THE    * 00100000
001100*  BUSINESS RULES HAVE BEEN MET TO CREATE A MESSAGE TO SEND AN  * 00110000
001200*  ADD OR UPDATE MESSAGE TO RMS SUPPLIER, AND IF SO, TO GATHER  * 00120000
001300*  ALL OF THE VENDOR DATA THAT WILL BE NEEDED TO FORMAT THE     * 00130000
001400*  APPROPRIATE MESSAGE.                                         * 00140000
001500***************************************************************** 00150000
001600* INPUT:                                                        * 00160000
001700*  1. PARAMATER LIST FROM CALLING PROGRAM (COPYBOOK VNWS013)    * 00170000
001800*                                                               * 00180000
001900* OUTPUT:                                                       * 00190000
002000*  1. PARAMATER LIST TO CALLED PROGRAM    (COPYBOOK VNWS007)    * 00200000
002100*                                                               * 00210000
002200* DB2 TABLES:                                                   * 00220000
002300*  1. EXTERNAL ENTERPRISE VENDOR BUSINESS LOCATION   (TBUSLOC)  * 00230000
002400*  2. EXTERNAL ENTERPRISE VENDOR REPRESENTATIVE      (TENTREP)  * 00240000
002500*  3. VENDOR DEPARTMENT TABLE                        (TVNDDPT)  * 00250000
002600*  4. VENDOR AGREEMENT TABLE                         (TVNDAGR)  * 00260000
002700***************************************************************** 00270000
002800* CHANGES MADE:                                                 * 00280000
002900* 08/08/2001 MIKE BESKE                      WR/IR #: 20704     * 00290000
003000*       ADDED AN ADDITIONAL WHERE CONDITION TO TWO CURSORS:     * 00300000
003100*       TERM_ACT_DEPTS_CSR & PROG_ACT_DEPTS_CSR.  THE WHERE     * 00310000
003200*       CONDITION CHECKS THAT EXPENSE DEPTS ARE NOT CONSIDERED. * 00320000
003300*                                                               * 00330000
003400* DATE  05/27/2003                                              * 00340000
003500*     CHANGE MADE: VENDOR MULTI PRE-PACK USAGE PROJECT.  REMOVE * 00350000
003600*     ALL INSTANCES OF TEXTENT AND TENTNME -- THEY AREN'T USED  * 00360000
003700*     IN THIS PROGRAM.  INCLUDE MOVE OF VN013-ENT-ID TO VN007-  * 00370000
003800*     ENT-ID AND MOVE OF VN013-PO-PREPK-CDE TO VN007-PO-PREPK-  * 00380000
003900*     CDE IN PARAGRAPH B100.                                    * 00390000
004000*     MADE BY: KEVIN CATLIN            WR/IR #: WR24663         * 00400000
004100*                                                               * 00410000
004200* DATE  11/05/2003                                              * 00420000
004300*     CHANGE MADE: ADDED CODE TO MOVE THE 4 NEW FIELDS ADDED    * 00430000
004400*     TO THE VNWS013 RMS PO MESSAGING COPYBOOK TO THEIR         * 00440000
004500*     CORRESPONDING FIELDS ON VNWS007.                          * 00450000
004600*     MADE BY: MIKE BESKE              WR/IR #: WR25358         * 00460000
004700*                                                               * 00470000
004800* DATE  02/04/2005                                              * 00480000
004900*     CHANGE MADE: ADDED LOGIC TO PROCESS NEW MESSAGES FOR      * 00490000
005000*     VENDOR CAPABILITIES AND RELATIONSHIPS.                    * 00500000
005100*     MADE BY: JACK KRAMER             WR/IR #: WR25278         * 00510000
005200*                                                               * 00520000
005300* DATE  07/14/2005                                              * 00530000
005400*     CHANGE MADE: OFF-INVOICE CO-OP ADVERTISING ALLOWANCES.    * 00540000
005500*     ADDED THE FIELD VN013-COOP-DISC-PCT TO COPYBOOK VNWS013   * 00550000
005600*     ALONG WITH THE 88 LEVEL VN013-FUNCTION-VENDOR-ALLW.  ALSO * 00560000
005700*     ADDED THE FIELD VN007-COOP-DISC-PCT TO THE COPYBOOK       * 00570000
005800*     VNWS007.  INCLUDED THE FOLLOWING CONDITIONS IN THE WHERE  * 00580000
005900*     CLAUSE FOR CURSORS PROG_ACT_DEPTS_CSR AND                 * 00590000
006000*     PROG_SPEC_DEPT_CSR:                                       * 00600000
006100*         AGRMT_TYP_ID = '6' AND                                * 00610000
006200*         TYP_CDE = 6        AND                                * 00620000
006300*         AP_TRN_CDE = '90'  AND                                * 00630000
006400*         PSTG_FRQ_CDE = 'IV'.                                  * 00640000
006500*     ADDED LOGIC TO PARAGRAPHS N110- AND N120- TO MOVE THE     * 00650000
006600*     VNDAGR-DISC-PCT FIELD TO THE VN007-COOP-DISC-PCT OUTPUT   * 00660000
006700*     FIELD WHEN THE AGRMT-TYP-ID = '6' AND THE TYP-CDE = 6.    * 00670000
006800*     CREATED PARAGRAPH C900- TO PROCESS MESSAGES FOR NEW       * 00680000
006900*     VENDOR ALLOWANCES.                                        * 00690000
007000*     MADE BY: KRYSTEN LEARY           WR/IR #: WR28651         * 00700000
007100*                                                               * 00710000
007200* DATE  07/28/2005                                              * 00720000
007300*     CHANGE MADE: OFF-INVOICE CO-OP ADVERTISING ALLOWANCES.    * 00730000
007400*     RECOMPILE FROM PRODUCTION.                                * 00740000
007500*     MADE BY: KRYSTEN LEARY           WR/IR #: WR28651         * 00750000
007600*                                                               * 00760000
007700* DATE  07/28/2005                                              * 00770000
007800*     CHANGE MADE: OFF-INVOICE CO-OP ADVERTISING ALLOWANCES.    * 00780000
007900*     ADDED LOGIC TO PARAGRAPH C400- TO MOVE THE CO-OP DISCOUNT * 00790000
008000*     PERCENT TO THE OUTPUT MESSAGE.  THIS INCLUDED ADDING      * 00800000
008100*     PARAGRAPH N130- TO THE PROGRAM.                           * 00810000
008200*     MADE BY: KRYSTEN LEARY           WR/IR #: WR28651         * 00820000
008300*                                                               * 00830000
008400* DATE  03/21/2006                                              * 00840000
008500*     CHANGE MADE: ADDED CODE TO PROCESS THE NEW INCENTIVES     * 00850000
008600*     CREATED FOR VENDOR ALLOWANCE AUTOMATION: CO-OP OFF INVOICE* 00860000
008700*     PROFITASST/ADCOOP ALLOWANCE AND TABLE/TOWER DATING.  THESE* 00870000
008800*     INCENTIVES ARE TRACKED ON THE TVNDAGR TABLE.  CO-OP OFF   * 00880000
008900*     INVOICE PREVIOUSLY WAS TREATED AS A PROGRAM, BUT NOW IS   * 00890000
009000*     CHANGED TO BE AN INCENTIVE.  THE PREVIOUS CODE THAT DEALT * 00900000
009100*     WITH CO-OP OFF INVOICE HAS BEEN CHANGED/REMOVED BECAUSE OF* 00910000
009200*     THIS.                                                     * 00920000
009300*     MADE BY: MIKE BESKE              WR/IR #: WR30028         * 00930000
009400*                                                               * 00940000
009500* DATE  04/05/2006                                              * 00950000
009600*     CHANGE MADE: ADDED CODE TO PROCESS THE NEW INCENTIVES     * 00960000
009700*     CREATED FOR VENDOR ALLOWANCE AUTOMATION: BRIDAL ALLOWANCE * 00970000
009800*     PERCENTAGE. THIS INCENTIVE IS TRACKED ON THE TVNDAGR TABLE* 00980000
009900*     MADE BY: MIKE BESKE              WR/IR #: WR30028         * 00990000
010000***************************************************************** 01000000
010100 ENVIRONMENT DIVISION.                                            01010000
010200                                                                  01020000
010300 DATA DIVISION.                                                   01030000
010400                                                                  01040000
010500*************************                                         01050000
010600 WORKING-STORAGE SECTION.                                         01060000
010700*************************                                         01070000
010800                                                                  01080000
010900 01  MIN-MAX-VALUES.                                              01090000
011000     05  LOW-SEQ-NBR             PIC S9(09) COMP VALUE ZERO.      01100000
011100     05  HIGH-SEQ-NBR            PIC S9(09) COMP VALUE 999999999. 01110000
011200     05  LOW-STR-NBR             PIC S9(04) COMP VALUE ZERO.      01120000
011300     05  HIGH-STR-NBR            PIC S9(04) COMP VALUE 9999.      01130000
011400     05  LOW-LNE-NBR             PIC S9(09) COMP VALUE ZERO.      01140000
011500     05  HIGH-LNE-NBR            PIC S9(09) COMP VALUE 999999999. 01150000
011600                                                                  01160000
011700 01  PROGRAM-CONSTANTS.                                           01170000
011800     05  PC-PROGRAM-NAME         PIC  X(08)  VALUE 'VNKCS023'.    01180000
011900     05  WS-VNKCS024             PIC  X(08)  VALUE 'VNKCS024'.    01190000
012000     05  PC-MAX-DATE             PIC  X(10)  VALUE  '9999-12-31'. 01200000
012100     05  PC-LOG-QUEUE-RESOURCE   PIC  X(04)  VALUE 'CSSL'.        01210000
012200     05  PC-LOG-QUEUE            PIC  X(04)  VALUE 'CSSL'.        01220000
012300                                                                  01230000
012400 01  PROGRAM-VARIABLES.                                           01240000
012500     05  ENT-ID-BEING-PROCESSED  PIC S9(09)      COMP   VALUE +0. 01250000
012600     05  DEPT-BEING-PROCESSED    PIC  X(03)          VALUE SPACE. 01260000
012700     05  PV-TOTAL-ITEM-QTY-COMP  PIC S9(09)      COMP   VALUE +0. 01270000
012800     05  PV-TOTAL-ITEM-QTY       PIC S9(11)      COMP-3 VALUE +0. 01280000
012900     05  PV-TOTAL-COST-AMT       PIC S9(11)V9(3) COMP-3 VALUE +0. 01290000
013000     05  PV-TOTAL-RETAIL-AMT     PIC S9(11)V99   COMP-3 VALUE +0. 01300000
013100     05  PV-DETAIL-ITEM-QTY-COMP PIC S9(09)      COMP   VALUE +0. 01310000
013200     05  PV-DETAIL-ITEM-QTY      PIC S9(11)      COMP-3 VALUE +0. 01320000
013300     05  PV-DETAIL-COST-AMT      PIC S9(11)V9(3) COMP-3 VALUE +0. 01330000
013400     05  PV-DETAIL-RETAIL-AMT    PIC S9(11)V99   COMP-3 VALUE +0. 01340000
013500     05  PV-ACCUM-ITEM-QTY       PIC S9(14)      COMP-3 VALUE +0. 01350000
013600     05  PV-ACCUM-COST-AMT       PIC S9(13)V9(3) COMP-3 VALUE +0. 01360000
013700     05  PV-ACCUM-RETAIL-AMT     PIC S9(13)V99   COMP-3 VALUE +0. 01370000
013800     05  PV-SEQ-NBR              PIC S9(4)       COMP-3 VALUE +0. 01380000
013900     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01390000
014000                                              COMP SYNC.          01400000
014100     05  PV-ENT-ID               PIC  9(09)          VALUE ZEROES.01410000
014200     05  PV-LOG-LINE             PIC  X(80)          VALUE SPACES.01420000
014300                                                                  01430000
014310     05  PV-CICS-RESPONSE2       PIC S9(04) VALUE +0              01431002
014320                                              COMP SYNC.          01432000
014330     05  PV-CICS-MSG-AREA        PIC  X(100) VALUE SPACES.        01433000
014340     05  PV-COMMAREA-LENGTH      PIC S9(04) VALUE +0              01434000
014350                                            COMP SYNC.            01435000
014360                                                                  01436000
014370 01  PV-DISPLAY-VARIABLES.                                        01437000
014380     05  PV-DISP-ENT-ID               PIC 9(08) VALUE ZEROES.     01438000
014390     05  PV-DISP-PRIM-TYP-CDE         PIC X(01) VALUE SPACES.     01439000
014392     05  PV-DISP-STATUS-CDE           PIC X(01) VALUE SPACES.     01439200
014393     05  PV-DISP-ENT-NAME-DESC        PIC X(30) VALUE SPACES.     01439300
014395     05  PV-DISP-VND-IN-RMS-IND       PIC X(01) VALUE SPACES.     01439500
014397     05  PV-DISP-PO-PREPK-CDE         PIC X(01) VALUE SPACES.     01439700
014398                                                                  01439800
014400 01  PROGRAM-SWITCHES.                                            01440000
014500     05  PS-DEPT-SEARCH-END-SW       PIC X(01)    VALUE 'N'.      01450000
014600         88 PS-DEPT-SEARCH-END                    VALUE 'Y'.      01460000
014700         88 PS-DEPT-SEARCH-NOT-END                VALUE 'N'.      01470000
014800     05  PS-NOT-FIRST-ADDR-FETCH-SW  PIC X(01)    VALUE 'Y'.      01480000
014900         88 PS-FIRST-ADDR-FETCH                   VALUE 'Y'.      01490000
015000         88 PS-NOT-FIRST-ADDR-FETCH               VALUE 'N'.      01500000
015100     05  PS-PO-ADDR-FOUND-SW         PIC X(01)    VALUE 'N'.      01510000
015200         88 PS-PO-ADDR-NOT-FOUND                  VALUE 'N'.      01520000
015300         88 PS-PO-ADDR-FOUND                      VALUE 'Y'.      01530000
015400     05  PS-FOUND-TERMS-ROWS-SW      PIC X(01)    VALUE 'N'.      01540000
015500         88 NEW-TERMS-ROWS                        VALUE 'N'.      01550000
015600         88 FOUND-TERMS-ROWS                      VALUE 'Y'.      01560000
015700     05  PS-SPEC-TERMS-EXIST-SW      PIC X(01)    VALUE 'N'.      01570000
015800         88 SPEC-TERMS-NOT-EXIST                  VALUE 'N'.      01580000
015900         88 SPEC-TERMS-EXIST                      VALUE 'Y'.      01590000
016000     05  PS-FOUND-PROG-ACT-ROWS-SW   PIC X(01)    VALUE 'N'.      01600000
016100         88 NEW-PROG-ACT-ROWS                     VALUE 'N'.      01610000
016200         88 FOUND-PROG-ACT-ROWS                   VALUE 'Y'.      01620000
016300     05  PS-FOUND-PROG-SPEC-ROWS-SW  PIC X(01)    VALUE 'N'.      01630000
016400         88 NEW-PROG-SPEC-ROWS                    VALUE 'N'.      01640000
016500         88 FOUND-PROG-SPEC-ROWS                  VALUE 'Y'.      01650000
016600     05  PS-FOUND-ADDR-ROWS-SW       PIC X(01)    VALUE 'N'.      01660000
016700         88 NEW-ADDR-ROWS                         VALUE 'N'.      01670000
016800         88 FOUND-ADDR-ROWS                       VALUE 'Y'.      01680000
016900     05  PS-FOUND-CPBL-SW            PIC X(01)    VALUE 'N'.      01690000
017000         88 NEW-CPBL-ROWS                         VALUE 'N'.      01700000
017100         88 FOUND-CPBL-ROWS                       VALUE 'Y'.      01710000
017200     05  PS-FOUND-RLTN-SW            PIC X(01)    VALUE 'N'.      01720000
017300         88 NEW-RLTN-ROWS                         VALUE 'N'.      01730000
017400         88 FOUND-RLTN-ROWS                       VALUE 'Y'.      01740000
017500     05  PS-END-OF-TERMS-CSR-SW      PIC X(01)    VALUE 'N'.      01750000
017600         88 END-OF-TERMS-CSR                      VALUE 'Y'.      01760000
017700         88 NOT-END-OF-TERMS-CSR                  VALUE 'N'.      01770000
017800         88 EMPTY-TERMS-CSR                       VALUE 'E'.      01780000
017900     05  PS-END-OF-PROG-ACT-CSR-SW   PIC X(01)    VALUE 'N'.      01790000
018000         88 END-OF-PROG-ACT-CSR                   VALUE 'Y'.      01800000
018100         88 NOT-END-OF-PROG-ACT-CSR               VALUE 'N'.      01810000
018200         88 EMPTY-PROG-ACT-CSR                    VALUE 'E'.      01820000
018300     05  PS-END-OF-PROG-SPEC-CSR-SW  PIC X(01)    VALUE 'N'.      01830000
018400         88 END-OF-PROG-SPEC-CSR                  VALUE 'Y'.      01840000
018500         88 NOT-END-OF-PROG-SPEC-CSR              VALUE 'N'.      01850000
018600         88 EMPTY-PROG-SPEC-CSR                   VALUE 'E'.      01860000
018700     05  PS-END-OF-ADDR-CSR-SW       PIC X(01)    VALUE 'N'.      01870000
018800         88 END-OF-ADDR-CSR                       VALUE 'Y'.      01880000
018900         88 NOT-END-OF-ADDR-CSR                   VALUE 'N'.      01890000
019000         88 EMPTY-ADDR-CSR                        VALUE 'E'.      01900000
019100     05  PS-END-OF-CPBL-CSR-SW       PIC X(01)    VALUE 'N'.      01910000
019200         88 END-OF-CPBL-CSR                       VALUE 'Y'.      01920000
019300         88 NOT-END-OF-CPBL-CSR                   VALUE 'N'.      01930000
019400     05  PS-END-OF-RLTN-CSR-SW       PIC X(01)    VALUE 'N'.      01940000
019500         88 END-OF-RLTN-CSR                       VALUE 'Y'.      01950000
019600         88 NOT-END-OF-RLTN-CSR                   VALUE 'N'.      01960000
019700     05  PS-ENT-ID-PROCESSED-SW      PIC X(01)    VALUE 'N'.      01970000
019800         88 ENT-ID-PROCESSED                      VALUE 'Y'.      01980000
019900     05  PS-DEPT-PROCESSED-SW        PIC X(01)    VALUE 'N'.      01990000
020000         88 DEPT-PROCESSED                        VALUE 'Y'.      02000000
020100                                                                  02010000
020200                                                                  02020000
020300 01  ERROR-MESSAGES.                                              02030000
020400     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                02040000
020500             '*****   PROGRAM: VNKCS023'.                         02050000
020600     05  AA-PARAGRAPH-LIT.                                        02060000
020700         10  FILLER              PIC  X(17)  VALUE                02070000
020800             '***** PARAGRAPH: '.                                 02080000
020900         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        02090000
021000     05  AA-MESSAGE-LINE.                                         02100000
021100         10  FILLER              PIC  X(06)  VALUE '*****'.       02110000
021200         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        02120000
021300     05  AA-DB2-ERROR-LIT        PIC  X(40)  VALUE                02130000
021400             '*****    DB2 ERROR'.                                02140000
021500     05  AA-DB2-OPERATION-LIT.                                    02150000
021600         10  FILLER              PIC  X(17)  VALUE                02160000
021700             '***** OPERATION: '.                                 02170000
021800         10  AA-DB2-OPERATION.                                    02180000
021900             15  AA-DB2-OP-1     PIC  X(25)  VALUE SPACES.        02190000
022000             15  AA-DB2-OP-2     PIC  X(25)  VALUE SPACES.        02200000
022100     05  AA-DB2-TABLE-1          PIC  X(08)  VALUE SPACES.        02210000
022200     05  AA-DB2-TABLE-2          PIC  X(08)  VALUE SPACES.        02220000
022300     05  AA-DB2-TABLE-3          PIC  X(08)  VALUE SPACES.        02230000
022400                                                                  02240000
022500 01  VN007-COMMAREA.                                              02250000
022600     COPY VNWS007.                                                02260000
022700*--------------------------------------------------------------*  02270000
022800*  DPWS004 CONTAINS THE FIELDS NECESSARY TO CALL THE SQLCA     *  02280000
022900*  MESSAGE MODULE 'DSNTIAR' AND DISPLAY THE FORMATTED RESULTS. *  02290000
023000*--------------------------------------------------------------*  02300000
023100     COPY DPWS004.                                                02310000
023200 EJECT                                                            02320000
023300                                                                  02330000
023400*---------------------------------------------------------------  02340000
023500*  COMMUNICATIONS AREA2 FOR DB2                                   02350000
023600*---------------------------------------------------------------  02360000
023700     COPY SQLCA2.                                                 02370000
023800                                                                  02380000
023900*---------------------------------------------------------------  02390000
024000*     SQL COMMUNICATIONS AREA DCLGEN                              02400000
024100*---------------------------------------------------------------  02410000
024200     EXEC SQL                                                     02420000
024300         INCLUDE SQLCA                                            02430000
024400     END-EXEC.                                                    02440000
024500     EJECT                                                        02450000
024600                                                                  02460000
024700*---------------------------------------------------------------  02470000
024800*     TBUSLOC DCLGEN                                              02480000
024900*---------------------------------------------------------------  02490000
025000     EXEC SQL                                                     02500000
025100         INCLUDE TBUSLOC                                          02510000
025200     END-EXEC.                                                    02520000
025300     EJECT                                                        02530000
025400                                                                  02540000
025500*---------------------------------------------------------------  02550000
025600*     TENTREP DCLGEN                                              02560000
025700*---------------------------------------------------------------  02570000
025800     EXEC SQL                                                     02580000
025900         INCLUDE TENTREP                                          02590000
026000     END-EXEC.                                                    02600000
026100     EJECT                                                        02610000
026200                                                                  02620000
026300*---------------------------------------------------------------  02630000
026400*     TVNDDPT DCLGEN                                              02640000
026500*---------------------------------------------------------------  02650000
026600     EXEC SQL                                                     02660000
026700         INCLUDE TVNDDPT                                          02670000
026800     END-EXEC.                                                    02680000
026900     EJECT                                                        02690000
027000                                                                  02700000
027100*---------------------------------------------------------------  02710000
027200*     TVNDAGR DCLGEN                                              02720000
027300*---------------------------------------------------------------  02730000
027400     EXEC SQL                                                     02740000
027500         INCLUDE TVNDAGR                                          02750000
027600     END-EXEC.                                                    02760000
027700     EJECT                                                        02770000
027800                                                                  02780000
027900*---------------------------------------------------------------* 02790000
028000*    DB2 AREA FOR VNT_VND_CPBL                                  * 02800000
028100*---------------------------------------------------------------* 02810000
028200     EXEC SQL                                                     02820000
028300          INCLUDE VNT00001                                        02830000
028400     END-EXEC.                                                    02840000
028500                                                                  02850000
028600*---------------------------------------------------------------* 02860000
028700*    DB2 AREA FOR VNT_VND_RLTNSHP                               * 02870000
028800*---------------------------------------------------------------* 02880000
028900     EXEC SQL                                                     02890000
029000          INCLUDE VNT00000                                        02900000
029100     END-EXEC.                                                    02910000
029200                                                                  02920000
029300*---------------------------------------------------------------* 02930000
029400*  TERMS FOR ALL ACTIVE DEPARTMENTS CURSOR                      * 02940000
029500*                                                               * 02950000
029600*                                                               * 02960000
029700*                                                               * 02970000
029800*                                                               * 02980000
029900*                                                               * 02990000
030000*                                                               * 03000000
030100*---------------------------------------------------------------* 03010000
030200     EXEC SQL                                                     03020000
030300         DECLARE TERM_ACT_DEPTS_CSR CURSOR FOR                    03030000
030400         SELECT  V.DEPT_NBR                                       03040000
030500              ,  V.PAYT_TERM_ID                                   03050000
030600              , V2.FRGT_TERM_ID                                   03060000
030700           FROM TVNDDPT D                                         03070000
030800              , TVNDAGR V                                         03080000
030900              , TVNDAGR V2                                        03090000
031000          WHERE  D.ENT_ID          = V.ENT_ID                     03100000
031100            AND V2.ENT_ID          = V.ENT_ID                     03110000
031200            AND  D.DEPT_NBR        = V.DEPT_NBR                   03120000
031300            AND V2.DEPT_NBR        = V.DEPT_NBR                   03130000
031400            AND  V.ENT_ID          = :ENT-ID-BEING-PROCESSED      03140000
031500            AND D.VND_DEPT_STAT_CD = 'A'                          03150000
031600            AND D.VEND_TYP_IND NOT IN ('E')                       03160000
031700            AND V.AGRMT_TYP_ID       IN ('2')                     03170000
031800            AND V.PAYT_TERM_ID   NOT IN (0)                       03180000
031900            AND V.PAYT_TERM_ID   IS NOT NULL                      03190000
032000            AND V2.AGRMT_TYP_ID      IN ('1')                     03200000
032100            AND V2.FRGT_TERM_ID  NOT IN (0)                       03210000
032200            AND V2.FRGT_TERM_ID  IS NOT NULL                      03220000
032300            AND V.EXPIRATION_DATE  >  CURRENT_DATE                03230000
032400            AND V.EFFECTIVE_DATE   <= CURRENT_DATE                03240000
032500            AND V2.EXPIRATION_DATE >  CURRENT_DATE                03250000
032600            AND V2.EFFECTIVE_DATE  <= CURRENT_DATE                03260000
032700         ORDER BY V.DEPT_NBR                                      03270000
032800     END-EXEC.                                                    03280000
032900     EJECT                                                        03290000
033000                                                                  03300000
033100*---------------------------------------------------------------* 03310000
033200*  PROGRAMS FOR ALL ACTIVE DEPARTMENTS CURSOR                   * 03320000
033300*                                                               * 03330000
033400*                                                               * 03340000
033500*                                                               * 03350000
033600*                                                               * 03360000
033700*                                                               * 03370000
033800*                                                               * 03380000
033900*---------------------------------------------------------------* 03390000
034000     EXEC SQL                                                     03400000
034100         DECLARE PROG_ACT_DEPTS_CSR CURSOR FOR                    03410000
034200         SELECT V.DEPT_NBR                                        03420000
034300              , V.AGRMT_TYP_ID                                    03430000
034400              , V.TYP_CDE                                         03440000
034500              , COALESCE(V.DISCOUNT_PCT,0)                        03450000
034600              , COALESCE(V.EXT_PAY_DAYS_QTY,0)                    03460000
034700              , COALESCE(V.LEADTIME_DAYS_QTY,0)                   03470000
034800              , COALESCE(V.TKT_MKR_IND,' ')                       03480000
034900              , COALESCE(V.BULK_STK_TKT_IND,' ')                  03490000
035000           FROM TVNDAGR V                                         03500000
035100              , TVNDDPT D                                         03510000
035200          WHERE V.ENT_ID           = D.ENT_ID                     03520000
035300            AND V.DEPT_NBR         = D.DEPT_NBR                   03530000
035400            AND V.ENT_ID           = :ENT-ID-BEING-PROCESSED      03540000
035500            AND D.VND_DEPT_STAT_CD = 'A'                          03550000
035600            AND D.VEND_TYP_IND NOT IN ('E')                       03560000
035700            AND ((V.AGRMT_TYP_ID   IN ('4') AND                   03570000
035800                  V.TYP_CDE        IN (1,2,4))                    03580000
035900              OR (V.AGRMT_TYP_ID   IN ('5') AND                   03590000
036000                  V.TYP_CDE        IN (1,7,8,9,10,11,12,13))      03600000
036100              OR (V.AGRMT_TYP_ID   IN ('6') AND                   03610000
036200                  V.TYP_CDE        IN (5)))                       03620000
036300**            OR (V.AGRMT_TYP_ID   IN ('6') AND                   03630000
036400**                V.TYP_CDE        IN (6)   AND                   03640000
036500**                V.AP_TRN_CDE     = '90'   AND                   03650000
036600**                V.PSTG_FRQ_CDE   = 'IV'))                       03660000
036700            AND V.EXPIRATION_DATE >  CURRENT_DATE                 03670000
036800            AND V.EFFECTIVE_DATE  <= CURRENT_DATE                 03680000
036900         ORDER BY V.DEPT_NBR                                      03690000
037000                 ,V.AGRMT_TYP_ID                                  03700000
037100                 ,V.TYP_CDE                                       03710000
037200     END-EXEC.                                                    03720000
037300     EJECT                                                        03730000
037400                                                                  03740000
037500*---------------------------------------------------------------* 03750000
037600*  PROGRAMS FOR SPECIFIC DEPARTMENT CURSOR                      * 03760000
037700*                                                               * 03770000
037800*                                                               * 03780000
037900*                                                               * 03790000
038000*                                                               * 03800000
038100*                                                               * 03810000
038200*                                                               * 03820000
038300*---------------------------------------------------------------* 03830000
038400     EXEC SQL                                                     03840000
038500         DECLARE PROG_SPEC_DEPT_CSR CURSOR FOR                    03850000
038600         SELECT V.AGRMT_TYP_ID                                    03860000
038700              , V.TYP_CDE                                         03870000
038800              , COALESCE(V.DISCOUNT_PCT,0)                        03880000
038900              , COALESCE(V.EXT_PAY_DAYS_QTY,0)                    03890000
039000              , COALESCE(V.LEADTIME_DAYS_QTY,0)                   03900000
039100              , COALESCE(V.TKT_MKR_IND,'N')                       03910000
039200              , COALESCE(V.BULK_STK_TKT_IND,'N')                  03920000
039300           FROM TVNDAGR V                                         03930000
039400          WHERE V.ENT_ID           = :ENT-ID-BEING-PROCESSED      03940000
039500            AND V.DEPT_NBR         = :DEPT-BEING-PROCESSED        03950000
039600            AND ((V.AGRMT_TYP_ID   IN ('4') AND                   03960000
039700                  V.TYP_CDE        IN (1,2,4))                    03970000
039800              OR (V.AGRMT_TYP_ID   IN ('5') AND                   03980000
039900                  V.TYP_CDE        IN (1,7,8,9,10,11,12,13))      03990000
040000              OR (V.AGRMT_TYP_ID   IN ('6') AND                   04000000
040100                  V.TYP_CDE        IN (5)))                       04010000
040200**            OR (V.AGRMT_TYP_ID   IN ('6') AND                   04020000
040300**                V.TYP_CDE        IN (6)   AND                   04030000
040400**                V.AP_TRN_CDE     = '90'   AND                   04040000
040500**                V.PSTG_FRQ_CDE   = 'IV'))                       04050000
040600            AND V.EXPIRATION_DATE >  CURRENT_DATE                 04060000
040700            AND V.EFFECTIVE_DATE  <= CURRENT_DATE                 04070000
040800         ORDER BY V.DEPT_NBR                                      04080000
040900                 ,V.AGRMT_TYP_ID                                  04090000
041000                 ,V.TYP_CDE                                       04100000
041100     END-EXEC.                                                    04110000
041200                                                                  04120000
041300*---------------------------------------------------------------* 04130000
041400*  ADDRESS CURSOR                                               * 04140000
041500*                                                               * 04150000
041600*                                                               * 04160000
041700*                                                               * 04170000
041800*                                                               * 04180000
041900*                                                               * 04190000
042000*                                                               * 04200000
042100*---------------------------------------------------------------* 04210000
042200     EXEC SQL                                                     04220000
042300         DECLARE ADDRESS_CSR CURSOR FOR                           04230000
042400         SELECT A.FUNCTION_ID                                     04240000
042500               ,B.SEQ_NBR                                         04250000
042600               ,B.PRIM_ADDR_IND                                   04260000
042700               ,B.CNTRY_CDE                                       04270000
042800               ,B.ADDRESS_LINE1_DESC                              04280000
042900               ,B.ADDRESS_LINE2_DESC                              04290000
043000               ,B.ADDRESS_LINE3_DESC                              04300000
043100               ,B.CITY_NAME                                       04310000
043200               ,B.ST_PROV_CDE                                     04320000
043300               ,B.ZIP_CDE                                         04330000
043400               ,A.EMAIL_ADDR_ID                                   04340000
043500               ,A.FIRST_NAME                                      04350000
043600               ,A.LAST_NAME                                       04360000
043700               ,A.TEL1_NBR                                        04370000
043800               ,A.FAX_NBR                                         04380000
043900          FROM TENTREP A                                          04390000
044000              ,TBUSLOC B                                          04400000
044100         WHERE A.ENT_ID         = B.ENT_ID                        04410000
044200           AND A.ENT_BUS_LOC_ID = B.SEQ_NBR                       04420000
044300           AND A.ENT_ID         = :ENT-ID-BEING-PROCESSED         04430000
044400           AND A.FUNCTION_ID   IN (2,4)                           04440000
044500           AND B.SEQ_NBR   NOT IN (:PV-SEQ-NBR)                   04450000
044600         ORDER BY B.PRIM_ADDR_IND DESC                            04460000
044700                 ,A.FUNCTION_ID   ASC                             04470000
044800     END-EXEC.                                                    04480000
044900                                                                  04490000
045000*---------------------------------------------------------------* 04500000
045100*   CURSOR TO SELECT VENDOR CAPABILITIES                        * 04510000
045200*---------------------------------------------------------------* 04520000
045300                                                                  04530000
045400     EXEC SQL                                                     04540000
045500        DECLARE CAPABILITY_CSR CURSOR FOR                         04550000
045600          SELECT  VND_CPBL_CDE                                    04560000
045700          FROM VNT_VND_CPBL                                       04570000
045800           WHERE ENT_ID       = :ENT-ID-BEING-PROCESSED           04580000
045900             AND EFF_END_DTE  = :PC-MAX-DATE                      04590000
046000             ORDER BY VND_CPBL_CDE                                04600000
046100     END-EXEC.                                                    04610000
046200                                                                  04620000
046300*---------------------------------------------------------------* 04630000
046400*   CURSOR TO SELECT VENDOR RELATIONSHIPS                       * 04640000
046500*---------------------------------------------------------------* 04650000
046600                                                                  04660000
046700     EXEC SQL                                                     04670000
046800        DECLARE RELATIONSHIP_CSR CURSOR FOR                       04680000
046900          SELECT  VND_RLTNSHP_CDE                                 04690000
047000                 ,RLTD_ENT_ID                                     04700000
047100          FROM VNT_VND_RLTNSHP                                    04710000
047200           WHERE ENT_ID        = :ENT-ID-BEING-PROCESSED          04720000
047300             AND EFF_END_DTE   = :PC-MAX-DATE                     04730000
047400             ORDER BY VND_RLTNSHP_CDE                             04740000
047500     END-EXEC.                                                    04750000
047600                                                                  04760000
047700     EJECT                                                        04770000
047800                                                                  04780000
047900 LINKAGE SECTION.                                                 04790000
048000                                                                  04800000
048100 01 DFHCOMMAREA.                                                  04810000
048200     COPY VNWS013.                                                04820000
048300                                                                  04830000
048400***********************************************************       04840000
048500 PROCEDURE DIVISION.                                              04850000
048600***********************************************************       04860000
048700                                                                  04870000
048800 A100-MAINLINE-ROUTINE.                                           04880000
048900                                                                  04890000
049000     PERFORM B100-INITIALIZATION.                                 04900000
049100                                                                  04910000
049200     IF VN013-VND-IN-RMS-IND = 'N'                                04920000
049300        EVALUATE TRUE                                             04930000
049400            WHEN VN013-ACTION-ADD                                 04940000
049500               EVALUATE TRUE                                      04950000
049600                   WHEN VN013-FUNCTION-ADDRESS                    04960000
049700                      PERFORM C100-PROCESS-ADD-ADDRESS            04970000
049800                   WHEN VN013-FUNCTION-TERMS                      04980000
049900                      PERFORM C200-PROCESS-ADD-TERMS              04990000
050000                   WHEN VN013-FUNCTION-DEPT                       05000000
050100                      PERFORM C300-PROCESS-ADD-DEPT               05010000
050200                   WHEN VN013-FUNCTION-VENDOR                     05020000
050300                      PERFORM C800-PROCESS-ADD-VENDOR             05030000
050400               END-EVALUATE                                       05040000
050500        END-EVALUATE                                              05050000
050600     ELSE                                                         05060000
050700        IF VN013-VND-IN-RMS-IND = 'Y'                             05070000
050800           EVALUATE TRUE                                          05080000
050900               WHEN VN013-ACTION-UPDATE                           05090000
051000                  EVALUATE TRUE                                   05100000
051100                      WHEN VN013-FUNCTION-PROGRAMS                05110000
051200                         PERFORM C400-PROCESS-UPDT-PROGRAMS       05120000
051300                      WHEN VN013-FUNCTION-TERMS                   05130000
051400                         PERFORM C500-PROCESS-UPDT-TERMS          05140000
051500                      WHEN VN013-FUNCTION-DEPT                    05150000
051600                         PERFORM C600-PROCESS-UPDT-DEPT           05160000
051700                      WHEN VN013-FUNCTION-VENDOR-ALLW             05170000
051800                         PERFORM C900-PROCESS-UPDT-VNDR-ALLW      05180000
051900                  END-EVALUATE                                    05190000
052000               WHEN VN013-ACTION-DELETE                           05200000
052100                  PERFORM C700-PROCESS-DELETE                     05210000
052200           END-EVALUATE                                           05220000
052300        END-IF                                                    05230000
052400     END-IF.                                                      05240000
052500                                                                  05250000
052600     EXEC CICS                                                    05260000
052700      RETURN                                                      05270000
052800     END-EXEC.                                                    05280000
052900                                                                  05290000
053000*--------------------------------------------------------------*  05300000
053100*    INITIALIZATION PROCESSING                                 *  05310000
053200*--------------------------------------------------------------*  05320000
053300 B100-INITIALIZATION.                                             05330000
053400                                                                  05340000
053500     INITIALIZE DCLTBUSLOC                                        05350000
053600                DCLTENTREP                                        05360000
053700                DCLTVNDDPT                                        05370000
053800                DCLTVNDAGR                                        05380000
053900                VN007-INTERFACE-MESSAGE-PARMS                     05390002
053910                PV-DISPLAY-VARIABLES.                             05391002
054000                                                                  05400000
054100     MOVE VN013-ENT-ID         TO ENT-ID-BEING-PROCESSED          05410000
054200                                  VN007-ENT-ID.                   05420000
054300     MOVE VN013-DEPT-NBR       TO DEPT-BEING-PROCESSED.           05430000
054400     MOVE VN013-ADDR-SEQ-NBR   TO PV-SEQ-NBR.                     05440000
054500     MOVE VN013-VND-NBR        TO VN007-VND-NBR.                  05450000
054600     IF NOT VN013-ACTION-UPDATE                                   05460000
054700        MOVE VN013-ENT-ID         TO PV-DISP-ENT-ID               05470000
054701        MOVE VN013-PRIM-TYP-CDE   TO VN007-PRIM-TYP-CDE           05470100
054710                                     PV-DISP-PRIM-TYP-CDE         05471000
054800        MOVE VN013-STATUS-CDE     TO VN007-STATUS-CDE             05480000
054810                                     PV-DISP-STATUS-CDE           05481000
054900        MOVE VN013-ENT-NAME-DESC  TO VN007-ENT-NAME-DESC          05490000
054910                                     PV-DISP-ENT-NAME-DESC        05491000
055000        MOVE VN013-VND-IN-RMS-IND TO VN007-VND-IN-RMS-IND         05500000
055010                                     PV-DISP-VND-IN-RMS-IND       05501000
055100        MOVE VN013-PO-PREPK-CDE   TO VN007-PO-PREPK-CDE           05510000
055110                                     PV-DISP-PO-PREPK-CDE         05511000
055120        PERFORM Z9990-WRITE-CICS                                  05512000
055200     END-IF.                                                      05520000
055300 EJECT                                                            05530000
055400                                                                  05540000
055500                                                                  05550000
055600*---------------------------------------------------------------* 05560000
055700*                                                               * 05570000
055800*                                                               * 05580000
055900*                                                               * 05590000
056000*                                                               * 05600000
056100*                                                               * 05610000
056200*                                                               * 05620000
056300*---------------------------------------------------------------* 05630000
056400 C100-PROCESS-ADD-ADDRESS.                                        05640000
056500     PERFORM Y100-OPEN-TERMS-ACTIVE-CSR.                          05650000
056600     PERFORM S100-FETCH-TERMS-ACTIVE-CSR.                         05660000
056700     IF FOUND-TERMS-ROWS                                          05670000
056800        SET VN007-DEPT-IND TO 1                                   05680000
056900        PERFORM M100-MOVE-ADD-ADDRESS-TERMS UNTIL                 05690000
057000                        END-OF-TERMS-CSR OR                       05700000
057100                        VN007-DEPT-IND > 10                       05710000
057200        IF (VN007-DEPT-IND > 10) AND (NOT-END-OF-TERMS-CSR)       05720000
057300           SET VN013-MAX-DEPT-EXCEEDED TO TRUE                    05730000
057400        END-IF                                                    05740000
057500        PERFORM M200-MOVE-ADD-ADDRESS-ADDL                        05750000
057600     END-IF.                                                      05760000
057700     PERFORM Y500-CLOSE-TERMS-ACTIVE-CSR.                         05770000
057800 EJECT                                                            05780000
057900                                                                  05790000
058000*---------------------------------------------------------------* 05800000
058100*                                                               * 05810000
058200*                                                               * 05820000
058300*                                                               * 05830000
058400*                                                               * 05840000
058500*                                                               * 05850000
058600*                                                               * 05860000
058700*---------------------------------------------------------------* 05870000
058800 C200-PROCESS-ADD-TERMS.                                          05880000
058900     PERFORM Y400-OPEN-ADDRESS-CSR.                               05890000
059000     PERFORM S400-FETCH-ADDRESS-CSR.                              05900000
059100     IF FOUND-ADDR-ROWS                                           05910000
059200        SET VN007-ADDR-IND TO 1                                   05920000
059300        PERFORM N200-MOVE-ADD-ADDRESS-ADDR UNTIL                  05930000
059400                        END-OF-ADDR-CSR OR                        05940000
059500                        VN007-ADDR-IND > 4                        05950000
059600        IF (VN007-ADDR-IND > 4) AND (NOT-END-OF-ADDR-CSR)         05960000
059700           SET VN013-MAX-ADDR-EXCEEDED TO TRUE                    05970000
059800        END-IF                                                    05980000
059900     END-IF.                                                      05990000
060000     PERFORM Y800-CLOSE-ADDRESS-CSR.                              06000000
060100                                                                  06010000
060200     IF PS-PO-ADDR-FOUND                                          06020000
060300        MOVE VN013-DEPT-NBR          TO VN007-DEPT-NBR(1)         06030000
060400        MOVE VN013-PAYT-TERM-ID      TO VN007-PAYT-TERM-ID(1)     06040000
060500        MOVE VN013-FRGT-TERM-ID      TO VN007-FRGT-TERM-ID(1)     06050000
060600        PERFORM Y300-OPEN-PROGS-SPECIFIC-CSR                      06060000
060700        PERFORM S300-FETCH-PROGS-SPECIFIC-CSR                     06070000
060800        SET VN007-DEPT-IND TO 1                                   06080000
060900        PERFORM N120-MOVE-SPECIFIC-PROGS-DATA                     06090000
061000                     UNTIL END-OF-PROG-SPEC-CSR                   06100000
061100                        OR EMPTY-PROG-SPEC-CSR                    06110000
061200        PERFORM Y700-CLOSE-PROGS-SPECIFIC-CSR                     06120000
061300        PERFORM Y900-OPEN-CAPABILITY-CSR                          06130000
061400        PERFORM S800-FETCH-CAPABILITY-CSR                         06140000
061500        IF FOUND-CPBL-ROWS                                        06150000
061600           SET VN007-CPBL-IND TO 1                                06160000
061700           PERFORM N300-MOVE-CAPABILITY UNTIL                     06170000
061800                           END-OF-CPBL-CSR OR                     06180000
061900                           VN007-CPBL-IND > 20                    06190000
062000           IF (VN007-CPBL-IND > 20) AND                           06200000
062100              (NOT-END-OF-CPBL-CSR)                               06210000
062200              SET VN013-MAX-CPBLTY-EXCEEDED TO TRUE               06220000
062300           END-IF                                                 06230000
062400        END-IF                                                    06240000
062500        PERFORM Y901-CLOSE-CAPABILITY-CSR                         06250000
062600        PERFORM Y910-OPEN-RELATIONSHIP-CSR                        06260000
062700        PERFORM S810-FETCH-RELATIONSHIP-CSR                       06270000
062800        IF FOUND-RLTN-ROWS                                        06280000
062900           SET VN007-RLTN-IND TO 1                                06290000
063000           PERFORM N400-MOVE-RELATIONSHIP UNTIL                   06300000
063100                           END-OF-RLTN-CSR OR                     06310000
063200                           VN007-RLTN-IND > 20                    06320000
063300           IF (VN007-RLTN-IND > 20) AND                           06330000
063400              (NOT-END-OF-RLTN-CSR)                               06340000
063500              SET VN013-MAX-RLTNSHP-EXCEEDED TO TRUE              06350000
063600           END-IF                                                 06360000
063700        END-IF                                                    06370000
063800        PERFORM Y911-CLOSE-RELATIONSHIP-CSR                       06380000
063900        PERFORM S500-SELECT-DEPARTMENT-STATUS                     06390000
064000        MOVE VNDDPT-VND-DEPT-STAT-CD TO VN007-VND-DEPT-STAT-CD(1) 06400000
064100        PERFORM P100-POPULATE-NON-NULLS                           06410000
064200                     VARYING VN007-DEPT-IND FROM 1 BY 1           06420000
064300                     UNTIL VN007-DEPT-IND > 10                    06430000
064400        EXEC CICS LINK PROGRAM (WS-VNKCS024)                      06440000
064500                        COMMAREA(VN007-COMMAREA)                  06450000
064600                        RESP    (PV-CICS-RESPONSE)                06460000
064700        END-EXEC                                                  06470000
064800        IF VN007-NO-ERRORS                                        06480000
064900           SET VN013-RMS-VENDOR-ADDED                             06490000
065000               VN013-NO-ERRORS          TO TRUE                   06500000
065100        ELSE                                                      06510000
065200           IF VN007-MQ-ERROR                                      06520000
065300              SET VN013-MQ-ERROR        TO TRUE                   06530000
065400              MOVE VN007-PROGRAM-NAME   TO VN013-PROGRAM-NAME     06540000
065500              MOVE VN007-PARAGRAPH-NAME TO VN013-PARAGRAPH-NAME   06550000
065600              MOVE VN007-MESSAGE        TO VN013-MESSAGE          06560000
065700              MOVE VN007-REASON-CODE    TO VN013-SQLCODE          06570000
065800           END-IF                                                 06580000
065900        END-IF                                                    06590000
066000     END-IF.                                                      06600000
066100                                                                  06610000
066200*---------------------------------------------------------------* 06620000
066300*                                                               * 06630000
066400*                                                               * 06640000
066500*                                                               * 06650000
066600*                                                               * 06660000
066700*                                                               * 06670000
066800*                                                               * 06680000
066900*---------------------------------------------------------------* 06690000
067000 C300-PROCESS-ADD-DEPT.                                           06700000
067100     MOVE VN013-DEPT-NBR         TO VN007-DEPT-NBR(1).            06710000
067200     MOVE VN013-VND-DEPT-STAT-CD TO VN007-VND-DEPT-STAT-CD(1).    06720000
067300     PERFORM S600-SELECT-TERMS-SPECIFIC.                          06730000
067400     IF SPEC-TERMS-EXIST                                          06740000
067500        MOVE VNDAGR-PAYT-TERM-ID TO VN007-PAYT-TERM-ID(1)         06750000
067600        MOVE VNDAGR-FRGT-TERM-ID TO VN007-FRGT-TERM-ID(1)         06760000
067700        PERFORM Y400-OPEN-ADDRESS-CSR                             06770000
067800        PERFORM S400-FETCH-ADDRESS-CSR                            06780000
067900        IF FOUND-ADDR-ROWS                                        06790000
068000           SET VN007-ADDR-IND TO 1                                06800000
068100           PERFORM N200-MOVE-ADD-ADDRESS-ADDR UNTIL               06810000
068200                        END-OF-ADDR-CSR OR                        06820000
068300                        VN007-ADDR-IND > 4                        06830000
068400           IF (VN007-ADDR-IND > 4) AND (NOT-END-OF-ADDR-CSR)      06840000
068500              SET VN013-MAX-ADDR-EXCEEDED TO TRUE                 06850000
068600           END-IF                                                 06860000
068700        END-IF                                                    06870000
068800        PERFORM Y800-CLOSE-ADDRESS-CSR                            06880000
068900        IF PS-PO-ADDR-FOUND                                       06890000
069000           PERFORM Y300-OPEN-PROGS-SPECIFIC-CSR                   06900000
069100           PERFORM S300-FETCH-PROGS-SPECIFIC-CSR                  06910000
069200           SET VN007-DEPT-IND TO 1                                06920000
069300           PERFORM N120-MOVE-SPECIFIC-PROGS-DATA                  06930000
069400                        UNTIL END-OF-PROG-SPEC-CSR                06940000
069500                           OR EMPTY-PROG-SPEC-CSR                 06950000
069600           PERFORM Y700-CLOSE-PROGS-SPECIFIC-CSR                  06960000
069700           PERFORM Y900-OPEN-CAPABILITY-CSR                       06970000
069800           PERFORM S800-FETCH-CAPABILITY-CSR                      06980000
069900           IF FOUND-CPBL-ROWS                                     06990000
070000              SET VN007-CPBL-IND TO 1                             07000000
070100              PERFORM N300-MOVE-CAPABILITY UNTIL                  07010000
070200                              END-OF-CPBL-CSR OR                  07020000
070300                              VN007-CPBL-IND > 20                 07030000
070400              IF (VN007-CPBL-IND > 20) AND                        07040000
070500                 (NOT-END-OF-CPBL-CSR)                            07050000
070600                 SET VN013-MAX-CPBLTY-EXCEEDED TO TRUE            07060000
070700              END-IF                                              07070000
070800           END-IF                                                 07080000
070900           PERFORM Y901-CLOSE-CAPABILITY-CSR                      07090000
071000           PERFORM Y910-OPEN-RELATIONSHIP-CSR                     07100000
071100           PERFORM S810-FETCH-RELATIONSHIP-CSR                    07110000
071200           IF FOUND-RLTN-ROWS                                     07120000
071300              SET VN007-RLTN-IND TO 1                             07130000
071400              PERFORM N400-MOVE-RELATIONSHIP UNTIL                07140000
071500                              END-OF-RLTN-CSR OR                  07150000
071600                              VN007-RLTN-IND > 20                 07160000
071700              IF (VN007-RLTN-IND > 20) AND                        07170000
071800                 (NOT-END-OF-RLTN-CSR)                            07180000
071900                 SET VN013-MAX-RLTNSHP-EXCEEDED TO TRUE           07190000
072000              END-IF                                              07200000
072100           END-IF                                                 07210000
072200           PERFORM Y911-CLOSE-RELATIONSHIP-CSR                    07220000
072300           PERFORM P100-POPULATE-NON-NULLS                        07230000
072400                        VARYING VN007-DEPT-IND FROM 1 BY 1        07240000
072500                        UNTIL VN007-DEPT-IND > 10                 07250000
072600           EXEC CICS LINK PROGRAM (WS-VNKCS024)                   07260000
072700                           COMMAREA(VN007-COMMAREA)               07270000
072800                           RESP    (PV-CICS-RESPONSE)             07280000
072900           END-EXEC                                               07290000
073000           IF VN007-NO-ERRORS                                     07300000
073100              SET VN013-RMS-VENDOR-ADDED                          07310000
073200                  VN013-NO-ERRORS          TO TRUE                07320000
073300           ELSE                                                   07330000
073400              IF VN007-MQ-ERROR                                   07340000
073500                 SET VN013-MQ-ERROR        TO TRUE                07350000
073600                 MOVE VN007-PROGRAM-NAME   TO VN013-PROGRAM-NAME  07360000
073700                 MOVE VN007-PARAGRAPH-NAME TO VN013-PARAGRAPH-NAME07370000
073800                 MOVE VN007-MESSAGE        TO VN013-MESSAGE       07380000
073900                 MOVE VN007-REASON-CODE    TO VN013-SQLCODE       07390000
074000              END-IF                                              07400000
074100           END-IF                                                 07410000
074200        END-IF                                                    07420000
074300     END-IF.                                                      07430000
074400                                                                  07440000
074500*---------------------------------------------------------------* 07450000
074600*                                                               * 07460000
074700*                                                               * 07470000
074800*                                                               * 07480000
074900*                                                               * 07490000
075000*                                                               * 07500000
075100*                                                               * 07510000
075200*---------------------------------------------------------------* 07520000
075300 C400-PROCESS-UPDT-PROGRAMS.                                      07530000
075400     PERFORM S600-SELECT-TERMS-SPECIFIC.                          07540000
075500     IF SPEC-TERMS-EXIST                                          07550000
075600        MOVE VNDAGR-PAYT-TERM-ID    TO VN007-PAYT-TERM-ID(1)      07560000
075700        MOVE VNDAGR-FRGT-TERM-ID    TO VN007-FRGT-TERM-ID(1)      07570000
075800        MOVE VN013-DEPT-NBR         TO VN007-DEPT-NBR(1)          07580000
075900        MOVE VN013-VND-DEPT-STAT-CD TO VN007-VND-DEPT-STAT-CD(1)  07590000
076000        MOVE VN013-BULK-STK-TKT-IND                               07600000
076100             TO VN007-BULK-STK-TKT-IND(1)                         07610000
076200        MOVE VN013-TKT-MKR-IND                                    07620000
076300             TO VN007-TKT-MKR-IND(1)                              07630000
076400        MOVE VN013-HANGER-IND                                     07640000
076500             TO VN007-HANGER-IND(1)                               07650000
076600        MOVE VN013-PACK-BY-STR-IND                                07660000
076700             TO VN007-PACK-BY-STR-IND(1)                          07670000
076800        MOVE VN013-SPLIT-REQD-IND                                 07680000
076900             TO VN007-SPLIT-REQD-IND(1)                           07690000
077000        MOVE VN013-SPLIT-LEADTIME-QTY                             07700000
077100             TO VN007-SPLIT-LEADTIME-QTY(1)                       07710000
077200        MOVE VN013-PRETKT-LEADTIME-QTY                            07720000
077300             TO VN007-PRETKT-LEADTIME-QTY(1)                      07730000
077400        MOVE VN013-NSD-DISC-PCT                                   07740000
077500             TO VN007-NSD-DISC-PCT(1)                             07750000
077600        MOVE VN013-NSD-EXT-DAYS-QTY                               07760000
077700             TO VN007-NSD-EXT-DAYS-QTY(1)                         07770000
077800        MOVE VN013-MOS-DISC-PCT                                   07780000
077900             TO VN007-MOS-DISC-PCT(1)                             07790000
078000        MOVE VN013-TRD-DISC-PCT                                   07800000
078100             TO VN007-TRD-DISC-PCT(1)                             07810000
078200        MOVE VN013-ADV-DISC-PCT                                   07820000
078300             TO VN007-ADV-DISC-PCT(1)                             07830000
078400        MOVE VN013-COOP-DISC-PCT                                  07840000
078500             TO VN007-COOP-DISC-PCT(1)                            07850000
078600        MOVE VN013-PRFTASST-ADCOOP-PCT                            07860000
078700             TO VN007-PRFTASST-ADCOOP-PCT(1)                      07870000
078800        MOVE VN013-TBL-TWR-DAYS-QTY                               07880000
078900             TO VN007-TBL-TWR-DAYS-QTY(1)                         07890000
079000        MOVE VN013-BRDL-DISC-PCT                                  07900000
079100             TO VN007-BRDL-DISC-PCT(1)                            07910000
079200**      PERFORM Y300-OPEN-PROGS-SPECIFIC-CSR                      07920000
079300**      PERFORM S300-FETCH-PROGS-SPECIFIC-CSR                     07930000
079400**      PERFORM N130-MOVE-DISCOUNT                                07940000
079500**                   UNTIL END-OF-PROG-SPEC-CSR                   07950000
079600**                      OR EMPTY-PROG-SPEC-CSR                    07960000
079700**      PERFORM Y700-CLOSE-PROGS-SPECIFIC-CSR                     07970000
079800        PERFORM S500-SELECT-DEPARTMENT-STATUS                     07980000
079900        MOVE VNDDPT-VND-DEPT-STAT-CD TO VN007-VND-DEPT-STAT-CD(1) 07990000
080000        PERFORM P100-POPULATE-NON-NULLS                           08000000
080100                     VARYING VN007-DEPT-IND FROM 1 BY 1           08010000
080200                     UNTIL VN007-DEPT-IND > 10                    08020000
080300        EXEC CICS LINK PROGRAM (WS-VNKCS024)                      08030000
080400                        COMMAREA(VN007-COMMAREA)                  08040000
080500                        RESP    (PV-CICS-RESPONSE)                08050000
080600        END-EXEC                                                  08060000
080700        IF VN007-NO-ERRORS                                        08070000
080800           SET VN013-NO-ERRORS          TO TRUE                   08080000
080900        ELSE                                                      08090000
081000           IF VN007-MQ-ERROR                                      08100000
081100              SET VN013-MQ-ERROR        TO TRUE                   08110000
081200              MOVE VN007-PROGRAM-NAME   TO VN013-PROGRAM-NAME     08120000
081300              MOVE VN007-PARAGRAPH-NAME TO VN013-PARAGRAPH-NAME   08130000
081400              MOVE VN007-MESSAGE        TO VN013-MESSAGE          08140000
081500              MOVE VN007-REASON-CODE    TO VN013-SQLCODE          08150000
081600           END-IF                                                 08160000
081700        END-IF                                                    08170000
081800     END-IF.                                                      08180000
081900                                                                  08190000
082000*---------------------------------------------------------------* 08200000
082100*                                                                 08210000
082200*                                                                 08220000
082300*                                                                 08230000
082400*                                                                 08240000
082500*                                                                 08250000
082600*                                                                 08260000
082700*---------------------------------------------------------------* 08270000
082800 C500-PROCESS-UPDT-TERMS.                                         08280000
082900     MOVE VN013-PAYT-TERM-ID TO VN007-PAYT-TERM-ID(1).            08290000
083000     MOVE VN013-FRGT-TERM-ID TO VN007-FRGT-TERM-ID(1).            08300000
083100     MOVE VN013-DEPT-NBR     TO VN007-DEPT-NBR(1).                08310000
083200     PERFORM S500-SELECT-DEPARTMENT-STATUS.                       08320000
083300     MOVE VNDDPT-VND-DEPT-STAT-CD TO VN007-VND-DEPT-STAT-CD(1).   08330000
083400     PERFORM Y300-OPEN-PROGS-SPECIFIC-CSR.                        08340000
083500     PERFORM S300-FETCH-PROGS-SPECIFIC-CSR.                       08350000
083600     SET VN007-DEPT-IND TO 1.                                     08360000
083700     PERFORM N120-MOVE-SPECIFIC-PROGS-DATA                        08370000
083800                  UNTIL END-OF-PROG-SPEC-CSR                      08380000
083900                     OR EMPTY-PROG-SPEC-CSR.                      08390000
084000     PERFORM Y700-CLOSE-PROGS-SPECIFIC-CSR.                       08400000
084100     PERFORM P100-POPULATE-NON-NULLS                              08410000
084200                  VARYING VN007-DEPT-IND FROM 1 BY 1              08420000
084300                  UNTIL VN007-DEPT-IND > 10.                      08430000
084400     EXEC CICS LINK PROGRAM (WS-VNKCS024)                         08440000
084500                     COMMAREA(VN007-COMMAREA)                     08450000
084600                     RESP    (PV-CICS-RESPONSE)                   08460000
084700     END-EXEC.                                                    08470000
084800     IF VN007-NO-ERRORS                                           08480000
084900        SET VN013-NO-ERRORS          TO TRUE                      08490000
085000     ELSE                                                         08500000
085100        IF VN007-MQ-ERROR                                         08510000
085200           SET VN013-MQ-ERROR        TO TRUE                      08520000
085300           MOVE VN007-PROGRAM-NAME   TO VN013-PROGRAM-NAME        08530000
085400           MOVE VN007-PARAGRAPH-NAME TO VN013-PARAGRAPH-NAME      08540000
085500           MOVE VN007-MESSAGE        TO VN013-MESSAGE             08550000
085600           MOVE VN007-REASON-CODE    TO VN013-SQLCODE             08560000
085700        END-IF                                                    08570000
085800     END-IF.                                                      08580000
085900                                                                  08590000
086000*---------------------------------------------------------------* 08600000
086100*                                                                 08610000
086200*                                                                 08620000
086300*                                                                 08630000
086400*                                                                 08640000
086500*                                                                 08650000
086600*                                                                 08660000
086700*---------------------------------------------------------------* 08670000
086800 C600-PROCESS-UPDT-DEPT.                                          08680000
086900     MOVE VN013-DEPT-NBR         TO VN007-DEPT-NBR(1).            08690000
087000     MOVE VN013-VND-DEPT-STAT-CD TO VN007-VND-DEPT-STAT-CD(1).    08700000
087100     PERFORM S600-SELECT-TERMS-SPECIFIC.                          08710000
087200     IF SPEC-TERMS-EXIST                                          08720000
087300        MOVE VNDAGR-PAYT-TERM-ID TO VN007-PAYT-TERM-ID(1)         08730000
087400        MOVE VNDAGR-FRGT-TERM-ID TO VN007-FRGT-TERM-ID(1)         08740000
087500        PERFORM Y300-OPEN-PROGS-SPECIFIC-CSR                      08750000
087600        PERFORM S300-FETCH-PROGS-SPECIFIC-CSR                     08760000
087700        SET VN007-DEPT-IND TO 1                                   08770000
087800        PERFORM N120-MOVE-SPECIFIC-PROGS-DATA                     08780000
087900                     UNTIL END-OF-PROG-SPEC-CSR                   08790000
088000                        OR EMPTY-PROG-SPEC-CSR                    08800000
088100        PERFORM Y700-CLOSE-PROGS-SPECIFIC-CSR                     08810000
088200        PERFORM P100-POPULATE-NON-NULLS                           08820000
088300                     VARYING VN007-DEPT-IND FROM 1 BY 1           08830000
088400                     UNTIL VN007-DEPT-IND > 10                    08840000
088500        EXEC CICS LINK PROGRAM (WS-VNKCS024)                      08850000
088600                        COMMAREA(VN007-COMMAREA)                  08860000
088700                        RESP    (PV-CICS-RESPONSE)                08870000
088800        END-EXEC                                                  08880000
088900        IF VN007-NO-ERRORS                                        08890000
089000           SET VN013-NO-ERRORS          TO TRUE                   08900000
089100        ELSE                                                      08910000
089200           IF VN007-MQ-ERROR                                      08920000
089300              SET VN013-MQ-ERROR        TO TRUE                   08930000
089400              MOVE VN007-PROGRAM-NAME   TO VN013-PROGRAM-NAME     08940000
089500              MOVE VN007-PARAGRAPH-NAME TO VN013-PARAGRAPH-NAME   08950000
089600              MOVE VN007-MESSAGE        TO VN013-MESSAGE          08960000
089700              MOVE VN007-REASON-CODE    TO VN013-SQLCODE          08970000
089800           END-IF                                                 08980000
089900        END-IF                                                    08990000
090000     END-IF.                                                      09000000
090100                                                                  09010000
090200*---------------------------------------------------------------* 09020000
090300*                                                                 09030000
090400*                                                                 09040000
090500*                                                                 09050000
090600*                                                                 09060000
090700*                                                                 09070000
090800*                                                                 09080000
090900*---------------------------------------------------------------* 09090000
091000 C700-PROCESS-DELETE.                                             09100000
091100     MOVE 'I' TO VN007-STATUS-CDE.                                09110000
091200     PERFORM Y100-OPEN-TERMS-ACTIVE-CSR.                          09120000
091300     PERFORM S100-FETCH-TERMS-ACTIVE-CSR.                         09130000
091400     IF FOUND-TERMS-ROWS                                          09140000
091500        SET VN007-DEPT-IND TO 1                                   09150000
091600        PERFORM M100-MOVE-ADD-ADDRESS-TERMS UNTIL                 09160000
091700                        END-OF-TERMS-CSR OR                       09170000
091800                        VN007-DEPT-IND > 10                       09180000
091900        IF (VN007-DEPT-IND > 10) AND (NOT-END-OF-TERMS-CSR)       09190000
092000           SET VN013-MAX-DEPT-EXCEEDED TO TRUE                    09200000
092100        END-IF                                                    09210000
092200        PERFORM Y200-OPEN-PROGS-ACTIVE-CSR                        09220000
092300        PERFORM S200-FETCH-PROGS-ACTIVE-CSR                       09230000
092400        IF FOUND-PROG-ACT-ROWS                                    09240000
092500           SET VN007-DEPT-IND TO 1                                09250000
092600           PERFORM N100-MOVE-ADD-ADDRESS-PROGS UNTIL              09260000
092700                           END-OF-PROG-ACT-CSR OR                 09270000
092800                           PS-DEPT-SEARCH-END                     09280000
092900        END-IF                                                    09290000
093000        PERFORM Y600-CLOSE-PROGS-ACTIVE-CSR                       09300000
093100        PERFORM P100-POPULATE-NON-NULLS                           09310000
093200                     VARYING VN007-DEPT-IND FROM 1 BY 1           09320000
093300                     UNTIL VN007-DEPT-IND > 10                    09330000
093400     END-IF.                                                      09340000
093500                                                                  09350000
093600     PERFORM Y500-CLOSE-TERMS-ACTIVE-CSR.                         09360000
093700                                                                  09370000
093800     EXEC CICS LINK PROGRAM (WS-VNKCS024)                         09380000
093900                     COMMAREA(VN007-COMMAREA)                     09390000
094000                     RESP    (PV-CICS-RESPONSE)                   09400000
094100     END-EXEC.                                                    09410000
094200     IF VN007-NO-ERRORS                                           09420000
094300        SET VN013-NO-ERRORS          TO TRUE                      09430000
094400     ELSE                                                         09440000
094500        IF VN007-MQ-ERROR                                         09450000
094600           SET VN013-MQ-ERROR        TO TRUE                      09460000
094700           MOVE VN007-PROGRAM-NAME   TO VN013-PROGRAM-NAME        09470000
094800           MOVE VN007-PARAGRAPH-NAME TO VN013-PARAGRAPH-NAME      09480000
094900           MOVE VN007-MESSAGE        TO VN013-MESSAGE             09490000
095000           MOVE VN007-REASON-CODE    TO VN013-SQLCODE             09500000
095100        END-IF                                                    09510000
095200     END-IF.                                                      09520000
095300                                                                  09530000
095400*---------------------------------------------------------------* 09540000
095500*                                                                 09550000
095600*                                                                 09560000
095700*                                                                 09570000
095800*                                                                 09580000
095900*                                                                 09590000
096000*                                                                 09600000
096100*---------------------------------------------------------------* 09610000
096200 C800-PROCESS-ADD-VENDOR.                                         09620000
096300     PERFORM Y100-OPEN-TERMS-ACTIVE-CSR.                          09630000
096400     PERFORM S100-FETCH-TERMS-ACTIVE-CSR.                         09640000
096500     IF FOUND-TERMS-ROWS                                          09650000
096600        SET VN007-DEPT-IND TO 1                                   09660000
096700        PERFORM M100-MOVE-ADD-ADDRESS-TERMS UNTIL                 09670000
096800                        END-OF-TERMS-CSR OR                       09680000
096900                        VN007-DEPT-IND > 10                       09690000
097000        IF (VN007-DEPT-IND > 10) AND (NOT-END-OF-TERMS-CSR)       09700000
097100           SET VN013-MAX-DEPT-EXCEEDED TO TRUE                    09710000
097200        END-IF                                                    09720000
097300        PERFORM Y400-OPEN-ADDRESS-CSR                             09730000
097400        PERFORM S400-FETCH-ADDRESS-CSR                            09740000
097500        IF FOUND-ADDR-ROWS                                        09750000
097600           SET VN007-ADDR-IND TO 1                                09760000
097700           PERFORM N200-MOVE-ADD-ADDRESS-ADDR UNTIL               09770000
097800                           END-OF-ADDR-CSR OR                     09780000
097900                           VN007-ADDR-IND > 4                     09790000
098000           IF (VN007-ADDR-IND > 4) AND (NOT-END-OF-ADDR-CSR)      09800000
098100              SET VN013-MAX-ADDR-EXCEEDED TO TRUE                 09810000
098200           END-IF                                                 09820000
098300        END-IF                                                    09830000
098400        IF PS-PO-ADDR-FOUND                                       09840000
098500           PERFORM Y200-OPEN-PROGS-ACTIVE-CSR                     09850000
098600           PERFORM S200-FETCH-PROGS-ACTIVE-CSR                    09860000
098700           IF FOUND-PROG-ACT-ROWS                                 09870000
098800              PERFORM Y900-OPEN-CAPABILITY-CSR                    09880000
098900              PERFORM S800-FETCH-CAPABILITY-CSR                   09890000
099000              IF FOUND-CPBL-ROWS                                  09900000
099100                 SET VN007-CPBL-IND TO 1                          09910000
099200                 PERFORM N300-MOVE-CAPABILITY UNTIL               09920000
099300                                 END-OF-CPBL-CSR OR               09930000
099400                                 VN007-CPBL-IND > 20              09940000
099500                 IF (VN007-CPBL-IND > 20) AND                     09950000
099600                    (NOT-END-OF-CPBL-CSR)                         09960000
099700                    SET VN013-MAX-CPBLTY-EXCEEDED TO TRUE         09970000
099800                 END-IF                                           09980000
099900              END-IF                                              09990000
100000              PERFORM Y901-CLOSE-CAPABILITY-CSR                   10000000
100100              PERFORM Y910-OPEN-RELATIONSHIP-CSR                  10010000
100200              PERFORM S810-FETCH-RELATIONSHIP-CSR                 10020000
100300              IF FOUND-RLTN-ROWS                                  10030000
100400                 SET VN007-RLTN-IND TO 1                          10040000
100500                 PERFORM N400-MOVE-RELATIONSHIP UNTIL             10050000
100600                                 END-OF-RLTN-CSR OR               10060000
100700                                 VN007-RLTN-IND > 20              10070000
100800                 IF (VN007-RLTN-IND > 20) AND                     10080000
100900                    (NOT-END-OF-RLTN-CSR)                         10090000
101000                    SET VN013-MAX-RLTNSHP-EXCEEDED TO TRUE        10100000
101100                 END-IF                                           10110000
101200              END-IF                                              10120000
101300              PERFORM Y911-CLOSE-RELATIONSHIP-CSR                 10130000
101400              SET VN007-DEPT-IND TO 1                             10140000
101500              PERFORM N100-MOVE-ADD-ADDRESS-PROGS UNTIL           10150000
101600                              END-OF-PROG-ACT-CSR OR              10160000
101700                              PS-DEPT-SEARCH-END                  10170000
101800              PERFORM P100-POPULATE-NON-NULLS                     10180000
101900                           VARYING VN007-DEPT-IND FROM 1 BY 1     10190000
102000                           UNTIL VN007-DEPT-IND > 10              10200000
102100              EXEC CICS LINK PROGRAM (WS-VNKCS024)                10210000
102200                              COMMAREA(VN007-COMMAREA)            10220000
102300                              RESP    (PV-CICS-RESPONSE)          10230000
102400              END-EXEC                                            10240000
102500              IF VN007-NO-ERRORS                                  10250000
102600                 SET VN013-RMS-VENDOR-ADDED                       10260000
102700                     VN013-NO-ERRORS          TO TRUE             10270000
102800              ELSE                                                10280000
102900                 IF VN007-MQ-ERROR                                10290000
103000                    SET VN013-MQ-ERROR        TO TRUE             10300000
103100                    MOVE VN007-PROGRAM-NAME   TO                  10310000
103200                                              VN013-PROGRAM-NAME  10320000
103300                    MOVE VN007-PARAGRAPH-NAME TO                  10330000
103400                                              VN013-PARAGRAPH-NAME10340000
103500                    MOVE VN007-MESSAGE        TO VN013-MESSAGE    10350000
103600                    MOVE VN007-REASON-CODE    TO VN013-SQLCODE    10360000
103700                 END-IF                                           10370000
103800              END-IF                                              10380000
103900           END-IF                                                 10390000
104000           PERFORM Y600-CLOSE-PROGS-ACTIVE-CSR                    10400000
104100        END-IF                                                    10410000
104200        PERFORM Y800-CLOSE-ADDRESS-CSR                            10420000
104300     END-IF.                                                      10430000
104400                                                                  10440000
104500     PERFORM Y500-CLOSE-TERMS-ACTIVE-CSR.                         10450000
104600                                                                  10460000
104700*---------------------------------------------------------------* 10470000
104800*                                                                 10480000
104900*                                                                 10490000
105000*                                                                 10500000
105100*                                                                 10510000
105200*                                                                 10520000
105300*                                                                 10530000
105400*---------------------------------------------------------------* 10540000
105500 C900-PROCESS-UPDT-VNDR-ALLW.                                     10550000
105600                                                                  10560000
105700     MOVE VN013-DEPT-NBR             TO VN007-DEPT-NBR(1).        10570000
105800     PERFORM S500-SELECT-DEPARTMENT-STATUS.                       10580000
105900     MOVE VNDDPT-VND-DEPT-STAT-CD    TO VN007-VND-DEPT-STAT-CD(1).10590000
106000     PERFORM S600-SELECT-TERMS-SPECIFIC.                          10600000
106100     IF SPEC-TERMS-EXIST                                          10610000
106200        MOVE VNDAGR-PAYT-TERM-ID     TO VN007-PAYT-TERM-ID(1)     10620000
106300        MOVE VNDAGR-FRGT-TERM-ID     TO VN007-FRGT-TERM-ID(1)     10630000
106400        PERFORM Y300-OPEN-PROGS-SPECIFIC-CSR                      10640000
106500        PERFORM S300-FETCH-PROGS-SPECIFIC-CSR                     10650000
106600        PERFORM N120-MOVE-SPECIFIC-PROGS-DATA                     10660000
106700                     UNTIL END-OF-PROG-SPEC-CSR                   10670000
106800                        OR EMPTY-PROG-SPEC-CSR                    10680000
106900        PERFORM Y700-CLOSE-PROGS-SPECIFIC-CSR                     10690000
107000        PERFORM P100-POPULATE-NON-NULLS                           10700000
107100                VARYING VN007-DEPT-IND FROM 1 BY 1                10710000
107200                UNTIL VN007-DEPT-IND > 10                         10720000
107300        EXEC CICS LINK PROGRAM (WS-VNKCS024)                      10730000
107400                       COMMAREA(VN007-COMMAREA)                   10740000
107500                       RESP    (PV-CICS-RESPONSE)                 10750000
107600        END-EXEC                                                  10760000
107700        IF VN007-NO-ERRORS                                        10770000
107800           SET VN013-NO-ERRORS          TO TRUE                   10780000
107900        ELSE                                                      10790000
108000           IF VN007-MQ-ERROR                                      10800000
108100              SET VN013-MQ-ERROR        TO TRUE                   10810000
108200              MOVE VN007-PROGRAM-NAME   TO VN013-PROGRAM-NAME     10820000
108300              MOVE VN007-PARAGRAPH-NAME TO VN013-PARAGRAPH-NAME   10830000
108400              MOVE VN007-MESSAGE        TO VN013-MESSAGE          10840000
108500              MOVE VN007-REASON-CODE    TO VN013-SQLCODE          10850000
108600           END-IF                                                 10860000
108700        END-IF                                                    10870000
108800     END-IF.                                                      10880000
108900                                                                  10890000
109000*---------------------------------------------------------------* 10900000
109100*                                                                 10910000
109200*                                                                 10920000
109300*                                                                 10930000
109400*                                                                 10940000
109500*                                                                 10950000
109600*                                                                 10960000
109700*---------------------------------------------------------------* 10970000
109800 M100-MOVE-ADD-ADDRESS-TERMS.                                     10980000
109900     MOVE VNDAGR-DEPT-NBR                                         10990000
110000           TO VN007-DEPT-NBR(VN007-DEPT-IND).                     11000000
110100     MOVE VNDAGR-PAYT-TERM-ID                                     11010000
110200           TO VN007-PAYT-TERM-ID(VN007-DEPT-IND).                 11020000
110300     MOVE VNDAGR-FRGT-TERM-ID                                     11030000
110400           TO VN007-FRGT-TERM-ID(VN007-DEPT-IND).                 11040000
110500     IF VN013-ACTION-DELETE                                       11050000
110600        MOVE 'I' TO VN007-VND-DEPT-STAT-CD(VN007-DEPT-IND)        11060000
110700     ELSE                                                         11070000
110800        MOVE 'A' TO VN007-VND-DEPT-STAT-CD(VN007-DEPT-IND)        11080000
110900     END-IF.                                                      11090000
111000                                                                  11100000
111100     SET VN007-DEPT-IND UP BY 1.                                  11110000
111200     PERFORM S100-FETCH-TERMS-ACTIVE-CSR.                         11120000
111300                                                                  11130000
111400 M200-MOVE-ADD-ADDRESS-ADDL.                                      11140000
111500     MOVE VN013-FUNCTION-ID   TO VN007-FUNCTION-ID(1).            11150000
111600     MOVE VN013-ADDR-SEQ-NBR  TO VN007-ADDR-SEQ-NBR(1).           11160000
111700     MOVE VN013-PRIM-ADDR-IND TO VN007-PRIM-ADDR-IND(1).          11170000
111800     MOVE VN013-CNTRY-CD      TO VN007-CNTRY-CD(1).               11180000
111900     MOVE VN013-ADDR-LINE1    TO VN007-ADDR-LINE1(1).             11190000
112000     MOVE VN013-ADDR-LINE2    TO VN007-ADDR-LINE2(1).             11200000
112100     MOVE VN013-ADDR-LINE3    TO VN007-ADDR-LINE3(1).             11210000
112200     MOVE VN013-CITY          TO VN007-CITY(1).                   11220000
112300     MOVE VN013-ST-PROV-CDE   TO VN007-ST-PROV-CDE(1).            11230000
112400     MOVE VN013-ZIP-CDE       TO VN007-ZIP-CDE(1).                11240000
112500     MOVE VN013-EMAIL-ADD     TO VN007-EMAIL-ADD(1).              11250000
112600     MOVE VN013-CONTACT-NAME  TO VN007-CONTACT-NAME(1).           11260000
112700     MOVE VN013-TEL1-NBR      TO VN007-TEL1-NBR(1).               11270000
112800     MOVE VN013-FAX-NBR       TO VN007-FAX-NBR(1).                11280000
112900     MOVE 'N'                 TO VN007-ADDR-DELETE-IND(1).        11290000
113000                                                                  11300000
113100     PERFORM Y200-OPEN-PROGS-ACTIVE-CSR.                          11310000
113200     PERFORM S200-FETCH-PROGS-ACTIVE-CSR.                         11320000
113300     IF FOUND-PROG-ACT-ROWS                                       11330000
113400        SET VN007-DEPT-IND TO 1                                   11340000
113500        PERFORM N100-MOVE-ADD-ADDRESS-PROGS UNTIL                 11350000
113600                        END-OF-PROG-ACT-CSR OR                    11360000
113700                        PS-DEPT-SEARCH-END                        11370000
113800     END-IF.                                                      11380000
113900     PERFORM Y600-CLOSE-PROGS-ACTIVE-CSR.                         11390000
114000     PERFORM P100-POPULATE-NON-NULLS                              11400000
114100                  VARYING VN007-DEPT-IND FROM 1 BY 1              11410000
114200                  UNTIL VN007-DEPT-IND > 10.                      11420000
114300                                                                  11430000
114400     PERFORM Y400-OPEN-ADDRESS-CSR.                               11440000
114500     PERFORM S400-FETCH-ADDRESS-CSR.                              11450000
114600     IF FOUND-ADDR-ROWS                                           11460000
114700        IF PS-PO-ADDR-FOUND                                       11470000
114800           PERFORM S400-FETCH-ADDRESS-CSR                         11480000
114900        END-IF                                                    11490000
115000        SET VN007-ADDR-IND TO 2                                   11500000
115100        PERFORM N200-MOVE-ADD-ADDRESS-ADDR UNTIL                  11510000
115200                        END-OF-ADDR-CSR OR                        11520000
115300                        VN007-ADDR-IND > 4                        11530000
115400        IF (VN007-ADDR-IND > 4) AND (NOT-END-OF-ADDR-CSR)         11540000
115500           SET VN013-MAX-ADDR-EXCEEDED TO TRUE                    11550000
115600        END-IF                                                    11560000
115700     END-IF.                                                      11570000
115800     PERFORM Y800-CLOSE-ADDRESS-CSR.                              11580000
115900     PERFORM Y900-OPEN-CAPABILITY-CSR.                            11590000
116000     PERFORM S800-FETCH-CAPABILITY-CSR.                           11600000
116100     IF FOUND-CPBL-ROWS                                           11610000
116200        SET VN007-CPBL-IND TO 1                                   11620000
116300        PERFORM N300-MOVE-CAPABILITY UNTIL                        11630000
116400                        END-OF-CPBL-CSR OR                        11640000
116500                        VN007-CPBL-IND > 20                       11650000
116600        IF (VN007-CPBL-IND > 20) AND                              11660000
116700           (NOT-END-OF-CPBL-CSR)                                  11670000
116800           SET VN013-MAX-CPBLTY-EXCEEDED TO TRUE                  11680000
116900        END-IF                                                    11690000
117000     END-IF.                                                      11700000
117100     PERFORM Y901-CLOSE-CAPABILITY-CSR.                           11710000
117200     PERFORM Y910-OPEN-RELATIONSHIP-CSR.                          11720000
117300     PERFORM S810-FETCH-RELATIONSHIP-CSR.                         11730000
117400     IF FOUND-RLTN-ROWS                                           11740000
117500        SET VN007-RLTN-IND TO 1                                   11750000
117600        PERFORM N400-MOVE-RELATIONSHIP UNTIL                      11760000
117700                        END-OF-RLTN-CSR OR                        11770000
117800                        VN007-RLTN-IND > 20                       11780000
117900        IF (VN007-RLTN-IND > 20) AND                              11790000
118000           (NOT-END-OF-RLTN-CSR)                                  11800000
118100           SET VN013-MAX-RLTNSHP-EXCEEDED TO TRUE                 11810000
118200        END-IF                                                    11820000
118300     END-IF.                                                      11830000
118400     PERFORM Y911-CLOSE-RELATIONSHIP-CSR.                         11840000
118500                                                                  11850000
118600     EXEC CICS LINK PROGRAM (WS-VNKCS024)                         11860000
118700                     COMMAREA(VN007-COMMAREA)                     11870000
118800                     RESP    (PV-CICS-RESPONSE)                   11880000
118900     END-EXEC.                                                    11890000
119000                                                                  11900000
119100     IF VN007-NO-ERRORS                                           11910000
119200        SET VN013-RMS-VENDOR-ADDED                                11920000
119300            VN013-NO-ERRORS          TO TRUE                      11930000
119400     ELSE                                                         11940000
119500        IF VN007-MQ-ERROR                                         11950000
119600           SET VN013-MQ-ERROR        TO TRUE                      11960000
119700           MOVE VN007-PROGRAM-NAME   TO VN013-PROGRAM-NAME        11970000
119800           MOVE VN007-PARAGRAPH-NAME TO VN013-PARAGRAPH-NAME      11980000
119900           MOVE VN007-MESSAGE        TO VN013-MESSAGE             11990000
120000           MOVE VN007-REASON-CODE    TO VN013-SQLCODE             12000000
120100        END-IF                                                    12010000
120200     END-IF.                                                      12020000
120300 EJECT                                                            12030000
120400                                                                  12040000
120500*---------------------------------------------------------------* 12050000
120600*                                                                 12060000
120700*                                                                 12070000
120800*                                                                 12080000
120900*                                                                 12090000
121000*                                                                 12100000
121100*                                                                 12110000
121200*---------------------------------------------------------------* 12120000
121300 N100-MOVE-ADD-ADDRESS-PROGS.                                     12130000
121400     SEARCH VN007-DEPARTMENT-FIELDS AT END                        12140000
121500               SET PS-DEPT-SEARCH-END TO TRUE                     12150000
121600         WHEN VNDAGR-DEPT-NBR = VN007-DEPT-NBR(VN007-DEPT-IND)    12160000
121700            PERFORM N110-MOVE-ACTIVE-PROGRAMS-DATA                12170000
121800     END-SEARCH.                                                  12180000
121900                                                                  12190000
122000     PERFORM S200-FETCH-PROGS-ACTIVE-CSR.                         12200000
122100*                                                                 12210000
122200 N110-MOVE-ACTIVE-PROGRAMS-DATA.                                  12220000
122300     EVALUATE TRUE                                                12230000
122400         WHEN VNDAGR-AGRMT-TYP-ID = 4                             12240000
122500             EVALUATE TRUE                                        12250000
122600                 WHEN VNDAGR-TYP-CDE = 1                          12260000
122700                    MOVE VNDAGR-LEADTIME-DAYS-QTY TO              12270000
122800                         VN007-PRETKT-LEADTIME-QTY(VN007-DEPT-IND)12280000
122900                    MOVE VNDAGR-TKT-MKR-IND TO                    12290000
123000                         VN007-TKT-MKR-IND(VN007-DEPT-IND)        12300000
123100                    MOVE VNDAGR-BULK-STK-TKT-IND TO               12310000
123200                         VN007-BULK-STK-TKT-IND(VN007-DEPT-IND)   12320000
123300                 WHEN VNDAGR-TYP-CDE = 2                          12330000
123400                    MOVE 'Y' TO VN007-HANGER-IND(VN007-DEPT-IND)  12340000
123500                 WHEN VNDAGR-TYP-CDE = 4                          12350000
123600                    MOVE 'Y' TO                                   12360000
123700                         VN007-PACK-BY-STR-IND(VN007-DEPT-IND)    12370000
123800             END-EVALUATE                                         12380000
123900         WHEN VNDAGR-AGRMT-TYP-ID = 5                             12390000
124000             EVALUATE TRUE                                        12400000
124100                 WHEN VNDAGR-TYP-CDE = 1                          12410000
124200                    MOVE VNDAGR-DISCOUNT-PCT TO                   12420000
124300                         VN007-NSD-DISC-PCT(VN007-DEPT-IND)       12430000
124400                    MOVE VNDAGR-EXT-PAY-DAYS-QTY TO               12440000
124500                         VN007-NSD-EXT-DAYS-QTY(VN007-DEPT-IND)   12450000
124600                 WHEN VNDAGR-TYP-CDE = 7                          12460000
124700                    MOVE VNDAGR-DISCOUNT-PCT TO                   12470000
124800                         VN007-MOS-DISC-PCT(VN007-DEPT-IND)       12480000
124900                 WHEN VNDAGR-TYP-CDE = 8                          12490000
125000                    MOVE VNDAGR-DISCOUNT-PCT TO                   12500000
125100                         VN007-TRD-DISC-PCT(VN007-DEPT-IND)       12510000
125200                 WHEN VNDAGR-TYP-CDE = 9                          12520000
125300                    MOVE VNDAGR-DISCOUNT-PCT TO                   12530000
125400                         VN007-ADV-DISC-PCT(VN007-DEPT-IND)       12540000
125500                 WHEN VNDAGR-TYP-CDE = 10                         12550000
125600                    MOVE VNDAGR-DISCOUNT-PCT TO                   12560000
125700                         VN007-COOP-DISC-PCT(VN007-DEPT-IND)      12570000
125800                 WHEN VNDAGR-TYP-CDE = 11                         12580000
125900                    MOVE VNDAGR-DISCOUNT-PCT TO                   12590000
126000                       VN007-PRFTASST-ADCOOP-PCT(VN007-DEPT-IND)  12600000
126100                 WHEN VNDAGR-TYP-CDE = 12                         12610000
126200                    MOVE VNDAGR-EXT-PAY-DAYS-QTY TO               12620000
126300                         VN007-TBL-TWR-DAYS-QTY(VN007-DEPT-IND)   12630000
126400                 WHEN VNDAGR-TYP-CDE = 13                         12640000
126500                    MOVE VNDAGR-DISCOUNT-PCT TO                   12650000
126600                         VN007-BRDL-DISC-PCT(VN007-DEPT-IND)      12660000
126700             END-EVALUATE                                         12670000
126800         WHEN VNDAGR-AGRMT-TYP-ID = 6                             12680000
126900             EVALUATE TRUE                                        12690000
127000                 WHEN VNDAGR-TYP-CDE = 5                          12700000
127100                    MOVE VNDAGR-LEADTIME-DAYS-QTY TO              12710000
127200                         VN007-SPLIT-LEADTIME-QTY(VN007-DEPT-IND) 12720000
127300                    IF VNDAGR-LEADTIME-DAYS-QTY = ZERO            12730000
127400                       MOVE 'Y' TO                                12740000
127500                            VN007-SPLIT-REQD-IND(VN007-DEPT-IND)  12750000
127600                    ELSE                                          12760000
127700                       IF VNDAGR-LEADTIME-DAYS-QTY > ZERO         12770000
127800                          MOVE 'N' TO                             12780000
127900                           VN007-SPLIT-REQD-IND(VN007-DEPT-IND)   12790000
128000                       END-IF                                     12800000
128100                    END-IF                                        12810000
128200**               WHEN VNDAGR-TYP-CDE = 6                          12820000
128300**                  MOVE VNDAGR-DISCOUNT-PCT TO                   12830000
128400**                       VN007-COOP-DISC-PCT(VN007-DEPT-IND)      12840000
128500             END-EVALUATE                                         12850000
128600     END-EVALUATE.                                                12860000
128700                                                                  12870000
128800*---------------------------------------------------------------* 12880000
128900*                                                                 12890000
129000*                                                                 12900000
129100*                                                                 12910000
129200*                                                                 12920000
129300*                                                                 12930000
129400*                                                                 12940000
129500*---------------------------------------------------------------* 12950000
129600 N120-MOVE-SPECIFIC-PROGS-DATA.                                   12960000
129700     EVALUATE TRUE                                                12970000
129800         WHEN VNDAGR-AGRMT-TYP-ID = 4                             12980000
129900             EVALUATE TRUE                                        12990000
130000                 WHEN VNDAGR-TYP-CDE = 1                          13000000
130100                    MOVE VNDAGR-LEADTIME-DAYS-QTY TO              13010000
130200                         VN007-PRETKT-LEADTIME-QTY(VN007-DEPT-IND)13020000
130300                    MOVE VNDAGR-TKT-MKR-IND TO                    13030000
130400                         VN007-TKT-MKR-IND(VN007-DEPT-IND)        13040000
130500                    MOVE VNDAGR-BULK-STK-TKT-IND TO               13050000
130600                         VN007-BULK-STK-TKT-IND(VN007-DEPT-IND)   13060000
130700                 WHEN VNDAGR-TYP-CDE = 2                          13070000
130800                    MOVE 'Y' TO VN007-HANGER-IND(VN007-DEPT-IND)  13080000
130900                 WHEN VNDAGR-TYP-CDE = 4                          13090000
131000                    MOVE 'Y' TO                                   13100000
131100                         VN007-PACK-BY-STR-IND(VN007-DEPT-IND)    13110000
131200             END-EVALUATE                                         13120000
131300         WHEN VNDAGR-AGRMT-TYP-ID = 5                             13130000
131400             EVALUATE TRUE                                        13140000
131500                 WHEN VNDAGR-TYP-CDE = 1                          13150000
131600                    MOVE VNDAGR-DISCOUNT-PCT TO                   13160000
131700                         VN007-NSD-DISC-PCT(VN007-DEPT-IND)       13170000
131800                    MOVE VNDAGR-EXT-PAY-DAYS-QTY TO               13180000
131900                         VN007-NSD-EXT-DAYS-QTY(VN007-DEPT-IND)   13190000
132000                 WHEN VNDAGR-TYP-CDE = 7                          13200000
132100                    MOVE VNDAGR-DISCOUNT-PCT TO                   13210000
132200                         VN007-MOS-DISC-PCT(VN007-DEPT-IND)       13220000
132300                 WHEN VNDAGR-TYP-CDE = 8                          13230000
132400                    MOVE VNDAGR-DISCOUNT-PCT TO                   13240000
132500                         VN007-TRD-DISC-PCT(VN007-DEPT-IND)       13250000
132600                 WHEN VNDAGR-TYP-CDE = 9                          13260000
132700                    MOVE VNDAGR-DISCOUNT-PCT TO                   13270000
132800                         VN007-ADV-DISC-PCT(VN007-DEPT-IND)       13280000
132900                 WHEN VNDAGR-TYP-CDE = 10                         13290000
133000                    MOVE VNDAGR-DISCOUNT-PCT TO                   13300000
133100                         VN007-COOP-DISC-PCT(VN007-DEPT-IND)      13310000
133200                 WHEN VNDAGR-TYP-CDE = 11                         13320000
133300                    MOVE VNDAGR-DISCOUNT-PCT TO                   13330000
133400                       VN007-PRFTASST-ADCOOP-PCT(VN007-DEPT-IND)  13340000
133500                 WHEN VNDAGR-TYP-CDE = 12                         13350000
133600                    MOVE VNDAGR-EXT-PAY-DAYS-QTY TO               13360000
133700                         VN007-TBL-TWR-DAYS-QTY(VN007-DEPT-IND)   13370000
133800                 WHEN VNDAGR-TYP-CDE = 13                         13380000
133900                    MOVE VNDAGR-DISCOUNT-PCT TO                   13390000
134000                         VN007-BRDL-DISC-PCT(VN007-DEPT-IND)      13400000
134100             END-EVALUATE                                         13410000
134200         WHEN VNDAGR-AGRMT-TYP-ID = 6                             13420000
134300             EVALUATE TRUE                                        13430000
134400                 WHEN VNDAGR-TYP-CDE = 5                          13440000
134500                    MOVE VNDAGR-LEADTIME-DAYS-QTY TO              13450000
134600                         VN007-SPLIT-LEADTIME-QTY(VN007-DEPT-IND) 13460000
134700                    IF VNDAGR-LEADTIME-DAYS-QTY = ZERO            13470000
134800                       MOVE 'Y' TO                                13480000
134900                            VN007-SPLIT-REQD-IND(VN007-DEPT-IND)  13490000
135000                    ELSE                                          13500000
135100                       IF VNDAGR-LEADTIME-DAYS-QTY > ZERO         13510000
135200                          MOVE 'N' TO                             13520000
135300                           VN007-SPLIT-REQD-IND(VN007-DEPT-IND)   13530000
135400                       END-IF                                     13540000
135500                    END-IF                                        13550000
135600**               WHEN VNDAGR-TYP-CDE = 6                          13560000
135700**                  MOVE VNDAGR-DISCOUNT-PCT TO                   13570000
135800**                       VN007-COOP-DISC-PCT(VN007-DEPT-IND)      13580000
135900             END-EVALUATE                                         13590000
136000     END-EVALUATE.                                                13600000
136100                                                                  13610000
136200     PERFORM S300-FETCH-PROGS-SPECIFIC-CSR.                       13620000
136300                                                                  13630000
136400*---------------------------------------------------------------* 13640000
136500*                                                                 13650000
136600*---------------------------------------------------------------* 13660000
136700**N130-MOVE-DISCOUNT.                                             13670000
136800**   EVALUATE TRUE                                                13680000
136900**       WHEN VNDAGR-AGRMT-TYP-ID = 6                             13690000
137000**           EVALUATE TRUE                                        13700000
137100**               WHEN VNDAGR-TYP-CDE = 6                          13710000
137200**                  MOVE VNDAGR-DISCOUNT-PCT TO                   13720000
137300**                       VN007-COOP-DISC-PCT(1)                   13730000
137400**           END-EVALUATE                                         13740000
137500**   END-EVALUATE.                                                13750000
137600**                                                                13760000
137700**   PERFORM S300-FETCH-PROGS-SPECIFIC-CSR.                       13770000
137800                                                                  13780000
137900*---------------------------------------------------------------* 13790000
138000*                                                                 13800000
138100*                                                                 13810000
138200*                                                                 13820000
138300*                                                                 13830000
138400*                                                                 13840000
138500*                                                                 13850000
138600*---------------------------------------------------------------* 13860000
138700 N200-MOVE-ADD-ADDRESS-ADDR.                                      13870000
138800     MOVE ENTREP-FUNCTION-ID                                      13880000
138900           TO VN007-FUNCTION-ID(VN007-ADDR-IND).                  13890000
139000     MOVE BUSLOC-SEQ-NBR                                          13900000
139100           TO VN007-ADDR-SEQ-NBR(VN007-ADDR-IND).                 13910000
139200     MOVE BUSLOC-PRIM-ADDR-IND                                    13920000
139300           TO VN007-PRIM-ADDR-IND(VN007-ADDR-IND).                13930000
139400     MOVE BUSLOC-CNTRY-CDE                                        13940000
139500           TO VN007-CNTRY-CD(VN007-ADDR-IND).                     13950000
139600     MOVE BUSLOC-ADDRESS-LINE1-DESC                               13960000
139700           TO VN007-ADDR-LINE1(VN007-ADDR-IND).                   13970000
139800     MOVE BUSLOC-ADDRESS-LINE2-DESC                               13980000
139900           TO VN007-ADDR-LINE2(VN007-ADDR-IND).                   13990000
140000     MOVE BUSLOC-ADDRESS-LINE3-DESC                               14000000
140100           TO VN007-ADDR-LINE3(VN007-ADDR-IND).                   14010000
140200     MOVE BUSLOC-CITY-NAME                                        14020000
140300           TO VN007-CITY(VN007-ADDR-IND).                         14030000
140400     MOVE BUSLOC-ST-PROV-CDE                                      14040000
140500           TO VN007-ST-PROV-CDE(VN007-ADDR-IND).                  14050000
140600     MOVE BUSLOC-ZIP-CDE                                          14060000
140700           TO VN007-ZIP-CDE(VN007-ADDR-IND).                      14070000
140800     MOVE ENTREP-EMAIL-ADDR-ID                                    14080000
140900           TO VN007-EMAIL-ADD(VN007-ADDR-IND).                    14090000
141000     STRING ENTREP-FIRST-NAME DELIMITED BY '  '                   14100000
141100            ' '               DELIMITED BY SIZE                   14110000
141200            ENTREP-LAST-NAME  DELIMITED BY '  '                   14120000
141300       INTO VN007-CONTACT-NAME(VN007-ADDR-IND).                   14130000
141400     MOVE ENTREP-TEL1-NBR                                         14140000
141500           TO VN007-TEL1-NBR(VN007-ADDR-IND).                     14150000
141600     MOVE ENTREP-FAX-NBR                                          14160000
141700           TO VN007-FAX-NBR(VN007-ADDR-IND).                      14170000
141800     MOVE 'N'   TO VN007-ADDR-DELETE-IND(VN007-ADDR-IND).         14180000
141900                                                                  14190000
142000     SET VN007-ADDR-IND UP BY 1.                                  14200000
142100     PERFORM S400-FETCH-ADDRESS-CSR.                              14210000
142200                                                                  14220000
142300*---------------------------------------------------------------* 14230000
142400*                                                               * 14240000
142500*---------------------------------------------------------------* 14250000
142600 N300-MOVE-CAPABILITY.                                            14260000
142700     MOVE VNT00001-VND-CPBL-CDE                                   14270000
142800           TO VN007-CPBLTY-CDE(VN007-CPBL-IND).                   14280000
142900     SET VN007-CPBLTY-ADD(VN007-CPBL-IND) TO TRUE.                14290000
143000                                                                  14300000
143100     SET VN007-CPBL-IND UP BY 1.                                  14310000
143200     PERFORM S800-FETCH-CAPABILITY-CSR.                           14320000
143300                                                                  14330000
143400*---------------------------------------------------------------* 14340000
143500*                                                               * 14350000
143600*---------------------------------------------------------------* 14360000
143700 N400-MOVE-RELATIONSHIP.                                          14370000
143800     MOVE VNT00000-VND-RLTNSHP-CDE                                14380000
143900           TO VN007-RLTNSHP-CDE(VN007-RLTN-IND).                  14390000
144000     MOVE VNT00000-RLTD-ENT-ID        TO PV-ENT-ID.               14400000
144100     MOVE PV-ENT-ID                                               14410000
144200           TO VN007-RLTNSHP-ENT-ID(VN007-RLTN-IND).               14420000
144300     SET VN007-RLTNSHP-ADD(VN007-RLTN-IND) TO TRUE.               14430000
144400                                                                  14440000
144500     SET VN007-RLTN-IND UP BY 1.                                  14450000
144600     PERFORM S810-FETCH-RELATIONSHIP-CSR.                         14460000
144700                                                                  14470000
144800*---------------------------------------------------------------* 14480000
144900*                                                                 14490000
145000*                                                                 14500000
145100*                                                                 14510000
145200*                                                                 14520000
145300*                                                                 14530000
145400*                                                                 14540000
145500*---------------------------------------------------------------* 14550000
145600 P100-POPULATE-NON-NULLS.                                         14560000
145700     IF VN007-DEPT-NBR(VN007-DEPT-IND) NOT = SPACES               14570000
145800        IF VN007-BULK-STK-TKT-IND(VN007-DEPT-IND) = SPACE         14580000
145900           MOVE 'N' TO VN007-BULK-STK-TKT-IND(VN007-DEPT-IND)     14590000
146000        END-IF                                                    14600000
146100        IF VN007-TKT-MKR-IND(VN007-DEPT-IND) = SPACE              14610000
146200           MOVE 'N' TO VN007-TKT-MKR-IND(VN007-DEPT-IND)          14620000
146300        END-IF                                                    14630000
146400        IF VN007-HANGER-IND(VN007-DEPT-IND) = SPACE               14640000
146500           MOVE 'N' TO VN007-HANGER-IND(VN007-DEPT-IND)           14650000
146600        END-IF                                                    14660000
146700        IF VN007-PACK-BY-STR-IND(VN007-DEPT-IND) = SPACE          14670000
146800           MOVE 'N' TO VN007-PACK-BY-STR-IND(VN007-DEPT-IND)      14680000
146900        END-IF                                                    14690000
147000        IF VN007-SPLIT-REQD-IND(VN007-DEPT-IND) = SPACE           14700000
147100           MOVE 'N' TO VN007-SPLIT-REQD-IND(VN007-DEPT-IND)       14710000
147200        END-IF                                                    14720000
147300     END-IF.                                                      14730000
147400                                                                  14740000
147500*---------------------------------------------------------------* 14750000
147600*  FETCHES THE TERMS FOR ALL ACTIVE DEPARTMENTS ROWS              14760000
147700*---------------------------------------------------------------* 14770000
147800 S100-FETCH-TERMS-ACTIVE-CSR.                                     14780000
147900     EXEC SQL                                                     14790000
148000         FETCH TERM_ACT_DEPTS_CSR                                 14800000
148100          INTO :VNDAGR-DEPT-NBR                                   14810000
148200             , :VNDAGR-PAYT-TERM-ID                               14820000
148300             , :VNDAGR-FRGT-TERM-ID                               14830000
148400     END-EXEC.                                                    14840000
148500     EVALUATE TRUE                                                14850000
148600         WHEN SQLCODE = ZEROES                                    14860000
148700             SET FOUND-TERMS-ROWS TO TRUE                         14870000
148800         WHEN SQLCODE = +100                                      14880000
148900             IF FOUND-TERMS-ROWS                                  14890000
149000                SET END-OF-TERMS-CSR TO TRUE                      14900000
149100             ELSE                                                 14910000
149200                SET EMPTY-TERMS-CSR TO TRUE                       14920000
149300             END-IF                                               14930000
149400         WHEN OTHER                                               14940000
149500             MOVE 'S100-FETCH-TERM-ACTIVE-CSR'                    14950000
149600                                           TO AA-PARAGRAPH-NAME   14960000
149700             MOVE 'FETCH CURSOR - ACTIVE TERMS'                   14970000
149800                                           TO AA-DB2-OPERATION    14980000
149900             MOVE 'TVNDAGR'                TO AA-DB2-TABLE-1      14990000
150000             MOVE 'TVNDDPT'                TO AA-DB2-TABLE-2      15000000
150100             MOVE '       '                TO AA-DB2-TABLE-3      15010000
150200             PERFORM Z900-DB2-ERROR-ROUTINE                       15020000
150300     END-EVALUATE.                                                15030000
150400 EJECT                                                            15040000
150500                                                                  15050000
150600*---------------------------------------------------------------* 15060000
150700*  FETCHES THE PROGRAMS FOR ALL ACTIVE DEPARTMENTS ROWS           15070000
150800*---------------------------------------------------------------* 15080000
150900 S200-FETCH-PROGS-ACTIVE-CSR.                                     15090000
151000     EXEC SQL                                                     15100000
151100         FETCH PROG_ACT_DEPTS_CSR                                 15110000
151200          INTO :VNDAGR-DEPT-NBR                                   15120000
151300             , :VNDAGR-AGRMT-TYP-ID                               15130000
151400             , :VNDAGR-TYP-CDE                                    15140000
151500             , :VNDAGR-DISCOUNT-PCT                               15150000
151600             , :VNDAGR-EXT-PAY-DAYS-QTY                           15160000
151700             , :VNDAGR-LEADTIME-DAYS-QTY                          15170000
151800             , :VNDAGR-TKT-MKR-IND                                15180000
151900             , :VNDAGR-BULK-STK-TKT-IND                           15190000
152000     END-EXEC.                                                    15200000
152100                                                                  15210000
152200     EVALUATE TRUE                                                15220000
152300         WHEN SQLCODE = ZEROES                                    15230000
152400             SET FOUND-PROG-ACT-ROWS TO TRUE                      15240000
152500         WHEN SQLCODE = +100                                      15250000
152600             IF FOUND-PROG-ACT-ROWS                               15260000
152700                SET END-OF-PROG-ACT-CSR TO TRUE                   15270000
152800             ELSE                                                 15280000
152900                SET EMPTY-PROG-ACT-CSR TO TRUE                    15290000
153000             END-IF                                               15300000
153100         WHEN OTHER                                               15310000
153200             MOVE 'S200-FETCH-PROGS-ACTIVE-CSR'                   15320000
153300                                           TO AA-PARAGRAPH-NAME   15330000
153400             MOVE 'FETCH CURSOR - PROGRAMS ACTIVE'                15340000
153500                                           TO AA-DB2-OPERATION    15350000
153600             MOVE 'TVNDAGR'                TO AA-DB2-TABLE-1      15360000
153700             MOVE 'TVNDDPT'                TO AA-DB2-TABLE-2      15370000
153800             MOVE '       '                TO AA-DB2-TABLE-3      15380000
153900             PERFORM Z900-DB2-ERROR-ROUTINE                       15390000
154000     END-EVALUATE.                                                15400000
154100 EJECT                                                            15410000
154200                                                                  15420000
154300*---------------------------------------------------------------* 15430000
154400*  FETCHES THE PROGRAMS FOR A SPECIFIC DEPARTMENT ROWS            15440000
154500*---------------------------------------------------------------* 15450000
154600 S300-FETCH-PROGS-SPECIFIC-CSR.                                   15460000
154700     EXEC SQL                                                     15470000
154800         FETCH PROG_SPEC_DEPT_CSR                                 15480000
154900          INTO :VNDAGR-AGRMT-TYP-ID                               15490000
155000             , :VNDAGR-TYP-CDE                                    15500000
155100             , :VNDAGR-DISCOUNT-PCT                               15510000
155200             , :VNDAGR-EXT-PAY-DAYS-QTY                           15520000
155300             , :VNDAGR-LEADTIME-DAYS-QTY                          15530000
155400             , :VNDAGR-TKT-MKR-IND                                15540000
155500             , :VNDAGR-BULK-STK-TKT-IND                           15550000
155600     END-EXEC.                                                    15560000
155700                                                                  15570000
155800     EVALUATE TRUE                                                15580000
155900         WHEN SQLCODE = ZEROES                                    15590000
156000             SET FOUND-PROG-SPEC-ROWS TO TRUE                     15600000
156100         WHEN SQLCODE = +100                                      15610000
156200             IF FOUND-PROG-SPEC-ROWS                              15620000
156300                SET END-OF-PROG-SPEC-CSR TO TRUE                  15630000
156400             ELSE                                                 15640000
156500                SET EMPTY-PROG-SPEC-CSR TO TRUE                   15650000
156600             END-IF                                               15660000
156700         WHEN OTHER                                               15670000
156800             MOVE 'S300-FETCH-PROGS-SPECIFIC-CSR'                 15680000
156900                                           TO AA-PARAGRAPH-NAME   15690000
157000             MOVE 'FETCH CURSOR - PROGRAMS SPECIFIC'              15700000
157100                                           TO AA-DB2-OPERATION    15710000
157200             MOVE 'TVNDAGR'                TO AA-DB2-TABLE-1      15720000
157300             MOVE 'TVNDDPT'                TO AA-DB2-TABLE-2      15730000
157400             MOVE '       '                TO AA-DB2-TABLE-3      15740000
157500             PERFORM Z900-DB2-ERROR-ROUTINE                       15750000
157600     END-EVALUATE.                                                15760000
157700 EJECT                                                            15770000
157800                                                                  15780000
157900*---------------------------------------------------------------* 15790000
158000*  FETCHES THE ADDRESS ROWS                                       15800000
158100*---------------------------------------------------------------* 15810000
158200 S400-FETCH-ADDRESS-CSR.                                          15820000
158300     EXEC SQL                                                     15830000
158400         FETCH ADDRESS_CSR                                        15840000
158500          INTO :ENTREP-FUNCTION-ID                                15850000
158600             , :BUSLOC-SEQ-NBR                                    15860000
158700             , :BUSLOC-PRIM-ADDR-IND                              15870000
158800             , :BUSLOC-CNTRY-CDE                                  15880000
158900             , :BUSLOC-ADDRESS-LINE1-DESC                         15890000
159000             , :BUSLOC-ADDRESS-LINE2-DESC                         15900000
159100             , :BUSLOC-ADDRESS-LINE3-DESC                         15910000
159200             , :BUSLOC-CITY-NAME                                  15920000
159300             , :BUSLOC-ST-PROV-CDE                                15930000
159400             , :BUSLOC-ZIP-CDE                                    15940000
159500             , :ENTREP-EMAIL-ADDR-ID                              15950000
159600             , :ENTREP-FIRST-NAME                                 15960000
159700             , :ENTREP-LAST-NAME                                  15970000
159800             , :ENTREP-TEL1-NBR                                   15980000
159900             , :ENTREP-FAX-NBR                                    15990000
160000     END-EXEC.                                                    16000000
160100                                                                  16010000
160200     EVALUATE TRUE                                                16020000
160300         WHEN SQLCODE = ZEROES                                    16030000
160400             SET FOUND-ADDR-ROWS TO TRUE                          16040000
160500             IF (PS-FIRST-ADDR-FETCH) AND (ENTREP-FUNCTION-ID = 2)16050000
160600                SET PS-PO-ADDR-FOUND TO TRUE                      16060000
160700             END-IF                                               16070000
160800             SET PS-NOT-FIRST-ADDR-FETCH TO TRUE                  16080000
160900         WHEN SQLCODE = +100                                      16090000
161000             IF FOUND-ADDR-ROWS                                   16100000
161100                SET END-OF-ADDR-CSR TO TRUE                       16110000
161200             ELSE                                                 16120000
161300                SET EMPTY-ADDR-CSR TO TRUE                        16130000
161400             END-IF                                               16140000
161500         WHEN OTHER                                               16150000
161600             MOVE 'S400-FETCH-ADDRESS-CSR'                        16160000
161700                                           TO AA-PARAGRAPH-NAME   16170000
161800             MOVE 'FETCH CURSOR - ADDRESS'                        16180000
161900                                           TO AA-DB2-OPERATION    16190000
162000             MOVE 'TBUSLOC'                TO AA-DB2-TABLE-1      16200000
162100             MOVE 'TENTREP'                TO AA-DB2-TABLE-2      16210000
162200             MOVE '       '                TO AA-DB2-TABLE-3      16220000
162300             PERFORM Z900-DB2-ERROR-ROUTINE                       16230000
162400     END-EVALUATE.                                                16240000
162500 EJECT                                                            16250000
162600                                                                  16260000
162700*---------------------------------------------------------------* 16270000
162800*  SELECTS THE DEPARTMENT STATUS FOR THE VENDOR/DEPT BEING      * 16280000
162900*  PROCESSED.                                                   * 16290000
163000*---------------------------------------------------------------* 16300000
163100 S500-SELECT-DEPARTMENT-STATUS.                                   16310000
163200     EXEC SQL                                                     16320000
163300         SELECT D.VND_DEPT_STAT_CD                                16330000
163400           INTO :VNDDPT-VND-DEPT-STAT-CD                          16340000
163500           FROM TVNDDPT D                                         16350000
163600          WHERE D.ENT_ID        = :ENT-ID-BEING-PROCESSED         16360000
163700            AND D.DEPT_NBR      = :DEPT-BEING-PROCESSED           16370000
163800     END-EXEC.                                                    16380000
163900                                                                  16390000
164000     EVALUATE TRUE                                                16400000
164100         WHEN SQLCODE = ZEROES                                    16410000
164200             CONTINUE                                             16420000
164300         WHEN OTHER                                               16430000
164400             MOVE 'S500-SELECT-DEPARTMENT-STATUS'                 16440000
164500                                           TO AA-PARAGRAPH-NAME   16450000
164600             MOVE 'SELECT '                TO AA-DB2-OPERATION    16460000
164700             MOVE 'TVNDDPT'                TO AA-DB2-TABLE-1      16470000
164800             MOVE SPACES                   TO AA-DB2-TABLE-2      16480000
164900             MOVE SPACES                   TO AA-DB2-TABLE-3      16490000
165000             PERFORM Z900-DB2-ERROR-ROUTINE                       16500000
165100     END-EVALUATE.                                                16510000
165200 EJECT                                                            16520000
165300                                                                  16530000
165400*---------------------------------------------------------------* 16540000
165500*  SELECTS THE TERMS FOR THE SPECFIC VENDOR/DEPT NUMBER BEING.  * 16550000
165600*  PROCESSED.                                                   * 16560000
165700*---------------------------------------------------------------* 16570000
165800 S600-SELECT-TERMS-SPECIFIC.                                      16580000
165900     EXEC SQL                                                     16590000
166000         SELECT V.PAYT_TERM_ID                                    16600000
166100              , V2.FRGT_TERM_ID                                   16610000
166200           INTO :VNDAGR-PAYT-TERM-ID                              16620000
166300              , :VNDAGR-FRGT-TERM-ID                              16630000
166400           FROM TVNDAGR V                                         16640000
166500              , TVNDAGR V2                                        16650000
166600          WHERE V2.ENT_ID        = V.ENT_ID                       16660000
166700            AND V2.DEPT_NBR      = V.DEPT_NBR                     16670000
166800            AND V.ENT_ID        = :ENT-ID-BEING-PROCESSED         16680000
166900            AND V.DEPT_NBR      = :DEPT-BEING-PROCESSED           16690000
167000            AND V.AGRMT_TYP_ID  IN ('2')                          16700000
167100            AND V.PAYT_TERM_ID  NOT IN (0)                        16710000
167200            AND V.PAYT_TERM_ID  IS NOT NULL                       16720000
167300            AND V2.AGRMT_TYP_ID  IN ('1')                         16730000
167400            AND V2.FRGT_TERM_ID NOT IN (0)                        16740000
167500            AND V2.FRGT_TERM_ID  IS NOT NULL                      16750000
167600            AND V.EXPIRATION_DATE  >  CURRENT_DATE                16760000
167700            AND V.EFFECTIVE_DATE   <= CURRENT_DATE                16770000
167800            AND V2.EXPIRATION_DATE >  CURRENT_DATE                16780000
167900            AND V2.EFFECTIVE_DATE  <= CURRENT_DATE                16790000
168000     END-EXEC.                                                    16800000
168100                                                                  16810000
168200     EVALUATE TRUE                                                16820000
168300         WHEN SQLCODE = ZEROES                                    16830000
168400             SET SPEC-TERMS-EXIST TO TRUE                         16840000
168500         WHEN SQLCODE = +100                                      16850000
168600             SET SPEC-TERMS-NOT-EXIST TO TRUE                     16860000
168700         WHEN OTHER                                               16870000
168800             MOVE 'S600-SELECT-TERMS-SPECIFIC'                    16880000
168900                                           TO AA-PARAGRAPH-NAME   16890000
169000             MOVE 'SELECT '                TO AA-DB2-OPERATION    16900000
169100             MOVE 'TVNDAGR'                TO AA-DB2-TABLE-1      16910000
169200             MOVE SPACES                   TO AA-DB2-TABLE-2      16920000
169300             MOVE SPACES                   TO AA-DB2-TABLE-3      16930000
169400             PERFORM Z900-DB2-ERROR-ROUTINE                       16940000
169500     END-EVALUATE.                                                16950000
169600 EJECT                                                            16960000
169700                                                                  16970000
169800*---------------------------------------------------------------* 16980000
169900*  FETCHES THE VENDOR CAPABILITY ROWS                             16990000
170000*---------------------------------------------------------------* 17000000
170100 S800-FETCH-CAPABILITY-CSR.                                       17010000
170200     EXEC SQL                                                     17020000
170300         FETCH CAPABILITY_CSR                                     17030000
170400          INTO :VNT00001-VND-CPBL-CDE                             17040000
170500     END-EXEC.                                                    17050000
170600                                                                  17060000
170700     EVALUATE TRUE                                                17070000
170800         WHEN SQLCODE = ZEROES                                    17080000
170900             SET FOUND-CPBL-ROWS TO TRUE                          17090000
171000         WHEN SQLCODE = +100                                      17100000
171100             SET END-OF-CPBL-CSR TO TRUE                          17110000
171200         WHEN OTHER                                               17120000
171300             MOVE 'S800-FETCH-CAPABILITY-CSR'                     17130000
171400                                           TO AA-PARAGRAPH-NAME   17140000
171500             MOVE 'FETCH CURSOR - CAPABILITIES'                   17150000
171600                                           TO AA-DB2-OPERATION    17160000
171700             MOVE 'VNT_VND_'               TO AA-DB2-TABLE-1      17170000
171800             MOVE 'CPBL   '                TO AA-DB2-TABLE-2      17180000
171900             MOVE '       '                TO AA-DB2-TABLE-3      17190000
172000             PERFORM Z900-DB2-ERROR-ROUTINE                       17200000
172100     END-EVALUATE.                                                17210000
172200 EJECT                                                            17220000
172300                                                                  17230000
172400*---------------------------------------------------------------* 17240000
172500*  FETCHES THE VENDOR RELATIONSHIP ROWS                           17250000
172600*---------------------------------------------------------------* 17260000
172700 S810-FETCH-RELATIONSHIP-CSR.                                     17270000
172800     EXEC SQL                                                     17280000
172900         FETCH RELATIONSHIP_CSR                                   17290000
173000          INTO :VNT00000-VND-RLTNSHP-CDE                          17300000
173100             , :VNT00000-RLTD-ENT-ID                              17310000
173200     END-EXEC.                                                    17320000
173300                                                                  17330000
173400     EVALUATE TRUE                                                17340000
173500         WHEN SQLCODE = ZEROES                                    17350000
173600             SET FOUND-RLTN-ROWS TO TRUE                          17360000
173700         WHEN SQLCODE = +100                                      17370000
173800             SET END-OF-RLTN-CSR TO TRUE                          17380000
173900         WHEN OTHER                                               17390000
174000             MOVE 'S810-FETCH-RELATIONSHIP-CSR'                   17400000
174100                                           TO AA-PARAGRAPH-NAME   17410000
174200             MOVE 'FETCH CURSOR - RELATIONSHIP'                   17420000
174300                                           TO AA-DB2-OPERATION    17430000
174400             MOVE 'VNT_VND_'               TO AA-DB2-TABLE-1      17440000
174500             MOVE 'RLTNSHP'                TO AA-DB2-TABLE-2      17450000
174600             MOVE '       '                TO AA-DB2-TABLE-3      17460000
174700             PERFORM Z900-DB2-ERROR-ROUTINE                       17470000
174800     END-EVALUATE.                                                17480000
174900 EJECT                                                            17490000
175000                                                                  17500000
175100*---------------------------------------------------------------* 17510000
175200*  OPENS THE TERMS FOR ALL ACTIVE DEPARTMENTS CURSOR            * 17520000
175300*---------------------------------------------------------------* 17530000
175400 Y100-OPEN-TERMS-ACTIVE-CSR.                                      17540000
175500     EXEC SQL                                                     17550000
175600         OPEN TERM_ACT_DEPTS_CSR                                  17560000
175700     END-EXEC.                                                    17570000
175800                                                                  17580000
175900     EVALUATE TRUE                                                17590000
176000         WHEN SQLCODE = ZEROES                                    17600000
176100             CONTINUE                                             17610000
176200         WHEN OTHER                                               17620000
176300             MOVE 'Y100-OPEN-TERMS-ACTIVE-CSR'                    17630000
176400                                           TO AA-PARAGRAPH-NAME   17640000
176500             MOVE 'OPEN CURSOR -TERMS   '  TO AA-DB2-OPERATION    17650000
176600             MOVE 'TVNDAGR'                TO AA-DB2-TABLE-1      17660000
176700             MOVE 'TVNDDPT'                TO AA-DB2-TABLE-2      17670000
176800             MOVE '       '                TO AA-DB2-TABLE-3      17680000
176900             PERFORM Z900-DB2-ERROR-ROUTINE                       17690000
177000     END-EVALUATE.                                                17700000
177100 EJECT                                                            17710000
177200                                                                  17720000
177300*---------------------------------------------------------------* 17730000
177400*  OPENS THE PROGRAMS FOR ALL ACTIVE DEPARTMENTS CURSOR         * 17740000
177500*---------------------------------------------------------------* 17750000
177600 Y200-OPEN-PROGS-ACTIVE-CSR.                                      17760000
177700     EXEC SQL                                                     17770000
177800         OPEN PROG_ACT_DEPTS_CSR                                  17780000
177900     END-EXEC.                                                    17790000
178000                                                                  17800000
178100     EVALUATE TRUE                                                17810000
178200         WHEN SQLCODE = ZEROES                                    17820000
178300             CONTINUE                                             17830000
178400         WHEN OTHER                                               17840000
178500             MOVE 'Y200-OPEN-PROGS-ACTIVE-CSR'                    17850000
178600                                           TO AA-PARAGRAPH-NAME   17860000
178700             MOVE 'OPEN CURSOR - PROGRAMS' TO AA-DB2-OPERATION    17870000
178800             MOVE 'TVNDAGR'                TO AA-DB2-TABLE-1      17880000
178900             MOVE 'TVNDDPT'                TO AA-DB2-TABLE-2      17890000
179000             MOVE '       '                TO AA-DB2-TABLE-3      17900000
179100             PERFORM Z900-DB2-ERROR-ROUTINE                       17910000
179200     END-EVALUATE.                                                17920000
179300 EJECT                                                            17930000
179400                                                                  17940000
179500*---------------------------------------------------------------* 17950000
179600*  OPENS THE PROGRAMS FOR A SPECIFIC DEPARTMENT CURSOR          * 17960000
179700*---------------------------------------------------------------* 17970000
179800 Y300-OPEN-PROGS-SPECIFIC-CSR.                                    17980000
179900     EXEC SQL                                                     17990000
180000         OPEN PROG_SPEC_DEPT_CSR                                  18000000
180100     END-EXEC.                                                    18010000
180200                                                                  18020000
180300     EVALUATE TRUE                                                18030000
180400         WHEN SQLCODE = ZEROES                                    18040000
180500             CONTINUE                                             18050000
180600         WHEN OTHER                                               18060000
180700             MOVE 'Y300-OPEN-PROGS-SPECIFIC-CSR'                  18070000
180800                                           TO AA-PARAGRAPH-NAME   18080000
180900             MOVE 'OPEN CURSOR - PROGRAMS' TO AA-DB2-OPERATION    18090000
181000             MOVE 'TVNDAGR'                TO AA-DB2-TABLE-1      18100000
181100             MOVE 'TVNDDPT'                TO AA-DB2-TABLE-2      18110000
181200             MOVE '       '                TO AA-DB2-TABLE-3      18120000
181300             PERFORM Z900-DB2-ERROR-ROUTINE                       18130000
181400     END-EVALUATE.                                                18140000
181500 EJECT                                                            18150000
181600                                                                  18160000
181700*---------------------------------------------------------------* 18170000
181800*  OPENS THE ADDRESS CURSOR                                     * 18180000
181900*---------------------------------------------------------------* 18190000
182000 Y400-OPEN-ADDRESS-CSR.                                           18200000
182100     EXEC SQL                                                     18210000
182200         OPEN ADDRESS_CSR                                         18220000
182300     END-EXEC.                                                    18230000
182400                                                                  18240000
182500     EVALUATE TRUE                                                18250000
182600         WHEN SQLCODE = ZEROES                                    18260000
182700             CONTINUE                                             18270000
182800         WHEN OTHER                                               18280000
182900             MOVE 'Y400-OPEN-ADDRESS-CSR'                         18290000
183000                                           TO AA-PARAGRAPH-NAME   18300000
183100             MOVE 'OPEN CURSOR - ADDRESS ' TO AA-DB2-OPERATION    18310000
183200             MOVE 'TBUSLOC'                TO AA-DB2-TABLE-1      18320000
183300             MOVE 'TENTREP'                TO AA-DB2-TABLE-2      18330000
183400             MOVE '       '                TO AA-DB2-TABLE-3      18340000
183500             PERFORM Z900-DB2-ERROR-ROUTINE                       18350000
183600     END-EVALUATE.                                                18360000
183700 EJECT                                                            18370000
183800                                                                  18380000
183900*---------------------------------------------------------------* 18390000
184000*  CLOSES THE TERMS FOR ALL ACTIVE DEPARTMENTS CURSOR           * 18400000
184100*---------------------------------------------------------------* 18410000
184200 Y500-CLOSE-TERMS-ACTIVE-CSR.                                     18420000
184300     EXEC SQL                                                     18430000
184400         CLOSE TERM_ACT_DEPTS_CSR                                 18440000
184500     END-EXEC.                                                    18450000
184600                                                                  18460000
184700     EVALUATE TRUE                                                18470000
184800         WHEN SQLCODE = ZEROES                                    18480000
184900             CONTINUE                                             18490000
185000         WHEN OTHER                                               18500000
185100             MOVE 'Y500-CLOSE-TERMS-ACTIVE-CSR'                   18510000
185200                                           TO AA-PARAGRAPH-NAME   18520000
185300             MOVE 'CLOSE CURSOR - TERMS  ' TO AA-DB2-OPERATION    18530000
185400             MOVE 'TVNDAGR'                TO AA-DB2-TABLE-1      18540000
185500             MOVE 'TVNDDPT'                TO AA-DB2-TABLE-2      18550000
185600             MOVE '       '                TO AA-DB2-TABLE-3      18560000
185700             PERFORM Z900-DB2-ERROR-ROUTINE                       18570000
185800     END-EVALUATE.                                                18580000
185900 EJECT                                                            18590000
186000                                                                  18600000
186100*---------------------------------------------------------------* 18610000
186200*  CLOSES THE PROGRAMS FOR ALL ACTIVE DEPARTMENTS CURSOR        * 18620000
186300*---------------------------------------------------------------* 18630000
186400 Y600-CLOSE-PROGS-ACTIVE-CSR.                                     18640000
186500     EXEC SQL                                                     18650000
186600         CLOSE PROG_ACT_DEPTS_CSR                                 18660000
186700     END-EXEC.                                                    18670000
186800                                                                  18680000
186900     EVALUATE TRUE                                                18690000
187000         WHEN SQLCODE = ZEROES                                    18700000
187100             CONTINUE                                             18710000
187200         WHEN OTHER                                               18720000
187300             MOVE 'Y600-CLOSE-PROGS-ACTIVE-CSR'                   18730000
187400                                            TO AA-PARAGRAPH-NAME  18740000
187500             MOVE 'CLOSE CURSOR - PROGRAMS' TO AA-DB2-OPERATION   18750000
187600             MOVE 'TVNDAGR'                 TO AA-DB2-TABLE-1     18760000
187700             MOVE 'TVNDDPT'                 TO AA-DB2-TABLE-2     18770000
187800             MOVE '       '                 TO AA-DB2-TABLE-3     18780000
187900             PERFORM Z900-DB2-ERROR-ROUTINE                       18790000
188000     END-EVALUATE.                                                18800000
188100 EJECT                                                            18810000
188200                                                                  18820000
188300*---------------------------------------------------------------* 18830000
188400*  CLOSES THE PROGRAMS FOR A SPECIFIC DEPARTMENT CURSOR         * 18840000
188500*---------------------------------------------------------------* 18850000
188600 Y700-CLOSE-PROGS-SPECIFIC-CSR.                                   18860000
188700     EXEC SQL                                                     18870000
188800         CLOSE PROG_SPEC_DEPT_CSR                                 18880000
188900     END-EXEC.                                                    18890000
189000                                                                  18900000
189100     EVALUATE TRUE                                                18910000
189200         WHEN SQLCODE = ZEROES                                    18920000
189300             CONTINUE                                             18930000
189400         WHEN OTHER                                               18940000
189500             MOVE 'Y700-CLOSE-PROGS-SPECIFIC-CSR'                 18950000
189600                                            TO AA-PARAGRAPH-NAME  18960000
189700             MOVE 'CLOSE CURSOR - PROGRAMS' TO AA-DB2-OPERATION   18970000
189800             MOVE 'TVNDAGR'                 TO AA-DB2-TABLE-1     18980000
189900             MOVE 'TVNDDPT'                 TO AA-DB2-TABLE-2     18990000
190000             MOVE '       '                 TO AA-DB2-TABLE-3     19000000
190100             PERFORM Z900-DB2-ERROR-ROUTINE                       19010000
190200     END-EVALUATE.                                                19020000
190300 EJECT                                                            19030000
190400                                                                  19040000
190500*---------------------------------------------------------------* 19050000
190600*  CLOSES THE ADDRESS CURSOR                                    * 19060000
190700*---------------------------------------------------------------* 19070000
190800 Y800-CLOSE-ADDRESS-CSR.                                          19080000
190900     EXEC SQL                                                     19090000
191000         CLOSE ADDRESS_CSR                                        19100000
191100     END-EXEC.                                                    19110000
191200                                                                  19120000
191300     EVALUATE TRUE                                                19130000
191400         WHEN SQLCODE = ZEROES                                    19140000
191500             CONTINUE                                             19150000
191600         WHEN OTHER                                               19160000
191700             MOVE 'Y800-CLOSE-ADDRESS-CSR'                        19170000
191800                                            TO AA-PARAGRAPH-NAME  19180000
191900             MOVE 'CLOSE CURSOR - ADDRESS ' TO AA-DB2-OPERATION   19190000
192000             MOVE 'TBUSLOC'                 TO AA-DB2-TABLE-1     19200000
192100             MOVE 'TENTREP'                 TO AA-DB2-TABLE-2     19210000
192200             MOVE '       '                 TO AA-DB2-TABLE-3     19220000
192300             PERFORM Z900-DB2-ERROR-ROUTINE                       19230000
192400     END-EVALUATE.                                                19240000
192500 EJECT                                                            19250000
192600                                                                  19260000
192700*---------------------------------------------------------------* 19270000
192800*  OPENS THE VENDOR CAPABILITIES CURSOR                         * 19280000
192900*---------------------------------------------------------------* 19290000
193000 Y900-OPEN-CAPABILITY-CSR.                                        19300000
193100     EXEC SQL                                                     19310000
193200         OPEN CAPABILITY_CSR                                      19320000
193300     END-EXEC.                                                    19330000
193400                                                                  19340000
193500     EVALUATE TRUE                                                19350000
193600         WHEN SQLCODE = ZEROES                                    19360000
193700             CONTINUE                                             19370000
193800         WHEN OTHER                                               19380000
193900             MOVE 'Y900-OPEN-CAPABILITY-CSR'                      19390000
194000                                           TO AA-PARAGRAPH-NAME   19400000
194100             MOVE 'OPEN CURSOR - CPBLTY '  TO AA-DB2-OPERATION    19410000
194200             MOVE 'VNT_VND_'               TO AA-DB2-TABLE-1      19420000
194300             MOVE 'CPBL    '               TO AA-DB2-TABLE-2      19430000
194400             MOVE '       '                TO AA-DB2-TABLE-3      19440000
194500             PERFORM Z900-DB2-ERROR-ROUTINE                       19450000
194600     END-EVALUATE.                                                19460000
194700 EJECT                                                            19470000
194800                                                                  19480000
194900*---------------------------------------------------------------* 19490000
195000*  CLOSES THE VENDOR CAPABILITIES CURSOR                        * 19500000
195100*---------------------------------------------------------------* 19510000
195200 Y901-CLOSE-CAPABILITY-CSR.                                       19520000
195300     EXEC SQL                                                     19530000
195400         CLOSE CAPABILITY_CSR                                     19540000
195500     END-EXEC.                                                    19550000
195600                                                                  19560000
195700     EVALUATE TRUE                                                19570000
195800         WHEN SQLCODE = ZEROES                                    19580000
195900             CONTINUE                                             19590000
196000         WHEN OTHER                                               19600000
196100             MOVE 'Y901-CLOSE-CAPABILITY-CSR'                     19610000
196200                                           TO AA-PARAGRAPH-NAME   19620000
196300             MOVE 'CLOSE CURSOR - CPBLTY ' TO AA-DB2-OPERATION    19630000
196400             MOVE 'VNT_VND_'               TO AA-DB2-TABLE-1      19640000
196500             MOVE 'CPBL    '               TO AA-DB2-TABLE-2      19650000
196600             MOVE '       '                TO AA-DB2-TABLE-3      19660000
196700             PERFORM Z900-DB2-ERROR-ROUTINE                       19670000
196800     END-EVALUATE.                                                19680000
196900 EJECT                                                            19690000
197000                                                                  19700000
197100*---------------------------------------------------------------* 19710000
197200*  OPENS THE VENDOR RELATIONSHIP CURSOR                         * 19720000
197300*---------------------------------------------------------------* 19730000
197400 Y910-OPEN-RELATIONSHIP-CSR.                                      19740000
197500     EXEC SQL                                                     19750000
197600         OPEN RELATIONSHIP_CSR                                    19760000
197700     END-EXEC.                                                    19770000
197800                                                                  19780000
197900     EVALUATE TRUE                                                19790000
198000         WHEN SQLCODE = ZEROES                                    19800000
198100             CONTINUE                                             19810000
198200         WHEN OTHER                                               19820000
198300             MOVE 'Y910-OPEN-RELATIONSHIP-CSR'                    19830000
198400                                           TO AA-PARAGRAPH-NAME   19840000
198500             MOVE 'OPEN CURSOR - RLTNSHP'  TO AA-DB2-OPERATION    19850000
198600             MOVE 'VNT_VND_'               TO AA-DB2-TABLE-1      19860000
198700             MOVE 'RLTNSHP '               TO AA-DB2-TABLE-2      19870000
198800             MOVE '       '                TO AA-DB2-TABLE-3      19880000
198900             PERFORM Z900-DB2-ERROR-ROUTINE                       19890000
199000     END-EVALUATE.                                                19900000
199100 EJECT                                                            19910000
199200                                                                  19920000
199300*---------------------------------------------------------------* 19930000
199400*  CLOSES THE VENDOR RELATIONSHIP CURSOR                        * 19940000
199500*---------------------------------------------------------------* 19950000
199600 Y911-CLOSE-RELATIONSHIP-CSR.                                     19960000
199700     EXEC SQL                                                     19970000
199800         CLOSE RELATIONSHIP_CSR                                   19980000
199900     END-EXEC.                                                    19990000
200000                                                                  20000000
200100     EVALUATE TRUE                                                20010000
200200         WHEN SQLCODE = ZEROES                                    20020000
200300             CONTINUE                                             20030000
200400         WHEN OTHER                                               20040000
200500             MOVE 'Y911-CLOSE-RELATIONSHIP-CSR'                   20050000
200600                                           TO AA-PARAGRAPH-NAME   20060000
200700             MOVE 'CLOSE CURSOR - RLTNSHP' TO AA-DB2-OPERATION    20070000
200800             MOVE 'VNT_VND_'               TO AA-DB2-TABLE-1      20080000
200900             MOVE 'RLTNSHP '               TO AA-DB2-TABLE-2      20090000
201000             MOVE '       '                TO AA-DB2-TABLE-3      20100000
201100             PERFORM Z900-DB2-ERROR-ROUTINE                       20110000
201200     END-EVALUATE.                                                20120000
201300 EJECT                                                            20130000
201400                                                                  20140000
201500*--------------------------------------------------------------*  20150000
201600*     DB2 ERROR ROUTINE                                        *  20160000
201700*--------------------------------------------------------------*  20170000
201800 Z900-DB2-ERROR-ROUTINE.                                          20180000
201900                                                                  20190000
202000     SET VN013-DB-ERROR    TO TRUE.                               20200000
202100     MOVE AA-PROGRAM-LIT   TO VN013-PROGRAM-NAME.                 20210000
202200     MOVE AA-PARAGRAPH-LIT TO VN013-PARAGRAPH-NAME.               20220000
202300     MOVE AA-DB2-ERROR-LIT TO VN013-MESSAGE.                      20230000
202400     MOVE SQLCODE          TO VN013-SQLCODE.                      20240000
202500*                                                                 20250000
202600     EXEC CICS                                                    20260000
202700         ENQ                                                      20270000
202800             RESOURCE (PC-LOG-QUEUE-RESOURCE)                     20280000
202900     END-EXEC.                                                    20290000
203000*                                                                 20300000
203100     MOVE AA-DB2-ERROR-LIT         TO PV-LOG-LINE.                20310000
203200     PERFORM Z910-LOG-ERROR.                                      20320000
203300     MOVE AA-PROGRAM-LIT           TO PV-LOG-LINE.                20330000
203400     PERFORM Z910-LOG-ERROR.                                      20340000
203500     MOVE AA-PARAGRAPH-LIT         TO PV-LOG-LINE.                20350000
203600     PERFORM Z910-LOG-ERROR.                                      20360000
203700     MOVE AA-DB2-OPERATION-LIT     TO PV-LOG-LINE.                20370000
203800     PERFORM Z910-LOG-ERROR.                                      20380000
203900     MOVE AA-DB2-TABLE-1           TO PV-LOG-LINE.                20390000
204000     PERFORM Z910-LOG-ERROR.                                      20400000
204100     MOVE AA-DB2-TABLE-2           TO PV-LOG-LINE.                20410000
204200     PERFORM Z910-LOG-ERROR.                                      20420000
204300     MOVE AA-DB2-TABLE-3           TO PV-LOG-LINE.                20430000
204400     PERFORM Z910-LOG-ERROR.                                      20440000
204500*                                                                 20450000
204600     EXEC CICS                                                    20460000
204700         DEQ                                                      20470000
204800             RESOURCE (PC-LOG-QUEUE-RESOURCE)                     20480000
204900     END-EXEC.                                                    20490000
205000*                                                                 20500000
205100                                                                  20510000
205200                                                                  20520000
205300*--------------------------------------------------------------*  20530000
205400*     LOG DISPLAY MESSAGES TO CSSL                             *  20540000
205500*--------------------------------------------------------------*  20550000
205600 Z910-LOG-ERROR.                                                  20560000
205700                                                                  20570000
205800*                                                                 20580000
205900     EXEC CICS                                                    20590000
206000         WRITEQ TD                                                20600000
206100             QUEUE (PC-LOG-QUEUE)                                 20610000
206200             FROM  (PV-LOG-LINE)                                  20620000
206300             RESP  (PV-CICS-RESPONSE)                             20630000
206400     END-EXEC.                                                    20640000
206500     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       20650000
206600         CONTINUE                                                 20660000
206700     ELSE                                                         20670000
206800         EXEC CICS                                                20680000
206900             ABEND                                                20690000
207000                 ABCODE (EIBTRMID)                                20700000
207100         END-EXEC                                                 20710000
207200     END-IF.                                                      20720000
207300*                                                                 20730000
207310*----------------------------------------------------------------*20731000
207320*                                                                 20732000
207330*----------------------------------------------------------------*20733000
207340 Z9990-WRITE-CICS.                                                20734000
207350         STRING  ' VNKCS023-ADD'           DELIMITED BY SIZE      20735000
207360                 ' ENT ID '                DELIMITED BY SIZE      20736000
207370                 PV-DISP-ENT-ID            DELIMITED BY SIZE      20737000
207380                 ' PREPK-CDE '             DELIMITED BY SIZE      20738003
207390                 PV-DISP-PO-PREPK-CDE      DELIMITED BY SIZE      20739000
207397                 ' TYPE CDE '              DELIMITED BY SIZE      20739703
207398                 PV-DISP-PRIM-TYP-CDE      DELIMITED BY SIZE      20739800
207399                 ' STAT CDE '              DELIMITED BY SIZE      20739903
207400                 PV-DISP-STATUS-CDE        DELIMITED BY SIZE      20740000
207421                 ' RMS-IND '               DELIMITED BY SIZE      20742103
207422                 PV-DISP-VND-IN-RMS-IND    DELIMITED BY SIZE      20742200
207423                 ' ENT NAME '              DELIMITED BY SIZE      20742303
207424                 PV-DISP-ENT-NAME-DESC     DELIMITED BY SIZE      20742400
207430                                      INTO PV-CICS-MSG-AREA       20743000
207440     MOVE LENGTH OF PV-CICS-MSG-AREA  TO  PV-COMMAREA-LENGTH.     20744000
207450                                                                  20745000
207460     EXEC CICS WRITEQ TD                                          20746000
207470                      QUEUE('CSSL')                               20747000
207480                      FROM(PV-CICS-MSG-AREA)                      20748000
207490                      LENGTH(PV-COMMAREA-LENGTH)                  20749000
207491                      RESP (PV-CICS-RESPONSE2)                    20749102
207492     END-EXEC.                                                    20749200
207493                                                                  20749300
207494     MOVE SPACES TO PV-CICS-MSG-AREA.                             20749400
207495*                                                                 20749500
207500*    COPY DPPD004.                                                20750000
