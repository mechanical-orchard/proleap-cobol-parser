000100*-----------------------*                                         00010069
000200 IDENTIFICATION DIVISION.                                         00020069
000300*-----------------------*                                         00030069
000400 PROGRAM-ID.    PCKCS700.                                         00040069
000500 AUTHOR.        DENISE HAHN.                                      00050069
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060069
000700 DATE-WRITTEN.  05-06-98.                                         00070069
000800 DATE-COMPILED.                                                   00080069
000900*----------------------------------------------------------------*00090069
001000*    E700 - P2L/CASEPACK SPLIT CRITERIA SPECIFICATION            *00100069
001100*                                                                *00110069
001200*    THIS PROGRAM ALLOWS THE USER TO KEY IN THE PO/RECEIVER      *00120069
001300*    (AND LINE NUMBER WHICH IS OPTIONAL) TO SET-UP THE LISTING   *00130069
001400*    CRITERIA FOR THE LINES TO BE DISPLAYED ON THE NEXT SCREEN.  *00140069
001500*                                                                *00150069
001600*                                                                *00160069
001700*                                                                *00170069
001800*----------------------------------------------------------------*00180069
001810* DATE  11/04/2021                                                00181099
001820*            - CHANGE CALL OF 'DPKUT100' TO                     * 00182099
001830*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00183099
001840*              MAKING THE CALL DYNAMIC VS STATIC                * 00184099
001850*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00185099
001860*-----------------------------------------------------------------00185199
1122RM* DATE  11/07/2022                                              * 00185299
1122RM*            - ADD COPYBOOK DPWS930                             * 00185399
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00185499
1122RM*              DYNAMIC.                                         * 00185599
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00185699
001860*-----------------------------------------------------------------00186099
001900                                                                  00190069
002000                                                                  00200069
002100                                                                  00210069
002200 ENVIRONMENT DIVISION.                                            00220069
002300                                                                  00230069
002400                                                                  00240069
002500 DATA DIVISION.                                                   00250069
002600                                                                  00260069
002700                                                                  00270069
002800 WORKING-STORAGE SECTION.                                         00280069
002900                                                                  00290069
003000                                                                  00300069
003100*----------------------------------------------------------------*00310069
003200*   PROGRAM CONSTANTS                                            *00320069
003300*----------------------------------------------------------------*00330069
003400 01  PC-PROGRAM-CONSTANTS.                                        00340069
003500     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'PC700A  '. 00350069
003600     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'PCKM700 '. 00360069
003700     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'PCKCS700'. 00370069
003701     05  PC-AUTOVE-DETERMIN-PGM    PIC  X(08)  VALUE  'RCKUT127'. 00370199
003800     05  PC-ZEROES                 PIC S9(03)  VALUE  +0.         00380069
003900     05  PC-ONE                    PIC S9(03)  VALUE  +1.         00390069
004000     05  PC-F23                    PIC  9(02)  VALUE  23.         00400069
004100     05  PC-90                     PIC  9(02)  VALUE  90.         00410069
004200     05  PC-BOTH                   PIC  X(01)  VALUE  'B'.        00420069
004300     05  PC-SHUFFLED               PIC  X(01)  VALUE  'S'.        00430069
004400     05  PC-MAX-RETRIES            PIC S9(04)  VALUE  +2.         00440069
004500     05  PC-REPORT-PGM-1           PIC  X(08)  VALUE 'PCKCS126'.  00450069
004600     05  PC-REPORT-PGM-2           PIC  X(08)  VALUE 'PCKCS123'.  00460069
004700     05  PC-01                     PIC  X(02)  VALUE '01'.        00470069
004800     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE 'DPKCS060'.  00480069
004900     05  PC-FCLTY-ID-0001          PIC  9(04)  VALUE  0001.       00490069
005000     05  PC-A                           PIC  X(01)  VALUE 'A'.    00500069
005100     05  PC-F                           PIC  X(01)  VALUE 'F'.    00510069
005200     05  PC-I                           PIC  X(01)  VALUE 'I'.    00520069
005210     05  PC-U                           PIC  X(01)  VALUE 'U'.    00521069
005220     05  PC-MGMX                        PIC  X(04)  VALUE 'MGMX'. 00522069
005230     05  PC-N                           PIC  X(01)  VALUE 'N'.    00523069
005240     05  PC-M                           PIC  X(01)  VALUE 'M'.    00524069
005250     05  PC-Y                           PIC  X(01)  VALUE 'Y'.    00525069
005260     05  PC-DEFAULT-TIMESTAMP           PIC  X(26)  VALUE         00526069
005270                                  '9999-09-09-09.09.09.999999'.   00527069
005280*                                                                 00528069
005290     05  PC-PGBK-LABEL-PRTR        PIC  X(01)  VALUE  'P'.        00529069
005300     05  PC-PGBK-LABEL-PRTR-SYSTEC PIC  X(01)  VALUE  'R'.        00530069
005400     05  PC-PGBK-LABEL-PRTR-TRACE  PIC  X(01)  VALUE  'T'.        00540069
005500     05  PC-SHIP-MFST-PRTR-SYSTEC  PIC  X(01)  VALUE  'M'.        00550069
005600     05  PC-SHIP-MFST-PRTR         PIC  X(01)  VALUE  'S'.        00560069
005700     05  PC-SHIP-MFST-PRTR-LOG     PIC  X(01)  VALUE  'L'.        00570069
005800                                                                  00580069
005900     05  PC-LIST-QUEUE-SEQ         PIC 9       VALUE 1.           00590069
006000     05  PC-SEL-QUEUE-SEQ          PIC 9       VALUE 2.           00600069
006100     05  PC-INTER-APPL-CODES.                                     00610069
006200         10  PC-INTER-APPL-CODE-1  PIC X(01)   VALUE ' '.         00620069
006300         10  PC-INTER-APPL-RC-TRLR PIC X(01)   VALUE '2'.         00630069
006400     05  PC-INTER-APPL-SU-PORCV    PIC X(01)   VALUE '3'.         00640069
006500     05  PC-INNER-PREPACK          PIC X(06)   VALUE 'INPRPK'.    00650069
006600     05  PC-MULTI-SKU              PIC X(06)   VALUE 'MLTSKU'.    00660069
006700     05  PC-SINGLE-SKU             PIC X(06)   VALUE 'SGLSKU'.    00670069
006800     05  PC-CASEPACK               PIC X(06)   VALUE 'CASEPK'.    00680069
006900     05  PC-BULK                   PIC X(06)   VALUE 'BULK  '.    00690069
007000     05  PC-DEFAULT-TMST           PIC X(26)   VALUE              00700069
007100                     '9999-09-09-09.09.09.999999'.                00710069
007110     05  PC-CASE-PROCESS-ONLY      PIC X(01)   VALUE 'C'.         00711069
007111     05  PC-STR-ZONE               PIC X(09)   VALUE 'STR ZONE:'. 00711189
007112     05  PC-PO-SET                 PIC X(09)   VALUE '  PO SET:'. 00711289
007120                                                                  00712069
007130*----------------------------------------------------------------*00713069
007140*   PROGRAM VARIABLES                                            *00714069
007150*----------------------------------------------------------------*00715069
007160 01  PV-PROGRAM-VARIABLES.                                        00716069
007170     05  PV-OPER-FCLTY-HOLD.                                      00717069
007180         10  PV-OPER-UNT-HOLD      PIC  9(04)  VALUE ZEROES.      00718069
007190         10  FILLER                PIC  X(01)  VALUE '-'.         00719069
007200         10  PV-FCLTY-ID-HOLD      PIC  9(04)  VALUE ZEROES.      00720069
007300     05  PV-CURR-OPER-FCLTY-HOLD.                                 00730069
007400         10  PV-CURR-OPER-UNT-HOLD PIC  9(04)  VALUE ZEROES.      00740069
007500         10  FILLER                PIC  X(01)  VALUE '-'.         00750069
007600         10  PV-CURR-FCLTY-ID-HOLD PIC  9(04)  VALUE ZEROES.      00760069
007700     05  PV-RETRY-COUNT            PIC S9(04)  VALUE ZERO         00770069
007800                                   COMP SYNC.                     00780069
007900     05  PV-FCLTY-NME              PIC  X(24)  VALUE SPACES.      00790069
008000     05  PV-HOLD-MOD               PIC S9(04)  COMP.              00800069
008100     05  PV-LINE-STATUS            PIC  X(08)  VALUE SPACES.      00810069
008200     05  PV-CICS-RESP              PIC S9(08)  VALUE ZEROES       00820069
008300                                   COMP SYNC.                     00830069
008400     05  PV-CICS-RESPONSE          PIC S9(08)  VALUE ZEROES       00840069
008500                                   COMP SYNC.                     00850069
008600     05  PV-STORE-DIST-COUNT       PIC S9(09)  COMP.              00860069
008700     05  PV-IN-OUT-PK-RESULT       PIC S9(04)  VALUE ZEROES.      00870069
008800     05  PV-IN-OUT-REMAINDER       PIC S9(04)  VALUE ZEROES.      00880069
008810                                                                  00881077
008820     05 PV-CURRENT-DB2-DATE              PIC X(10)   VALUE SPACES.00882077
008830     05 PV-CURRENT-DB2-DATE-R REDEFINES PV-CURRENT-DB2-DATE.      00883077
008840         10 PV-CURRENT-CCYY              PIC  9(04).              00884077
008850         10 FILLER                       PIC  X(01).              00885077
008860         10 PV-CURRENT-MM-DD             PIC  9(05).              00886077
008870                                                                  00887077
008900     05  PV-DEFAULT-TMST           PIC  X(26)  VALUE              00890069
009000         '9999-09-09-09.09.09.999999'.                            00900069
009100     05  PV-CREATE-LABEL-OPTION    PIC  X(01)  VALUE SPACE.       00910069
009200         88 PV-VALID-LABEL-OPT                 VALUE 'B' 'P'      00920069
009300                                                     'C'.         00930069
009400         88 PV-CASEPACK-SHIP-ONLY              VALUE 'C'.         00940069
009500     05  PV-PRINT-ORDER            PIC  X(01)  VALUE SPACE.       00950069
009600         88 PV-VALID-PRINT-ORDER               VALUE 'R' 'S' 'D'. 00960099
009700     05  PV-RECITM-ORD-NBR         PIC S9(09)  COMP.              00970069
009800     05  PV-RECITM-ORD-LNE         PIC S9(09)  COMP.              00980069
009900     05  PV-RECITM-ORD-LNE-NBR     PIC S9(09)  COMP.              00990069
010000     05  PV-RECITM-COUNT           PIC S9(09)  VALUE ZEROES       01000069
010100                                               COMP.              01010069
010200*                                                                 01020069
010300     05  PV-PO-NUMBER-HOLD         PIC S9(09)  COMP.              01030069
010400     05  PV-REC-SEQ-HOLD           PIC S9(09)  COMP.              01040069
010500     05  PV-OPER-UNT-ID-HOLD       PIC S9(04)  COMP.              01050069
010600     05  PV-RECITM-OPER-UNT-ID     PIC S9(04)  COMP.              01060069
010700     05  PV-MODU-NBR-HOLD          PIC S9(04)  COMP.              01070069
010800     05  PV-LINE-NBR-HOLD          PIC S9(09)  COMP.              01080069
010900     05  PV-CURR-OPER-UNT-ID-HOLD  PIC S9(04)  COMP.              01090069
011000     05  PV-PREPK-ID-HOLD          PIC S9(04)  COMP.              01100069
011100*                                                                 01110069
011200     05  PV-SYSTEM-ID.                                            01120069
011300         10  FILLER                PIC  X(04)  VALUE SPACE.       01130069
011400         10  PV-REGION-IND         PIC  X(01).                    01140069
011500             88  PV-TEST-CICS                  VALUE 'T'.         01150069
011600             88  PV-QA-CICS                    VALUE 'Q'.         01160069
011700             88  PV-PROD-CICS                  VALUE 'P'.         01170069
011800             88  PV-LEARN-CICS                 VALUE 'L'.         01180069
011900         10  FILLER                PIC  X(03)  VALUE SPACE.       01190069
012000*                                                                 01200069
012100     05  PV-RETRY-COUNTER          PIC S9(04)  VALUE +0           01210069
012200                                               COMP SYNC.         01220069
012300*                                                                 01230069
012400     05  PV-DC-RTV-TYPE-CODE            PIC  X(02).               01240069
012500     05  PV-DC-RTV-COUNT                PIC S9(09)  COMP.         01250069
012510     05  PV-DC-P2L-MODULE-COUNT         PIC S9(09)  COMP.         01251069
012520     05  PV-DC-RTV-ROWS-RETRIEVED       PIC S9(09)  VALUE ZEROES. 01252069
012530                                                                  01253069
012540     05  PV-UCC128-COUNT                PIC S9(09)  COMP.         01254069
012550                                                                  01255069
012560     05  PV-SHP-PRTR-CLUSTER-NBR        PIC S9(04)  VALUE ZERO.   01256069
012570     05  PV-SHP-PRTR-ID-ADDR            PIC  X(15)  VALUE SPACES. 01257069
012580     05  PV-SHP-PRTR-OS-RLSE-CDE        PIC  X(15)  VALUE SPACES. 01258069
012590     05  PV-SHP-DATA-XFER-MODE-ID       PIC  X(02)  VALUE SPACES. 01259069
012600     05  PV-SHP-XMIT-INTFC-CDE          PIC  X(01)  VALUE SPACE.  01260069
012700     05  PV-PGYBK-PRTR-CLUSTER-NBR      PIC S9(04)  VALUE ZERO.   01270069
012800     05  PV-PGYBK-PRTR-ID-ADDR          PIC  X(15)  VALUE SPACES. 01280069
012900     05  PV-PGYBK-PRTR-OS-RLSE-CDE      PIC  X(15)  VALUE SPACES. 01290069
013000     05  PV-PGYBK-DATA-XFER-MODE-ID     PIC  X(02)  VALUE SPACES. 01300069
013100     05  PV-PGYBK-XMIT-INTFC-CDE        PIC  X(01)  VALUE SPACE.  01310069
013200     05  PV-DC-PRTD-AT                  PIC  X(02)  VALUE SPACE.  01320069
013300                                                                  01330069
013400     05  PV-DISTDT-ODD-CNT-FCSE         PIC S9(09)  COMP.         01340069
013500     05  PV-DISTDT-ODD-CNT-INPK         PIC S9(09)  COMP.         01350069
013600                                                                  01360069
013700     05  PV-DC-5-CHAR-ABBR               PIC X(05) VALUE SPACES.  01370069
013800     05  PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.         01380069
013900         10  FILLER                      PIC  X(03).              01390069
014000         10  PV-2-DIGIT-DC-ABBR          PIC  X(02).              01400069
014100                                                                  01410069
014200     05  PV-PREPK-BLANK-COUNT         PIC S9(09) VALUE ZERO       01420069
014300                                                    COMP SYNC.    01430069
014310     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01431099
014320                                                     COMP SYNC.   01432099
014330     05  PV-DISP-TRIP                    PIC Z(09).               01433099
014340     05  PV-DISP-PO                      PIC Z(09).               01434099
014350     05  PV-DISP-RCVR                    PIC 9(04).               01435099
014360     05  PV-NULL-IND-3                  PIC S9(04)  VALUE ZEROS   01436099
014370                                                    COMP SYNC.    01437099
014380     05  PV-HANG-COUNT                  PIC S9(09)  COMP.         01438099
014390     05  PV-FOLD-COUNT                  PIC S9(09)  COMP.         01439099
014391     05  PV-OTHER-COUNT                 PIC S9(09)  COMP.         01439199
014392     05  PV-COMMODITY-COUNT             PIC S9(09)  COMP.         01439299
014400                                                                  01440069
014500*-----------------------------------------------------------------01450069
014600* PACK-TO-LIGHT MODULE TABLE                                      01460069
014700*-----------------------------------------------------------------01470069
014800 01  PMT-P2L-MODULE-TABLE.                                        01480069
014900     15 FILLER  OCCURS 05 TIMES                                   01490069
015000                INDEXED BY PMT-MOD-IDX.                           01500069
015100        20 PMT-MODULE       PIC  9(03) VALUE ZEROES.              01510069
015200                                                                  01520069
015300                                                                  01530069
015400*-----------------------------------------------------------------01540069
015500*                                                                 01550069
015600*-----------------------------------------------------------------01560069
015700 01  DK-DB2-KEYS.                                                 01570069
015800     05  DK-PO                          PIC S9(09)  COMP VALUE +0.01580069
015900     05  DK-REC-SEQ-NBR                 PIC S9(09)  COMP VALUE +0.01590069
016000     05  DK-CURR-OPER-UNT-ID            PIC S9(04)  COMP VALUE +0.01600069
016100     05  DK-OPER-UNT-ID                 PIC S9(04)  COMP VALUE +0.01610069
016200     05  DK-OPER-UNT-ID-2               PIC S9(04)  COMP VALUE +0.01620069
016300     05  DK-OPER-UNT-ID-3               PIC S9(04)  COMP VALUE +0.01630069
016400     05  DK-FCLTY-ID                    PIC S9(04)  COMP VALUE +0.01640069
016500     05  DK-STORE-NMBR.                                           01650069
016600         10  FILLER                     PIC X(01)   VALUE SPACES. 01660069
016700         10  DK-THREE-DIG-STORE-NMBR    PIC X(03)   VALUE SPACES. 01670069
016800     05  DK-PRTR-ID                     PIC S9(04)  COMP VALUE +0.01680069
016810* JAK 04/2007 - ADD KEY FIELD                                     01681099
016900     05  DK-CURRENT-TIMESTAMP            PIC X(26)   VALUE SPACES.01690099
016910                                                                  01691099
017000*----------------------------------------------------------------*01700069
017100*  SYSTEM MESSAGES                                               *01710069
017200*----------------------------------------------------------------*01720069
017300*   00005 = INVALID VALUE                                         01730069
017400*   00007 = REQUIRED ENTRY                                        01740069
017500*   00008 = MUST BE NUMERIC                                       01750069
017600*   00045 = INVALID FUNCTION KEY                                  01760069
017700*   00095 = APPLICATION SYSTEM DOES NOT EXIST                     01770069
017800*   00342 = MUST BE NUMERIC AND > ZERO                            01780069
017900*   00746 = INVALID PRINTER DESTINATION                           01790069
018000*   00918 = NO STORE DISTRIBUTION RECORDS EXIST                   01800069
018100*   00984 = DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES          01810069
018200*   00954 = PO/RECEIVER SEQUENCE NOT FOUND                        01820069
018300*   01000 = OUTER PACK MUST BE DIVISIBLE BY THE INNER PACK        01830069
018400*   01196 = RECEIVER HAS ALREADY BEEN VERIFIED                    01840069
018500*   01563 = PRINTER ID MUST BE ENTERED FOR THIS SELECTION         01850069
018600*   01729 = LINE NUMBER DOES NOT EXIST FOR PO/RECEIVER            01860069
018700*   01730 = PO/RECEIVER HAS NOT BEEN ARRIVED                      01870069
018800*   01731 = INVALID PACK-TO-LIGHT MODULE NUMBER FOR DC            01880069
018900*   01732 = PO/RECEIVER NOT FOR THIS DC - F2 TO CONFIRM           01890069
019000*   01733 = LINE(S) EXISTS ON MULT RECEIVERS FOR DC - F2 TO CONT  01900069
019100*   01790 - PIGGYBACK LABELS CANNOT BE PRINTED IN A SHUFFLED SEQ  01910069
019200*   01803 = UNABLE TO PROCESS PACK-BY-STORE ORDERS                01920069
019300*   01857 = SUPPRESSION OF HEADER/FOOTER LABEL PRINT VALID FOR P2L01930069
019400*   02424 = PGYBK PRTRS CANNOT BE USED FOR PRE-PACK TYPE I OR M   01940069
019500*   02437 = LINE NUMBER CANNOT BE USED FOR PRE-PACK TYPE I OR M   01950069
019600*   02490 = INVALID PRINTER ID - UCC128 DATA US BIT AVAILABLE M   01960069
019610*   02508 = CANNOT REPRT LBL FOR LINES PROCESSED USING UCC128     01961069
019620*   02538 = NO P2L MODULES DEFINED FOR DC - PROCESS CASEPACK ONLY 01962069
019621*   03598 = CURR OPER DOES NOT MATCH SIGN ON OPER- CANT PROCESS   01962199
019630*----------------------------------------------------------------*01963069
019640 01  PC-TSYMSG-NUMBERS.                                           01964069
019650     05  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.          01965069
019660     05  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.          01966069
019670     05  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.          01967069
019680     05  PC-TSYMSG-00045       PIC  9(05)  VALUE  00045.          01968069
019690     05  PC-TSYMSG-00057       PIC  9(05)  VALUE  00057.          01969069
019700     05  PC-TSYMSG-00069       PIC  9(05)  VALUE  00069.          01970069
019800     05  PC-TSYMSG-00070       PIC  9(05)  VALUE  00070.          01980069
019900     05  PC-TSYMSG-00095       PIC  9(05)  VALUE  00095.          01990069
020000     05  PC-TSYMSG-00342       PIC  9(05)  VALUE  00342.          02000069
020100     05  PC-TSYMSG-00746       PIC  9(05)  VALUE  00746.          02010069
020200     05  PC-TSYMSG-00918       PIC  9(05)  VALUE  00918.          02020069
020300     05  PC-TSYMSG-00984       PIC  9(05)  VALUE  00954.          02030069
020400     05  PC-TSYMSG-00954       PIC  9(05)  VALUE  00954.          02040069
020500     05  PC-TSYMSG-01000       PIC  9(05)  VALUE  01000.          02050069
020600     05  PC-TSYMSG-01196       PIC  9(05)  VALUE  01196.          02060069
020700     05  PC-TSYMSG-01563       PIC  9(05)  VALUE  01563.          02070069
020800     05  PC-TSYMSG-01729       PIC  9(05)  VALUE  01729.          02080069
020900     05  PC-TSYMSG-01730       PIC  9(05)  VALUE  01730.          02090069
021000     05  PC-TSYMSG-01731       PIC  9(05)  VALUE  01731.          02100069
021100     05  PC-TSYMSG-01732       PIC  9(05)  VALUE  01732.          02110069
021200     05  PC-TSYMSG-01733       PIC  9(05)  VALUE  01733.          02120069
021300     05  PC-TSYMSG-01790       PIC  9(05)  VALUE  01790.          02130069
021400     05  PC-TSYMSG-01803       PIC  9(05)  VALUE  01803.          02140069
021500     05  PC-TSYMSG-01857       PIC  9(05)  VALUE  01857.          02150069
021600     05  PC-TSYMSG-02424       PIC  9(05)  VALUE  02424.          02160069
021700     05  PC-TSYMSG-02437       PIC  9(05)  VALUE  02437.          02170069
021800     05  PC-TSYMSG-02490       PIC  9(05)  VALUE  02490.          02180069
021900     05  PC-TSYMSG-02508       PIC  9(05)  VALUE  02508.          02190069
022000     05  PC-TSYMSG-02538       PIC  9(05)  VALUE  02538.          02200069
022010     05  PC-TSYMSG-03554       PIC  9(05)  VALUE  03554.          02201099
022020     05  PC-TSYMSG-03598       PIC  9(05)  VALUE  03598.          02202099
022100                                                                  02210069
022200                                                                  02220069
022300*----------------------------------------------------------------*02230069
022400*   SWITCHES                                                     *02240069
022500*----------------------------------------------------------------*02250069
022600 01  PS-PROGRAM-SWITCHES.                                         02260069
022700     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        02270069
022800         88  PS-ERROR                          VALUE  'Y'.        02280069
022900         88  PS-NO-ERROR                       VALUE  'N'.        02290069
023000     05  PS-PRINTER-ERROR-SW       PIC  X(01)  VALUE  'N'.        02300069
023100         88  PS-PRINTER-ERROR                  VALUE  'Y'.        02310069
023200     05  PS-EOF-MOD-CURSOR-INT     PIC  X(01)  VALUE  'N'.        02320069
023300         88  PS-EOF-MOD-CURSOR                 VALUE  'Y'.        02330069
023400         88  PS-NOT-EOF-MOD-CURSOR             VALUE  'N'.        02340069
023500     05  PS-CONFIRM-PROCESSING-IND PIC  X(01)  VALUE  'N'.        02350069
023600         88  PS-CONFIRM-PROCESSING             VALUE  'Y'.        02360069
023700     05  PS-MULTI-RCVRS-IND        PIC  X(01)  VALUE  'N'.        02370069
023800         88  PS-MULTI-RCVR-CONFIRM             VALUE  'Y'.        02380069
023900         88  PS-MULTI-RCVR-NO-CONFIRM          VALUE  'N'.        02390069
024000     05  PS-RECITM-ON-MULTI-IND    PIC  X(01)  VALUE  'N'.        02400069
024100         88  PS-RECITM-ON-MULTI-RCVRS          VALUE  'Y'.        02410069
024200         88  PS-RECITM-NOT-ON-MULTI-RCVRS      VALUE  'N'.        02420069
024300     05  PS-DISTHD-RECORD-FOUND-SW      PIC  X(01)  VALUE  'N'.   02430069
024400         88  PS-DISTHD-RECORD-FOUND                 VALUE  'Y'.   02440069
024500         88  PS-NOT-DISTHD-RECORD-FOUND             VALUE  'N'.   02450069
024600     05  PS-LINE-STATUS-SW              PIC  X(01)  VALUE  'N'.   02460069
024700         88  PS-LINE-STATUS-KNOWN                   VALUE  'Y'.   02470069
024800         88  PS-LINE-STATUS-UNKNOWN                 VALUE  'N'.   02480069
024900     05  PS-EOF-DC-RTV-CURSOR-SW        PIC  X(01)  VALUE  'N'.   02490069
025000         88  PS-EOF-DC-RTV-CURSOR                   VALUE  'Y'.   02500069
025100         88  PS-NOT-EOF-DC-RTV-CURSOR               VALUE  'N'.   02510069
025200     05  PS-EOF-MULT-RCVR-CURSOR-SW     PIC  X(01)  VALUE  'N'.   02520069
025300         88  PS-EOF-MULT-RCVR-CSR                   VALUE  'Y'.   02530069
025400         88  PS-NOT-EOF-MULT-RCVR-CSR               VALUE  'N'.   02540069
025500     05  PS-FULLCASE-AREA-SW            PIC  X(01)  VALUE  'N'.   02550069
025600         88  PS-VALID-FULLCASE-AREA                 VALUE  'Y'.   02560069
025700         88  PS-NOT-VALID-FULLCASE-AREA             VALUE  'N'.   02570069
025800     05  PS-UCC128-DATA-EXISTS-SW       PIC  X(01)  VALUE  'N'.   02580069
025900         88  PS-UCC128-DATA-EXISTS                  VALUE  'Y'.   02590069
026000         88  PS-NO-UCC128-DATA-EXISTS               VALUE  'N'.   02600069
026010     05  PS-SEASET-ITEM-SW              PIC  X(01)  VALUE  'N'.   02601070
026020         88  PS-SEASET-ITEM                         VALUE  'Y'.   02602070
026030         88  PS-NOT-SEASET-ITEM                     VALUE  'N'.   02603070
026040* JAK 04/2007 - ADD WMOS SWITCH                                   02604099
026050     05  PS-DC-ON-WMOS-SW               PIC  X       VALUE 'N'.   02605099
026060         88  PS-DC-ON-WMOS-YES                       VALUE 'Y'.   02606099
026070         88  PS-DC-ON-WMOS-NO                        VALUE 'N'.   02607099
026100                                                                  02610069
026200                                                                  02620069
026300*----------------------------------------------------------------*02630069
026400*   PROGRAM MESSAGES                                             *02640069
026500*----------------------------------------------------------------*02650069
026600 01  PM-PROGRAM-MESSAGES.                                         02660069
026700     05  PM-ABEND-INFO-A.                                         02670069
026800         10  FILLER                PIC X(15)   VALUE              02680069
026900                                   'DP020-SRC-AID: '.             02690069
027000         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      02700069
027100         10  FILLER                PIC X(19)   VALUE              02710069
027200                                   '. DP020-FK-ACTION: '.         02720069
027300         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      02730069
027400         10  FILLER                PIC X(22)   VALUE              02740069
027500                                   '. DP020-FK-DISPN-IND: '.      02750069
027600         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      02760069
027700         10  FILLER                PIC X(01)   VALUE '.'.         02770069
027800         10  FILLER                PIC X(19)   VALUE SPACE.       02780069
027900                                                                  02790069
028000                                                                  02800069
028100******************************************************************02810069
028200*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           02820069
028300******************************************************************02830069
028400     COPY RCWS013.                                                02840069
028500                                                                  02850069
028600*----------------------------------------------------------------*02860069
028700*    MAP LAYOUT                                                  *02870069
028800*----------------------------------------------------------------*02880069
028900     COPY PCKM700.                                                02890069
029000                                                                  02900069
029100                                                                  02910069
029200*----------------------------------------------------------------*02920069
029300*  SENDING/RECEIVING AREA FOR THE                                *02930069
029400*  PRINTER VALIDATION ROUTING (DPKCS060)                         *02940069
029500*----------------------------------------------------------------*02950069
029600     COPY DPWS072.                                                02960069
029700                                                                  02970069
029800                                                                  02980069
029810******************************************************************02981099
029820*    COMMAREA COPYBOOK FOR AUTOVE PARM CHECK MODULE               02982099
029830******************************************************************02983099
029840     COPY RCWS040.                                                02984099
029850                                                                  02985099
029900*----------------------------------------------------------------*02990069
030000*    ATTRIBUTE SETTINGS COPYBOOK.                                *03000069
030100*----------------------------------------------------------------*03010069
030200     COPY DPWS015.                                                03020069
030300                                                                  03030069
030400                                                                  03040069
030500*----------------------------------------------------------------*03050069
030600*    FUNCTION KEYS COPYBOOK                                      *03060069
030700*----------------------------------------------------------------*03070069
030800     COPY DPWS016.                                                03080069
030900                                                                  03090069
031000                                                                  03100069
031100*----------------------------------------------------------------*03110069
031200*    ABEND PROCESSING COPYBOOK.                                  *03120069
031300*----------------------------------------------------------------*03130069
031400     COPY DPWS013.                                                03140069
031500                                                                  03150069
031600                                                                  03160069
031700*----------------------------------------------------------------*03170069
031800*  THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT     *03180069
031900*  SUB-ROUTINE (DPKUT100).                                       *03190069
032000*----------------------------------------------------------------*03200069
032100     COPY DPWS010I.                                               03210069
032200                                                                  03220069
032300                                                                  03230069
032400*----------------------------------------------------------------*03240069
032500*  THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS             *03250069
032600*  ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                     *03260069
032700*----------------------------------------------------------------*03270069
032800     COPY DPWS030.                                                03280069
1122RM     COPY DPWS930.                                                03281099
032900                                                                  03290069
033000                                                                  03300069
033100*----------------------------------------------------------------*03310069
033200*    STANDARD COMMAREA.                                          *03320069
033300*----------------------------------------------------------------*03330069
033400     COPY DPWS020.                                                03340069
033500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03350069
033600                                                                  03360069
033700*----------------------------------------------------------------*03370069
033800*    INTER-APPLICATION COMMAREA.                                 *03380069
033900*----------------------------------------------------------------*03390069
034000         10  INTER-APPL-COMM-AREA PIC X(200).                     03400069
034100     COPY PCWS120.                                                03410069
034200     COPY RCWS012.                                                03420069
034300*FROM RCKCS225 - RC PO/RCVR LIST BY TRAILER.                      03430069
034400     COPY RCWS015.                                                03440069
034500                                                                  03450069
034600                                                                  03460069
034700*----------------------------------------------------------------*03470069
034800*    SPECIFIC COMMMAREA FOR PCKCS700.                            *03480069
034900*----------------------------------------------------------------*03490069
035000         10  ASC-SPECIFIC-COMMAREA.                               03500069
035100             15  ASC-PO-NBR                  PIC  X(09).          03510069
035200             15  ASC-PO-NBR-N REDEFINES ASC-PO-NBR                03520069
035300                                             PIC  9(09).          03530069
035400             15  ASC-REC-SEQ-NBR             PIC  X(09).          03540069
035500             15  ASC-REC-SEQ-NBR-N REDEFINES ASC-REC-SEQ-NBR      03550069
035600                                             PIC  9(09).          03560069
035700             15  ASC-OPER-UNT-ID             PIC  X(04).          03570069
035800                 88  ASC-OPER-UNIT-CORP           VALUE '0090'.   03580069
035900             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID      03590069
036000                                             PIC  9(04).          03600069
036100             15  ASC-FCLTY-ID                PIC  X(04).          03610069
036200             15  ASC-FCLTY-ID-N REDEFINES ASC-FCLTY-ID            03620069
036300                                             PIC  9(04).          03630069
036400             15  ASC-CURR-OPER-UNT-ID        PIC  X(04).          03640069
036500             15  ASC-CURR-OPER-UNT-ID-N REDEFINES                 03650069
036600                     ASC-CURR-OPER-UNT-ID    PIC  9(04).          03660069
036700             15  ASC-CURR-FCLTY-ID           PIC  X(04).          03670069
036800             15  ASC-CURR-FCLTY-ID-N REDEFINES                    03680069
036900                     ASC-CURR-FCLTY-ID       PIC  9(04).          03690069
037000             15  ASC-SML-P2L-PRTR-ID         PIC  X(08).          03700069
037100                 88  ASC-DO-NOT-PRINT-SML         VALUE 'NL'.     03710069
037200             15  ASC-PGYBCK-PRTR-ID          PIC  X(08).          03720069
037300                 88  ASC-DO-NOT-PRINT-PGYBK       VALUE 'NL'.     03730069
037400             15  ASC-MODU-NBR                PIC  X(04).          03740069
037500             15  ASC-MODU-NBR-N REDEFINES ASC-MODU-NBR            03750069
037600                                             PIC  9(04).          03760069
037700             15  ASC-DFLT-STR-ZN-ID          PIC  X(05).          03770069
037710             15  ASC-SEASET-SHRT-NME         PIC  X(05).          03771070
037800             15  ASC-CART-CNT                PIC  X(09).          03780069
037900             15  ASC-CART-CNT-N REDEFINES ASC-CART-CNT            03790069
038000                                             PIC  9(09).          03800069
038100             15  ASC-INPK-UNT-QTY            PIC  X(04).          03810069
038200             15  ASC-INPK-UNT-QTY-N REDEFINES ASC-INPK-UNT-QTY    03820069
038300                                             PIC  9(04).          03830069
038400             15  ASC-OTPK-UNT-QTY            PIC  X(04).          03840069
038500             15  ASC-OTPK-UNT-QTY-N REDEFINES ASC-OTPK-UNT-QTY    03850069
038600                                             PIC  9(04).          03860069
038700             15  ASC-CRE-LBL-IND             PIC  X(01).          03870069
038800                 88  ASC-CRE-BOTH-LBL                   VALUE 'B'.03880069
038900                 88  ASC-CRE-P2L-LBL                    VALUE 'P'.03890069
039000                 88  ASC-CRE-SML-LBL                    VALUE 'C'.03900069
039100             15  ASC-LBL-PRT-ORDER           PIC  X(01).          03910069
039200                 88  ASC-LBL-PRT-SHUFFLED               VALUE 'S'.03920069
039300                 88  ASC-LBL-PRT-STR-ORD                VALUE 'R'.03930069
039400             15  ASC-SPEC-INST-DESC          PIC  X(05).          03940069
039500             15  ASC-PO-LINE-NBR             PIC  X(04).          03950069
039600             15  ASC-PO-LINE-NBR-N REDEFINES ASC-PO-LINE-NBR      03960069
039700                                             PIC  9(04).          03970069
039800             15  ASC-LINE-STATUS             PIC  X(08).          03980069
039900             15  ASC-PREV-CRE-LBL-OPT-SW     PIC  X(01).          03990069
040000                 88  ASC-PREV-CRE-LBL-OPT-Y             VALUE 'Y'.04000069
040100                 88  ASC-PREV-CRE-LBL-OPT-N             VALUE 'N'.04010069
040200             15  ASC-FCSE-AREA-ID            PIC  X(06).          04020069
040300             15  ASC-PRT-HEAD-FOOT           PIC  X(01).          04030069
040400                 88  ASC-YES-HEAD-FOOT                  VALUE 'Y'.04040069
040500                 88  ASC-NO-HEAD-FOOT                   VALUE 'N'.04050069
040600             15  ASC-ODD-CART-UNT-QTY        PIC  9(02).          04060069
040700             15  ASC-ODD-CRTN-USE-SW         PIC  X(01).          04070069
040800                 88  ASC-ODD-CRTN-FCSE                  VALUE 'F'.04080069
040900                 88  ASC-ODD-CRTN-INPK                  VALUE 'I'.04090069
041000                 88  ASC-ODD-CRTN-P2L                   VALUE 'P'.04100069
041100                 88  ASC-ODD-CRTN-NONE                  VALUE 'N'.04110069
041200             15  ASC-PKGNG-CD                PIC  X(01).          04120069
041300                 88  ASC-PRE-PACK-ORDER            VALUE 'I', 'M'.04130069
041400                 88  ASC-INNER-PREPK                    VALUE 'I'.04140069
041500                 88  ASC-MULTI-SKU-PREPK                VALUE 'M'.04150069
041600                 88  ASC-SINGLE-SKU-PREPK               VALUE 'S'.04160069
041700                 88  ASC-CASEPACK                       VALUE 'C'.04170069
041800                 88  ASC-BULK-PACK                      VALUE 'B'.04180069
041900             15  ASC-DSPLY-PKGNG-CD          PIC  X(01).          04190069
042000                 88  ASC-DSP-PRE-PACK-ORDER        VALUE 'I', 'M'.04200069
042010                 88  ASC-DSP-INNER-PREPK                VALUE 'I'.04201069
042020                 88  ASC-DSP-MULTI-SKU-PREPK            VALUE 'M'.04202069
042030                 88  ASC-DSP-SINGLE-SKU-PREPK           VALUE 'S'.04203069
042040                 88  ASC-DSP-CASEPACK                   VALUE 'C'.04204069
042050                 88  ASC-DSP-BULK-PACK                  VALUE 'B'.04205069
042060             15  ASC-USE-SELECTION-QUEUE-IND PIC X(1).            04206069
042070                 88  ASC-USE-SELECTION-QUEUE     VALUE 'Y'.       04207069
042080             15  ASC-LIST-QUEUE-NAME.                             04208069
042090                 20  ASC-LIST-TERM-ID        PIC X(4).            04209069
042100                 20  ASC-LIST-TASK-NUMBER    PIC S9(5) COMP-3.    04210069
042200                 20  ASC-LIST-SEQ            PIC 9.               04220069
042300             15  ASC-SEL-QUEUE-NAME-IN       PIC X(8).            04230069
042400             15  ASC-SEL-QUEUE-NAME-OUT.                          04240069
042500                 20  ASC-SEL-TERM-ID         PIC X(4).            04250069
042600                 20  ASC-SEL-TASK-NUMBER     PIC S9(5) COMP-3.    04260069
042700                 20  ASC-SEL-SEQ             PIC 9.               04270069
042800             15  ASC-INTER-APPL-CODE-IND     PIC X(01).           04280069
042900                 88  ASC-INTER-APPL-RC-TRLR      VALUE '2'.       04290069
043000                 88  ASC-INTER-APPL-SU-PORCV     VALUE '3'.       04300069
043100             15  ASC-BLK-SUB                 PIC S9(4) COMP SYNC. 04310069
043200             15  ASC-ITEM-SUB                PIC S9(4) COMP SYNC. 04320069
043300             15  ASC-SEL-SUB                 PIC S9(4) COMP.      04330069
043400             15  ASC-SEL-ITEM                PIC S9(4) COMP.      04340069
043500             15  ASC-NUMBER-OF-ITEMS-READ    PIC S9(9) COMP-3.    04350069
043600             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(9) COMP-3.   04360069
043700             15  ASC-NUMBER-OF-TS-ITEMS      PIC S9(5) COMP-3.    04370069
043800             15  ASC-ITEMS-DISPLAYED         PIC S999  COMP-3.    04380069
043900             15  ASC-ITEM-AT-TOP-OF-PANEL    PIC S9(9) COMP-3.    04390069
044000             15  ASC-ITEM-AT-BOT-OF-PANEL    PIC S9(9) COMP-3.    04400069
044100             15  ASC-HIGHEST-BLOCK-WRITTEN   PIC S9(4) COMP SYNC. 04410069
044200             15  ASC-UCC128-DATA-EXISTS-SW   PIC  X(1).           04420069
044300                 88  ASC-UCC128-DATA-EXISTS       VALUE  'Y'.     04430069
044400                 88  ASC-NO-UCC128-DATA-EXISTS    VALUE  'N'.     04440069
044401             15  ASC-USE-UCC128-DATA-SW      PIC  X(1).           04440169
044402                 88  ASC-USE-UCC128-DATA-YES      VALUE  'Y'.     04440269
044403                 88  ASC-USE-UCC128-DATA-NO       VALUE  'N'.     04440369
044404                 88  ASC-USE-UCC128-DATA-UNKNOWN  VALUE  ' '.     04440469
044405             15  ASC-PACK-BY-ST-IND          PIC  X(01).          04440569
044406                 88  ASC-PACK-BY-ST-YES           VALUE  'Y'.     04440669
044407             15  ASC-AUTOVE-PARM-SW          PIC  X(01).          04440799
044408                 88  ASC-AUTOVE-PARM-YES          VALUE  'Y'.     04440899
044409                 88  ASC-AUTOVE-PARM-NO           VALUE  'N'.     04440999
044410             15  ASC-DPT-NBR                 PIC  X(03).          04441099
044411             15  ASC-OPER-MATCH-SW            PIC  X.             04441199
044412                 88  ASC-OPER-MATCH-YES            VALUE 'Y'.     04441299
044413                 88  ASC-OPER-MATCH-NO             VALUE 'N'.     04441399
044414             15  ASC-TRIP-ARRIVE-DATE        PIC  X(10).          04441499
044415             15  ASC-TRIP-ARRIVE-DATE-R                           04441599
044416                 REDEFINES ASC-TRIP-ARRIVE-DATE.                  04441699
044417                 20  ASC-TRIP-ARRIVE-CCYY    PIC  X(04).          04441799
044418                 20  ASC-TRIP-ARRIVE-DASH1   PIC  X(01).          04441899
044419                 20  ASC-TRIP-ARRIVE-MM      PIC  X(02).          04441999
044420                 20  ASC-TRIP-ARRIVE-DASH2   PIC  X(01).          04442099
044421                 20  ASC-TRIP-ARRIVE-DD      PIC  X(02).          04442199
044422*                                                                 04442299
044423             15  ASC-P2L-ZONE            PIC X(14).               04442399
044424                 88 ASC-COMMODITY         VALUE 'COMMODITY     '. 04442499
044425                 88 ASC-HANG-FOLD         VALUE 'HANG/FOLD     '. 04442599
044426                 88 ASC-HANG-COMMODITY    VALUE 'HANG/COMMODITY'. 04442699
044431             15  ASC-HANGER-IND          PIC X(01).               04443199
044432                 88 ASC-HANGER-AGREEMENT  VALUE 'Y'.              04443299
044433*                                                                 04443399
044434             15  FILLER                      PIC  X(12).          04443499
044435         10  ASC-HOLD-INTER-APPL         PIC X(200).              04443599
044436                                                                  04443699
044437*-----------------------------------------------------------------04443799
044438*  SQL AND COBOL DECLARATIONS FOR THE XLT_LOC TABLE (XLT00010)    04443899
044439*-----------------------------------------------------------------04443969
044440     EXEC SQL                                                     04444069
044450          INCLUDE XLT00010                                        04445099
044460     END-EXEC.                                                    04446069
044470                                                                  04447069
044480                                                                  04448069
044490*-----------------------------------------------------------------04449069
044500*  SQL AND COBOL DECLARATION FOR COMPANY CONTROL TABLE (TCOCNTL)  04450069
044600*-----------------------------------------------------------------04460069
044700     EXEC SQL                                                     04470069
044800         INCLUDE TCOCNTL                                          04480069
044900     END-EXEC.                                                    04490069
045000                                                                  04500069
045100*-----------------------------------------------------------------04510069
045200*  SQL AND COBOL DECLARATIONS FOR THE RECEIVER TABLE (TRECEIV)    04520069
045300*-----------------------------------------------------------------04530069
045400     EXEC SQL                                                     04540069
045500          INCLUDE TRECEIV                                         04550069
045600     END-EXEC.                                                    04560069
045700                                                                  04570069
045800                                                                  04580069
045900*-----------------------------------------------------------------04590069
046000*  SQL AND COBOL DECLARATIONS FOR THE PO-PURCHASE TABLE (TPURCHS) 04600069
046100*-----------------------------------------------------------------04610069
046200     EXEC SQL                                                     04620069
046300          INCLUDE TPURCHS                                         04630069
046400     END-EXEC.                                                    04640069
046500                                                                  04650069
046600                                                                  04660069
046700*-----------------------------------------------------------------04670069
046800*  SQL AND COBOL DECLARATIONS FOR THE MB-MERCHANDISE AREA TABLE   04680069
046900*-----------------------------------------------------------------04690069
047000     EXEC SQL                                                     04700069
047100          INCLUDE TMDSEAR                                         04710069
047200     END-EXEC.                                                    04720069
047300                                                                  04730069
047400                                                                  04740069
047500*-----------------------------------------------------------------04750069
047600*  SQL AND COBOL DECLARATIONS FOR THE MB-MERCHANDISE DEPT TABLE   04760069
047700*-----------------------------------------------------------------04770069
047800     EXEC SQL                                                     04780069
047900          INCLUDE TMDSEDP                                         04790069
048000     END-EXEC.                                                    04800069
048100                                                                  04810069
048200                                                                  04820069
048300*-----------------------------------------------------------------04830069
048400*  SQL AND COBOL DECLARATIONS FOR THE RC-RECEIPT ITEM TABLE       04840069
048500*-----------------------------------------------------------------04850069
048600     EXEC SQL                                                     04860069
048700          INCLUDE TRECITM                                         04870069
048800     END-EXEC.                                                    04880069
048900                                                                  04890069
049000                                                                  04900069
049100*-----------------------------------------------------------------04910069
049200*  SQL AND COBOL DECLARATIONS FOR THE RC-RECEIPT DISTRIBUTION     04920069
049300*-----------------------------------------------------------------04930069
049400     EXEC SQL                                                     04940069
049500          INCLUDE TRECDIS                                         04950069
049600     END-EXEC.                                                    04960069
049700                                                                  04970069
049800                                                                  04980069
049900*-----------------------------------------------------------------04990069
050000*  SQL AND COBOL DECLARATIONS FOR THE PC-PACK-TO-LIGHT MODULE     05000069
050100*-----------------------------------------------------------------05010069
050200     EXEC SQL                                                     05020069
050300          INCLUDE TP2LMOD                                         05030069
050400     END-EXEC.                                                    05040069
050500                                                                  05050069
050600                                                                  05060069
050700*---------------------------------------------------------------* 05070069
050800*    RC - TROUBLE NOTIFICATION TABLE                            * 05080069
050900*---------------------------------------------------------------* 05090069
051000     EXEC SQL                                                     05100069
051100          INCLUDE TTRBNTF                                         05110069
051200     END-EXEC.                                                    05120069
051300                                                                  05130069
051400                                                                  05140069
051500*---------------------------------------------------------------* 05150069
051600*    RC - TROUBLE REASON CODES TABLE                            * 05160069
051700*---------------------------------------------------------------* 05170069
051800     EXEC SQL                                                     05180069
051900          INCLUDE TTRBRSN                                         05190069
052000     END-EXEC.                                                    05200069
052100                                                                  05210069
052200                                                                  05220069
052300*---------------------------------------------------------------* 05230069
052400*    DC-DISTRIBUTION TRANSACTION HEADER                         * 05240069
052500*---------------------------------------------------------------* 05250069
052600     EXEC SQL                                                     05260069
052700          INCLUDE TDISTHD                                         05270069
052800     END-EXEC.                                                    05280069
052900                                                                  05290069
053000                                                                  05300069
053100*---------------------------------------------------------------* 05310069
053200*    DC-DISTRIBUTION TRANSACTION DETAIL                         * 05320069
053300*---------------------------------------------------------------* 05330069
053400     EXEC SQL                                                     05340069
053500          INCLUDE TDISTDT                                         05350069
053600     END-EXEC.                                                    05360069
053700                                                                  05370069
053800                                                                  05380069
054700*---------------------------------------------------------------* 05470069
054800*      -FACILITY AREA TABLE                                     * 05480069
054900*---------------------------------------------------------------* 05490069
055000     EXEC SQL                                                     05500069
055100          INCLUDE TFLAREA                                         05510069
055200     END-EXEC.                                                    05520069
055300                                                                  05530069
055400                                                                  05540069
055500*---------------------------------------------------------------* 05550069
055600*      -PACK SLIP TABLE                                         * 05560069
055700*---------------------------------------------------------------* 05570069
055800     EXEC SQL                                                     05580069
055900          INCLUDE TPKSLIP                                         05590069
056000     END-EXEC.                                                    05600069
056100                                                                  05610069
056200                                                                  05620069
056300*---------------------------------------------------------------* 05630069
056400*      -                                                        * 05640069
056410*---------------------------------------------------------------* 05641069
056420     EXEC SQL                                                     05642069
056430          INCLUDE TINPKSU                                         05643069
056440     END-EXEC.                                                    05644069
056450                                                                  05645069
056460                                                                  05646069
056461*---------------------------------------------------------------* 05646174
056462*      -                                                        * 05646274
056463*---------------------------------------------------------------* 05646374
056464     EXEC SQL                                                     05646474
056465          INCLUDE TSEASET                                         05646574
056466     END-EXEC.                                                    05646674
056467                                                                  05646774
056468                                                                  05646874
056470*---------------------------------------------------------------* 05647069
056480*      -                                                        * 05648069
056490*---------------------------------------------------------------* 05649069
056500     EXEC SQL                                                     05650069
056501          INCLUDE TSHUUPC                                         05650169
056502     END-EXEC.                                                    05650269
056503                                                                  05650369
056504                                                                  05650469
056505* JAK 04/2007 - ADD WST00008/9/10                                 05650599
056506*---------------------------------------------------------------* 05650699
056508*  SQL AND COBOL DECLARATIONS FOR WST_INTGRTN_TYP                 05650899
056510*---------------------------------------------------------------* 05651099
056511     EXEC SQL                                                     05651199
056512          INCLUDE WST00008                                        05651299
056513     END-EXEC.                                                    05651399
056515*---------------------------------------------------------------* 05651599
056516*  SQL AND COBOL DECLARATIONS FOR WST_ATTR_DEFN                   05651699
056518*---------------------------------------------------------------* 05651899
056519     EXEC SQL                                                     05651999
056520          INCLUDE WST00009                                        05652099
056521     END-EXEC.                                                    05652199
056523*---------------------------------------------------------------* 05652399
056524*  SQL AND COBOL DECLARATIONS FOR WST_ATTR_ELEM                   05652499
056526*---------------------------------------------------------------* 05652699
056527     EXEC SQL                                                     05652799
056528          INCLUDE WST00010                                        05652899
056529     END-EXEC.                                                    05652999
056530                                                                  05653099
056531                                                                  05653199
056532*---------------------------------------------------------------* 05653299
056533*  TSHPTPO                                                        05653399
056534*---------------------------------------------------------------* 05653499
056535     EXEC SQL                                                     05653599
056536          INCLUDE TSHPTPO                                         05653699
056537     END-EXEC.                                                    05653799
056538                                                                  05653899
056539                                                                  05653999
056540*---------------------------------------------------------------* 05654099
056541*  TSHIPMT                                                        05654199
056542*---------------------------------------------------------------* 05654299
056543     EXEC SQL                                                     05654399
056544          INCLUDE TSHIPMT                                         05654499
056545     END-EXEC.                                                    05654599
056546                                                                  05654699
056547                                                                  05654799
056548*---------------------------------------------------------------* 05654899
056549*  TVHTRIP                                                        05654999
056550*---------------------------------------------------------------* 05655099
056551     EXEC SQL                                                     05655199
056552          INCLUDE TVHTRIP                                         05655299
056553     END-EXEC.                                                    05655399
056554                                                                  05655499
056555                                                                  05655599
056556*---------------------------------------------------------------* 05655699
056557*  TTRIPST                                                        05655799
056558*---------------------------------------------------------------* 05655899
056559     EXEC SQL                                                     05655999
056560          INCLUDE TTRIPST                                         05656099
056561     END-EXEC.                                                    05656199
056562                                                                  05656299
056563                                                                  05656399
056564*---------------------------------------------------------------* 05656499
056565*  TKRPRPM                                                        05656599
056566*---------------------------------------------------------------* 05656699
056567     EXEC SQL                                                     05656799
056568          INCLUDE TKRPRPM                                         05656899
056569     END-EXEC.                                                    05656999
056570                                                                  05657099
056571                                                                  05657199
056572*---------------------------------------------------------------* 05657299
056573* XLT_SKU                                                         05657399
056574*---------------------------------------------------------------* 05657499
056575     EXEC SQL                                                     05657599
056576          INCLUDE XLT00003                                        05657699
056577     END-EXEC.                                                    05657799
056578                                                                  05657899
056579                                                                  05657999
056580*---------------------------------------------------------------* 05658099
056581*  XLT_VND_STYL                                                   05658199
056582*---------------------------------------------------------------* 05658299
056583     EXEC SQL                                                     05658399
056584          INCLUDE XLT00004                                        05658499
056585     END-EXEC.                                                    05658599
056586                                                                  05658699
056587                                                                  05658799
056588*---------------------------------------------------------------* 05658899
056589*  TPURITM                                                        05658999
056590*---------------------------------------------------------------* 05659099
056591     EXEC SQL                                                     05659199
056592          INCLUDE TPURITM                                         05659299
056593     END-EXEC.                                                    05659399
056594                                                                  05659499
056595                                                                  05659599
056596*-----------------------------------------------------------------05659669
056597* PACK-TO-LIGHT MODULE CURSOR - THIS CURSOR WILL RETRIEVE P2L     05659769
056598* MODULES FOR A GIVEN STORE ZONE.                                 05659869
056599*-----------------------------------------------------------------05659969
056600     EXEC SQL                                                     05660069
056601          DECLARE  MODULE_CURSOR CURSOR FOR                       05660169
056602           SELECT  DISTINCT D.MODU_NBR                            05660269
056603             FROM  TP2LMOD D                                      05660369
056604            WHERE  D.OPER_UNT_ID    = :PV-OPER-UNT-ID-HOLD        05660469
056605              AND  D.DFLT_STR_ZN_ID = :ASC-DFLT-STR-ZN-ID         05660569
056606            ORDER  BY 1                                           05660669
056607     END-EXEC.                                                    05660769
056608                                                                  05660869
056609                                                                  05660969
056610*---------------------------------------------------------------* 05661069
056700*   DC/RTV CURSOR                                               * 05670069
056800*---------------------------------------------------------------* 05680069
056900     EXEC SQL                                                     05690069
057000          DECLARE DC-RTV-CSR CURSOR FOR                           05700069
057100              SELECT  LOC_TYP_CDE                                 05710099
057110                     ,(COUNT(*))                                  05711099
057200                FROM  TRECDIS A                                   05720069
057300                     ,XLT_LOC B                                   05730099
057400                WHERE A.ORD_NBR        = :PV-PO-NUMBER-HOLD       05740069
057500                  AND A.REC_SEQ_NBR    = :PV-REC-SEQ-HOLD         05750069
057600                  AND A.ORD_LNE_NBR    = :PV-LINE-NBR-HOLD        05760069
057700                  AND A.STR_NBR        = B.LOC_NBR                05770099
057800                  AND B.LOC_TYP_CDE   IN ('DC', 'RV')             05780099
057900                GROUP BY LOC_TYP_CDE                              05790099
058000     END-EXEC.                                                    05800069
058100                                                                  05810069
058200                                                                  05820069
058300*-----------------------------------------------------------------05830069
058400*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                05840069
058500*-----------------------------------------------------------------05850069
058600     EXEC SQL                                                     05860069
058700          INCLUDE SQLCA                                           05870069
058800     END-EXEC.                                                    05880069
058900                                                                  05890069
059000                                                                  05900069
059100*-----------------------------------------------------------------05910069
059200*                                                                 05920069
059300*-----------------------------------------------------------------05930069
059400                                                                  05940069
059500                                                                  05950069
059600 LINKAGE SECTION.                                                 05960069
059700                                                                  05970069
059800                                                                  05980069
059900 01  DFHCOMMAREA.                                                 05990069
060000     05  FILLER                         OCCURS  1 TO 4072 TIMES   06000069
060100                                        DEPENDING ON EIBCALEN.    06010069
060200         10  FILLER                     PIC X.                    06020069
060300                                                                  06030069
060400                                                                  06040069
060500 PROCEDURE DIVISION.                                              06050069
060600*----------------------------------------------------------------*06060069
060700*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.   *06070069
060800*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API    *06080069
060900*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.              *06090069
061000*                                                                *06100069
061100*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE    *06110069
061200*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.         *06120069
061300*----------------------------------------------------------------*06130069
061400 0000-MAIN-MODULE.                                                06140069
061500     INITIALIZE DP030-CICS-API-FIELDS.                            06150069
061600     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       06160069
061700     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          06170069
061800     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         06180069
061900     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       06190069
062000     MOVE LENGTH OF PC700AI        TO DP030-MAP-LENGTH (1).       06200069
062100     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     06210069
062200     PERFORM 0001-CALL-CICS-ARCH-API.                             06220069
062300                                                                  06230069
062400     PERFORM 1000-CONTROL-PROCESSING                              06240069
062500                                                                  06250069
062600     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     06260069
062700     PERFORM 0001-CALL-CICS-ARCH-API.                             06270069
062800                                                                  06280069
062900                                                                  06290069
063000 0001-CALL-CICS-ARCH-API.                                         06300069
1122RM*    CALL 'DPKCS030' USING DFHEIBLK                               06310099
1122RM     CALL DP930-CICS-ARCH-API                                     06311099
1122RM                     USING DFHEIBLK                               06312099
063200                           DFHCOMMAREA                            06320069
063300                           DP030-CICS-API-FIELDS                  06330069
063400                           DP020-STANDARD-COMMAREA                06340069
063500                           PC700AI.                               06350069
063600*                                                                 06360069
063700     IF  DP030-RC-CALL-SUCCESSFUL                                 06370069
063800         CONTINUE                                                 06380069
063900     ELSE                                                         06390069
064000         SET DP013-NO-ROLLBACK                                    06400069
064100             DP013-XCTL-DISPLAY-RESTART                           06410069
064200             DP013-CICS-ABEND      TO TRUE                        06420069
064300         MOVE 'BEFORE 0000-MAIN-MODULE'                           06430069
064400                                   TO DP013-PARAGRAPH             06440069
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX06450099
1122RM*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      06460099
1122RM         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O06461099
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06462099
064700         MOVE DP030-RETURN-CODE                                   06470069
064800                                   TO DP013-MESSAGE-TEXT (3)      06480069
064900         PERFORM DP013-0000-PROCESS-ABEND                         06490069
065000     END-IF.                                                      06500069
065100                                                                  06510069
065200                                                                  06520069
065300*----------------------------------------------------------------*06530069
065400*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *06540069
065500*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *06550069
065600*----------------------------------------------------------------*06560069
065700 1000-CONTROL-PROCESSING.                                         06570069
065800                                                                  06580069
065900     EVALUATE TRUE                                                06590069
066000       WHEN DP020-NEXT-ACT-INITIAL                                06600069
066100           INITIALIZE ASC-SPECIFIC-COMMAREA                       06610069
066200           MOVE EIBTRMID              TO ASC-LIST-TERM-ID         06620069
066300                                         ASC-SEL-TERM-ID          06630069
066400           MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER     06640069
066500                                         ASC-SEL-TASK-NUMBER      06650069
066600           MOVE PC-LIST-QUEUE-SEQ     TO ASC-LIST-SEQ             06660069
066700           MOVE PC-SEL-QUEUE-SEQ      TO ASC-SEL-SEQ              06670069
066800           SET PS-NO-ERROR            TO TRUE                     06680069
066850                                                                  06685099
066900           PERFORM 1100-PROCESS-INTER-APPL-COMM                   06690069
067000           IF PS-NO-ERROR                                         06700069
067100               MOVE INTER-APPL-COMM-AREA TO ASC-HOLD-INTER-APPL   06710069
067200               IF ASC-USE-SELECTION-QUEUE                         06720069
067300                   PERFORM 7000-BUILD-INITIAL-PANEL               06730069
067400                   SET ASC-PREV-CRE-LBL-OPT-N TO TRUE             06740069
067500                   PERFORM 3000-EDIT-DATA-IN-COMMAREA             06750069
067600               ELSE                                               06760069
067700                   PERFORM 7000-BUILD-INITIAL-PANEL               06770069
067800                   SET ASC-PREV-CRE-LBL-OPT-N TO TRUE             06780069
067900               END-IF                                             06790069
068000           END-IF                                                 06800069
068100                                                                  06810069
068200*        WHEN DP020-NEXT-ACT-INITIAL                              06820069
068300*            MOVE INTER-APPL-COMM-AREA  TO ASC-HOLD-INTER-APPL    06830069
068400*        WHEN OTHER                                               06840069
068500*            MOVE ASC-HOLD-INTER-APPL   TO INTER-APPL-COMM-AREA   06850069
068600*        END-EVALUATE.                                            06860069
068700                                                                  06870069
068800*    EVALUATE TRUE                                                06880069
068900*        WHEN DP020-NEXT-ACT-INITIAL                              06890069
069000*            PERFORM 7000-BUILD-INITIAL-PANEL                     06900069
069100*            SET ASC-PREV-CRE-LBL-OPT-N  TO  TRUE                 06910069
069200                                                                  06920069
069300         WHEN DP020-NEXT-ACT-READ-MAP                             06930069
069400             PERFORM 2000-FKEY-PROCESSING                         06940069
069500                                                                  06950069
069600         WHEN DP020-NEXT-ACT-RETURN                               06960069
069700             MOVE  SPACES  TO  ASC-DFLT-STR-ZN-ID                 06970069
069710                               ASC-SEASET-SHRT-NME                06971070
069800                               ASC-SPEC-INST-DESC                 06980069
069900                               ASC-UCC128-DATA-EXISTS-SW          06990069
070000                               ASC-USE-UCC128-DATA-SW             07000069
070100             MOVE  ZEROES  TO  ASC-MODU-NBR-N                     07010069
070200                               ASC-INPK-UNT-QTY-N                 07020069
070300                               ASC-OTPK-UNT-QTY-N                 07030069
070400                               ASC-CART-CNT-N                     07040069
070500*11/27 - BEGIN                                                    07050069
070600*            MOVE  'S'     TO  ASC-LBL-PRT-ORDER                  07060069
070700*            MOVE  'B'     TO  ASC-CRE-LBL-IND                    07070069
070800                                                                  07080069
070900             MOVE ASC-OPER-UNT-ID  TO DK-OPER-UNT-ID              07090069
071000             MOVE ASC-FCLTY-ID     TO DK-FCLTY-ID                 07100069
071100                                                                  07110069
071200             PERFORM 7020-GET-DC-DEFAULTS                         07120069
071300                                                                  07130069
071400             MOVE COCNTL-DFLT-CRE-LBL-CDE   TO  ASC-CRE-LBL-IND   07140069
071500             MOVE COCNTL-DFLT-PRT-ORD-CDE   TO  ASC-LBL-PRT-ORDER 07150069
071600             MOVE COCNTL-DFLT-FCSE-AREA-ID  TO  ASC-FCSE-AREA-ID  07160069
071700             MOVE PC-Y                      TO  ASC-PRT-HEAD-FOOT 07170069
071800                                                                  07180069
071900             PERFORM 7025-CHECK-DC-P2L-MODULES                    07190069
072000             IF  PV-DC-P2L-MODULE-COUNT  >  0                     07200069
072100                 CONTINUE                                         07210069
072200             ELSE                                                 07220069
072300                 MOVE  PC-CASE-PROCESS-ONLY  TO  ASC-CRE-LBL-IND  07230069
072400             END-IF                                               07240069
072500*11/27 - END                                                      07250069
072600                                                                  07260069
072700             PERFORM 8000-MOVE-COMMAREA-TO-SCREEN                 07270069
072800             MOVE -1                   TO MPONBRL                 07280069
072900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07290069
073000                                                                  07300069
073100         WHEN OTHER                                               07310069
073200             SET DP013-LOGIC-ABEND                                07320069
073300                 DP013-NO-ROLLBACK TO TRUE                        07330069
073400             MOVE '1000-CONTROL-PROCESSING'                       07340069
073500                                   TO  DP013-PARAGRAPH            07350069
073600             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   07360069
073700                                   TO  DP013-MESSAGE-TEXT(1)      07370069
073800             MOVE DP020-NEXT-APPL-ACTIVITY                        07380069
073900                                   TO DP013-MESSAGE-TEXT(2)       07390069
074000             PERFORM DP013-0000-PROCESS-ABEND                     07400069
074100     END-EVALUATE.                                                07410069
074200                                                                  07420069
074300******************************************************************07430069
074400 1100-PROCESS-INTER-APPL-COMM.                                    07440069
074500                                                                  07450069
074600     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INTER-APPL-CODE-IND.   07460069
074700                                                                  07470069
074800     EVALUATE DP020-INT-APPL-FORMAT-IND                           07480069
074900       WHEN PC-INTER-APPL-RC-TRLR                                 07490069
075000       WHEN PC-INTER-APPL-SU-PORCV                                07500069
075100           IF RC015-NUMBER-OF-SELECTED-ITEMS = ZERO               07510069
075200               SET DP020-MSG-FATAL                                07520069
075300                   DP020-NEXT-ACT-APPL-ERROR                      07530069
075400                   PS-ERROR          TO TRUE                      07540069
075500               MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER          07550069
075600           ELSE                                                   07560069
075700               SET ASC-USE-SELECTION-QUEUE TO TRUE                07570069
075800               MOVE RC015-NUMBER-OF-SELECTED-ITEMS                07580069
075900                                  TO ASC-NUMBER-OF-SELECTED-ITEMS 07590069
076000               MOVE RC015-NUMBER-OF-TS-ITEMS                      07600069
076100                                  TO ASC-NUMBER-OF-TS-ITEMS       07610069
076200               MOVE RC015-SEL-QUEUE-NAME TO ASC-SEL-QUEUE-NAME-IN 07620069
076300               MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB           07630069
076400               MOVE ZEROES               TO ASC-SEL-ITEM          07640069
076500               PERFORM 1150-GET-NEXT-RECORD                       07650069
076600           END-IF                                                 07660069
076700     END-EVALUATE.                                                07670069
076800                                                                  07680069
076900******************************************************************07690069
077000* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *07700069
077100* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *07710069
077200******************************************************************07720069
077300 1150-GET-NEXT-RECORD.                                            07730069
077400                                                                  07740069
077500     SET  ASC-USE-UCC128-DATA-UNKNOWN  TO  TRUE.                  07750069
077510                                                                  07751069
077520     ADD  +1 TO ASC-SEL-SUB.                                      07752069
077530                                                                  07753069
077540     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             07754069
077550         ADD  +1 TO ASC-SEL-ITEM                                  07755069
077560         MOVE +1 TO ASC-SEL-SUB                                   07756069
077570     END-IF.                                                      07757069
077580                                                                  07758069
077590     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 07759069
077600         PERFORM 9100-READ-SEL-QUEUE                              07760069
077700         IF RC013-ITEM (ASC-SEL-SUB) > ZERO                       07770069
077800             MOVE RC013-PO-NBR (ASC-SEL-SUB)                      07780069
077900                  TO ASC-PO-NBR-N                                 07790069
078000                     DK-PO                                        07800069
078100                     MPONBRI                                      07810069
078200             MOVE RC013-REC-SEQ-NBR (ASC-SEL-SUB)                 07820069
078300                  TO ASC-REC-SEQ-NBR-N                            07830069
078400                     DK-REC-SEQ-NBR                               07840069
078500                     MRECVRI                                      07850069
078600             MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                 07860069
078700                  TO ASC-OPER-UNT-ID-N                            07870069
078800                     DK-OPER-UNT-ID                               07880069
078900                     PV-OPER-UNT-HOLD                             07890069
079000             MOVE RC013-FCLTY-ID (ASC-SEL-SUB)                    07900069
079100                  TO ASC-FCLTY-ID-N                               07910069
079200                     DK-FCLTY-ID                                  07920069
079300                     PV-FCLTY-ID-HOLD                             07930069
079400             MOVE PV-OPER-FCLTY-HOLD                              07940069
079500                  TO MOPIDI                                       07950069
079600             SET RC013-INQ (ASC-SEL-SUB)                          07960069
079700                                   TO TRUE                        07970069
079800             PERFORM 9200-REWRITE-LIST-QUEUE                      07980069
079900         ELSE                                                     07990069
080000             SUBTRACT +1 FROM ASC-SEL-SUB                         08000069
080100*--- BOTTOM OF LIST ---                                           08010069
080200             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             08020069
080300             SET DP020-MSG-INFORMATIONAL TO TRUE                  08030069
080400         END-IF                                                   08040069
080500     ELSE                                                         08050069
080600         SUBTRACT +1               FROM ASC-SEL-ITEM              08060069
080700         MOVE RC013-MAX-ITEMS        TO ASC-SEL-SUB               08070069
080800         MOVE PC-TSYMSG-00070        TO DP020-MSG-NUMBER          08080069
080900         SET DP020-MSG-INFORMATIONAL TO TRUE                      08090069
081000     END-IF.                                                      08100069
081100                                                                  08110069
081200******************************************************************08120069
081300* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *08130069
081400* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *08140069
081500******************************************************************08150069
081600 1160-GET-PREV-RECORD.                                            08160069
081700                                                                  08170069
081800     SET  ASC-USE-UCC128-DATA-UNKNOWN  TO  TRUE.                  08180069
081900                                                                  08190069
082000     SUBTRACT +1 FROM ASC-SEL-SUB.                                08200069
082100                                                                  08210069
082200     IF ASC-SEL-SUB < +1                                          08220069
082300         SUBTRACT +1 FROM ASC-SEL-ITEM                            08230069
082400         MOVE RC013-MAX-ITEMS TO ASC-SEL-SUB                      08240069
082500     END-IF.                                                      08250069
082600                                                                  08260069
082700     IF ASC-SEL-ITEM > ZERO                                       08270069
082800         PERFORM 9100-READ-SEL-QUEUE                              08280069
082900         MOVE RC013-PO-NBR (ASC-SEL-SUB)                          08290069
083000                  TO ASC-PO-NBR-N                                 08300069
083100                     DK-PO                                        08310069
083200         MOVE RC013-REC-SEQ-NBR (ASC-SEL-SUB)                     08320069
083300                  TO ASC-REC-SEQ-NBR-N                            08330069
083400                     DK-REC-SEQ-NBR                               08340069
083500         MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                     08350069
083600                  TO ASC-OPER-UNT-ID-N                            08360069
083700                     DK-OPER-UNT-ID                               08370069
083800         MOVE RC013-FCLTY-ID (ASC-SEL-SUB)                        08380069
083900                  TO ASC-FCLTY-ID-N                               08390069
084000                     DK-FCLTY-ID                                  08400069
084100     ELSE                                                         08410069
084200         MOVE +1 TO ASC-SEL-ITEM                                  08420069
084300                    ASC-SEL-SUB                                   08430069
084400*--- TOP OF LIST ---                                              08440069
084500         MOVE PC-TSYMSG-00069        TO DP020-MSG-NUMBER          08450069
084600         SET DP020-MSG-INFORMATIONAL TO TRUE                      08460069
084700     END-IF.                                                      08470069
084800                                                                  08480069
084900                                                                  08490069
085000*----------------------------------------------------------------*08500069
085100* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*08510069
085200* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*08520069
085300* EDITS.                                                         *08530069
085400*----------------------------------------------------------------*08540069
085500 2000-FKEY-PROCESSING.                                            08550069
085600                                                                  08560069
085700     EVALUATE TRUE                                                08570069
085800                                                                  08580069
085900         WHEN DP020-SRC-AID = DP016-CLEAR                         08590069
086000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08600069
086100             PERFORM 8000-MOVE-COMMAREA-TO-SCREEN                 08610069
086200             SET ASC-PREV-CRE-LBL-OPT-N  TO  TRUE                 08620069
086300                                                                  08630069
086400         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     08640069
086500             INITIALIZE ASC-SPECIFIC-COMMAREA                     08650069
086600             PERFORM 7000-BUILD-INITIAL-PANEL                     08660069
086700             PERFORM 3200-RESET-ATTRIBUTES                        08670069
086800             SET ASC-PREV-CRE-LBL-OPT-N  TO  TRUE                 08680069
086900                                                                  08690069
087000         WHEN OTHER                                               08700069
087100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 08710069
087200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08720069
087300             IF  PS-NO-ERROR                                      08730069
087400                 SET DP030-CONTINUE-GO TO TRUE                    08740069
087500                 PERFORM 2100-CHECK-FUNCTION-KEY                  08750069
087600             ELSE                                                 08760069
087700                 SET DP030-OVERRIDE-GO TO TRUE                    08770069
087800             END-IF                                               08780069
087900     END-EVALUATE.                                                08790069
088000                                                                  08800069
088100                                                                  08810069
088200*----------------------------------------------------------------*08820069
088300*  ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED      *08830069
088400*  FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED  *08840069
088500*  FROM THE CICS ARCHITECTURE API.                               *08850069
088600*----------------------------------------------------------------*08860069
088700 2100-CHECK-FUNCTION-KEY.                                         08870069
088800                                                                  08880069
088900     EVALUATE TRUE                                                08890069
089000         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 08900069
089100         WHEN DP020-FK-DISPN-GO (DP020-SRC-AID)                   08910069
089200         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    08920069
089300             PERFORM 2110-PREPARE-INTER-APPL-COMM                 08930069
089400                                                                  08940069
089500         WHEN DP020-SRC-AID = DP016-ENTER                         08950069
089600             SET ASC-PREV-CRE-LBL-OPT-N  TO  TRUE                 08960069
089700                                                                  08970069
089800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             08980069
089900             IF ASC-USE-SELECTION-QUEUE                           08990069
090000                 PERFORM 6200-DEL-LIST-QUEUE                      09000069
090100                 PERFORM 1150-GET-NEXT-RECORD                     09010069
090200                 PERFORM 7000-BUILD-INITIAL-PANEL                 09020069
090300                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               09030069
090400             ELSE                                                 09040069
090500*                --- BOTTOM OF LIST ---                           09050069
090600                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         09060069
090700                 SET DP020-MSG-INFORMATIONAL TO TRUE              09070069
090800             END-IF                                               09080069
090900                                                                  09090069
091000         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             09100069
091100             IF ASC-USE-SELECTION-QUEUE                           09110069
091200                 PERFORM 6200-DEL-LIST-QUEUE                      09120069
091300                 PERFORM 1160-GET-PREV-RECORD                     09130069
091400                 PERFORM 7000-BUILD-INITIAL-PANEL                 09140069
091500                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               09150069
091600             ELSE                                                 09160069
091700*                --- TOP OF LIST ---                              09170069
091800                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         09180069
091900                 SET DP020-MSG-INFORMATIONAL TO TRUE              09190069
092000             END-IF                                               09200069
092100                                                                  09210069
092200         WHEN OTHER                                               09220069
092300             SET DP013-NO-ROLLBACK                                09230069
092400                 DP013-XCTL-DISPLAY-RESTART                       09240069
092500                 DP013-CICS-ABEND  TO TRUE                        09250069
092600             MOVE '2100-CHECK-FUNCTION-KEY'                       09260069
092700                                   TO DP013-PARAGRAPH             09270069
092800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      09280069
092900                                   TO DP013-MESSAGE-TEXT (1)      09290069
093000             MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:' 09300069
093100                                   TO DP013-MESSAGE-TEXT (2)      09310069
093200             MOVE DP020-SRC-AID    TO PM-A-SRC-AID                09320069
093300             MOVE DP020-FK-ACTION (DP020-SRC-AID)                 09330069
093400                                   TO PM-A-FK-ACTION              09340069
093500             MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)              09350069
093600                                   TO PM-A-FK-DISPN               09360069
093700             MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)      09370069
093800             MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'        09380069
093900                                   TO DP013-MESSAGE-TEXT (4)      09390069
094000             PERFORM DP013-0000-PROCESS-ABEND                     09400069
094100     END-EVALUATE.                                                09410069
094200                                                                  09420069
094300                                                                  09430069
094400*----------------------------------------------------------------*09440069
094500*  MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE    *09450069
094600*  INTER-APPLICATION COMMAREA.                                   *09460069
094700*----------------------------------------------------------------*09470069
094800 2110-PREPARE-INTER-APPL-COMM.                                    09480069
094900                                                                  09490069
095000     INITIALIZE RC012-INTER-APPL-COMMAREA.                        09500069
095100     INITIALIZE PC120-INTER-APPL-COMMAREA.                        09510069
095200                                                                  09520069
095300     IF  DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                   09530069
095400             MOVE RECEIV-OPER-UNT-ID   TO RC012-OPER-UNT-ID       09540069
095500             MOVE ASC-FCLTY-ID-N       TO RC012-FCLTY-ID          09550069
095600             MOVE ASC-PO-NBR-N         TO RC012-PO-NBR            09560069
095700             MOVE ZEROES               TO RC012-REC-SEQ-NBR       09570069
095800     ELSE                                                         09580069
095900     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                   09590069
096000             MOVE RECEIV-OPER-UNT-ID   TO RC012-OPER-UNT-ID       09600069
096100             MOVE ASC-FCLTY-ID-N       TO RC012-FCLTY-ID          09610069
096200             MOVE ASC-PO-NBR-N         TO RC012-PO-NBR            09620069
096300             MOVE ASC-REC-SEQ-NBR-N    TO RC012-REC-SEQ-NBR       09630069
096400     ELSE                                                         09640069
096500         MOVE ASC-PO-NBR-N             TO PC120-PO-NBR            09650069
096600         MOVE ASC-REC-SEQ-NBR-N        TO PC120-REC-SEQ-NBR       09660069
096700         MOVE ASC-OPER-UNT-ID-N        TO PC120-OPER-UNT-ID       09670069
096800         MOVE ASC-FCLTY-ID-N           TO PC120-FCLTY-ID          09680069
096900         MOVE ASC-CURR-OPER-UNT-ID-N   TO PC120-CURR-OPER-UNT-ID  09690069
097000         MOVE ASC-CURR-FCLTY-ID-N      TO PC120-CURR-FCLTY-ID     09700069
097100         MOVE ASC-SML-P2L-PRTR-ID      TO PC120-SML-P2L-PRTR-ID   09710069
097200         MOVE ASC-PGYBCK-PRTR-ID       TO PC120-PGYBCK-PRTR-ID    09720069
097300         MOVE ASC-MODU-NBR-N           TO PC120-MODU-NBR          09730069
097400         MOVE ASC-DFLT-STR-ZN-ID       TO PC120-DFLT-STR-ZN-ID    09740069
097500         MOVE ASC-CART-CNT-N           TO PC120-CART-CNT          09750069
097600         MOVE ASC-INPK-UNT-QTY-N       TO PC120-INPK-UNT-QTY      09760069
097700         MOVE ASC-OTPK-UNT-QTY-N       TO PC120-OTPK-UNT-QTY      09770069
097800         MOVE ASC-CRE-LBL-IND          TO PC120-CRE-LBL-IND       09780069
097900         MOVE ASC-LBL-PRT-ORDER        TO PC120-LBL-PRT-ORDER     09790069
098000         MOVE ASC-SPEC-INST-DESC       TO PC120-SPEC-INST-DESC    09800069
098100         MOVE ASC-PO-LINE-NBR-N        TO PC120-PO-LINE-NBR       09810069
098200         MOVE ASC-ODD-CART-UNT-QTY     TO PC120-ODD-CARTON        09820069
098300         MOVE ASC-ODD-CRTN-USE-SW      TO PC120-ODD-CRTN-USE-SW   09830069
098400*11/27                                                            09840069
098500         MOVE ASC-FCSE-AREA-ID  TO  PC120-FCSE-PROCESS-AREA       09850069
098600         MOVE ASC-PRT-HEAD-FOOT TO  PC120-PRT-HEAD-FOOT           09860069
098700*11/27                                                            09870069
098800         MOVE PV-SHP-PRTR-CLUSTER-NBR                             09880069
098900                                TO PC120-SHP-PRTR-CLUSTER-NBR     09890069
099000         MOVE PV-SHP-PRTR-ID-ADDR                                 09900069
099100                                TO PC120-SHP-PRTR-IP-ADDR         09910069
099200         MOVE PV-SHP-PRTR-OS-RLSE-CDE                             09920069
099300                                TO PC120-SHP-PRTR-OS-RLSE-CDE     09930069
099400         MOVE PV-SHP-DATA-XFER-MODE-ID                            09940069
099500                                TO PC120-SHP-DATA-XFER-MODE-ID    09950069
099600         MOVE PV-SHP-XMIT-INTFC-CDE                               09960069
099700                                TO PC120-SHP-XMIT-INTFC-CDE       09970069
099800         MOVE PV-PGYBK-PRTR-CLUSTER-NBR                           09980069
099900                                TO PC120-PGYBCK-PRTR-CLUSTER-NBR  09990069
100000         MOVE PV-PGYBK-PRTR-ID-ADDR                               10000069
100100                                TO PC120-PGYBCK-PRTR-IP-ADDR      10010069
100200         MOVE PV-PGYBK-PRTR-OS-RLSE-CDE                           10020069
100300                                TO PC120-PGYBCK-PRTR-OS-RLSE-CDE  10030069
100400         MOVE PV-PGYBK-DATA-XFER-MODE-ID                          10040069
100500                                TO PC120-PGYBCK-DATA-XFER-MODE-ID 10050069
100600         MOVE PV-PGYBK-XMIT-INTFC-CDE                             10060069
100700                                TO PC120-PGYBCK-XMIT-INTFC-CDE    10070069
100800         MOVE PV-DC-PRTD-AT                                       10080069
100900                                TO PC120-DC-PRTD-AT               10090069
101000         MOVE ASC-PKGNG-CD      TO PC120-PKGNG-CD                 10100069
101100         MOVE ASC-DSPLY-PKGNG-CD TO PC120-DSPLY-PKGNG-CD          10110069
101200         MOVE ASC-UCC128-DATA-EXISTS-SW                           10120069
101210                                 TO PC120-UCC128-DATA-AVAIL-SW    10121069
101211         IF  ASC-UCC128-DATA-EXISTS                               10121169
101212             IF  ASC-USE-UCC128-DATA-YES                          10121269
101213                 SET  PC120-USE-UCC128-DATA-YES  TO  TRUE         10121369
101214             ELSE                                                 10121469
101215                 SET  PC120-USE-UCC128-DATA-IGN  TO  TRUE         10121569
101216             END-IF                                               10121669
101217         ELSE                                                     10121769
101218             SET  PC120-USE-UCC128-DATA-NO       TO  TRUE         10121869
101219         END-IF                                                   10121969
101221*05/07/03                                                         10122199
101222         MOVE ASC-DPT-NBR       TO PC120-DPT-NBR                  10122299
101223*05/07/03                                                         10122399
101224*12/05/03 GB                                                      10122499
101225         MOVE ASC-AUTOVE-PARM-SW TO PC120-AUTOVE-DC-SW            10122599
101226*12/05/03 GB                                                      10122699
101227         MOVE ASC-TRIP-ARRIVE-DATE TO PC120-TRIP-ARRIVE-DATE      10122799
101228     END-IF.                                                      10122899
101230                                                                  10123069
101240                                                                  10124069
101250*----------------------------------------------------------------*10125069
101260* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*10126069
101270* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *10127069
101280* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *10128069
101290*----------------------------------------------------------------*10129069
101300 2200-MOVE-SCREEN-TO-COMMAREA.                                    10130069
101400                                                                  10140069
101500* OPERATING UNIT ID / FACILITY                                    10150069
101600     IF  MOPIDL > ZERO                                            10160069
101700         MOVE MOPIDI               TO PV-OPER-FCLTY-HOLD          10170069
101800         MOVE PV-OPER-UNT-HOLD     TO ASC-OPER-UNT-ID             10180069
101900         MOVE PV-FCLTY-ID-HOLD     TO ASC-FCLTY-ID                10190069
102000     ELSE                                                         10200069
102100         MOVE ZEROES               TO ASC-OPER-UNT-ID             10210069
102200                                      ASC-FCLTY-ID                10220069
102300     END-IF.                                                      10230069
102400                                                                  10240069
102500* PURCHASE ORDER NUMBER                                           10250069
102600     IF  MPONBRL > ZERO                                           10260069
102700         MOVE MPONBRI              TO ASC-PO-NBR                  10270069
102800     ELSE                                                         10280069
102900         IF  MPONBRF = DP015-ERASE-EOF                            10290069
103000             MOVE ZEROES           TO ASC-PO-NBR                  10300069
103100         END-IF                                                   10310069
103200     END-IF.                                                      10320069
103300                                                                  10330069
103400* RECEIVER SEQUENCE NUMBER                                        10340069
103500     IF  MRECVRL > ZERO                                           10350069
103600         MOVE MRECVRI              TO ASC-REC-SEQ-NBR             10360069
103700     ELSE                                                         10370069
103800         IF  MRECVRF = DP015-ERASE-EOF                            10380069
103900             MOVE ZEROES           TO ASC-REC-SEQ-NBR             10390069
104000         END-IF                                                   10400069
104100     END-IF.                                                      10410069
104200                                                                  10420069
104300* PURCHASE ORDER LINE NUMBER                                      10430069
104400     IF  MLINEL > ZERO                                            10440069
104500         MOVE MLINEI              TO ASC-PO-LINE-NBR              10450069
104600     ELSE                                                         10460069
104700         IF  MLINEF = DP015-ERASE-EOF                             10470069
104800             MOVE SPACES           TO ASC-PO-LINE-NBR             10480069
104900         END-IF                                                   10490069
105000     END-IF.                                                      10500069
105100                                                                  10510069
105200* SHIPPING MANIFEST LABELS/PACK-TO-LIGHT LABELS --- PRINTER ID    10520069
105300     IF  MDEST1L > ZERO                                           10530069
105400         MOVE MDEST1I              TO ASC-SML-P2L-PRTR-ID         10540069
105500     ELSE                                                         10550069
105600         IF  MDEST1F = DP015-ERASE-EOF                            10560069
105700             MOVE SPACES           TO ASC-SML-P2L-PRTR-ID         10570069
105800         END-IF                                                   10580069
105900     END-IF.                                                      10590069
106000                                                                  10600069
106100* PIGGYBACK LABEL PRINTER ID                                      10610069
106200     IF  MDEST2L > ZERO                                           10620069
106300         MOVE MDEST2I              TO ASC-PGYBCK-PRTR-ID          10630069
106400     ELSE                                                         10640069
106500         IF  MDEST2F = DP015-ERASE-EOF                            10650069
106600             MOVE SPACES           TO ASC-PGYBCK-PRTR-ID          10660069
106700         END-IF                                                   10670069
106800     END-IF.                                                      10680069
106900                                                                  10690069
107000* OPTIONAL - P2L MODULE NUMBER                                    10700069
107100     IF  MP2LMODL > ZERO                                          10710069
107200         MOVE MP2LMODI             TO ASC-MODU-NBR                10720069
107300     ELSE                                                         10730069
107400         IF  MP2LMODF = DP015-ERASE-EOF                           10740069
107500             MOVE ZEROES           TO ASC-MODU-NBR                10750069
107600         END-IF                                                   10760069
107700     END-IF.                                                      10770069
107800                                                                  10780069
107900* DEFAULT STORE ZONE                                              10790069
108000     IF  MZONEL > ZERO                                            10800069
108100         MOVE MZONEI               TO ASC-DFLT-STR-ZN-ID          10810069
108200     ELSE                                                         10820069
108300         IF  MZONEF = DP015-ERASE-EOF                             10830069
108400             MOVE ZEROES           TO ASC-DFLT-STR-ZN-ID          10840069
108500         END-IF                                                   10850069
108600     END-IF.                                                      10860069
108700                                                                  10870069
108800* CARTON COUNT                                                    10880069
108900     IF  MCTNCNTL > ZERO                                          10890069
109000         MOVE MCTNCNTI             TO ASC-CART-CNT                10900069
109100     ELSE                                                         10910069
109200         IF  MCTNCNTF = DP015-ERASE-EOF                           10920069
109300             MOVE ZEROES           TO ASC-CART-CNT                10930069
109400         END-IF                                                   10940069
109500     END-IF.                                                      10950069
109600                                                                  10960069
109700* INNER PACK QUANTITY                                             10970069
109800     IF  MINPACKL > ZERO                                          10980069
109900         MOVE MINPACKI             TO ASC-INPK-UNT-QTY            10990069
110000     ELSE                                                         11000069
110100         IF  MINPACKF = DP015-ERASE-EOF                           11010069
110200             MOVE ZEROES           TO ASC-INPK-UNT-QTY            11020069
110300         END-IF                                                   11030069
110400     END-IF.                                                      11040069
110500                                                                  11050069
110600* OUTER PACK QUANTITY                                             11060069
110700     IF  MOUTPCKL > ZERO                                          11070069
110800         MOVE MOUTPCKI             TO ASC-OTPK-UNT-QTY            11080069
110900     ELSE                                                         11090069
111000         IF  MOUTPCKF = DP015-ERASE-EOF                           11100069
111100             MOVE ZEROES           TO ASC-OTPK-UNT-QTY            11110069
111200         END-IF                                                   11120069
111300     END-IF.                                                      11130069
111400                                                                  11140069
111500* CREATE LABEL OPTION                                             11150069
111600     IF  MLBLOPTL > ZERO                                          11160069
111700         MOVE MLBLOPTI             TO ASC-CRE-LBL-IND             11170069
111800     ELSE                                                         11180069
111900         IF  MLBLOPTF = DP015-ERASE-EOF                           11190069
112000             MOVE SPACES           TO ASC-CRE-LBL-IND             11200069
112100         END-IF                                                   11210069
112200     END-IF.                                                      11220069
112300                                                                  11230069
112400* LABEL PRINT ORDER                                               11240069
112500     IF  MPRTORDL > ZERO                                          11250069
112600         MOVE MPRTORDI             TO ASC-LBL-PRT-ORDER           11260069
112700     ELSE                                                         11270069
112800         IF  MPRTORDF = DP015-ERASE-EOF                           11280069
112900             MOVE SPACES           TO ASC-LBL-PRT-ORDER           11290069
113000         END-IF                                                   11300069
113100     END-IF.                                                      11310069
113200                                                                  11320069
113300*11/27 - BEGIN                                                    11330069
113400* PRINT HEADER/FOOTER                                             11340069
113500     IF  MHDRFTL > ZERO                                           11350069
113600         MOVE MHDRFTI              TO ASC-PRT-HEAD-FOOT           11360069
113700     ELSE                                                         11370069
113800         IF  MHDRFTF = DP015-ERASE-EOF                            11380069
113900             MOVE SPACES           TO ASC-PRT-HEAD-FOOT           11390069
114000         END-IF                                                   11400069
114100     END-IF.                                                      11410069
114200                                                                  11420069
114300* CASEPACK PROCESS AREA                                           11430069
114400     IF  MCSEPKL > ZERO                                           11440069
114500         MOVE MCSEPKI               TO ASC-FCSE-AREA-ID           11450069
114600     ELSE                                                         11460069
114700         IF  MCSEPKF = DP015-ERASE-EOF                            11470069
114800             MOVE SPACES            TO ASC-FCSE-AREA-ID           11480069
114900         END-IF                                                   11490069
115000     END-IF.                                                      11500069
115100*11/27 - END                                                      11510069
115200                                                                  11520069
115300* SPECIAL INSTRUCTIONS                                            11530069
115400     IF  MINSTRL > ZERO                                           11540069
115500         MOVE MINSTRI              TO ASC-SPEC-INST-DESC          11550069
115600***  ELSE                                                         11560069
115700***      MOVE ASC-DFLT-STR-ZN-ID   TO ASC-SPEC-INST-DESC          11570069
115800     END-IF.                                                      11580069
115810                                                                  11581099
116000* USE UCC128 DATA (Y/N)                                           11600069
116100     IF  USE128L > ZERO                                           11610069
116200         MOVE USE128I              TO ASC-USE-UCC128-DATA-SW      11620069
116300     ELSE                                                         11630069
116400         IF  USE128F = DP015-ERASE-EOF                            11640069
116500             MOVE SPACES           TO ASC-USE-UCC128-DATA-SW      11650069
116600         END-IF                                                   11660069
116700     END-IF.                                                      11670069
116800                                                                  11680069
116900                                                                  11690069
117000                                                                  11700069
117100*----------------------------------------------------------------*11710069
117200* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *11720069
117300* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *11730069
117400* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*11740069
117500* IN THE DESTINATION PROGRAM, NOT HERE.                          *11750069
117600*----------------------------------------------------------------*11760069
117700 3000-EDIT-DATA-IN-COMMAREA.                                      11770069
117800                                                                  11780069
117900     PERFORM 3200-RESET-ATTRIBUTES.                               11790069
118000                                                                  11800069
118001*  DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID) = F24 LBLRPRT            11800199
118002*  CHECK TO SEE IF DC IS SET UP ON WMOS, THEN F24 IS NOT ALLOWED  11800299
118010* JAK 04/2007 - START                                             11801099
118011     IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                    11801199
118020         PERFORM 5010-GET-CURR-TMST                               11802099
118030         MOVE ASC-OPER-UNT-ID      TO DK-OPER-UNT-ID              11803099
118040         PERFORM 5020-CHECK-DC-WMOS                               11804099
118050         IF PS-DC-ON-WMOS-YES                                     11805099
118060             SET PS-ERROR                                         11806099
118070                 DP020-MSG-FATAL   TO TRUE                        11807099
118080             MOVE PC-TSYMSG-03554  TO DP020-MSG-NUMBER            11808099
118090             MOVE DP015-UNP-ALP-BRT-OFF                           11809099
118091                                       TO MPONBRA                 11809199
118092             MOVE DP015-RED        TO MPONBRC                     11809299
118093             MOVE DP015-REVERSE    TO MPONBRH                     11809399
118094             MOVE -1               TO MPONBRL                     11809499
118095             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11809599
118096         END-IF                                                   11809699
118097     END-IF.                                                      11809799
118098* JAK 04/2007 - END                                               11809899
118100*-----------------------------------------------------------------11810069
118200* VERIFY THAT PURCHASE ORDER NUMBER WAS ENTERED AND IS NUMERIC    11820069
118300*-----------------------------------------------------------------11830069
118310* JAK 04/2007 - ADD CHECK FOR ERROR                               11831099
118400     IF PS-NO-ERROR                                               11840099
118410      IF ASC-PO-NBR  > SPACES                                     11841099
118500         MOVE ASC-PO-NBR               TO DP010I-UNEDITED-FIELD   11850069
118600         MOVE LENGTH OF ASC-PO-NBR     TO DP010I-MAXIMUM-DIGITS   11860069
118700         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 11870069
118800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  11880069
118910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11891099
118920                         USING DP010I-NUMERIC-EDIT-AREA           11892099
119000         IF  DP010I-ERROR-DETECTED                                11900069
119100             SET PS-ERROR                                         11910069
119200                 DP020-MSG-FATAL       TO TRUE                    11920069
119300             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        11930069
119400             MOVE DP015-UNP-ALP-BRT-OFF                           11940069
119500                                       TO MPONBRA                 11950069
119600             MOVE DP015-RED            TO MPONBRC                 11960069
119700             MOVE DP015-REVERSE        TO MPONBRH                 11970069
119800             MOVE -1                   TO MPONBRL                 11980069
119900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11990069
120000         ELSE                                                     12000069
120100             MOVE DP010I-NUMERIC-FIELD                            12010069
120200                                   TO ASC-PO-NBR-N                12020069
120300                                      MPONBRO                     12030069
120400         END-IF                                                   12040069
120500      ELSE                                                        12050099
120600         SET PS-ERROR                                             12060069
120700             DP020-MSG-FATAL       TO TRUE                        12070069
120800         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            12080069
120900         MOVE DP015-UNP-ALP-BRT-OFF                               12090069
121000                                   TO MPONBRA                     12100069
121100         MOVE DP015-RED            TO MPONBRC                     12110069
121200         MOVE DP015-REVERSE        TO MPONBRH                     12120069
121300         MOVE -1                   TO MPONBRL                     12130069
121400         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      12140069
121500      END-IF                                                      12150099
121600                                                                  12160069
121700*-----------------------------------------------------------------12170069
121800* VERIFY THAT RECEIVER SEQUENCE NUMBER WAS ENTERED AND IS NUMERIC 12180069
121900*-----------------------------------------------------------------12190069
122000*    IF  PS-NO-ERROR                                              12200069
122100         IF  ASC-REC-SEQ-NBR > SPACES                             12210069
122200             MOVE ASC-REC-SEQ-NBR      TO DP010I-UNEDITED-FIELD   12220069
122300             MOVE LENGTH OF ASC-REC-SEQ-NBR                       12230069
122400                                       TO DP010I-MAXIMUM-DIGITS   12240069
122500             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 12250069
122600             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              12260069
122710             CALL DP010I-NUMERIC-EDIT-ROUTINE                     12271099
122720                         USING DP010I-NUMERIC-EDIT-AREA           12272099
122800             IF  DP010I-ERROR-DETECTED                            12280069
122900                 SET PS-ERROR                                     12290069
123000                     DP020-MSG-FATAL       TO TRUE                12300069
123100             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        12310069
123200             MOVE DP015-UNP-ALP-BRT-OFF                           12320069
123300                                       TO MRECVRA                 12330069
123400             MOVE DP015-RED            TO MRECVRC                 12340069
123500             MOVE DP015-REVERSE        TO MRECVRH                 12350069
123600             MOVE -1                   TO MRECVRL                 12360069
123700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12370069
123800             ELSE                                                 12380069
123900                 MOVE DP010I-NUMERIC-FIELD                        12390069
124000                                       TO ASC-REC-SEQ-NBR-N       12400069
124100                                          MRECVRO                 12410069
124200             END-IF                                               12420069
124300         ELSE                                                     12430069
124400             SET PS-ERROR                                         12440069
124500                 DP020-MSG-FATAL       TO TRUE                    12450069
124600             MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER        12460069
124700             MOVE DP015-UNP-ALP-BRT-OFF                           12470069
124800                                       TO MRECVRA                 12480069
124900             MOVE DP015-RED            TO MRECVRC                 12490069
125000             MOVE DP015-REVERSE        TO MRECVRH                 12500069
125100             MOVE -1                   TO MRECVRL                 12510069
125200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12520069
125300         END-IF                                                   12530099
125400*    END-IF.                                                      12540069
125410* JAK 04/2007 - ADD END-IF                                        12541099
125420     END-IF.                                                      12542099
125500                                                                  12550069
125600*-----------------------------------------------------------------12560069
125700* VERIFY PO/RCVR NUMBER IS VALID IN RECEIVING SYSTEM              12570069
125800*-----------------------------------------------------------------12580069
125900     MOVE  MPONBRI     TO  PV-PO-NUMBER-HOLD.                     12590069
126000     MOVE  MRECVRI     TO  PV-REC-SEQ-HOLD.                       12600069
126100     IF  PS-NO-ERROR                                              12610069
126200         EXEC SQL                                                 12620069
126300             SELECT CURR_OPER_UNT_ID                              12630069
126400                   ,OPER_UNT_ID                                   12640069
126500                   ,REC_TMST                                      12650069
126600                   ,STATUS_CDE                                    12660069
126700                   ,PACK_BY_ST_IND                                12670069
126800                   ,PKGNG_CDE                                     12680069
126810                   ,GOH_IND                                       12681099
126900               INTO :RECEIV-CURR-OPER-UNT-ID                      12690069
127000                   ,:RECEIV-OPER-UNT-ID                           12700069
127100                   ,:RECEIV-REC-TMST                              12710069
127200                   ,:RECEIV-STATUS-CDE                            12720069
127300                   ,:RECEIV-PACK-BY-ST-IND                        12730069
127400                   ,:RECEIV-PKGNG-CDE                             12740069
127410                   ,:RECEIV-GOH-IND                               12741099
127500               FROM TRECEIV                                       12750069
127600              WHERE ORD_NBR       =  :PV-PO-NUMBER-HOLD           12760069
127700                AND REC_SEQ_NBR   =  :PV-REC-SEQ-HOLD             12770069
127800         END-EXEC                                                 12780069
127900                                                                  12790069
128000         EVALUATE TRUE                                            12800069
128100             WHEN SQLCODE = +0                                    12810069
128110                  MOVE  RECEIV-GOH-IND                            12811099
128120                            TO ASC-HANGER-IND                     12812099
128200                  MOVE  RECEIV-PACK-BY-ST-IND                     12820069
128300                            TO ASC-PACK-BY-ST-IND                 12830069
128400                  MOVE  RECEIV-CURR-OPER-UNT-ID                   12840069
128500                            TO  ASC-CURR-OPER-UNT-ID              12850069
128600                                PV-CURR-OPER-UNT-HOLD             12860069
128700                                DK-OPER-UNT-ID                    12870069
128800                  MOVE  PC-FCLTY-ID-0001                          12880069
128900                            TO  ASC-CURR-FCLTY-ID                 12890069
129000                                PV-CURR-FCLTY-ID-HOLD             12900069
129100                                DK-FCLTY-ID                       12910069
129110                  MOVE  PV-CURR-OPER-FCLTY-HOLD                   12911069
129120                            TO  MCOPIDO                           12912069
129130                  PERFORM 7010-GET-FCLTY-NAME                     12913069
129140                  MOVE PV-FCLTY-NME  TO MCOPDSCO                  12914069
129150                  SET  PS-NO-UCC128-DATA-EXISTS                   12915069
129160                       ASC-NO-UCC128-DATA-EXISTS  TO  TRUE        12916069
129170                  MOVE  ZEROES          TO  PV-UCC128-COUNT       12917069
129180                                                                  12918069
129190****************************************************************  12919069
129200* CHANGED TO ALLOW CHECK FOR UCC128 DATA FOR ALL PO'S          *  12920069
129300****************************************************************  12930069
129301* DMH             IF  RECEIV-PKGNG-CDE  = 'M'  OR                 12930169
129302* DMH                 RECEIV-PKGNG-CDE  = 'I'                     12930269
129303* DMH                 CONTINUE                                    12930369
129304* DMH             ELSE                                            12930469
129305                      PERFORM 7050-CHECK-UCC128-DATA              12930569
129306* DMH             END-IF                                          12930669
129307****************************************************************  12930769
129308                PERFORM 3100-CHECK-AUTOVE-DC                      12930899
129309                IF  PS-NO-ERROR                                   12930999
129310                  IF  PS-UCC128-DATA-EXISTS                       12931069
129311                      MOVE 'UCC-128 DATA'  TO MUCC128O            12931169
129320                      MOVE DP015-YELLOW    TO MUCC128C            12932069
129322                    IF ASC-AUTOVE-PARM-YES                        12932299
129323                       SET  ASC-USE-UCC128-DATA-YES  TO  TRUE     12932399
129324                       MOVE ASC-USE-UCC128-DATA-SW TO USE128O     12932499
129325                       MOVE DP015-ASK-NOR-MDT       TO  USE128A   12932599
129326                       MOVE DP015-GREEN             TO  USE128C   12932699
129328                       MOVE DP015-HL-OFF            TO  USE128H   12932899
129330                    ELSE                                          12933099
129331                      IF  ASC-USE-UCC128-DATA-UNKNOWN             12933169
129332                          SET  ASC-USE-UCC128-DATA-YES  TO  TRUE  12933269
129333                          MOVE ASC-USE-UCC128-DATA-SW             12933369
129334                            TO USE128O                            12933469
129335                      MOVE DP015-YELLOW    TO USE128C             12933569
129336                      END-IF                                      12933669
129337                      IF  ASC-USE-UCC128-DATA-NO                  12933769
129338                          MOVE ASC-USE-UCC128-DATA-SW             12933869
129339                            TO USE128O                            12933969
129340                          MOVE DP015-GREEN     TO USE128C         12934069
129341                      END-IF                                      12934169
129342                    END-IF                                        12934299
129343                  ELSE                                            12934369
129344                      SET  ASC-USE-UCC128-DATA-NO  TO  TRUE       12934469
129345                      MOVE SPACES                  TO  MUCC128O   12934569
129346                      MOVE DP015-BLUE              TO  MUCC128C   12934669
129347                      MOVE ASC-USE-UCC128-DATA-SW  TO  USE128O    12934769
129348                      MOVE DP015-BLUE              TO  USE128C    12934869
129349                      MOVE DP015-ASK-NOR-OFF       TO  USE128A    12934969
129350                      MOVE DP015-HL-OFF            TO  USE128H    12935069
129351                  END-IF                                          12935169
129352                  MOVE RECEIV-PKGNG-CDE TO ASC-PKGNG-CD           12935269
129360                  MOVE RECEIV-PKGNG-CDE TO ASC-DSPLY-PKGNG-CD     12936069
129370*GB 9/28/04       IF  ASC-PRE-PACK-ORDER                          12937099
129380*                     PERFORM 7040-PREPK-PROCESSED-OLD            12938099
129390*                 END-IF                                          12939099
129400                  IF  ASC-DSP-PRE-PACK-ORDER                      12940069
129500                      MOVE DP015-YELLOW    TO MPKGCDC             12950069
129600                  END-IF                                          12960069
129700                  MOVE SPACES                TO MPKGCDO           12970069
129800                  IF  ASC-DSP-INNER-PREPK                         12980069
129801                      MOVE  PC-INNER-PREPACK TO MPKGCDO           12980169
129802                  ELSE                                            12980269
129803                  IF  ASC-DSP-MULTI-SKU-PREPK                     12980369
129804                      MOVE  PC-MULTI-SKU     TO MPKGCDO           12980469
129805                  ELSE                                            12980569
129806                  IF  ASC-DSP-SINGLE-SKU-PREPK                    12980669
129807                      MOVE  PC-SINGLE-SKU    TO MPKGCDO           12980769
129808                  ELSE                                            12980869
129809                  IF  ASC-DSP-CASEPACK                            12980969
129810                      MOVE  PC-CASEPACK      TO MPKGCDO           12981069
129811                  ELSE                                            12981169
129812                  IF  ASC-DSP-BULK-PACK                           12981269
129813                      MOVE  PC-BULK          TO MPKGCDO           12981369
129814                  END-IF                                          12981469
129815                  END-IF                                          12981569
129816                  END-IF                                          12981669
129817                  END-IF                                          12981769
129818                  END-IF                                          12981869
129819                END-IF                                            12981999
129820             WHEN SQLCODE = +100                                  12982099
129821                  MOVE SPACES           TO MPKGCDO                12982199
129830                                           ASC-PKGNG-CD           12983069
129840                                           ASC-DSPLY-PKGNG-CD     12984069
129850                  SET PS-ERROR                                    12985069
129860                      DP020-MSG-FATAL      TO TRUE                12986069
129870                  MOVE PC-TSYMSG-00954     TO DP020-MSG-NUMBER    12987069
129880                  MOVE DP015-UNP-ALP-BRT-OFF                      12988069
129890                                           TO MPONBRA             12989069
129900                                              MRECVRA             12990069
130000                  MOVE DP015-RED           TO MPONBRC             13000069
130100                                              MRECVRC             13010069
130200                  MOVE DP015-REVERSE       TO MPONBRH             13020069
130300                                              MRECVRH             13030069
130400                  MOVE -1                  TO MPONBRL             13040069
130500                                              MPONBRL             13050069
130600                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             13060069
130700             WHEN OTHER                                           13070069
130800                  MOVE '3000-EDIT-DATA-IN-COMMAREA'               13080069
130900                                   TO DP013-PARAGRAPH             13090069
131000                  MOVE 'VERIFY PO/RCVR IN SYSTEM'                 13100069
131100                                   TO DP013-MESSAGE-TEXT (1)      13110069
131200                  MOVE SQLCA       TO DP013-SQLCA                 13120069
131300                  MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)    13130069
131400                  SET DP013-DB2-ABEND                             13140069
131500                      DP013-XCTL-DISPLAY-RESTART                  13150069
131600                                   TO TRUE                        13160069
131700                  PERFORM DP013-0000-PROCESS-ABEND                13170069
131800         END-EVALUATE                                             13180069
131900     END-IF.                                                      13190069
132000                                                                  13200069
132100                                                                  13210069
132200*----------------------------------------------------------------*13220069
132300* GET DEPARTMENT NUMBER TO PASS THROUGH COMM-AREA                *13230099
132400*----------------------------------------------------------------*13240069
132421     IF  PS-NO-ERROR                                              13242199
132422         PERFORM 3700-GET-PO-DEPT                                 13242299
132423     END-IF.                                                      13242399
132424                                                                  13242499
132425                                                                  13242599
132430*----------------------------------------------------------------*13243099
132440* IF PRE-PACK TYPE= I -OR- M - DO NOT ALLOW PIGGYBACK            *13244099
132450*----------------------------------------------------------------*13245099
132500     IF  PS-NO-ERROR                                              13250069
132600         IF  ASC-PRE-PACK-ORDER                                   13260069
132700             IF  ASC-PGYBCK-PRTR-ID > SPACES                      13270069
132800                 SET  PS-ERROR         TO TRUE                    13280069
132900                 MOVE PC-TSYMSG-02424  TO DP020-MSG-NUMBER        13290069
133000                 MOVE DP015-UNP-ALP-BRT-OFF                       13300069
133100                                       TO MDEST2A                 13310069
133200                 MOVE DP015-RED        TO MDEST2C                 13320069
133300                                          MPKGCDC                 13330069
133400                 MOVE DP015-REVERSE    TO MDEST2H                 13340069
133500                 MOVE -1               TO MDEST2L                 13350069
133600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13360069
133700             END-IF                                               13370069
133800         END-IF                                                   13380069
133900     END-IF.                                                      13390069
134000                                                                  13400069
134100                                                                  13410069
134200*-----------------------------------------------------------------13420069
134300* SELECT STORE ZONE TO BE DISPLAYED ON THE SCREEN                 13430069
134400*-----------------------------------------------------------------13440069
134500     MOVE  ASC-PO-NBR  TO  PV-PO-NUMBER-HOLD.                     13450069
134600     IF  PS-NO-ERROR                                              13460069
134700         EXEC SQL                                                 13470069
134800             SELECT C.STR_ZN_ID                                   13480069
134900               INTO :MDSEDP-STR-ZN-ID                             13490069
135000               FROM TPURCHS A,                                    13500069
135100                    TMDSEAR B,                                    13510069
135200                    TMDSEDP C                                     13520069
135300              WHERE A.PO_NBR         = :PV-PO-NUMBER-HOLD         13530069
135400                AND A.VER_STATUS_CDE = 'A'                        13540069
135500                AND A.DEPT_NBR       = B.DEPT_NBR                 13550069
135600                AND B.MDSELV_CDE     = 'DPT'                      13560069
135700                AND B.OPERCO_NBR     = '03'                       13570069
135800                AND (B.STRT_DTE     <= CURRENT DATE  AND          13580069
135900                     B.END_DTE      >  CURRENT DATE)              13590069
136000                AND B.MDSEAR_DKEY    = C.MDSEAR_DKEY              13600069
136100         END-EXEC                                                 13610069
136200                                                                  13620069
136300                                                                  13630069
136400         EVALUATE TRUE                                            13640069
136500             WHEN SQLCODE = +0                                    13650069
136600                  MOVE  MDSEDP-STR-ZN-ID                          13660069
136700                            TO  ASC-DFLT-STR-ZN-ID                13670069
136800                                MZONEO                            13680069
136900             WHEN SQLCODE = +100                                  13690069
137000                  MOVE  SPACES TO ASC-DFLT-STR-ZN-ID              13700069
137100                                  MZONEO                          13710069
137200             WHEN OTHER                                           13720069
137300                  MOVE '3000-EDIT-DATA-IN-COMMAREA'               13730069
137400                                   TO DP013-PARAGRAPH             13740069
137500                  MOVE 'SELECT STORE ZONE DISPLY'                 13750069
137600                                   TO DP013-MESSAGE-TEXT (1)      13760069
137700                  MOVE SQLCA       TO DP013-SQLCA                 13770069
137800                  MOVE 'TMDSEDP '  TO DP013-DB2-TABLE-NAME (1)    13780069
137900                  SET DP013-DB2-ABEND                             13790069
138000                      DP013-XCTL-DISPLAY-RESTART                  13800069
138100                                   TO TRUE                        13810069
138200                  PERFORM DP013-0000-PROCESS-ABEND                13820069
138300         END-EVALUATE                                             13830069
138400     END-IF.                                                      13840069
138500                                                                  13850069
138600***  IF  ASC-SPEC-INST-DESC  >  SPACES                            13860069
138700***      CONTINUE                                                 13870069
138800***  ELSE                                                         13880069
138900***      MOVE ASC-DFLT-STR-ZN-ID TO ASC-SPEC-INST-DESC            13890069
139000***  END-IF.                                                      13900069
139100                                                                  13910069
139110                                                                  13911099
139111                                                                  13911199
139112*-----------------------------------------------------------------13911299
139113*                                                                 13911399
139114*** DMH BEGIN - 6/26/12                                           13911499
139115*                                                                 13911599
139116*** CHECK HOW DC IS PROCESSING P2L FREIGHT                        13911699
139117***       HANG/FOLD   (COMBINE ZONES: CHILD, MENS,JRS, WOMEN)     13911799
139118***       HANG/COMMODITY                                          13911899
139119***       COMMODITY                                               13911999
139120***                                                               13912099
139121*** IF HANG/FOLD OR HANG/COMMODITY THE DEFAULT STORE ZONE TO      13912199
139122*** TO BE DISPLAYED WOULD BE FOR WHATEVER ZONE WOULD HAVE THE     13912299
139123*** MOST LINES:                                                   13912399
139124***                                                               13912499
139125*** EX: RECEIVER HAS 5 LINES.  3 LINES ARE HANG  2 LINES ARE FOLD 13912599
139127***     THE DEFAULT STORE ZONE WOULD BE HANG                      13912799
139128*                                                                 13912899
139129*   1.  COUNT THE NUMBER OF RCVR LINES WITH HANG PRESENTATION     13912999
139130*   2.  COUNT THE NUMBER OF RCVR LINES WITH FOLD PRESENTATION     13913099
139131*   3.  COUNT THE NUMBER OF RCVR LINES WITH OTHER PRESENTATION    13913199
139132*   4.  GET GOH_IND (GOODS ON HAND FROM RECEIVER)                 13913299
139133*       Y=VENDOR HANG AGREEMENT   N=NO VENDOR HANG AGREEMENT      13913399
139134*                                                                 13913499
139135*   IF DC IS PROCESSING P2L AS HANG/FOLD  AND                     13913599
139136*      STORE ZONE FOR RECEIVER = CHILD, JRS, MENS, WOMEN          13913699
139137*          IF GOH-IND = Y    ADD OTHER-COUNT TO HANG-COUNT        13913799
139138*          IF GOH-IND = N    ADD OTHER-COUNT TO FOLD-COUNT        13913899
139139*      IF HANG-COUNT >  FOLD-COUNT =====  STORE-ZONE HANG         13913999
139140*         ELSE                                                    13914099
139141*      STORE-ZONE FOR P2L WILL BE FOLD                            13914199
139142*                                                                 13914299
139143* ELSE                                                            13914399
139144*                                                                 13914499
139145*   IF DC IS PROCESSING P2L AS HANG/COMMODITY AND                 13914599
139146*      STORE ZONE FOR RECEIVER = CHILD, JRS, MENS, WOMEN          13914699
139147*          IF GOH-IND = Y    ADD OTHER-COUNT TO HANG-COUNT        13914799
139148*          IF GOH-IND = N    ADD OTHER-COUNT TO COMMODITY-COUNT   13914899
139149*      IF HANG-COUNT >  COMMODITY-COUNT =====  STORE-ZONE HANG    13914999
139150*         ELSE                                                    13915099
139151*      STORE-ZONE FOR P2L WILL BE COMMODITY                       13915199
139152*                                                                 13915299
139158*-----------------------------------------------------------------13915899
139159*                                                                 13915999
139160*** HOW IS DC PROCESSING P2L FREIGHT                              13916099
139161*                                                                 13916199
139162     IF  PS-NO-ERROR                                              13916299
139163         PERFORM 3007-CHECK-P2L-ZONES                             13916399
139164     END-IF.                                                      13916499
139165                                                                  13916599
139166*                                                                 13916699
139167*** IS THE STORE ZONE ONE OF THE ZONES BEING PROCESSED AS H/F     13916799
139168*                                                                 13916899
139169     IF  PS-NO-ERROR                                              13916999
139170         IF  ASC-HANG-FOLD       OR                               13917099
139171             ASC-HANG-COMMODITY                                   13917199
139172             PERFORM 3008-CHECK-HANG-FOLD                         13917299
139173         END-IF                                                   13917399
139174     END-IF.                                                      13917499
139175                                                                  13917599
139176*                                                                 13917699
139177*** COUNT THE NUMBER OF LINES ON THE RCVR WITH HANG PRESENTATION  13917799
139178*                                                                 13917899
139179     IF  PS-NO-ERROR                                              13917999
139180         IF  ASC-HANG-FOLD       OR                               13918099
139181             ASC-HANG-COMMODITY                                   13918199
139182             PERFORM 3015-COUNT-HANG                              13918299
139183         END-IF                                                   13918399
139184     END-IF.                                                      13918499
139185                                                                  13918599
139186*                                                                 13918699
139187*** COUNT THE NUMBER OF LINES ON THE RCVR WITH FOLD PRESENTATION  13918799
139188*                                                                 13918899
139189     IF  PS-NO-ERROR                                              13918999
139190         IF  ASC-HANG-FOLD                                        13919099
139191             PERFORM 3016-COUNT-FOLD                              13919199
139192         END-IF                                                   13919299
139193     END-IF.                                                      13919399
139194                                                                  13919499
139195*                                                                 13919599
139196*** COUNT THE NUMBER OF LINES ON THE RCVR BY COMMODITY NOT HANG   13919699
139197*                                                                 13919799
139198     IF  PS-NO-ERROR                                              13919899
139199         IF  ASC-HANG-COMMODITY                                   13919999
139200             PERFORM 3017-COUNT-COMMODITY                         13920099
139201         END-IF                                                   13920199
139202     END-IF.                                                      13920299
139203                                                                  13920399
139204*                                                                 13920499
139205*** COUNT THE NUMBER OF LINES ON THE RCVR NOT H/F PRESENTATION    13920599
139206*                                                                 13920699
139207     IF  PS-NO-ERROR                                              13920799
139208         IF  ASC-HANG-FOLD                                        13920899
139209             PERFORM 3018-COUNT-OTHER                             13920999
139210         END-IF                                                   13921099
139211     END-IF.                                                      13921199
139212                                                                  13921299
139213*                                                                 13921399
139214* DC PROCESSING P2L AS HANG/FOLD                                  13921499
139215* VENDOR HANGER AGREEMENT (GOH-IND = Y) ADD OTHER TO HANG-COUNT   13921599
139216*                                                                 13921699
139217* DC PROCESSING P2L AS HANG/FOLD                                  13921799
139218* VENDOR HANGER AGREEMENT (GOH-IND = N) ADD OTHER TO FOLD-COUNT   13921899
139219*                                                                 13921999
139220     IF  PS-NO-ERROR                                              13922099
139221         IF  ASC-HANG-FOLD                                        13922199
139222             IF  ASC-HANGER-AGREEMENT                             13922299
139223                 ADD  PV-OTHER-COUNT  TO  PV-HANG-COUNT           13922399
139224                 MOVE ZEROES          TO  PV-OTHER-COUNT          13922499
139225             ELSE                                                 13922599
139227                 ADD  PV-OTHER-COUNT  TO  PV-FOLD-COUNT           13922799
139228                 MOVE ZEROES          TO  PV-OTHER-COUNT          13922899
139230             END-IF                                               13923099
139231         END-IF                                                   13923199
139232     END-IF.                                                      13923299
139233                                                                  13923399
139234*                                                                 13923499
139235* DC PROCESSING P2L AS HANG/COMMODITY                             13923599
139236* VENDOR HANGER AGREEMENT (GOH-IND = Y) ADD OTHER TO HANG-COUNT   13923699
139237*                                                                 13923799
139241     IF  PS-NO-ERROR                                              13924199
139242         IF  ASC-HANG-COMMODITY                                   13924299
139243             IF  ASC-HANGER-AGREEMENT                             13924399
139244                 ADD  PV-OTHER-COUNT  TO  PV-HANG-COUNT           13924499
139245                 MOVE ZEROES          TO  PV-OTHER-COUNT          13924599
139246             END-IF                                               13924699
139247         END-IF                                                   13924799
139248     END-IF.                                                      13924899
139249                                                                  13924999
139250*                                                                 13925099
139251***  IF  DC IS PROCESSING P2L AS HANG/FOLD                        13925199
139252***       IF  HANG-COUNT >=  FOLD COUNT                           13925299
139253***           STORE ZONE WILL BE "HANG"                           13925399
139254***       OHERWISE                                                13925499
139255***           STORE ZONE WILL BE "FOLD"                           13925599
139256*                                                                 13925699
139257     IF  PS-NO-ERROR                                              13925799
139258         IF  ASC-HANG-FOLD                                        13925899
139259                                                                  13925999
139260             IF  PV-HANG-COUNT  >  PV-FOLD-COUNT  OR              13926099
139261                 PV-HANG-COUNT  =  PV-FOLD-COUNT                  13926199
139262                 MOVE  'HANG'  TO  ASC-DFLT-STR-ZN-ID             13926299
139263                                   MZONEO                         13926399
139264                                   PC120-DFLT-STR-ZN-ID           13926499
139265             ELSE                                                 13926599
139266                 MOVE  'FOLD'  TO  ASC-DFLT-STR-ZN-ID             13926699
139267                                   MZONEO                         13926799
139268                                   PC120-DFLT-STR-ZN-ID           13926899
139269             END-IF                                               13926999
139289         END-IF                                                   13928999
139290     END-IF.                                                      13929099
139291                                                                  13929199
139292                                                                  13929299
139293*                                                                 13929399
139294***  IF  DC IS PROCESSING P2L AS HANG/COMMODITY                   13929499
139295***       IF  HANG-COUNT >=  COMMODITY COUNT                      13929599
139296***           STORE ZONE WILL BE "HANG"                           13929699
139297***       OHERWISE                                                13929799
139298***           STORE ZONE WILL BE COMMODITY                        13929899
139299*                                                                 13929999
139300     IF  PS-NO-ERROR                                              13930099
139301         IF  ASC-HANG-COMMODITY                                   13930199
139302             IF  PV-HANG-COUNT  >  PV-COMMODITY-COUNT  OR         13930299
139303                 PV-HANG-COUNT  =  PV-COMMODITY-COUNT             13930399
139304                 MOVE  'HANG'  TO  ASC-DFLT-STR-ZN-ID             13930499
139305                                   PC120-DFLT-STR-ZN-ID           13930599
139306             END-IF                                               13930699
139307         END-IF                                                   13930799
139308     END-IF.                                                      13930899
139309                                                                  13930999
139310                                                                  13931099
139311*                                                                 13931199
139312*** DMH END - 6/26/12                                             13931299
139313*                                                                 13931399
139314                                                                  13931499
139315                                                                  13931599
139316*-----------------------------------------------------------------13931699
139320* FIND P2L MODULE NUMBERS FOR THE DEFAULT STORE ZONE              13932069
139400*-----------------------------------------------------------------13940069
139500     IF  PS-NO-ERROR                                              13950069
139600         PERFORM 3400-GET-P2L-MODULES                             13960069
139700         MOVE PMT-MODULE(1)  TO  MMOD1O                           13970069
139800         MOVE PMT-MODULE(2)  TO  MMOD2O                           13980069
139900         MOVE PMT-MODULE(3)  TO  MMOD3O                           13990069
140000         MOVE PMT-MODULE(4)  TO  MMOD4O                           14000069
140100         MOVE PMT-MODULE(5)  TO  MMOD5O                           14010069
140200     END-IF                                                       14020069
140310                                                                  14031078
140320     PERFORM 3500-CHECK-SEASET-ITEM.                              14032095
140330     IF PS-SEASET-ITEM                                            14033095
140333            MOVE DP015-YELLOW          TO MSETNMC                 14033399
140337            MOVE ZEROS                 TO MMOD1O                  14033795
140338                                          MMOD2O                  14033895
140339                                          MMOD3O                  14033995
140340                                          MMOD4O                  14034095
140341                                          MMOD5O                  14034195
140344     END-IF.                                                      14034495
140345     MOVE ASC-SEASET-SHRT-NME          TO MSETNMO.                14034599
140350                                                                  14035078
140400*-----------------------------------------------------------------14040069
140500* IF PO LINE NUMBER HAS BEEN ENTERED - VERIFY THAT IT IS NUMERIC  14050069
140600*-----------------------------------------------------------------14060069
140700     MOVE  SPACES                      TO ASC-LINE-STATUS.        14070069
140800                                                                  14080069
140900     IF  PS-NO-ERROR                                              14090069
141000         IF  ASC-PO-LINE-NBR > SPACES                             14100069
141100             IF  ASC-PRE-PACK-ORDER                               14110069
141200                 SET  PS-ERROR                                    14120069
141300                      DP020-MSG-FATAL  TO TRUE                    14130069
141400                 MOVE PC-TSYMSG-02437  TO DP020-MSG-NUMBER        14140069
141500                 MOVE DP015-UNP-ALP-BRT-OFF                       14150069
141600                                       TO MLINEA                  14160069
141700                 MOVE DP015-RED        TO MLINEC                  14170069
141800                 MOVE DP015-REVERSE    TO MLINEH                  14180069
141810                 MOVE -1               TO MLINEL                  14181069
141811                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              14181169
141812             ELSE                                                 14181269
141813                 MOVE ASC-PO-LINE-NBR  TO DP010I-UNEDITED-FIELD   14181369
141814                 MOVE LENGTH OF ASC-PO-LINE-NBR                   14181469
141815                                       TO DP010I-MAXIMUM-DIGITS   14181569
141816                 MOVE ZERO             TO DP010I-MAXIMUM-DECIMALS 14181669
141817                 SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE          14181769
141819                 CALL DP010I-NUMERIC-EDIT-ROUTINE                 14181999
141820                         USING DP010I-NUMERIC-EDIT-AREA           14182099
141821                 IF  DP010I-ERROR-DETECTED                        14182169
141822                     SET PS-ERROR                                 14182269
141830                         DP020-MSG-FATAL   TO TRUE                14183069
141840                     MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER    14184069
141850                     MOVE DP015-UNP-ALP-BRT-OFF                   14185069
141860                                       TO MLINEA                  14186069
141870                     MOVE DP015-RED    TO MLINEC                  14187069
141880                     MOVE DP015-REVERSE TO MLINEH                 14188069
141890                     MOVE -1           TO MLINEL                  14189069
141900                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          14190069
142000                 ELSE                                             14200069
142100                     MOVE DP010I-NUMERIC-FIELD                    14210069
142200                                       TO ASC-PO-LINE-NBR-N       14220069
142300                                          MLINEO                  14230069
142400                 END-IF                                           14240069
142500             END-IF                                               14250069
142600         ELSE                                                     14260069
142700            IF DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID) OR           14270069
142800               DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)              14280069
142900                 SET PS-ERROR                                     14290069
143000                     DP020-MSG-FATAL   TO TRUE                    14300069
143100                 MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER        14310069
143200                 MOVE DP015-UNP-ALP-BRT-OFF                       14320069
143300                                       TO MLINEA                  14330069
143400                 MOVE DP015-RED        TO MLINEC                  14340069
143500                 MOVE DP015-REVERSE    TO MLINEH                  14350069
143600                 MOVE -1               TO MLINEL                  14360069
143700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              14370069
143800            END-IF                                                14380069
143900         END-IF                                                   14390069
144000     END-IF.                                                      14400069
144100                                                                  14410069
144200     IF  PS-NO-ERROR                                              14420069
144300         IF  ASC-PO-LINE-NBR = ZEROES                             14430069
144400              IF DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID) OR         14440069
144500                 DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)            14450069
144600                     SET PS-ERROR                                 14460069
144700                         DP020-MSG-FATAL   TO TRUE                14470069
144800                     MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER    14480069
144900                     MOVE DP015-UNP-ALP-BRT-OFF                   14490069
145000                                           TO MLINEA              14500069
145100                     MOVE DP015-RED        TO MLINEC              14510069
145200                     MOVE DP015-REVERSE    TO MLINEH              14520069
145300                     MOVE -1               TO MLINEL              14530069
145400                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          14540069
145500              END-IF                                              14550069
145600         END-IF                                                   14560069
145700     END-IF.                                                      14570069
145800                                                                  14580069
145900*-----------------------------------------------------------------14590069
146000* IF PO LINE NUMBER HAS BEEN ENTERED - VERIFY THAT IT EXISTS      14600069
146100* (TRANSCRIBED) AND THAT THERE IS STORE DISTRIBUTION              14610069
146200* GET LINE-STATUS                                                 14620069
146300*-----------------------------------------------------------------14630069
146400     IF  PS-NO-ERROR                                              14640069
146500         IF  ASC-PO-LINE-NBR > SPACES  AND                        14650069
146600             ASC-PO-LINE-NBR > ZEROES                             14660069
146700             PERFORM 3800-VERIFY-LINE-NBR                         14670069
146800         ELSE                                                     14680069
146900             MOVE SPACES  TO MLINESTO                             14690069
147000                             ASC-LINE-STATUS                      14700069
147100         END-IF                                                   14710069
147200     END-IF.                                                      14720069
147300                                                                  14730069
147400     INITIALIZE  PV-SHP-PRTR-CLUSTER-NBR                          14740069
147500                 PV-SHP-PRTR-ID-ADDR                              14750069
147600                 PV-SHP-PRTR-OS-RLSE-CDE                          14760069
147700                 PV-SHP-DATA-XFER-MODE-ID.                        14770069
147800                                                                  14780069
147900     INITIALIZE  PV-PGYBK-PRTR-CLUSTER-NBR                        14790069
148000                 PV-PGYBK-PRTR-ID-ADDR                            14800069
148100                 PV-PGYBK-PRTR-OS-RLSE-CDE                        14810069
148200                 PV-PGYBK-DATA-XFER-MODE-ID.                      14820069
148300                                                                  14830069
148400                                                                  14840069
148500     INITIALIZE  PV-DC-PRTD-AT.                                   14850069
148600*----------------------------------------------------------------*14860069
148700* PRINTER ID'S ARE NOT REQUIRED FOR THE FOLLOWING:               *14870069
148800*       ENTER                                                    *14880069
148900*   F22-RCVRLST  LOCAL-02                                        *14890069
149000*   F18-TRBLLIST LOCAL-03                                        *14900069
149100*   F17-STORLIST LOCAL-04 & CONFIRMED                            *14910069
149200*                                                                *14920069
149300*   IF F17 & PGYBCK ID IS ENTERED - VALIDATE                     *14930069
149400*----------------------------------------------------------------*14940069
149500     IF  PS-NO-ERROR                                              14950069
149600         IF DP020-NEXT-ACT-INITIAL                                14960069
149700           OR DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             14970069
149800           OR DP020-FK-PREV-SELECTION (DP020-SRC-AID)             14980069
149900             CONTINUE                                             14990069
150000         ELSE                                                     15000069
150100         IF  DP020-SRC-AID = DP016-ENTER             OR           15010069
150200             DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)  OR           15020069
150300             DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)               15030069
150400             CONTINUE                                             15040069
150500         ELSE                                                     15050069
150600         IF  DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)  AND          15060069
150700             ASC-PGYBCK-PRTR-ID  >  SPACES  AND                   15070069
150800             NOT ASC-DO-NOT-PRINT-PGYBK                           15080069
150900                 PERFORM 3060-EDIT-PGYBK-ID                       15090069
151000         ELSE                                                     15100069
151100         IF  DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)  AND          15110069
151200             DISTHD-FCSE-CNFRMN-TMST  NOT = PC-DEFAULT-TIMESTAMP  15120069
151300             CONTINUE                                             15130069
151400         ELSE                                                     15140069
151500             IF  NOT ASC-DO-NOT-PRINT-SML                         15150069
151600                 PERFORM 3050-EDIT-SML-ID                         15160069
151700             END-IF                                               15170069
151800             IF  NOT ASC-DO-NOT-PRINT-PGYBK                       15180069
151900                 PERFORM 3060-EDIT-PGYBK-ID                       15190069
152000             END-IF                                               15200069
152100         END-IF                                                   15210069
152200         END-IF                                                   15220069
152300         END-IF                                                   15230069
152400         END-IF                                                   15240069
152500     END-IF.                                                      15250069
152600                                                                  15260069
152700     PERFORM 3040-GET-DC-PRTD-AT.                                 15270069
152800                                                                  15280069
152900                                                                  15290069
153000*-----------------------------------------------------------------15300069
153100* IF MODULE NUMBER HAS BEEN ENTERED - VERIFY THAT IT IS NUMERIC   15310069
153200*-----------------------------------------------------------------15320069
153300     IF  PS-NO-ERROR                                              15330069
153400         IF  ASC-MODU-NBR > SPACES                                15340069
153500             MOVE ASC-MODU-NBR         TO DP010I-UNEDITED-FIELD   15350069
153600             MOVE LENGTH OF ASC-MODU-NBR                          15360069
153700                                       TO DP010I-MAXIMUM-DIGITS   15370069
153800             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 15380069
153900             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              15390069
154010             CALL DP010I-NUMERIC-EDIT-ROUTINE                     15401099
154020                         USING DP010I-NUMERIC-EDIT-AREA           15402099
154100             IF  DP010I-ERROR-DETECTED                            15410069
154200                 SET PS-ERROR                                     15420069
154300                     DP020-MSG-FATAL   TO TRUE                    15430069
154400                 MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER        15440069
154500                 MOVE DP015-UNP-ALP-BRT-OFF                       15450069
154600                                       TO MP2LMODA                15460069
154700                 MOVE DP015-RED        TO MP2LMODC                15470069
154800                 MOVE DP015-REVERSE    TO MP2LMODH                15480069
154900                 MOVE -1               TO MP2LMODL                15490069
155000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              15500069
155100             ELSE                                                 15510069
155200                 MOVE DP010I-NUMERIC-FIELD                        15520069
155300                                       TO ASC-MODU-NBR-N          15530069
155400                                          MP2LMODO                15540069
155500             END-IF                                               15550069
155600         END-IF                                                   15560069
155700     END-IF.                                                      15570069
155800                                                                  15580069
155900*-----------------------------------------------------------------15590069
156000* IF MODULE NUMBER HAS BEEN ENTERED - VERIFY THAT IT EXISTS       15600069
156100*-----------------------------------------------------------------15610069
156200     IF  PS-NO-ERROR                                              15620069
156300         IF  ASC-MODU-NBR > SPACES  AND                           15630069
156400             ASC-MODU-NBR > ZEROES                                15640069
156500             PERFORM 4000-VERIFY-MODULE-NBR                       15650069
156600         END-IF                                                   15660069
156700     END-IF.                                                      15670069
156800                                                                  15680069
156900*-----------------------------------------------------------------15690069
157000* IF CARTON COUNT/INNER PACK QTY/OUTER PACK QTY HAVE BEEN ENTERED 15700069
157100* VERIFY THAT NUMERIC AND > 0                                     15710069
157200*-----------------------------------------------------------------15720069
157300     IF  PS-NO-ERROR                                              15730069
157400         IF  ASC-CART-CNT > SPACES                                15740069
157500             MOVE ASC-CART-CNT         TO DP010I-UNEDITED-FIELD   15750069
157600             MOVE LENGTH OF ASC-CART-CNT                          15760069
157700                                       TO DP010I-MAXIMUM-DIGITS   15770069
157800             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 15780069
157900             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              15790069
158010             CALL DP010I-NUMERIC-EDIT-ROUTINE                     15801099
158020                         USING DP010I-NUMERIC-EDIT-AREA           15802099
158100             IF  DP010I-ERROR-DETECTED                            15810069
158200                 SET PS-ERROR                                     15820069
158300                     DP020-MSG-FATAL   TO TRUE                    15830069
158400                 MOVE PC-TSYMSG-00342  TO DP020-MSG-NUMBER        15840069
158500                 MOVE DP015-UNP-ALP-BRT-OFF                       15850069
158600                                       TO MCTNCNTA                15860069
158700                 MOVE DP015-RED        TO MCTNCNTC                15870069
158800                 MOVE DP015-REVERSE    TO MCTNCNTH                15880069
158900                 MOVE -1               TO MCTNCNTL                15890069
159000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              15900069
159100             ELSE                                                 15910069
159200                 MOVE DP010I-NUMERIC-FIELD                        15920069
159300                                       TO ASC-CART-CNT-N          15930069
159400                                          MCTNCNTO                15940069
159500             END-IF                                               15950069
159600         END-IF                                                   15960069
159700         IF  ASC-INPK-UNT-QTY > SPACES                            15970069
159800             MOVE ASC-INPK-UNT-QTY     TO DP010I-UNEDITED-FIELD   15980069
159900             MOVE LENGTH OF ASC-INPK-UNT-QTY                      15990069
160000                                       TO DP010I-MAXIMUM-DIGITS   16000069
160100             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 16010069
160200             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              16020069
160310             CALL DP010I-NUMERIC-EDIT-ROUTINE                     16031099
160320                         USING DP010I-NUMERIC-EDIT-AREA           16032099
160400             IF  DP010I-ERROR-DETECTED                            16040069
160500                 SET PS-ERROR                                     16050069
160600                     DP020-MSG-FATAL   TO TRUE                    16060069
160700                 MOVE PC-TSYMSG-00342  TO DP020-MSG-NUMBER        16070069
160800                 MOVE DP015-UNP-ALP-BRT-OFF                       16080069
160900                                       TO MINPACKA                16090069
161000                 MOVE DP015-RED        TO MINPACKC                16100069
161100                 MOVE DP015-REVERSE    TO MINPACKH                16110069
161200                 MOVE -1               TO MINPACKL                16120069
161300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              16130069
161400             ELSE                                                 16140069
161500                 MOVE DP010I-NUMERIC-FIELD                        16150069
161600                                       TO ASC-INPK-UNT-QTY-N      16160069
161700                                          MINPACKO                16170069
161800             END-IF                                               16180069
161900         END-IF                                                   16190069
162000         IF  ASC-OTPK-UNT-QTY > SPACES                            16200069
162100             MOVE ASC-OTPK-UNT-QTY     TO DP010I-UNEDITED-FIELD   16210069
162200             MOVE LENGTH OF ASC-OTPK-UNT-QTY                      16220069
162300                                       TO DP010I-MAXIMUM-DIGITS   16230069
162400             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 16240069
162500             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              16250069
162610             CALL DP010I-NUMERIC-EDIT-ROUTINE                     16261099
162620                         USING DP010I-NUMERIC-EDIT-AREA           16262099
162700             IF  DP010I-ERROR-DETECTED                            16270069
162800                 SET PS-ERROR                                     16280069
162900                     DP020-MSG-FATAL   TO TRUE                    16290069
163000                 MOVE PC-TSYMSG-00342  TO DP020-MSG-NUMBER        16300069
163100                 MOVE DP015-UNP-ALP-BRT-OFF                       16310069
163200                                       TO MOUTPCKA                16320069
163300                 MOVE DP015-RED        TO MOUTPCKC                16330069
163400                 MOVE DP015-REVERSE    TO MOUTPCKH                16340069
163500                 MOVE -1               TO MOUTPCKL                16350069
163600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              16360069
163700             ELSE                                                 16370069
163800                 MOVE DP010I-NUMERIC-FIELD                        16380069
163900                                       TO ASC-OTPK-UNT-QTY-N      16390069
164000                                          MOUTPCKO                16400069
164100             END-IF                                               16410069
164200         END-IF                                                   16420069
164300     END-IF.                                                      16430069
164400                                                                  16440069
164500*-----------------------------------------------------------------16450069
164600* IF INNERPACK QTY & OUTERPACK QTY ENTERED MAKE SURE OUTERPACK IS 16460069
164700* DIVISIBLE BY INNERPACK                                          16470069
164800*-----------------------------------------------------------------16480069
164900     IF  PS-NO-ERROR                                              16490069
165000         IF  ASC-INPK-UNT-QTY > SPACES AND                        16500069
165100             ASC-OTPK-UNT-QTY > SPACES AND                        16510069
165200             ASC-INPK-UNT-QTY > ZEROES AND                        16520069
165300             ASC-OTPK-UNT-QTY > ZEROES                            16530069
165400             PERFORM 4200-VERIFY-INNER-OUTER-PACK                 16540069
165500         END-IF                                                   16550069
165600     END-IF.                                                      16560069
165700                                                                  16570069
165800*-----------------------------------------------------------------16580069
165900* IF CREATE LABEL OPTION SELECTED - VALIDATE VALUE (B,P, OR C)    16590069
166000*-----------------------------------------------------------------16600069
166100     IF  PS-NO-ERROR                                              16610069
166200         MOVE ASC-CRE-LBL-IND  TO  PV-CREATE-LABEL-OPTION         16620069
166300         IF  PV-VALID-LABEL-OPT                                   16630069
166400             CONTINUE                                             16640069
166500         ELSE                                                     16650069
166600             SET PS-ERROR                                         16660069
166700                 DP020-MSG-FATAL   TO TRUE                        16670069
166800             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            16680069
166900             MOVE DP015-UNP-ALP-BRT-OFF                           16690069
167000                                   TO MLBLOPTA                    16700069
167100             MOVE DP015-RED        TO MLBLOPTC                    16710069
167200             MOVE DP015-REVERSE    TO MLBLOPTH                    16720069
167300             MOVE -1               TO MLBLOPTL                    16730069
167400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16740069
167500         END-IF                                                   16750069
167600     END-IF.                                                      16760069
167700                                                                  16770069
167800                                                                  16780069
167900*-----------------------------------------------------------------16790069
168000* IF CREATE LABEL BOTH OR P2L CHECK TO SEE IF DC IS SET UP WITH   16800069
168100* P2L MODULES.                                                    16810069
168200*-----------------------------------------------------------------16820069
168300     IF  PS-NO-ERROR                                              16830069
168400         IF  ASC-CRE-SML-LBL                                      16840069
168500             CONTINUE                                             16850069
168600         ELSE                                                     16860069
168700             PERFORM 7025-CHECK-DC-P2L-MODULES                    16870069
168800             IF  PV-DC-P2L-MODULE-COUNT  >  0                     16880069
168900                 CONTINUE                                         16890069
169000             ELSE                                                 16900069
169100                 SET PS-ERROR                                     16910069
169200                     DP020-MSG-FATAL   TO TRUE                    16920069
169210                 MOVE PC-TSYMSG-02538  TO DP020-MSG-NUMBER        16921069
169220                 MOVE DP015-UNP-ALP-BRT-OFF                       16922069
169230                                       TO MLBLOPTA                16923069
169240                 MOVE DP015-RED        TO MLBLOPTC                16924069
169250                 MOVE DP015-REVERSE    TO MLBLOPTH                16925069
169260                 MOVE -1               TO MLBLOPTL                16926069
169270                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              16927069
169280             END-IF                                               16928069
169290         END-IF                                                   16929069
169300     END-IF.                                                      16930069
169301                                                                  16930169
169302                                                                  16930269
169303*-----------------------------------------------------------------16930369
169304* IF LABEL PRINT ORDER SELECTED - VALIDATE VALUE (S OR R)         16930469
169305*-----------------------------------------------------------------16930569
169306     IF  PS-NO-ERROR                                              16930669
169307         MOVE ASC-LBL-PRT-ORDER  TO  PV-PRINT-ORDER               16930769
169308         IF  PV-VALID-PRINT-ORDER                                 16930869
169309             CONTINUE                                             16930969
169310         ELSE                                                     16931069
169320             SET PS-ERROR                                         16932069
169330                 DP020-MSG-FATAL   TO TRUE                        16933069
169340             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            16934069
169350             MOVE DP015-UNP-ALP-BRT-OFF                           16935069
169360                                   TO MPRTORDA                    16936069
169370             MOVE DP015-RED        TO MPRTORDC                    16937069
169380             MOVE DP015-REVERSE    TO MPRTORDH                    16938069
169390             MOVE -1               TO MPRTORDL                    16939069
169400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16940069
169500         END-IF                                                   16950069
169600     END-IF.                                                      16960069
169700                                                                  16970069
169800                                                                  16980069
169900*-----------------------------------------------------------------16990069
170000* IF ONLY PGYBCK PRINTER ID IS ENTERED MAKE SURE THAT LABEL PRINT 17000069
170100* ORDER IS BY STORE (R)                                           17010069
170200*-----------------------------------------------------------------17020069
170300     IF  PS-NO-ERROR                                              17030069
170400         IF  ASC-PGYBCK-PRTR-ID  >  SPACES   AND                  17040069
170500             ASC-SML-P2L-PRTR-ID  =  SPACES  AND                  17050069
170600             ASC-LBL-PRT-SHUFFLED                                 17060069
170700                 SET PS-ERROR                                     17070069
170800                     DP020-MSG-FATAL   TO TRUE                    17080069
170900                 MOVE PC-TSYMSG-01790  TO DP020-MSG-NUMBER        17090069
171000                 MOVE DP015-UNP-ALP-BRT-OFF                       17100069
171100                                       TO MPRTORDA                17110069
171200                 MOVE DP015-RED        TO MPRTORDC                17120069
171300                 MOVE DP015-REVERSE    TO MPRTORDH                17130069
171400                 MOVE -1               TO MPRTORDL                17140069
171500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              17150069
171600         END-IF                                                   17160069
171700     END-IF.                                                      17170069
171800                                                                  17180069
171900                                                                  17190069
172000*-----------------------------------------------------------------17200069
172100* VERIFY THAT THE PO/RECEIVER HAS NOT ALREADY BEEN VERIFIED       17210069
172200* NOTE: THIS CHECK HAS BEEN REMOVED PER REQUEST OF RON/STEPH      17220069
172300*       9/29/98 E-MAIL                                            17230069
172400*-----------------------------------------------------------------17240069
172500*    IF  PS-NO-ERROR                                              17250069
172600*        IF  RECEIV-STATUS-CDE = 'VE'                             17260069
172700*            SET PS-ERROR                                         17270069
172800*                DP020-MSG-FATAL   TO TRUE                        17280069
172900*            MOVE PC-TSYMSG-01196  TO DP020-MSG-NUMBER            17290069
173000*            MOVE DP015-UNP-ALP-BRT-OFF                           17300069
173100*                                  TO MPONBRA                     17310069
173200*                                     MRECVRA                     17320069
173300*            MOVE DP015-RED        TO MPONBRC                     17330069
173400*                                     MRECVRC                     17340069
173500*            MOVE DP015-REVERSE    TO MPONBRH                     17350069
173600*                                     MRECVRH                     17360069
173700*            MOVE -1               TO MPONBRL                     17370069
173800*                                     MRECVRL                     17380069
173900*            SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17390069
174000*        END-IF                                                   17400069
174100*    END-IF.                                                      17410069
174200*                                                                 17420069
174300*-----------------------------------------------------------------17430069
174400* CHECK TO SEE IF PO/RECEIVER IS PACK-BY-STORE                    17440069
174500*-----------------------------------------------------------------17450069
174600     IF  PS-NO-ERROR                                              17460069
174700         IF  DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID) OR            17470069
174800             DP020-FK-CONFIRM  (DP020-SRC-AID)                    17480069
174900             IF  RECEIV-PACK-BY-ST-IND  =  'Y'                    17490069
175000                 SET PS-ERROR                                     17500069
175100                     DP020-MSG-FATAL   TO TRUE                    17510069
175200                 MOVE PC-TSYMSG-01803  TO DP020-MSG-NUMBER        17520069
175300                 MOVE DP015-UNP-ALP-BRT-OFF                       17530069
175400                                       TO MPONBRA                 17540069
175500                                          MRECVRA                 17550069
175600                 MOVE DP015-RED        TO MPONBRC                 17560069
175700                                          MRECVRC                 17570069
175800                 MOVE DP015-REVERSE    TO MPONBRH                 17580069
175900                                          MRECVRH                 17590069
176000                 MOVE -1               TO MPONBRL                 17600069
176100                                          MRECVRL                 17610069
176200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              17620069
176300             END-IF                                               17630069
176400         END-IF                                                   17640069
176500     END-IF.                                                      17650069
176600                                                                  17660069
176700*11/27 - BEGIN                                                    17670069
176800*-----------------------------------------------------------------17680069
176900* VERIFY THAT PRINT HEADER/FOOTER ENTERED/VALID                DMH17690069
177000*    REQUIRED:  F23 CRE LABEL (LOCAL-05)                          17700069
177100*               F25 LBLRPRT   (LOCAL-01)                          17710069
177200*               'N' ONLY VALID IF ALL 'P2L'                       17720069
177300*-----------------------------------------------------------------17730069
177400     IF  PS-NO-ERROR                                              17740069
177500       IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR             17750069
177600           DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)  OR             17760069
177700           DP020-FK-CONFIRM (DP020-SRC-AID)                       17770069
177800         IF  ASC-PRT-HEAD-FOOT  >  SPACES                         17780069
177900             IF  ASC-YES-HEAD-FOOT                                17790069
178000                 CONTINUE                                         17800069
178100             ELSE                                                 17810069
178200             IF  ASC-NO-HEAD-FOOT                                 17820069
178300                 IF  ASC-CRE-P2L-LBL                              17830069
178400                     CONTINUE                                     17840069
178500                 ELSE                                             17850069
178600                     SET PS-ERROR                                 17860069
178700                         DP020-MSG-FATAL   TO TRUE                17870069
178800                     MOVE PC-TSYMSG-01857  TO DP020-MSG-NUMBER    17880069
178900                     MOVE DP015-UNP-ALP-BRT-OFF                   17890069
179000                                           TO MHDRFTA             17900069
179100                     MOVE DP015-RED        TO MHDRFTC             17910069
179200                     MOVE DP015-REVERSE    TO MHDRFTH             17920069
179300                     MOVE -1               TO MHDRFTL             17930069
179400                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          17940069
179500                 END-IF                                           17950069
179600             ELSE                                                 17960069
179700                 SET PS-ERROR                                     17970069
179800                     DP020-MSG-FATAL       TO TRUE                17980069
179900                 MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER    17990069
180000                 MOVE DP015-UNP-ALP-BRT-OFF                       18000069
180100                                           TO MHDRFTA             18010069
180200                 MOVE DP015-RED            TO MHDRFTC             18020069
180300                 MOVE DP015-REVERSE        TO MHDRFTH             18030069
180400                 MOVE -1                   TO MHDRFTL             18040069
180500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              18050069
180600             END-IF                                               18060069
180700             END-IF                                               18070069
180800         ELSE                                                     18080069
180900             SET PS-ERROR                                         18090069
181000                 DP020-MSG-FATAL       TO TRUE                    18100069
181100             MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER        18110069
181200             MOVE DP015-UNP-ALP-BRT-OFF                           18120069
181300                                       TO MHDRFTA                 18130069
181400             MOVE DP015-RED            TO MHDRFTC                 18140069
181500             MOVE DP015-REVERSE        TO MHDRFTH                 18150069
181600             MOVE -1                   TO MHDRFTL                 18160069
181700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  18170069
181800         END-IF                                                   18180069
181900       END-IF                                                     18190069
182000     END-IF.                                                      18200069
182100                                                                  18210069
182200*-----------------------------------------------------------------18220069
182300* VERIFY THAT USE UCC128 DATA ENTERED/VALID                       18230069
182400*    REQUIRED:  F23 CRE LABEL (LOCAL-05)                          18240069
182500*-----------------------------------------------------------------18250069
182600     IF  PS-NO-ERROR                                              18260069
182700         IF  DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)               18270069
182800             IF  ASC-USE-UCC128-DATA-YES  AND                     18280069
182900                 ASC-UCC128-DATA-EXISTS                           18290069
183000                 CONTINUE                                         18300069
183100             ELSE                                                 18310069
183200             IF  ASC-USE-UCC128-DATA-NO  OR                       18320069
183300                 ASC-USE-UCC128-DATA-UNKNOWN                      18330069
183400                 CONTINUE                                         18340069
183500             ELSE                                                 18350069
183501                 SET PS-ERROR                                     18350169
183502                     DP020-MSG-FATAL   TO TRUE                    18350269
183503                 MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER        18350369
183504                 MOVE DP015-UNP-ALP-BRT-OFF                       18350469
183505                                       TO USE128A                 18350569
183506                 MOVE DP015-RED        TO USE128C                 18350669
183507                 MOVE DP015-REVERSE    TO USE128H                 18350769
183508                 MOVE -1               TO USE128L                 18350869
183509                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              18350969
183510             END-IF                                               18351069
183520             END-IF                                               18352069
183530         END-IF                                                   18353069
183531     END-IF.                                                      18353169
183532                                                                  18353269
183533*-----------------------------------------------------------------18353369
183534* CHECK TO MAKE SURE NOT TRYING TO REPRINT LINES FOR A PO-RCVR-LNE18353469
183535* PROCESSED USING UCC128 DATA                                     18353569
183536*    REQUIRED:  F24 LBLRPRT   (LOCAL-01)                          18353669
183537*-----------------------------------------------------------------18353769
183538     IF  PS-NO-ERROR                                              18353869
183539         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               18353969
183556               IF  DISTHD-UCC128-DAT-USG-CDE  =  PC-U             18355699
183557                   SET PS-ERROR                                   18355799
183558                       DP020-MSG-FATAL   TO TRUE                  18355899
183559                   MOVE PC-TSYMSG-02508  TO DP020-MSG-NUMBER      18355999
183560                   MOVE DP015-UNP-ALP-BRT-OFF                     18356099
183561                                         TO MPONBRA               18356199
183562                   MOVE DP015-RED        TO MPONBRC               18356299
183563                   MOVE DP015-REVERSE    TO MPONBRH               18356399
183564                  MOVE -1               TO MPONBRL                18356499
183565                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            18356599
183566               END-IF                                             18356699
183569         END-IF                                                   18356999
183570     END-IF.                                                      18357099
183571                                                                  18357199
183572*-----------------------------------------------------------------18357299
183573* VERIFY THAT CASEPACK PROCESS AREA ENTERED                       18357399
183574*    REQUIRED:  ONLY NEED FOR LABEL OPTION - BOTH OR CASE PK      18357499
183575*    REQUIRED:  F23 CRE LABEL (LOCAL-05)                          18357599
183576*               F25 LBLRPRT   (LOCAL-01)                          18357699
183577*-----------------------------------------------------------------18357799
183578     IF  PS-NO-ERROR                                              18357899
183579       IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR             18357999
183580           DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)  OR             18358069
183590           DP020-FK-CONFIRM (DP020-SRC-AID)                       18359069
183600         IF  ASC-CRE-BOTH-LBL  OR                                 18360069
183700             ASC-CRE-SML-LBL                                      18370069
183800             IF  ASC-FCSE-AREA-ID  >  SPACES                      18380069
183900                 PERFORM 3010-VALIDATE-AREA                       18390069
184000                 IF  PS-VALID-FULLCASE-AREA                       18400069
184100                     CONTINUE                                     18410069
184200                 ELSE                                             18420069
184300                     SET PS-ERROR                                 18430069
184400                         DP020-MSG-FATAL   TO TRUE                18440069
184500                     MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER    18450069
184600                     MOVE DP015-UNP-ALP-BRT-OFF                   18460069
184700                                           TO MCSEPKA             18470069
184800                     MOVE DP015-RED        TO MCSEPKC             18480069
184900                     MOVE DP015-REVERSE    TO MCSEPKH             18490069
185000                     MOVE -1               TO MCSEPKL             18500069
185100                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          18510069
185200                 END-IF                                           18520069
185300             ELSE                                                 18530069
185400                 SET PS-ERROR                                     18540069
185500                     DP020-MSG-FATAL   TO TRUE                    18550069
185600                 MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER        18560069
185700                 MOVE DP015-UNP-ALP-BRT-OFF                       18570069
185800                                       TO MCSEPKA                 18580069
185900                 MOVE DP015-RED        TO MCSEPKC                 18590069
186000                 MOVE DP015-REVERSE    TO MCSEPKH                 18600069
186100                 MOVE -1               TO MCSEPKL                 18610069
186200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              18620069
186300             END-IF                                               18630069
186400         END-IF                                                   18640069
186500       END-IF                                                     18650069
186600     END-IF.                                                      18660069
186700                                                                  18670069
186800*11/27 - END                                                      18680069
186900                                                                  18690069
187000*-----------------------------------------------------------------18700069
187100* CHECK SEE IF DC ASSOCIATED W/ PO RECEIVER IS THE SAME DC        18710069
187200* TRYING TO PROCESS THE PO RECEIVER - IF NOT, REQUEST CONFIRM     18720069
187300*  DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID) = F24 LBLRPRT            18730069
187400*  DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID) = F22 RCVRLST            18740069
187500*  DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID) = F18 TRBLLIST           18750069
187600*  DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID) = F17 STORLIST           18760069
187700*-----------------------------------------------------------------18770069
187710*** - DMH REMOVED 1/9/07                                          18771099
187800     IF  PS-NO-ERROR                                              18780099
187900         IF  DP020-FK-CONFIRM(DP020-SRC-AID) AND                  18790099
188000             ASC-PREV-CRE-LBL-OPT-Y          AND                  18800099
188010             ASC-OPER-MATCH-YES                                   18801099
188100             SET PS-MULTI-RCVR-CONFIRM TO TRUE                    18810099
188200         END-IF                                                   18820099
188300     END-IF.                                                      18830099
188400                                                                  18840069
188500     IF  PS-NO-ERROR                                              18850069
188600         IF DP020-NEXT-ACT-INITIAL                                18860069
188700           OR DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             18870069
188800           OR DP020-FK-PREV-SELECTION (DP020-SRC-AID)             18880069
188900             CONTINUE                                             18890069
189000         ELSE                                                     18900069
189100         IF  RECEIV-CURR-OPER-UNT-ID = DP020-LOCATION-NBR   OR    18910099
189200             DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)          OR    18920069
189300             DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)          OR    18930069
189400             DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)          OR    18940069
189500             DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)          OR    18950069
189600             DP020-SRC-AID = DP016-ENTER                          18960069
189610             SET  ASC-OPER-MATCH-YES  TO  TRUE                    18961099
189700             CONTINUE                                             18970069
189800         ELSE                                                     18980069
189900         IF  DP020-FK-CONFIRM(DP020-SRC-AID)                      18990099
190000             SET PS-CONFIRM-PROCESSING TO TRUE                    19000099
190100         ELSE                                                     19010099
190200             SET PS-ERROR                                         19020069
190300                 DP020-MSG-FATAL       TO TRUE                    19030099
190400             SET  ASC-OPER-MATCH-NO     TO TRUE                   19040099
190500             MOVE PC-TSYMSG-03598      TO DP020-MSG-NUMBER        19050099
190510             MOVE RECEIV-CURR-OPER-UNT-ID                         19051099
190520                                       TO DP020-MSG-TEXT          19052099
190600             MOVE DP015-RED            TO MOPIDC                  19060069
190700                                          MCOPIDC                 19070069
190800             MOVE DP015-REVERSE        TO MOPIDH                  19080069
190900                                          MCOPIDH                 19090069
191000             MOVE -1                   TO MPONBRL                 19100069
191100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  19110069
191200         END-IF                                                   19120099
191300         END-IF                                                   19130069
191400         END-IF                                                   19140069
191500     END-IF.                                                      19150069
191600                                                                  19160069
191700*-----------------------------------------------------------------19170069
191800* IF CREATE LABEL HAS BEEN SELECTED(F23).  CHECK TO SEE IF THIS   19180069
191900* RECEIVER IS ONLY PART OF A SHIPMENT (DELIVERY IS COMING IN MULT 19190069
192000* TRUCKS.  LOOK FOR OTHER RECEIVERS FOR THIS DC & PO THAT ARE NOT 19200069
192100* IN VERIFIED STATUS.                                             19210069
192200*-----------------------------------------------------------------19220069
192300     IF  PS-NO-ERROR                                              19230069
192400         IF  PS-MULTI-RCVR-CONFIRM                                19240069
192500             CONTINUE                                             19250069
192600         ELSE                                                     19260069
192700         IF  DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)                19270069
192800             IF  ASC-PO-LINE-NBR > SPACE                          19280069
192900                 PERFORM 4500-CHECK-MULT-RECV-WITH-LINE           19290069
193000             ELSE                                                 19300069
193100                 PERFORM 4400-CHECK-MULT-RECV-NO-LINE             19310069
193200             END-IF                                               19320069
193300         END-IF                                                   19330069
193400         END-IF                                                   19340069
193500     END-IF.                                                      19350069
193600                                                                  19360069
193700                                                                  19370069
193800*-----------------------------------------------------------------19380069
193900*    CONFIRM --- ONLY VALID WHEN CONFIRM PROCESSING               19390069
194000*    IF F2 & CONFIRM FOLLOW SAME PATH AS IF F23 (CRE LABL) USED   19400069
194100*    IF F2 & MULTI-RCVR PROCESSING FOLLOW SAME PATH AS F23 USED   19410069
194200*-----------------------------------------------------------------19420069
194300     IF  DP020-FK-CONFIRM(DP020-SRC-AID)                          19430069
194400***      IF  PS-CONFIRM-PROCESSING                                19440099
194500***          MOVE PC-F23   TO  DP020-SRC-AID                      19450099
194600***      ELSE                                                     19460099
194700         IF  PS-MULTI-RCVR-CONFIRM                                19470069
194800             MOVE PC-F23   TO  DP020-SRC-AID                      19480069
194900         ELSE                                                     19490069
195000         IF  ASC-PACK-BY-ST-YES                                   19500069
195100             SET PS-ERROR                                         19510069
195200                 DP020-MSG-FATAL   TO TRUE                        19520069
195300             MOVE PC-TSYMSG-01803  TO DP020-MSG-NUMBER            19530069
195400             MOVE -1               TO MPONBRL                     19540069
195500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  19550069
195600         ELSE                                                     19560069
195700             SET PS-ERROR                                         19570069
195800                 DP020-MSG-FATAL       TO TRUE                    19580069
195900             MOVE PC-TSYMSG-00045      TO DP020-MSG-NUMBER        19590069
196000             MOVE -1                   TO MPONBRL                 19600069
196100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  19610069
196200         END-IF                                                   19620069
196300         END-IF                                                   19630069
196400***      END-IF                                                   19640099
196500     END-IF.                                                      19650069
196600                                                                  19660069
196700                                                                  19670069
196800*-----------------------------------------------------------------19680069
196900*                                                                 19690069
197000*-----------------------------------------------------------------19700069
197100     IF  DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                   19710069
197200         SET  ASC-PREV-CRE-LBL-OPT-Y  TO  TRUE                    19720069
197300     ELSE                                                         19730069
197400         SET  ASC-PREV-CRE-LBL-OPT-N  TO  TRUE.                   19740069
197500                                                                  19750069
197510*-----------------------------------------------------------------19751099
197520*   ADDED - DMH - 10-5-10                                         19752099
197521*   GET TRIP ARRIVE DATE                                          19752199
197522*   GET TRIP ARRIVE DATE                                          19752299
197523*   LOCAL-FUNC-01 - F24 - LABEL REPRINT                           19752399
197524*   LOCAL-FUNC-04 - F17 - STORE LIST                              19752499
197525*   LOCAL-FUNC-05 - F23 - LABEL PRINT                             19752599
197530*-----------------------------------------------------------------19753099
197531     IF  PS-NO-ERROR                                              19753199
197540         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR           19754099
197541             DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)  OR           19754199
197542             DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)               19754299
197550             PERFORM 3005-GET-TRIP-ID                             19755099
197560         END-IF                                                   19756099
197570     END-IF.                                                      19757099
197580                                                                  19758099
197600*-----------------------------------------------------------------19760069
197700*                                                                 19770069
197800*-----------------------------------------------------------------19780069
197900     IF  PS-NO-ERROR                                              19790069
198000         IF  ASC-PO-NBR-N       >  0  AND                         19800069
198100             ASC-REC-SEQ-NBR-N  >  0                              19810069
198200             MOVE -1               TO MDEST1L                     19820069
198300         ELSE                                                     19830069
198400             MOVE -1               TO MPONBRL                     19840069
198410         END-IF                                                   19841069
198420             SET DP030-SET-CURSOR-APPL-1                          19842069
198430                                   TO TRUE                        19843069
198440     END-IF.                                                      19844069
198450                                                                  19845069
198451                                                                  19845199
198452*-----------------------------------------------------------------19845299
198453*   ADDED - DMH - 10-5-10                                         19845399
198454*   GET TRIP ARRIVE DATE                                          19845499
198455*   GET TRIP ARRIVE DATE                                          19845599
198456*   LOCAL-FUNC-01 - F24 - LABEL REPRINT                           19845699
198457*   LOCAL-FUNC-04 - F17 - STORE LIST                              19845799
198458*   LOCAL-FUNC-05 - F23 - LABEL PRINT                             19845899
198460*-----------------------------------------------------------------19846099
198461 3005-GET-TRIP-ID.                                                19846199
198462                                                                  19846299
198463     MOVE  ASC-PO-NBR       TO  SHPTPO-PO-NBR                     19846399
198464     MOVE  ASC-REC-SEQ-NBR  TO  SHPTPO-REC-SEQ-NBR                19846499
198465                                                                  19846599
198466     EXEC SQL                                                     19846699
198467         SELECT C.VEH_NBR                                         19846799
198468               ,C.TRIP_ID                                         19846899
198469           INTO :VHTRIP-VEH-NBR  :PV-NULL-IND-3                   19846999
198470               ,:VHTRIP-TRIP-ID                                   19847099
198471           FROM TSHPTPO A                                         19847199
198472               ,TSHIPMT B                                         19847299
198473               ,TVHTRIP C                                         19847399
198474          WHERE A.PO_NBR       =  :SHPTPO-PO-NBR                  19847499
198475            AND A.REC_SEQ_NBR  =  :SHPTPO-REC-SEQ-NBR             19847599
198476            AND A.SHIPT_ID     =  B.SHIPT_ID                      19847699
198477            AND B.TRIP_ID      =  C.TRIP_ID                       19847799
198478            AND A.PRIM_SHIPT_IND = 'Y'                            19847899
198479     END-EXEC                                                     19847999
198480                                                                  19848099
198481     EVALUATE TRUE                                                19848199
198482         WHEN SQLCODE = +0                                        19848299
198483             IF  PV-NULL-IND-3  =  -1                             19848399
198484                 MOVE '9999-99-99' TO  ASC-TRIP-ARRIVE-DATE       19848499
198485             ELSE                                                 19848599
198486                 PERFORM 3006-CHECK-TRAILER-ARRIVED               19848699
198487             END-IF                                               19848799
198488         WHEN OTHER                                               19848899
198489              MOVE  ASC-PO-NBR          TO  PV-DISP-PO            19848999
198490              MOVE  ASC-REC-SEQ-NBR     TO  PV-DISP-RCVR          19849099
198491              MOVE '3005-GET-TRIP-ID          '                   19849199
198492                               TO DP013-PARAGRAPH                 19849299
198493              MOVE 'GET TRIP ID             '                     19849399
198494                               TO DP013-MESSAGE-TEXT (1)          19849499
198495              STRING ' RCVR:'  PV-DISP-PO                         19849599
198496                     '-'       PV-DISP-RCVR                       19849699
198497                               DELIMITED BY SIZE                  19849799
198498                             INTO DP013-MESSAGE-TEXT (2)          19849899
198499              MOVE SQLCA       TO DP013-SQLCA                     19849999
198500              MOVE 'TSHPTPO '  TO DP013-DB2-TABLE-NAME (1)        19850099
198501              MOVE 'TSHIPMT '  TO DP013-DB2-TABLE-NAME (2)        19850199
198502              MOVE 'TVHTRIP '  TO DP013-DB2-TABLE-NAME (3)        19850299
198503              SET DP013-DB2-ABEND                                 19850399
198504                  DP013-XCTL-DISPLAY-RESTART                      19850499
198505                               TO TRUE                            19850599
198506              PERFORM DP013-0000-PROCESS-ABEND                    19850699
198509                                                                  19850999
198518     END-EVALUATE.                                                19851899
198519                                                                  19851999
198520                                                                  19852099
198521 3006-CHECK-TRAILER-ARRIVED.                                      19852199
198523                                                                  19852399
198524     EXEC SQL                                                     19852499
198525         SELECT  STATUS_DTE                                       19852599
198526           INTO :TRIPST-STATUS-DTE                                19852699
198527           FROM  TTRIPST                                          19852799
198528          WHERE  TRIP_ID          =  :VHTRIP-TRIP-ID              19852899
198529            AND  TRIP_STATUS_CDE  =  'AR'                         19852999
198530     END-EXEC                                                     19853099
198531                                                                  19853199
198532     EVALUATE TRUE                                                19853299
198533         WHEN SQLCODE = +0                                        19853399
198534              MOVE TRIPST-STATUS-DTE TO  ASC-TRIP-ARRIVE-DATE     19853499
198535         WHEN SQLCODE = +100                                      19853599
198536              MOVE  '9999-99-99'     TO  ASC-TRIP-ARRIVE-DATE     19853699
198537         WHEN OTHER                                               19853799
198538              MOVE  VHTRIP-TRIP-ID   TO  PV-DISP-TRIP             19853899
198539              MOVE '3306-CHECK-TRAILER-ARRIVED'                   19853999
198540                               TO DP013-PARAGRAPH                 19854099
198541              MOVE 'GET ARRIVE DATE         '                     19854199
198542                               TO DP013-MESSAGE-TEXT (1)          19854299
198543              MOVE PV-DISP-TRIP TO DP013-MESSAGE-TEXT (2)         19854399
198545              MOVE SQLCA       TO DP013-SQLCA                     19854599
198546              MOVE 'TTRIPST '  TO DP013-DB2-TABLE-NAME (1)        19854699
198547              SET DP013-DB2-ABEND                                 19854799
198548                  DP013-XCTL-DISPLAY-RESTART                      19854899
198549                               TO TRUE                            19854999
198550              PERFORM DP013-0000-PROCESS-ABEND                    19855099
198560                                                                  19856099
198571     END-EVALUATE.                                                19857199
198574                                                                  19857469
198575                                                                  19857599
198576*----------------------------------------------------------------*19857699
198577* CHECK TO SEE HOW THE DC IS PROCESSING PACK-TO-LIGHT FREIGHT    *19857799
198578*        HANG/FOLD -OR- HANG/COMMODITY -OR- COMMODITY            *19857899
198579* DMH ADDED 6/26/12                                              *19857999
198580*----------------------------------------------------------------*19858099
198581 3007-CHECK-P2L-ZONES.                                            19858199
198582                                                                  19858299
198583     EXEC SQL                                                     19858399
198584          SELECT  FUNC_TXT                                        19858499
198585            INTO :ASC-P2L-ZONE                                    19858599
198586            FROM  TKRPRPM                                         19858699
198587           WHERE  LOC_ID            = :DK-OPER-UNT-ID             19858799
198588             AND  SYS_PRC_FUNC_CDE  = 'P2LZON'                    19858899
198589             AND  INTFC_SYS_CDE     = 'KHL'                       19858999
198590             AND  FUNC_PRC_STAT_CDE = 'AC'                        19859099
198591             AND  FUNC_BEG_TMST    <=  CURRENT TIMESTAMP          19859199
198592             AND  FUNC_END_TMST    >=  CURRENT TIMESTAMP          19859299
198593     END-EXEC                                                     19859399
198594                                                                  19859499
198595     EVALUATE TRUE                                                19859599
198596         WHEN SQLCODE = +0                                        19859699
198597              CONTINUE                                            19859799
198598         WHEN SQLCODE = +100                                      19859899
198599              SET  ASC-COMMODITY     TO  TRUE                     19859999
198600         WHEN OTHER                                               19860099
198601              MOVE '3007-CHECK-P2L-ZONES'                         19860199
198602                               TO DP013-PARAGRAPH                 19860299
198603              MOVE 'CHECK P2L ZONE SETUP    '                     19860399
198604                               TO DP013-MESSAGE-TEXT (1)          19860499
198606              MOVE SQLCA       TO DP013-SQLCA                     19860699
198607              MOVE 'TKRPRPM '  TO DP013-DB2-TABLE-NAME (1)        19860799
198608              SET DP013-DB2-ABEND                                 19860899
198609                  DP013-XCTL-DISPLAY-RESTART                      19860999
198610                               TO TRUE                            19861099
198611              PERFORM DP013-0000-PROCESS-ABEND                    19861199
198612                                                                  19861299
198613     END-EVALUATE.                                                19861399
198614                                                                  19861499
198615                                                                  19861599
198616*----------------------------------------------------------------*19861699
198617* CHECK TO SEE IF THE DEFAULT STORE ZONE IS ONE OF THE ZONES     *19861799
198618* SETUP FOR HANG/FOLD OR HANG/COMMODITY                          *19861899
198619* DMH ADDED 6/26/12                                              *19861999
198620*----------------------------------------------------------------*19862099
198621 3008-CHECK-HANG-FOLD.                                            19862199
198622                                                                  19862299
198623     EXEC SQL                                                     19862399
198624          SELECT                                                  19862499
198625                   E.ATTR_ELEM_TXT  AS STORE_ZONE                 19862599
198626            INTO :WST00010-ATTR-ELEM-TXT                          19862699
198627            FROM                                                  19862799
198628                   WST_INTGRTN_TYP  A                             19862899
198629               ,   WST_ATTR_DEFN    B                             19862999
198630               ,   WST_ATTR_ELEM    C                             19863099
198631               ,   WST_ATTR_ELEM    D                             19863199
198632               ,   WST_ATTR_ELEM    E                             19863299
198633               ,   WST_ATTR_ELEM    F                             19863399
198634               ,   WST_ATTR_ELEM    G                             19863499
198635            WHERE                                                 19863599
198636                  A.INTGRTN_TYP_CDE   = 'P2LHNGFLD'               19863699
198637              AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         19863799
198638              AND B.ATTR_DEFN_SEQ_NBR = 1                         19863899
198639              AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         19863999
198640              AND C.ATTR_DEFN_SEQ_NBR = 1                         19864099
198641              AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         19864199
198642              AND D.ATTR_DEFN_SEQ_NBR = 2                         19864299
198643              AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         19864399
198644              AND E.ATTR_DEFN_SEQ_NBR = 3                         19864499
198645              AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE         19864599
198646              AND F.ATTR_DEFN_SEQ_NBR = 4                         19864699
198647              AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE         19864799
198648              AND G.ATTR_DEFN_SEQ_NBR = 5                         19864899
198649              AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       19864999
198650              AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       19865099
198651              AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR       19865199
198652              AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR       19865299
198653              AND C.ATTR_ELEM_NBR     =  90                       19865399
198654              AND D.ATTR_ELEM_TXT     = 'P2L'                     19865499
198655              AND F.ATTR_ELEM_TMST   <=  CURRENT TIMESTAMP        19865599
198656              AND G.ATTR_ELEM_TMST   >=  CURRENT TIMESTAMP        19865699
198657              AND E.ATTR_ELEM_TXT     = :ASC-DFLT-STR-ZN-ID       19865799
198658     END-EXEC.                                                    19865899
198659                                                                  19865999
198660     EVALUATE TRUE                                                19866099
198661         WHEN SQLCODE = +0                                        19866199
198662              CONTINUE                                            19866299
198663         WHEN SQLCODE = +100                                      19866399
198664              SET  ASC-COMMODITY     TO  TRUE                     19866499
198665         WHEN OTHER                                               19866599
198666              MOVE '3008-CHECK-HANG-FOLD'                         19866699
198667                               TO DP013-PARAGRAPH                 19866799
198668              MOVE 'CHECK IF STR ZNE SETUP FOR HANG/FOLD'         19866899
198669                               TO DP013-MESSAGE-TEXT (1)          19866999
198670              MOVE SQLCA       TO DP013-SQLCA                     19867099
198671              MOVE 'WST00010'  TO DP013-DB2-TABLE-NAME (1)        19867199
198672              SET DP013-DB2-ABEND                                 19867299
198673                  DP013-XCTL-DISPLAY-RESTART                      19867399
198674                               TO TRUE                            19867499
198675              PERFORM DP013-0000-PROCESS-ABEND                    19867599
198676                                                                  19867699
198677     END-EVALUATE.                                                19867799
198678                                                                  19867899
198679                                                                  19867999
198773*----------------------------------------------------------------*19877399
198774* VALIDATE FULLCASE PROCESS AREA                                 *19877499
198775*----------------------------------------------------------------*19877599
198776 3010-VALIDATE-AREA.                                              19877699
198777     IF  ASC-OPER-UNIT-CORP                                       19877769
198780         MOVE ASC-CURR-OPER-UNT-ID  TO DK-OPER-UNT-ID-2           19878069
198800     ELSE                                                         19880069
198900         MOVE ASC-OPER-UNT-ID       TO DK-OPER-UNT-ID-2           19890069
199000     END-IF.                                                      19900069
199100                                                                  19910069
199200     EXEC SQL                                                     19920069
199300          SELECT FCLTY_AREA_ID                                    19930069
199400           INTO :FLAREA-FCLTY-AREA-ID                             19940069
199500           FROM  TFLAREA                                          19950069
199600          WHERE  OPER_UNT_ID       = :DK-OPER-UNT-ID-2            19960069
199700            AND  FCLTY_ID          = :DK-FCLTY-ID                 19970069
199800            AND  FCLTY_LOC_TYP_CDE = 'PA'                         19980069
199900            AND  FCLTY_AREA_ID     = :ASC-FCSE-AREA-ID            19990069
200000     END-EXEC.                                                    20000069
200100                                                                  20010069
200200     EVALUATE TRUE                                                20020069
200300         WHEN SQLCODE = +0                                        20030069
200400              SET PS-VALID-FULLCASE-AREA  TO  TRUE                20040069
200500         WHEN SQLCODE = +100                                      20050069
200600              SET PS-NOT-VALID-FULLCASE-AREA  TO  TRUE            20060069
200700         WHEN OTHER                                               20070069
200800              MOVE '3010-VALIDATE-AREA        '                   20080069
200900                               TO DP013-PARAGRAPH                 20090069
201000              MOVE 'VALIDATE FULLCASE AREA  '                     20100069
201100                               TO DP013-MESSAGE-TEXT (1)          20110069
201200              MOVE SQLCA       TO DP013-SQLCA                     20120069
201300              MOVE 'TFLAREA '  TO DP013-DB2-TABLE-NAME (1)        20130069
201400              SET DP013-DB2-ABEND                                 20140069
201500                  DP013-XCTL-DISPLAY-RESTART                      20150069
201600                               TO TRUE                            20160069
201700              PERFORM DP013-0000-PROCESS-ABEND                    20170069
201800     END-EVALUATE.                                                20180069
201900                                                                  20190069
202000                                                                  20200069
202010*----------------------------------------------------------------*20201099
202020* CHECK TO SEE WHICH ZONE HAS MORE LINES.  THAT WILL BECOME THE  *20202099
202030* DEFAULT FOR THIS ORDER  --- COUNTS THE NUMBER OF HANG LINES    *20203099
202040* DMH ADDED 6/26/12                                              *20204099
202050*----------------------------------------------------------------*20205099
202060 3015-COUNT-HANG.                                                 20206099
202061                                                                  20206199
202062     MOVE  ASC-PO-NBR       TO  DK-PO.                            20206299
202063     MOVE  ASC-REC-SEQ-NBR  TO  DK-REC-SEQ-NBR.                   20206399
202070                                                                  20207099
202080     EXEC SQL                                                     20208099
202090          SELECT COUNT(*)                                         20209099
202091            INTO :PV-HANG-COUNT                                   20209199
202100            FROM TRECITM A                                        20210099
202110                ,TPURITM B                                        20211099
202120                ,XLT_SKU C                                        20212099
202121                ,XLT_VND_STYL D                                   20212199
202122           WHERE A.ORD_NBR           = :DK-PO                     20212299
202123             AND A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR            20212399
202124             AND A.ORD_NBR           = B.PO_NBR                   20212499
202125             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           20212599
202126             AND A.VER_STATUS_CDE    = 'A'                        20212699
202127             AND A.PO_VER_NBR        = B.VER_NBR                  20212799
202128             AND B.ITM_NBR           = C.ITM_NBR                  20212899
202129             AND C.STYL_ID           = D.STYL_ID                  20212999
202130             AND D.HNG_FOLD_DESC     = 'HANG'                     20213099
202131     END-EXEC.                                                    20213199
202132                                                                  20213299
202133     EVALUATE TRUE                                                20213399
202134         WHEN SQLCODE = +0                                        20213499
202136              CONTINUE                                            20213699
202137         WHEN SQLCODE = +100                                      20213799
202138              MOVE ZERO              TO  PV-HANG-COUNT            20213899
202139         WHEN OTHER                                               20213999
202140              MOVE  ASC-PO-NBR          TO  PV-DISP-PO            20214099
202141              MOVE  ASC-REC-SEQ-NBR     TO  PV-DISP-RCVR          20214199
202142              MOVE '3015-COUNT-HANG     '                         20214299
202143                               TO DP013-PARAGRAPH                 20214399
202144              MOVE 'COUNT THE NUMBER OF LINE FOR HANG   '         20214499
202145                               TO DP013-MESSAGE-TEXT (1)          20214599
202146              STRING PV-DISP-PO '-'                               20214699
202147                     PV-DISP-RCVR DELIMITED BY SIZE               20214799
202148                             INTO DP013-MESSAGE-TEXT (2)          20214899
202149              MOVE SQLCA       TO DP013-SQLCA                     20214999
202150              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        20215099
202151              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (2)        20215199
202152              MOVE 'XLT00003'  TO DP013-DB2-TABLE-NAME (3)        20215299
202153              MOVE 'XLT00004'  TO DP013-DB2-TABLE-NAME (3)        20215399
202154              SET DP013-DB2-ABEND                                 20215499
202155                  DP013-XCTL-DISPLAY-RESTART                      20215599
202156                               TO TRUE                            20215699
202157              PERFORM DP013-0000-PROCESS-ABEND                    20215799
202158                                                                  20215899
202159     END-EVALUATE.                                                20215999
202160                                                                  20216099
202161                                                                  20216199
202163*----------------------------------------------------------------*20216399
202164* CHECK TO SEE WHICH ZONE HAS MORE LINES.  THAT WILL BECOME THE  *20216499
202165* DEFAULT FOR THIS ORDER  --- COUNTS THE NUMBER OF FOLD LINES    *20216599
202166* DMH ADDED 6/26/12                                              *20216699
202167*----------------------------------------------------------------*20216799
202168 3016-COUNT-FOLD.                                                 20216899
202170                                                                  20217099
202171     MOVE  ASC-PO-NBR       TO  DK-PO.                            20217199
202172     MOVE  ASC-REC-SEQ-NBR  TO  DK-REC-SEQ-NBR.                   20217299
202173                                                                  20217399
202174     EXEC SQL                                                     20217499
202175          SELECT COUNT(*)                                         20217599
202176            INTO :PV-FOLD-COUNT                                   20217699
202177            FROM TRECITM A                                        20217799
202178                ,TPURITM B                                        20217899
202179                ,XLT_SKU C                                        20217999
202180                ,XLT_VND_STYL D                                   20218099
202181           WHERE A.ORD_NBR           = :DK-PO                     20218199
202182             AND A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR            20218299
202183             AND A.ORD_NBR           = B.PO_NBR                   20218399
202184             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           20218499
202185             AND A.VER_STATUS_CDE    = 'A'                        20218599
202186             AND A.PO_VER_NBR        = B.VER_NBR                  20218699
202187             AND B.ITM_NBR           = C.ITM_NBR                  20218799
202188             AND C.STYL_ID           = D.STYL_ID                  20218899
202189             AND D.HNG_FOLD_DESC     = 'FOLD'                     20218999
202190     END-EXEC.                                                    20219099
202191                                                                  20219199
202192     EVALUATE TRUE                                                20219299
202193         WHEN SQLCODE = +0                                        20219399
202194              CONTINUE                                            20219499
202195         WHEN SQLCODE = +100                                      20219599
202196              MOVE ZERO              TO  PV-HANG-COUNT            20219699
202197         WHEN OTHER                                               20219799
202198              MOVE  ASC-PO-NBR          TO  PV-DISP-PO            20219899
202199              MOVE  ASC-REC-SEQ-NBR     TO  PV-DISP-RCVR          20219999
202200              MOVE '3016-COUNT-FOLD     '                         20220099
202201                               TO DP013-PARAGRAPH                 20220199
202202              MOVE 'COUNT THE NUMBER OF LINE FOR FOLD   '         20220299
202203                               TO DP013-MESSAGE-TEXT (1)          20220399
202204              STRING PV-DISP-PO '-'                               20220499
202205                     PV-DISP-RCVR DELIMITED BY SIZE               20220599
202206                             INTO DP013-MESSAGE-TEXT (2)          20220699
202207              MOVE SQLCA       TO DP013-SQLCA                     20220799
202208              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        20220899
202209              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (2)        20220999
202210              MOVE 'XLT00003'  TO DP013-DB2-TABLE-NAME (3)        20221099
202211              MOVE 'XLT00004'  TO DP013-DB2-TABLE-NAME (3)        20221199
202212              SET DP013-DB2-ABEND                                 20221299
202213                  DP013-XCTL-DISPLAY-RESTART                      20221399
202214                               TO TRUE                            20221499
202215              PERFORM DP013-0000-PROCESS-ABEND                    20221599
202216                                                                  20221699
202217     END-EVALUATE.                                                20221799
202218                                                                  20221899
202219                                                                  20221999
202221*----------------------------------------------------------------*20222199
202222* CHECK TO SEE WHICH ZONE HAS MORE LINES.  THAT WILL BECOME THE  *20222299
202223* DEFAULT FOR THIS ORDER  --- COUNTS THE NUMBER OF <> HANG LINES *20222399
202224* DMH ADDED 6/26/12                                              *20222499
202225*----------------------------------------------------------------*20222599
202226 3017-COUNT-COMMODITY.                                            20222699
202228                                                                  20222899
202229     MOVE  ASC-PO-NBR       TO  DK-PO.                            20222999
202230     MOVE  ASC-REC-SEQ-NBR  TO  DK-REC-SEQ-NBR.                   20223099
202231                                                                  20223199
202232     EXEC SQL                                                     20223299
202233          SELECT COUNT(*)                                         20223399
202234            INTO :PV-COMMODITY-COUNT                              20223499
202235            FROM TRECITM A                                        20223599
202236                ,TPURITM B                                        20223699
202237                ,XLT_SKU C                                        20223799
202238                ,XLT_VND_STYL D                                   20223899
202239           WHERE A.ORD_NBR           = :DK-PO                     20223999
202240             AND A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR            20224099
202241             AND A.ORD_NBR           = B.PO_NBR                   20224199
202242             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           20224299
202243             AND A.VER_STATUS_CDE    = 'A'                        20224399
202244             AND A.PO_VER_NBR        = B.VER_NBR                  20224499
202245             AND B.ITM_NBR           = C.ITM_NBR                  20224599
202246             AND C.STYL_ID           = D.STYL_ID                  20224699
202247             AND D.HNG_FOLD_DESC    <> 'HANG'                     20224799
202248     END-EXEC.                                                    20224899
202249                                                                  20224999
202250     EVALUATE TRUE                                                20225099
202251         WHEN SQLCODE = +0                                        20225199
202252              CONTINUE                                            20225299
202253         WHEN SQLCODE = +100                                      20225399
202254              MOVE ZERO              TO  PV-HANG-COUNT            20225499
202255         WHEN OTHER                                               20225599
202256              MOVE  ASC-PO-NBR          TO  PV-DISP-PO            20225699
202257              MOVE  ASC-REC-SEQ-NBR     TO  PV-DISP-RCVR          20225799
202258              MOVE '3017-COUNT-COMMODITY'                         20225899
202259                               TO DP013-PARAGRAPH                 20225999
202260              MOVE 'COUNT THE NUMBER OF LINE FOR COMMODITY'       20226099
202261                               TO DP013-MESSAGE-TEXT (1)          20226199
202262              STRING PV-DISP-PO '-'                               20226299
202263                     PV-DISP-RCVR DELIMITED BY SIZE               20226399
202264                             INTO DP013-MESSAGE-TEXT (2)          20226499
202265              MOVE SQLCA       TO DP013-SQLCA                     20226599
202266              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        20226699
202267              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (2)        20226799
202268              MOVE 'XLT00003'  TO DP013-DB2-TABLE-NAME (3)        20226899
202269              MOVE 'XLT00004'  TO DP013-DB2-TABLE-NAME (3)        20226999
202270              SET DP013-DB2-ABEND                                 20227099
202271                  DP013-XCTL-DISPLAY-RESTART                      20227199
202272                               TO TRUE                            20227299
202273              PERFORM DP013-0000-PROCESS-ABEND                    20227399
202274                                                                  20227499
202275     END-EVALUATE.                                                20227599
202276                                                                  20227699
202277                                                                  20227799
202278*----------------------------------------------------------------*20227899
202279* CHECK TO SEE HOW MANY LINES HAVE SOMETHING OTHER THAN HANG OR  *20227999
202280* FOLD                                                           *20228099
202281* DMH ADDED 6/26/12                                              *20228199
202282*----------------------------------------------------------------*20228299
202283 3018-COUNT-OTHER.                                                20228399
202284                                                                  20228499
202285     MOVE  ASC-PO-NBR       TO  DK-PO.                            20228599
202286     MOVE  ASC-REC-SEQ-NBR  TO  DK-REC-SEQ-NBR.                   20228699
202287                                                                  20228799
202288     EXEC SQL                                                     20228899
202289          SELECT COUNT(*)                                         20228999
202290            INTO :PV-OTHER-COUNT                                  20229099
202291            FROM TRECITM A                                        20229199
202292                ,TPURITM B                                        20229299
202293                ,XLT_SKU C                                        20229399
202294                ,XLT_VND_STYL D                                   20229499
202295           WHERE A.ORD_NBR            =  :DK-PO                   20229599
202296             AND A.REC_SEQ_NBR        =  :DK-REC-SEQ-NBR          20229699
202297             AND A.ORD_NBR            =  B.PO_NBR                 20229799
202298             AND A.ORD_LNE_NBR        =  B.APP_PO_LNE_NBR         20229899
202299             AND A.VER_STATUS_CDE     =  'A'                      20229999
202300             AND A.PO_VER_NBR         =  B.VER_NBR                20230099
202301             AND B.ITM_NBR            =  C.ITM_NBR                20230199
202302             AND C.STYL_ID            =  D.STYL_ID                20230299
202303             AND NOT D.HNG_FOLD_DESC IN ('FOLD', 'HANG')          20230399
202304     END-EXEC.                                                    20230499
202305                                                                  20230599
202306     EVALUATE TRUE                                                20230699
202307         WHEN SQLCODE = +0                                        20230799
202308              CONTINUE                                            20230899
202309         WHEN SQLCODE = +100                                      20230999
202310              MOVE ZERO              TO  PV-OTHER-COUNT           20231099
202311         WHEN OTHER                                               20231199
202312              MOVE  ASC-PO-NBR          TO  PV-DISP-PO            20231299
202313              MOVE  ASC-REC-SEQ-NBR     TO  PV-DISP-RCVR          20231399
202314              MOVE '3018-COUNT-OTHER    '                         20231499
202315                               TO DP013-PARAGRAPH                 20231599
202316              MOVE 'COUNT THE NUMBER OF LINE NOT HANG OR FOLD'    20231699
202317                               TO DP013-MESSAGE-TEXT (1)          20231799
202318              STRING PV-DISP-PO '-'                               20231899
202319                     PV-DISP-RCVR DELIMITED BY SIZE               20231999
202320                             INTO DP013-MESSAGE-TEXT (2)          20232099
202321              MOVE SQLCA       TO DP013-SQLCA                     20232199
202322              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        20232299
202323              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (2)        20232399
202324              MOVE 'XLT00003'  TO DP013-DB2-TABLE-NAME (3)        20232499
202325              MOVE 'XLT00004'  TO DP013-DB2-TABLE-NAME (3)        20232599
202326              SET DP013-DB2-ABEND                                 20232699
202327                  DP013-XCTL-DISPLAY-RESTART                      20232799
202328                               TO TRUE                            20232899
202329              PERFORM DP013-0000-PROCESS-ABEND                    20232999
202330                                                                  20233099
202331     END-EVALUATE.                                                20233199
202332                                                                  20233299
202333*----------------------------------------------------------------*20233399
202334*                                                                *20233469
202340*----------------------------------------------------------------*20234069
202400 3040-GET-DC-PRTD-AT.                                             20240069
202500                                                                  20250069
202600     MOVE  DP020-LOCATION-NBR        TO  DK-CURR-OPER-UNT-ID.     20260099
202700                                                                  20270069
202800     EXEC SQL                                                     20280069
202900          SELECT LOC_5_ABBR_NM                                    20290099
203000          INTO  :PV-DC-5-CHAR-ABBR                                20300069
203100          FROM   XLT_LOC                                          20310099
203200          WHERE  LOC_TYP_CDE = 'DC'                               20320099
203300          AND    LOC_NBR   = :DK-CURR-OPER-UNT-ID                 20330099
203400     END-EXEC.                                                    20340069
203500                                                                  20350099
203600     EVALUATE TRUE                                                20360069
203700         WHEN SQLCODE = ZERO                                      20370069
203800              MOVE  PV-2-DIGIT-DC-ABBR  TO  PV-DC-PRTD-AT         20380069
203900                                                                  20390069
204000         WHEN SQLCODE = +100                                      20400069
204100              MOVE  PC-90   TO  PV-DC-PRTD-AT                     20410069
204200                                                                  20420069
204300         WHEN SQLCODE = -811                                      20430069
204400         WHEN SQLCODE = -904                                      20440069
204500         WHEN SQLCODE = -913                                      20450069
204600             CONTINUE                                             20460069
204700         WHEN SQLWARN0 NOT = SPACES                               20470069
204800         WHEN SQLCODE < +0                                        20480069
204900         WHEN SQLCODE > +0                                        20490069
205000            MOVE '3040-GET-DC-PRTD-AT' TO DP013-PARAGRAPH         20500069
205100            MOVE 'GET DC PRINTED AT'   TO DP013-MESSAGE-TEXT(1)   20510069
205200            MOVE SQLCA                 TO DP013-SQLCA             20520069
205300            MOVE 'XLT_LOC'             TO DP013-DB2-TABLE-NAME(1) 20530099
205400            SET  DP013-DB2-ABEND                                  20540069
205500                 DP013-XCTL-DISPLAY-RESTART                       20550069
205600                                       TO TRUE                    20560069
205700            PERFORM DP013-0000-PROCESS-ABEND                      20570069
205800     END-EVALUATE.                                                20580069
205900                                                                  20590069
206000                                                                  20600069
206100*----------------------------------------------------------------*20610069
206200* VALIDATE SML PRINTER ID                                        *20620069
206300*----------------------------------------------------------------*20630069
206400 3050-EDIT-SML-ID.                                                20640069
206500                                                                  20650069
206600*-----------------------------------------------------------------20660069
206700* VERIFY THAT SHIPPING MANIFEST LABEL(SML)/PACK-TO-LIGHT(P2L)     20670069
206800* PRINTER ID IS ENTERED AND IS VALID.                             20680069
206900* NOTE:  IF SML/P2L PRINTER ID NOT ENTERED                        20690069
207000*           AND CRE-LBL-IND = C (ALL CASEPACK)                    20700069
207100*           AND PGYBCK PRINTER ID HAS BEEN ENTERED                20710069
207200*           THEN SML/P2L PRINTER ID IS NOT NEEDED                 20720069
207300*-----------------------------------------------------------------20730069
207400                                                                  20740069
207500     IF  PS-NO-ERROR                                              20750069
207600         IF  ASC-SML-P2L-PRTR-ID = SPACES                         20760069
207700             IF  (ASC-PGYBCK-PRTR-ID > SPACES  AND                20770069
207800                  ASC-CRE-SML-LBL)                                20780069
207900                 CONTINUE                                         20790069
208000             ELSE                                                 20800069
208100                 SET PS-ERROR                                     20810069
208200                     DP020-MSG-FATAL       TO TRUE                20820069
208300                 MOVE PC-TSYMSG-01563      TO DP020-MSG-NUMBER    20830069
208400                 MOVE DP015-UNP-ALP-BRT-OFF                       20840069
208500                                           TO MDEST1A             20850069
208600                 MOVE DP015-RED            TO MDEST1C             20860069
208700                 MOVE DP015-REVERSE        TO MDEST1H             20870069
208800                 MOVE -1                   TO MDEST1L             20880069
208900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              20890069
209000             END-IF                                               20900069
209100         ELSE                                                     20910069
209200             MOVE ASC-SML-P2L-PRTR-ID TO DP072-PRINTER-ID         20920069
209300             MOVE PC-REPORT-PGM-1     TO DP072-RPT-PGM-NME        20930069
209400             PERFORM 3600-VALIDATE-PRINTER                        20940069
209500             IF  PS-NO-ERROR                                      20950069
209600                 PERFORM 3620-VALIDATE-PRINTER-ID-SML             20960069
209700                 MOVE  DP072-PRTR-CLUSTER-NBR                     20970069
209800                                   TO PV-SHP-PRTR-CLUSTER-NBR     20980069
209900                 MOVE  DP072-PRTR-IP-ADDRESS                      20990069
210000                                   TO PV-SHP-PRTR-ID-ADDR         21000069
210100                 MOVE  DP072-PRTR-CLUSTER-OS-RLSE-CDE             21010069
210200                                   TO PV-SHP-PRTR-OS-RLSE-CDE     21020069
210300                 MOVE  DP072-PRTR-DATA-XFER-MODE-ID               21030069
210400                                   TO PV-SHP-DATA-XFER-MODE-ID    21040069
210500                 MOVE  DP072-XMIT-INTFC-CDE                       21050069
210600                                   TO PV-SHP-XMIT-INTFC-CDE       21060069
210700             END-IF                                               21070069
210800         END-IF                                                   21080069
210900     END-IF.                                                      21090069
211000                                                                  21100069
211100*----------------------------------------------------------------*21110069
211200* VALIDATE PIGGYBACK PRINTER ID                                  *21120069
211300*----------------------------------------------------------------*21130069
211400 3060-EDIT-PGYBK-ID.                                              21140069
211500                                                                  21150069
211600*-----------------------------------------------------------------21160069
211700* IF PIGGYBACK LABEL PRINTER ID IS ENTERED - VALIDATE             21170069
211800*-----------------------------------------------------------------21180069
211900                                                                  21190069
212000     IF  PS-NO-ERROR                                              21200069
212100         IF  ASC-PGYBCK-PRTR-ID > SPACES                          21210069
212200             MOVE ASC-PGYBCK-PRTR-ID TO DP072-PRINTER-ID          21220069
212300             MOVE PC-REPORT-PGM-2    TO DP072-RPT-PGM-NME         21230069
212400             PERFORM 3600-VALIDATE-PRINTER                        21240069
212500             IF  PS-NO-ERROR                                      21250069
212600                 PERFORM 3640-VALIDATE-PRINTER-ID-PGBK            21260069
212700                 MOVE  DP072-PRTR-CLUSTER-NBR                     21270069
212800                                   TO PV-PGYBK-PRTR-CLUSTER-NBR   21280069
212900                 MOVE  DP072-PRTR-IP-ADDRESS                      21290069
213000                                   TO PV-PGYBK-PRTR-ID-ADDR       21300069
213100                 MOVE  DP072-PRTR-CLUSTER-OS-RLSE-CDE             21310069
213200                                   TO PV-PGYBK-PRTR-OS-RLSE-CDE   21320069
213300                 MOVE  DP072-PRTR-DATA-XFER-MODE-ID               21330069
213400                                   TO PV-PGYBK-DATA-XFER-MODE-ID  21340069
213500                 MOVE  DP072-XMIT-INTFC-CDE                       21350069
213600                                   TO PV-PGYBK-XMIT-INTFC-CDE     21360069
213700             END-IF                                               21370069
213800         END-IF                                                   21380069
213900     END-IF.                                                      21390069
214000                                                                  21400069
214100                                                                  21410069
214110 3100-CHECK-AUTOVE-DC.                                            21411099
214120     INITIALIZE RC040-FIELDS.                                     21412099
214130     MOVE PV-PO-NUMBER-HOLD        TO RC040-PO-NBR                21413099
214140     MOVE PV-REC-SEQ-HOLD          TO RC040-PO-RCVR               21414099
214170     SET RC040-RCVR-EXISTS         TO TRUE                        21417099
214192                                                                  21419299
214193     MOVE DP020-LOCATION-NBR       TO RC040-SIGNON-LOCATION.      21419399
214194     MOVE PC-CURRENT-PROGRAM-NAME  TO RC040-CALLING-PROGRAM.      21419499
214195                                                                  21419599
214196     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  21419699
214197                                        RC040-COMMAREA            21419799
214198                                        RC040-FIELDS.             21419899
214199                                                                  21419999
214205     EVALUATE TRUE                                                21420599
214206         WHEN RC040-SUCCESSFUL                                    21420699
214208             IF RC040-AUTO-VE-YES                                 21420899
214209                SET ASC-AUTOVE-PARM-YES TO TRUE                   21420999
214210             ELSE                                                 21421099
214211                SET ASC-AUTOVE-PARM-NO TO TRUE                    21421199
214212             END-IF                                               21421299
214219         WHEN OTHER                                               21421999
214220             SET PS-ERROR                                         21422099
214221                 DP020-MSG-FATAL       TO TRUE                    21422199
214230             MOVE PC-TSYMSG-00984      TO DP020-MSG-NUMBER        21423099
214234             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  21423499
214235     END-EVALUATE.                                                21423599
214236                                                                  21423699
214237                                                                  21423799
214238                                                                  21423899
214240*----------------------------------------------------------------*21424069
214300*  MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE  *21430069
214400*  MAP.                                                          *21440069
214500*----------------------------------------------------------------*21450069
214600 3200-RESET-ATTRIBUTES.                                           21460069
214700     MOVE DP015-UNP-ALP-NOR-OFF    TO MDEST1A                     21470069
214800                                      MDEST2A.                    21480069
214900     MOVE DP015-ASK-NOR-MDT        TO MOPIDA                      21490069
215000                                      MCOPIDA                     21500069
215100     MOVE DP015-UNP-ALP-NOR-MDT    TO MLBLOPTA                    21510069
215200                                      MPRTORDA                    21520069
215300                                      MHDRFTA                     21530069
215400                                      MCSEPKA                     21540069
215500                                      MINSTRA.                    21550069
215600     MOVE DP015-UNP-ALP-BRT-OFF    TO USE128A.                    21560069
215700     MOVE DP015-UNP-ALP-NOR-OFF    TO MPONBRA                     21570069
215800                                      MRECVRA                     21580069
215900                                      MLINEA                      21590069
216000                                      MP2LMODA                    21600069
216100                                      MCTNCNTA                    21610069
216200                                      MINPACKA                    21620069
216300                                      MOUTPCKA.                   21630069
216400     MOVE DP015-GREEN              TO MPONBRC                     21640069
216500                                      MRECVRC                     21650069
216600                                      MLINEC                      21660069
216700                                      MDEST1C                     21670069
216800                                      MDEST2C                     21680069
216900                                      MP2LMODC                    21690069
217000                                      MCTNCNTC                    21700069
217100                                      MINPACKC                    21710069
217200                                      MOUTPCKC                    21720069
217300                                      MLBLOPTC                    21730069
217400                                      MPRTORDC                    21740069
217500                                      MHDRFTC                     21750069
217600                                      MCSEPKC                     21760069
217700                                      MINSTRC.                    21770069
217800     MOVE DP015-BLUE               TO MOPIDC                      21780069
217900                                      MCOPIDC                     21790069
218000                                      MPKGCDC                     21800099
218010                                      MSETNMC.                    21801099
218100     MOVE DP015-HL-OFF             TO MOPIDH                      21810069
218200                                      MCOPIDH                     21820069
218300     MOVE DP015-UNDERLINE          TO MPONBRH                     21830069
218400                                      MRECVRH                     21840069
218500                                      MLINEH                      21850069
218600                                      MDEST1H                     21860069
218700                                      MDEST2H                     21870069
218800                                      MP2LMODH                    21880069
218900                                      MCTNCNTH                    21890069
219000                                      MINPACKH                    21900069
219100                                      MOUTPCKH                    21910069
219200                                      MLBLOPTH                    21920069
219300                                      MPRTORDH                    21930069
219400                                      MHDRFTH                     21940069
219500                                      MCSEPKH                     21950069
219600                                      MINSTRH                     21960069
219700                                      USE128H.                    21970069
219800                                                                  21980069
219900*----------------------------------------------------------------*21990069
220000*  OPEN A CURSOR TO SELECT ALL THE P2L MODULES FOR A GIVEN       *22000069
220100*  DEFAULT STORE ZONE                                            *22010069
220200*----------------------------------------------------------------*22020069
220300 3400-GET-P2L-MODULES.                                            22030069
220400                                                                  22040069
220500     INITIALIZE PMT-P2L-MODULE-TABLE.                             22050069
220600                                                                  22060069
220700     SET PMT-MOD-IDX TO PC-ZEROES.                                22070069
220800                                                                  22080069
220900     MOVE  ASC-OPER-UNT-ID  TO  PV-OPER-UNT-ID-HOLD.              22090069
221000                                                                  22100069
221100     PERFORM 3410-OPEN-MOD-CURSOR.                                22110069
221200     PERFORM 3420-FETCH-MOD-CURSOR.                               22120069
221300                                                                  22130069
221400     PERFORM UNTIL PS-EOF-MOD-CURSOR                              22140069
221500         IF  P2LMOD-MODU-NBR = PV-HOLD-MOD                        22150069
221600             CONTINUE                                             22160069
221700         ELSE                                                     22170069
221800             SET PMT-MOD-IDX UP BY +1                             22180069
221900             MOVE P2LMOD-MODU-NBR  TO                             22190069
222000                             PMT-MODULE (PMT-MOD-IDX)             22200069
222100             MOVE P2LMOD-MODU-NBR  TO PV-HOLD-MOD                 22210069
222200         END-IF                                                   22220069
222300         IF  PMT-MOD-IDX =  5                                     22230069
222400             SET PS-EOF-MOD-CURSOR TO TRUE                        22240069
222500         ELSE                                                     22250069
222600             PERFORM 3420-FETCH-MOD-CURSOR                        22260069
222700         END-IF                                                   22270069
222800     END-PERFORM                                                  22280069
222900                                                                  22290069
223000     PERFORM 3430-CLOSE-MOD-CURSOR.                               22300069
223100                                                                  22310069
223200                                                                  22320069
223300*----------------------------------------------------------------*22330069
223400*  THIS PROCEDURE WILL OPEN THE MODULE (P2L MODULE) CURSOR        22340069
223500*----------------------------------------------------------------*22350069
223600 3410-OPEN-MOD-CURSOR.                                            22360069
223700                                                                  22370069
223800     EXEC SQL                                                     22380069
223900         OPEN MODULE_CURSOR                                       22390069
224000     END-EXEC.                                                    22400069
224100                                                                  22410069
224200     EVALUATE TRUE                                                22420069
224300         WHEN SQLCODE = +0                                        22430069
224400              SET PS-NOT-EOF-MOD-CURSOR  TO  TRUE                 22440069
224500         WHEN SQLCODE  NOT =  +0                                  22450069
224600              MOVE '3410-OPEN-MOD-CURSOR'                         22460069
224700                                  TO DP013-PARAGRAPH              22470069
224800              MOVE 'OPEN P2L MODULE CURSOR'                       22480069
224900                                  TO DP013-MESSAGE-TEXT (1)       22490069
225000              MOVE SQLCA          TO DP013-SQLCA                  22500069
225100              MOVE 'TP2LMOD'      TO DP013-DB2-TABLE-NAME (1)     22510069
225200              SET DP013-DB2-ABEND TO TRUE                         22520069
225300              SET DP013-XCTL-DISPLAY-RESTART                      22530069
225400                                  TO TRUE                         22540069
225500              PERFORM DP013-0000-PROCESS-ABEND                    22550069
225600     END-EVALUATE.                                                22560069
225700                                                                  22570069
225800                                                                  22580069
225900*----------------------------------------------------------------*22590069
226000*  THIS PROCEDURE WILL FETCH THE MODULE (P2L MODULE) CURSOR       22600069
226100*----------------------------------------------------------------*22610069
226200 3420-FETCH-MOD-CURSOR.                                           22620069
226300                                                                  22630069
226400     EXEC SQL                                                     22640069
226500          FETCH MODULE_CURSOR                                     22650069
226600          INTO :P2LMOD-MODU-NBR                                   22660069
226700     END-EXEC.                                                    22670069
226800                                                                  22680069
226900     EVALUATE TRUE                                                22690069
227000         WHEN SQLCODE = ZERO                                      22700069
227100              CONTINUE                                            22710069
227200         WHEN SQLCODE = +100                                      22720069
227300              SET PS-EOF-MOD-CURSOR TO TRUE                       22730069
227400         WHEN SQLWARN0 NOT = +0                                   22740069
227500         WHEN SQLCODE < ZERO                                      22750069
227600         WHEN SQLCODE > ZERO                                      22760069
227700              MOVE '3420-FETCH-MOD-CURSOR'                        22770069
227800                                  TO DP013-PARAGRAPH              22780069
227900              MOVE 'FETCH P2L MODULE CURSOR'                      22790069
228000                                  TO DP013-MESSAGE-TEXT (1)       22800069
228100              MOVE SQLCA          TO DP013-SQLCA                  22810069
228200              MOVE 'TPTLMOD'      TO DP013-DB2-TABLE-NAME (1)     22820069
228300              SET DP013-DB2-ABEND TO TRUE                         22830069
228400              SET DP013-XCTL-DISPLAY-RESTART                      22840069
228500                                  TO TRUE                         22850069
228600              PERFORM DP013-0000-PROCESS-ABEND                    22860069
228700     END-EVALUATE.                                                22870069
228800                                                                  22880069
228900                                                                  22890069
229000*----------------------------------------------------------------*22900069
229100*  THIS PROCEDURE WILL CLOSE THE MODULE (P2L MODULE) CURSOR       22910069
229200*----------------------------------------------------------------*22920069
229300 3430-CLOSE-MOD-CURSOR.                                           22930069
229400                                                                  22940069
229500     EXEC SQL                                                     22950069
229600         CLOSE MODULE_CURSOR                                      22960069
229700     END-EXEC.                                                    22970069
229800                                                                  22980069
229900     EVALUATE TRUE                                                22990069
230000         WHEN SQLCODE = +0                                        23000069
230100              CONTINUE                                            23010069
230200         WHEN SQLCODE  NOT =  +0                                  23020069
230300              MOVE '3430-CLOSE-MOD-CURSOR'                        23030069
230400                                  TO DP013-PARAGRAPH              23040069
230500              MOVE 'CLOSE P2L MODULE CURSOR'                      23050069
230600                                  TO DP013-MESSAGE-TEXT (1)       23060069
230700              MOVE SQLCA          TO DP013-SQLCA                  23070069
230800              MOVE 'TP2LMOD'      TO DP013-DB2-TABLE-NAME (1)     23080069
230900              SET DP013-DB2-ABEND TO TRUE                         23090069
231000              SET DP013-XCTL-DISPLAY-RESTART                      23100069
231100                                  TO TRUE                         23110069
231200              PERFORM DP013-0000-PROCESS-ABEND                    23120069
231300     END-EVALUATE.                                                23130069
231400                                                                  23140069
231500                                                                  23150069
231600*----------------------------------------------------------------*23160069
231700*   3500-CHECK-SEASET-ITEM                                       *23170073
231800* CHECKS FOR SEASONAL SET ITEMS                                  *23180073
231900*----------------------------------------------------------------*23190069
232000 3500-CHECK-SEASET-ITEM.                                          23200073
232100                                                                  23210069
232101     MOVE ASC-PO-NBR-N           TO DK-PO.                        23210173
232102                                                                  23210273
232103     EXEC SQL                                                     23210373
232104        SELECT                                                    23210473
232105            A.SEASET_YR                                           23210573
232106           ,A.SEASET_SHRT_NM                                      23210673
232107           ,B.SEASET_NM                                           23210773
232108       INTO                                                       23210873
232109           :PURCHS-SEASET-YR                                      23210973
232110          ,:PURCHS-SEASET-SHRT-NM                                 23211073
232111          ,:SEASET-SEASET-NM                                      23211173
232112        FROM                                                      23211273
232113            TPURCHS A                                             23211373
232114          , TSEASET B                                             23211473
232115        WHERE PO_NBR         = :DK-PO                             23211573
232116          AND A.SEASET_YR      = B.SEASET_YR                      23211673
232117          AND A.SEASET_SHRT_NM = B.SEASET_SHRT_NM                 23211773
232118          AND A.VER_STATUS_CDE = 'A'                              23211873
232119     END-EXEC.                                                    23211973
232120                                                                  23212073
232121     EVALUATE TRUE                                                23212173
232122     WHEN SQLCODE = ZERO                                          23212273
232125     WHEN SQLCODE = -811                                          23212573
232126         PERFORM 3510-CHECK-DIVERT-NUMBER                         23212673
232127     WHEN SQLCODE = +100                                          23212773
232128         CONTINUE                                                 23212873
232129     END-EVALUATE.                                                23212973
232130                                                                  23213073
232131 3510-CHECK-DIVERT-NUMBER.                                        23213173
232132*----------------------------------------------------------------*23213273
232133*  CHECK THE SEASONAL SET DIVERT NUMBER                           23213373
232134*----------------------------------------------------------------*23213473
232135     EXEC SQL                                                     23213573
232136        SELECT                                                    23213673
232137            STR_RLSE_END_DTE                                      23213773
232138           ,DIVERT_PFX_NBR                                        23213873
232139        INTO                                                      23213973
232140           :SEASET-STR-RLSE-END-DTE                               23214073
232141          ,:SEASET-DIVERT-PFX-NBR                                 23214173
232142        FROM                                                      23214273
232143            TSEASET                                               23214373
232144        WHERE SEASET_YR       = :PURCHS-SEASET-YR                 23214473
232145          AND SEASET_SHRT_NM  = :PURCHS-SEASET-SHRT-NM            23214573
232146          AND SEASET_STAT_CDE = :PC-A                             23214673
232147     END-EXEC.                                                    23214773
232148                                                                  23214873
232149     EVALUATE TRUE                                                23214973
232150     WHEN SQLCODE = ZERO                                          23215073
232151     WHEN SQLCODE = -811                                          23215173
232152         PERFORM 3525-GET-CURRENT-DATE                            23215277
232153         PERFORM 3520-COMPARE-RELEASE-DATE                        23215373
232154     WHEN SQLCODE = +100                                          23215473
232155         CONTINUE                                                 23215573
232156     END-EVALUATE.                                                23215673
232157                                                                  23215773
232198*----------------------------------------------------------------*23219877
232199*  CHECK THE RELEASE ENDING DATE WITH THE CURRENT DATE            23219977
232200*----------------------------------------------------------------*23220077
232201 3520-COMPARE-RELEASE-DATE.                                       23220177
232202                                                                  23220277
232203     MOVE PURCHS-SEASET-SHRT-NM   TO ASC-SEASET-SHRT-NME.         23220399
232204                                                                  23220499
232205     IF  PURCHS-SEASET-SHRT-NM  = 'T & T' OR                      23220599
232206         PURCHS-SEASET-SHRT-NM  = 'T&T'                           23220699
232207         SET PS-SEASET-ITEM       TO TRUE                         23220799
232208     ELSE                                                         23220899
232209     IF PV-CURRENT-DB2-DATE > SEASET-STR-RLSE-END-DTE             23220999
232210         SET PS-NOT-SEASET-ITEM   TO TRUE                         23221099
232214     ELSE                                                         23221499
232215     IF  SEASET-DIVERT-PFX-NBR  >  0                              23221599
232216         SET PS-SEASET-ITEM       TO TRUE                         23221699
232218     ELSE                                                         23221899
232219         SET PS-NOT-SEASET-ITEM   TO TRUE                         23221998
232223     END-IF                                                       23222398
232224     END-IF                                                       23222498
232225     END-IF.                                                      23222598
232226                                                                  23222698
232227 3525-GET-CURRENT-DATE.                                           23222798
232228*----------------------------------------------------------------*23222898
232229* GET CURRENT DATE/TIME FROM CONTROL TABLE                       *23222998
232230*----------------------------------------------------------------*23223098
232231     EXEC SQL                                                     23223198
232232         SELECT  CURRENT DATE                                     23223298
232233           INTO  :PV-CURRENT-DB2-DATE                             23223398
232234           FROM  TCOCNTL                                          23223498
232235          WHERE  OPER_UNT_ID = 90                                 23223598
232236     END-EXEC.                                                    23223698
232237                                                                  23223798
232238     EVALUATE TRUE                                                23223898
232239         WHEN SQLCODE = ZERO                                      23223998
232240              CONTINUE                                            23224098
232241         WHEN OTHER                                               23224198
232242              MOVE '3525-GET-CURRENT-DATE'                        23224298
232243                                  TO DP013-PARAGRAPH              23224398
232244              MOVE 'SELECT ON TCOCNTL'                            23224498
232245                                  TO DP013-MESSAGE-TEXT (1)       23224598
232246              MOVE SQLCA          TO DP013-SQLCA                  23224698
232247              MOVE 'TCOCNTL'      TO DP013-DB2-TABLE-NAME (1)     23224798
232248              SET DP013-DB2-ABEND TO TRUE                         23224898
232249              SET DP013-XCTL-DISPLAY-RESTART                      23224998
232250                                  TO TRUE                         23225098
232251              PERFORM DP013-0000-PROCESS-ABEND                    23225198
232252     END-EVALUATE.                                                23225298
232253/                                                                 23225398
232254*----------------------------------------------------------------*23225498
232255*   3600-VALIDATE-PRINTER                                        *23225598
232256* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *23225698
232257*----------------------------------------------------------------*23225798
232258 3600-VALIDATE-PRINTER.                                           23225898
232259                                                                  23225998
232260     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     23226069
232300     MOVE DP020-LOCATION-NBR         TO DP072-ORIGIN-OPER-UNT-ID. 23230099
232400     MOVE DP020-LOCATION-NBR         TO DP072-OPER-UNT-ID.        23240099
232500     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     23250069
232600                                        DP072-FCLTY-ID.           23260069
232700     SET DP072-VALIDATE              TO TRUE.                     23270069
232800                                                                  23280069
232900     EXEC CICS                                                    23290069
233000          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  23300069
233100               COMMAREA (DP072-COMM-AREA)                         23310069
233200               RESP     (PV-CICS-RESPONSE)                        23320069
233300     END-EXEC                                                     23330069
233400                                                                  23340069
233500     EVALUATE TRUE                                                23350069
233600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 23360069
233700              CONTINUE                                            23370069
233800         WHEN OTHER                                               23380069
233900             SET PS-ERROR                                         23390069
234000                 DP020-MSG-FATAL       TO TRUE                    23400069
234100             MOVE PC-TSYMSG-00746      TO DP020-MSG-NUMBER        23410069
234200             IF  DP072-RPT-PGM-NME = PC-REPORT-PGM-1              23420069
234300                 MOVE DP015-UNP-ALP-BRT-OFF                       23430069
234400                                       TO MDEST1A                 23440069
234500                 MOVE DP015-RED        TO MDEST1C                 23450069
234600                 MOVE DP015-REVERSE    TO MDEST1H                 23460069
234700                 MOVE -1               TO MDEST1L                 23470069
234800             ELSE                                                 23480069
234900                 MOVE DP015-UNP-ALP-BRT-OFF                       23490069
235000                                       TO MDEST2A                 23500069
235100                 MOVE DP015-RED        TO MDEST2C                 23510069
235200                 MOVE DP015-REVERSE    TO MDEST2H                 23520069
235300                 MOVE -1               TO MDEST2L                 23530069
235400             END-IF                                               23540069
235500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  23550069
235600     END-EVALUATE.                                                23560069
235700                                                                  23570069
235800                                                                  23580069
235900*----------------------------------------------------------------*23590069
236000*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *23600069
236100*  THIS IS A VALID PRINTER AND THAT SHIPPING MANIFEST LABELS     *23610069
236200*  CAN BE PRINTED ON THIS PRINTER.                               *23620069
236300*----------------------------------------------------------------*23630069
236400 3620-VALIDATE-PRINTER-ID-SML.                                    23640069
236500                                                                  23650069
236600     IF  DP072-PRTR-CLUSTER-OS-RLSE-CDE  =  PC-MGMX               23660069
236700         SET  PS-PRINTER-ERROR                                    23670069
236800              PS-ERROR                                            23680069
236900              DP020-MSG-FATAL         TO TRUE                     23690069
237000         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         23700069
237100         MOVE DP015-UNP-ALP-BRT-OFF   TO MDEST1A                  23710069
237200         MOVE DP015-RED               TO MDEST1C                  23720069
237300         MOVE DP015-REVERSE           TO MDEST1H                  23730069
237400         MOVE -1                      TO MDEST1L                  23740069
237500         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     23750069
237600     END-IF.                                                      23760069
237700                                                                  23770069
237800     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    =  PC-A                  23780069
237900         CONTINUE                                                 23790069
238000     ELSE                                                         23800069
238100         SET  PS-PRINTER-ERROR                                    23810069
238200              PS-ERROR                                            23820069
238300              DP020-MSG-FATAL         TO TRUE                     23830069
238400         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         23840069
238500         MOVE DP015-UNP-ALP-BRT-OFF   TO MDEST1A                  23850069
238600         MOVE DP015-RED               TO MDEST1C                  23860069
238700         MOVE DP015-REVERSE           TO MDEST1H                  23870069
238800         MOVE -1                      TO MDEST1L                  23880069
238900         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     23890069
239000     END-IF.                                                      23900069
239100                                                                  23910069
239200                                                                  23920069
239300*----------------------------------------------------------------*23930069
239400*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *23940069
239500*  THIS IS A VALID PRINTER AND THAT PIGGYBACK LABELS CAN BE      *23950069
239600*  PRINTED ON THIS PRINTER.                                      *23960069
239700*----------------------------------------------------------------*23970069
239800 3640-VALIDATE-PRINTER-ID-PGBK.                                   23980069
239900                                                                  23990069
240000     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    = PC-A                   24000069
240100         CONTINUE                                                 24010069
240200     ELSE                                                         24020069
240300         SET  PS-PRINTER-ERROR                                    24030069
240400              PS-ERROR                                            24040069
240500              DP020-MSG-FATAL         TO TRUE                     24050069
240600         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         24060069
240700         MOVE DP015-UNP-ALP-BRT-OFF   TO MDEST2A                  24070069
240800         MOVE DP015-RED               TO MDEST2C                  24080069
240900         MOVE DP015-REVERSE           TO MDEST2H                  24090069
241000         MOVE -1                      TO MDEST2L                  24100069
241100         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     24110069
241200     END-IF.                                                      24120069
241300                                                                  24130069
241400                                                                  24140069
241401*----------------------------------------------------------------*24140199
241402* GET THE DEPARTMENT NUMBER FROM THE PO TABLE TO PASS THROUGH    *24140299
241403* TO THE COMM-AREA.                                              *24140399
241404*----------------------------------------------------------------*24140499
241410 3700-GET-PO-DEPT.                                                24141099
241411                                                                  24141199
241420     EXEC SQL                                                     24142099
241430         SELECT DEPT_NBR                                          24143099
241490           INTO :PURCHS-DEPT-NBR                                  24149099
241496           FROM TRECEIV A                                         24149699
241497              , TPURCHS B                                         24149799
241498          WHERE A.ORD_NBR       =  :PV-PO-NUMBER-HOLD             24149899
241499            AND A.REC_SEQ_NBR   =  :PV-REC-SEQ-HOLD               24149999
241500            AND B.PO_NBR        =  A.ORD_NBR                      24150099
241501            AND B.VER_NBR       =  A.PO_VER_NBR                   24150199
241502     END-EXEC.                                                    24150299
241503                                                                  24150399
241504     EVALUATE TRUE                                                24150499
241505         WHEN SQLCODE = +0                                        24150599
241506              MOVE  PURCHS-DEPT-NBR TO ASC-DPT-NBR                24150699
241583         WHEN SQLCODE = +100                                      24158399
241584              MOVE  0               TO ASC-DPT-NBR                24158499
241600         WHEN OTHER                                               24160099
241601              MOVE '3700-GET-PO-DEPT'                             24160199
241602                               TO DP013-PARAGRAPH                 24160299
241603              MOVE 'GET PO DEPARTMENT NUMBER'                     24160399
241604                               TO DP013-MESSAGE-TEXT (1)          24160499
241605              MOVE SQLCA       TO DP013-SQLCA                     24160599
241606              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        24160699
241607              SET DP013-DB2-ABEND                                 24160799
241608                  DP013-XCTL-DISPLAY-RESTART                      24160899
241609                               TO TRUE                            24160999
241610              PERFORM DP013-0000-PROCESS-ABEND                    24161099
241611     END-EVALUATE.                                                24161199
241612                                                                  24161299
241613                                                                  24161399
241614*----------------------------------------------------------------*24161469
241620* VERIFY THAT THE LINE NUMBER IS VALID (TRANSCRIBED) AND THAT    *24162069
241700* STORE DISTRIBUTION EXISTS.                                     *24170069
241800*----------------------------------------------------------------*24180069
241900 3800-VERIFY-LINE-NBR.                                            24190069
242000                                                                  24200069
242100     SET PS-LINE-STATUS-UNKNOWN  TO  TRUE.                        24210069
242200     MOVE  MPONBRI            TO  PV-PO-NUMBER-HOLD.              24220069
242300     MOVE  MRECVRI            TO  PV-REC-SEQ-HOLD.                24230069
242400     MOVE  MLINEI             TO  PV-LINE-NBR-HOLD.               24240069
242500                                                                  24250069
242600     IF  PS-NO-ERROR                                              24260069
242700         EXEC SQL                                                 24270069
242800             SELECT ORD_NBR                                       24280069
242900                   ,REC_SEQ_NBR                                   24290069
243000                   ,ORD_LNE_NBR                                   24300069
243100                   ,STATUS_CDE                                    24310069
243200                   ,OPER_UNT_ID                                   24320069
243300                   ,PREPK_ID                                      24330069
243400               INTO :RECITM-ORD-NBR                               24340069
243500                   ,:RECITM-REC-SEQ-NBR                           24350069
243600                   ,:RECITM-ORD-LNE-NBR                           24360069
243700                   ,:RECITM-STATUS-CDE                            24370069
243800                   ,:PV-RECITM-OPER-UNT-ID                        24380069
243900                   ,:PV-PREPK-ID-HOLD                             24390069
244000               FROM TRECITM                                       24400069
244100              WHERE ORD_NBR        = :PV-PO-NUMBER-HOLD           24410069
244200                AND REC_SEQ_NBR    = :PV-REC-SEQ-HOLD             24420069
244300                AND ORD_LNE_NBR    = :PV-LINE-NBR-HOLD            24430069
244400         END-EXEC                                                 24440069
244500                                                                  24450069
244600         EVALUATE TRUE                                            24460069
244700             WHEN SQLCODE = +0                                    24470069
244800              IF  RECITM-STATUS-CDE  = 'VE'                       24480069
244900                  MOVE  'VERFYD  '          TO  PV-LINE-STATUS    24490069
245000                  SET PS-LINE-STATUS-KNOWN  TO  TRUE              24500069
245100              END-IF                                              24510069
245200             WHEN SQLCODE = +100                                  24520069
245300                 SET PS-ERROR                                     24530069
245400                     DP020-MSG-FATAL       TO TRUE                24540069
245500                 MOVE PC-TSYMSG-01729      TO DP020-MSG-NUMBER    24550069
245600                 MOVE DP015-UNP-ALP-BRT-OFF                       24560069
245700                                           TO MLINEA              24570069
245800                 MOVE DP015-RED            TO MLINEC              24580069
245900                 MOVE DP015-REVERSE        TO MLINEH              24590069
246000                 MOVE -1                   TO MLINEL              24600069
246100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              24610069
246200             WHEN OTHER                                           24620069
246300                  MOVE '3800-VERIFY-LINE-NBR      '               24630069
246400                                   TO DP013-PARAGRAPH             24640069
246500                  MOVE 'VERIFY LINE NBR VALID   '                 24650069
246600                                   TO DP013-MESSAGE-TEXT (1)      24660069
246700                  MOVE SQLCA       TO DP013-SQLCA                 24670069
246800                  MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)    24680069
246900                  SET DP013-DB2-ABEND                             24690069
247000                      DP013-XCTL-DISPLAY-RESTART                  24700069
247100                                   TO TRUE                        24710069
247200                  PERFORM DP013-0000-PROCESS-ABEND                24720069
247300         END-EVALUATE                                             24730069
247400     END-IF.                                                      24740069
247500                                                                  24750069
247600     IF  PS-NO-ERROR                                              24760069
247700         EXEC SQL                                                 24770069
247800             SELECT  COUNT(*)                                     24780069
247900               INTO  :PV-STORE-DIST-COUNT                         24790069
248000               FROM  TRECDIS                                      24800069
248100              WHERE  ORD_NBR        = :PV-PO-NUMBER-HOLD          24810069
248200                AND  REC_SEQ_NBR    = :PV-REC-SEQ-HOLD            24820069
248300                AND  ORD_LNE_NBR    = :PV-LINE-NBR-HOLD           24830069
248400         END-EXEC                                                 24840069
248500                                                                  24850069
248600         IF  PV-STORE-DIST-COUNT  >  ZERO                         24860069
248700             PERFORM 4600-GET-LINE-STATUS                         24870069
248800             MOVE  PV-LINE-STATUS  TO ASC-LINE-STATUS             24880069
248900             MOVE  PV-LINE-STATUS  TO MLINESTO                    24890069
249000         ELSE                                                     24900069
249100             SET PS-ERROR                                         24910069
249200                 DP020-MSG-FATAL           TO TRUE                24920069
249300             MOVE PC-TSYMSG-00918          TO DP020-MSG-NUMBER    24930069
249400             MOVE DP015-UNP-ALP-BRT-OFF    TO MLINEA              24940069
249500             MOVE DP015-RED                TO MLINEC              24950069
249600             MOVE DP015-REVERSE            TO MLINEH              24960069
249700             MOVE -1                       TO MLINEL              24970069
249800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  24980069
249900         END-IF                                                   24990069
250000     END-IF.                                                      25000069
250100                                                                  25010069
250200                                                                  25020069
250300*----------------------------------------------------------------*25030069
250400* VERIFY THAT THE MODULE NUMBER IS VALID                         *25040069
250500*----------------------------------------------------------------*25050069
250600 4000-VERIFY-MODULE-NBR.                                          25060069
250700                                                                  25070069
250800     MOVE  ASC-OPER-UNT-ID-N  TO  PV-OPER-UNT-ID-HOLD.            25080069
250900     MOVE  ASC-MODU-NBR-N     TO  PV-MODU-NBR-HOLD.               25090069
251000                                                                  25100069
251100     IF  PS-NO-ERROR                                              25110069
251200         EXEC SQL                                                 25120069
251300             SELECT OPER_UNT_ID                                   25130069
251400               INTO :P2LMOD-OPER-UNT-ID                           25140069
251500               FROM TP2LMOD                                       25150069
251600              WHERE OPER_UNT_ID    = :PV-OPER-UNT-ID-HOLD         25160069
251700                AND MODU_NBR       = :PV-MODU-NBR-HOLD            25170069
251800         END-EXEC                                                 25180069
251900                                                                  25190069
252000         EVALUATE TRUE                                            25200069
252100             WHEN SQLCODE = +0                                    25210069
252200                  CONTINUE                                        25220069
252300             WHEN SQLCODE = +100                                  25230069
252400                 SET PS-ERROR                                     25240069
252500                     DP020-MSG-FATAL       TO TRUE                25250069
252600                 MOVE PC-TSYMSG-01731      TO DP020-MSG-NUMBER    25260069
252700                 MOVE DP015-UNP-ALP-BRT-OFF                       25270069
252800                                           TO MP2LMODA            25280069
252900                 MOVE DP015-RED            TO MP2LMODC            25290069
253000                 MOVE DP015-REVERSE        TO MP2LMODH            25300069
253100                 MOVE -1                   TO MP2LMODL            25310069
253200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              25320069
253300             WHEN OTHER                                           25330069
253400                  MOVE '4000-VERIFY-MODULE-NBR    '               25340069
253500                                   TO DP013-PARAGRAPH             25350069
253600                  MOVE 'VERIFY MODULE NBR VALID '                 25360069
253700                                   TO DP013-MESSAGE-TEXT (1)      25370069
253800                  MOVE SQLCA       TO DP013-SQLCA                 25380069
253900                  MOVE 'TP2LMOD '  TO DP013-DB2-TABLE-NAME (1)    25390069
254000                  SET DP013-DB2-ABEND                             25400069
254100                      DP013-XCTL-DISPLAY-RESTART                  25410069
254200                                   TO TRUE                        25420069
254300                  PERFORM DP013-0000-PROCESS-ABEND                25430069
254400         END-EVALUATE                                             25440069
254500     END-IF.                                                      25450069
254600                                                                  25460069
254700                                                                  25470069
254800*----------------------------------------------------------------*25480069
254900* VERIFY THAT OUTERPACK QTY IS DIVISIBLE BY INNERPACK QTY        *25490069
255000*----------------------------------------------------------------*25500069
255100 4200-VERIFY-INNER-OUTER-PACK.                                    25510069
255200                                                                  25520069
255300     DIVIDE  ASC-INPK-UNT-QTY-N                                   25530069
255400       INTO  ASC-OTPK-UNT-QTY-N                                   25540069
255500     GIVING  PV-IN-OUT-PK-RESULT REMAINDER PV-IN-OUT-REMAINDER.   25550069
255600                                                                  25560069
255700     IF  PV-IN-OUT-REMAINDER = ZERO                               25570069
255800         CONTINUE                                                 25580069
255900     ELSE                                                         25590069
256000         SET PS-ERROR                                             25600069
256100             DP020-MSG-FATAL           TO TRUE                    25610069
256200         MOVE PC-TSYMSG-01000          TO DP020-MSG-NUMBER        25620069
256300         MOVE DP015-UNP-ALP-BRT-OFF    TO MINPACKA                25630069
256400                                          MOUTPCKA                25640069
256500         MOVE DP015-RED                TO MINPACKC                25650069
256600                                          MOUTPCKC                25660069
256700         MOVE DP015-REVERSE            TO MINPACKH                25670069
256800                                          MOUTPCKH                25680069
256900         MOVE -1                       TO MINPACKL                25690069
257000                                          MOUTPCKL                25700069
257100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      25710069
257200     END-IF.                                                      25720069
257300                                                                  25730069
257400                                                                  25740069
257500*----------------------------------------------------------------*25750069
257600* IF CREATE LABEL HAS BEEN SELECTED(F23).  CHECK TO SEE IF THIS  *25760069
257700* RECEIVER IS ONLY PART OF A SHIPMENT (DELIVERY IS COMING IN MULT*25770069
257800* TRUCKS.  LOOK FOR OTHER RECEIVERS FOR THIS DC & PO THAT ARE NOT*25780069
257900* IN VERIFIED STATUS.                                            *25790069
258000* PO/RECEIVER LINE HAS NOT BEEN KEYED                            *25800069
258100*----------------------------------------------------------------*25810069
258200 4400-CHECK-MULT-RECV-NO-LINE.                                    25820069
258300                                                                  25830069
258400     INITIALIZE  PV-RECITM-COUNT.                                 25840069
258500                                                                  25850069
258600     EXEC SQL                                                     25860069
258700          SELECT  COUNT(*)                                        25870069
258800            INTO  :PV-RECITM-COUNT                                25880069
258900            FROM  TRECITM                                         25890069
259000           WHERE  ORD_NBR        = :PV-PO-NUMBER-HOLD             25900069
259100             AND  OPER_UNT_ID    = :RECEIV-OPER-UNT-ID            25910069
259200             AND  REC_SEQ_NBR   <> :PV-REC-SEQ-HOLD               25920069
259300             AND  VER_STATUS_CDE = :PC-A                          25930069
259400             AND  NOT STATUS_CDE = 'VE'                           25940069
259500     END-EXEC.                                                    25950069
259600                                                                  25960069
259700     EVALUATE TRUE                                                25970069
259800         WHEN SQLCODE = +0                                        25980069
259900              IF  PV-RECITM-COUNT  >  0                           25990069
260000                  SET PS-RECITM-ON-MULTI-RCVRS TO  TRUE           26000069
260100              ELSE                                                26010069
260200                  SET PS-RECITM-NOT-ON-MULTI-RCVRS TO  TRUE       26020069
260300              END-IF                                              26030069
260400         WHEN SQLCODE = +100                                      26040069
260500              SET PS-RECITM-NOT-ON-MULTI-RCVRS TO  TRUE           26050069
260600         WHEN SQLWARN0 NOT = +0                                   26060069
260700         WHEN SQLCODE < ZERO                                      26070069
260800         WHEN SQLCODE > ZERO                                      26080069
260900              MOVE '4400-CHECK-MULT-RECV-NO-LINE'                 26090069
261000                                  TO DP013-PARAGRAPH              26100069
261100              MOVE 'COUNT MULT RCVRS - NO LINE'                   26110069
261200                                  TO DP013-MESSAGE-TEXT (1)       26120069
261300              MOVE SQLCA          TO DP013-SQLCA                  26130069
261400              MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (1)     26140069
261500              SET DP013-DB2-ABEND TO TRUE                         26150069
261600              SET DP013-XCTL-DISPLAY-RESTART                      26160069
261700                                  TO TRUE                         26170069
261800              PERFORM DP013-0000-PROCESS-ABEND                    26180069
261900     END-EVALUATE.                                                26190069
262000                                                                  26200069
262100     IF  PS-RECITM-ON-MULTI-RCVRS                                 26210069
262200         SET PS-ERROR                                             26220069
262300             DP020-MSG-WARNING TO TRUE                            26230069
262400         MOVE PC-TSYMSG-01733  TO DP020-MSG-NUMBER                26240069
262500         MOVE -1               TO MPONBRL                         26250069
262600         MOVE DP015-RED        TO MPONBRC                         26260069
262700         MOVE DP015-REVERSE    TO MPONBRH                         26270069
262800         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      26280069
262900     END-IF.                                                      26290069
263000                                                                  26300069
263100                                                                  26310069
263200*----------------------------------------------------------------*26320069
263300* IF CREATE LABEL HAS BEEN SELECTED(F23).  CHECK TO SEE IF THIS  *26330069
263400* RECEIVER IS ONLY PART OF A SHIPMENT (DELIVERY IS COMING IN MULT*26340069
263500* TRUCKS.  LOOK FOR OTHER RECEIVERS FOR THIS DC & PO THAT ARE NOT*26350069
263600* IN VERIFIED STATUS.                                            *26360069
263700* PO/RECEIVER LINE HAS BEEN KEYED                                *26370069
263800*----------------------------------------------------------------*26380069
263900 4500-CHECK-MULT-RECV-WITH-LINE.                                  26390069
264000                                                                  26400069
264100     MOVE ASC-PO-LINE-NBR  TO  PV-RECITM-ORD-LNE-NBR.             26410069
264200     INITIALIZE  PV-RECITM-COUNT.                                 26420069
264300                                                                  26430069
264400     EXEC SQL                                                     26440069
264500          SELECT  COUNT(*)                                        26450069
264600            INTO  :PV-RECITM-COUNT                                26460069
264700            FROM  TRECITM                                         26470069
264800           WHERE  ORD_NBR        = :PV-PO-NUMBER-HOLD             26480069
264900             AND  OPER_UNT_ID    = :RECEIV-OPER-UNT-ID            26490069
265000             AND  ORD_LNE_NBR    = :PV-RECITM-ORD-LNE-NBR         26500069
265100             AND  REC_SEQ_NBR   <> :PV-REC-SEQ-HOLD               26510069
265200             AND  VER_STATUS_CDE = :PC-A                          26520069
265300             AND  NOT STATUS_CDE = 'VE'                           26530069
265400     END-EXEC.                                                    26540069
265500                                                                  26550069
265600     EVALUATE TRUE                                                26560069
265700         WHEN SQLCODE = +0                                        26570069
265800              IF  PV-RECITM-COUNT  >  0                           26580069
265900                  SET PS-RECITM-ON-MULTI-RCVRS TO  TRUE           26590069
266000              ELSE                                                26600069
266100                  SET PS-RECITM-NOT-ON-MULTI-RCVRS TO  TRUE       26610069
266200              END-IF                                              26620069
266300         WHEN SQLCODE = +100                                      26630069
266400              SET PS-RECITM-NOT-ON-MULTI-RCVRS TO  TRUE           26640069
266500         WHEN SQLWARN0 NOT = +0                                   26650069
266600         WHEN SQLCODE < ZERO                                      26660069
266700         WHEN SQLCODE > ZERO                                      26670069
266800              MOVE '4500-CHECK-MULT-RECV-WITH-LINE'               26680069
266900                                  TO DP013-PARAGRAPH              26690069
267000              MOVE 'COUNT MULT RCVRS - BY LINE'                   26700069
267100                                  TO DP013-MESSAGE-TEXT (1)       26710069
267200              MOVE SQLCA          TO DP013-SQLCA                  26720069
267300              MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (1)     26730069
267400              SET DP013-DB2-ABEND TO TRUE                         26740069
267500              SET DP013-XCTL-DISPLAY-RESTART                      26750069
267600                                  TO TRUE                         26760069
267700              PERFORM DP013-0000-PROCESS-ABEND                    26770069
267800     END-EVALUATE.                                                26780069
267900                                                                  26790069
268000     IF  PS-RECITM-ON-MULTI-RCVRS                                 26800069
268100         SET PS-ERROR                                             26810069
268200             DP020-MSG-WARNING TO TRUE                            26820069
268300         MOVE PC-TSYMSG-01733  TO DP020-MSG-NUMBER                26830069
268400         MOVE -1               TO MPONBRL                         26840069
268500         MOVE DP015-RED        TO MPONBRC                         26850069
268600         MOVE DP015-REVERSE    TO MPONBRH                         26860069
268700         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      26870069
268800     END-IF.                                                      26880069
268900                                                                  26890069
269000                                                                  26900069
269100*----------------------------------------------------------------*26910069
269200*                                                                *26920069
269300*----------------------------------------------------------------*26930069
269400 4600-GET-LINE-STATUS.                                            26940069
269500                                                                  26950069
269600     IF  PS-LINE-STATUS-UNKNOWN                                   26960069
269700         PERFORM 4620-CHECK-DISTHD.                               26970069
269800                                                                  26980069
269900     IF  PS-DISTHD-RECORD-FOUND                                   26990069
270000         MOVE  DISTHD-ODD-CART-UNT-QTY                            27000069
270100           TO  ASC-ODD-CART-UNT-QTY                               27010069
270200     ELSE                                                         27020069
270300         MOVE  ZEROES                                             27030069
270400           TO  ASC-ODD-CART-UNT-QTY                               27040069
270500     END-IF.                                                      27050069
270600                                                                  27060069
270700     IF  ASC-ODD-CART-UNT-QTY  >  ZERO                            27070069
270800         PERFORM 4625-ODD-CART-USE                                27080069
270900         IF  PV-DISTDT-ODD-CNT-FCSE > ZERO                        27090069
271000             SET ASC-ODD-CRTN-FCSE  TO  TRUE                      27100069
271100         ELSE                                                     27110069
271200         IF  PV-DISTDT-ODD-CNT-INPK > ZERO                        27120069
271300             SET ASC-ODD-CRTN-INPK  TO  TRUE                      27130069
271400         ELSE                                                     27140069
271500             SET ASC-ODD-CRTN-P2L   TO  TRUE                      27150069
271600         END-IF                                                   27160069
271700         END-IF                                                   27170069
271800     END-IF.                                                      27180069
271900                                                                  27190069
272000*----------------------------------------------------------------*27200069
272100*                                                                *27210069
272200*----------------------------------------------------------------*27220069
272300 4620-CHECK-DISTHD.                                               27230069
272400                                                                  27240069
272500     SET PS-NOT-DISTHD-RECORD-FOUND TO TRUE.                      27250069
272600                                                                  27260069
272700     EXEC SQL                                                     27270069
272800          SELECT  SYS_CRE_CDE                                     27280069
272900                 ,RSLTS_RCVD_TMST                                 27290069
273000                 ,PRCG_STAT_CDE                                   27300069
273100                 ,TOT_CART_CNT                                    27310069
273200                 ,PRC_AREA_MODU_ID                                27320069
273300                 ,FCSE_CNFRMN_TMST                                27330069
273400                 ,ODD_CART_UNT_QTY                                27340069
273500                 ,UCC128_DAT_USG_CDE                              27350069
273600            INTO  :DISTHD-SYS-CRE-CDE                             27360069
273700                 ,:DISTHD-RSLTS-RCVD-TMST                         27370069
273800                 ,:DISTHD-PRCG-STAT-CDE                           27380069
273900                 ,:DISTHD-TOT-CART-CNT                            27390069
274000                 ,:DISTHD-PRC-AREA-MODU-ID                        27400069
274100                 ,:DISTHD-FCSE-CNFRMN-TMST                        27410069
274200                 ,:DISTHD-ODD-CART-UNT-QTY                        27420069
274300                 ,:DISTHD-UCC128-DAT-USG-CDE                      27430069
274400            FROM  TDISTHD                                         27440069
274500            WHERE ORD_NBR          = :PV-PO-NUMBER-HOLD           27450069
274600              AND RCVR_SEQ_NBR     = :PV-REC-SEQ-HOLD             27460069
274700              AND ORD_LNE_NBR      = :PV-LINE-NBR-HOLD            27470069
274800     END-EXEC.                                                    27480069
274900                                                                  27490069
275000     EVALUATE TRUE                                                27500069
275100         WHEN SQLCODE = ZERO                                      27510069
275200             PERFORM 4630-BY-OLD-OR-UPLOADED                      27520069
275300             SET PS-DISTHD-RECORD-FOUND TO TRUE                   27530069
275400         WHEN SQLCODE = +100                                      27540069
275500              CONTINUE                                            27550069
275600         WHEN SQLWARN0 NOT = SPACES                               27560069
275700         WHEN SQLCODE  NOT = ZERO                                 27570069
275800             MOVE '4620-CHECK-DISTHD'                             27580069
275900                                 TO DP013-PARAGRAPH               27590069
276000             MOVE 'UNSUCCESSFUL SELECT OF TDISTHD'                27600069
276100                                 TO DP013-MESSAGE-TEXT (1)        27610069
276200             MOVE SQLCA         TO DP013-SQLCA                    27620069
276300             MOVE 'TDISTHD'     TO DP013-DB2-TABLE-NAME (1)       27630069
276400             SET DP013-DB2-ABEND                                  27640069
276500                 DP013-XCTL-DISPLAY-RESTART                       27650069
276600                                 TO TRUE                          27660069
276700                                                                  27670069
276800             PERFORM DP013-0000-PROCESS-ABEND                     27680069
276900     END-EVALUATE.                                                27690069
277000                                                                  27700069
277100     IF  PS-LINE-STATUS-UNKNOWN                                   27710069
277200         PERFORM 4640-CHECK-TROUBLE.                              27720069
277300                                                                  27730069
277400     IF  PS-LINE-STATUS-UNKNOWN                                   27740069
277500         PERFORM 4650-CHECK-DC-RTV.                               27750069
277600                                                                  27760069
277700     IF  PS-LINE-STATUS-UNKNOWN  AND                              27770069
277800         PS-DISTHD-RECORD-FOUND                                   27780069
277900         PERFORM 4690-EVALUATE-STAT-CODE                          27790069
278000     ELSE                                                         27800069
278100     IF  PS-LINE-STATUS-UNKNOWN                                   27810069
278200        MOVE SPACES                    TO  PV-LINE-STATUS.        27820069
278300                                                                  27830069
278400*----------------------------------------------------------------*27840069
278500*                                                                *27850069
278600*----------------------------------------------------------------*27860069
278700 4625-ODD-CART-USE.                                               27870069
278800                                                                  27880069
278900     EXEC SQL                                                     27890069
279000         SELECT COUNT(*)                                          27900069
279100           INTO :PV-DISTDT-ODD-CNT-FCSE                           27910069
279200           FROM TDISTDT                                           27920069
279300          WHERE ORD_NBR      = :PV-PO-NUMBER-HOLD                 27930069
279400            AND RCVR_SEQ_NBR = :PV-REC-SEQ-HOLD                   27940069
279500            AND ORD_LNE_NBR  = :PV-LINE-NBR-HOLD                  27950069
279600            AND ODD_CART_IND = :PC-F                              27960069
279700     END-EXEC.                                                    27970069
279800                                                                  27980069
279900     EVALUATE TRUE                                                27990069
280000         WHEN SQLCODE = +0                                        28000069
280100             CONTINUE                                             28010069
280200         WHEN SQLWARN0 NOT = SPACES                               28020069
280300         WHEN SQLCODE  NOT = ZERO                                 28030069
280400             MOVE '4625-ODD-CART-USE - 1'                         28040069
280500                                 TO DP013-PARAGRAPH               28050069
280600                                                                  28060069
280700             MOVE 'CHECK IF ODD CARTON USE IS FCSE'               28070069
280800                               TO DP013-MESSAGE-TEXT (1)          28080069
280900             MOVE SQLCA        TO DP013-SQLCA                     28090069
281000             MOVE 'TDISTDT'    TO DP013-DB2-TABLE-NAME (1)        28100069
281100             SET DP013-DB2-ABEND                                  28110069
281200                 DP013-XCTL-DISPLAY-RESTART                       28120069
281300                               TO TRUE                            28130069
281400             PERFORM DP013-0000-PROCESS-ABEND                     28140069
281500     END-EVALUATE.                                                28150069
281600                                                                  28160069
281700     EXEC SQL                                                     28170069
281800         SELECT COUNT(*)                                          28180069
281900           INTO :PV-DISTDT-ODD-CNT-INPK                           28190069
282000           FROM TDISTDT                                           28200069
282100          WHERE ORD_NBR      = :PV-PO-NUMBER-HOLD                 28210069
282200            AND RCVR_SEQ_NBR = :PV-REC-SEQ-HOLD                   28220069
282300            AND ORD_LNE_NBR  = :PV-LINE-NBR-HOLD                  28230069
282400            AND ODD_CART_IND = :PC-I                              28240069
282500     END-EXEC.                                                    28250069
282600                                                                  28260069
282700     EVALUATE TRUE                                                28270069
282800         WHEN SQLCODE = +0                                        28280069
282900             CONTINUE                                             28290069
283000         WHEN SQLWARN0 NOT = SPACES                               28300069
283100         WHEN SQLCODE < ZERO                                      28310069
283200         WHEN SQLCODE > ZERO                                      28320069
283300             MOVE '4625-ODD-CART-USE - 2'                         28330069
283400                               TO DP013-PARAGRAPH                 28340069
283500             MOVE 'CHECK IF ODD CARTON USE IS INPK'               28350069
283600                               TO DP013-MESSAGE-TEXT (1)          28360069
283700             MOVE SQLCA        TO DP013-SQLCA                     28370069
283800             MOVE 'TDISTDT'    TO DP013-DB2-TABLE-NAME (1)        28380069
283900             SET DP013-DB2-ABEND                                  28390069
284000                 DP013-XCTL-DISPLAY-RESTART                       28400069
284100                               TO TRUE                            28410069
284200             PERFORM DP013-0000-PROCESS-ABEND                     28420069
284300     END-EVALUATE.                                                28430069
284400                                                                  28440069
284500                                                                  28450069
284600*----------------------------------------------------------------*28460069
284700*                                                                *28470069
284800*----------------------------------------------------------------*28480069
284900 4630-BY-OLD-OR-UPLOADED.                                         28490069
285000     IF  DISTHD-SYS-CRE-CDE  =  'P'                               28500069
285100         MOVE 'CR BY OLD'               TO  PV-LINE-STATUS        28510069
285200         SET  PS-LINE-STATUS-KNOWN      TO  TRUE                  28520069
285300     END-IF.                                                      28530069
285400                                                                  28540069
285500 4640-CHECK-TROUBLE.                                              28550069
285600     EXEC SQL                                                     28560069
285700           SELECT   B.TRBL_SHT_DESC                               28570069
285800             INTO   :TRBRSN-TRBL-SHT-DESC                         28580069
285900             FROM   TTRBNTF A                                     28590069
286000                   ,TTRBRSN B                                     28600069
286100            WHERE   A.PO_NBR         = :PV-PO-NUMBER-HOLD         28610069
286200              AND   A.REC_SEQ_NBR    = :PV-REC-SEQ-HOLD           28620069
286300              AND ((A.PO_LNE_NBR     = :PV-LINE-NBR-HOLD          28630069
286400              AND   B.TRBL_LVL_IND  <> :PC-M)                     28640069
286500               OR  (A.PREPK_ID       = :PV-PREPK-ID-HOLD          28650069
286600              AND   B.TRBL_LVL_IND   = :PC-M))                    28660069
286700              AND   A.RESOLVED_IND  IN (:PC-N, :PC-I)             28670069
286800              AND   A.TRBL_RSN_CDE   = B.TRBL_RSN_CDE             28680069
286900     END-EXEC.                                                    28690069
287000                                                                  28700069
287100     EVALUATE TRUE                                                28710069
287200         WHEN SQLCODE = +0                                        28720069
287300         WHEN SQLCODE = -811                                      28730069
287400             MOVE  TRBRSN-TRBL-SHT-DESC  TO  PV-LINE-STATUS       28740069
287500             SET   PS-LINE-STATUS-KNOWN  TO  TRUE                 28750069
287600         WHEN SQLCODE = +100                                      28760069
287700              CONTINUE                                            28770069
287800         WHEN SQLWARN0 NOT = SPACES                               28780069
287900         WHEN SQLCODE  NOT = ZERO                                 28790069
288000             MOVE '4640-CHECK-TROUBLE'                            28800069
288100                                  TO DP013-PARAGRAPH              28810069
288200              MOVE 'UNSUCCESSFUL SELECT OF TROUBLE'               28820069
288300                                  TO DP013-MESSAGE-TEXT (1)       28830069
288400              MOVE SQLCA         TO DP013-SQLCA                   28840069
288500              MOVE 'TTRBNTF'     TO DP013-DB2-TABLE-NAME (1)      28850069
288600              MOVE 'TTRBRSN'     TO DP013-DB2-TABLE-NAME (2)      28860069
288700              SET DP013-DB2-ABEND                                 28870069
288800                  DP013-XCTL-DISPLAY-RESTART                      28880069
288900                                  TO TRUE                         28890069
289000                                                                  28900069
289100              PERFORM DP013-0000-PROCESS-ABEND                    28910069
289200      END-EVALUATE.                                               28920069
289300                                                                  28930069
289400 4650-CHECK-DC-RTV.                                               28940069
289500     PERFORM 4660-OPEN-DC-RTV-CURSOR.                             28950069
289600                                                                  28960069
289700     PERFORM 4670-FETCH-DC-RTV-CURSOR                             28970069
289800       UNTIL PS-EOF-DC-RTV-CURSOR.                                28980069
289900                                                                  28990069
290000     IF  PV-DC-RTV-ROWS-RETRIEVED  =  +1                          29000069
290100         IF  PV-DC-RTV-TYPE-CODE  =  'DC'                         29010069
290200             MOVE  'DC BND  '            TO  PV-LINE-STATUS       29020069
290300             SET   PS-LINE-STATUS-KNOWN  TO  TRUE                 29030069
290400         ELSE                                                     29040069
290500             MOVE  'RTV BND  '           TO  PV-LINE-STATUS       29050069
290600             SET   PS-LINE-STATUS-KNOWN   TO  TRUE                29060069
290700         END-IF                                                   29070069
290800     ELSE                                                         29080069
290900     IF  PV-DC-RTV-ROWS-RETRIEVED  >  +1                          29090069
291000             MOVE  'DC/RTV    '          TO  PV-LINE-STATUS       29100069
291100             SET   PS-LINE-STATUS-KNOWN  TO  TRUE                 29110069
291200     END-IF.                                                      29120069
291300                                                                  29130069
291400     PERFORM 4680-CLOSE-DC-RTV-CURSOR.                            29140069
291500                                                                  29150069
291600                                                                  29160069
291700 4660-OPEN-DC-RTV-CURSOR.                                         29170069
291800      EXEC SQL                                                    29180069
291900           OPEN DC-RTV-CSR                                        29190069
292000      END-EXEC                                                    29200069
292100                                                                  29210069
292200     EVALUATE TRUE                                                29220069
292300         WHEN SQLCODE = ZERO                                      29230069
292400             CONTINUE                                             29240069
292500         WHEN SQLWARN0 NOT = SPACES                               29250069
292600         WHEN SQLCODE < ZERO                                      29260069
292700         WHEN SQLCODE > ZERO                                      29270069
292800             MOVE '4660-OPEN-DC-RTV-CURSOR'                       29280069
292900                               TO DP013-PARAGRAPH                 29290069
293000             MOVE 'OPEN SYSTEM MESSAGE CURSOR - '                 29300069
293100                               TO DP013-MESSAGE-TEXT (1)          29310069
293200             MOVE 'CURSOR:  DC-RTV-CURSOR           '             29320069
293300                               TO DP013-MESSAGE-TEXT (2)          29330069
293400             MOVE SQLCA        TO DP013-SQLCA                     29340069
293500             MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)        29350069
293600             MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (2)        29360099
293700             SET DP013-DB2-ABEND                                  29370069
293800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29380069
293900             PERFORM DP013-0000-PROCESS-ABEND                     29390069
294000     END-EVALUATE.                                                29400069
294100                                                                  29410069
294200                                                                  29420069
294300 4670-FETCH-DC-RTV-CURSOR.                                        29430069
294400     EXEC SQL                                                     29440069
294500          FETCH DC-RTV-CSR                                        29450069
294600           INTO :PV-DC-RTV-TYPE-CODE                              29460069
294700              , :PV-DC-RTV-COUNT                                  29470069
294800     END-EXEC.                                                    29480069
294900                                                                  29490069
295000     EVALUATE TRUE                                                29500069
295100         WHEN SQLCODE = ZERO                                      29510069
295200              ADD  1  TO  PV-DC-RTV-ROWS-RETRIEVED                29520069
295300         WHEN SQLCODE = +100                                      29530069
295400             SET PS-EOF-DC-RTV-CURSOR  TO TRUE                    29540069
295500         WHEN SQLWARN0 NOT = SPACE                                29550069
295600         WHEN SQLCODE NOT = ZERO                                  29560069
295700              MOVE '4670-FETCH-DC-RTV-CURSOR'                     29570069
295800                               TO DP013-PARAGRAPH                 29580069
295900              MOVE 'FETCH RECITM/PURITM CURSOR'                   29590069
296000                               TO DP013-MESSAGE-TEXT (1)          29600069
296100              MOVE 'CURSOR:  DC-RTV-CURSOR       '                29610069
296200                               TO DP013-MESSAGE-TEXT (2)          29620069
296300              MOVE SQLCA       TO DP013-SQLCA                     29630069
296400              SET DP013-DB2-ABEND                                 29640069
296500                               TO TRUE                            29650069
296600              PERFORM DP013-0000-PROCESS-ABEND                    29660069
296700     END-EVALUATE.                                                29670069
296800                                                                  29680069
296900                                                                  29690069
297000 4680-CLOSE-DC-RTV-CURSOR.                                        29700069
297100     EXEC SQL                                                     29710069
297200          CLOSE DC-RTV-CSR                                        29720069
297300     END-EXEC                                                     29730069
297400                                                                  29740069
297500     EVALUATE TRUE                                                29750069
297600         WHEN SQLCODE = ZERO                                      29760069
297700             CONTINUE                                             29770069
297800         WHEN SQLWARN0 NOT = SPACES                               29780069
297900         WHEN SQLCODE < ZERO                                      29790069
298000         WHEN SQLCODE > ZERO                                      29800069
298100             MOVE '4680-CLOSE-DC-RTV-CURSOR'                      29810069
298200                               TO DP013-PARAGRAPH                 29820069
298300             MOVE 'CLOSE SYSTEM MESSAGE CURSOR '                  29830069
298400                               TO DP013-MESSAGE-TEXT (1)          29840069
298500             MOVE 'CURSOR:  TDC-RTV-CURSOR'                       29850069
298600                               TO DP013-MESSAGE-TEXT (2)          29860069
298700             MOVE SQLCA        TO DP013-SQLCA                     29870069
298800             MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)        29880069
298900             MOVE 'TSRT000 '   TO DP013-DB2-TABLE-NAME (2)        29890069
299000             SET DP013-DB2-ABEND                                  29900069
299100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29910069
299200             PERFORM DP013-0000-PROCESS-ABEND                     29920069
299300     END-EVALUATE.                                                29930069
299400                                                                  29940069
299500                                                                  29950069
299510* JAK 04/2007 - START                                             29951099
299520 5010-GET-CURR-TMST.                                              29952099
299530                                                                  29953099
299540         EXEC SQL                                                 29954099
299550             SET :DK-CURRENT-TIMESTAMP = CURRENT TIMESTAMP        29955099
299560         END-EXEC.                                                29956099
299570                                                                  29957099
299580                                                                  29958099
299590 5020-CHECK-DC-WMOS.                                              29959099
299591                                                                  29959199
299592     EXEC SQL                                                     29959299
299593          SELECT   A.INTGRTN_TYP_DESC                             29959399
299594            INTO  :WST00008-INTGRTN-TYP-DESC                      29959499
299595            FROM                                                  29959599
299596                  WST_INTGRTN_TYP  A                              29959699
299597               ,  WST_ATTR_DEFN    B                              29959799
299598               ,  WST_ATTR_ELEM    C                              29959899
299599               ,  WST_ATTR_ELEM    D                              29959999
299600               ,  WST_ATTR_ELEM    E                              29960099
299601            WHERE                                                 29960199
299602                  A.INTGRTN_TYP_CDE   = 'WMOSON'                  29960299
299603              AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         29960399
299604              AND B.ATTR_DEFN_SEQ_NBR = 1                         29960499
299605              AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         29960599
299606              AND C.ATTR_DEFN_SEQ_NBR = 1                         29960699
299607              AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         29960799
299608              AND D.ATTR_DEFN_SEQ_NBR = 2                         29960899
299609              AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         29960999
299610              AND E.ATTR_DEFN_SEQ_NBR = 3                         29961099
299611              AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       29961199
299612              AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       29961299
299613              AND C.ATTR_ELEM_NBR     = :DK-OPER-UNT-ID           29961399
299614              AND E.ATTR_ELEM_TMST   <= :DK-CURRENT-TIMESTAMP     29961499
299615     END-EXEC.                                                    29961599
299616                                                                  29961699
299617     EVALUATE TRUE                                                29961799
299618         WHEN SQLCODE = ZERO                                      29961899
299619             SET PS-DC-ON-WMOS-YES      TO TRUE                   29961999
299620         WHEN OTHER                                               29962099
299621             SET PS-DC-ON-WMOS-NO       TO TRUE                   29962199
299622     END-EVALUATE.                                                29962299
299623* JAK 04/2007 - END                                               29962399
299624                                                                  29962499
299625                                                                  29962599
299630 4690-EVALUATE-STAT-CODE.                                         29963069
299700     IF  DISTHD-PRCG-STAT-CDE  =  'E'                             29970069
299800         MOVE  'ERROR'                   TO  PV-LINE-STATUS       29980069
299900         SET   PS-LINE-STATUS-KNOWN      TO  TRUE                 29990069
300000     ELSE                                                         30000069
300100     IF  DISTHD-PRCG-STAT-CDE  =  'R'                             30010069
300200         MOVE  'READY'                   TO  PV-LINE-STATUS       30020069
300300         SET   PS-LINE-STATUS-KNOWN      TO  TRUE                 30030069
300400     ELSE                                                         30040069
300500     IF  DISTHD-PRCG-STAT-CDE  =  'P'                             30050069
300600         MOVE  'PRVRFYD  '               TO  PV-LINE-STATUS       30060069
300700         SET   PS-LINE-STATUS-KNOWN      TO  TRUE                 30070069
300800     ELSE                                                         30080069
300900     IF  DISTHD-PRCG-STAT-CDE  =  'F'                             30090069
301000         MOVE  'NO PRO'                  TO  PV-LINE-STATUS       30100069
301100         SET   PS-LINE-STATUS-KNOWN      TO  TRUE                 30110069
301200     ELSE                                                         30120069
301300     IF  DISTHD-PRCG-STAT-CDE  =  'V'                             30130069
301400         MOVE  'VERFYD  '                TO  PV-LINE-STATUS       30140069
301500         SET   PS-LINE-STATUS-KNOWN      TO  TRUE                 30150069
301600     ELSE                                                         30160069
301700     IF  DISTHD-PRCG-STAT-CDE  =  'D'                             30170069
301800         IF  DISTHD-TOT-CART-CNT      =  ZEROES AND               30180069
301900             DISTHD-PRC-AREA-MODU-ID  = SPACES                    30190069
302000             MOVE  SPACES                TO  PV-LINE-STATUS       30200069
302100         ELSE                                                     30210069
302200             MOVE  'DOWNLD  '            TO  PV-LINE-STATUS       30220069
302300             SET   PS-LINE-STATUS-KNOWN  TO  TRUE                 30230069
302400         END-IF                                                   30240069
302500     ELSE                                                         30250069
302600     IF  DISTHD-PRCG-STAT-CDE  =  'I'                             30260069
302700         MOVE  'SUSPEND'                 TO  PV-LINE-STATUS       30270069
302800         SET   PS-LINE-STATUS-KNOWN      TO  TRUE                 30280069
302900     ELSE                                                         30290069
303000     IF  DISTHD-PRCG-STAT-CDE  =  'C'                             30300069
303100         MOVE  'CANCELD '                TO  PV-LINE-STATUS       30310069
303200         SET   PS-LINE-STATUS-KNOWN      TO  TRUE                 30320069
303300     ELSE                                                         30330069
303400     IF  DISTHD-PRCG-STAT-CDE  =  'S'                             30340069
303500         MOVE  'STARTED'                 TO  PV-LINE-STATUS       30350069
303600         SET   PS-LINE-STATUS-KNOWN      TO  TRUE                 30360069
303700     END-IF.                                                      30370069
303800* BAD RATIO                                                       30380069
303900     IF  DISTHD-PRCG-STAT-CDE  =  'A'                             30390069
304000         MOVE  'BAD RAT'                 TO  PV-LINE-STATUS       30400069
304100         SET   PS-LINE-STATUS-KNOWN      TO  TRUE                 30410069
304200     END-IF.                                                      30420069
304300* NOT ARRIVED                                                     30430069
304400     IF  DISTHD-PRCG-STAT-CDE  =  'G'                             30440069
304500         MOVE  'NOT ARR'                 TO  PV-LINE-STATUS       30450069
304600         SET   PS-LINE-STATUS-KNOWN      TO  TRUE                 30460069
304700     END-IF.                                                      30470069
304800                                                                  30480069
304900******************************************************************30490069
305000* DELETE THE LIST QUEUE WHEN PREV-SEL OR NEXT-SEL WAS ENTERED.   *30500069
305100******************************************************************30510069
305200 6200-DEL-LIST-QUEUE.                                             30520069
305300                                                                  30530069
305400     EXEC CICS                                                    30540069
305500         DELETEQ TS                                               30550069
305600             QUEUE (ASC-LIST-QUEUE-NAME)                          30560069
305700             RESP  (PV-CICS-RESP)                                 30570069
305800     END-EXEC.                                                    30580069
305900                                                                  30590069
306000     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      30600069
306100        (PV-CICS-RESP = DFHRESP(QIDERR)))                         30610069
306200         CONTINUE                                                 30620069
306300     ELSE                                                         30630069
306400        SET DP013-CICS-ABEND       TO TRUE                        30640069
306500        SET DP013-NO-ROLLBACK      TO TRUE                        30650069
306600        MOVE '6200-DEL-LIST-QUEUE' TO DP013-PARAGRAPH             30660069
306700        MOVE 'ERROR TRYING TO DELETE LIST TS QUEUE'               30670069
306800                                   TO DP013-MESSAGE-TEXT (1)      30680069
306900        PERFORM DP013-0000-PROCESS-ABEND                          30690069
307000     END-IF.                                                      30700069
307100                                                                  30710069
307200*----------------------------------------------------------------*30720069
307300*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *30730069
307400*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *30740069
307500*  IT HERE.                                                      *30750069
307600*----------------------------------------------------------------*30760069
307700 7000-BUILD-INITIAL-PANEL.                                        30770069
307800     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        30780069
307900     MOVE -1                       TO MPONBRL.                    30790069
308000                                                                  30800069
308100*11/27                                                            30810069
308200*    MOVE PC-BOTH                  TO MLBLOPTO.                   30820069
308300*    MOVE PC-SHUFFLED              TO MPRTORDO.                   30830069
308400     MOVE PC-Y                     TO MHDRFTO.                    30840069
308500*11/27                                                            30850069
308600                                                                  30860069
308700     EXEC CICS ASSIGN                                             30870069
308800               APPLID(PV-SYSTEM-ID)                               30880069
308900     END-EXEC.                                                    30890069
309000                                                                  30900069
309100                                                                  30910069
309200     IF ASC-USE-SELECTION-QUEUE                                   30920069
309300         MOVE ASC-OPER-UNT-ID    TO PV-OPER-UNT-HOLD              30930069
309301         MOVE ASC-FCLTY-ID       TO PV-FCLTY-ID-HOLD              30930169
309302         MOVE PV-OPER-FCLTY-HOLD TO MOPIDO                        30930269
309303     ELSE                                                         30930369
309304         MOVE PC-FCLTY-ID-0001   TO ASC-FCLTY-ID                  30930469
309305                                    DK-FCLTY-ID                   30930569
309306         IF PV-PROD-CICS                                          30930669
309307           OR PV-LEARN-CICS                                       30930769
309308             MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID            30930899
309309                                        ASC-OPER-UNT-ID-N         30930999
309310         ELSE                                                     30931069
309320             MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID            30932099
309330                                        ASC-OPER-UNT-ID-N         30933099
309340         END-IF                                                   30934069
309350         MOVE ASC-OPER-UNT-ID    TO PV-OPER-UNT-HOLD              30935069
309360         MOVE ASC-FCLTY-ID       TO PV-FCLTY-ID-HOLD              30936069
309370         MOVE PV-OPER-FCLTY-HOLD TO MOPIDO                        30937069
309380     END-IF.                                                      30938069
309390                                                                  30939069
309400     PERFORM 7010-GET-FCLTY-NAME.                                 30940069
309500                                                                  30950069
309600     MOVE PV-FCLTY-NME             TO MOPDESCO.                   30960069
309700                                                                  30970069
309800*11/27 - BEGIN                                                    30980069
309900                                                                  30990069
310000     PERFORM 7020-GET-DC-DEFAULTS.                                31000069
310100                                                                  31010069
310200     MOVE  COCNTL-DFLT-CRE-LBL-CDE   TO  MLBLOPTO                 31020069
310300                                         ASC-CRE-LBL-IND.         31030069
310400     MOVE  COCNTL-DFLT-PRT-ORD-CDE   TO  MPRTORDO                 31040069
310500                                         ASC-LBL-PRT-ORDER.       31050069
310600     MOVE  COCNTL-DFLT-FCSE-AREA-ID  TO  MCSEPKO.                 31060069
310700                                                                  31070069
310800     PERFORM 7025-CHECK-DC-P2L-MODULES.                           31080069
310900     IF  PV-DC-P2L-MODULE-COUNT  >  0                             31090069
311000         CONTINUE                                                 31100069
311100     ELSE                                                         31110069
311200         MOVE  PC-CASE-PROCESS-ONLY  TO  MLBLOPTO                 31120069
311300                                         ASC-CRE-LBL-IND          31130069
311400     END-IF.                                                      31140069
311500                                                                  31150069
311600                                                                  31160069
311700*11/27 - END                                                      31170069
311800                                                                  31180069
311900     MOVE ZEROES                   TO PV-CURR-OPER-UNT-HOLD       31190069
312000                                      PV-CURR-FCLTY-ID-HOLD.      31200069
312100     MOVE PV-CURR-OPER-FCLTY-HOLD  TO MCOPIDO.                    31210069
312200     MOVE SPACES                   TO MCOPDSCO.                   31220069
312300                                                                  31230069
312400     MOVE SPACES                   TO MZONEO                      31240069
312500                                      MMOD1O                      31250069
312600                                      MMOD2O                      31260069
312700                                      MMOD3O                      31270069
312800                                      MMOD4O                      31280069
312900                                      MMOD5O                      31290069
313000                                      MUCC128O.                   31300069
313100                                                                  31310069
313200                                                                  31320069
313300*----------------------------------------------------------------*31330069
313400*       GET THE FACILITY NAME                                    *31340069
313500*----------------------------------------------------------------*31350069
313600 7010-GET-FCLTY-NAME.                                             31360069
313700                                                                  31370069
313800     PERFORM                                                      31380069
313900         WITH TEST AFTER                                          31390069
314000         VARYING PV-RETRY-COUNT                                   31400069
314100         FROM 1 BY 1                                              31410069
314200         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 31420069
314300             OR (SQLCODE = +0)                                    31430069
314400             OR (SQLCODE = +100))                                 31440069
314500                                                                  31450069
314600     EXEC SQL                                                     31460069
314700         SELECT LOC_NM                                            31470099
314800           INTO :XLT00010-LOC-NM                                  31480099
314900           FROM XLT_LOC                                           31490099
315000           WHERE LOC_NBR     = :DK-OPER-UNT-ID                    31500099
315200     END-EXEC                                                     31520069
315300                                                                  31530069
315400         EVALUATE TRUE                                            31540069
315500             WHEN SQLCODE = +0                                    31550069
315600                  MOVE XLT00010-LOC-NM                            31560099
315700                                  TO PV-FCLTY-NME                 31570069
315800                                                                  31580069
315900             WHEN SQLCODE = +100                                  31590069
316000                  MOVE SPACES     TO PV-FCLTY-NME                 31600069
316100                                                                  31610069
316200             WHEN SQLCODE = -904                                  31620069
316300             WHEN SQLCODE = -913                                  31630069
316400                  CONTINUE                                        31640069
316500             WHEN SQLWARN0 NOT = +0                               31650069
316600             WHEN SQLCODE < +0                                    31660069
316700             WHEN SQLCODE > +0                                    31670069
316800                  MOVE '7010-GET-FCLTY-NAME'                      31680069
316900                                  TO DP013-PARAGRAPH              31690069
317000                  MOVE 'UNSUCCESSFUL SELECT ON FACILITY TABLE'    31700069
317100                                  TO DP013-MESSAGE-TEXT (1)       31710069
317200                  MOVE SQLCA      TO DP013-SQLCA                  31720069
317300                  MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME (1)     31730099
317400                  SET DP013-DB2-ABEND                             31740069
317500                      DP013-XCTL-DISPLAY-RESTART                  31750069
317600                                  TO TRUE                         31760069
317700              PERFORM DP013-0000-PROCESS-ABEND                    31770069
317800         END-EVALUATE                                             31780069
317900     END-PERFORM.                                                 31790069
318000                                                                  31800069
318100     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          31810069
318200         MOVE '7010-GET-FCLTY-NAME'                               31820069
318300                                  TO DP013-PARAGRAPH              31830069
318400         MOVE 'MAX RETRIES EXCEEDED ON SELECT FACILITY TABLE'     31840069
318500                                  TO DP013-MESSAGE-TEXT (1)       31850069
318600         MOVE SQLCA               TO DP013-SQLCA                  31860069
318700         MOVE 'XLT_LOC'           TO DP013-DB2-TABLE-NAME (1)     31870099
318800         SET DP013-DB2-ABEND                                      31880069
318900             DP013-XCTL-DISPLAY-RESTART                           31890069
319000                                  TO TRUE                         31900069
319100         PERFORM DP013-0000-PROCESS-ABEND                         31910069
319200     END-IF.                                                      31920069
319300                                                                  31930069
319400                                                                  31940069
319500*11/27  BEGIN                                                     31950069
319600*----------------------------------------------------------------*31960069
319700* GET DC DEFAULTS FROM TCOCNTL                                   *31970069
319800*----------------------------------------------------------------*31980069
319900 7020-GET-DC-DEFAULTS.                                            31990069
320000                                                                  32000069
320100     INITIALIZE DCLTCOCNTL.                                       32010069
320200                                                                  32020069
320300     EXEC SQL                                                     32030069
320400         SELECT  DFLT_CRE_LBL_CDE                                 32040069
320500                ,DFLT_PRT_ORD_CDE                                 32050069
320600                ,DFLT_FCSE_AREA_ID                                32060069
320700           INTO  :COCNTL-DFLT-CRE-LBL-CDE                         32070069
320800                ,:COCNTL-DFLT-PRT-ORD-CDE                         32080069
320900                ,:COCNTL-DFLT-FCSE-AREA-ID                        32090069
321000           FROM  TCOCNTL                                          32100069
321100          WHERE  OPER_UNT_ID = :DK-OPER-UNT-ID                    32110069
321200            AND  FCLTY_ID    = :DK-FCLTY-ID                       32120069
321300     END-EXEC.                                                    32130069
321400                                                                  32140069
321500     EVALUATE TRUE                                                32150069
321600         WHEN SQLCODE = +0                                        32160069
321700         WHEN SQLCODE = -904                                      32170069
321800         WHEN SQLCODE = -913                                      32180069
321900              CONTINUE                                            32190069
322000         WHEN SQLWARN0 NOT = +0                                   32200069
322100         WHEN SQLCODE < +0                                        32210069
322200         WHEN SQLCODE > +0                                        32220069
322300              MOVE '7020-GET-DC-DEFAULTS'                         32230069
322400                              TO DP013-PARAGRAPH                  32240069
322500              MOVE 'UNSUCCESSFUL SELECT ON CONTROL TABLE'         32250069
322600                              TO DP013-MESSAGE-TEXT (1)           32260069
322700              MOVE SQLCA      TO DP013-SQLCA                      32270069
322800              MOVE 'TCOCNTL ' TO DP013-DB2-TABLE-NAME (1)         32280069
322900              SET DP013-DB2-ABEND                                 32290069
323000                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            32300069
323100          PERFORM DP013-0000-PROCESS-ABEND                        32310069
323200     END-EVALUATE.                                                32320069
323300                                                                  32330069
323400*11/27  END                                                       32340069
323500                                                                  32350069
323600                                                                  32360069
323700*----------------------------------------------------------------*32370069
323800* CHECK TO SEE IF DC HAS VALID P2L MODULES                       *32380069
323900*----------------------------------------------------------------*32390069
324000 7025-CHECK-DC-P2L-MODULES.                                       32400069
324100                                                                  32410069
324200     MOVE ASC-OPER-UNT-ID  TO  DK-OPER-UNT-ID-3.                  32420069
324300                                                                  32430069
324301     EXEC SQL                                                     32430169
324302         SELECT  COUNT(*)                                         32430269
324303           INTO  :PV-DC-P2L-MODULE-COUNT                          32430369
324304           FROM  TP2LMOD                                          32430469
324305          WHERE  OPER_UNT_ID = :DK-OPER-UNT-ID-3                  32430569
324306            AND  FCLTY_ID    = :DK-FCLTY-ID                       32430669
324307     END-EXEC.                                                    32430769
324308                                                                  32430869
324309     EVALUATE TRUE                                                32430969
324310         WHEN SQLCODE = +0                                        32431069
324320              CONTINUE                                            32432069
324321         WHEN SQLWARN0 NOT = +0                                   32432169
324322         WHEN SQLCODE < +0                                        32432269
324323         WHEN SQLCODE > +0                                        32432369
324324              MOVE '7025-CHECK-DC-P2L-MODULES'                    32432469
324325                              TO DP013-PARAGRAPH                  32432569
324326              MOVE 'UNSUCCESSFUL COUNT FOR DC P2L MODULES'        32432669
324327                              TO DP013-MESSAGE-TEXT (1)           32432769
324328              MOVE SQLCA      TO DP013-SQLCA                      32432869
324329              MOVE 'TP2LMOD ' TO DP013-DB2-TABLE-NAME (1)         32432969
324330              SET DP013-DB2-ABEND                                 32433069
324331                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            32433169
324332          PERFORM DP013-0000-PROCESS-ABEND                        32433269
324333     END-EVALUATE.                                                32433369
324334                                                                  32433469
324335                                                                  32433569
324336*----------------------------------------------------------------*32433669
324337* CHECK TO SEE IF PREPACK ORDER ALREADY HAS LINES IN TDISTHD     *32433769
324338* TABLE THAT WERE PROCESSED PRIOR TO PREPACK CHANGE INSTALL      *32433869
324339* (TDISTHD-PREPK-LNE-PRC-CDE  = SPACE)                           *32433969
324340*----------------------------------------------------------------*32434069
324350 7040-PREPK-PROCESSED-OLD.                                        32435069
324360     MOVE  MPONBRI     TO  DK-PO.                                 32436069
324370     MOVE  MRECVRI     TO  DK-REC-SEQ-NBR.                        32437069
324380     MOVE  ZEROES      TO  PV-PREPK-BLANK-COUNT.                  32438069
324390                                                                  32439069
324400     EXEC SQL                                                     32440069
324401         SELECT COUNT (*)                                         32440169
324402           INTO :PV-PREPK-BLANK-COUNT                             32440269
324403           FROM TDISTHD A                                         32440369
324404          WHERE A.ORD_NBR            = :DK-PO                     32440469
324405            AND A.RCVR_SEQ_NBR       = :DK-REC-SEQ-NBR            32440569
324406            AND A.PREPK_LNE_PRC_CDE  = ' '                        32440669
324407            AND A.DLT_REQ_TMST       = :PC-DEFAULT-TMST           32440769
324408     END-EXEC.                                                    32440869
324409                                                                  32440969
324410     EVALUATE TRUE                                                32441069
324411         WHEN SQLCODE = ZERO                                      32441169
324412              IF  PV-PREPK-BLANK-COUNT  >  0                      32441269
324413                  MOVE  SPACES  TO  ASC-PKGNG-CD                  32441369
324414              END-IF                                              32441469
324415         WHEN SQLWARN0 NOT = SPACES                               32441569
324416         WHEN SQLCODE < ZERO                                      32441669
324417         WHEN SQLCODE > ZERO                                      32441769
324418              MOVE '7040-PREPK-PROCESSED-OLD'                     32441869
324419                              TO DP013-PARAGRAPH                  32441969
324420              MOVE 'COUNT DISTHD LINES'                           32442069
324421                              TO DP013-MESSAGE-TEXT (1)           32442169
324422              MOVE SQLCA      TO DP013-SQLCA                      32442269
324423              MOVE 'TDISTHD ' TO DP013-DB2-TABLE-NAME (1)         32442369
324424              SET DP013-DB2-ABEND                                 32442469
324425                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            32442569
324426          PERFORM DP013-0000-PROCESS-ABEND                        32442669
324427     END-EVALUATE.                                                32442769
324428                                                                  32442869
324429                                                                  32442969
324430*----------------------------------------------------------------*32443069
324440* CHECK TO SEE IF THERE IS UCC128 DATA FOR THE PO/RCVR ENTERED   *32444069
324441*----------------------------------------------------------------*32444169
324442 7050-CHECK-UCC128-DATA.                                          32444269
324443     SET  PS-NO-UCC128-DATA-EXISTS  TO  TRUE.                     32444369
324444     MOVE  MPONBRI     TO  DK-PO.                                 32444469
324445     MOVE  MRECVRI     TO  DK-REC-SEQ-NBR.                        32444569
324446                                                                  32444669
324447     EXEC SQL                                                     32444769
324448          SELECT  COUNT(*)                                        32444869
324449            INTO  :PV-UCC128-COUNT                                32444969
324450            FROM  TPKSLIP A                                       32445069
324451                 ,TINPKSU B                                       32445169
324452                 ,TSHUUPC C                                       32445269
324453           WHERE  A.PO_NBR         = :DK-PO                       32445369
324454             AND  A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR              32445469
324455             AND  A.VER_STAT_CDE   = 'A'                          32445569
324456             AND  A.PKSL_STAT_CDE  = 'AC'                         32445669
324457             AND  B.PO_NBR         = A.PO_NBR                     32445769
324458             AND  B.SEQ_NBR        = A.SEQ_NBR                    32445869
324459             AND  C.SHIPT_UNT_ID   = B.SHIPT_UNT_ID               32445969
324460             AND  C.TRN_NBR        = B.PO_NBR                     32446069
324461             AND  C.TRN_LNE_NBR    > 0                            32446169
324462             AND  C.SHPD_QTY       > 0                            32446299
324463     END-EXEC.                                                    32446399
324464                                                                  32446499
324465     EVALUATE TRUE                                                32446599
324466         WHEN SQLCODE = ZERO                                      32446699
324467              IF  PV-UCC128-COUNT  >  0                           32446799
324468                  SET  PS-UCC128-DATA-EXISTS                      32446899
324469                       ASC-UCC128-DATA-EXISTS  TO  TRUE           32446999
324470              END-IF                                              32447099
324471         WHEN SQLWARN0 NOT = SPACES                               32447199
324480         WHEN SQLCODE < ZERO                                      32448069
324481         WHEN SQLCODE > ZERO                                      32448169
324482              MOVE '7050-CHECK-UCC128-DATA  '                     32448269
324483                              TO DP013-PARAGRAPH                  32448369
324484              MOVE 'CHECK TO SEE IF THERE IS UCC128 DATA'         32448469
324485                              TO DP013-MESSAGE-TEXT (1)           32448569
324486              MOVE SQLCA      TO DP013-SQLCA                      32448669
324487              MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)         32448769
324488              MOVE 'TINPKSU ' TO DP013-DB2-TABLE-NAME (1)         32448869
324489              MOVE 'TSHUUPC ' TO DP013-DB2-TABLE-NAME (1)         32448969
324490              SET DP013-DB2-ABEND                                 32449069
324491                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            32449169
324492          PERFORM DP013-0000-PROCESS-ABEND                        32449269
324493     END-EVALUATE.                                                32449369
324494                                                                  32449469
324495                                                                  32449569
324496*----------------------------------------------------------------*32449669
324497*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *32449769
324498*----------------------------------------------------------------*32449869
324499 8000-MOVE-COMMAREA-TO-SCREEN.                                    32449969
324500                                                                  32450069
324600     MOVE ASC-PO-NBR-N             TO MPONBRO.                    32460069
324700     MOVE ASC-REC-SEQ-NBR-N        TO MRECVRO.                    32470069
324800     MOVE ASC-OPER-UNT-ID-N        TO PV-OPER-UNT-HOLD            32480069
324900     MOVE ASC-FCLTY-ID-N           TO PV-FCLTY-ID-HOLD            32490069
325000     MOVE PV-OPER-FCLTY-HOLD       TO MOPIDO.                     32500069
325100     MOVE ASC-CURR-OPER-UNT-ID-N   TO PV-CURR-OPER-UNT-HOLD.      32510069
325200     MOVE ASC-CURR-FCLTY-ID-N      TO PV-CURR-FCLTY-ID-HOLD.      32520069
325300     MOVE PV-CURR-OPER-FCLTY-HOLD  TO MCOPIDO.                    32530069
325400                                                                  32540069
325500                                                                  32550069
325600     MOVE ASC-SML-P2L-PRTR-ID      TO MDEST1O                     32560069
325700     MOVE ASC-PGYBCK-PRTR-ID       TO MDEST2O.                    32570069
325800     MOVE ASC-MODU-NBR-N           TO MP2LMODO.                   32580069
325900     MOVE ASC-DFLT-STR-ZN-ID       TO MZONEO.                     32590069
326000     MOVE ASC-CART-CNT-N           TO MCTNCNTO.                   32600069
326100     MOVE ASC-INPK-UNT-QTY-N       TO MINPACKO.                   32610069
326200     MOVE ASC-OTPK-UNT-QTY-N       TO MOUTPCKO.                   32620069
326300     MOVE ASC-CRE-LBL-IND          TO MLBLOPTO.                   32630069
326400     MOVE ASC-LBL-PRT-ORDER        TO MPRTORDO.                   32640069
326500     MOVE ASC-FCSE-AREA-ID         TO MCSEPKO.                    32650069
326600     MOVE ASC-PRT-HEAD-FOOT        TO MHDRFTO.                    32660069
326700     MOVE ASC-SPEC-INST-DESC       TO MINSTRO.                    32670069
326800     MOVE ASC-PO-LINE-NBR-N        TO MLINEO.                     32680069
326900                                                                  32690069
327000     MOVE ASC-OPER-UNT-ID-N        TO DK-OPER-UNT-ID.             32700069
327100     MOVE ASC-FCLTY-ID-N           TO DK-FCLTY-ID.                32710069
327200     PERFORM 7010-GET-FCLTY-NAME.                                 32720069
327300     MOVE PV-FCLTY-NME             TO MOPDESCO.                   32730069
327400                                                                  32740069
327500     MOVE ASC-CURR-OPER-UNT-ID-N   TO DK-OPER-UNT-ID.             32750069
327600     MOVE ASC-CURR-FCLTY-ID-N      TO DK-FCLTY-ID.                32760069
327700     PERFORM 7010-GET-FCLTY-NAME.                                 32770069
327800     MOVE PV-FCLTY-NME             TO MCOPDSCO.                   32780069
327900                                                                  32790069
328000     IF  ASC-DSP-PRE-PACK-ORDER                                   32800069
328100         MOVE DP015-YELLOW         TO MPKGCDC                     32810069
328200     END-IF.                                                      32820069
328300                                                                  32830069
328310     MOVE  SPACES               TO MPKGCDO                        32831069
328311     IF  ASC-DSP-INNER-PREPK                                      32831169
328312         MOVE  PC-INNER-PREPACK TO MPKGCDO                        32831269
328313     ELSE                                                         32831369
328314     IF  ASC-DSP-MULTI-SKU-PREPK                                  32831469
328315         MOVE  PC-MULTI-SKU     TO MPKGCDO                        32831569
328316     ELSE                                                         32831669
328317     IF  ASC-DSP-SINGLE-SKU-PREPK                                 32831769
328318         MOVE  PC-SINGLE-SKU    TO MPKGCDO                        32831869
328319     ELSE                                                         32831969
328320     IF  ASC-DSP-CASEPACK                                         32832069
328330         MOVE  PC-CASEPACK      TO MPKGCDO                        32833069
328340     ELSE                                                         32834069
328350     IF  ASC-DSP-BULK-PACK                                        32835069
328360         MOVE  PC-BULK          TO MPKGCDO                        32836069
328370     END-IF                                                       32837069
328380     END-IF                                                       32838069
328390     END-IF                                                       32839069
328391     END-IF                                                       32839169
328392     END-IF.                                                      32839269
328393                                                                  32839381
328396     IF  DP020-NEXT-ACT-RETURN                                    32839669
328398         MOVE ZEROES                   TO MMOD1O                  32839869
328399                                          MMOD2O                  32839969
328400                                          MMOD3O                  32840069
328401                                          MMOD4O                  32840169
328402                                          MMOD5O                  32840269
328410     ELSE                                                         32841069
328500         PERFORM 3400-GET-P2L-MODULES                             32850069
328501         MOVE ASC-SEASET-SHRT-NME      TO MSETNMO                 32850199
328510         IF PS-SEASET-ITEM                                        32851096
328512            MOVE DP015-YELLOW          TO MSETNMC                 32851299
328514                                                                  32851496
328520            MOVE ZEROS                 TO MMOD1O                  32852096
328530                                          MMOD2O                  32853096
328540                                          MMOD3O                  32854096
328541                                          MMOD4O                  32854196
328542                                          MMOD5O                  32854296
328550         ELSE                                                     32855072
328600            MOVE PMT-MODULE(1)         TO MMOD1O                  32860072
328700            MOVE PMT-MODULE(2)         TO MMOD2O                  32870072
328800            MOVE PMT-MODULE(3)         TO MMOD3O                  32880072
328900            MOVE PMT-MODULE(4)         TO MMOD4O                  32890072
329000            MOVE PMT-MODULE(5)         TO MMOD5O                  32900072
329010         END-IF                                                   32901072
329100     END-IF.                                                      32910069
329200                                                                  32920069
329300     MOVE ASC-LINE-STATUS          TO MLINESTO.                   32930069
329400                                                                  32940069
329500******************************************************************32950069
329600* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *32960069
329700******************************************************************32970069
329800 9100-READ-SEL-QUEUE.                                             32980069
329900                                                                  32990069
330000     EXEC CICS                                                    33000069
330100         READQ TS                                                 33010069
330200             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        33020069
330300             INTO  (RC013-DC-SELECT-RECORD)                       33030069
330400             ITEM  (ASC-SEL-ITEM)                                 33040069
330500             RESP  (PV-CICS-RESP)                                 33050069
330600     END-EXEC.                                                    33060069
330700                                                                  33070069
330800     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        33080069
330900         CONTINUE                                                 33090069
331000     ELSE                                                         33100069
331100         SET DP013-LOGIC-ABEND                                    33110069
331200             DP013-NO-ROLLBACK   TO TRUE                          33120069
331300         MOVE '9100-READ-SEL-QUEUE'                               33130069
331400                                 TO DP013-PARAGRAPH               33140069
331500         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    33150069
331600                                 TO DP013-MESSAGE-TEXT (1)        33160069
331700         PERFORM DP013-0000-PROCESS-ABEND                         33170069
331800     END-IF.                                                      33180069
331900                                                                  33190069
332000******************************************************************33200069
332100* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *33210069
332200******************************************************************33220069
332300 9200-REWRITE-LIST-QUEUE.                                         33230069
332400     EXEC CICS                                                    33240069
332500          WRITEQ TS                                               33250069
332600              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     33260069
332700              FROM    (RC013-DC-SELECT-RECORD)                    33270069
332800              ITEM    (ASC-SEL-ITEM)                              33280069
332900              RESP    (PV-CICS-RESP)                              33290069
333000              REWRITE                                             33300069
333100     END-EXEC.                                                    33310069
333200                                                                  33320069
333300     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    33330069
333400         SET DP013-CICS-ABEND                                     33340069
333500             DP013-NO-ROLLBACK   TO TRUE                          33350069
333600         MOVE '9200-REWRITE-LIST-QUEUE'                           33360069
333700                                 TO DP013-PARAGRAPH               33370069
333800         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   33380069
333900                                 TO DP013-MESSAGE-TEXT (1)        33390069
334000         PERFORM DP013-0000-PROCESS-ABEND                         33400069
334100     END-IF.                                                      33410069
334200                                                                  33420069
334300                                                                  33430069
334400*----------------------------------------------------------------*33440069
334500*    ABEND PROCESSOR MODULE                                      *33450069
334600*----------------------------------------------------------------*33460069
334700                                                                  33470069
334800     COPY DPPD013.                                                33480069
