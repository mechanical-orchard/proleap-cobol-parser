000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             CMKUT006.                                00050002
000600 AUTHOR.                 RICK TULLOCH.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            01-15-2015.                              00080002
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*       THIS PROGRAM PERFORMS BASIC INTEGRITY CHECKS ON THE USE  *00120018
001300*  OF ASSIGNMENT GROUPS WITHIN THE JOB DOCUMENTATION AND         *00130018
001400*  INCIDENT ASSIGNMENT INFRASTRUCTURE.  PROCESS ALL UNLOADED     *00140018
001530*  JOB DOCUMENTATION LINES TO VERIFY THAT THE ULTIMATE           *00153018
001531*  ASSIGNMENT GROUP TO BE USED IS VALID, AND THAT ANY NECESSARY  *00153118
001532*  ASSIGNMENT EXCEPTIONS EXIST.  CHECK THE OVERALL INTEGRITY OF  *00153218
001542*  THE SUPPORTING ASSIGNMENT FILES, VERIFYING THAT ALL SYSTEM    *00154218
001543*  ID DEFAULTS AND ASSIGNMENT EXCEPTIONS REFERENCE VALID         *00154334
001570*  ASSIGNMENT GROUPS.  CHECK THE INTEGRITY OF THE SETUP AND      *00157034
001580*  EXPLICIT ASSIGNMENT GROUP REQUESTS IN THE OVERDUE AND AD HOC  *00158034
001590*  INCIDENT APPLICATIONS.                                        *00159034
002029******************************************************************00202900
002030                                                                  00203000
002040******************************************************************00204000
002050 ENVIRONMENT DIVISION.                                            00205000
002060******************************************************************00206000
002070                                                                  00207000
002080 CONFIGURATION SECTION.                                           00208000
002090                                                                  00209000
002100 SOURCE-COMPUTER.        IBM-3090.                                00210000
002200 OBJECT-COMPUTER.        IBM-3090.                                00220000
002300                                                                  00230000
002400 INPUT-OUTPUT SECTION.                                            00240000
002500                                                                  00250000
002600 FILE-CONTROL.                                                    00260000
002700                                                                  00270000
002800     SELECT JOB-DOCUMENTATION-FILE                                00280000
002900         ASSIGN TO INP01.                                         00290000
003000                                                                  00300000
003100     SELECT SYSTEM-ID-DEFAULT-FILE                                00310000
003200         ASSIGN TO INP02.                                         00320000
003300                                                                  00330000
003400     SELECT ASSIGNMENT-GROUP-FILE                                 00340000
003500         ASSIGN TO INP03.                                         00350000
003600                                                                  00360000
003700     SELECT ASSIGNMENT-EXCP-FILE                                  00370000
003800         ASSIGN TO INP04.                                         00380000
003813                                                                  00381329
003820     SELECT OVERDUE-INCIDENT-FILE                                 00382019
003830         ASSIGN TO INP05.                                         00383029
003900                                                                  00390000
004000     SELECT ADHOC-INCIDENT-FILE                                   00400036
004010         ASSIGN TO INP06.                                         00401036
004020                                                                  00402036
004100     SELECT EMAIL-NOTICE-FILE                                     00410002
004200         ASSIGN TO OUT01.                                         00420002
004500                                                                  00450000
004600******************************************************************00460000
004700 DATA DIVISION.                                                   00470000
004800******************************************************************00480000
004900                                                                  00490000
005000 FILE SECTION.                                                    00500000
005010                                                                  00501003
005020 FD  JOB-DOCUMENTATION-FILE                                       00502003
005030     RECORDING MODE IS F                                          00503003
005040     LABEL RECORDS ARE STANDARD                                   00504003
005050     BLOCK CONTAINS 0 RECORDS                                     00505003
005060     RECORD CONTAINS 80 CHARACTERS                                00506005
005070     DATA RECORD IS JD-JOB-DOCUMENTATION-RECORD.                  00507003
005080                                                                  00508003
005090 01  JD-JOB-DOCUMENTATION-RECORD PIC X(80).                       00509005
005100                                                                  00510000
005200 FD  SYSTEM-ID-DEFAULT-FILE                                       00520000
005300     RECORDING MODE IS F                                          00530000
005400     LABEL RECORDS ARE STANDARD                                   00540000
005500     BLOCK CONTAINS 0 RECORDS                                     00550000
005600     RECORD CONTAINS 80 CHARACTERS                                00560000
005700     DATA RECORD IS SI-SYSTEM-ID-DEFAULT-RECORD.                  00570000
005800                                                                  00580000
005900 01  SI-SYSTEM-ID-DEFAULT-RECORD PIC X(80).                       00590000
006900                                                                  00690000
007000 FD  ASSIGNMENT-GROUP-FILE                                        00700000
007100     RECORDING MODE IS F                                          00710000
007200     LABEL RECORDS ARE STANDARD                                   00720000
007300     BLOCK CONTAINS 0 RECORDS                                     00730000
007400     RECORD CONTAINS 80 CHARACTERS                                00740000
007500     DATA RECORD IS AG-ASSIGNMENT-GROUP-RECORD.                   00750000
007600                                                                  00760000
007700 01  AG-ASSIGNMENT-GROUP-RECORD  PIC X(80).                       00770000
007800                                                                  00780000
007900 FD  ASSIGNMENT-EXCP-FILE                                         00790000
008000     RECORDING MODE IS F                                          00800000
008100     LABEL RECORDS ARE STANDARD                                   00810000
008200     BLOCK CONTAINS 0 RECORDS                                     00820000
008300     RECORD CONTAINS 80 CHARACTERS                                00830000
008400     DATA RECORD IS AE-ASSIGNMENT-EXCP-RECORD.                    00840000
008500                                                                  00850000
008600 01  AE-ASSIGNMENT-EXCP-RECORD   PIC X(80).                       00860000
008700                                                                  00870000
008710 FD  OVERDUE-INCIDENT-FILE                                        00871019
008720     RECORDING MODE IS F                                          00872019
008730     LABEL RECORDS ARE STANDARD                                   00873019
008740     BLOCK CONTAINS 0 RECORDS                                     00874019
008750     RECORD CONTAINS 80 CHARACTERS                                00875019
008760     DATA RECORD IS OI-OVERDUE-INCIDENT-RECORD.                   00876019
008770                                                                  00877019
008780 01  OI-OVERDUE-INCIDENT-RECORD  PIC X(80).                       00878019
008790                                                                  00879037
008791 FD  ADHOC-INCIDENT-FILE                                          00879137
008792     RECORDING MODE IS F                                          00879237
008793     LABEL RECORDS ARE STANDARD                                   00879337
008794     BLOCK CONTAINS 0 RECORDS                                     00879437
008795     RECORD CONTAINS 80 CHARACTERS                                00879537
008796     DATA RECORD IS AI-ADHOC-INCIDENT-RECORD.                     00879637
008797                                                                  00879737
008798 01  AI-ADHOC-INCIDENT-RECORD    PIC X(80).                       00879837
008800                                                                  00880002
008900 FD  EMAIL-NOTICE-FILE                                            00890002
009000     RECORDING MODE IS F                                          00900002
009100     LABEL RECORDS ARE STANDARD                                   00910002
009200     BLOCK CONTAINS 0 RECORDS                                     00920002
009300     RECORD CONTAINS 122 CHARACTERS                               00930014
009400     DATA RECORDS IS EN-EMAIL-NOTICE-RECORD.                      00940002
009500                                                                  00950002
009600 01  EN-EMAIL-NOTICE-RECORD      PIC X(122).                      00960014
010700                                                                  01070000
010800 WORKING-STORAGE SECTION.                                         01080000
010900                                                                  01090000
011000*                                                                 01100000
011100*  CALL LIST SYSTEM ID DEFAULT ASSIGNMENT GROUP RECORD LAYOUT     01110000
011200*                                                                 01120000
011300     COPY CMRD004.                                                01130000
011400                                                                  01140000
011500*                                                                 01150000
011600*  CALL LIST ASSIGNMENT EXCEPTIONS BY JOB SUFFIX RECORD LAYOUT    01160000
011700*                                                                 01170000
011800     COPY CMRD005.                                                01180000
012400                                                                  01240000
012500 01  ABEND-CODE                  PIC S9(4)    VALUE ZEROS         01250000
012600                                              COMP SYNC.          01260000
012610     88  AC-TABLE-OVERFLOW-ERROR              VALUE +4004.        01261003
012620     88  AC-FILE-SEQUENCE-ERROR               VALUE +4007.        01262003
012700                                                                  01270000
012800 01  PS-PROGRAM-SWITCHES.                                         01280000
012900     05  PS-END-OF-JOB-DOC-FILE-IND                               01290000
013000                                 PIC X(1)     VALUE 'N'.          01300000
013100         88  PS-END-OF-JOB-DOC-FILE           VALUE 'Y'.          01310000
013200     05  PS-END-OF-SYSID-DFLT-FILE-IND                            01320000
013300                                 PIC X(1)     VALUE 'N'.          01330000
013400         88  PS-END-OF-SYSID-DFLT-FILE        VALUE 'Y'.          01340000
013500     05  PS-END-OF-ASSIGN-GRP-FILE-IND                            01350000
013600                                 PIC X(1)     VALUE 'N'.          01360000
013610         88  PS-END-OF-ASSIGN-GRP-FILE        VALUE 'Y'.          01361000
013620     05  PS-END-OF-ASSIGN-EXCP-FILE-IND                           01362000
013630                                 PIC X(1)     VALUE 'N'.          01363000
013640         88  PS-END-OF-ASSIGN-EXCP-FILE       VALUE 'Y'.          01364000
013650     05  PS-END-OF-OVERDUE-INC-FILE-IND                           01365019
013660                                 PIC X(1)     VALUE 'N'.          01366019
013670         88  PS-END-OF-OVERDUE-INC-FILE       VALUE 'Y'.          01367019
013680     05  PS-END-OF-ADHOC-INC-FILE-IND                             01368035
013690                                 PIC X(1)     VALUE 'N'.          01369035
013700         88  PS-END-OF-ADHOC-INC-FILE         VALUE 'Y'.          01370035
015700     05  PS-SYSID-DFLT-FOUND-IND                                  01570000
015800                                 PIC X(1)     VALUE 'N'.          01580000
015900         88  PS-SYSID-DFLT-FOUND              VALUE 'Y'.          01590000
016000         88  PS-SYSID-DFLT-NOT-FOUND          VALUE 'N'.          01600000
016010     05  PS-SYSID-DFLT-GROUP-FOUND-IND                            01601007
016020                                 PIC X(1)     VALUE 'N'.          01602007
016030         88  PS-SYSID-DFLT-GROUP-FOUND        VALUE 'Y'.          01603007
016040         88  PS-SYSID-DFLT-GROUP-NOT-FOUND    VALUE 'N'.          01604007
016100     05  PS-ASSIGNMENT-GROUP-FOUND-IND                            01610000
016200                                 PIC X(1)     VALUE 'N'.          01620000
016300         88  PS-ASSIGNMENT-GROUP-FOUND        VALUE 'Y'.          01630000
016400         88  PS-ASSIGNMENT-GROUP-NOT-FOUND    VALUE 'N'.          01640000
016500     05  PS-ASSIGNMENT-CODE-FOUND-IND                             01650000
016600                                 PIC X(1)     VALUE 'N'.          01660000
016700         88  PS-ASSIGNMENT-CODE-FOUND         VALUE 'Y'.          01670000
016800         88  PS-ASSIGNMENT-CODE-NOT-FOUND     VALUE 'N'.          01680000
016900     05  PS-ASSIGN-EXCP-GRP-FOUND-IND                             01690013
017000                                 PIC X(1)     VALUE 'N'.          01700007
017100         88  PS-ASSIGN-EXCP-GRP-FOUND         VALUE 'Y'.          01710013
017200         88  PS-ASSIGN-EXCP-GRP-NOT-FOUND     VALUE 'N'.          01720013
017300     05  PS-ASSIGN-CODE-GRP-FOUND-IND                             01730013
017400                                 PIC X(1)     VALUE 'N'.          01740013
017500         88  PS-ASSIGN-CODE-GRP-FOUND         VALUE 'Y'.          01750013
017600         88  PS-ASSIGN-CODE-GRP-NOT-FOUND     VALUE 'N'.          01760013
017610     05  PS-OVERDUE-WARNING-IND  PIC X(1)     VALUE 'N'.          01761028
017620         88  PS-OVERDUE-WARNING               VALUE 'Y'.          01762028
017630         88  PS-NO-OVERDUE-WARNING            VALUE 'N'.          01763028
017700                                                                  01770000
017800 01  PC-PROGRAM-CONSTANTS.                                        01780000
017900     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'CMKUT006'.   01790002
018300     05  PC-MAXIMUM-SYSID-DFLT-COUNT                              01830003
018400                                 PIC S9(4)    VALUE +500          01840003
018500                                              COMP SYNC.          01850003
018600     05  PC-MAXIMUM-ASSIGN-GRP-COUNT                              01860003
018700                                 PIC S9(4)    VALUE +1000         01870003
018800                                              COMP SYNC.          01880003
018900     05  PC-MAXIMUM-ASSIGN-EXCP-COUNT                             01890003
018910                                 PIC S9(4)    VALUE +100          01891003
018920                                              COMP SYNC.          01892003
018930     05  PC-MAXIMUM-ASSIGN-CODE-COUNT                             01893013
018940                                 PIC S9(4)    VALUE +100          01894013
018950                                              COMP SYNC.          01895013
018960     05  PC-INCIDENT-ASSIGN-GRP-VAR                               01896034
018970                                 PIC X(6)     VALUE 'IGROUP'.     01897020
018980     05  PC-INCIDENT-ASSIGN-GRP-EQ                                01898034
018990                                 PIC X(1)     VALUE '='.          01899020
018991     05  PC-INCIDENT-ASSIGN-GRP-STR                               01899134
018992                                 PIC X(1)     VALUE QUOTE.        01899220
019000                                                                  01900000
019100 01  PV-PROGRAM-VARIABLES.                                        01910000
020400     05  PV-JOB-DOC-MEMBER-NAME  PIC X(8)     VALUE SPACES.       02040000
020410         88  PV-JC-TEMPLATE-MEMBER            VALUE '#JOBDOC '.   02041013
020500     05  FILLER                  REDEFINES PV-JOB-DOC-MEMBER-NAME.02050000
020600         10  PV-JD-SYSTEM-ID     PIC X(2).                        02060000
020700         10  FILLER              PIC X(6).                        02070000
021800     05  PV-JOB-DOC-UNLOAD-RECORD                                 02180003
021900                                 PIC X(80)    VALUE SPACES.       02190005
021901     05  FILLER                  REDEFINES                        02190105
021902                                     PV-JOB-DOC-UNLOAD-RECORD.    02190205
021903         10  FILLER              PIC X(13).                       02190305
021904             88  PV-JD-UNLOADED-MEMBER-ID     VALUE               02190405
021905                 './ ADD  NAME='.                                 02190505
021906         10  PV-JD-JOB-DOC-MEMBER-NAME                            02190605
021907                                 PIC X(8).                        02190705
021908         10  FILLER              PIC X(59).                       02190805
021910     05  PV-JOB-DOCUMENTATION-LINE                                02191003
021911                                 REDEFINES                        02191105
021912                                     PV-JOB-DOC-UNLOAD-RECORD     02191205
021920                                 PIC X(80).                       02192005
023400     05  FILLER                  REDEFINES                        02340000
023500                                     PV-JOB-DOC-UNLOAD-RECORD.    02350005
023600         10  FILLER              PIC X(21).                       02360000
023700             88  PV-JD-ASSIGNMENT-GROUP-ID    VALUE               02370000
023800                 '   Assignment Group: '.                         02380000
023900         10  PV-JD-ASSIGNMENT-GROUP                               02390000
024000                                 PIC X(59).                       02400000
024100             88  PV-JD-DEFAULT-ASSIGNMENT     VALUE 'default'.    02410006
024200     05  FILLER                  REDEFINES                        02420015
024300                                     PV-JOB-DOC-UNLOAD-RECORD.    02430015
024400         10  FILLER              PIC X(21).                       02440015
024700         10  PV-JD-ASSIGNMENT-EXCP-CODE                           02470015
024710                                 PIC X(4).                        02471015
024711         10  PV-JD-ASSIGNMENT-CODE-FILLER                         02471115
024712                                 PIC X(55).                       02471215
024720             88  PV-JD-ASSIGN-CODE-CANDIDATE  VALUE SPACES.       02472015
024800     05  PV-ASSIGNMENT-GROUP-RECORD                               02480000
024900                                 PIC X(80)    VALUE SPACES.       02490000
026010     05  PV-SYSID-DEFAULT-COUNT  PIC S9(4)    VALUE ZEROS         02601003
026030                                              COMP SYNC.          02603003
026040     05  PV-ASSIGNMENT-GROUP-COUNT                                02604003
026041                                 PIC S9(4)    VALUE ZEROS         02604103
026050                                              COMP SYNC.          02605003
026060     05  PV-ASSIGNMENT-EXCP-COUNT                                 02606003
026070                                 PIC S9(4)    VALUE ZEROS         02607003
026080                                              COMP SYNC.          02608003
026090     05  PV-ASSIGNMENT-CODE-COUNT                                 02609013
026100                                 PIC S9(4)    VALUE ZEROS         02610013
026200                                              COMP SYNC.          02620013
026300     05  PV-ASSIGNMENT-EXCEPTION-KEY.                             02630013
026400         10  PV-AE-ASSIGNMENT-CODE                                02640013
026500                                 PIC X(4)     VALUE SPACES.       02650013
026600         10  PV-AE-JOB-NAME-SUFFIX                                02660013
026700                                 PIC X(2)     VALUE SPACES.       02670013
026900     05  PV-LAST-SYSTEM-ID       PIC X(2)     VALUE SPACES.       02690007
026910     05  PV-LAST-ASSIGNMENT-GROUP                                 02691007
027000                                 PIC X(59)    VALUE SPACES.       02700007
027100     05  PV-CURRENT-ERROR        PIC X(100)   VALUE SPACES.       02710007
027200     05  PV-INCIDENT-APPL-RECORD PIC X(80)    VALUE SPACES.       02720035
027210     05  PV-UNSTRING-POINTER     PIC S9(4)    VALUE ZEROS         02721022
027300                                              COMP SYNC.          02730020
027310     05  PV-INC-ASSIGN-GRP-CONSTANT-LOC                           02731040
027311                                 PIC S9(4)    VALUE ZEROS         02731140
027320                                              COMP SYNC.          02732040
027400     05  PV-QUOTE-COUNT          PIC S9(4)    VALUE ZEROS         02740032
027500                                              COMP SYNC.          02750027
027510     05  PV-QUOTE-POINTER        PIC S9(4)    VALUE ZEROS         02751032
027520                                              COMP SYNC.          02752032
027600     05  PV-INCIDENT-ASSIGNMENT-GROUP                             02760034
027700                                 PIC X(59)    VALUE SPACES.       02770027
029310                                                                  02931001
029311 01  SI-SYSTEM-ID-DEFAULT-TABLE.                                  02931102
029312     05  SI-SYSTEM-ID-DEFAULT-ENTRY                               02931206
029313                                 OCCURS 500 TIMES                 02931306
029314                                 ASCENDING KEY SI-SYSTEM-ID       02931406
029315                                 INDEXED BY SI-INDEX.             02931506
029316         10  SI-SYSTEM-ID        PIC X(2).                        02931606
029321         10  SI-ASSIGNMENT-GROUP PIC X(76).                       02932102
029328                                                                  02932802
029329 01  AG-ASSIGNMENT-GROUP-TABLE.                                   02932902
029330     05  AG-ASSIGNMENT-GROUP-ENTRY                                02933002
029331                                 OCCURS 1000 TIMES                02933102
029340                                 ASCENDING KEY AG-ASSIGNMENT-GROUP02934002
029350                                 INDEXED BY AG-INDEX.             02935002
029360         10  AG-ASSIGNMENT-GROUP PIC X(80).                       02936002
029400                                                                  02940000
029420 01  AE-ASSIGNMENT-EXCP-TABLE.                                    02942003
029430     05  AE-ASSIGNMENT-EXCP-ENTRY                                 02943003
029440                                 OCCURS 100 TIMES                 02944003
029450                                 ASCENDING KEY                    02945013
029451                                            AE-ASSIGNMENT-EXCP-KEY02945113
029460                                 INDEXED BY AE-INDEX.             02946003
029461         10  AE-ASSIGNMENT-EXCP-KEY.                              02946113
029470             15  AE-ASSIGNMENT-CODE                               02947013
029471                                 PIC X(4).                        02947113
029472             15  AE-JOB-NAME-SUFFIX                               02947213
029473                                 PIC X(2).                        02947313
029474         10  AE-ASSIGNMENT-GROUP PIC X(72).                       02947413
029475                                                                  02947513
029476 01  AC-ASSIGNMENT-CODE-TABLE.                                    02947613
029477     05  AC-ASSIGNMENT-CODE-ENTRY                                 02947713
029478                                 OCCURS 100 TIMES                 02947813
029479                                 ASCENDING KEY AC-ASSIGNMENT-CODE 02947913
029480                                 INDEXED BY AC-INDEX.             02948013
029481         10  AC-ASSIGNMENT-CODE  PIC X(4).                        02948113
029482         10  AC-ASSIGNMENT-GROUP PIC X(72).                       02948213
029490                                                                  02949013
029500 01  PT-PROGRAM-TOTALS.                                           02950000
029600     05  PT-JOB-DOC-LINES-READ   PIC S9(7)    VALUE ZEROS         02960000
029700                                              COMP-3.             02970000
029710     05  PT-JOB-DOC-MEMBERS      PIC S9(7)    VALUE ZEROS         02971004
029720                                              COMP-3.             02972004
029800     05  PT-SYSID-DFLT-RECORDS-READ                               02980000
029900                                 PIC S9(7)    VALUE ZEROS         02990000
030000                                              COMP-3.             03000000
030100     05  PT-ASSIGN-GRP-RECORDS-READ                               03010000
030200                                 PIC S9(7)    VALUE ZEROS         03020000
030300                                              COMP-3.             03030000
030400     05  PT-ASSIGN-EXCP-RECORDS-READ                              03040000
030500                                 PIC S9(7)    VALUE ZEROS         03050000
030600                                              COMP-3.             03060000
030610     05  PT-ASSIGN-EXCP-CODES-FOUND                               03061013
030620                                 PIC S9(7)    VALUE ZEROS         03062013
030630                                              COMP-3.             03063013
030640     05  PT-OVERDUE-INC-RECORDS-READ                              03064019
030650                                 PIC S9(7)    VALUE ZEROS         03065019
030660                                              COMP-3.             03066019
030670     05  PT-ADHOC-INC-RECORDS-READ                                03067034
030680                                 PIC S9(7)    VALUE ZEROS         03068034
030690                                              COMP-3.             03069034
030700     05  PT-EMAIL-NOTICE-RCDS-WRITTEN                             03070002
030800                                 PIC S9(7)    VALUE ZEROS         03080000
030900                                              COMP-3.             03090000
031300                                                                  03130000
031400 01  TD-TOTAL-DISPLAY-MESSAGE.                                    03140000
031500     05  TD-TOTAL-ID             PIC X(51)    VALUE SPACE.        03150000
031600         88  TD-JOB-DOC-LINES-READ-ID         VALUE               03160000
031700             'JOB DOCUMENTATION LINES READ . . . . . . . . . . '. 03170000
031710         88  TD-JOB-DOC-MEMBERS-ID            VALUE               03171004
031720             'JOB DOCUMENTATION MEMBERS FOUND  . . . . . . . . '. 03172004
031800         88  TD-SYSID-DFLT-RECORDS-READ-ID    VALUE               03180004
031900             'SYSTEM ID DEFAULT ASSIGNMENT GROUP RECORDS READ. '. 03190000
032000         88  TD-ASSIGN-GRP-RECORDS-READ-ID    VALUE               03200000
032100             'VALID ASSIGNMENT GROUP RECORDS READ  . . . . . . '. 03210000
032200         88  TD-ASSIGN-EXCP-RECORDS-READ-ID   VALUE               03220000
032300             'ASSIGNMENT EXCEPTION RECORDS READ  . . . . . . . '. 03230000
032310         88  TD-ASSIGN-EXCP-CODES-FOUND-ID    VALUE               03231013
032320             'ASSIGNMENT EXCEPTION CODES FOUND . . . . . . . . '. 03232013
032330         88  TD-OVERDUE-INC-RECORDS-READ-ID   VALUE               03233019
032340             'OVERDUE INCIDENT SETUP RECORDS READ  . . . . . . '. 03234019
032350         88  TD-ADHOC-INC-RECORDS-READ-ID     VALUE               03235034
032360             'ADHOC INCIDENT SETUP RECORDS READ  . . . . . . . '. 03236034
032400         88  TD-EMAIL-NOTIC-RCDS-WRITTEN-ID  VALUE                03240009
032500             'E-MAIL NOTICE RECORDS WRITTEN  . . . . . . . . . '. 03250002
032800     05  TD-TOTAL-AMOUNT         PIC Z,ZZZ,ZZ9                    03280000
032900                                              VALUE ZEROS.        03290000
033900                                                                  03390000
034000******************************************************************03400000
034100 PROCEDURE DIVISION.                                              03410002
034200******************************************************************03420000
034300                                                                  03430000
034400 0000-MAINLINE.                                                   03440000
034500                                                                  03450000
034600     PERFORM 1000-INITIALIZE.                                     03460000
034700                                                                  03470000
034800     PERFORM 2000-PROCESS-JOB-DOC-UNLOAD                          03480003
034900         UNTIL PS-END-OF-JOB-DOC-FILE.                            03490003
035100                                                                  03510000
035300     PERFORM 3000-CHECK-INTEGRITY.                                03530011
035500                                                                  03550011
040400     PERFORM 1500-DISPLAY-PROGRAM-TOTALS.                         04040000
040500                                                                  04050000
040600     PERFORM 9000-EOJ-ROUTINE.                                    04060000
040700                                                                  04070000
040800     STOP RUN.                                                    04080000
040900                                                                  04090000
041000******************************************************************04100000
041900*  INITIALIZE FOR PROGRAM PROCESSING.  OPEN ALL FILES.  LOAD THE *04190018
041910*  LOOKUP TABLES FOR THE CALL LIST SYSTEM ID DEFAULT ASSIGNMENT  *04191018
041920*  GROUP FILE, VALID ASSIGNMENT GROUP FILE, CALL LIST ASSIGNMENT *04192018
041930*  EXCEPTION CODES AND CALL LIST ASSIGNMENT EXCEPTIONS.  READ    *04193018
041940*  THE FIRST UNLOADED JOB DOCUMENTATION RECORD.                  *04194018
042000******************************************************************04200000
042100                                                                  04210000
042200 1000-INITIALIZE.                                                 04220000
042500     OPEN INPUT  JOB-DOCUMENTATION-FILE                           04250003
042501                 SYSTEM-ID-DEFAULT-FILE                           04250103
042502                 ASSIGNMENT-GROUP-FILE                            04250203
042503                 ASSIGNMENT-EXCP-FILE                             04250303
042510          OUTPUT EMAIL-NOTICE-FILE.                               04251003
042700                                                                  04270000
042800     PERFORM 1100-LOAD-SYSID-DEFAULTS.                            04280003
042900                                                                  04290003
043000     PERFORM 1200-LOAD-ASSIGNMENT-GROUPS.                         04300003
043100                                                                  04310003
043200     PERFORM 1300-LOAD-ASSIGNMENT-EXCPS.                          04320003
043300                                                                  04330003
043400     PERFORM 7000-READ-JOB-DOC-FILE.                              04340003
052200*1000-EXIT.                                                       05220000
052210                                                                  05221001
052300******************************************************************05230001
052310*  LOAD THE CALL LIST SYSTEM ID DEFAULT ASSIGNMENT GROUP LOOKUP  *05231018
052311*  TABLE.  INITIALIZE TO HIGH VALUES TO ALLOW A BINARY SEARCH    *05231118
052312*  REGARDLESS OF UNUSED ENTRIES.  READ EACH RECORD.  VERIFY      *05231218
052313*  THE FILE IS IN ASCENDING SYSTEM ID SEQUENCE WHILE LOADING.    *05231318
052314*  LOAD ALL INFORMATION.  IF THE MAXIMUM NUMBER OF ENTRIES IN    *05231418
052315*  THE TABLE ARE EXCEEDED, TERMINATE PROCESSING.                 *05231518
052321******************************************************************05232118
052330                                                                  05233001
052340 1100-LOAD-SYSID-DEFAULTS.                                        05234003
052350     INITIALIZE SI-SYSTEM-ID-DEFAULT-TABLE                        05235003
052360         REPLACING ALPHANUMERIC DATA BY HIGH-VALUES.              05236001
052361     INITIALIZE PV-SYSID-DEFAULT-COUNT.                           05236103
052362                                                                  05236201
052363     PERFORM 7100-READ-SYSID-DFLT-FILE.                           05236303
052364                                                                  05236401
052365     PERFORM                                                      05236501
052366             VARYING SI-INDEX                                     05236603
052367             FROM 1 BY 1                                          05236701
052368             UNTIL ((SI-INDEX > PC-MAXIMUM-SYSID-DFLT-COUNT)      05236803
052369                     OR (PS-END-OF-SYSID-DFLT-FILE))              05236903
052370         IF ((SI-INDEX > 1)                                       05237003
052371                 AND (CM004-SYSTEM-ID <=                          05237103
052372                              SI-SYSTEM-ID (SI-INDEX - 1)))       05237203
052373             DISPLAY '** ABEND **'                                05237301
052374             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - CALL LIST '     05237403
052375                       'SYSTEM ID DEFAULT ASSIGNMENT GROUP FILE ' 05237503
052376                       'NOT IN ASCENDING SYSTEM ID SEQUENCE'      05237603
052377             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ERROR OCCURS '  05237701
052378                       'AT SYSTEM ID = '  CM004-SYSTEM-ID         05237803
052379             SET AC-FILE-SEQUENCE-ERROR TO TRUE                   05237901
052380             CALL 'ILBOABN0' USING ABEND-CODE                     05238001
052381         END-IF                                                   05238101
052382         MOVE CM004-SYSTEM-ID TO SI-SYSTEM-ID (SI-INDEX)          05238203
052383         MOVE CM004-ASSIGNMENT-GROUP TO                           05238303
052384                   SI-ASSIGNMENT-GROUP (SI-INDEX)                 05238409
052386         ADD +1 TO PV-SYSID-DEFAULT-COUNT                         05238603
052387         PERFORM 7100-READ-SYSID-DFLT-FILE                        05238703
052388     END-PERFORM.                                                 05238801
052389                                                                  05238901
052390     IF ((SI-INDEX > PC-MAXIMUM-SYSID-DFLT-COUNT)                 05239003
052391             AND (NOT PS-END-OF-SYSID-DFLT-FILE))                 05239103
052392         DISPLAY '** ABEND **'                                    05239201
052393         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - MAXIMUM NUMBER OF ' 05239301
052394                   'CALL LIST SYSTEM ID DEFAULT ASSIGNMENT '      05239403
052395                   'GROUPS EXCEEDED'                              05239503
052396         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - EXPAND THE TABLE '  05239601
052397                   'AND RERUN'                                    05239701
052398         SET AC-TABLE-OVERFLOW-ERROR TO TRUE                      05239801
052399         CALL 'ILBOABN0' USING ABEND-CODE                         05239901
052400     END-IF.                                                      05240001
052401*1100-EXIT.                                                       05240103
052402                                                                  05240203
052403******************************************************************05240303
052404*  LOAD THE VALID ASSIGNMENT GROUP LOOKUP TABLE.  INITIALIZE TO  *05240418
052405*  HIGH VALUES TO ALLOW A BINARY SEARCH REGARDLESS OF UNUSED     *05240518
052406*  ENTRIES.  READ EACH RECORD.  VERIFY THE FILE IS IN ASCENDING  *05240618
052407*  ASSIGNMENT GROUP SEQUENCE WHILE LOADING.  LOAD ALL            *05240718
052408*  INFORMATION.  IF THE MAXIMUM NUMBER OF ENTRIES IN THE TABLE   *05240818
052409*  ARE EXCEEDED, TERMINATE PROCESSING.                           *05240918
052411******************************************************************05241103
052412                                                                  05241203
052413 1200-LOAD-ASSIGNMENT-GROUPS.                                     05241303
052414     INITIALIZE AG-ASSIGNMENT-GROUP-TABLE                         05241403
052415         REPLACING ALPHANUMERIC DATA BY HIGH-VALUES.              05241503
052416     INITIALIZE PV-ASSIGNMENT-GROUP-COUNT.                        05241603
052417                                                                  05241703
052418     PERFORM 7200-READ-ASSIGN-GRP-FILE.                           05241803
052419                                                                  05241903
052420     PERFORM                                                      05242003
052421             VARYING AG-INDEX                                     05242103
052422             FROM 1 BY 1                                          05242203
052423             UNTIL ((AG-INDEX > PC-MAXIMUM-ASSIGN-GRP-COUNT)      05242303
052424                     OR (PS-END-OF-ASSIGN-GRP-FILE))              05242403
052425         IF ((AG-INDEX > 1)                                       05242503
052426                 AND (PV-ASSIGNMENT-GROUP-RECORD <=               05242603
052427                              AG-ASSIGNMENT-GROUP (AG-INDEX - 1)))05242703
052428             DISPLAY '** ABEND **'                                05242803
052429             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - VALID '         05242903
052430                       'ASSIGNMENT GROUP FILE NOT IN ASCENDING '  05243003
052431                       'ASSIGNMENT GROUP SEQUENCE'                05243103
052432             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ERROR OCCURS '  05243203
052433                       'AT ASSIGNMENT GROUP = '                   05243303
052434                       PV-ASSIGNMENT-GROUP-RECORD                 05243403
052435             SET AC-FILE-SEQUENCE-ERROR TO TRUE                   05243503
052436             CALL 'ILBOABN0' USING ABEND-CODE                     05243603
052437         END-IF                                                   05243703
052438         MOVE PV-ASSIGNMENT-GROUP-RECORD TO                       05243803
052439                   AG-ASSIGNMENT-GROUP (AG-INDEX)                 05243909
052440         ADD +1 TO PV-ASSIGNMENT-GROUP-COUNT                      05244003
052441         PERFORM 7200-READ-ASSIGN-GRP-FILE                        05244103
052442     END-PERFORM.                                                 05244203
052443                                                                  05244303
052444     IF ((AG-INDEX > PC-MAXIMUM-ASSIGN-GRP-COUNT)                 05244403
052445             AND (NOT PS-END-OF-ASSIGN-GRP-FILE))                 05244503
052446         DISPLAY '** ABEND **'                                    05244603
052447         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - MAXIMUM NUMBER OF ' 05244703
052448                   'VALID ASSIGNMENT GROUPS EXCEEDED'             05244803
052449         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - EXPAND THE TABLE '  05244903
052450                   'AND RERUN'                                    05245003
052451         SET AC-TABLE-OVERFLOW-ERROR TO TRUE                      05245103
052452         CALL 'ILBOABN0' USING ABEND-CODE                         05245203
052453     END-IF.                                                      05245303
052454*1200-EXIT.                                                       05245403
052455                                                                  05245503
052456******************************************************************05245603
052457*  LOAD THE CALL LIST ASSIGNMENT EXCEPTIONS AND EXCEPTION CODES  *05245718
052458*  LOOKUP TABLES.  INITIALIZE TO HIGH VALUES TO ALLOW A BINARY   *05245818
052459*  SEARCH REGARDLESS OF UNUSED ENTRIES.  READ EACH RECORD.       *05245918
052460*  VERIFY THE FILE IS IN ASCENDING EXCEPTION CODE AND JOB NAME   *05246018
052461*  SUFFIX SEQUENCE WHILE LOADING.  LOAD ALL EXCEPTION            *05246118
052462*  INFORMATION.  CREATE NEW EXCEPTION CODE ENTRIES AT CHANGE     *05246218
052463*  WHEN EACH NEW EXCEPTION CODE IS DETECTED.  IF THE MAXIUMUM    *05246318
052464*  NUMBER OF ENTRIES IN EITHER TABLE ARE EXCEEDED, TERMINATE     *05246418
052467*  PROCESSING.                                                   *05246718
052468******************************************************************05246818
052469                                                                  05246918
052470 1300-LOAD-ASSIGNMENT-EXCPS.                                      05247018
052471     INITIALIZE AE-ASSIGNMENT-EXCP-TABLE                          05247118
052472         REPLACING ALPHANUMERIC DATA BY HIGH-VALUES.              05247218
052473     INITIALIZE AC-ASSIGNMENT-CODE-TABLE                          05247318
052474         REPLACING ALPHANUMERIC DATA BY HIGH-VALUES.              05247418
052475     INITIALIZE PV-ASSIGNMENT-EXCP-COUNT                          05247518
052476                PV-ASSIGNMENT-CODE-COUNT.                         05247618
052477                                                                  05247718
052478     PERFORM 7300-READ-ASSIGN-EXCP-FILE.                          05247818
052479                                                                  05247918
052480     SET AE-INDEX                                                 05248018
052481         AC-INDEX TO 1.                                           05248118
052482     SET AC-INDEX DOWN BY 1.                                      05248218
052483     PERFORM                                                      05248318
052484             UNTIL ((AE-INDEX > PC-MAXIMUM-ASSIGN-EXCP-COUNT)     05248418
052485                     OR (PS-END-OF-ASSIGN-EXCP-FILE))             05248518
052486         MOVE CM005-ASSIGNMENT-CODE TO PV-AE-ASSIGNMENT-CODE      05248618
052487         MOVE CM005-JOB-NAME-SUFFIX TO PV-AE-JOB-NAME-SUFFIX      05248718
052488         IF ((AE-INDEX > 1)                                       05248818
052489                 AND (PV-ASSIGNMENT-EXCEPTION-KEY <               05248918
052490                           AE-ASSIGNMENT-EXCP-KEY (AE-INDEX - 1)))05249018
052491             DISPLAY '** ABEND **'                                05249118
052492             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - CALL LIST '     05249218
052493                       'ASSIGNMENT EXCEPTIONS BY JOB SUFFIX FILE '05249318
052494                       'NOT IN ASCENDING ASSIGNMENT CODE SEQUENCE'05249418
052495             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ERROR OCCURS '  05249518
052496                       'AT ASSIGNMENT CODE/JOB NAME SUFFIX = '    05249618
052497                       CM005-ASSIGNMENT-CODE '/'                  05249718
052498                       CM005-JOB-NAME-SUFFIX                      05249818
052499             SET AC-FILE-SEQUENCE-ERROR TO TRUE                   05249918
052500             CALL 'ILBOABN0' USING ABEND-CODE                     05250018
052501         END-IF                                                   05250118
052502         MOVE CM005-ASSIGNMENT-CODE TO                            05250218
052503                   AE-ASSIGNMENT-CODE (AE-INDEX)                  05250318
052504         MOVE CM005-JOB-NAME-SUFFIX TO                            05250418
052505                   AE-JOB-NAME-SUFFIX (AE-INDEX)                  05250518
052506         MOVE CM005-ASSIGNMENT-GROUP TO                           05250618
052507                   AE-ASSIGNMENT-GROUP (AE-INDEX)                 05250718
052508         ADD +1 TO PV-ASSIGNMENT-EXCP-COUNT                       05250818
052509         SET AE-INDEX UP BY 1                                     05250918
052510         IF ((AC-INDEX = 0)                                       05251018
052511                 OR (CM005-ASSIGNMENT-CODE NOT =                  05251118
052512                              AC-ASSIGNMENT-CODE (AC-INDEX)))     05251218
052513             SET AC-INDEX UP BY 1                                 05251318
052514             IF (AC-INDEX > PC-MAXIMUM-ASSIGN-CODE-COUNT)         05251418
052515                 DISPLAY '** ABEND **'                            05251518
052516                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - MAXIMUM '   05251618
052517                           'NUMBER OF CALL LIST ASSIGNMENT '      05251718
052518                           ' EXCEPTION CODES EXCEEDED'            05251818
052519                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - EXPAND '    05251918
052520                           'THE TABLE AND RERUN'                  05252018
052521                 SET AC-TABLE-OVERFLOW-ERROR TO TRUE              05252118
052522                 CALL 'ILBOABN0' USING ABEND-CODE                 05252218
052523             END-IF                                               05252318
052524             MOVE CM005-ASSIGNMENT-CODE TO                        05252418
052525                       AC-ASSIGNMENT-CODE (AC-INDEX)              05252518
052526             MOVE CM005-ASSIGNMENT-GROUP TO                       05252618
052527                       AC-ASSIGNMENT-GROUP (AC-INDEX)             05252718
052528             ADD +1 TO PV-ASSIGNMENT-CODE-COUNT                   05252818
052529                       PT-ASSIGN-EXCP-CODES-FOUND                 05252918
052530         END-IF                                                   05253018
052531         PERFORM 7300-READ-ASSIGN-EXCP-FILE                       05253118
052532     END-PERFORM.                                                 05253218
052533                                                                  05253318
052534     IF ((AE-INDEX > PC-MAXIMUM-ASSIGN-EXCP-COUNT)                05253418
052535             AND (NOT PS-END-OF-ASSIGN-EXCP-FILE))                05253518
052536         DISPLAY '** ABEND **'                                    05253618
052537         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - MAXIMUM NUMBER OF ' 05253718
052538                   'CALL LIST ASSIGNMENT EXCEPTIONS BY JOB '      05253818
052539                   'SUFFIX EXCEEDED'                              05253918
052540         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - EXPAND THE TABLE '  05254018
052541                   'AND RERUN'                                    05254118
052542         SET AC-TABLE-OVERFLOW-ERROR TO TRUE                      05254218
052543         CALL 'ILBOABN0' USING ABEND-CODE                         05254318
052544     END-IF.                                                      05254418
052545*1300-EXIT.                                                       05254518
052546                                                                  05254618
052547******************************************************************05254718
052550*  DISPLAY SUMMARY TOTALS OF I/O ACTIVITY.                       *05255013
052600******************************************************************05260000
052700                                                                  05270000
052800 1500-DISPLAY-PROGRAM-TOTALS.                                     05280000
052900     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '.                      05290000
053000                                                                  05300000
053100     SET TD-JOB-DOC-LINES-READ-ID TO TRUE.                        05310000
053200     MOVE PT-JOB-DOC-LINES-READ TO TD-TOTAL-AMOUNT.               05320000
053300     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       05330000
053310               TD-TOTAL-DISPLAY-MESSAGE.                          05331000
053311                                                                  05331104
053312     SET TD-JOB-DOC-MEMBERS-ID TO TRUE.                           05331204
053313     MOVE PT-JOB-DOC-MEMBERS TO TD-TOTAL-AMOUNT.                  05331304
053314     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       05331404
053315               TD-TOTAL-DISPLAY-MESSAGE.                          05331504
053320                                                                  05332000
053330     SET TD-SYSID-DFLT-RECORDS-READ-ID TO TRUE.                   05333000
053340     MOVE PT-SYSID-DFLT-RECORDS-READ TO TD-TOTAL-AMOUNT.          05334000
053350     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       05335000
053360               TD-TOTAL-DISPLAY-MESSAGE.                          05336000
053370                                                                  05337000
053380     SET TD-ASSIGN-GRP-RECORDS-READ-ID TO TRUE.                   05338000
053390     MOVE PT-ASSIGN-GRP-RECORDS-READ TO TD-TOTAL-AMOUNT.          05339000
053400     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       05340000
053500               TD-TOTAL-DISPLAY-MESSAGE.                          05350000
053600                                                                  05360000
053700     SET TD-ASSIGN-EXCP-RECORDS-READ-ID TO TRUE.                  05370000
053800     MOVE PT-ASSIGN-EXCP-RECORDS-READ TO TD-TOTAL-AMOUNT.         05380000
053900     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       05390000
054000               TD-TOTAL-DISPLAY-MESSAGE.                          05400000
054600                                                                  05460000
054601     SET TD-ASSIGN-EXCP-CODES-FOUND-ID TO TRUE.                   05460113
054610     MOVE PT-ASSIGN-EXCP-CODES-FOUND TO TD-TOTAL-AMOUNT.          05461013
054620     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       05462013
054630               TD-TOTAL-DISPLAY-MESSAGE.                          05463013
054631                                                                  05463119
054632     SET TD-OVERDUE-INC-RECORDS-READ-ID TO TRUE.                  05463219
054633     MOVE PT-OVERDUE-INC-RECORDS-READ TO TD-TOTAL-AMOUNT.         05463319
054634     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       05463419
054635               TD-TOTAL-DISPLAY-MESSAGE.                          05463519
054640                                                                  05464013
054650     SET TD-ADHOC-INC-RECORDS-READ-ID TO TRUE.                    05465034
054660     MOVE PT-ADHOC-INC-RECORDS-READ TO TD-TOTAL-AMOUNT.           05466034
054670     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       05467034
054680               TD-TOTAL-DISPLAY-MESSAGE.                          05468034
054690                                                                  05469034
054700     SET TD-EMAIL-NOTIC-RCDS-WRITTEN-ID TO TRUE.                  05470009
054800     MOVE PT-EMAIL-NOTICE-RCDS-WRITTEN TO TD-TOTAL-AMOUNT.        05480002
054900     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       05490000
055000               TD-TOTAL-DISPLAY-MESSAGE.                          05500000
055100*1500-EXIT.                                                       05510000
057700                                                                  05770000
057800******************************************************************05780000
058620*  PROCESS AN UNLOADED JOB DOCUMENTATION RECORD.  WHEN A NEW     *05862018
058621*  MEMBER IS DETECTED IN THE UNLOAD, CAPTURE THE MEMBER NAME,    *05862118
058622*  AND INCREASE THE MEMBER COUNT.  WHEN AN ASSIGNMENT GROUP      *05862218
058623*  LINE IS DETECTED IN A DOCUMENTATION MEMBER, DETERMINE THE     *05862318
058624*  ASSIGNMENT REQUIREMENTS.  IF IT SPECIFIES TO USE THE DEFAULT  *05862418
058625*  ASSIGNMENT GROUP, VERIFY THAT THE RELATED SYSTEM ID HAS A     *05862518
058626*  DEFAULT DEFINED, AND THAT THE DEFAULT IS A VALID ASSIGNMENT   *05862618
058627*  GROUP.  IF IT IS DETECTED THAT AN ASSIGNMENT EXCEPTION CODE   *05862718
058628*  WAS SPECIFIED FOR ASSIGNMENT, VERIFY THAT THE FIRST           *05862818
058629*  ASSIGNMENT EXCEPTION FOR THAT CODE HAS A VALID ASSIGNMENT     *05862918
058630*  GROUP.                                                        *05863018
058631******************************************************************05863118
058640                                                                  05864000
058650 2000-PROCESS-JOB-DOC-UNLOAD.                                     05865004
059200     EVALUATE TRUE                                                05920005
059300         WHEN (PV-JD-UNLOADED-MEMBER-ID)                          05930005
059400             MOVE PV-JD-JOB-DOC-MEMBER-NAME TO                    05940005
059410                       PV-JOB-DOC-MEMBER-NAME                     05941005
059500             ADD +1 to PT-JOB-DOC-MEMBERS                         05950005
059900         WHEN (NOT PV-JD-ASSIGNMENT-GROUP-ID)                     05990006
059910             CONTINUE                                             05991006
060100         WHEN OTHER                                               06010007
060101*                                                                 06010118
060102*  ONLY EVALUATE SYSTEM ID DETAILS AND ASSIGNMENT GROUP           06010218
060103*  DETAILS, IF NOT THE SAME AS THE LAST PROCESSED JOB             06010318
060104*  DOCUMENTATION MEMBER.                                          06010418
060105*                                                                 06010518
060106             IF (PV-JD-SYSTEM-ID NOT = PV-LAST-SYSTEM-ID)         06010618
060107                 MOVE PV-JD-SYSTEM-ID TO PV-LAST-SYSTEM-ID        06010718
060110                 SEARCH ALL SI-SYSTEM-ID-DEFAULT-ENTRY            06011007
060120                     AT END                                       06012007
060130                         SET PS-SYSID-DFLT-NOT-FOUND TO TRUE      06013007
060150                     WHEN SI-SYSTEM-ID (SI-INDEX) =               06015007
060151                                           PV-JD-SYSTEM-ID        06015107
060160                         SET PS-SYSID-DFLT-FOUND TO TRUE          06016007
060199                 END-SEARCH                                       06019907
060200                 IF (PS-SYSID-DFLT-FOUND)                         06020007
060231                     SEARCH ALL AG-ASSIGNMENT-GROUP-ENTRY         06023107
060232                         AT END                                   06023207
060233                             SET PS-SYSID-DFLT-GROUP-NOT-FOUND TO 06023307
060234                                                              TRUE06023407
060235                         WHEN AG-ASSIGNMENT-GROUP (AG-INDEX) =    06023507
060236                                   SI-ASSIGNMENT-GROUP (SI-INDEX) 06023606
060237                             SET PS-SYSID-DFLT-GROUP-FOUND TO TRUE06023707
060238                     END-SEARCH                                   06023807
060239                 ELSE                                             06023907
060240                     SET PS-SYSID-DFLT-GROUP-NOT-FOUND TO TRUE    06024007
060242                 END-IF                                           06024207
060243             END-IF                                               06024307
060250             IF (PV-JD-ASSIGNMENT-GROUP NOT =                     06025007
060260                                       PV-LAST-ASSIGNMENT-GROUP)  06026007
060270                 MOVE PV-JD-ASSIGNMENT-GROUP TO                   06027007
060280                          PV-LAST-ASSIGNMENT-GROUP                06028007
060301                 SEARCH ALL AG-ASSIGNMENT-GROUP-ENTRY             06030106
060302                     AT END                                       06030206
060303                         SET PS-ASSIGNMENT-GROUP-NOT-FOUND TO TRUE06030307
060304                     WHEN AG-ASSIGNMENT-GROUP (AG-INDEX) =        06030406
060305                                   PV-JD-ASSIGNMENT-GROUP         06030506
060306                         SET PS-ASSIGNMENT-GROUP-FOUND TO TRUE    06030607
060307                 END-SEARCH                                       06030706
060309                 IF ((PS-ASSIGNMENT-GROUP-NOT-FOUND)              06030915
060310                         AND (PV-JD-ASSIGN-CODE-CANDIDATE))       06031015
060311                     SEARCH ALL AC-ASSIGNMENT-CODE-ENTRY          06031113
060312                         AT END                                   06031207
060313                             SET PS-ASSIGNMENT-CODE-NOT-FOUND TO  06031307
060314                                                              TRUE06031407
060315                         WHEN AC-ASSIGNMENT-CODE (AC-INDEX) =     06031513
060316                                   PV-JD-ASSIGNMENT-EXCP-CODE     06031615
060317                             SET PS-ASSIGNMENT-CODE-FOUND TO TRUE 06031707
060318                     END-SEARCH                                   06031807
060319                 ELSE                                             06031907
060320                     SET PS-ASSIGNMENT-CODE-NOT-FOUND TO TRUE     06032007
060321                 END-IF                                           06032107
060322                 IF (PS-ASSIGNMENT-CODE-FOUND)                    06032215
060323                     SEARCH ALL AG-ASSIGNMENT-GROUP-ENTRY         06032307
060324                         AT END                                   06032407
060325                             SET PS-ASSIGN-CODE-GRP-NOT-FOUND TO  06032507
060326                                                              TRUE06032607
060327                         WHEN AG-ASSIGNMENT-GROUP (AG-INDEX) =    06032707
060328                                   AC-ASSIGNMENT-GROUP (AC-INDEX) 06032813
060329                             SET PS-ASSIGN-CODE-GRP-FOUND TO TRUE 06032907
060330                 END-SEARCH                                       06033007
060331                 ELSE                                             06033107
060332                     SET PS-ASSIGN-CODE-GRP-NOT-FOUND TO TRUE     06033207
060333                 END-IF                                           06033307
060334             END-IF                                               06033407
060335*                                                                 06033518
060336*  EVALUATE ASSIGNMENT RULES FOR THIS JOB NAME.  SKIP REVIEW OF   06033618
060337*  THE JOB DOCUMENTATION TEMPLATE, SINCE IT WILL HAVE AN UNFILLED 06033718
060338*  ENTRY BLANK FOR ALL DETAILS.                                   06033818
060339*                                                                 06033918
060340             EVALUATE TRUE                                        06034007
060341                 WHEN (PV-JC-TEMPLATE-MEMBER)                     06034113
060342                     CONTINUE                                     06034213
060343                 WHEN ((PV-JD-DEFAULT-ASSIGNMENT) AND             06034313
060344                         (PS-SYSID-DFLT-GROUP-NOT-FOUND))         06034413
060345                     IF (PS-SYSID-DFLT-NOT-FOUND)                 06034513
060346                         INITIALIZE EN-EMAIL-NOTICE-RECORD        06034613
060347                         STRING PV-JOB-DOC-MEMBER-NAME            06034713
060348                                                 DELIMITED BY SIZE06034813
060349                                ' HAS NO SYSTEM ID DEFAULT '      06034913
060350                                                 DELIMITED BY SIZE06035013
060351                                'ASSIGNMENT GROUP FOR SYSTEM ID ' 06035113
060352                                                 DELIMITED BY SIZE06035213
060353                                PV-JD-SYSTEM-ID  DELIMITED BY SIZE06035313
060354                             INTO EN-EMAIL-NOTICE-RECORD          06035413
060355                         PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD   06035513
060356                     ELSE                                         06035613
060357                         INITIALIZE EN-EMAIL-NOTICE-RECORD        06035713
060358                         STRING 'SYSTEM ID '     DELIMITED BY SIZE06035813
060359                                PV-JD-SYSTEM-ID  DELIMITED BY SIZE06035913
060360                                ' IS USED AND HAS AN INVALID '    06036014
060361                                                 DELIMITED BY SIZE06036113
060362                                'DEFAULT GROUP "'                 06036213
060363                                                 DELIMITED BY SIZE06036313
060364                                SI-ASSIGNMENT-GROUP (SI-INDEX)    06036413
060365                                                 DELIMITED BY '  '06036513
060366                                '"'              DELIMITED BY SIZE06036613
060367                            INTO EN-EMAIL-NOTICE-RECORD           06036713
060368                        PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD    06036813
060369                     END-IF                                       06036908
060370                 WHEN (PV-JD-DEFAULT-ASSIGNMENT)                  06037008
060371                     CONTINUE                                     06037108
060372                 WHEN (PS-ASSIGNMENT-GROUP-FOUND)                 06037208
060373                     CONTINUE                                     06037308
060374                 WHEN (PS-ASSIGN-CODE-GRP-FOUND)                  06037408
060375                     CONTINUE                                     06037508
060376                 WHEN OTHER                                       06037608
060377                     IF (PS-ASSIGNMENT-CODE-FOUND)                06037708
060378                         STRING 'ASSIGNMENT CODE '                06037808
060379                                                 DELIMITED BY SIZE06037908
060380                                PV-JD-ASSIGNMENT-GROUP            06038008
060381                                                 DELIMITED BY '  '06038108
060382                                ' IS USED AND HAS AN INVALID '    06038214
060383                                                 DELIMITED BY SIZE06038308
060384                                'ASSIGNMENT GROUP "'              06038411
060385                                                 DELIMITED BY SIZE06038511
060386                                AC-ASSIGNMENT-GROUP (AC-INDEX)    06038613
060387                                                 DELIMITED BY '  '06038711
060388                                '"'              DELIMITED BY SIZE06038811
060389                             INTO EN-EMAIL-NOTICE-RECORD          06038911
060390                         PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD   06039011
060391                     ELSE                                         06039111
060392                         INITIALIZE EN-EMAIL-NOTICE-RECORD        06039211
060393                         STRING PV-JOB-DOC-MEMBER-NAME            06039311
060394                                                 DELIMITED BY SIZE06039411
060395                                ' HAS AN INVALID ASSIGNMENT GROUP'06039511
060396                                                 DELIMITED BY SIZE06039611
060397                                ' OR CODE "'     DELIMITED BY SIZE06039711
060398                                PV-LAST-ASSIGNMENT-GROUP          06039811
060399                                                 DELIMITED BY '  '06039911
060400                                '"'              DELIMITED BY SIZE06040011
060401                            INTO EN-EMAIL-NOTICE-RECORD           06040111
060402                        PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD    06040211
060410                     END-IF                                       06041008
060500             END-EVALUATE                                         06050008
060600     END-EVALUATE.                                                06060005
060900                                                                  06090000
060910     PERFORM 7000-READ-JOB-DOC-FILE.                              06091004
061100*2000-EXIT.                                                       06110005
069580                                                                  06958000
069581******************************************************************06958100
069582*  CHECK OVERALL INTEGRITY OF THE SUPPORTING ASSIGNMENT FILES.   *06958218
069583*  VERIFY THAT ALL CALL LIST SYSTEM ID DEFAULT ASSIGNMENT GROUPS *06958318
069584*  ARE VALID.  VERIFY THAT ALL CALL LIST ASSIGNMENT EXCEPTIONS   *06958418
069585*  USE VALID ASSIGNMENT GROUPS.  VERIFY ALL ASSIGNMENT GROUPS    *06958519
069586*  USED IN OVERDUE OR AD HOC INCIDENTS ARE SYNTACTICALLY CORRECT *06958635
069587*  AND VALID.                                                    *06958734
069588******************************************************************06958834
069589                                                                  06958934
069590 3000-CHECK-INTEGRITY.                                            06959034
069591     PERFORM                                                      06959134
069592             VARYING SI-INDEX                                     06959234
069593             FROM 1 BY 1                                          06959334
069600             UNTIL (SI-INDEX > PV-SYSID-DEFAULT-COUNT)            06960018
069609         SEARCH ALL AG-ASSIGNMENT-GROUP-ENTRY                     06960911
069610             AT END                                               06961011
069611                 SET PS-SYSID-DFLT-GROUP-NOT-FOUND TO TRUE        06961111
069613             WHEN AG-ASSIGNMENT-GROUP (AG-INDEX) =                06961311
069614                                   SI-ASSIGNMENT-GROUP (SI-INDEX) 06961411
069615                 SET PS-SYSID-DFLT-GROUP-FOUND TO TRUE            06961511
069616         END-SEARCH                                               06961611
069617         IF (PS-SYSID-DFLT-GROUP-NOT-FOUND)                       06961711
069618             INITIALIZE EN-EMAIL-NOTICE-RECORD                    06961811
069619             STRING 'SYSTEM ID '                 DELIMITED BY SIZE06961911
069620                    SI-SYSTEM-ID (SI-INDEX)      DELIMITED BY SIZE06962013
069621                    ' HAS AN INVALID DEFAULT GROUP "'             06962114
069622                                                 DELIMITED BY SIZE06962211
069623                    SI-ASSIGNMENT-GROUP (SI-INDEX)                06962311
069624                                                 DELIMITED BY '  '06962411
069625                    '"'                          DELIMITED BY SIZE06962511
069626                 INTO EN-EMAIL-NOTICE-RECORD                      06962611
069627             PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD               06962711
069628         END-IF                                                   06962811
069629     END-PERFORM.                                                 06962912
069630                                                                  06963013
069631     PERFORM                                                      06963113
069640             VARYING AE-INDEX                                     06964013
069650             FROM 1 BY 1                                          06965013
069660             UNTIL (AE-INDEX > PV-ASSIGNMENT-EXCP-COUNT)          06966013
069670         SEARCH ALL AG-ASSIGNMENT-GROUP-ENTRY                     06967013
069680             AT END                                               06968013
069690                 SET PS-ASSIGN-EXCP-GRP-NOT-FOUND TO TRUE         06969013
069700             WHEN AG-ASSIGNMENT-GROUP (AG-INDEX) =                06970013
069710                                   AE-ASSIGNMENT-GROUP (AE-INDEX) 06971013
069720                 SET PS-ASSIGN-EXCP-GRP-FOUND TO TRUE             06972016
069721         END-SEARCH                                               06972113
069722         IF (PS-ASSIGN-EXCP-GRP-NOT-FOUND)                        06972213
069734             INITIALIZE EN-EMAIL-NOTICE-RECORD                    06973413
069735             STRING 'ASSIGNMENT EXCP '           DELIMITED BY SIZE06973513
069736                    AE-ASSIGNMENT-CODE (AE-INDEX)                 06973613
069737                                                 DELIMITED BY SIZE06973713
069738                    '/'                          DELIMITED BY SIZE06973813
069739                    AE-JOB-NAME-SUFFIX (AE-INDEX)                 06973913
069740                                                 DELIMITED BY SIZE06974013
069741                    ' HAS AN INVALID ASSIGNMENT GROUP "'          06974114
069742                                                 DELIMITED BY SIZE06974213
069743                    AE-ASSIGNMENT-GROUP (AE-INDEX)                06974313
069744                                                 DELIMITED BY '  '06974413
069745                    '"'                          DELIMITED BY SIZE06974513
069746                 INTO EN-EMAIL-NOTICE-RECORD                      06974613
069747             PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD               06974713
069754         END-IF                                                   06975413
069755     END-PERFORM.                                                 06975513
069756                                                                  06975619
069757     PERFORM 3100-CHECK-OVERDUE-INCIDENTS.                        06975719
069758                                                                  06975838
069759     PERFORM 3200-CHECK-ADHOC-INCIDENTS.                          06975938
069760*3000-EXIT.                                                       06976038
069761                                                                  06976138
069762******************************************************************06976238
069763*  CHECK THE INTEGRITY OF THE ASSIGNMENT GROUP VARIABLE SETUP    *06976338
069764*  AND ASSIGNMENT GROUP REFERENCES IN THE OVERDUE INCIDENT       *06976438
069765*  APPLICATION.  READ THROUGH THE APPLICATION DEFINITION.  FOR   *06976538
069766*  EACH ASSIGNMENT GROUP VARIABLE REFERENCE, MAKE SURE THE       *06976638
069767*  SYNTAX IS AS IS REQUESTED FOR STANDARD SETUP.  FOR CORRECT    *06976738
069768*  VARIABLE DEFINITIONS, VERIFY THAT THE REQUESTED ASSIGNMENT    *06976838
069769*  GROUP IS VALID.                                               *06976938
069770******************************************************************06977038
069771                                                                  06977138
069772 3100-CHECK-OVERDUE-INCIDENTS.                                    06977238
069773     OPEN INPUT  OVERDUE-INCIDENT-FILE.                           06977338
069774                                                                  06977438
069775     COMPUTE PV-INC-ASSIGN-GRP-CONSTANT-LOC =                     06977540
069776             ((LENGTH OF PC-INCIDENT-ASSIGN-GRP-VAR) +            06977640
069777             (LENGTH OF PC-INCIDENT-ASSIGN-GRP-EQ) +              06977740
069778             (LENGTH OF PC-INCIDENT-ASSIGN-GRP-STR) + 1).         06977840
069779                                                                  06977940
069780     PERFORM 7400-READ-OVERDUE-INC-FILE.                          06978040
069781                                                                  06978140
069782     PERFORM                                                      06978240
069783             UNTIL (PS-END-OF-OVERDUE-INC-FILE)                   06978340
069784                                                                  06978440
069785         INITIALIZE PV-UNSTRING-POINTER                           06978540
069786         INSPECT PV-INCIDENT-APPL-RECORD                          06978640
069787             TALLYING PV-UNSTRING-POINTER                         06978740
069788             FOR LEADING SPACES                                   06978840
069789         ADD +1 TO PV-UNSTRING-POINTER                            06978940
069790                                                                  06979040
069791         IF ((PV-UNSTRING-POINTER +                               06979140
069792                 (LENGTH OF PC-INCIDENT-ASSIGN-GRP-VAR)) <        06979240
069793                 (LENGTH OF PV-INCIDENT-APPL-RECORD))             06979340
069794             IF (PV-INCIDENT-APPL-RECORD(PV-UNSTRING-POINTER:     06979440
069795                     (LENGTH OF PC-INCIDENT-ASSIGN-GRP-VAR)) =    06979540
069796                     PC-INCIDENT-ASSIGN-GRP-VAR)                  06979640
069797                 SET PS-NO-OVERDUE-WARNING TO TRUE                06979740
069798                 COMPUTE PV-UNSTRING-POINTER =                    06979840
069799                     (PV-UNSTRING-POINTER +                       06979940
069800                     (LENGTH OF PC-INCIDENT-ASSIGN-GRP-VAR))      06980040
069801                 IF (PV-INCIDENT-APPL-RECORD                      06980140
069802                                  (PV-UNSTRING-POINTER:1) NOT =   06980240
069803                                  PC-INCIDENT-ASSIGN-GRP-EQ)      06980340
069804                     SET PS-OVERDUE-WARNING TO TRUE               06980440
069805                     INITIALIZE EN-EMAIL-NOTICE-RECORD            06980540
069806                     STRING 'OVERDUE '           DELIMITED BY SIZE06980640
069807                            PC-INCIDENT-ASSIGN-GRP-VAR            06980740
069808                                                 DELIMITED BY SIZE06980840
069809                            ' VARIABLE SETUP ERROR AS '           06980940
069810                                                 DELIMITED BY SIZE06981040
069811                            PV-INCIDENT-APPL-RECORD               06981140
069812                                                 DELIMITED BY SIZE06981240
069820                         INTO EN-EMAIL-NOTICE-RECORD              06982028
069821                     PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD       06982128
069822                 END-IF                                           06982228
069823                 IF (PS-NO-OVERDUE-WARNING)                       06982328
069824                     ADD +1 TO PV-UNSTRING-POINTER                06982428
069825                     IF (PV-INCIDENT-APPL-RECORD                  06982535
069826                                  (PV-UNSTRING-POINTER:1) NOT =   06982628
069827                                  PC-INCIDENT-ASSIGN-GRP-STR)     06982734
069828                         SET PS-OVERDUE-WARNING TO TRUE           06982828
069829                         INITIALIZE EN-EMAIL-NOTICE-RECORD        06982928
069830                         STRING 'OVERDUE '       DELIMITED BY SIZE06983031
069831                                PC-INCIDENT-ASSIGN-GRP-VAR        06983134
069832                                                 DELIMITED BY SIZE06983228
069833                                ' VARIABLE SETUP ERROR AS '       06983328
069834                                                 DELIMITED BY SIZE06983428
069835                                PV-INCIDENT-APPL-RECORD           06983535
069836                                                 DELIMITED BY SIZE06983628
069837                             INTO EN-EMAIL-NOTICE-RECORD          06983728
069838                         PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD   06983828
069839                     END-IF                                       06983928
069840                 END-IF                                           06984028
069841                 IF (PS-NO-OVERDUE-WARNING)                       06984128
069842                     ADD +1 TO PV-UNSTRING-POINTER                06984228
069843                     INITIALIZE PV-QUOTE-COUNT                    06984333
069844                                PV-QUOTE-POINTER                  06984433
069845                     INSPECT PV-INCIDENT-APPL-RECORD(             06984535
069846                        PV-UNSTRING-POINTER:                      06984633
069847                        ((LENGTH OF PV-INCIDENT-APPL-RECORD) -    06984737
069848                        PV-UNSTRING-POINTER + 1))                 06984833
069849                         TALLYING PV-QUOTE-COUNT                  06984933
069850                         FOR ALL PC-INCIDENT-ASSIGN-GRP-STR       06985034
069851                     INSPECT PV-INCIDENT-APPL-RECORD(             06985135
069852                        PV-UNSTRING-POINTER:                      06985232
069853                        ((LENGTH OF PV-INCIDENT-APPL-RECORD) -    06985337
069854                        PV-UNSTRING-POINTER + 1))                 06985432
069855                         TALLYING PV-QUOTE-POINTER                06985532
069856                         FOR CHARACTERS BEFORE INITIAL            06985632
069857                                     PC-INCIDENT-ASSIGN-GRP-STR   06985734
069863                     IF (PV-QUOTE-COUNT NOT = 1)                  06986332
069864                         SET PS-OVERDUE-WARNING TO TRUE           06986432
069865                         INITIALIZE EN-EMAIL-NOTICE-RECORD        06986532
069866                         STRING 'OVERDUE '       DELIMITED BY SIZE06986632
069867                                PC-INCIDENT-ASSIGN-GRP-VAR        06986734
069868                                                 DELIMITED BY SIZE06986832
069869                                ' VARIABLE SETUP ERROR AS '       06986932
069870                                                 DELIMITED BY SIZE06987032
069871                                PV-INCIDENT-APPL-RECORD           06987135
069872                                                 DELIMITED BY SIZE06987232
069873                             INTO EN-EMAIL-NOTICE-RECORD          06987332
069874                         PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD   06987432
069875                     ELSE                                         06987532
069876                         MOVE PV-INCIDENT-APPL-RECORD(            06987635
069877                                   PV-UNSTRING-POINTER:           06987732
069878                                   (PV-QUOTE-POINTER)) TO         06987833
069879                                   PV-INCIDENT-ASSIGNMENT-GROUP   06987934
069882                         SEARCH ALL AG-ASSIGNMENT-GROUP-ENTRY     06988232
069883                             AT END                               06988332
069884                                 SET PS-ASSIGNMENT-GROUP-NOT-FOUND06988432
069885                                                           TO TRUE06988532
069886                             WHEN AG-ASSIGNMENT-GROUP (AG-INDEX) =06988632
069887                                   PV-INCIDENT-ASSIGNMENT-GROUP   06988734
069888                                 SET PS-ASSIGNMENT-GROUP-FOUND    06988832
069889                                                           TO TRUE06988932
069890                         END-SEARCH                               06989032
069900                         IF (PS-ASSIGNMENT-GROUP-NOT-FOUND)       06990043
069901*                                                                 06990143
069902* EXEMPT THE SETTING OF THE DEFAULT VALUE IN THE APPLICATION      06990243
069903*                                                                 06990343
069904                          IF ((PV-INCIDENT-ASSIGNMENT-GROUP =     06990443
069905                                                           SPACES)06990543
069906                                 AND (PV-UNSTRING-POINTER =       06990643
069907                                  PV-INC-ASSIGN-GRP-CONSTANT-LOC))06990743
069908                            CONTINUE                              06990843
069909                          ELSE                                    06990943
069910                            SET PS-OVERDUE-WARNING TO TRUE        06991043
069911                            INITIALIZE EN-EMAIL-NOTICE-RECORD     06991143
069912                            STRING 'ADHOC '   DELIMITED BY SIZE   06991243
069913                                   PC-INCIDENT-ASSIGN-GRP-VAR     06991343
069914                                                 DELIMITED BY SIZE06991443
069915                                   ' GROUP NOT FOUND - '          06991543
069916                                                 DELIMITED BY SIZE06991643
069917                                   PV-INCIDENT-ASSIGNMENT-GROUP   06991743
069918                                                 DELIMITED BY SIZE06991843
069919                                INTO EN-EMAIL-NOTICE-RECORD       06991943
069920                            PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD06992043
069921                           END-IF                                 06992143
069922                         END-IF                                   06992243
069923                     END-IF                                       06992332
069924                 END-IF                                           06992432
069925             END-IF                                               06992532
069926         END-IF                                                   06992632
069927                                                                  06992732
069928         PERFORM 7400-READ-OVERDUE-INC-FILE                       06992832
069929     END-PERFORM.                                                 06992932
069930                                                                  06993032
069931     CLOSE OVERDUE-INCIDENT-FILE.                                 06993132
069932*3100-EXIT.                                                       06993232
069933                                                                  06993332
069934******************************************************************06993434
069935*  CHECK THE INTEGRITY OF THE ASSIGNMENT GROUP VARIABLE SETUP    *06993534
069936*  AND ASSIGNMENT GROUP REFERENCES IN THE AD HOC INCIDENT        *06993634
069937*  APPLICATION.  READ THROUGH THE APPLICATION DEFINITION.  FOR   *06993734
069938*  EACH ASSIGNMENT GROUP VARIABLE REFERENCE, MAKE SURE THE       *06993834
069939*  SYNTAX IS AS IS REQUESTED FOR STANDARD SETUP.  FOR CORRECT    *06993934
069940*  VARIABLE DEFINITIONS, VERIFY THAT THE REQUESTED ASSIGNMENT    *06994034
069941*  GROUP IS VALID.                                               *06994134
069942******************************************************************06994234
069943                                                                  06994334
069944 3200-CHECK-ADHOC-INCIDENTS.                                      06994434
069945     OPEN INPUT  ADHOC-INCIDENT-FILE.                             06994534
069946                                                                  06994634
069947     COMPUTE PV-INC-ASSIGN-GRP-CONSTANT-LOC =                     06994741
069948             ((LENGTH OF PC-INCIDENT-ASSIGN-GRP-VAR) +            06994841
069949             (LENGTH OF PC-INCIDENT-ASSIGN-GRP-EQ) +              06994941
069950             (LENGTH OF PC-INCIDENT-ASSIGN-GRP-STR) + 1).         06995041
069951                                                                  06995141
069952     PERFORM 7500-READ-ADHOC-INC-FILE.                            06995234
069953                                                                  06995334
069954     PERFORM                                                      06995434
069955             UNTIL (PS-END-OF-ADHOC-INC-FILE)                     06995534
069956                                                                  06995634
069957         INITIALIZE PV-UNSTRING-POINTER                           06995734
069958         INSPECT PV-INCIDENT-APPL-RECORD                          06995836
069959             TALLYING PV-UNSTRING-POINTER                         06995934
069960             FOR LEADING SPACES                                   06996034
069961         ADD +1 TO PV-UNSTRING-POINTER                            06996134
069962                                                                  06996234
069963         IF ((PV-UNSTRING-POINTER +                               06996334
069964                 (LENGTH OF PC-INCIDENT-ASSIGN-GRP-VAR)) <        06996436
069965                 (LENGTH OF PV-INCIDENT-APPL-RECORD))             06996535
069966             IF (PV-INCIDENT-APPL-RECORD(PV-UNSTRING-POINTER:     06996635
069967                     (LENGTH OF PC-INCIDENT-ASSIGN-GRP-VAR)) =    06996734
069968                     PC-INCIDENT-ASSIGN-GRP-VAR)                  06996834
069969                 SET PS-NO-OVERDUE-WARNING TO TRUE                06996934
069970                 COMPUTE PV-UNSTRING-POINTER =                    06997034
069971                     (PV-UNSTRING-POINTER +                       06997134
069972                     (LENGTH OF PC-INCIDENT-ASSIGN-GRP-VAR))      06997234
069973                 IF (PV-INCIDENT-APPL-RECORD                      06997335
069974                                  (PV-UNSTRING-POINTER:1) NOT =   06997434
069975                                  PC-INCIDENT-ASSIGN-GRP-EQ)      06997534
069976                     SET PS-OVERDUE-WARNING TO TRUE               06997634
069977                     INITIALIZE EN-EMAIL-NOTICE-RECORD            06997734
069978                     STRING 'ADHOC '             DELIMITED BY SIZE06997834
069979                            PC-INCIDENT-ASSIGN-GRP-VAR            06997934
069980                                                 DELIMITED BY SIZE06998034
069981                            ' VARIABLE SETUP ERROR AS '           06998134
069982                                                 DELIMITED BY SIZE06998234
069983                            PV-INCIDENT-APPL-RECORD               06998335
069984                                                 DELIMITED BY SIZE06998434
069985                         INTO EN-EMAIL-NOTICE-RECORD              06998534
069986                     PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD       06998634
069987                 END-IF                                           06998734
069988                 IF (PS-NO-OVERDUE-WARNING)                       06998834
069989                     ADD +1 TO PV-UNSTRING-POINTER                06998934
069990                     IF (PV-INCIDENT-APPL-RECORD                  06999035
069991                                  (PV-UNSTRING-POINTER:1) NOT =   06999134
069992                                  PC-INCIDENT-ASSIGN-GRP-STR)     06999234
069993                         SET PS-OVERDUE-WARNING TO TRUE           06999334
069994                         INITIALIZE EN-EMAIL-NOTICE-RECORD        06999434
069995                         STRING 'ADHOC '         DELIMITED BY SIZE06999534
069996                                PC-INCIDENT-ASSIGN-GRP-VAR        06999634
069997                                                 DELIMITED BY SIZE06999734
069998                                ' VARIABLE SETUP ERROR AS '       06999834
069999                                                 DELIMITED BY SIZE06999934
070000                                PV-INCIDENT-APPL-RECORD           07000035
070001                                                 DELIMITED BY SIZE07000134
070002                             INTO EN-EMAIL-NOTICE-RECORD          07000234
070003                         PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD   07000334
070004                     END-IF                                       07000434
070005                 END-IF                                           07000534
070006                 IF (PS-NO-OVERDUE-WARNING)                       07000634
070007                     ADD +1 TO PV-UNSTRING-POINTER                07000734
070008                     INITIALIZE PV-QUOTE-COUNT                    07000834
070009                                PV-QUOTE-POINTER                  07000934
070010                     INSPECT PV-INCIDENT-APPL-RECORD(             07001035
070011                        PV-UNSTRING-POINTER:                      07001134
070012                        ((LENGTH OF PV-INCIDENT-APPL-RECORD) -    07001237
070013                        PV-UNSTRING-POINTER + 1))                 07001334
070014                         TALLYING PV-QUOTE-COUNT                  07001434
070015                         FOR ALL PC-INCIDENT-ASSIGN-GRP-STR       07001534
070016                     INSPECT PV-INCIDENT-APPL-RECORD(             07001635
070017                        PV-UNSTRING-POINTER:                      07001734
070018                        ((LENGTH OF PV-INCIDENT-APPL-RECORD) -    07001837
070019                        PV-UNSTRING-POINTER + 1))                 07001934
070020                         TALLYING PV-QUOTE-POINTER                07002034
070021                         FOR CHARACTERS BEFORE INITIAL            07002134
070022                                     PC-INCIDENT-ASSIGN-GRP-STR   07002234
070023                     IF (PV-QUOTE-COUNT NOT = 1)                  07002334
070024                         SET PS-OVERDUE-WARNING TO TRUE           07002434
070025                         INITIALIZE EN-EMAIL-NOTICE-RECORD        07002534
070026                         STRING 'ADHOC '         DELIMITED BY SIZE07002634
070027                                PC-INCIDENT-ASSIGN-GRP-VAR        07002734
070028                                                 DELIMITED BY SIZE07002834
070029                                ' VARIABLE SETUP ERROR AS '       07002934
070030                                                 DELIMITED BY SIZE07003034
070031                                PV-INCIDENT-APPL-RECORD           07003135
070032                                                 DELIMITED BY SIZE07003234
070033                             INTO EN-EMAIL-NOTICE-RECORD          07003334
070034                         PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD   07003434
070035                     ELSE                                         07003534
070036                         MOVE PV-INCIDENT-APPL-RECORD(            07003635
070037                                   PV-UNSTRING-POINTER:           07003734
070038                                   (PV-QUOTE-POINTER)) TO         07003834
070039                                   PV-INCIDENT-ASSIGNMENT-GROUP   07003934
070040                         SEARCH ALL AG-ASSIGNMENT-GROUP-ENTRY     07004034
070041                             AT END                               07004134
070042                                 SET PS-ASSIGNMENT-GROUP-NOT-FOUND07004234
070043                                                           TO TRUE07004334
070044                             WHEN AG-ASSIGNMENT-GROUP (AG-INDEX) =07004434
070045                                   PV-INCIDENT-ASSIGNMENT-GROUP   07004534
070046                                 SET PS-ASSIGNMENT-GROUP-FOUND    07004634
070047                                                           TO TRUE07004734
070048                         END-SEARCH                               07004834
070049                         IF (PS-ASSIGNMENT-GROUP-NOT-FOUND)       07004942
070050*                                                                 07005042
070051* EXEMPT THE SETTING OF THE DEFAULT VALUE IN THE APPLICATION      07005142
070052*                                                                 07005242
070053                          IF ((PV-INCIDENT-ASSIGNMENT-GROUP =     07005342
070054                                                           SPACES)07005442
070055                                 AND (PV-UNSTRING-POINTER =       07005542
070056                                  PV-INC-ASSIGN-GRP-CONSTANT-LOC))07005641
070057                            CONTINUE                              07005742
070058                          ELSE                                    07005842
070059                            SET PS-OVERDUE-WARNING TO TRUE        07005942
070060                            INITIALIZE EN-EMAIL-NOTICE-RECORD     07006042
070061                            STRING 'ADHOC '   DELIMITED BY SIZE   07006142
070062                                   PC-INCIDENT-ASSIGN-GRP-VAR     07006242
070063                                                 DELIMITED BY SIZE07006334
070064                                   ' GROUP NOT FOUND - '          07006442
070065                                                 DELIMITED BY SIZE07006534
070066                                   PV-INCIDENT-ASSIGNMENT-GROUP   07006642
070067                                                 DELIMITED BY SIZE07006734
070068                                INTO EN-EMAIL-NOTICE-RECORD       07006842
070069                            PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD07006934
070070                           END-IF                                 07007042
070071                         END-IF                                   07007142
070072                     END-IF                                       07007242
070073                 END-IF                                           07007342
070074             END-IF                                               07007442
070075         END-IF                                                   07007542
070076                                                                  07007642
070077         PERFORM 7500-READ-ADHOC-INC-FILE                         07007742
070078     END-PERFORM.                                                 07007842
070079                                                                  07007942
070080     CLOSE ADHOC-INCIDENT-FILE.                                   07008042
070081*3200-EXIT.                                                       07008142
070082                                                                  07008242
070083******************************************************************07008342
070084*  READ A JOB DOCUMENTATION LINE.                                *07008442
070085******************************************************************07008542
070086                                                                  07008642
070087 7000-READ-JOB-DOC-FILE.                                          07008742
070088     READ JOB-DOCUMENTATION-FILE                                  07008842
070089         INTO PV-JOB-DOC-UNLOAD-RECORD                            07008942
070090         AT END                                                   07009042
070091             SET PS-END-OF-JOB-DOC-FILE TO TRUE                   07009142
070092             SUBTRACT +1 FROM PT-JOB-DOC-LINES-READ               07009242
070093     END-READ.                                                    07009342
070094                                                                  07009442
070095     ADD +1 TO PT-JOB-DOC-LINES-READ.                             07009542
070096*7000-EXIT.                                                       07009642
070097                                                                  07009734
070100******************************************************************07010000
070200*  READ A SYSTEM ID DEFAULT ASSIGNMENT GROUP RECORD.             *07020000
070300******************************************************************07030000
070400                                                                  07040000
070500 7100-READ-SYSID-DFLT-FILE.                                       07050000
070600     READ SYSTEM-ID-DEFAULT-FILE                                  07060000
070700         INTO CM004-SYSID-DFLT-GROUP-RECORD                       07070000
070800         AT END                                                   07080000
070900             SET PS-END-OF-SYSID-DFLT-FILE TO TRUE                07090000
071000             SUBTRACT +1 FROM PT-SYSID-DFLT-RECORDS-READ          07100000
071100     END-READ.                                                    07110000
071200                                                                  07120000
071300     ADD +1 TO PT-SYSID-DFLT-RECORDS-READ.                        07130000
071400*7100-EXIT.                                                       07140000
071500                                                                  07150000
071600******************************************************************07160000
071700*  READ A VALID ASSIGNMENT GROUP RECORD.                         *07170000
071800******************************************************************07180000
071900                                                                  07190000
072000 7200-READ-ASSIGN-GRP-FILE.                                       07200000
072100     READ ASSIGNMENT-GROUP-FILE                                   07210000
072200         INTO PV-ASSIGNMENT-GROUP-RECORD                          07220000
072300         AT END                                                   07230000
072400             SET PS-END-OF-ASSIGN-GRP-FILE TO TRUE                07240000
072500             SUBTRACT +1 FROM PT-ASSIGN-GRP-RECORDS-READ          07250000
072600     END-READ.                                                    07260000
072700                                                                  07270000
072800     ADD +1 TO PT-ASSIGN-GRP-RECORDS-READ.                        07280000
072900*7200-EXIT.                                                       07290000
073000                                                                  07300000
073100******************************************************************07310000
073200*  READ A CALL LIST ASSIGNMENT EXCEPTIONS BY JOB SUFFIX RECORD.  *07320000
073300******************************************************************07330000
073400                                                                  07340000
073500 7300-READ-ASSIGN-EXCP-FILE.                                      07350000
073600     READ ASSIGNMENT-EXCP-FILE                                    07360000
073700         INTO CM005-ASSIGNMENT-EXCP-RECORD                        07370000
073800         AT END                                                   07380000
073900             SET PS-END-OF-ASSIGN-EXCP-FILE TO TRUE               07390000
074000             SUBTRACT +1 FROM PT-ASSIGN-EXCP-RECORDS-READ         07400000
074100     END-READ.                                                    07410000
074200                                                                  07420000
074300     ADD +1 TO PT-ASSIGN-EXCP-RECORDS-READ.                       07430000
074400*7300-EXIT.                                                       07440000
074500                                                                  07450000
074600******************************************************************07460002
074700*  READ AN OVERDUE INCIDENT APPLICATION DEFINITION RECORD.       *07470035
074800******************************************************************07480002
074900                                                                  07490002
075000 7400-READ-OVERDUE-INC-FILE.                                      07500019
075001     READ OVERDUE-INCIDENT-FILE                                   07500119
075002         INTO PV-INCIDENT-APPL-RECORD                             07500235
075003         AT END                                                   07500319
075004             SET PS-END-OF-OVERDUE-INC-FILE TO TRUE               07500419
075005             SUBTRACT +1 FROM PT-OVERDUE-INC-RECORDS-READ         07500519
075006     END-READ.                                                    07500619
075007                                                                  07500719
075008     ADD +1 TO PT-OVERDUE-INC-RECORDS-READ.                       07500819
075010*7400-EXIT.                                                       07501019
075011                                                                  07501135
075012******************************************************************07501235
075013*  READ AN AD HOC INCIDENT APPLICATION DEFINITION RECORD.        *07501335
075014******************************************************************07501435
075015                                                                  07501535
075016 7500-READ-ADHOC-INC-FILE.                                        07501635
075017     READ ADHOC-INCIDENT-FILE                                     07501735
075018         INTO PV-INCIDENT-APPL-RECORD                             07501835
075019         AT END                                                   07501935
075020             SET PS-END-OF-ADHOC-INC-FILE TO TRUE                 07502035
075021             SUBTRACT +1 FROM PT-ADHOC-INC-RECORDS-READ           07502135
075022     END-READ.                                                    07502235
075023                                                                  07502335
075024     ADD +1 TO PT-OVERDUE-INC-RECORDS-READ.                       07502435
075025*7500-EXIT.                                                       07502535
075026                                                                  07502635
075030******************************************************************07503019
075040*  WRITE AN E-MAIL NOTICE RECORD.                                *07504019
075050******************************************************************07505019
075060                                                                  07506019
075070 8000-WRITE-EMAIL-NOTICE-RECORD.                                  07507019
075100     WRITE EN-EMAIL-NOTICE-RECORD.                                07510002
075101                                                                  07510102
075110     ADD +1 TO PT-EMAIL-NOTICE-RCDS-WRITTEN.                      07511002
075200*8000-EXIT.                                                       07520002
077100                                                                  07710000
077200******************************************************************07720000
077300*  CLOSE ALL FILES.                                              *07730000
077400******************************************************************07740000
077500                                                                  07750000
077600 9000-EOJ-ROUTINE.                                                07760000
077800     CLOSE JOB-DOCUMENTATION-FILE                                 07780003
077810           SYSTEM-ID-DEFAULT-FILE                                 07781003
077820           ASSIGNMENT-GROUP-FILE                                  07782003
077830           ASSIGNMENT-EXCP-FILE                                   07783003
077840           EMAIL-NOTICE-FILE.                                     07784003
077900*9000-EXIT.                                                       07790000
