000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    RCKCS837.                                         00040000
000500 AUTHOR.        LARRY SCHLEICHER.                                 00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  JAN, 2002.                                        00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    E837 - RECEIVING TRACKING LIST PROGRAM.                    * 00110000
001200*                                                               * 00120000
001300*    THIS PROGRAM GENERATES A LIST OF THE RECEIVING TRACKING    * 00130000
001400*    RECORDS THAT WHERE WRITTEN.                                * 00140000
001500*                                                               * 00150000
001600*---------------------------------------------------------------* 00160000
001610* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00161002
001620* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00162003
001630* MAKING THE CALL DYNAMIC VS STATIC.                              00163003
001640*---------------------------------------------------------------* 00164003
001700 EJECT                                                            00170000
001800 ENVIRONMENT DIVISION.                                            00180000
001900                                                                  00190000
002000 DATA DIVISION.                                                   00200000
002100                                                                  00210000
002200 WORKING-STORAGE SECTION.                                         00220000
002300                                                                  00230000
002400 01  DK-DB2-KEYS.                                                 00240000
002500     05  DK-OPER-UNT-ID                 PIC S9(04)  COMP.         00250000
002600     05  DK-PO-NBR                      PIC S9(09)  COMP.         00260000
002700     05  DK-RCVR-SEQ-NBR                PIC S9(09)  COMP.         00270000
002800     05  DK-PO-LNE-NBR                  PIC S9(09)  COMP.         00280000
002900     05  DK-PREPK-ID                    PIC S9(04)  COMP.         00290000
003000     05  DK-CRE-BY-USR-ID               PIC  X(08)  VALUE SPACES. 00300000
003100     05  DK-DATE-FROM-TIMESTAMP         PIC  X(26)  VALUE SPACES. 00310000
003200     05  DK-DATE-TO-TIMESTAMP           PIC  X(26)  VALUE SPACES. 00320000
003300                                                                  00330000
003400 01  PC-PROGRAM-CONSTANTS.                                        00340000
003500     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00350000
003600                                                    'RC837A  '.   00360000
003700     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00370000
003800                                                    'RCKM837 '.   00380000
003900     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00390000
004000                                                    'RCKCS837'.   00400000
004100     05  PC-LOCATION-MODULE             PIC  X(08)  VALUE         00410000
004200                                                    'XLKUT071'.   00420000
004300     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00430000
004400     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00440000
004500     05  PC-INTER-APPL-CODES.                                     00450000
004600         10  PC-INTER-APPL-CRIT-SPEC                              00460000
004700                                  PIC  X(01)  VALUE '1'.          00470000
004800         10  PC-INTER-APPL-LIST   PIC  X(01)  VALUE '2'.          00480000
004900         10  PC-INTER-APPL-CHKIN  PIC  X(01)  VALUE '3'.          00490000
005000     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +13     00500000
005100                                                    COMP SYNC.    00510000
005200     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00520000
005300                                                    COMP SYNC.    00530000
005400     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00540000
005500                                                    +1000000      00550000
005600                                                    COMP-3.       00560000
005700     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00570000
005800                                                    COMP SYNC.    00580000
005900     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00590000
006000     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00600000
006100     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00610000
006200     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00620000
006300     05  PC-01                          PIC  X(02)  VALUE '01'.   00630000
006400     05  PC-FCLTY-ID                    PIC S9(04)  VALUE +1      00640000
006500                                                    COMP.         00650000
006600                                                                  00660000
006700******************************************************************00670000
006800*   SYSTEM MESSAGES                                              *00680000
006900******************************************************************00690000
007000* 00005 - INVALID VALUE                                          *00700000
007100* 00008 - MUST BE NUMERIC                                        *00710000
007200* 00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED    *00720000
007300* 00051 - NO END OF RANGE HAS BEEN SPECIFIED                     *00730000
007400* 00052 - END OF RANGE PRECEDES START OF RANGE                   *00740000
007500* 00053 - NO START OF RANGE HAS BEEN SPECIFIED                   *00750000
007600* 00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED     *00760000
007700* 00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED       *00770000
007800* 00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION         *00780000
007900* 00069 - TOP OF LIST                                            *00790000
008000* 00070 - BOTTOM OF LIST                                         *00800000
008100* 00101 - VALUE MUST BE GREATER THAN ZERO AND LESS THAN 100,000,0*00810000
008200* 00148 - DATA DOES NOT EXIST                                    *00820000
008300* 00279 - MORE ITEMS TO DISPLAY                                  *00830000
008400* 00302 - DATA ENTERED IN THE 'KEY' FIELD IS INVALID             *00840000
008500* 02844 - YOU DO NOT HAVE THE AUTHORITY TO UPDATE RANK           *00850000
008600* 03414 - THIS FUNCTION ONLY AVAILABLE FOR PACKSLIP DELETE TRANSA*00860000
008700* 99901 - INVALID COMMAND WAS ENTERED                            *00870000
008800******************************************************************00880000
008900     05  PC-TSYMSG-NUMBERS.                                       00890000
009000         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00900000
009100         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00910000
009200         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00920000
009300         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00930000
009400         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00940000
009500         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00950000
009600         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00960000
009700         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00970000
009800         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00980000
009900         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00990000
010000         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01000000
010100         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01010000
010200         10  PC-TSYMSG-00148            PIC  9(05)  VALUE 00148.  01020000
010300         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01030000
010400         10  PC-TSYMSG-00302            PIC  9(05)  VALUE 00302.  01040000
010500         10  PC-TSYMSG-02844            PIC  9(05)  VALUE 02844.  01050000
010600         10  PC-TSYMSG-03414            PIC  9(05)  VALUE 03414.  01060000
010700         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01070000
010800*                                                                 01080000
010900 01  PS-PROGRAM-SWITCHES.                                         01090000
011000     05  PS-CURSOR-TYPE-SW              PIC  X(01)  VALUE ' '.    01100000
011100         88  PS-PO-RC-LN-USER                       VALUE 'A'.    01110000
011200         88  PS-PO-RC-PK-US                         VALUE 'B'.    01120000
011300         88  PS-PO-RCVR-LINE                        VALUE 'C'.    01130000
011400         88  PS-PO-RCVR-PACK                        VALUE 'D'.    01140000
011500         88  PS-PO-RCVR-USER                        VALUE 'E'.    01150000
011600         88  PS-PO-RCVR                             VALUE 'F'.    01160000
011700         88  PS-PO-USER                             VALUE 'G'.    01170000
011800         88  PS-PO                                  VALUE 'H'.    01180000
011900         88  PS-USER-DATE                           VALUE 'I'.    01190000
012000         88  PS-USER                                VALUE 'J'.    01200000
012100                                                                  01210000
012200     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01220000
012300         88  PS-NO-ERROR                            VALUE 'Y'.    01230000
012400         88  PS-ERROR                               VALUE 'N'.    01240000
012500                                                                  01250000
012600     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01260000
012700         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01270000
012800         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01280000
012900     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01290000
013000         88  PS-DONE                                VALUE 'Y'.    01300000
013100         88  PS-NOT-DONE                            VALUE 'N'.    01310000
013200     05  PS-END-OF-RANKINGS-SW          PIC  X(01)  VALUE 'N'.    01320000
013300         88  PS-END-OF-RANKINGS                     VALUE 'Y'.    01330000
013400         88  PS-NOT-END-OF-RANKINGS                 VALUE 'N'.    01340000
013500     05  PS-ACCESS-SW                   PIC  X(01)  VALUE 'N'.    01350000
013600         88  PS-ACCESS-ALLOWED                      VALUE 'Y'.    01360000
013700         88  PS-ACCESS-NOT-ALLOWED                  VALUE 'N'.    01370000
013800     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01380000
013900         88  PS-LIST-END                            VALUE  'Y'.   01390000
014000         88  PS-NO-LIST-END                         VALUE  'N'.   01400000
014100     05  PS-UPC-SKU-SW                  PIC  X(01)  VALUE  ' '.   01410000
014200         88  PS-NO-UPC-SKU-FND                      VALUE  'N'.   01420000
014300         88  PS-MULTI-SKU-FND                       VALUE  'M'.   01430000
014400*                                                                 01440000
014500 01  PV-PROGRAM-VARIABLES.                                        01450000
014600     05  PV-UNION-TYPE                  PIC  X(01).               01460000
014700     05  PV-FCLTY-NME                   PIC  X(24)  VALUE SPACES. 01470000
014800     05  PV-CICS-RESPONSE               PIC S9(04)  VALUE +0      01480000
014900                                                    COMP SYNC.    01490000
015000     05  PV-SUB                         PIC S9(04)  VALUE +0      01500000
015100                                                    COMP SYNC.    01510000
015200     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01520000
015300                                                    COMP SYNC.    01530000
015400     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01540000
015500                                                    COMP-3.       01550000
015600     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01560000
015700                                                    COMP-3.       01570000
015800     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01580000
015900                                                    COMP-3.       01590000
016000     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01600000
016100                                                    COMP-3.       01610000
016200     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01620000
016300                                                    COMP-3.       01630000
016400     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01640000
016500                                                    COMP-3.       01650000
016600     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01660000
016700                                                    COMP-3.       01670000
016800     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01680000
016900                                                    COMP SYNC.    01690000
017000     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01700000
017100                                                    COMP SYNC.    01710000
017200     05  PV-ITEM                        PIC S9(04)  VALUE +0      01720000
017300                                                    COMP SYNC.    01730000
017400     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01740000
017500                                                    COMP SYNC.    01750000
017600     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01760000
017700                                                    COMP SYNC.    01770000
017800     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01780000
017900                                                    COMP SYNC.    01790000
018000     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01800000
018100                                                    COMP SYNC.    01810000
018200     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01820000
018300                                                    COMP SYNC.    01830000
018400     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01840000
018500                                                    COMP SYNC.    01850000
018600     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01860000
018700                                                    COMP SYNC.    01870000
018800     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01880000
018900                                                    COMP SYNC.    01890000
019000     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01900000
019100                                                    COMP SYNC.    01910000
019200     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01920000
019300                                                    COMP SYNC.    01930000
019400     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01940000
019500                                                    COMP SYNC.    01950000
019600     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      01960000
019700                                                    COMP SYNC.    01970000
019800     05  PV-OPER-UNIT-ID                PIC ZZZZ.                 01980000
019900     05  PV-PO-RECEIVER.                                          01990000
020000         10  PV-PO-NBR                  PIC ZZZZZZZ9.             02000000
020100         10  PV-DASH                    PIC X(1)  VALUE '-'.      02010000
020200         10  PV-RECEIVER                PIC 999.                  02020000
020300                                                                  02030000
020400         10  PV-RCVR-TEXT-R REDEFINES PV-RECEIVER.                02040000
020500             15  PV-RCVR-NUMBER-3POS         PIC  X(03).          02050000
020600                                                                  02060000
020700     05  PV-CSR-SEQ-DATE                PIC X(10) VALUE SPACES.   02070000
020800                                                                  02080000
020900     05  PV-REQ-DATE.                                             02090000
021000         10  PV-REQ-DATE-MM             PIC 9(02).                02100000
021100         10  FILLER                     PIC X(1)  VALUE '-'.      02110000
021200         10  PV-REQ-DATE-DD             PIC 9(02).                02120000
021300         10  FILLER                     PIC X(1)  VALUE '-'.      02130000
021400         10  PV-REQ-DATE-YY             PIC 9(02).                02140000
021500                                                                  02150000
021600     05  PV-REQ-DATE-MDCY.                                        02160000
021700         10  PV-REQ-DATE-MDCY-MM        PIC 9(02).                02170000
021800         10  FILLER                     PIC X(1)  VALUE '-'.      02180000
021900         10  PV-REQ-DATE-MDCY-DD        PIC 9(02).                02190000
022000         10  FILLER                     PIC X(1)  VALUE '-'.      02200000
022100         10  PV-REQ-DATE-MDCY-CCYY      PIC 9(04).                02210000
022200                                                                  02220000
022300     05  PV-REQ-TIME.                                             02230000
022400         10  PV-REQ-TIME-HR             PIC 9(02).                02240000
022500         10  FILLER                     PIC X(1)  VALUE ':'.      02250000
022600         10  PV-REQ-TIME-MN             PIC 9(02).                02260000
022700         10  FILLER                     PIC X(1)  VALUE ':'.      02270000
022800         10  PV-REQ-TIME-SS             PIC 9(02).                02280000
022900                                                                  02290000
023000     05  PV-FROM-DATE-TIME.                                       02300000
023100         10  PV-FROM-DATE-YY            PIC 9(04).                02310000
023200         10  FILLER                     PIC X(1)  VALUE '-'.      02320000
023300         10  PV-FROM-DATE-MM            PIC 9(02).                02330000
023400         10  FILLER                     PIC X(1)  VALUE '-'.      02340000
023500         10  PV-FROM-DATE-DD            PIC 9(02).                02350000
023600         10  FILLER                     PIC X(16)                 02360000
023700                  VALUE '-00.00.00.000000'.                       02370000
023800     05  PV-TO-DATE-TIME.                                         02380000
023900         10  PV-TO-DATE-YY              PIC 9(04).                02390000
024000         10  FILLER                     PIC X(1)  VALUE '-'.      02400000
024100         10  PV-TO-DATE-MM              PIC 9(02).                02410000
024200         10  FILLER                     PIC X(1)  VALUE '-'.      02420000
024300         10  PV-TO-DATE-DD              PIC 9(02).                02430000
024400         10  FILLER                     PIC X(16)                 02440000
024500                  VALUE '-23.59.59.999999'.                       02450000
024600                                                                  02460000
024700     05  PV-PKG-TYP-1                    PIC X(02)  VALUE SPACES. 02470000
024800         88   PV-PKG-1-BC                           VALUE 'BC'.   02480000
024900         88   PV-PKG-1-PP                           VALUE 'PP'.   02490000
025000         88   PV-PKG-1-PBS                          VALUE 'PS'.   02500000
025100     05  PV-PKG-TYP-2                    PIC X(02)  VALUE SPACES. 02510000
025200         88   PV-PKG-2-BC                           VALUE 'BC'.   02520000
025300         88   PV-PKG-2-PP                           VALUE 'PP'.   02530000
025400         88   PV-PKG-2-PBS                          VALUE 'PS'.   02540000
025500     05  PV-PKG-TYP-3                    PIC X(02)  VALUE SPACES. 02550000
025600         88   PV-PKG-3-BC                           VALUE 'BC'.   02560000
025700         88   PV-PKG-3-PP                           VALUE 'PP'.   02570000
025800         88   PV-PKG-3-PBS                          VALUE 'PS'.   02580000
025900                                                                  02590000
026000     05  PV-PROC-STAT-1                  PIC X(01)  VALUE SPACES. 02600000
026100         88   PV-STAT-1-P                           VALUE 'P'.    02610000
026200         88   PV-STAT-1-F                           VALUE 'F'.    02620000
026300         88   PV-STAT-1-I                           VALUE 'I'.    02630000
026400         88   PV-STAT-1-N                           VALUE 'N'.    02640000
026500     05  PV-PROC-STAT-2                  PIC X(01)  VALUE SPACES. 02650000
026600         88   PV-STAT-2-P                           VALUE 'P'.    02660000
026700         88   PV-STAT-2-F                           VALUE 'F'.    02670000
026800         88   PV-STAT-2-I                           VALUE 'I'.    02680000
026900         88   PV-STAT-2-N                           VALUE 'N'.    02690000
027000     05  PV-PROC-STAT-3                  PIC X(01)  VALUE SPACES. 02700000
027100         88   PV-STAT-3-P                           VALUE 'P'.    02710000
027200         88   PV-STAT-3-F                           VALUE 'F'.    02720000
027300         88   PV-STAT-3-I                           VALUE 'I'.    02730000
027400         88   PV-STAT-3-N                           VALUE 'N'.    02740000
027500     05  PV-PROC-STAT-4                  PIC X(01)  VALUE SPACES. 02750000
027600         88   PV-STAT-4-P                           VALUE 'P'.    02760000
027700         88   PV-STAT-4-F                           VALUE 'F'.    02770000
027800         88   PV-STAT-4-I                           VALUE 'I'.    02780000
027900         88   PV-STAT-4-N                           VALUE 'N'.    02790000
028000                                                                  02800000
028100 01  DN-DB2-NULL-INDICATORS.                                      02810000
028200     05  DN-DEST-OPER-UNT           PIC S9(04) COMP VALUE +0.     02820000
028210     05  DN-PKSL-SEQ-NBR            PIC S9(04) COMP VALUE +0.     02821000
028220     05  DN-PO-LNE-NBR              PIC S9(04) COMP VALUE +0.     02822000
028230     05  DN-PREPK-ID                PIC S9(04) COMP VALUE +0.     02823000
028300                                                                  02830000
028400******************************************************************02840000
028500**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **02850000
028600**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **02860000
028700**  APPLICATION-SPECIFIC COMMAREA.                              **02870000
028800******************************************************************02880000
028900 01  LQW-LIST-QUEUE-WORK-AREA.                                    02890000
029000     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  02900000
029100     05  LQW-ITEM-ENTRIES               OCCURS 13 TIMES           02910000
029200                                        INDEXED BY LQW-IDX.       02920000
029300         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02930000
029400         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               02940000
029500         10  LQW-SELECTED-SW            PIC  X(01).               02950000
029600             88  LQW-SELECT                         VALUE 'S'.    02960000
029700             88  LQW-DESELECT                       VALUE ' '.    02970000
029800         10  LQW-ACTION                 PIC  X(03).               02980000
029900         10  LQW-CSR-IND                PIC  X(01).               02990000
030000*LMM                                                              03000000
030100*****    10  LQW-PO-RECEIVER            PIC  X(12).               03010000
030200         10  LQW-PO-RECEIVER.                                     03020000
030300             15 LQW-PO-NBR              PIC  X(08).               03030000
030400             15 FILLER                  PIC  X(01).               03040000
030500             15 LQW-RECEIVER            PIC  X(03).               03050000
030600         10  LQW-LINE-PACK              PIC S9(04)                03060000
030700                                        COMP.                     03070000
030800         10  LQW-OPER-UNT-ID            PIC S9(04)                03080000
030900                                        COMP.                     03090000
031000         10  LQW-DEST-OPER-UNT          PIC S9(04)                03100000
031100                                        COMP.                     03110000
031200         10  LQW-PKSL-SEQ-NBR           PIC S9(04)                03120000
031300                                        COMP.                     03130000
031400         10  LQW-DC-FUNC-CDE            PIC  X(02).               03140000
031500         10  LQW-PKG-CODE               PIC  X(01).               03150000
031600         10  LQW-USER-ID                PIC  X(08).               03160000
031700         10  LQW-CREATE-DATE            PIC  X(08).               03170000
031800         10  LQW-CREATE-MDCY            PIC  X(10).               03180000
031900         10  LQW-CREATE-TIME            PIC  X(08).               03190000
032000         10  LQW-FUNCTION               PIC  X(20).               03200000
032100                                                                  03210000
032200                                                                  03220000
032300     EJECT                                                        03230000
032400*---------------------------------------------------------------* 03240000
032500*  RECORD LAYOUT FOR THE VENDOR SELECTION TEMP STORAGE QUEUE.   * 03250000
032600*---------------------------------------------------------------* 03260000
032700                                                                  03270000
032800     COPY SUWS025.                                                03280000
032900     COPY RCWS013.                                                03290000
033000                                                                  03300000
033100     COPY XLWS071.                                                03310000
033200                                                                  03320000
033300*                                                                 03330000
033400*----------------------------------------------------------------*03340000
033500**  SECURITY SUBROUTINE PARAMETERS                                03350000
033600*----------------------------------------------------------------*03360000
033700     COPY DPWS008.                                                03370000
033800     EJECT                                                        03380000
033900*---------------------------------------------------------------* 03390000
034000*    MAP LAYOUT                                                 * 03400000
034100*---------------------------------------------------------------* 03410000
034200                                                                  03420000
034300     COPY RCKM837.                                                03430000
034400*                                                                 03440000
034500 01  MR-OCCURS-LAYOUT                   REDEFINES  RC837AO.       03450000
034600     05  FILLER                         PIC X(086).               03460000
034700*LMM 05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          03470000
034800     05  MR-SCROLL-AREA                 OCCURS 13 TIMES.          03480000
034900         10  MR-SELECTL                 PIC S9(04) COMP.          03490000
035000         10  MR-SELECTA                 PIC  X(01).               03500000
035100         10  MR-SELECTC                 PIC  X(01).               03510000
035200         10  MR-SELECTH                 PIC  X(01).               03520000
035300         10  MR-SELECTI                 PIC  X(01).               03530000
035400                                                                  03540000
035500         10  MR-ACTIONL                 PIC S9(04) COMP.          03550000
035600         10  MR-ACTIONA                 PIC  X(01).               03560000
035700         10  MR-ACTIONC                 PIC  X(01).               03570000
035800         10  MR-ACTIONH                 PIC  X(01).               03580000
035900         10  MR-ACTION                  PIC  X(03).               03590000
036000                                                                  03600000
036100         10  MR-PO-RECEIVERL            PIC S9(04) COMP.          03610000
036200         10  MR-PO-RECEIVERA            PIC  X(01).               03620000
036300         10  MR-PO-RECEIVERC            PIC  X(01).               03630000
036400         10  MR-PO-RECEIVERH            PIC  X(01).               03640000
036500         10  MR-PO-RECEIVER             PIC  X(12).               03650000
036600                                                                  03660000
036700         10  MR-LINE-PACKL              PIC S9(04) COMP.          03670000
036800         10  MR-LINE-PACKA              PIC  X(01).               03680000
036900         10  MR-LINE-PACKC              PIC  X(01).               03690000
037000         10  MR-LINE-PACKH              PIC  X(01).               03700000
037100         10  MR-LINE-PACK-X.                                      03710000
037200             15  MR-LINE-PACK           PIC ZZZ9.                 03720000
037300                                                                  03730000
037400         10  MR-DEST-OPER-UNT-IDL       PIC S9(04) COMP.          03740000
037500         10  MR-DEST-OPER-UNT-IDA       PIC  X(01).               03750000
037600         10  MR-DEST-OPER-UNT-IDC       PIC  X(01).               03760000
037700         10  MR-DEST-OPER-UNT-IDH       PIC  X(01).               03770000
037800         10  MR-DEST-OPER-UNT-ID-X.                               03780000
037900             15  MR-DEST-OPER-UNT-ID    PIC ZZZ9.                 03790000
038000                                                                  03800000
038100         10  MR-PKG-CODEL               PIC S9(04) COMP.          03810000
038200         10  MR-PKG-CODEA               PIC  X(01).               03820000
038300         10  MR-PKG-CODEC               PIC  X(01).               03830000
038400         10  MR-PKG-CODEH               PIC  X(01).               03840000
038500         10  MR-PKG-CODE                PIC  X(01).               03850000
038600                                                                  03860000
038700         10  MR-USER-IDL                PIC S9(04) COMP.          03870000
038800         10  MR-USER-IDA                PIC  X(01).               03880000
038900         10  MR-USER-IDC                PIC  X(01).               03890000
039000         10  MR-USER-IDH                PIC  X(01).               03900000
039100         10  MR-USER-ID                 PIC  X(08).               03910000
039200                                                                  03920000
039300         10  MR-CREATE-DATEL            PIC S9(04) COMP.          03930000
039400         10  MR-CREATE-DATEA            PIC  X(01).               03940000
039500         10  MR-CREATE-DATEC            PIC  X(01).               03950000
039600         10  MR-CREATE-DATEH            PIC  X(01).               03960000
039700         10  MR-CREATE-DATE             PIC  X(08).               03970000
039800                                                                  03980000
039900         10  MR-CREATE-TIMEL            PIC S9(04) COMP.          03990000
040000         10  MR-CREATE-TIMEA            PIC  X(01).               04000000
040100         10  MR-CREATE-TIMEC            PIC  X(01).               04010000
040200         10  MR-CREATE-TIMEH            PIC  X(01).               04020000
040300         10  MR-CREATE-TIME             PIC  X(08).               04030000
040400                                                                  04040000
040500         10  MR-FUNCTIONL               PIC S9(04) COMP.          04050000
040600         10  MR-FUNCTIONA               PIC  X(01).               04060000
040700         10  MR-FUNCTIONC               PIC  X(01).               04070000
040800         10  MR-FUNCTIONH               PIC  X(01).               04080000
040900         10  MR-FUNCTION                PIC  X(20).               04090000
041000                                                                  04100000
041100     05  FILLER                         PIC  X(12).               04110000
041200                                                                  04120000
041300     EJECT                                                        04130000
041400*---------------------------------------------------------------* 04140000
041500*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04150000
041600*---------------------------------------------------------------* 04160000
041700                                                                  04170000
041800     COPY DPWS015.                                                04180000
041900                                                                  04190000
042000*---------------------------------------------------------------* 04200000
042100*    FUNCTION KEYS COPYBOOK.                                    * 04210000
042200*---------------------------------------------------------------* 04220000
042300                                                                  04230000
042400     COPY DPWS016.                                                04240000
042500                                                                  04250000
042600*---------------------------------------------------------------* 04260000
042700*    NUMERIC EDIT LAYOUT.                                       * 04270000
042800*---------------------------------------------------------------* 04280000
042900                                                                  04290000
043000     COPY DPWS010I.                                               04300000
043100 EJECT                                                            04310000
043200******************************************************************04320003
043300** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **04330003
043310** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **04331003
043400******************************************************************04340003
043500                                                                  04350000
043600     COPY DPWS030.                                                04360000
043610     COPY DPWS930.                                                04361003
043700 EJECT                                                            04370000
043800*---------------------------------------------------------------* 04380000
043900*    STANDARD COMMAREA.                                         * 04390000
044000*---------------------------------------------------------------* 04400000
044100                                                                  04410000
044200     COPY DPWS020.                                                04420000
044300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04430000
044400                                                                  04440000
044500*---------------------------------------------------------------* 04450000
044600* INTER-APPLICATION COMMAREA.                                   * 04460000
044700*   RCWS836 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04470000
044800*             SPEC SCREEN.                                      * 04480000
044900*   RCWS015 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04490000
045000*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04500000
045100*---------------------------------------------------------------* 04510000
045200                                                                  04520000
045300         10  INTER-APPL-COMM-AREA       PIC X(200).               04530000
045400     COPY RCWS836.                                                04540000
045500     COPY RCWS015.                                                04550000
045600*---------------------------------------------------------------* 04560000
045700*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04570000
045800*---------------------------------------------------------------* 04580000
045900         10  ASC-SPECIFIC-COMMAREA.                               04590000
046000             15  ASC-LIST-KEYS.                                   04600000
046100                 20  ASC-OPER-UNIT-ID.                            04610000
046200                     25  ASC-OPER-UNIT-ID-N          PIC  9(04).  04620000
046300                 20  ASC-OPER-DESC                   PIC  X(30).  04630000
046400                 20  ASC-PO                          PIC  9(09).  04640000
046500                 20  ASC-RECEIVER-SEQ                PIC  9(03).  04650000
046600                 20  ASC-PO-RECEIVER.                             04660000
046700                     25  ASC-PO-NBR                  PIC X(08).   04670000
046800                     25  ASC-PO-NBR-N REDEFINES ASC-PO-NBR        04680000
046900                                                     PIC 9(08).   04690000
047000                     25  FILLER                      PIC X(01).   04700000
047100                     25  ASC-RCVR                    PIC X(04).   04710000
047200                     25  ASC-RCVR-N REDEFINES ASC-RCVR            04720000
047300                                                     PIC 9(04).   04730000
047400                 20  ASC-LINE-NUMBER                 PIC  9(04).  04740000
047500                 20  ASC-PACK-NUMBER                 PIC  9(04).  04750000
047600                 20  ASC-USER-ID                     PIC  X(08).  04760000
047700                 20  ASC-FROM-DATE-MM                PIC  9(02).  04770000
047800                 20  ASC-FROM-DATE-DD                PIC  9(02).  04780000
047900                 20  ASC-FROM-DATE-YY                PIC  9(04).  04790000
048000                 20  ASC-TO-DATE-MM                  PIC  9(02).  04800000
048100                 20  ASC-TO-DATE-DD                  PIC  9(02).  04810000
048200                 20  ASC-TO-DATE-YY                  PIC  9(04).  04820000
048300                 20  ASC-CURSOR-TYPE-SW              PIC X(01).   04830000
048400             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                04840000
048500                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  04850000
048600                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   04860000
048700                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   04870000
048800                                                                  04880000
048900                 20  ASC-ITEM-ARRAY.                              04890000
049000                     25  ASC-ITEM-ENTRIES OCCURS 13 TIMES.        04900000
049100                         30  ASC-LIST-ITEM-NUMBER                 04910000
049200                                                     PIC S9(09)   04920000
049300                                                     COMP-3.      04930000
049400                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  04940000
049500                             88  ASC-VALID-SELECT    VALUE ' '    04950000
049600                                                           'S'    04960000
049700                                                           'B'    04970000
049800                                                           'E'.   04980000
049900                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   04990000
050000                             88  ASC-TEMP-SELECT     VALUE 'S'.   05000000
050100                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05010000
050200                             88  ASC-TEMP-END        VALUE 'E'.   05020000
050300                         30  ASC-SELECTED-SW         PIC  X(01).  05030000
050400                             88  ASC-NO-SELECT       VALUE ' '.   05040000
050500                             88  ASC-SELECT          VALUE 'S'.   05050000
050600                             88  ASC-BEGIN           VALUE 'B'.   05060000
050700                             88  ASC-END             VALUE 'E'.   05070000
050800                         30  ASC-ACTION              PIC  X(03).  05080000
050900                         30  ASC-CSR-IND             PIC  X(01).  05090000
051000*LMM                                                              05100000
051100*********                30  ASC-TBL-PO-RECEIVER     PIC  X(12).  05110000
051200                         30  ASC-TBL-PO-RECEIVER.                 05120000
051300                             35 ASC-TBL-PO-NBR      PIC  X(08).   05130000
051400                             35 FILLER              PIC  X(01).   05140000
051500                             35 ASC-TBL-RECEIVER    PIC  X(03).   05150000
051600                         30  ASC-TBL-LINE-PACK       PIC S9(04)   05160000
051700                                                     COMP.        05170000
051800                         30  ASC-TBL-OPER-UNT-ID     PIC S9(04)   05180000
051900                                                     COMP.        05190000
052000                         30  ASC-TBL-DEST-OPER-UNT   PIC S9(04)   05200000
052100                                                     COMP.        05210000
052200                         30  ASC-TBL-PKSL-SEQ-NBR    PIC S9(04)   05220000
052300                                                     COMP.        05230000
052400                         30  ASC-TBL-DC-FUNC-CDE     PIC  X(02).  05240000
052500                         30  ASC-TBL-PKG-CODE        PIC  X(01).  05250000
052600                         30  ASC-TBL-USER-ID         PIC  X(08).  05260000
052700                         30  ASC-TBL-CREATE-DATE     PIC  X(08).  05270000
052800                         30  ASC-TBL-CREATE-MDCY     PIC  X(10).  05280000
052900                         30  ASC-TBL-CREATE-TIME     PIC  X(08).  05290000
053000                         30  ASC-TBL-FUNCTION        PIC  X(20).  05300000
053100                                                                  05310000
053200             15  ASC-BLK-SUB                         PIC S9(04)   05320000
053300                                                          COMP    05330000
053400                                                          SYNC.   05340000
053500             15  ASC-ITEM-SUB                        PIC S9(04)   05350000
053600                                                          COMP    05360000
053700                                                          SYNC.   05370000
053800             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   05380000
053900                                                          COMP-3. 05390000
054000             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   05400000
054100                                                          COMP-3. 05410000
054200             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   05420000
054300                                                          COMP-3. 05430000
054400             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   05440000
054500                                                          COMP-3. 05450000
054600             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   05460000
054700                                                          COMP-3. 05470000
054800             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   05480000
054900                                                          COMP    05490000
055000                                                          SYNC.   05500000
055100             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   05510000
055200                                                          COMP-3. 05520000
055300             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   05530000
055400                                                          COMP-3. 05540000
055500             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  05550000
055600                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   05560000
055700                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   05570000
055800             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  05580000
055900                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   05590000
056000                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   05600000
056100             15  ASC-LIST-QUEUE-NAME.                             05610000
056200                 20  ASC-LIST-TERM-ID                PIC  X(04).  05620000
056300                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   05630000
056400                                                          COMP-3. 05640000
056500                 20  ASC-LIST-SEQ                    PIC  9(01).  05650000
056600             15  ASC-SEL-QUEUE-NAME.                              05660000
056700                 20  ASC-SEL-TERM-ID                 PIC  X(04).  05670000
056800                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   05680000
056900                                                          COMP-3. 05690000
057000                 20  ASC-SEL-SEQ                     PIC  9(01).  05700000
057100                                                                  05710000
057200             15  ASC-SEL-QUEUE-NAME-IN.                           05720000
057300                 20  ASC-SEL-TERM-ID-IN  PIC X(04).               05730000
057400                 20  ASC-SEL-TASK-NUMBER-IN                       05740000
057500                                      PIC S9(05) COMP-3.          05750000
057600                 20  ASC-SEL-SEQ-IN      PIC 9(01).               05760000
057700             15  ASC-USE-SELECTION-QUEUE-IND                      05770000
057800                                           PIC  X(01).            05780000
057900                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05790000
058000             15  ASC-START-ITEM-REQUEST.                          05800000
058100                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  05810000
058200             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    05820000
058300             15  ASC-SEL-SUB               PIC S9(04)  COMP.      05830000
058400             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      05840000
058500     EJECT                                                        05850000
058600*---------------------------------------------------------------* 05860000
058700*    ABEND PROCESSING COPYBOOK.                                 * 05870000
058800*---------------------------------------------------------------* 05880000
058900                                                                  05890000
059000     COPY DPWS013.                                                05900000
059100                                                                  05910000
059200*----------------------------------------------------------------*05920000
059300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIVING TABLE    05930000
059400*----------------------------------------------------------------*05940000
059500     EXEC SQL                                                     05950000
059600         INCLUDE TRECEIV                                          05960000
059700     END-EXEC.                                                    05970000
059800                                                                  05980000
059900*----------------------------------------------------------------*05990000
060000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PO-RECEIVER        06000000
060100*  TRACKING TABLE (RCT_PO_RCVR_TRKG)                              06010000
060200*----------------------------------------------------------------*06020000
060300     EXEC SQL                                                     06030000
060400         INCLUDE RCT00017                                         06040000
060500     END-EXEC.                                                    06050000
060600*----------------------------------------------------------------*06060000
060700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE DC FUNCTION        06070000
060800*  TABLE (RCT_DC_FUNC)                                            06080000
060900*----------------------------------------------------------------*06090000
061000     EXEC SQL                                                     06100000
061100         INCLUDE RCT00018                                         06110000
061200     END-EXEC.                                                    06120000
061300                                                                  06130000
061400*----------------------------------------------------------------*06140000
061500*    DB2 SQL COMMUNICATION AREA                                   06150000
061600*----------------------------------------------------------------*06160000
061700     EXEC SQL                                                     06170000
061800          INCLUDE SQLCA                                           06180000
061900     END-EXEC.                                                    06190000
062000                                                                  06200000
062100                                                                  06210000
062200*---------------------------------------------------------------* 06220000
062300*    CURSOR FOR ALL AUDITS FOR AN OPER ID AND STATUS            * 06230000
062400*---------------------------------------------------------------* 06240000
062500                                                                  06250000
062600     EXEC SQL                                                     06260000
062700          DECLARE PO-RC-LN-USER-CSR CURSOR                        06270000
062800          FOR SELECT 'A'                                          06280000
062900          ,  A.PO_NBR                                             06290000
063000          ,  A.RCVR_SEQ_NBR                                       06300000
063100          ,  A.CRE_BY_USR_ID                                      06310000
063200          ,  A.CRE_TMST                                           06320000
063300          ,  A.DC_FUNC_CDE                                        06330000
063400          ,  A.LOC_NBR                                            06340000
063500          ,  A.PO_LNE_NBR                                         06350000
063600          ,  A.PREPK_ID                                           06360000
063700          ,  A.CRE_BY_PGM_NM                                      06370000
063800          ,  A.LAST_UPD_TMST                                      06380000
063900          ,  A.PKSL_SEQ_NBR                                       06390000
064000          ,  B.DC_FUNC_DESC                                       06400000
064100          ,  B.SHRT_DC_FUNC_DESC                                  06410000
064200          ,  C.PKGNG_CDE                                          06420000
064300          ,  A.DEST_LOC_NBR                                       06430000
064400          FROM                                                    06440000
064500             RCT_PO_RCVR_TRKG A                                   06450000
064600          ,  RCT_DC_FUNC B                                        06460000
064700          ,  TRECEIV     C                                        06470000
064800          WHERE  A.PO_NBR         = :DK-PO-NBR                    06480000
064900             AND A.RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR              06490000
065000             AND A.LOC_NBR        = :DK-OPER-UNT-ID               06500000
065100             AND A.PO_LNE_NBR     = :DK-PO-LNE-NBR                06510000
065200             AND A.CRE_BY_USR_ID  = :DK-CRE-BY-USR-ID             06520000
065300             AND A.DC_FUNC_CDE     = B.DC_FUNC_CDE                06530000
065400             AND A.PO_NBR          = C.ORD_NBR                    06540000
065500             AND A.RCVR_SEQ_NBR    = C.REC_SEQ_NBR                06550000
065600            UNION                                                 06560000
065700           SELECT 'B'                                             06570000
065800             ,A.PO_NBR                                            06580000
065900             ,A.RCVR_SEQ_NBR                                      06590000
066000             ,A.CRE_BY_USR_ID                                     06600000
066100             ,A.CRE_TMST                                          06610000
066200             ,A.DC_FUNC_CDE                                       06620000
066300             ,A.LOC_NBR                                           06630000
066400             ,A.PO_LNE_NBR                                        06640000
066500             ,A.PREPK_ID                                          06650000
066600             ,A.CRE_BY_PGM_NM                                     06660000
066700             ,A.LAST_UPD_TMST                                     06670000
066800             ,A.PKSL_SEQ_NBR                                      06680000
066900             ,B.DC_FUNC_DESC                                      06690000
067000             ,B.SHRT_DC_FUNC_DESC                                 06700000
067100             ,' '                                                 06710000
067200             ,A.DEST_LOC_NBR                                      06720000
067300            FROM RCT_PO_RCVR_TRKG A                               06730000
067400               , RCT_DC_FUNC      B                               06740000
067500           WHERE A.PO_NBR        = :DK-PO-NBR                     06750000
067600             AND A.RCVR_SEQ_NBR  = 0                              06760000
067700             AND A.LOC_NBR       = :DK-OPER-UNT-ID                06770000
067800             AND A.PO_LNE_NBR     = :DK-PO-LNE-NBR                06780000
067900             AND A.CRE_BY_USR_ID = :DK-CRE-BY-USR-ID              06790000
068000             AND A.DC_FUNC_CDE   = B.DC_FUNC_CDE                  06800000
068100          ORDER BY                                                06810000
068200             5                                                    06820000
068300     END-EXEC.                                                    06830000
068400                                                                  06840000
068500                                                                  06850000
068600     EXEC SQL                                                     06860000
068700          DECLARE PO-RC-PK-US-CSR CURSOR                          06870000
068800          FOR SELECT 'A'                                          06880000
068900          ,  A.PO_NBR                                             06890000
069000          ,  A.RCVR_SEQ_NBR                                       06900000
069100          ,  A.CRE_BY_USR_ID                                      06910000
069200          ,  A.CRE_TMST                                           06920000
069300          ,  A.DC_FUNC_CDE                                        06930000
069400          ,  A.LOC_NBR                                            06940000
069500          ,  A.PO_LNE_NBR                                         06950000
069600          ,  A.PREPK_ID                                           06960000
069700          ,  A.CRE_BY_PGM_NM                                      06970000
069800          ,  A.LAST_UPD_TMST                                      06980000
069900          ,  A.PKSL_SEQ_NBR                                       06990000
070000          ,  B.DC_FUNC_DESC                                       07000000
070100          ,  B.SHRT_DC_FUNC_DESC                                  07010000
070200          ,  C.PKGNG_CDE                                          07020000
070300          ,  A.DEST_LOC_NBR                                       07030000
070400          FROM                                                    07040000
070500             RCT_PO_RCVR_TRKG A                                   07050000
070600          ,  RCT_DC_FUNC B                                        07060000
070700          ,  TRECEIV     C                                        07070000
070800          WHERE  A.PO_NBR         = :DK-PO-NBR                    07080000
070900             AND A.RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR              07090000
071000*LMM         AND A.LOC_NBR        = :DK-OPER-UNT-ID               07100000
071100             AND A.PREPK_ID       = :DK-PREPK-ID                  07110000
071200             AND A.CRE_BY_USR_ID  = :DK-CRE-BY-USR-ID             07120000
071300             AND A.DC_FUNC_CDE     = B.DC_FUNC_CDE                07130000
071400             AND A.PO_NBR          = C.ORD_NBR                    07140000
071500             AND A.RCVR_SEQ_NBR    = C.REC_SEQ_NBR                07150000
071600            UNION                                                 07160000
071700           SELECT 'B'                                             07170000
071800             ,A.PO_NBR                                            07180000
071900             ,A.RCVR_SEQ_NBR                                      07190000
072000             ,A.CRE_BY_USR_ID                                     07200000
072100             ,A.CRE_TMST                                          07210000
072200             ,A.DC_FUNC_CDE                                       07220000
072300             ,A.LOC_NBR                                           07230000
072400             ,A.PO_LNE_NBR                                        07240000
072500             ,A.PREPK_ID                                          07250000
072600             ,A.CRE_BY_PGM_NM                                     07260000
072700             ,A.LAST_UPD_TMST                                     07270000
072800             ,A.PKSL_SEQ_NBR                                      07280000
072900             ,B.DC_FUNC_DESC                                      07290000
073000             ,B.SHRT_DC_FUNC_DESC                                 07300000
073100             ,' '                                                 07310000
073200             ,A.DEST_LOC_NBR                                      07320000
073300            FROM RCT_PO_RCVR_TRKG A                               07330000
073400               , RCT_DC_FUNC      B                               07340000
073500           WHERE A.PO_NBR        = :DK-PO-NBR                     07350000
073600             AND A.RCVR_SEQ_NBR  = 0                              07360000
073700             AND A.LOC_NBR       = :DK-OPER-UNT-ID                07370000
073800             AND A.PREPK_ID       = :DK-PREPK-ID                  07380000
073900             AND A.CRE_BY_USR_ID = :DK-CRE-BY-USR-ID              07390000
074000             AND A.DC_FUNC_CDE   = B.DC_FUNC_CDE                  07400000
074100          ORDER BY                                                07410000
074200             5                                                    07420000
074300     END-EXEC.                                                    07430000
074400                                                                  07440000
074500     EXEC SQL                                                     07450000
074600          DECLARE PO-RCVR-LINE-CSR CURSOR                         07460000
074700          FOR SELECT 'A'                                          07470000
074800          ,  A.PO_NBR                                             07480000
074900          ,  A.RCVR_SEQ_NBR                                       07490000
075000          ,  A.CRE_BY_USR_ID                                      07500000
075100          ,  A.CRE_TMST                                           07510000
075200          ,  A.DC_FUNC_CDE                                        07520000
075300          ,  A.LOC_NBR                                            07530000
075400          ,  A.PO_LNE_NBR                                         07540000
075500          ,  A.PREPK_ID                                           07550000
075600          ,  A.CRE_BY_PGM_NM                                      07560000
075700          ,  A.LAST_UPD_TMST                                      07570000
075800          ,  A.PKSL_SEQ_NBR                                       07580000
075900          ,  B.DC_FUNC_DESC                                       07590000
076000          ,  B.SHRT_DC_FUNC_DESC                                  07600000
076100          ,  C.PKGNG_CDE                                          07610000
076200          ,  A.DEST_LOC_NBR                                       07620000
076300          FROM                                                    07630000
076400             RCT_PO_RCVR_TRKG A                                   07640000
076500          ,  RCT_DC_FUNC B                                        07650000
076600          ,  TRECEIV     C                                        07660000
076700          WHERE  A.PO_NBR         = :DK-PO-NBR                    07670000
076800             AND A.RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR              07680000
076900*LMM         AND A.LOC_NBR        = :DK-OPER-UNT-ID               07690000
077000             AND A.PO_LNE_NBR     = :DK-PO-LNE-NBR                07700000
077100             AND A.DC_FUNC_CDE     = B.DC_FUNC_CDE                07710000
077200             AND A.PO_NBR          = C.ORD_NBR                    07720000
077300             AND A.RCVR_SEQ_NBR    = C.REC_SEQ_NBR                07730000
077400            UNION                                                 07740000
077500           SELECT 'B'                                             07750000
077600             ,A.PO_NBR                                            07760000
077700             ,A.RCVR_SEQ_NBR                                      07770000
077800             ,A.CRE_BY_USR_ID                                     07780000
077900             ,A.CRE_TMST                                          07790000
078000             ,A.DC_FUNC_CDE                                       07800000
078100             ,A.LOC_NBR                                           07810000
078200             ,A.PO_LNE_NBR                                        07820000
078300             ,A.PREPK_ID                                          07830000
078400             ,A.CRE_BY_PGM_NM                                     07840000
078500             ,A.LAST_UPD_TMST                                     07850000
078600             ,A.PKSL_SEQ_NBR                                      07860000
078700             ,B.DC_FUNC_DESC                                      07870000
078800             ,B.SHRT_DC_FUNC_DESC                                 07880000
078900             ,' '                                                 07890000
079000             ,A.DEST_LOC_NBR                                      07900000
079100            FROM RCT_PO_RCVR_TRKG A                               07910000
079200               , RCT_DC_FUNC      B                               07920000
079300           WHERE A.PO_NBR        = :DK-PO-NBR                     07930000
079400             AND A.RCVR_SEQ_NBR  = 0                              07940000
079500             AND A.LOC_NBR       = :DK-OPER-UNT-ID                07950000
079600             AND A.PO_LNE_NBR     = :DK-PO-LNE-NBR                07960000
079700             AND A.DC_FUNC_CDE   = B.DC_FUNC_CDE                  07970000
079800          ORDER BY                                                07980000
079900             5                                                    07990000
080000     END-EXEC.                                                    08000000
080100                                                                  08010000
080200                                                                  08020000
080300     EXEC SQL                                                     08030000
080400          DECLARE PO-RCVR-PACK-CSR CURSOR                         08040000
080500          FOR SELECT 'A'                                          08050000
080600          ,  A.PO_NBR                                             08060000
080700          ,  A.RCVR_SEQ_NBR                                       08070000
080800          ,  A.CRE_BY_USR_ID                                      08080000
080900          ,  A.CRE_TMST                                           08090000
081000          ,  A.DC_FUNC_CDE                                        08100000
081100          ,  A.LOC_NBR                                            08110000
081200          ,  A.PO_LNE_NBR                                         08120000
081300          ,  A.PREPK_ID                                           08130000
081400          ,  A.CRE_BY_PGM_NM                                      08140000
081500          ,  A.LAST_UPD_TMST                                      08150000
081600          ,  A.PKSL_SEQ_NBR                                       08160000
081700          ,  B.DC_FUNC_DESC                                       08170000
081800          ,  B.SHRT_DC_FUNC_DESC                                  08180000
081900          ,  C.PKGNG_CDE                                          08190000
082000          ,  A.DEST_LOC_NBR                                       08200000
082100          FROM                                                    08210000
082200             RCT_PO_RCVR_TRKG A                                   08220000
082300          ,  RCT_DC_FUNC B                                        08230000
082400          ,  TRECEIV     C                                        08240000
082500          WHERE  A.PO_NBR         = :DK-PO-NBR                    08250000
082600             AND A.RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR              08260000
082700*LMM         AND A.LOC_NBR        = :DK-OPER-UNT-ID               08270000
082800             AND A.PREPK_ID       = :DK-PREPK-ID                  08280000
082900             AND A.DC_FUNC_CDE     = B.DC_FUNC_CDE                08290000
083000             AND A.PO_NBR          = C.ORD_NBR                    08300000
083100             AND A.RCVR_SEQ_NBR    = C.REC_SEQ_NBR                08310000
083200            UNION                                                 08320000
083300           SELECT 'B'                                             08330000
083400             ,A.PO_NBR                                            08340000
083500             ,A.RCVR_SEQ_NBR                                      08350000
083600             ,A.CRE_BY_USR_ID                                     08360000
083700             ,A.CRE_TMST                                          08370000
083800             ,A.DC_FUNC_CDE                                       08380000
083900             ,A.LOC_NBR                                           08390000
084000             ,A.PO_LNE_NBR                                        08400000
084100             ,A.PREPK_ID                                          08410000
084200             ,A.CRE_BY_PGM_NM                                     08420000
084300             ,A.LAST_UPD_TMST                                     08430000
084400             ,A.PKSL_SEQ_NBR                                      08440000
084500             ,B.DC_FUNC_DESC                                      08450000
084600             ,B.SHRT_DC_FUNC_DESC                                 08460000
084700             ,' '                                                 08470000
084800             ,A.DEST_LOC_NBR                                      08480000
084900            FROM RCT_PO_RCVR_TRKG A                               08490000
085000               , RCT_DC_FUNC      B                               08500000
085100           WHERE A.PO_NBR        = :DK-PO-NBR                     08510000
085200             AND A.RCVR_SEQ_NBR  = 0                              08520000
085300             AND A.LOC_NBR       = :DK-OPER-UNT-ID                08530000
085400             AND A.PREPK_ID       = :DK-PREPK-ID                  08540000
085500             AND A.DC_FUNC_CDE   = B.DC_FUNC_CDE                  08550000
085600          ORDER BY                                                08560000
085700             5                                                    08570000
085800     END-EXEC.                                                    08580000
085900                                                                  08590000
086000                                                                  08600000
086100     EXEC SQL                                                     08610000
086200          DECLARE PO-RCVR-USER-CSR CURSOR                         08620000
086300          FOR SELECT 'A'                                          08630000
086400          ,  A.PO_NBR                                             08640000
086500          ,  A.RCVR_SEQ_NBR                                       08650000
086600          ,  A.CRE_BY_USR_ID                                      08660000
086700          ,  A.CRE_TMST                                           08670000
086800          ,  A.DC_FUNC_CDE                                        08680000
086900          ,  A.LOC_NBR                                            08690000
087000          ,  A.PO_LNE_NBR                                         08700000
087100          ,  A.PREPK_ID                                           08710000
087200          ,  A.CRE_BY_PGM_NM                                      08720000
087300          ,  A.LAST_UPD_TMST                                      08730000
087400          ,  A.PKSL_SEQ_NBR                                       08740000
087500          ,  B.DC_FUNC_DESC                                       08750000
087600          ,  B.SHRT_DC_FUNC_DESC                                  08760000
087700          ,  C.PKGNG_CDE                                          08770000
087800          ,  A.DEST_LOC_NBR                                       08780000
087900          FROM                                                    08790000
088000             RCT_PO_RCVR_TRKG A                                   08800000
088100          ,  RCT_DC_FUNC B                                        08810000
088200          ,  TRECEIV     C                                        08820000
088300          WHERE  A.PO_NBR         = :DK-PO-NBR                    08830000
088400             AND A.RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR              08840000
088500*LMM         AND A.LOC_NBR        = :DK-OPER-UNT-ID               08850000
088600             AND A.CRE_BY_USR_ID  = :DK-CRE-BY-USR-ID             08860000
088700             AND A.DC_FUNC_CDE     = B.DC_FUNC_CDE                08870000
088800             AND A.PO_NBR          = C.ORD_NBR                    08880000
088900             AND A.RCVR_SEQ_NBR    = C.REC_SEQ_NBR                08890000
089000            UNION                                                 08900000
089100           SELECT 'B'                                             08910000
089200             ,A.PO_NBR                                            08920000
089300             ,A.RCVR_SEQ_NBR                                      08930000
089400             ,A.CRE_BY_USR_ID                                     08940000
089500             ,A.CRE_TMST                                          08950000
089600             ,A.DC_FUNC_CDE                                       08960000
089700             ,A.LOC_NBR                                           08970000
089800             ,A.PO_LNE_NBR                                        08980000
089900             ,A.PREPK_ID                                          08990000
090000             ,A.CRE_BY_PGM_NM                                     09000000
090100             ,A.LAST_UPD_TMST                                     09010000
090200             ,A.PKSL_SEQ_NBR                                      09020000
090300             ,B.DC_FUNC_DESC                                      09030000
090400             ,B.SHRT_DC_FUNC_DESC                                 09040000
090500             ,' '                                                 09050000
090600             ,A.DEST_LOC_NBR                                      09060000
090700            FROM RCT_PO_RCVR_TRKG A                               09070000
090800               , RCT_DC_FUNC      B                               09080000
090900           WHERE A.PO_NBR        = :DK-PO-NBR                     09090000
091000             AND A.RCVR_SEQ_NBR  = 0                              09100000
091100             AND A.LOC_NBR       = :DK-OPER-UNT-ID                09110000
091200             AND A.CRE_BY_USR_ID = :DK-CRE-BY-USR-ID              09120000
091300             AND A.DC_FUNC_CDE   = B.DC_FUNC_CDE                  09130000
091400          ORDER BY                                                09140000
091500             8,9,5                                                09150000
091600     END-EXEC.                                                    09160000
091700                                                                  09170000
091800     EXEC SQL                                                     09180000
091900          DECLARE PO-RCVR-CSR CURSOR                              09190000
092000          FOR SELECT 'A'                                          09200000
092100          ,  A.PO_NBR                                             09210000
092200          ,  A.RCVR_SEQ_NBR                                       09220000
092300          ,  A.CRE_BY_USR_ID                                      09230000
092400          ,  A.CRE_TMST                                           09240000
092500          ,  A.DC_FUNC_CDE                                        09250000
092600          ,  A.LOC_NBR                                            09260000
092700          ,  A.PO_LNE_NBR                                         09270000
092800          ,  A.PREPK_ID                                           09280000
092900          ,  A.CRE_BY_PGM_NM                                      09290000
093000          ,  A.LAST_UPD_TMST                                      09300000
093100          ,  A.PKSL_SEQ_NBR                                       09310000
093200          ,  B.DC_FUNC_DESC                                       09320000
093300          ,  B.SHRT_DC_FUNC_DESC                                  09330000
093400          ,  C.PKGNG_CDE                                          09340000
093500          ,  A.DEST_LOC_NBR                                       09350000
093600          FROM                                                    09360000
093700             RCT_PO_RCVR_TRKG A                                   09370000
093800          ,  RCT_DC_FUNC B                                        09380000
093900          ,  TRECEIV     C                                        09390000
094000          WHERE  A.PO_NBR         = :DK-PO-NBR                    09400000
094100             AND A.RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR              09410000
094200*LMM         AND A.LOC_NBR        = :DK-OPER-UNT-ID               09420000
094300             AND A.DC_FUNC_CDE     = B.DC_FUNC_CDE                09430000
094400             AND A.PO_NBR          = C.ORD_NBR                    09440000
094500             AND A.RCVR_SEQ_NBR    = C.REC_SEQ_NBR                09450000
094600            UNION                                                 09460000
094700           SELECT 'B'                                             09470000
094800             ,A.PO_NBR                                            09480000
094900             ,A.RCVR_SEQ_NBR                                      09490000
095000             ,A.CRE_BY_USR_ID                                     09500000
095100             ,A.CRE_TMST                                          09510000
095200             ,A.DC_FUNC_CDE                                       09520000
095300             ,A.LOC_NBR                                           09530000
095400             ,A.PO_LNE_NBR                                        09540000
095500             ,A.PREPK_ID                                          09550000
095600             ,A.CRE_BY_PGM_NM                                     09560000
095700             ,A.LAST_UPD_TMST                                     09570000
095800             ,A.PKSL_SEQ_NBR                                      09580000
095900             ,B.DC_FUNC_DESC                                      09590000
096000             ,B.SHRT_DC_FUNC_DESC                                 09600000
096100             ,' '                                                 09610000
096200             ,A.DEST_LOC_NBR                                      09620000
096300            FROM RCT_PO_RCVR_TRKG A                               09630000
096400               , RCT_DC_FUNC      B                               09640000
096500           WHERE A.PO_NBR        = :DK-PO-NBR                     09650000
096600             AND A.RCVR_SEQ_NBR  = 0                              09660000
096700             AND A.LOC_NBR       = :DK-OPER-UNT-ID                09670000
096800             AND A.DC_FUNC_CDE   = B.DC_FUNC_CDE                  09680000
096900          ORDER BY                                                09690000
097000             8,9,5                                                09700000
097100     END-EXEC.                                                    09710000
097200                                                                  09720000
097300                                                                  09730000
097400     EXEC SQL                                                     09740000
097500          DECLARE PO-USER-CSR CURSOR                              09750000
097600          FOR SELECT 'A'                                          09760000
097700          ,  A.PO_NBR                                             09770000
097800          ,  A.RCVR_SEQ_NBR                                       09780000
097900          ,  A.CRE_BY_USR_ID                                      09790000
098000          ,  A.CRE_TMST                                           09800000
098100          ,  A.DC_FUNC_CDE                                        09810000
098200          ,  A.LOC_NBR                                            09820000
098300          ,  A.PO_LNE_NBR                                         09830000
098400          ,  A.PREPK_ID                                           09840000
098500          ,  A.CRE_BY_PGM_NM                                      09850000
098600          ,  A.LAST_UPD_TMST                                      09860000
098700          ,  A.PKSL_SEQ_NBR                                       09870000
098800          ,  B.DC_FUNC_DESC                                       09880000
098900          ,  B.SHRT_DC_FUNC_DESC                                  09890000
099000          ,  C.PKGNG_CDE                                          09900000
099100          ,  A.DEST_LOC_NBR                                       09910000
099200          FROM                                                    09920000
099300             RCT_PO_RCVR_TRKG A                                   09930000
099400          ,  RCT_DC_FUNC B                                        09940000
099500          ,  TRECEIV     C                                        09950000
099600          WHERE  A.PO_NBR         = :DK-PO-NBR                    09960000
099700             AND A.CRE_BY_USR_ID  = :DK-CRE-BY-USR-ID             09970000
099800             AND A.DC_FUNC_CDE     = B.DC_FUNC_CDE                09980000
099900             AND A.PO_NBR          = C.ORD_NBR                    09990000
100000             AND A.RCVR_SEQ_NBR    = C.REC_SEQ_NBR                10000000
100100             AND A.LOC_NBR        = :DK-OPER-UNT-ID               10010000
100200            UNION                                                 10020000
100300           SELECT 'B'                                             10030000
100400             ,A.PO_NBR                                            10040000
100500             ,A.RCVR_SEQ_NBR                                      10050000
100600             ,A.CRE_BY_USR_ID                                     10060000
100700             ,A.CRE_TMST                                          10070000
100800             ,A.DC_FUNC_CDE                                       10080000
100900             ,A.LOC_NBR                                           10090000
101000             ,A.PO_LNE_NBR                                        10100000
101100             ,A.PREPK_ID                                          10110000
101200             ,A.CRE_BY_PGM_NM                                     10120000
101300             ,A.LAST_UPD_TMST                                     10130000
101400             ,A.PKSL_SEQ_NBR                                      10140000
101500             ,B.DC_FUNC_DESC                                      10150000
101600             ,B.SHRT_DC_FUNC_DESC                                 10160000
101700             ,' '                                                 10170000
101800             ,A.DEST_LOC_NBR                                      10180000
101900            FROM RCT_PO_RCVR_TRKG A                               10190000
102000               , RCT_DC_FUNC      B                               10200000
102100           WHERE A.PO_NBR        = :DK-PO-NBR                     10210000
102200             AND A.RCVR_SEQ_NBR  = 0                              10220000
102300             AND A.LOC_NBR       = :DK-OPER-UNT-ID                10230000
102400             AND A.CRE_BY_USR_ID = :DK-CRE-BY-USR-ID              10240000
102500             AND A.DC_FUNC_CDE   = B.DC_FUNC_CDE                  10250000
102600          ORDER BY                                                10260000
102700             3,8,9,5                                              10270000
102800     END-EXEC.                                                    10280000
102900                                                                  10290000
103000                                                                  10300000
103100     EXEC SQL                                                     10310000
103200          DECLARE PO-CSR CURSOR                                   10320000
103300          FOR SELECT 'A'                                          10330000
103400          ,  A.PO_NBR                                             10340000
103500          ,  A.RCVR_SEQ_NBR                                       10350000
103600          ,  A.CRE_BY_USR_ID                                      10360000
103700          ,  A.CRE_TMST                                           10370000
103800          ,  A.DC_FUNC_CDE                                        10380000
103900          ,  A.LOC_NBR                                            10390000
104000          ,  A.PO_LNE_NBR                                         10400000
104100          ,  A.PREPK_ID                                           10410000
104200          ,  A.CRE_BY_PGM_NM                                      10420000
104300          ,  A.LAST_UPD_TMST                                      10430000
104400          ,  A.PKSL_SEQ_NBR                                       10440000
104500          ,  B.DC_FUNC_DESC                                       10450000
104600          ,  B.SHRT_DC_FUNC_DESC                                  10460000
104700          ,  C.PKGNG_CDE                                          10470000
104800          ,  A.DEST_LOC_NBR                                       10480000
104900          FROM                                                    10490000
105000             RCT_PO_RCVR_TRKG A                                   10500000
105100          ,  RCT_DC_FUNC B                                        10510000
105200          ,  TRECEIV     C                                        10520000
105300          WHERE  A.PO_NBR         = :DK-PO-NBR                    10530000
105400             AND A.DC_FUNC_CDE     = B.DC_FUNC_CDE                10540000
105500             AND A.PO_NBR          = C.ORD_NBR                    10550000
105600             AND A.RCVR_SEQ_NBR    = C.REC_SEQ_NBR                10560000
105700             AND A.LOC_NBR        = :DK-OPER-UNT-ID               10570000
105800            UNION                                                 10580000
105900           SELECT 'B'                                             10590000
106000             ,A.PO_NBR                                            10600000
106100             ,A.RCVR_SEQ_NBR                                      10610000
106200             ,A.CRE_BY_USR_ID                                     10620000
106300             ,A.CRE_TMST                                          10630000
106400             ,A.DC_FUNC_CDE                                       10640000
106500             ,A.LOC_NBR                                           10650000
106600             ,A.PO_LNE_NBR                                        10660000
106700             ,A.PREPK_ID                                          10670000
106800             ,A.CRE_BY_PGM_NM                                     10680000
106900             ,A.LAST_UPD_TMST                                     10690000
107000             ,A.PKSL_SEQ_NBR                                      10700000
107100             ,B.DC_FUNC_DESC                                      10710000
107200             ,B.SHRT_DC_FUNC_DESC                                 10720000
107300             ,' '                                                 10730000
107400             ,A.DEST_LOC_NBR                                      10740000
107500            FROM RCT_PO_RCVR_TRKG A                               10750000
107600               , RCT_DC_FUNC      B                               10760000
107700           WHERE A.PO_NBR        = :DK-PO-NBR                     10770000
107800             AND A.RCVR_SEQ_NBR  = 0                              10780000
107900             AND A.LOC_NBR       = :DK-OPER-UNT-ID                10790000
108000             AND A.DC_FUNC_CDE   = B.DC_FUNC_CDE                  10800000
108100          ORDER BY                                                10810000
108200             3,8,9,5                                              10820000
108300     END-EXEC.                                                    10830000
108400                                                                  10840000
108500     EXEC SQL                                                     10850000
108600          DECLARE USER-CSR CURSOR                                 10860000
108700          FOR SELECT 'A'                                          10870000
108800          ,  A.PO_NBR                                             10880000
108900          ,  A.RCVR_SEQ_NBR                                       10890000
109000          ,  A.CRE_BY_USR_ID                                      10900000
109100          ,  A.CRE_TMST                                           10910000
109200          ,  A.DC_FUNC_CDE                                        10920000
109300          ,  A.LOC_NBR                                            10930000
109400          ,  A.PO_LNE_NBR                                         10940000
109500          ,  A.PREPK_ID                                           10950000
109600          ,  A.CRE_BY_PGM_NM                                      10960000
109700          ,  A.LAST_UPD_TMST                                      10970000
109800          ,  A.PKSL_SEQ_NBR                                       10980000
109900          ,  B.DC_FUNC_DESC                                       10990000
110000          ,  B.SHRT_DC_FUNC_DESC                                  11000000
110100          ,  C.PKGNG_CDE                                          11010000
110200          ,  A.DEST_LOC_NBR                                       11020000
110300          FROM                                                    11030000
110400             RCT_PO_RCVR_TRKG A                                   11040000
110500          ,  RCT_DC_FUNC B                                        11050000
110600          ,  TRECEIV     C                                        11060000
110700          WHERE  A.CRE_BY_USR_ID  = :DK-CRE-BY-USR-ID             11070000
110800             AND A.DC_FUNC_CDE     = B.DC_FUNC_CDE                11080000
110900             AND A.PO_NBR          = C.ORD_NBR                    11090000
111000             AND A.RCVR_SEQ_NBR    = C.REC_SEQ_NBR                11100000
111100             AND A.LOC_NBR        = :DK-OPER-UNT-ID               11110000
111200            UNION                                                 11120000
111300           SELECT 'B'                                             11130000
111400             ,A.PO_NBR                                            11140000
111500             ,A.RCVR_SEQ_NBR                                      11150000
111600             ,A.CRE_BY_USR_ID                                     11160000
111700             ,A.CRE_TMST                                          11170000
111800             ,A.DC_FUNC_CDE                                       11180000
111900             ,A.LOC_NBR                                           11190000
112000             ,A.PO_LNE_NBR                                        11200000
112100             ,A.PREPK_ID                                          11210000
112200             ,A.CRE_BY_PGM_NM                                     11220000
112300             ,A.LAST_UPD_TMST                                     11230000
112400             ,A.PKSL_SEQ_NBR                                      11240000
112500             ,B.DC_FUNC_DESC                                      11250000
112600             ,B.SHRT_DC_FUNC_DESC                                 11260000
112700             ,' '                                                 11270000
112800             ,A.DEST_LOC_NBR                                      11280000
112900            FROM RCT_PO_RCVR_TRKG A                               11290000
113000               , RCT_DC_FUNC      B                               11300000
113100           WHERE A.RCVR_SEQ_NBR  = 0                              11310000
113200             AND A.LOC_NBR       = :DK-OPER-UNT-ID                11320000
113300             AND A.CRE_BY_USR_ID = :DK-CRE-BY-USR-ID              11330000
113400             AND A.DC_FUNC_CDE   = B.DC_FUNC_CDE                  11340000
113500          ORDER BY                                                11350000
113600             2,3,8,9,5                                            11360000
113700     END-EXEC.                                                    11370000
113800                                                                  11380000
113900     EXEC SQL                                                     11390000
114000          DECLARE USER-DATE-CSR CURSOR                            11400000
114100          FOR SELECT 'A'                                          11410000
114200          ,  A.PO_NBR                                             11420000
114300          ,  A.RCVR_SEQ_NBR                                       11430000
114400          ,  A.CRE_BY_USR_ID                                      11440000
114500          ,  A.CRE_TMST                                           11450000
114600          ,  A.DC_FUNC_CDE                                        11460000
114700          ,  A.LOC_NBR                                            11470000
114800          ,  A.PO_LNE_NBR                                         11480000
114900          ,  A.PREPK_ID                                           11490000
115000          ,  A.CRE_BY_PGM_NM                                      11500000
115100          ,  A.LAST_UPD_TMST                                      11510000
115200          ,  A.PKSL_SEQ_NBR                                       11520000
115300          ,  B.DC_FUNC_DESC                                       11530000
115400          ,  B.SHRT_DC_FUNC_DESC                                  11540000
115500          ,  C.PKGNG_CDE                                          11550000
115600          ,  A.DEST_LOC_NBR                                       11560000
115700          FROM                                                    11570000
115800             RCT_PO_RCVR_TRKG A                                   11580000
115900          ,  RCT_DC_FUNC B                                        11590000
116000          ,  TRECEIV     C                                        11600000
116100          WHERE  A.CRE_BY_USR_ID  = :DK-CRE-BY-USR-ID             11610000
116200             AND A.CRE_TMST       >= :DK-DATE-FROM-TIMESTAMP      11620000
116300             AND A.CRE_TMST       <= :DK-DATE-TO-TIMESTAMP        11630000
116400             AND A.DC_FUNC_CDE     = B.DC_FUNC_CDE                11640000
116500             AND A.PO_NBR          = C.ORD_NBR                    11650000
116600             AND A.RCVR_SEQ_NBR    = C.REC_SEQ_NBR                11660000
116700             AND A.LOC_NBR        = :DK-OPER-UNT-ID               11670000
116800            UNION                                                 11680000
116900           SELECT 'B'                                             11690000
117000             ,A.PO_NBR                                            11700000
117100             ,A.RCVR_SEQ_NBR                                      11710000
117200             ,A.CRE_BY_USR_ID                                     11720000
117300             ,A.CRE_TMST                                          11730000
117400             ,A.DC_FUNC_CDE                                       11740000
117500             ,A.LOC_NBR                                           11750000
117600             ,A.PO_LNE_NBR                                        11760000
117700             ,A.PREPK_ID                                          11770000
117800             ,A.CRE_BY_PGM_NM                                     11780000
117900             ,A.LAST_UPD_TMST                                     11790000
118000             ,A.PKSL_SEQ_NBR                                      11800000
118100             ,B.DC_FUNC_DESC                                      11810000
118200             ,B.SHRT_DC_FUNC_DESC                                 11820000
118300             ,' '                                                 11830000
118400             ,A.DEST_LOC_NBR                                      11840000
118500            FROM RCT_PO_RCVR_TRKG A                               11850000
118600               , RCT_DC_FUNC      B                               11860000
118700           WHERE A.RCVR_SEQ_NBR  = 0                              11870000
118800             AND A.LOC_NBR       = :DK-OPER-UNT-ID                11880000
118900             AND A.CRE_BY_USR_ID = :DK-CRE-BY-USR-ID              11890000
119000             AND A.CRE_TMST       >= :DK-DATE-FROM-TIMESTAMP      11900000
119100             AND A.CRE_TMST       <= :DK-DATE-TO-TIMESTAMP        11910000
119200             AND A.DC_FUNC_CDE   = B.DC_FUNC_CDE                  11920000
119300          ORDER BY                                                11930000
119400             2,3,8,9,5                                            11940000
119500     END-EXEC.                                                    11950000
119600                                                                  11960000
119700                                                                  11970000
119800 EJECT                                                            11980000
119900 LINKAGE SECTION.                                                 11990000
120000                                                                  12000000
120100 01  DFHCOMMAREA.                                                 12010000
120200     05  FILLER                         OCCURS  1 TO 4072 TIMES   12020000
120300                                        DEPENDING ON EIBCALEN.    12030000
120400         10  FILLER                     PIC X.                    12040000
120500                                                                  12050000
120600 EJECT                                                            12060000
120700 PROCEDURE DIVISION.                                              12070000
120800******************************************************************12080000
120900**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **12090000
121000**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **12100000
121100**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **12110000
121200******************************************************************12120000
121300 0000-MAIN-MODULE.                                                12130000
121400     INITIALIZE DP030-CICS-API-FIELDS.                            12140000
121500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       12150000
121600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          12160000
121700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         12170000
121800     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       12180000
121900     MOVE LENGTH OF RC837AI        TO DP030-MAP-LENGTH (1).       12190000
122000     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     12200000
122100     PERFORM 0001-CALL-CICS-ARCH-API.                             12210000
122200*                                                                 12220000
122300     PERFORM 1000-CONTROL-PROCESSING                              12230000
122400*                                                                 12240000
122500     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     12250000
122600     PERFORM 0001-CALL-CICS-ARCH-API.                             12260000
122700                                                                  12270000
122800******************************************************************12280000
122900**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **12290000
123000**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **12300000
123100******************************************************************12310000
123200 0001-CALL-CICS-ARCH-API.                                         12320000
123310     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      12331003
123400                                    DFHCOMMAREA                   12340003
123500                                    DP030-CICS-API-FIELDS         12350003
123600                                    DP020-STANDARD-COMMAREA       12360003
123700                                    RC837AI.                      12370003
123800*                                                                 12380000
123900     IF  DP030-RC-CALL-SUCCESSFUL                                 12390000
124000         CONTINUE                                                 12400000
124100     ELSE                                                         12410000
124200         SET DP013-NO-ROLLBACK                                    12420000
124300             DP013-XCTL-DISPLAY-RESTART                           12430000
124400             DP013-CICS-ABEND      TO TRUE                        12440000
124500         MOVE '0001-CALL-CICS-ARCH-API'                           12450000
124600                                   TO DP013-PARAGRAPH             12460000
124620         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O12462003
124630-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      12463003
124900         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      12490000
125000         PERFORM DP013-0000-PROCESS-ABEND                         12500000
125100     END-IF.                                                      12510000
125200*----------------------------------------------------------------*12520000
125300* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *12530000
125400* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *12540000
125500*                                                                *12550000
125600* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *12560000
125700*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *12570000
125800*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *12580000
125900*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *12590000
126000*----------------------------------------------------------------*12600000
126100                                                                  12610000
126200 1000-CONTROL-PROCESSING.                                         12620000
126300                                                                  12630000
126400     EVALUATE TRUE                                                12640000
126500         WHEN DP020-NEXT-ACT-INITIAL                              12650000
126600             INITIALIZE ASC-SPECIFIC-COMMAREA                     12660000
126700             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            12670000
126800                                      ASC-SEL-TERM-ID             12680000
126900             MOVE DP020-SRC-TASK-NUMBER                           12690000
127000                                   TO ASC-LIST-TASK-NUMBER        12700000
127100                                      ASC-SEL-TASK-NUMBER         12710000
127200             MOVE PC-LIST-QUEUE-SEQ                               12720000
127300                                   TO ASC-LIST-SEQ                12730000
127400             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 12740000
127500             PERFORM 1100-PROCESS-INTER-APPL-COMM                 12750000
127600***-----$TEMPLATE NOTE$-------------------------------------------12760000
127700*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,12770000
127800*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  12780000
127900*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.12790000
128000***---------------------------------------------------------------12800000
128100             IF  PS-COMMAREA-NOT-VALID                            12810000
128200***              MOVE PC-TSYMSG-99901                             12820000
128300***                                TO DP020-MSG-NUMBER            12830000
128400***              SET DP020-MSG-FATAL                              12840000
128500***                                TO TRUE                        12850000
128600                 SET DP020-NEXT-ACT-APPL-ERROR                    12860000
128700                                   TO TRUE                        12870000
128800             ELSE                                                 12880000
128900                 PERFORM 4000-BUILD-INITIAL-PANEL                 12890000
129000             END-IF                                               12900000
129100                                                                  12910000
129200         WHEN DP020-NEXT-ACT-READ-MAP                             12920000
129300             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        12930000
129400                                   TO PV-TOP-ITEM                 12940000
129500             PERFORM 2000-PROCESS-PANEL                           12950000
129600                                                                  12960000
129700         WHEN DP020-NEXT-ACT-RETURN                               12970000
129800             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        12980000
129900                                   TO PV-TOP-ITEM                 12990000
130000             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    13000000
130100             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 13010000
130200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13020000
130300*            PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13030000
130400                                                                  13040000
130500         WHEN OTHER                                               13050000
130600             SET DP013-LOGIC-ABEND TO TRUE                        13060000
130700             SET DP013-NO-ROLLBACK TO TRUE                        13070000
130800             MOVE '1000-CONTROL-PROCESSING'                       13080000
130900                                   TO DP013-PARAGRAPH             13090000
131000             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    13100000
131100                                   TO DP013-MESSAGE-TEXT(1)       13110000
131200             PERFORM DP013-0000-PROCESS-ABEND                     13120000
131300     END-EVALUATE.                                                13130000
131400                                                                  13140000
131500 EJECT                                                            13150000
131600*----------------------------------------------------------------*13160000
131700* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *13170000
131800* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *13180000
131900*----------------------------------------------------------------*13190000
132000                                                                  13200000
132100 1100-PROCESS-INTER-APPL-COMM.                                    13210000
132200                                                                  13220000
132300     SET PS-COMMAREA-VALID         TO TRUE.                       13230000
132400     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     13240000
132500     EVALUATE DP020-INT-APPL-FORMAT-IND                           13250000
132600         WHEN PC-INTER-APPL-CRIT-SPEC                             13260000
132700             MOVE RC836-OPER-UNIT-ID   TO ASC-OPER-UNIT-ID        13270000
132800             IF ASC-OPER-UNIT-ID NOT EQUAL 0                      13280000
132900                 MOVE ASC-OPER-UNIT-ID-N   TO DK-OPER-UNT-ID      13290000
133000                 PERFORM 1500-SELECT-OPER-UNIT                    13300000
133100                 MOVE PV-FCLTY-NME     TO ASC-OPER-DESC           13310000
133200             ELSE                                                 13320000
133300                 MOVE SPACES           TO ASC-OPER-DESC           13330000
133400             END-IF                                               13340000
133500                                                                  13350000
133600             MOVE RC836-FROM-DATE-MM   TO ASC-FROM-DATE-MM        13360000
133700             MOVE RC836-FROM-DATE-DD   TO ASC-FROM-DATE-DD        13370000
133800             MOVE RC836-FROM-DATE-YY   TO ASC-FROM-DATE-YY        13380000
133900                                                                  13390000
134000             MOVE RC836-PO             TO ASC-PO                  13400000
134100             MOVE RC836-RECEIVER-SEQ   TO ASC-RECEIVER-SEQ        13410000
134200                                                                  13420000
134300             MOVE RC836-TO-DATE-MM     TO ASC-TO-DATE-MM          13430000
134400             MOVE RC836-TO-DATE-DD     TO ASC-TO-DATE-DD          13440000
134500             MOVE RC836-TO-DATE-YY     TO ASC-TO-DATE-YY          13450000
134600                                                                  13460000
134700             MOVE RC836-LINE-NBR       TO ASC-LINE-NUMBER         13470000
134800             MOVE RC836-PACK-NBR       TO ASC-PACK-NUMBER         13480000
134900             MOVE RC836-USER-ID        TO ASC-USER-ID             13490000
135000                                                                  13500000
135100                                                                  13510000
135200         WHEN OTHER                                               13520000
135300             IF  DP020-NAV-KEY-DATA > SPACE                       13530000
135400                 PERFORM 1110-EDIT-NAV-KEY                        13540000
135500             ELSE                                                 13550000
135600                 MOVE PC-TSYMSG-00148                             13560000
135700                                   TO DP020-MSG-NUMBER            13570000
135800                 SET DP020-MSG-FATAL                              13580000
135900                     DP020-NEXT-ACT-APPL-ERROR                    13590000
136000                                   TO TRUE                        13600000
136100             END-IF                                               13610000
136200     END-EVALUATE.                                                13620000
136300                                                                  13630000
136400******************************************************************13640000
136500** EDIT THE KEY ENTERED BY THE USER INTO THE KEY FIELD OF THE   **13650000
136600** COMMAND LINE.  A VALID MESSAGE NUMBER IS THE ONLY KEY        **13660000
136700** ACCEPTED.                                                    **13670000
136800******************************************************************13680000
136900 1110-EDIT-NAV-KEY.                                               13690000
137000*----------------------------------------------------------------*13700000
137100* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *13710000
137200* STORAGE QUEUE PASSED FROM THE LIST.                            *13720000
137300*----------------------------------------------------------------*13730000
137400 1120-PREPARE-LIST-ENTRY.                                         13740000
137500*    MOVE SU025-MAX-ITEMS          TO ASC-SEL-SUB.                13750000
137600     MOVE RC013-MAX-ITEMS          TO ASC-SEL-SUB.                13760000
137700     MOVE ZERO                     TO ASC-SEL-ITEM.               13770000
137800     PERFORM 2300-GET-NEXT-RECORD.                                13780000
137900 EJECT                                                            13790000
138000                                                                  13800000
138100                                                                  13810000
138200 1500-SELECT-OPER-UNIT.                                           13820000
138300                                                                  13830000
138400                                                                  13840000
138500     INITIALIZE XL071-COMMAREA-REC.                               13850000
138600     MOVE DK-OPER-UNT-ID  TO XL071-LOCATION-NUMBER.               13860000
138700                                                                  13870000
138800     CALL PC-LOCATION-MODULE  USING                               13880000
138900                                    DFHEIBLK                      13890000
139000                                    XL071-COMMAREA                13900000
139100                                    XL071-COMMAREA-REC.           13910000
139200                                                                  13920000
139300     IF XL071-NO-ERRORS                                           13930000
139400         IF XL071-LOC-TYP-CDE = 'DC'                              13940000
139500             MOVE XL071-LOC-NM  TO  PV-FCLTY-NME                  13950000
139600         ELSE                                                     13960000
139700             MOVE SPACES        TO  PV-FCLTY-NME                  13970000
139800         END-IF                                                   13980000
139900     ELSE                                                         13990000
140000         MOVE SPACES        TO  PV-FCLTY-NME                      14000000
140100     END-IF.                                                      14010000
140200                                                                  14020000
140300*----------------------------------------------------------------*14030000
140400* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *14040000
140500* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *14050000
140600* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *14060000
140700* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *14070000
140800* FUNCTION KEYS CAN GET THIS FAR.                                *14080000
140900*----------------------------------------------------------------*14090000
141000                                                                  14100000
141100 2000-PROCESS-PANEL.                                              14110000
141200     EVALUATE TRUE                                                14120000
141300         WHEN DP020-SRC-AID = DP016-CLEAR                         14130000
141400             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    14140000
141500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   14150000
141600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14160000
141700*F5                                                               14170000
141800         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    14180000
141900             MOVE ASC-CURSOR-TYPE-SW TO PS-CURSOR-TYPE-SW         14190000
142000             PERFORM 2050-DELETE-LIST-QUEUE                       14200000
142100             PERFORM 4000-BUILD-INITIAL-PANEL                     14210000
142200                                                                  14220000
142300*F8                                                               14230000
142400         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             14240000
142500             IF ASC-USE-SELECTION-QUEUE                           14250000
142600                 PERFORM 2300-GET-NEXT-RECORD                     14260000
142700                 IF PS-LIST-END                                   14270000
142800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         14280000
142900                     SET PS-NO-LIST-END TO TRUE                   14290000
143000                 ELSE                                             14300000
143100                     PERFORM 2050-DELETE-LIST-QUEUE               14310000
143200                     PERFORM 3200-RESET-ATTRIBUTES                14320000
143300             MOVE ASC-CURSOR-TYPE-SW TO PS-CURSOR-TYPE-SW         14330000
143400                     PERFORM 4000-BUILD-INITIAL-PANEL             14340000
143500                 END-IF                                           14350000
143600              ELSE                                                14360000
143700*                --- BOTTOM OF LIST ---                           14370000
143800                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         14380000
143900                 SET DP020-MSG-INFORMATIONAL TO TRUE              14390000
144000             END-IF                                               14400000
144100                                                                  14410000
144200*F7                                                               14420000
144300         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             14430000
144400             IF ASC-USE-SELECTION-QUEUE                           14440000
144500                 PERFORM 2310-GET-PREV-RECORD                     14450000
144600                 IF PS-LIST-END                                   14460000
144700                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         14470000
144800                     SET PS-NO-LIST-END TO TRUE                   14480000
144900                 ELSE                                             14490000
145000                     PERFORM 2050-DELETE-LIST-QUEUE               14500000
145100                     PERFORM 3200-RESET-ATTRIBUTES                14510000
145200             MOVE ASC-CURSOR-TYPE-SW TO PS-CURSOR-TYPE-SW         14520000
145300                     PERFORM 4000-BUILD-INITIAL-PANEL             14530000
145400                 END-IF                                           14540000
145500             ELSE                                                 14550000
145600                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         14560000
145700                 SET DP020-MSG-INFORMATIONAL TO TRUE              14570000
145800             END-IF                                               14580000
145900                                                                  14590000
146000         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    14600000
146100             PERFORM 2140-DESELECT-ALL-ITEMS                      14610000
146200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14620000
146300                                                                  14630000
146400*F21                                                              14640000
146500         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  14650000
146600             PERFORM 2150-SELECT-ALL-ITEMS                        14660000
146700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14670000
146800                                                                  14680000
146900         WHEN OTHER                                               14690000
147000             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 14700000
147100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   14710000
147200             IF  PS-NO-ERROR                                      14720000
147300                 SET DP030-CONTINUE-GO                            14730000
147400                                 TO TRUE                          14740000
147500                 PERFORM 2100-CHECK-FUNCTION-KEY                  14750000
147600             ELSE                                                 14760000
147700                 SET DP030-OVERRIDE-GO                            14770000
147800                                 TO TRUE                          14780000
147900             END-IF                                               14790000
148000     END-EVALUATE.                                                14800000
148100 EJECT                                                            14810000
148200*----------------------------------------------------------------*14820000
148300*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *14830000
148400*----------------------------------------------------------------*14840000
148500 2050-DELETE-LIST-QUEUE.                                          14850000
148600                                                                  14860000
148700     EXEC CICS                                                    14870000
148800         DELETEQ TS                                               14880000
148900             QUEUE (ASC-LIST-QUEUE-NAME)                          14890000
149000             RESP  (PV-CICS-RESP)                                 14900000
149100     END-EXEC.                                                    14910000
149200                                                                  14920000
149300     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       14930000
149400        (PV-CICS-RESP = DFHRESP(QIDERR))                          14940000
149500         CONTINUE                                                 14950000
149600     ELSE                                                         14960000
149700         SET DP013-CICS-ABEND      TO TRUE                        14970000
149800         SET DP013-NO-ROLLBACK     TO TRUE                        14980000
149900                                                                  14990000
150000         MOVE '2050-DELETE-LIST-QUEUE'                            15000000
150100                                   TO DP013-PARAGRAPH             15010000
150200         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    15020000
150300                                   TO DP013-MESSAGE-TEXT (1)      15030000
150400         PERFORM DP013-0000-PROCESS-ABEND                         15040000
150500     END-IF.                                                      15050000
150600                                                                  15060000
150700     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  15070000
150800 EJECT                                                            15080000
150900*----------------------------------------------------------------*15090000
151000* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*15100000
151100* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *15110000
151200* CICS ARCHITECTURE API.                                         *15120000
151300*----------------------------------------------------------------*15130000
151400 2100-CHECK-FUNCTION-KEY.                                         15140000
151500     EVALUATE TRUE                                                15150000
151600                                                                  15160000
151700* F14 - SU-AUDIT RESULTS DETAIL (LOCAL-FUNC-01) - SUKCS590        15170000
151800*                                                                 15180000
151900* F24 - RC-PACK SLIP HEADER INQUIRY (LOCAL-FUNC-01) - RCKCS267    15190000
152000         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              15200000
152100             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              15210000
152200                 INITIALIZE RC015-INTER-APPL-COMMAREA             15220000
152300                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                15230000
152400                                TO RC015-NUMBER-OF-SELECTED-ITEMS 15240000
152500                                                                  15250000
152600                 SET PS-NO-ERROR TO TRUE                          15260000
152700                 PERFORM 5200A-FILL-SEL-QUEUE-RECORD              15270000
152800                  VARYING PV-ITEM                                 15280000
152900                     FROM 1 BY 1                                  15290000
153000                  UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN 15300000
153100                 IF PS-NO-ERROR                                   15310000
153200                    MOVE ASC-OPER-UNIT-ID-N                       15320000
153300                               TO DK-OPER-UNT-ID                  15330000
153400                    MOVE DK-OPER-UNT-ID                           15340000
153500                               TO RC015-OPER-UNT-ID               15350000
153600                    MOVE PC-FCLTY-ID TO RC015-FCLTY-ID            15360000
153700                    PERFORM 5000-PREPARE-SEL-QUEUE                15370000
153800                 ELSE                                             15380000
153900                    SET DP030-OVERRIDE-GO  TO TRUE                15390000
154000                    MOVE PC-TSYMSG-03414   TO DP020-MSG-NUMBER    15400000
154100                    SET DP020-MSG-WARNING  TO TRUE                15410000
154200                 END-IF                                           15420000
154300             ELSE                                                 15430000
154400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15440000
154500                 SET DP030-OVERRIDE-GO  TO TRUE                   15450000
154600                 MOVE PC-TSYMSG-00057   TO DP020-MSG-NUMBER       15460000
154700                 SET DP020-MSG-WARNING  TO TRUE                   15470000
154800             END-IF                                               15480000
154900                                                                  15490000
155000*                                                                 15500000
155100* F6 - FIRST PAGE                                                 15510000
155200*                                                                 15520000
155300         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  15530000
155400             MOVE +1               TO PV-TOP-ITEM                 15540000
155500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15550000
155600                                                                  15560000
155700*                                                                 15570000
155800* F7 - PREVIOUS PAGE                                              15580000
155900*                                                                 15590000
156000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   15600000
156100             PERFORM 2110-BROWSE-BACKWARD                         15610000
156200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15620000
156300                                                                  15630000
156400*                                                                 15640000
156500* F8 - NEXT PAGE                                                  15650000
156600*                                                                 15660000
156700         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   15670000
156800             PERFORM 2120-BROWSE-FORWARD                          15680000
156900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15690000
157000                                                                  15700000
157100*                                                                 15710000
157200* ENTER KEY                                                       15720000
157300*                                                                 15730000
157400         WHEN DP020-SRC-AID = DP016-ENTER                         15740000
157500             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   15750000
157600             IF  PS-ERROR                                         15760000
157700                 CONTINUE                                         15770000
157800             ELSE                                                 15780000
157900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15790000
158000             END-IF                                               15800000
158100                                                                  15810000
158200         WHEN OTHER                                               15820000
158300             PERFORM 2050-DELETE-LIST-QUEUE                       15830000
158400             MOVE ASC-CURSOR-TYPE-SW TO PS-CURSOR-TYPE-SW         15840000
158500             PERFORM 4000-BUILD-INITIAL-PANEL                     15850000
158600             PERFORM 3200-RESET-ATTRIBUTES                        15860000
158700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15870000
158800     END-EVALUATE.                                                15880000
158900                                                                  15890000
159000*----------------------------------------------------------------*15900000
159100* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     15910000
159200*----------------------------------------------------------------*15920000
159300 2105-RACF-ACCESS.                                                15930000
159400                                                                  15940000
159500      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  15950000
159600      SET DP008-ACCESS-TYPE-USE          TO TRUE                  15960000
159700                                                                  15970000
159800      EXEC CICS                                                   15980000
159900         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 15990000
160000              COMMAREA (DP008-SECURITY-COMMAREA)                  16000000
160100              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             16010000
160200      END-EXEC                                                    16020000
160300                                                                  16030000
160400      IF DP008-CALL-SUCCESSFUL                                    16040000
160500         IF DP008-ACCESS-ALLOWED                                  16050000
160600             SET PS-ACCESS-ALLOWED TO TRUE                        16060000
160700         ELSE                                                     16070000
160800             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    16080000
160900         END-IF                                                   16090000
161000     ELSE                                                         16100000
161100         MOVE '2105-RACF-ACCESS'                                  16110000
161200                               TO DP013-PARAGRAPH                 16120000
161300          MOVE 'UNABLE TO ACCESS CICS'                            16130000
161400                               TO DP013-MESSAGE-TEXT (1)          16140000
161500          MOVE SQLCA                 TO DP013-SQLCA               16150000
161600          SET DP013-DB2-ABEND                                     16160000
161700              DP013-XCTL-DISPLAY-RESTART                          16170000
161800                               TO TRUE                            16180000
161900          PERFORM DP013-0000-PROCESS-ABEND                        16190000
162000      END-IF.                                                     16200000
162100                                                                  16210000
162200*                                                                 16220000
162300*----------------------------------------------------------------*16230000
162400*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *16240000
162500*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *16250000
162600*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *16260000
162700*    MESSAGE.                                                    *16270000
162800*----------------------------------------------------------------*16280000
162900                                                                  16290000
163000 2110-BROWSE-BACKWARD.                                            16300000
163100     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    16310000
163200         GIVING PV-TOP-ITEM.                                      16320000
163300*                                                                 16330000
163400     IF  ((PV-TOP-ITEM < +1)                                      16340000
163500       OR (PV-TOP-ITEM = +1))                                     16350000
163600         MOVE +1                   TO PV-TOP-ITEM                 16360000
163700*        -- TOP OF LIST --                                        16370000
163800         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            16380000
163900         SET DP020-MSG-INFORMATIONAL TO TRUE                      16390000
164000     END-IF.                                                      16400000
164100                                                                  16410000
164200 EJECT                                                            16420000
164300*----------------------------------------------------------------*16430000
164400*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *16440000
164500*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *16450000
164600*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *16460000
164700*----------------------------------------------------------------*16470000
164800                                                                  16480000
164900 2120-BROWSE-FORWARD.                                             16490000
165000                                                                  16500000
165100     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              16510000
165200         GIVING PV-TOP-ITEM.                                      16520000
165300     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   16530000
165400         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            16540000
165500                                   TO PV-TOP-ITEM                 16550000
165600*        -- BOTTOM OF LIST --                                     16560000
165700         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            16570000
165800         SET DP020-MSG-INFORMATIONAL                              16580000
165900                                   TO TRUE                        16590000
166000     ELSE                                                         16600000
166100         COMPUTE PV-BOTTOM-ITEM =                                 16610000
166200             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 16620000
166300         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            16630000
166400*            -- BOTTOM OF LIST --                                 16640000
166500             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            16650000
166600             SET DP020-MSG-INFORMATIONAL                          16660000
166700                                   TO TRUE                        16670000
166800         END-IF                                                   16680000
166900     END-IF.                                                      16690000
167000 EJECT                                                            16700000
167100*----------------------------------------------------------------*16710000
167200*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *16720000
167300*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *16730000
167400*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *16740000
167500*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *16750000
167600*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *16760000
167700*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *16770000
167800*----------------------------------------------------------------*16780000
167900                                                                  16790000
168000 2130-CHECK-FOR-JUMP-BROWSE.                                      16800000
168100     SET PS-NO-ERROR               TO TRUE.                       16810000
168200     IF (ASC-START-ITEM-REQUEST = SPACE)                          16820000
168300         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            16830000
168400                                   TO PV-TOP-ITEM                 16840000
168500     ELSE                                                         16850000
168600         MOVE ASC-START-ITEM-REQUEST                              16860000
168700                                   TO DP010I-UNEDITED-FIELD       16870000
168800         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       16880000
168900         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     16890000
169000         SET DP010I-NEGATIVE-NOT-ALLOWED                          16900000
169100                                   TO TRUE                        16910000
169200         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16920003
169210              USING DP010I-NUMERIC-EDIT-AREA                      16921003
169300                                                                  16930000
169400         IF  NOT DP010I-ERROR-DETECTED                            16940000
169500             MOVE DP010I-NUMERIC-FIELD                            16950000
169600                                   TO  ASC-START-ITEM-REQUEST-N   16960000
169700             IF  ASC-START-ITEM-REQUEST-N > ZERO                  16970000
169800                 IF  ASC-START-ITEM-REQUEST-N >                   16980000
169900                                          ASC-NUMBER-OF-ITEMS-READ16990000
170000                     MOVE SPACE TO ASC-START-ITEM-REQUEST         17000000
170100                     COMPUTE PV-TOP-ITEM =                        17010000
170200                             ASC-NUMBER-OF-ITEMS-READ             17020000
170300                             - PC-ITEMS-PER-PANEL + 1             17030000
170400                     IF  PV-TOP-ITEM < +1                         17040000
170500                         MOVE +1   TO PV-TOP-ITEM                 17050000
170600                         MOVE PC-TSYMSG-00070                     17060000
170700                                   TO DP020-MSG-NUMBER            17070000
170800                         SET DP020-MSG-INFORMATIONAL              17080000
170900                                   TO TRUE                        17090000
171000                     END-IF                                       17100000
171100                 ELSE                                             17110000
171200                     MOVE ASC-START-ITEM-REQUEST-N                17120000
171300                                   TO PV-TOP-ITEM                 17130000
171400                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      17140000
171500                     COMPUTE PV-BOTTOM-ITEM =                     17150000
171600                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     17160000
171700                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ17170000
171800*                        -- BOTTOM OF LIST --                     17180000
171900                         MOVE PC-TSYMSG-00070                     17190000
172000                                   TO DP020-MSG-NUMBER            17200000
172100                         SET DP020-MSG-INFORMATIONAL              17210000
172200                                   TO TRUE                        17220000
172300                     END-IF                                       17230000
172400                 END-IF                                           17240000
172500             ELSE                                                 17250000
172600*                --- VALUE OUT OF RANGE ----                      17260000
172700                 MOVE PC-TSYMSG-00101                             17270000
172800                                   TO DP020-MSG-NUMBER            17280000
172900                 MOVE -1           TO ASTRTITL                    17290000
173000                 SET DP030-SET-CURSOR-APPL-1                      17300000
173100                                   TO TRUE                        17310000
173200                 MOVE DP015-REVERSE                               17320000
173300                                   TO ASTRTITH                    17330000
173400                 MOVE DP015-RED    TO ASTRTITC                    17340000
173500                 MOVE DP015-UNP-NUM-BRT-MDT                       17350000
173600                                   TO ASTRTITA                    17360000
173700                 SET DP020-MSG-FATAL                              17370000
173800                                   TO TRUE                        17380000
173900                 SET PS-ERROR      TO TRUE                        17390000
174000             END-IF                                               17400000
174100                                                                  17410000
174200         ELSE                                                     17420000
174300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            17430000
174400             MOVE -1               TO ASTRTITL                    17440000
174500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17450000
174600             MOVE DP015-REVERSE    TO ASTRTITH                    17460000
174700             MOVE DP015-RED        TO ASTRTITC                    17470000
174800             MOVE DP015-UNP-NUM-BRT-MDT                           17480000
174900                                   TO ASTRTITA                    17490000
175000             SET DP020-MSG-FATAL   TO TRUE                        17500000
175100             SET PS-ERROR          TO TRUE                        17510000
175200         END-IF                                                   17520000
175300     END-IF.                                                      17530000
175400 EJECT                                                            17540000
175500*----------------------------------------------------------------*17550000
175600*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *17560000
175700*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *17570000
175800*----------------------------------------------------------------*17580000
175900 2140-DESELECT-ALL-ITEMS.                                         17590000
176000     MOVE +1                       TO ASC-BLK-SUB.                17600000
176100                                                                  17610000
176200     PERFORM 2141-CLEAR-SELECTED-INDS                             17620000
176300         VARYING ASC-ITEM-SUB                                     17630000
176400         FROM 1 BY 1                                              17640000
176500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17650000
176600                                                                  17660000
176700     ADD +1                        TO ASC-BLK-SUB.                17670000
176800                                                                  17680000
176900     PERFORM 2141-CLEAR-SELECTED-INDS                             17690000
177000         VARYING ASC-ITEM-SUB                                     17700000
177100         FROM 1 BY 1                                              17710000
177200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17720000
177300                                                                  17730000
177400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17740000
177500                                   TO PV-LIST-ITEM-NUMBER.        17750000
177600                                                                  17760000
177700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17770000
177800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    17780000
177900                                                                  17790000
178000     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     17800000
178100        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      17810000
178200         MOVE +1                   TO ASC-BLK-SUB                 17820000
178300                                                                  17830000
178400         PERFORM 5100-WRITE-TEMP-STORAGE                          17840000
178500                                                                  17850000
178600         MOVE +1                   TO PV-BLOCK-NUMBER             17860000
178700                                                                  17870000
178800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17880000
178900             PV-FIRST-BLOCK-IN-ARRAY - 1                          17890000
179000                                                                  17900000
179100         PERFORM                                                  17910000
179200             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       17920000
179300                                                                  17930000
179400             PERFORM 4410-READ-TEMP-STORAGE                       17940000
179500                                                                  17950000
179600             PERFORM 2141-CLEAR-SELECTED-INDS                     17960000
179700                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 17970000
179800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17980000
179900                                                                  17990000
180000             PERFORM 5100-WRITE-TEMP-STORAGE                      18000000
180100                                                                  18010000
180200             ADD +1                TO PV-BLOCK-NUMBER             18020000
180300                                                                  18030000
180400         END-PERFORM                                              18040000
180500                                                                  18050000
180600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18060000
180700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18070000
180800                                                                  18080000
180900         PERFORM                                                  18090000
181000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18100000
181100                   ASC-HIGHEST-BLOCK-WRITTEN                      18110000
181200                                                                  18120000
181300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          18130000
181400                                   TO PV-BLOCK-NUMBER             18140000
181500                                                                  18150000
181600             PERFORM 4410-READ-TEMP-STORAGE                       18160000
181700                                                                  18170000
181800             PERFORM 2141-CLEAR-SELECTED-INDS                     18180000
181900                 VARYING ASC-ITEM-SUB                             18190000
182000                 FROM 1 BY 1                                      18200000
182100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18210000
182200                                                                  18220000
182300             PERFORM 5100-WRITE-TEMP-STORAGE                      18230000
182400                                                                  18240000
182500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      18250000
182600                                                                  18260000
182700         END-PERFORM                                              18270000
182800                                                                  18280000
182900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18290000
183000                                   TO PV-BLOCK-NUMBER             18300000
183100                                                                  18310000
183200         PERFORM 4410-READ-TEMP-STORAGE                           18320000
183300     END-IF.                                                      18330000
183400                                                                  18340000
183500                                                                  18350000
183600     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 18360000
183700     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.18370000
183800     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  18380000
183900                                                                  18390000
184000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        18400000
184100                                                                  18410000
184200 EJECT                                                            18420000
184300*----------------------------------------------------------------*18430000
184400*    MARK EACH ITEM AS BEING NOT SELECTED.                       *18440000
184500*----------------------------------------------------------------*18450000
184600                                                                  18460000
184700 2141-CLEAR-SELECTED-INDS.                                        18470000
184800                                                                  18480000
184900     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           18490000
185000             NOT EQUAL ZERO                                       18500000
185100         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          18510000
185200             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          18520000
185300                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    18530000
185400                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  18540000
185500                                   TO TRUE                        18550000
185600         END-IF                                                   18560000
185700     END-IF.                                                      18570000
185800                                                                  18580000
185900 EJECT                                                            18590000
186000*----------------------------------------------------------------*18600000
186100*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *18610000
186200*  FOR ALL ITEMS.                                                *18620000
186300*----------------------------------------------------------------*18630000
186400                                                                  18640000
186500 2150-SELECT-ALL-ITEMS.                                           18650000
186600                                                                  18660000
186700     MOVE +1                       TO ASC-BLK-SUB.                18670000
186800                                                                  18680000
186900     PERFORM 2151-SET-SELECTED-INDS                               18690000
187000         VARYING ASC-ITEM-SUB                                     18700000
187100         FROM 1 BY 1                                              18710000
187200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18720000
187300                                                                  18730000
187400     ADD +1                        TO ASC-BLK-SUB.                18740000
187500                                                                  18750000
187600     PERFORM 2151-SET-SELECTED-INDS                               18760000
187700         VARYING ASC-ITEM-SUB                                     18770000
187800         FROM 1 BY 1                                              18780000
187900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18790000
188000                                                                  18800000
188100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               18810000
188200                                   TO PV-LIST-ITEM-NUMBER.        18820000
188300                                                                  18830000
188400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            18840000
188500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    18850000
188600                                                                  18860000
188700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     18870000
188800        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    18880000
188900         MOVE +1                   TO ASC-BLK-SUB                 18890000
189000                                                                  18900000
189100         PERFORM 5100-WRITE-TEMP-STORAGE                          18910000
189200                                                                  18920000
189300         MOVE +1                   TO PV-BLOCK-NUMBER             18930000
189400                                                                  18940000
189500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18950000
189600             PV-FIRST-BLOCK-IN-ARRAY - 1                          18960000
189700                                                                  18970000
189800         PERFORM                                                  18980000
189900             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       18990000
190000                                                                  19000000
190100             PERFORM 4410-READ-TEMP-STORAGE                       19010000
190200                                                                  19020000
190300             PERFORM 2151-SET-SELECTED-INDS                       19030000
190400                 VARYING ASC-ITEM-SUB                             19040000
190500                 FROM 1 BY 1                                      19050000
190600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19060000
190700                                                                  19070000
190800             PERFORM 5100-WRITE-TEMP-STORAGE                      19080000
190900                                                                  19090000
191000             ADD +1                TO PV-BLOCK-NUMBER             19100000
191100                                                                  19110000
191200         END-PERFORM                                              19120000
191300                                                                  19130000
191400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         19140000
191500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     19150000
191600                                                                  19160000
191700         PERFORM                                                  19170000
191800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       19180000
191900                   ASC-HIGHEST-BLOCK-WRITTEN                      19190000
192000                                                                  19200000
192100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          19210000
192200                                   TO PV-BLOCK-NUMBER             19220000
192300                                                                  19230000
192400             PERFORM 4410-READ-TEMP-STORAGE                       19240000
192500                                                                  19250000
192600             PERFORM 2151-SET-SELECTED-INDS                       19260000
192700                 VARYING ASC-ITEM-SUB                             19270000
192800                 FROM 1 BY 1                                      19280000
192900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19290000
193000                                                                  19300000
193100             PERFORM 5100-WRITE-TEMP-STORAGE                      19310000
193200                                                                  19320000
193300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      19330000
193400                                                                  19340000
193500         END-PERFORM                                              19350000
193600                                                                  19360000
193700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             19370000
193800                                   TO PV-BLOCK-NUMBER             19380000
193900                                                                  19390000
194000         PERFORM 4410-READ-TEMP-STORAGE                           19400000
194100     END-IF.                                                      19410000
194200                                                                  19420000
194300                                                                  19430000
194400     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             19440000
194500                       ASC-NUMBER-OF-SELECTED-ITEMS.              19450000
194600                                                                  19460000
194700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        19470000
194800                                                                  19480000
194900 EJECT                                                            19490000
195000*----------------------------------------------------------------*19500000
195100*    MARK EACH ITEM AS BEING SELECTED.                           *19510000
195200*----------------------------------------------------------------*19520000
195300                                                                  19530000
195400 2151-SET-SELECTED-INDS.                                          19540000
195500                                                                  19550000
195600     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           19560000
195700             NOT EQUAL ZERO                                       19570000
195800         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             19580000
195900             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             19590000
196000                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        19600000
196100                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  19610000
196200                               TO  TRUE                           19620000
196300         END-IF                                                   19630000
196400     END-IF.                                                      19640000
196500******************************************************************19650000
196600** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **19660000
196700** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **19670000
196800******************************************************************19680000
196900 2200-MOVE-SCREEN-TO-COMMAREA.                                    19690000
197000                                                                  19700000
197100     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             19710000
197200     MOVE +1                       TO PV-SUB.                     19720000
197300*                                                                 19730000
197400     PERFORM 3100-SET-SUBSCRIPTS.                                 19740000
197500     IF  ASTRTITL > ZERO                                          19750000
197600         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          19760000
197700     ELSE                                                         19770000
197800         IF  ASTRTITF = DP015-ERASE-EOF                           19780000
197900             INITIALIZE ASC-START-ITEM-REQUEST                    19790000
198000         END-IF                                                   19800000
198100     END-IF.                                                      19810000
198200     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          19820000
198300         VARYING PV-SUB                                           19830000
198400         FROM 1 BY 1                                              19840000
198500         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      19850000
198600******************************************************************19860000
198700** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**19870000
198800******************************************************************19880000
198900 2210-MOVE-LINES-TO-COMMAREA.                                     19890000
199000     IF  MR-SELECTL (PV-SUB) > ZERO                               19900000
199100         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             19910000
199200         MOVE MR-SELECTI (PV-SUB)                                 19920000
199300                                   TO ASC-TEMP-SELECTED-SW        19930000
199400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      19940000
199500     ELSE                                                         19950000
199600         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                19960000
199700                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     19970000
199800                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        19980000
199900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      19990000
200000         END-IF                                                   20000000
200100     END-IF.                                                      20010000
200200     ADD +1                        TO ASC-ITEM-SUB.               20020000
200300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        20030000
200400         ADD +1                    TO ASC-BLK-SUB                 20040000
200500         MOVE +1                   TO ASC-ITEM-SUB                20050000
200600     END-IF.                                                      20060000
200700                                                                  20070000
200800 2300-GET-NEXT-RECORD.                                            20080000
200900         ADD +1                    TO ASC-SEL-SUB                 20090000
201000*        IF ASC-SEL-SUB > SU025-MAX-ITEMS                         20100000
201100*            ADD +1                TO ASC-SEL-ITEM                20110000
201200*            MOVE +1               TO ASC-SEL-SUB                 20120000
201300*        END-IF                                                   20130000
201400*LMM FOR F24                                                      20140000
201500         IF ASC-SEL-SUB > RC013-MAX-ITEMS                         20150000
201600             ADD +1                TO ASC-SEL-ITEM                20160000
201700             MOVE +1               TO ASC-SEL-SUB                 20170000
201800         END-IF                                                   20180000
201900                                                                  20190000
202000         IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS             20200000
202100             PERFORM 9100-READ-SEL-QUEUE                          20210000
202200*            IF SU025-ITEM (ASC-SEL-SUB) > ZERO                   20220000
202300*                MOVE SU025-PO-RECEIVER (ASC-SEL-SUB)             20230000
202400*                                     TO ASC-PO-RECEIVER          20240000
202500*                INSPECT ASC-PO-NBR REPLACING ALL SPACES BY ZERO  20250000
202600*                MOVE ASC-PO-NBR-N    TO ASC-PO                   20260000
202700*                INSPECT ASC-RCVR REPLACING ALL SPACES BY ZERO    20270000
202800*                MOVE ASC-RCVR-N      TO ASC-RECEIVER-SEQ         20280000
202900*                SET SU025-INQ (ASC-SEL-SUB)                      20290000
203000*                                      TO TRUE                    20300000
203100*                PERFORM 9200-REWRITE-LIST-QUEUE                  20310000
203200*            ELSE                                                 20320000
203300*                SUBTRACT +1 FROM ASC-SEL-SUB                     20330000
203400*                --- BOTTOM OF LIST ---                           20340000
203500*                MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         20350000
203600*                SET DP020-MSG-INFORMATIONAL                      20360000
203700*                                      TO TRUE                    20370000
203800*            END-IF                                               20380000
203900*LMM FOR F24                                                      20390000
204000             IF RC013-ITEM (ASC-SEL-SUB) > ZERO                   20400000
204100                 MOVE RC013-PO-NBR (ASC-SEL-SUB)                  20410000
204200                                      TO ASC-PO-RECEIVER          20420000
204300                 INSPECT ASC-PO-NBR REPLACING ALL SPACES BY ZERO  20430000
204400                 MOVE ASC-PO-NBR-N    TO ASC-PO                   20440000
204500                 INSPECT ASC-RCVR REPLACING ALL SPACES BY ZERO    20450000
204600                 MOVE ASC-RCVR-N      TO ASC-RECEIVER-SEQ         20460000
204700                 SET RC013-INQ (ASC-SEL-SUB)                      20470000
204800                                       TO TRUE                    20480000
204900                 PERFORM 9200-REWRITE-LIST-QUEUE                  20490000
205000             ELSE                                                 20500000
205100                 SUBTRACT +1 FROM ASC-SEL-SUB                     20510000
205200*                --- BOTTOM OF LIST ---                           20520000
205300                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         20530000
205400                 SET DP020-MSG-INFORMATIONAL                      20540000
205500                                       TO TRUE                    20550000
205600             END-IF                                               20560000
205700         ELSE                                                     20570000
205800             SUBTRACT +1 FROM ASC-SEL-ITEM                        20580000
205900*            MOVE SU025-MAX-ITEMS  TO ASC-SEL-SUB                 20590000
206000*LMM FOR F24                                                      20600000
206100             MOVE RC013-MAX-ITEMS  TO ASC-SEL-SUB                 20610000
206200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            20620000
206300             SET DP020-MSG-INFORMATIONAL                          20630000
206400                                       TO TRUE                    20640000
206500         END-IF.                                                  20650000
206600                                                                  20660000
206700 2310-GET-PREV-RECORD.                                            20670000
206800     SUBTRACT +1                 FROM ASC-SEL-SUB.                20680000
206900     IF ASC-SEL-SUB < +1                                          20690000
207000         SUBTRACT +1             FROM ASC-SEL-ITEM                20700000
207100*        MOVE SU025-MAX-ITEMS      TO ASC-SEL-SUB                 20710000
207200*LMM FOR F24                                                      20720000
207300         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 20730000
207400     END-IF.                                                      20740000
207500*                                                                 20750000
207600*    MOVE SU024-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN       20760000
207700*    IF ASC-SEL-ITEM > ZERO                                       20770000
207800*        PERFORM 9100-READ-SEL-QUEUE                              20780000
207900*        MOVE SU025-PO-RECEIVER (ASC-SEL-SUB)                     20790000
208000*                                     TO ASC-PO-RECEIVER          20800000
208100*        INSPECT ASC-PO-NBR REPLACING ALL SPACES BY ZERO          20810000
208200*        MOVE ASC-PO-NBR-N            TO ASC-PO                   20820000
208300*        INSPECT ASC-RCVR REPLACING ALL SPACES BY ZERO            20830000
208400*        MOVE ASC-RCVR-N              TO ASC-RECEIVER-SEQ         20840000
208500*        SET SU025-INQ (ASC-SEL-SUB)  TO TRUE                     20850000
208600*        PERFORM 5120-REWRITE-LIST-QUEUE                          20860000
208700*    ELSE                                                         20870000
208800*            MOVE +1 TO  ASC-SEL-SUB                              20880000
208900*                        ASC-SEL-ITEM                             20890000
209000*            --- TOP OF LIST ---                                  20900000
209100*            MOVE PC-TSYMSG-00069  TO DP020-MSG-NUMBER            20910000
209200*            SET DP020-MSG-INFORMATIONAL                          20920000
209300*                                  TO TRUE                        20930000
209400*    END-IF.                                                      20940000
209500*LMM FOR F24                                                      20950000
209600     MOVE RC015-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN       20960000
209700     IF ASC-SEL-ITEM > ZERO                                       20970000
209800         PERFORM 9100-READ-SEL-QUEUE                              20980000
209900         MOVE RC013-PO-NBR (ASC-SEL-SUB)                          20990000
210000                                      TO ASC-PO-RECEIVER          21000000
210100         INSPECT ASC-PO-NBR REPLACING ALL SPACES BY ZERO          21010000
210200         MOVE ASC-PO-NBR-N            TO ASC-PO                   21020000
210300         INSPECT ASC-RCVR REPLACING ALL SPACES BY ZERO            21030000
210400         MOVE ASC-RCVR-N              TO ASC-RECEIVER-SEQ         21040000
210500         SET RC013-INQ (ASC-SEL-SUB)  TO TRUE                     21050000
210600         PERFORM 5120-REWRITE-LIST-QUEUE                          21060000
210700     ELSE                                                         21070000
210800             MOVE +1 TO  ASC-SEL-SUB                              21080000
210900                         ASC-SEL-ITEM                             21090000
211000*            --- TOP OF LIST ---                                  21100000
211100             MOVE PC-TSYMSG-00069  TO DP020-MSG-NUMBER            21110000
211200             SET DP020-MSG-INFORMATIONAL                          21120000
211300                                   TO TRUE                        21130000
211400     END-IF.                                                      21140000
211500                                                                  21150000
211600******************************************************************21160000
211700** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **21170000
211800** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **21180000
211900******************************************************************21190000
212000 3000-EDIT-DATA-IN-COMMAREA.                                      21200000
212100     SET PS-NO-ERROR               TO TRUE.                       21210000
212200     PERFORM 3200-RESET-ATTRIBUTES.                               21220000
212300     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     21230000
212400**                                                                21240000
212500* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              21250000
212600* EDITTING IS DONE FROM THE BOTTOM UP.                            21260000
212700**                                                                21270000
212800     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       21280000
212900         ASC-ITEMS-DISPLAYED - 1.                                 21290000
213000     PERFORM 3100-SET-SUBSCRIPTS.                                 21300000
213100     PERFORM 3300-EDIT-SELECTIONS                                 21310000
213200         VARYING PV-SUB                                           21320000
213300         FROM PV-SUB BY -1                                        21330000
213400         UNTIL PV-SUB < +1                                        21340000
213500*                                                                 21350000
213600     IF  PS-NO-ERROR                                              21360000
213700         PERFORM 3400-CHECK-RANGE-SEQUENCE                        21370000
213800     END-IF.                                                      21380000
213900*                                                                 21390000
214000     IF  ((PS-NO-ERROR)                                           21400000
214100       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   21410000
214200       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    21420000
214300             PERFORM 3500-MARK-RANGE-AS-SELECTED                  21430000
214400     END-IF.                                                      21440000
214500 EJECT                                                            21450000
214600*----------------------------------------------------------------*21460000
214700*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *21470000
214800*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*21480000
214900*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *21490000
215000*                                                                *21500000
215100*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *21510000
215200*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *21520000
215300*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *21530000
215400*    US IN THE 2ND BLOCK OF THE ARRAY.                           *21540000
215500*----------------------------------------------------------------*21550000
215600                                                                  21560000
215700 3100-SET-SUBSCRIPTS.                                             21570000
215800                                                                  21580000
215900     COMPUTE ASC-ITEM-SUB =                                       21590000
216000         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        21600000
216100                                                                  21610000
216200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         21620000
216300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            21630000
216400                                                                  21640000
216500         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               21650000
216600     ELSE                                                         21660000
216700         MOVE +1                     TO ASC-BLK-SUB               21670000
216800     END-IF.                                                      21680000
216900******************************************************************21690000
217000** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **21700000
217100******************************************************************21710000
217200                                                                  21720000
217300 3200-RESET-ATTRIBUTES.                                           21730000
217400     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   21740000
217500     MOVE DP015-GREEN              TO ASTRTITC.                   21750000
217600     MOVE DP015-UNDERLINE          TO ASTRTITH.                   21760000
217700                                                                  21770000
217800     PERFORM                                                      21780000
217900         VARYING PV-SUB                                           21790000
218000         FROM 1 BY 1                                              21800000
218100         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        21810000
218200         MOVE DP015-UNP-ALP-NOR-OFF                               21820000
218300                                   TO MR-SELECTA (PV-SUB)         21830000
218400         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         21840000
218500         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         21850000
218600*        MOVE DP015-UNP-ALP-NOR-OFF TO MR-LINE-PACKA (PV-SUB)     21860000
218700         MOVE DP015-ASK-NOR-OFF     TO MR-LINE-PACKA (PV-SUB)     21870000
218800         MOVE DP015-UNP-ALP-NOR-OFF                               21880000
218900                           TO MR-DEST-OPER-UNT-IDA (PV-SUB)       21890000
219000     END-PERFORM.                                                 21900000
219100******************************************************************21910000
219200** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **21920000
219300** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **21930000
219400** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **21940000
219500** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **21950000
219600******************************************************************21960000
219700 3300-EDIT-SELECTIONS.                                            21970000
219800     EVALUATE TRUE                                                21980000
219900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     21990000
220000             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         22000000
220100                 CONTINUE                                         22010000
220200         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         22020000
220300             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        22030000
220400                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   22040000
220500                 MOVE ASC-TEMP-SELECTED-SW                        22050000
220600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22060000
220700                                TO ASC-SELECTED-SW                22070000
220800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22080000
220900             END-IF                                               22090000
221000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     22100000
221100                 = SPACE                                          22110000
221200             EVALUATE TRUE                                        22120000
221300                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       22130000
221400                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS22140000
221500                     MOVE SPACE TO ASC-SELECTED-SW                22150000
221600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22160000
221700                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        22170000
221800                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    22180000
221900                     MOVE SPACE TO ASC-SELECTED-SW                22190000
222000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22200000
222100                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          22210000
222200                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      22220000
222300                     MOVE SPACE TO ASC-SELECTED-SW                22230000
222400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22240000
222500             END-EVALUATE                                         22250000
222600         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           22260000
222700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22270000
222800                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22280000
222900             END-IF                                               22290000
223000             PERFORM 3310-EDIT-RANGE                              22300000
223100         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             22310000
223200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22320000
223300                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22330000
223400             END-IF                                               22340000
223500             PERFORM 3310-EDIT-RANGE                              22350000
223600         WHEN OTHER                                               22360000
223700             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           22370000
223800             SET DP020-MSG-FATAL    TO TRUE                       22380000
223900             MOVE -1                TO MR-SELECTL (PV-SUB)        22390000
224000             SET DP030-SET-CURSOR-APPL-1                          22400000
224100                                    TO TRUE                       22410000
224200             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        22420000
224300             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        22430000
224400             SET PS-ERROR TO TRUE                                 22440000
224500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22450000
224600                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     22460000
224700                 MOVE SPACE         TO ASC-SELECTED-SW            22470000
224800                                        (ASC-BLK-SUB ASC-ITEM-SUB)22480000
224900             END-IF                                               22490000
225000     END-EVALUATE.                                                22500000
225100                                                                  22510000
225200     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 22520000
225300     SUBTRACT +1 FROM ASC-ITEM-SUB.                               22530000
225400     IF  ASC-ITEM-SUB < 1                                         22540000
225500         SUBTRACT +1 FROM ASC-BLK-SUB                             22550000
225600         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                22560000
225700     END-IF.                                                      22570000
225800******************************************************************22580000
225900** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **22590000
226000** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **22600000
226100** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**22610000
226200** THE ENDING.                                                  **22620000
226300******************************************************************22630000
226400 3310-EDIT-RANGE.                                                 22640000
226500     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                22650000
226600         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   22660000
226700             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)22670000
226800                                   TO ASC-SELECTED-SW             22680000
226900                                        (ASC-BLK-SUB ASC-ITEM-SUB)22690000
227000             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 22700000
227100         ELSE                                                     22710000
227200             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     22720000
227300                 CONTINUE                                         22730000
227400             ELSE                                                 22740000
227500*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        22750000
227600                 MOVE PC-TSYMSG-00054                             22760000
227700                                   TO DP020-MSG-NUMBER            22770000
227800                 SET DP020-MSG-FATAL                              22780000
227900                                   TO TRUE                        22790000
228000                 MOVE -1           TO MR-SELECTL (PV-SUB)         22800000
228100                 SET DP030-SET-CURSOR-APPL-1                      22810000
228200                                   TO TRUE                        22820000
228300                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         22830000
228400                 MOVE DP015-UNDERLINE                             22840000
228500                                   TO MR-SELECTH (PV-SUB)         22850000
228600                 SET PS-ERROR      TO TRUE                        22860000
228700             END-IF                                               22870000
228800         END-IF                                                   22880000
228900     ELSE                                                         22890000
229000         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     22900000
229100             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 22910000
229200                                   TO ASC-SELECTED-SW             22920000
229300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22930000
229400             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   22940000
229500         ELSE                                                     22950000
229600             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       22960000
229700                 CONTINUE                                         22970000
229800             ELSE                                                 22980000
229900*                -- ONLY ONE END-OF-RANGE ALLOWED --              22990000
230000                 MOVE PC-TSYMSG-00055                             23000000
230100                                   TO DP020-MSG-NUMBER            23010000
230200                 SET DP020-MSG-FATAL                              23020000
230300                                   TO TRUE                        23030000
230400                 MOVE -1           TO MR-SELECTL (PV-SUB)         23040000
230500                 SET DP030-SET-CURSOR-APPL-1                      23050000
230600                                   TO TRUE                        23060000
230700                 SET PS-ERROR      TO TRUE                        23070000
230800             END-IF                                               23080000
230900         END-IF                                                   23090000
231000     END-IF.                                                      23100000
231100*                                                                 23110000
231200******************************************************************23120000
231300** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **23130000
231400** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **23140000
231500******************************************************************23150000
231600 3400-CHECK-RANGE-SEQUENCE.                                       23160000
231700     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       23170000
231800       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      23180000
231900       AND  ASC-START-OF-SELECTED-RANGE >                         23190000
232000                                         ASC-END-OF-SELECTED-RANGE23200000
232100*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                23210000
232200         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 23220000
232300         SET DP020-MSG-FATAL TO TRUE                              23230000
232400         SET PS-ERROR TO TRUE                                     23240000
232500         PERFORM 3410-POSITION-AT-ERROR                           23250000
232600     END-IF.                                                      23260000
232700******************************************************************23270000
232800** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **23280000
232900** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **23290000
233000** SHOULD BE POSITIONED ON A RANGE ERROR.                       **23300000
233100******************************************************************23310000
233200 3410-POSITION-AT-ERROR.                                          23320000
233300     SET DP030-SET-CURSOR-APPL-1                                  23330000
233400                                   TO TRUE.                       23340000
233500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 23350000
233600                    - PV-TOP-ITEM + 1.                            23360000
233700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      23370000
233800         CONTINUE                                                 23380000
233900     ELSE                                                         23390000
234000         MOVE -1                   TO MR-SELECTL (PV-SUB)         23400000
234100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         23410000
234200         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         23420000
234300     END-IF.                                                      23430000
234400*                                                                 23440000
234500     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   23450000
234600                    - PV-TOP-ITEM + 1.                            23460000
234700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      23470000
234800         CONTINUE                                                 23480000
234900     ELSE                                                         23490000
235000         MOVE -1                   TO MR-SELECTL (PV-SUB)         23500000
235100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         23510000
235200         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         23520000
235300     END-IF.                                                      23530000
235400 EJECT                                                            23540000
235500*----------------------------------------------------------------*23550000
235600*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *23560000
235700*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *23570000
235800*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *23580000
235900*----------------------------------------------------------------*23590000
236000                                                                  23600000
236100 3500-MARK-RANGE-AS-SELECTED.                                     23610000
236200     MOVE +1                       TO  ASC-BLK-SUB.               23620000
236300     PERFORM 3510-MARK-SELECTED-INDS                              23630000
236400         VARYING ASC-ITEM-SUB                                     23640000
236500         FROM 1 BY 1                                              23650000
236600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23660000
236700                                                                  23670000
236800     ADD +1                        TO ASC-BLK-SUB.                23680000
236900     PERFORM 3510-MARK-SELECTED-INDS                              23690000
237000         VARYING ASC-ITEM-SUB                                     23700000
237100         FROM 1 BY 1                                              23710000
237200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23720000
237300                                                                  23730000
237400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               23740000
237500                                   TO  PV-LIST-ITEM-NUMBER.       23750000
237600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            23760000
237700         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         23770000
237800               PC-ITEMS-PER-PANEL).                               23780000
237900                                                                  23790000
238000     MOVE ASC-START-OF-SELECTED-RANGE                             23800000
238100                                   TO PV-START-OF-SELECTED-RANGE. 23810000
238200     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            23820000
238300         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  23830000
238400               PC-ITEMS-PER-PANEL).                               23840000
238500                                                                  23850000
238600     MOVE ASC-END-OF-SELECTED-RANGE                               23860000
238700                                   TO  PV-END-OF-SELECTED-RANGE.  23870000
238800     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             23880000
238900         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    23890000
239000               PC-ITEMS-PER-PANEL).                               23900000
239100     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             23910000
239200         PV-FIRST-BLOCK-IN-ARRAY + 1.                             23920000
239300                                                                  23930000
239400     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    23940000
239500        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        23950000
239600         MOVE +1                   TO ASC-BLK-SUB                 23960000
239700         PERFORM 5100-WRITE-TEMP-STORAGE                          23970000
239800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         23980000
239900             PV-FIRST-BLOCK-IN-ARRAY - 1                          23990000
240000                                                                  24000000
240100         PERFORM                                                  24010000
240200             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      24020000
240300                   PV-PREV-BLOCK-IN-ARRAY                         24030000
240400             MOVE PV-FIRST-BLOCK-IN-RANGE                         24040000
240500                                   TO PV-BLOCK-NUMBER             24050000
240600             PERFORM 4410-READ-TEMP-STORAGE                       24060000
240700             PERFORM 3510-MARK-SELECTED-INDS                      24070000
240800                 VARYING ASC-ITEM-SUB                             24080000
240900                 FROM 1 BY 1                                      24090000
241000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24100000
241100             PERFORM 5100-WRITE-TEMP-STORAGE                      24110000
241200             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     24120000
241300         END-PERFORM                                              24130000
241400                                                                  24140000
241500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         24150000
241600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     24160000
241700         PERFORM                                                  24170000
241800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       24180000
241900                   PV-LAST-BLOCK-IN-RANGE                         24190000
242000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          24200000
242100                                   TO PV-BLOCK-NUMBER             24210000
242200             PERFORM 4410-READ-TEMP-STORAGE                       24220000
242300             PERFORM 3510-MARK-SELECTED-INDS                      24230000
242400                 VARYING ASC-ITEM-SUB                             24240000
242500                 FROM 1 BY 1                                      24250000
242600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24260000
242700             PERFORM 5100-WRITE-TEMP-STORAGE                      24270000
242800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      24280000
242900         END-PERFORM                                              24290000
243000                                                                  24300000
243100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             24310000
243200                                   TO PV-BLOCK-NUMBER             24320000
243300         PERFORM 4410-READ-TEMP-STORAGE                           24330000
243400     END-IF.                                                      24340000
243500                                                                  24350000
243600     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 24360000
243700                                      ASC-END-OF-SELECTED-RANGE.  24370000
243800                                                                  24380000
243900 EJECT                                                            24390000
244000*----------------------------------------------------------------*24400000
244100* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *24410000
244200*----------------------------------------------------------------*24420000
244300                                                                  24430000
244400 3510-MARK-SELECTED-INDS.                                         24440000
244500                                                                  24450000
244600     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         24460000
244700                                ASC-ITEM-SUB) >                   24470000
244800         ASC-START-OF-SELECTED-RANGE)                             24480000
244900     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         24490000
245000                                ASC-ITEM-SUB) =                   24500000
245100         ASC-START-OF-SELECTED-RANGE)                             24510000
245200                                                                  24520000
245300         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     24530000
245400                                    ASC-ITEM-SUB) <               24540000
245500             ASC-END-OF-SELECTED-RANGE)                           24550000
245600         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     24560000
245700                                    ASC-ITEM-SUB) =               24570000
245800             ASC-END-OF-SELECTED-RANGE)                           24580000
245900                                                                  24590000
246000             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          24600000
246100                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   24610000
246200                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   24620000
246300                               TO TRUE                            24630000
246400                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              24640000
246500                               TO TRUE                            24650000
246600                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    24660000
246700             END-IF                                               24670000
246800         END-IF                                                   24680000
246900     END-IF.                                                      24690000
247000                                                                  24700000
247100 EJECT                                                            24710000
247200*----------------------------------------------------------------*24720000
247300*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *24730000
247400*    INITIALIZE ALL COUNTERS AND FLAGS.                          *24740000
247500*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *24750000
247600*    DISPLAY THE PANEL TO USER.                                  *24760000
247700*----------------------------------------------------------------*24770000
247800                                                                  24780000
247900 4000-BUILD-INITIAL-PANEL.                                        24790000
248000                                                                  24800000
248100     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            24810000
248200                                 ASC-BLOCK-ENTRIES (2).           24820000
248300     MOVE +1                 TO ASC-BLK-SUB.                      24830000
248400     SET ASC-ITEMS-LEFT-ON-DB                                     24840000
248500                             TO TRUE.                             24850000
248600                                                                  24860000
248700     MOVE +0                 TO ASC-ITEM-SUB                      24870000
248800                                ASC-NUMBER-OF-ITEMS-READ          24880000
248900                                ASC-NUMBER-OF-SELECTED-ITEMS      24890000
249000                                ASC-HIGHEST-BLOCK-WRITTEN         24900000
249100                                ASC-START-OF-SELECTED-RANGE       24910000
249200                                ASC-END-OF-SELECTED-RANGE         24920000
249300                                ASC-ITEM-AT-TOP-OF-PANEL.         24930000
249400     PERFORM 4100-PREPARE-CURSOR                                  24940000
249500     IF PS-CURSOR-TYPE-SW = SPACES                                24950000
249600         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    24960000
249700         SET DP020-MSG-FATAL   TO  TRUE                           24970000
249800         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               24980000
249900     ELSE                                                         24990000
250000                                                                  25000000
250100         MOVE PS-CURSOR-TYPE-SW       TO ASC-CURSOR-TYPE-SW       25010000
250200         PERFORM 4010-OPEN-CURSOR                                 25020000
250300                                                                  25030000
250400         PERFORM 4300-READ-ITEMS-FROM-DB                          25040000
250500                                                                  25050000
250600         PERFORM 4020-CLOSE-CURSOR                                25060000
250700                                                                  25070000
250800         MOVE +1                   TO  PV-TOP-ITEM                25080000
250900         IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                      25090000
251000             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                25100000
251100             SET DP020-MSG-FATAL   TO  TRUE                       25110000
251200             MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER           25120000
251300         ELSE                                                     25130000
251400             MOVE -1               TO MR-SELECTL (1)              25140000
251500             SET DP030-SET-CURSOR-APPL-1                          25150000
251600                                   TO TRUE                        25160000
251700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 25170000
251800         END-IF                                                   25180000
251900     END-IF.                                                      25190000
252000 EJECT                                                            25200000
252100*----------------------------------------------------------------*25210000
252200* OPEN THE TMESSAGE CURSOR.                                      *25220000
252300*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *25230000
252400*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *25240000
252500*   USER.                                                        *25250000
252600*----------------------------------------------------------------*25260000
252700                                                                  25270000
252800 4010-OPEN-CURSOR.                                                25280000
252900                                                                  25290000
253000     EVALUATE TRUE                                                25300000
253100         WHEN PS-PO-RC-LN-USER                                    25310000
253200             EXEC SQL                                             25320000
253300                  OPEN PO-RC-LN-USER-CSR                          25330000
253400             END-EXEC                                             25340000
253500         WHEN PS-PO-RC-PK-US                                      25350000
253600             EXEC SQL                                             25360000
253700                  OPEN PO-RC-PK-US-CSR                            25370000
253800             END-EXEC                                             25380000
253900         WHEN PS-PO-RCVR-LINE                                     25390000
254000             EXEC SQL                                             25400000
254100                  OPEN PO-RCVR-LINE-CSR                           25410000
254200             END-EXEC                                             25420000
254300         WHEN PS-PO-RCVR-PACK                                     25430000
254400             EXEC SQL                                             25440000
254500                  OPEN PO-RCVR-PACK-CSR                           25450000
254600             END-EXEC                                             25460000
254700         WHEN PS-PO-RCVR-USER                                     25470000
254800             EXEC SQL                                             25480000
254900                  OPEN PO-RCVR-USER-CSR                           25490000
255000             END-EXEC                                             25500000
255100         WHEN PS-PO-RCVR                                          25510000
255200             EXEC SQL                                             25520000
255300                  OPEN PO-RCVR-CSR                                25530000
255400             END-EXEC                                             25540000
255500         WHEN PS-PO-USER                                          25550000
255600             EXEC SQL                                             25560000
255700                  OPEN PO-USER-CSR                                25570000
255800             END-EXEC                                             25580000
255900         WHEN PS-PO                                               25590000
256000             EXEC SQL                                             25600000
256100                  OPEN PO-CSR                                     25610000
256200             END-EXEC                                             25620000
256300         WHEN PS-USER-DATE                                        25630000
256400             EXEC SQL                                             25640000
256500                  OPEN USER-DATE-CSR                              25650000
256600             END-EXEC                                             25660000
256700         WHEN PS-USER                                             25670000
256800             EXEC SQL                                             25680000
256900                  OPEN USER-CSR                                   25690000
257000             END-EXEC                                             25700000
257100     END-EVALUATE.                                                25710000
257200                                                                  25720000
257300     EVALUATE TRUE                                                25730000
257400         WHEN SQLCODE = ZERO                                      25740000
257500         WHEN SQLCODE = -904                                      25750000
257600         WHEN SQLCODE = -913                                      25760000
257700             CONTINUE                                             25770000
257800         WHEN SQLWARN0 NOT = SPACES                               25780000
257900         WHEN SQLCODE < ZERO                                      25790000
258000         WHEN SQLCODE > ZERO                                      25800000
258100             MOVE '4010-OPEN-CURSOR'                              25810000
258200                               TO DP013-PARAGRAPH                 25820000
258300             MOVE 'OPEN SYSTEM MESSAGE CURSOR - '                 25830000
258400                               TO DP013-MESSAGE-TEXT (1)          25840000
258500             MOVE SQLCA        TO DP013-SQLCA                     25850000
258600             MOVE 'RCT00017'   TO DP013-DB2-TABLE-NAME (1)        25860000
258700             MOVE 'RCT00018'   TO DP013-DB2-TABLE-NAME (2)        25870000
258800             MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (3)        25880000
258900             SET DP013-DB2-ABEND                                  25890000
259000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               25900000
259100             PERFORM DP013-0000-PROCESS-ABEND                     25910000
259200     END-EVALUATE.                                                25920000
259300*                                                                 25930000
259400 EJECT                                                            25940000
259500*----------------------------------------------------------------*25950000
259600* CLOSE THE TMESSAGE CURSOR.                                     *25960000
259700*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *25970000
259800*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *25980000
259900*   USER.                                                        *25990000
260000*----------------------------------------------------------------*26000000
260100                                                                  26010000
260200 4020-CLOSE-CURSOR.                                               26020000
260300     EVALUATE TRUE                                                26030000
260400         WHEN PS-PO-RC-LN-USER                                    26040000
260500             EXEC SQL                                             26050000
260600                  CLOSE PO-RC-LN-USER-CSR                         26060000
260700             END-EXEC                                             26070000
260800         WHEN PS-PO-RC-PK-US                                      26080000
260900             EXEC SQL                                             26090000
261000                  CLOSE PO-RC-PK-US-CSR                           26100000
261100             END-EXEC                                             26110000
261200         WHEN PS-PO-RCVR-LINE                                     26120000
261300             EXEC SQL                                             26130000
261400                  CLOSE PO-RCVR-LINE-CSR                          26140000
261500             END-EXEC                                             26150000
261600         WHEN PS-PO-RCVR-PACK                                     26160000
261700             EXEC SQL                                             26170000
261800                  CLOSE PO-RCVR-PACK-CSR                          26180000
261900             END-EXEC                                             26190000
262000         WHEN PS-PO-RCVR-USER                                     26200000
262100             EXEC SQL                                             26210000
262200                  CLOSE PO-RCVR-USER-CSR                          26220000
262300             END-EXEC                                             26230000
262400         WHEN PS-PO-RCVR                                          26240000
262500             EXEC SQL                                             26250000
262600                  CLOSE PO-RCVR-CSR                               26260000
262700             END-EXEC                                             26270000
262800         WHEN PS-PO-USER                                          26280000
262900             EXEC SQL                                             26290000
263000                  CLOSE PO-USER-CSR                               26300000
263100             END-EXEC                                             26310000
263200         WHEN PS-PO                                               26320000
263300             EXEC SQL                                             26330000
263400                  CLOSE PO-CSR                                    26340000
263500             END-EXEC                                             26350000
263600         WHEN PS-USER-DATE                                        26360000
263700             EXEC SQL                                             26370000
263800                  CLOSE USER-DATE-CSR                             26380000
263900             END-EXEC                                             26390000
264000         WHEN PS-USER                                             26400000
264100             EXEC SQL                                             26410000
264200                  CLOSE USER-CSR                                  26420000
264300             END-EXEC                                             26430000
264400     END-EVALUATE.                                                26440000
264500                                                                  26450000
264600*                                                                 26460000
264700     EVALUATE TRUE                                                26470000
264800         WHEN SQLCODE = ZERO                                      26480000
264900             CONTINUE                                             26490000
265000         WHEN SQLWARN0 NOT = SPACES                               26500000
265100         WHEN SQLCODE < ZERO                                      26510000
265200         WHEN SQLCODE > ZERO                                      26520000
265300             MOVE '4020-CLOSE-CURSOR'                             26530000
265400                               TO DP013-PARAGRAPH                 26540000
265500             MOVE 'CLOSE SYSTEM MESSAGE CURSOR '                  26550000
265600                               TO DP013-MESSAGE-TEXT (1)          26560000
265700             MOVE SQLCA        TO DP013-SQLCA                     26570000
265800             MOVE 'RCT00017'   TO DP013-DB2-TABLE-NAME (1)        26580000
265900             MOVE 'RCT00018'   TO DP013-DB2-TABLE-NAME (2)        26590000
266000             MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (3)        26600000
266100             SET DP013-DB2-ABEND                                  26610000
266200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               26620000
266300             PERFORM DP013-0000-PROCESS-ABEND                     26630000
266400     END-EVALUATE.                                                26640000
266500                                                                  26650000
266600 EJECT                                                            26660000
266700*----------------------------------------------------------------*26670000
266800*    SET UP THE HOST VARIABLES.                                  *26680000
266900*----------------------------------------------------------------*26690000
267000                                                                  26700000
267100 4100-PREPARE-CURSOR.                                             26710000
267200                                                                  26720000
267300     MOVE ASC-OPER-UNIT-ID-N TO DK-OPER-UNT-ID                    26730000
267400                                                                  26740000
267500     EVALUATE TRUE                                                26750000
267600                                                                  26760000
267700         WHEN ASC-PO > 0 AND                                      26770000
267800              ASC-RECEIVER-SEQ > 0 AND                            26780000
267900              ASC-LINE-NUMBER > 0 AND                             26790000
268000              ASC-USER-ID NOT = SPACES AND                        26800000
268100              ASC-FROM-DATE-MM > 0 AND                            26810000
268200              ASC-FROM-DATE-DD > 0 AND                            26820000
268300              ASC-FROM-DATE-YY > 0                                26830000
268400               MOVE ASC-FROM-DATE-MM       TO PV-FROM-DATE-MM     26840000
268500               MOVE ASC-FROM-DATE-DD       TO PV-FROM-DATE-DD     26850000
268600               MOVE ASC-FROM-DATE-YY       TO PV-FROM-DATE-YY     26860000
268700               MOVE PV-FROM-DATE-TIME  TO DK-DATE-FROM-TIMESTAMP  26870000
268800               MOVE ASC-TO-DATE-MM         TO PV-TO-DATE-MM       26880000
268900               MOVE ASC-TO-DATE-DD         TO PV-TO-DATE-DD       26890000
269000               MOVE ASC-TO-DATE-YY         TO PV-TO-DATE-YY       26900000
269100               MOVE PV-TO-DATE-TIME    TO DK-DATE-TO-TIMESTAMP    26910000
269200               MOVE ASC-PO                 TO DK-PO-NBR           26920000
269300               MOVE ASC-RECEIVER-SEQ       TO DK-RCVR-SEQ-NBR     26930000
269400               MOVE ASC-LINE-NUMBER        TO DK-PO-LNE-NBR       26940000
269500               MOVE ASC-USER-ID            TO DK-CRE-BY-USR-ID    26950000
269600               SET PS-PO-RC-LN-USER TO TRUE                       26960000
269700*                                                                 26970000
269800         WHEN ASC-PO > 0 AND                                      26980000
269900              ASC-RECEIVER-SEQ > 0 AND                            26990000
270000              ASC-LINE-NUMBER > 0 AND                             27000000
270100              ASC-USER-ID NOT = SPACES                            27010000
270200               MOVE ASC-PO                 TO DK-PO-NBR           27020000
270300               MOVE ASC-RECEIVER-SEQ       TO DK-RCVR-SEQ-NBR     27030000
270400               MOVE ASC-LINE-NUMBER        TO DK-PO-LNE-NBR       27040000
270500               MOVE ASC-USER-ID            TO DK-CRE-BY-USR-ID    27050000
270600               SET PS-PO-RC-LN-USER TO TRUE                       27060000
270700*                                                                 27070000
270800         WHEN ASC-PO > 0 AND                                      27080000
270900              ASC-RECEIVER-SEQ > 0 AND                            27090000
271000              ASC-PACK-NUMBER > 0 AND                             27100000
271100              ASC-USER-ID NOT = SPACES AND                        27110000
271200              ASC-FROM-DATE-MM > 0 AND                            27120000
271300              ASC-FROM-DATE-DD > 0 AND                            27130000
271400              ASC-FROM-DATE-YY > 0                                27140000
271500               MOVE ASC-FROM-DATE-MM       TO PV-FROM-DATE-MM     27150000
271600               MOVE ASC-FROM-DATE-DD       TO PV-FROM-DATE-DD     27160000
271700               MOVE ASC-FROM-DATE-YY       TO PV-FROM-DATE-YY     27170000
271800               MOVE PV-FROM-DATE-TIME  TO DK-DATE-FROM-TIMESTAMP  27180000
271900               MOVE ASC-TO-DATE-MM         TO PV-TO-DATE-MM       27190000
272000               MOVE ASC-TO-DATE-DD         TO PV-TO-DATE-DD       27200000
272100               MOVE ASC-TO-DATE-YY         TO PV-TO-DATE-YY       27210000
272200               MOVE PV-TO-DATE-TIME    TO DK-DATE-TO-TIMESTAMP    27220000
272300               MOVE ASC-PO                 TO DK-PO-NBR           27230000
272400               MOVE ASC-RECEIVER-SEQ       TO DK-RCVR-SEQ-NBR     27240000
272500               MOVE ASC-PACK-NUMBER        TO DK-PREPK-ID         27250000
272600               MOVE ASC-USER-ID            TO DK-CRE-BY-USR-ID    27260000
272700               SET PS-PO-RC-PK-US TO TRUE                         27270000
272800*                                                                 27280000
272900         WHEN ASC-PO > 0 AND                                      27290000
273000              ASC-RECEIVER-SEQ > 0 AND                            27300000
273100              ASC-PACK-NUMBER > 0 AND                             27310000
273200              ASC-USER-ID NOT = SPACES                            27320000
273300               MOVE ASC-PO                 TO DK-PO-NBR           27330000
273400               MOVE ASC-RECEIVER-SEQ       TO DK-RCVR-SEQ-NBR     27340000
273500               MOVE ASC-PACK-NUMBER        TO DK-PREPK-ID         27350000
273600               MOVE ASC-USER-ID            TO DK-CRE-BY-USR-ID    27360000
273700               SET PS-PO-RC-PK-US TO TRUE                         27370000
273800*                                                                 27380000
273900         WHEN ASC-PO > 0 AND                                      27390000
274000              ASC-RECEIVER-SEQ > 0 AND                            27400000
274100              ASC-LINE-NUMBER > 0 AND                             27410000
274200              ASC-FROM-DATE-MM > 0 AND                            27420000
274300              ASC-FROM-DATE-DD > 0 AND                            27430000
274400              ASC-FROM-DATE-YY > 0                                27440000
274500               MOVE ASC-FROM-DATE-MM       TO PV-FROM-DATE-MM     27450000
274600               MOVE ASC-FROM-DATE-DD       TO PV-FROM-DATE-DD     27460000
274700               MOVE ASC-FROM-DATE-YY       TO PV-FROM-DATE-YY     27470000
274800               MOVE PV-FROM-DATE-TIME  TO DK-DATE-FROM-TIMESTAMP  27480000
274900               MOVE ASC-TO-DATE-MM         TO PV-TO-DATE-MM       27490000
275000               MOVE ASC-TO-DATE-DD         TO PV-TO-DATE-DD       27500000
275100               MOVE ASC-TO-DATE-YY         TO PV-TO-DATE-YY       27510000
275200               MOVE PV-TO-DATE-TIME    TO DK-DATE-TO-TIMESTAMP    27520000
275300               MOVE ASC-PO                 TO DK-PO-NBR           27530000
275400               MOVE ASC-RECEIVER-SEQ       TO DK-RCVR-SEQ-NBR     27540000
275500               MOVE ASC-LINE-NUMBER        TO DK-PO-LNE-NBR       27550000
275600               SET PS-PO-RCVR-LINE      TO TRUE                   27560000
275700*                                                                 27570000
275800         WHEN ASC-PO > 0 AND                                      27580000
275900              ASC-RECEIVER-SEQ > 0 AND                            27590000
276000              ASC-LINE-NUMBER > 0                                 27600000
276100               MOVE ASC-PO                 TO DK-PO-NBR           27610000
276200               MOVE ASC-RECEIVER-SEQ       TO DK-RCVR-SEQ-NBR     27620000
276300               MOVE ASC-LINE-NUMBER        TO DK-PO-LNE-NBR       27630000
276400               SET PS-PO-RCVR-LINE      TO TRUE                   27640000
276500*                                                                 27650000
276600         WHEN ASC-PO > 0 AND                                      27660000
276700              ASC-RECEIVER-SEQ > 0 AND                            27670000
276800              ASC-PACK-NUMBER > 0 AND                             27680000
276900              ASC-FROM-DATE-MM > 0 AND                            27690000
277000              ASC-FROM-DATE-DD > 0 AND                            27700000
277100              ASC-FROM-DATE-YY > 0                                27710000
277200               MOVE ASC-FROM-DATE-MM       TO PV-FROM-DATE-MM     27720000
277300               MOVE ASC-FROM-DATE-DD       TO PV-FROM-DATE-DD     27730000
277400               MOVE ASC-FROM-DATE-YY       TO PV-FROM-DATE-YY     27740000
277500               MOVE PV-FROM-DATE-TIME  TO DK-DATE-FROM-TIMESTAMP  27750000
277600               MOVE ASC-TO-DATE-MM         TO PV-TO-DATE-MM       27760000
277700               MOVE ASC-TO-DATE-DD         TO PV-TO-DATE-DD       27770000
277800               MOVE ASC-TO-DATE-YY         TO PV-TO-DATE-YY       27780000
277900               MOVE PV-TO-DATE-TIME    TO DK-DATE-TO-TIMESTAMP    27790000
278000               MOVE ASC-PO                 TO DK-PO-NBR           27800000
278100               MOVE ASC-RECEIVER-SEQ       TO DK-RCVR-SEQ-NBR     27810000
278200               MOVE ASC-PACK-NUMBER        TO DK-PREPK-ID         27820000
278300               SET PS-PO-RCVR-PACK TO TRUE                        27830000
278400*                                                                 27840000
278500         WHEN ASC-PO > 0 AND                                      27850000
278600              ASC-RECEIVER-SEQ > 0 AND                            27860000
278700              ASC-PACK-NUMBER > 0                                 27870000
278800               MOVE ASC-PO                 TO DK-PO-NBR           27880000
278900               MOVE ASC-RECEIVER-SEQ       TO DK-RCVR-SEQ-NBR     27890000
279000               MOVE ASC-PACK-NUMBER        TO DK-PREPK-ID         27900000
279100               SET PS-PO-RCVR-PACK TO TRUE                        27910000
279200*                                                                 27920000
279300         WHEN ASC-PO > 0 AND                                      27930000
279400              ASC-RECEIVER-SEQ > 0 AND                            27940000
279500              ASC-USER-ID NOT = SPACES AND                        27950000
279600              ASC-FROM-DATE-MM > 0 AND                            27960000
279700              ASC-FROM-DATE-DD > 0 AND                            27970000
279800              ASC-FROM-DATE-YY > 0                                27980000
279900               MOVE ASC-FROM-DATE-MM       TO PV-FROM-DATE-MM     27990000
280000               MOVE ASC-FROM-DATE-DD       TO PV-FROM-DATE-DD     28000000
280100               MOVE ASC-FROM-DATE-YY       TO PV-FROM-DATE-YY     28010000
280200               MOVE PV-FROM-DATE-TIME  TO DK-DATE-FROM-TIMESTAMP  28020000
280300               MOVE ASC-TO-DATE-MM         TO PV-TO-DATE-MM       28030000
280400               MOVE ASC-TO-DATE-DD         TO PV-TO-DATE-DD       28040000
280500               MOVE ASC-TO-DATE-YY         TO PV-TO-DATE-YY       28050000
280600               MOVE PV-TO-DATE-TIME    TO DK-DATE-TO-TIMESTAMP    28060000
280700               MOVE ASC-PO                 TO DK-PO-NBR           28070000
280800               MOVE ASC-RECEIVER-SEQ       TO DK-RCVR-SEQ-NBR     28080000
280900               MOVE ASC-USER-ID            TO DK-CRE-BY-USR-ID    28090000
281000               SET PS-PO-RCVR-USER TO TRUE                        28100000
281100*                                                                 28110000
281200         WHEN ASC-PO > 0 AND                                      28120000
281300              ASC-RECEIVER-SEQ > 0 AND                            28130000
281400              ASC-USER-ID NOT = SPACES                            28140000
281500               MOVE ASC-PO                 TO DK-PO-NBR           28150000
281600               MOVE ASC-RECEIVER-SEQ       TO DK-RCVR-SEQ-NBR     28160000
281700               MOVE ASC-USER-ID            TO DK-CRE-BY-USR-ID    28170000
281800               SET PS-PO-RCVR-USER TO TRUE                        28180000
281900*                                                                 28190000
282000         WHEN ASC-PO > 0 AND                                      28200000
282100              ASC-RECEIVER-SEQ > 0 AND                            28210000
282200              ASC-FROM-DATE-MM > 0 AND                            28220000
282300              ASC-FROM-DATE-DD > 0 AND                            28230000
282400              ASC-FROM-DATE-YY > 0                                28240000
282500               MOVE ASC-FROM-DATE-MM       TO PV-FROM-DATE-MM     28250000
282600               MOVE ASC-FROM-DATE-DD       TO PV-FROM-DATE-DD     28260000
282700               MOVE ASC-FROM-DATE-YY       TO PV-FROM-DATE-YY     28270000
282800               MOVE PV-FROM-DATE-TIME  TO DK-DATE-FROM-TIMESTAMP  28280000
282900               MOVE ASC-TO-DATE-MM         TO PV-TO-DATE-MM       28290000
283000               MOVE ASC-TO-DATE-DD         TO PV-TO-DATE-DD       28300000
283100               MOVE ASC-TO-DATE-YY         TO PV-TO-DATE-YY       28310000
283200               MOVE PV-TO-DATE-TIME    TO DK-DATE-TO-TIMESTAMP    28320000
283300               MOVE ASC-PO                 TO DK-PO-NBR           28330000
283400               MOVE ASC-RECEIVER-SEQ       TO DK-RCVR-SEQ-NBR     28340000
283500               SET PS-PO-RCVR TO TRUE                             28350000
283600*                                                                 28360000
283700         WHEN ASC-PO > 0 AND                                      28370000
283800              ASC-RECEIVER-SEQ > 0                                28380000
283900               MOVE ASC-PO                 TO DK-PO-NBR           28390000
284000               MOVE ASC-RECEIVER-SEQ       TO DK-RCVR-SEQ-NBR     28400000
284100               SET PS-PO-RCVR TO TRUE                             28410000
284200*                                                                 28420000
284300         WHEN ASC-PO > 0 AND                                      28430000
284400              ASC-USER-ID NOT = SPACES AND                        28440000
284500              ASC-FROM-DATE-MM > 0 AND                            28450000
284600              ASC-FROM-DATE-DD > 0 AND                            28460000
284700              ASC-FROM-DATE-YY > 0                                28470000
284800               MOVE ASC-FROM-DATE-MM       TO PV-FROM-DATE-MM     28480000
284900               MOVE ASC-FROM-DATE-DD       TO PV-FROM-DATE-DD     28490000
285000               MOVE ASC-FROM-DATE-YY       TO PV-FROM-DATE-YY     28500000
285100               MOVE PV-FROM-DATE-TIME  TO DK-DATE-FROM-TIMESTAMP  28510000
285200               MOVE ASC-TO-DATE-MM         TO PV-TO-DATE-MM       28520000
285300               MOVE ASC-TO-DATE-DD         TO PV-TO-DATE-DD       28530000
285400               MOVE ASC-TO-DATE-YY         TO PV-TO-DATE-YY       28540000
285500               MOVE PV-TO-DATE-TIME    TO DK-DATE-TO-TIMESTAMP    28550000
285600               MOVE ASC-PO                 TO DK-PO-NBR           28560000
285700               MOVE ASC-USER-ID            TO DK-CRE-BY-USR-ID    28570000
285800               SET PS-PO-USER TO TRUE                             28580000
285900*                                                                 28590000
286000         WHEN ASC-PO > 0 AND                                      28600000
286100              ASC-USER-ID NOT = SPACES                            28610000
286200               MOVE ASC-PO                 TO DK-PO-NBR           28620000
286300               MOVE ASC-USER-ID            TO DK-CRE-BY-USR-ID    28630000
286400               SET PS-PO-USER TO TRUE                             28640000
286500*                                                                 28650000
286600         WHEN ASC-PO > 0 AND                                      28660000
286700              ASC-FROM-DATE-MM > 0 AND                            28670000
286800              ASC-FROM-DATE-DD > 0 AND                            28680000
286900              ASC-FROM-DATE-YY > 0                                28690000
287000               MOVE ASC-FROM-DATE-MM       TO PV-FROM-DATE-MM     28700000
287100               MOVE ASC-FROM-DATE-DD       TO PV-FROM-DATE-DD     28710000
287200               MOVE ASC-FROM-DATE-YY       TO PV-FROM-DATE-YY     28720000
287300               MOVE PV-FROM-DATE-TIME  TO DK-DATE-FROM-TIMESTAMP  28730000
287400               MOVE ASC-TO-DATE-MM         TO PV-TO-DATE-MM       28740000
287500               MOVE ASC-TO-DATE-DD         TO PV-TO-DATE-DD       28750000
287600               MOVE ASC-TO-DATE-YY         TO PV-TO-DATE-YY       28760000
287700               MOVE PV-TO-DATE-TIME    TO DK-DATE-TO-TIMESTAMP    28770000
287800               MOVE ASC-PO                 TO DK-PO-NBR           28780000
287900               SET PS-PO TO TRUE                                  28790000
288000*                                                                 28800000
288100         WHEN ASC-PO > 0                                          28810000
288200               MOVE ASC-PO                 TO DK-PO-NBR           28820000
288300               SET PS-PO TO TRUE                                  28830000
288400*                                                                 28840000
288500         WHEN ASC-USER-ID NOT = SPACES AND                        28850000
288600              ASC-FROM-DATE-MM > 0 AND                            28860000
288700              ASC-FROM-DATE-DD > 0 AND                            28870000
288800              ASC-FROM-DATE-YY > 0                                28880000
288900               MOVE ASC-FROM-DATE-MM       TO PV-FROM-DATE-MM     28890000
289000               MOVE ASC-FROM-DATE-DD       TO PV-FROM-DATE-DD     28900000
289100               MOVE ASC-FROM-DATE-YY       TO PV-FROM-DATE-YY     28910000
289200               MOVE PV-FROM-DATE-TIME  TO DK-DATE-FROM-TIMESTAMP  28920000
289300               MOVE ASC-TO-DATE-MM         TO PV-TO-DATE-MM       28930000
289400               MOVE ASC-TO-DATE-DD         TO PV-TO-DATE-DD       28940000
289500               MOVE ASC-TO-DATE-YY         TO PV-TO-DATE-YY       28950000
289600               MOVE PV-TO-DATE-TIME  TO DK-DATE-TO-TIMESTAMP      28960000
289700               MOVE ASC-USER-ID            TO DK-CRE-BY-USR-ID    28970000
289800               SET PS-USER-DATE  TO TRUE                          28980000
289900*                                                                 28990000
290000         WHEN ASC-USER-ID NOT = SPACES                            29000000
290100               MOVE ASC-USER-ID            TO DK-CRE-BY-USR-ID    29010000
290200               SET PS-USER  TO TRUE                               29020000
290300*                                                                 29030000
290400     END-EVALUATE.                                                29040000
290500 EJECT                                                            29050000
290600*----------------------------------------------------------------*29060000
290700*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *29070000
290800*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *29080000
290900*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *29090000
291000*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *29100000
291100*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *29110000
291200*                                                                *29120000
291300*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *29130000
291400*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *29140000
291500*    UPON INITIALIZATION.                                        *29150000
291600*----------------------------------------------------------------*29160000
291700                                                                  29170000
291800 4300-READ-ITEMS-FROM-DB.                                         29180000
291900                                                                  29190000
292000     PERFORM                                                      29200000
292100         VARYING PV-READ-COUNT                                    29210000
292200         FROM 1 BY 1                                              29220000
292300         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    29230000
292400            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         29240000
292500                                                                  29250000
292600         PERFORM 4310-FETCH                                       29260000
292700                                                                  29270000
292800         IF  ASC-ITEMS-LEFT-ON-DB                                 29280000
292900             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                29290000
293000                 ADD +1            TO ASC-ITEM-SUB                29300000
293100             ELSE                                                 29310000
293200                 ADD +1            TO ASC-BLK-SUB                 29320000
293300                 MOVE +1           TO ASC-ITEM-SUB                29330000
293400                                                                  29340000
293500                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         29350000
293600                     MOVE +1       TO ASC-BLK-SUB                 29360000
293700                     SET ASC-BLOCK-MODIFIED (1)                   29370000
293800                                   TO TRUE                        29380000
293900                     PERFORM 5100-WRITE-TEMP-STORAGE              29390000
294000                     MOVE ASC-BLOCK-ENTRIES                       29400000
294100                               (PC-MAX-BLOCKS-IN-ARRAY)           29410000
294200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 29420000
294300                     ADD +1        TO ASC-BLK-SUB                 29430000
294400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   29440000
294500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      29450000
294600                                   TO TRUE                        29460000
294700                 END-IF                                           29470000
294800             END-IF                                               29480000
294900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    29490000
295000             MOVE ASC-NUMBER-OF-ITEMS-READ                        29500000
295100                                   TO ASC-LIST-ITEM-NUMBER        29510000
295200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29520000
295300*                                                                 29530000
295400             MOVE RCT00017-DC-FUNC-CDE  TO ASC-TBL-DC-FUNC-CDE    29540000
295500                                        (ASC-BLK-SUB ASC-ITEM-SUB)29550000
295600                                                                  29560000
295700             MOVE RCT00017-PO-NBR       TO PV-PO-NBR              29570000
295800             MOVE RCT00017-RCVR-SEQ-NBR TO PV-RECEIVER            29580000
295900             MOVE PV-PO-RECEIVER        TO ASC-TBL-PO-RECEIVER    29590000
296000                                        (ASC-BLK-SUB ASC-ITEM-SUB)29600000
296100             MOVE RECEIV-PKGNG-CDE      TO ASC-TBL-PKG-CODE       29610000
296200                                        (ASC-BLK-SUB ASC-ITEM-SUB)29620000
296300             MOVE RCT00017-CRE-TMST    (3:2) TO PV-REQ-DATE-YY    29630000
296400             MOVE RCT00017-CRE-TMST    (6:2) TO PV-REQ-DATE-MM    29640000
296500             MOVE RCT00017-CRE-TMST    (9:2) TO PV-REQ-DATE-DD    29650000
296600             MOVE PV-REQ-DATE           TO  ASC-TBL-CREATE-DATE   29660000
296700                                    (ASC-BLK-SUB ASC-ITEM-SUB)    29670000
296800             MOVE RCT00017-CRE-TMST (1:4)                         29680000
296900                                        TO PV-REQ-DATE-MDCY-CCYY  29690000
297000             MOVE RCT00017-CRE-TMST (6:2)                         29700000
297100                                        TO PV-REQ-DATE-MDCY-MM    29710000
297200             MOVE RCT00017-CRE-TMST (9:2)                         29720000
297300                                        TO PV-REQ-DATE-MDCY-DD    29730000
297400             MOVE PV-REQ-DATE-MDCY      TO ASC-TBL-CREATE-MDCY    29740000
297500                                        (ASC-BLK-SUB ASC-ITEM-SUB)29750000
297600             MOVE RCT00017-CRE-TMST (12:2)                        29760000
297700                                        TO PV-REQ-TIME-HR         29770000
297800             MOVE RCT00017-CRE-TMST (15:2)                        29780000
297900                                        TO PV-REQ-TIME-MN         29790000
298000             MOVE RCT00017-CRE-TMST (18:2)                        29800000
298100                                        TO PV-REQ-TIME-SS         29810000
298200             MOVE PV-REQ-TIME           TO ASC-TBL-CREATE-TIME    29820000
298300                                        (ASC-BLK-SUB ASC-ITEM-SUB)29830000
298400                                                                  29840000
298500             IF RECEIV-PKGNG-CDE = 'M' OR 'I'                     29850000
298600                 MOVE RCT00017-PREPK-ID    TO ASC-TBL-LINE-PACK   29860000
298700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29870000
298800             ELSE                                                 29880000
298900                 MOVE RCT00017-PO-LNE-NBR  TO ASC-TBL-LINE-PACK   29890000
299000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29900000
299100             END-IF                                               29910000
299200*                                                                 29920000
299300             MOVE RCT00017-CRE-BY-USR-ID  TO ASC-TBL-USER-ID      29930000
299400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29940000
299500                                                                  29950000
299600             MOVE RCT00018-SHRT-DC-FUNC-DESC TO ASC-TBL-FUNCTION  29960000
299700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29970000
299800             MOVE RCT00017-DEST-LOC-NBR TO ASC-TBL-DEST-OPER-UNT  29980000
299900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29990000
300000             MOVE RCT00017-PKSL-SEQ-NBR TO ASC-TBL-PKSL-SEQ-NBR   30000000
300100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 30010000
300200         END-IF                                                   30020000
300300     END-PERFORM.                                                 30030000
300400*LMM                                                              30040000
300500          MOVE PV-UNION-TYPE                                      30050000
300600                                TO ASC-CSR-IND                    30060000
300700                                    (ASC-BLK-SUB ASC-ITEM-SUB)    30070000
300800*LMM                                                              30080000
300900     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          30090000
301000         MOVE +1               TO ASC-BLK-SUB                     30100000
301100         PERFORM 5100-WRITE-TEMP-STORAGE                          30110000
301200         ADD +1                TO ASC-BLK-SUB                     30120000
301300         PERFORM 5100-WRITE-TEMP-STORAGE                          30130000
301400                                                                  30140000
301500         MOVE 1                TO ASC-BLK-SUB                     30150000
301600                                  PV-BLOCK-NUMBER                 30160000
301700         PERFORM 4410-READ-TEMP-STORAGE                           30170000
301800         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             30180000
301900             MOVE 2            TO ASC-BLK-SUB                     30190000
302000                                  PV-BLOCK-NUMBER                 30200000
302100             PERFORM 4410-READ-TEMP-STORAGE                       30210000
302200         END-IF                                                   30220000
302300     END-IF.                                                      30230000
302400 EJECT                                                            30240000
302500*----------------------------------------------------------------*30250000
302600*    FETCH THE MESSAGE CURSOR.                                   *30260000
302700*----------------------------------------------------------------*30270000
302800                                                                  30280000
302900 4310-FETCH.                                                      30290000
303000     INITIALIZE PS-UPC-SKU-SW.                                    30300000
303100                                                                  30310000
303200     EVALUATE TRUE                                                30320000
303300         WHEN PS-PO-RC-LN-USER                                    30330000
303400             EXEC SQL                                             30340000
303500                  FETCH PO-RC-LN-USER-CSR                         30350000
303600                  INTO  :PV-UNION-TYPE                            30360000
303700                     ,  :RCT00017-PO-NBR                          30370000
303800                     ,  :RCT00017-RCVR-SEQ-NBR                    30380000
303900                     ,  :RCT00017-CRE-BY-USR-ID                   30390000
304000                     ,  :RCT00017-CRE-TMST                        30400000
304100                     ,  :RCT00017-DC-FUNC-CDE                     30410000
304200                     ,  :RCT00017-LOC-NBR                         30420000
304300                     ,  :RCT00017-PO-LNE-NBR   :DN-PO-LNE-NBR     30430000
304400                     ,  :RCT00017-PREPK-ID     :DN-PREPK-ID       30440000
304500                     ,  :RCT00017-CRE-BY-PGM-NM                   30450000
304600                     ,  :RCT00017-LAST-UPD-TMST                   30460000
304700                     ,  :RCT00017-PKSL-SEQ-NBR :DN-PKSL-SEQ-NBR   30470000
304800                     ,  :RCT00018-DC-FUNC-DESC                    30480000
304900                     ,  :RCT00018-SHRT-DC-FUNC-DESC               30490000
305000                     ,  :RECEIV-PKGNG-CDE                         30500000
305100                     ,  :RCT00017-DEST-LOC-NBR :DN-DEST-OPER-UNT  30510000
305200             END-EXEC                                             30520000
305300         WHEN PS-PO-RC-PK-US                                      30530000
305400             EXEC SQL                                             30540000
305500                  FETCH PO-RC-PK-US-CSR                           30550000
305600                  INTO  :PV-UNION-TYPE                            30560000
305700                     ,  :RCT00017-PO-NBR                          30570000
305800                     ,  :RCT00017-RCVR-SEQ-NBR                    30580000
305900                     ,  :RCT00017-CRE-BY-USR-ID                   30590000
306000                     ,  :RCT00017-CRE-TMST                        30600000
306100                     ,  :RCT00017-DC-FUNC-CDE                     30610000
306200                     ,  :RCT00017-LOC-NBR                         30620000
306300                     ,  :RCT00017-PO-LNE-NBR   :DN-PO-LNE-NBR     30630000
306400                     ,  :RCT00017-PREPK-ID     :DN-PREPK-ID       30640000
306500                     ,  :RCT00017-CRE-BY-PGM-NM                   30650000
306600                     ,  :RCT00017-LAST-UPD-TMST                   30660000
306700                     ,  :RCT00017-PKSL-SEQ-NBR :DN-PKSL-SEQ-NBR   30670000
306800                     ,  :RCT00018-DC-FUNC-DESC                    30680000
306900                     ,  :RCT00018-SHRT-DC-FUNC-DESC               30690000
307000                     ,  :RECEIV-PKGNG-CDE                         30700000
307100                     ,  :RCT00017-DEST-LOC-NBR :DN-DEST-OPER-UNT  30710000
307200             END-EXEC                                             30720000
307300         WHEN PS-PO-RCVR-LINE                                     30730000
307400             EXEC SQL                                             30740000
307500                  FETCH PO-RCVR-LINE-CSR                          30750000
307600                  INTO  :PV-UNION-TYPE                            30760000
307700                     ,  :RCT00017-PO-NBR                          30770000
307800                     ,  :RCT00017-RCVR-SEQ-NBR                    30780000
307900                     ,  :RCT00017-CRE-BY-USR-ID                   30790000
308000                     ,  :RCT00017-CRE-TMST                        30800000
308100                     ,  :RCT00017-DC-FUNC-CDE                     30810000
308200                     ,  :RCT00017-LOC-NBR                         30820000
308300                     ,  :RCT00017-PO-LNE-NBR    :DN-PO-LNE-NBR    30830000
308400                     ,  :RCT00017-PREPK-ID      :DN-PREPK-ID      30840000
308500                     ,  :RCT00017-CRE-BY-PGM-NM                   30850000
308600                     ,  :RCT00017-LAST-UPD-TMST                   30860000
308700                     ,  :RCT00017-PKSL-SEQ-NBR :DN-PKSL-SEQ-NBR   30870000
308800                     ,  :RCT00018-DC-FUNC-DESC                    30880000
308900                     ,  :RCT00018-SHRT-DC-FUNC-DESC               30890000
309000                     ,  :RECEIV-PKGNG-CDE                         30900000
309100                     ,  :RCT00017-DEST-LOC-NBR :DN-DEST-OPER-UNT  30910000
309200             END-EXEC                                             30920000
309300         WHEN PS-PO-RCVR-PACK                                     30930000
309400             EXEC SQL                                             30940000
309500                  FETCH PO-RCVR-PACK-CSR                          30950000
309600                  INTO  :PV-UNION-TYPE                            30960000
309700                     ,  :RCT00017-PO-NBR                          30970000
309800                     ,  :RCT00017-RCVR-SEQ-NBR                    30980000
309900                     ,  :RCT00017-CRE-BY-USR-ID                   30990000
310000                     ,  :RCT00017-CRE-TMST                        31000000
310100                     ,  :RCT00017-DC-FUNC-CDE                     31010000
310200                     ,  :RCT00017-LOC-NBR                         31020000
310300                     ,  :RCT00017-PO-LNE-NBR   :DN-PO-LNE-NBR     31030000
310400                     ,  :RCT00017-PREPK-ID     :DN-PREPK-ID       31040000
310500                     ,  :RCT00017-CRE-BY-PGM-NM                   31050000
310600                     ,  :RCT00017-LAST-UPD-TMST                   31060000
310700                     ,  :RCT00017-PKSL-SEQ-NBR :DN-PKSL-SEQ-NBR   31070000
310800                     ,  :RCT00018-DC-FUNC-DESC                    31080000
310900                     ,  :RCT00018-SHRT-DC-FUNC-DESC               31090000
311000                     ,  :RECEIV-PKGNG-CDE                         31100000
311100                     ,  :RCT00017-DEST-LOC-NBR :DN-DEST-OPER-UNT  31110000
311200             END-EXEC                                             31120000
311300         WHEN PS-PO-RCVR-USER                                     31130000
311400             EXEC SQL                                             31140000
311500                  FETCH PO-RCVR-USER-CSR                          31150000
311600                  INTO  :PV-UNION-TYPE                            31160000
311700                     ,  :RCT00017-PO-NBR                          31170000
311800                     ,  :RCT00017-RCVR-SEQ-NBR                    31180000
311900                     ,  :RCT00017-CRE-BY-USR-ID                   31190000
312000                     ,  :RCT00017-CRE-TMST                        31200000
312100                     ,  :RCT00017-DC-FUNC-CDE                     31210000
312200                     ,  :RCT00017-LOC-NBR                         31220000
312300                     ,  :RCT00017-PO-LNE-NBR   :DN-PO-LNE-NBR     31230000
312400                     ,  :RCT00017-PREPK-ID     :DN-PREPK-ID       31240000
312500                     ,  :RCT00017-CRE-BY-PGM-NM                   31250000
312600                     ,  :RCT00017-LAST-UPD-TMST                   31260000
312700                     ,  :RCT00017-PKSL-SEQ-NBR :DN-PKSL-SEQ-NBR   31270000
312800                     ,  :RCT00018-DC-FUNC-DESC                    31280000
312900                     ,  :RCT00018-SHRT-DC-FUNC-DESC               31290000
313000                     ,  :RECEIV-PKGNG-CDE                         31300000
313100                     ,  :RCT00017-DEST-LOC-NBR :DN-DEST-OPER-UNT  31310000
313200             END-EXEC                                             31320000
313300         WHEN PS-PO-RCVR                                          31330000
313400             EXEC SQL                                             31340000
313500                  FETCH PO-RCVR-CSR                               31350000
313600                  INTO  :PV-UNION-TYPE                            31360000
313700                     ,  :RCT00017-PO-NBR                          31370000
313800                     ,  :RCT00017-RCVR-SEQ-NBR                    31380000
313900                     ,  :RCT00017-CRE-BY-USR-ID                   31390000
314000                     ,  :RCT00017-CRE-TMST                        31400000
314100                     ,  :RCT00017-DC-FUNC-CDE                     31410000
314200                     ,  :RCT00017-LOC-NBR                         31420000
314300                     ,  :RCT00017-PO-LNE-NBR   :DN-PO-LNE-NBR     31430000
314400                     ,  :RCT00017-PREPK-ID     :DN-PREPK-ID       31440000
314500                     ,  :RCT00017-CRE-BY-PGM-NM                   31450000
314600                     ,  :RCT00017-LAST-UPD-TMST                   31460000
314700                     ,  :RCT00017-PKSL-SEQ-NBR :DN-PKSL-SEQ-NBR   31470000
314800                     ,  :RCT00018-DC-FUNC-DESC                    31480000
314900                     ,  :RCT00018-SHRT-DC-FUNC-DESC               31490000
315000                     ,  :RECEIV-PKGNG-CDE                         31500000
315100                     ,  :RCT00017-DEST-LOC-NBR :DN-DEST-OPER-UNT  31510000
315200             END-EXEC                                             31520000
315300         WHEN PS-PO-USER                                          31530000
315400             EXEC SQL                                             31540000
315500                  FETCH PO-USER-CSR                               31550000
315600                  INTO  :PV-UNION-TYPE                            31560000
315700                     ,  :RCT00017-PO-NBR                          31570000
315800                     ,  :RCT00017-RCVR-SEQ-NBR                    31580000
315900                     ,  :RCT00017-CRE-BY-USR-ID                   31590000
316000                     ,  :RCT00017-CRE-TMST                        31600000
316100                     ,  :RCT00017-DC-FUNC-CDE                     31610000
316200                     ,  :RCT00017-LOC-NBR                         31620000
316300                     ,  :RCT00017-PO-LNE-NBR   :DN-PO-LNE-NBR     31630000
316400                     ,  :RCT00017-PREPK-ID     :DN-PREPK-ID       31640000
316500                     ,  :RCT00017-CRE-BY-PGM-NM                   31650000
316600                     ,  :RCT00017-LAST-UPD-TMST                   31660000
316700                     ,  :RCT00017-PKSL-SEQ-NBR :DN-PKSL-SEQ-NBR   31670000
316800                     ,  :RCT00018-DC-FUNC-DESC                    31680000
316900                     ,  :RCT00018-SHRT-DC-FUNC-DESC               31690000
317000                     ,  :RECEIV-PKGNG-CDE                         31700000
317100                     ,  :RCT00017-DEST-LOC-NBR :DN-DEST-OPER-UNT  31710000
317200             END-EXEC                                             31720000
317300         WHEN PS-PO                                               31730000
317400             EXEC SQL                                             31740000
317500                  FETCH PO-CSR                                    31750000
317600                  INTO  :PV-UNION-TYPE                            31760000
317700                     ,  :RCT00017-PO-NBR                          31770000
317800                     ,  :RCT00017-RCVR-SEQ-NBR                    31780000
317900                     ,  :RCT00017-CRE-BY-USR-ID                   31790000
318000                     ,  :RCT00017-CRE-TMST                        31800000
318100                     ,  :RCT00017-DC-FUNC-CDE                     31810000
318200                     ,  :RCT00017-LOC-NBR                         31820000
318300                     ,  :RCT00017-PO-LNE-NBR   :DN-PO-LNE-NBR     31830000
318400                     ,  :RCT00017-PREPK-ID     :DN-PREPK-ID       31840000
318500                     ,  :RCT00017-CRE-BY-PGM-NM                   31850000
318600                     ,  :RCT00017-LAST-UPD-TMST                   31860000
318700                     ,  :RCT00017-PKSL-SEQ-NBR :DN-PKSL-SEQ-NBR   31870000
318800                     ,  :RCT00018-DC-FUNC-DESC                    31880000
318900                     ,  :RCT00018-SHRT-DC-FUNC-DESC               31890000
319000                     ,  :RECEIV-PKGNG-CDE                         31900000
319100                     ,  :RCT00017-DEST-LOC-NBR :DN-DEST-OPER-UNT  31910000
319200             END-EXEC                                             31920000
319300         WHEN PS-USER-DATE                                        31930000
319400             EXEC SQL                                             31940000
319500                  FETCH USER-DATE-CSR                             31950000
319600                  INTO  :PV-UNION-TYPE                            31960000
319700                     ,  :RCT00017-PO-NBR                          31970000
319800                     ,  :RCT00017-RCVR-SEQ-NBR                    31980000
319900                     ,  :RCT00017-CRE-BY-USR-ID                   31990000
320000                     ,  :RCT00017-CRE-TMST                        32000000
320100                     ,  :RCT00017-DC-FUNC-CDE                     32010000
320200                     ,  :RCT00017-LOC-NBR                         32020000
320300                     ,  :RCT00017-PO-LNE-NBR   :DN-PO-LNE-NBR     32030000
320400                     ,  :RCT00017-PREPK-ID     :DN-PREPK-ID       32040000
320500                     ,  :RCT00017-CRE-BY-PGM-NM                   32050000
320600                     ,  :RCT00017-LAST-UPD-TMST                   32060000
320700                     ,  :RCT00017-PKSL-SEQ-NBR :DN-PKSL-SEQ-NBR   32070000
320800                     ,  :RCT00018-DC-FUNC-DESC                    32080000
320900                     ,  :RCT00018-SHRT-DC-FUNC-DESC               32090000
321000                     ,  :RECEIV-PKGNG-CDE                         32100000
321100                     ,  :RCT00017-DEST-LOC-NBR :DN-DEST-OPER-UNT  32110000
321200             END-EXEC                                             32120000
321300         WHEN PS-USER                                             32130000
321400             EXEC SQL                                             32140000
321500                  FETCH USER-CSR                                  32150000
321600                  INTO  :PV-UNION-TYPE                            32160000
321700                     ,  :RCT00017-PO-NBR                          32170000
321800                     ,  :RCT00017-RCVR-SEQ-NBR                    32180000
321900                     ,  :RCT00017-CRE-BY-USR-ID                   32190000
322000                     ,  :RCT00017-CRE-TMST                        32200000
322100                     ,  :RCT00017-DC-FUNC-CDE                     32210000
322200                     ,  :RCT00017-LOC-NBR                         32220000
322300                     ,  :RCT00017-PO-LNE-NBR   :DN-PO-LNE-NBR     32230000
322400                     ,  :RCT00017-PREPK-ID     :DN-PREPK-ID       32240000
322500                     ,  :RCT00017-CRE-BY-PGM-NM                   32250000
322600                     ,  :RCT00017-LAST-UPD-TMST                   32260000
322700                     ,  :RCT00017-PKSL-SEQ-NBR :DN-PKSL-SEQ-NBR   32270000
322800                     ,  :RCT00018-DC-FUNC-DESC                    32280000
322900                     ,  :RCT00018-SHRT-DC-FUNC-DESC               32290000
323000                     ,  :RECEIV-PKGNG-CDE                         32300000
323100                     ,  :RCT00017-DEST-LOC-NBR :DN-DEST-OPER-UNT  32310000
323200             END-EXEC                                             32320000
323300     END-EVALUATE.                                                32330000
323400                                                                  32340000
323500     EVALUATE TRUE                                                32350000
323600         WHEN SQLCODE = ZERO                                      32360000
323700              IF DN-DEST-OPER-UNT = -1                            32370000
323800                 MOVE ZEROES TO RCT00017-DEST-LOC-NBR             32380000
323900              END-IF                                              32390000
323910              IF DN-PKSL-SEQ-NBR  = -1                            32391000
323920                 MOVE ZEROES TO RCT00017-PKSL-SEQ-NBR             32392000
323930              END-IF                                              32393000
323940              IF DN-PO-LNE-NBR    = -1                            32394000
323950                 MOVE ZEROES TO RCT00017-PO-LNE-NBR               32395000
323960              END-IF                                              32396000
323970              IF DN-PREPK-ID      = -1                            32397000
323980                 MOVE ZEROES TO RCT00017-PREPK-ID                 32398000
323990              END-IF                                              32399000
324000         WHEN SQLCODE = +100                                      32400000
324100              CONTINUE                                            32410000
324200         WHEN SQLWARN0 NOT = SPACE                                32420000
324300         WHEN SQLCODE NOT = ZERO                                  32430000
324400              MOVE '4310-FETCH-CURSOR'                            32440000
324500                               TO DP013-PARAGRAPH                 32450000
324600              MOVE 'FETCH AUDIT CURSOR'                           32460000
324700                               TO DP013-MESSAGE-TEXT (1)          32470000
324800              MOVE 'RCT00017'  TO DP013-DB2-TABLE-NAME (1)        32480000
324900              MOVE 'RCT00018'  TO DP013-DB2-TABLE-NAME (2)        32490000
325000              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (3)        32500000
325100              MOVE SQLCA       TO DP013-SQLCA                     32510000
325200              SET DP013-DB2-ABEND                                 32520000
325300                               TO TRUE                            32530000
325400              PERFORM DP013-0000-PROCESS-ABEND                    32540000
325500     END-EVALUATE.                                                32550000
325600                                                                  32560000
325700     IF  SQLCODE EQUAL +100                                       32570000
325800         SET ASC-NO-ITEMS-LEFT-ON-DB                              32580000
325900                                   TO TRUE                        32590000
326000     END-IF.                                                      32600000
326100*                                                                 32610000
326200 EJECT                                                            32620000
326300*----------------------------------------------------------------*32630000
326400* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *32640000
326500*----------------------------------------------------------------*32650000
326600                                                                  32660000
326700 4400-MOVE-COMMAREA-TO-SCREEN.                                    32670000
326800                                                                  32680000
326900     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             32690000
327000         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          32700000
327100         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          32710000
327200             MOVE +1    TO ASC-BLK-SUB                            32720000
327300             PERFORM 5100-WRITE-TEMP-STORAGE                      32730000
327400             ADD +1     TO ASC-BLK-SUB                            32740000
327500             PERFORM 5100-WRITE-TEMP-STORAGE                      32750000
327600             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             32760000
327700                 GIVING PV-BLOCK-NUMBER                           32770000
327800                 REMAINDER PV-REMAINDER                           32780000
327900             IF  PV-REMAINDER > ZERO                              32790000
328000                 ADD +1 TO PV-BLOCK-NUMBER                        32800000
328100             END-IF                                               32810000
328200             MOVE +1    TO ASC-BLK-SUB                            32820000
328300             PERFORM 4410-READ-TEMP-STORAGE                       32830000
328400             ADD +1     TO ASC-BLK-SUB                            32840000
328500                           PV-BLOCK-NUMBER                        32850000
328600             PERFORM 4410-READ-TEMP-STORAGE                       32860000
328700     END-IF.                                                      32870000
328800     MOVE +1            TO ASC-BLK-SUB.                           32880000
328900     COMPUTE ASC-ITEM-SUB =                                       32890000
329000         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              32900000
329100         + PC-ITEMS-PER-PANEL).                                   32910000
329200*                                                                 32920000
329300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        32930000
329400         ADD +1         TO ASC-BLK-SUB                            32940000
329500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            32950000
329600     END-IF.                                                      32960000
329700*                                                                 32970000
329800     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           32980000
329900         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                32990000
330000     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        33000000
330100                                                                  33010000
330200     PERFORM 4420-FORMAT-LIST-LINES                               33020000
330300         VARYING PV-SUB                                           33030000
330400         FROM PC-ITEMS-PER-PANEL BY -1                            33040000
330500         UNTIL PV-SUB < +1.                                       33050000
330600*                                                                 33060000
330700*                                                                 33070000
330800     MOVE ASC-OPER-UNIT-ID-N       TO PV-OPER-UNIT-ID.            33080000
330900     MOVE PV-OPER-UNIT-ID          TO AOPERO                      33090000
331000                                      ASC-OPER-UNIT-ID.           33100000
331100     MOVE ASC-OPER-DESC            TO AFDESCO.                    33110000
331200                                                                  33120000
331300     COMPUTE ASC-ITEMS-DISPLAYED =                                33130000
331400         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          33140000
331500     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    33150000
331600                                      ASTRTITO.                   33160000
331700     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    33170000
331800     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    33180000
331900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            33190000
332000                                   TO ASELITO.                    33200000
332100*                                                                 33210000
332200     IF  DP020-MSG-NUMBER-X = SPACE                               33220000
332300         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  33230000
332400*            --- MORE ITEMS TO DISPLAY ----                       33240000
332500             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            33250000
332600             SET DP020-MSG-INFORMATIONAL TO TRUE                  33260000
332700         END-IF                                                   33270000
332800     END-IF.                                                      33280000
332900*----------------------------------------------------------------*33290000
333000*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *33300000
333100*----------------------------------------------------------------*33310000
333200                                                                  33320000
333300 4410-READ-TEMP-STORAGE.                                          33330000
333400                                                                  33340000
333500     EXEC CICS                                                    33350000
333600         READQ TS                                                 33360000
333700             QUEUE (ASC-LIST-QUEUE-NAME)                          33370000
333800             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               33380000
333900             ITEM  (PV-BLOCK-NUMBER)                              33390000
334000             RESP  (PV-CICS-RESP)                                 33400000
334100     END-EXEC.                                                    33410000
334200                                                                  33420000
334300     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       33430000
334400       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     33440000
334500         CONTINUE                                                 33450000
334600     ELSE                                                         33460000
334700         SET DP013-CICS-ABEND     TO TRUE                         33470000
334800         SET DP013-NO-ROLLBACK    TO TRUE                         33480000
334900         MOVE '4410-READ-TEMP-STORAGE'                            33490000
335000                                  TO DP013-PARAGRAPH              33500000
335100         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      33510000
335200                                  TO DP013-MESSAGE-TEXT(1)        33520000
335300         PERFORM DP013-0000-PROCESS-ABEND                         33530000
335400     END-IF.                                                      33540000
335500                                                                  33550000
335600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             33560000
335700*                                                                 33570000
335800     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         33580000
335900         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               33590000
336000     END-IF.                                                      33600000
336100 EJECT                                                            33610000
336200*----------------------------------------------------------------*33620000
336300*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *33630000
336400*----------------------------------------------------------------*33640000
336500                                                                  33650000
336600 4420-FORMAT-LIST-LINES.                                          33660000
336700     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      33670000
336800         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                33680000
336900                                                                  33690000
337000         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           33700000
337100                                    MR-LINE-PACKA (PV-SUB)        33710000
337200                                    MR-DEST-OPER-UNT-IDA (PV-SUB) 33720000
337300                                                                  33730000
337400         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           33740000
337500         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           33750000
337600         MOVE SPACE              TO MR-SELECTI (PV-SUB)           33760000
337700                                    MR-ACTION (PV-SUB)            33770000
337800                                    MR-PO-RECEIVER (PV-SUB)       33780000
337900                                    MR-LINE-PACK-X (PV-SUB)       33790000
338000                                    MR-PKG-CODE (PV-SUB)          33800000
338100                                    MR-USER-ID (PV-SUB)           33810000
338200                                    MR-CREATE-DATE (PV-SUB)       33820000
338300                                    MR-CREATE-TIME (PV-SUB)       33830000
338400                                    MR-FUNCTION (PV-SUB)          33840000
338500     ELSE                                                         33850000
338600         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      33860000
338700                                                   > SPACE        33870000
338800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 33880000
338900                                 TO MR-SELECTI (PV-SUB)           33890000
339000         ELSE                                                     33900000
339100             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      33910000
339200                                 TO MR-SELECTI (PV-SUB)           33920000
339300         END-IF                                                   33930000
339400*                                                                 33940000
339500         IF  DP030-SET-CURSOR-TRAILER                             33950000
339600             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)33960000
339700                 > SPACE)                                         33970000
339800               OR (PV-SUB = 1))                                   33980000
339900                SET DP030-SET-CURSOR-APPL-1 TO TRUE               33990000
340000                MOVE -1          TO MR-SELECTL (PV-SUB)           34000000
340100             END-IF                                               34010000
340200         END-IF                                                   34020000
340300*                                                                 34030000
340400         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           34040000
340500             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           34050000
340600                                 TO MR-ACTION (PV-SUB)            34060000
340700             MOVE ASC-TBL-LINE-PACK (ASC-BLK-SUB ASC-ITEM-SUB)    34070000
340800                                 TO MR-LINE-PACK (PV-SUB)         34080000
340900             MOVE ASC-TBL-PO-RECEIVER (ASC-BLK-SUB ASC-ITEM-SUB)  34090000
341000                                 TO MR-PO-RECEIVER (PV-SUB)       34100000
341100             MOVE ASC-TBL-PKG-CODE (ASC-BLK-SUB ASC-ITEM-SUB)     34110000
341200                                 TO MR-PKG-CODE (PV-SUB)          34120000
341300             MOVE ASC-TBL-USER-ID (ASC-BLK-SUB ASC-ITEM-SUB)      34130000
341400                                 TO MR-USER-ID (PV-SUB)           34140000
341500                                                                  34150000
341600             IF ASC-TBL-CREATE-DATE (ASC-BLK-SUB ASC-ITEM-SUB)    34160000
341700                                 = '09-09-99'                     34170000
341800                 MOVE SPACES     TO MR-CREATE-DATE (PV-SUB)       34180000
341900             ELSE                                                 34190000
342000                 MOVE ASC-TBL-CREATE-DATE                         34200000
342100                             (ASC-BLK-SUB ASC-ITEM-SUB)           34210000
342200                                 TO MR-CREATE-DATE (PV-SUB)       34220000
342300             END-IF                                               34230000
342400                                                                  34240000
342500             IF ASC-TBL-CREATE-TIME (ASC-BLK-SUB ASC-ITEM-SUB)    34250000
342600                                 = '09:09:99'                     34260000
342700                 MOVE SPACES     TO MR-CREATE-TIME (PV-SUB)       34270000
342800             ELSE                                                 34280000
342900                 MOVE ASC-TBL-CREATE-TIME                         34290000
343000                             (ASC-BLK-SUB ASC-ITEM-SUB)           34300000
343100                                 TO MR-CREATE-TIME (PV-SUB)       34310000
343200             END-IF                                               34320000
343300                                                                  34330000
343400             MOVE ASC-TBL-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB)     34340000
343500                                 TO MR-FUNCTION (PV-SUB)          34350000
343600             IF ASC-TBL-DEST-OPER-UNT (ASC-BLK-SUB ASC-ITEM-SUB)  34360000
343700                           =   0                                  34370000
343800                MOVE SPACES TO MR-DEST-OPER-UNT-ID-X (PV-SUB)     34380000
343900             ELSE                                                 34390000
344000                MOVE ASC-TBL-DEST-OPER-UNT                        34400000
344100                                        (ASC-BLK-SUB ASC-ITEM-SUB)34410000
344200                                 TO MR-DEST-OPER-UNT-ID (PV-SUB)  34420000
344300             END-IF                                               34430000
344400         END-IF                                                   34440000
344500     END-IF.                                                      34450000
344600     SUBTRACT +1 FROM ASC-ITEM-SUB                                34460000
344700     IF  ASC-ITEM-SUB < + 1                                       34470000
344800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  34480000
344900         MOVE +1                 TO ASC-BLK-SUB                   34490000
345000     END-IF.                                                      34500000
345100******************************************************************34510000
345200** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **34520000
345300** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **34530000
345400** ISSUE A WARNING.                                             **34540000
345500******************************************************************34550000
345600 4430-CHECK-FOR-BEGIN-AND-END.                                    34560000
345700     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       34570000
345800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     34580000
345900*            -- NO END-OF-RANGE SPECFIED ---                      34590000
346000             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            34600000
346100             SET DP020-MSG-WARNING TO TRUE                        34610000
346200             PERFORM 4431-POSITION-AT-WARNING                     34620000
346300         END-IF                                                   34630000
346400     ELSE                                                         34640000
346500         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     34650000
346600*            -- NO BEGINNING-OF-RANGE SPECFIED ---                34660000
346700             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            34670000
346800             SET DP020-MSG-WARNING TO TRUE                        34680000
346900             PERFORM 4431-POSITION-AT-WARNING                     34690000
347000         END-IF                                                   34700000
347100     END-IF.                                                      34710000
347200******************************************************************34720000
347300** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **34730000
347400** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **34740000
347500** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **34750000
347600** POSITION THE CURSOR THERE.                                   **34760000
347700******************************************************************34770000
347800 4431-POSITION-AT-WARNING.                                        34780000
347900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 34790000
348000                    - PV-TOP-ITEM + 1.                            34800000
348100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34810000
348200         CONTINUE                                                 34820000
348300     ELSE                                                         34830000
348400         SET DP030-SET-CURSOR-APPL-1                              34840000
348500                                   TO TRUE                        34850000
348600         MOVE -1                   TO MR-SELECTL (PV-SUB)         34860000
348700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         34870000
348800         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         34880000
348900     END-IF.                                                      34890000
349000*                                                                 34900000
349100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   34910000
349200                    - PV-TOP-ITEM + 1.                            34920000
349300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34930000
349400         CONTINUE                                                 34940000
349500     ELSE                                                         34950000
349600         SET DP030-SET-CURSOR-APPL-1                              34960000
349700                                   TO TRUE                        34970000
349800         MOVE -1                   TO MR-SELECTL (PV-SUB)         34980000
349900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         34990000
350000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         35000000
350100     END-IF.                                                      35010000
350200 EJECT                                                            35020000
350300                                                                  35030000
350400*----------------------------------------------------------------*35040000
350500* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *35050000
350600* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *35060000
350700* FOR THE SELECTED ITEMS QUEUE.                                  *35070000
350800*                                                                *35080000
350900* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *35090000
351000* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *35100000
351100* THE ARRAY IS FULL.                                             *35110000
351200*----------------------------------------------------------------*35120000
351300                                                                  35130000
351400 5000-PREPARE-SEL-QUEUE.                                          35140000
351500                                                                  35150000
351600     MOVE +1                   TO  ASC-BLK-SUB.                   35160000
351700     PERFORM 5100-WRITE-TEMP-STORAGE.                             35170000
351800     ADD +1                    TO  ASC-BLK-SUB.                   35180000
351900     PERFORM 5100-WRITE-TEMP-STORAGE.                             35190000
352000                                                                  35200000
352100*    MOVE ASC-SEL-QUEUE-NAME   TO  SU024-SEL-QUEUE-NAME.          35210000
352200*LMM FOR F24                                                      35220000
352300     MOVE ASC-SEL-QUEUE-NAME   TO  RC015-SEL-QUEUE-NAME.          35230000
352400     PERFORM 6010-DELETE-SEL-QUEUE.                               35240000
352500                                                                  35250000
352600     SET ASC-UPDATE-TSQ        TO  TRUE.                          35260000
352700                                                                  35270000
352800*    SET SU025-IDX             TO  1.                             35280000
352900*    MOVE ZERO                 TO SU024-NUMBER-OF-TS-ITEMS.       35290000
353000*    INITIALIZE SU025-SELECTED-ITEM-ARRAY.                        35300000
353100*LMM FOR F24                                                      35310000
353200     SET RC013-IDX             TO  1.                             35320000
353300     MOVE ZERO                 TO RC015-NUMBER-OF-TS-ITEMS.       35330000
353400     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        35340000
353500                                                                  35350000
353600     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           35360000
353700             VARYING PV-ITEM                                      35370000
353800             FROM 1 BY 1                                          35380000
353900             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     35390000
354000                                                                  35400000
354100*    IF  SU025-IDX > 1                                            35410000
354200*        PERFORM 5205-WRITE-SEL-QUEUE                             35420000
354300*        ADD +1                TO SU024-NUMBER-OF-TS-ITEMS        35430000
354400*    END-IF.                                                      35440000
354500*LMM FOR F24                                                      35450000
354600     IF  RC013-IDX > 1                                            35460000
354700         PERFORM 5205-WRITE-SEL-QUEUE                             35470000
354800         ADD +1                TO RC015-NUMBER-OF-TS-ITEMS        35480000
354900     END-IF.                                                      35490000
355000 EJECT                                                            35500000
355100*----------------------------------------------------------------*35510000
355200*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *35520000
355300*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *35530000
355400*----------------------------------------------------------------*35540000
355500                                                                  35550000
355600 5100-WRITE-TEMP-STORAGE.                                         35560000
355700     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     35570000
355800                                   TO PV-LIST-ITEM-NUMBER.        35580000
355900     COMPUTE PV-BLOCK-NUMBER =                                    35590000
356000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    35600000
356100                                                                  35610000
356200     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             35620000
356300     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             35630000
356400         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      35640000
356500             PERFORM 5105-REWRITE-ASC-LISTQ                       35650000
356600         END-IF                                                   35660000
356700     ELSE                                                         35670000
356800         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       35680000
356900         ASC-HIGHEST-BLOCK-WRITTEN + 1                            35690000
357000         PERFORM 5110-WRITE-ASC-LISTQ                             35700000
357100         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   35710000
357200     END-IF.                                                      35720000
357300                                                                  35730000
357400     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             35740000
357500******************************************************************35750000
357600** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **35760000
357700** SPECIFIC COMMAREA.                                           **35770000
357800******************************************************************35780000
357900 5105-REWRITE-ASC-LISTQ.                                          35790000
358000     EXEC CICS                                                    35800000
358100         WRITEQ TS                                                35810000
358200             QUEUE (ASC-LIST-QUEUE-NAME)                          35820000
358300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               35830000
358400             ITEM  (PV-BLOCK-NUMBER)                              35840000
358500             REWRITE                                              35850000
358600             RESP  (PV-CICS-RESP)                                 35860000
358700     END-EXEC.                                                    35870000
358800                                                                  35880000
358900     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           35890000
359000         CONTINUE                                                 35900000
359100     ELSE                                                         35910000
359200         SET DP013-CICS-ABEND            TO TRUE                  35920000
359300         SET DP013-NO-ROLLBACK           TO TRUE                  35930000
359400         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       35940000
359500         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     35950000
359600                                         TO DP013-MESSAGE-TEXT(1) 35960000
359700         PERFORM DP013-0000-PROCESS-ABEND                         35970000
359800     END-IF.                                                      35980000
359900                                                                  35990000
360000******************************************************************36000000
360100** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **36010000
360200** SPECIFIC COMMAREA.                                           **36020000
360300******************************************************************36030000
360400 5110-WRITE-ASC-LISTQ.                                            36040000
360500     EXEC CICS                                                    36050000
360600         WRITEQ TS                                                36060000
360700             QUEUE (ASC-LIST-QUEUE-NAME)                          36070000
360800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               36080000
360900             ITEM  (PV-BLOCK-NUMBER)                              36090000
361000             RESP  (PV-CICS-RESP)                                 36100000
361100     END-EXEC.                                                    36110000
361200     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      36120000
361300         SET DP013-CICS-ABEND      TO TRUE                        36130000
361400         SET DP013-NO-ROLLBACK     TO TRUE                        36140000
361500         MOVE '5110-WRITE-ASC-LISTQ'                              36150000
361600                                   TO DP013-PARAGRAPH             36160000
361700         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           36170000
361800                                   TO DP013-MESSAGE-TEXT(1)       36180000
361900         PERFORM DP013-0000-PROCESS-ABEND                         36190000
362000     END-IF.                                                      36200000
362100 EJECT                                                            36210000
362200*----------------------------------------------------------------*36220000
362300* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *36230000
362400* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *36240000
362500*----------------------------------------------------------------*36250000
362600                                                                  36260000
362700*                                                                 36270000
362800 5120-REWRITE-LIST-QUEUE.                                         36280000
362900     EXEC CICS                                                    36290000
363000          WRITEQ TS                                               36300000
363100*             QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     36310000
363200*             FROM    (SU025-SELECT-RECORD)                       36320000
363300*             ITEM    (ASC-SEL-ITEM)                              36330000
363400*             RESP    (PV-CICS-RESP)                              36340000
363500*LMM FOR F24                                                      36350000
363600              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     36360000
363700              FROM    (RC013-DC-SELECT-RECORD)                    36370000
363800              ITEM    (ASC-SEL-ITEM)                              36380000
363900              RESP    (PV-CICS-RESP)                              36390000
364000              REWRITE                                             36400000
364100     END-EXEC.                                                    36410000
364200                                                                  36420000
364300     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    36430000
364400         SET DP013-CICS-ABEND                                     36440000
364500             DP013-NO-ROLLBACK     TO TRUE                        36450000
364600         MOVE '5120-REWRITE-LIST-QUEUE'                           36460000
364700                                   TO DP013-PARAGRAPH             36470000
364800         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   36480000
364900                                   TO DP013-MESSAGE-TEXT (1)      36490000
365000         PERFORM DP013-0000-PROCESS-ABEND                         36500000
365100     END-IF.                                                      36510000
365200                                                                  36520000
365300                                                                  36530000
365400 5200-FILL-SEL-QUEUE-RECORD.                                      36540000
365500                                                                  36550000
365600     PERFORM 6112-READ-LIST-QUEUE.                                36560000
365700                                                                  36570000
365800     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       36580000
365900         PERFORM                                                  36590000
366000         VARYING LQW-IDX                                          36600000
366100         FROM 1 BY 1                                              36610000
366200         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            36620000
366300           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          36630000
366400                                                                  36640000
366500             IF  LQW-SELECT (LQW-IDX)                             36650000
366600                                                                  36660000
366700*                MOVE SPACE      TO SU025-ACTION-SW (SU025-IDX)   36670000
366800*                SET SU025-IDX UP BY 1                            36680000
366900*                IF  SU025-IDX > SU025-MAX-ITEMS                  36690000
367000*                    PERFORM 5205-WRITE-SEL-QUEUE                 36700000
367100*                    ADD +1        TO SU024-NUMBER-OF-TS-ITEMS    36710000
367200*                    INITIALIZE SU025-SELECTED-ITEM-ARRAY         36720000
367300*                    SET SU025-IDX TO  1                          36730000
367400*LMM FOR F24                                                      36740000
367500                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              36750000
367600                                   TO RC013-ITEM (RC013-IDX)      36760000
367700                 MOVE SPACE      TO RC013-ACTION-SW (RC013-IDX)   36770000
367800                 MOVE LQW-OPER-UNT-ID (LQW-IDX)                   36780000
367900                                 TO RC013-OPER-UNT-ID             36790000
368000                                    (RC013-IDX)                   36800000
368100                 MOVE LQW-PO-NBR      (LQW-IDX)                   36810000
368200                                 TO RC013-PO-NBR                  36820000
368300                                    (RC013-IDX)                   36830000
368400                 MOVE LQW-RECEIVER    (LQW-IDX)                   36840000
368500                                 TO RC013-REC-SEQ-NBR             36850000
368600                                    (RC013-IDX)                   36860000
368700                 MOVE LQW-DEST-OPER-UNT    (LQW-IDX)              36870000
368800                                 TO RC013-STR-NBR                 36880000
368900                                    (RC013-IDX)                   36890000
369000                 MOVE LQW-PKSL-SEQ-NBR     (LQW-IDX)              36900000
369100                                 TO RC013-SEQ-NBR                 36910000
369200                                    (RC013-IDX)                   36920000
369300                                                                  36930000
369400                 SET RC013-IDX UP BY 1                            36940000
369500                 IF  RC013-IDX > RC013-MAX-ITEMS                  36950000
369600                     PERFORM 5205-WRITE-SEL-QUEUE                 36960000
369700                     ADD +1        TO RC015-NUMBER-OF-TS-ITEMS    36970000
369800                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         36980000
369900                     SET RC013-IDX TO  1                          36990000
370000                 END-IF                                           37000000
370100             END-IF                                               37010000
370200         END-PERFORM                                              37020000
370300     END-IF.                                                      37030000
370400                                                                  37040000
370500*** LOOK AT DC FUNC CDE TO SEE IF PACKSLIP DELETE                 37050000
370600 5200A-FILL-SEL-QUEUE-RECORD.                                     37060000
370700                                                                  37070000
370800     MOVE +1                   TO  ASC-BLK-SUB.                   37080000
370900     PERFORM 5100-WRITE-TEMP-STORAGE.                             37090000
371000     ADD +1                    TO  ASC-BLK-SUB.                   37100000
371100     PERFORM 5100-WRITE-TEMP-STORAGE.                             37110000
371200                                                                  37120000
371300     PERFORM 6112-READ-LIST-QUEUE.                                37130000
371400                                                                  37140000
371500     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       37150000
371600         PERFORM                                                  37160000
371700         VARYING LQW-IDX                                          37170000
371800         FROM 1 BY 1                                              37180000
371900         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            37190000
372000           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          37200000
372100                                                                  37210000
372200             IF  LQW-SELECT (LQW-IDX)                             37220000
372300                                                                  37230000
372400                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              37240000
372500                                   TO RC013-ITEM (RC013-IDX)      37250000
372600                 MOVE SPACE      TO RC013-ACTION-SW (RC013-IDX)   37260000
372700                                                                  37270000
372800                 EVALUATE TRUE                                    37280000
372900                    WHEN LQW-DC-FUNC-CDE (LQW-IDX) = '0C'         37290000
373000                       CONTINUE                                   37300000
373100                    WHEN LQW-DC-FUNC-CDE (LQW-IDX) = '0D'         37310000
373200                       CONTINUE                                   37320000
373300                    WHEN OTHER                                    37330000
373400                       SET PS-ERROR TO TRUE                       37340000
373500                 END-EVALUATE                                     37350000
373600                                                                  37360000
373700                 SET RC013-IDX UP BY 1                            37370000
373800                 IF  RC013-IDX > RC013-MAX-ITEMS                  37380000
373900                     PERFORM 5205-WRITE-SEL-QUEUE                 37390000
374000                     ADD +1        TO RC015-NUMBER-OF-TS-ITEMS    37400000
374100                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         37410000
374200                     SET RC013-IDX TO  1                          37420000
374300                 END-IF                                           37430000
374400             END-IF                                               37440000
374500         END-PERFORM                                              37450000
374600     END-IF.                                                      37460000
374700                                                                  37470000
374800*----------------------------------------------------------------*37480000
374900*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *37490000
375000*----------------------------------------------------------------*37500000
375100                                                                  37510000
375200 5205-WRITE-SEL-QUEUE.                                            37520000
375300                                                                  37530000
375400*    MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            37540000
375500*                                  TO SU025-SELECTED-ITEMS.       37550000
375600                                                                  37560000
375700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            37570000
375800                                   TO RC013-SELECTED-ITEMS.       37580000
375900                                                                  37590000
376000*    EXEC CICS                                                    37600000
376100*         WRITEQ TS                                               37610000
376200*             QUEUE (ASC-SEL-QUEUE-NAME)                          37620000
376300*             FROM  (SU025-SELECT-RECORD)                         37630000
376400*             ITEM  (PV-SEL-QUEUE-ITEM)                           37640000
376500*             RESP  (PV-CICS-RESP)                                37650000
376600*    END-EXEC.                                                    37660000
376700                                                                  37670000
376800     EXEC CICS                                                    37680000
376900          WRITEQ TS                                               37690000
377000              QUEUE (ASC-SEL-QUEUE-NAME)                          37700000
377100              FROM  (RC013-DC-SELECT-RECORD)                      37710000
377200              ITEM  (PV-SEL-QUEUE-ITEM)                           37720000
377300              RESP  (PV-CICS-RESP)                                37730000
377400     END-EXEC.                                                    37740000
377500                                                                  37750000
377600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37760000
377700         CONTINUE                                                 37770000
377800     ELSE                                                         37780000
377900         SET DP013-CICS-ABEND      TO TRUE                        37790000
378000         SET DP013-NO-ROLLBACK     TO TRUE                        37800000
378100         MOVE '5205-WRITE-SEL-QUEUE'                              37810000
378200                                   TO DP013-PARAGRAPH             37820000
378300         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          37830000
378400                                   TO DP013-MESSAGE-TEXT(1)       37840000
378500         PERFORM DP013-0000-PROCESS-ABEND                         37850000
378600     END-IF.                                                      37860000
378700 EJECT                                                            37870000
378800******************************************************************37880000
378900** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **37890000
379000** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **37900000
379100** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **37910000
379200** THE USER.                                                    **37920000
379300******************************************************************37930000
379400 6000-REFRESH-PANEL-FROM-TEMP.                                    37940000
379500     IF  ASC-UPDATE-TSQ                                           37950000
379600         SET ASC-NO-TSQ-UPDATE TO TRUE                            37960000
379700         MOVE ZERO                 TO PV-SAVE-ITEM                37970000
379800                                      PV-SEL-QUEUE-ITEM           37980000
379900         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        37990000
380000                                   TO PV-HOLD-SELECTED-ITEMS      38000000
380100         MOVE +1                   TO PV-ITEMS-PROCESSED          38010000
380200         PERFORM 6100-UPDATE-TSQ                                  38020000
380300             UNTIL PV-ITEMS-PROCESSED >                           38030000
380400                                     PV-HOLD-SELECTED-ITEMS       38040000
380500         PERFORM 6010-DELETE-SEL-QUEUE                            38050000
380600         INITIALIZE ASC-BLOCK-ENTRIES (1)                         38060000
380700                    ASC-BLOCK-ENTRIES (2)                         38070000
380800     END-IF.                                                      38080000
380900                                                                  38090000
381000*----------------------------------------------------------------*38100000
381100*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *38110000
381200*----------------------------------------------------------------*38120000
381300 6010-DELETE-SEL-QUEUE.                                           38130000
381400                                                                  38140000
381500     EXEC CICS                                                    38150000
381600         DELETEQ TS                                               38160000
381700             QUEUE (ASC-SEL-QUEUE-NAME)                           38170000
381800             RESP  (PV-CICS-RESP)                                 38180000
381900     END-EXEC.                                                    38190000
382000*                                                                 38200000
382100     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      38210000
382200        (PV-CICS-RESP = DFHRESP(QIDERR)))                         38220000
382300         CONTINUE                                                 38230000
382400     ELSE                                                         38240000
382500         SET DP013-CICS-ABEND TO TRUE                             38250000
382600         SET DP013-NO-ROLLBACK TO TRUE                            38260000
382700         MOVE '6010-DELETE-SEL-QUEUE'                             38270000
382800                        TO DP013-PARAGRAPH                        38280000
382900         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         38290000
383000                        TO DP013-MESSAGE-TEXT (1)                 38300000
383100         PERFORM DP013-0000-PROCESS-ABEND                         38310000
383200     END-IF.                                                      38320000
383300                                                                  38330000
383400*----------------------------------------------------------------*38340000
383500*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *38350000
383600*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *38360000
383700*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *38370000
383800*    THE TEMP QUEUE.                                             *38380000
383900*----------------------------------------------------------------*38390000
384000                                                                  38400000
384100 6100-UPDATE-TSQ.                                                 38410000
384200                                                                  38420000
384300     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             38430000
384400     PERFORM 6105-READ-SEL-QUEUE.                                 38440000
384500     PERFORM                                                      38450000
384600*        VARYING SU025-IDX                                        38460000
384700*        FROM 1 BY 1                                              38470000
384800*        UNTIL ((PV-ITEMS-PROCESSED >                             38480000
384900*                             PV-HOLD-SELECTED-ITEMS)             38490000
385000*        OR (SU025-IDX GREATER THAN SU025-MAX-ITEMS))             38500000
385100*        IF  SU025-ACTION-SW (SU025-IDX) > SPACE                  38510000
385200*            PERFORM 6110-PROCESS-ITEMS                           38520000
385300*        END-IF                                                   38530000
385400*LMM FOR F24                                                      38540000
385500         VARYING RC013-IDX                                        38550000
385600         FROM 1 BY 1                                              38560000
385700         UNTIL ((PV-ITEMS-PROCESSED >                             38570000
385800                              PV-HOLD-SELECTED-ITEMS)             38580000
385900         OR (RC013-IDX GREATER THAN RC013-MAX-ITEMS))             38590000
386000         IF  RC013-ACTION-SW (RC013-IDX) > SPACE                  38600000
386100             PERFORM 6110-PROCESS-ITEMS                           38610000
386200         END-IF                                                   38620000
386300         ADD +1                TO PV-ITEMS-PROCESSED              38630000
386400     END-PERFORM.                                                 38640000
386500     PERFORM 6111-WRITE-LIST-QUEUE.                               38650000
386600*----------------------------------------------------------------*38660000
386700*    READ THE LIST QUEUE RECORD.                                 *38670000
386800*----------------------------------------------------------------*38680000
386900                                                                  38690000
387000 6105-READ-SEL-QUEUE.                                             38700000
387100                                                                  38710000
387200     EXEC CICS                                                    38720000
387300          READQ TS                                                38730000
387400*             QUEUE (ASC-SEL-QUEUE-NAME)                          38740000
387500*             INTO  (SU025-SELECT-RECORD)                         38750000
387600*             ITEM  (PV-SEL-QUEUE-ITEM)                           38760000
387700*             RESP  (PV-CICS-RESP)                                38770000
387800*LMM FOR F24                                                      38780000
387900              QUEUE (ASC-SEL-QUEUE-NAME)                          38790000
388000              INTO  (RC013-DC-SELECT-RECORD)                      38800000
388100              ITEM  (PV-SEL-QUEUE-ITEM)                           38810000
388200              RESP  (PV-CICS-RESP)                                38820000
388300     END-EXEC.                                                    38830000
388400*                                                                 38840000
388500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          38850000
388600         CONTINUE                                                 38860000
388700     ELSE                                                         38870000
388800         SET DP013-CICS-ABEND      TO  TRUE                       38880000
388900         SET DP013-NO-ROLLBACK     TO  TRUE                       38890000
389000         MOVE '6105-READ-SEL-QUEUE'                               38900000
389100                                   TO  DP013-PARAGRAPH            38910000
389200         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           38920000
389300                                   TO  DP013-MESSAGE-TEXT(1)      38930000
389400         PERFORM DP013-0000-PROCESS-ABEND                         38940000
389500     END-IF.                                                      38950000
389600 EJECT                                                            38960000
389700*----------------------------------------------------------------*38970000
389800*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*38980000
389900*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*38990000
390000*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *39000000
390100*----------------------------------------------------------------*39010000
390200                                                                  39020000
390300 6110-PROCESS-ITEMS.                                              39030000
390400                                                                  39040000
390500*    COMPUTE PV-ITEM = 1 + ((SU025-ITEM (SU025-IDX) - 1)          39050000
390600*                    / PC-ITEMS-PER-PANEL).                       39060000
390700*LMM FOR F24                                                      39070000
390800     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          39080000
390900                     / PC-ITEMS-PER-PANEL).                       39090000
391000                                                                  39100000
391100     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           39110000
391200         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          39120000
391300             PERFORM 6111-WRITE-LIST-QUEUE                        39130000
391400         END-IF                                                   39140000
391500         MOVE PV-ITEM          TO PV-SAVE-ITEM                    39150000
391600                                                                  39160000
391700         PERFORM 6112-READ-LIST-QUEUE                             39170000
391800         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               39180000
391900             CONTINUE                                             39190000
392000         END-IF                                                   39200000
392100     END-IF.                                                      39210000
392200                                                                  39220000
392300*    COMPUTE PV-SUB = (SU025-ITEM (SU025-IDX)                     39230000
392400*                   - LQW-LIST-ITEM-NUMBER (1)) + 1.              39240000
392500*    SET LQW-DESELECT (PV-SUB) TO    TRUE                         39250000
392600*    MOVE LQW-SELECTED-SW (PV-SUB)                                39260000
392700*                              TO LQW-TEMP-SELECTED-SW (PV-SUB).  39270000
392800*    EVALUATE TRUE                                                39280000
392900*        WHEN SU025-INQ (SU025-IDX)                               39290000
393000*             MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             39300000
393100*                                                                 39310000
393200*        WHEN SU025-UPD (SU025-IDX)                               39320000
393300*             MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             39330000
393400*                                                                 39340000
393500*        WHEN SU025-DEL (SU025-IDX)                               39350000
393600*             MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             39360000
393700*                                                                 39370000
393800*        WHEN SU025-ERR (SU025-IDX)                               39380000
393900*             MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             39390000
394000*    END-EVALUATE.                                                39400000
394100*LMM FOR F24                                                      39410000
394200     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX)                     39420000
394300                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              39430000
394400     SET LQW-DESELECT (PV-SUB) TO    TRUE                         39440000
394500     MOVE LQW-SELECTED-SW (PV-SUB)                                39450000
394600                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  39460000
394700     EVALUATE TRUE                                                39470000
394800         WHEN RC013-INQ (RC013-IDX)                               39480000
394900              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             39490000
395000                                                                  39500000
395100         WHEN RC013-UPD (RC013-IDX)                               39510000
395200              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             39520000
395300                                                                  39530000
395400         WHEN RC013-DEL (RC013-IDX)                               39540000
395500              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             39550000
395600                                                                  39560000
395700         WHEN RC013-ERR (RC013-IDX)                               39570000
395800              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             39580000
395900     END-EVALUATE.                                                39590000
396000                                                                  39600000
396100     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                39610000
396200                                                                  39620000
396300*----------------------------------------------------------------*39630000
396400*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *39640000
396500*----------------------------------------------------------------*39650000
396600                                                                  39660000
396700 6111-WRITE-LIST-QUEUE.                                           39670000
396800                                                                  39680000
396900     EXEC CICS                                                    39690000
397000         WRITEQ TS                                                39700000
397100             QUEUE (ASC-LIST-QUEUE-NAME)                          39710000
397200             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     39720000
397300             ITEM  (PV-SAVE-ITEM)                                 39730000
397400             REWRITE                                              39740000
397500             RESP  (PV-CICS-RESP)                                 39750000
397600     END-EXEC.                                                    39760000
397700*                                                                 39770000
397800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          39780000
397900         CONTINUE                                                 39790000
398000     ELSE                                                         39800000
398100         SET DP013-CICS-ABEND  TO  TRUE                           39810000
398200         SET DP013-NO-ROLLBACK TO  TRUE                           39820000
398300         MOVE '6111-WRITE-LIST-QUEUE'                             39830000
398400                               TO  DP013-PARAGRAPH                39840000
398500         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  39850000
398600                               TO  DP013-MESSAGE-TEXT(1)          39860000
398700         PERFORM DP013-0000-PROCESS-ABEND                         39870000
398800     END-IF.                                                      39880000
398900                                                                  39890000
399000 EJECT                                                            39900000
399100*----------------------------------------------------------------*39910000
399200*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*39920000
399300*----------------------------------------------------------------*39930000
399400                                                                  39940000
399500 6112-READ-LIST-QUEUE.                                            39950000
399600                                                                  39960000
399700     EXEC CICS                                                    39970000
399800         READQ TS                                                 39980000
399900             QUEUE (ASC-LIST-QUEUE-NAME)                          39990000
400000             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     40000000
400100             ITEM  (PV-ITEM)                                      40010000
400200             RESP  (PV-CICS-RESP)                                 40020000
400300     END-EXEC.                                                    40030000
400400*                                                                 40040000
400500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          40050000
400600         CONTINUE                                                 40060000
400700     ELSE                                                         40070000
400800         SET DP013-CICS-ABEND        TO TRUE                      40080000
400900         SET DP013-NO-ROLLBACK       TO TRUE                      40090000
401000         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           40100000
401100         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    40110000
401200                                     TO DP013-MESSAGE-TEXT(1)     40120000
401300         PERFORM DP013-0000-PROCESS-ABEND                         40130000
401400     END-IF.                                                      40140000
401500                                                                  40150000
401600*----------------------------------------------------------------*40160000
401700* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *40170000
401800*----------------------------------------------------------------*40180000
401900                                                                  40190000
402000 9100-READ-SEL-QUEUE.                                             40200000
402100     EXEC CICS                                                    40210000
402200         READQ TS                                                 40220000
402300*            QUEUE (ASC-SEL-QUEUE-NAME-IN)                        40230000
402400*            INTO  (SU025-SELECT-RECORD)                          40240000
402500*            ITEM  (ASC-SEL-ITEM)                                 40250000
402600*            RESP  (PV-CICS-RESPONSE)                             40260000
402700*LMM FOR F24                                                      40270000
402800             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        40280000
402900             INTO  (RC013-DC-SELECT-RECORD)                       40290000
403000             ITEM  (ASC-SEL-ITEM)                                 40300000
403100             RESP  (PV-CICS-RESPONSE)                             40310000
403200     END-EXEC.                                                    40320000
403300                                                                  40330000
403400     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   40340000
403500         CONTINUE                                                 40350000
403600     ELSE                                                         40360000
403700         SET DP013-LOGIC-ABEND                                    40370000
403800             DP013-NO-ROLLBACK     TO TRUE                        40380000
403900         MOVE '9100-READ-SEL-QUEUE'                               40390000
404000                                   TO DP013-PARAGRAPH             40400000
404100         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   40410000
404200                                   TO DP013-MESSAGE-TEXT (1)      40420000
404300         PERFORM DP013-0000-PROCESS-ABEND                         40430000
404400     END-IF.                                                      40440000
404500*----------------------------------------------------------------*40450000
404600* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *40460000
404700*----------------------------------------------------------------*40470000
404800 9200-REWRITE-LIST-QUEUE.                                         40480000
404900     EXEC CICS                                                    40490000
405000          WRITEQ TS                                               40500000
405100*             QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      40510000
405200*             FROM   (SU025-SELECT-RECORD)                        40520000
405300*             ITEM   (ASC-SEL-ITEM)                               40530000
405400*             RESP   (PV-CICS-RESPONSE)                           40540000
405500*             REWRITE                                             40550000
405600*LMM FOR F24                                                      40560000
405700              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      40570000
405800              FROM   (RC013-DC-SELECT-RECORD)                     40580000
405900              ITEM   (ASC-SEL-ITEM)                               40590000
406000              RESP   (PV-CICS-RESPONSE)                           40600000
406100              REWRITE                                             40610000
406200     END-EXEC.                                                    40620000
406300                                                                  40630000
406400     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               40640000
406500         SET DP013-CICS-ABEND                                     40650000
406600             DP013-NO-ROLLBACK     TO TRUE                        40660000
406700         MOVE '9200-REWRITE-LIST-QUEUE'                           40670000
406800                                   TO DP013-PARAGRAPH             40680000
406900         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   40690000
407000                                   TO DP013-MESSAGE-TEXT (1)      40700000
407100         PERFORM DP013-0000-PROCESS-ABEND                         40710000
407200     END-IF.                                                      40720000
407300                                                                  40730000
407400 EJECT                                                            40740000
407500*----------------------------------------------------------------*40750000
407600*    ABEND PROCESSOR MODULE                                      *40760000
407700*----------------------------------------------------------------*40770000
407800                                                                  40780000
407900     COPY DPPD013.                                                40790000
