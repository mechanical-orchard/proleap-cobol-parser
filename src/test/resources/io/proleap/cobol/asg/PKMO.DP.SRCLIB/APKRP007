000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    APKRP007.                                         00020000
000300 AUTHOR.        MIKE BESKE.                                       00030000
000400 DATE-WRITTEN.  JUNE 2000.                                        00040000
000500 DATE-COMPILED.                                                   00050000
000600***************************************************************** 00060000
000700*        VENDOR PURCHASES BY DEPT YEAR TO DATE REPORT           * 00070000
000800***************************************************************** 00080000
000900*    COBOL II                                                   * 00090000
001000***************************************************************** 00100000
001100*  PURPOSE:  CREATES THE MONTHLY VENDOR PURCHASES BY DEPT YEAR  * 00110000
001200*  TO DATE REPORT.                                              * 00120000
001300***************************************************************** 00130000
001400* CHANGES:                                                      * 00140000
001500*                                                               * 00150000
001600* 10/14/02  ADDED THE VENDOR NUMBER TO THE REPORT.              * 00160014
001700*           BY MIKE BESKE                 WR/PITS#: 24208       * 00170014
001800*                                                               * 00180000
001900* 04/22/04  RECOMPILED TO PICK UP CHANGES TO STOREEXT COPYBOOK. * 00190016
002000*           BY MIKE BESKE                 WR/PITS#: 25805       * 00200016
002100*                                                               * 00210000
002110* 02/12/08  FOR PRIVATE LABEL ACCOUNTING PROJECT CHANGED SORT   * 00211022
002120*           CARD AND LET PROGRAM ACCUMULATE TOTALS FOR CORRECT  * 00212021
002130*           FIELD EITHER UNIT COST FOR IMPORTS OR 1ST COST FOR  * 00213021
002140*           DOMESTIC                                            * 00214021
002150*           BY GREG WISIALOWSKI           WR/PITS#: 32664       * 00215021
002151*                                                               * 00215123
002152* 09/11/08  APK592 ABENDED DUE TO TOO MUCH SPACE NEEDED FOR THE * 00215231
002153*           SORT OF THE INPUT FILE.  THE FILE WAS DECREASED     * 00215323
002154*           IN SIZE FROM 300 TO 80 CHARACTERS.  A NEW COPYBOOK, * 00215423
002155*           APRD412, WAS CREATED TO DEFINE THE FIELDS IN THE    * 00215523
002158*           SMALLER FILE, REPLACING THE COPYBOOK STOREEXT       * 00215830
002159*           THAT WAS USED TO DEFINE THE LARGER FILE.            * 00215930
002160*           BY MICHELE RINDFLEISCH     WR/IR #: INC000000501631 * 00216023
002200***************************************************************** 00220000
002300*                                                                 00230000
002400     EJECT                                                        00240000
002500 ENVIRONMENT DIVISION.                                            00250000
002600 CONFIGURATION SECTION.                                           00260000
002700 SOURCE-COMPUTER.    IBM-3090.                                    00270000
002800 OBJECT-COMPUTER.    IBM-3090.                                    00280000
002900                                                                  00290000
003000 INPUT-OUTPUT SECTION.                                            00300000
003100 FILE-CONTROL.                                                    00310000
003200                                                                  00320000
003300     SELECT INPUT-FILE              ASSIGN TO INP01.              00330000
003400     SELECT REPORT-FILE             ASSIGN TO RPT01.              00340000
003500*                                                                 00350000
003600 DATA DIVISION.                                                   00360000
003700*                                                                 00370000
003800 FILE SECTION.                                                    00380000
003900*                                                                 00390000
004000 FD  INPUT-FILE                                                   00400000
004100     RECORDING MODE IS F                                          00410000
004200     LABEL RECORDS ARE STANDARD                                   00420000
004300     RECORD CONTAINS 80 CHARACTERS                                00430023
004400     BLOCK CONTAINS 0 RECORDS                                     00440000
004500     DATA RECORD IS INPUT-RECORD.                                 00450000
004600 01  INPUT-RECORD                  PIC  X(80).                    00460023
004700*                                                                 00470000
004800 FD  REPORT-FILE                                                  00480000
004900     RECORDING MODE IS F                                          00490000
005000     LABEL RECORDS ARE STANDARD                                   00500000
005100     RECORD CONTAINS 132 CHARACTERS                               00510000
005200     BLOCK CONTAINS 0 RECORDS                                     00520000
005300     DATA RECORD IS REPORT-RECORD.                                00530000
005400 01  REPORT-RECORD                 PIC X(132).                    00540000
005500*                                                                 00550000
005600     EJECT                                                        00560000
005700 WORKING-STORAGE SECTION.                                         00570000
005800******************************************************************00580000
005910**   EXTRACT STORE DETAIL RECORDS                               **00591024
006000******************************************************************00600000
006100     COPY APRD412.                                                00610026
006200*                                                                 00620000
006300 01  HF-HOLD-BREAK-FIELDS.                                        00630000
006400     05  HF-HOLD-BREAK-VEND         PIC  X(25)  VALUE SPACE.      00640000
006500     05  HF-HOLD-BREAK-VEND-NBR     PIC  X(09)  VALUE SPACE.      00650011
006600     05  HF-HOLD-BREAK-DEPT         PIC  9(03)  VALUE ZEROES.     00660001
006700*                                                                 00670000
006800 01  MC-MISCELLANEOUS-CONSTANTS.                                  00680000
006900     05  MC-RPT-TOTAL-MAX           PIC  S9(4)  COMP SYNC         00690000
007000                                                VALUE +3.         00700000
007100     05  MC-LEVEL-1                 PIC S9(04)  COMP SYNC         00710000
007200                                                VALUE +1.         00720000
007300     05  MC-LEVEL-2                 PIC S9(04)  COMP SYNC         00730000
007400                                                VALUE +2.         00740000
007500     05  MC-LEVEL-3                 PIC S9(04)  COMP SYNC         00750000
007600                                                VALUE +3.         00760000
007700     05  MC-PAGE-SIZE               PIC  S9(3)  COMP-3            00770000
007800                                                VALUE +56.        00780000
007900     05  MC-NUMBER-HEAD-LINES       PIC  S9(3)  COMP-3            00790000
008000                                                VALUE +6.         00800000
008100     05  MC-BLANK-LINE              PIC  X(132) VALUE SPACES.     00810000
008200     05  MC-ADVANCE-1-LINE          PIC  9(1)   VALUE 1.          00820000
008300     05  MC-ADVANCE-2-LINES         PIC  9(1)   VALUE 2.          00830000
008400     05  MC-ADVANCE-3-LINES         PIC  9(1)   VALUE 3.          00840000
008500*                                                                 00850000
008600 01  PC-PROGRAM-COUNTERS.                                         00860000
008700     05  PC-LINE-COUNT              PIC S9(03)  VALUE +99         00870000
008800                                                COMP-3.           00880000
008900     05  PC-PAGE-COUNT              PIC S9(05)  VALUE ZERO        00890000
009000                                                COMP-3.           00900000
009100*                                                                 00910000
009200 01  PV-PROGRAM-VARIABLES.                                        00920000
009300     05  PV-BREAK-LEVEL             PIC S9(04)  COMP SYNC         00930000
009400                                                VALUE ZERO.       00940000
009500         88  PV-BREAK-LEVEL-1                   VALUE +1.         00950000
009600         88  PV-BREAK-LEVEL-2                   VALUE +2.         00960000
009700         88  PV-BREAK-LEVEL-3                   VALUE +3.         00970000
009800     05  PV-NUMBER-OF-LINES         PIC 9(1)     VALUE ZERO.      00980000
009900*                                                                 00990000
010000 01  REPORT-TITLES.                                               01000000
010100     05  REPORT-TITLE-VALUES.                                     01010000
010200         10  RPT-DEPT-1             PIC X(25)   VALUE             01020000
010300             '     ** GRAND TOTALS **  '.                         01030000
010400         10  FILLER                 PIC X(25)   VALUE SPACES.     01040000
010500         10  FILLER                 PIC X(09)   VALUE SPACES.     01050011
010600         10  RPT-DEPT-2-A           PIC X(10)   VALUE             01060000
010700             '  * DEPT. '.                                        01070000
010800         10  RPT-DEPT-2-B           PIC X(3)    VALUE SPACES.     01080000
010900         10  RPT-DEPT-2-C           PIC X(12)   VALUE             01090000
011000             ' TOTALS *   '.                                      01100000
011100         10  FILLER                 PIC X(25)   VALUE SPACES.     01110000
011200         10  FILLER                 PIC X(09)   VALUE SPACES.     01120011
011300         10  RPT-DEPT-3             PIC X(25)   VALUE SPACE.      01130000
011400         10  RPT-VEND-3             PIC X(25)   VALUE SPACES.     01140000
011500         10  RPT-VEND-NBR-3         PIC X(09)   VALUE SPACES.     01150011
011600     05  REPORT-TITLE-TABLE  REDEFINES  REPORT-TITLE-VALUES.      01160000
011700         10  RPT-TITLES OCCURS 3 TIMES                            01170000
011800                        INDEXED BY REPORT-TITLES-INDEX.           01180000
011900             15  RPT-TITLE-DEPT     PIC X(25).                    01190000
012000             15  RPT-TITLE-VEND     PIC X(25).                    01200000
012100             15  RPT-TITLE-VEND-NBR PIC X(09).                    01210011
012200                                                                  01220000
012300* THE FOLLOWING CONTAINS THE ACCUMULATED TOTALS FOR THIS REPORT.  01230000
012400* TABLE OCCURANCE (1) CONTAINS HIGHEST LEVEL (GRAND) TOTALS, AND  01240000
012500* TABLE OCCURANCE (3) CONTAINS THE LOWEST LEVEL TOTALS.           01250000
012600*                                                                 01260000
012700 01  REPORT-TOTAL-TABLE.                                          01270000
012800     05  RPT-TOTALS  OCCURS  3 TIMES                              01280000
012900                     INDEXED BY REPORT-TOTALS-INDEX               01290000
013000                                REPORT-TOTALS-INDEX-NEXT.         01300033
013100         10  RPT-TOT-COST           PIC S9(11)V99   COMP-3.       01310000
013200         10  RPT-TOT-RETAIL         PIC S9(11)V99   COMP-3.       01320000
013300*                                                                 01330000
013400 01  SF-SYSTEM-FIELDS.                                            01340000
013500     05  SF-SYSTEM-DATE.                                          01350000
013600         10  SF-SYSTEM-YEAR         PIC  9(02)  VALUE ZERO.       01360000
013700         10  SF-SYSTEM-MONTH        PIC  9(02)  VALUE ZERO.       01370000
013800         10  SF-SYSTEM-DAY          PIC  9(02)  VALUE ZERO.       01380000
013900     05  SF-SYSTEM-TIME.                                          01390000
014000         10  SF-SYSTEM-HOUR         PIC  9(02)  VALUE ZERO.       01400000
014100         10  SF-SYSTEM-MINUTE       PIC  9(02)  VALUE ZERO.       01410000
014200         10  SF-SYSTEM-SECOND       PIC  9(02)  VALUE ZERO.       01420000
014300         10  FILLER                 PIC  9(02)  VALUE ZERO.       01430000
014400*                                                                 01440000
014500 01  SW-SWITCHES.                                                 01450000
014600     05  SW-END-OF-FILE-SW          PIC  X(01)  VALUE 'N'.        01460000
014700         88  SW-END-OF-FILE                     VALUE 'Y'.        01470000
014800         88  SW-NOT-END-OF-FILE                 VALUE 'N'.        01480000
014900     05  SW-BREAKS-FOUND-SW         PIC  X(01)  VALUE 'N'.        01490000
015000         88  SW-NO-BREAKS-FOUND                 VALUE 'N'.        01500000
015100         88  SW-BREAKS-FOUND                    VALUE 'Y'.        01510000
015200     05  SW-NEED-PAGE-HEAD-SW       PIC  X(01)  VALUE 'N'.        01520000
015300         88  SW-DONT-NEED-PAGE-HEAD             VALUE 'N'.        01530000
015400         88  SW-NEED-PAGE-HEAD                  VALUE 'Y'.        01540000
015500     05  SW-FIRST-READ-SW           PIC  X(01)  VALUE 'Y'.        01550000
015600         88  SW-FIRST-READ                      VALUE 'Y'.        01560000
015700         88  SW-NOT-FIRST-READ                  VALUE 'N'.        01570000
015800*                                                                 01580000
015900     EJECT                                                        01590000
016000******************************************************************01600000
016100**          KOHLS STANDARD 132 CHARACTER REPORT HEADER          **01610000
016200******************************************************************01620000
016300     COPY DPWS132O.                                               01630029
016400*                                                                 01640000
016500 01  RH1-REPORT-HEAD1.                                            01650000
016600     05  FILLER                     PIC  X(43)  VALUE SPACE.      01660008
016700     05  FILLER                     PIC  X(47)  VALUE             01670000
016800         'VENDOR PURCHASES BY DEPARTMENT FOR YEAR TO DATE'.       01680000
016900     05  FILLER                     PIC  X(42)  VALUE SPACE.      01690008
017000*                                                                 01700000
017100 01  CH1-COLUMN-HEAD1.                                            01710000
017200     05  FILLER                     PIC  X(51)  VALUE             01720011
017300       '  DEPT     VENDOR NAME            VNDR NBR         '.     01730015
017400     05  FILLER                     PIC  X(40)  VALUE             01740000
017500       ' MERCH COST              RETAIL         '.                01750007
017600     05  FILLER                     PIC  X(41)  VALUE             01760011
017700       '                                         '.               01770011
017800*                                                                 01780000
017900 01  DL1-DETAIL-LINE1.                                            01790007
018000     05  DL1-DEPARTMENT-NUMBER.                                   01800000
018100         10  FILLER                 PIC  X(02).                   01810000
018200         10  DL1-DEPT               PIC  X(25).                   01820000
018300         10  FILLER                 PIC  X(5).                    01830000
018400     05  DL1-VENDOR-NAME  REDEFINES  DL1-DEPARTMENT-NUMBER.       01840000
018500         10  FILLER                 PIC  X(07).                   01850000
018600         10  DL1-VENDOR             PIC  X(25).                   01860000
018700     05  FILLER                     PIC  X(02)  VALUE SPACE.      01870000
018800     05  DL1-VENDOR-NUMBER          PIC  X(09)  VALUE SPACE.      01880011
018900     05  FILLER                     PIC  X(02)  VALUE SPACE.      01890011
019000     05  DL1-MERCH-COST             PIC  ZZ,ZZZ,ZZZ,ZZZ.99-       01900011
019100                                                VALUE ZERO        01910011
019200                                                BLANK WHEN ZERO.  01920011
019300     05  FILLER                     PIC  X(02)  VALUE SPACE.      01930011
019400     05  DL1-RETAIL                 PIC  ZZ,ZZZ,ZZZ,ZZZ.99-       01940011
019500                                                VALUE ZERO        01950011
019600                                                BLANK WHEN ZERO.  01960011
019700     05  FILLER                     PIC  X(52)  VALUE SPACE.      01970011
019800*                                                                 01980011
019900 01  RE1-REPORT-END-LINE1.                                        01990011
020000     05  FILLER                     PIC  X(49)  VALUE SPACE.      02000011
020100     05  FILLER                     PIC  X(34)  VALUE             02010011
020200         '***  END OF REPORT APKRP007-1  ***'.                    02020011
020300     05  FILLER                     PIC  X(49)  VALUE SPACE.      02030011
020400*                                                                 02040011
020500     EJECT                                                        02050011
020600 PROCEDURE DIVISION.                                              02060011
020700*                                                                 02070011
020800 A000-MAINLINE-PROCESSING.                                        02080011
020900                                                                  02090011
021000     PERFORM B100-INITIALIZATION.                                 02100011
021100     PERFORM B200-PROCESS-FILE                                    02110011
021200         UNTIL SW-END-OF-FILE.                                    02120011
021300     MOVE HF-HOLD-BREAK-VEND     TO RPT-VEND-3.                   02130011
021400     MOVE HF-HOLD-BREAK-VEND-NBR TO RPT-VEND-NBR-3.               02140011
021500     PERFORM B300-TERMINATION.                                    02150011
021600     STOP RUN.                                                    02160011
021700                                                                  02170011
021800*                                                                 02180011
021900******************************************************************02190011
022000**                    B100-INITIALIZATION                       **02200011
022100**  SET UP THE STANDARD REPORT HEADER, DO AN INITIAL FILE READ. **02210011
022200**  WRITE FIRST REPORT HEADINGS. SAVE FIRST RECORD KEY VALUES   **02220011
022300**  FOR LATER COMPARISON.                                       **02230011
022400******************************************************************02240011
022500 B100-INITIALIZATION.                                             02250011
022600                                                                  02260011
022700     OPEN INPUT INPUT-FILE                                        02270011
022800         OUTPUT REPORT-FILE.                                      02280011
022900                                                                  02290011
023000     ACCEPT SF-SYSTEM-DATE FROM DATE.                             02300011
023100     MOVE SF-SYSTEM-MONTH        TO DP132O-RUN-MONTH.             02310011
023200     MOVE SF-SYSTEM-DAY          TO DP132O-RUN-DAY.               02320011
023300     MOVE SF-SYSTEM-YEAR         TO DP132O-RUN-YEAR.              02330011
023400     ACCEPT SF-SYSTEM-TIME FROM TIME.                             02340011
023500     MOVE SF-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              02350011
023600     MOVE SF-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            02360011
023700     MOVE 'APKRP007'             TO DP132O-PROGRAM-NAME.          02370011
023800     MOVE '1'                    TO DP132O-REPORT-NUMBER.         02380011
023900                                                                  02390011
024000     INITIALIZE REPORT-TOTAL-TABLE.                               02400011
024100                                                                  02410011
024200     PERFORM S100-HEADINGS.                                       02420011
024300                                                                  02430011
024400     PERFORM R100-READ-INPUT.                                     02440011
024500                                                                  02450011
024600     IF SW-FIRST-READ                                             02460011
024700         SET SW-NOT-FIRST-READ     TO TRUE                        02470011
024800         MOVE AP412-DEPT           TO HF-HOLD-BREAK-DEPT          02480033
024900                                      RPT-DEPT-3                  02490011
025000         MOVE AP412-VENDOR-NAME-DUNNS TO HF-HOLD-BREAK-VEND       02500033
025100         MOVE AP412-VENDOR-NO-DUNNS TO HF-HOLD-BREAK-VEND-NBR     02510033
025200     END-IF.                                                      02520011
025300                                                                  02530011
025400     MOVE SPACES TO DL1-DEPARTMENT-NUMBER.                        02540011
025500                                                                  02550011
025600*                                                                 02560011
025700******************************************************************02570011
025800**                    B200-PROCESS-FILE                         **02580011
025900**  FOR EACH RECORD READ FROM INPUT FILE, DETERMINE WHETHER OR  **02590011
026000**  NOT A TOTAL FIELD HAS HAD A BREAK SINCE THE PREVIOUS RECORD.**02600011
026100**  IF A BREAK HAS OCCURRED, SET A SWITCH WHICH TELLS AT WHICH  **02610011
026200**  LEVEL THIS BREAK HAS HAPPENED AND PERFORM THE PARAGRAPH     **02620011
026300**  WHICH PRINTS TOTAL LINES. REGARDLESS OF WHETHER OR NOT ANY  **02630011
026400**  TOTAL BREAKS HAVE OCCURRED, INCREMENT THE PROGRAM TOTAL     **02640011
026500**  TABLES FOR THE INPUT RECORD AFTER CALCULATING VALUES.       **02650011
026600**  SAVE THE CURRENT RECORD BREAK VALUES, AND READ ANOTHER      **02660011
026700**  INPUT RECORD.                                               **02670011
026800******************************************************************02680011
026900 B200-PROCESS-FILE.                                               02690011
027000                                                                  02700011
027100     MOVE HF-HOLD-BREAK-VEND     TO RPT-VEND-3.                   02710011
027200     MOVE HF-HOLD-BREAK-VEND-NBR TO RPT-VEND-NBR-3.               02720011
027300                                                                  02730011
027400     SET SW-NO-BREAKS-FOUND TO TRUE.                              02740011
027500                                                                  02750011
027600* DETERMINE IF ANY TOTAL BREAKS HAVE TAKEN PLACE                  02760011
027700     IF AP412-DEPT           NOT EQUAL HF-HOLD-BREAK-DEPT         02770033
027800         SET PV-BREAK-LEVEL-2 TO TRUE                             02780011
027900         SET SW-BREAKS-FOUND TO TRUE                              02790011
028000     ELSE                                                         02800011
028100         IF AP412-VENDOR-NAME-DUNNS   NOT EQUAL HF-HOLD-BREAK-VEND02810033
028200             SET PV-BREAK-LEVEL-3 TO TRUE                         02820011
028300             SET SW-BREAKS-FOUND TO TRUE                          02830011
028400         END-IF                                                   02840011
028500     END-IF.                                                      02850011
028600                                                                  02860011
028700* IF THERE WERE TOTAL BREAKS, WRITE OUT TOTAL LINES.              02870011
028800     IF SW-BREAKS-FOUND                                           02880011
028900         PERFORM C100-PROCESS-TOTAL-BREAK                         02890011
029000             VARYING REPORT-TOTALS-INDEX                          02900011
029100                 FROM MC-RPT-TOTAL-MAX BY -1                      02910011
029200                     UNTIL REPORT-TOTALS-INDEX                    02920011
029300                         LESS THAN PV-BREAK-LEVEL                 02930011
029400     END-IF.                                                      02940011
029500                                                                  02950011
029600* INCREMENT THE PROGRAM TOTAL TABLE FOR CURRENT INPUT RECORD.     02960011
029610     IF AP412-PO-TYP-CDE = 'IM' OR 'IE' OR 'IF' OR 'CD'           02961033
029620         ADD AP412-COST-EXTENSION    TO RPT-TOT-COST              02962033
029630                                       (MC-RPT-TOTAL-MAX)         02963017
029640     ELSE                                                         02964017
029650         ADD AP412-1ST-COST-EXTENSION TO RPT-TOT-COST             02965033
029660                                       (MC-RPT-TOTAL-MAX)         02966017
029670     END-IF.                                                      02967017
029900                                                                  02990011
030000                                                                  03000011
030100     ADD AP412-RETAIL-EXTENSION   TO RPT-TOT-RETAIL               03010033
030200                                      (MC-RPT-TOTAL-MAX).         03020011
030300                                                                  03030011
030400* SAVE THE BREAK VALUES FOR THE CURRENT RECORD.                   03040011
030500     IF SW-NOT-END-OF-FILE                                        03050011
030600         MOVE AP412-DEPT           TO HF-HOLD-BREAK-DEPT          03060033
030700         MOVE AP412-VENDOR-NAME-DUNNS TO HF-HOLD-BREAK-VEND       03070033
030800         MOVE AP412-VENDOR-NO-DUNNS TO HF-HOLD-BREAK-VEND-NBR     03080033
030900     END-IF.                                                      03090011
031000                                                                  03100011
031100     PERFORM R100-READ-INPUT.                                     03110011
031200                                                                  03120011
031300*                                                                 03130011
031400******************************************************************03140011
031500**               B300-TERMINATION                               **03150011
031600**  PROCESS THE REMAINING TOTALS LEFT TO BE PRINTED (THE LEFT-  **03160011
031700**  OVER TOTALS IN THE PROGRAM TOTAL TABLE) AND THE GRAND TOTAL.**03170011
031800******************************************************************03180011
031900 B300-TERMINATION.                                                03190011
032000                                                                  03200011
032100     SET PV-BREAK-LEVEL-1 TO TRUE.                                03210011
032200     SET REPORT-TOTALS-INDEX TO +1.                               03220011
032300     PERFORM C100-PROCESS-TOTAL-BREAK                             03230011
032400         VARYING REPORT-TOTALS-INDEX                              03240011
032500             FROM MC-RPT-TOTAL-MAX BY -1                          03250011
032600                 UNTIL REPORT-TOTALS-INDEX                        03260011
032700                     LESS THAN PV-BREAK-LEVEL.                    03270011
032800                                                                  03280011
032900     WRITE REPORT-RECORD FROM RE1-REPORT-END-LINE1                03290011
033000         AFTER ADVANCING 2 LINES.                                 03300011
033100                                                                  03310011
033200     CLOSE INPUT-FILE                                             03320011
033300           REPORT-FILE.                                           03330011
033400                                                                  03340011
033500*                                                                 03350011
033600******************************************************************03360011
033700**               C100-PROCESS-TOTAL-BREAK                       **03370011
033800**  PRINT PAGE HEADINGS IF NEEDED. ADD THE CURRENT BREAK LEVEL  **03380011
033900**  TOTALS TO THE NEXT HIGHER LEVEL'S TOTALS. SET THE INDEX FOR **03390011
034000**  THE PRINT LINE TITLE TO BE THE SAME INDEX LEVEL AS THE TOTAL**03400011
034100**  NUMBERS WHICH ARE BEING PRINTED. MOVE THE TOTALS TO THE OUT-**03410011
034200**  PUT PRINT LINE. WRITE THE PRINT LINE AND ZERO OUT THE TOTAL **03420011
034300**  TABLE LEVEL WHICH WAS JUST PRINTED.                         **03430011
034400******************************************************************03440011
034500 C100-PROCESS-TOTAL-BREAK.                                        03450011
034600                                                                  03460011
034700     IF PC-LINE-COUNT GREATER THAN MC-PAGE-SIZE                   03470011
034800         PERFORM S100-HEADINGS                                    03480011
034900     END-IF.                                                      03490011
035000                                                                  03500011
035100* ADD THE CURRENT LEVEL TOTALS TO THE NEXT HIGHER LEVEL TOTALS IN 03510011
035200* THE TABLE.                                                      03520011
035300     SET REPORT-TOTALS-INDEX-NEXT TO REPORT-TOTALS-INDEX.         03530011
035400     SET REPORT-TOTALS-INDEX-NEXT DOWN BY 1.                      03540011
035500                                                                  03550011
035600     IF REPORT-TOTALS-INDEX-NEXT GREATER THAN ZERO                03560011
035700         ADD RPT-TOT-COST (REPORT-TOTALS-INDEX) TO                03570011
035800              RPT-TOT-COST (REPORT-TOTALS-INDEX-NEXT)             03580011
035900         ADD RPT-TOT-RETAIL (REPORT-TOTALS-INDEX) TO              03590011
036000              RPT-TOT-RETAIL (REPORT-TOTALS-INDEX-NEXT)           03600011
036100     END-IF.                                                      03610011
036200                                                                  03620011
036300* SET THE LINE TITLE INDEX TO THE SAME LEVEL AS THE TOTAL LEVEL   03630011
036400* TO BE PRINTED.                                                  03640011
036500     SET REPORT-TITLES-INDEX TO REPORT-TOTALS-INDEX.              03650011
036600                                                                  03660011
036700     MOVE RPT-TITLE-DEPT (REPORT-TITLES-INDEX) TO DL1-DEPT.       03670011
036800     IF REPORT-TITLES-INDEX EQUAL MC-LEVEL-3                      03680011
036900         MOVE RPT-TITLE-VEND (REPORT-TITLES-INDEX) TO DL1-VENDOR  03690011
037000         MOVE RPT-TITLE-VEND-NBR (REPORT-TITLES-INDEX)            03700011
037100                                              TO DL1-VENDOR-NUMBER03710012
037200     END-IF.                                                      03720012
037300                                                                  03730011
037400* FILL THE OUTPUT PRINT LINE.                                     03740011
037500     MOVE RPT-TOT-COST (REPORT-TOTALS-INDEX) TO                   03750011
037600                               DL1-MERCH-COST.                    03760011
037700     MOVE RPT-TOT-RETAIL (REPORT-TOTALS-INDEX) TO                 03770011
037800                               DL1-RETAIL.                        03780011
037900                                                                  03790011
038000* SET THE NUMBER OF LINES TO BE ADVANCED ACCORDING TO THE TOTAL   03800011
038100* LEVEL BEING PRINTED.                                            03810011
038200     EVALUATE REPORT-TOTALS-INDEX                                 03820011
038300         WHEN MC-LEVEL-1                                          03830011
038400             MOVE MC-ADVANCE-3-LINES TO PV-NUMBER-OF-LINES        03840011
038500         WHEN MC-LEVEL-2                                          03850011
038600             MOVE MC-ADVANCE-2-LINES  TO PV-NUMBER-OF-LINES       03860011
038700         WHEN MC-LEVEL-3                                          03870011
038800             MOVE MC-ADVANCE-1-LINE TO PV-NUMBER-OF-LINES         03880011
038900     END-EVALUATE.                                                03890011
039000                                                                  03900011
039100* WRITE PAGE HEADERS BEFORE PRINTING THE LOWEST LEVEL (VENDOR)    03910011
039200* TOTALS IF THE LAST TOTAL PRINTED WAS A HIGHER LEVEL TOTAL (DEPT)03920011
039300     IF REPORT-TOTALS-INDEX EQUAL MC-LEVEL-3                      03930011
039400         IF SW-NEED-PAGE-HEAD                                     03940011
039500             IF PC-LINE-COUNT GREATER THAN MC-NUMBER-HEAD-LINES   03950011
039600                 PERFORM S100-HEADINGS                            03960011
039700             END-IF                                               03970011
039800             SET SW-DONT-NEED-PAGE-HEAD TO TRUE                   03980011
039900         END-IF                                                   03990011
040000     END-IF.                                                      04000011
040100                                                                  04010011
040200* WRITE THE PRINT LINE.                                           04020011
040300     WRITE REPORT-RECORD FROM DL1-DETAIL-LINE1                    04030011
040400         AFTER ADVANCING PV-NUMBER-OF-LINES LINES.                04040011
040500     ADD PV-NUMBER-OF-LINES TO PC-LINE-COUNT.                     04050011
040600                                                                  04060011
040700* ZERO OUT THE TOTAL LEVEL JUST PRINTED                           04070011
040800     MOVE ZEROES TO RPT-TOT-COST (REPORT-TOTALS-INDEX)            04080011
040900                    RPT-TOT-RETAIL (REPORT-TOTALS-INDEX).         04090011
041000                                                                  04100011
041100* ONLY PRINT DEPARTMENT NAME (BREAK LEVEL 2) ON THE FIRST VENDOR  04110011
041200* (BREAK LEVEL 3) LINE WHICH IS PRINTED FOR A PARTICULAR DEPARTMEN04120011
041300     IF PV-BREAK-LEVEL-2                                          04130011
041400         MOVE AP412-DEPT           TO RPT-DEPT-3                  04140033
041500         SET SW-NEED-PAGE-HEAD TO TRUE                            04150011
041600     ELSE                                                         04160011
041700         MOVE SPACES TO RPT-DEPT-3                                04170011
041800     END-IF.                                                      04180011
041900                                                                  04190011
042000     MOVE SPACES TO DL1-DEPARTMENT-NUMBER                         04200013
042100                    DL1-VENDOR-NUMBER.                            04210013
042200                                                                  04220011
042300                                                                  04230011
042400*                                                                 04240011
042500******************************************************************04250011
042600**                       R100-READ-INPUT                        **04260011
042700**  READ A RECORD FROM THE INPUT STORE EXTRACT FILE.            **04270011
042800**                                                              **04280011
042900******************************************************************04290011
043000 R100-READ-INPUT.                                                 04300011
043100                                                                  04310011
043200     READ INPUT-FILE INTO APRD412-STORE-DETAIL-LINE               04320032
043300         AT END                                                   04330011
043400             SET SW-END-OF-FILE TO TRUE.                          04340011
043500                                                                  04350011
043600*                                                                 04360011
043700******************************************************************04370011
043800**                       S100-HEADINGS                          **04380011
043900**  PRODUCE THE PAGE HEADINGS FOR THE REPORT.                   **04390011
044000**                                                              **04400011
044100******************************************************************04410011
044200 S100-HEADINGS.                                                   04420011
044300                                                                  04430011
044400     ADD 1 TO PC-PAGE-COUNT.                                      04440011
044500     MOVE PC-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    04450011
044600     WRITE REPORT-RECORD FROM DP132O-STANDRD-HEADER-132-COLS      04460011
044700         AFTER ADVANCING PAGE.                                    04470011
044800     WRITE REPORT-RECORD FROM RH1-REPORT-HEAD1                    04480011
044900         AFTER ADVANCING 1 LINE.                                  04490011
045000     WRITE REPORT-RECORD FROM CH1-COLUMN-HEAD1                    04500011
045100         AFTER ADVANCING 2 LINES.                                 04510011
045200     WRITE REPORT-RECORD FROM MC-BLANK-LINE                       04520011
045300         AFTER ADVANCING 1 LINE.                                  04530011
045400     MOVE MC-NUMBER-HEAD-LINES TO PC-LINE-COUNT.                  04540011
