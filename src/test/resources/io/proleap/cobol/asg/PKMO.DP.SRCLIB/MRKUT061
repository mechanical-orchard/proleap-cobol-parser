000100*************************                                         08/03/95
000200 IDENTIFICATION DIVISION.                                         MRKUT061
000300*************************                                            LV002
000400 PROGRAM-ID.      MRKUT061.                                       MRKUT061
000500 AUTHOR.          HOWARD MENDELSON.  GREENBRIER & RUSSEL.         MRKUT061
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                        MRKUT061
000700 DATE-WRITTEN.    06/15/95.                                       MRKUT061
000800 DATE-COMPILED.                                                   MRKUT061
000900****************************************************************  MRKUT061
001000* THIS PROGRAM WILL EXTRACT DEMAND EXCEPTION INFORMATION       *  MRKUT061
001100* FOR A GIVEN PTAG WITHIN A DEPARTMENT.                        *  MRKUT061
001200****************************************************************  MRKUT061
006512*                                                                         
006513* CHANGED 03/12/2001 BY LINDA FRIESS                                      
006514*   WR# 21599                                                             
006515*            CORRECTED PROGRAM NAME IN SQL ERROR ROUTINE                  
006516*                                                                         
006600*****************************************************************         
006610* CHANGED 04/16/2002 BY DONALD TOMLINSON                                  
006620*   MR PHASE 4 NON INTELLIGENT SKU CONVERSION                             
006630*   ADDED TSKXREF TABLE TO OBTAIN DEPT.                                   
006650*****************************************************************         
006512*                                                                         
006513* CHANGED 10/20/2005 BY LINDA FRIESS                                      
006514*   WR# 28751  RECOMPILED FOR NEW MRRD010 COPYBOOK                        
006516*              (STORE NUMBER EXPANSION CHANGES)                           
006516*                                                                         
006600*****************************************************************         
006700*                                                                 MRKUT061
006800 ENVIRONMENT DIVISION.                                            MRKUT061
006900*                                                                 MRKUT061
007000*                                                                 MRKUT061
007100 CONFIGURATION SECTION.                                           MRKUT061
007200 SOURCE-COMPUTER. IBM-3090.                                       MRKUT061
007300 OBJECT-COMPUTER. IBM-3090.                                       MRKUT061
007400*                                                                 MRKUT061
007500*                                                                 MRKUT061
007600 INPUT-OUTPUT SECTION.                                            MRKUT061
007700 FILE-CONTROL.                                                    MRKUT061
007800                                                                  MRKUT061
007900     SELECT PTAG-FILE                                             MRKUT061
008000         ASSIGN                       TO INP01.                   MRKUT061
008100                                                                  MRKUT061
008200     SELECT DEMAND-EXCEPT-FILE                                    MRKUT061
008300         ASSIGN                       TO OUTP01.                  MRKUT061
008400                                                                  MRKUT061
008500     EJECT                                                        MRKUT061
008600*                                                                 MRKUT061
008700*                                                                 MRKUT061
008800*                                                                 MRKUT061
008900***************                                                   MRKUT061
009000 DATA DIVISION.                                                   MRKUT061
009100***************                                                   MRKUT061
009200*                                                                 MRKUT061
009300*                                                                 MRKUT061
009400 FILE SECTION.                                                    MRKUT061
009500                                                                  MRKUT061
009600 FD  PTAG-FILE                                                    MRKUT061
009700     RECORDING MODE F                                             MRKUT061
009800     BLOCK CONTAINS 0 RECORDS                                     MRKUT061
009900     RECORD CONTAINS 35 CHARACTERS                                MRKUT061
010000     LABEL RECORDS ARE OMITTED                                    MRKUT061
010100     DATA RECORD IS PTAG-RECS.                                    MRKUT061
010200*                                                                 MRKUT061
010300 01  PTAG-RECS                                       PIC X(35).   MRKUT061
010400                                                                  MRKUT061
010500 FD  DEMAND-EXCEPT-FILE                                           MRKUT061
010600     RECORDING MODE F                                             MRKUT061
010700     BLOCK CONTAINS 0 RECORDS                                     MRKUT061
010800     RECORD CONTAINS 333 CHARACTERS                               MRKUT061
010900     LABEL RECORDS ARE OMITTED                                    MRKUT061
011000     DATA RECORD IS DEMAND-EXCEPT-RECS.                           MRKUT061
011100*                                                                 MRKUT061
011200 01  DEMAND-EXCEPT-RECS                              PIC X(333).  MRKUT061
011300                                                                  MRKUT061
011400     EJECT                                                        MRKUT061
011500*                                                                 MRKUT061
011600 WORKING-STORAGE SECTION.                                         MRKUT061
011700*                                                                 MRKUT061
011800 01  CD-CPU-DATE.                                                 MRKUT061
011900     05  CD-CPU-YY                    PIC 9(2)       VALUE ZEROS. MRKUT061
012000     05  CD-CPU-MM                    PIC 9(2)       VALUE ZEROS. MRKUT061
012100     05  CD-CPU-DD                    PIC 9(2)       VALUE ZEROS. MRKUT061
012200                                                                  MRKUT061
012300*                                                                 MRKUT061
012400 01  PV-DB2-DATE.                                                 MRKUT061
012500     05  PV-DB2-CC                    PIC 9(2)       VALUE ZEROS. MRKUT061
012600     05  PV-DB2-YY                    PIC 9(2)       VALUE ZEROS. MRKUT061
012700     05  FILLER                       PIC X(1)       VALUE '-'.   MRKUT061
012800     05  PV-DB2-MM                    PIC 9(2)       VALUE ZEROS. MRKUT061
012900     05  FILLER                       PIC X(1)       VALUE '-'.   MRKUT061
013000     05  PV-DB2-DD                    PIC 9(2)       VALUE ZEROS. MRKUT061
013100 01  PV-DB2-DATE-R REDEFINES PV-DB2-DATE                          MRKUT061
013200                                      PIC X(10).                  MRKUT061
013300                                                                  MRKUT061
013400*                                                                 MRKUT061
013500 01  PV-PROGRAM-VARIABLES.                                        MRKUT061
013600     05 PV-PREV-DEPT-NMBR             PIC X(03)      VALUE SPACES.MRKUT061
013700     05 PV-PREV-PTAG-ID               PIC X(07)      VALUE SPACES.MRKUT061
013800     05 PV-PREV-ITEM-NBR              PIC 9(15)V     VALUE ZEROES.MRKUT061
013900                                                                  MRKUT061
014000     05 PV-DFLREG-CDE.                                            MRKUT061
014100        10  PV-DFLREG-CDE-1           PIC X(01)      VALUE SPACES.MRKUT061
014200        10  PV-DFLREG-CDE-2           PIC X(01)      VALUE SPACES.MRKUT061
014300        10  PV-DFLREG-CDE-3           PIC X(01)      VALUE SPACES.MRKUT061
014400        10  PV-DFLREG-CDE-4           PIC X(01)      VALUE SPACES.MRKUT061
014500        10  PV-DFLREG-CDE-5-13        PIC X(09)      VALUE SPACES.MRKUT061
014600                                                                  MRKUT061
014700     05  PV-ABEND-PARAGRAPH           PIC X(30)      VALUE SPACES.MRKUT061
014800*                                                                 MRKUT061
014900 01  ERROR-MESSAGES.                                              MRKUT061
015000     05 FILLER                        PIC X(46)      VALUE        MRKUT061
015100        'ERROR DETAIL RECORD NOT FOUND FOR REF-NO   #: '.         MRKUT061
015200     05 ERROR-REF-NO                  PIC X(21).                  MRKUT061
015300     05 FILLER                        PIC X(72)      VALUE SPACES.MRKUT061
015400*                                                                 MRKUT061
015500 01  PV-ABEND-CODE                    PIC S9(04)     VALUE +0     MRKUT061
015600                                                     COMP SYNC.   MRKUT061
015700     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. MRKUT061
015800     88  ABEND-4002-READ-ERROR                       VALUE +4002. MRKUT061
015900     88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. MRKUT061
016000     88  ABEND-4004-TABLE-ERROR                      VALUE +4004. MRKUT061
016100     88  ABEND-4005-OPEN-ERROR                       VALUE +4005. MRKUT061
016200     88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. MRKUT061
016300     88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. MRKUT061
016400     88  ABEND-4008-DATA-ERROR                       VALUE +4008. MRKUT061
016500     88  ABEND-4009-KEY-DATA-ERROR                   VALUE +4009. MRKUT061
016800     88  ABEND-4013-DB2-ERROR                        VALUE +4013. MRKUT061
016900*                                                                 MRKUT061
017000 01  PC-PROGRAM-CONSTANTS.                                        MRKUT061
017100     05  PC-Y                         PIC X(01)      VALUE 'Y'.   MRKUT061
017200     05  PC-N                         PIC X(01)      VALUE 'N'.   MRKUT061
017300     05  PC-D                         PIC X(01)      VALUE 'D'.   MRKUT061
017400     05  PC-H                         PIC X(01)      VALUE 'H'.   MRKUT061
017500     05  PC-I                         PIC X(01)      VALUE 'I'.   MRKUT061
017600     05  PC-L                         PIC X(01)      VALUE 'L'.   MRKUT061
017700     05  PC-U                         PIC X(01)      VALUE 'U'.   MRKUT061
017800     05  PC-DPT                       PIC X(03)      VALUE 'DPT'. MRKUT061
017900     05  PC-1                         PIC 9(01)      VALUE 1.     MRKUT061
018000     05  PC-PLUS-1                    PIC S9(1)      VALUE +1.    MRKUT061
018100     05  PC-PLUS-4                    PIC S9(1)      VALUE +4.    MRKUT061
018200     05  PC-PGM-DPKUT500              PIC X(08)      VALUE        MRKUT061
018300                                                     'DPKUT500'.  MRKUT061
018400     05  PC-ROW-NOT-FOUND             PIC S9(04)     VALUE +100   MRKUT061
018500                                                     COMP SYNC.   MRKUT061
018600     05  PC-DUPLICATE-ROW             PIC S9(04)     VALUE -811   MRKUT061
018700                                                     COMP SYNC.   MRKUT061
018800*                                                                 MRKUT061
018900 01  PS-PROGRAM-SWITCHES.                                         MRKUT061
019000     05  PS-EOC-PTAG-CSR              PIC X(01)      VALUE 'N'.   MRKUT061
019100         88  EOC-PTAG-CSR                            VALUE 'Y'.   MRKUT061
019200     05  PS-PTAG-EOF                  PIC X(01)      VALUE 'N'.   MRKUT061
019300         88  PTAG-EOF                                VALUE 'Y'.   MRKUT061
019400*                                                                 MRKUT061
019500* PTAG FILE LAYOUT FOR DEMAND EXCEPTION REPORTING                 MRKUT061
019600     COPY MRRD010.                                                MRKUT061
019700*                                                                 MRKUT061
019800* DEMAND EXECPTION FILE LAYOUT FOR REPORTING                      MRKUT061
019900     COPY MRRD025.                                                MRKUT061
020000*                                                                 MRKUT061
020010* NI-SKU WORK AREAS FOR MANIPULATING FIELD SIZES                        61
020020     COPY ISWS006.                                                MRKUT061
020030*                                                                 MRKUT061
020100* NI-SKU CROSS REFERENCE TABLE                                    MRKUT061
020200     EXEC SQL                                                     MRKUT061
020300         INCLUDE TSKXREF                                          MRKUT061
020400     END-EXEC.                                                    MRKUT061
020500 EJECT                                                            MRKUT061
020600* SKU TABLE                                                       MRKUT061
020700     EXEC SQL                                                     MRKUT061
020800         INCLUDE TSK                                              MRKUT061
020900     END-EXEC.                                                    MRKUT061
021000 EJECT                                                            MRKUT061
021100* MBS TABLE                                                       MRKUT061
021200     EXEC SQL                                                     MRKUT061
021300         INCLUDE TMDSEAR                                          MRKUT061
021400     END-EXEC.                                                    MRKUT061
021500 EJECT                                                            MRKUT061
021600* DB2 COMMUNICATION AREA                                          MRKUT061
021700*                                                                 MRKUT061
021800     EXEC SQL                                                     MRKUT061
021900         INCLUDE SQLCA                                            MRKUT061
022000     END-EXEC.                                                    MRKUT061
022100 EJECT                                                            MRKUT061
022200* DB2 COMMUNICATION AREA2                                         MRKUT061
022300*                                                                 MRKUT061
022400     COPY SQLCA2.                                                 MRKUT061
022500 EJECT                                                            MRKUT061
022600*                                                                 MRKUT061
022700****************************************************************  MRKUT061
022800 PROCEDURE DIVISION.                                              MRKUT061
022900****************************************************************  MRKUT061
023000                                                                  MRKUT061
023100****************************************************************  MRKUT061
023200* A000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE  *  MRKUT061
023300* PROGRAM.                                                     *  MRKUT061
023400****************************************************************  MRKUT061
023500                                                                  MRKUT061
023600 A000-PROGRAM-MAINLINE.                                           MRKUT061
023700                                                                  MRKUT061
023800     PERFORM A100-INITIALIZATION.                                 MRKUT061
023900                                                                  MRKUT061
024000     PERFORM B000-PROCESS-PTAG-FILE                               MRKUT061
024100         UNTIL PTAG-EOF.                                          MRKUT061
024200                                                                  MRKUT061
024300     PERFORM Y000-END-ROUTINE.                                    MRKUT061
024400                                                                  MRKUT061
024500     GOBACK.                                                      MRKUT061
024600                                                                  MRKUT061
024700     EJECT                                                        MRKUT061
024800*                                                                 MRKUT061
024900****************************************************************  MRKUT061
025000* A100-INITIALIZATION OPENS ALL FILES AND INITAILZES ALL OF    *  MRKUT061
025100* THE NECESSARY FIELDS.                                        *  MRKUT061
025200****************************************************************  MRKUT061
025300 A100-INITIALIZATION.                                             MRKUT061
025400                                                                  MRKUT061
025500     OPEN  INPUT PTAG-FILE                                        MRKUT061
025600          OUTPUT DEMAND-EXCEPT-FILE.                              MRKUT061
025700*                                                                 MRKUT061
025800     INITIALIZE MR025-DEMAND-EXCEPT-REC.                          MRKUT061
025900                                                                  MRKUT061
026000     ACCEPT CD-CPU-DATE FROM DATE.                                MRKUT061
026100                                                                  MRKUT061
026200     MOVE CD-CPU-MM                   TO PV-DB2-MM.               MRKUT061
026300     MOVE CD-CPU-DD                   TO PV-DB2-DD.               MRKUT061
026400     MOVE CD-CPU-YY                   TO PV-DB2-YY.               MRKUT061
026500                                                                  MRKUT061
026600     IF CD-CPU-YY GREATER THAN 90                                 MRKUT061
026700        MOVE 19                       TO PV-DB2-CC                MRKUT061
026800     ELSE                                                         MRKUT061
026900        MOVE 20                       TO PV-DB2-CC                MRKUT061
027000     END-IF.                                                      MRKUT061
027100*                                                                 MRKUT061
027200     PERFORM R000-READ-PTAG-FILE.                                 MRKUT061
027300*                                                                 MRKUT061
027400****************************************************************  MRKUT061
027500* B000-PROCESS-CURSOR.  THIS MODULE CONTROLS THE MAIN FLOW     *  MRKUT061
027600* OF THE PROGRAM.                                              *  MRKUT061
027700****************************************************************  MRKUT061
027800                                                                  MRKUT061
027900 B000-PROCESS-PTAG-FILE.                                          MRKUT061
028000                                                                  MRKUT061
028100*    DISPLAY 'B000-PROCESS-PTAG-FILE'.                            MRKUT061
028200                                                                  MRKUT061
028300     IF MR010-PTAG-ID = PV-PREV-PTAG-ID                           MRKUT061
028400         PERFORM C000-ACCUM-REGISTERS                             MRKUT061
028500     ELSE                                                         MRKUT061
028600         PERFORM C100-CALCULATE-PCT-OF-TRIPS                      MRKUT061
028700         PERFORM S000-SELECT-DEPARTMENT                           MRKUT061
028800         PERFORM S100-SELECT-DEPT-DESC                            MRKUT061
028900         PERFORM W000-WRITE-DEMAND-EXCEPT-REC                     MRKUT061
029000         INITIALIZE MR025-DEMAND-EXCEPT-REC                       MRKUT061
029100     END-IF.                                                      MRKUT061
029200*                                                                 MRKUT061
029300     MOVE MR010-PTAG-ID   TO PV-PREV-PTAG-ID.                     MRKUT061
029400     MOVE MR010-ITEM-NBR  TO PV-PREV-ITEM-NBR.                    MRKUT061
029500     PERFORM R000-READ-PTAG-FILE.                                 MRKUT061
029600*                                                                 MRKUT061
029700****************************************************************  MRKUT061
029800* C000-ACCUM-REGISTERS                                            MRKUT061
029900*                                                                 MRKUT061
030000*                                                                 MRKUT061
030100****************************************************************  MRKUT061
030200                                                                  MRKUT061
030300 C000-ACCUM-REGISTERS.                                            MRKUT061
030400                                                                  MRKUT061
030500*    DISPLAY 'C000-ACCUM-REGISTERS'.                              MRKUT061
030600                                                                  MRKUT061
030700     MOVE MR010-DFLREG-CDE    TO PV-DFLREG-CDE                    MRKUT061
030800     EVALUATE TRUE                                                MRKUT061
030900         WHEN PV-DFLREG-CDE-1 = PC-L                              MRKUT061
031000             MOVE PV-DFLREG-CDE-1 TO MR025-DEREG-CDE (1)          MRKUT061
031100             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-CURR (1)    MRKUT061
031200             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (1)   MRKUT061
031300             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-CURR         MRKUT061
031400             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
031500         WHEN PV-DFLREG-CDE-1 = PC-H                              MRKUT061
031600             MOVE PV-DFLREG-CDE-1 TO MR025-DEREG-CDE (2)          MRKUT061
031700             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-CURR (2)    MRKUT061
031800             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (2)   MRKUT061
031900             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-CURR         MRKUT061
032000             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
032100         WHEN PV-DFLREG-CDE-1 = PC-I                              MRKUT061
032200             MOVE PV-DFLREG-CDE-1 TO MR025-DEREG-CDE (3)          MRKUT061
032300             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-CURR (3)    MRKUT061
032400             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (3)   MRKUT061
032500             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-CURR         MRKUT061
032600             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
032700         WHEN PV-DFLREG-CDE-1 = PC-D                              MRKUT061
032800             MOVE PV-DFLREG-CDE-1 TO MR025-DEREG-CDE (4)          MRKUT061
032900             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-CURR (4)    MRKUT061
033000             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (4)   MRKUT061
033100             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-CURR         MRKUT061
033200             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
033300         WHEN PV-DFLREG-CDE-1 = PC-U                              MRKUT061
033400             MOVE PV-DFLREG-CDE-1 TO MR025-DEREG-CDE (5)          MRKUT061
033500             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-CURR (5)    MRKUT061
033600             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (5)   MRKUT061
033700             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-CURR         MRKUT061
033800             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
033900         WHEN PV-DFLREG-CDE-2 = PC-L                              MRKUT061
034000             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-1-WK (1)    MRKUT061
034100             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (1)   MRKUT061
034200             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-1-WK         MRKUT061
034300             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
034400         WHEN PV-DFLREG-CDE-2 = PC-H                              MRKUT061
034500             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-1-WK (2)    MRKUT061
034600             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (2)   MRKUT061
034700             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-1-WK         MRKUT061
034800             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
034900         WHEN PV-DFLREG-CDE-2 = PC-I                              MRKUT061
035000             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-1-WK (3)    MRKUT061
035100             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (3)   MRKUT061
035200             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-1-WK         MRKUT061
035300             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
035400         WHEN PV-DFLREG-CDE-2 = PC-D                              MRKUT061
035500             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-1-WK (4)    MRKUT061
035600             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (4)   MRKUT061
035700             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-1-WK         MRKUT061
035800             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
035900         WHEN PV-DFLREG-CDE-2 = PC-U                              MRKUT061
036000             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-1-WK (5)    MRKUT061
036100             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (5)   MRKUT061
036200             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-1-WK         MRKUT061
036300             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
036400         WHEN PV-DFLREG-CDE-3 = PC-L                              MRKUT061
036500             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-2-WK (1)    MRKUT061
036600             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (1)   MRKUT061
036700             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-2-WK         MRKUT061
036800             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
036900         WHEN PV-DFLREG-CDE-3 = PC-H                              MRKUT061
037000             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-2-WK (2)    MRKUT061
037100             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (2)   MRKUT061
037200             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-2-WK         MRKUT061
037300             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
037400         WHEN PV-DFLREG-CDE-3 = PC-I                              MRKUT061
037500             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-2-WK (3)    MRKUT061
037600             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (3)   MRKUT061
037700             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-2-WK         MRKUT061
037800             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
037900         WHEN PV-DFLREG-CDE-3 = PC-D                              MRKUT061
038000             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-2-WK (4)    MRKUT061
038100             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (4)   MRKUT061
038200             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-2-WK         MRKUT061
038300             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
038400         WHEN PV-DFLREG-CDE-3 = PC-U                              MRKUT061
038500             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-2-WK (5)    MRKUT061
038600             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (5)   MRKUT061
038700             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-2-WK         MRKUT061
038800             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
038900         WHEN PV-DFLREG-CDE-4 = PC-L                              MRKUT061
039000             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-3-WK (1)    MRKUT061
039100             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (1)   MRKUT061
039200             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-3-WK         MRKUT061
039300             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
039400         WHEN PV-DFLREG-CDE-4 = PC-H                              MRKUT061
039500             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-3-WK (2)    MRKUT061
039600             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (2)   MRKUT061
039700             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-3-WK         MRKUT061
039800             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
039900         WHEN PV-DFLREG-CDE-4 = PC-I                              MRKUT061
040000             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-3-WK (3)    MRKUT061
040100             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (3)   MRKUT061
040200             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-3-WK         MRKUT061
040300             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
040400         WHEN PV-DFLREG-CDE-4 = PC-D                              MRKUT061
040500             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-3-WK (4)    MRKUT061
040600             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (4)   MRKUT061
040700             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-3-WK         MRKUT061
040800             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
040900         WHEN PV-DFLREG-CDE-4 = PC-U                              MRKUT061
041000             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-3-WK (5)    MRKUT061
041100             ADD PC-PLUS-1        TO MR025-NMBR-ITEMS-TOTAL (5)   MRKUT061
041200             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-3-WK         MRKUT061
041300             ADD PC-PLUS-1        TO MR025-TTL-ITEMS-TOTAL        MRKUT061
041400         WHEN OTHER                                               MRKUT061
041500             CONTINUE                                             MRKUT061
041600     END-EVALUATE.                                                MRKUT061
041700                                                                  MRKUT061
041800     IF MR010-ITEM-NBR  = PV-PREV-ITEM-NBR                        MRKUT061
041900         CONTINUE                                                 MRKUT061
042000     ELSE                                                         MRKUT061
042100         ADD PC-PLUS-1 TO MR025-NMBR-OF-ITEMS                     MRKUT061
042200     END-IF.                                                      MRKUT061
042300                                                                  MRKUT061
042400     ADD PC-PLUS-1 TO MR025-NMBR-OF-ITEMS-STORES.                 MRKUT061
042500*                                                                 MRKUT061
042600****************************************************************  MRKUT061
042700* C100-CALCULATE-PCT-OF-TRIPS.                                    MRKUT061
042800*                                                                 MRKUT061
042900*                                                                 MRKUT061
043000****************************************************************  MRKUT061
043100                                                                  MRKUT061
043200 C100-CALCULATE-PCT-OF-TRIPS.                                     MRKUT061
043300                                                                  MRKUT061
043400*    DISPLAY 'C100-CALCULATE-PCT-OF-TRIPS'.                       MRKUT061
043500                                                                  MRKUT061
043600     ADD PC-PLUS-1 TO MR025-NMBR-OF-ITEMS.                        MRKUT061
043700     ADD PC-PLUS-1 TO MR025-NMBR-OF-ITEMS-STORES.                 MRKUT061
043800                                                                  MRKUT061
043900     COMPUTE MR025-AVG-NMBR-ITEMS-TOTAL (1) ROUNDED =             MRKUT061
044000             (MR025-NMBR-ITEMS-TOTAL (1) / PC-PLUS-4).            MRKUT061
044100                                                                  MRKUT061
044200     COMPUTE MR025-AVG-NMBR-ITEMS-TOTAL (2) ROUNDED =             MRKUT061
044300             (MR025-NMBR-ITEMS-TOTAL (2) / PC-PLUS-4).            MRKUT061
044400                                                                  MRKUT061
044500     COMPUTE MR025-AVG-NMBR-ITEMS-TOTAL (3) ROUNDED =             MRKUT061
044600             (MR025-NMBR-ITEMS-TOTAL (3) / PC-PLUS-4).            MRKUT061
044700                                                                  MRKUT061
044800     COMPUTE MR025-AVG-NMBR-ITEMS-TOTAL (4) ROUNDED =             MRKUT061
044900             (MR025-NMBR-ITEMS-TOTAL (4) / PC-PLUS-4).            MRKUT061
045000                                                                  MRKUT061
045100     COMPUTE MR025-AVG-NMBR-ITEMS-TOTAL (5) ROUNDED =             MRKUT061
045200             (MR025-NMBR-ITEMS-TOTAL (5) / PC-PLUS-4).            MRKUT061
045300                                                                  MRKUT061
045400     COMPUTE MR025-TTL-AVG-ITEMS-TOTAL ROUNDED =                  MRKUT061
045500             (MR025-TTL-ITEMS-TOTAL / PC-PLUS-4).                 MRKUT061
045600                                                                  MRKUT061
045700     IF MR025-TTL-ITEMS-CURR = ZEROES                             MRKUT061
045800         MOVE ZEROES TO MR025-REG-PCT-TRIPS-CURR (1)              MRKUT061
045900                        MR025-REG-PCT-TRIPS-CURR (2)              MRKUT061
046000                        MR025-REG-PCT-TRIPS-CURR (3)              MRKUT061
046100                        MR025-REG-PCT-TRIPS-CURR (4)              MRKUT061
046200                        MR025-REG-PCT-TRIPS-CURR (5)              MRKUT061
046300                        MR025-TTL-PCT-TRIPS-CURR                  MRKUT061
046400     ELSE                                                         MRKUT061
046500         COMPUTE MR025-REG-PCT-TRIPS-CURR (1) ROUNDED =           MRKUT061
046600                 (MR025-NMBR-ITEMS-CURR (1)/ MR025-TTL-ITEMS-CURR)MRKUT061
046700                       * 100                                      MRKUT061
046800         COMPUTE MR025-REG-PCT-TRIPS-CURR (2) ROUNDED =           MRKUT061
046900                 (MR025-NMBR-ITEMS-CURR (2)/ MR025-TTL-ITEMS-CURR)MRKUT061
047000                       * 100                                      MRKUT061
047100         COMPUTE MR025-REG-PCT-TRIPS-CURR (3) ROUNDED =           MRKUT061
047200                 (MR025-NMBR-ITEMS-CURR (3)/ MR025-TTL-ITEMS-CURR)MRKUT061
047300                       * 100                                      MRKUT061
047400         COMPUTE MR025-REG-PCT-TRIPS-CURR (4) ROUNDED =           MRKUT061
047500                 (MR025-NMBR-ITEMS-CURR (4)/ MR025-TTL-ITEMS-CURR)MRKUT061
047600                       * 100                                      MRKUT061
047700         COMPUTE MR025-REG-PCT-TRIPS-CURR (5) ROUNDED =           MRKUT061
047800                 (MR025-NMBR-ITEMS-CURR (5)/ MR025-TTL-ITEMS-CURR)MRKUT061
047900                       * 100                                      MRKUT061
048000         COMPUTE MR025-TTL-PCT-TRIPS-CURR ROUNDED =               MRKUT061
048100                 (MR025-TTL-ITEMS-CURR /                          MRKUT061
048200                        MR025-NMBR-OF-ITEMS-STORES) * 100         MRKUT061
048300     END-IF.                                                      MRKUT061
048400                                                                  MRKUT061
048500     IF MR025-TTL-ITEMS-1-WK = ZEROES                             MRKUT061
048600         MOVE ZEROES TO MR025-REG-PCT-TRIPS-1-WK (1)              MRKUT061
048700                        MR025-REG-PCT-TRIPS-1-WK (2)              MRKUT061
048800                        MR025-REG-PCT-TRIPS-1-WK (3)              MRKUT061
048900                        MR025-REG-PCT-TRIPS-1-WK (4)              MRKUT061
049000                        MR025-REG-PCT-TRIPS-1-WK (5)              MRKUT061
049100                        MR025-TTL-PCT-TRIPS-1-WK                  MRKUT061
049200     ELSE                                                         MRKUT061
049300         COMPUTE MR025-REG-PCT-TRIPS-1-WK (1) ROUNDED =           MRKUT061
049400                 (MR025-NMBR-ITEMS-1-WK (1)/ MR025-TTL-ITEMS-1-WK)MRKUT061
049500                       * 100                                      MRKUT061
049600         COMPUTE MR025-REG-PCT-TRIPS-1-WK (2) ROUNDED =           MRKUT061
049700                 (MR025-NMBR-ITEMS-1-WK (2)/ MR025-TTL-ITEMS-1-WK)MRKUT061
049800                       * 100                                      MRKUT061
049900         COMPUTE MR025-REG-PCT-TRIPS-1-WK (3) ROUNDED =           MRKUT061
050000                 (MR025-NMBR-ITEMS-1-WK (3)/ MR025-TTL-ITEMS-1-WK)MRKUT061
050100                       * 100                                      MRKUT061
050200         COMPUTE MR025-REG-PCT-TRIPS-1-WK (4) ROUNDED =           MRKUT061
050300                 (MR025-NMBR-ITEMS-1-WK (4)/ MR025-TTL-ITEMS-1-WK)MRKUT061
050400                       * 100                                      MRKUT061
050500         COMPUTE MR025-REG-PCT-TRIPS-1-WK (5) ROUNDED =           MRKUT061
050600                 (MR025-NMBR-ITEMS-1-WK (5)/ MR025-TTL-ITEMS-1-WK)MRKUT061
050700                       * 100                                      MRKUT061
050800         COMPUTE MR025-TTL-PCT-TRIPS-1-WK ROUNDED =               MRKUT061
050900                 (MR025-TTL-ITEMS-1-WK /                          MRKUT061
051000                        MR025-NMBR-OF-ITEMS-STORES) * 100         MRKUT061
051100     END-IF.                                                      MRKUT061
051200                                                                  MRKUT061
051300     IF MR025-TTL-ITEMS-2-WK = ZEROES                             MRKUT061
051400         MOVE ZEROES TO MR025-REG-PCT-TRIPS-2-WK (1)              MRKUT061
051500                        MR025-REG-PCT-TRIPS-2-WK (2)              MRKUT061
051600                        MR025-REG-PCT-TRIPS-2-WK (3)              MRKUT061
051700                        MR025-REG-PCT-TRIPS-2-WK (4)              MRKUT061
051800                        MR025-REG-PCT-TRIPS-2-WK (5)              MRKUT061
051900                        MR025-TTL-PCT-TRIPS-2-WK                  MRKUT061
052000     ELSE                                                         MRKUT061
052100         COMPUTE MR025-REG-PCT-TRIPS-2-WK (1) ROUNDED =           MRKUT061
052200                 (MR025-NMBR-ITEMS-2-WK (1)/ MR025-TTL-ITEMS-2-WK)MRKUT061
052300                       * 100                                      MRKUT061
052400         COMPUTE MR025-REG-PCT-TRIPS-2-WK (2) ROUNDED =           MRKUT061
052500                 (MR025-NMBR-ITEMS-2-WK (2)/ MR025-TTL-ITEMS-2-WK)MRKUT061
052600                       * 100                                      MRKUT061
052700         COMPUTE MR025-REG-PCT-TRIPS-2-WK (3) ROUNDED =           MRKUT061
052800                 (MR025-NMBR-ITEMS-2-WK (3)/ MR025-TTL-ITEMS-2-WK)MRKUT061
052900                       * 100                                      MRKUT061
053000         COMPUTE MR025-REG-PCT-TRIPS-2-WK (4) ROUNDED =           MRKUT061
053100                 (MR025-NMBR-ITEMS-2-WK (4)/ MR025-TTL-ITEMS-2-WK)MRKUT061
053200                       * 100                                      MRKUT061
053300         COMPUTE MR025-REG-PCT-TRIPS-2-WK (5) ROUNDED =           MRKUT061
053400                 (MR025-NMBR-ITEMS-2-WK (5)/ MR025-TTL-ITEMS-2-WK)MRKUT061
053500                       * 100                                      MRKUT061
053600         COMPUTE MR025-TTL-PCT-TRIPS-2-WK ROUNDED =               MRKUT061
053700                 (MR025-TTL-ITEMS-2-WK /                          MRKUT061
053800                        MR025-NMBR-OF-ITEMS-STORES) * 100         MRKUT061
053900     END-IF.                                                      MRKUT061
054000                                                                  MRKUT061
054100     IF MR025-TTL-ITEMS-3-WK = ZEROES                             MRKUT061
054200         MOVE ZEROES TO MR025-REG-PCT-TRIPS-3-WK (1)              MRKUT061
054300                        MR025-REG-PCT-TRIPS-3-WK (2)              MRKUT061
054400                        MR025-REG-PCT-TRIPS-3-WK (3)              MRKUT061
054500                        MR025-REG-PCT-TRIPS-3-WK (4)              MRKUT061
054600                        MR025-REG-PCT-TRIPS-3-WK (5)              MRKUT061
054700                        MR025-TTL-PCT-TRIPS-3-WK                  MRKUT061
054800     ELSE                                                         MRKUT061
054900         COMPUTE MR025-REG-PCT-TRIPS-3-WK (1) ROUNDED =           MRKUT061
055000                 (MR025-NMBR-ITEMS-3-WK (1)/ MR025-TTL-ITEMS-3-WK)MRKUT061
055100                       * 100                                      MRKUT061
055200         COMPUTE MR025-REG-PCT-TRIPS-3-WK (2) ROUNDED =           MRKUT061
055300                 (MR025-NMBR-ITEMS-3-WK (2)/ MR025-TTL-ITEMS-3-WK)MRKUT061
055400                       * 100                                      MRKUT061
055500         COMPUTE MR025-REG-PCT-TRIPS-3-WK (3) ROUNDED =           MRKUT061
055600                 (MR025-NMBR-ITEMS-3-WK (3)/ MR025-TTL-ITEMS-3-WK)MRKUT061
055700                       * 100                                      MRKUT061
055800         COMPUTE MR025-REG-PCT-TRIPS-3-WK (4) ROUNDED =           MRKUT061
055900                 (MR025-NMBR-ITEMS-3-WK (4)/ MR025-TTL-ITEMS-3-WK)MRKUT061
056000                       * 100                                      MRKUT061
056100         COMPUTE MR025-REG-PCT-TRIPS-3-WK (5) ROUNDED =           MRKUT061
056200                 (MR025-NMBR-ITEMS-3-WK (5)/ MR025-TTL-ITEMS-3-WK)MRKUT061
056300                       * 100                                      MRKUT061
056400         COMPUTE MR025-TTL-PCT-TRIPS-3-WK ROUNDED =               MRKUT061
056500                 (MR025-TTL-ITEMS-3-WK /                          MRKUT061
056600                        MR025-NMBR-OF-ITEMS-STORES) * 100         MRKUT061
056700     END-IF.                                                      MRKUT061
056800                                                                  MRKUT061
056900     IF MR025-TTL-ITEMS-TOTAL = ZEROES                            MRKUT061
057000         MOVE ZEROES TO MR025-REG-PCT-TRIPS-TOTAL (1)             MRKUT061
057100                        MR025-REG-PCT-TRIPS-TOTAL (2)             MRKUT061
057200                        MR025-REG-PCT-TRIPS-TOTAL (3)             MRKUT061
057300                        MR025-REG-PCT-TRIPS-TOTAL (4)             MRKUT061
057400                        MR025-REG-PCT-TRIPS-TOTAL (5)             MRKUT061
057500                        MR025-TTL-PCT-TRIPS-TOTAL                 MRKUT061
057600     ELSE                                                         MRKUT061
057700         COMPUTE MR025-REG-PCT-TRIPS-TOTAL (1) ROUNDED =          MRKUT061
057800                 (MR025-NMBR-ITEMS-TOTAL (1)/                     MRKUT061
057900                        MR025-TTL-ITEMS-TOTAL) * 100              MRKUT061
058000         COMPUTE MR025-REG-PCT-TRIPS-TOTAL (2) ROUNDED =          MRKUT061
058100                 (MR025-NMBR-ITEMS-TOTAL (2)/                     MRKUT061
058200                        MR025-TTL-ITEMS-TOTAL) * 100              MRKUT061
058300         COMPUTE MR025-REG-PCT-TRIPS-TOTAL (3) ROUNDED =          MRKUT061
058400                 (MR025-NMBR-ITEMS-TOTAL (3)/                     MRKUT061
058500                        MR025-TTL-ITEMS-TOTAL) * 100              MRKUT061
058600         COMPUTE MR025-REG-PCT-TRIPS-TOTAL (4) ROUNDED =          MRKUT061
058700                 (MR025-NMBR-ITEMS-TOTAL (4)/                     MRKUT061
058800                        MR025-TTL-ITEMS-TOTAL) * 100              MRKUT061
058900         COMPUTE MR025-REG-PCT-TRIPS-TOTAL (5) ROUNDED =          MRKUT061
059000                 (MR025-NMBR-ITEMS-TOTAL (5)/                     MRKUT061
059100                        MR025-TTL-ITEMS-TOTAL) * 100              MRKUT061
059200         COMPUTE MR025-TTL-PCT-TRIPS-TOTAL ROUNDED =              MRKUT061
059300                 (MR025-TTL-AVG-ITEMS-TOTAL /                     MRKUT061
059400                        MR025-NMBR-OF-ITEMS-STORES) * 100         MRKUT061
059500     END-IF.                                                      MRKUT061
059600                                                                  MRKUT061
059700*                                                                 MRKUT061
059800****************************************************************  MRKUT061
059900                                                                  MRKUT061
060000*                                                                 MRKUT061
060100***************************************************************** MRKUT061
060200* R000-READ-PTAG-FILE                                           * MRKUT061
060300*                                                               * MRKUT061
060400*                                                               * MRKUT061
060500***************************************************************** MRKUT061
060600                                                                  MRKUT061
060700 R000-READ-PTAG-FILE.                                             MRKUT061
060800                                                                  MRKUT061
060900*    DISPLAY 'R000-READ-PTAG-FILE'.                               MRKUT061
061000                                                                  MRKUT061
061100     MOVE 'R000-READ-PTAG-FILE'                                   MRKUT061
061200                                 TO PV-ABEND-PARAGRAPH.           MRKUT061
061300*                                                                 MRKUT061
061400     READ PTAG-FILE            INTO MR010-PTAG-FILE               MRKUT061
061500         AT END                                                   MRKUT061
061600            MOVE PC-Y TO PS-PTAG-EOF.                             MRKUT061
061700*                                                                 MRKUT061
061800***************************************************************** MRKUT061
061900* S000-SELECT-DEPTARTMENT                                       * MRKUT061
062000*                                                               * MRKUT061
062100*                                                               * MRKUT061
062200***************************************************************** MRKUT061
062300                                                                  MRKUT061
062400 S000-SELECT-DEPARTMENT.                                          MRKUT061
062500                                                                  MRKUT061
062600*    DISPLAY 'S000-SELECT-DEPARTMENT'.                            MRKUT061
062700                                                                  MRKUT061
062800     MOVE 'S000-SELECT-DEPTARTMENT'                               MRKUT061
062900                                 TO PV-ABEND-PARAGRAPH.           MRKUT061
063000                                                                  MRKUT061
063100     MOVE PV-PREV-ITEM-NBR       TO SKXREF-ITM-NBR.                     61
063200                                                                  MRKUT061
063300     EXEC SQL                                                     MRKUT061
063400         SELECT B.DEPT                                                  61
063500               ,A.MERCH_DIV_CODE                                        61
063600               ,A.DMM_NMBR                                              61
063700           INTO :SKXREF-DEPT                                            61
063800               ,:TSK-MERCH-DIV-CODE                               MRKUT061
063900               ,:TSK-DMM-NMBR                                     MRKUT061
064000           FROM TSK      A,                                       MRKUT061
064010                TSKXREF  B                                        MRKUT061
064100          WHERE B.ITM_NBR = :SKXREF-ITM-NBR                             61
064110            AND A.ITEM_NMBR = B.ITM_NBR                                 61
064200     END-EXEC.                                                    MRKUT061
064300                                                                  MRKUT061
064400     EVALUATE TRUE                                                MRKUT061
064500       WHEN SQLCODE = ZEROS                                       MRKUT061
064600         CONTINUE                                                 MRKUT061
064700       WHEN SQLCODE = PC-ROW-NOT-FOUND                            MRKUT061
064800         MOVE ZEROS              TO SKXREF-DEPT                         61
064900         MOVE ZEROS              TO TSK-MERCH-DIV-CODE            MRKUT061
065000         MOVE ZEROS              TO TSK-DMM-NMBR                  MRKUT061
065100         DISPLAY 'DEPT NOT FOUND FOR: ' PV-PREV-ITEM-NBR                61
065200       WHEN OTHER                                                 MRKUT061
065300         DISPLAY PV-ABEND-PARAGRAPH                               MRKUT061
065400         DISPLAY 'ITEM NBR: '                                     MRKUT061
065500                  PV-PREV-ITEM-NBR                                      61
065600         PERFORM Z999-SQL-ERROR                                   MRKUT061
065700     END-EVALUATE.                                                MRKUT061
065800                                                                  MRKUT061
065900     EJECT                                                        MRKUT061
066000*                                                                 MRKUT061
066100***************************************************************** MRKUT061
066200* S100-SELECT-DEPTARTMENT-DESCRIPTION                           * MRKUT061
066300*                                                               * MRKUT061
066400*                                                               * MRKUT061
066500***************************************************************** MRKUT061
066600                                                                  MRKUT061
066700 S100-SELECT-DEPT-DESC.                                           MRKUT061
066800                                                                  MRKUT061
066900*    DISPLAY 'S100-SELECT-DEPT-DESC'.                             MRKUT061
067000                                                                  MRKUT061
067100     MOVE 'S100-SELECT-DEPT-DESC'                                 MRKUT061
067200                                 TO PV-ABEND-PARAGRAPH.           MRKUT061
067300                                                                  MRKUT061
067310     MOVE SKXREF-DEPT            TO NI-DEPT-9-3.                          
067320     MOVE NI-DEPT-X-3            TO MDSEAR-DEPT-NBR.                      
067400     EXEC SQL                                                     MRKUT061
067500         SELECT MDSEAR_DESC                                       MRKUT061
067600           INTO :MDSEAR-DESC                                      MRKUT061
067700           FROM TMDSEAR                                           MRKUT061
067800          WHERE DEPT_NBR = :MDSEAR-DEPT-NBR                             61
067900            AND MDSELV_CDE = :PC-DPT                              MRKUT061
068000            AND :PV-DB2-DATE-R BETWEEN                            MRKUT061
068100                STRT_DTE AND END_DTE                              MRKUT061
068200     END-EXEC.                                                    MRKUT061
068300                                                                  MRKUT061
068400     EVALUATE TRUE                                                MRKUT061
068500       WHEN SQLCODE = ZEROS                                       MRKUT061
068600       WHEN SQLCODE = PC-DUPLICATE-ROW                            MRKUT061
068700         CONTINUE                                                 MRKUT061
068800       WHEN SQLCODE = PC-ROW-NOT-FOUND                            MRKUT061
068900         MOVE SPACES             TO MDSEAR-DESC                   MRKUT061
069000       WHEN OTHER                                                 MRKUT061
069100         DISPLAY PV-ABEND-PARAGRAPH                               MRKUT061
069200         DISPLAY 'DEPT NBR: '                                     MRKUT061
069300                  NI-DEPT-X-3                                           61
069400         PERFORM Z999-SQL-ERROR                                   MRKUT061
069500     END-EVALUATE.                                                MRKUT061
069600                                                                  MRKUT061
069700     EJECT                                                        MRKUT061
069800*                                                                 MRKUT061
069900***************************************************************** MRKUT061
070000* W000-WRITE-DEMAND-EXCEPT-REC                                  * MRKUT061
070100*                                                               * MRKUT061
070200*                                                               * MRKUT061
070300***************************************************************** MRKUT061
070400                                                                  MRKUT061
070500  W000-WRITE-DEMAND-EXCEPT-REC.                                   MRKUT061
070600                                                                  MRKUT061
070700     MOVE TSK-MERCH-DIV-CODE  TO MR025-MERCH-DIV-CODE.            MRKUT061
070800     MOVE TSK-DMM-NMBR        TO MR025-DMM-NMBR.                  MRKUT061
070810                                                                          
070900     IF   SKXREF-DEPT = 0                                               61
070901         MOVE SPACES TO MR025-MERCH-DEPT-NMBR                             
070902     ELSE                                                                 
070903         MOVE SKXREF-DEPT     TO NI-DEPT-9-3                            61
070910         MOVE NI-DEPT-X-3     TO MR025-MERCH-DEPT-NMBR.                 61
070920                                                                          
071000     MOVE MDSEAR-DESC         TO MR025-MDSEAR-DESC                MRKUT061
071100     MOVE PV-PREV-PTAG-ID     TO MR025-PTAG-ID.                   MRKUT061
071200                                                                  MRKUT061
071300     WRITE DEMAND-EXCEPT-RECS FROM MR025-DEMAND-EXCEPT-REC.       MRKUT061
071400                                                                  MRKUT061
071500     EJECT                                                        MRKUT061
071600*                                                                 MRKUT061
071700***************************************************************** MRKUT061
071800* Y000-END-ROUTINE                                              * MRKUT061
071900*                                                               * MRKUT061
072000*                                                               * MRKUT061
072100***************************************************************** MRKUT061
072200                                                                  MRKUT061
072300 Y000-END-ROUTINE.                                                MRKUT061
072400                                                                  MRKUT061
072500     CLOSE PTAG-FILE                                              MRKUT061
072600           DEMAND-EXCEPT-FILE.                                    MRKUT061
072700                                                                  MRKUT061
072800     EJECT                                                        MRKUT061
072900*                                                                 MRKUT061
073000******************************************************************MRKUT061
073100*     SQL WARNING OR ERROR PROCESSING                            *MRKUT061
073200*                                                                *MRKUT061
073300******************************************************************MRKUT061
073400                                                                  MRKUT061
073500 Z999-SQL-ERROR.                                                  MRKUT061
073600*---------------                                                  MRKUT061
073700                                                                  MRKUT061
073800     MOVE SQLCODE    TO SQLCODE2.                                 MRKUT061
073900     MOVE SQLERRD(3) TO SQLERRD3.                                 MRKUT061
074000     DISPLAY '** ABEND **       ** = SQLERROR'.                   MRKUT061
074100     DISPLAY '** PROGRAM        ** = MRKUT061'.                   MRKUT061
074200     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  MRKUT061
074300     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  MRKUT061
074400     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   MRKUT061
074500     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  MRKUT061
074600     MOVE +4013 TO PV-ABEND-CODE.                                 MRKUT061
074700     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         MRKUT061
074800*                                                                 MRKUT061
074900******************************************************************MRKUT061
