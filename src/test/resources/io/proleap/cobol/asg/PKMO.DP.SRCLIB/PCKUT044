000100 IDENTIFICATION DIVISION.                                                 
000200                                                                          
000300 PROGRAM-ID.         PCKUT044.                                            
000400 AUTHOR.             DENNIS STEFFEN.                                      
000500 INSTALLATION.       KOHLS DEPARTMENT STORES.                             
000600 DATE-WRITTEN.       MAY 2005.                                            
000700 DATE-COMPILED.                                                           
000800 ENVIRONMENT DIVISION.                                                    
000900 CONFIGURATION SECTION.                                                   
001000                                                                          
001100 SOURCE-COMPUTER.    IBM-3090.                                            
001200 OBJECT-COMPUTER.    IBM-3090.                                            
001300                                                                          
001400 INPUT-OUTPUT SECTION.                                                    
001500 FILE-CONTROL.                                                            
001600                                                                          
001700     SELECT IN-TRANSIT-FILE              ASSIGN TO INP01.                 
001800                                                                          
001900 DATA DIVISION.                                                           
002000 FILE SECTION.                                                            
002100                                                                          
002200 FD  IN-TRANSIT-FILE                                                      
002300     LABEL RECORDS ARE STANDARD                                           
002400     RECORDING MODE IS F                                                  
002500     BLOCK CONTAINS 0 RECORDS                                             
002600     RECORD CONTAINS 035 CHARACTERS                                       
002700     DATA RECORD IS IN-TRANSIT-RECORD.                                    
002800 01  IN-TRANSIT-RECORD    PIC  X(035).                                    
002900                                                                          
003000*                                                                         
003100 WORKING-STORAGE SECTION.                                                 
003200                                                                          
003300 01  ABEND-CODE                  PIC S9(04)     VALUE +0  COMP.           
003400                                                                          
003500 01  PROGRAM-CONSTANTS.                                                   
003600     05  PC-PROGRAM-NAME         PIC X(08)      VALUE 'PCKUT044'.         
003700     05  PC-TRAN-PREP-FUNC-CODES.                                         
003800         10  PC-TRAN-PREP-FUNC-OPEN                                       
003900                                 PIC X(05)      VALUE 'OPEN '.            
004000         10  PC-TRAN-PREP-FUNC-WRITE                                      
004100                                 PIC X(05)      VALUE 'WRITE'.            
004200         10  PC-TRAN-PREP-FUNC-CLOSE                                      
004300                                 PIC X(05)      VALUE 'CLOSE'.            
004400     05  PC-TRANS-RECORD-LENGTH  PIC S9(04)     VALUE +100 COMP.          
004500     05  PV-JOB-NAME             PIC X(08)      VALUE SPACES.             
004600     05  PC-PLAN-NAME            PIC X(08)      VALUE 'PCKUP015'.         
004700                                                                          
004800 01  PROGRAM-VARIABLES.                                                   
004900     05  PV-CHECKPOINT-TYPE      PIC X(01)      VALUE SPACE.              
005000         88  CONTROL-BREAK                      VALUE 'C'.                
005100         88  LOGICAL-TRANSACTION                VALUE 'L'.                
005200         88  TIME-INTERVAL                      VALUE 'T'.                
005300         88  REQUESTED-BY-PROGRAM               VALUE 'R'.                
005400     05  PS-TRANS-EOF-SW     PIC X(01)          VALUE 'N'.                
005500         88  PS-TRANS-EOF                       VALUE 'Y'.                
005600     05  PV-SKIP-CLOSE-SW        PIC X(01)      VALUE 'N'.                
005700         88  SKIP-CLOSE                         VALUE 'Y'.                
005800     05  PV-CURRENT-DATE         PIC X(10).                               
005900                                                                          
006000*     IN-TRANSIT CLEAN RECORD                                             
006100     COPY PCRD041.                                                        
006200*                                                                         
006300*     TRANSACTION PREPARATION MODULE LINKAGE SECTION.                     
006400*                                                                         
260107     COPY DPWS990.                                                        
006600                                                                          
006500     COPY DPLS000.                                                        
006600                                                                          
006700     EXEC SQL                                                             
006800         INCLUDE SQLCA                                                    
006900     END-EXEC.                                                            
007000     COPY SQLCA2.                                                         
007100                                                                          
007200 PROCEDURE DIVISION.                                                      
007300******************************************************************        
007400* 0000-MAINLINE-PROCESSING                                       *        
007500*      CONTROLS FLOW OF THE PROGRAM.                             *        
007600******************************************************************        
007700 0000-MAINLINE-PROCESSING.                                                
007800                                                                          
007900     PERFORM 1000-INITIALIZE.                                             
008000     PERFORM 2000-PROCESS UNTIL PS-TRANS-EOF                              
008100     PERFORM 9000-EOJ.                                                    
008200                                                                          
008300     GOBACK.                                                              
008400                                                                          
008500 1000-INITIALIZE.                                                         
008600                                                                          
008700     OPEN INPUT IN-TRANSIT-FILE.                                          
008800                                                                          
008900     ACCEPT PV-JOB-NAME FROM SYSIN.                                       
009000                                                                          
009100     EXEC SQL                                                             
009200          SET :PV-CURRENT-DATE = CURRENT DATE                             
009300     END-EXEC.                                                            
009400                                                                          
009500     PERFORM 8000-READ-ASN-TRANS-FILE.                                    
009600                                                                          
009700*    IF PS-TRANS-EOF                                                      
009800*       SET SKIP-CLOSE                TO TRUE                             
009900*       MOVE +1                       TO RETURN-CODE                      
010000*        DISPLAY ' PCKUT044 -- INP01 IS EMPTY '                           
010100*    ELSE                                                                 
010200*       PERFORM 1100-ISSUE-OPEN-REQUEST                                   
010300*    END-IF.                                                              
010400                                                                          
010500     PERFORM 1100-ISSUE-OPEN-REQUEST.                                     
010600                                                                          
010700 1100-ISSUE-OPEN-REQUEST.                                                 
010800                                                                          
010900     MOVE PC-TRAN-PREP-FUNC-OPEN      TO DP000-FUNC-CODE.                 
011000     MOVE PV-JOB-NAME                 TO DP000-JOB-NAME.                  
011100     MOVE PC-PLAN-NAME                TO DP000-PLAN-NAME.                 
011200     PERFORM Z900-CALL-TRANS-PREP-MODULE.                                 
011300     MOVE DP000-CKPT-TYPE-CODE        TO PV-CHECKPOINT-TYPE.              
011400                                                                          
011500 2000-PROCESS.                                                            
011600     PERFORM 2100-MOVE-TRANS-DATA                                         
011700                                                                          
011800     PERFORM 8000-READ-ASN-TRANS-FILE.                                    
011900                                                                          
012000 2100-MOVE-TRANS-DATA.                                                    
012100                                                                          
012200     MOVE LENGTH OF PC041-UNBAL-SUMMARY-REC                               
012300                                      TO DP000-TRANS-REC-LENGTH.          
012400                                                                          
012500     MOVE PC041-UNBAL-SUMMARY-REC     TO DP000-TRANS-REC.                 
012600                                                                          
012700     MOVE PC-TRAN-PREP-FUNC-WRITE     TO DP000-FUNC-CODE.                 
012800     MOVE PV-JOB-NAME                 TO DP000-JOB-NAME.                  
012900     MOVE PC-PLAN-NAME                TO DP000-PLAN-NAME.                 
013000                                                                          
013100     PERFORM Z900-CALL-TRANS-PREP-MODULE.                                 
013200                                                                          
013300 8000-READ-ASN-TRANS-FILE.                                                
013400                                                                          
013500     READ IN-TRANSIT-FILE INTO PC041-UNBAL-SUMMARY-REC                    
013600         AT END                                                           
013700           SET PS-TRANS-EOF           TO TRUE                             
013800     END-READ.                                                            
013900                                                                          
014000 9000-EOJ.                                                                
014100     CLOSE IN-TRANSIT-FILE.                                               
014200                                                                          
014300     IF SKIP-CLOSE                                                        
014400        NEXT SENTENCE                                                     
014500     ELSE                                                                 
014600        PERFORM 9100-ISSUE-CLOSE-REQUEST                                  
014700     END-IF.                                                              
014800                                                                          
014900 9100-ISSUE-CLOSE-REQUEST.                                                
015000                                                                          
015100     MOVE PC-TRAN-PREP-FUNC-CLOSE TO DP000-FUNC-CODE.                     
015200     MOVE PV-JOB-NAME TO DP000-JOB-NAME.                                  
015300     MOVE PC-PLAN-NAME TO DP000-PLAN-NAME.                                
015400                                                                          
015500     PERFORM Z900-CALL-TRANS-PREP-MODULE.                                 
015600                                                                          
015700     COPY DPPD000.                                                        
015800*                                                                         
015900*     TRANSACTION PREPARATION MODULE CALL AND ERROR ROUTINES.             
016000*                                                                         
