000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    PCKCS161.                                         00020000
000300 AUTHOR.        SHENG TSANG.                                      00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  04-28-94.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800*---------------------------------------------------------------* 00080000
000900*    TRANID      - E161                                         * 00090000
001000*    TYPE        - CICS ARCHITECTURE MAINTENANCE - DB2          * 00100000
001100*    DESCRIPTION - COMPLETE ALL ZERO LINES OF A RECEIVER        * 00110000
001200*    MAPSET      - PCKM161                                      * 00120000
001300*                                                               * 00130000
001400*    THIS PROGRAM WILL COMPLETE ALL ZERO LINE ITEMS FOR A       * 00140000
001500*    WORK ORDER.                                                * 00150000
001600*                                                               * 00160000
001700*    WR-28767 REMOVE ARCHIVING OF TRECEIVER SEGMENT REPLACE     * 00170000
001800*             WITH UPDATE.                                      * 00180000
001900*             BY GARDNER     8/26/94                            * 00190000
002000*    IR-340   IF SQLCODE = -913, -911, -904, PUT THE MESSAGES   * 00200000
002100*             TO SCREEN INSTEAD OF ABENDING THE TRANSACTION.    * 00210000
002200*             BY H. KIM      8/09/95                            * 00220000
002300*                                                               * 00230000
002310*---------------------------------------------------------------- 00231007
002320* DATE  11/07/2022                                              * 00232008
002330*            - ADD COPYBOOK DPWS930                             * 00233008
002340*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00234008
002350*              DYNAMIC.                                         * 00235008
002360*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00236008
002400*---------------------------------------------------------------* 00240000
002500                                                                  00250000
002600 ENVIRONMENT DIVISION.                                            00260000
002700 DATA DIVISION.                                                   00270000
002800                                                                  00280000
002900/                                                                 00290000
003000 WORKING-STORAGE SECTION.                                         00300000
003100                                                                  00310000
003200 01  PC-PROGRAM-CONSTANTS.                                        00320000
003300     05  PC-998                       PIC S9(04)  VALUE  +998     00330000
003400                                                  COMP.           00340000
003500     05  PC-999                       PIC S9(04)  VALUE  +999     00350000
003600                                                  COMP.           00360000
003700     05  PC-A                         PIC  X(01)   VALUE 'A'.     00370000
003800     05  PC-I                         PIC  X(01)   VALUE 'I'.     00380000
003900     05  PC-M                         PIC  X(01)   VALUE 'M'.     00390000
004000     05  PC-N                         PIC  X(01)   VALUE 'N'.     00400000
004100     05  PC-R                         PIC  X(01)   VALUE 'R'.     00410000
004200     05  PC-T                         PIC  X(01)   VALUE 'T'.     00420000
004300     05  PC-CM                        PIC  X(02)   VALUE 'CM'.    00430000
004400     05  PC-IP                        PIC  X(02)   VALUE 'IP'.    00440000
004500     05  PC-CURRENT-MAP-NAME          PIC  X(08)   VALUE          00450000
004600         'PC161A  '.                                              00460000
004700     05  PC-CURRENT-MAPSET-NAME       PIC  X(08)   VALUE          00470000
004800         'PCKM161 '.                                              00480000
004900     05  PC-CURRENT-PROGRAM-NAME      PIC  X(08)   VALUE          00490000
005000         'PCKCS161'.                                              00500000
005100     05  PC-AUDIT-RTN                 PIC  X(08)  VALUE           00510000
005200         'RCKCS290'.                                              00520000
005300     05  PC-AUDIT-RTN-LENGTH          PIC S9(04)  VALUE  +300     00530000
005400                                                  COMP SYNC.      00540000
005500     05  PC-VERIF-ELIGIBILITY-PGM  PIC X(08)  VALUE 'RCKUT124'.   00550000
005600     05  PC-CONFIRM-BY-RECEIVER    PIC X(08)  VALUE 'RCKUT136'.   00560000
005700     05  PC-AUTOVE-PARM-PROGRAM    PIC X(08)  VALUE 'RCKUT127'.   00570000
005800                                                                  00580000
005900     05  PC-TSYMSG-NUMBERS.                                       00590000
006000         10  PC-TSYMSG-00551          PIC  9(5)    VALUE 00551.   00600000
006100*            DB2 TABLE IS NOT AVAILABLE - TRY AGAIN               00610000
006200         10  PC-TSYMSG-00884          PIC  9(5)    VALUE 00884.   00620000
006300*            PO TROUBLE EXISTS, NO UPDATES OCCURRED               00630000
006400         10  PC-TSYMSG-00885          PIC  9(5)    VALUE 00885.   00640000
006500*            CANNOT UPDATE LINES WITH TROUBLE AND RECDIS ERRORS   00650000
006600         10  PC-TSYMSG-00886          PIC  9(5)    VALUE 00886.   00660000
006700*            CANNOT UPDATE LINE(S) WHERE TROUBLE EXISTS           00670000
006800         10  PC-TSYMSG-00887          PIC  9(5)    VALUE 00887.   00680000
006900*            CANNOT UPDATE LINE(S) WITH RECDIS ERROR              00690000
007000         10  PC-TSYMSG-00888          PIC  9(5)    VALUE 00888.   00700000
007100*            ALL LINES FOR RECEIVER ARE COMPLETED                 00710000
007200         10  PC-TSYMSG-02408          PIC  9(5)    VALUE 02408.   00720000
007300*            UPDATE SUCCESSFUL; PRESS F5 TO REFRESH THE SCREEN.   00730000
007400         10  PC-TSYMSG-03241          PIC  9(5)    VALUE 03241.   00740000
007500         10  PC-TSYMSG-00984          PIC  9(5)    VALUE 00984.   00750000
007600         10  PC-TSYMSG-03353          PIC  9(5)    VALUE 03353.   00760000
007700* ERROR OCCURED IN VERIFICATION PROCESS - PERFORM HOT COMPLETE AGA00770000
007800                                                                  00780000
007900 01  PV-PROGRAM-VARIABLES.                                        00790000
008000     05  PV-DISPLAY-OPER-UNT-ID       PIC  9(04).                 00800000
008100     05  PV-DISPLAY-FCLTY-ID          PIC  9(04).                 00810000
008200     05  PV-DISPLAY-PO-NBR            PIC  9(09).                 00820000
008300     05  PV-DISPLAY-RCVR-SEQ-NBR      PIC  9(09).                 00830000
008400     05  PV-DISPLAY-LNE-NBR           PIC  9(04).                 00840000
008500     05  PV-DISPLAY-PREPK-ID          PIC  9(04).                 00850000
008600     05  PV-DISPLAY-TRIP-ID           PIC  9(09).                 00860000
008700*                                                                 00870000
008800     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        00880000
008900                                           COMP SYNC.             00890000
009000     05  PV-CICS-RESPONSE             PIC S9(04)  VALUE +0        00900000
009100                                           COMP SYNC.             00910000
009200     05  PV-CICS-MSG-AREA             PIC  X(80)  VALUE SPACES.   00920000
009300                                                                  00930000
009400     05  PV-DB2-DISTHD-ERR-CNT           PIC S9(09)   VALUE +0    00940000
009500                                                      COMP-3.     00950000
009600 01  PS-PROGRAM-SWITCHES.                                         00960000
009700     05  PS-ERROR-SW                  PIC  X(01)   VALUE 'N'.     00970000
009800         88  PS-NO-ERROR                           VALUE 'N'.     00980000
009900         88  PS-ERROR                              VALUE 'Y'.     00990000
010000     05  PS-FETCHING-SW               PIC  X(01)   VALUE 'N'.     01000000
010100         88  PS-FETCHING-DONE                      VALUE 'Y'.     01010000
010200         88  PS-FETCHING-NOT-DONE                  VALUE 'N'.     01020000
010300     05  PS-LINE-ERROR-SW             PIC  X(01)   VALUE 'N'.     01030000
010400         88  PS-LINE-ERROR-BOTH                    VALUE 'B'.     01040000
010500         88  PS-LINE-ERROR-NONE                    VALUE 'N'.     01050000
010600         88  PS-LINE-ERROR-RECDIS                  VALUE 'R'.     01060000
010700         88  PS-LINE-ERROR-TROUBLE                 VALUE 'T'.     01070000
010800     05  PS-RECDIS-EXISTS-SW          PIC  X(01)   VALUE 'N'.     01080000
010900         88  PS-RECDIS-EXISTS-NO                   VALUE 'N'.     01090000
011000         88  PS-RECDIS-EXISTS-YES                  VALUE 'Y'.     01100000
011100     05  PS-TROUBLE-EXISTS-SW         PIC  X(01)   VALUE 'N'.     01110000
011200         88  PS-TROUBLE-EXISTS-NO                  VALUE 'N'.     01120000
011300         88  PS-TROUBLE-EXISTS-YES                 VALUE 'Y'.     01130000
011400     05  PS-UPDATE-SW                 PIC  X(01)   VALUE 'N'.     01140000
011500         88  PS-NO-UPDATES-DONE                    VALUE 'N'.     01150000
011600         88  PS-UPDATES-DONE                       VALUE 'Y'.     01160000
011610     05  PS-WMOS-RCVR-FOUND-SW        PIC  X(01)   VALUE 'N'.     01161003
011620         88  PS-WMOS-RCVR-YES                      VALUE 'Y'.     01162003
011630         88  PS-WMOS-RCVR-NO                       VALUE 'N'.     01163003
011700                                                                  01170000
011800*---------------------------------------------------------------* 01180000
011900*  RECORD LAYOUT 'INSERT AUDIT MODULE'  RCKCS290                * 01190000
012000*---------------------------------------------------------------* 01200000
012100     COPY RCWS031.                                                01210000
012200                                                                  01220000
012300*---------------------------------------------------------------* 01230000
012400*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 01240000
012500*---------------------------------------------------------------* 01250000
012600     COPY PCWS016.                                                01260000
012700                                                                  01270000
012800*---------------------------------------------------------------* 01280000
012900*    MAP LAYOUT                                                 * 01290000
013000*---------------------------------------------------------------* 01300000
013100     COPY PCKM161.                                                01310000
013200                                                                  01320000
013300*---------------------------------------------------------------* 01330000
013400*    PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).   * 01340000
013500*---------------------------------------------------------------* 01350000
013600     COPY DPWS030.                                                01360000
013610     COPY DPWS930.                                                01361008
013700                                                                  01370000
013800******************************************************************01380000
013900*      THIS COPYBOOK IS USED FOR THE VERIFICATION ELIGIBILITY    *01390000
014000*  MODULE.  THIS MODULE WILL BE USED TO DETERMINE IF AN ORDER    *01400000
014100*  CAN BE VERIFIED.  (RCKUT124)                                  *01410000
014200******************************************************************01420000
014300     COPY RCWS038.                                                01430000
014400*---------------------------------------------------------------* 01440000
014500*  RECORD LAYOUTS FOR THE AUTO VERF PARM CHECK MODULE             01450000
014600*---------------------------------------------------------------* 01460000
014700     COPY RCWS040.                                                01470000
014800                                                                  01480000
014900*---------------------------------------------------------------* 01490000
015000*---------------------------------------------------------------* 01500000
015100*  RECORD LAYOUT FOR THE COMMAREA BEING USED TO PASS DATA TO    * 01510000
015200*  THE AUTO CONFIRMATION MODULE (RCKUT125).                     * 01520000
015300*---------------------------------------------------------------* 01530000
015400     COPY RCWS041.                                                01540000
015500                                                                  01550000
015600*---------------------------------------------------------------* 01560000
015700*  RECORD LAYOUT FOR THE COMMAREA BEING USED TO PASS DATA TO    * 01570000
015800*  THE VERIFICATION TRANSACTION (PCKCS200).                     * 01580000
015900*---------------------------------------------------------------* 01590000
016000     COPY RCWS289.                                                01600000
016100                                                                  01610000
016200*---------------------------------------------------------------* 01620000
016300*  RECORD LAYOUT FOR THE COMMAREA BEING USED TO PASS DATA TO    * 01630000
016400*  THE ADJUST SYSTEM AUDIT MODULE (SUKCS762).                   * 01640000
016500*---------------------------------------------------------------* 01650000
016600     COPY SUWS047.                                                01660000
016700                                                                  01670000
016800*---------------------------------------------------------------* 01680000
016900*    STANDARD COMMAREA.                                         * 01690000
017000*---------------------------------------------------------------* 01700000
017100     COPY DPWS020.                                                01710000
017200     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01720000
017300                                                                  01730000
017400         10  INTER-APPL-COMM-AREA     PIC  X(200).                01740000
017500     COPY PCWS000.                                                01750000
017600*---------------------------------------------------------------* 01760000
017700*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 01770000
017800*---------------------------------------------------------------* 01780000
017900         10  ASC-SPECIFIC-COMMAREA.                               01790000
018000             15  ASC-HOLD-INTER-APPL  PIC  X(200).                01800000
018100             15  ASC-UPDATE-SUCCESSFUL-SW                         01810000
018200                                      PIC  X(01).                 01820000
018300                 88  ASC-UPDATE-SUCCESSFUL         VALUE 'Y'.     01830000
018400             15  ASC-KEY-OPER-UNT-ID  PIC S9(04)   COMP.          01840000
018500             15  ASC-KEY-FCLTY-ID     PIC S9(04)   COMP.          01850000
018600             15  ASC-KEY-PO-NBR       PIC S9(09)   COMP.          01860000
018700             15  ASC-KEY-ORD-NBR  REDEFINES  ASC-KEY-PO-NBR       01870000
018800                                      PIC S9(09)   COMP.          01880000
018900             15  ASC-KEY-RCVR-SEQ-NBR PIC S9(09)   COMP.          01890000
019000             15  ASC-KEY-LINE-NBR     PIC S9(04)   COMP.          01900000
019100             15  ASC-KEY-WO-NBR       PIC S9(04)   COMP.          01910000
019200             15  ASC-KEY-PREPK-ID     PIC S9(04)   COMP.          01920000
019300             15  ASC-UPD-TMST         PIC  X(26).                 01930000
019400             15  FILLER               PIC  X(1180).               01940000
019500         10  FILLER                   PIC  X(200).                01950000
019600*                                                                 01960000
019700*---------------------------------------------------------------* 01970000
019800*    DB2 AREA FOR TRECDIS                                       * 01980000
019900*---------------------------------------------------------------* 01990000
020000     EXEC SQL                                                     02000000
020100          INCLUDE TRECDIS                                         02010000
020200     END-EXEC.                                                    02020000
020300*                                                                 02030000
020400*---------------------------------------------------------------* 02040000
020500*    DB2 AREA FOR TRECEIV                                       * 02050000
020600*---------------------------------------------------------------* 02060000
020700     EXEC SQL                                                     02070000
020800          INCLUDE TRECEIV                                         02080000
020900     END-EXEC.                                                    02090000
021000*                                                                 02100000
021100*---------------------------------------------------------------* 02110000
021200*    DB2 AREA FOR TRECITM                                       * 02120000
021300*---------------------------------------------------------------* 02130000
021400     EXEC SQL                                                     02140000
021500          INCLUDE TRECITM                                         02150000
021600     END-EXEC.                                                    02160000
021700*                                                                 02170000
021800*---------------------------------------------------------------* 02180000
021900*    DB2 AREA FOR TTRBNTF                                       * 02190000
022000*---------------------------------------------------------------* 02200000
022100     EXEC SQL                                                     02210000
022200          INCLUDE TTRBNTF                                         02220000
022300     END-EXEC.                                                    02230000
022400*---------------------------------------------------------------* 02240000
022500*    DB2 AREA FOR TTRBRSN                                       * 02250000
022600*---------------------------------------------------------------* 02260000
022700     EXEC SQL                                                     02270000
022800          INCLUDE TTRBRSN                                         02280000
022900     END-EXEC.                                                    02290000
023000*                                                                 02300000
023100*---------------------------------------------------------------* 02310000
023200*    DB2 AREA FOR TWRKORD                                       * 02320000
023300*---------------------------------------------------------------* 02330000
023400     EXEC SQL                                                     02340000
023500          INCLUDE TWRKORD                                         02350000
023600     END-EXEC.                                                    02360000
023700*                                                                 02370000
023800*---------------------------------------------------------------* 02380000
023900*    DB2 AREA FOR TWKORIN                                       * 02390000
024000*---------------------------------------------------------------* 02400000
024100     EXEC SQL                                                     02410000
024200          INCLUDE TWKORIN                                         02420000
024300     END-EXEC.                                                    02430000
024400*                                                                 02440000
024500*---------------------------------------------------------------* 02450000
024600*    DB2 AREA FOR TSHIPMT                                       * 02460000
024700*---------------------------------------------------------------* 02470000
024800     EXEC SQL                                                     02480000
024900          INCLUDE TSHIPMT                                         02490000
025000     END-EXEC.                                                    02500000
025100*                                                                 02510000
025200*---------------------------------------------------------------* 02520000
025300*    DB2 AREA FOR TPKSLIP                                       * 02530000
025400*---------------------------------------------------------------* 02540000
025500     EXEC SQL                                                     02550000
025600          INCLUDE TPKSLIP                                         02560000
025700     END-EXEC.                                                    02570000
025800*                                                                 02580000
025900*---------------------------------------------------------------* 02590000
026000*    DB2 AREA FOR TTRIPST                                       * 02600000
026100*---------------------------------------------------------------* 02610000
026200     EXEC SQL                                                     02620000
026300          INCLUDE TTRIPST                                         02630000
026400     END-EXEC.                                                    02640000
026500*                                                                 02650000
026600*---------------------------------------------------------------* 02660000
026700*    DB2 AREA FOR TTRSTYP                                       * 02670000
026800*---------------------------------------------------------------* 02680000
026900     EXEC SQL                                                     02690000
027000          INCLUDE TTRSTYP                                         02700000
027100     END-EXEC.                                                    02710000
027200*                                                                 02720000
027300*---------------------------------------------------------------* 02730000
027400*    DB2 AREA FOR TSHPTPO                                       * 02740000
027500*---------------------------------------------------------------* 02750000
027600     EXEC SQL                                                     02760000
027700          INCLUDE TSHPTPO                                         02770000
027800     END-EXEC.                                                    02780000
027900*                                                                 02790000
028000*---------------------------------------------------------------* 02800000
028100*    DB2 AREA FOR TDISTHD                                       * 02810000
028200*---------------------------------------------------------------* 02820000
028300     EXEC SQL                                                     02830000
028400          INCLUDE TDISTHD                                         02840000
028500     END-EXEC.                                                    02850000
028600*                                                                 02860000
028610*---------------------------------------------------------------* 02861002
028620*    DB2 AREA FOR TKRPRPM  PARAMETER TABLE                      * 02862002
028630*---------------------------------------------------------------* 02863002
028640     EXEC SQL                                                     02864002
028650          INCLUDE TKRPRPM                                         02865002
028660     END-EXEC.                                                    02866002
028670*                                                                 02867002
028700*---------------------------------------------------------------* 02870000
028800*    DB2 AREA FOR COMMUNICATIONS                                * 02880000
028900*---------------------------------------------------------------* 02890000
029000     EXEC SQL                                                     02900000
029100          INCLUDE SQLCA                                           02910000
029200     END-EXEC.                                                    02920000
029300*                                                                 02930000
029400*---------------------------------------------------------------* 02940000
029500*    DB2 AREA DECLARE CURSOR                                    * 02950000
029600*---------------------------------------------------------------* 02960000
029700     EXEC SQL                                                     02970000
029800          DECLARE ITEM_CSR CURSOR FOR                             02980000
029900           SELECT ORD_NBR,                                        02990000
030000                  ORD_LNE_NBR,                                    03000000
030100                  REC_SEQ_NBR,                                    03010000
030200                  OPER_UNT_ID,                                    03020000
030300                  FCLTY_ID,                                       03030000
030400                  CRE_TMST,                                       03040000
030500                  CRE_UID,                                        03050000
030600                  PO_VER_NBR,                                     03060000
030700                  ITM_NBR,                                        03070000
030800                  PRE_TKT_IND,                                    03080000
030900                  TKT_FMT_ID,                                     03090000
031000                  RTV_IND,                                        03100000
031100                  STATUS_CDE,                                     03110000
031200                  VER_STATUS_CDE,                                 03120000
031300                  PKSL_ITM_QTY,                                   03130000
031400                  DTL_CK_ITM_QTY,                                 03140000
031500                  INNR_PACK_QTY,                                  03150000
031600                  CASE_PACK_QTY,                                  03160000
031700                  RTV_QTY,                                        03170000
031800                  EXPTED_CART_CNT,                                03180000
031900                  ACTL_CART_CNT,                                  03190000
032000                  MKING_APRON_TMST,                               03200000
032100                  UNT_COST_AMT,                                   03210000
032200                  COLOR_DESC,                                     03220000
032300                  SIZE_DESC,                                      03230000
032400                  VEND_STYL_NAME,                                 03240000
032500                  VEND_DESC,                                      03250000
032600                  VERFYD_TMST,                                    03260000
032700                  PKSL_NBR,                                       03270000
032800                  REC_INV_LNE_NBR,                                03280000
032900                  DMG_ITM_QTY,                                    03290000
033000                  UPD_TMST,                                       03300000
033100                  UPD_UID,                                        03310000
033200                  UPD_PGM_ID,                                     03320000
033300                  RCPT_DISTR_UPD_CDE,                             03330000
033400                  PREPK_ID                                        03340000
033500             FROM TRECITM                                         03350000
033600            WHERE ORD_NBR         =  :ASC-KEY-PO-NBR              03360000
033700              AND REC_SEQ_NBR     =  :ASC-KEY-RCVR-SEQ-NBR        03370000
033800              AND OPER_UNT_ID     =  :ASC-KEY-OPER-UNT-ID         03380000
033900              AND FCLTY_ID        =  :ASC-KEY-FCLTY-ID            03390000
034000              AND STATUS_CDE      =  :PC-IP                       03400000
034100              AND VER_STATUS_CDE  =  :PC-A                        03410000
034200     END-EXEC.                                                    03420000
034300*                                                                 03430000
034400*---------------------------------------------------------------* 03440000
034500*    ABEND PROCESSING COPYBOOK.                                 * 03450000
034600*---------------------------------------------------------------* 03460000
034700     COPY DPWS013.                                                03470000
034800*                                                                 03480000
034900*                                                                 03490000
035000 LINKAGE SECTION.                                                 03500000
035100*                                                                 03510000
035200 01  DFHCOMMAREA.                                                 03520000
035300     05  FILLER                         OCCURS  1 TO 4072 TIMES   03530000
035400                                        DEPENDING ON EIBCALEN.    03540000
035500         10  FILLER                   PIC  X(01).                 03550000
035600*                                                                 03560000
035700*                                                                 03570000
035800 PROCEDURE DIVISION.                                              03580000
035900*                                                                 03590000
036000*---------------------------------------------------------------* 03600000
036100*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 03610000
036200*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 03620000
036300*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 03630000
036400*---------------------------------------------------------------* 03640000
036500 0000-MAIN-MODULE.                                                03650000
036600     INITIALIZE DP030-CICS-API-FIELDS.                            03660000
036700                                                                  03670000
036800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03680000
036900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03690000
037000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03700000
037100                                                                  03710000
037200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03720000
037300                                                                  03730000
037400     MOVE LENGTH OF PC161AI        TO DP030-MAP-LENGTH (1).       03740000
037500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03750000
037600                                                                  03760000
037700     PERFORM 0001-CALL-CICS-ARCH-API.                             03770000
037800                                                                  03780000
037900     PERFORM 1000-CONTROL-PROCESSING.                             03790000
038000                                                                  03800000
038100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03810000
038200     PERFORM 0001-CALL-CICS-ARCH-API.                             03820000
038300*                                                                 03830000
038400*                                                                 03840000
038500*---------------------------------------------------------------* 03850000
038600*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 03860000
038700*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 03870000
038800*---------------------------------------------------------------* 03880000
038900 0001-CALL-CICS-ARCH-API.                                         03890000
039000*    CALL 'DPKCS030' USING DFHEIBLK                               03900008
039010     CALL DP930-CICS-ARCH-API                                     03901008
039020                     USING DFHEIBLK                               03902008
039100                           DFHCOMMAREA                            03910000
039200                           DP030-CICS-API-FIELDS                  03920000
039300                           DP020-STANDARD-COMMAREA                03930000
039400                           PC161AI.                               03940000
039500                                                                  03950000
039600     IF  DP030-RC-CALL-SUCCESSFUL                                 03960000
039700         CONTINUE                                                 03970000
039800     ELSE                                                         03980000
039900         SET DP013-NO-ROLLBACK                                    03990000
040000             DP013-XCTL-DISPLAY-RESTART                           04000000
040100             DP013-CICS-ABEND      TO TRUE                        04010000
040200         MOVE '0001-CALL-CICS-ARCH-API'                           04020000
040300                                   TO DP013-PARAGRAPH             04030000
040400*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX04040008
040500*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      04050008
040510         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04051008
040520-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04052008
040600         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      04060000
040700         PERFORM DP013-0000-PROCESS-ABEND                         04070000
040800     END-IF.                                                      04080000
040900*                                                                 04090000
041000*                                                                 04100000
041100*----------------------------------------------------------------*04110000
041200* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *04120000
041300* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *04130000
041400*                                                                *04140000
041500* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *04150000
041600*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *04160000
041700*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *04170000
041800*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *04180000
041900*----------------------------------------------------------------*04190000
042000 1000-CONTROL-PROCESSING.                                         04200000
042100     EVALUATE TRUE                                                04210000
042200         WHEN DP020-NEXT-ACT-INITIAL                              04220000
042300         WHEN DP020-INT-APPL-FORMAT-IND  = '1'                    04230000
042400             MOVE 02   TO DP020-SRC-AID                           04240000
042500             MOVE '3'  TO DP020-FK-ACTION (DP020-SRC-AID)         04250000
042600             PERFORM 2000-PROCESS-PANEL                           04260000
042700                                                                  04270000
042800         WHEN DP020-NEXT-ACT-INITIAL                              04280000
042900         WHEN DP020-NEXT-ACT-RETURN                               04290000
043000              INITIALIZE ASC-SPECIFIC-COMMAREA                    04300000
043100              MOVE INTER-APPL-COMM-AREA TO ASC-HOLD-INTER-APPL    04310000
043200                                                                  04320000
043300         WHEN DP020-NEXT-ACT-READ-MAP                             04330000
043400              IF ASC-UPDATE-SUCCESSFUL                            04340000
043500                  NEXT SENTENCE                                   04350000
043600              ELSE                                                04360000
043700                  PERFORM 2000-PROCESS-PANEL                      04370000
043800              END-IF                                              04380000
043900                                                                  04390000
044000         WHEN OTHER                                               04400000
044100              SET DP013-LOGIC-ABEND  TO TRUE                      04410000
044200              SET DP013-NO-ROLLBACK  TO TRUE                      04420000
044300              MOVE '1000-CONTROL-PROCESSING'                      04430000
044400                                   TO DP013-PARAGRAPH             04440000
044500              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'   04450000
044600                                   TO DP013-MESSAGE-TEXT(1)       04460000
044700              PERFORM DP013-0000-PROCESS-ABEND                    04470000
044800     END-EVALUATE.                                                04480000
044900*                                                                 04490000
045000*                                                                 04500000
045100*----------------------------------------------------------------*04510000
045200* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *04520000
045300* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *04530000
045400* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *04540000
045500* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *04550000
045600* FUNCTION KEYS CAN GET THIS FAR.                                *04560000
045700*----------------------------------------------------------------*04570000
045800 2000-PROCESS-PANEL.                                              04580000
045900     IF  DP020-FK-CONFIRM (DP020-SRC-AID)                         04590000
045910         SET PS-NO-ERROR   TO TRUE                                04591000
045920         MOVE PC000-PO-NBR-N       TO ASC-KEY-PO-NBR              04592000
045930         MOVE PC000-REC-SEQ-NBR-N  TO ASC-KEY-RCVR-SEQ-NBR        04593000
045940         MOVE PC000-WO-NBR-N       TO ASC-KEY-WO-NBR              04594000
045950         MOVE PC000-OPERATING-UNIT-ID                             04595000
045960                                   TO ASC-KEY-OPER-UNT-ID         04596000
045970         MOVE PC000-FACILITY-ID    TO ASC-KEY-FCLTY-ID            04597000
045980         MOVE ZERO                 TO TRBNTF-PO-LNE-NBR           04598000
045990         MOVE ZERO                 TO TRBNTF-PREPK-ID             04599000
046000         PERFORM 7550-CHECK-FOR-RCVR-TRBL                         04600000
046100         IF  PS-TROUBLE-EXISTS-YES                                04610000
046200             MOVE PC-TSYMSG-00884  TO DP020-MSG-MESSAGE           04620000
046300             SET PS-ERROR          TO TRUE                        04630000
046400         ELSE                                                     04640000
046500             PERFORM 7100-COMPLETE-RCVR-ITEMS                     04650000
046600             EVALUATE TRUE                                        04660000
046700                 WHEN PS-LINE-ERROR-BOTH                          04670000
046800                      MOVE PC-TSYMSG-00885                        04680000
046900                                   TO DP020-MSG-MESSAGE           04690000
047000                      SET PS-ERROR          TO TRUE               04700000
047100                 WHEN PS-LINE-ERROR-TROUBLE                       04710000
047200                      MOVE PC-TSYMSG-00886                        04720000
047300                                   TO DP020-MSG-MESSAGE           04730000
047400                      SET PS-ERROR          TO TRUE               04740000
047500                 WHEN PS-LINE-ERROR-RECDIS                        04750000
047600                      MOVE PC-TSYMSG-00887                        04760000
047700                                   TO DP020-MSG-MESSAGE           04770000
047800                      SET PS-ERROR          TO TRUE               04780000
047900                 WHEN OTHER                                       04790000
048000                      PERFORM 7000-COMPLETE-RCVR                  04800000
048100                      IF PS-ERROR AND DP020-MSG-MESSAGE = SPACES  04810000
048200                        MOVE PC-TSYMSG-03353  TO DP020-MSG-MESSAGE04820000
048300                      END-IF                                      04830000
048400             END-EVALUATE                                         04840000
048500         END-IF                                                   04850000
048600         IF DP020-INT-APPL-FORMAT-IND = '1'                       04860000
048700             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                04870000
048800             IF PS-NO-ERROR                                       04880000
048900                 SET DP020-MSG-INFORMATIONAL  TO TRUE             04890000
049000                 MOVE PC-TSYMSG-02408  TO DP020-MSG-MESSAGE       04900000
049100             ELSE                                                 04910000
049200                 SET DP020-MSG-FATAL         TO TRUE              04920000
049300             END-IF                                               04930000
049400         ELSE                                                     04940000
049500             SET ASC-UPDATE-SUCCESSFUL                            04950000
049600                 DP020-MSG-INFORMATIONAL                          04960000
049700                 DP030-OVERRIDE-GO     TO TRUE                    04970000
049800         END-IF                                                   04980000
049900     END-IF.                                                      04990000
050000*                                                                 05000000
050100*                                                                 05010000
050200*----------------------------------------------------------------*05020000
050300* STATUS THE RECEIVER AS 'CM' IF THE CURRENT STATUS IS 'IP'.     *05030000
050400*----------------------------------------------------------------*05040000
050500 7000-COMPLETE-RCVR.                                              05050000
050600                                                                  05060000
050700     PERFORM 7005-SELECT-TRECEIV.                                 05070000
050800                                                                  05080000
050900     IF RECEIV-STATUS-CDE = 'IP' OR 'CM'                          05090000
051000       IF RECEIV-STATUS-CDE = 'IP'                                05100000
051100        PERFORM 7010-LINK-AUDIT-MODULE                            05110000
051200          IF RC031-CALL-SUCCESSFUL                                05120000
051300            PERFORM 7020-UPDATE-TRECEIV                           05130000
051400          END-IF                                                  05140000
051500       END-IF                                                     05150000
051600       MOVE ZERO                 TO WRKORD-ORD-LNE-NBR            05160000
051700                                    WKORIN-ORD-LNE-NBR            05170000
051800*GB 3/17/04 BEG                                                   05180000
051900        PERFORM 7030-SEL-PKSLIP-TRIP                              05190000
052000        PERFORM 7040-SEL-TRSTYP-PRTY-CDE                          05200000
052100        PERFORM 7060-PROCESS-AUTOVE-COMPLETE                      05210000
052200*GB 3/17/04 END                                                   05220000
052300     END-IF.                                                      05230000
052400                                                                  05240000
052500     IF PS-NO-ERROR AND PS-WMOS-RCVR-NO                           05250003
052600         PERFORM 7200-COMPLETE-TWRKORD                            05260000
052700         MOVE PC-TSYMSG-00888  TO DP020-MSG-MESSAGE               05270000
052800     END-IF.                                                      05280000
052900*----------------------------------------------------------------*05290000
053000*    SELECT THE CURRENT RECEIVER                                 *05300000
053100*----------------------------------------------------------------*05310000
053200 7005-SELECT-TRECEIV.                                             05320000
053300                                                                  05330000
053400     EXEC SQL                                                     05340000
053500          SELECT STATUS_CDE                                       05350000
053600               , PACK_BY_ST_IND                                   05360000
053700               , PKGNG_CDE                                        05370000
053710               , CURR_OPER_UNT_ID                                 05371001
053800           INTO :RECEIV-STATUS-CDE                                05380001
053900              , :RECEIV-PACK-BY-ST-IND                            05390001
054000              , :RECEIV-PKGNG-CDE                                 05400001
054010              , :RECEIV-CURR-OPER-UNT-ID                          05401001
054100           FROM  TRECEIV                                          05410001
054200           WHERE ORD_NBR         =  :ASC-KEY-PO-NBR               05420001
054300             AND REC_SEQ_NBR     =  :ASC-KEY-RCVR-SEQ-NBR         05430001
054400*            AND OPER_UNT_ID     =  :ASC-KEY-OPER-UNT-ID          05440001
054500*            AND FCLTY_ID        =  :ASC-KEY-FCLTY-ID             05450001
054600             AND VER_STATUS_CDE  =  :PC-A                         05460001
054700     END-EXEC.                                                    05470001
054800                                                                  05480001
054900     EVALUATE TRUE                                                05490001
055000         WHEN SQLCODE = ZERO                                      05500001
055100              CONTINUE                                            05510001
055200         WHEN SQLCODE = -904                                      05520001
055300         WHEN SQLCODE = -911                                      05530001
055400         WHEN SQLCODE = -913                                      05540001
055500              SET PS-UPDATES-DONE TO TRUE                         05550001
055600              PERFORM 9900-SOFT-ABORT                             05560001
055700         WHEN SQLWARN0 NOT = SPACE                                05570001
055800         WHEN SQLCODE NOT = ZERO                                  05580001
055900              MOVE '7005-SELECT-TRECEIV'                          05590001
056000                                   TO DP013-PARAGRAPH             05600001
056100              MOVE 'SELECT TRECEIV STATUS CODE'                   05610001
056200                                   TO DP013-MESSAGE-TEXT (1)      05620001
056300              MOVE SQLCA           TO DP013-SQLCA                 05630001
056400              MOVE 'TRECEIV '      TO DP013-DB2-TABLE-NAME (1)    05640001
056500              MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR           05650001
056600              MOVE ASC-KEY-RCVR-SEQ-NBR                           05660001
056700                                   TO PV-DISPLAY-RCVR-SEQ-NBR     05670001
056800              STRING 'PO = '                                      05680001
056900                     PV-DISPLAY-PO-NBR                            05690001
057000                     ' RECV = '                                   05700001
057100                     PV-DISPLAY-RCVR-SEQ-NBR                      05710001
057200                     DELIMITED BY SIZE                            05720001
057300                                 INTO DP013-MESSAGE-TEXT (2)      05730001
057400              MOVE ASC-KEY-OPER-UNT-ID                            05740001
057500                                   TO PV-DISPLAY-OPER-UNT-ID      05750001
057600              MOVE ASC-KEY-FCLTY-ID                               05760001
057700                                   TO PV-DISPLAY-FCLTY-ID         05770001
057800              STRING 'OPER = '                                    05780001
057900                     PV-DISPLAY-OPER-UNT-ID                       05790001
058000                     ' FCLTY = '                                  05800001
058100                     PV-DISPLAY-FCLTY-ID                          05810001
058200                     DELIMITED BY SIZE                            05820001
058300                                 INTO DP013-MESSAGE-TEXT (3)      05830001
058400              SET DP013-DB2-ABEND  TO TRUE                        05840001
058500              PERFORM DP013-0000-PROCESS-ABEND                    05850001
058600     END-EVALUATE.                                                05860001
058700*                                                                 05870001
058800*----------------------------------------------------------------*05880001
058900*    LINK TO AUDIT MODULE * RCKCS290                             *05890001
059000*----------------------------------------------------------------*05900001
059100                                                                  05910001
059200 7010-LINK-AUDIT-MODULE.                                          05920001
059300                                                                  05930001
059400     MOVE 'V'                   TO RC031-TABLE-TO-AUDIT.          05940001
059500     MOVE 'B'                   TO RC031-AUD-TYP-CDE.             05950001
059600     MOVE 'U'                   TO RC031-AUD-FUNC-CDE.            05960001
059700     MOVE ASC-KEY-OPER-UNT-ID   TO RC031-OPER-UNT-ID.             05970001
059800     MOVE ASC-KEY-FCLTY-ID      TO RC031-FCLTY-ID.                05980001
059900     MOVE ASC-KEY-PO-NBR        TO RC031-PO-NBR.                  05990001
060000     MOVE ASC-KEY-RCVR-SEQ-NBR  TO RC031-REC-SEQ-NBR.             06000001
060100                                                                  06010001
060200     EXEC CICS                                                    06020001
060300          LINK PROGRAM  (PC-AUDIT-RTN)                            06030001
060400          COMMAREA (RC031-FIELDS)                                 06040001
060500          LENGTH   (PC-AUDIT-RTN-LENGTH)                          06050001
060600     END-EXEC.                                                    06060001
060700                                                                  06070001
060800     EVALUATE TRUE                                                06080001
060900         WHEN RC031-CALL-SUCCESSFUL                               06090001
061000         WHEN RC031-TRECEIV-REC-NOT-FOUND                         06100001
061100             CONTINUE                                             06110001
061200         WHEN OTHER                                               06120001
061300             MOVE '7010-LINK-AUDIT-MODULE'                        06130001
061400                                 TO DP013-PARAGRAPH               06140001
061500             MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'                06150001
061600                                 TO DP013-MESSAGE-TEXT (1)        06160001
061700             MOVE RC031-RETURN-DESC                               06170001
061800                                 TO DP013-MESSAGE-TEXT (2)        06180001
061900             MOVE RC031-SQLCA    TO DP013-SQLCA                   06190001
062000             SET DP013-DB2-ABEND                                  06200001
062100                 DP013-XCTL-DISPLAY-RESTART                       06210001
062200                                 TO TRUE                          06220001
062300             PERFORM DP013-0000-PROCESS-ABEND                     06230001
062400     END-EVALUATE.                                                06240001
062500/                                                                 06250001
062600*----------------------------------------------------------------*06260001
062700*    CHANGE THE CURRENT STATUS TO COMPLETE.                      *06270001
062800*----------------------------------------------------------------*06280001
062900 7020-UPDATE-TRECEIV.                                             06290001
063000     EXEC SQL                                                     06300001
063100          UPDATE TRECEIV                                          06310001
063200           SET   STATUS_CDE         =  :PC-CM                     06320001
063300                ,VER_STATUS_CDE     =  :PC-A                      06330001
063400                ,UPD_TMST           =  CURRENT TIMESTAMP          06340001
063500                ,UPD_UID            =  :DP020-USERID              06350001
063600                ,UPD_PGM_ID         =  :PC-CURRENT-PROGRAM-NAME   06360001
063700           WHERE ORD_NBR         =  :ASC-KEY-PO-NBR               06370001
063800             AND REC_SEQ_NBR     =  :ASC-KEY-RCVR-SEQ-NBR         06380001
063900             AND OPER_UNT_ID     =  :ASC-KEY-OPER-UNT-ID          06390001
064000             AND FCLTY_ID        =  :ASC-KEY-FCLTY-ID             06400001
064100             AND STATUS_CDE      =  :PC-IP                        06410001
064200             AND VER_STATUS_CDE  =  :PC-A                         06420001
064300     END-EXEC.                                                    06430001
064400                                                                  06440001
064500     EVALUATE TRUE                                                06450001
064600         WHEN SQLCODE = ZERO                                      06460001
064700         WHEN SQLCODE = +100                                      06470001
064800             CONTINUE                                             06480001
064900         WHEN SQLCODE = -904                                      06490001
065000         WHEN SQLCODE = -911                                      06500001
065100         WHEN SQLCODE = -913                                      06510001
065200              SET PS-UPDATES-DONE TO TRUE                         06520001
065300              PERFORM 9900-SOFT-ABORT                             06530001
065400         WHEN SQLWARN0 NOT = SPACE                                06540001
065500         WHEN SQLCODE NOT = ZERO                                  06550001
065600              MOVE '7020-UPDATE-TRECEIV'                          06560001
065700                                   TO DP013-PARAGRAPH             06570001
065800              MOVE 'UPDATE TRECEIV STATUS CODE'                   06580001
065900                                   TO DP013-MESSAGE-TEXT (1)      06590001
066000              MOVE SQLCA           TO DP013-SQLCA                 06600001
066100              MOVE 'TRECEIV '      TO DP013-DB2-TABLE-NAME (1)    06610001
066200              MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR           06620001
066300              MOVE ASC-KEY-RCVR-SEQ-NBR                           06630001
066400                                   TO PV-DISPLAY-RCVR-SEQ-NBR     06640001
066500              STRING 'PO = '                                      06650001
066600                     PV-DISPLAY-PO-NBR                            06660001
066700                     ' RECV = '                                   06670001
066800                     PV-DISPLAY-RCVR-SEQ-NBR                      06680001
066900                     DELIMITED BY SIZE                            06690001
067000                                 INTO DP013-MESSAGE-TEXT (2)      06700001
067100              MOVE ASC-KEY-OPER-UNT-ID                            06710001
067200                                   TO PV-DISPLAY-OPER-UNT-ID      06720001
067300              MOVE ASC-KEY-FCLTY-ID                               06730001
067400                                   TO PV-DISPLAY-FCLTY-ID         06740001
067500              STRING 'OPER = '                                    06750001
067600                     PV-DISPLAY-OPER-UNT-ID                       06760001
067700                     ' FCLTY = '                                  06770001
067800                     PV-DISPLAY-FCLTY-ID                          06780001
067900                     DELIMITED BY SIZE                            06790001
068000                                 INTO DP013-MESSAGE-TEXT (3)      06800001
068100              SET DP013-DB2-ABEND  TO TRUE                        06810001
068200              PERFORM DP013-0000-PROCESS-ABEND                    06820001
068300     END-EVALUATE.                                                06830001
068400*                                                                 06840001
068500*                                                                 06850001
068600*----------------------------------------------------------------*06860001
068700*----------------------------------------------------------------*06870001
068800 7030-SEL-PKSLIP-TRIP.                                            06880001
068900                                                                  06890001
069000     EXEC SQL                                                     06900001
069100          SELECT DISTINCT                                         06910001
069200                 C.TRIP_ID                                        06920001
069300               , D.PKSL_STAT_CDE                                  06930001
069400          INTO  :SHIPMT-TRIP-ID                                   06940001
069500               ,:PKSLIP-PKSL-STAT-CDE                             06950001
069600          FROM  TRECEIV A                                         06960001
069700               ,TSHPTPO B                                         06970001
069800               ,TSHIPMT C                                         06980001
069900               ,TPKSLIP D                                         06990001
070000          WHERE A.ORD_NBR        =  :ASC-KEY-PO-NBR               07000001
070100            AND A.REC_SEQ_NBR    =  :ASC-KEY-RCVR-SEQ-NBR         07010001
070200            AND VER_STATUS_CDE   =  :PC-A                         07020001
070300            AND A.ORD_NBR        =  B.PO_NBR                      07030001
070400            AND A.REC_SEQ_NBR    =  B.REC_SEQ_NBR                 07040001
070500            AND B.SHIPT_ID       =  C.SHIPT_ID                    07050001
070600            AND B.PRIM_SHIPT_IND =  'Y'                           07060001
070700            AND B.PO_NBR         =  D.PO_NBR                      07070001
070800            AND B.REC_SEQ_NBR    =  D.REC_SEQ_NBR                 07080001
070900            AND D.VER_STAT_CDE   =  'A'                           07090001
071000     END-EXEC.                                                    07100001
071100                                                                  07110001
071200     EVALUATE TRUE                                                07120001
071300         WHEN SQLCODE = ZERO                                      07130001
071400         WHEN SQLCODE = +100                                      07140001
071500             CONTINUE                                             07150001
071600         WHEN SQLCODE = -811                                      07160001
071700             MOVE 'AC' TO PKSLIP-PKSL-STAT-CDE                    07170001
071800         WHEN SQLCODE = -904                                      07180001
071900         WHEN SQLCODE = -911                                      07190001
072000         WHEN SQLCODE = -913                                      07200001
072100              SET PS-UPDATES-DONE TO TRUE                         07210001
072200              PERFORM 9900-SOFT-ABORT                             07220001
072300         WHEN SQLWARN0 NOT = SPACE                                07230001
072400         WHEN SQLCODE NOT = ZERO                                  07240001
072500              MOVE '7030-SEL-PKSLIP-TRIP'                         07250001
072600                                   TO DP013-PARAGRAPH             07260001
072700              MOVE 'SELECT PKSLIP STAT AND TRIP'                  07270001
072800                                   TO DP013-MESSAGE-TEXT (1)      07280001
072900              MOVE SQLCA           TO DP013-SQLCA                 07290001
073000              MOVE 'TPKSLIP '      TO DP013-DB2-TABLE-NAME (1)    07300001
073100              MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR           07310001
073200              MOVE ASC-KEY-RCVR-SEQ-NBR                           07320001
073300                                   TO PV-DISPLAY-RCVR-SEQ-NBR     07330001
073400              STRING 'PO = '                                      07340001
073500                     PV-DISPLAY-PO-NBR                            07350001
073600                     ' RECV = '                                   07360001
073700                     PV-DISPLAY-RCVR-SEQ-NBR                      07370001
073800                     DELIMITED BY SIZE                            07380001
073900                                 INTO DP013-MESSAGE-TEXT (2)      07390001
074000              MOVE ASC-KEY-OPER-UNT-ID                            07400001
074100                                   TO PV-DISPLAY-OPER-UNT-ID      07410001
074200              MOVE ASC-KEY-FCLTY-ID                               07420001
074300                                   TO PV-DISPLAY-FCLTY-ID         07430001
074400              STRING 'OPER = '                                    07440001
074500                     PV-DISPLAY-OPER-UNT-ID                       07450001
074600                     ' FCLTY = '                                  07460001
074700                     PV-DISPLAY-FCLTY-ID                          07470001
074800                     DELIMITED BY SIZE                            07480001
074900                                 INTO DP013-MESSAGE-TEXT (3)      07490001
075000              SET DP013-DB2-ABEND  TO TRUE                        07500001
075100              PERFORM DP013-0000-PROCESS-ABEND                    07510001
075200     END-EVALUATE.                                                07520001
075300*                                                                 07530001
075400*                                                                 07540001
075500*----------------------------------------------------------------*07550001
075600 7040-SEL-TRSTYP-PRTY-CDE.                                        07560001
075700                                                                  07570001
075800     EXEC SQL                                                     07580001
075900          SELECT C.PRTY_CDE                                       07590001
076000          INTO  :TRSTYP-PRTY-CDE                                  07600001
076100          FROM  TTRIPST B                                         07610001
076200               ,TTRSTYP C                                         07620001
076300          WHERE B.TRIP_ID         =  :SHIPMT-TRIP-ID              07630001
076400            AND B.TRIP_STATUS_CDE =  C.TRIP_STATUS_CDE            07640001
076500            AND TIMESTAMP(B.STATUS_DTE, B.STATUS_TME) IN          07650001
076600                (SELECT MAX(TIMESTAMP(A.STATUS_DTE, A.STATUS_TME))07660001
076700                    FROM  TTRIPST A                               07670001
076800                  WHERE A.TRIP_ID = B.TRIP_ID)                    07680001
076900     END-EXEC.                                                    07690001
077000                                                                  07700001
077100     EVALUATE TRUE                                                07710001
077200         WHEN SQLCODE = ZERO                                      07720001
077300         WHEN SQLCODE = +100                                      07730001
077400             CONTINUE                                             07740001
077500         WHEN SQLCODE = -904                                      07750001
077600         WHEN SQLCODE = -911                                      07760001
077700         WHEN SQLCODE = -913                                      07770001
077800              SET PS-UPDATES-DONE TO TRUE                         07780001
077900              PERFORM 9900-SOFT-ABORT                             07790001
078000         WHEN SQLWARN0 NOT = SPACE                                07800001
078100         WHEN SQLCODE NOT = ZERO                                  07810001
078200              MOVE '7040-SEL-TRSTYP-PRTY-CDE'                     07820001
078300                                   TO DP013-PARAGRAPH             07830001
078400              MOVE 'SELECT PRTY CODE -TTRSTYP  '                  07840001
078500                                   TO DP013-MESSAGE-TEXT (1)      07850001
078600              MOVE SQLCA           TO DP013-SQLCA                 07860001
078700              MOVE 'TTRIPST '      TO DP013-DB2-TABLE-NAME (1)    07870001
078800              MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR           07880001
078900              MOVE ASC-KEY-RCVR-SEQ-NBR                           07890001
079000                                   TO PV-DISPLAY-RCVR-SEQ-NBR     07900001
079100              MOVE SHIPMT-TRIP-ID                                 07910001
079200                                   TO PV-DISPLAY-TRIP-ID          07920001
079300              STRING 'PO = '                                      07930001
079400                     PV-DISPLAY-PO-NBR                            07940001
079500                     ' RECV = '                                   07950001
079600                     PV-DISPLAY-RCVR-SEQ-NBR                      07960001
079700                     DELIMITED BY SIZE                            07970001
079800                                 INTO DP013-MESSAGE-TEXT (2)      07980001
079900              STRING 'TRIP = '                                    07990001
080000                     PV-DISPLAY-TRIP-ID                           08000001
080100                     DELIMITED BY SIZE                            08010001
080200                                 INTO DP013-MESSAGE-TEXT (3)      08020001
080300              SET DP013-DB2-ABEND  TO TRUE                        08030001
080400              PERFORM DP013-0000-PROCESS-ABEND                    08040001
080500     END-EVALUATE.                                                08050001
080600*                                                                 08060001
080700*                                                                 08070001
080800 7060-PROCESS-AUTOVE-COMPLETE.                                    08080001
080900*                                                                 08090001
081000     IF TRSTYP-PRTY-CDE >= 70                                     08100001
081100        PERFORM 7065-CALL-RCKUT127-AUTOVE-MOD                     08110001
081200        IF RC040-AUTO-VE-YES                                      08120001
081300           IF PKSLIP-PKSL-STAT-CDE = 'AC'                         08130001
081310              PERFORM 7072-CHECK-WMOS-DC                          08131001
081400              IF (RECEIV-PACK-BY-ST-IND = 'Y') OR PS-WMOS-RCVR-YES08140001
081500                 PERFORM 7070-VEM-MODULE                          08150001
081600                 IF RC038-VERIFY-YES                              08160001
081610                    IF PS-WMOS-RCVR-YES                           08161001
081611                       PERFORM 7077-START-VERIFY-MOD-WM           08161101
081620                    ELSE                                          08162001
081700                       PERFORM 7075-START-VERIFY-MODULE           08170001
081710                    END-IF                                        08171001
081800                 ELSE                                             08180001
081900                    IF RC038-OPEN-SYSTEM-AUDIT                    08190001
082000                       PERFORM 7080-CALL-ADJUST-SYST-AUDIT        08200001
082100                    END-IF                                        08210001
082200                 END-IF                                           08220001
082300              ELSE                                                08230001
082400                 PERFORM 7090-RCKUT136-CONFIRM-RCVR               08240001
082500              END-IF                                              08250001
082600           ELSE                                                   08260001
082700              MOVE PC-TSYMSG-03241  TO DP020-MSG-MESSAGE          08270001
082800              SET PS-ERROR          TO TRUE                       08280001
082900           END-IF                                                 08290001
083000        END-IF                                                    08300001
083100     END-IF.                                                      08310001
083200                                                                  08320001
083300 7065-CALL-RCKUT127-AUTOVE-MOD.                                   08330001
083400                                                                  08340001
083500     INITIALIZE RC040-FIELDS.                                     08350001
083600     MOVE ASC-KEY-PO-NBR           TO RC040-PO-NBR                08360001
083700     MOVE ASC-KEY-RCVR-SEQ-NBR     TO RC040-PO-RCVR               08370001
083800                                                                  08380001
083900     SET RC040-RCVR-EXISTS         TO TRUE                        08390001
084000                                                                  08400001
084100     MOVE ASC-KEY-OPER-UNT-ID      TO RC040-SIGNON-LOCATION.      08410001
084200                                                                  08420001
084300     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  08430001
084400                                        RC040-COMMAREA            08440001
084500                                        RC040-FIELDS.             08450001
084600                                                                  08460001
084700     EVALUATE TRUE                                                08470001
084800         WHEN RC040-SUCCESSFUL                                    08480001
084900             CONTINUE                                             08490001
085000         WHEN OTHER                                               08500001
085100              MOVE '7065-CALL-RCKUT127-AUTOVE-MOD'                08510001
085200                                   TO DP013-PARAGRAPH             08520001
085300              MOVE 'CALL RCKUT127 AUTOVE MOD  '                   08530001
085400                                   TO DP013-MESSAGE-TEXT (1)      08540001
085500              MOVE RC040-SQLCA     TO DP013-SQLCA                 08550001
085600              MOVE 'TKRPRPM '      TO DP013-DB2-TABLE-NAME (1)    08560001
085700              MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR           08570001
085800              MOVE ASC-KEY-RCVR-SEQ-NBR                           08580001
085900                                   TO PV-DISPLAY-RCVR-SEQ-NBR     08590001
086000              STRING 'PO = '                                      08600001
086100                     PV-DISPLAY-PO-NBR                            08610001
086200                     ' RECV = '                                   08620001
086300                     PV-DISPLAY-RCVR-SEQ-NBR                      08630001
086400                     DELIMITED BY SIZE                            08640001
086500                                 INTO DP013-MESSAGE-TEXT (2)      08650001
086600              MOVE RC040-CRA-RET-MSG                              08660001
086700                                   TO DP013-MESSAGE-TEXT (3)      08670001
086800              SET DP013-DB2-ABEND  TO TRUE                        08680001
086900              PERFORM DP013-0000-PROCESS-ABEND                    08690001
087000     END-EVALUATE.                                                08700001
087100                                                                  08710001
087200 7070-VEM-MODULE.                                                 08720001
087300                                                                  08730001
087400     INITIALIZE RC038-FIELDS.                                     08740001
087500     MOVE ASC-KEY-PO-NBR            TO RC038-PO-NBR               08750001
087600     MOVE ASC-KEY-RCVR-SEQ-NBR      TO RC038-REC-SEQ-NBR          08760001
087700     MOVE 0                         TO RC038-PO-LNE-NBR           08770001
087800     MOVE 0                         TO RC038-PREPACK-ID           08780001
087900     MOVE ASC-KEY-OPER-UNT-ID       TO RC038-OPER-UNT-ID          08790001
088000                                       RC038-RCVR-OPER-UNT-ID     08800001
088100     MOVE ASC-KEY-FCLTY-ID          TO RC038-FCLTY-ID             08810001
088200     MOVE RECEIV-PKGNG-CDE          TO RC038-PKGNG-CDE            08820001
088300     MOVE RECEIV-PACK-BY-ST-IND     TO RC038-PBS-IND              08830001
088400     MOVE DP020-USERID              TO RC038-USER-ID              08840001
088500     MOVE PC-CURRENT-PROGRAM-NAME   TO RC038-PROGRAM-NAME         08850001
088600     SET  RC038-VERIFY-YES          TO TRUE                       08860001
088601                                                                  08860104
088602     IF PS-WMOS-RCVR-YES                                          08860204
088610        SET RC038-PBS TO TRUE                                     08861004
088620*           RC038-PROCESS-NO-UPDATE TO TRUE                       08862004
088700     END-IF                                                       08870004
088710                                                                  08871004
088800     MOVE RC040-AUTO-VE-SW          TO RC038-AUTOVE-PO-SW.        08880001
088900                                                                  08890001
089000     MOVE LENGTH OF RC038-FIELDS         TO PV-COMMAREA-LENGTH.   08900001
089100                                                                  08910001
089200     EXEC CICS                                                    08920001
089300         LINK PROGRAM  (PC-VERIF-ELIGIBILITY-PGM)                 08930001
089400              COMMAREA (RC038-FIELDS)                             08940001
089500              LENGTH   (PV-COMMAREA-LENGTH)                       08950001
089600              RESP     (PV-CICS-RESPONSE)                         08960001
089700     END-EXEC.                                                    08970001
089800                                                                  08980001
089900     EVALUATE TRUE                                                08990001
090000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09000001
090100             IF  RC038-INVALID-SQL     OR                         09010001
090200                 RC038-DATABASE-BUSY                              09020001
090300                 MOVE '7070-VEM-MODULE  '                         09030001
090400                                      TO DP013-PARAGRAPH          09040001
090500                 MOVE 'CALL RCKUT124 VER-ELIG (VEM)'              09050001
090600                                      TO DP013-MESSAGE-TEXT (1)   09060001
090700                 MOVE RC038-SQLCA     TO DP013-SQLCA              09070001
090800                 MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR        09080001
090900                 MOVE ASC-KEY-RCVR-SEQ-NBR                        09090001
091000                                      TO PV-DISPLAY-RCVR-SEQ-NBR  09100001
091100                 STRING 'PO = '                                   09110001
091200                        PV-DISPLAY-PO-NBR                         09120001
091300                        ' RECV = '                                09130001
091400                        PV-DISPLAY-RCVR-SEQ-NBR                   09140001
091500                        DELIMITED BY SIZE                         09150001
091600                                    INTO DP013-MESSAGE-TEXT (2)   09160001
091700                 MOVE RC038-CRA-RET-MSG                           09170001
091800                                      TO DP013-MESSAGE-TEXT (3)   09180001
091900                 SET DP013-DB2-ABEND  TO TRUE                     09190001
092000                 PERFORM DP013-0000-PROCESS-ABEND                 09200001
092100                                                                  09210001
092200             END-IF                                               09220001
092300         WHEN OTHER                                               09230001
092400              MOVE '7070-VEM-MODULE  '                            09240001
092500                                   TO DP013-PARAGRAPH             09250001
092600              MOVE 'CALL RCKUT124 VER-ELIG (VEM)'                 09260001
092700                                   TO DP013-MESSAGE-TEXT (1)      09270001
092800              MOVE RC038-SQLCA     TO DP013-SQLCA                 09280001
092900              MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR           09290001
093000              MOVE ASC-KEY-RCVR-SEQ-NBR                           09300001
093100                                   TO PV-DISPLAY-RCVR-SEQ-NBR     09310001
093200              STRING 'PO = '                                      09320001
093300                     PV-DISPLAY-PO-NBR                            09330001
093400                     ' RECV = '                                   09340001
093500                     PV-DISPLAY-RCVR-SEQ-NBR                      09350001
093600                     DELIMITED BY SIZE                            09360001
093700                                 INTO DP013-MESSAGE-TEXT (2)      09370001
093800              MOVE RC038-CRA-RET-MSG                              09380001
093900                                   TO DP013-MESSAGE-TEXT (3)      09390001
094000              SET DP013-DB2-ABEND  TO TRUE                        09400001
094100              PERFORM DP013-0000-PROCESS-ABEND                    09410001
094200     END-EVALUATE.                                                09420001
094210******************************************************************09421001
094220*    CHECK TO DETERMINE IF THE CURRENT OPER ON THE DC IS         *09422001
094230*    PROCESSING USING WMOS  (VERIFICATION FOR A WMOS DC IS       *09423001
094240*    WSKCS313)                                                    09424001
094250******************************************************************09425001
094260 7072-CHECK-WMOS-DC.                                              09426001
094293                                                                  09429301
094294     MOVE RECEIV-CURR-OPER-UNT-ID  TO KRPRPM-LOC-ID.              09429401
094295                                                                  09429501
094296     EXEC SQL                                                     09429601
094297       SELECT FUNC_TXT                                            09429701
094298         INTO :KRPRPM-FUNC-TXT                                    09429801
094299         FROM TKRPRPM                                             09429901
094300        WHERE LOC_ID             =  :KRPRPM-LOC-ID                09430001
094301          AND INTFC_SYS_CDE      =  'KHL'                         09430101
094302          AND FUNC_PRC_STAT_CDE  =  'AC'                          09430201
094303          AND SYS_PRC_FUNC_CDE   =  'WMOSDC'                      09430301
094304          AND (CURRENT DATE                                       09430401
094305              BETWEEN DATE(FUNC_BEG_TMST) AND                     09430501
094306                      DATE(FUNC_END_TMST))                        09430601
094307     END-EXEC                                                     09430701
094308                                                                  09430801
094309     EVALUATE TRUE                                                09430901
094310        WHEN SQLCODE = ZERO                                       09431001
094311           MOVE KRPRPM-FUNC-TXT TO PS-WMOS-RCVR-FOUND-SW          09431101
094312        WHEN SQLCODE = +100                                       09431201
094313           SET PS-WMOS-RCVR-NO TO TRUE                            09431301
094314         WHEN SQLCODE = -904                                      09431401
094315         WHEN SQLCODE = -911                                      09431501
094316         WHEN SQLCODE = -913                                      09431601
094317              SET PS-UPDATES-DONE TO TRUE                         09431701
094318              PERFORM 9900-SOFT-ABORT                             09431801
094319         WHEN SQLWARN0 NOT = SPACE                                09431901
094320         WHEN SQLCODE NOT = ZERO                                  09432001
094321              MOVE '7072-CHECK-WMOS-DC '                          09432101
094322                                   TO DP013-PARAGRAPH             09432201
094323              MOVE 'SELECT TURNED ON WMOS PROCESS '               09432301
094324                                   TO DP013-MESSAGE-TEXT (1)      09432401
094325              MOVE SQLCA           TO DP013-SQLCA                 09432501
094326              MOVE 'TKRPRPM '      TO DP013-DB2-TABLE-NAME (1)    09432601
094327              MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR           09432701
094328              MOVE ASC-KEY-RCVR-SEQ-NBR                           09432801
094329                                   TO PV-DISPLAY-RCVR-SEQ-NBR     09432901
094330              STRING 'PO = '                                      09433001
094331                     PV-DISPLAY-PO-NBR                            09433101
094332                     ' RECV = '                                   09433201
094333                     PV-DISPLAY-RCVR-SEQ-NBR                      09433301
094334                     DELIMITED BY SIZE                            09433401
094335                                 INTO DP013-MESSAGE-TEXT (2)      09433501
094336              MOVE KRPRPM-LOC-ID                                  09433601
094337                                   TO PV-DISPLAY-OPER-UNT-ID      09433701
094338              MOVE ASC-KEY-FCLTY-ID                               09433801
094339                                   TO PV-DISPLAY-FCLTY-ID         09433901
094340              STRING 'OPER = '                                    09434001
094341                     PV-DISPLAY-OPER-UNT-ID                       09434101
094342                     ' FCLTY = '                                  09434201
094343                     PV-DISPLAY-FCLTY-ID                          09434301
094344                     DELIMITED BY SIZE                            09434401
094345                                 INTO DP013-MESSAGE-TEXT (3)      09434501
094346              SET DP013-DB2-ABEND  TO TRUE                        09434601
094347              PERFORM DP013-0000-PROCESS-ABEND                    09434701
094363     END-EVALUATE.                                                09436301
094370*----------------------------------------------------------------*09437001
094400 7075-START-VERIFY-MODULE.                                        09440001
094500     INITIALIZE RC289-COMMAREA-FOR-E200.                          09450001
094600                                                                  09460001
094700     MOVE ASC-KEY-PO-NBR         TO RC289-ORD-NBR.                09470001
094800     MOVE ASC-KEY-RCVR-SEQ-NBR   TO RC289-RCVR-SEQ-NBR.           09480001
094900     MOVE ASC-KEY-LINE-NBR       TO RC289-ORD-LNE-NBR.            09490001
095000     MOVE PC-CURRENT-PROGRAM-NAME TO RC289-CALLING-PROGRAM.       09500001
095100     MOVE DP020-USERID            TO RC289-USER-ID.               09510001
095200     SET RC289-VERIF-HOT-COMPLETE TO TRUE                         09520001
095300                                                                  09530001
095400     EXEC CICS                                                    09540001
095500          START TRANSID ('E200')                                  09550001
095600               FROM (RC289-COMMAREA-FOR-E200)                     09560001
095700     END-EXEC.                                                    09570001
095800                                                                  09580001
095810*----------------------------------------------------------------*09581001
095820 7077-START-VERIFY-MOD-WM.                                        09582001
095830     INITIALIZE RC289-COMMAREA-FOR-E200.                          09583001
095840                                                                  09584001
095850     MOVE ASC-KEY-PO-NBR         TO RC289-ORD-NBR.                09585001
095860     MOVE ASC-KEY-RCVR-SEQ-NBR   TO RC289-RCVR-SEQ-NBR.           09586001
095870     MOVE ASC-KEY-LINE-NBR       TO RC289-ORD-LNE-NBR.            09587001
095880     MOVE PC-CURRENT-PROGRAM-NAME TO RC289-CALLING-PROGRAM.       09588001
095890     MOVE DP020-USERID            TO RC289-USER-ID.               09589001
095891     SET RC289-VERIF-HOT-COMPLETE TO TRUE                         09589101
095892                                                                  09589201
095893     EXEC CICS                                                    09589301
095894          START TRANSID ('W313')                                  09589401
095895               FROM (RC289-COMMAREA-FOR-E200)                     09589501
095896     END-EXEC.                                                    09589601
095897                                                                  09589701
095900*----------------------------------------------------------------*09590001
096000*    CALL TO ADJUST SYSTEM AUDIT                                  09600001
096100*----------------------------------------------------------------*09610001
096200 7080-CALL-ADJUST-SYST-AUDIT.                                     09620001
096300                                                                  09630001
096400     INITIALIZE SU047-COMMAREA-REC.                               09640001
096500     MOVE ASC-KEY-PO-NBR            TO SU047-PO-NBR               09650001
096600                                       PV-DISPLAY-PO-NBR.         09660001
096700     MOVE ASC-KEY-RCVR-SEQ-NBR      TO SU047-REC-SEQ-NBR          09670001
096800                                       PV-DISPLAY-RCVR-SEQ-NBR.   09680001
096900     MOVE ASC-KEY-OPER-UNT-ID       TO SU047-OPER-UNT-ID.         09690001
097000     MOVE 1                         TO SU047-FCLTY-ID.            09700001
097100     SET  SU047-PBS                 TO TRUE                       09710001
097200     MOVE DP020-USERID              TO SU047-USER-ID              09720001
097300     MOVE SHIPMT-TRIP-ID            TO SU047-INBND-TRIP.          09730001
097400     MOVE PC-CURRENT-PROGRAM-NAME   TO SU047-CALLING-PROGRAM.     09740001
097500                                                                  09750001
097600     MOVE LENGTH OF SU047-COMMAREA-REC   TO PV-COMMAREA-LENGTH.   09760001
097700                                                                  09770001
097800     EXEC CICS                                                    09780001
097900         LINK PROGRAM  (SU047-MODULE-NAME)                        09790001
098000              COMMAREA (SU047-COMMAREA-REC)                       09800001
098100              LENGTH   (PV-COMMAREA-LENGTH)                       09810001
098200              RESP     (PV-CICS-RESPONSE)                         09820001
098300     END-EXEC.                                                    09830001
098400                                                                  09840001
098500     EVALUATE TRUE                                                09850001
098600         WHEN SU047-SUCCESSFUL                                    09860001
098700              CONTINUE                                            09870001
098800         WHEN SU047-DATABASE-BUSY OR                              09880001
098900              SU047-INVALID-SQL                                   09890001
099000                INITIALIZE  PV-CICS-MSG-AREA                      09900001
099100                STRING ' PCKCS161-7080-CALL'     DELIMITED BY SIZE09910001
099200                       ' PO:'                    DELIMITED BY SIZE09920001
099300                       PV-DISPLAY-PO-NBR         DELIMITED BY SIZE09930001
099400                       ' RCVR:'                  DELIMITED BY SIZE09940001
099500                       PV-DISPLAY-RCVR-SEQ-NBR   DELIMITED BY SIZE09950001
099600                       'ABEND-PARA:'             DELIMITED BY SIZE09960001
099700                       SU047-CRA-REQ-ID          DELIMITED BY SIZE09970001
099800                       'SQLCODE: '               DELIMITED BY SIZE09980001
099900                       SU047-SQLCODE             DELIMITED BY SIZE09990001
100000                                             INTO PV-CICS-MSG-AREA10000001
100100                MOVE LENGTH OF PV-CICS-MSG-AREA                   10010001
100200                       TO PV-COMMAREA-LENGTH                      10020001
100300                PERFORM 9999-WRITE-TO-CSSL                        10030001
100400                                                                  10040001
100500                MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER         10050001
100600                SET DP020-MSG-WARNING TO TRUE                     10060001
100700                SET DP030-OVERRIDE-GO TO TRUE                     10070001
100800                SET PS-ERROR          TO TRUE                     10080001
100900                                                                  10090001
101000         WHEN OTHER                                               10100001
101100              INITIALIZE  PV-CICS-MSG-AREA                        10110001
101200              STRING ' PCKCS161-7080-CALL'     DELIMITED BY SIZE  10120001
101300                     ' PO:'                    DELIMITED BY SIZE  10130001
101400                     PV-DISPLAY-PO-NBR         DELIMITED BY SIZE  10140001
101500                     ' RCVR:'                  DELIMITED BY SIZE  10150001
101600                     PV-DISPLAY-RCVR-SEQ-NBR   DELIMITED BY SIZE  10160001
101700                     'ABEND-PARA: '            DELIMITED BY SIZE  10170001
101800                     SU047-CRA-REQ-ID          DELIMITED BY SIZE  10180001
101900                     'SQLCODE: '               DELIMITED BY SIZE  10190001
102000                     SU047-SQLCODE             DELIMITED BY SIZE  10200001
102100                                           INTO PV-CICS-MSG-AREA  10210001
102200              MOVE LENGTH OF PV-CICS-MSG-AREA                     10220001
102300                     TO PV-COMMAREA-LENGTH                        10230001
102400              PERFORM 9999-WRITE-TO-CSSL                          10240001
102500                                                                  10250001
102600              MOVE '7080-CALL-ADJUST-SYST-AUDIT'                  10260001
102700                                   TO DP013-PARAGRAPH             10270001
102800              MOVE 'CALL SUKCS762 AUDIT ADJUST '                  10280001
102900                                   TO DP013-MESSAGE-TEXT (1)      10290001
103000              MOVE SU047-SQLCA     TO DP013-SQLCA                 10300001
103100              MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR           10310001
103200              MOVE ASC-KEY-RCVR-SEQ-NBR                           10320001
103300                                   TO PV-DISPLAY-RCVR-SEQ-NBR     10330001
103400              STRING 'PO = '                                      10340001
103500                     PV-DISPLAY-PO-NBR                            10350001
103600                     ' RECV = '                                   10360001
103700                     PV-DISPLAY-RCVR-SEQ-NBR                      10370001
103800                     DELIMITED BY SIZE                            10380001
103900                                 INTO DP013-MESSAGE-TEXT (2)      10390001
104000              MOVE SU047-CRA-RET-MSG                              10400001
104100                                   TO DP013-MESSAGE-TEXT (3)      10410001
104200              SET DP013-DB2-ABEND  TO TRUE                        10420001
104300              PERFORM DP013-0000-PROCESS-ABEND                    10430001
104400                                                                  10440001
104500     END-EVALUATE.                                                10450001
104600/                                                                 10460001
104700 7090-RCKUT136-CONFIRM-RCVR.                                      10470001
104800                                                                  10480001
104900     INITIALIZE RC041-FIELDS.                                     10490001
105000     MOVE ASC-KEY-PO-NBR            TO RC041-PO-NBR               10500001
105100     MOVE ASC-KEY-RCVR-SEQ-NBR      TO RC041-REC-SEQ-NBR          10510001
105200     MOVE ASC-KEY-OPER-UNT-ID       TO RC041-OPER-UNT-ID          10520001
105300     MOVE ASC-KEY-FCLTY-ID          TO RC041-FCLTY-ID             10530001
105400     MOVE RECEIV-PKGNG-CDE          TO RC041-PKGNG-CDE            10540001
105500     MOVE RECEIV-PACK-BY-ST-IND     TO RC041-PBS-IND              10550001
105600     MOVE DP020-USERID              TO RC041-USER-ID              10560001
105700     MOVE PC-CURRENT-PROGRAM-NAME   TO RC041-PROGRAM-NAME         10570001
105800     SET RC041-VERIFY-YES                                         10580001
105900         RC041-PROCESS-BY-RCVR      TO TRUE                       10590001
106000                                                                  10600001
106100     MOVE LENGTH OF RC041-FIELDS    TO PV-COMMAREA-LENGTH.        10610001
106200                                                                  10620001
106300     EXEC CICS                                                    10630001
106400         LINK PROGRAM  (PC-CONFIRM-BY-RECEIVER)                   10640001
106500              COMMAREA (RC041-FIELDS)                             10650001
106600              LENGTH   (PV-COMMAREA-LENGTH)                       10660001
106700              RESP     (PV-CICS-RESPONSE)                         10670001
106800     END-EXEC.                                                    10680001
106900                                                                  10690001
107000     EVALUATE TRUE                                                10700001
107100         WHEN RC041-SUCCESSFUL                                    10710001
107200                 CONTINUE                                         10720001
107300         WHEN OTHER                                               10730001
107400                 SET PS-ERROR   TO TRUE                           10740001
107500                 MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR        10750001
107600                 MOVE ASC-KEY-RCVR-SEQ-NBR                        10760001
107700                                      TO PV-DISPLAY-RCVR-SEQ-NBR  10770001
107800                                                                  10780001
107900                 STRING ' PCKCS161-7090-LINK'    DELIMITED BY SIZE10790001
108000                       ' PO:'                    DELIMITED BY SIZE10800001
108100                       PV-DISPLAY-PO-NBR         DELIMITED BY SIZE10810001
108200                       ' RCVR:'                  DELIMITED BY SIZE10820001
108300                       PV-DISPLAY-RCVR-SEQ-NBR   DELIMITED BY SIZE10830001
108400                       ' RC041-SUCCESS-IND: '    DELIMITED BY SIZE10840001
108500                       RC041-SUCCESS-IND         DELIMITED BY SIZE10850001
108600                                             INTO PV-CICS-MSG-AREA10860001
108700                 MOVE LENGTH OF PV-CICS-MSG-AREA                  10870001
108800                       TO PV-COMMAREA-LENGTH                      10880001
108900                 PERFORM 9999-WRITE-TO-CSSL                       10890001
109000                 MOVE RC041-CRA-RET-MSG        TO PV-CICS-MSG-AREA10900001
109100                 MOVE LENGTH OF PV-CICS-MSG-AREA                  10910001
109200                       TO PV-COMMAREA-LENGTH                      10920001
109300                 PERFORM 9999-WRITE-TO-CSSL                       10930001
109400     END-EVALUATE.                                                10940001
109500*----------------------------------------------------------------*10950001
109600* STATUS THE RECEIVER ITEMS WITH 'CM' IF THE STATUSES ARE 'IP'.  *10960001
109700*----------------------------------------------------------------*10970001
109800 7100-COMPLETE-RCVR-ITEMS.                                        10980001
109900     PERFORM 7110-OPEN-CURSOR.                                    10990001
110000                                                                  11000001
110100     SET PS-FETCHING-NOT-DONE      TO TRUE.                       11010001
110200     PERFORM                                                      11020001
110300         WITH TEST AFTER                                          11030001
110400         UNTIL PS-FETCHING-DONE                                   11040001
110500                                                                  11050001
110600         PERFORM 7130-FETCH-CURSOR                                11060001
110700                                                                  11070001
110800     END-PERFORM.                                                 11080001
110900                                                                  11090001
111000     PERFORM 7150-CLOSE-CURSOR.                                   11100001
111100*                                                                 11110001
111200*                                                                 11120001
111300*----------------------------------------------------------------*11130001
111400* OPEN THE CURSOR.                                               *11140001
111500*----------------------------------------------------------------*11150001
111600 7110-OPEN-CURSOR.                                                11160001
111700                                                                  11170001
111800         EXEC SQL                                                 11180001
111900              OPEN ITEM_CSR                                       11190001
112000         END-EXEC                                                 11200001
112100                                                                  11210001
112200         EVALUATE TRUE                                            11220001
112300             WHEN SQLCODE = ZERO                                  11230001
112400                  CONTINUE                                        11240001
112500             WHEN SQLCODE = -904                                  11250001
112600             WHEN SQLCODE = -911                                  11260001
112700             WHEN SQLCODE = -913                                  11270001
112800                  PERFORM 9900-SOFT-ABORT                         11280001
112900             WHEN SQLWARN0 NOT = SPACES                           11290001
113000             WHEN SQLCODE < ZERO                                  11300001
113100             WHEN SQLCODE > ZERO                                  11310001
113200                  MOVE '7110-OPEN-CURSOR'                         11320001
113300                                   TO DP013-PARAGRAPH             11330001
113400                  MOVE 'OPEN LINE CURSOR - '                      11340001
113500                                   TO DP013-MESSAGE-TEXT (1)      11350001
113600                  MOVE SQLCA       TO DP013-SQLCA                 11360001
113700                  MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)    11370001
113800                  MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR       11380001
113900                  MOVE ASC-KEY-RCVR-SEQ-NBR                       11390001
114000                                       TO PV-DISPLAY-RCVR-SEQ-NBR 11400001
114100                  STRING 'PO = '                                  11410001
114200                         PV-DISPLAY-PO-NBR                        11420001
114300                         ' RECV = '                               11430001
114400                         PV-DISPLAY-RCVR-SEQ-NBR                  11440001
114500                         DELIMITED BY SIZE                        11450001
114600                                     INTO DP013-MESSAGE-TEXT (2)  11460001
114700                  MOVE ASC-KEY-OPER-UNT-ID                        11470001
114800                                       TO PV-DISPLAY-OPER-UNT-ID  11480001
114900                  MOVE ASC-KEY-FCLTY-ID                           11490001
115000                                       TO PV-DISPLAY-FCLTY-ID     11500001
115100                  STRING 'OPER = '                                11510001
115200                         PV-DISPLAY-OPER-UNT-ID                   11520001
115300                         ' FCLTY = '                              11530001
115400                         PV-DISPLAY-FCLTY-ID                      11540001
115500                         DELIMITED BY SIZE                        11550001
115600                                     INTO DP013-MESSAGE-TEXT (3)  11560001
115700                  SET DP013-DB2-ABEND                             11570001
115800                      DP013-XCTL-DISPLAY-RESTART                  11580001
115900                                   TO TRUE                        11590001
116000                  PERFORM DP013-0000-PROCESS-ABEND                11600001
116100        END-EVALUATE.                                             11610001
116200*                                                                 11620001
116300*----------------------------------------------------------------*11630001
116400* FETCH  THE CURSOR.                                             *11640001
116500*----------------------------------------------------------------*11650001
116600 7130-FETCH-CURSOR.                                               11660001
116700     EXEC SQL                                                     11670001
116800          FETCH ITEM_CSR                                          11680001
116900           INTO :RECITM-ORD-NBR,                                  11690001
117000                :RECITM-ORD-LNE-NBR,                              11700001
117100                :RECITM-REC-SEQ-NBR,                              11710001
117200                :RECITM-OPER-UNT-ID,                              11720001
117300                :RECITM-FCLTY-ID,                                 11730001
117400                :RECITM-CRE-TMST,                                 11740001
117500                :RECITM-CRE-UID,                                  11750001
117600                :RECITM-PO-VER-NBR,                               11760001
117700                :RECITM-ITM-NBR,                                  11770001
117800                :RECITM-PRE-TKT-IND,                              11780001
117900                :RECITM-TKT-FMT-ID,                               11790001
118000                :RECITM-RTV-IND,                                  11800001
118100                :RECITM-STATUS-CDE,                               11810001
118200                :RECITM-VER-STATUS-CDE,                           11820001
118300                :RECITM-PKSL-ITM-QTY,                             11830001
118400                :RECITM-DTL-CK-ITM-QTY,                           11840001
118500                :RECITM-INNR-PACK-QTY,                            11850001
118600                :RECITM-CASE-PACK-QTY,                            11860001
118700                :RECITM-RTV-QTY,                                  11870001
118800                :RECITM-EXPTED-CART-CNT,                          11880001
118900                :RECITM-ACTL-CART-CNT,                            11890001
119000                :RECITM-MKING-APRON-TMST,                         11900001
119100                :RECITM-UNT-COST-AMT,                             11910001
119200                :RECITM-COLOR-DESC,                               11920001
119300                :RECITM-SIZE-DESC,                                11930001
119400                :RECITM-VEND-STYL-NAME,                           11940001
119500                :RECITM-VEND-DESC,                                11950001
119600                :RECITM-VERFYD-TMST,                              11960001
119700                :RECITM-PKSL-NBR,                                 11970001
119800                :RECITM-REC-INV-LNE-NBR,                          11980001
119900                :RECITM-DMG-ITM-QTY,                              11990001
120000                :RECITM-UPD-TMST,                                 12000001
120100                :RECITM-UPD-UID,                                  12010001
120200                :RECITM-UPD-PGM-ID,                               12020001
120300                :RECITM-RCPT-DISTR-UPD-CDE,                       12030001
120400                :RECITM-PREPK-ID                                  12040001
120500     END-EXEC.                                                    12050001
120600*                                                                 12060001
120700     EVALUATE TRUE                                                12070001
120800         WHEN SQLCODE = ZERO                                      12080001
120900              MOVE RECITM-ORD-LNE-NBR                             12090001
121000                                   TO TRBNTF-PO-LNE-NBR           12100001
121100                                      RECDIS-ORD-LNE-NBR          12110001
121200                                      WRKORD-ORD-LNE-NBR          12120001
121300                                      WKORIN-ORD-LNE-NBR          12130001
121400              MOVE RECITM-PREPK-ID TO ASC-KEY-PREPK-ID            12140001
121500              PERFORM 7500-CHECK-FOR-TROUBLE                      12150001
121600              IF  PS-TROUBLE-EXISTS-YES                           12160001
121700                  EVALUATE TRUE                                   12170001
121800                      WHEN PS-LINE-ERROR-BOTH                     12180001
121900                      WHEN PS-LINE-ERROR-TROUBLE                  12190001
122000                           CONTINUE                               12200001
122100                      WHEN PS-LINE-ERROR-NONE                     12210001
122200                           SET PS-LINE-ERROR-TROUBLE              12220001
122300                                   TO TRUE                        12230001
122400                      WHEN PS-LINE-ERROR-RECDIS                   12240001
122500                           SET PS-LINE-ERROR-BOTH                 12250001
122600                                   TO TRUE                        12260001
122700                  END-EVALUATE                                    12270001
122800              ELSE                                                12280001
122900                  PERFORM 7600-CHECK-RECDIS                       12290001
123000                  IF  PS-RECDIS-EXISTS-YES                        12300001
123100                      PERFORM 7200-COMPLETE-TWRKORD               12310001
123200                  ELSE                                            12320001
123300                      EVALUATE TRUE                               12330001
123400                          WHEN PS-LINE-ERROR-BOTH                 12340001
123500                          WHEN PS-LINE-ERROR-RECDIS               12350001
123600                               CONTINUE                           12360001
123700                          WHEN PS-LINE-ERROR-NONE                 12370001
123800                               SET PS-LINE-ERROR-RECDIS           12380001
123900                                   TO TRUE                        12390001
124000                          WHEN PS-LINE-ERROR-TROUBLE              12400001
124100                               SET PS-LINE-ERROR-BOTH             12410001
124200                                   TO TRUE                        12420001
124300                      END-EVALUATE                                12430001
124400                  END-IF                                          12440001
124500              END-IF                                              12450001
124600         WHEN SQLCODE = +100                                      12460001
124700              SET PS-FETCHING-DONE TO TRUE                        12470001
124800         WHEN SQLCODE = -904                                      12480001
124900         WHEN SQLCODE = -911                                      12490001
125000         WHEN SQLCODE = -913                                      12500001
125100              PERFORM 9900-SOFT-ABORT                             12510001
125200         WHEN SQLWARN0 NOT = SPACES                               12520001
125300         WHEN SQLCODE < ZERO                                      12530001
125400         WHEN SQLCODE > ZERO                                      12540001
125500              MOVE '7130-FETCH-CURSOR'                            12550001
125600                                   TO DP013-PARAGRAPH             12560001
125700              MOVE 'FETCH ITEM_CSR   - '                          12570001
125800                                   TO DP013-MESSAGE-TEXT (1)      12580001
125900              MOVE SQLCA           TO DP013-SQLCA                 12590001
126000              MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (1)    12600001
126100              MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR           12610001
126200              MOVE ASC-KEY-RCVR-SEQ-NBR                           12620001
126300                                   TO PV-DISPLAY-RCVR-SEQ-NBR     12630001
126400              STRING 'PO = '                                      12640001
126500                     PV-DISPLAY-PO-NBR                            12650001
126600                     ' RECV = '                                   12660001
126700                     PV-DISPLAY-RCVR-SEQ-NBR                      12670001
126800                     DELIMITED BY SIZE                            12680001
126900                                 INTO DP013-MESSAGE-TEXT (2)      12690001
127000              MOVE ASC-KEY-OPER-UNT-ID                            12700001
127100                                   TO PV-DISPLAY-OPER-UNT-ID      12710001
127200              MOVE ASC-KEY-FCLTY-ID                               12720001
127300                                   TO PV-DISPLAY-FCLTY-ID         12730001
127400              STRING 'OPER = '                                    12740001
127500                     PV-DISPLAY-OPER-UNT-ID                       12750001
127600                     ' FCLTY = '                                  12760001
127700                     PV-DISPLAY-FCLTY-ID                          12770001
127800                     DELIMITED BY SIZE                            12780001
127900                                 INTO DP013-MESSAGE-TEXT (3)      12790001
128000              SET DP013-DB2-ABEND                                 12800001
128100                  DP013-XCTL-DISPLAY-RESTART                      12810001
128200                                   TO TRUE                        12820001
128300              PERFORM DP013-0000-PROCESS-ABEND                    12830001
128400     END-EVALUATE.                                                12840001
128500*                                                                 12850001
128600*----------------------------------------------------------------*12860001
128700* CLOSE THE LINE CURSOR.                                         *12870001
128800*----------------------------------------------------------------*12880001
128900 7150-CLOSE-CURSOR.                                               12890001
129000     EXEC SQL                                                     12900001
129100          CLOSE ITEM_CSR                                          12910001
129200     END-EXEC.                                                    12920001
129300                                                                  12930001
129400     EVALUATE TRUE                                                12940001
129500         WHEN SQLCODE = ZERO                                      12950001
129600              CONTINUE                                            12960001
129700         WHEN SQLCODE = -904                                      12970001
129800         WHEN SQLCODE = -911                                      12980001
129900         WHEN SQLCODE = -913                                      12990001
130000              PERFORM 9900-SOFT-ABORT                             13000001
130100         WHEN SQLWARN0 NOT = SPACES                               13010001
130200         WHEN SQLCODE < ZERO                                      13020001
130300         WHEN SQLCODE > ZERO                                      13030001
130400              MOVE '7150-CLOSE-CURSOR'                            13040001
130500                                   TO DP013-PARAGRAPH             13050001
130600              MOVE 'CLOSE LINE CURSOR '                           13060001
130700                                   TO DP013-MESSAGE-TEXT (1)      13070001
130800              MOVE SQLCA           TO DP013-SQLCA                 13080001
130900              MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (1)    13090001
131000              MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR           13100001
131100              MOVE ASC-KEY-RCVR-SEQ-NBR                           13110001
131200                                   TO PV-DISPLAY-RCVR-SEQ-NBR     13120001
131300              STRING 'PO = '                                      13130001
131400                     PV-DISPLAY-PO-NBR                            13140001
131500                     ' RECV = '                                   13150001
131600                     PV-DISPLAY-RCVR-SEQ-NBR                      13160001
131700                     DELIMITED BY SIZE                            13170001
131800                                 INTO DP013-MESSAGE-TEXT (2)      13180001
131900              MOVE ASC-KEY-OPER-UNT-ID                            13190001
132000                                   TO PV-DISPLAY-OPER-UNT-ID      13200001
132100              MOVE ASC-KEY-FCLTY-ID                               13210001
132200                                   TO PV-DISPLAY-FCLTY-ID         13220001
132300              STRING 'OPER = '                                    13230001
132400                     PV-DISPLAY-OPER-UNT-ID                       13240001
132500                     ' FCLTY = '                                  13250001
132600                     PV-DISPLAY-FCLTY-ID                          13260001
132700                     DELIMITED BY SIZE                            13270001
132800                                 INTO DP013-MESSAGE-TEXT (3)      13280001
132900              SET DP013-DB2-ABEND                                 13290001
133000                  DP013-XCTL-DISPLAY-RESTART                      13300001
133100                                   TO TRUE                        13310001
133200              PERFORM DP013-0000-PROCESS-ABEND                    13320001
133300     END-EVALUATE.                                                13330001
133400*                                                                 13340001
133500*                                                                 13350001
133600*----------------------------------------------------------------*13360001
133700*    SET THE STATUS CODE TO 'COMPLETE' ON TWRKORD.               *13370001
133800*----------------------------------------------------------------*13380001
133900 7200-COMPLETE-TWRKORD.                                           13390001
134000     EXEC SQL                                                     13400001
134100          UPDATE TWRKORD                                          13410001
134200             SET STAT_CDE        =  :PC-CM                        13420001
134300           WHERE ORD_NBR         =  :ASC-KEY-PO-NBR               13430001
134400             AND RCVR_SEQ_NBR    =  :ASC-KEY-RCVR-SEQ-NBR         13440001
134500             AND ORD_LNE_NBR     =  :WRKORD-ORD-LNE-NBR           13450001
134600* 11/17      AND OPER_UNT_ID     =  :ASC-KEY-OPER-UNT-ID          13460006
134700* 11/17      AND FCLTY_ID        =  :ASC-KEY-FCLTY-ID             13470006
134800             AND VER_STATUS_CDE  =  :PC-A                         13480001
134900             AND STAT_CDE        =  :PC-IP                        13490001
135000     END-EXEC.                                                    13500001
135100*                                                                 13510001
135200     EVALUATE TRUE                                                13520001
135300         WHEN SQLCODE = ZERO                                      13530001
135400              PERFORM 7300-PROCESS-TWKORIN-START                  13540001
135500              PERFORM 7400-PROCESS-TWKORIN-STOP                   13550001
135600         WHEN SQLCODE = +100                                      13560001
135700              CONTINUE                                            13570001
135800         WHEN SQLCODE = -904                                      13580001
135900         WHEN SQLCODE = -911                                      13590001
136000         WHEN SQLCODE = -913                                      13600001
136100              SET PS-UPDATES-DONE TO TRUE                         13610001
136200              PERFORM 9900-SOFT-ABORT                             13620001
136300         WHEN SQLWARN0 NOT = SPACE                                13630001
136400         WHEN SQLCODE < ZERO                                      13640001
136500         WHEN SQLCODE > ZERO                                      13650001
136600              MOVE '7200-COMPLETE-TWRKORD'                        13660001
136700                                   TO DP013-PARAGRAPH             13670001
136800              MOVE 'UPDATE TWRKORD STATUS CODE'                   13680001
136900                                   TO DP013-MESSAGE-TEXT (1)      13690001
137000              MOVE SQLCA           TO DP013-SQLCA                 13700001
137100              MOVE 'TWRKORD '      TO DP013-DB2-TABLE-NAME (1)    13710001
137200              MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR           13720001
137300              MOVE ASC-KEY-RCVR-SEQ-NBR                           13730001
137400                                   TO PV-DISPLAY-RCVR-SEQ-NBR     13740001
137500              STRING 'PO = '                                      13750001
137600                     PV-DISPLAY-PO-NBR                            13760001
137700                     ' RECV = '                                   13770001
137800                     PV-DISPLAY-RCVR-SEQ-NBR                      13780001
137900                     DELIMITED BY SIZE                            13790001
138000                                 INTO DP013-MESSAGE-TEXT (2)      13800001
138100              MOVE WRKORD-ORD-LNE-NBR                             13810001
138200                                   TO PV-DISPLAY-LNE-NBR          13820001
138300              MOVE ASC-KEY-OPER-UNT-ID                            13830001
138400                                   TO PV-DISPLAY-OPER-UNT-ID      13840001
138500              MOVE ASC-KEY-FCLTY-ID                               13850001
138600                                   TO PV-DISPLAY-FCLTY-ID         13860001
138700              STRING 'LINE = '                                    13870001
138800                     PV-DISPLAY-LNE-NBR                           13880001
138900                     'OPER = '                                    13890001
139000                     PV-DISPLAY-OPER-UNT-ID                       13900001
139100                     ' FCLTY = '                                  13910001
139200                     PV-DISPLAY-FCLTY-ID                          13920001
139300                     DELIMITED BY SIZE                            13930001
139400                                 INTO DP013-MESSAGE-TEXT (3)      13940001
139500              SET DP013-DB2-ABEND  TO TRUE                        13950001
139600              PERFORM DP013-0000-PROCESS-ABEND                    13960001
139700     END-EVALUATE.                                                13970001
139800*                                                                 13980001
139900*                                                                 13990001
140000*----------------------------------------------------------------*14000001
140100*    SET THE START AND STOP TIMESTAMP TO THE CURRENT DATE/TIME   *14010001
140200*    ON TWKORIN.  THE LIST BELOW SHOWS THE START AND STOP TIME-  *14020001
140300*    STAMP COMBINATIONS AND THE ACTION THAT SHOULD BE DONE FOR   *14030001
140400*    EACH:                                                       *14040001
140500*        START        STOP         RESULTS                       *14050001
140600*        -----        ----         -------                       *14060001
140700*        DATE         DATE         DON'T UPDATE ANYTHING         *14070001
140800*        DATE         DEFAULT      UPDATE STOP                   *14080001
140900*        DEFAULT      DEFAULT      UPDATE BOTH START AND STOP    *14090001
141000*        DEFAULT      DATE         INVALID COMBINATION           *14100001
141100*----------------------------------------------------------------*14110001
141200 7300-PROCESS-TWKORIN-START.                                      14120001
141300     EXEC SQL                                                     14130001
141400          UPDATE TWKORIN                                          14140001
141500             SET STRT_TMST       =  CURRENT TIMESTAMP,            14150001
141600                 STOP_TMST       =  CURRENT TIMESTAMP             14160001
141700           WHERE ORD_NBR         =  :ASC-KEY-PO-NBR               14170001
141800             AND RCVR_SEQ_NBR    =  :ASC-KEY-RCVR-SEQ-NBR         14180001
141900             AND ORD_LNE_NBR     =  :WKORIN-ORD-LNE-NBR           14190001
142000* 11/17      AND OPER_UNT_ID     =  :ASC-KEY-OPER-UNT-ID          14200005
142100* 11/17      AND FCLTY_ID        =  :ASC-KEY-FCLTY-ID             14210005
142200             AND VER_STATUS_CDE  =  :PC-A                         14220001
142300             AND STRT_TMST       >  CURRENT TIMESTAMP             14230001
142400     END-EXEC.                                                    14240001
142500*                                                                 14250001
142600     EVALUATE TRUE                                                14260001
142700         WHEN SQLCODE = ZERO                                      14270001
142800         WHEN SQLCODE = +100                                      14280001
142900              CONTINUE                                            14290001
143000         WHEN SQLCODE = -904                                      14300001
143100         WHEN SQLCODE = -911                                      14310001
143200         WHEN SQLCODE = -913                                      14320001
143300              SET PS-UPDATES-DONE TO TRUE                         14330001
143400              PERFORM 9900-SOFT-ABORT                             14340001
143500         WHEN SQLWARN0 NOT = SPACE                                14350001
143600         WHEN SQLCODE < ZERO                                      14360001
143700         WHEN SQLCODE > ZERO                                      14370001
143800              MOVE '7300-COMPLETE-TWRKORD'                        14380001
143900                                   TO DP013-PARAGRAPH             14390001
144000              MOVE 'UPDATE TWKORIN START TIMESTAMP'               14400001
144100                                   TO DP013-MESSAGE-TEXT (1)      14410001
144200              MOVE SQLCA           TO DP013-SQLCA                 14420001
144300              MOVE 'TWKORIN '      TO DP013-DB2-TABLE-NAME (1)    14430001
144400              MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR           14440001
144500              MOVE ASC-KEY-RCVR-SEQ-NBR                           14450001
144600                                   TO PV-DISPLAY-RCVR-SEQ-NBR     14460001
144700              STRING 'PO = '                                      14470001
144800                     PV-DISPLAY-PO-NBR                            14480001
144900                     ' RECV = '                                   14490001
145000                     PV-DISPLAY-RCVR-SEQ-NBR                      14500001
145100                     DELIMITED BY SIZE                            14510001
145200                                 INTO DP013-MESSAGE-TEXT (2)      14520001
145300              MOVE WKORIN-ORD-LNE-NBR                             14530001
145400                                   TO PV-DISPLAY-LNE-NBR          14540001
145500              MOVE ASC-KEY-OPER-UNT-ID                            14550001
145600                                   TO PV-DISPLAY-OPER-UNT-ID      14560001
145700              MOVE ASC-KEY-FCLTY-ID                               14570001
145800                                   TO PV-DISPLAY-FCLTY-ID         14580001
145900              STRING 'LINE = '                                    14590001
146000                     PV-DISPLAY-LNE-NBR                           14600001
146100                     'OPER = '                                    14610001
146200                     PV-DISPLAY-OPER-UNT-ID                       14620001
146300                     ' FCLTY = '                                  14630001
146400                     PV-DISPLAY-FCLTY-ID                          14640001
146500                     DELIMITED BY SIZE                            14650001
146600                                 INTO DP013-MESSAGE-TEXT (3)      14660001
146700              SET DP013-DB2-ABEND  TO TRUE                        14670001
146800              PERFORM DP013-0000-PROCESS-ABEND                    14680001
146900     END-EVALUATE.                                                14690001
147000*                                                                 14700001
147100*                                                                 14710001
147200*----------------------------------------------------------------*14720001
147300*    SET THE STOP TIMESTAMP TO THE CURRENT DATE/TIME ON TWKORIN  *14730001
147400*----------------------------------------------------------------*14740001
147500 7400-PROCESS-TWKORIN-STOP.                                       14750001
147600     EXEC SQL                                                     14760001
147700          UPDATE TWKORIN                                          14770001
147800             SET STOP_TMST       =  CURRENT TIMESTAMP             14780001
147900           WHERE ORD_NBR         =  :ASC-KEY-PO-NBR               14790001
148000             AND RCVR_SEQ_NBR    =  :ASC-KEY-RCVR-SEQ-NBR         14800001
148100             AND ORD_LNE_NBR     =  :WKORIN-ORD-LNE-NBR           14810001
148200* 11/17      AND OPER_UNT_ID     =  :ASC-KEY-OPER-UNT-ID          14820005
148300* 11/17      AND FCLTY_ID        =  :ASC-KEY-FCLTY-ID             14830005
148400             AND VER_STATUS_CDE  =  :PC-A                         14840001
148500             AND STOP_TMST       >  CURRENT TIMESTAMP             14850001
148600     END-EXEC.                                                    14860001
148700*                                                                 14870001
148800     EVALUATE TRUE                                                14880001
148900         WHEN SQLCODE = ZERO                                      14890001
149000         WHEN SQLCODE = +100                                      14900001
149100              CONTINUE                                            14910001
149200         WHEN SQLCODE = -904                                      14920001
149300         WHEN SQLCODE = -911                                      14930001
149400         WHEN SQLCODE = -913                                      14940001
149500              SET PS-UPDATES-DONE TO TRUE                         14950001
149600              PERFORM 9900-SOFT-ABORT                             14960001
149700         WHEN SQLWARN0 NOT = SPACE                                14970001
149800         WHEN SQLCODE < ZERO                                      14980001
149900         WHEN SQLCODE > ZERO                                      14990001
150000              MOVE '7400-PROCESS-TWKORIN-STOP'                    15000001
150100                                   TO DP013-PARAGRAPH             15010001
150200              MOVE 'UPDATE TWKORIN STOP TIMESTAMP'                15020001
150300                                   TO DP013-MESSAGE-TEXT (1)      15030001
150400              MOVE SQLCA           TO DP013-SQLCA                 15040001
150500              MOVE 'TWKORIN '      TO DP013-DB2-TABLE-NAME (1)    15050001
150600              MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR           15060001
150700              MOVE ASC-KEY-RCVR-SEQ-NBR                           15070001
150800                                   TO PV-DISPLAY-RCVR-SEQ-NBR     15080001
150900              STRING 'PO = '                                      15090001
151000                     PV-DISPLAY-PO-NBR                            15100001
151100                     ' RECV = '                                   15110001
151200                     PV-DISPLAY-RCVR-SEQ-NBR                      15120001
151300                     DELIMITED BY SIZE                            15130001
151400                                 INTO DP013-MESSAGE-TEXT (2)      15140001
151500              MOVE WKORIN-ORD-LNE-NBR                             15150001
151600                                   TO PV-DISPLAY-LNE-NBR          15160001
151700              MOVE ASC-KEY-OPER-UNT-ID                            15170001
151800                                   TO PV-DISPLAY-OPER-UNT-ID      15180001
151900              MOVE ASC-KEY-FCLTY-ID                               15190001
152000                                   TO PV-DISPLAY-FCLTY-ID         15200001
152100              STRING 'LINE = '                                    15210001
152200                     PV-DISPLAY-LNE-NBR                           15220001
152300                     'OPER = '                                    15230001
152400                     PV-DISPLAY-OPER-UNT-ID                       15240001
152500                     ' FCLTY = '                                  15250001
152600                     PV-DISPLAY-FCLTY-ID                          15260001
152700                     DELIMITED BY SIZE                            15270001
152800                                 INTO DP013-MESSAGE-TEXT (3)      15280001
152900              SET DP013-DB2-ABEND  TO TRUE                        15290001
153000              PERFORM DP013-0000-PROCESS-ABEND                    15300001
153100     END-EVALUATE.                                                15310001
153200*                                                                 15320001
153300*                                                                 15330001
153400 7500-CHECK-FOR-TROUBLE.                                          15340001
153500     EXEC SQL                                                     15350001
153600          SELECT A.PO_NBR,                                        15360001
153700                 A.REC_SEQ_NBR                                    15370001
153800            INTO :TRBNTF-PO-NBR,                                  15380001
153900                 :TRBNTF-REC-SEQ-NBR                              15390001
154000            FROM TTRBNTF A                                        15400001
154100                ,TTRBRSN B                                        15410001
154200           WHERE   A.PO_NBR         =  :ASC-KEY-PO-NBR            15420001
154300             AND ((A.PO_LNE_NBR     =  :TRBNTF-PO-LNE-NBR         15430001
154400             AND   B.TRBL_LVL_IND    <> :PC-M)                    15440001
154500             OR   (A.PREPK_ID       =  :ASC-KEY-PREPK-ID          15450001
154600             AND   B.TRBL_LVL_IND    =  :PC-M))                   15460001
154700             AND   A.REC_SEQ_NBR    =  :ASC-KEY-RCVR-SEQ-NBR      15470001
154800             AND   A.OPER_UNT_ID    =  :ASC-KEY-OPER-UNT-ID       15480001
154900             AND   A.FCLTY_ID       =  :ASC-KEY-FCLTY-ID          15490001
155000             AND   (A.RESOLVED_IND  =  :PC-I                      15500001
155100                    OR                                            15510001
155200                    A.RESOLVED_IND  =  :PC-N                      15520001
155300                    OR                                            15530001
155400                    A.RESOLVED_IND  =  :PC-R)                     15540001
155500             AND   B.TRBL_RSN_CDE   =  A.TRBL_RSN_CDE             15550001
155600             AND   B.NOTIF_IND      =  :PC-T                      15560001
155700     END-EXEC.                                                    15570001
155800                                                                  15580001
155900     EVALUATE TRUE                                                15590001
156000         WHEN SQLCODE = ZERO                                      15600001
156100         WHEN SQLCODE = -811                                      15610001
156200              SET PS-TROUBLE-EXISTS-YES                           15620001
156300                                   TO TRUE                        15630001
156400         WHEN SQLCODE = +100                                      15640001
156500              SET PS-TROUBLE-EXISTS-NO                            15650001
156600                                   TO TRUE                        15660001
156700         WHEN SQLCODE = -904                                      15670001
156800         WHEN SQLCODE = -911                                      15680001
156900         WHEN SQLCODE = -913                                      15690001
157000              PERFORM 9900-SOFT-ABORT                             15700001
157100         WHEN SQLWARN0 NOT = SPACE                                15710001
157200         WHEN SQLCODE NOT = ZERO                                  15720001
157300              MOVE '7500-CHECK-FOR-TROUBLE'                       15730001
157400                                   TO DP013-PARAGRAPH             15740001
157500              MOVE 'SELECT TTRBNTF'                               15750001
157600                                   TO DP013-MESSAGE-TEXT (1)      15760001
157700              MOVE SQLCA           TO DP013-SQLCA                 15770001
157800              MOVE 'TTRBNTF '      TO DP013-DB2-TABLE-NAME (1)    15780001
157900              MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR           15790001
158000              MOVE ASC-KEY-RCVR-SEQ-NBR                           15800001
158100                                   TO PV-DISPLAY-RCVR-SEQ-NBR     15810001
158200              MOVE ASC-KEY-PREPK-ID                               15820001
158300                                   TO PV-DISPLAY-PREPK-ID         15830001
158400              STRING 'PO = '                                      15840001
158500                     PV-DISPLAY-PO-NBR                            15850001
158600                     ' RECV = '                                   15860001
158700                     PV-DISPLAY-RCVR-SEQ-NBR                      15870001
158800                     ' PACK = '                                   15880001
158900                     PV-DISPLAY-PREPK-ID                          15890001
159000                     DELIMITED BY SIZE                            15900001
159100                                 INTO DP013-MESSAGE-TEXT (2)      15910001
159200              MOVE TRBNTF-PO-LNE-NBR                              15920001
159300                                   TO PV-DISPLAY-LNE-NBR          15930001
159400              MOVE ASC-KEY-OPER-UNT-ID                            15940001
159500                                   TO PV-DISPLAY-OPER-UNT-ID      15950001
159600              MOVE ASC-KEY-FCLTY-ID                               15960001
159700                                   TO PV-DISPLAY-FCLTY-ID         15970001
159800              STRING 'LINE = '                                    15980001
159900                     PV-DISPLAY-LNE-NBR                           15990001
160000                     'OPER = '                                    16000001
160100                     PV-DISPLAY-OPER-UNT-ID                       16010001
160200                     ' FCLTY = '                                  16020001
160300                     PV-DISPLAY-FCLTY-ID                          16030001
160400                     DELIMITED BY SIZE                            16040001
160500                                 INTO DP013-MESSAGE-TEXT (3)      16050001
160600              SET DP013-DB2-ABEND  TO TRUE                        16060001
160700              PERFORM DP013-0000-PROCESS-ABEND                    16070001
160800     END-EVALUATE.                                                16080001
160900*                                                                 16090001
161000*                                                                 16100001
161100*                                                                 16110001
161200 7550-CHECK-FOR-RCVR-TRBL.                                        16120001
161300     EXEC SQL                                                     16130001
161400          SELECT A.PO_NBR,                                        16140001
161500                 A.REC_SEQ_NBR                                    16150001
161600            INTO :TRBNTF-PO-NBR,                                  16160001
161700                 :TRBNTF-REC-SEQ-NBR                              16170001
161800           FROM  TTRBNTF A                                        16180001
161900                ,TTRBRSN B                                        16190001
162000           WHERE A.PO_NBR         =  :ASC-KEY-PO-NBR              16200001
162100             AND A.PO_LNE_NBR     =  :TRBNTF-PO-LNE-NBR           16210001
162200             AND A.PREPK_ID       =  :TRBNTF-PREPK-ID             16220001
162300             AND A.REC_SEQ_NBR    =  :ASC-KEY-RCVR-SEQ-NBR        16230001
162400             AND A.OPER_UNT_ID    =  :ASC-KEY-OPER-UNT-ID         16240001
162500             AND A.FCLTY_ID       =  :ASC-KEY-FCLTY-ID            16250001
162600             AND A.TRBL_RSN_CDE  ^=  :PC-998                      16260001
162700             AND A.TRBL_RSN_CDE  ^=  :PC-999                      16270001
162800             AND (A.RESOLVED_IND  =  :PC-I                        16280001
162900                  OR                                              16290001
163000                  A.RESOLVED_IND  =  :PC-N                        16300001
163100                  OR                                              16310001
163200                  A.RESOLVED_IND  =  :PC-R)                       16320001
163300             AND B.TRBL_RSN_CDE   =  A.TRBL_RSN_CDE               16330001
163400             AND B.NOTIF_IND      =  :PC-T                        16340001
163500     END-EXEC.                                                    16350001
163600                                                                  16360001
163700     EVALUATE TRUE                                                16370001
163800         WHEN SQLCODE = ZERO                                      16380001
163900         WHEN SQLCODE = -811                                      16390001
164000              SET PS-TROUBLE-EXISTS-YES                           16400001
164100                                   TO TRUE                        16410001
164200         WHEN SQLCODE = +100                                      16420001
164300              SET PS-TROUBLE-EXISTS-NO                            16430001
164400                                   TO TRUE                        16440001
164500         WHEN SQLCODE = -904                                      16450001
164600         WHEN SQLCODE = -911                                      16460001
164700         WHEN SQLCODE = -913                                      16470001
164800              PERFORM 9900-SOFT-ABORT                             16480001
164900         WHEN SQLWARN0 NOT = SPACE                                16490001
165000         WHEN SQLCODE NOT = ZERO                                  16500001
165100              MOVE '7550-CHECK-FOR-RCVR-TRBL'                     16510001
165200                                   TO DP013-PARAGRAPH             16520001
165300              MOVE 'SELECT TTRBNTF'                               16530001
165400                                   TO DP013-MESSAGE-TEXT (1)      16540001
165500              MOVE SQLCA           TO DP013-SQLCA                 16550001
165600              MOVE 'TTRBNTF '      TO DP013-DB2-TABLE-NAME (1)    16560001
165700              MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR           16570001
165800              MOVE ASC-KEY-RCVR-SEQ-NBR                           16580001
165900                                   TO PV-DISPLAY-RCVR-SEQ-NBR     16590001
166000              MOVE TRBNTF-PREPK-ID                                16600001
166100                                   TO PV-DISPLAY-PREPK-ID         16610001
166200              STRING 'PO = '                                      16620001
166300                     PV-DISPLAY-PO-NBR                            16630001
166400                     ' RECV = '                                   16640001
166500                     PV-DISPLAY-RCVR-SEQ-NBR                      16650001
166600                     ' PACK = '                                   16660001
166700                     PV-DISPLAY-PREPK-ID                          16670001
166800                     DELIMITED BY SIZE                            16680001
166900                                 INTO DP013-MESSAGE-TEXT (2)      16690001
167000              MOVE TRBNTF-PO-LNE-NBR                              16700001
167100                                   TO PV-DISPLAY-LNE-NBR          16710001
167200              MOVE ASC-KEY-OPER-UNT-ID                            16720001
167300                                   TO PV-DISPLAY-OPER-UNT-ID      16730001
167400              MOVE ASC-KEY-FCLTY-ID                               16740001
167500                                   TO PV-DISPLAY-FCLTY-ID         16750001
167600              STRING 'LINE = '                                    16760001
167700                     PV-DISPLAY-LNE-NBR                           16770001
167800                     'OPER = '                                    16780001
167900                     PV-DISPLAY-OPER-UNT-ID                       16790001
168000                     ' FCLTY = '                                  16800001
168100                     PV-DISPLAY-FCLTY-ID                          16810001
168200                     DELIMITED BY SIZE                            16820001
168300                                 INTO DP013-MESSAGE-TEXT (3)      16830001
168400              SET DP013-DB2-ABEND  TO TRUE                        16840001
168500              PERFORM DP013-0000-PROCESS-ABEND                    16850001
168600     END-EVALUATE.                                                16860001
168700*                                                                 16870001
168800*                                                                 16880001
168900 7600-CHECK-RECDIS.                                               16890001
169000     EXEC SQL                                                     16900001
169100          SELECT ORD_NBR,                                         16910001
169200                 REC_SEQ_NBR                                      16920001
169300            INTO :RECDIS-ORD-NBR,                                 16930001
169400                 :RECDIS-REC-SEQ-NBR                              16940001
169500            FROM TRECDIS                                          16950001
169600           WHERE ORD_NBR         =  :ASC-KEY-PO-NBR               16960001
169700             AND ORD_LNE_NBR     =  :RECDIS-ORD-LNE-NBR           16970001
169800             AND REC_SEQ_NBR     =  :ASC-KEY-RCVR-SEQ-NBR         16980001
169900             AND OPER_UNT_ID     =  :ASC-KEY-OPER-UNT-ID          16990001
170000             AND FCLTY_ID        =  :ASC-KEY-FCLTY-ID             17000001
170200     END-EXEC.                                                    17020001
170300                                                                  17030001
170400     EVALUATE TRUE                                                17040001
170500         WHEN SQLCODE = ZERO                                      17050001
170600         WHEN SQLCODE = -811                                      17060001
170700              SET PS-RECDIS-EXISTS-YES                            17070001
170800                                   TO TRUE                        17080001
170900         WHEN SQLCODE = +100                                      17090001
171000              SET PS-RECDIS-EXISTS-NO                             17100001
171100                                   TO TRUE                        17110001
171200         WHEN SQLCODE = -904                                      17120001
171300         WHEN SQLCODE = -911                                      17130001
171400         WHEN SQLCODE = -913                                      17140001
171500              PERFORM 9900-SOFT-ABORT                             17150001
171600         WHEN SQLWARN0 NOT = SPACE                                17160001
171700         WHEN SQLCODE NOT = ZERO                                  17170001
171800              MOVE '7600-CHECK-RECDIS'                            17180001
171900                                   TO DP013-PARAGRAPH             17190001
172000              MOVE 'SELECT TRECDIS'                               17200001
172100                                   TO DP013-MESSAGE-TEXT (1)      17210001
172200              MOVE SQLCA           TO DP013-SQLCA                 17220001
172300              MOVE 'TRECDIS '      TO DP013-DB2-TABLE-NAME (1)    17230001
172400              MOVE ASC-KEY-PO-NBR  TO PV-DISPLAY-PO-NBR           17240001
172500              MOVE ASC-KEY-RCVR-SEQ-NBR                           17250001
172600                                   TO PV-DISPLAY-RCVR-SEQ-NBR     17260001
172700              MOVE TRBNTF-PREPK-ID                                17270001
172800                                   TO PV-DISPLAY-PREPK-ID         17280001
172900              STRING 'PO = '                                      17290001
173000                     PV-DISPLAY-PO-NBR                            17300001
173100                     ' RECV = '                                   17310001
173200                     PV-DISPLAY-RCVR-SEQ-NBR                      17320001
173300                     ' PACK = '                                   17330001
173400                     PV-DISPLAY-PREPK-ID                          17340001
173500                     DELIMITED BY SIZE                            17350001
173600                                 INTO DP013-MESSAGE-TEXT (2)      17360001
173700              MOVE RECDIS-ORD-LNE-NBR                             17370001
173800                                   TO PV-DISPLAY-LNE-NBR          17380001
173900              MOVE ASC-KEY-OPER-UNT-ID                            17390001
174000                                   TO PV-DISPLAY-OPER-UNT-ID      17400001
174100              MOVE ASC-KEY-FCLTY-ID                               17410001
174200                                   TO PV-DISPLAY-FCLTY-ID         17420001
174300              STRING 'LINE = '                                    17430001
174400                     PV-DISPLAY-LNE-NBR                           17440001
174500                     'OPER = '                                    17450001
174600                     PV-DISPLAY-OPER-UNT-ID                       17460001
174700                     ' FCLTY = '                                  17470001
174800                     PV-DISPLAY-FCLTY-ID                          17480001
174900                     DELIMITED BY SIZE                            17490001
175000                                 INTO DP013-MESSAGE-TEXT (3)      17500001
175100              SET DP013-DB2-ABEND  TO TRUE                        17510001
175200              PERFORM DP013-0000-PROCESS-ABEND                    17520001
175300     END-EVALUATE.                                                17530001
175400*                                                                 17540001
175500*----------------------------------------------------------------*17550001
175600*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *17560001
175700*    AND THE ERROR SWITCHES.                                     *17570001
175800*----------------------------------------------------------------*17580001
175900 9900-SOFT-ABORT.                                                 17590001
176000     SET PS-ERROR         TO TRUE.                                17600001
176100     SET DP020-MSG-FATAL  TO TRUE.                                17610001
176200     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    17620001
176300     IF PS-UPDATES-DONE AND SQLCODE = -913                        17630001
176400        PERFORM 9901-BACKUP                                       17640001
176500     END-IF.                                                      17650001
176600     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     17660001
176700     PERFORM 0001-CALL-CICS-ARCH-API.                             17670001
176800                                                                  17680001
176900 9901-BACKUP.                                                     17690001
177000     EXEC CICS SYNCPOINT                                          17700001
177100          ROLLBACK                                                17710001
177200     END-EXEC.                                                    17720001
177300 9999-WRITE-TO-CSSL.                                              17730001
177400        MOVE LENGTH OF PV-CICS-MSG-AREA                           17740001
177500            TO PV-COMMAREA-LENGTH                                 17750001
177600        EXEC CICS                                                 17760001
177700            WRITEQ TD                                             17770001
177800                QUEUE   ('CSSL')                                  17780001
177900                FROM    (PV-CICS-MSG-AREA)                        17790001
178000                LENGTH  (PV-COMMAREA-LENGTH)                      17800001
178100                RESP    (PV-CICS-RESPONSE)                        17810001
178200        END-EXEC.                                                 17820001
178300*----------------------------------------------------------------*17830001
178400*    ABEND PROCESSOR MODULE                                      *17840001
178500*----------------------------------------------------------------*17850001
178600     COPY DPPD013.                                                17860001
