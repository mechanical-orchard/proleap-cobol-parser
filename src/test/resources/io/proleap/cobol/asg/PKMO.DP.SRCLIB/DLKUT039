000100 IDENTIFICATION DIVISION.                                         00010000
000200******************************************************************00020000
000300                                                                  00030000
000400 PROGRAM-ID.    DLKUT039.                                         00040000
000500 AUTHOR.        GERMAN BANDA.                                     00050000
000600 INSTALLATION.  KOHLS.                                            00060000
000700 DATE-WRITTEN   JUNE 2015.                                        00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000******************************************************************00100000
001100* THIS PROGRAM TAKES IN THE EAI EXTRACT FOR RED PRAIRIE DATA,     00110000
001200* AND OBTAINS ADDITIONAL DATA FROM SYSTEM OF RECORD TABLES. THE   00120000
001300* OUTPUT IS JOB0100 AND WMS0102 RECORDS TO BE FTP'D TO THE RED    00130000
001400* PRAIRIE SERVERS OR MANHATTAN LM SERVER                          00140004
001500******************************************************************00150000
001600*PROGRAM CREATED FROM DLKUT004                                    00160000
001700*NEW VERSION OF PROGRAM NEEDED AS DATA IS CONVERSION FROM DLX     00170000
001800*TO LM LABOR REQUIRES NEW EXTRACT. PROGRAM IS EXECUTED IN MULTIPLE00180000
001900*JOBS, HOWEVER RDC'S WILL BE ROLLED OUT OVER A PERIOD OF TIME     00190000
002000******************************************************************00200000
002100******************************************************************00210000
002200 ENVIRONMENT DIVISION.                                            00220000
002300******************************************************************00230000
002400 CONFIGURATION SECTION.                                           00240000
002500 SOURCE-COMPUTER.        IBM-3090.                                00250000
002600 OBJECT-COMPUTER.        IBM-3090.                                00260000
002700                                                                  00270000
002800 INPUT-OUTPUT SECTION.                                            00280000
002900 FILE-CONTROL.                                                    00290000
003000                                                                  00300000
003100     SELECT INPUT-FILE                                            00310000
003200         ASSIGN TO INP01.                                         00320000
003300                                                                  00330000
003400     SELECT OUTPUT-FILE1                                          00340000
003500         ASSIGN TO OUT01.                                         00350000
003600                                                                  00360000
003700     SELECT OUTPUT-FILE2                                          00370000
003800         ASSIGN TO OUT02.                                         00380000
003900                                                                  00390000
004000     SELECT OUTPUT-FILE3                                          00400000
004100         ASSIGN TO OUT03.                                         00410000
004200                                                                  00420000
004300     SELECT OUTPUT-FILE4                                          00430000
004400         ASSIGN TO OUT04.                                         00440000
004500                                                                  00450000
004600******************************************************************00460000
004700 DATA DIVISION.                                                   00470000
004800******************************************************************00480000
004900                                                                  00490000
005000 FILE SECTION.                                                    00500000
005100                                                                  00510000
005200 FD  INPUT-FILE                                                   00520000
005300     RECORDING MODE IS F                                          00530000
005400     LABEL RECORDS ARE STANDARD                                   00540000
005500     RECORD CONTAINS 900                                          00550000
005600     BLOCK CONTAINS 0 RECORDS                                     00560000
005700     DATA RECORD IS INPUT-RECORD.                                 00570000
005800                                                                  00580000
005900 01  INPUT-RECORD              PIC  X(900).                       00590000
006000                                                                  00600000
006100 FD  OUTPUT-FILE1                                                 00610000
006200     RECORDING MODE IS F                                          00620000
006300     LABEL RECORDS ARE STANDARD                                   00630000
006400     RECORD CONTAINS 512                                          00640000
006500     BLOCK CONTAINS 0 RECORDS                                     00650000
006600     DATA RECORD IS OUTPUT-RECORD1.                               00660000
006700                                                                  00670000
006800 01  OUTPUT-RECORD1            PIC  X(512).                       00680000
006900                                                                  00690000
007000 FD  OUTPUT-FILE2                                                 00700000
007100     RECORDING MODE IS F                                          00710000
007200     LABEL RECORDS ARE STANDARD                                   00720000
007300     RECORD CONTAINS 10                                           00730000
007400     BLOCK CONTAINS 0 RECORDS                                     00740000
007500     DATA RECORD IS OUTPUT-RECORD2.                               00750000
007600                                                                  00760000
007700 01  OUTPUT-RECORD2            PIC  X(010).                       00770000
007800                                                                  00780000
007900 FD  OUTPUT-FILE3                                                 00790000
008000     RECORDING MODE IS F                                          00800000
008100     LABEL RECORDS ARE STANDARD                                   00810000
008200     RECORD CONTAINS 92                                           00820000
008300     BLOCK CONTAINS 0 RECORDS                                     00830000
008400     DATA RECORD IS OUTPUT-RECORD3.                               00840000
008500                                                                  00850000
008600 01  OUTPUT-RECORD3            PIC  X(92).                        00860000
008700                                                                  00870000
008800 FD  OUTPUT-FILE4                                                 00880000
008900     RECORDING MODE IS F                                          00890000
009000     LABEL RECORDS ARE STANDARD                                   00900000
009100     RECORD CONTAINS 512                                          00910000
009200     BLOCK CONTAINS 0 RECORDS                                     00920000
009300     DATA RECORD IS OUTPUT-RECORD4.                               00930000
009400                                                                  00940000
009500 01  OUTPUT-RECORD4            PIC  X(512).                       00950000
009600                                                                  00960000
009700******************************************************************00970000
009800 WORKING-STORAGE SECTION.                                         00980000
009900******************************************************************00990000
010000 01  PS-PROGRAM-SWITCHES.                                         01000000
010100     05  PS-EOF-INPUT-SW              PIC X(01)  VALUE 'N'.       01010000
010200         88  PS-EOF-INPUT                        VALUE 'Y'.       01020000
010300         88  PS-NOT-EOF-INPUT                    VALUE 'N'.       01030000
010400     05  PS-OUTPUT-RECORD-TYPE        PIC X(01)  VALUE ' '.       01040000
010500         88  PS-JOB0100-RECORD                   VALUE 'J'.       01050000
010600         88  PS-WMS0102-RECORD                   VALUE 'W'.       01060000
010700         88  PS-EMP0101-RECORD                   VALUE 'E'.       01070000
010800     05  PS-END-OF-CURSOR-SW          PIC X(01)  VALUE 'N'.       01080000
010900         88  PS-END-OF-CURSOR                    VALUE 'Y'.       01090000
011000         88  PS-NOT-END-OF-CURSOR                VALUE 'N'.       01100000
011100     05  PS-END-OF-CARTON-CURSOR-SW   PIC X(01)  VALUE 'N'.       01110000
011200         88  PS-END-OF-CARTON-CURSOR             VALUE 'Y'.       01120000
011300         88  PS-NOT-END-OF-CARTON-CURSOR         VALUE 'N'.       01130000
011400     05  PS-OUTBOUND-UPC-SW           PIC X(01)  VALUE 'N'.       01140000
011500         88  PS-OUTBOUND-UPC                     VALUE 'Y'.       01150000
011600         88  PS-REGULAR-UPC                      VALUE 'N'.       01160000
011700                                                                  01170000
011800     05  PS-OLD-NEW-VERSION-SW        PIC X(01)  VALUE 'N'.       01180000
011900         88  PS-OLD-VERSION                      VALUE 'N'.       01190000
012000         88  PS-NEW-VERSION                      VALUE 'Y'.       01200000
012100                                                                  01210000
012200     05  PS-DOOR-SUMMARY-HIST-SW      PIC X(01)  VALUE 'N'.       01220000
012300         88  PS-NO-DOOR-SUMMARY-HIST             VALUE 'N'.       01230000
012400         88  PS-DOOR-SUMMARY-HIST                VALUE 'Y'.       01240000
012500                                                                  01250000
012600     05  PS-DOOR-SUM-TBL-ENTRY-SW     PIC X(01)  VALUE 'N'.       01260000
012700         88  PS-NO-DOOR-SUM-TBL-ENTRY-FOUND      VALUE 'N'.       01270000
012800         88  PS-DOOR-SUM-TBL-ENTRY-FOUND         VALUE 'Y'.       01280000
012900                                                                  01290000
013000     05  PS-BYPASS-RECORD-SW          PIC X(01)  VALUE 'N'.       01300000
013100         88  PS-BYPASS-RECORD-LM-YES             VALUE 'Y'.       01310000
013200         88  PS-BYPASS-RECORD-LM-NO              VALUE 'N'.       01320000
013300                                                                  01330000
013310     05  PS-BYPASS-RECORD-DLX-SW      PIC X(01)  VALUE 'N'.       01331036
013320         88  PS-BYPASS-RECORD-DLX-YES            VALUE 'Y'.       01332036
013330         88  PS-BYPASS-RECORD-DLX-NO             VALUE 'N'.       01333036
013340                                                                  01334036
013400 01  CC-CONTROL-CARD-PARAMETERS.                                  01340000
013500      05 CC-DC-NBR                      PIC 9(04).                01350000
013600      05 FILLER                         PIC X(76) VALUE SPACE.    01360000
013700                                                                  01370000
013800 01  PC-PROGRAM-CONSTANTS.                                        01380000
013900     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'DLKUT004'. 01390000
014000     05  PC-MAX-RETRIES           PIC S9(04) VALUE +3 COMP.       01400000
014100     05  PC-ASSIGNMENT-CLOSE      PIC X(40)  VALUE                01410000
014200         'ASSIGNMENT CLOSE                        '.              01420000
014300     05  PC-DC-LABOR              PIC X(40)  VALUE                01430000
014400         'DC LABOR                                '.              01440000
014500     05  PC-DEFAULT-TMST              PIC X(26) VALUE             01450000
014600                                     '9999-99-99-99.99.99.999999'.01460000
014700     05  PC-A                         PIC X(01) VALUE 'A'.        01470000
014800     05  PC-B                         PIC X(01) VALUE 'B'.        01480000
014900     05  PC-C                         PIC X(01) VALUE 'C'.        01490000
015000     05  PC-I                         PIC X(01) VALUE 'I'.        01500000
015100     05  PC-M                         PIC X(01) VALUE 'M'.        01510000
015200     05  PC-N                         PIC X(01) VALUE 'N'.        01520000
015300     05  PC-S                         PIC X(01) VALUE 'S'.        01530000
015400     05  PC-Y                         PIC X(01) VALUE 'Y'.        01540000
015500                                                                  01550000
015600 01  PV-PROGRAM-VARIABLES.                                        01560000
015700     05  PV-RECORDS-READ-DISPLAY      PIC ZZZ,ZZZ,ZZZ.            01570000
015800     05  PV-RECORDS-READ2             PIC 9(09)  VALUE ZERO.      01580000
015900     05  PV-RECORDS-READ              PIC 9(09)  VALUE ZERO.      01590000
016000     05  PV-RECORDS-WRITTEN           PIC 9(09)  VALUE ZERO.      01600000
016100     05  PV-HIST-RECORDS-WRITTEN      PIC 9(09)  VALUE ZERO.      01610000
016200     05  PV-RETRY-COUNTER             PIC S9(04) VALUE 0 COMP.    01620000
016300     05  PV-SUB                       PIC S9(04) VALUE 0 COMP.    01630000
016400     05  PV-DOOR-SUM-TABLE-COUNT      PIC S9(04) VALUE 0 COMP.    01640000
016500     05  PV-PICKED                    PIC 9(05) VALUE ZEROS.      01650000
016600     05  PV-LEFTOVER                  PIC 9(05) VALUE ZEROS.      01660000
016700     05  PV-THROWS                    PIC 9(05) VALUE ZEROS.      01670000
016800     05  PV-REMAINDER                 PIC 9(05) VALUE ZEROS.      01680000
016900     05  PV-SAVE-DC                   PIC 9(04) VALUE ZEROS.      01690000
017000     05  PV-DISPLAY-OPER-UNT-ID       PIC 9(04) VALUE ZEROS.      01700000
017100     05  PV-DISPLAY-SEQ-NBR           PIC 9(04) VALUE ZEROS.      01710000
017200     05  PV-DISPLAY-DEPT-NBR          PIC 9(04) VALUE ZEROS.      01720000
017300     05  PV-DISPLAY-MAJ-CL-NBR        PIC 9(04) VALUE ZEROS.      01730000
017400     05  PV-DISPLAY-TRIP-ID           PIC 9(09) VALUE ZEROS.      01740000
017410     05  PV-DISPLAY-CARTONS           PIC 9(09) VALUE ZEROS.      01741030
017500     05  PV-DISPLAY-SHIP-UNT-ID       PIC 9(18) VALUE ZEROS.      01750000
017600     05  PV-WORK-TMST                 PIC X(26).                  01760000
017610     05  PV-DOOR-SUMMARY-TMST         PIC X(26).                  01761013
017700     05  PV-COMPARE-TMST              PIC X(26).                  01770000
017800     05  PV-CURRENT-TIMESTAMP         PIC X(26).                  01780000
017900     05  PV-MOD-NBR.                                              01790000
018000         10  FILLER                   PIC X(03) VALUE 'MOD'.      01800000
018100         10  PV-MOD-NBR-4-8           PIC X(05) VALUE SPACES.     01810000
018200     05  PV-ASSIGNMENT.                                           01820000
018300         10  PV-ASSIGNMENT-1-10       PIC X(10) VALUE SPACES.     01830000
018400         10  PV-ASSIGNMENT-11-15      PIC 9(05) VALUE ZEROS.      01840000
018500     05  PV-ASGMT-NBR-TXT.                                        01850000
018600         10 FILLER                    PIC X(04) VALUE SPACES.     01860000
018700         10 PV-ASGMT-NBR-TXT-5-10     PIC X(06) VALUE SPACES.     01870000
018800     05  PV-ROUTE.                                                01880000
018900         10 FILLER                    PIC X(01).                  01890000
019000         10 PV-ROUTE-2-4              PIC X(03).                  01900000
019100     05  PV-TOTAL-UNITS               PIC  9(09) VALUE 0.         01910000
019200     05  PV-SUM-UNITS                 PIC S9(09) VALUE 0 COMP.    01920000
019300     05  PV-SUM-CARTONS               PIC S9(09) VALUE 0 COMP.    01930000
019310     05  PV-SUM-CARTONS-LM            PIC 9(05).                  01931033
019320     05  PV-CARTONS-ZERO-UNITS        PIC 9(05).                  01932034
019400     05  PV-SUM-PICKED                PIC S9(09) VALUE 0 COMP.    01940000
019500     05  PV-FUNC-QTY                  PIC S9(09) COMP.            01950000
019600     05  PV-TIME-QTY                  PIC S9(09) COMP.            01960000
019700     05  PV-PO-NBR                    PIC 9(09) VALUE ZEROS.      01970000
019800     05  PV-REC-SEQ                   PIC 9(03) VALUE ZEROS.      01980000
019900     05  PV-PO-LNE-NBR                PIC 9(03) VALUE ZEROS.      01990000
020000     05  PV-PACK-TYPE                 PIC X.                      02000000
020100     05  PV-PACK-BY-STR               PIC X.                      02010000
020200     05  PV-NULL-VEH-NBR-IND          PIC S9(4)   VALUE ZERO      02020000
020300                                                  COMP SYNC.      02030000
020400     05  PV-NULL-SUM-UNITS            PIC S9(4)   VALUE ZERO      02040000
020500                                                  COMP SYNC.      02050000
020600     05  PV-NULL-SUM-CARTONS          PIC S9(4)   VALUE ZERO      02060000
020700                                                  COMP SYNC.      02070000
020800     05  PV-NULL-SUM-PICKED           PIC S9(4)   VALUE ZERO      02080000
020900                                                  COMP SYNC.      02090000
021000     05  PV-DB2-WORK-DATE.                                        02100000
021100         10  PV-DB2-CC                PIC X(02).                  02110000
021200         10  PV-DB2-YY                PIC X(02).                  02120000
021300         10  FILLER                   PIC X(01).                  02130000
021400         10  PV-DB2-MM                PIC X(02).                  02140000
021500         10  FILLER                   PIC X(01).                  02150000
021600         10  PV-DB2-DD                PIC X(02).                  02160000
021700     05  PV-DB2-WORK-TME.                                         02170000
021800         10  PV-DB2-HH                PIC X(02).                  02180000
021900         10  FILLER                   PIC X(01).                  02190000
022000         10  PV-DB2-MIN               PIC X(02).                  02200000
022100         10  FILLER                   PIC X(01).                  02210000
022200         10  PV-DB2-SS                PIC X(02).                  02220000
022300     05  PV-REF-ID.                                               02230000
022400         10  PV-ARRIVAL-YY            PIC X(02).                  02240000
022500         10  PV-ARRIVAL-MM            PIC X(02).                  02250000
022600         10  PV-ARRIVAL-DD            PIC X(02).                  02260000
022700         10  PV-ARRIVAL-DASH1         PIC X(01).                  02270000
022800         10  PV-ARRIVAL-HH            PIC X(02).                  02280000
022900         10  PV-ARRIVAL-MIN           PIC X(02).                  02290000
023000         10  PV-ARRIVAL-DASH2         PIC X(01).                  02300000
023100         10  PV-ARRIVAL-SCAC          PIC X(04).                  02310000
023200         10  FILLER                   PIC X(01) VALUE '-'.        02320000
023300         10  PV-ARRIVAL-TRAILER       PIC X(10).                  02330000
023400     05  PV-DL002-WMS0102-USR-ID      PIC X(10).                  02340000
023500                                                                  02350000
023600     05  PV-WORK-AREA.                                            02360000
023700         10 PV-WORK-AREA-GROUP        PIC X(20).                  02370000
023800         10 FILLER REDEFINES PV-WORK-AREA-GROUP.                  02380000
023900             15 PV-WORK-AREA-1-4      PIC X(04).                  02390000
024000                88 PV-FQA             VALUE 'FQA '.               02400000
024100             15 PV-WORK-AREA-5-20     PIC X(16).                  02410000
024200         10 FILLER REDEFINES PV-WORK-AREA-GROUP.                  02420000
024300             15 PV-WORK-AREA-1-4-P2L  PIC X(04).                  02430000
024400                88 PV-P2L             VALUE 'P2L-'.               02440000
024500             15 PV-WORK-AREA-5-9      PIC X(05).                  02450000
024600             15 PV-WORK-AREA-10-20    PIC X(11).                  02460000
024700         10 FILLER REDEFINES PV-WORK-AREA-GROUP.                  02470000
024800             15 PV-WORK-AREA-1-8      PIC X(08).                  02480000
024900                88 PV-DOORFLAT        VALUE 'DOORFLAT'.           02490000
025000                88 PV-DOORCAGE        VALUE 'DOORCAGE'.           02500000
025100                88 PV-DOORTRBL        VALUE 'DOORTRBL'.           02510000
025200                88 PV-DOORPLT         VALUE 'DOORPLT '.           02520000
025300                88 PV-DOORMISC        VALUE 'DOORMISC'.           02530000
025400                88 PV-DOOR2LFT        VALUE 'DOOR2LFT'.           02540000
025500                88 PV-DOORSETS        VALUE 'DOORSETS'.           02550000
025600                88 PV-DOORSPEC        VALUE 'DOORSPEC'.           02560000
025700                88 PV-DOORFLOW        VALUE 'DOORFLOW'.           02570000
025800                88 PV-DOORSHTL        VALUE 'DOORSHTL'.           02580000
025900                88 PV-DOORCONS        VALUE 'DOORCONS'.           02590000
026000                88 PV-DOORSTRP        VALUE 'DOORSTRP'.           02600000
026100                88 PV-DOORJEWL        VALUE 'DOORJEWL'.           02610000
026200                88 PV-DOORCPBS        VALUE 'DOORCPBS'.           02620000
026300             15 PV-WORK-AREA-9-20     PIC X(12).                  02630000
026400         10 FILLER REDEFINES PV-WORK-AREA-GROUP.                  02640000
026500             15 PV-WORK-AREA-1-5      PIC X(05).                  02650000
026600                88 PV-RLABL           VALUE 'RLABL'.              02660000
026700             15 PV-WORK-AREA-6-20     PIC X(15).                  02670000
026800         10 FILLER REDEFINES PV-WORK-AREA-GROUP.                  02680000
026900              15 PV-WORK-AREA-1-7      PIC X(07).                 02690000
027000              15 PV-WORK-AREA-8-20     PIC X(13).                 02700000
027100     05  PV-MODU-DESC.                                            02710000
027200         10 PV-MODU-DESC-GROUP        PIC X(07).                  02720000
027300         10 FILLER REDEFINES PV-MODU-DESC-GROUP.                  02730000
027400             15 PV-MODU-DESC-1-3      PIC X(03).                  02740000
027500                88 PV-MODU-P2L        VALUE 'P2L'.                02750000
027600                88 PV-MODU-RFP        VALUE 'RFP'.                02760000
027700             15 PV-MODU-DESC-4-7      PIC X(04).                  02770000
027800         10 FILLER REDEFINES PV-MODU-DESC-GROUP.                  02780000
027900             15 PV-MODU-DESC-1-4      PIC X(04).                  02790000
028000                88 PV-MODU-HRTW       VALUE 'HRTW'.               02800000
028100                88 PV-MODU-CAGE       VALUE 'CAGE'.               02810000
028200             15 PV-MODU-DESC-5-7      PIC X(03).                  02820000
028300                                                                  02830000
028400     05  PV-INPUT-TMST.                                           02840000
028500         10 PV-INPUT-TMST-DATE.                                   02850000
028600             15 PV-INPUT-TMST-YR      PIC 9(04).                  02860000
028700             15 FILLER                PIC X.                      02870000
028800             15 PV-INPUT-TMST-MO      PIC 9(02).                  02880000
028900             15 FILLER                PIC X.                      02890000
029000             15 PV-INPUT-TMST-DA      PIC 9(02).                  02900000
029100         10 FILLER                    PIC X.                      02910000
029200         10 PV-INPUT-TMST-TIME.                                   02920000
029300             15 PV-INPUT-TMST-HR      PIC 9(02).                  02930000
029400             15 FILLER                PIC X.                      02940000
029500             15 PV-INPUT-TMST-MN      PIC 9(02).                  02950000
029600             15 FILLER                PIC X.                      02960000
029700             15 PV-INPUT-TMST-SS      PIC 9(02).                  02970000
029800         10 FILLER                PIC X.                          02980000
029900         10 FILLER                PIC X(06).                      02990000
030000** REFORMAT TIME FOR LM DATA                                      03000000
030100     05  PV-INPUT-TMST-LM.                                        03010000
030200         10 PV-INPUT-TMST-DATE-LM.                                03020000
030300             15 PV-INPUT-TMST-YR-LM   PIC 9(04).                  03030000
030400             15 FILLER                PIC X.                      03040000
030500             15 PV-INPUT-TMST-MO-LM   PIC 9(02).                  03050000
030600             15 FILLER                PIC X.                      03060000
030700             15 PV-INPUT-TMST-DA-LM   PIC 9(02).                  03070000
030800         10 FILLER                    PIC X.                      03080000
030900         10 PV-INPUT-TMST-TIME-LM.                                03090000
031000             15 PV-INPUT-TMST-HR-LM   PIC 9(02).                  03100000
031100             15 FILLER                PIC X.                      03110000
031200             15 PV-INPUT-TMST-MN-LM   PIC 9(02).                  03120000
031300             15 FILLER                PIC X.                      03130000
031400             15 PV-INPUT-TMST-SS-LM   PIC 9(02).                  03140000
031500         10 FILLER                PIC X.                          03150000
031600         10 FILLER                PIC X(06).                      03160000
031700                                                                  03170000
031800     05  PV-JOB0100-START-TIME-LM     PIC 9(06)  VALUE ZEROES.    03180000
031900     05  PV-JOB0100-PLAN-DATE-LM.                                 03190000
032000         10  PV-JOB0100-PLAN-DATE-MM-LM PIC 9(02).                03200000
032100         10  PV-JOB0100-PLAN-DATE-DD-LM PIC 9(02).                03210000
032200         10  PV-JOB0100-PLAN-DATE-YY-LM PIC 9(04).                03220000
032300*                                                                 03230000
032400     05  PV-JOIN-TMST.                                            03240000
032500         10 PV-JOIN-TMST-DATE.                                    03250000
032600             15 PV-JOIN-TMST-YR       PIC 9(04).                  03260000
032700             15 FILLER                PIC X.                      03270000
032800             15 PV-JOIN-TMST-MO       PIC 9(02).                  03280000
032900             15 FILLER                PIC X.                      03290000
033000             15 PV-JOIN-TMST-DA       PIC 9(02).                  03300000
033100         10 FILLER                    PIC X.                      03310000
033200         10 PV-JOIN-TMST-TIME.                                    03320000
033300             15 PV-JOIN-TMST-HR       PIC 9(02).                  03330000
033400             15 FILLER                PIC X.                      03340000
033500             15 PV-JOIN-TMST-MN       PIC 9(02).                  03350000
033600             15 FILLER                PIC X.                      03360000
033700             15 PV-JOIN-TMST-SS       PIC 9(02).                  03370000
033800         10 FILLER                PIC X.                          03380000
033900         10 FILLER                PIC X(06).                      03390000
034000                                                                  03400000
034100     05  PV-START-DATE.                                           03410000
034200         10 PV-START-DATE-MO          PIC 9(02).                  03420000
034300         10 PV-START-DATE-DA          PIC 9(02).                  03430000
034400         10 PV-START-DATE-YR          PIC 9(04).                  03440000
034500                                                                  03450000
034600     05  PV-PLAN-DATE.                                            03460000
034700         10 PV-PLAN-DATE-MO           PIC 9(02).                  03470000
034800         10 PV-PLAN-DATE-DA           PIC 9(02).                  03480000
034900         10 PV-PLAN-DATE-YR           PIC 9(04).                  03490000
035000                                                                  03500000
035100     05  PV-START-TIME.                                           03510000
035200         10 PV-START-TIME-HR          PIC 9(02).                  03520000
035300         10 PV-START-TIME-MN          PIC 9(02).                  03530000
035400         10 PV-START-TIME-SS          PIC 9(02).                  03540000
035500                                                                  03550000
035600     05  PC-MAX-DOOR-SUMMARY-COUNT    PIC S9(04) COMP             03560000
035700                                                 VALUE +750.      03570000
035800     05  PV-DOOR-SUMMARY-TABLE        OCCURS 750 TIMES.           03580000
035900         10 PV-DOOR-ID                PIC  X(04)  VALUE SPACES.   03590000
036000         10 PV-END-TMST               PIC  X(26)  VALUE SPACES.   03600000
036010*CHGXXXXXXX                                                       03601043
036020     05  PV-AJ-PICKED-QTY-CH          PIC  X(05) VALUE SPACES.    03602044
036030     05  PV-NO-OF-NEG                 PIC  9(02) VALUE ZEROES.    03603044
036040     05  PV-TOT-NO-OF-NEG             PIC  9(04) VALUE ZEROES.    03604044
036050*CHGXXXXXXX                                                       03605044
036100                                                                  03610000
036200 01  PV-ABEND-FIELDS.                                             03620000
036300     05  PV-ABEND-CODE                PIC  S9(4) VALUE +0         03630000
036400                                                 COMP SYNC.       03640000
036500     05  PV-SQLCODE                   PIC  Z(08)9-.               03650000
036600     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    03660000
036700     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    03670000
036800     05  PV-ABEND-STRUCTURE-1         PIC  X(08) VALUE SPACES.    03680000
036900     05  PV-ABEND-STRUCTURE-2         PIC  X(08) VALUE SPACES.    03690000
037000     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    03700000
037100     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    03710000
037200     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    03720000
037300     05  PV-DB2-TABLE-NAME            PIC X(12)  VALUE SPACE.     03730000
037400                                                                  03740000
037500 01  DN-NULL-INDICATORS.                                          03750000
037600     05  DN-KOHLS-USR-ID-NULL-IND     PIC S9(04) VALUE ZERO       03760000
037700                                                     COMP SYNC.   03770000
037800     05  DN-TMP-USR-ID-NULL-IND       PIC S9(04) VALUE ZERO       03780000
037900                                                     COMP SYNC.   03790000
038000     05  DN-NULL-IND-VEH              PIC S9(04)    VALUE ZERO    03800000
038100                                                     COMP SYNC.   03810000
038200     05  DN-NULL-IND-FCSE             PIC S9(04)    VALUE ZERO    03820000
038300                                                     COMP SYNC.   03830000
038400     05  DN-NULL-IND-P2L              PIC S9(04)    VALUE ZERO    03840000
038500                                                     COMP SYNC.   03850000
038600     05  DN-NULL-FCSE-SPLT            PIC S9(04)    VALUE ZERO    03860000
038700                                                     COMP SYNC.   03870000
038800     05  DN-NULL-P2L-SPLT             PIC S9(04)    VALUE ZERO    03880000
038900                                                     COMP SYNC.   03890000
039000 01  DK-DB-KEYS.                                                  03900000
039100     05 DK-ASGMT-STRT-DTE             PIC X(10).                  03910000
039200     05 DK-ASGMT-NBR-TXT              PIC X(10).                  03920000
039300     05 DK-EVNT-KY-1-TMST             PIC X(26).                  03930000
039400     05 DK-ASGMT-NBR-SEQ-NBR          PIC S9(09) COMP.            03940000
039500     05 DK-TRIP-ID                    PIC S9(09) COMP.            03950000
039600     05 DK-SHIP-UNT-ID                PIC S9(18) COMP-3.          03960000
039700     05 DK-DEPT-NBR                   PIC S9(04) COMP.            03970000
039800     05 DK-MAJ-CL-NBR                 PIC S9(04) COMP.            03980000
039900     05 DK-REC-SEQ-NBR                PIC S9(09) COMP.            03990000
040000     05 DK-PO-LNE-NBR                 PIC S9(09) COMP.            04000000
040100     05 DK-PO-NBR                     PIC S9(09) COMP.            04010000
040200     05 DK-OPER-UNT-ID                PIC S9(04) COMP.            04020000
040300     05 DK-DOOR-NUMBER                PIC X(04).                  04030000
040400                                                                  04040000
040500******************************************************************04050000
040600*  DB2 FORMATTED MESSAGE AREA                                     04060000
040700******************************************************************04070000
040800     COPY DPWS004.                                                04080000
040900*                                                                 04090000
041000******************************************************************04100000
041100*  COPYBOOK SUWS050 (SU- BUSINESS EVENT EXPORT DETAIL)            04110000
041200******************************************************************04120000
041300     COPY SUWS050.                                                04130000
041400*                                                                 04140000
041500******************************************************************04150000
041600*  COPYBOOK PSWS242 (PC - BUSINESS EVENT EXPORT DETAIL)           04160000
041700******************************************************************04170000
041800     COPY PCWS242.                                                04180000
041900*                                                                 04190000
042000******************************************************************04200000
042100*  COPYBOOK DLRD001 (JOB0100 OUTPUT FILE LAYOUT)                  04210000
042200******************************************************************04220000
042300     COPY DLRD001.                                                04230000
042400*                                                                 04240000
042500******************************************************************04250000
042600*  COPYBOOK DLRD002 (WMS0102 OUTPUT FILE LAYOUT)                  04260000
042700******************************************************************04270000
042800     COPY DLRD002.                                                04280000
042900*                                                                 04290000
043000******************************************************************04300000
043100*  COPYBOOK DLRD003 (EAI EXTRACT INPUT FILE LAYOUT)               04310000
043200******************************************************************04320000
043300     COPY DLRD003.                                                04330000
043400*                                                                 04340000
043500******************************************************************04350000
043600*  COPYBOOK DLRD006 (EMP0101 OUTPUT FILE LAYOUT)                  04360000
043700******************************************************************04370000
043800     COPY DLRD006.                                                04380000
043900*                                                                 04390000
044000******************************************************************04400000
044100*  COPYBOOK DLRD013 (DOOR SUMMARY HISTORY LAYOUT)                 04410000
044200******************************************************************04420000
044300     COPY DLRD013.                                                04430000
044400*                                                                 04440000
044500******************************************************************04450000
044600*    TKRPRPM TABLE                                                04460000
044700******************************************************************04470000
044800     EXEC SQL                                                     04480000
044900          INCLUDE TKRPRPM                                         04490000
045000     END-EXEC.                                                    04500000
045100*                                                                 04510000
045200******************************************************************04520000
045300*    TSHPTPO TABLE                                                04530000
045400******************************************************************04540000
045500     EXEC SQL                                                     04550000
045600          INCLUDE TSHPTPO                                         04560000
045700     END-EXEC.                                                    04570000
045800                                                                  04580000
045900******************************************************************04590000
046000*    TRECITM TABLE                                                04600000
046100******************************************************************04610000
046200     EXEC SQL                                                     04620000
046300          INCLUDE TRECITM                                         04630000
046400     END-EXEC.                                                    04640000
046500                                                                  04650000
046600******************************************************************04660000
046700*    TSHIPMT TABLE                                                04670000
046800******************************************************************04680000
046900     EXEC SQL                                                     04690000
047000          INCLUDE TSHIPMT                                         04700000
047100     END-EXEC.                                                    04710000
047200                                                                  04720000
047300******************************************************************04730000
047400*    TVHTRIP TABLE                                                04740000
047500******************************************************************04750000
047600     EXEC SQL                                                     04760000
047700          INCLUDE TVHTRIP                                         04770000
047800     END-EXEC.                                                    04780000
047900                                                                  04790000
048000******************************************************************04800000
048100*   TRECEIV TABLE                                                 04810000
048200******************************************************************04820000
048300     EXEC SQL                                                     04830000
048400          INCLUDE TRECEIV                                         04840000
048500     END-EXEC.                                                    04850000
048600                                                                  04860000
048700******************************************************************04870000
048800*    TPURCHS TABLE                                                04880000
048900******************************************************************04890000
049000     EXEC SQL                                                     04900000
049100          INCLUDE TPURCHS                                         04910000
049200     END-EXEC.                                                    04920000
049300                                                                  04930000
049400******************************************************************04940000
049500*    TINPKSU TABLE                                                04950000
049600******************************************************************04960000
049700     EXEC SQL                                                     04970000
049800          INCLUDE TINPKSU                                         04980000
049900     END-EXEC.                                                    04990000
050000                                                                  05000000
050100******************************************************************05010000
050200*    TPKSLIP TABLE                                                05020000
050300******************************************************************05030000
050400     EXEC SQL                                                     05040000
050500          INCLUDE TPKSLIP                                         05050000
050600     END-EXEC.                                                    05060000
050700                                                                  05070000
050800******************************************************************05080000
050900*    TSHUUPC TABLE                                                05090000
051000******************************************************************05100000
051100     EXEC SQL                                                     05110000
051200          INCLUDE TSHUUPC                                         05120000
051300     END-EXEC.                                                    05130000
051400                                                                  05140000
051500******************************************************************05150000
051600*    TSUOBTR TABLE                                                05160000
051700******************************************************************05170000
051800     EXEC SQL                                                     05180000
051900          INCLUDE TSUOBTR                                         05190000
052000     END-EXEC.                                                    05200000
052100                                                                  05210000
052200******************************************************************05220000
052300*    TCNTRID TABLE                                                05230000
052400******************************************************************05240000
052500     EXEC SQL                                                     05250000
052600          INCLUDE TCNTRID                                         05260000
052700     END-EXEC.                                                    05270000
052800                                                                  05280000
052900******************************************************************05290000
053000*    TSUCRDV TABLE                                                05300000
053100******************************************************************05310000
053200     EXEC SQL                                                     05320000
053300          INCLUDE TSUCRDV                                         05330000
053400     END-EXEC.                                                    05340000
053500                                                                  05350000
053600******************************************************************05360000
053700*    TTRIPST TABLE                                                05370000
053800******************************************************************05380000
053900     EXEC SQL                                                     05390000
054000          INCLUDE TTRIPST                                         05400000
054100     END-EXEC.                                                    05410000
054200                                                                  05420000
054300******************************************************************05430000
054400*    SUT_OTBND_UPC                                                05440000
054500******************************************************************05450000
054600     EXEC SQL                                                     05460000
054700          INCLUDE SUT00028                                        05470000
054800     END-EXEC.                                                    05480000
054900                                                                  05490000
055000******************************************************************05500000
055100*    XLT_UPC TABLE (XLT00006)                                     05510000
055200******************************************************************05520000
055300     EXEC SQL                                                     05530000
055400          INCLUDE XLT00006                                        05540000
055500     END-EXEC.                                                    05550000
055600                                                                  05560000
055700******************************************************************05570000
055800*    XLT_SKU TABLE (XLT00003)                                     05580000
055900******************************************************************05590000
056000     EXEC SQL                                                     05600000
056100          INCLUDE XLT00003                                        05610000
056200     END-EXEC.                                                    05620000
056300                                                                  05630000
056400******************************************************************05640000
056500*    XLT_VND_STYL TABLE (XLT00004)                                05650000
056600******************************************************************05660000
056700     EXEC SQL                                                     05670000
056800          INCLUDE XLT00004                                        05680000
056900     END-EXEC.                                                    05690000
057000                                                                  05700000
057100******************************************************************05710000
057200*    DLT_DC_DOOR_SUM TABLE (DLT00011)                             05720000
057300******************************************************************05730000
057400     EXEC SQL                                                     05740000
057500          INCLUDE DLT00011                                        05750000
057600     END-EXEC.                                                    05760000
057700                                                                  05770000
057800******************************************************************05780000
057900*    DLT_CLS_CART_DFLT TABLE (DLT00006)                           05790000
058000******************************************************************05800000
058100     EXEC SQL                                                     05810000
058200          INCLUDE DLT00006                                        05820000
058300     END-EXEC.                                                    05830000
058400                                                                  05840000
058500******************************************************************05850000
058600*    DLT_DEPT_CART_DFLT TABLE (DLT00005)                          05860000
058700******************************************************************05870000
058800     EXEC SQL                                                     05880000
058900          INCLUDE DLT00005                                        05890000
059000     END-EXEC.                                                    05900000
059100                                                                  05910000
059200******************************************************************05920000
059300*    DLT_ASGMT (DLT00004)                                         05930000
059400******************************************************************05940000
059500     EXEC SQL                                                     05950000
059600          INCLUDE DLT00004                                        05960000
059700     END-EXEC.                                                    05970000
059800                                                                  05980000
059900******************************************************************05990000
060000*    DLT_TEM_ASGMT (DLT00003)                                     06000000
060100******************************************************************06010000
060200     EXEC SQL                                                     06020000
060300          INCLUDE DLT00003                                        06030000
060400     END-EXEC.                                                    06040000
060500                                                                  06050000
060600******************************************************************06060000
060700*    CURSOR TO GET ASSOCIATES ON A TEAM ASSIGNMENT                06070000
060800******************************************************************06080000
060900                                                                  06090000
061000     EXEC SQL                                                     06100000
061100        DECLARE ASSOCIATE-CURSOR CURSOR FOR                       06110000
061200         SELECT                                                   06120000
061300                TEM.ASGMT_STRT_DTE                                06130000
061400               ,TEM.ASGMT_NBR_TXT                                 06140000
061500               ,TEM.KOHLS_USR_ID                                  06150000
061600               ,TEM.TMP_USR_ID                                    06160000
061700               ,TEM.JN_TMST + :PV-FUNC-QTY HOURS                  06170000
061800               ,TEM.CRE_BY_USR_ID                                 06180000
061900                                                                  06190000
062000          FROM  DLT_TEM_ASGMT   TEM                               06200000
062100                                                                  06210000
062200         WHERE  TEM.ASGMT_STRT_DTE    = :DK-ASGMT-STRT-DTE        06220000
062300           AND  TEM.ASGMT_NBR_TXT     = :DK-ASGMT-NBR-TXT         06230000
062400           AND  TEM.ASGMT_NBR_SEQ_NBR =                           06240000
062500                              :DK-ASGMT-NBR-SEQ-NBR               06250000
062600           AND  TEM.LVE_RSN_CDE      <> :PC-N                     06260000
062700     END-EXEC.                                                    06270000
062800                                                                  06280000
062900******************************************************************06290000
063000*    CURSOR TO GET CARTONS WITHIN DIVERT TIMESTAMPS               06300000
063100******************************************************************06310000
063200                                                                  06320000
063300     EXEC SQL                                                     06330000
063400        DECLARE CARTON-CURSOR CURSOR FOR                          06340000
063500         SELECT                                                   06350000
063600                CAR.SHIPT_UNT_ID                                  06360000
063700              , CAR.DIVERT_TMST                                   06370023
063800          FROM  TSUCRDV CAR                                       06380000
063900                                                                  06390000
064000         WHERE  CAR.OPER_UNT_ID       = :DK-OPER-UNT-ID           06400000
064100           AND  CAR.DOOR_ID           = :DK-DOOR-NUMBER           06410000
064200           AND  CAR.ACTV_CDE          = 'A'                       06420000
064300           AND (CAR.DIVERT_TMST > :DK-EVNT-KY-1-TMST AND          06430000
064400                CAR.DIVERT_TMST <= :DL003-EVNT-KY-2-TMST)         06440000
064500     END-EXEC.                                                    06450000
064600*                                                                 06460000
064700******************************************************************06470000
064800*  COMMUNICATIONS AREA FOR DB2                                    06480000
064900******************************************************************06490000
065000     EXEC SQL                                                     06500000
065100          INCLUDE SQLCA                                           06510000
065200     END-EXEC.                                                    06520000
065300                                                                  06530000
065400******************************************************************06540000
065500 PROCEDURE DIVISION.                                              06550000
065600******************************************************************06560000
065700 0000-PROGRAM-MAINLINE.                                           06570000
065800                                                                  06580000
065900     ACCEPT CC-CONTROL-CARD-PARAMETERS FROM SYSIN.                06590000
066000     DISPLAY 'CONTROL CARD SET-UP FOR THIS RUN IS: '              06600000
066100             CC-CONTROL-CARD-PARAMETERS.                          06610000
066200     IF CC-DC-NBR NOT NUMERIC                                     06620000
066300         MOVE 85                    TO CC-DC-NBR                  06630000
066400     END-IF.                                                      06640000
066500     MOVE CC-DC-NBR                 TO DK-OPER-UNT-ID.            06650000
066600                                                                  06660000
066700     OPEN INPUT  INPUT-FILE                                       06670000
066800          OUTPUT OUTPUT-FILE1                                     06680000
066900          OUTPUT OUTPUT-FILE2                                     06690000
067000          OUTPUT OUTPUT-FILE3                                     06700000
067100          OUTPUT OUTPUT-FILE4.                                    06710000
067200                                                                  06720000
067300     INITIALIZE OUTPUT-RECORD2                                    06730000
067400                OUTPUT-RECORD3                                    06740000
067500                OUTPUT-RECORD4.                                   06750000
067600                                                                  06760000
067700     PERFORM 8700-GET-TKRPRPM-TIME-ZONE.                          06770000
067800                                                                  06780000
067900     PERFORM 8750-GET-TKRPRPM-TIME-INTERVAL.                      06790000
068000                                                                  06800000
068100     PERFORM 8400-GET-TIMESTAMP.                                  06810000
068200                                                                  06820000
068300     PERFORM 8800-GET-OLD-NEW-VERSION.                            06830000
068301                                                                  06830137
068310     PERFORM 8850-CHECK-WRITE-DLX-FILE.                           06831037
068400                                                                  06840000
068500     PERFORM 1000-READ-INPUT-FILE.                                06850000
068600                                                                  06860000
068700     PERFORM 2000-PROCESS-INPUT-FILE                              06870000
068800         UNTIL PS-EOF-INPUT.                                      06880000
068900                                                                  06890000
069000*** MMH - 11/12/09 - BEGIN                                        06900000
069100     DISPLAY '*****************************'.                     06910000
069200     DISPLAY '** PV-DOOR-SUM-TABLE-COUNT = '                      06920000
069300             PV-DOOR-SUM-TABLE-COUNT                              06930000
069400     DISPLAY '*****************************'.                     06940000
069500*** DMH - 11/12/09 - END                                          06950000
069510*CHGXXXXXXX                                                       06951044
069520     DISPLAY '*****************************'.                     06952042
069530     DISPLAY '** TOTAL NO OF NEGTIVE PICKMADE = '                 06953042
069540             PV-TOT-NO-OF-NEG                                     06954042
069550     DISPLAY '*****************************'.                     06955042
069560*CHGXXXXXXX                                                       06956042
069600                                                                  06960000
069700     PERFORM 9000-EOJ.                                            06970000
069800                                                                  06980000
069900     STOP RUN.                                                    06990000
070000                                                                  07000000
070100******************************************************************07010000
070200* READS RECORD FROM THE INPUT FILE                                07020000
070300******************************************************************07030000
070400 1000-READ-INPUT-FILE.                                            07040000
070500     MOVE '1000-READ-INPUT-FILE.'      TO  PV-ABEND-PARAGRAPH.    07050000
070600                                                                  07060000
070700     READ INPUT-FILE                                              07070000
070800          INTO DL003-EXPORT-RECORD-LAYOUT                         07080000
070900            AT END                                                07090000
071000               SET PS-EOF-INPUT     TO TRUE                       07100000
071100                                                                  07110000
071200            NOT AT END                                            07120000
071300               SET PS-NOT-EOF-INPUT TO TRUE                       07130000
071400               SET PS-BYPASS-RECORD-LM-NO TO TRUE                 07140000
071500               ADD +1 TO PV-RECORDS-READ                          07150000
071600                         PV-RECORDS-READ2                         07160000
071700               IF  PV-RECORDS-READ2  >= 5000                      07170000
071800                   MOVE  PV-RECORDS-READ                          07180000
071900                     TO  PV-RECORDS-READ-DISPLAY                  07190000
072000                   DISPLAY 'RECORDS PROCESSED:  '                 07200000
072100                   PV-RECORDS-READ-DISPLAY                        07210000
072200                   MOVE  ZEROES TO  PV-RECORDS-READ2              07220000
072300               END-IF                                             07230000
072400     END-READ.                                                    07240000
072500                                                                  07250000
072600******************************************************************07260000
072700* PROCESS INPUT RECORDS                                          *07270000
072800******************************************************************07280000
072900 2000-PROCESS-INPUT-FILE.                                         07290000
073000     MOVE '2000-PROCESS-INPUT-FILE.'   TO PV-ABEND-PARAGRAPH.     07300000
073100     MOVE     DL003-CRE-BY-USR-ID     TO  PV-DL002-WMS0102-USR-ID.07310000
073200     IF DL003-EVNT-OBJ-TXT = 'DC LABOR'                           07320000
073300         IF DL003-EVNT-OBJ-ACTN-TXT = 'INDIRECT LABOR'            07330000
073400             PERFORM 3000-BUILD-JOB0100                           07340000
073500             PERFORM 9000-WRITE-OUTPUT-RECORD                     07350000
073600         ELSE                                                     07360000
073700         IF DL003-EVNT-OBJ-ACTN-TXT = 'ASSIGNMENT CLOSE'          07370000
073800             PERFORM 3020-BUILD-WMS0102-ASSN-CLOSE                07380000
073900         ELSE                                                     07390000
074000         IF DL003-EVNT-OBJ-ACTN-TXT = 'ASSOCIATE ADD'             07400000
074100             PERFORM 3040-BUILD-EMP0101                           07410000
074200             PERFORM 9000-WRITE-OUTPUT-RECORD                     07420000
074300         ELSE                                                     07430000
074400         IF DL003-EVNT-OBJ-ACTN-TXT = 'ASSIGNMENT USER ADD'       07440000
074500            PERFORM 3050-BUILD-WMS0102-ASSN-USER                  07450000
074600         END-IF                                                   07460000
074700         END-IF                                                   07470000
074800     ELSE                                                         07480000
074900     IF DL003-EVNT-OBJ-TXT = 'RECEIVING'                          07490000
075000         IF DL003-EVNT-OBJ-ACTN-TXT = 'TRAILER OPEN'              07500000
075100             PERFORM 3200-BUILD-WMS0102-TRLR-OPEN                 07510000
075200             PERFORM 9000-WRITE-OUTPUT-RECORD                     07520000
075300         END-IF                                                   07530000
075400     ELSE                                                         07540000
075500     IF DL003-EVNT-OBJ-TXT = 'CARTON'                             07550000
075600         IF DL003-EVNT-OBJ-ACTN-TXT = 'CHECKIN'                   07560000
075700             PERFORM 3300-BUILD-WMS0102-CRTN-CHKIN                07570000
075800             PERFORM 9000-WRITE-OUTPUT-RECORD                     07580000
075900         ELSE                                                     07590000
076000         IF DL003-EVNT-OBJ-ACTN-TXT = 'RECLAIM'                   07600000
076100             PERFORM 3400-BUILD-WMS0102-CRTN-RECLM                07610000
076200             PERFORM 9000-WRITE-OUTPUT-RECORD                     07620000
076300         ELSE                                                     07630000
076400         IF DL003-EVNT-OBJ-ACTN-TXT = 'AUDIT'                     07640000
076500             PERFORM 3500-BUILD-WMS0102-CRTN-AUDIT                07650000
076600             PERFORM 9000-WRITE-OUTPUT-RECORD                     07660000
076700         ELSE                                                     07670000
076800         IF DL003-EVNT-OBJ-ACTN-TXT = 'CHECKIN PRINT'             07680000
076900             PERFORM 3600-BUILD-WMS0102-CRTN-PRINT                07690000
077000             PERFORM 9000-WRITE-OUTPUT-RECORD                     07700000
077100         ELSE                                                     07710000
077200         IF DL003-EVNT-OBJ-ACTN-TXT = 'NON UCC PRINT'             07720000
077300             PERFORM 3800-BUILD-WMS0102-NOUCC-PRINT               07730000
077400             PERFORM 9000-WRITE-OUTPUT-RECORD                     07740000
077500         END-IF                                                   07750000
077600     ELSE                                                         07760000
077700     IF DL003-EVNT-OBJ-TXT = 'PO DOWNLOAD'                        07770000
077800         IF DL003-EVNT-OBJ-ACTN-TXT = 'DOWNLOAD PROCESS'          07780000
077900             PERFORM 3700-BUILD-WMS0102-PO-DWNLD                  07790000
078000             PERFORM 9000-WRITE-OUTPUT-RECORD                     07800000
078100         END-IF                                                   07810000
078200     ELSE                                                         07820000
078300     IF DL003-EVNT-OBJ-TXT = 'SHIPPING'                           07830000
078400         IF DL003-EVNT-OBJ-ACTN-TXT = 'TRAILER OPEN' OR           07840000
078500            DL003-EVNT-OBJ-ACTN-TXT = 'TRAILER CLOSE'             07850000
078600             PERFORM 4200-BUILD-WMS0102-SHIP-TRLR                 07860000
078700             PERFORM 9000-WRITE-OUTPUT-RECORD                     07870000
078800         ELSE                                                     07880000
078900         IF DL003-EVNT-OBJ-ACTN-TXT = 'CARTON MANUAL SCAN'        07890000
079000             PERFORM 4300-BUILD-WMS0102-CRTN-SCAN                 07900000
079100             PERFORM 9000-WRITE-OUTPUT-RECORD                     07910000
079200         ELSE                                                     07920000
079300         IF DL003-EVNT-OBJ-ACTN-TXT = 'PALLET MANUAL SCAN'        07930000
079400             PERFORM 4400-BUILD-WMS0102-PLLT-SCAN                 07940000
079500         ELSE                                                     07950000
079600         IF DL003-EVNT-OBJ-ACTN-TXT = 'DOOR SUMMARY'              07960000
079700             PERFORM 4500-BUILD-WMS0102-DOOR-SMRY                 07970000
079710             SET PS-BYPASS-RECORD-LM-YES TO TRUE                  07971012
079800             PERFORM 9000-WRITE-OUTPUT-RECORD                     07980000
079900             SET PS-NO-DOOR-SUMMARY-HIST TO TRUE                  07990000
080000         ELSE                                                     08000000
080100         IF DL003-EVNT-OBJ-ACTN-TXT = 'ADD MASTER'                08010000
080200            AND PS-NEW-VERSION                                    08020000
080300             PERFORM 4600-BUILD-WMS0102-ADD-MASTER                08030000
080400             PERFORM 9000-WRITE-OUTPUT-RECORD                     08040000
080500         ELSE                                                     08050000
080600         IF DL003-EVNT-OBJ-ACTN-TXT = 'ADD CHILD TO MASTER'       08060000
080700            AND PS-NEW-VERSION                                    08070000
080800             PERFORM 4610-BLD-WMS0102-AD-CH-TO-MS                 08080000
080900             PERFORM 9000-WRITE-OUTPUT-RECORD                     08090000
081000         ELSE                                                     08100000
081100         IF DL003-EVNT-OBJ-ACTN-TXT = 'ADD MASTER TO MASTER'      08110000
081200            AND PS-NEW-VERSION                                    08120000
081300             PERFORM 4620-BLD-WMS0102-AD-MS-TO-MS                 08130000
081400             PERFORM 9000-WRITE-OUTPUT-RECORD                     08140000
081500         ELSE                                                     08150000
081600         IF DL003-EVNT-OBJ-ACTN-TXT = 'REMOVE CHILD FROM MASTER'  08160000
081700            AND PS-NEW-VERSION                                    08170000
081800           PERFORM 4630-BLD-WMS0102-RM-CH-FR-MS                   08180000
081900           PERFORM 9000-WRITE-OUTPUT-RECORD                       08190000
082000         ELSE                                                     08200000
082100         IF DL003-EVNT-OBJ-ACTN-TXT = 'REMOVE MASTER FROM MASTER' 08210000
082200            AND PS-NEW-VERSION                                    08220000
082300           PERFORM 4640-BLD-WMS0102-RM-MS-FR-MS                   08230000
082400           PERFORM 9000-WRITE-OUTPUT-RECORD                       08240000
082500         ELSE                                                     08250000
082600         IF DL003-EVNT-OBJ-ACTN-TXT = 'REASSIGN TO MASTER'        08260000
082700            AND PS-NEW-VERSION                                    08270000
082800           PERFORM 4650-BLD-WMS0102-RSGN-TO-MS                    08280000
082900           PERFORM 9000-WRITE-OUTPUT-RECORD                       08290000
083000         END-IF                                                   08300000
083100     ELSE                                                         08310000
083200     IF DL003-EVNT-OBJ-TXT = 'PACKTOLIGHT'                        08320000
083300         IF DL003-EVNT-OBJ-ACTN-TXT = 'PICKMADE'                  08330000
083400             PERFORM 4700-BUILD-WMS0102-PICK-MADE                 08340000
083500         ELSE                                                     08350000
083600         IF DL003-EVNT-OBJ-ACTN-TXT = 'INBOUND LAUNCH'            08360000
083700             PERFORM 4710-BUILD-WMS0102-INBD-LNCH                 08370000
083800             PERFORM 9000-WRITE-OUTPUT-RECORD                     08380000
083900         ELSE                                                     08390000
084000         IF DL003-EVNT-OBJ-ACTN-TXT = 'OUTBOUND OPEN'             08400000
084100             PERFORM 4720-BUILD-WMS0102-OTBD-OPEN                 08410000
084200             PERFORM 9000-WRITE-OUTPUT-RECORD                     08420000
084300         ELSE                                                     08430000
084400         IF DL003-EVNT-OBJ-ACTN-TXT = 'OUTBOUND CLOSE'            08440000
084500             PERFORM 4730-BUILD-WMS0102-OTBD-CLOSE                08450000
084600             PERFORM 9000-WRITE-OUTPUT-RECORD                     08460000
084700         END-IF                                                   08470000
084800     END-IF.                                                      08480000
084900                                                                  08490000
085000     PERFORM 1000-READ-INPUT-FILE.                                08500000
085100                                                                  08510000
085200******************************************************************08520000
085300* BUILDS THE JOB0100 RECORD                                      *08530000
085400******************************************************************08540000
085500 3000-BUILD-JOB0100.                                              08550000
085600                                                                  08560000
085700     INITIALIZE DL001-RECORD.                                     08570000
085800     SET PS-JOB0100-RECORD TO TRUE.                               08580000
085900     MOVE 'JOB0100'             TO DL001-JOB0100-RECORDTYPE.      08590000
086000     MOVE DL003-EVNT-KY-1-TXT   TO DL001-JOB0100-JOBCODEID.       08600000
086100***                                                               08610000
086200***  DISPLAY 'JOBCODEID = ' DL001-JOB0100-JOBCODEID.              08620000
086300***                                                               08630000
086400     MOVE DL003-CRE-BY-USR-ID   TO DL001-JOB0100-USR-ID.          08640000
086500     EXEC SQL                                                     08650000
086600        SET :PV-WORK-TMST                                         08660000
086700       = (TIMESTAMP(:DL003-EVNT-KY-1-TMST) + :PV-FUNC-QTY HOURS)  08670000
086800     END-EXEC.                                                    08680000
086900     MOVE PV-WORK-TMST          TO PV-INPUT-TMST.                 08690000
087000     MOVE PV-INPUT-TMST-YR      TO PV-PLAN-DATE-YR.               08700000
087100     MOVE PV-INPUT-TMST-MO      TO PV-PLAN-DATE-MO.               08710000
087200     MOVE PV-INPUT-TMST-DA      TO PV-PLAN-DATE-DA.               08720000
087300     MOVE PV-INPUT-TMST-HR      TO PV-START-TIME-HR.              08730000
087400     MOVE PV-INPUT-TMST-MN      TO PV-START-TIME-MN.              08740000
087500     MOVE PV-INPUT-TMST-SS      TO PV-START-TIME-SS.              08750000
087600     MOVE PV-START-TIME         TO DL001-JOB0100-START-TIME.      08760000
087700     MOVE PV-PLAN-DATE          TO DL001-JOB0100-PLAN-DATE.       08770000
087800******************************************************************08780000
087900* BUILDS THE WMS0102 RECORD FOR AN ASSIGNMENT CLOSE              *08790000
088000******************************************************************08800000
088100 3020-BUILD-WMS0102-ASSN-CLOSE.                                   08810000
088200     MOVE '3020-BUILD-WMS0102-ASSN-CLOSE'  TO PV-ABEND-PARAGRAPH. 08820000
088300     MOVE DL003-EVNT-KY-1-NBR       TO DK-ASGMT-NBR-SEQ-NBR.      08830000
088400     MOVE DL003-EVNT-KY-2-NBR       TO PV-SAVE-DC.                08840000
088500     MOVE DL003-EVNT-KY-1-TXT       TO DK-ASGMT-NBR-TXT.          08850000
088600     MOVE DL003-EVNT-KY-1-TMST      TO PV-INPUT-TMST.             08860000
088700     MOVE PV-INPUT-TMST-DATE        TO DK-ASGMT-STRT-DTE.         08870000
088800                                                                  08880000
088900     SET PS-NOT-END-OF-CURSOR TO TRUE.                            08890000
089000     PERFORM 5000-OPEN-ASSOCIATE-CURSOR.                          08900000
089100                                                                  08910000
089200     PERFORM UNTIL (PS-END-OF-CURSOR)                             08920000
089300         PERFORM 5100-FETCH-ASSOCIATE                             08930000
089400     END-PERFORM.                                                 08940000
089500                                                                  08950000
089600     PERFORM 5200-CLOSE-ASSOCIATE-CURSOR.                         08960000
089700                                                                  08970000
089800******************************************************************08980000
089900* BUILDS THE EMP0101 RECORD                                      *08990000
090000******************************************************************09000000
090100 3040-BUILD-EMP0101.                                              09010000
090200                                                                  09020000
090300***  DISPLAY 'NOW IN 3040-BUILD-EMP0101'.                         09030000
090400     SET PS-EMP0101-RECORD TO TRUE.                               09040000
090500     MOVE 'EMP0101'             TO DL006-EMP0101-RECORDTYPE.      09050000
090600     MOVE 'N'                   TO DL006-EMP0101-FUNCTION.        09060000
090700     MOVE DL003-EVNT-KY-1-TXT   TO DL006-EMP0101-USER-ID.         09070000
090800     MOVE DL003-EVNT-KY-2-TXT   TO DL006-EMP0101-LAST-NAME.       09080000
090900     MOVE DL003-EVNT-KY-3-TXT   TO DL006-EMP0101-FIRST-NAME.      09090000
091000     MOVE 'NONE'                TO DL006-EMP0101-SUPERVISOR-ID.   09100000
091100     MOVE 'N'                   TO DL006-EMP0101-SUPERVISOR.      09110000
091200     MOVE 'A'                   TO DL006-EMP0101-STATUS.          09120000
091300                                                                  09130000
091400 3050-BUILD-WMS0102-ASSN-USER.                                    09140000
091500******************************************************************09150000
091600* BUILDS THE WMS0102 RECORD FOR AN ASSIGNMENT USER ADD           *09160000
091700******************************************************************09170000
091800     MOVE '3050-BUILD-WMS0102-ASSN-USER '  TO PV-ABEND-PARAGRAPH. 09180000
091900     INITIALIZE DL002-RECORD.                                     09190000
092000     MOVE 'WMS0102'                 TO DL002-WMS0102-RECTYPE.     09200000
092100     MOVE PC-N                      TO DL002-WMS0102-FUNC-ID.     09210000
092220                                                                  09222000
092300     MOVE DL003-EVNT-KY-1-TXT       TO PV-ASSIGNMENT-1-10.        09230008
092400     MOVE DL003-EVNT-KY-1-NBR       TO PV-ASSIGNMENT-11-15.       09240008
092500     MOVE PV-ASSIGNMENT             TO DL002-WMS0102-ASSIGN-NUM.  09250008
092520     MOVE DL003-EVNT-KY-2-NBR       TO PV-SAVE-DC.                09252002
092600     MOVE PV-SAVE-DC                TO DL002-WMS0102-WAREHOUSE.   09260002
092610                                                                  09261002
092700     MOVE DL003-EVNT-KY-2-TXT       TO DL002-WMS0102-USR-ID.      09270000
092800     MOVE DL003-EVNT-KY-3-TXT       TO DL002-WMS0102-WORK-TYPE.   09280000
092900     MOVE DL003-EVNT-KY-4-TXT       TO DL002-WMS0102-LOCATION.    09290000
093000     MOVE 'MANUAL ADD'              TO DL002-WMS0102-REF-ID.      09300006
093100                                                                  09310000
093101* RPK - 07-24-2015 BEGIN                                          09310108
093110     EXEC SQL                                                     09311008
093120        SET :PV-WORK-TMST =                                       09312008
093130        (TIMESTAMP(:DL003-EVNT-KY-2-TMST) + :PV-FUNC-QTY HOURS)   09313009
093140     END-EXEC.                                                    09314008
093150                                                                  09315008
093194     MOVE PV-WORK-TMST          TO PV-INPUT-TMST.                 09319408
093195     MOVE PV-INPUT-TMST-YR(1:2) TO DL002-WMS0102-START-DATE-CC.   09319508
093196     MOVE PV-INPUT-TMST-YR(3:2) TO DL002-WMS0102-START-DATE-YY.   09319608
093197     MOVE PV-INPUT-TMST-MO      TO DL002-WMS0102-START-DATE-MM.   09319708
093198     MOVE PV-INPUT-TMST-DA      TO DL002-WMS0102-START-DATE-DD.   09319808
093199                                                                  09319908
093200     MOVE PV-INPUT-TMST-HR      TO PV-START-TIME-HR.              09320008
093201     MOVE PV-INPUT-TMST-MN      TO PV-START-TIME-MN.              09320108
093202     MOVE PV-INPUT-TMST-SS      TO PV-START-TIME-SS.              09320208
093203     MOVE PV-START-TIME         TO DL002-WMS0102-START-TIME.      09320308
093204* RPK - 07-24-2015 END                                            09320408
094300                                                                  09430000
094310* RPK - 07-24-2015 BEGIN                                          09431008
094400*    MOVE DL003-EVNT-KY-2-TMST      TO PV-WORK-TMST.              09440008
094401     MOVE DL003-EVNT-KY-1-TMST      TO PV-WORK-TMST.              09440108
094410* RPK - 07-24-2015 END                                            09441008
094500     MOVE PV-WORK-TMST              TO PV-INPUT-TMST.             09450008
094600     MOVE PV-INPUT-TMST-YR          TO DL002-WMS0102-PLAN-DATE-YY 09460000
094700     MOVE PV-INPUT-TMST-MO          TO DL002-WMS0102-PLAN-DATE-MM 09470000
094800     MOVE PV-INPUT-TMST-DA          TO DL002-WMS0102-PLAN-DATE-DD 09480000
094810                                                                  09481008
094900     MOVE DL003-TEAM-CODE           TO DL002-WMS0102-TEAM-CODE.   09490008
095000     MOVE DL003-TEAM-CODE-IND       TO DL002-WMS0102-TEAM-IND.    09500008
095100                                                                  09510000
095110* RPK - 07-24-2015 BEGIN                                          09511008
095200*    WRITE OUTPUT-RECORD4                                         09520008
095300*          FROM DL002-RECORD.                                     09530008
095301     IF  DL002-WMS0102-ONE                                        09530108
095302         NEXT SENTENCE                                            09530208
095303     ELSE                                                         09530308
095310         WRITE OUTPUT-RECORD4                                     09531008
095320          FROM DL002-RECORD                                       09532008
095321     END-IF.                                                      09532108
095330* RPK - 07-24-2015 END                                            09533008
095400******************************************************************09540000
095500* BUILDS THE WMS0102 RECORD FOR A RECEIVING TRAILER OPEN         *09550000
095600******************************************************************09560000
095700 3200-BUILD-WMS0102-TRLR-OPEN.                                    09570000
095800                                                                  09580000
095900     MOVE '3200-BUILD-WMS0102-TRLR-OPEN'   TO PV-ABEND-PARAGRAPH. 09590000
096000***  DISPLAY 'NOW IN 3200-BUILD-WMS0102'.                         09600000
096100     INITIALIZE DL002-RECORD.                                     09610000
096200     SET PS-WMS0102-RECORD TO TRUE.                               09620000
096300     MOVE DL003-EVNT-KY-1-NBR       TO DK-TRIP-ID.                09630000
096400     MOVE DL003-DTL-TXT-AREA        TO SU050-DTL-TXT.             09640000
096500     MOVE SU050-AA-ASGMT-STRT-DTE    TO DK-ASGMT-STRT-DTE         09650000
096600                                       PV-INPUT-TMST-DATE.        09660000
096700     MOVE SU050-AA-ASGMT-NBR-TXT     TO DK-ASGMT-NBR-TXT          09670000
096800                                       PV-ASSIGNMENT-1-10.        09680000
096900     MOVE SU050-AA-ASGMT-NBR-SEQ-NBR TO DK-ASGMT-NBR-SEQ-NBR      09690000
097000                                        PV-ASSIGNMENT-11-15.      09700000
097100     PERFORM 4000-SELECT-ASSIGNMENT.                              09710000
097200     PERFORM 4010-SELECTS-BY-TRIP-ID.                             09720000
097300     MOVE SU050-AA-DOOR-NBR          TO DL002-WMS0102-ROUTE-NUM.  09730000
097400     MOVE SU050-AA-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  09740000
097500     MOVE SU050-AA-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    09750000
097600     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    09760000
097700     MOVE 'O'                      TO DL002-WMS0102-OBTAIN-PLACE. 09770000
097800     MOVE 1                        TO DL002-WMS0102-SPEC-HAND-5.  09780000
097900     MOVE PC-N                   TO DL002-WMS0102-FUNC-ID.        09790000
098000     MOVE PV-INPUT-TMST-YR       TO PV-PLAN-DATE-YR.              09800000
098100     MOVE PV-INPUT-TMST-MO       TO PV-PLAN-DATE-MO.              09810000
098200     MOVE PV-INPUT-TMST-DA       TO PV-PLAN-DATE-DA.              09820000
098300     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      09830000
098400     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     09840000
098500*****                                                             09850000
098600     MOVE DL003-CRE-BY-USR-ID    TO PV-DL002-WMS0102-USR-ID.      09860000
098700                                                                  09870000
098800******************************************************************09880000
098900* BUILDS THE WMS0102 RECORD FOR A CARTON CHECKIN                 *09890000
099000******************************************************************09900000
099100 3300-BUILD-WMS0102-CRTN-CHKIN.                                   09910000
099200                                                                  09920000
099300     MOVE '3300-BUILD-WMS0102-CRTN-CHKIN' TO PV-ABEND-PARAGRAPH.  09930000
099400***  DISPLAY 'NOW IN 3300-BUILD-WMS0102'.                         09940000
099500     INITIALIZE DL002-RECORD.                                     09950000
099600     SET PS-WMS0102-RECORD TO TRUE.                               09960000
099700     MOVE DL003-EVNT-KY-1-NBR       TO DK-SHIP-UNT-ID             09970000
099800                                       PV-DISPLAY-SHIP-UNT-ID.    09980000
099900     MOVE DL003-EVNT-KY-2-NBR       TO DK-TRIP-ID.                09990000
100000     MOVE DL003-DTL-TXT-AREA        TO SU050-DTL-TXT.             10000000
100100     MOVE SU050-AB-ASGMT-STRT-DTE    TO DK-ASGMT-STRT-DTE         10010000
100200                                       PV-INPUT-TMST-DATE.        10020000
100300     MOVE SU050-AB-ASGMT-NBR-TXT     TO DK-ASGMT-NBR-TXT          10030000
100400                                       PV-ASSIGNMENT-1-10.        10040000
100500     MOVE SU050-AB-ASGMT-NBR-SEQ-NBR TO DK-ASGMT-NBR-SEQ-NBR      10050000
100600                                        PV-ASSIGNMENT-11-15.      10060000
100700     PERFORM 4000-SELECT-ASSIGNMENT.                              10070000
100800     PERFORM 4020-SELECTS-BY-SHIP-UNT-ID.                         10080000
100900     PERFORM 4030-SELECT-TVHTRIP.                                 10090000
101000     PERFORM 4040-SELECT-TSHUUPC-FOR-UNITS.                       10100000
101100     PERFORM 4050-SELECT-TSHUUPC-UPC-DEPT.                        10110000
101200     MOVE SU050-AB-DOOR-NBR          TO DL002-WMS0102-ROUTE-NUM.  10120000
101300     MOVE SU050-AB-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  10130000
101400     MOVE SU050-AB-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    10140000
101500     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    10150000
101600     MOVE 1                    TO DL002-WMS0102-CONT-2.           10160000
101700     MOVE 'O'                  TO DL002-WMS0102-OBTAIN-PLACE.     10170000
101800     IF SU050-AB-CRTN-FREE-ASTRAY                                 10180000
101900         MOVE 'P'                  TO DL002-WMS0102-OBTAIN-PLACE  10190000
102000         MOVE 1                    TO DL002-WMS0102-CONT-1        10200000
102100         MOVE 0                    TO DL002-WMS0102-CONT-2        10210000
102200         MOVE ZEROS                TO DL002-WMS0102-SHIP-UNITS    10220000
102300                                      DL002-WMS0102-CUBE          10230000
102400                                      DL002-WMS0102-WEIGHT        10240000
102500     ELSE                                                         10250000
102600     IF SU050-AB-CRTN-TO-LOC                                      10260000
102700         CONTINUE                                                 10270000
102800***      MOVE SU050-AB-CRTN-DEST-LOC-NBR                          10280000
102900***                                TO DL002-WMS0102-CUST-NO       10290000
103000     ELSE                                                         10300000
103100     IF SU050-AB-CRTN-TO-MULT-LOC OR                              10310000
103200        DL002-WMS0102-USER-DEF-3 = 'INNER'                        10320000
103300         CONTINUE                                                 10330000
103400***      MOVE 'MULTI'              TO DL002-WMS0102-CUST-NO       10340000
103500     ELSE                                                         10350000
103600     IF SU050-AB-CRTN-TO-P2L                                      10360000
103700         MOVE SU050-AB-P2L-MODU-DESC TO PV-MODU-DESC              10370000
103800         IF PV-MODU-P2L                                           10380000
103900             CONTINUE                                             10390000
104000***          STRING 'P2L-'             DELIMITED BY SIZE          10400000
104100***          SU050-AB-STR-ZN-ID        DELIMITED BY SIZE          10410000
104200***                               INTO DL002-WMS0102-CUST-NO      10420000
104300         ELSE                                                     10430000
104400         IF PV-MODU-RFP                                           10440000
104500             CONTINUE                                             10450000
104600***          STRING 'RFP-'             DELIMITED BY SIZE          10460000
104700***          SU050-AB-STR-ZN-ID        DELIMITED BY SIZE          10470000
104800***                                  INTO DL002-WMS0102-CUST-NO   10480000
104900         ELSE                                                     10490000
105000         IF PV-MODU-HRTW                                          10500000
105100             CONTINUE                                             10510000
105200***          STRING 'HRTW-'            DELIMITED BY SIZE          10520000
105300***          SU050-AB-STR-ZN-ID        DELIMITED BY SIZE          10530000
105400***                                  INTO DL002-WMS0102-CUST-NO   10540000
105500         ELSE                                                     10550000
105600         IF PV-MODU-CAGE                                          10560000
105700             CONTINUE                                             10570000
105800***          STRING 'CAGE-'            DELIMITED BY SIZE          10580000
105900***          SU050-AB-STR-ZN-ID        DELIMITED BY SIZE          10590000
106000***                                  INTO DL002-WMS0102-CUST-NO   10600000
106100         END-IF                                                   10610000
106200     END-IF.                                                      10620000
106300     IF SU050-AB-CRTN-AUDIT-NEEDED                                10630000
106400         MOVE 1                    TO DL002-WMS0102-SPEC-HAND-2   10640000
106500     END-IF.                                                      10650000
106600     MOVE PC-N                   TO DL002-WMS0102-FUNC-ID.        10660000
106700     MOVE PV-INPUT-TMST-YR       TO PV-PLAN-DATE-YR.              10670000
106800     MOVE PV-INPUT-TMST-MO       TO PV-PLAN-DATE-MO.              10680000
106900     MOVE PV-INPUT-TMST-DA       TO PV-PLAN-DATE-DA.              10690000
107000     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      10700000
107100     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     10710000
107200     MOVE PV-DISPLAY-SHIP-UNT-ID TO DL002-WMS0102-USER-DEF-4.     10720000
107300                                                                  10730000
107400******************************************************************10740000
107500* BUILDS THE WMS0102 RECORD FOR A CARTON RECLAIM                 *10750000
107600******************************************************************10760000
107700 3400-BUILD-WMS0102-CRTN-RECLM.                                   10770000
107800                                                                  10780000
107900     MOVE '3400-BUILD-WMS0102-CRTN-RECLM' TO PV-ABEND-PARAGRAPH.  10790000
108000***  DISPLAY 'NOW IN 3400-BUILD-WMS0102'.                         10800000
108100     INITIALIZE DL002-RECORD.                                     10810000
108200     SET PS-WMS0102-RECORD TO TRUE.                               10820000
108300     MOVE DL003-EVNT-KY-1-NBR       TO DK-SHIP-UNT-ID             10830000
108400                                       PV-DISPLAY-SHIP-UNT-ID.    10840000
108500     MOVE DL003-EVNT-KY-2-NBR       TO DK-TRIP-ID.                10850000
108600     MOVE DL003-DTL-TXT-AREA        TO SU050-DTL-TXT.             10860000
108700     MOVE SU050-AC-ASGMT-STRT-DTE    TO DK-ASGMT-STRT-DTE         10870000
108800                                       PV-INPUT-TMST-DATE.        10880000
108900     MOVE SU050-AC-ASGMT-NBR-TXT     TO DK-ASGMT-NBR-TXT          10890000
109000                                       PV-ASSIGNMENT-1-10.        10900000
109100     MOVE SU050-AC-ASGMT-NBR-SEQ-NBR TO DK-ASGMT-NBR-SEQ-NBR      10910000
109200                                        PV-ASSIGNMENT-11-15.      10920000
109300     PERFORM 4000-SELECT-ASSIGNMENT.                              10930000
109400     PERFORM 4020-SELECTS-BY-SHIP-UNT-ID.                         10940000
109500     PERFORM 4030-SELECT-TVHTRIP.                                 10950000
109600     IF PS-REGULAR-UPC                                            10960000
109700         PERFORM 4040-SELECT-TSHUUPC-FOR-UNITS                    10970000
109800         PERFORM 4050-SELECT-TSHUUPC-UPC-DEPT                     10980000
109900     ELSE                                                         10990000
110000         PERFORM 4055-SELECT-OTBND-FOR-UNITS                      11000000
110100         PERFORM 4056-SELECT-OTBND-UPC-DEPT                       11010000
110200     END-IF.                                                      11020000
110300     MOVE SU050-AC-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  11030000
110400     MOVE SU050-AC-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    11040000
110500     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    11050000
110600     MOVE 'O'                  TO DL002-WMS0102-OBTAIN-PLACE.     11060000
110700     MOVE 1                    TO DL002-WMS0102-CONT-1.           11070000
110800     MOVE ZEROS                TO DL002-WMS0102-SHIP-UNITS        11080000
110900                                  DL002-WMS0102-CUBE              11090000
111000                                  DL002-WMS0102-WEIGHT.           11100000
111100     MOVE PC-N                   TO DL002-WMS0102-FUNC-ID.        11110000
111200     MOVE PV-INPUT-TMST-YR       TO PV-PLAN-DATE-YR.              11120000
111300     MOVE PV-INPUT-TMST-MO       TO PV-PLAN-DATE-MO.              11130000
111400     MOVE PV-INPUT-TMST-DA       TO PV-PLAN-DATE-DA.              11140000
111500     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      11150000
111600     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     11160000
111700     MOVE PV-DISPLAY-SHIP-UNT-ID TO DL002-WMS0102-USER-DEF-4.     11170000
111800     IF SU050-AC-CRTN-TO-LOC                                      11180000
111900         CONTINUE                                                 11190000
112000***      MOVE SU050-AC-CRTN-DEST-LOC-NBR                          11200000
112100***                                TO DL002-WMS0102-CUST-NO       11210000
112200     END-IF.                                                      11220000
112300                                                                  11230000
112400******************************************************************11240000
112500* BUILDS THE WMS0102 RECORD FOR A CARTON AUDIT                   *11250000
112600******************************************************************11260000
112700 3500-BUILD-WMS0102-CRTN-AUDIT.                                   11270000
112800                                                                  11280000
112900     MOVE '3500-BUILD-WMS0102-CRTN-AUDIT' TO PV-ABEND-PARAGRAPH.  11290000
113000***  DISPLAY 'NOW IN 3500-BUILD-WMS0102'.                         11300000
113100     INITIALIZE DL002-RECORD.                                     11310000
113200     SET PS-WMS0102-RECORD TO TRUE.                               11320000
113300     MOVE DL003-EVNT-KY-1-NBR       TO DK-SHIP-UNT-ID             11330000
113400                                       PV-DISPLAY-SHIP-UNT-ID.    11340000
113500     MOVE DL003-EVNT-KY-2-NBR       TO DK-TRIP-ID.                11350000
113600**** MOVE DL003-EVNT-KY-3-NBR       TO DL002-WMS0102-USER-DEF-1.  11360000
113700     MOVE DL003-DTL-TXT-AREA        TO SU050-DTL-TXT.             11370000
113800     MOVE SU050-AD-ASGMT-STRT-DTE    TO DK-ASGMT-STRT-DTE         11380000
113900                                       PV-INPUT-TMST-DATE.        11390000
114000     MOVE SU050-AD-ASGMT-NBR-TXT     TO DK-ASGMT-NBR-TXT          11400000
114100                                       PV-ASSIGNMENT-1-10.        11410000
114200     MOVE SU050-AD-ASGMT-NBR-SEQ-NBR TO DK-ASGMT-NBR-SEQ-NBR      11420000
114300                                        PV-ASSIGNMENT-11-15.      11430000
114400     PERFORM 4000-SELECT-ASSIGNMENT.                              11440000
114500     PERFORM 4020-SELECTS-BY-SHIP-UNT-ID.                         11450000
114600     PERFORM 4030-SELECT-TVHTRIP.                                 11460000
114700     PERFORM 4040-SELECT-TSHUUPC-FOR-UNITS.                       11470000
114800     PERFORM 4050-SELECT-TSHUUPC-UPC-DEPT.                        11480000
114900     MOVE SU050-AD-DOOR-NBR          TO DL002-WMS0102-ROUTE-NUM.  11490000
115000     MOVE SU050-AD-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  11500000
115100     MOVE SU050-AD-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    11510000
115200     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    11520000
115300     MOVE 'O'                  TO DL002-WMS0102-OBTAIN-PLACE.     11530000
115400     MOVE PC-N                   TO DL002-WMS0102-FUNC-ID.        11540000
115500     MOVE PV-INPUT-TMST-YR       TO PV-PLAN-DATE-YR.              11550000
115600     MOVE PV-INPUT-TMST-MO       TO PV-PLAN-DATE-MO.              11560000
115700     MOVE PV-INPUT-TMST-DA       TO PV-PLAN-DATE-DA.              11570000
115800     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      11580000
115900     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     11590000
116000     MOVE PV-DISPLAY-SHIP-UNT-ID TO DL002-WMS0102-USER-DEF-4.     11600000
116100     IF SU050-AD-CRTN-TO-LOC                                      11610000
116200         CONTINUE                                                 11620000
116300***      MOVE SU050-AD-CRTN-DEST-LOC-NBR                          11630000
116400***                                TO DL002-WMS0102-CUST-NO       11640000
116500     END-IF.                                                      11650000
116600     IF DL002-WMS0102-USER-DEF-3 = 'BULK' OR 'CASE'               11660000
116700         MOVE 1                    TO DL002-WMS0102-SPEC-HAND-1   11670000
116800         IF SU050-AD-AUDIT-QTY > 999                              11680000
116900             MOVE 999                  TO DL002-WMS0102-HUNIT-1   11690000
117000         ELSE                                                     11700000
117100             MOVE SU050-AD-AUDIT-QTY   TO DL002-WMS0102-HUNIT-1   11710000
117200         END-IF                                                   11720000
117300     ELSE                                                         11730000
117400     IF DL002-WMS0102-USER-DEF-3 = 'MULTI' OR 'PBS' OR 'SINGL'    11740000
117500         MOVE 1                    TO DL002-WMS0102-SPEC-HAND-1   11750000
117600         MOVE SU050-AD-AUDIT-QTY       TO DL002-WMS0102-HUNIT-2   11760000
117700     ELSE                                                         11770000
117800     IF DL002-WMS0102-USER-DEF-3 = 'INNER'                        11780000
117900         MOVE 1                    TO DL002-WMS0102-SPEC-HAND-1   11790000
118000         MOVE SU050-AD-AUDIT-QTY       TO DL002-WMS0102-HUNIT-3   11800000
118100     END-IF.                                                      11810000
118200     MOVE ZEROS                TO DL002-WMS0102-SHIP-UNITS        11820000
118300                                  DL002-WMS0102-CUBE              11830000
118400                                  DL002-WMS0102-WEIGHT.           11840000
118500                                                                  11850000
118600******************************************************************11860000
118700* BUILDS THE WMS0102 RECORD FOR A CARTON CHECKIN PRINT           *11870000
118800******************************************************************11880000
118900 3600-BUILD-WMS0102-CRTN-PRINT.                                   11890000
119000                                                                  11900000
119100     MOVE '3600-BUILD-WMS0102-CRTN-PRINT'  TO PV-ABEND-PARAGRAPH. 11910000
119200***  DISPLAY 'NOW IN 3600-BUILD-WMS0102'.                         11920000
119300     INITIALIZE DL002-RECORD.                                     11930000
119400     SET PS-WMS0102-RECORD TO TRUE.                               11940000
119500     MOVE DL003-EVNT-KY-1-NBR       TO DK-TRIP-ID.                11950000
119600     MOVE DL003-DTL-TXT-AREA        TO SU050-DTL-TXT.             11960000
119700     MOVE SU050-AG-ASGMT-STRT-DTE    TO DK-ASGMT-STRT-DTE         11970000
119800                                       PV-INPUT-TMST-DATE.        11980000
119900     MOVE SU050-AG-ASGMT-NBR-TXT     TO DK-ASGMT-NBR-TXT          11990000
120000                                       PV-ASSIGNMENT-1-10.        12000000
120100     MOVE SU050-AG-ASGMT-NBR-SEQ-NBR TO DK-ASGMT-NBR-SEQ-NBR      12010000
120200                                        PV-ASSIGNMENT-11-15.      12020000
120300     PERFORM 4000-SELECT-ASSIGNMENT.                              12030000
120400     PERFORM 4010-SELECTS-BY-TRIP-ID.                             12040000
120500     MOVE SU050-AG-DOOR-NBR          TO PV-ROUTE.                 12050000
120600     IF PV-ROUTE-2-4 = LOW-VALUES                                 12060000
120700         MOVE SPACES                 TO DL002-WMS0102-ROUTE-NUM   12070000
120800     ELSE                                                         12080000
120900         MOVE SU050-AG-DOOR-NBR      TO DL002-WMS0102-ROUTE-NUM   12090000
121000     END-IF.                                                      12100000
121100     MOVE SU050-AG-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  12110000
121200     MOVE SU050-AG-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    12120000
121300     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    12130000
121400     MOVE 'O'                      TO DL002-WMS0102-OBTAIN-PLACE. 12140000
121500     MOVE 1                        TO DL002-WMS0102-SPEC-HAND-3.  12150000
121600     MOVE PC-N                   TO DL002-WMS0102-FUNC-ID.        12160000
121700     MOVE PV-INPUT-TMST-YR       TO PV-PLAN-DATE-YR.              12170000
121800     MOVE PV-INPUT-TMST-MO       TO PV-PLAN-DATE-MO.              12180000
121900     MOVE PV-INPUT-TMST-DA       TO PV-PLAN-DATE-DA.              12190000
122000     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      12200000
122100     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     12210000
122200                                                                  12220000
122300******************************************************************12230000
122400* BUILDS THE WMS0102 RECORD FOR A PO DOWNLOAD                    *12240000
122500******************************************************************12250000
122600 3700-BUILD-WMS0102-PO-DWNLD.                                     12260000
122700                                                                  12270000
122800     MOVE '3700-BUILD-WMS0102-PO-DWNLD'   TO PV-ABEND-PARAGRAPH.  12280000
122900***  DISPLAY 'NOW IN 3700-BUILD-WMS0102'.                         12290000
123000     INITIALIZE DL002-RECORD.                                     12300000
123100     SET PS-WMS0102-RECORD TO TRUE.                               12310000
123200     MOVE DL003-EVNT-KY-1-NBR       TO DK-PO-NBR.                 12320000
123300     MOVE DL003-EVNT-KY-3-NBR       TO DK-TRIP-ID.                12330000
123400     MOVE DL003-DTL-TXT-AREA        TO PC242-DTL-TXT.             12340000
123500     MOVE PC242-AA-ASGMT-STRT-DTE    TO DK-ASGMT-STRT-DTE         12350000
123600                                       PV-INPUT-TMST-DATE.        12360000
123700     MOVE PC242-AA-ASGMT-NBR-TXT     TO DK-ASGMT-NBR-TXT          12370000
123800                                       PV-ASSIGNMENT-1-10.        12380000
123900     MOVE PC242-AA-ASGMT-NBR-SEQ-NBR TO DK-ASGMT-NBR-SEQ-NBR      12390000
124000                                        PV-ASSIGNMENT-11-15.      12400000
124100     PERFORM 4000-SELECT-ASSIGNMENT.                              12410000
124200     PERFORM 4010-SELECTS-BY-TRIP-ID.                             12420000
124300     PERFORM 4090-SELECT-TPURCHS-FOR-ENTID.                       12430000
124400     MOVE DL003-EVNT-KY-1-NBR       TO PV-PO-NBR.                 12440000
124500     MOVE DL003-EVNT-KY-2-NBR       TO PV-REC-SEQ.                12450000
124600     STRING PV-PO-NBR              DELIMITED BY SIZE              12460000
124700            '-'                    DELIMITED BY SIZE              12470000
124800            PV-REC-SEQ             DELIMITED BY SIZE              12480000
124900                             INTO DL002-WMS0102-USER-DEF-5.       12490000
125000     MOVE PC242-AA-PACK-TYPE-CDE    TO PV-PACK-TYPE.              12500000
125100     PERFORM 6000-CHECK-PKGNG-CDE.                                12510000
125200     MOVE PC242-AA-DOOR-NBR          TO DL002-WMS0102-ROUTE-NUM.  12520000
125300     MOVE PC242-AA-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  12530000
125400     MOVE PC242-AA-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    12540000
125500     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    12550000
125600     MOVE 'O'                      TO DL002-WMS0102-OBTAIN-PLACE. 12560000
125700     MOVE 1                        TO DL002-WMS0102-SPEC-HAND-4.  12570000
125800     MOVE PC-N                   TO DL002-WMS0102-FUNC-ID.        12580000
125900     MOVE PV-INPUT-TMST-YR       TO PV-PLAN-DATE-YR.              12590000
126000     MOVE PV-INPUT-TMST-MO       TO PV-PLAN-DATE-MO.              12600000
126100     MOVE PV-INPUT-TMST-DA       TO PV-PLAN-DATE-DA.              12610000
126200     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      12620000
126300     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     12630000
126400                                                                  12640000
126500******************************************************************12650000
126600* BUILDS THE WMS0102 RECORD FOR A CARTON NON UCC PRINT           *12660000
126700******************************************************************12670000
126800 3800-BUILD-WMS0102-NOUCC-PRINT.                                  12680000
126900                                                                  12690000
127000     MOVE '3800-BUILD-WMS0102-NOUCC-PRINT' TO PV-ABEND-PARAGRAPH. 12700000
127100***  DISPLAY 'NOW IN 3800-BUILD-WMS0102'.                         12710000
127200     INITIALIZE DL002-RECORD.                                     12720000
127300     SET PS-WMS0102-RECORD TO TRUE.                               12730000
127400     MOVE DL003-EVNT-KY-1-NBR       TO DK-PO-NBR.                 12740000
127500     MOVE DL003-EVNT-KY-4-NBR       TO DK-TRIP-ID.                12750000
127600     MOVE DL003-DTL-TXT-AREA        TO PC242-DTL-TXT.             12760000
127700     MOVE PC242-AD-ASGMT-STRT-DTE    TO DK-ASGMT-STRT-DTE         12770000
127800                                       PV-INPUT-TMST-DATE.        12780000
127900     MOVE PC242-AD-ASGMT-NBR-TXT     TO DK-ASGMT-NBR-TXT          12790000
128000                                       PV-ASSIGNMENT-1-10.        12800000
128100     MOVE PC242-AD-ASGMT-NBR-SEQ-NBR TO DK-ASGMT-NBR-SEQ-NBR      12810000
128200                                        PV-ASSIGNMENT-11-15.      12820000
128300     PERFORM 4000-SELECT-ASSIGNMENT.                              12830000
128400     PERFORM 4010-SELECTS-BY-TRIP-ID.                             12840000
128500     PERFORM 4090-SELECT-TPURCHS-FOR-ENTID.                       12850000
128600     MOVE DL003-EVNT-KY-1-NBR       TO PV-PO-NBR.                 12860000
128700     MOVE DL003-EVNT-KY-2-NBR       TO PV-REC-SEQ.                12870000
128800     STRING PV-PO-NBR              DELIMITED BY SIZE              12880000
128900            '-'                    DELIMITED BY SIZE              12890000
129000            PV-REC-SEQ             DELIMITED BY SIZE              12900000
129100                             INTO DL002-WMS0102-USER-DEF-5.       12910000
129200     MOVE PC242-AD-PACK-TYPE-CDE    TO PV-PACK-TYPE.              12920000
129300     PERFORM 6000-CHECK-PKGNG-CDE.                                12930000
129400     MOVE PC242-AD-DOOR-NBR          TO DL002-WMS0102-ROUTE-NUM.  12940000
129500     MOVE PC242-AD-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  12950000
129600     MOVE PC242-AD-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    12960000
129700     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    12970000
129800     MOVE 'O'                      TO DL002-WMS0102-OBTAIN-PLACE. 12980000
129900     MOVE PC-N                   TO DL002-WMS0102-FUNC-ID.        12990000
130000     MOVE PV-INPUT-TMST-YR       TO PV-PLAN-DATE-YR.              13000000
130100     MOVE PV-INPUT-TMST-MO       TO PV-PLAN-DATE-MO.              13010000
130200     MOVE PV-INPUT-TMST-DA       TO PV-PLAN-DATE-DA.              13020000
130300     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      13030000
130400     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     13040000
130500     IF PC242-AD-CRSDCK-UNIT-QTY = 0                              13050000
130600         MOVE PC242-AD-P2L-UNIT-QTY                               13060000
130700                               TO DL002-WMS0102-SHIP-UNITS        13070000
130800         MOVE PC242-AD-P2L-LABEL-QTY                              13080000
130900                               TO DL002-WMS0102-HUNIT-2           13090000
131000     ELSE                                                         13100000
131100         MOVE PC242-AD-CRSDCK-UNIT-QTY                            13110000
131200                               TO DL002-WMS0102-SHIP-UNITS        13120000
131300         MOVE PC242-AD-CRSDCK-LABEL-QTY                           13130000
131400                               TO DL002-WMS0102-HUNIT-2           13140000
131500     END-IF.                                                      13150000
131600                                                                  13160000
131700****************************************************************  13170000
131800*  SELECT DLT ASSIGNMENT AND ASSOCIATE WITH BUSINESS EVENT     *  13180000
131900*                                                              *  13190000
132000****************************************************************  13200000
132100 4000-SELECT-ASSIGNMENT.                                          13210000
132200     MOVE '4000-SELECT-ASSIGNMENT'  TO PV-ABEND-PARAGRAPH.        13220000
132300     PERFORM                                                      13230000
132400         WITH TEST AFTER                                          13240000
132500             VARYING PV-RETRY-COUNTER                             13250000
132600             FROM 1 BY 1                                          13260000
132700             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              13270000
132800                OR SQLCODE = ZERO                                 13280000
132900                OR SQLCODE = +100                                 13290000
133000                OR SQLCODE = -811                                 13300000
133100                                                                  13310000
133200         EXEC SQL                                                 13320000
133300             SELECT                                               13330000
133400                    ASGMT.WK_TYP_DESC                             13340000
133500                   ,ASGMT.WK_AREA_DESC                            13350000
133600                   ,ASGMT.DC_NBR                                  13360000
133700                   ,ASGMT_STRT_TM                                 13370000
133800              INTO                                                13380000
133900                    :DLT00004-WK-TYP-DESC                         13390000
134000                   ,:DLT00004-WK-AREA-DESC                        13400000
134100                   ,:DLT00004-DC-NBR                              13410000
134200                   ,:DLT00004-ASGMT-STRT-TM                       13420000
134300              FROM  DLT_ASGMT       ASGMT                         13430000
134400                                                                  13440000
134500              WHERE ASGMT.ASGMT_STRT_DTE = :DK-ASGMT-STRT-DTE     13450000
134600               AND  ASGMT.ASGMT_NBR_TXT  = :DK-ASGMT-NBR-TXT      13460000
134700               AND  ASGMT.ASGMT_NBR_SEQ_NBR                       13470000
134800                                         = :DK-ASGMT-NBR-SEQ-NBR  13480000
134900              WITH UR                                             13490000
135000         END-EXEC                                                 13500000
135100                                                                  13510000
135200         EVALUATE TRUE                                            13520000
135300             WHEN SQLCODE = ZERO                                  13530000
135400             WHEN SQLCODE = -811                                  13540000
135500             WHEN SQLCODE = +100                                  13550000
135600             WHEN SQLCODE = -904                                  13560000
135700             WHEN SQLCODE = -913                                  13570000
135800             WHEN SQLCODE = -911                                  13580000
135900                  CONTINUE                                        13590000
136000                                                                  13600000
136100             WHEN SQLWARN0 NOT = SPACES                           13610000
136200             WHEN SQLCODE NOT = ZERO                              13620000
136300                  MOVE +4             TO PV-RETRY-COUNTER         13630000
136400         END-EVALUATE                                             13640000
136500     END-PERFORM.                                                 13650000
136600                                                                  13660000
136700     IF SQLCODE = ZERO OR -811                                    13670000
136800        MOVE DLT00004-WK-TYP-DESC   TO DL002-WMS0102-WORK-TYPE    13680000
136900        MOVE DK-ASGMT-NBR-TXT       TO PV-ASGMT-NBR-TXT           13690000
137000        IF PV-ASGMT-NBR-TXT-5-10 = 'RECV1 '                       13700000
137100            MOVE 'RECV1 '           TO DL002-WMS0102-WORK-TYPE    13710000
137200        END-IF                                                    13720000
137300        IF PV-ASGMT-NBR-TXT-5-10 = 'P2L1  '                       13730000
137400            MOVE 'P2L1  '           TO DL002-WMS0102-WORK-TYPE    13740000
137500        END-IF                                                    13750000
137600        MOVE DLT00004-DC-NBR        TO DL002-WMS0102-WAREHOUSE    13760000
137700        MOVE DLT00004-WK-AREA-DESC  TO PV-WORK-AREA               13770000
137800        IF PV-FQA                                                 13780000
137900            MOVE SPACES             TO PV-WORK-AREA-5-20          13790000
138000            MOVE PV-WORK-AREA       TO DL002-WMS0102-LOCATION     13800000
138100        ELSE                                                      13810000
138200        IF PV-P2L                                                 13820000
138300            MOVE SPACES             TO PV-WORK-AREA-10-20         13830000
138400            MOVE PV-WORK-AREA       TO DL002-WMS0102-LOCATION     13840000
138500        ELSE                                                      13850000
138600        IF PV-DOORFLAT OR PV-DOORCAGE OR PV-DOORTRBL OR           13860000
138700           PV-DOORPLT  OR PV-DOORMISC OR PV-DOOR2LFT OR           13870000
138800           PV-DOORSETS OR PV-DOORSPEC OR PV-DOORFLOW OR           13880000
138900           PV-DOORSHTL OR PV-DOORCONS OR PV-DOORSTRP OR           13890000
139000           PV-DOORJEWL OR PV-DOORCPBS                             13900000
139100            MOVE SPACES             TO PV-WORK-AREA-9-20          13910000
139200            MOVE PV-WORK-AREA       TO DL002-WMS0102-LOCATION     13920000
139300        ELSE                                                      13930000
139400        IF PV-RLABL                                               13940000
139500            MOVE SPACES             TO PV-WORK-AREA-6-20          13950000
139600            MOVE PV-WORK-AREA       TO DL002-WMS0102-LOCATION     13960000
139700        ELSE                                                      13970000
139800                                                                  13980000
139900        IF DL003-EVNT-OBJ-ACTN-TXT = 'ADD MASTER'   OR            13990000
140000         DL003-EVNT-OBJ-ACTN-TXT = 'ADD CHILD TO MASTER' OR       14000000
140100         DL003-EVNT-OBJ-ACTN-TXT = 'ADD MASTER TO MASTER' OR      14010000
140200         DL003-EVNT-OBJ-ACTN-TXT = 'REMOVE CHILD FROM MASTER' OR  14020000
140300         DL003-EVNT-OBJ-ACTN-TXT = 'REMOVE MASTER FROM MASTER' OR 14030000
140400         DL003-EVNT-OBJ-ACTN-TXT = 'REASSIGN TO MASTER'           14040000
140500                                                                  14050000
140600          MOVE SPACES TO PV-WORK-AREA-8-20                        14060000
140700          MOVE PV-WORK-AREA TO DL002-WMS0102-LOCATION             14070000
140800                                                                  14080000
140900       ELSE                                                       14090000
141000           MOVE PV-WORK-AREA       TO DL002-WMS0102-LOCATION      14100000
141100       END-IF                                                     14110000
141200     ELSE                                                         14120000
141300                                                                  14130000
141400     IF SQLCODE = +100                                            14140000
141500         MOVE DK-ASGMT-NBR-SEQ-NBR  TO PV-DISPLAY-SEQ-NBR         14150000
141600         STRING 'ASSIGNMENT INFO * '    DELIMITED BY SIZE         14160000
141700                'START DATE = '         DELIMITED BY SIZE         14170000
141800                 DK-ASGMT-STRT-DTE      DELIMITED BY SIZE         14180000
141900                ' ASSIGNMENT NUM = '    DELIMITED BY SIZE         14190000
142000                 DK-ASGMT-NBR-TXT       DELIMITED BY SIZE         14200000
142100                ' SEQ NUM = '           DELIMITED BY SIZE         14210000
142200                 PV-DISPLAY-SEQ-NBR     DELIMITED BY SIZE         14220000
142300                                   INTO PV-DB2-OPERATION-MESSAGE-214230000
142400         MOVE SQLCODE               TO PV-SQLCODE                 14240000
142500         MOVE 'SELECT ASSIGNMENT - NOT FOUND'                     14250000
142600                                   TO PV-DB2-OPERATION-MESSAGE-1  14260000
142700         MOVE 'DLT_ASGMT'    TO PV-DB2-TABLE-NAME                 14270000
142800         PERFORM 9999-SQL-ABEND                                   14280000
142900     ELSE                                                         14290000
143000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         14300000
143100         MOVE DK-ASGMT-NBR-SEQ-NBR  TO PV-DISPLAY-SEQ-NBR         14310000
143200         STRING 'ASSIGNMENT INFO * '    DELIMITED BY SIZE         14320000
143300                'START DATE = '         DELIMITED BY SIZE         14330000
143400                 DK-ASGMT-STRT-DTE      DELIMITED BY SIZE         14340000
143500                ' ASSIGNMENT NUM = '    DELIMITED BY SIZE         14350000
143600                 DK-ASGMT-NBR-TXT       DELIMITED BY SIZE         14360000
143700                ' SEQ NUM = '           DELIMITED BY SIZE         14370000
143800                 PV-DISPLAY-SEQ-NBR     DELIMITED BY SIZE         14380000
143900                                   INTO PV-DB2-OPERATION-MESSAGE-214390000
144000         MOVE SQLCODE               TO PV-SQLCODE                 14400000
144100         MOVE 'SELECT ASSIGNMENT'  TO PV-DB2-OPERATION-MESSAGE-1  14410000
144200         MOVE 'DLT_ASGMT'    TO PV-DB2-TABLE-NAME                 14420000
144300         PERFORM 9999-SQL-ABEND                                   14430000
144400     END-IF.                                                      14440000
144500                                                                  14450000
144600****************************************************************  14460000
144700*                                                              *  14470000
144800*                                                              *  14480000
144900****************************************************************  14490000
145000 4010-SELECTS-BY-TRIP-ID.                                         14500000
145100     MOVE '4010-SELECTS-BY-TRIP-ID' TO PV-ABEND-PARAGRAPH.        14510000
145200***  DISPLAY 'NOW IN 4010-SELECTS-BY-TRIP-ID'.                    14520000
145300                                                                  14530000
145400     PERFORM                                                      14540000
145500         WITH TEST AFTER                                          14550000
145600             VARYING PV-RETRY-COUNTER                             14560000
145700             FROM 1 BY 1                                          14570000
145800             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              14580000
145900                OR SQLCODE = ZERO                                 14590000
146000                OR SQLCODE = +100                                 14600000
146100                OR SQLCODE = -811                                 14610000
146200                                                                  14620000
146300         EXEC SQL                                                 14630000
146400             SELECT DISTINCT                                      14640000
146500                    C.PO_NBR                                      14650000
146600                  , C.REC_SEQ_NBR                                 14660000
146700                  , D.PKGNG_CDE                                   14670000
146800                  , D.PACK_BY_ST_IND                              14680000
146900                  , E.ENT_ID                                      14690000
147000                  , A.OWNER_SCAC_ID                               14700000
147100                  , A.VEH_NBR                                     14710000
147200              INTO  :SHPTPO-PO-NBR                                14720000
147300                   ,:SHPTPO-REC-SEQ-NBR                           14730000
147400                   ,:RECEIV-PKGNG-CDE                             14740000
147500                   ,:RECEIV-PACK-BY-ST-IND                        14750000
147600                   ,:PURCHS-ENT-ID                                14760000
147700                   ,:VHTRIP-OWNER-SCAC-ID                         14770000
147800                   ,:VHTRIP-VEH-NBR         :PV-NULL-VEH-NBR-IND  14780000
147900              FROM  TVHTRIP A                                     14790000
148000                  , TSHIPMT B                                     14800000
148100                  , TSHPTPO C                                     14810000
148200                  , TRECEIV D                                     14820000
148300                  , TPURCHS E                                     14830000
148400              WHERE A.TRIP_ID           = :DK-TRIP-ID             14840000
148500                 AND A.TRIP_ID           = B.TRIP_ID              14850000
148600                 AND C.SHIPT_ID          = B.SHIPT_ID             14860000
148700                 AND C.PO_NBR          = D.ORD_NBR                14870000
148800                 AND C.REC_SEQ_NBR     = D.REC_SEQ_NBR            14880000
148900                 AND D.VER_STATUS_CDE  = 'A'                      14890000
149000                 AND E.PO_NBR = D.ORD_NBR                         14900000
149100                 AND E.VER_NBR = D.PO_VER_NBR                     14910000
149200              WITH UR                                             14920000
149300         END-EXEC                                                 14930000
149400                                                                  14940000
149500         EVALUATE TRUE                                            14950000
149600             WHEN SQLCODE = ZERO                                  14960000
149700             WHEN SQLCODE = -811                                  14970000
149800             WHEN SQLCODE = +100                                  14980000
149900             WHEN SQLCODE = -904                                  14990000
150000             WHEN SQLCODE = -913                                  15000000
150100             WHEN SQLCODE = -911                                  15010000
150200                  CONTINUE                                        15020000
150300                                                                  15030000
150400             WHEN SQLWARN0 NOT = SPACES                           15040000
150500             WHEN SQLCODE NOT = ZERO                              15050000
150600                  MOVE +4             TO PV-RETRY-COUNTER         15060000
150700         END-EVALUATE                                             15070000
150800     END-PERFORM.                                                 15080000
150900                                                                  15090000
151000     IF SQLCODE = ZERO OR -811                                    15100000
151100         PERFORM 4011-SELECT-ARRIVAL-DATE                         15110000
151200         MOVE RECEIV-PKGNG-CDE       TO PV-PACK-TYPE              15120000
151300         MOVE RECEIV-PACK-BY-ST-IND  TO PV-PACK-BY-STR            15130000
151400         PERFORM 6000-CHECK-PKGNG-CDE                             15140000
151500         MOVE SHPTPO-PO-NBR      TO PV-PO-NBR                     15150000
151600         MOVE SHPTPO-REC-SEQ-NBR TO PV-REC-SEQ                    15160000
151700         STRING PV-PO-NBR              DELIMITED BY SIZE          15170000
151800                '-'                    DELIMITED BY SIZE          15180000
151900                PV-REC-SEQ             DELIMITED BY SIZE          15190000
152000                             INTO DL002-WMS0102-USER-DEF-5        15200000
152100         IF  PV-NULL-VEH-NBR-IND = -1                             15210000
152200             MOVE VHTRIP-OWNER-SCAC-ID                            15220000
152300                              TO PV-ARRIVAL-SCAC                  15230000
152400             MOVE PV-REF-ID   TO DL002-WMS0102-REF-ID             15240000
152500             MOVE SPACES                  TO DL003-REF-ID         15250000
152600         ELSE                                                     15260000
152700             MOVE VHTRIP-OWNER-SCAC-ID                            15270000
152800                              TO PV-ARRIVAL-SCAC                  15280000
152900             MOVE VHTRIP-VEH-NBR                                  15290000
153000                              TO PV-ARRIVAL-TRAILER               15300000
153100             MOVE PV-REF-ID        TO DL002-WMS0102-REF-ID        15310000
153200             MOVE SPACES                  TO DL003-REF-ID         15320000
153300         END-IF                                                   15330000
153400     ELSE                                                         15340000
153500     IF SQLCODE = +100                                            15350000
153600        PERFORM 4030-SELECT-TVHTRIP                               15360000
153700     ELSE                                                         15370000
153800     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         15380000
153900         MOVE SQLCODE               TO PV-SQLCODE                 15390000
154000         MOVE 'SELECT SCAC/TRLR'   TO PV-DB2-OPERATION-MESSAGE-1  15400000
154100         MOVE 'TVHTRIP JOIN' TO PV-DB2-TABLE-NAME                 15410000
154200         MOVE DK-TRIP-ID            TO PV-DISPLAY-TRIP-ID         15420000
154300         STRING 'INBOUND TRIP ID = '    DELIMITED BY SIZE         15430000
154400                 PV-DISPLAY-TRIP-ID     DELIMITED BY SIZE         15440000
154500                                   INTO PV-DB2-OPERATION-MESSAGE-215450000
154600         PERFORM 9999-SQL-ABEND                                   15460000
154700     END-IF.                                                      15470000
154800                                                                  15480000
154900 4011-SELECT-ARRIVAL-DATE.                                        15490000
155000     MOVE '4011-SELECT-ARRIVAL-DATE' TO PV-ABEND-PARAGRAPH.       15500000
155100***  DISPLAY 'NOW IN 4011-SELECT-ARRIVAL-DATE'                    15510000
155200                                                                  15520000
155300     PERFORM                                                      15530000
155400         WITH TEST AFTER                                          15540000
155500             VARYING PV-RETRY-COUNTER                             15550000
155600             FROM 1 BY 1                                          15560000
155700             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              15570000
155800                OR SQLCODE = ZERO                                 15580000
155900                OR SQLCODE = +100                                 15590000
156000                OR SQLCODE = -811                                 15600000
156100                                                                  15610000
156200         EXEC SQL                                                 15620000
156300             SELECT STATUS_DTE                                    15630000
156400                  , STATUS_TME                                    15640000
156500              INTO  :TRIPST-STATUS-DTE                            15650000
156600                   ,:TRIPST-STATUS-TME                            15660000
156700              FROM  TTRIPST A                                     15670000
156800              WHERE A.TRIP_ID           = :DK-TRIP-ID             15680000
156900                 AND A.TRIP_STATUS_CDE   = 'AR'                   15690000
157000              WITH UR                                             15700000
157100         END-EXEC                                                 15710000
157200                                                                  15720000
157300         EVALUATE TRUE                                            15730000
157400             WHEN SQLCODE = ZERO                                  15740000
157500                  MOVE TRIPST-STATUS-DTE TO PV-DB2-WORK-DATE      15750000
157600                  MOVE TRIPST-STATUS-TME TO PV-DB2-WORK-TME       15760000
157700                  MOVE PV-DB2-YY   TO PV-ARRIVAL-YY               15770000
157800                  MOVE PV-DB2-MM   TO PV-ARRIVAL-MM               15780000
157900                  MOVE PV-DB2-DD   TO PV-ARRIVAL-DD               15790000
158000                  MOVE PV-DB2-HH   TO PV-ARRIVAL-HH               15800000
158100                  MOVE PV-DB2-MIN  TO PV-ARRIVAL-MIN              15810000
158200                  MOVE '-'         TO PV-ARRIVAL-DASH1            15820000
158300                                      PV-ARRIVAL-DASH2            15830000
158400             WHEN SQLCODE = +100                                  15840000
158500                  MOVE SPACES      TO PV-ARRIVAL-YY               15850000
158600                                      PV-ARRIVAL-MM               15860000
158700                                      PV-ARRIVAL-DD               15870000
158800                                      PV-ARRIVAL-HH               15880000
158900                                      PV-ARRIVAL-MIN              15890000
159000                                      PV-ARRIVAL-DASH1            15900000
159100             WHEN SQLCODE = -904                                  15910000
159200             WHEN SQLCODE = -913                                  15920000
159300             WHEN SQLCODE = -911                                  15930000
159400                  CONTINUE                                        15940000
159500             WHEN SQLWARN0 NOT = SPACES                           15950000
159600             WHEN SQLCODE NOT = ZERO                              15960000
159700                  MOVE +4             TO PV-RETRY-COUNTER         15970000
159800         END-EVALUATE                                             15980000
159900     END-PERFORM.                                                 15990000
160000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         16000000
160100        MOVE SQLCODE               TO PV-SQLCODE                  16010000
160200        MOVE '4011-SELECT-ARRIVAL-DATE'                           16020000
160300                                   TO PV-DB2-OPERATION-MESSAGE-1  16030000
160400        MOVE 'TTRIPST'             TO PV-DB2-TABLE-NAME           16040000
160500        MOVE DK-TRIP-ID            TO PV-DISPLAY-TRIP-ID          16050000
160600        STRING 'INBOUND TRIP ID = '    DELIMITED BY SIZE          16060000
160700                PV-DISPLAY-TRIP-ID     DELIMITED BY SIZE          16070000
160800                                  INTO PV-DB2-OPERATION-MESSAGE-2 16080000
160900        PERFORM 9999-SQL-ABEND                                    16090000
161000     END-IF.                                                      16100000
161100                                                                  16110000
161200****************************************************************  16120000
161300*                                                              *  16130000
161400*                                                              *  16140000
161500****************************************************************  16150000
161600 4020-SELECTS-BY-SHIP-UNT-ID.                                     16160000
161700     MOVE '4020-SELECTS-BY-SHIP-UNT-ID' TO PV-ABEND-PARAGRAPH.    16170000
161800***  DISPLAY 'NOW IN 4020-SELECTS-BY-SHIP-UNT-ID'.                16180000
161900                                                                  16190000
162000     PERFORM                                                      16200000
162100         WITH TEST AFTER                                          16210000
162200             VARYING PV-RETRY-COUNTER                             16220000
162300             FROM 1 BY 1                                          16230000
162400             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              16240000
162500                OR SQLCODE = ZERO                                 16250000
162600                OR SQLCODE = +100                                 16260000
162700                OR SQLCODE = -811                                 16270000
162800                                                                  16280000
162900         EXEC SQL                                                 16290000
163000             SELECT DISTINCT                                      16300000
163100                     A.SHIPT_UNT_ID                               16310000
163200                   , A.PO_NBR                                     16320000
163300                   , B.REC_SEQ_NBR                                16330000
163400                   , C.ENT_ID                                     16340000
163500                   , C.PKGNG_CDE                                  16350000
163600               INTO  :INPKSU-SHIPT-UNT-ID                         16360000
163700                    ,:INPKSU-PO-NBR                               16370000
163800                    ,:PKSLIP-REC-SEQ-NBR                          16380000
163900                    ,:PURCHS-ENT-ID                               16390000
164000                    ,:PURCHS-PKGNG-CDE                            16400000
164100               FROM  TINPKSU A                                    16410000
164200                   , TPKSLIP B                                    16420000
164300                   , TPURCHS C                                    16430000
164400               WHERE A.SHIPT_UNT_ID      = :DK-SHIP-UNT-ID        16440000
164500                 AND A.PO_NBR            = B.PO_NBR               16450000
164600                 AND A.SEQ_NBR           = B.SEQ_NBR              16460000
164700                 AND B.VER_STAT_CDE      = 'A'                    16470000
164800                 AND C.PO_NBR = A.PO_NBR                          16480000
164900                 AND C.VER_STATUS_CDE = 'A'                       16490000
165000              WITH UR                                             16500000
165100         END-EXEC                                                 16510000
165200                                                                  16520000
165300         EVALUATE TRUE                                            16530000
165400             WHEN SQLCODE = ZERO                                  16540000
165500             WHEN SQLCODE = -811                                  16550000
165600             WHEN SQLCODE = +100                                  16560000
165700             WHEN SQLCODE = -904                                  16570000
165800             WHEN SQLCODE = -913                                  16580000
165900             WHEN SQLCODE = -911                                  16590000
166000                  CONTINUE                                        16600000
166100                                                                  16610000
166200             WHEN SQLWARN0 NOT = SPACES                           16620000
166300             WHEN SQLCODE NOT = ZERO                              16630000
166400                  MOVE +4             TO PV-RETRY-COUNTER         16640000
166500         END-EVALUATE                                             16650000
166600     END-PERFORM.                                                 16660000
166700                                                                  16670000
166800     IF (SQLCODE = ZERO OR -811) AND                              16680000
166900       PKSLIP-REC-SEQ-NBR = 0                                     16690000
167000         MOVE PURCHS-PKGNG-CDE       TO PV-PACK-TYPE              16700000
167100         MOVE SPACES                 TO PV-PACK-BY-STR            16710000
167200         PERFORM 6000-CHECK-PKGNG-CDE                             16720000
167300         MOVE INPKSU-PO-NBR      TO PV-PO-NBR                     16730000
167400         MOVE PKSLIP-REC-SEQ-NBR TO PV-REC-SEQ                    16740000
167500         STRING PV-PO-NBR              DELIMITED BY SIZE          16750000
167600                '-'                    DELIMITED BY SIZE          16760000
167700                PV-REC-SEQ             DELIMITED BY SIZE          16770000
167800                             INTO DL002-WMS0102-USER-DEF-5        16780000
167900***      MOVE PURCHS-ENT-ID      TO DL002-WMS0102-CLIENT-ID       16790000
168000     ELSE                                                         16800000
168100     IF (SQLCODE = ZERO OR -811)                                  16810000
168200         MOVE PURCHS-PKGNG-CDE       TO PV-PACK-TYPE              16820000
168300         MOVE SPACES                 TO PV-PACK-BY-STR            16830000
168400         PERFORM 4080-SELECT-TRECEIV-PKGNG                        16840000
168500         PERFORM 6000-CHECK-PKGNG-CDE                             16850000
168600         MOVE INPKSU-PO-NBR      TO PV-PO-NBR                     16860000
168700         MOVE PKSLIP-REC-SEQ-NBR TO PV-REC-SEQ                    16870000
168800         STRING PV-PO-NBR              DELIMITED BY SIZE          16880000
168900                '-'                    DELIMITED BY SIZE          16890000
169000                PV-REC-SEQ             DELIMITED BY SIZE          16900000
169100                             INTO DL002-WMS0102-USER-DEF-5        16910000
169200***      MOVE PURCHS-ENT-ID      TO DL002-WMS0102-CLIENT-ID       16920000
169300     ELSE                                                         16930000
169400     IF SQLCODE = +100                                            16940000
169500         PERFORM 4025-ALT-SELECT-BY-OUTBOUND                      16950000
169600     ELSE                                                         16960000
169700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         16970000
169800         MOVE SQLCODE               TO PV-SQLCODE                 16980000
169900         MOVE 'SELECT BY SHIP UNT' TO PV-DB2-OPERATION-MESSAGE-1  16990000
170000         MOVE 'TINPKSU JOIN' TO PV-DB2-TABLE-NAME                 17000000
170100         MOVE DK-SHIP-UNT-ID        TO PV-DISPLAY-SHIP-UNT-ID     17010000
170200         STRING 'SHIP UNIT ID = '       DELIMITED BY SIZE         17020000
170300                 PV-DISPLAY-SHIP-UNT-ID DELIMITED BY SIZE         17030000
170400                                   INTO PV-DB2-OPERATION-MESSAGE-217040000
170500         PERFORM 9999-SQL-ABEND                                   17050000
170600     END-IF.                                                      17060000
170700                                                                  17070000
170800****************************************************************  17080000
170900*                                                              *  17090000
171000*                                                              *  17100000
171100****************************************************************  17110000
171200 4025-ALT-SELECT-BY-OUTBOUND.                                     17120000
171300     MOVE '4025-ALT-SELECT-BY-OUTBOUND' TO PV-ABEND-PARAGRAPH.    17130000
171400***  DISPLAY 'NOW IN 4025-ALT-SELECT-BY-OUTBOUND'.                17140000
171500                                                                  17150000
171600     PERFORM                                                      17160000
171700         WITH TEST AFTER                                          17170000
171800             VARYING PV-RETRY-COUNTER                             17180000
171900             FROM 1 BY 1                                          17190000
172000             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              17200000
172100                OR SQLCODE = ZERO                                 17210000
172200                OR SQLCODE = +100                                 17220000
172300                OR SQLCODE = -811                                 17230000
172400                                                                  17240000
172500         EXEC SQL                                                 17250000
172600             SELECT  A.SHIPT_UNT_ID                               17260000
172700                   , A.TRN_NBR                                    17270000
172800                   , A.RCVR_SEQ_NBR                               17280000
172900                   , B.ENT_ID                                     17290000
173000                   , B.PKGNG_CDE                                  17300000
173100               INTO  :SUT00028-SHIPT-UNT-ID                       17310000
173200                   , :SUT00028-TRN-NBR                            17320000
173300                   , :SUT00028-RCVR-SEQ-NBR                       17330000
173400                   , :PURCHS-ENT-ID                               17340000
173500                   , :PURCHS-PKGNG-CDE                            17350000
173600               FROM  SUT_OTBND_UPC A                              17360000
173700                  ,  TPURCHS B                                    17370000
173800               WHERE A.SHIPT_UNT_ID      = :DK-SHIP-UNT-ID        17380000
173900                 AND B.PO_NBR = A.TRN_NBR                         17390000
174000                 AND B.VER_STATUS_CDE = 'A'                       17400000
174100              WITH UR                                             17410000
174200         END-EXEC                                                 17420000
174300                                                                  17430000
174400         EVALUATE TRUE                                            17440000
174500             WHEN SQLCODE = ZERO                                  17450000
174600             WHEN SQLCODE = -811                                  17460000
174700             WHEN SQLCODE = -904                                  17470000
174800             WHEN SQLCODE = -913                                  17480000
174900             WHEN SQLCODE = -911                                  17490000
175000                  CONTINUE                                        17500000
175100                                                                  17510000
175200             WHEN SQLWARN0 NOT = SPACES                           17520000
175300             WHEN SQLCODE NOT = ZERO                              17530000
175400                  MOVE +4             TO PV-RETRY-COUNTER         17540000
175500         END-EVALUATE                                             17550000
175600     END-PERFORM.                                                 17560000
175700                                                                  17570000
175800     IF (SQLCODE = ZERO OR -811)                                  17580000
175900         SET PS-OUTBOUND-UPC         TO TRUE                      17590000
176000         MOVE SUT00028-RCVR-SEQ-NBR  TO PV-REC-SEQ                17600000
176100         MOVE PURCHS-PKGNG-CDE       TO PV-PACK-TYPE              17610000
176200         MOVE SPACES                 TO PV-PACK-BY-STR            17620000
176300         PERFORM 6000-CHECK-PKGNG-CDE                             17630000
176400         MOVE SUT00028-TRN-NBR   TO PV-PO-NBR                     17640000
176500         STRING PV-PO-NBR              DELIMITED BY SIZE          17650000
176600                '-'                    DELIMITED BY SIZE          17660000
176700                PV-REC-SEQ             DELIMITED BY SIZE          17670000
176800                             INTO DL002-WMS0102-USER-DEF-5        17680000
176900***      MOVE PURCHS-ENT-ID      TO DL002-WMS0102-CLIENT-ID       17690000
177000     ELSE                                                         17700000
177100     IF SQLCODE = +100                                            17710000
177200         PERFORM 4026-ALT-SELECT-BY-SHIPUNT                       17720000
177300     ELSE                                                         17730000
177400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         17740000
177500         MOVE SQLCODE               TO PV-SQLCODE                 17750000
177600         MOVE 'ALT SELECT-OUTBOUND ' TO PV-DB2-OPERATION-MESSAGE-117760000
177700         MOVE 'SUT_OTBD' TO PV-DB2-TABLE-NAME                     17770000
177800         MOVE DK-SHIP-UNT-ID        TO PV-DISPLAY-SHIP-UNT-ID     17780000
177900         STRING 'SHIP UNIT ID = '       DELIMITED BY SIZE         17790000
178000                 PV-DISPLAY-SHIP-UNT-ID DELIMITED BY SIZE         17800000
178100                                   INTO PV-DB2-OPERATION-MESSAGE-217810000
178200         PERFORM 9999-SQL-ABEND                                   17820000
178300     END-IF.                                                      17830000
178400                                                                  17840000
178500****************************************************************  17850000
178600*                                                              *  17860000
178700*                                                              *  17870000
178800****************************************************************  17880000
178900 4026-ALT-SELECT-BY-SHIPUNT.                                      17890000
179000     MOVE '4026-ALT-SELECT-BY-SHIP-UNT' TO PV-ABEND-PARAGRAPH.    17900000
179100***  DISPLAY 'NOW IN 4026-ALT-SELECT-BY-SHIP-UNT'.                17910000
179200                                                                  17920000
179300     PERFORM                                                      17930000
179400         WITH TEST AFTER                                          17940000
179500             VARYING PV-RETRY-COUNTER                             17950000
179600             FROM 1 BY 1                                          17960000
179700             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              17970000
179800                OR SQLCODE = ZERO                                 17980000
179900                OR SQLCODE = +100                                 17990000
180000                OR SQLCODE = -811                                 18000000
180100                                                                  18010000
180200         EXEC SQL                                                 18020000
180300             SELECT  A.SHIPT_UNT_ID                               18030000
180400                   , A.PO_NBR                                     18040000
180500                   , B.ENT_ID                                     18050000
180600                   , B.PKGNG_CDE                                  18060000
180700               INTO  :INPKSU-SHIPT-UNT-ID                         18070000
180800                   , :INPKSU-PO-NBR                               18080000
180900                   , :PURCHS-ENT-ID                               18090000
181000                   , :PURCHS-PKGNG-CDE                            18100000
181100               FROM  TINPKSU A                                    18110000
181200                  ,  TPURCHS B                                    18120000
181300               WHERE A.SHIPT_UNT_ID      = :DK-SHIP-UNT-ID        18130000
181400                 AND B.PO_NBR = A.PO_NBR                          18140000
181500                 AND B.VER_STATUS_CDE = 'A'                       18150000
181600              WITH UR                                             18160000
181700         END-EXEC                                                 18170000
181800                                                                  18180000
181900         EVALUATE TRUE                                            18190000
182000             WHEN SQLCODE = ZERO                                  18200000
182100             WHEN SQLCODE = -811                                  18210000
182200             WHEN SQLCODE = -904                                  18220000
182300             WHEN SQLCODE = -913                                  18230000
182400             WHEN SQLCODE = -911                                  18240000
182500                  CONTINUE                                        18250000
182600                                                                  18260000
182700             WHEN SQLWARN0 NOT = SPACES                           18270000
182800             WHEN SQLCODE NOT = ZERO                              18280000
182900                  MOVE +4             TO PV-RETRY-COUNTER         18290000
183000         END-EVALUATE                                             18300000
183100     END-PERFORM.                                                 18310000
183200                                                                  18320000
183300     IF (SQLCODE = ZERO OR -811)                                  18330000
183400         SET PS-REGULAR-UPC          TO TRUE                      18340000
183500         MOVE 0                      TO PV-REC-SEQ                18350000
183600         MOVE PURCHS-PKGNG-CDE       TO PV-PACK-TYPE              18360000
183700         MOVE SPACES                 TO PV-PACK-BY-STR            18370000
183800         PERFORM 6000-CHECK-PKGNG-CDE                             18380000
183900         MOVE INPKSU-PO-NBR      TO PV-PO-NBR                     18390000
184000         STRING PV-PO-NBR              DELIMITED BY SIZE          18400000
184100                '-'                    DELIMITED BY SIZE          18410000
184200                PV-REC-SEQ             DELIMITED BY SIZE          18420000
184300                             INTO DL002-WMS0102-USER-DEF-5        18430000
184400***      MOVE PURCHS-ENT-ID      TO DL002-WMS0102-CLIENT-ID       18440000
184500     ELSE                                                         18450000
184600     IF SQLCODE = +100                                            18460000
184700         MOVE ZEROS              TO DL002-WMS0102-SHIP-UNITS      18470000
184800         MOVE SPACES             TO DL002-WMS0102-USER-DEF-3      18480000
184900         MOVE SPACES             TO DL002-WMS0102-USER-DEF-5      18490000
185000***      MOVE SPACES             TO DL002-WMS0102-CLIENT-ID       18500000
185100     ELSE                                                         18510000
185200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         18520000
185300         MOVE SQLCODE               TO PV-SQLCODE                 18530000
185400         MOVE 'ALT SELECT - SHPUNIT' TO PV-DB2-OPERATION-MESSAGE-118540000
185500         MOVE 'TINPKSU'         TO PV-DB2-TABLE-NAME              18550000
185600         MOVE DK-SHIP-UNT-ID        TO PV-DISPLAY-SHIP-UNT-ID     18560000
185700         STRING 'SHIP UNIT ID = '       DELIMITED BY SIZE         18570000
185800                 PV-DISPLAY-SHIP-UNT-ID DELIMITED BY SIZE         18580000
185900                                   INTO PV-DB2-OPERATION-MESSAGE-218590000
186000         PERFORM 9999-SQL-ABEND                                   18600000
186100     END-IF.                                                      18610000
186200                                                                  18620000
186300****************************************************************  18630000
186400*                                                              *  18640000
186500*                                                              *  18650000
186600****************************************************************  18660000
186700 4030-SELECT-TVHTRIP.                                             18670000
186800     MOVE '4030-SELECT-TVHTRIP' TO PV-ABEND-PARAGRAPH.            18680000
186900***  DISPLAY 'NOW IN 4030-SELECT-TVHTRIP'.                        18690000
187000                                                                  18700000
187100     PERFORM                                                      18710000
187200         WITH TEST AFTER                                          18720000
187300             VARYING PV-RETRY-COUNTER                             18730000
187400             FROM 1 BY 1                                          18740000
187500             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              18750000
187600                OR SQLCODE = ZERO                                 18760000
187700                OR SQLCODE = +100                                 18770000
187800                OR SQLCODE = -811                                 18780000
187900                                                                  18790000
188000         EXEC SQL                                                 18800000
188100              SELECT DISTINCT                                     18810000
188200                     A.OWNER_SCAC_ID                              18820000
188300                   , A.VEH_NBR                                    18830000
188400               INTO                                               18840000
188500                    :VHTRIP-OWNER-SCAC-ID                         18850000
188600                   ,:VHTRIP-VEH-NBR         :PV-NULL-VEH-NBR-IND  18860000
188700               FROM  TVHTRIP A                                    18870000
188800                    WHERE A.TRIP_ID = :DK-TRIP-ID                 18880000
188900              WITH UR                                             18890000
189000         END-EXEC                                                 18900000
189100                                                                  18910000
189200         EVALUATE TRUE                                            18920000
189300             WHEN SQLCODE = ZERO                                  18930000
189400             WHEN SQLCODE = -811                                  18940000
189500             WHEN SQLCODE = +100                                  18950000
189600             WHEN SQLCODE = -904                                  18960000
189700             WHEN SQLCODE = -913                                  18970000
189800             WHEN SQLCODE = -911                                  18980000
189900                  CONTINUE                                        18990000
190000                                                                  19000000
190100             WHEN SQLWARN0 NOT = SPACES                           19010000
190200             WHEN SQLCODE NOT = ZERO                              19020000
190300                  MOVE +4             TO PV-RETRY-COUNTER         19030000
190400         END-EVALUATE                                             19040000
190500     END-PERFORM.                                                 19050000
190600                                                                  19060000
190700     IF SQLCODE = ZERO OR -811                                    19070000
190800         PERFORM 4011-SELECT-ARRIVAL-DATE                         19080000
190900         IF  PV-NULL-VEH-NBR-IND = -1                             19090000
191000             MOVE VHTRIP-OWNER-SCAC-ID                            19100000
191100                              TO PV-ARRIVAL-SCAC                  19110000
191200             MOVE PV-REF-ID   TO DL002-WMS0102-REF-ID             19120000
191300         ELSE                                                     19130000
191400             MOVE VHTRIP-OWNER-SCAC-ID                            19140000
191500                              TO PV-ARRIVAL-SCAC                  19150000
191600             MOVE VHTRIP-VEH-NBR                                  19160000
191700                              TO PV-ARRIVAL-TRAILER               19170000
191800             MOVE PV-REF-ID   TO DL002-WMS0102-REF-ID             19180000
191900         END-IF                                                   19190000
192000     ELSE                                                         19200000
192100     IF SQLCODE = +100                                            19210000
192200         MOVE SPACES           TO DL002-WMS0102-REF-ID            19220000
192300     ELSE                                                         19230000
192400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         19240000
192500         MOVE SQLCODE               TO PV-SQLCODE                 19250000
192600         MOVE 'SELECT SCAC/TRLR'   TO PV-DB2-OPERATION-MESSAGE-1  19260000
192700         MOVE 'TVHTRIP'      TO PV-DB2-TABLE-NAME                 19270000
192800         MOVE DK-TRIP-ID            TO PV-DISPLAY-TRIP-ID         19280000
192900         STRING 'INBOUND TRIP ID = '    DELIMITED BY SIZE         19290000
193000                 PV-DISPLAY-TRIP-ID     DELIMITED BY SIZE         19300000
193100                                   INTO PV-DB2-OPERATION-MESSAGE-219310000
193200         PERFORM 9999-SQL-ABEND                                   19320000
193300     END-IF.                                                      19330000
193400                                                                  19340000
193500****************************************************************  19350000
193600*                                                              *  19360000
193700*                                                              *  19370000
193800****************************************************************  19380000
193900 4040-SELECT-TSHUUPC-FOR-UNITS.                                   19390000
194000     MOVE '4040-SELECT-TSHUUPC-FOR-UNITS' TO PV-ABEND-PARAGRAPH.  19400000
194100***  DISPLAY 'NOW IN 4040-SELECT-TSHUUPC-FOR-UNITS'.              19410000
194200                                                                  19420000
194300     PERFORM                                                      19430000
194400         WITH TEST AFTER                                          19440000
194500             VARYING PV-RETRY-COUNTER                             19450000
194600             FROM 1 BY 1                                          19460000
194700             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              19470000
194800                OR SQLCODE = ZERO                                 19480000
194900                OR SQLCODE = +100                                 19490000
195000                OR SQLCODE = -811                                 19500000
195100                                                                  19510000
195200         EXEC SQL                                                 19520000
195300             SELECT SUM(SHPD_QTY)                                 19530000
195400              INTO :PV-SUM-UNITS    :PV-NULL-SUM-UNITS            19540000
195500              FROM TSHUUPC                                        19550000
195600                 WHERE SHIPT_UNT_ID = :DK-SHIP-UNT-ID             19560000
195700              WITH UR                                             19570000
195800         END-EXEC                                                 19580000
195900                                                                  19590000
196000         EVALUATE TRUE                                            19600000
196100             WHEN SQLCODE = ZERO                                  19610000
196200             WHEN SQLCODE = -811                                  19620000
196300             WHEN SQLCODE = +100                                  19630000
196400             WHEN SQLCODE = -904                                  19640000
196500             WHEN SQLCODE = -913                                  19650000
196600             WHEN SQLCODE = -911                                  19660000
196700                  CONTINUE                                        19670000
196800                                                                  19680000
196900             WHEN SQLWARN0 NOT = SPACES                           19690000
197000             WHEN SQLCODE NOT = ZERO                              19700000
197100                  MOVE +4             TO PV-RETRY-COUNTER         19710000
197200         END-EVALUATE                                             19720000
197300     END-PERFORM.                                                 19730000
197400                                                                  19740000
197500     IF SQLCODE = ZERO OR -811                                    19750000
197600         IF  PV-NULL-SUM-UNITS = -1                               19760000
197700             MOVE ZEROS            TO DL002-WMS0102-SHIP-UNITS    19770000
197800         ELSE                                                     19780000
197900             MOVE PV-SUM-UNITS     TO DL002-WMS0102-SHIP-UNITS    19790000
198000         END-IF                                                   19800000
198100     ELSE                                                         19810000
198200     IF SQLCODE = +100                                            19820000
198300         MOVE ZEROS            TO DL002-WMS0102-SHIP-UNITS        19830000
198400     ELSE                                                         19840000
198500     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         19850000
198600         MOVE SQLCODE               TO PV-SQLCODE                 19860000
198700         MOVE 'SELECT FOR UNITS'   TO PV-DB2-OPERATION-MESSAGE-1  19870000
198800         MOVE 'TSHUUPC'      TO PV-DB2-TABLE-NAME                 19880000
198900         MOVE DK-SHIP-UNT-ID        TO PV-DISPLAY-SHIP-UNT-ID     19890000
199000         STRING 'SHIP UNIT ID = '       DELIMITED BY SIZE         19900000
199100                 PV-DISPLAY-SHIP-UNT-ID DELIMITED BY SIZE         19910000
199200                                   INTO PV-DB2-OPERATION-MESSAGE-219920000
199300         PERFORM 9999-SQL-ABEND                                   19930000
199400     END-IF.                                                      19940000
199500                                                                  19950000
199600****************************************************************  19960000
199700*                                                              *  19970000
199800*                                                              *  19980000
199900****************************************************************  19990000
200000 4050-SELECT-TSHUUPC-UPC-DEPT.                                    20000000
200100     MOVE '4050-SELECT-TSHUUPC-UPC-DEPT' TO PV-ABEND-PARAGRAPH.   20010000
200200***  DISPLAY 'NOW IN 4050-SELECT-TSHUUPC-UPC-DEPT'                20020000
200300                                                                  20030000
200400     PERFORM                                                      20040000
200500         WITH TEST AFTER                                          20050000
200600             VARYING PV-RETRY-COUNTER                             20060000
200700             FROM 1 BY 1                                          20070000
200800             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              20080000
200900                OR SQLCODE = ZERO                                 20090000
201000                OR SQLCODE = +100                                 20100000
201100                OR SQLCODE = -811                                 20110000
201200                                                                  20120000
201300         EXEC SQL                                                 20130000
201400             SELECT DISTINCT                                      20140000
201500                D.DEPT_NBR                                        20150000
201600               ,D.MAJ_CL_NBR                                      20160000
201700             INTO :XLT00004-DEPT-NBR                              20170000
201800                 ,:XLT00004-MAJ-CL-NBR                            20180000
201900             FROM TSHUUPC   A                                     20190000
202000                , XLT_UPC   B                                     20200000
202100                , XLT_SKU   C                                     20210000
202200                , XLT_VND_STYL   D                                20220000
202300             WHERE A.SHIPT_UNT_ID = :DK-SHIP-UNT-ID               20230000
202400               AND B.UPC_NBR = A.UPC_NBR                          20240000
202500               AND C.INTR_UPC_ID = B.INTR_UPC_ID                  20250000
202600               AND D.STYL_ID = C.STYL_ID                          20260000
202700              WITH UR                                             20270000
202800         END-EXEC                                                 20280000
202900                                                                  20290000
203000         EVALUATE TRUE                                            20300000
203100             WHEN SQLCODE = ZERO                                  20310000
203200             WHEN SQLCODE = -811                                  20320000
203300             WHEN SQLCODE = +100                                  20330000
203400             WHEN SQLCODE = -904                                  20340000
203500             WHEN SQLCODE = -913                                  20350000
203600             WHEN SQLCODE = -911                                  20360000
203700                  CONTINUE                                        20370000
203800                                                                  20380000
203900             WHEN SQLWARN0 NOT = SPACES                           20390000
204000             WHEN SQLCODE NOT = ZERO                              20400000
204100                  MOVE +4             TO PV-RETRY-COUNTER         20410000
204200         END-EVALUATE                                             20420000
204300     END-PERFORM.                                                 20430000
204400                                                                  20440000
204500     IF SQLCODE = ZERO OR -811                                    20450000
204600         PERFORM 4060-SELECT-CUBE-BY-CLASS                        20460000
204700     ELSE                                                         20470000
204800     IF SQLCODE = +100                                            20480000
204900         MOVE ZEROS            TO DL002-WMS0102-CUBE              20490000
205000         MOVE ZEROS            TO DL002-WMS0102-WEIGHT            20500000
205100     ELSE                                                         20510000
205200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         20520000
205300         MOVE SQLCODE               TO PV-SQLCODE                 20530000
205400         MOVE 'SELECT FOR DEPT/CL' TO PV-DB2-OPERATION-MESSAGE-1  20540000
205500         MOVE 'TSHUUPC JOIN' TO PV-DB2-TABLE-NAME                 20550000
205600         MOVE DK-SHIP-UNT-ID        TO PV-DISPLAY-SHIP-UNT-ID     20560000
205700         STRING 'SHIP UNIT ID = '       DELIMITED BY SIZE         20570000
205800                 PV-DISPLAY-SHIP-UNT-ID DELIMITED BY SIZE         20580000
205900                                   INTO PV-DB2-OPERATION-MESSAGE-220590000
206000         PERFORM 9999-SQL-ABEND                                   20600000
206100     END-IF.                                                      20610000
206200                                                                  20620000
206300****************************************************************  20630000
206400*                                                              *  20640000
206500*                                                              *  20650000
206600****************************************************************  20660000
206700 4055-SELECT-OTBND-FOR-UNITS.                                     20670000
206800     MOVE '4055-SELECT-OTBND-FOR-UNITS' TO PV-ABEND-PARAGRAPH.    20680000
206900***  DISPLAY 'NOW IN 4055-SELECT-OTBND-FOR-UNITS'.                20690000
207000                                                                  20700000
207100     PERFORM                                                      20710000
207200         WITH TEST AFTER                                          20720000
207300             VARYING PV-RETRY-COUNTER                             20730000
207400             FROM 1 BY 1                                          20740000
207500             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              20750000
207600                OR SQLCODE = ZERO                                 20760000
207700                OR SQLCODE = +100                                 20770000
207800                OR SQLCODE = -811                                 20780000
207900                                                                  20790000
208000         EXEC SQL                                                 20800000
208100             SELECT SUM(SHPD_UNT_QTY)                             20810000
208200              INTO :PV-SUM-UNITS   :PV-NULL-SUM-UNITS             20820000
208300              FROM SUT_OTBND_UPC                                  20830000
208400                 WHERE SHIPT_UNT_ID = :DK-SHIP-UNT-ID             20840000
208500              WITH UR                                             20850000
208600         END-EXEC                                                 20860000
208700                                                                  20870000
208800         EVALUATE TRUE                                            20880000
208900             WHEN SQLCODE = ZERO                                  20890000
209000             WHEN SQLCODE = -811                                  20900000
209100             WHEN SQLCODE = +100                                  20910000
209200             WHEN SQLCODE = -904                                  20920000
209300             WHEN SQLCODE = -913                                  20930000
209400             WHEN SQLCODE = -911                                  20940000
209500                  CONTINUE                                        20950000
209600                                                                  20960000
209700             WHEN SQLWARN0 NOT = SPACES                           20970000
209800             WHEN SQLCODE NOT = ZERO                              20980000
209900                  MOVE +4             TO PV-RETRY-COUNTER         20990000
210000         END-EVALUATE                                             21000000
210100     END-PERFORM.                                                 21010000
210200                                                                  21020000
210300     IF SQLCODE = ZERO OR -811                                    21030000
210400         IF  PV-NULL-SUM-UNITS = -1                               21040000
210500             MOVE ZEROS            TO DL002-WMS0102-SHIP-UNITS    21050000
210600         ELSE                                                     21060000
210700             MOVE PV-SUM-UNITS     TO DL002-WMS0102-SHIP-UNITS    21070000
210800         END-IF                                                   21080000
210900     ELSE                                                         21090000
211000     IF SQLCODE = +100                                            21100000
211100         MOVE ZEROS            TO DL002-WMS0102-SHIP-UNITS        21110000
211200     ELSE                                                         21120000
211300     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         21130000
211400         MOVE SQLCODE               TO PV-SQLCODE                 21140000
211500         MOVE 'SELECT FOR UNITS'   TO PV-DB2-OPERATION-MESSAGE-1  21150000
211600         MOVE 'SUT_OTBND'    TO PV-DB2-TABLE-NAME                 21160000
211700         MOVE DK-SHIP-UNT-ID        TO PV-DISPLAY-SHIP-UNT-ID     21170000
211800         STRING 'SHIP UNIT ID = '       DELIMITED BY SIZE         21180000
211900                 PV-DISPLAY-SHIP-UNT-ID DELIMITED BY SIZE         21190000
212000                                   INTO PV-DB2-OPERATION-MESSAGE-221200000
212100         PERFORM 9999-SQL-ABEND                                   21210000
212200     END-IF.                                                      21220000
212300                                                                  21230000
212400****************************************************************  21240000
212500*                                                              *  21250000
212600*                                                              *  21260000
212700****************************************************************  21270000
212800 4056-SELECT-OTBND-UPC-DEPT.                                      21280000
212900     MOVE '4056-SELECT-OTBND-UPC-DEPT' TO PV-ABEND-PARAGRAPH.     21290000
213000***  DISPLAY 'NOW IN 4056-SELECT-OTBND-UPC-DEPT'                  21300000
213100                                                                  21310000
213200     PERFORM                                                      21320000
213300         WITH TEST AFTER                                          21330000
213400             VARYING PV-RETRY-COUNTER                             21340000
213500             FROM 1 BY 1                                          21350000
213600             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              21360000
213700                OR SQLCODE = ZERO                                 21370000
213800                OR SQLCODE = +100                                 21380000
213900                OR SQLCODE = -811                                 21390000
214000                                                                  21400000
214100         EXEC SQL                                                 21410000
214200             SELECT DISTINCT                                      21420000
214300                D.DEPT_NBR                                        21430000
214400               ,D.MAJ_CL_NBR                                      21440000
214500             INTO :XLT00004-DEPT-NBR                              21450000
214600                 ,:XLT00004-MAJ-CL-NBR                            21460000
214700             FROM SUT_OTBND_UPC A                                 21470000
214800                , XLT_UPC   B                                     21480000
214900                , XLT_SKU   C                                     21490000
215000                , XLT_VND_STYL   D                                21500000
215100             WHERE A.SHIPT_UNT_ID = :DK-SHIP-UNT-ID               21510000
215200               AND B.UPC_NBR = A.UPC_NBR                          21520000
215300               AND C.INTR_UPC_ID = B.INTR_UPC_ID                  21530000
215400               AND D.STYL_ID = C.STYL_ID                          21540000
215500              WITH UR                                             21550000
215600         END-EXEC                                                 21560000
215700                                                                  21570000
215800         EVALUATE TRUE                                            21580000
215900             WHEN SQLCODE = ZERO                                  21590000
216000             WHEN SQLCODE = -811                                  21600000
216100             WHEN SQLCODE = +100                                  21610000
216200             WHEN SQLCODE = -904                                  21620000
216300             WHEN SQLCODE = -913                                  21630000
216400             WHEN SQLCODE = -911                                  21640000
216500                  CONTINUE                                        21650000
216600                                                                  21660000
216700             WHEN SQLWARN0 NOT = SPACES                           21670000
216800             WHEN SQLCODE NOT = ZERO                              21680000
216900                  MOVE +4             TO PV-RETRY-COUNTER         21690000
217000         END-EVALUATE                                             21700000
217100     END-PERFORM.                                                 21710000
217200                                                                  21720000
217300     IF SQLCODE = ZERO OR -811                                    21730000
217400         PERFORM 4060-SELECT-CUBE-BY-CLASS                        21740000
217500     ELSE                                                         21750000
217600     IF SQLCODE = +100                                            21760000
217700         MOVE ZEROS            TO DL002-WMS0102-CUBE              21770000
217800         MOVE ZEROS            TO DL002-WMS0102-WEIGHT            21780000
217900     ELSE                                                         21790000
218000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         21800000
218100         MOVE SQLCODE               TO PV-SQLCODE                 21810000
218200         MOVE 'SELECT FOR DEPT/CL' TO PV-DB2-OPERATION-MESSAGE-1  21820000
218300         MOVE 'TSHUUPC JOIN' TO PV-DB2-TABLE-NAME                 21830000
218400         MOVE DK-SHIP-UNT-ID        TO PV-DISPLAY-SHIP-UNT-ID     21840000
218500         STRING 'SHIP UNIT ID = '       DELIMITED BY SIZE         21850000
218600                 PV-DISPLAY-SHIP-UNT-ID DELIMITED BY SIZE         21860000
218700                                   INTO PV-DB2-OPERATION-MESSAGE-221870000
218800         PERFORM 9999-SQL-ABEND                                   21880000
218900     END-IF.                                                      21890000
219000                                                                  21900000
219100****************************************************************  21910000
219200*                                                              *  21920000
219300*                                                              *  21930000
219400****************************************************************  21940000
219500 4060-SELECT-CUBE-BY-CLASS.                                       21950000
219600     MOVE '4060-SELECT-CUBE-BY-CLASS' TO PV-ABEND-PARAGRAPH.      21960000
219700***  DISPLAY 'NOW IN 4060-SELECT-CUBE-BY-CLASS'.                  21970000
219800                                                                  21980000
219900     PERFORM                                                      21990000
220000         WITH TEST AFTER                                          22000000
220100             VARYING PV-RETRY-COUNTER                             22010000
220200             FROM 1 BY 1                                          22020000
220300             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              22030000
220400                OR SQLCODE = ZERO                                 22040000
220500                OR SQLCODE = +100                                 22050000
220600                                                                  22060000
220700         EXEC SQL                                                 22070000
220800             SELECT DISTINCT                                      22080000
220900                DFLT_CART_CUBE_MU                                 22090000
221000               ,DFLT_CART_WT_MU                                   22100000
221100             INTO :DLT00006-DFLT-CART-CUBE-MU                     22110000
221200                 ,:DLT00006-DFLT-CART-WT-MU                       22120000
221300             FROM DLT_CLS_CART_DFLT                               22130000
221400             WHERE DEPT_NBR = :XLT00004-DEPT-NBR                  22140000
221500               AND MAJ_CL_NBR = :XLT00004-MAJ-CL-NBR              22150000
221600              WITH UR                                             22160000
221700         END-EXEC                                                 22170000
221800                                                                  22180000
221900         EVALUATE TRUE                                            22190000
222000             WHEN SQLCODE = ZERO                                  22200000
222100             WHEN SQLCODE = +100                                  22210000
222200             WHEN SQLCODE = -904                                  22220000
222300             WHEN SQLCODE = -913                                  22230000
222400             WHEN SQLCODE = -911                                  22240000
222500                  CONTINUE                                        22250000
222600                                                                  22260000
222700             WHEN SQLWARN0 NOT = SPACES                           22270000
222800             WHEN SQLCODE NOT = ZERO                              22280000
222900                  MOVE +4             TO PV-RETRY-COUNTER         22290000
223000         END-EVALUATE                                             22300000
223100     END-PERFORM.                                                 22310000
223200                                                                  22320000
223300     IF SQLCODE = ZERO                                            22330000
223400         MOVE DLT00006-DFLT-CART-CUBE-MU  TO DL002-WMS0102-CUBE   22340000
223500***      MOVE DLT00006-DFLT-CART-WT-MU TO DL002-WMS0102-WEIGHT    22350000
223600     ELSE                                                         22360000
223700     IF SQLCODE = +100                                            22370000
223800         PERFORM 4070-SELECT-CUBE-BY-DEPT                         22380000
223900     ELSE                                                         22390000
224000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         22400000
224100         MOVE SQLCODE               TO PV-SQLCODE                 22410000
224200         MOVE 'SELECT CUBE BY DEPT' TO PV-DB2-OPERATION-MESSAGE-1 22420000
224300         MOVE 'DLT_DEPT_CART_DFLT'  TO PV-DB2-TABLE-NAME          22430000
224400         MOVE XLT00004-DEPT-NBR     TO PV-DISPLAY-DEPT-NBR        22440000
224500         STRING 'DLT-DEPT-CART = '       DELIMITED BY SIZE        22450000
224600                 PV-DISPLAY-DEPT-NBR DELIMITED BY SIZE            22460000
224700                                   INTO PV-DB2-OPERATION-MESSAGE-222470000
224800         PERFORM 9999-SQL-ABEND                                   22480000
224900     END-IF.                                                      22490000
225000                                                                  22500000
225100****************************************************************  22510000
225200*                                                              *  22520000
225300*                                                              *  22530000
225400****************************************************************  22540000
225500 4070-SELECT-CUBE-BY-DEPT.                                        22550000
225600     MOVE '4070-SELECT-CUBE-BY-DEPT' TO PV-ABEND-PARAGRAPH.       22560000
225700***  DISPLAY 'NOW IN 4070-SELECT-CUBE-BY-DEPT'.                   22570000
225800                                                                  22580000
225900     PERFORM                                                      22590000
226000         WITH TEST AFTER                                          22600000
226100             VARYING PV-RETRY-COUNTER                             22610000
226200             FROM 1 BY 1                                          22620000
226300             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              22630000
226400                OR SQLCODE = ZERO                                 22640000
226500                OR SQLCODE = +100                                 22650000
226600                                                                  22660000
226700         EXEC SQL                                                 22670000
226800             SELECT DISTINCT                                      22680000
226900                DFLT_CART_CUBE_MU                                 22690000
227000               ,DFLT_CART_WT_MU                                   22700000
227100             INTO :DLT00005-DFLT-CART-CUBE-MU                     22710000
227200                 ,:DLT00005-DFLT-CART-WT-MU                       22720000
227300             FROM DLT_DEPT_CART_DFLT                              22730000
227400             WHERE DEPT_NBR = :XLT00004-DEPT-NBR                  22740000
227500              WITH UR                                             22750000
227600         END-EXEC                                                 22760000
227700                                                                  22770000
227800         EVALUATE TRUE                                            22780000
227900             WHEN SQLCODE = ZERO                                  22790000
228000             WHEN SQLCODE = +100                                  22800000
228100             WHEN SQLCODE = -904                                  22810000
228200             WHEN SQLCODE = -913                                  22820000
228300             WHEN SQLCODE = -911                                  22830000
228400                  CONTINUE                                        22840000
228500                                                                  22850000
228600             WHEN SQLWARN0 NOT = SPACES                           22860000
228700             WHEN SQLCODE NOT = ZERO                              22870000
228800                  MOVE +4             TO PV-RETRY-COUNTER         22880000
228900         END-EVALUATE                                             22890000
229000     END-PERFORM.                                                 22900000
229100                                                                  22910000
229200     IF SQLCODE = ZERO                                            22920000
229300         MOVE DLT00005-DFLT-CART-CUBE-MU  TO DL002-WMS0102-CUBE   22930000
229400***      MOVE DLT00005-DFLT-CART-WT-MU TO DL002-WMS0102-WEIGHT    22940000
229500     ELSE                                                         22950000
229600     IF SQLCODE = +100                                            22960000
229700         MOVE ZEROS            TO DL002-WMS0102-CUBE              22970000
229800         MOVE ZEROS            TO DL002-WMS0102-WEIGHT            22980000
229900     ELSE                                                         22990000
230000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         23000000
230100         MOVE SQLCODE               TO PV-SQLCODE                 23010000
230200         MOVE 'SELECT CUBE BY DEPT' TO PV-DB2-OPERATION-MESSAGE-1 23020000
230300         MOVE 'DLT_DEPT_CART_DFLT'  TO PV-DB2-TABLE-NAME          23030000
230400         MOVE XLT00004-DEPT-NBR     TO PV-DISPLAY-DEPT-NBR        23040000
230500         STRING 'DLT-DEPT-CART = '       DELIMITED BY SIZE        23050000
230600                 PV-DISPLAY-DEPT-NBR DELIMITED BY SIZE            23060000
230700                                   INTO PV-DB2-OPERATION-MESSAGE-223070000
230800         PERFORM 9999-SQL-ABEND                                   23080000
230900     END-IF.                                                      23090000
231000                                                                  23100000
231100****************************************************************  23110000
231200*                                                              *  23120000
231300*                                                              *  23130000
231400****************************************************************  23140000
231500 4080-SELECT-TRECEIV-PKGNG.                                       23150000
231600     MOVE '4080-SELECT-TRECEIV-PKGNG' TO PV-ABEND-PARAGRAPH.      23160000
231700***  DISPLAY 'NOW IN 4080-SELECT-TRECEIV-PKGNG'.                  23170000
231800                                                                  23180000
231900     PERFORM                                                      23190000
232000         WITH TEST AFTER                                          23200000
232100             VARYING PV-RETRY-COUNTER                             23210000
232200             FROM 1 BY 1                                          23220000
232300             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              23230000
232400                OR SQLCODE = ZERO                                 23240000
232500                OR SQLCODE = +100                                 23250000
232600                OR SQLCODE = -811                                 23260000
232700                                                                  23270000
232800         EXEC SQL                                                 23280000
232900              SELECT  A.PKGNG_CDE                                 23290000
233000                   ,  A.PACK_BY_ST_IND                            23300000
233100                INTO :RECEIV-PKGNG-CDE                            23310000
233200                    ,:RECEIV-PACK-BY-ST-IND                       23320000
233300              FROM  TRECEIV A                                     23330000
233400              WHERE A.ORD_NBR           = :INPKSU-PO-NBR          23340000
233500                AND A.REC_SEQ_NBR       = :PKSLIP-REC-SEQ-NBR     23350000
233600                AND A.VER_STATUS_CDE    = 'A'                     23360000
233700              WITH UR                                             23370000
233800         END-EXEC                                                 23380000
233900                                                                  23390000
234000         EVALUATE TRUE                                            23400000
234100             WHEN SQLCODE = ZERO                                  23410000
234200             WHEN SQLCODE = -811                                  23420000
234300             WHEN SQLCODE = +100                                  23430000
234400             WHEN SQLCODE = -904                                  23440000
234500             WHEN SQLCODE = -913                                  23450000
234600             WHEN SQLCODE = -911                                  23460000
234700                  CONTINUE                                        23470000
234800                                                                  23480000
234900             WHEN SQLWARN0 NOT = SPACES                           23490000
235000             WHEN SQLCODE NOT = ZERO                              23500000
235100                  MOVE +4             TO PV-RETRY-COUNTER         23510000
235200         END-EVALUATE                                             23520000
235300     END-PERFORM.                                                 23530000
235400                                                                  23540000
235500     IF (SQLCODE = ZERO OR -811)                                  23550000
235600         MOVE RECEIV-PKGNG-CDE       TO PV-PACK-TYPE              23560000
235700         MOVE RECEIV-PACK-BY-ST-IND  TO PV-PACK-BY-STR            23570000
235800         PERFORM 6000-CHECK-PKGNG-CDE                             23580000
235900         MOVE INPKSU-PO-NBR      TO PV-PO-NBR                     23590000
236000         MOVE PKSLIP-REC-SEQ-NBR TO PV-REC-SEQ                    23600000
236100         STRING PV-PO-NBR              DELIMITED BY SIZE          23610000
236200                '-'                    DELIMITED BY SIZE          23620000
236300                PV-REC-SEQ             DELIMITED BY SIZE          23630000
236400                             INTO DL002-WMS0102-USER-DEF-5        23640000
236500***      MOVE PURCHS-ENT-ID      TO DL002-WMS0102-CLIENT-ID       23650000
236600     ELSE                                                         23660000
236700     IF SQLCODE = +100                                            23670000
236800         CONTINUE                                                 23680000
236900     ELSE                                                         23690000
237000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         23700000
237100         MOVE INPKSU-PO-NBR      TO PV-PO-NBR                     23710000
237200         MOVE PKSLIP-REC-SEQ-NBR TO PV-REC-SEQ                    23720000
237300         MOVE SQLCODE               TO PV-SQLCODE                 23730000
237400         MOVE 'SELECT PKGNG'   TO PV-DB2-OPERATION-MESSAGE-1      23740000
237500         MOVE 'TRECEIV     ' TO PV-DB2-TABLE-NAME                 23750000
237600         STRING 'PO / RCVR = '    DELIMITED BY SIZE               23760000
237700                 PV-PO-NBR              DELIMITED BY SIZE         23770000
237800                '-'               DELIMITED BY SIZE               23780000
237900                 PV-REC-SEQ             DELIMITED BY SIZE         23790000
238000                                   INTO PV-DB2-OPERATION-MESSAGE-223800000
238100         PERFORM 9999-SQL-ABEND                                   23810000
238200     END-IF.                                                      23820000
238300                                                                  23830000
238400****************************************************************  23840000
238500*                                                              *  23850000
238600*                                                              *  23860000
238700****************************************************************  23870000
238800 4090-SELECT-TPURCHS-FOR-ENTID.                                   23880000
238900     MOVE '4090-SELECT-TPURCHS-FOR-ENTID' TO PV-ABEND-PARAGRAPH.  23890000
239000***  DISPLAY 'NOW IN 4090-SELECT-TPURCHS-FOR-ENTID'.              23900000
239100                                                                  23910000
239200     PERFORM                                                      23920000
239300         WITH TEST AFTER                                          23930000
239400             VARYING PV-RETRY-COUNTER                             23940000
239500             FROM 1 BY 1                                          23950000
239600             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              23960000
239700                OR SQLCODE = ZERO                                 23970000
239800                OR SQLCODE = +100                                 23980000
239900                OR SQLCODE = -811                                 23990000
240000                                                                  24000000
240100         EXEC SQL                                                 24010000
240200             SELECT  ENT_ID                                       24020000
240300               INTO :PURCHS-ENT-ID                                24030000
240400               FROM  TPURCHS                                      24040000
240500               WHERE PO_NBR = :DK-PO-NBR                          24050000
240600                 AND VER_STATUS_CDE = 'A'                         24060000
240700              WITH UR                                             24070000
240800         END-EXEC                                                 24080000
240900                                                                  24090000
241000         EVALUATE TRUE                                            24100000
241100             WHEN SQLCODE = ZERO                                  24110000
241200             WHEN SQLCODE = -811                                  24120000
241300             WHEN SQLCODE = +100                                  24130000
241400             WHEN SQLCODE = -904                                  24140000
241500             WHEN SQLCODE = -913                                  24150000
241600             WHEN SQLCODE = -911                                  24160000
241700                  CONTINUE                                        24170000
241800                                                                  24180000
241900             WHEN SQLWARN0 NOT = SPACES                           24190000
242000             WHEN SQLCODE NOT = ZERO                              24200000
242100                  MOVE +4             TO PV-RETRY-COUNTER         24210000
242200         END-EVALUATE                                             24220000
242300     END-PERFORM.                                                 24230000
242400                                                                  24240000
242500     IF SQLCODE = ZERO OR -811                                    24250000
242600         CONTINUE                                                 24260000
242700***      MOVE PURCHS-ENT-ID      TO DL002-WMS0102-CLIENT-ID       24270000
242800     ELSE                                                         24280000
242900     IF SQLCODE = +100                                            24290000
243000         CONTINUE                                                 24300000
243100***      MOVE SPACES           TO DL002-WMS0102-CLIENT-ID         24310000
243200     ELSE                                                         24320000
243300     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         24330000
243400         MOVE SQLCODE               TO PV-SQLCODE                 24340000
243500         MOVE 'SELECT FOR ENTID'   TO PV-DB2-OPERATION-MESSAGE-1  24350000
243600         MOVE 'TPURCHS'      TO PV-DB2-TABLE-NAME                 24360000
243700         MOVE DK-PO-NBR             TO PV-PO-NBR                  24370000
243800         STRING 'PO NUMBER = '       DELIMITED BY SIZE            24380000
243900                 PV-PO-NBR           DELIMITED BY SIZE            24390000
244000                                   INTO PV-DB2-OPERATION-MESSAGE-224400000
244100         PERFORM 9999-SQL-ABEND                                   24410000
244200     END-IF.                                                      24420000
244300                                                                  24430000
244400******************************************************************24440000
244500* BUILDS THE WMS0102 RECORD FOR A SHIPPING TRAILER OPEN OR CLOSE *24450000
244600******************************************************************24460000
244700 4200-BUILD-WMS0102-SHIP-TRLR.                                    24470000
244800                                                                  24480000
244900     MOVE '4200-BUILD-WMS0102-SHIP-TRLR'   TO PV-ABEND-PARAGRAPH. 24490000
245000***  DISPLAY 'NOW IN 4200-BUILD-WMS0102'.                         24500000
245100     INITIALIZE DL002-RECORD.                                     24510000
245200     SET PS-WMS0102-RECORD TO TRUE.                               24520000
245300     MOVE DL003-EVNT-KY-1-NBR       TO DK-TRIP-ID.                24530000
245400     MOVE DL003-DTL-TXT-AREA        TO PC242-DTL-TXT.             24540000
245500     MOVE PC242-AH-ASGMT-STRT-DTE    TO DK-ASGMT-STRT-DTE         24550000
245600                                       PV-INPUT-TMST-DATE.        24560000
245700     MOVE PC242-AH-ASGMT-NBR-TXT     TO DK-ASGMT-NBR-TXT          24570000
245800                                       PV-ASSIGNMENT-1-10.        24580000
245900     MOVE PC242-AH-ASGMT-NBR-SEQ-NBR TO DK-ASGMT-NBR-SEQ-NBR      24590000
246000                                        PV-ASSIGNMENT-11-15.      24600000
246100     PERFORM 4000-SELECT-ASSIGNMENT.                              24610000
246200     IF DK-TRIP-ID = 0                                            24620000
246300         MOVE SPACES                  TO DL002-WMS0102-REF-ID     24630000
246400         MOVE SPACES                  TO DL002-WMS0102-USER-DEF-4 24640000
246500         MOVE SPACES                  TO DL002-WMS0102-CUST-NO    24650000
246600     ELSE                                                         24660000
246700         PERFORM 4910-SELECTS-BY-TRIP-ID                          24670000
246800     END-IF.                                                      24680000
246900     MOVE PC242-AH-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  24690000
247000     MOVE PC242-AH-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    24700000
247100     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    24710000
247200     MOVE 'O'                      TO DL002-WMS0102-OBTAIN-PLACE. 24720000
247300     IF DL003-EVNT-OBJ-ACTN-TXT = 'TRAILER OPEN'                  24730000
247400         MOVE 1                    TO DL002-WMS0102-SPEC-HAND-3   24740000
247500     ELSE                                                         24750000
247600         MOVE 1                    TO DL002-WMS0102-SPEC-HAND-4   24760000
247700     END-IF.                                                      24770000
247800     MOVE ZEROS                  TO  DL002-WMS0102-CUBE           24780000
247900                                     DL002-WMS0102-WEIGHT.        24790000
248000     MOVE PC-N                   TO DL002-WMS0102-FUNC-ID.        24800000
248100     MOVE PV-INPUT-TMST-YR       TO PV-PLAN-DATE-YR.              24810000
248200     MOVE PV-INPUT-TMST-MO       TO PV-PLAN-DATE-MO.              24820000
248300     MOVE PV-INPUT-TMST-DA       TO PV-PLAN-DATE-DA.              24830000
248400     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      24840000
248500     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     24850000
248600                                                                  24860000
248700******************************************************************24870000
248800* BUILDS THE WMS0102 RECORD FOR A SHIPPING CARTON MANUAL SCAN    *24880000
248900******************************************************************24890000
249000 4300-BUILD-WMS0102-CRTN-SCAN.                                    24900000
249100                                                                  24910000
249200     MOVE '4300-BUILD-WMS0102-CRTN-SCAN' TO PV-ABEND-PARAGRAPH.   24920000
249300***  DISPLAY 'NOW IN 4300-BUILD-WMS0102'.                         24930000
249400     INITIALIZE DL002-RECORD.                                     24940000
249500     SET PS-WMS0102-RECORD TO TRUE.                               24950000
249600     MOVE DL003-EVNT-KY-3-NBR       TO DK-SHIP-UNT-ID             24960000
249700                                       PV-DISPLAY-SHIP-UNT-ID.    24970000
249800     MOVE DL003-EVNT-KY-1-NBR       TO DK-TRIP-ID.                24980000
249900     MOVE DL003-DTL-TXT-AREA        TO PC242-DTL-TXT.             24990000
250000     MOVE PC242-AG-ASGMT-STRT-DTE    TO DK-ASGMT-STRT-DTE         25000000
250100                                       PV-INPUT-TMST-DATE.        25010000
250200     MOVE PC242-AG-ASGMT-NBR-TXT     TO DK-ASGMT-NBR-TXT          25020000
250300                                       PV-ASSIGNMENT-1-10.        25030000
250400     MOVE PC242-AG-ASGMT-NBR-SEQ-NBR TO DK-ASGMT-NBR-SEQ-NBR      25040000
250500                                        PV-ASSIGNMENT-11-15.      25050000
250600     PERFORM 4000-SELECT-ASSIGNMENT.                              25060000
250700     IF DK-TRIP-ID = 0                                            25070000
250800         MOVE SPACES                  TO DL002-WMS0102-REF-ID     25080000
250900         MOVE SPACES                  TO DL002-WMS0102-USER-DEF-4 25090000
251000         MOVE SPACES                  TO DL002-WMS0102-CUST-NO    25100000
251100     ELSE                                                         25110000
251200         PERFORM 4910-SELECTS-BY-TRIP-ID                          25120000
251300     END-IF.                                                      25130000
251400     PERFORM 4940-SELECT-SUTOTBND-FOR-UNITS.                      25140000
251500     MOVE PC242-AG-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  25150000
251600     MOVE PC242-AG-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    25160000
251700     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    25170000
251800     MOVE 'P'                  TO DL002-WMS0102-OBTAIN-PLACE.     25180000
251900     MOVE PC-N                   TO DL002-WMS0102-FUNC-ID.        25190000
252000     MOVE 1                      TO DL002-WMS0102-SPEC-HAND-1.    25200000
252100     MOVE 1                      TO DL002-WMS0102-SPEC-HAND-2.    25210000
252200     MOVE ZEROS                  TO DL002-WMS0102-CUBE            25220000
252300                                    DL002-WMS0102-WEIGHT.         25230000
252400     MOVE PV-INPUT-TMST-YR       TO PV-PLAN-DATE-YR.              25240000
252500     MOVE PV-INPUT-TMST-MO       TO PV-PLAN-DATE-MO.              25250000
252600     MOVE PV-INPUT-TMST-DA       TO PV-PLAN-DATE-DA.              25260000
252700     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      25270000
252800     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     25280000
252900                                                                  25290000
253000******************************************************************25300000
253100* BUILDS THE WMS0102 RECORD FOR A SHIPPING PALLET MANUAL SCAN    *25310000
253200******************************************************************25320000
253300 4400-BUILD-WMS0102-PLLT-SCAN.                                    25330000
253400                                                                  25340000
253500     MOVE '4400-BUILD-WMS0102-PLLT-SCAN' TO PV-ABEND-PARAGRAPH.   25350000
253600***  DISPLAY 'NOW IN 4400-BUILD-WMS0102'.                         25360000
253700     INITIALIZE DL002-RECORD.                                     25370000
253800     SET PS-WMS0102-RECORD TO TRUE.                               25380000
253900     MOVE DL003-EVNT-KY-1-NBR       TO DK-TRIP-ID.                25390000
254000     MOVE DL003-DTL-TXT-AREA        TO PC242-DTL-TXT.             25400000
254100     MOVE PC242-AF-ASGMT-STRT-DTE    TO DK-ASGMT-STRT-DTE         25410000
254200                                       PV-INPUT-TMST-DATE.        25420000
254300     MOVE PC242-AF-ASGMT-NBR-TXT     TO DK-ASGMT-NBR-TXT          25430000
254400                                       PV-ASSIGNMENT-1-10.        25440000
254500     MOVE PC242-AF-ASGMT-NBR-SEQ-NBR TO DK-ASGMT-NBR-SEQ-NBR      25450000
254600                                        PV-ASSIGNMENT-11-15.      25460000
254700     PERFORM 4000-SELECT-ASSIGNMENT.                              25470000
254800     IF DK-TRIP-ID = 0                                            25480000
254900         MOVE SPACES                  TO DL002-WMS0102-REF-ID     25490000
255000         MOVE SPACES                  TO DL002-WMS0102-USER-DEF-4 25500000
255100         MOVE SPACES                  TO DL002-WMS0102-CUST-NO    25510000
255200     ELSE                                                         25520000
255300         PERFORM 4910-SELECTS-BY-TRIP-ID                          25530000
255400     END-IF.                                                      25540000
255500     MOVE PC242-AF-ASGMT-SEQ-DTL-NBR-O TO DL002-WMS0102-TRANS-NUM.25550000
255600     MOVE PC242-AF-ASGMT-SEQ-DTL-NBR-O TO DL002-WMS0102-SEQ-NUM.  25560000
255700     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    25570000
255800     MOVE 'O'                  TO DL002-WMS0102-OBTAIN-PLACE.     25580000
255900     MOVE 1                    TO DL002-WMS0102-CONT-1.           25590000
256000     MOVE ZEROS                TO DL002-WMS0102-SHIP-UNITS        25600000
256100                                  DL002-WMS0102-CUBE              25610000
256200                                  DL002-WMS0102-WEIGHT.           25620000
256300     MOVE PC-N                   TO DL002-WMS0102-FUNC-ID.        25630000
256400     MOVE PV-INPUT-TMST-YR       TO PV-PLAN-DATE-YR.              25640000
256500     MOVE PV-INPUT-TMST-MO       TO PV-PLAN-DATE-MO.              25650000
256600     MOVE PV-INPUT-TMST-DA       TO PV-PLAN-DATE-DA.              25660000
256700     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      25670000
256800     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     25680000
256900     PERFORM 9000-WRITE-OUTPUT-RECORD.                            25690000
257000     MOVE PC242-AF-ASGMT-SEQ-DTL-NBR-P TO DL002-WMS0102-TRANS-NUM.25700000
257100     MOVE PC242-AF-ASGMT-SEQ-DTL-NBR-P TO DL002-WMS0102-SEQ-NUM.  25710000
257200     MOVE 'P'                    TO DL002-WMS0102-OBTAIN-PLACE.   25720000
257300     MOVE ZEROS                  TO DL002-WMS0102-CONT-1.         25730000
257400     MOVE PC242-AF-INNER-CARTON-QTY TO DL002-WMS0102-SHIP-UNITS.  25740000
257500     MOVE PC242-AF-INNER-UNIT-QTY   TO DL002-WMS0102-HUNIT-3.     25750000
257600     MOVE 1                      TO DL002-WMS0102-SPEC-HAND-1.    25760000
257700     PERFORM 9000-WRITE-OUTPUT-RECORD.                            25770000
257800                                                                  25780000
257900******************************************************************25790000
258000* BUILDS THE WMS0102 RECORD FOR A SHIPPING DOOR SUMMARY          *25800000
258100* THE BEGINNING TIMESTAMP USED TO SELECT THE CONTAINER DIVERT    *25810000
258200* INFORMATION IS CALCULATED BASED ON A TIME PARAMETER IN THE     *25820000
258300* TKRPRPM TABLE.  A RECORD WILL BE WRITTEN TO A FILE THAT        *25830000
258400* CONTAINS THE BEGINNING AND ENDING TIMESTAMPS FOR THE CURRENT   *25840000
258500* DOOR SUMMARY RECORD BEING PROCESSED.  THIS RECORD WILL BE      *25850000
258600* WRITTEN TO THE DLT_DC_DOOR_SUM TABLE TO BE USED WHEN           *25860000
258700* CALCULATING THE BEGINNING TIMESTAMP FOR FUTURE DOOR SUMMARY    *25870000
258800* EVENTS FOR THE SPECIFIED DOOR.                                 *25880000
258900******************************************************************25890000
259000 4500-BUILD-WMS0102-DOOR-SMRY.                                    25900000
259100                                                                  25910000
259110     MOVE +0 TO   PV-CARTONS-ZERO-UNITS                           25911034
259120                  PV-SUM-CARTONS-LM                               25912030
259200     MOVE '4500-BUILD-WMS0102-DOOR-SMRY' TO PV-ABEND-PARAGRAPH.   25920000
259300     DISPLAY 'NOW IN 4500-BUILD-WMS0102'.                         25930000
259400     INITIALIZE DL002-RECORD.                                     25940000
259500     SET PS-WMS0102-RECORD TO TRUE.                               25950000
259600     SET PS-NO-DOOR-SUM-TBL-ENTRY-FOUND                           25960000
259700         PS-DOOR-SUMMARY-HIST       TO TRUE.                      25970000
259800     MOVE DL003-EVNT-KY-1-NBR       TO DK-TRIP-ID.                25980000
259900     MOVE DL003-EVNT-KY-2-NBR       TO DK-OPER-UNT-ID.            25990000
260000     MOVE DL003-EVNT-KY-1-TXT       TO DK-DOOR-NUMBER.            26000000
260100                                                                  26010000
260200     DISPLAY '** '.                                               26020000
260300     DISPLAY '** BEGINNING TIMESTAMP(FROM INPUT RECORD): '        26030000
260400              DL003-EVNT-KY-1-TMST.                               26040000
260500     DISPLAY '** ENDING TIMESTAMP(FROM INPUT RECORD)...: '        26050000
260600              DL003-EVNT-KY-2-TMST.                               26060000
260700     DISPLAY '** START TIME ADJUST PARAMETER...........: '        26070000
260800**            PV-TIME-QTY.                                        26080000
260900**   DISPLAY '** DOOR NUMBER...........................: '        26090000
261000**            DK-DOOR-NUMBER.                                     26100000
261100**   DISPLAY '** '.                                               26110000
261200                                                                  26120000
261300     IF  PS-DOOR-SUMMARY-HIST                                     26130000
261400         IF  PV-DOOR-SUM-TABLE-COUNT > 0                          26140000
261500             PERFORM 4505-SEARCH-DOOR-SUM-HIST-TBL                26150000
261600         END-IF                                                   26160000
261700         IF  PS-NO-DOOR-SUM-TBL-ENTRY-FOUND                       26170000
261800             PERFORM 4510-SELECT-CURR-DOOR-SUM-HIST               26180000
261900         END-IF                                                   26190000
262000         IF  DLT00011-DOOR-SUM-END-TMST = PC-DEFAULT-TMST         26200000
262100             MOVE DL003-EVNT-KY-1-TMST                            26210000
262200                                    TO DK-EVNT-KY-1-TMST          26220000
262300         ELSE                                                     26230000
262400             PERFORM 4520-SET-BEGINNING-TMST                      26240000
262500         END-IF                                                   26250000
262600     ELSE                                                         26260000
262700         MOVE DL003-EVNT-KY-1-TMST  TO DK-EVNT-KY-1-TMST          26270000
262800     END-IF.                                                      26280000
262900                                                                  26290000
263000     MOVE DL003-EVNT-KY-1-TXT       TO DL002-WMS0102-USER-DEF-3.  26300000
263100     MOVE DL003-DTL-TXT-AREA        TO PC242-DTL-TXT.             26310000
263200     MOVE PC242-AE-ASGMT-STRT-DTE    TO DK-ASGMT-STRT-DTE         26320000
263300                                       PV-INPUT-TMST-DATE.        26330000
263400     MOVE PC242-AE-ASGMT-NBR-TXT     TO DK-ASGMT-NBR-TXT          26340000
263500                                       PV-ASSIGNMENT-1-10.        26350000
263600     MOVE PC242-AE-ASGMT-NBR-SEQ-NBR TO DK-ASGMT-NBR-SEQ-NBR      26360000
263700                                        PV-ASSIGNMENT-11-15.      26370000
263800     PERFORM 4000-SELECT-ASSIGNMENT.                              26380000
263900     IF DK-TRIP-ID = 0                                            26390000
264000         MOVE SPACES                  TO DL002-WMS0102-REF-ID     26400000
264100         MOVE SPACES                  TO DL002-WMS0102-USER-DEF-4 26410000
264200         MOVE SPACES                  TO DL002-WMS0102-CUST-NO    26420000
264300     ELSE                                                         26430000
264400         PERFORM 4910-SELECTS-BY-TRIP-ID                          26440000
264500     END-IF.                                                      26450000
264600                                                                  26460000
264700     DISPLAY '** BEGINNING TIMESTAMP(FOR CARTON DATA SELECT): '   26470000
264800              DK-EVNT-KY-1-TMST.                                  26480000
264900     DISPLAY '** ENDING TIMESTAMP(FOR CARTON DATA SELECT)...: '   26490000
265000              DL003-EVNT-KY-2-TMST.                               26500000
265100     DISPLAY '** '.                                               26510000
265200                                                                  26520000
265300     PERFORM 4950-SELECT-COUNT-CARTONS.                           26530000
265400     MOVE PC242-AE-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  26540000
265500     MOVE PC242-AE-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    26550000
265600     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    26560000
265700     MOVE 'P'                  TO DL002-WMS0102-OBTAIN-PLACE.     26570000
265800     MOVE PC-N                   TO DL002-WMS0102-FUNC-ID.        26580000
265900     MOVE ZEROS                  TO DL002-WMS0102-CUBE            26590000
266000                                    DL002-WMS0102-WEIGHT.         26600000
266100     MOVE PV-INPUT-TMST-YR       TO PV-PLAN-DATE-YR.              26610000
266200     MOVE PV-INPUT-TMST-MO       TO PV-PLAN-DATE-MO.              26620000
266300     MOVE PV-INPUT-TMST-DA       TO PV-PLAN-DATE-DA.              26630000
266400     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      26640000
266500     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     26650000
266600     MOVE ZEROS                  TO PV-TOTAL-UNITS.               26660000
266700                                                                  26670000
266800     SET PS-NOT-END-OF-CARTON-CURSOR TO TRUE.                     26680000
266900     PERFORM 8000-OPEN-CARTON-CURSOR.                             26690000
267000     PERFORM UNTIL (PS-END-OF-CARTON-CURSOR)                      26700000
267100         PERFORM 8100-FETCH-CARTON                                26710000
267200     END-PERFORM.                                                 26720000
267300     PERFORM 8200-CLOSE-CARTON-CURSOR.                            26730000
267400                                                                  26740000
267500     MOVE PV-TOTAL-UNITS         TO DL002-WMS0102-HUNIT-3.        26750000
267510     MOVE PV-SUM-CARTONS         TO DL002-WMS0102-SHIP-UNITS.     26751020
267511                                                                  26751130
267520     DISPLAY 'CARTONS DLX.......:' DL002-WMS0102-SHIP-UNITS.      26752034
267530     DISPLAY 'CARTONS LM........:' PV-SUM-CARTONS-LM.             26753034
267540     DISPLAY 'CARTONS ZERO UNITS:' PV-CARTONS-ZERO-UNITS.         26754034
267600                                                                  26760000
267700****************************************************************  26770000
267800* SEARCH THE DOOR SUM HISTORY COBOL TABLE FOR THE LATEST END   *  26780000
267900* TIMESTAMP FOR THIS DOOR.  THIS CODE WAS ADDED WHEN WE HAVE   *  26790000
268000* THE SITUATION WHERE DOOR SUMMARY RECORDS ARE BEING PROCESSED *  26800000
268100* FROM MULTIPLE TIME PERIODS IN A SINGLE RUN.  THIS USUALLY    *  26810000
268200* HAPPENS WHEN THE BATCH JOB HAS BEEN HELD FOR A PERIOD OF     *  26820000
268300* TIME AND MULTIPLE TIME PERIODS NEED TO BE PROCESSED IN ORDER *  26830000
268400* TO GET CAUGHT UP WITH THE PROCESSING.                        *  26840000
268500****************************************************************  26850000
268600 4505-SEARCH-DOOR-SUM-HIST-TBL.                                   26860000
268700     MOVE '4505-SEARCH-DOOR-SUM-HIST-TBL'                         26870000
268800                                     TO PV-ABEND-PARAGRAPH.       26880000
268900***  DISPLAY 'NOW IN 4505-SEARCH-DOOR-SUM-HIST-TBL'.              26890026
269000                                                                  26900000
269100***  SEARCH THE DOOR SUMMARY COBOL TABLE FROM THE END TO GET THE  26910000
269200***  LATEST ENDING TIMESTAMP FOR A SPECIFIED DOOR.                26920000
269300     PERFORM VARYING PV-SUB                                       26930000
269400                FROM PV-DOOR-SUM-TABLE-COUNT                      26940000
269500                  BY -1                                           26950000
269600               UNTIL PS-DOOR-SUM-TBL-ENTRY-FOUND                  26960000
269700                  OR PV-SUB < 1                                   26970000
269800                                                                  26980000
269900         IF  PV-DOOR-ID(PV-SUB) = DK-DOOR-NUMBER                  26990000
270000             MOVE PV-END-TMST(PV-SUB)                             27000000
270100                                     TO DLT00011-DOOR-SUM-END-TMST27010000
270200             SET PS-DOOR-SUM-TBL-ENTRY-FOUND                      27020000
270300                                     TO TRUE                      27030000
270400                                                                  27040000
270500****  DMH - 11/12/09 BEGIN                                        27050000
270600**** UPDATE THE TIMESTAMP FOR THE DOOR TO THE NEW TIMESTAMP       27060000
270700**** THIS WAY WE ONLY NEED ONE ROW IN THIS TABLE FOR EACH DOORI   27070000
270800****         DISPLAY PV-DOOR-ID(PV-SUB)  '   -  '                 27080000
270900****                 PV-END-TMST(PV-SUB)  '  -  '                 27090000
271000****                 DL003-EVNT-KY-2-TMST                         27100000
271100                                                                  27110000
271200             MOVE DL003-EVNT-KY-2-TMST                            27120000
271300                                     TO PV-END-TMST(PV-SUB)       27130000
271400****  DMH - 11/12/09 END                                          27140000
271500                                                                  27150000
271600         END-IF                                                   27160000
271700                                                                  27170000
271800     END-PERFORM.                                                 27180000
271900                                                                  27190000
272000****************************************************************  27200000
272100* SELECT THE MOST RECENT ROW FROM THE DLT_DC_DOOR_SUM TABLE.   *  27210000
272200****************************************************************  27220000
272300 4510-SELECT-CURR-DOOR-SUM-HIST.                                  27230000
272400     MOVE '4510-SELECT-CURR-DOOR-SUM-HIST'                        27240000
272500                                     TO PV-ABEND-PARAGRAPH.       27250000
272600***  DISPLAY 'NOW IN 4510-SELECT-CURR-DOOR-SUM-HIST'.             27260026
272700                                                                  27270000
272800     INITIALIZE DCLDLT00011.                                      27280000
272900                                                                  27290000
273000     PERFORM                                                      27300000
273100         WITH TEST AFTER                                          27310000
273200             VARYING PV-RETRY-COUNTER                             27320000
273300             FROM 1 BY 1                                          27330000
273400             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              27340000
273500                OR SQLCODE = ZERO                                 27350000
273600                OR SQLCODE = +100                                 27360000
273700                                                                  27370000
273800         EXEC SQL                                                 27380000
273900             SELECT DOOR_SUM_END_TMST                             27390000
274000               INTO :DLT00011-DOOR-SUM-END-TMST                   27400000
274100               FROM DLT_DC_DOOR_SUM A                             27410000
274200              WHERE A.OPER_UNT_ID       = :DK-OPER-UNT-ID         27420000
274300                AND A.DOOR_ID           = :DK-DOOR-NUMBER         27430000
274400                AND A.DOOR_SUM_END_TMST = (                       27440000
274500                    SELECT MAX(B.DOOR_SUM_END_TMST)               27450000
274600                      FROM DLT_DC_DOOR_SUM B                      27460000
274700                     WHERE B.OPER_UNT_ID = A.OPER_UNT_ID          27470000
274800                       AND B.DOOR_ID     = A.DOOR_ID)             27480000
274900         END-EXEC                                                 27490000
275000                                                                  27500000
275100         EVALUATE TRUE                                            27510000
275200             WHEN SQLCODE = ZERO                                  27520000
275300                  CONTINUE                                        27530000
275400             WHEN SQLCODE = +100                                  27540000
275500                  MOVE PC-DEFAULT-TMST                            27550000
275600                                     TO DLT00011-DOOR-SUM-END-TMST27560000
275700                                                                  27570000
275800             WHEN SQLCODE = -904                                  27580000
275900             WHEN SQLCODE = -913                                  27590000
276000             WHEN SQLCODE = -911                                  27600000
276100                 CONTINUE                                         27610000
276200             WHEN SQLWARN0 NOT = SPACES                           27620000
276300             WHEN SQLCODE NOT = ZERO                              27630000
276400                  MOVE +4             TO PV-RETRY-COUNTER         27640000
276500         END-EVALUATE                                             27650000
276600     END-PERFORM.                                                 27660000
276700                                                                  27670000
276800     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         27680000
276900         MOVE SQLCODE               TO PV-SQLCODE                 27690000
277000         MOVE 'SELECT BEG TMST'     TO PV-DB2-OPERATION-MESSAGE-1 27700000
277100         MOVE 'DLT_DC_DOOR_SUM'     TO PV-DB2-TABLE-NAME          27710000
277200         MOVE DK-OPER-UNT-ID        TO PV-DISPLAY-OPER-UNT-ID     27720000
277300         STRING 'OPER UNT ID: '         DELIMITED BY SIZE         27730000
277400                 PV-DISPLAY-OPER-UNT-ID DELIMITED BY SIZE         27740000
277500                '  DOOR ID: '           DELIMITED BY SIZE         27750000
277600                 DK-DOOR-NUMBER         DELIMITED BY SIZE         27760000
277700                                   INTO PV-DB2-OPERATION-MESSAGE-227770000
277800         PERFORM 9999-SQL-ABEND                                   27780000
277900     END-IF.                                                      27790000
278000                                                                  27800000
278100******************************************************************27810000
278200* SET THE BEGINNING TIMESTAMP.  START BY CALCULATING A COMPARE   *27820000
278300* DATE BY SUBTRACTING THE HOURLY PARM VALUE FROM THE BEGINNING   *27830000
278400* TIMESTAMP OF THE CURRENT EVENT TIME PERIOD.  IF THE CALCULATED *27840000
278500* TIMESTAMP IS BEFORE THE ENDING TIMESTAMP OF THE PREVIOUS EVENT *27850000
278600* TIME PERIOD, WE WILL USE THIS CALCULATED TIMESTAMP FOR THE     *27860000
278700* BEGINNING TIMESTAMP FOR SELECTING CONTAINER DIVERT INFORMATION.*27870000
278800* OTHERWISE, WE WILL USE THE ENDING TIMESTAMP OF THE PREVIOUS    *27880000
278900* EVENT TIME PERIOD FOR THE BEGINNING TIMESTAMP.  THIS IS BEING  *27890000
279000* DONE TO COLLECT DATA THAT IS MISSED WHEN THERE ARE GAPS        *27900000
279100* BETWEEN THE EVENT TIME PERIODS.                                *27910000
279200******************************************************************27920000
279300 4520-SET-BEGINNING-TMST.                                         27930000
279400                                                                  27940000
279500     MOVE '4520-SET-BEGINNING-TMST'        TO PV-ABEND-PARAGRAPH. 27950000
279600     DISPLAY 'NOW IN 4520-SET-BEGINNING-TMST'.                    27960000
279700                                                                  27970000
279800     EXEC SQL                                                     27980000
279900        SET :PV-COMPARE-TMST = (TIMESTAMP(:DL003-EVNT-KY-1-TMST) -27990000
280000                                :PV-TIME-QTY HOURS)               28000000
280100     END-EXEC.                                                    28010000
280300     IF  DLT00011-DOOR-SUM-END-TMST >= PV-COMPARE-TMST            28030040
280400         MOVE DLT00011-DOOR-SUM-END-TMST TO DK-EVNT-KY-1-TMST     28040040
280500     ELSE                                                         28050040
280600         MOVE PV-COMPARE-TMST            TO DK-EVNT-KY-1-TMST     28060040
280700     END-IF.                                                      28070040
280800                                                                  28080000
280900******************************************************************28090000
281000* BUILDS THE WMS0102 RECORD FOR ADD TO MASTER PICKMADE           *28100000
281100******************************************************************28110000
281200                                                                  28120000
281300 4600-BUILD-WMS0102-ADD-MASTER.                                   28130000
281400                                                                  28140000
281500     MOVE '4600-BUILD-WMS0102-ADD-MASTER' TO PV-ABEND-PARAGRAPH.  28150000
281600                                                                  28160000
281700***  DISPLAY 'NOW IN 4600-BUILD-WMS0102-ADD-MASTER'.              28170000
281800                                                                  28180000
281900     INITIALIZE DL002-RECORD.                                     28190000
282000                                                                  28200000
282100     SET PS-WMS0102-RECORD TO TRUE.                               28210000
282200                                                                  28220000
282300     MOVE DL003-EVNT-KY-1-NBR       TO DK-TRIP-ID.                28230000
282400     MOVE DL003-EVNT-KY-3-NBR       TO DK-SHIP-UNT-ID             28240000
282500                                       PV-DISPLAY-SHIP-UNT-ID.    28250000
282600     MOVE DL003-DTL-TXT-AREA        TO PC242-DTL-TXT.             28260000
282700                                                                  28270000
282800     MOVE PC242-AN-ASGMT-STRT-DTE    TO   DK-ASGMT-STRT-DTE       28280000
282900                                          PV-INPUT-TMST-DATE.     28290000
283000                                                                  28300000
283100     MOVE PC242-AN-ASGMT-NBR-TXT     TO   DK-ASGMT-NBR-TXT        28310000
283200                                          PV-ASSIGNMENT-1-10.     28320000
283300                                                                  28330000
283400     MOVE PC242-AN-ASGMT-NBR-SEQ-NBR  TO  DK-ASGMT-NBR-SEQ-NBR    28340000
283500                                          PV-ASSIGNMENT-11-15.    28350000
283600                                                                  28360000
283700     PERFORM 4000-SELECT-ASSIGNMENT.                              28370000
283800                                                                  28380000
283900     MOVE PC242-AN-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  28390000
284000     MOVE PC242-AN-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    28400000
284100     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    28410000
284200     MOVE 'O'                      TO DL002-WMS0102-OBTAIN-PLACE. 28420000
284300     MOVE PC-N                   TO DL002-WMS0102-FUNC-ID.        28430000
284400                                                                  28440000
284500     MOVE PV-INPUT-TMST-YR       TO PV-PLAN-DATE-YR.              28450000
284600     MOVE PV-INPUT-TMST-MO       TO PV-PLAN-DATE-MO.              28460000
284700     MOVE PV-INPUT-TMST-DA       TO PV-PLAN-DATE-DA.              28470000
284800     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      28480000
284900                                                                  28490000
285000     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     28500000
285100                                                                  28510000
285200     MOVE 1   TO DL002-WMS0102-CONT-1.                            28520000
285300     MOVE 0   TO DL002-WMS0102-CONT-2.                            28530000
285400     MOVE 0   TO DL002-WMS0102-HUNIT-1.                           28540000
285500     MOVE 0   TO DL002-WMS0102-HUNIT-2.                           28550000
285600     MOVE 0   TO DL002-WMS0102-HUNIT-3.                           28560000
285700     MOVE 0   TO DL002-WMS0102-SPEC-HAND-1.                       28570000
285800     MOVE 0   TO DL002-WMS0102-SPEC-HAND-2.                       28580000
285900                                                                  28590000
286000******************************************************************28600000
286100* BUILDS THE WMS0102 RECORD FOR ADD CHILD TO MASTER PICKMADE     *28610000
286200******************************************************************28620000
286300                                                                  28630000
286400 4610-BLD-WMS0102-AD-CH-TO-MS.                                    28640000
286500                                                                  28650000
286600     MOVE '4610-BLD-WMS0102-AD-CH-TO-MS'                          28660000
286700           TO PV-ABEND-PARAGRAPH.                                 28670000
286800                                                                  28680000
286900*    DISPLAY 'NOW IN 4610-BLD-WMS0102-AD-CH-TO-MS'.               28690000
287000                                                                  28700000
287100     INITIALIZE DL002-RECORD.                                     28710000
287200                                                                  28720000
287300     SET PS-WMS0102-RECORD TO TRUE.                               28730000
287400                                                                  28740000
287500     MOVE DL003-EVNT-KY-1-NBR       TO DK-TRIP-ID.                28750000
287600     MOVE DL003-EVNT-KY-3-NBR       TO DK-SHIP-UNT-ID             28760000
287700                                       PV-DISPLAY-SHIP-UNT-ID.    28770000
287800     MOVE DL003-DTL-TXT-AREA        TO PC242-DTL-TXT.             28780000
287900                                                                  28790000
288000     MOVE PC242-AO-ASGMT-STRT-DTE    TO   DK-ASGMT-STRT-DTE       28800000
288100                                          PV-INPUT-TMST-DATE.     28810000
288200                                                                  28820000
288300     MOVE PC242-AO-ASGMT-NBR-TXT     TO   DK-ASGMT-NBR-TXT        28830000
288400                                          PV-ASSIGNMENT-1-10.     28840000
288500                                                                  28850000
288600     MOVE PC242-AO-ASGMT-NBR-SEQ-NBR  TO  DK-ASGMT-NBR-SEQ-NBR    28860000
288700                                          PV-ASSIGNMENT-11-15.    28870000
288800                                                                  28880000
288900     PERFORM 4000-SELECT-ASSIGNMENT.                              28890000
289000                                                                  28900000
289100     MOVE PC242-AO-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  28910000
289200     MOVE PC242-AO-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    28920000
289300     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    28930000
289400     MOVE 'P'                      TO DL002-WMS0102-OBTAIN-PLACE. 28940000
289500     MOVE PC-N                   TO DL002-WMS0102-FUNC-ID.        28950000
289600                                                                  28960000
289700     MOVE PV-INPUT-TMST-YR       TO PV-PLAN-DATE-YR.              28970000
289800     MOVE PV-INPUT-TMST-MO       TO PV-PLAN-DATE-MO.              28980000
289900     MOVE PV-INPUT-TMST-DA       TO PV-PLAN-DATE-DA.              28990000
290000     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      29000000
290100                                                                  29010000
290200     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     29020000
290300                                                                  29030000
290400     MOVE 0   TO DL002-WMS0102-CONT-1.                            29040000
290500     MOVE 0   TO DL002-WMS0102-CONT-2.                            29050000
290600     MOVE 0   TO DL002-WMS0102-HUNIT-1.                           29060000
290700     MOVE 0   TO DL002-WMS0102-HUNIT-2.                           29070000
290800     MOVE 1   TO DL002-WMS0102-HUNIT-3.                           29080000
290900     MOVE 1   TO DL002-WMS0102-SPEC-HAND-1.                       29090000
291000     MOVE 0   TO DL002-WMS0102-SPEC-HAND-2.                       29100000
291100                                                                  29110000
291200******************************************************************29120000
291300* BUILDS THE WMS0102 RECORD FOR ADD MASTER TO MASTER PICKMADE    *29130000
291400******************************************************************29140000
291500                                                                  29150000
291600 4620-BLD-WMS0102-AD-MS-TO-MS.                                    29160000
291700                                                                  29170000
291800     MOVE '4620-BLD-WMS0102-AD-MS-TO-MS'                          29180000
291900           TO PV-ABEND-PARAGRAPH.                                 29190000
292000                                                                  29200000
292100***  DISPLAY 'NOW IN 4620-BLD-WMS0102-AD-MS-TO-MS'.               29210000
292200                                                                  29220000
292300     INITIALIZE DL002-RECORD.                                     29230000
292400                                                                  29240000
292500     SET PS-WMS0102-RECORD TO TRUE.                               29250000
292600                                                                  29260000
292700     MOVE DL003-EVNT-KY-1-NBR       TO DK-TRIP-ID.                29270000
292800     MOVE DL003-EVNT-KY-3-NBR       TO DK-SHIP-UNT-ID             29280000
292900                                       PV-DISPLAY-SHIP-UNT-ID.    29290000
293000     MOVE DL003-DTL-TXT-AREA        TO PC242-DTL-TXT.             29300000
293100                                                                  29310000
293200     MOVE PC242-AP-ASGMT-STRT-DTE    TO   DK-ASGMT-STRT-DTE       29320000
293300                                          PV-INPUT-TMST-DATE.     29330000
293400                                                                  29340000
293500     MOVE PC242-AP-ASGMT-NBR-TXT     TO   DK-ASGMT-NBR-TXT        29350000
293600                                          PV-ASSIGNMENT-1-10.     29360000
293700                                                                  29370000
293800     MOVE PC242-AP-ASGMT-NBR-SEQ-NBR  TO  DK-ASGMT-NBR-SEQ-NBR    29380000
293900                                          PV-ASSIGNMENT-11-15.    29390000
294000                                                                  29400000
294100     PERFORM 4000-SELECT-ASSIGNMENT.                              29410000
294200                                                                  29420000
294300     MOVE PC242-AP-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  29430000
294400     MOVE PC242-AP-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    29440000
294500     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    29450000
294600     MOVE 'P'                      TO DL002-WMS0102-OBTAIN-PLACE. 29460000
294700     MOVE PC-N                   TO DL002-WMS0102-FUNC-ID.        29470000
294800                                                                  29480000
294900     MOVE PV-INPUT-TMST-YR       TO PV-PLAN-DATE-YR.              29490000
295000     MOVE PV-INPUT-TMST-MO       TO PV-PLAN-DATE-MO.              29500000
295100     MOVE PV-INPUT-TMST-DA       TO PV-PLAN-DATE-DA.              29510000
295200     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      29520000
295300                                                                  29530000
295400     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     29540000
295500                                                                  29550000
295600     MOVE 0   TO DL002-WMS0102-CONT-1.                            29560000
295700     MOVE 1   TO DL002-WMS0102-SHIP-UNITS.                        29570000
295800     MOVE 0   TO DL002-WMS0102-CONT-2.                            29580000
295900     MOVE 0   TO DL002-WMS0102-HUNIT-1.                           29590000
296000     MOVE 0   TO DL002-WMS0102-HUNIT-2.                           29600000
296100     MOVE 0   TO DL002-WMS0102-HUNIT-3.                           29610000
296200     MOVE 1   TO DL002-WMS0102-SPEC-HAND-1.                       29620000
296300     MOVE 0   TO DL002-WMS0102-SPEC-HAND-2.                       29630000
296400                                                                  29640000
296500******************************************************************29650000
296600* BUILDS THE WMS0102 RECORD FOR REMOVE CHILD FROM MASTER         *29660000
296700******************************************************************29670000
296800                                                                  29680000
296900 4630-BLD-WMS0102-RM-CH-FR-MS.                                    29690000
297000                                                                  29700000
297100     MOVE '4630-BLD-WMS0102-RM-CH-FR-MS'                          29710000
297200           TO PV-ABEND-PARAGRAPH.                                 29720000
297300                                                                  29730000
297400***  DISPLAY 'NOW IN 4630-BLD-WMS0102-RM-CH-FR-MS'.               29740000
297500                                                                  29750000
297600     INITIALIZE DL002-RECORD.                                     29760000
297700                                                                  29770000
297800     SET PS-WMS0102-RECORD TO TRUE.                               29780000
297900                                                                  29790000
298000     MOVE DL003-EVNT-KY-1-NBR       TO DK-TRIP-ID.                29800000
298100     MOVE DL003-EVNT-KY-3-NBR       TO DK-SHIP-UNT-ID             29810000
298200                                       PV-DISPLAY-SHIP-UNT-ID.    29820000
298300     MOVE DL003-DTL-TXT-AREA        TO PC242-DTL-TXT.             29830000
298400                                                                  29840000
298500     MOVE PC242-AQ-ASGMT-STRT-DTE    TO   DK-ASGMT-STRT-DTE       29850000
298600                                          PV-INPUT-TMST-DATE.     29860000
298700                                                                  29870000
298800     MOVE PC242-AQ-ASGMT-NBR-TXT     TO   DK-ASGMT-NBR-TXT        29880000
298900                                          PV-ASSIGNMENT-1-10.     29890000
299000                                                                  29900000
299100     MOVE PC242-AQ-ASGMT-NBR-SEQ-NBR  TO  DK-ASGMT-NBR-SEQ-NBR    29910000
299200                                          PV-ASSIGNMENT-11-15.    29920000
299300                                                                  29930000
299400     PERFORM 4000-SELECT-ASSIGNMENT.                              29940000
299500                                                                  29950000
299600     MOVE PC242-AQ-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  29960000
299700     MOVE PC242-AQ-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    29970000
299800     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    29980000
299900     MOVE 'O'                      TO DL002-WMS0102-OBTAIN-PLACE. 29990000
300000     MOVE PC-N                   TO DL002-WMS0102-FUNC-ID.        30000000
300100                                                                  30010000
300200     MOVE PV-INPUT-TMST-YR       TO PV-PLAN-DATE-YR.              30020000
300300     MOVE PV-INPUT-TMST-MO       TO PV-PLAN-DATE-MO.              30030000
300400     MOVE PV-INPUT-TMST-DA       TO PV-PLAN-DATE-DA.              30040000
300500     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      30050000
300600                                                                  30060000
300700     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     30070000
300800                                                                  30080000
300900     MOVE 0   TO DL002-WMS0102-CONT-1.                            30090000
301000     MOVE 0   TO DL002-WMS0102-CONT-2.                            30100000
301100     MOVE 0   TO DL002-WMS0102-HUNIT-1.                           30110000
301200     MOVE 1   TO DL002-WMS0102-HUNIT-2.                           30120000
301300     MOVE 0   TO DL002-WMS0102-HUNIT-3.                           30130000
301400     MOVE 1   TO DL002-WMS0102-SPEC-HAND-1.                       30140000
301500     MOVE 0   TO DL002-WMS0102-SPEC-HAND-2.                       30150000
301600                                                                  30160000
301700******************************************************************30170000
301800* BUILDS THE WMS0102 RECORD FOR REMOVE MASTER FROM MASTER        *30180000
301900******************************************************************30190000
302000                                                                  30200000
302100 4640-BLD-WMS0102-RM-MS-FR-MS.                                    30210000
302200                                                                  30220000
302300     MOVE '4640-BLD-WMS0102-RM-MS-FR-MS'                          30230000
302400           TO PV-ABEND-PARAGRAPH.                                 30240000
302500                                                                  30250000
302600***  DISPLAY 'NOW IN 4630-BLD-WMS0102-RM-MS-FR-MS'.               30260000
302700                                                                  30270000
302800     INITIALIZE DL002-RECORD.                                     30280000
302900                                                                  30290000
303000     SET PS-WMS0102-RECORD TO TRUE.                               30300000
303100                                                                  30310000
303200     MOVE DL003-EVNT-KY-1-NBR       TO DK-TRIP-ID.                30320000
303300     MOVE DL003-EVNT-KY-3-NBR       TO DK-SHIP-UNT-ID             30330000
303400                                       PV-DISPLAY-SHIP-UNT-ID.    30340000
303500     MOVE DL003-DTL-TXT-AREA        TO PC242-DTL-TXT.             30350000
303600                                                                  30360000
303700     MOVE PC242-AR-ASGMT-STRT-DTE    TO   DK-ASGMT-STRT-DTE       30370000
303800                                          PV-INPUT-TMST-DATE.     30380000
303900                                                                  30390000
304000     MOVE PC242-AR-ASGMT-NBR-TXT     TO   DK-ASGMT-NBR-TXT        30400000
304100                                          PV-ASSIGNMENT-1-10.     30410000
304200                                                                  30420000
304300     MOVE PC242-AR-ASGMT-NBR-SEQ-NBR  TO  DK-ASGMT-NBR-SEQ-NBR    30430000
304400                                          PV-ASSIGNMENT-11-15.    30440000
304500                                                                  30450000
304600     PERFORM 4000-SELECT-ASSIGNMENT.                              30460000
304700                                                                  30470000
304800     MOVE PC242-AR-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  30480000
304900     MOVE PC242-AR-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    30490000
305000     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    30500000
305100     MOVE 'O'                      TO DL002-WMS0102-OBTAIN-PLACE. 30510000
305200     MOVE PC-N                   TO DL002-WMS0102-FUNC-ID.        30520000
305300                                                                  30530000
305400     MOVE PV-INPUT-TMST-YR       TO PV-PLAN-DATE-YR.              30540000
305500     MOVE PV-INPUT-TMST-MO       TO PV-PLAN-DATE-MO.              30550000
305600     MOVE PV-INPUT-TMST-DA       TO PV-PLAN-DATE-DA.              30560000
305700     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      30570000
305800                                                                  30580000
305900     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     30590000
306000                                                                  30600000
306100     MOVE 0   TO DL002-WMS0102-CONT-1.                            30610000
306200     MOVE 1   TO DL002-WMS0102-CONT-2.                            30620000
306300     MOVE 0   TO DL002-WMS0102-HUNIT-1.                           30630000
306400     MOVE 0   TO DL002-WMS0102-HUNIT-2.                           30640000
306500     MOVE 0   TO DL002-WMS0102-HUNIT-3.                           30650000
306600     MOVE 1   TO DL002-WMS0102-SPEC-HAND-1.                       30660000
306700     MOVE 0   TO DL002-WMS0102-SPEC-HAND-2.                       30670000
306800                                                                  30680000
306900******************************************************************30690000
307000* BUILDS THE WMS0102 RECORD FOR REASSIGN TO MASTER               *30700000
307100******************************************************************30710000
307200                                                                  30720000
307300 4650-BLD-WMS0102-RSGN-TO-MS.                                     30730000
307400                                                                  30740000
307500     MOVE '4650-BLD-WMS0102-RSGN-TO-MS'                           30750000
307600           TO PV-ABEND-PARAGRAPH.                                 30760000
307700                                                                  30770000
307800***  DISPLAY 'NOW IN 4650-BLD-WMS0102-RSGN-TO-MS'.                30780000
307900                                                                  30790000
308000     INITIALIZE DL002-RECORD.                                     30800000
308100                                                                  30810000
308200     SET PS-WMS0102-RECORD TO TRUE.                               30820000
308300                                                                  30830000
308400     MOVE DL003-EVNT-KY-1-NBR       TO DK-TRIP-ID.                30840000
308500     MOVE DL003-EVNT-KY-3-NBR       TO DK-SHIP-UNT-ID             30850000
308600                                       PV-DISPLAY-SHIP-UNT-ID.    30860000
308700     MOVE DL003-DTL-TXT-AREA        TO PC242-DTL-TXT.             30870000
308800                                                                  30880000
308900     MOVE PC242-AS-ASGMT-STRT-DTE    TO   DK-ASGMT-STRT-DTE       30890000
309000                                          PV-INPUT-TMST-DATE.     30900000
309100                                                                  30910000
309200     MOVE PC242-AS-ASGMT-NBR-TXT     TO   DK-ASGMT-NBR-TXT        30920000
309300                                          PV-ASSIGNMENT-1-10.     30930000
309400                                                                  30940000
309500     MOVE PC242-AS-ASGMT-NBR-SEQ-NBR  TO  DK-ASGMT-NBR-SEQ-NBR    30950000
309600                                          PV-ASSIGNMENT-11-15.    30960000
309700                                                                  30970000
309800     PERFORM 4000-SELECT-ASSIGNMENT.                              30980000
309900                                                                  30990000
310000     MOVE PC242-AS-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  31000000
310100     MOVE PC242-AS-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    31010000
310200     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    31020000
310300     MOVE 'P'                      TO DL002-WMS0102-OBTAIN-PLACE. 31030000
310400     MOVE PC-N                   TO DL002-WMS0102-FUNC-ID.        31040000
310500                                                                  31050000
310600     MOVE PV-INPUT-TMST-YR       TO PV-PLAN-DATE-YR.              31060000
310700     MOVE PV-INPUT-TMST-MO       TO PV-PLAN-DATE-MO.              31070000
310800     MOVE PV-INPUT-TMST-DA       TO PV-PLAN-DATE-DA.              31080000
310900     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      31090000
311000                                                                  31100000
311100     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     31110000
311200                                                                  31120000
311300     MOVE 0   TO DL002-WMS0102-CONT-1.                            31130000
311400     MOVE 0   TO DL002-WMS0102-CONT-2.                            31140000
311500     MOVE 1   TO DL002-WMS0102-HUNIT-1.                           31150000
311600     MOVE 0   TO DL002-WMS0102-HUNIT-2.                           31160000
311700     MOVE 0   TO DL002-WMS0102-HUNIT-3.                           31170000
311800     MOVE 0   TO DL002-WMS0102-SPEC-HAND-1.                       31180000
311900     MOVE 1   TO DL002-WMS0102-SPEC-HAND-2.                       31190000
312000                                                                  31200000
312100******************************************************************31210000
312200* BUILDS THE WMS0102 RECORD FOR A PACK-TO-LIGHT PICKMADE         *31220000
312300******************************************************************31230000
312400 4700-BUILD-WMS0102-PICK-MADE.                                    31240000
312500                                                                  31250000
312600     MOVE '4700-BUILD-WMS0102-PICK-MADE'   TO PV-ABEND-PARAGRAPH. 31260000
312700***  DISPLAY 'NOW IN 4700-BUILD-WMS0102'.                         31270000
312800     INITIALIZE DL002-RECORD.                                     31280000
312900     SET PS-WMS0102-RECORD TO TRUE.                               31290000
313000     MOVE DL003-EVNT-KY-1-TXT       TO PV-MOD-NBR-4-8.            31300000
313100     MOVE PV-MOD-NBR                TO DL002-WMS0102-REF-ID.      31310000
313200     MOVE DL003-EVNT-KY-2-TXT       TO DL002-WMS0102-USER-DEF-4.  31320000
313300     MOVE DL003-EVNT-KY-3-NBR       TO PV-PO-NBR.                 31330000
313400     MOVE DL003-EVNT-KY-4-NBR       TO PV-REC-SEQ.                31340000
313500     STRING PV-PO-NBR              DELIMITED BY SIZE              31350000
313600            '-'                    DELIMITED BY SIZE              31360000
313700            PV-REC-SEQ             DELIMITED BY SIZE              31370000
313800                             INTO DL002-WMS0102-USER-DEF-5.       31380000
313900     MOVE DL003-DTL-TXT-AREA        TO PC242-DTL-TXT.             31390000
314000     MOVE PC242-AJ-ASGMT-STRT-DTE    TO DK-ASGMT-STRT-DTE         31400000
314100                                       PV-INPUT-TMST-DATE.        31410000
314200     MOVE PC242-AJ-ASGMT-NBR-TXT     TO DK-ASGMT-NBR-TXT          31420000
314300                                       PV-ASSIGNMENT-1-10.        31430000
314400     MOVE PC242-AJ-ASGMT-NBR-SEQ-NBR TO DK-ASGMT-NBR-SEQ-NBR      31440000
314500                                        PV-ASSIGNMENT-11-15.      31450000
314600     PERFORM 4000-SELECT-ASSIGNMENT.                              31460000
314700     MOVE SPACES                  TO DL002-WMS0102-CUST-NO.       31470000
314800     MOVE SPACES                  TO DL002-WMS0102-CLIENT-ID.     31480000
314900     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    31490000
315000     MOVE SPACES                  TO DL002-WMS0102-USER-DEF-3.    31500000
315100     MOVE 'P'                     TO DL002-WMS0102-OBTAIN-PLACE.  31510000
315200     MOVE ZEROS                   TO DL002-WMS0102-CUBE.          31520000
315300     MOVE ZEROS                   TO DL002-WMS0102-WEIGHT.        31530000
315400     MOVE PC-N                    TO DL002-WMS0102-FUNC-ID.       31540000
315500     MOVE PV-INPUT-TMST-YR        TO PV-PLAN-DATE-YR.             31550000
315600     MOVE PV-INPUT-TMST-MO        TO PV-PLAN-DATE-MO.             31560000
315700     MOVE PV-INPUT-TMST-DA        TO PV-PLAN-DATE-DA.             31570000
315800     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      31580000
315900     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     31590000
316000     MOVE 0                       TO PV-THROWS.                   31600000
316100     MOVE 0                       TO PV-LEFTOVER.                 31610000
316200     MOVE 0                       TO PV-PICKED.                   31620000
316300     MOVE PC242-AJ-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  31630000
316400     MOVE PC242-AJ-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    31640000
316500     IF PC242-AJ-INNER-PK-QTY = 0                                 31650000
316600         MOVE 1                   TO PC242-AJ-INNER-PK-QTY        31660000
316700     END-IF.                                                      31670000
316800     IF PC242-AJ-INNER-PK-NO                                      31680000
316900         MOVE PC242-AJ-PICKED-QTY TO PV-PICKED                    31690000
317000         DIVIDE PC242-AJ-PICKED-QTY BY PC242-AJ-INNER-PK-QTY      31700000
317100             GIVING PV-THROWS REMAINDER PV-LEFTOVER               31710000
317200         IF PV-LEFTOVER NOT EQUAL 0                               31720000
317300             ADD PV-LEFTOVER TO PV-THROWS                         31730000
317400         END-IF                                                   31740000
317500     ELSE                                                         31750000
317600         PERFORM 4750-INNER-PACK-CALC                             31760000
317700     END-IF.                                                      31770000
317710*CHGXXXXXXX                                                       31771042
317720     IF PC242-AJ-PICKED-QTY-NEG                                   31772042
317730        ADD +1 TO PV-TOT-NO-OF-NEG                                31773044
317740     ELSE                                                         31774042
317750        IF PC242-AJ-PICKED-QTY-POS                                31775044
317760           MOVE PC242-AJ-PICKED-QTY     TO PV-AJ-PICKED-QTY-CH    31776044
317770           MOVE ZEROS                   TO PV-NO-OF-NEG           31777044
317780           INSPECT PV-AJ-PICKED-QTY-CH TALLYING PV-NO-OF-NEG      31778044
317790               FOR ALL '-'                                        31779044
317791           IF PV-NO-OF-NEG = 0                                    31779144
317792*CHGXXXXXXX                                                       31779242
317800              IF (PC242-AJ-EXP-PICK-ORDER-QTY =                   31780044
317810                  PC242-AJ-PICKED-QTY)                            31781044
317900                 MOVE PV-THROWS TO DL002-WMS0102-HUNIT-1          31790044
318000                 MOVE PV-PICKED TO DL002-WMS0102-SHIP-UNITS       31800044
318100                 MOVE PC242-AJ-ASGMT-SEQ-DTL-NBR TO               31810044
318200                      DL002-WMS0102-ITEM-NUMBER                   31820044
318300                 PERFORM 9000-WRITE-OUTPUT-RECORD                 31830044
318400              ELSE                                                31840044
318500                 MOVE 1 TO DL002-WMS0102-CONT-1                   31850044
318600                 MOVE 0 TO DL002-WMS0102-SHIP-UNITS               31860044
318700                 PERFORM 9000-WRITE-OUTPUT-RECORD                 31870044
318800                 MOVE 0 TO DL002-WMS0102-CONT-1                   31880044
318900                 MOVE PC242-AJ-ASGMT-SEQ-DTL-NBR-2 TO             31890044
319000                      DL002-WMS0102-TRANS-NUM                     31900044
319100                      DL002-WMS0102-SEQ-NUM                       31910044
319200                 MOVE PV-THROWS TO DL002-WMS0102-HUNIT-1          31920044
319300                 MOVE PV-PICKED TO DL002-WMS0102-SHIP-UNITS       31930044
319400                 PERFORM 9000-WRITE-OUTPUT-RECORD                 31940044
319410*CHGXXXXXXX                                                       31941042
319500              END-IF                                              31950044
319520           ELSE                                                   31952044
319530              ADD +1 TO PV-TOT-NO-OF-NEG                          31953044
319540           END-IF                                                 31954044
319550        END-IF                                                    31955044
319560     END-IF.                                                      31956042
319570*CHGXXXXXXX                                                       31957042
319600                                                                  31960000
319700******************************************************************31970000
319800* BUILDS THE WMS0102 RECORD FOR A PACK-TO-LIGHT INBOUND LAUNCH   *31980000
319900******************************************************************31990000
320000 4710-BUILD-WMS0102-INBD-LNCH.                                    32000000
320100                                                                  32010000
320200     MOVE '4710-BUILD-WMS0102-INBD-LNCH'   TO PV-ABEND-PARAGRAPH. 32020000
320300***  DISPLAY 'NOW IN 4710-BUILD-WMS0102'.                         32030000
320400     INITIALIZE DL002-RECORD.                                     32040000
320500     SET PS-WMS0102-RECORD TO TRUE.                               32050000
320600     MOVE DL003-EVNT-KY-1-TXT       TO PV-MOD-NBR-4-8.            32060000
320700     MOVE PV-MOD-NBR                TO DL002-WMS0102-REF-ID.      32070000
320800     MOVE DL003-EVNT-KY-2-TXT       TO DL002-WMS0102-USER-DEF-4.  32080000
320900     MOVE DL003-EVNT-KY-2-NBR       TO PV-PO-NBR.                 32090000
321000     MOVE DL003-EVNT-KY-3-NBR       TO PV-REC-SEQ.                32100000
321100     STRING PV-PO-NBR              DELIMITED BY SIZE              32110000
321200            '-'                    DELIMITED BY SIZE              32120000
321300            PV-REC-SEQ             DELIMITED BY SIZE              32130000
321400                             INTO DL002-WMS0102-USER-DEF-5.       32140000
321500     MOVE DL003-DTL-TXT-AREA        TO PC242-DTL-TXT.             32150000
321600     MOVE PC242-AK-ASGMT-STRT-DTE    TO DK-ASGMT-STRT-DTE         32160000
321700                                       PV-INPUT-TMST-DATE.        32170000
321800     MOVE PC242-AK-ASGMT-NBR-TXT     TO DK-ASGMT-NBR-TXT          32180000
321900                                       PV-ASSIGNMENT-1-10.        32190000
322000     MOVE PC242-AK-ASGMT-NBR-SEQ-NBR TO DK-ASGMT-NBR-SEQ-NBR      32200000
322100                                        PV-ASSIGNMENT-11-15.      32210000
322200     PERFORM 4000-SELECT-ASSIGNMENT.                              32220000
322300     MOVE SPACES                  TO DL002-WMS0102-REF-ID.        32230000
322400     MOVE SPACES                  TO DL002-WMS0102-CUST-NO.       32240000
322500     MOVE SPACES                  TO DL002-WMS0102-CLIENT-ID.     32250000
322600     MOVE PC242-AK-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  32260000
322700     MOVE PC242-AK-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    32270000
322800     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    32280000
322900     MOVE SPACES                  TO DL002-WMS0102-USER-DEF-3.    32290000
323000     MOVE 'O'                     TO DL002-WMS0102-OBTAIN-PLACE.  32300000
323100     MOVE 1                       TO DL002-WMS0102-CONT-2.        32310000
323200     MOVE 0                       TO DL002-WMS0102-SHIP-UNITS     32320000
323300     MOVE ZEROS                   TO DL002-WMS0102-CUBE.          32330000
323400     MOVE ZEROS                   TO DL002-WMS0102-WEIGHT.        32340000
323500     MOVE PC-N                    TO DL002-WMS0102-FUNC-ID.       32350000
323600     MOVE PV-INPUT-TMST-YR        TO PV-PLAN-DATE-YR.             32360000
323700     MOVE PV-INPUT-TMST-MO        TO PV-PLAN-DATE-MO.             32370000
323800     MOVE PV-INPUT-TMST-DA        TO PV-PLAN-DATE-DA.             32380000
323900     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      32390000
324000     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     32400000
324100                                                                  32410000
324200******************************************************************32420000
324300* BUILDS THE WMS0102 RECORD FOR A PACK-TO-LIGHT OUTBOUND OPEN    *32430000
324400******************************************************************32440000
324500 4720-BUILD-WMS0102-OTBD-OPEN.                                    32450000
324600                                                                  32460000
324700     MOVE '4720-BUILD-WMS0102-OTBD-OPEN'   TO PV-ABEND-PARAGRAPH. 32470000
324800***  DISPLAY 'NOW IN 4720-BUILD-WMS0102'.                         32480000
324900     INITIALIZE DL002-RECORD.                                     32490000
325000     SET PS-WMS0102-RECORD TO TRUE.                               32500000
325100     MOVE DL003-EVNT-KY-1-TXT       TO PV-MOD-NBR-4-8.            32510000
325200     MOVE PV-MOD-NBR                TO DL002-WMS0102-REF-ID.      32520000
325300     MOVE DL003-EVNT-KY-2-TXT       TO DL002-WMS0102-USER-DEF-4.  32530000
325400     MOVE DL003-DTL-TXT-AREA        TO PC242-DTL-TXT.             32540000
325500     MOVE PC242-AL-ASGMT-STRT-DTE    TO DK-ASGMT-STRT-DTE         32550000
325600                                       PV-INPUT-TMST-DATE.        32560000
325700     MOVE PC242-AL-ASGMT-NBR-TXT     TO DK-ASGMT-NBR-TXT          32570000
325800                                       PV-ASSIGNMENT-1-10.        32580000
325900     MOVE PC242-AL-ASGMT-NBR-SEQ-NBR TO DK-ASGMT-NBR-SEQ-NBR      32590000
326000                                        PV-ASSIGNMENT-11-15.      32600000
326100     PERFORM 4000-SELECT-ASSIGNMENT.                              32610000
326200     MOVE SPACES                  TO DL002-WMS0102-REF-ID.        32620000
326300     MOVE SPACES                  TO DL002-WMS0102-CUST-NO.       32630000
326400     MOVE SPACES                  TO DL002-WMS0102-CLIENT-ID.     32640000
326500     MOVE PC242-AL-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  32650000
326600     MOVE PC242-AL-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    32660000
326700     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    32670000
326800     MOVE SPACES                  TO DL002-WMS0102-USER-DEF-3.    32680000
326900     MOVE 'O'                     TO DL002-WMS0102-OBTAIN-PLACE.  32690000
327000     MOVE 1                       TO DL002-WMS0102-HUNIT-2.       32700000
327100     MOVE 0                       TO DL002-WMS0102-SHIP-UNITS.    32710000
327200     MOVE ZEROS                   TO DL002-WMS0102-CUBE.          32720000
327300     MOVE ZEROS                   TO DL002-WMS0102-WEIGHT.        32730000
327400     MOVE PC-N                    TO DL002-WMS0102-FUNC-ID.       32740000
327500     MOVE PV-INPUT-TMST-YR        TO PV-PLAN-DATE-YR.             32750000
327600     MOVE PV-INPUT-TMST-MO        TO PV-PLAN-DATE-MO.             32760000
327700     MOVE PV-INPUT-TMST-DA        TO PV-PLAN-DATE-DA.             32770000
327800     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      32780000
327900     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     32790000
328000                                                                  32800000
328100******************************************************************32810000
328200* BUILDS THE WMS0102 RECORD FOR A PACK-TO-LIGHT OUTBOUND CLOSE   *32820000
328300******************************************************************32830000
328400 4730-BUILD-WMS0102-OTBD-CLOSE.                                   32840000
328500                                                                  32850000
328600     MOVE '4730-BUILD-WMS0102-OTBD-CLOSE'  TO PV-ABEND-PARAGRAPH. 32860000
328700***  DISPLAY 'NOW IN 4730-BUILD-WMS0102'.                         32870000
328800     INITIALIZE DL002-RECORD.                                     32880000
328900     SET PS-WMS0102-RECORD TO TRUE.                               32890000
329000     MOVE DL003-EVNT-KY-1-TXT       TO PV-MOD-NBR-4-8.            32900000
329100     MOVE PV-MOD-NBR                TO DL002-WMS0102-REF-ID.      32910000
329200     MOVE DL003-EVNT-KY-2-TXT       TO DL002-WMS0102-USER-DEF-4.  32920000
329300     MOVE DL003-DTL-TXT-AREA        TO PC242-DTL-TXT.             32930000
329400     MOVE PC242-AM-ASGMT-STRT-DTE    TO DK-ASGMT-STRT-DTE         32940000
329500                                       PV-INPUT-TMST-DATE.        32950000
329600     MOVE PC242-AM-ASGMT-NBR-TXT     TO DK-ASGMT-NBR-TXT          32960000
329700                                       PV-ASSIGNMENT-1-10.        32970000
329800     MOVE PC242-AM-ASGMT-NBR-SEQ-NBR TO DK-ASGMT-NBR-SEQ-NBR      32980000
329900                                        PV-ASSIGNMENT-11-15.      32990000
330000     PERFORM 4000-SELECT-ASSIGNMENT.                              33000000
330100     MOVE SPACES                  TO DL002-WMS0102-REF-ID.        33010000
330200     MOVE SPACES                  TO DL002-WMS0102-CUST-NO.       33020000
330300     MOVE SPACES                  TO DL002-WMS0102-CLIENT-ID.     33030000
330400     MOVE PC242-AM-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-TRANS-NUM.  33040000
330500     MOVE PC242-AM-ASGMT-SEQ-DTL-NBR TO DL002-WMS0102-SEQ-NUM.    33050000
330600     MOVE 'WMS0102'                  TO DL002-WMS0102-RECTYPE.    33060000
330700     MOVE SPACES                  TO DL002-WMS0102-USER-DEF-3.    33070000
330800     MOVE 'O'                     TO DL002-WMS0102-OBTAIN-PLACE.  33080000
330900     MOVE 1                       TO DL002-WMS0102-HUNIT-3.       33090000
331000     MOVE 0                       TO DL002-WMS0102-SHIP-UNITS.    33100000
331100     MOVE ZEROS                   TO DL002-WMS0102-CUBE.          33110000
331200     MOVE ZEROS                   TO DL002-WMS0102-WEIGHT.        33120000
331300     MOVE PC-N                    TO DL002-WMS0102-FUNC-ID.       33130000
331400     MOVE PV-INPUT-TMST-YR        TO PV-PLAN-DATE-YR.             33140000
331500     MOVE PV-INPUT-TMST-MO        TO PV-PLAN-DATE-MO.             33150000
331600     MOVE PV-INPUT-TMST-DA        TO PV-PLAN-DATE-DA.             33160000
331700     MOVE PV-PLAN-DATE           TO DL002-WMS0102-PLAN-DATE.      33170000
331800     MOVE PV-ASSIGNMENT          TO DL002-WMS0102-ASSIGN-NUM.     33180000
331900                                                                  33190000
332000                                                                  33200000
332100******************************************************************33210000
332200* DETERMINES THE NUMBER OF PICKS FOR AN INNER PACK PICKMADE      *33220000
332300******************************************************************33230000
332400 4750-INNER-PACK-CALC.                                            33240000
332500                                                                  33250000
332600     MOVE '4750-INNER-PACK-CALC'           TO PV-ABEND-PARAGRAPH. 33260000
332700***  DISPLAY 'NOW IN 4750-INNER-PACK'.                            33270000
332800                                                                  33280000
332900     MOVE DL003-EVNT-KY-1-NBR       TO DK-OPER-UNT-ID.            33290000
333000     MOVE DL003-EVNT-KY-3-NBR       TO DK-PO-NBR.                 33300000
333100     MOVE DL003-EVNT-KY-4-NBR       TO DK-REC-SEQ-NBR.            33310000
333200     MOVE DL003-EVNT-KY-5-NBR       TO DK-PO-LNE-NBR.             33320000
333300                                                                  33330000
333400     PERFORM                                                      33340000
333500         WITH TEST AFTER                                          33350000
333600             VARYING PV-RETRY-COUNTER                             33360000
333700             FROM 1 BY 1                                          33370000
333800             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              33380000
333900                OR SQLCODE = ZERO                                 33390000
334000                OR SQLCODE = +100                                 33400000
334100                                                                  33410000
334200         EXEC SQL                                                 33420000
334300             SELECT SUM (B.PREPK_RATO_QTY)                        33430000
334400              INTO :PV-SUM-PICKED   :PV-NULL-SUM-PICKED           33440000
334500              FROM TRECITM A                                      33450000
334600                 , TRECITM B                                      33460000
334700             WHERE A.ORD_NBR = :DK-PO-NBR                         33470000
334800              AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                 33480000
334900              AND A.ORD_LNE_NBR = :DK-PO-LNE-NBR                  33490000
335000**            AND A.OPER_UNT_ID = :DK-OPER-UNT-ID                 33500000
335100**            AND B.OPER_UNT_ID = A.OPER_UNT_ID                   33510000
335200              AND B.ORD_NBR = A.ORD_NBR                           33520000
335300              AND B.REC_SEQ_NBR = A.REC_SEQ_NBR                   33530000
335400              AND B.PREPK_ID = A.PREPK_ID                         33540000
335500              AND B.VER_STATUS_CDE = 'A'                          33550000
335600              WITH UR                                             33560000
335700         END-EXEC                                                 33570000
335800                                                                  33580000
335900         EVALUATE TRUE                                            33590000
336000             WHEN SQLCODE = ZERO                                  33600000
336100             WHEN SQLCODE = +100                                  33610000
336200             WHEN SQLCODE = -904                                  33620000
336300             WHEN SQLCODE = -913                                  33630000
336400             WHEN SQLCODE = -911                                  33640000
336500                  CONTINUE                                        33650000
336600                                                                  33660000
336700             WHEN SQLWARN0 NOT = SPACES                           33670000
336800             WHEN SQLCODE NOT = ZERO                              33680000
336900                  MOVE +4             TO PV-RETRY-COUNTER         33690000
337000         END-EVALUATE                                             33700000
337100     END-PERFORM.                                                 33710000
337200                                                                  33720000
337300     IF SQLCODE = ZERO OR +100                                    33730000
337400         IF  PV-NULL-SUM-PICKED  = -1                             33740000
337500             MOVE PC242-AJ-PICKED-QTY   TO PV-THROWS              33750000
337600             COMPUTE PV-PICKED =                                  33760000
337700                      PV-THROWS * PC242-AJ-INNER-PK-QTY           33770000
337800         ELSE                                                     33780000
337900             MOVE PC242-AJ-PICKED-QTY   TO PV-THROWS              33790000
338000             COMPUTE PV-PICKED = PV-THROWS * PV-SUM-PICKED        33800000
338100         END-IF                                                   33810000
338200     ELSE                                                         33820000
338300     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         33830000
338400         MOVE SQLCODE               TO PV-SQLCODE                 33840000
338500         MOVE '4750 - INNER PACK ' TO PV-DB2-OPERATION-MESSAGE-1  33850000
338600         MOVE 'TRECITM'      TO PV-DB2-TABLE-NAME                 33860000
338700         MOVE DK-OPER-UNT-ID        TO PV-DISPLAY-OPER-UNT-ID     33870000
338800         MOVE DK-PO-NBR             TO PV-PO-NBR                  33880000
338900         MOVE DK-REC-SEQ-NBR        TO PV-REC-SEQ                 33890000
339000         MOVE DK-PO-LNE-NBR         TO PV-PO-LNE-NBR              33900000
339100         STRING 'OPER UNIT ID = '       DELIMITED BY SIZE         33910000
339200                 PV-DISPLAY-OPER-UNT-ID DELIMITED BY SIZE         33920000
339300                ' PO   NUMBER  = '       DELIMITED BY SIZE        33930000
339400                 PV-PO-NBR              DELIMITED BY SIZE         33940000
339500                ' REC SEQ NBR ='         DELIMITED BY SIZE        33950000
339600                 PV-REC-SEQ             DELIMITED BY SIZE         33960000
339700                ' PO LINE NUMBER = '     DELIMITED BY SIZE        33970000
339800                 PV-PO-LNE-NBR          DELIMITED BY SIZE         33980000
339900                                   INTO PV-DB2-OPERATION-MESSAGE-233990000
340000         PERFORM 9999-SQL-ABEND                                   34000000
340100     END-IF.                                                      34010000
340200                                                                  34020000
340300****************************************************************  34030000
340400*                                                              *  34040000
340500*                                                              *  34050000
340600****************************************************************  34060000
340700 4910-SELECTS-BY-TRIP-ID.                                         34070000
340800     MOVE '4910-SELECTS-BY-TRIP-ID' TO PV-ABEND-PARAGRAPH.        34080000
340900**   DISPLAY 'NOW IN 4910-SELECTS-BY-TRIP-ID'.                    34090000
341000                                                                  34100000
341100     PERFORM                                                      34110000
341200         WITH TEST AFTER                                          34120000
341300             VARYING PV-RETRY-COUNTER                             34130000
341400             FROM 1 BY 1                                          34140000
341500             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              34150000
341600                OR SQLCODE = ZERO                                 34160000
341700                OR SQLCODE = +100                                 34170000
341800                OR SQLCODE = -811                                 34180000
341900                                                                  34190000
342000         EXEC SQL                                                 34200000
342100             SELECT DISTINCT                                      34210000
342200                    A.DEST_OPER_UNT_ID                            34220000
342300                  , A.TRLR_SRL_NBR                                34230000
342400                  , B.SCAC_CDE                                    34240000
342500                  , B.TRLR_ID                                     34250000
342600                  , B.TRLR_SIZE_MU                                34260000
342700              INTO  :SUOBTR-DEST-OPER-UNT-ID                      34270000
342800                   ,:SUOBTR-TRLR-SRL-NBR                          34280000
342900                   ,:CNTRID-SCAC-CDE                              34290000
343000                   ,:CNTRID-TRLR-ID                               34300000
343100                   ,:CNTRID-TRLR-SIZE-MU                          34310000
343200              FROM  TSUOBTR A                                     34320000
343300                  , TCNTRID B                                     34330000
343400              WHERE A.OTBND_TRIP_ID     = :DK-TRIP-ID             34340000
343500                 AND A.TRLR_SRL_NBR      = B.TRLR_SRL_NBR         34350000
343600              WITH UR                                             34360000
343700         END-EXEC                                                 34370000
343800                                                                  34380000
343900         EVALUATE TRUE                                            34390000
344000             WHEN SQLCODE = ZERO                                  34400000
344100             WHEN SQLCODE = -811                                  34410000
344200             WHEN SQLCODE = +100                                  34420000
344300             WHEN SQLCODE = -904                                  34430000
344400             WHEN SQLCODE = -913                                  34440000
344500             WHEN SQLCODE = -911                                  34450000
344600                  CONTINUE                                        34460000
344700                                                                  34470000
344800             WHEN SQLWARN0 NOT = SPACES                           34480000
344900             WHEN SQLCODE NOT = ZERO                              34490000
345000                  MOVE +4             TO PV-RETRY-COUNTER         34500000
345100         END-EVALUATE                                             34510000
345200     END-PERFORM.                                                 34520000
345300                                                                  34530000
345400     IF SQLCODE = ZERO OR -811                                    34540000
345500         STRING CNTRID-SCAC-CDE        DELIMITED BY SIZE          34550000
345600                '-'                    DELIMITED BY SIZE          34560000
345700                CNTRID-TRLR-ID         DELIMITED BY SIZE          34570000
345800                                    INTO DL002-WMS0102-REF-ID     34580000
345900         MOVE CNTRID-TRLR-SIZE-MU     TO DL002-WMS0102-USER-DEF-4 34590000
346000***      MOVE SUOBTR-DEST-OPER-UNT-ID TO DL002-WMS0102-CUST-NO    34600000
346100     ELSE                                                         34610000
346200     IF SQLCODE = +100                                            34620000
346300         MOVE SPACES                  TO DL002-WMS0102-REF-ID     34630000
346400         MOVE SPACES                  TO DL002-WMS0102-USER-DEF-4 34640000
346500         MOVE SPACES                  TO DL002-WMS0102-CUST-NO    34650000
346600     ELSE                                                         34660000
346700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         34670000
346800         MOVE SQLCODE               TO PV-SQLCODE                 34680000
346900         MOVE 'SELECT SCAC/TRLR'   TO PV-DB2-OPERATION-MESSAGE-1  34690000
347000         MOVE 'TSUOBTR JOIN' TO PV-DB2-TABLE-NAME                 34700000
347100         MOVE DK-TRIP-ID            TO PV-DISPLAY-TRIP-ID         34710000
347200         STRING 'INBOUND TRIP ID = '    DELIMITED BY SIZE         34720000
347300                 PV-DISPLAY-TRIP-ID     DELIMITED BY SIZE         34730000
347400                                   INTO PV-DB2-OPERATION-MESSAGE-234740000
347500         PERFORM 9999-SQL-ABEND                                   34750000
347600     END-IF.                                                      34760000
347700                                                                  34770000
347800****************************************************************  34780000
347900*                                                              *  34790000
348000*                                                              *  34800000
348100****************************************************************  34810000
348200 4940-SELECT-SUTOTBND-FOR-UNITS.                                  34820000
348300     MOVE '4940-SELECT-SUTOTBND-FOR-UNITS' TO PV-ABEND-PARAGRAPH. 34830000
348400***  DISPLAY 'NOW IN 4940-SELECT-SUTOTNBD-FOR-UNITS'.             34840000
348500                                                                  34850000
348600     PERFORM                                                      34860000
348700         WITH TEST AFTER                                          34870000
348800             VARYING PV-RETRY-COUNTER                             34880000
348900             FROM 1 BY 1                                          34890000
349000             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              34900000
349100                OR SQLCODE = ZERO                                 34910000
349200                OR SQLCODE = +100                                 34920000
349300                OR SQLCODE = -811                                 34930000
349400                                                                  34940000
349500         EXEC SQL                                                 34950000
349600             SELECT SUM(SHPD_UNT_QTY)                             34960000
349700              INTO :PV-SUM-UNITS    :PV-NULL-SUM-UNITS            34970000
349800              FROM SUT_OTBND_UPC                                  34980000
349900                 WHERE SHIPT_UNT_ID = :DK-SHIP-UNT-ID             34990000
350000              WITH UR                                             35000000
350100         END-EXEC                                                 35010000
350200                                                                  35020000
350300         EVALUATE TRUE                                            35030000
350400             WHEN SQLCODE = ZERO                                  35040000
350500             WHEN SQLCODE = -811                                  35050000
350600             WHEN SQLCODE = +100                                  35060000
350700             WHEN SQLCODE = -904                                  35070000
350800             WHEN SQLCODE = -913                                  35080000
350900             WHEN SQLCODE = -911                                  35090000
351000                  CONTINUE                                        35100000
351100                                                                  35110000
351200             WHEN SQLWARN0 NOT = SPACES                           35120000
351300             WHEN SQLCODE NOT = ZERO                              35130000
351400                  MOVE +4             TO PV-RETRY-COUNTER         35140000
351500         END-EVALUATE                                             35150000
351600     END-PERFORM.                                                 35160000
351700                                                                  35170000
351800     IF SQLCODE = ZERO OR -811                                    35180000
351900         IF  PV-NULL-SUM-UNITS = -1                               35190000
352000             MOVE 1                TO DL002-WMS0102-SHIP-UNITS    35200000
352100             MOVE ZEROS            TO DL002-WMS0102-HUNIT-3       35210000
352200         ELSE                                                     35220000
352300             MOVE 1                TO DL002-WMS0102-SHIP-UNITS    35230000
352400             MOVE PV-SUM-UNITS     TO DL002-WMS0102-HUNIT-3       35240000
352500         END-IF                                                   35250000
352600     ELSE                                                         35260000
352700     IF SQLCODE = +100                                            35270000
352800         MOVE ZEROS            TO DL002-WMS0102-SHIP-UNITS        35280000
352900         MOVE ZEROS            TO DL002-WMS0102-HUNIT-3           35290000
353000     ELSE                                                         35300000
353100     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         35310000
353200         MOVE SQLCODE               TO PV-SQLCODE                 35320000
353300         MOVE 'SELECT FOR UNITS'   TO PV-DB2-OPERATION-MESSAGE-1  35330000
353400         MOVE 'SUTOTBND'     TO PV-DB2-TABLE-NAME                 35340000
353500         MOVE DK-SHIP-UNT-ID        TO PV-DISPLAY-SHIP-UNT-ID     35350000
353600         STRING 'SHIP UNIT ID = '       DELIMITED BY SIZE         35360000
353700                 PV-DISPLAY-SHIP-UNT-ID DELIMITED BY SIZE         35370000
353800                                   INTO PV-DB2-OPERATION-MESSAGE-235380000
353900         PERFORM 9999-SQL-ABEND                                   35390000
354000     END-IF.                                                      35400000
354100                                                                  35410000
354200****************************************************************  35420000
354300*                                                              *  35430000
354400*                                                              *  35440000
354500****************************************************************  35450000
354600 4950-SELECT-COUNT-CARTONS.                                       35460000
354700     MOVE '4950-SELECT-COUNT-CARTONS'      TO PV-ABEND-PARAGRAPH. 35470000
354800**   DISPLAY 'NOW IN 4950-SELECT-COUNT-CARTONS'.                  35480000
354900                                                                  35490000
355000     PERFORM                                                      35500000
355100         WITH TEST AFTER                                          35510000
355200             VARYING PV-RETRY-COUNTER                             35520000
355300             FROM 1 BY 1                                          35530000
355400             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              35540000
355500                OR SQLCODE = ZERO                                 35550000
355600                OR SQLCODE = +100                                 35560000
355700                                                                  35570000
355800         EXEC SQL                                                 35580000
355900             SELECT COUNT (*)                                     35590000
356000              INTO :PV-SUM-CARTONS  :PV-NULL-SUM-CARTONS          35600000
356100              FROM TSUCRDV                                        35610000
356200                 WHERE OPER_UNT_ID = :DK-OPER-UNT-ID              35620000
356300                  AND DOOR_ID     = :DK-DOOR-NUMBER               35630000
356400                  AND ACTV_CDE    = 'A'                           35640000
356500                  AND (DIVERT_TMST >  :DK-EVNT-KY-1-TMST AND      35650000
356600                       DIVERT_TMST <= :DL003-EVNT-KY-2-TMST)      35660000
356700              WITH UR                                             35670000
356800         END-EXEC                                                 35680000
356900                                                                  35690000
357000         EVALUATE TRUE                                            35700000
357100             WHEN SQLCODE = ZERO                                  35710000
357200             WHEN SQLCODE = +100                                  35720000
357300             WHEN SQLCODE = -904                                  35730000
357400             WHEN SQLCODE = -913                                  35740000
357500             WHEN SQLCODE = -911                                  35750000
357600                  CONTINUE                                        35760000
357700                                                                  35770000
357800             WHEN SQLWARN0 NOT = SPACES                           35780000
357900             WHEN SQLCODE NOT = ZERO                              35790000
358000                  MOVE +4             TO PV-RETRY-COUNTER         35800000
358100         END-EVALUATE                                             35810000
358200     END-PERFORM.                                                 35820000
358300                                                                  35830000
358400     IF SQLCODE = ZERO OR +100                                    35840000
358500         IF  PV-NULL-SUM-CARTONS = -1                             35850000
358600             MOVE ZEROS            TO DL002-WMS0102-SHIP-UNITS    35860000
358610                                      PV-SUM-CARTONS              35861020
358700         ELSE                                                     35870000
358800             MOVE PV-SUM-CARTONS   TO DL002-WMS0102-SHIP-UNITS    35880000
358900         END-IF                                                   35890000
358910                                                                  35891030
359100*** DMH BEGIN - 11/12/09                                          35910000
359200        DISPLAY ' DOOR ID: '  DK-DOOR-NUMBER                      35920000
359300                ' DIVERT TIMESTAMP FROM: '  DK-EVNT-KY-1-TMST     35930000
359400                ' DIVERT TIMESTAMP TO:   '  DL003-EVNT-KY-2-TMST  35940000
359410        DISPLAY ' WORK TYPE : ' DL002-WMS0102-WORK-TYPE           35941030
359420                ' DOOR GROUP: ' DL002-WMS0102-LOCATION            35942030
359500*** DMH END   - 11/12/09                                          35950000
359600                                                                  35960000
359700                                                                  35970000
359800     ELSE                                                         35980000
359900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         35990000
360000         MOVE SQLCODE               TO PV-SQLCODE                 36000000
360100         MOVE 'SELECT FOR CARTONS' TO PV-DB2-OPERATION-MESSAGE-1  36010000
360200         MOVE 'TSUCRDV'      TO PV-DB2-TABLE-NAME                 36020000
360300         MOVE DK-OPER-UNT-ID        TO PV-DISPLAY-OPER-UNT-ID     36030000
360400         STRING 'OPER UNIT ID = '       DELIMITED BY SIZE         36040000
360500                 PV-DISPLAY-OPER-UNT-ID DELIMITED BY SIZE         36050000
360600                'DOOR NUMBER  = '       DELIMITED BY SIZE         36060000
360700                 DK-DOOR-NUMBER         DELIMITED BY SIZE         36070000
360800                'ASGMT STRT TMST = '    DELIMITED BY SIZE         36080000
360900                 DK-EVNT-KY-1-TMST      DELIMITED BY SIZE         36090000
361000                'ASGMT STOP TMST = '    DELIMITED BY SIZE         36100000
361100                 DL003-EVNT-KY-2-TMST   DELIMITED BY SIZE         36110000
361200                                   INTO PV-DB2-OPERATION-MESSAGE-236120000
361300         PERFORM 9999-SQL-ABEND                                   36130000
361400     END-IF.                                                      36140000
361500                                                                  36150000
361600****************************************************************  36160000
361700*                                                              *  36170000
361800*                                                              *  36180000
361900****************************************************************  36190000
362000 5000-OPEN-ASSOCIATE-CURSOR.                                      36200000
362100     MOVE '5000-OPEN-ASSOCIATE-CURSOR'   TO PV-ABEND-PARAGRAPH.   36210000
362200***  DISPLAY 'NOW IN 5000-OPEN-ASSOCIATE-CURSOR'.                 36220000
362300                                                                  36230000
362400     PERFORM                                                      36240000
362500         WITH TEST AFTER                                          36250000
362600             VARYING PV-RETRY-COUNTER                             36260000
362700             FROM 1 BY 1                                          36270000
362800             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              36280000
362900                OR SQLCODE = ZERO                                 36290000
363000                                                                  36300000
363100         EXEC SQL                                                 36310000
363200              OPEN  ASSOCIATE-CURSOR                              36320000
363300         END-EXEC                                                 36330000
363400                                                                  36340000
363500         EVALUATE TRUE                                            36350000
363600             WHEN SQLCODE = ZERO                                  36360000
363700             WHEN SQLCODE = +100                                  36370000
363800             WHEN SQLCODE = -904                                  36380000
363900             WHEN SQLCODE = -913                                  36390000
364000             WHEN SQLCODE = -911                                  36400000
364100                  CONTINUE                                        36410000
364200                                                                  36420000
364300             WHEN SQLWARN0 NOT = SPACES                           36430000
364400             WHEN SQLCODE NOT = ZERO                              36440000
364500                  MOVE +4             TO PV-RETRY-COUNTER         36450000
364600         END-EVALUATE                                             36460000
364700     END-PERFORM.                                                 36470000
364800                                                                  36480000
364900     IF SQLCODE = ZERO                                            36490000
365000        CONTINUE                                                  36500000
365100     ELSE                                                         36510000
365200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         36520000
365300         MOVE SQLCODE               TO PV-SQLCODE                 36530000
365400         MOVE 'CURSOR OPEN ERROR'   TO PV-DB2-OPERATION-MESSAGE-1 36540000
365500         MOVE 'DLT_TEM_ASGMT'      TO PV-DB2-TABLE-NAME           36550000
365600         PERFORM 9999-SQL-ABEND                                   36560000
365700     END-IF.                                                      36570000
365800                                                                  36580000
365900****************************************************************  36590000
366000*                                                              *  36600000
366100*                                                              *  36610000
366200****************************************************************  36620000
366300 5100-FETCH-ASSOCIATE.                                            36630000
366400     MOVE '5100-FETCH-ASSOCIATE'          TO PV-ABEND-PARAGRAPH.  36640000
366500                                                                  36650000
366600     PERFORM                                                      36660000
366700         WITH TEST AFTER                                          36670000
366800         VARYING PV-RETRY-COUNTER                                 36680000
366900         FROM 1 BY 1                                              36690000
367000         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  36700000
367100            OR SQLCODE = ZERO                                     36710000
367200            OR SQLCODE = +100                                     36720000
367300                                                                  36730000
367400         EXEC SQL                                                 36740000
367500             FETCH  ASSOCIATE-CURSOR                              36750000
367600                                                                  36760000
367700              INTO  :DLT00003-ASGMT-STRT-DTE                      36770000
367800                   ,:DLT00003-ASGMT-NBR-TXT                       36780000
367900                   ,:DLT00003-KOHLS-USR-ID                        36790000
368000                              :DN-KOHLS-USR-ID-NULL-IND           36800000
368100                   ,:DLT00003-TMP-USR-ID                          36810000
368200                              :DN-TMP-USR-ID-NULL-IND             36820000
368300                   ,:DLT00003-JN-TMST                             36830000
368400                   ,:DLT00003-CRE-BY-USR-ID                       36840000
368500                                                                  36850000
368600         END-EXEC                                                 36860000
368700                                                                  36870000
368800         EVALUATE TRUE                                            36880000
368900             WHEN SQLCODE = ZERO                                  36890000
369000             WHEN SQLCODE = -904                                  36900000
369100             WHEN SQLCODE = -911                                  36910000
369200             WHEN SQLCODE = -913                                  36920000
369300                  CONTINUE                                        36930000
369400                                                                  36940000
369500             WHEN SQLCODE = +100                                  36950000
369600                  SET PS-END-OF-CURSOR TO TRUE                    36960000
369700                                                                  36970000
369800             WHEN SQLWARN0 NOT = SPACES                           36980000
369900             WHEN SQLCODE NOT = ZERO                              36990000
370000                  MOVE +4             TO PV-RETRY-COUNTER         37000000
370100         END-EVALUATE                                             37010000
370200     END-PERFORM.                                                 37020000
370300                                                                  37030000
370400     IF SQLCODE = ZERO                                            37040000
370500         INITIALIZE DL002-RECORD                                  37050000
370600         SET PS-WMS0102-RECORD TO TRUE                            37060000
370700         SET PS-BYPASS-RECORD-LM-YES TO TRUE                      37070000
370800         MOVE 'WMS0102'             TO DL002-WMS0102-RECTYPE      37080000
370900         MOVE PC-A                  TO DL002-WMS0102-FUNC-ID      37090000
371000         MOVE PV-INPUT-TMST-YR      TO PV-PLAN-DATE-YR            37100000
371100         MOVE PV-INPUT-TMST-MO      TO PV-PLAN-DATE-MO            37110000
371200         MOVE PV-INPUT-TMST-DA      TO PV-PLAN-DATE-DA            37120000
371300         MOVE PV-PLAN-DATE          TO DL002-WMS0102-PLAN-DATE    37130000
371400         MOVE DLT00003-ASGMT-NBR-TXT TO PV-ASSIGNMENT-1-10        37140000
371500         MOVE DK-ASGMT-NBR-SEQ-NBR  TO PV-ASSIGNMENT-11-15        37150000
371600         MOVE PV-ASSIGNMENT         TO DL002-WMS0102-ASSIGN-NUM   37160000
371700         MOVE DLT00003-JN-TMST      TO PV-JOIN-TMST               37170000
371800         MOVE PV-JOIN-TMST-YR       TO PV-START-DATE-YR           37180000
371900         MOVE PV-JOIN-TMST-MO       TO PV-START-DATE-MO           37190000
372000         MOVE PV-JOIN-TMST-DA       TO PV-START-DATE-DA           37200000
372100         MOVE PV-JOIN-TMST-HR       TO PV-START-TIME-HR           37210000
372200         MOVE PV-JOIN-TMST-MN       TO PV-START-TIME-MN           37220000
372300         MOVE PV-JOIN-TMST-SS       TO PV-START-TIME-SS           37230000
372400         MOVE PV-START-TIME         TO DL002-WMS0102-START-TIME   37240000
372500         MOVE PV-START-DATE         TO DL002-WMS0102-START-DATE   37250000
372600         MOVE PV-SAVE-DC            TO DL002-WMS0102-WAREHOUSE    37260000
372700         MOVE SPACES           TO DL002-WMS0102-TRANS-NUM-CHAR    37270000
372800         MOVE SPACES           TO DL002-WMS0102-SEQ-NUM-CHAR      37280000
372900         MOVE 0                     TO DL002-WMS0102-RESPONSE     37290000
373000         IF DN-KOHLS-USR-ID-NULL-IND < +0                         37300000
373100             MOVE DLT00003-TMP-USR-ID                             37310000
373200                                    TO DL002-WMS0102-USR-ID       37320000
373300         ELSE                                                     37330000
373400             MOVE DLT00003-KOHLS-USR-ID                           37340000
373500                                    TO DL002-WMS0102-USR-ID       37350000
373600         END-IF                                                   37360000
373700         PERFORM 9000-WRITE-OUTPUT-RECORD                         37370000
373800     ELSE                                                         37380000
373900     IF SQLCODE = +100                                            37390000
374000         CONTINUE                                                 37400000
374100     ELSE                                                         37410000
374200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         37420000
374300         MOVE SQLCODE               TO PV-SQLCODE                 37430000
374400         MOVE 'FETCH TEAM ASGMT'    TO PV-DB2-OPERATION-MESSAGE-1 37440000
374500         MOVE DK-ASGMT-NBR-SEQ-NBR  TO PV-DISPLAY-SEQ-NBR         37450000
374600         STRING 'ASSIGNMENT INFO * '    DELIMITED BY SIZE         37460000
374700                'START DATE = '         DELIMITED BY SIZE         37470000
374800                 DK-ASGMT-STRT-DTE      DELIMITED BY SIZE         37480000
374900                ' ASSIGNMENT NUM = '    DELIMITED BY SIZE         37490000
375000                 DK-ASGMT-NBR-TXT       DELIMITED BY SIZE         37500000
375100                ' SEQ NUM = '           DELIMITED BY SIZE         37510000
375200                 PV-DISPLAY-SEQ-NBR     DELIMITED BY SIZE         37520000
375300                                   INTO PV-DB2-OPERATION-MESSAGE-237530000
375400         MOVE 'DLT_TEM_ASGMT'       TO PV-DB2-TABLE-NAME          37540000
375500         PERFORM 9999-SQL-ABEND                                   37550000
375600     END-IF.                                                      37560000
375700                                                                  37570000
375800****************************************************************  37580000
375900*                                                              *  37590000
376000*                                                              *  37600000
376100****************************************************************  37610000
376200 5200-CLOSE-ASSOCIATE-CURSOR.                                     37620000
376300     MOVE '5200-CLOSE-ASSOCIATE-CURSOR'   TO PV-ABEND-PARAGRAPH.  37630000
376400***  DISPLAY 'NOW IN 5200-CLOSE-ASSOCIATE-CURSOR'.                37640000
376500                                                                  37650000
376600     PERFORM                                                      37660000
376700         WITH TEST AFTER                                          37670000
376800         VARYING PV-RETRY-COUNTER                                 37680000
376900         FROM 1 BY 1                                              37690000
377000         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  37700000
377100            OR SQLCODE = ZERO                                     37710000
377200                                                                  37720000
377300         EXEC SQL                                                 37730000
377400              CLOSE ASSOCIATE-CURSOR                              37740000
377500         END-EXEC                                                 37750000
377600                                                                  37760000
377700         EVALUATE TRUE                                            37770000
377800             WHEN SQLCODE = ZERO                                  37780000
377900             WHEN SQLCODE = -904                                  37790000
378000             WHEN SQLCODE = -913                                  37800000
378100             WHEN SQLCODE = -911                                  37810000
378200                  CONTINUE                                        37820000
378300                                                                  37830000
378400             WHEN SQLCODE = +100                                  37840000
378500             WHEN SQLWARN0 NOT = SPACES                           37850000
378600             WHEN SQLCODE NOT = ZERO                              37860000
378700                  MOVE +4             TO PV-RETRY-COUNTER         37870000
378800         END-EVALUATE                                             37880000
378900     END-PERFORM.                                                 37890000
379000                                                                  37900000
379100     IF SQLCODE = ZERO                                            37910000
379200        CONTINUE                                                  37920000
379300     ELSE                                                         37930000
379400        IF PV-RETRY-COUNTER > PC-MAX-RETRIES                      37940000
379500         MOVE SQLCODE               TO PV-SQLCODE                 37950000
379600         MOVE 'CURSOR CLOSE ERROR'  TO PV-DB2-OPERATION-MESSAGE-1 37960000
379700         MOVE 'DLT_TEM_ASGMT'      TO PV-DB2-TABLE-NAME           37970000
379800         PERFORM 9999-SQL-ABEND                                   37980000
379900        END-IF                                                    37990000
380000     END-IF.                                                      38000000
380100                                                                  38010000
380200******************************************************************38020000
380300* LOADS VALUE OF APPROPRIATE PACKAGING CODE                      *38030000
380400******************************************************************38040000
380500 6000-CHECK-PKGNG-CDE.                                            38050000
380600     IF (PV-PACK-TYPE = SPACES OR 'Z') OR                         38060000
380700         PV-PACK-BY-STR = 'Y'                                     38070000
380800         MOVE 'PBS'              TO DL002-WMS0102-USER-DEF-3      38080000
380900     ELSE                                                         38090000
381000     IF PV-PACK-TYPE = 'B'                                        38100000
381100         MOVE 'BULK '            TO DL002-WMS0102-USER-DEF-3      38110000
381200     ELSE                                                         38120000
381300     IF PV-PACK-TYPE = 'I'                                        38130000
381400         MOVE 'INNER'            TO DL002-WMS0102-USER-DEF-3      38140000
381500***      MOVE 'MULTI'            TO DL002-WMS0102-CUST-NO         38150000
381600     ELSE                                                         38160000
381700     IF PV-PACK-TYPE = 'C'                                        38170000
381800         MOVE 'CASE '            TO DL002-WMS0102-USER-DEF-3      38180000
381900     ELSE                                                         38190000
382000     IF PV-PACK-TYPE = 'M'                                        38200000
382100         MOVE 'MULTI'            TO DL002-WMS0102-USER-DEF-3      38210000
382200     ELSE                                                         38220000
382300     IF PV-PACK-TYPE = 'S'                                        38230000
382400         MOVE 'SINGL'            TO DL002-WMS0102-USER-DEF-3      38240000
382500     END-IF.                                                      38250000
382600                                                                  38260000
382700****************************************************************  38270000
382800*                                                              *  38280000
382900*                                                              *  38290000
383000****************************************************************  38300000
383100 8000-OPEN-CARTON-CURSOR.                                         38310000
383200     MOVE '8000-OPEN-CARTON-CURSOR'   TO PV-ABEND-PARAGRAPH.      38320000
383300**   DISPLAY 'NOW IN 8000-OPEN-CARTON-CURSOR'.                    38330000
383400                                                                  38340000
383500     PERFORM                                                      38350000
383600         WITH TEST AFTER                                          38360000
383700             VARYING PV-RETRY-COUNTER                             38370000
383800             FROM 1 BY 1                                          38380000
383900             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              38390000
384000                OR SQLCODE = ZERO                                 38400000
384100                                                                  38410000
384200         EXEC SQL                                                 38420000
384300              OPEN  CARTON-CURSOR                                 38430000
384400         END-EXEC                                                 38440000
384500                                                                  38450000
384600         EVALUATE TRUE                                            38460000
384700             WHEN SQLCODE = ZERO                                  38470000
384800             WHEN SQLCODE = -904                                  38480000
384900             WHEN SQLCODE = -913                                  38490000
385000             WHEN SQLCODE = -911                                  38500000
385100                  CONTINUE                                        38510000
385200                                                                  38520000
385300             WHEN SQLCODE = +100                                  38530000
385400             WHEN SQLWARN0 NOT = SPACES                           38540000
385500             WHEN SQLCODE NOT = ZERO                              38550000
385600                  MOVE +4             TO PV-RETRY-COUNTER         38560000
385700         END-EVALUATE                                             38570000
385800     END-PERFORM.                                                 38580000
385900                                                                  38590000
386000     IF SQLCODE = ZERO                                            38600000
386100        CONTINUE                                                  38610000
386200     ELSE                                                         38620000
386300     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         38630000
386400         MOVE SQLCODE               TO PV-SQLCODE                 38640000
386500         MOVE 'CURSOR OPEN ERROR'   TO PV-DB2-OPERATION-MESSAGE-1 38650000
386600         MOVE 'TSUCRDV'            TO PV-DB2-TABLE-NAME           38660000
386700         PERFORM 9999-SQL-ABEND                                   38670000
386800     END-IF.                                                      38680000
386900                                                                  38690000
387000****************************************************************  38700000
387100*                                                              *  38710000
387200*                                                              *  38720000
387300****************************************************************  38730000
387400 8100-FETCH-CARTON.                                               38740000
387500     MOVE '8100-FETCH-CARTON'             TO PV-ABEND-PARAGRAPH.  38750000
387600**   DISPLAY 'NOW IN 8100-FETCH-CARTON'.                          38760000
387700                                                                  38770000
387800     PERFORM                                                      38780000
387900         WITH TEST AFTER                                          38790000
388000         VARYING PV-RETRY-COUNTER                                 38800000
388100         FROM 1 BY 1                                              38810000
388200         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  38820000
388300            OR SQLCODE = ZERO                                     38830000
388400            OR SQLCODE = +100                                     38840000
388500                                                                  38850000
388600         EXEC SQL                                                 38860000
388700             FETCH  CARTON-CURSOR                                 38870000
388800                                                                  38880000
388900              INTO  :SUCRDV-SHIPT-UNT-ID                          38890000
389000                  , :SUCRDV-DIVERT-TMST                           38900011
389100         END-EXEC                                                 38910000
389200                                                                  38920000
389300         EVALUATE TRUE                                            38930000
389400             WHEN SQLCODE = ZERO                                  38940000
389500             WHEN SQLCODE = -904                                  38950000
389600             WHEN SQLCODE = -911                                  38960000
389700             WHEN SQLCODE = -913                                  38970000
389800                  CONTINUE                                        38980000
389900                                                                  38990000
390000             WHEN SQLCODE = +100                                  39000000
390100                  SET PS-END-OF-CARTON-CURSOR TO TRUE             39010000
390200                                                                  39020000
390300             WHEN SQLWARN0 NOT = SPACES                           39030000
390400             WHEN SQLCODE NOT = ZERO                              39040000
390500                  MOVE +4             TO PV-RETRY-COUNTER         39050000
390600         END-EVALUATE                                             39060000
390700     END-PERFORM.                                                 39070000
390800                                                                  39080000
390900     IF SQLCODE = ZERO                                            39090000
391000         PERFORM 8300-SELECT-SUTOTBND-FOR-UNITS                   39100000
391100     ELSE                                                         39110000
391200     IF SQLCODE = +100                                            39120000
391300        CONTINUE                                                  39130000
391400     ELSE                                                         39140000
391500     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         39150000
391600         MOVE SQLCODE               TO PV-SQLCODE                 39160000
391700         MOVE 'FETCH  FOR CARTONS' TO PV-DB2-OPERATION-MESSAGE-1  39170000
391800         MOVE 'TSUCRDV'      TO PV-DB2-TABLE-NAME                 39180000
391900         MOVE DK-OPER-UNT-ID        TO PV-DISPLAY-OPER-UNT-ID     39190000
392000         STRING 'OPER UNIT ID = '       DELIMITED BY SIZE         39200000
392100                 PV-DISPLAY-OPER-UNT-ID DELIMITED BY SIZE         39210000
392200                'DOOR NUMBER  = '       DELIMITED BY SIZE         39220000
392300                 DK-DOOR-NUMBER         DELIMITED BY SIZE         39230000
392400                'ASGMT STRT TMST = '    DELIMITED BY SIZE         39240000
392500                 DL003-EVNT-KY-1-TMST   DELIMITED BY SIZE         39250000
392600                'ASGMT STOP TMST = '    DELIMITED BY SIZE         39260000
392700                 DL003-EVNT-KY-2-TMST   DELIMITED BY SIZE         39270000
392800                                   INTO PV-DB2-OPERATION-MESSAGE-239280000
392900         PERFORM 9999-SQL-ABEND                                   39290000
393000     END-IF.                                                      39300000
393100                                                                  39310000
393200****************************************************************  39320000
393300*                                                              *  39330000
393400*                                                              *  39340000
393500****************************************************************  39350000
393600 8200-CLOSE-CARTON-CURSOR.                                        39360000
393700     MOVE '8200-CLOSE-CARTON-CURSOR'   TO PV-ABEND-PARAGRAPH.     39370000
393800**   DISPLAY 'NOW IN 8200-CLOSE-CARTON-CURSOR'.                   39380000
393900                                                                  39390000
394000     PERFORM                                                      39400000
394100         WITH TEST AFTER                                          39410000
394200         VARYING PV-RETRY-COUNTER                                 39420000
394300         FROM 1 BY 1                                              39430000
394400         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  39440000
394500            OR SQLCODE = ZERO                                     39450000
394600                                                                  39460000
394700         EXEC SQL                                                 39470000
394800              CLOSE CARTON-CURSOR                                 39480000
394900         END-EXEC                                                 39490000
395000                                                                  39500000
395100         EVALUATE TRUE                                            39510000
395200             WHEN SQLCODE = ZERO                                  39520000
395300             WHEN SQLCODE = -904                                  39530000
395400             WHEN SQLCODE = -913                                  39540000
395500             WHEN SQLCODE = -911                                  39550000
395600                  CONTINUE                                        39560000
395700                                                                  39570000
395800             WHEN SQLCODE = +100                                  39580000
395900             WHEN SQLWARN0 NOT = SPACES                           39590000
396000             WHEN SQLCODE NOT = ZERO                              39600000
396100                  MOVE +4             TO PV-RETRY-COUNTER         39610000
396200         END-EVALUATE                                             39620000
396300     END-PERFORM.                                                 39630000
396400                                                                  39640000
396500     IF SQLCODE = ZERO                                            39650000
396600        CONTINUE                                                  39660000
396700     ELSE                                                         39670000
396800        IF PV-RETRY-COUNTER > PC-MAX-RETRIES                      39680000
396900         MOVE SQLCODE               TO PV-SQLCODE                 39690000
397000         MOVE 'CURSOR CLOSE ERROR'  TO PV-DB2-OPERATION-MESSAGE-1 39700000
397100         MOVE 'TSUCRDV'            TO PV-DB2-TABLE-NAME           39710000
397200         PERFORM 9999-SQL-ABEND                                   39720000
397300        END-IF                                                    39730000
397400     END-IF.                                                      39740000
397500                                                                  39750000
397600****************************************************************  39760000
397700*                                                              *  39770000
397800*                                                              *  39780000
397900****************************************************************  39790000
398000 8300-SELECT-SUTOTBND-FOR-UNITS.                                  39800000
398100     MOVE '8300-SELECT-SUTOTBND-FOR-UNITS' TO PV-ABEND-PARAGRAPH. 39810000
398200***  DISPLAY 'NOW IN 8300-SELECT-SUTOTNBD-FOR-UNITS'.             39820000
398300                                                                  39830000
398400     PERFORM                                                      39840000
398500         WITH TEST AFTER                                          39850000
398600             VARYING PV-RETRY-COUNTER                             39860000
398700             FROM 1 BY 1                                          39870000
398800             UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES              39880000
398900                OR SQLCODE = ZERO                                 39890000
399000                OR SQLCODE = +100                                 39900000
399100                OR SQLCODE = -811                                 39910000
399200                                                                  39920000
399300         EXEC SQL                                                 39930000
399400             SELECT SUM(SHPD_UNT_QTY)                             39940000
399500              INTO :PV-SUM-UNITS    :PV-NULL-SUM-UNITS            39950000
399600              FROM SUT_OTBND_UPC                                  39960000
399700                 WHERE SHIPT_UNT_ID = :SUCRDV-SHIPT-UNT-ID        39970000
399800              WITH UR                                             39980000
399900         END-EXEC                                                 39990000
400000                                                                  40000000
400100         EVALUATE TRUE                                            40010000
400200             WHEN SQLCODE = ZERO                                  40020000
400300             WHEN SQLCODE = -811                                  40030000
400400             WHEN SQLCODE = +100                                  40040000
400500             WHEN SQLCODE = -904                                  40050000
400600             WHEN SQLCODE = -913                                  40060000
400700             WHEN SQLCODE = -911                                  40070000
400800                  CONTINUE                                        40080000
400900                                                                  40090000
401000             WHEN SQLWARN0 NOT = SPACES                           40100000
401100             WHEN SQLCODE NOT = ZERO                              40110000
401200                  MOVE +4             TO PV-RETRY-COUNTER         40120000
401300         END-EVALUATE                                             40130000
401400     END-PERFORM.                                                 40140000
401500                                                                  40150000
401600     IF SQLCODE = ZERO OR -811                                    40160000
401700         IF  PV-NULL-SUM-UNITS = -1                               40170000
401710             ADD +1 TO PV-CARTONS-ZERO-UNITS                      40171034
401720             MOVE SUCRDV-SHIPT-UNT-ID TO PV-DISPLAY-SHIP-UNT-ID   40172035
401730             DISPLAY 'EMPTY CARTON...' PV-DISPLAY-SHIP-UNT-ID     40173041
401900         ELSE                                                     40190000
402000             COMPUTE PV-TOTAL-UNITS =                             40200000
402100                        PV-TOTAL-UNITS + PV-SUM-UNITS             40210000
402101****GB 8/17/15                                                    40210116
402110         PERFORM 8900-WRITE-LMS-DATA                              40211016
402111         ADD +1 TO PV-SUM-CARTONS-LM                              40211130
402120****GB 8/17/15                                                    40212016
402200         END-IF                                                   40220000
402300     ELSE                                                         40230000
402400     IF SQLCODE = +100                                            40240000
402500         CONTINUE                                                 40250000
402600     ELSE                                                         40260000
402700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         40270000
402800         MOVE SQLCODE               TO PV-SQLCODE                 40280000
402900         MOVE '8300 SELECT UNTS'   TO PV-DB2-OPERATION-MESSAGE-1  40290000
403000         MOVE 'SUTOTBND'     TO PV-DB2-TABLE-NAME                 40300000
403100         MOVE SUCRDV-SHIPT-UNT-ID        TO PV-DISPLAY-SHIP-UNT-ID40310000
403200         STRING 'SHIP UNIT ID = '       DELIMITED BY SIZE         40320000
403300                 PV-DISPLAY-SHIP-UNT-ID DELIMITED BY SIZE         40330000
403400                                   INTO PV-DB2-OPERATION-MESSAGE-240340000
403500         PERFORM 9999-SQL-ABEND                                   40350000
403600     END-IF.                                                      40360000
403700                                                                  40370000
403800****************************************************************  40380000
403900*    RETRIEVE THE CURRENT TIMESTAMP TO USE WHEN UPDATING ROWS. *  40390000
404000*                                                              *  40400000
404100****************************************************************  40410000
404200                                                                  40420000
404300 8400-GET-TIMESTAMP.                                              40430000
404400      PERFORM                                                     40440000
404500          WITH TEST AFTER                                         40450000
404600          VARYING PV-RETRY-COUNTER                                40460000
404700          FROM 1 BY 1                                             40470000
404800          UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)              40480000
404900             OR  (SQLCODE = +100)                                 40490000
405000             OR  (SQLCODE = +0))                                  40500000
405100       EXEC SQL                                                   40510000
405200           SET :PV-CURRENT-TIMESTAMP  = CURRENT TIMESTAMP         40520000
405300       END-EXEC                                                   40530000
405400                                                                  40540000
405500       EVALUATE TRUE                                              40550000
405600           WHEN SQLCODE = +0                                      40560000
405700           WHEN SQLCODE = -904                                    40570000
405800           WHEN SQLCODE = -913                                    40580000
405900           WHEN SQLCODE = -911                                    40590000
406000               CONTINUE                                           40600000
406100           WHEN OTHER                                             40610000
406200               MOVE 0 TO PV-FUNC-QTY                              40620000
406300               DISPLAY '8400-GET-TIMESTAMP'                       40630000
406400               MOVE DK-OPER-UNT-ID TO  PV-DISPLAY-OPER-UNT-ID     40640000
406500               DISPLAY ' OPER UNIT   - '                          40650000
406600                       PV-DISPLAY-OPER-UNT-ID                     40660000
406700                                                                  40670000
406800       END-EVALUATE                                               40680000
406900       END-PERFORM.                                               40690000
407000                                                                  40700000
407100        IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                 40710000
407200            SQLCODE NOT = ZERO                                    40720000
407300            DISPLAY '**************************************'      40730000
407400            DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '      40740000
407500            DISPLAY 'GET THE TIME STAMP    '                      40750000
407600            DISPLAY '**************************************'      40760000
407700            MOVE '8400-GET-TIMESTAMP'                             40770000
407800                                  TO PV-ABEND-PARAGRAPH           40780000
407900            MOVE 'SELECT'         TO PV-ABEND-OPERATION           40790000
408000            MOVE 'TABLE'          TO PV-ABEND-STRUCTURE-1         40800000
408100            MOVE 'GET TIMESTAMP'  TO PV-DB2-OPERATION-MESSAGE-1   40810000
408200            PERFORM 9999-SQL-ABEND                                40820000
408300        END-IF.                                                   40830000
408400*----------------------------------------------------------------*40840000
408500*    RETRIEVE THE TIMEZN SYS-PRC-FUNC-CDE TO DETERMINE THE NUMBER 40850000
408600*    OF HOURS TO ADD OR SUBTRACT FROM THE CURRENT TIME INORDER    40860000
408700*    TO BE IN THE CORRECT TIMEZONE.                               40870000
408800*----------------------------------------------------------------*40880000
408900*                                                                 40890000
409000 8700-GET-TKRPRPM-TIME-ZONE.                                      40900000
409100                                                                  40910000
409200      PERFORM                                                     40920000
409300          WITH TEST AFTER                                         40930000
409400          VARYING PV-RETRY-COUNTER                                40940000
409500          FROM 1 BY 1                                             40950000
409600          UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)              40960000
409700             OR  (SQLCODE = +100)                                 40970000
409800             OR  (SQLCODE = +0))                                  40980000
409900       EXEC SQL                                                   40990000
410000           SELECT FUNC_QTY                                        41000000
410100             INTO   :PV-FUNC-QTY                                  41010000
410200             FROM   TKRPRPM                                       41020000
410300            WHERE LOC_ID           = :DK-OPER-UNT-ID              41030000
410400              AND INTFC_SYS_CDE    = 'KHL'                        41040000
410500              AND SYS_PRC_FUNC_CDE = 'TIMEZN'                     41050000
410600              AND FUNC_PRC_STAT_CDE = 'AC'                        41060000
410700       END-EXEC                                                   41070000
410800                                                                  41080000
410900       EVALUATE TRUE                                              41090000
411000           WHEN SQLCODE = +0                                      41100000
411100           WHEN SQLCODE = -904                                    41110000
411200           WHEN SQLCODE = -913                                    41120000
411300           WHEN SQLCODE = -911                                    41130000
411400               CONTINUE                                           41140000
411500           WHEN OTHER                                             41150000
411600               MOVE 0 TO PV-FUNC-QTY                              41160000
411700               DISPLAY '8700-GET-TKRPRPM ERROR'                   41170000
411800               MOVE DK-OPER-UNT-ID TO  PV-DISPLAY-OPER-UNT-ID     41180000
411900               DISPLAY ' OPER UNIT   - '                          41190000
412000                       PV-DISPLAY-OPER-UNT-ID                     41200000
412100       END-EVALUATE                                               41210000
412200       END-PERFORM.                                               41220000
412300                                                                  41230000
412400       IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                  41240000
412500            SQLCODE NOT = ZERO                                    41250000
412600            DISPLAY '**************************************'      41260000
412700            DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '      41270000
412800            DISPLAY 'GET THE TIME ZONE      '                     41280000
412900            DISPLAY '**************************************'      41290000
413000            MOVE '8700-GET-TKRPRPM-TIME-ZONE'                     41300000
413100                                  TO PV-ABEND-PARAGRAPH           41310000
413200            MOVE 'SELECT'         TO PV-ABEND-OPERATION           41320000
413300            MOVE 'TKRPRPM'        TO PV-ABEND-STRUCTURE-1         41330000
413400            MOVE 'SELECT'         TO PV-DB2-OPERATION-MESSAGE-1   41340000
413500            PERFORM 9999-SQL-ABEND                                41350000
413600        END-IF.                                                   41360000
413700*----------------------------------------------------------------*41370000
413800*    RETRIEVE THE TIME QUANTITY VALUE (IN HOURS) THAT WILL BE     41380000
413900*    USED TO CALCULATE THE BEGINNING TIMESTAMP FOR COUNTING       41390000
414000*    CONTAINERS AND SELECTING CONTAINER INFORMATION FOR A         41400000
414100*    SPECIFIED PERIOD OF TIME.                                    41410000
414200*----------------------------------------------------------------*41420000
414300*                                                                 41430000
414400 8750-GET-TKRPRPM-TIME-INTERVAL.                                  41440000
414500                                                                  41450000
414600      PERFORM                                                     41460000
414700          WITH TEST AFTER                                         41470000
414800          VARYING PV-RETRY-COUNTER                                41480000
414900          FROM 1 BY 1                                             41490000
415000          UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)              41500000
415100             OR  (SQLCODE = +100)                                 41510000
415200             OR  (SQLCODE = +0))                                  41520000
415300       EXEC SQL                                                   41530000
415400           SELECT FUNC_QTY                                        41540000
415500             INTO :PV-TIME-QTY                                    41550000
415600             FROM TKRPRPM                                         41560000
415700            WHERE LOC_ID           = :DK-OPER-UNT-ID              41570000
415800              AND INTFC_SYS_CDE    = 'DLX'                        41580000
415900              AND SYS_PRC_FUNC_CDE = 'DRSMTM'                     41590000
416000              AND FUNC_PRC_STAT_CDE = 'AC'                        41600000
416100       END-EXEC                                                   41610000
416200                                                                  41620000
416300       EVALUATE TRUE                                              41630000
416400           WHEN SQLCODE = +0                                      41640000
416500           WHEN SQLCODE = -904                                    41650000
416600           WHEN SQLCODE = -913                                    41660000
416700           WHEN SQLCODE = -911                                    41670000
416800               CONTINUE                                           41680000
416900           WHEN SQLCODE = +100                                    41690000
417000               MOVE 0                       TO PV-TIME-QTY        41700000
417100               SET PS-NO-DOOR-SUMMARY-HIST  TO TRUE               41710000
417200           WHEN OTHER                                             41720000
417300               MOVE 0                       TO PV-TIME-QTY        41730000
417400               SET PS-NO-DOOR-SUMMARY-HIST  TO TRUE               41740000
417500               DISPLAY '8750-GET-TKRPRPM-TIME-INTERVAL ERROR'     41750000
417600               MOVE DK-OPER-UNT-ID  TO PV-DISPLAY-OPER-UNT-ID     41760000
417700               DISPLAY ' OPER UNIT   - '                          41770000
417800                       PV-DISPLAY-OPER-UNT-ID                     41780000
417900       END-EVALUATE                                               41790000
418000      END-PERFORM.                                                41800000
418100      IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                   41810000
418200          SQLCODE NOT = ZERO                                      41820000
418300          DISPLAY '**************************************'        41830000
418400          DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '        41840000
418500          DISPLAY 'GET THE TIME INTERVAL  '                       41850000
418600          DISPLAY '**************************************'        41860000
418700          MOVE '8750-GET-TKRPRPM-TIME-INTERVAL'                   41870000
418800                                TO PV-ABEND-PARAGRAPH             41880000
418900          MOVE 'SELECT'         TO PV-ABEND-OPERATION             41890000
419000          MOVE 'TKRPRPM'        TO PV-ABEND-STRUCTURE-1           41900000
419100          MOVE 'SINGLE SELECT'  TO PV-DB2-OPERATION-MESSAGE-1     41910000
419200          PERFORM 9999-SQL-ABEND                                  41920000
419300       END-IF.                                                    41930000
419400                                                                  41940000
419500 8800-GET-OLD-NEW-VERSION.                                        41950000
419600                                                                  41960000
419700      PERFORM                                                     41970000
419800          WITH TEST AFTER                                         41980000
419900          VARYING PV-RETRY-COUNTER                                41990000
420000          FROM 1 BY 1                                             42000000
420100          UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)              42010000
420200             OR  (SQLCODE = +100)                                 42020000
420300             OR  (SQLCODE = +0))                                  42030000
420400       EXEC SQL                                                   42040000
420500          SELECT FUNC_BEG_TMST,                                   42050000
420600                 FUNC_END_TMST                                    42060000
420700             INTO :KRPRPM-FUNC-BEG-TMST,                          42070000
420800                  :KRPRPM-FUNC-END-TMST                           42080000
420900               FROM TKRPRPM                                       42090000
421000                  WHERE LOC_ID = :DK-OPER-UNT-ID AND              42100000
421100                     INTFC_SYS_CDE = 'MST' AND                    42110000
421200                     SYS_PRC_FUNC_CDE = 'MASTCO'                  42120000
421300       END-EXEC                                                   42130000
421400                                                                  42140000
421500        EVALUATE TRUE                                             42150000
421600         WHEN SQLCODE = +0                                        42160000
421700         WHEN SQLCODE = -904                                      42170000
421800         WHEN SQLCODE = -913                                      42180000
421900         WHEN SQLCODE = -911                                      42190000
422000             CONTINUE                                             42200000
422100         WHEN OTHER                                               42210000
422200             MOVE 0 TO PV-FUNC-QTY                                42220000
422300             DISPLAY '8800-GET-VERSION'                           42230000
422400             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        42240000
422500             DISPLAY ' OPER UNIT   - '                            42250000
422600                     PV-DISPLAY-OPER-UNT-ID                       42260000
422700        END-EVALUATE                                              42270000
422800       END-PERFORM.                                               42280000
422900                                                                  42290000
423000        IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                 42300000
423100            SQLCODE NOT = ZERO                                    42310000
423200            DISPLAY '**************************************'      42320000
423300            DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '      42330000
423400            DISPLAY 'GET THE OLD NEW VERSION'                     42340000
423500            DISPLAY '**************************************'      42350000
423600            MOVE '8800-GET-OLD-NEW-VERSION'                       42360000
423700                                  TO PV-ABEND-PARAGRAPH           42370000
423800            MOVE 'SELECT'         TO PV-ABEND-OPERATION           42380000
423900            MOVE 'TKRPRPM'        TO PV-ABEND-STRUCTURE-1         42390000
424000            MOVE 'SINGLE SELECT'  TO PV-DB2-OPERATION-MESSAGE-1   42400000
424100            PERFORM 9999-SQL-ABEND                                42410000
424200        END-IF.                                                   42420000
424300      DISPLAY 'BEG-TMST = ' KRPRPM-FUNC-BEG-TMST.                 42430000
424400      DISPLAY 'END-TMST = ' KRPRPM-FUNC-END-TMST.                 42440000
424500      DISPLAY 'CUR-TMST = ' KRPRPM-FUNC-END-TMST.                 42450000
424600                                                                  42460000
424700      IF KRPRPM-FUNC-BEG-TMST <= PV-CURRENT-TIMESTAMP AND         42470000
424800         KRPRPM-FUNC-END-TMST >= PV-CURRENT-TIMESTAMP             42480000
424900          SET PS-NEW-VERSION TO TRUE                              42490000
425000      ELSE                                                        42500000
425100          SET PS-OLD-VERSION TO TRUE                              42510000
425200      END-IF.                                                     42520000
425300                                                                  42530000
425400      DISPLAY 'NEW VERSION IS = ' PS-OLD-NEW-VERSION-SW.          42540000
425401                                                                  42540137
425410******************************************************************42541037
425500*** PARAMETER : STOP WRITING TO DLX INTERFACE FILE                42550037
425501******************************************************************42550137
425510 8850-CHECK-WRITE-DLX-FILE.                                       42551037
425511                                                                  42551141
425520       SET PS-BYPASS-RECORD-DLX-NO  TO TRUE                       42552041
425530                                                                  42553041
425591       EXEC SQL                                                   42559137
425592          SELECT FUNC_TXT                                         42559237
425594          INTO :KRPRPM-FUNC-TXT                                   42559437
425596          FROM TKRPRPM                                            42559637
425597          WHERE LOC_ID = :DK-OPER-UNT-ID                          42559737
425598          AND  INTFC_SYS_CDE = 'DLX'                              42559837
425599          AND  SYS_PRC_FUNC_CDE = 'DLXSDW'                        42559937
425600          AND  CURRENT TIMESTAMP > FUNC_BEG_TMST                  42560037
425601       END-EXEC                                                   42560137
425602                                                                  42560237
425603        EVALUATE TRUE                                             42560337
425604         WHEN SQLCODE = +0                                        42560437
425605              MOVE KRPRPM-FUNC-TXT TO PS-BYPASS-RECORD-DLX-SW     42560537
425606         WHEN SQLCODE = +100                                      42560637
425607              SET PS-BYPASS-RECORD-DLX-NO   TO TRUE               42560741
425608         WHEN SQLCODE = -904                                      42560837
425609         WHEN SQLCODE = -913                                      42560937
425610         WHEN SQLCODE = -911                                      42561037
425611             CONTINUE                                             42561137
425612         WHEN OTHER                                               42561237
425614             DISPLAY '8850-CHECK-WRITE-DLX-FILE'                  42561437
425615             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        42561537
425616             DISPLAY ' OPER UNIT   - '                            42561637
425617                     PV-DISPLAY-OPER-UNT-ID                       42561737
425618             SET PS-BYPASS-RECORD-DLX-YES  TO TRUE                42561837
425620        END-EVALUATE.                                             42562038
425630                                                                  42563037
425633                                                                  42563337
425642                                                                  42564237
425650******************************************************************42565037
425700 8900-WRITE-LMS-DATA.                                             42570000
425800     IF PS-BYPASS-RECORD-LM-YES                                   42580000
425900        CONTINUE                                                  42590000
426000     ELSE                                                         42600000
426100       EXEC SQL                                                   42610007
426200          SET :PV-WORK-TMST =                                     42620007
426300        (TIMESTAMP(:DL003-EVENT-DB-CRE-TMST) + :PV-FUNC-QTY HOURS)42630007
426400       END-EXEC                                                   42640007
426500       IF PS-JOB0100-RECORD                                       42650000
426600                                                                  42660000
426700         WRITE OUTPUT-RECORD4                                     42670000
426800             FROM DL001-RECORD                                    42680000
426900       ELSE                                                       42690000
426901**GB 8/17/15                                                      42690112
426902        IF DL003-EVNT-OBJ-ACTN-TXT = 'DOOR SUMMARY'               42690212
426903*        DISPLAY 'DOOR SUMMARY'                                   42690327
426904*        DISPLAY 'SUCRDV-SHIPT-UNT-ID' SUCRDV-SHIPT-UNT-ID        42690427
426905         IF  PV-NULL-SUM-UNITS = -1                               42690513
426907             CONTINUE                                             42690713
426908         ELSE                                                     42690813
426909            MOVE PV-SUM-UNITS          TO DL002-WMS0102-HUNIT-3   42690913
426911         END-IF                                                   42691113
426912         MOVE +1                     TO DL002-WMS0102-SHIP-UNITS  42691213
426915         IF SUCRDV-DIVERT-TMST  < DL003-EVNT-KY-1-TMST            42691515
426917            MOVE DL003-EVNT-KY-1-TMST   TO  PV-DOOR-SUMMARY-TMST  42691715
426918         ELSE                                                     42691815
426919            MOVE SUCRDV-DIVERT-TMST     TO PV-DOOR-SUMMARY-TMST   42691915
426921         END-IF                                                   42692115
426922         EXEC SQL                                                 42692215
426923           SET :PV-WORK-TMST =                                    42692315
426924           (TIMESTAMP(:PV-DOOR-SUMMARY-TMST) + :PV-FUNC-QTY HOURS)42692415
426925         END-EXEC                                                 42692515
426927        END-IF                                                    42692715
426928**GB 8/17/15                                                      42692815
426930* RPK - 07-16-2015 BEGIN                                          42693007
427000*        MOVE DL003-EVENT-DB-CRE-TMST TO PV-WORK-TMST             42700007
427010* RPK - 07-16-2015 END                                            42701007
427100         MOVE PV-WORK-TMST          TO PV-INPUT-TMST              42710000
427200         MOVE PV-INPUT-TMST-YR(1:2) TO DL002-WMS0102-START-DATE-CC42720000
427300         MOVE PV-INPUT-TMST-YR(3:2) TO DL002-WMS0102-START-DATE-YY42730000
427400         MOVE PV-INPUT-TMST-MO      TO DL002-WMS0102-START-DATE-MM42740000
427500         MOVE PV-INPUT-TMST-DA      TO DL002-WMS0102-START-DATE-DD42750000
427600                                                                  42760000
427700         MOVE PV-INPUT-TMST-HR      TO PV-START-TIME-HR           42770000
427800         MOVE PV-INPUT-TMST-MN      TO PV-START-TIME-MN           42780000
427900         MOVE PV-INPUT-TMST-SS      TO PV-START-TIME-SS           42790000
428000         MOVE PV-START-TIME         TO DL002-WMS0102-START-TIME   42800000
428100         MOVE PV-DL002-WMS0102-USR-ID  TO DL002-WMS0102-USR-ID    42810000
428200         MOVE DL003-TEAM-CODE       TO DL002-WMS0102-TEAM-CODE    42820000
428300         MOVE DL003-TEAM-CODE-IND   TO DL002-WMS0102-TEAM-IND     42830000
428400         WRITE OUTPUT-RECORD4                                     42840000
428500               FROM DL002-RECORD                                  42850000
428600       END-IF                                                     42860000
428700     END-IF.                                                      42870000
428800******************************************************************42880000
428900 9000-WRITE-OUTPUT-RECORD.                                        42890000
429000***  DISPLAY 'NOW IN 9000-WRITE-OUTPUT-RECORD'.                   42900000
429100     MOVE '9000-WRITE-OUTPUT-RECORD.'  TO PV-ABEND-PARAGRAPH.     42910000
429200***  DISPLAY 'PS-OUTPUT-RECORD-TYPE = ' PS-OUTPUT-RECORD-TYPE.    42920000
429300                                                                  42930000
429400     IF PS-JOB0100-RECORD                                         42940000
429410         IF PS-BYPASS-RECORD-DLX-NO                               42941039
429500            WRITE OUTPUT-RECORD1                                  42950036
429600               FROM DL001-RECORD                                  42960036
429610         END-IF                                                   42961036
429700         PERFORM 8900-WRITE-LMS-DATA                              42970000
429800     ELSE                                                         42980000
429900     IF PS-WMS0102-RECORD                                         42990000
429910         IF PS-BYPASS-RECORD-DLX-NO                               42991039
430000            WRITE OUTPUT-RECORD1                                  43000036
430100               FROM DL002-RECORD                                  43010036
430110         END-IF                                                   43011036
430200         PERFORM 8900-WRITE-LMS-DATA                              43020000
430300     ELSE                                                         43030000
430310         IF PS-BYPASS-RECORD-DLX-NO                               43031039
430400           WRITE OUTPUT-RECORD1                                   43040036
430500               FROM DL006-RECORD                                  43050036
430510         END-IF                                                   43051036
430600         WRITE OUTPUT-RECORD4                                     43060000
430700             FROM DL006-RECORD                                    43070000
430800     END-IF.                                                      43080000
430900                                                                  43090000
431000     IF  PS-DOOR-SUMMARY-HIST                                     43100000
431100                                                                  43110000
431200*** DMH - 11/12/09 - BEGIN                                        43120000
431300         IF  PS-DOOR-SUM-TBL-ENTRY-FOUND                          43130000
431400             MOVE DL003-EVNT-KY-1-TXT  TO DL013-EVNT-KY-1-TXT     43140000
431500             MOVE DL003-EVNT-KY-1-TMST TO DL013-EVNT-KY-1-TMST    43150000
431600             MOVE DL003-EVNT-KY-2-TMST TO DL013-EVNT-KY-2-TMST    43160000
431700             WRITE OUTPUT-RECORD3                                 43170000
431800              FROM DL013-DOOR-SUMMARY-HISTORY                     43180000
431900             ADD  1                TO  PV-HIST-RECORDS-WRITTEN    43190000
432000         ELSE                                                     43200000
432100*** DMH - 11/12/09 - END                                          43210000
432200                                                                  43220000
432300             ADD  1                TO PV-DOOR-SUM-TABLE-COUNT     43230000
432400             IF  PV-DOOR-SUM-TABLE-COUNT                          43240000
432500                                     > PC-MAX-DOOR-SUMMARY-COUNT  43250000
432600                 DISPLAY '*************************************'  43260000
432700                          '****'                                  43270000
432800                 DISPLAY '** ABEND **'                            43280000
432900                 DISPLAY '** EXCEEDED MAXIMUM TABLE ENTRIES OF '  43290000
433000                         '750 '                                   43300000
433100                 DISPLAY '** PV-DOOR-SUM-TABLE-COUNT = '          43310000
433200                         PV-DOOR-SUM-TABLE-COUNT                  43320000
433300                 DISPLAY '*************************************'  43330000
433400                          '****'                                  43340000
433500                 MOVE +4013                  TO PV-ABEND-CODE     43350000
433600                 CALL 'ILBOABN0'   USING PV-ABEND-CODE            43360000
433700             END-IF                                               43370000
433800                                                                  43380000
433900             DISPLAY 'PV-DOOR-ID =  '  DL003-EVNT-KY-1-TXT        43390000
434000                     ' *** '                                      43400000
434100                     'TABLE-COUNT=  '  PV-DOOR-SUM-TABLE-COUNT    43410000
434200                                                                  43420000
434300             MOVE DL003-EVNT-KY-1-TXT  TO DL013-EVNT-KY-1-TXT     43430000
434400             MOVE DL003-EVNT-KY-1-TXT  TO PV-DOOR-ID              43440000
434500                                      (PV-DOOR-SUM-TABLE-COUNT)   43450000
434600             MOVE DL003-EVNT-KY-1-TMST TO DL013-EVNT-KY-1-TMST    43460000
434700             MOVE DL003-EVNT-KY-2-TMST TO DL013-EVNT-KY-2-TMST    43470000
434800             MOVE DL003-EVNT-KY-2-TMST TO PV-END-TMST             43480000
434900                                      (PV-DOOR-SUM-TABLE-COUNT)   43490000
435000             WRITE OUTPUT-RECORD3                                 43500000
435100              FROM DL013-DOOR-SUMMARY-HISTORY                     43510000
435200             ADD  1                TO  PV-HIST-RECORDS-WRITTEN    43520000
435300                                                                  43530000
435400*** DMH - 11/12/09 - BEGIN                                        43540000
435500         END-IF                                                   43550000
435600*** DMH - 11/12/09 - END                                          43560000
435700                                                                  43570000
435800     END-IF.                                                      43580000
435900                                                                  43590000
436000     ADD  1  TO  PV-RECORDS-WRITTEN.                              43600000
436100                                                                  43610000
436200 9000-EOJ.                                                        43620000
436300     WRITE OUTPUT-RECORD2.                                        43630000
436400                                                                  43640000
436500     CLOSE INPUT-FILE                                             43650000
436600           OUTPUT-FILE1                                           43660000
436700           OUTPUT-FILE2                                           43670000
436800           OUTPUT-FILE3                                           43680000
436900           OUTPUT-FILE4.                                          43690000
437000                                                                  43700000
437100     DISPLAY ' RECORDS READ      = ' PV-RECORDS-READ              43710000
437200     DISPLAY ' RECORDS WRITTEN   = ' PV-RECORDS-WRITTEN.          43720000
437300     DISPLAY ' HIST RECS WRITTEN = ' PV-HIST-RECORDS-WRITTEN.     43730000
437400                                                                  43740000
437500******************************************************************43750000
437600* ABEND PROCEDURE                                                *43760000
437700******************************************************************43770000
437800 9999-SQL-ABEND.                                                  43780000
437900     DISPLAY '** ABEND           ** = SQLABEND'.                  43790000
438000     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          43800000
438100     DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARAGRAPH.       43810000
438200     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME.        43820000
438300     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MESSAGE-143830000
438400     DISPLAY '**                 ** = ' PV-DB2-OPERATION-MESSAGE-243840000
438500     DISPLAY '** SQLCODE         ** = ' PV-SQLCODE.               43850000
438600     COPY DPPD004.                                                43860000
438700     MOVE +4013                  TO PV-ABEND-CODE.                43870000
438800     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       43880000
438900                                                                  43890000
