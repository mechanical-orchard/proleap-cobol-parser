000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.             RCKRP090.                                00020000
000300 AUTHOR.                 DENISE HAHN.                             00030000
000400 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00040000
000500 DATE-WRITTEN.           OCTOBER, 2018.                           00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800***************************************************************** 00080000
000900*                                                               * 00090000
001000*  EFC FREE ASTRAY RECEIVERS THAT WERE AUTOMATICALLY VERFIED    * 00100000
001200*                                                               * 00120000
001300*  INPUT FILE IS CREATED BY RCKUP067 - RCRD090 - LRECL 200      * 00130011
001400*                                                               * 00140000
001500***************************************************************** 00150000
001600 ENVIRONMENT DIVISION.                                            00160000
001700 CONFIGURATION SECTION.                                           00170000
001800                                                                  00180000
001900 SOURCE-COMPUTER.        IBM-3090.                                00190000
002000 OBJECT-COMPUTER.        IBM-3090.                                00200000
002100                                                                  00210000
002200***************************************************************** 00220000
002300 INPUT-OUTPUT SECTION.                                            00230000
002400                                                                  00240000
002500 FILE-CONTROL.                                                    00250000
002600                                                                  00260000
002700     SELECT INPUT-FILE                                            00270000
002800         ASSIGN TO INP01.                                         00280000
002900                                                                  00290000
003000     SELECT REPORT-FILE                                           00300000
003100         ASSIGN TO RPT01.                                         00310000
003200                                                                  00320000
003300***************************************************************** 00330000
003400 DATA DIVISION.                                                   00340000
003500***************************************************************** 00350000
003600 FILE SECTION.                                                    00360000
003700                                                                  00370000
003800 FD  INPUT-FILE                                                   00380000
003900     RECORDING MODE IS F                                          00390000
004000     LABEL RECORDS ARE STANDARD                                   00400000
004100     BLOCK CONTAINS 0 RECORDS.                                    00410000
004200 01  INPUT-RECORD                    PIC  X(200).                 00420000
004300                                                                  00430000
004400 FD  REPORT-FILE                                                  00440000
004500     RECORDING MODE IS F                                          00450000
004600     BLOCK CONTAINS 0  RECORDS.                                   00460000
004700 01  REPORT-RECORD                   PIC X(200).                  00470004
004800                                                                  00480000
004900***************************************************************** 00490000
005000 WORKING-STORAGE SECTION.                                         00500000
005100                                                                  00510000
005200 01  PROGRAM-SWITCHES.                                            00520000
005300     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         00530000
005400         88  PS-END-OF-INPUT                   VALUE 'Y'.         00540000
005500         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         00550000
005501     05  PS-END-OF-CSR-SW            PIC X(01) VALUE 'N'.         00550107
005502         88  PS-END-OF-CSR                     VALUE 'Y'.         00550207
005503         88  PS-END-OF-CSR-NO                  VALUE 'N'.         00550307
005510     05  PS-ERROR-SW                 PIC X(01) VALUE 'N'.         00551007
005520         88  PS-ERROR                          VALUE 'Y'.         00552007
005530         88  PS-ERROR-NO                       VALUE 'N'.         00553007
005600                                                                  00560000
005700 01  PC-PROGRAM-CONSTANTS.                                        00570000
005800     05  PC-RCKRP090                 PIC X(08) VALUE              00580000
005900                                               'RCKRP090'.        00590000
006000     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00600000
006100     05  PC-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00610000
006200                                               COMP-3.            00620000
006300     05  PC-SLASH                    PIC X(01) VALUE '/'.         00630000
006400     05  PC-DASH                     PIC X(01) VALUE '-'.         00640000
006500                                                                  00650000
006600 01  SD-DATE-TIME.                                                00660000
006700     05  SD-SYSTEM-DATE.                                          00670000
006800         10  SD-SYSTEM-DATE-YY       PIC 9(02) VALUE ZERO.        00680000
006900         10  SD-SYSTEM-DATE-MM       PIC 9(02) VALUE ZERO.        00690000
007000         10  SD-SYSTEM-DATE-DD       PIC 9(02) VALUE ZERO.        00700000
007100     05  SD-SYSTEM-TIME.                                          00710000
007200         10  SD-SYSTEM-TIME-HH       PIC 9(02) VALUE ZERO.        00720000
007300         10  SD-SYSTEM-TIME-MM       PIC 9(02) VALUE ZERO.        00730000
007400         10  SD-SYSTEM-TIME-SS       PIC 9(02) VALUE ZERO.        00740000
007500         10  FILLER                  PIC 9(02) VALUE ZERO.        00750000
007600*                                                                 00760000
007700 01  DK-DB2-KEYS.                                                 00770000
007800     05  DK-PO-NBR                   PIC S9(9) COMP VALUE +0.     00780000
007900     05  DK-RCVR-NBR                 PIC S9(9) COMP VALUE +0.     00790000
007901     05  DK-LINE-NBR                 PIC S9(9) COMP VALUE +0.     00790107
007910*                                                                 00791000
007920 01  PV-PROGRAM-VARIABLES.                                        00792000
007930     05  PV-PREV-OPER                PIC  9(05).                  00793000
008100     05  PV-SQLCODE                  PIC 9(09) VALUE ZERO.        00810000
008200     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         00820000
008300                                               COMP-3.            00830000
008400     05  PV-READ-COUNT                PIC S9(7) COMP-3            00840000
008500                                                VALUE ZERO.       00850000
008600     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            00860000
008700                                                VALUE ZERO.       00870000
008800     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         00880000
008900                                               COMP-3.            00890000
009000     05  PV-LINES-ON-PAGE            PIC  9(3) VALUE 60.          00900000
009100                                                                  00910000
009200     05  PV-RPT-DATE.                                             00920000
009300         10  PV-RPT-DATE-MM          PIC 9(02) VALUE ZERO.        00930000
009400         10  FILLER                  PIC X(01) VALUE '-'.         00940000
009500         10  PV-RPT-DATE-DD          PIC 9(02) VALUE ZERO.        00950000
009600         10  FILLER                  PIC X(01) VALUE '-'.         00960000
009700         10  PV-RPT-DATE-YY          PIC 9(02) VALUE ZERO.        00970000
009800                                                                  00980000
009900 01  PV-ABEND-FIELDS.                                             00990000
010000     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     01000000
010100     05  PV-DB2-TABLE-NAME            PIC X(30) VALUE SPACES.     01010000
010200     05  PV-ABEND-CODE               PIC S9(4) VALUE +0           01020000
010300                                               COMP SYNC.         01030000
010400     05  PV-ABEND-PROGRAM            PIC X(08) VALUE 'RCKRP090'.  01040000
010500     05  PV-ABEND-PARAGRAPH          PIC X(50) VALUE SPACES.      01050000
010600     05  PV-ABEND-OPERATION          PIC X(50) VALUE SPACES.      01060000
010700     05  PV-ABEND-STRUCTURE-1        PIC X(08) VALUE SPACES.      01070000
010800                                                                  01080000
010900     05  PV-DISPLAY-READ-COUNT       PIC ZZZ,ZZZ,ZZ9.             01090000
011000     05  PV-DISPLAY-WRITE-COUNT      PIC ZZZ,ZZZ,ZZ9.             01100000
011100     05  PV-DISP-SQL                 PIC  -999.                   01110000
011200     05  PV-DISP-OPER                PIC  9999.                   01120000
011210     05  PV-DISP-PO                  PIC Z(09).                   01121007
011220     05  PV-DISP-REC-SEQ             PIC 9(04).                   01122007
011300                                                                  01130000
011400******************************************************************01140000
011500* RECORD LAYOUT FOR THE INPUT FILE.                               01150000
011600******************************************************************01160000
011700     COPY RCRD099.                                                01170012
011800                                                                  01180000
011900******************************************************************01190000
012000*  WORK FIELDS FOR PRINTING A 200 CHARACTER REPORT.               01200004
012100******************************************************************01210000
012200     COPY DPWS200O.                                               01220004
012300                                                                  01230000
012400 01  WS-BATCH-PROC-DATE.                                          01240000
012500     05  WS-BATCH-PROC-CC            PIC X(02) VALUE SPACES.      01250000
012600     05  WS-BATCH-PROC-YY            PIC X(02) VALUE SPACES.      01260000
012700     05  FILLER                      PIC X(01) VALUE SPACES.      01270000
012800     05  WS-BATCH-PROC-MM            PIC X(02) VALUE SPACES.      01280000
012900     05  FILLER                      PIC X(01) VALUE SPACES.      01290000
013000     05  WS-BATCH-PROC-DD            PIC X(02) VALUE SPACES.      01300000
013100*                                                                 01310000
013200 01  HEADING-LINES.                                               01320000
013300     05  HEADING-LINE1.                                           01330000
013400         10  FILLER                  PIC X(80) VALUE SPACES.      01340005
013500         10  FILLER                  PIC X(39) VALUE              01350000
013600         'EFC-FREE ASTRAY RECEIVERS AUTO-VERIFIED'.               01360000
013900         10  FILLER                  PIC X(81) VALUE SPACES.      01390005
014000                                                                  01400000
014100     05  HEADING-LINE1A.                                          01410000
014200         10  FILLER                  PIC X(87) VALUE SPACES.      01420018
014300         10  FILLER                  PIC X(16) VALUE              01430000
014400         'PROCESS DATE OF '.                                      01440000
014500         10  HD1-PROCESS-DATE        PIC X(10) VALUE SPACES.      01450000
014600         10  FILLER                  PIC X(53) VALUE SPACES.      01460000
014700                                                                  01470000
014800     05  HEADING-LINE2.                                           01480000
014900         10  HD2-OPER-UNT-ID         PIC 9(04) VALUE ZEROES.      01490000
015000         10  FILLER                  PIC X(01) VALUE SPACES.      01500000
015100         10  HD2-DC-NAME             PIC X(40) VALUE SPACES.      01510000
015200         10  FILLER                  PIC X(87) VALUE SPACES.      01520000
015300                                                                  01530000
015400     05  HEADING-LINE3.                                           01540000
015500         10  FILLER            PIC X(34) VALUE SPACES.            01550018
015600         10  FILLER            PIC X(06) VALUE 'VERIFY'.          01560005
015700         10  FILLER            PIC X(65) VALUE SPACES.            01570018
015820         10  FILLER            PIC X(02) VALUE '--'.              01582021
015830         10  FILLER            PIC X(14) VALUE '-- CREATE ----'.  01583021
015900         10  FILLER            PIC X(30) VALUE SPACES.            01590005
016000         10  FILLER            PIC X(03) VALUE 'EFC'.             01600005
016100         10  FILLER            PIC X(05) VALUE SPACES.            01610000
016110         10  FILLER            PIC X(13) VALUE 'TRIP ------- '.   01611005
016120         10  FILLER            PIC X(14) VALUE 'STATUS ------'.   01612005
016500         10  FILLER            PIC X(07) VALUE SPACES.            01650005
016600                                                                  01660000
016700     05  HEADING-LINE4.                                           01670000
016800         10  FILLER            PIC X(04) VALUE 'OPER'.            01680000
016900         10  FILLER            PIC X(06) VALUE SPACES.            01690000
017000         10  FILLER            PIC X(02) VALUE 'PO'.              01700000
017100         10  FILLER            PIC X(03) VALUE SPACES.            01710000
017200         10  FILLER            PIC X(09) VALUE 'RCVR LINE'.       01720000
017300         10  FILLER            PIC X(02) VALUE SPACES.            01730000
017400         10  FILLER            PIC X(07) VALUE 'STR    '.         01740018
017500         10  FILLER            PIC X(08) VALUE 'QUANTITY'.        01750005
017600         10  FILLER            PIC X(09) VALUE '  SKU NBR'.       01760018
017700         10  FILLER            PIC X(05) VALUE SPACES.            01770005
017800         10  FILLER            PIC X(11) VALUE 'VENDOR NAME'.     01780005
017900         10  FILLER            PIC X(11) VALUE SPACES.            01790018
018000         10  FILLER            PIC X(04) VALUE 'DEPT'.            01800005
018100         10  FILLER            PIC X(06) VALUE SPACES.            01810005
018200         10  FILLER            PIC X(09) VALUE 'DEPT NAME'.       01820005
018300         10  FILLER            PIC X(12) VALUE SPACES.            01830021
018600         10  FILLER            PIC X(09) VALUE 'DATE     '.       01860021
018610         10  FILLER            PIC X(09) VALUE 'TIME SCAC'.       01861005
018611         10  FILLER            PIC X(02) VALUE SPACES.            01861105
018620         10  FILLER            PIC X(07) VALUE 'TRAILER'.         01862005
018630         10  FILLER            PIC X(05) VALUE SPACES.            01863021
018640         10  FILLER            PIC X(07) VALUE 'TRIP ID'.         01864005
018650         10  FILLER            PIC X(03) VALUE SPACES.            01865005
018660         10  FILLER            PIC X(08) VALUE 'SHIPMENT'.        01866005
018670         10  FILLER            PIC X(02) VALUE SPACES.            01867021
018680         10  FILLER            PIC X(02) VALUE 'ST'.              01868021
018690         10  FILLER            PIC X(05) VALUE SPACES.            01869021
018691         10  FILLER            PIC X(04) VALUE 'DATE'.            01869105
018692         10  FILLER            PIC X(04) VALUE SPACES.            01869205
018693         10  FILLER            PIC X(04) VALUE 'TIME'.            01869305
018694         10  FILLER            PIC X(03) VALUE SPACES.            01869405
018695         10  FILLER            PIC X(06) VALUE 'USERID'.          01869505
018696         10  FILLER            PIC X(07) VALUE SPACES.            01869605
018800                                                                  01880000
018900                                                                  01890000
019000 01  DETAIL-LINES.                                                01900000
019100     05  DETAIL-LINE1.                                            01910000
019200         10  DL1-OPER                 PIC  Z(04) VALUE ZEROES.    01920002
019300         10  FILLER                   PIC  X(01) VALUE SPACES.    01930000
019400         10  DL1-PO                   PIC  Z(09) VALUE ZEROES.    01940000
019500         10  FILLER                   PIC  X(01) VALUE SPACES.    01950000
019600         10  DL1-RCVR                 PIC  Z(04) VALUE ZEROES.    01960000
019700         10  FILLER                   PIC  X(01) VALUE SPACES.    01970000
019800         10  DL1-LINE                 PIC  Z(04) VALUE ZEROES.    01980000
019900         10  FILLER                   PIC  X(01) VALUE SPACES.    01990000
020000         10  DL1-STR                  PIC  Z(04) VALUE ZEROES.    02000000
020200         10  FILLER                   PIC  X(01) VALUE SPACES.    02020002
020300         10  DL1-VERIFY-QTY           PIC  ZZZ,ZZZ,ZZZ.           02030002
020320         10  FILLER                   PIC  X(01) VALUE SPACES.    02032002
020330         10  DL1-SKU                  PIC  9(08) VALUE ZEROES.    02033002
020340         10  FILLER                   PIC  X(01) VALUE SPACES.    02034002
020400         10  DL1-VENDOR-NAME          PIC  X(25) VALUE SPACES.    02040000
020500         10  FILLER                   PIC  X(01) VALUE SPACES.    02050000
020600         10  DL1-DEPT                 PIC  9(04) VALUE ZEROES.    02060000
020700         10  FILLER                   PIC  X(01) VALUE SPACES.    02070000
020800         10  DL1-DEPT-NAME            PIC  X(20) VALUE SPACES.    02080000
021300         10  FILLER                   PIC  X(03) VALUE SPACES.    02130000
021600         10  DL1-CRE_DATE             PIC  X(10) VALUE SPACES.    02160005
021601         10  FILLER                   PIC  X(01) VALUE SPACES.    02160105
021602         10  DL1-CRE_TIME             PIC  X(05) VALUE SPACES.    02160205
021610         10  FILLER                   PIC  X(01) VALUE SPACES.    02161002
021700         10  DL1-SCAC                 PIC  X(04) VALUE SPACES.    02170005
021701         10  FILLER                   PIC  X(01) VALUE SPACES.    02170102
021710         10  DL1-VEHICL               PIC  X(10) VALUE SPACES.    02171005
021711         10  FILLER                   PIC  X(01) VALUE SPACES.    02171102
021720         10  DL1-TRIP                 PIC  Z(09) VALUE SPACES.    02172005
021721         10  FILLER                   PIC  X(01) VALUE SPACES.    02172102
021730         10  DL1-EFC-SHPMT            PIC  X(10) VALUE SPACES.    02173005
021731         10  FILLER                   PIC  X(02) VALUE SPACES.    02173121
021740         10  DL1-TRIP-STATUS          PIC  X(02) VALUE SPACES.    02174021
021741         10  FILLER                   PIC  X(02) VALUE SPACES.    02174121
021750         10  DL1-STATUS-DTE           PIC  X(10) VALUE SPACES.    02175021
021751         10  FILLER                   PIC  X(01) VALUE SPACES.    02175102
021760         10  DL1-STATUS-TME           PIC  X(05) VALUE SPACES.    02176021
021761         10  FILLER                   PIC  X(01) VALUE SPACES.    02176102
021770         10  DL1-STATUS-USERID        PIC  X(08) VALUE SPACES.    02177021
021771         10  FILLER                   PIC  X(06) VALUE SPACES.    02177105
021800                                                                  02180000
022000 01  MISCELLANEOUS-LINES.                                         02200000
022100     05  BLANK-LINE.                                              02210000
022200         10  FILLER                  PIC X(150) VALUE SPACES.     02220000
022300                                                                  02230000
022400     05  END-OF-REPORT-LINE.                                      02240000
022500         10  FILLER                  PIC X(44) VALUE SPACES.      02250000
022600         10  FILLER                  PIC X(45) VALUE              02260000
022700             '*******   E N D   O F   R E P O R T   *******'.     02270000
022800         10  FILLER                  PIC X(43) VALUE SPACES.      02280000
022900         10  FILLER                  PIC X(18) VALUE SPACES.      02290000
023000                                                                  02300000
023100     05  NO-DATA-TO-REPORT-LINE.                                  02310000
023200         10  FILLER                  PIC X(40) VALUE SPACES.      02320000
023300         10  FILLER                  PIC  X(52)    VALUE          02330000
023400         '*******  N O   D A T A   T O   R E P O R T   *******'.  02340000
023500         10  FILLER                  PIC  X(40)    VALUE SPACES.  02350000
023600         10  FILLER                  PIC X(18) VALUE SPACES.      02360000
023700                                                                  02370000
023800                                                                  02380000
023900******************************************************************02390000
024000*  USED FOR DB2 ERROR MESSAGE BUILDING                            02400000
024100******************************************************************02410000
024200     COPY DPWS004.                                                02420000
024300                                                                  02430000
024400******************************************************************02440000
024500*   DB2 SQL COMMUNICATION AREA                                    02450000
024600******************************************************************02460000
024700     EXEC SQL                                                     02470000
024800          INCLUDE SQLCA                                           02480000
024900     END-EXEC.                                                    02490000
025000                                                                  02500000
025100*---------------------------------------------------------------* 02510000
025200*  DCLGEN FOR THE LOGISTICS LOCATION TABLE                        02520000
025300*  XLT_LOC                                                        02530000
025400*---------------------------------------------------------------* 02540000
025500     EXEC SQL                                                     02550000
025600          INCLUDE XLT00010                                        02560000
025700     END-EXEC.                                                    02570000
025800                                                                  02580000
025810*---------------------------------------------------------------* 02581001
025820*  TPURCHS                                                        02582001
025840*---------------------------------------------------------------* 02584001
025850     EXEC SQL                                                     02585001
025860          INCLUDE TPURCHS                                         02586001
025870     END-EXEC.                                                    02587001
025880                                                                  02588001
025900*---------------------------------------------------------------* 02590000
026000*  TRECEIV                                                        02600000
026100*---------------------------------------------------------------* 02610000
026200     EXEC SQL                                                     02620000
026300          INCLUDE TRECEIV                                         02630000
026400     END-EXEC.                                                    02640000
026500                                                                  02650000
026510*---------------------------------------------------------------* 02651000
026520*  TRECITM                                                        02652000
026530*---------------------------------------------------------------* 02653000
026540     EXEC SQL                                                     02654000
026550          INCLUDE TRECITM                                         02655000
026560     END-EXEC.                                                    02656000
026570                                                                  02657000
026580*---------------------------------------------------------------* 02658000
026590*  TRECDIS                                                        02659000
026591*---------------------------------------------------------------* 02659100
026592     EXEC SQL                                                     02659200
026593          INCLUDE TRECDIS                                         02659300
026594     END-EXEC.                                                    02659400
026595                                                                  02659500
026600*---------------------------------------------------------------* 02660000
026700*  XLT_SKU                                                        02670000
026800*---------------------------------------------------------------* 02680000
026900     EXEC SQL                                                     02690000
027000          INCLUDE XLT00003                                        02700000
027100     END-EXEC.                                                    02710000
027200                                                                  02720000
027210*---------------------------------------------------------------* 02721000
027220*  XLT_DEPT                                                       02722000
027230*---------------------------------------------------------------* 02723000
027240     EXEC SQL                                                     02724000
027250          INCLUDE XLT00002                                        02725000
027260     END-EXEC.                                                    02726000
027270                                                                  02727000
027300*---------------------------------------------------------------* 02730000
027400*  TENTNME                                                        02740000
027500*---------------------------------------------------------------* 02750000
027600     EXEC SQL                                                     02760000
027700          INCLUDE TENTNME                                         02770000
027800     END-EXEC.                                                    02780000
027900                                                                  02790000
027910*-----------------------------------------------------------------02791000
027920*    RCVR-CSR                                                     02792000
027930*-----------------------------------------------------------------02793000
027940     EXEC SQL                                                     02794000
027950          DECLARE RCVR-CSR CURSOR FOR                             02795000
027960          SELECT C.ORD_LNE_NBR                                    02796000
027961               , C.STR_NBR                                        02796100
027970               , C.VERIFY_ITM_QTY                                 02797000
027980               , D.SKU_NBR                                        02798000
027990            FROM TRECEIV A                                        02799000
027991               , TRECITM B                                        02799100
027992               , TRECDIS C                                        02799200
027993               , XLT_SKU D                                        02799300
027994          WHERE A.ORD_NBR      = :DK-PO-NBR                       02799400
027995            AND A.REC_SEQ_NBR  = :DK-RCVR-NBR                     02799500
027996            AND A.ORD_NBR      =  B.ORD_NBR                       02799600
027997            AND A.REC_SEQ_NBR  =  B.REC_SEQ_NBR                   02799700
027998            AND B.ORD_NBR      =  C.ORD_NBR                       02799800
027999            AND B.REC_SEQ_NBR  =  C.REC_SEQ_NBR                   02799900
028000            AND B.ORD_LNE_NBR  =  C.ORD_LNE_NBR                   02800000
028001            AND B.ITM_NBR      = D.ITM_NBR                        02800100
028002          ORDER BY C.ORD_LNE_NBR                                  02800200
028003     END-EXEC.                                                    02800300
028004                                                                  02800400
028010******************************************************************02801000
028100 PROCEDURE DIVISION.                                              02810000
028200     DISPLAY '**** START OF RCKRP090 ****'.                       02820000
028300                                                                  02830000
028400*OPEN FILES.                                                      02840000
028500     OPEN INPUT  INPUT-FILE                                       02850000
028600          OUTPUT REPORT-FILE.                                     02860000
028700                                                                  02870000
028800     PERFORM 1000-INITIALIZATION.                                 02880000
028900                                                                  02890000
029000     SET  PS-NOT-END-OF-INPUT   TO  TRUE.                         02900000
029100                                                                  02910000
029200     PERFORM 7000-READ-EXTRACT-FILE.                              02920000
029300                                                                  02930000
029400     MOVE RC099-CURR-OPER-UNIT  TO  PV-PREV-OPER.                 02940011
029700                                                                  02970000
029800     IF PS-END-OF-INPUT                                           02980000
029900        ADD +1                  TO PV-PAGE-COUNT                  02990000
030000        MOVE PV-PAGE-COUNT      TO DP200O-PAGE-NUMBER             03000004
030100        WRITE REPORT-RECORD                                       03010000
030200          FROM DP200O-STANDRD-HEADER-200-COLS                     03020004
030300            AFTER ADVANCING PAGE                                  03030000
030400        WRITE REPORT-RECORD                                       03040000
030500          FROM HEADING-LINE1                                      03050000
030600            AFTER ADVANCING 1 LINES                               03060000
030700        WRITE REPORT-RECORD                                       03070000
030800          FROM HEADING-LINE1A                                     03080000
030900            AFTER ADVANCING 1 LINES                               03090000
031000        WRITE REPORT-RECORD                                       03100000
031100          FROM HEADING-LINE2                                      03110000
031200            AFTER ADVANCING 1 LINE                                03120000
031300        WRITE REPORT-RECORD                                       03130000
031400          FROM NO-DATA-TO-REPORT-LINE                             03140000
031500            AFTER ADVANCING 2 LINES                               03150000
031600     ELSE                                                         03160000
031700         MOVE RC099-CURR-OPER-UNIT  TO  PV-PREV-OPER              03170011
031800         PERFORM 8500-GET-LOCATION-NAME                           03180000
031900         PERFORM 1500-PRINT-HEADINGS                              03190000
032000***      PERFORM 3000-GET-VENDOR-INFO                             03200023
032100***      PERFORM 3010-GET-DEPT-INFO                               03210023
032200         PERFORM 2000-PROCESS-INPUT                               03220000
032300           UNTIL PS-END-OF-INPUT                                  03230000
032400     END-IF.                                                      03240000
032500                                                                  03250000
032600*FINISH REPORT.                                                   03260000
032700                                                                  03270000
032800     WRITE REPORT-RECORD                                          03280000
032900       FROM END-OF-REPORT-LINE                                    03290000
033000         AFTER ADVANCING 3 LINES.                                 03300000
033100                                                                  03310000
033200*CLOSE FILES.                                                     03320000
033300     CLOSE INPUT-FILE                                             03330000
033400           REPORT-FILE.                                           03340000
033500                                                                  03350000
033600     MOVE PV-READ-COUNT TO PV-DISPLAY-READ-COUNT.                 03360000
033700     DISPLAY 'TOTAL INPUT READ ' PV-DISPLAY-READ-COUNT.           03370000
033800                                                                  03380000
033900     MOVE PV-WRITE-COUNT TO PV-DISPLAY-WRITE-COUNT.               03390000
034000     DISPLAY 'TOTAL RECS WRITTEN ' PV-DISPLAY-WRITE-COUNT.        03400000
034100                                                                  03410000
034200     GOBACK.                                                      03420000
034300*                                                                 03430000
034400******************************************************************03440000
034500*  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               *03450000
034600******************************************************************03460000
034700 1000-INITIALIZATION.                                             03470000
034710                                                                  03471016
034800     ACCEPT SD-SYSTEM-DATE                                        03480000
034900       FROM DATE.                                                 03490000
035000                                                                  03500000
035100     ACCEPT SD-SYSTEM-TIME                                        03510000
035200       FROM TIME.                                                 03520000
035300                                                                  03530000
035400     MOVE SD-SYSTEM-DATE-MM  TO DP200O-RUN-MONTH.                 03540004
035500     MOVE SD-SYSTEM-DATE-DD  TO DP200O-RUN-DAY.                   03550004
035600     MOVE SD-SYSTEM-DATE-YY  TO DP200O-RUN-YEAR.                  03560004
035700     MOVE SD-SYSTEM-TIME-HH  TO DP200O-RUN-HOUR.                  03570004
035800     MOVE SD-SYSTEM-TIME-MM  TO DP200O-RUN-MINUTE.                03580004
035900                                                                  03590000
036000     MOVE SD-SYSTEM-DATE-MM  TO PV-RPT-DATE-MM.                   03600000
036100     MOVE SD-SYSTEM-DATE-DD  TO PV-RPT-DATE-DD.                   03610000
036200     MOVE SD-SYSTEM-DATE-YY  TO PV-RPT-DATE-YY.                   03620000
036300                                                                  03630000
036400     MOVE PC-RCKRP090             TO DP200O-PROGRAM-NAME.         03640004
036500     MOVE PC-REPORT-NBR           TO DP200O-REPORT-NUMBER.        03650004
036600     MOVE +0                      TO PV-PAGE-COUNT.               03660000
036700                                                                  03670000
036800                                                                  03680000
036900******************************************************************03690000
037000**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  03700000
037100**  PAGES (AS NEEDED).                                            03710000
037200******************************************************************03720000
037300 1500-PRINT-HEADINGS.                                             03730000
037310                                                                  03731013
037400     ADD +1                  TO PV-PAGE-COUNT.                    03740000
037500     MOVE PV-PAGE-COUNT      TO DP200O-PAGE-NUMBER.               03750004
037600                                                                  03760000
037700     MOVE PV-RPT-DATE        TO  HD1-PROCESS-DATE.                03770000
037800                                                                  03780000
037900     WRITE REPORT-RECORD                                          03790000
038000       FROM DP200O-STANDRD-HEADER-200-COLS                        03800004
038100         AFTER ADVANCING PAGE.                                    03810000
038200                                                                  03820000
038300     WRITE REPORT-RECORD                                          03830000
038400       FROM HEADING-LINE1                                         03840000
038500         AFTER ADVANCING 1 LINES.                                 03850000
038600                                                                  03860000
038700     WRITE REPORT-RECORD                                          03870000
038800       FROM HEADING-LINE1A                                        03880000
038900         AFTER ADVANCING 1 LINES.                                 03890000
039000                                                                  03900000
039100     WRITE REPORT-RECORD                                          03910000
039200       FROM HEADING-LINE2                                         03920000
039300         AFTER ADVANCING 1 LINE.                                  03930000
039400                                                                  03940000
039500     WRITE REPORT-RECORD                                          03950000
039600       FROM HEADING-LINE3                                         03960000
039700         AFTER ADVANCING 2 LINES.                                 03970000
039800                                                                  03980000
039900     WRITE REPORT-RECORD                                          03990000
040000       FROM HEADING-LINE4                                         04000000
040100         AFTER ADVANCING 1 LINES.                                 04010000
040200                                                                  04020000
040300     WRITE REPORT-RECORD                                          04030000
040400       FROM BLANK-LINE                                            04040000
040500         AFTER ADVANCING 1 LINE.                                  04050000
040600                                                                  04060000
040700     MOVE +05                TO PV-LINE-COUNT.                    04070000
040800                                                                  04080000
040900                                                                  04090000
041000******************************************************************04100000
041100**  READ INPUT-FILE, WHEN DC CHANGES, DO A PAGE BREAK             04110000
041200******************************************************************04120000
041300 2000-PROCESS-INPUT.                                              04130000
041301                                                                  04130124
041400     IF  RC099-CURR-OPER-UNIT  =  PV-PREV-OPER                    04140011
041600         CONTINUE                                                 04160000
041700     ELSE                                                         04170000
041710         WRITE REPORT-RECORD                                      04171028
041720          FROM BLANK-LINE                                         04172028
041730         AFTER ADVANCING 1 LINE                                   04173028
041731         ADD 1 TO PV-LINE-COUNT                                   04173130
041740                                                                  04174028
041900         IF  PV-LINE-COUNT  > PV-LINES-ON-PAGE                    04190000
042000             PERFORM 1500-PRINT-HEADINGS                          04200000
042100         END-IF                                                   04210000
042200     END-IF.                                                      04220000
042300                                                                  04230000
042400     IF  RC099-CURR-OPER-UNIT  =  PV-PREV-OPER                    04240011
042500         CONTINUE                                                 04250000
042600     ELSE                                                         04260000
042700         MOVE RC099-CURR-OPER-UNIT  TO  PV-PREV-OPER              04270011
042800         PERFORM 8500-GET-LOCATION-NAME                           04280000
042900         PERFORM 1500-PRINT-HEADINGS                              04290000
043000     END-IF.                                                      04300000
043100                                                                  04310000
044110     SET  PS-END-OF-CSR-NO  TO  TRUE                              04411007
044111                                                                  04411107
044112     PERFORM 8050-OPEN-RCVR-CSR.                                  04411207
044120     PERFORM 8060-FETCH-RCVR-CSR                                  04412007
044121       UNTIL PS-END-OF-CSR                                        04412107
044122          OR PS-ERROR.                                            04412207
044130     PERFORM 8070-CLOSE-RCVR-LNE-CSR.                             04413007
044330                                                                  04433007
044331     WRITE REPORT-RECORD                                          04433131
044332      FROM BLANK-LINE                                             04433231
044333     AFTER ADVANCING 1 LINE.                                      04433331
044370                                                                  04437021
044380     ADD  1                  TO PV-LINE-COUNT.                    04438021
044390     IF  PV-LINE-COUNT  > PV-LINES-ON-PAGE                        04439021
044391         PERFORM 1500-PRINT-HEADINGS                              04439121
044392     END-IF.                                                      04439221
044393                                                                  04439321
044400     PERFORM 7000-READ-EXTRACT-FILE.                              04440000
044500                                                                  04450000
044600                                                                  04460000
044700****************************************************************  04470000
044800* GET VENDOR NAME                                              *  04480000
044900****************************************************************  04490000
045000 3000-GET-VENDOR-INFO.                                            04500000
045100                                                                  04510024
045200     MOVE  RC099-ORD-NBR      TO DK-PO-NBR.                       04520010
045300                                                                  04530000
045400     EXEC SQL                                                     04540000
045500          SELECT                                                  04550000
045600                 A.DEPT_NBR                                       04560000
045700               , B.ENT_NAME_DESC                                  04570000
045800            INTO                                                  04580000
045900                 :PURCHS-DEPT-NBR                                 04590000
046000               , :ENTNME-ENT-NAME-DESC                            04600000
046100            FROM TPURCHS A,                                       04610000
046200                 TENTNME B                                        04620000
046300           WHERE A.VER_STATUS_CDE = 'A'                           04630000
046400             AND A.PO_NBR         = :DK-PO-NBR                    04640000
046500             AND A.ENT_ID         = B.ENT_ID                      04650000
046600             AND B.TYPE_CDE       = '01'                          04660000
046700            WITH UR                                               04670000
046800     END-EXEC.                                                    04680000
046900                                                                  04690000
047000     EVALUATE TRUE                                                04700000
047100         WHEN SQLCODE = +0                                        04710000
047200              CONTINUE                                            04720000
047300         WHEN SQLCODE = +100                                      04730000
047400              MOVE 'UNKNOWN'  TO  ENTNME-ENT-NAME-DESC            04740000
047500         WHEN OTHER                                               04750000
047600             MOVE SQLCODE                 TO  PV-DISP-SQL         04760000
047700             DISPLAY 'RCKRP090: 3000-'                            04770000
047800                     ' SQL:'  PV-DISP-SQL                         04780000
047900                     ' RCVR:' RC099-CURR-OPER-UNIT                04790011
048000                     '-'      RC099-ORD-NBR                       04800011
048100                     '-'      RC099-REC-SEQ-NBR                   04810011
048400                                                                  04840000
048500             MOVE '3000-GET-VENDOR-INFO  '                        04850000
048600                           TO PV-ABEND-PARAGRAPH                  04860000
048700             MOVE 'GET VENDOR NAME'   TO PV-DB2-FUNCTION          04870000
048800             MOVE 'TENTNME '          TO PV-DB2-TABLE-NAME        04880000
048900             PERFORM 9900-DB2-ABEND                               04890000
049000     END-EVALUATE.                                                04900000
049001                                                                  04900114
049210                                                                  04921024
049300****************************************************************  04930000
049400* GET DEPT NAME                                                *  04940000
049500****************************************************************  04950000
049600 3010-GET-DEPT-INFO.                                              04960000
049700                                                                  04970024
049800     MOVE  PURCHS-DEPT-NBR  TO  XLT00002-DEPT-NBR                 04980000
049900                                                                  04990000
050000     EXEC SQL                                                     05000000
050100          SELECT                                                  05010000
050200                 DEPT_NM                                          05020000
050300            INTO                                                  05030000
050400                 :XLT00002-DEPT-NM                                05040000
050500            FROM XLT_DEPT                                         05050000
050600           WHERE DEPT_NBR         = :XLT00002-DEPT-NBR            05060000
050700            WITH UR                                               05070000
050800     END-EXEC.                                                    05080000
050900                                                                  05090000
051000     EVALUATE TRUE                                                05100000
051100         WHEN SQLCODE = +0                                        05110000
051200              CONTINUE                                            05120000
051300         WHEN SQLCODE = +100                                      05130000
051400              MOVE 'UNKNOWN'  TO  XLT00002-DEPT-NM                05140000
051500         WHEN OTHER                                               05150000
051600             MOVE SQLCODE                 TO  PV-DISP-SQL         05160000
051700             DISPLAY 'RCKRP090: 3010-'                            05170000
051800                     ' SQL:'  PV-DISP-SQL                         05180000
051900                     ' RCVR:' RC099-CURR-OPER-UNIT                05190011
052000                     '-'      RC099-ORD-NBR                       05200011
052100                     '-'      RC099-REC-SEQ-NBR                   05210011
052200                     '-'      RECDIS-ORD-LNE-NBR                  05220002
052300                     '-'      RECDIS-STR-NBR                      05230002
052400                                                                  05240000
052500             MOVE '3010-GET-DEPT-INFO    '                        05250000
052600                           TO PV-ABEND-PARAGRAPH                  05260000
052700             MOVE 'GET DEPT NAME'     TO PV-DB2-FUNCTION          05270000
052800             MOVE 'XLT_DEPT'          TO PV-DB2-TABLE-NAME        05280000
052900             PERFORM 9900-DB2-ABEND                               05290000
053000     END-EVALUATE.                                                05300000
053001                                                                  05300114
053200                                                                  05320000
053300****************************************************************  05330000
053400* MOVE THE DETAILS TO REPORT LINE.                             *  05340000
053500****************************************************************  05350000
053600 5000-WRITE-RPT-DTL.                                              05360000
053610                                                                  05361024
054000     MOVE RC099-CURR-OPER-UNIT      TO DL1-OPER.                  05400011
054100     MOVE RC099-ORD-NBR             TO DL1-PO.                    05410011
054200     MOVE RC099-REC-SEQ-NBR         TO DL1-RCVR.                  05420011
054300     MOVE RECDIS-ORD-LNE-NBR        TO DL1-LINE.                  05430007
054310     MOVE RECDIS-STR-NBR            TO DL1-STR.                   05431007
054311     MOVE RECDIS-VERIFY-ITM-QTY     TO DL1-VERIFY-QTY.            05431107
054400     MOVE XLT00003-SKU-NBR          TO DL1-SKU.                   05440007
054500     MOVE ENTNME-ENT-NAME-DESC      TO DL1-VENDOR-NAME.           05450007
054800     MOVE XLT00002-DEPT-NBR         TO DL1-DEPT.                  05480007
054900     MOVE XLT00002-DEPT-NM          TO DL1-DEPT-NAME.             05490007
055010     MOVE RC099-CREATE-TMST         TO DL1-CRE_DATE.              05501011
055020     MOVE RC099-CREATE-TMST(12:5)   TO DL1-CRE_TIME.              05502019
055030     MOVE RC099-SCAC                TO DL1-SCAC.                  05503011
055040     MOVE RC099-VEHICL              TO DL1-VEHICL.                05504011
055050     MOVE RC099-TRIP                TO DL1-TRIP.                  05505011
055100     MOVE RC099-EFC-SHIPMT-NBR      TO DL1-EFC-SHPMT.             05510011
055110     MOVE RC099-TRIP-STATUS         TO DL1-TRIP-STATUS.           05511011
055120     MOVE RC099-TRIP-STATUS-DATE    TO DL1-STATUS-DTE.            05512011
055121     MOVE RC099-TRIP-STATUS-TIME    TO DL1-STATUS-TME.            05512111
055122     MOVE RC099-TRIP-STATUS-UID     TO DL1-STATUS-USERID.         05512211
055180                                                                  05518000
055200     WRITE REPORT-RECORD                                          05520000
055300      FROM DETAIL-LINE1                                           05530000
055400     AFTER ADVANCING 1 LINES.                                     05540000
055500                                                                  05550000
055600     ADD  1                  TO PV-LINE-COUNT.                    05560000
055700     IF  PV-LINE-COUNT  > PV-LINES-ON-PAGE                        05570000
055800         PERFORM 1500-PRINT-HEADINGS                              05580000
055900     END-IF.                                                      05590000
056000                                                                  05600000
056100                                                                  05610000
057300******************************************************************05730000
057400*  READ A FROM THE INPUT FILE                                    *05740000
057500******************************************************************05750000
057600 7000-READ-EXTRACT-FILE.                                          05760000
057610                                                                  05761013
057700     READ INPUT-FILE                                              05770000
057800          INTO RC099-EFC-RCVR-REC                                 05780011
057900         AT END                                                   05790000
058000             SET PS-END-OF-INPUT TO TRUE                          05800000
058100         NOT AT END                                               05810000
058200             ADD +1 TO PV-READ-COUNT                              05820000
058300     END-READ.                                                    05830000
058400                                                                  05840000
058401                                                                  05840100
058410******************************************************************05841000
058420*                                                                *05842000
058430******************************************************************05843000
058440 8050-OPEN-RCVR-CSR.                                              05844000
058441                                                                  05844113
058442     MOVE  RC099-ORD-NBR      TO DK-PO-NBR.                       05844225
058443     MOVE  RC099-REC-SEQ-NBR  TO DK-RCVR-NBR.                     05844325
058444                                                                  05844425
058460     EXEC SQL                                                     05846000
058470          OPEN RCVR-CSR                                           05847000
058480     END-EXEC.                                                    05848000
058490                                                                  05849000
058491     EVALUATE TRUE                                                05849100
058492         WHEN SQLCODE = +0                                        05849200
058493              CONTINUE                                            05849300
058494         WHEN SQLWARN0 NOT = SPACE                                05849400
058495         WHEN SQLCODE  NOT = +0                                   05849500
058496             MOVE DK-PO-NBR          TO PV-DISP-PO                05849600
058497             MOVE DK-RCVR-NBR        TO PV-DISP-REC-SEQ           05849707
058498             MOVE SQLCODE            TO PV-DISP-SQL               05849807
058499             SET PS-ERROR        TO TRUE                          05849900
058500             DISPLAY '******************************************' 05850000
058501             DISPLAY '*ABEND                                   *' 05850100
058502             DISPLAY '*PROGRAM   = RCKUP067                    *' 05850200
058503             DISPLAY '*DB2 OPER  = OPEN RCVR-CSR               *' 05850300
058504             DISPLAY '*PARAGRAPH = 8050-OPEN-RCVR-CSR          *' 05850400
058505             DISPLAY '*PO-RCVR   = ' PV-DISP-PO                   05850500
058506                                 '-' PV-DISP-REC-SEQ              05850600
058507             DISPLAY '*SQLCODE = ' PV-DISP-SQL                    05850707
058508             DISPLAY '******************************************' 05850800
058509     END-EVALUATE.                                                05850900
058510                                                                  05851014
058516                                                                  05851624
058517******************************************************************05851700
058518*                                                                *05851800
058519******************************************************************05851900
058520 8060-FETCH-RCVR-CSR.                                             05852000
058521                                                                  05852124
058527     EXEC SQL                                                     05852715
058528          FETCH RCVR-CSR                                          05852815
058529           INTO :RECDIS-ORD-LNE-NBR                               05852915
058530              , :RECDIS-STR-NBR                                   05853015
058531              , :RECDIS-VERIFY-ITM-QTY                            05853115
058532              , :XLT00003-SKU-NBR                                 05853215
058533     END-EXEC.                                                    05853315
058534                                                                  05853415
058535     EVALUATE TRUE                                                05853515
058536         WHEN SQLCODE = +0                                        05853615
058537              MOVE RECITM-ORD-LNE-NBR  TO  DK-LINE-NBR            05853715
058538              PERFORM 3000-GET-VENDOR-INFO                        05853815
058539              PERFORM 3010-GET-DEPT-INFO                          05853915
058540              PERFORM 5000-WRITE-RPT-DTL                          05854015
058541                                                                  05854115
058542         WHEN SQLCODE = +100                                      05854215
058543              SET PS-END-OF-CSR  TO  TRUE                         05854315
058544                                                                  05854415
058545         WHEN SQLWARN0 NOT = SPACE                                05854515
058546         WHEN SQLCODE < +0                                        05854615
058547         WHEN SQLCODE > +0                                        05854715
058548             MOVE SQLCODE TO PV-DISP-SQL                          05854815
058549             SET PS-ERROR        TO TRUE                          05854915
058550             DISPLAY '******************************************' 05855015
058551             DISPLAY '*ABEND                                   *' 05855115
058552             DISPLAY '*PROGRAM   = RCKUP067                    *' 05855215
058553             DISPLAY '*DB2 OPER  = FETCH RCVR-CSR              *' 05855315
058554             DISPLAY '*PARAGRAPH = 8060-FETCH-RCVR-CSR         *' 05855415
058555             DISPLAY '*SQLCODE = ' PV-DISP-SQL                    05855515
058556             DISPLAY '******************************************' 05855615
058557     END-EVALUATE.                                                05855715
058558                                                                  05855815
058563                                                                  05856315
058564******************************************************************05856415
058565*                                                                *05856515
058566******************************************************************05856615
058567 8070-CLOSE-RCVR-LNE-CSR.                                         05856715
058568                                                                  05856815
058571     EXEC SQL                                                     05857115
058572          CLOSE RCVR-CSR                                          05857215
058573     END-EXEC.                                                    05857315
058574                                                                  05857415
058575     EVALUATE TRUE                                                05857515
058576         WHEN SQLCODE = +0                                        05857615
058577              CONTINUE                                            05857715
058578         WHEN SQLWARN0 NOT = SPACE                                05857815
058579         WHEN SQLCODE  NOT = +0                                   05857915
058580             MOVE DK-PO-NBR          TO PV-DISP-PO                05858015
058581             MOVE DK-RCVR-NBR        TO PV-DISP-REC-SEQ           05858115
058582             MOVE SQLCODE TO PV-DISP-SQL                          05858215
058583             SET PS-ERROR        TO TRUE                          05858315
058584             DISPLAY '******************************************' 05858415
058585             DISPLAY '*ABEND                                   *' 05858515
058586             DISPLAY '*PROGRAM   = RCKUP067                    *' 05858615
058587             DISPLAY '*DB2 OPER  = CLOSE RCVR-CSR              *' 05858715
058588             DISPLAY '*PARAGRAPH = 8070-CLOSE-RCVR-CSR         *' 05858815
058589             DISPLAY '*PO-RCVR   = ' PV-DISP-PO                   05858915
058590                                 '-' PV-DISP-REC-SEQ              05859015
058591             DISPLAY '*SQLCODE = ' PV-DISP-SQL                    05859115
058592             DISPLAY '******************************************' 05859215
058593     END-EVALUATE.                                                05859315
058594                                                                  05859415
058599                                                                  05859915
058600******************************************************************05860015
058610*                                                                *05861000
058700******************************************************************05870000
058800 8500-GET-LOCATION-NAME.                                          05880000
058810                                                                  05881013
059000     MOVE PV-PREV-OPER         TO  XLT00010-LOC-NBR               05900000
059100                                   PV-DISP-OPER.                  05910000
059200                                                                  05920000
059300     EXEC SQL                                                     05930000
059400         SELECT   LOC_NM                                          05940000
059500           INTO  :XLT00010-LOC-NM                                 05950000
059600           FROM   XLT_LOC                                         05960000
059700          WHERE   LOC_NBR  =  :XLT00010-LOC-NBR                   05970000
059800     END-EXEC.                                                    05980000
059900                                                                  05990000
060000     EVALUATE TRUE                                                06000000
060100         WHEN SQLCODE = +0                                        06010000
060200              MOVE PV-PREV-OPER        TO HD2-OPER-UNT-ID         06020000
060300              MOVE XLT00010-LOC-NM     TO HD2-DC-NAME             06030000
060400         WHEN OTHER                                               06040000
060500              CONTINUE                                            06050000
060600     END-EVALUATE.                                                06060000
060610                                                                  06061014
060800                                                                  06080000
060900******************************************************************06090000
061000*  ABEND ROUTINE                                                 *06100000
061100******************************************************************06110000
061200 9900-DB2-ABEND.                                                  06120000
061210                                                                  06121013
061400     MOVE SQLCODE TO PV-SQLCODE.                                  06140000
061500     DISPLAY '*** DB2 ERROR '.                                    06150000
061600     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       06160000
061700     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 06170000
061800     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               06180000
061900     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               06190000
062000     DISPLAY '*** FUNCTION  = ' PV-DB2-FUNCTION.                  06200000
062100     DISPLAY '*** TABLE 1   = ' PV-DB2-TABLE-NAME.                06210000
062200                                                                  06220000
062300     COPY DPPD004.                                                06230000
062400                                                                  06240000
062500     MOVE +4013 TO PV-ABEND-CODE.                                 06250000
062600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         06260000
062700                                                                  06270000
062800 9998-ABEND.                                                      06280000
062900                                                                  06290000
063000     DISPLAY '***************'.                                   06300000
063100     DISPLAY '** ABEND     **'.                                   06310000
063200     DISPLAY '** PROGRAM   ** = ' PV-ABEND-PROGRAM.               06320000
063300     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             06330000
063400     DISPLAY '***************'.                                   06340000
063500                                                                  06350000
063600     MOVE +4008                  TO PV-ABEND-CODE.                06360000
063700     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         06370000
063800                                                                  06380000
063900 9999-ABEND.                                                      06390000
064000                                                                  06400000
064100     DISPLAY '***************'.                                   06410000
064200     DISPLAY '** ABEND     **'.                                   06420000
064300     DISPLAY '** PROGRAM   ** = ' PV-ABEND-PROGRAM.               06430000
064400     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             06440000
064500     DISPLAY '***************'.                                   06450000
064600                                                                  06460000
064700     MOVE +4008                  TO PV-ABEND-CODE.                06470000
064800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         06480000
064900                                                                  06490000
065000******************************************************************06500000
065100*                 E N D   O F   P R O G R A M                    *06510000
065200******************************************************************06520000
