000100*-----------------------*                                         00010095
000200 IDENTIFICATION DIVISION.                                         00020095
000300*-----------------------*                                         00030095
000400 PROGRAM-ID.    CNKCS214.                                         00040099
000500 AUTHOR.        LYNN MCADAMS.                                     00050099
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060095
000700 DATE-WRITTEN.  JUNE, 2000.                                       00070099
000800 DATE-COMPILED.                                                   00080095
000900*----------------------------------------------------------------*00090095
001000*    Y214 - PRINTER MAINTENANCE CRITERIA SPECIFICATION           *00100099
001100*                                                                *00110095
001200*    THIS PROGRAM ALLOWS THE USER TO ENTER DATA TO BE USED BY    *00120095
001300*    SUBSEQUENT PROGRAMS.  FROM THIS SCREEN THE USER CAN PRESS:  *00130099
001400*    F13 TO ADD A PRINTER                                        *00140099
001500*    F15 TO UPDATE A PRINTER                                     *00150099
001600*    F17 TO DISPLAY A LIST OF PRINTERS                           *00160099
001700*    F19 TO ADD A CLUSTER                                        *00170099
001800*    F20 TO ADD A PRINTER TYPE                                   *00180099
001900*    F23 TO DISPLAY A LIST OF CLUSTERS                           *00190099
002000*    F24 TO DISPLAY A LIST OF PRINTER TYPES                      *00200099
002100*----------------------------------------------------------------*00210095
263455* CHANGED 11/02/2021    BY JIM HUNTER      WR: CHG0263455                 
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE             
263455* MAKING THE CALL DYNAMIC VS STATIC.                                      
263455*----------------------------------------------------------------*        
CICS  * CHANGED 10/25/2022    BY JIM HUNTER      WR: CHG0276961                 
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL                
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.               
CICS  *-----------------------------------------------------------------        
002200                                                                  00220095
002300                                                                  00230095
002400 ENVIRONMENT DIVISION.                                            00240095
002500                                                                  00250095
002600 DATA DIVISION.                                                   00260095
002700                                                                  00270095
002800 WORKING-STORAGE SECTION.                                         00280095
002900                                                                  00290095
003000 01  DK-DB2-KEYS.                                                 00300095
003100     05  DK-OPER-UNT-ID            PIC S9(04) COMP VALUE +0.      00310095
003200     05  DK-FCLTY-ID               PIC S9(04) COMP VALUE +0.      00320099
003300     05  DK-PRINTER-ID             PIC X(08).                     00330099
003400*                                                                 00340099
003500 01  DN-DB2-NULL-INDICATORS.                                      00350099
003600     05  DN-CLUSTER-NBR           PIC S9(04)  COMP  VALUE ZEROES. 00360099
003700*                                                                 00370099
003800 01  PV-PROGRAM-VARIABLES.                                        00380095
003900     05  PV-CICS-RESPONSE          PIC S9(08)  VALUE ZEROES       00390099
004000                                   COMP SYNC.                     00400099
004100     05  PV-DP020-LOCATION         PIC 9(04)  VALUE 0.            00410099
004600*                                                                 00460099
004700     05  PV-RETRY-COUNTER                PIC S9(04)  VALUE +0     00470099
004800                                                    COMP SYNC.    00480099
004900*                                                                 00490099
005000     05  PV-TYPE-1                       PIC X(01)  VALUE SPACES. 00500099
005100         88   PV-TYPE-1-LABEL                       VALUE 'L'.    00510099
005200         88   PV-TYPE-1-LINE                        VALUE 'N'.    00520099
005300     05  PV-TYPE-2                       PIC X(02)  VALUE SPACES. 00530099
005400         88   PV-TYPE-2-LABEL                       VALUE 'L'.    00540099
005500         88   PV-TYPE-2-LINE                        VALUE 'N'.    00550099
005600*                                                                 00560099
005700*                                                                 00570099
005800 01  PC-PROGRAM-CONSTANTS.                                        00580095
005900     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'CNK214'.   00590099
006000     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'CNKM214'.  00600099
006100     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'CNKCS214'. 00610099
006200     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE  'DPKCS060'. 00620099
006300     05  PC-REPORT-PGM-1           PIC  X(08)  VALUE  'CNKCS214'. 00630099
006400     05  PC-01                     PIC  X(02)  VALUE  '01'.       00640099
006500     05  PC-DC                     PIC  X(02)  VALUE  'DC'.       00650095
006600     05  PC-A                      PIC  X(01)  VALUE  'A'.        00660099
006700     05  PC-N                      PIC  X(01)  VALUE  'N'.        00670099
006800     05  PC-Y                      PIC  X(01)  VALUE  'Y'.        00680099
006900     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00690099
007000                                               COMP-3.            00700099
007100*                                                                 00710099
007200 01  PS-PROGRAM-SWITCHES.                                         00720099
007300     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00730099
007400         88  PS-ERROR                          VALUE  'Y'.        00740099
007500         88  PS-NO-ERROR                       VALUE  'N'.        00750099
007600     05  PS-PRINTER-ID-EXISTS-SW   PIC  X(01)  VALUE  'N'.        00760099
007700         88  PS-PRINTER-ID-EXISTS              VALUE  'Y'.        00770099
007800         88  PS-PRINTER-ID-DOESNT-EXIST        VALUE  'N'.        00780099
007900     05  PS-PRINTER-TYPE-EXISTS-SW PIC  X(01)  VALUE  'N'.        00790099
008000         88  PS-PRINTER-TYPE-EXISTS            VALUE  'Y'.        00800099
008100         88  PS-PRINTER-TYPE-DOESNT-EXIST      VALUE  'N'.        00810099
008200                                                                  00820099
008300*----------------------------------------------------------------*00830099
008400*  SYSTEM MESSAGES                                               *00840099
008500*----------------------------------------------------------------*00850099
008600*   00005 = INVALID VALUE                                         00860099
008700*   00007 = REQUIRED ENTRY                                        00870099
008800*   00008 = MUST BE NUMERIC                                       00880099
008900*   02542 - PRINTER ALREADY EXISTS - UNABLE TO ADD                00890099
009000*----------------------------------------------------------------*00900099
009100*                                                                 00910099
009200 01  PC-TSYMSG-NUMBERS.                                           00920099
009300     05  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.          00930099
009400     05  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.          00940099
009500     05  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.          00950099
009600     05  PC-TSYMSG-02542       PIC  9(05)  VALUE  02542.          00960099
009700*                                                                 00970099
009800 01  PM-PROGRAM-MESSAGES.                                         00980099
009900     05  PM-ABEND-INFO-A.                                         00990099
010000         10  FILLER                PIC X(15)   VALUE              01000099
010100                                   'DP020-SRC-AID: '.             01010099
010200         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      01020099
010300         10  FILLER                PIC X(19)   VALUE              01030099
010400                                   '. DP020-FK-ACTION: '.         01040099
010500         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      01050099
010600         10  FILLER                PIC X(22)   VALUE              01060099
010700                                   '. DP020-FK-DISPN-IND: '.      01070099
010800         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      01080099
010900         10  FILLER                PIC X(01)   VALUE '.'.         01090099
011000         10  FILLER                PIC X(19)   VALUE SPACE.       01100099
011100                                                                  01110099
011200                                                                  01120099
011300*----------------------------------------------------------------*01130099
011400*    MAP LAYOUT                                                  *01140099
011500*----------------------------------------------------------------*01150099
011600                                                                  01160099
011700     COPY CNKM214.                                                01170099
011800     EJECT                                                        01180099
011900                                                                  01190099
012000                                                                  01200099
012100*----------------------------------------------------------------*01210099
012200*    ATTRIBUTE SETTINGS COPYBOOK.                                *01220099
012300*----------------------------------------------------------------*01230099
012400                                                                  01240099
012500     COPY DPWS015.                                                01250099
012600                                                                  01260099
012700*----------------------------------------------------------------*01270099
012800*    FUNCTION KEYS COPYBOOK                                      *01280099
012900*----------------------------------------------------------------*01290099
013000                                                                  01300099
013100     COPY DPWS016.                                                01310099
013200 EJECT                                                            01320099
013300******************************************************************01330099
013400** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01340099
013500** SUB-ROUTINE (DPKUT100).                                      **01350099
013600******************************************************************01360099
013700     COPY DPWS010I.                                               01370099
013800 EJECT                                                            01380099
013900******************************************************************01390099
014000** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS            **01400099
014100** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **01410099
014200******************************************************************01420099
014300     COPY DPWS030.                                                01430099
CICS       COPY DPWS930.                                                01430099
014400 EJECT                                                            01440099
014500***************************************************************** 01450099
014600*    STANDARD COMMAREA.                                           01460099
014700***************************************************************** 01470099
014800                                                                  01480099
014900     COPY DPWS020.                                                01490099
015000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01500099
015100                                                                  01510099
015200***************************************************************** 01520099
015300*    INTER-APPLICATION COMMAREA.                                  01530099
015400***************************************************************** 01540099
015500                                                                  01550099
015600         10  INTER-APPL-COMM-AREA PIC X(200).                     01560099
015700     COPY CNWS161.                                                01570099
015800***************************************************************** 01580099
015900*    SPECIFIC COMMAREA FOR CNKCS214.                              01590099
016000***************************************************************** 01600099
016100         10  ASC-SPECIFIC-COMMAREA.                               01610099
016200             15  ASC-LIST-KEYS.                                   01620099
016300                 20  ASC-KEY-OPER-UNT-ID             PIC S9(04)   01630099
016400                                                     COMP.        01640099
016500                 20  ASC-KEY-FCLTY-ID                PIC S9(04)   01650099
016600                                                     COMP.        01660099
016700             15  ASC-OPER-UNT-ID             PIC  X(04).          01670099
016800             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID      01680099
016900                                             PIC  Z(04).          01690099
017000             15  ASC-FCLTY-ID                PIC  X(04).          01700099
017100             15  ASC-FCLTY-ID-N REDEFINES ASC-FCLTY-ID            01710099
017200                                             PIC  Z(04).          01720099
017300             15  ASC-FCLTY-NME               PIC  X(25).          01730099
017400             15  ASC-PRTR-CLUSTR-NBR         PIC S9(04)  COMP.    01740099
017500             15  ASC-PRINTER-ID              PIC  X(08).          01750099
017600             15  ASC-PRINTER-ID-SW           PIC  X(01).          01760099
017700                 88  ASC-PRINTER-ID-ENTERED     VALUE 'Y'.        01770099
017800                 88  ASC-NO-PRINTER-ID-ENTERED  VALUE 'N'.        01780099
017900             15  ASC-PRTR-SELECT-TYPE        PIC  X(01).          01790099
018000                 88  ASC-SELECT-SRC-VALID     VALUE 'A' 'L' 'N'   01800099
018100                                                    ' '.          01810099
018200                 88  ASC-PRINTER-TYPE-ENTERED VALUE 'A' 'L' 'N'.  01820099
018300                 88  ASC-SELECT-SRC-ALL           VALUE 'A'.      01830099
018400                 88  ASC-SELECT-SRC-LABEL         VALUE 'L'.      01840099
018500                 88  ASC-SELECT-SRC-LINE          VALUE 'N'.      01850099
018600             15  FILLER                      PIC  X(44).          01860099
018700     EJECT                                                        01870099
018800*----------------------------------------------------------------*01880099
018900*    ABEND PROCESSING COPYBOOK.                                  *01890099
019000*----------------------------------------------------------------*01900099
019100                                                                  01910099
019200     COPY DPWS013.                                                01920099
019300                                                                  01930099
020100                                                                  02010099
020200*----------------------------------------------------------------*02020099
020300*    COMMAREA USED TO CALL XLKUT071 (LOCATION DOMAIN ACCESS)     *02030099
020400*----------------------------------------------------------------*02040099
020500                                                                  02050099
020600     COPY XLWS071.                                                02060099
020900                                                                  02090099
021000*----------------------------------------------------------------*02100099
021100*    DB2 AREA FOR PRINTER TABLE                                  *02110099
021200*----------------------------------------------------------------*02120099
021300                                                                  02130099
021400     EXEC SQL                                                     02140099
021500          INCLUDE TPRTRID                                         02150099
021600     END-EXEC.                                                    02160099
021700                                                                  02170099
021800*----------------------------------------------------------------*02180099
021900*    DB2 AREA FOR TSYMSG  (SYSTEM MESSAGE - SHORT MESSAGE)        02190099
022000*----------------------------------------------------------------*02200099
022100     EXEC SQL                                                     02210099
022200          INCLUDE TSYMSG                                          02220099
022300     END-EXEC.                                                    02230099
022400                                                                  02240099
022500*----------------------------------------------------------------*02250099
022600                                                                  02260099
022700*  COMMUNICATION AREAS FOR DB2                                    02270099
022800*                                                                 02280099
022900     EXEC SQL                                                     02290099
023000         INCLUDE SQLCA                                            02300099
023100     END-EXEC.                                                    02310099
023200*----------------------------------------------------------------*02320099
023300                                                                  02330099
023400 EJECT                                                            02340099
023500 LINKAGE SECTION.                                                 02350099
023600                                                                  02360099
023700 01  DFHCOMMAREA.                                                 02370099
023800     05  FILLER                         OCCURS  1 TO 4072 TIMES   02380099
023900                                        DEPENDING ON EIBCALEN.    02390099
024000         10  FILLER                     PIC X.                    02400099
024100                                                                  02410099
024200                                                                  02420099
024300 PROCEDURE DIVISION.                                              02430099
024400***************************************************************** 02440099
024500** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 02450099
024600** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 02460099
024700** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 02470099
024800**                                                             ** 02480099
024900** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 02490099
025000** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 02500099
025100***************************************************************** 02510099
025200 0000-MAIN-MODULE.                                                02520099
025300     INITIALIZE DP030-CICS-API-FIELDS.                            02530099
025400     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       02540099
025500     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          02550099
025600     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         02560099
025700     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       02570099
025800     MOVE LENGTH OF CNK214I       TO DP030-MAP-LENGTH (1).        02580099
025900     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     02590099
026000     PERFORM 0001-CALL-CICS-ARCH-API.                             02600099
026100*                                                                 02610099
026200     PERFORM 1000-CONTROL-PROCESSING                              02620099
026300*                                                                 02630099
026400     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     02640099
026500     PERFORM 0001-CALL-CICS-ARCH-API.                             02650099
026600                                                                  02660099
026700 0001-CALL-CICS-ARCH-API.                                         02670099
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                              
026900                                    DFHCOMMAREA                           
027000                                    DP030-CICS-API-FIELDS                 
027100                                    DP020-STANDARD-COMMAREA               
027200                                    CNK214I.                              
027300*                                                                 02730099
027400     IF  DP030-RC-CALL-SUCCESSFUL                                 02740099
027500         CONTINUE                                                 02750099
027600     ELSE                                                         02760099
027700         SET DP013-NO-ROLLBACK                                    02770099
027800             DP013-XCTL-DISPLAY-RESTART                           02780099
027900             DP013-CICS-ABEND      TO TRUE                        02790099
028000         MOVE 'BEFORE 0000-MAIN-MODULE'                           02800099
028100                                   TO DP013-PARAGRAPH             02810099
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O        
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)              
028400         MOVE DP030-RETURN-CODE                                   02840099
028500                                   TO DP013-MESSAGE-TEXT (3)      02850099
028600         PERFORM DP013-0000-PROCESS-ABEND                         02860099
028700     END-IF.                                                      02870099
028800 EJECT                                                            02880099
028900*                                                                 02890099
029000*                                                                 02900099
029100*----------------------------------------------------------------*02910099
029200*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02920099
029300*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02930099
029400*----------------------------------------------------------------*02940099
029500 1000-CONTROL-PROCESSING.                                         02950099
029600                                                                  02960099
029700     EVALUATE TRUE                                                02970099
029800         WHEN DP020-NEXT-ACT-INITIAL                              02980099
029900         WHEN DP020-NEXT-ACT-RETURN                               02990099
030000             INITIALIZE ASC-SPECIFIC-COMMAREA                     03000099
030100             MOVE DP020-LOCATION-NBR TO PV-DP020-LOCATION         03010099
030200             MOVE PV-DP020-LOCATION TO ASC-OPER-UNT-ID            03020099
030300             MOVE PV-DP020-LOCATION TO ASC-KEY-OPER-UNT-ID        03030099
030400                                       DK-OPER-UNT-ID             03040099
030500             MOVE 1                 TO ASC-FCLTY-ID-N             03050099
030600                                       ASC-KEY-FCLTY-ID           03060099
030700                                       DK-FCLTY-ID                03070099
030800             MOVE PC-A              TO ASC-PRTR-SELECT-TYPE       03080099
030900             PERFORM 4000-BUILD-INITIAL-PANEL                     03090099
031000                                                                  03100099
031100         WHEN DP020-NEXT-ACT-READ-MAP                             03110099
031200             PERFORM 2000-FKEY-PROCESSING                         03120099
031300                                                                  03130099
031400         WHEN OTHER                                               03140099
031500             SET DP013-LOGIC-ABEND                                03150099
031600                 DP013-NO-ROLLBACK TO TRUE                        03160099
031700             MOVE 'CNKCS214 - 1000-CONTROL-PROCESSING'            03170099
031800                                   TO  DP013-PARAGRAPH            03180099
031900             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   03190099
032000                                   TO  DP013-MESSAGE-TEXT(1)      03200099
032100             MOVE DP020-NEXT-APPL-ACTIVITY                        03210099
032200                                   TO DP013-MESSAGE-TEXT(2)       03220099
032300             PERFORM DP013-0000-PROCESS-ABEND                     03230099
032400     END-EVALUATE.                                                03240099
032500*                                                                 03250099
032600*                                                                 03260099
032700*----------------------------------------------------------------*03270099
032800* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*03280099
032900* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*03290099
033000* EDITS.                                                         *03300099
033100*----------------------------------------------------------------*03310099
033200 2000-FKEY-PROCESSING.                                            03320099
033300                                                                  03330099
033400     EVALUATE TRUE                                                03340099
033500                                                                  03350099
033600         WHEN DP020-SRC-AID = DP016-CLEAR                         03360099
033700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03370099
033800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03380099
033900                                                                  03390099
034000*F5-REFRESH                                                       03400099
034100         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     03410099
034200             INITIALIZE ASC-SPECIFIC-COMMAREA                     03420099
034300             MOVE DP020-LOCATION-NBR TO PV-DP020-LOCATION         03430099
034400             MOVE PV-DP020-LOCATION TO ASC-OPER-UNT-ID            03440099
034500             MOVE PV-DP020-LOCATION TO ASC-KEY-OPER-UNT-ID        03450099
034600             MOVE 1              TO ASC-FCLTY-ID-N                03460099
034700                                    ASC-KEY-FCLTY-ID              03470099
034800*LMM                                                              03480099
034900             MOVE PC-A           TO ASC-PRTR-SELECT-TYPE          03490099
035000             PERFORM 4000-BUILD-INITIAL-PANEL                     03500099
035100             PERFORM 3200-RESET-ATTRIBUTES                        03510099
035200                                                                  03520099
035300         WHEN OTHER                                               03530099
035400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03540099
035500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03550099
035600             IF  PS-NO-ERROR                                      03560099
035700                 SET DP030-CONTINUE-GO TO TRUE                    03570099
035800                 PERFORM 2100-CHECK-FUNCTION-KEY                  03580099
035900             ELSE                                                 03590099
036000                 SET DP030-OVERRIDE-GO TO TRUE                    03600099
036100             END-IF                                               03610099
036200     END-EVALUATE.                                                03620099
036300*                                                                 03630099
036400******************************************************************03640099
036500** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **03650099
036600** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **03660099
036700** FROM THE CICS ARCHITECTURE API.                              **03670099
036800******************************************************************03680099
036900 2100-CHECK-FUNCTION-KEY.                                         03690099
037000     EVALUATE TRUE                                                03700099
037100*                                                                 03710099
037200         WHEN DP020-SRC-AID = DP016-ENTER                         03720099
037300             CONTINUE                                             03730099
037400*                                                                 03740099
037500*F13 ADDPRTR  ----> GOES TO CNKCS216 TO PROCESS PRINTER ID ADD    03750099
037600         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              03760099
037700             PERFORM 3030-VALIDATE-PRINTER-ID                     03770099
037800             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03780099
037900*                                                                 03790099
038000*F15 UPDPRTR  ----> GOES TO CNKCS216 TO PROCESS PRINTER ID UPDATE 03800099
038100         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              03810099
038200             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03820099
038300*                                                                 03830099
038400*F17 PRTRLIST ----> GOES TO CNKCS215                              03840099
038500         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              03850099
038600             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03860099
038700*                                                                 03870099
038800*F19 ADDCLSTR ----> GOES TO CNKCS220                              03880099
038900         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              03890099
039000             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03900099
039100*                                                                 03910099
039200*F20 ADDTYPE ----> GOES TO CNKCS218                               03920099
039300         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              03930099
039400             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03940099
039500*                                                                 03950099
039600*F23 CLSTRLST ----> GOES TO CNKCS219                              03960099
039700         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              03970099
039800             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03980099
039900*                                                                 03990099
040000*F24 PTRTYPLS ----> GOES TO CNKCS217                              04000099
040100         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              04010099
040200             PERFORM 2110-PREPARE-INTER-APPL-COMM                 04020099
040300     END-EVALUATE.                                                04030099
040400*                                                                 04040099
040500*                                                                 04050099
040600******************************************************************04060099
040700** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **04070099
040800** INTER-APPLICATION COMMAREA.                                  **04080099
040900******************************************************************04090099
041000 2110-PREPARE-INTER-APPL-COMM.                                    04100099
041100                                                                  04110099
041200     INITIALIZE CN161-INTER-APPL-COMMAREA.                        04120099
041300                                                                  04130099
041400     MOVE ASC-KEY-OPER-UNT-ID      TO CN161-OPER-UNT-ID.          04140099
041500     MOVE ASC-KEY-FCLTY-ID         TO CN161-FCLTY-ID.             04150099
041600     MOVE ASC-FCLTY-NME            TO CN161-FCLTY-NME.            04160099
041700     MOVE ASC-PRINTER-ID           TO CN161-PRINTER-ID.           04170099
041800     MOVE ASC-PRTR-SELECT-TYPE     TO CN161-PRINTER-SELECT-TYPE.  04180099
041900     MOVE ASC-PRINTER-ID-SW        TO CN161-PRINTER-ID-SW.        04190099
042000*                                                                 04200099
042100*                                                                 04210099
042200*----------------------------------------------------------------*04220099
042300* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*04230099
042400* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *04240099
042500* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *04250099
042600*----------------------------------------------------------------*04260099
042700 2200-MOVE-SCREEN-TO-COMMAREA.                                    04270099
042800*USER LOCATION                                                    04280099
042900     IF  AOPERL > ZERO                                            04290099
043000         MOVE AOPERI               TO ASC-OPER-UNT-ID             04300099
043100     ELSE                                                         04310099
043200         IF AOPERF = DP015-ERASE-EOF                              04320099
043300            MOVE ZERO              TO ASC-OPER-UNT-ID-N           04330099
043400                                      ASC-KEY-OPER-UNT-ID         04340099
043500         END-IF                                                   04350099
043600     END-IF.                                                      04360099
043700*                                                                 04370099
043800*FACILITY ID                                                      04380099
043900     IF  AFCLTYL > ZERO                                           04390099
044000         MOVE AFCLTYI              TO ASC-FCLTY-ID                04400099
044100     ELSE                                                         04410099
044200         IF AFCLTYF = DP015-ERASE-EOF                             04420099
044300            MOVE ZERO              TO ASC-FCLTY-ID-N              04430099
044400                                      ASC-KEY-FCLTY-ID            04440099
044500         END-IF                                                   04450099
044600     END-IF.                                                      04460099
044700*                                                                 04470099
044800*PRINTER ID                                                       04480099
044900     IF  APRTIDL > ZERO                                           04490099
045000         MOVE APRTIDI              TO ASC-PRINTER-ID              04500099
045100                                      DK-PRINTER-ID               04510099
045200         MOVE PC-Y                 TO ASC-PRINTER-ID-SW           04520099
045300     ELSE                                                         04530099
045400         IF APRTIDF = DP015-ERASE-EOF                             04540099
045500            MOVE SPACES            TO ASC-PRINTER-ID              04550099
045600            MOVE PC-N              TO ASC-PRINTER-ID-SW           04560099
045700         END-IF                                                   04570099
045800     END-IF.                                                      04580099
045900*                                                                 04590099
046000*PRINTER TYPE                                                     04600099
046100     IF  APRTTYPL > ZERO                                          04610099
046200         MOVE APRTTYPI             TO ASC-PRTR-SELECT-TYPE        04620099
046300     ELSE                                                         04630099
046400         IF APRTTYPF = DP015-ERASE-EOF                            04640099
046500            MOVE SPACES            TO ASC-PRTR-SELECT-TYPE        04650099
046600         END-IF                                                   04660099
046700     END-IF.                                                      04670099
046800*                                                                 04680099
046900*                                                                 04690099
047000******************************************************************04700099
047100* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *04710099
047200* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *04720099
047300* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE     *04730099
047400* DONE IN THE DESTINATION PROGRAM, NOT HERE.                     *04740099
047500******************************************************************04750099
047600*                                                                 04760099
047700 3000-EDIT-DATA-IN-COMMAREA.                                      04770099
047800     PERFORM 3200-RESET-ATTRIBUTES.                               04780099
047900                                                                  04790099
048000*EDIT OPER UNIT TO MAKE SURE NUMERIC                              04800099
048100     IF  ASC-OPER-UNT-ID NOT = SPACES                             04810099
048200         MOVE ASC-OPER-UNT-ID    TO DP010I-UNEDITED-FIELD         04820099
048300         MOVE LENGTH OF ASC-OPER-UNT-ID                           04830099
048400                                 TO DP010I-MAXIMUM-DIGITS         04840099
048500         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       04850099
048600         SET DP010I-NEGATIVE-NOT-ALLOWED                          04860099
048700                                 TO TRUE                          04870099
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
263455              USING DP010I-NUMERIC-EDIT-AREA                              
048900         IF  DP010I-ERROR-DETECTED                                04890099
049000             SET PS-ERROR                                         04900099
049100                 DP020-MSG-FATAL TO TRUE                          04910099
049200             MOVE PC-TSYMSG-00008                                 04920099
049300                                 TO DP020-MSG-NUMBER              04930099
049400             MOVE DP015-UNP-ALP-BRT-OFF                           04940099
049500                                 TO AOPERA                        04950099
049600             MOVE DP015-RED      TO AOPERC                        04960099
049700             MOVE DP015-REVERSE  TO AOPERH                        04970099
049800             MOVE -1             TO AOPERL                        04980099
049900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04990099
050000         ELSE                                                     05000099
050100             MOVE DP010I-NUMERIC-FIELD                            05010099
050200                                 TO ASC-OPER-UNT-ID-N             05020099
050300                                    ASC-KEY-OPER-UNT-ID           05030099
050400                                    DK-OPER-UNT-ID                05040099
050500             MOVE ASC-OPER-UNT-ID                                 05050099
050600                                 TO AOPERO                        05060099
050700*VALIDATE OPER UNIT                                               05070099
050800             PERFORM 3010-VALIDATE-OPER-UNT-ID                    05080099
052100         END-IF                                                   05210099
052200     ELSE                                                         05220099
052300         SET PS-ERROR                                             05230099
052400             DP020-MSG-FATAL         TO TRUE                      05240099
052500         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          05250099
052600         MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA                    05260099
052700         MOVE DP015-RED              TO AOPERC                    05270099
052800         MOVE DP015-REVERSE          TO AOPERH                    05280099
052900         MOVE -1                     TO AOPERL                    05290099
053000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      05300099
053100     END-IF.                                                      05310099
053200*                                                                 05320099
053300*EDIT FACILITY ID TO MAKE SURE NUMERIC                            05330099
053400     IF  ASC-FCLTY-ID NOT = SPACES                                05340099
053500         MOVE ASC-FCLTY-ID       TO DP010I-UNEDITED-FIELD         05350099
053600         MOVE LENGTH OF ASC-FCLTY-ID                              05360099
053700                                 TO DP010I-MAXIMUM-DIGITS         05370099
053800         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       05380099
053900         SET DP010I-NEGATIVE-NOT-ALLOWED                          05390099
054000                                 TO TRUE                          05400099
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
263455              USING DP010I-NUMERIC-EDIT-AREA                              
054200         IF  DP010I-ERROR-DETECTED                                05420099
054300             SET PS-ERROR                                         05430099
054400                 DP020-MSG-FATAL TO TRUE                          05440099
054500             MOVE PC-TSYMSG-00008                                 05450099
054600                                 TO DP020-MSG-NUMBER              05460099
054700             MOVE DP015-UNP-ALP-BRT-OFF                           05470099
054800                                 TO AFCLTYA                       05480099
054900             MOVE DP015-RED      TO AFCLTYC                       05490099
055000             MOVE DP015-REVERSE  TO AFCLTYH                       05500099
055100             MOVE -1             TO AFCLTYL                       05510099
055200             SET DP030-SET-CURSOR-APPL-1                          05520099
055300                                 TO TRUE                          05530099
055400         ELSE                                                     05540099
055500             MOVE DP010I-NUMERIC-FIELD                            05550099
055600                                 TO ASC-FCLTY-ID-N                05560099
055700                                    ASC-KEY-FCLTY-ID              05570099
055800                                    DK-FCLTY-ID                   05580099
055900             MOVE ASC-FCLTY-ID   TO AFCLTYO                       05590099
056000*VALIDATE FACILITY ID                                             05600099
056100             PERFORM 3020-VALIDATE-FCLTY-ID                       05610099
057700         END-IF                                                   05770099
057800     ELSE                                                         05780099
057900         SET PS-ERROR                                             05790099
058000             DP020-MSG-FATAL         TO TRUE                      05800099
058100         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          05810099
058200         MOVE DP015-UNP-ALP-BRT-OFF  TO AFCLTYA                   05820099
058300         MOVE DP015-RED              TO AFCLTYC                   05830099
058400         MOVE DP015-REVERSE          TO AFCLTYH                   05840099
058500         MOVE -1                     TO AFCLTYL                   05850099
058600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      05860099
058700     END-IF.                                                      05870099
058800*                                                                 05880099
058900******************************************************************05890099
059000*VALIDATE PRINTER ID                                              05900099
059100     IF ASC-PRINTER-ID > SPACES AND                               05910099
059200        DP020-SRC-AID = DP016-ENTER OR                            05920099
059300        DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID) OR                 05930099
059400        DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)                    05940099
059500        CONTINUE                                                  05950099
059600     ELSE                                                         05960099
059700        PERFORM 3030-VALIDATE-PRINTER-ID                          05970099
059800     END-IF                                                       05980099
059900*                                                                 05990099
060000******************************************************************06000099
060100*VALIDATE PRINTER SELECT TYPE IS 'A', 'L' OR 'N' ONLY.            06010099
060200     IF ASC-PRTR-SELECT-TYPE > SPACES                             06020099
060300        EVALUATE TRUE                                             06030099
060400           WHEN ASC-PRTR-SELECT-TYPE = 'A'                        06040099
060500              SET ASC-SELECT-SRC-ALL   TO TRUE                    06050099
060600              PERFORM 4700-PROCESS-PRINT-TYPE                     06060099
060700           WHEN ASC-PRTR-SELECT-TYPE = 'L'                        06070099
060800              SET ASC-SELECT-SRC-LABEL TO TRUE                    06080099
060900              PERFORM 4700-PROCESS-PRINT-TYPE                     06090099
061000           WHEN ASC-PRTR-SELECT-TYPE = 'N'                        06100099
061100              SET ASC-SELECT-SRC-LINE  TO TRUE                    06110099
061200              PERFORM 4700-PROCESS-PRINT-TYPE                     06120099
061300           WHEN OTHER                                             06130099
061400              SET PS-ERROR                                        06140099
061500                  DP020-MSG-FATAL         TO TRUE                 06150099
061600              MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER     06160099
061700              MOVE DP015-UNP-ALP-BRT-OFF  TO APRTTYPA             06170099
061800              MOVE DP015-RED              TO APRTTYPC             06180099
061900              MOVE DP015-REVERSE          TO APRTTYPH             06190099
062000              MOVE -1                     TO APRTTYPL             06200099
062100              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 06210099
062200        END-EVALUATE                                              06220099
062300     END-IF.                                                      06230099
062400*LMM                                                              06240099
062500     EVALUATE TRUE                                                06250099
062600         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              06260099
062700             IF ASC-PRINTER-ID = SPACES OR ZEROS                  06270099
062800                INITIALIZE CN161-INTER-APPL-COMMAREA              06280099
062900                SET PS-ERROR                                      06290099
063000                    DP020-MSG-FATAL        TO TRUE                06300099
063100                MOVE PC-TSYMSG-00007       TO DP020-MSG-NUMBER    06310099
063200                MOVE DP015-UNP-ALP-BRT-OFF TO APRTIDA             06320099
063300                MOVE DP015-RED             TO APRTIDC             06330099
063400                MOVE DP015-REVERSE         TO APRTIDH             06340099
063500                MOVE -1                    TO APRTIDL             06350099
063600                SET DP030-SET-CURSOR-APPL-1 TO TRUE               06360099
063700             END-IF                                               06370099
063800     END-EVALUATE.                                                06380099
063900*                                                                 06390099
067110                                                                  06711099
067120****************************************************************  06712099
067130*    THIS PARAGRAPH RETRIEVES THE STORE INFORMATION.           *  06713099
067140*                                                              *  06714099
067150****************************************************************  06715099
067160                                                                  06716099
067161 3010-VALIDATE-OPER-UNT-ID.                                       06716199
067180                                                                  06718099
067190     INITIALIZE XL071-COMMAREA.                                   06719099
067191     MOVE DK-OPER-UNT-ID TO XL071-LOCATION-NUMBER.                06719199
067192                                                                  06719299
067193     CALL XL071-LOCATION-MODULE USING                             06719399
067194                                DFHEIBLK                          06719499
067195                                XL071-COMMAREA                    06719599
067196                                XL071-COMMAREA-REC.               06719699
067197                                                                  06719799
067198     EVALUATE TRUE                                                06719899
067199         WHEN XL071-NO-ERRORS                                     06719999
067200         WHEN XL071-DC-ASGMT-NOT-FND                              06720099
067201              CONTINUE                                            06720199
067202                                                                  06720299
067203         WHEN XL071-LOC-NOT-FOUND                                 06720399
067204              SET PS-ERROR                                        06720499
067205                  DP020-MSG-FATAL     TO TRUE                     06720599
067206              MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER         06720699
067207              MOVE DP015-UNP-ALP-BRT-OFF                          06720799
067208                                      TO AOPERA                   06720899
067209              MOVE DP015-RED          TO AOPERC                   06720999
067210              MOVE DP015-REVERSE      TO AOPERH                   06721099
067211              MOVE -1                 TO AOPERL                   06721199
067212              SET DP030-SET-CURSOR-APPL-1                         06721299
067213                                      TO TRUE                     06721399
067214                                                                  06721499
067215         WHEN OTHER                                               06721599
067216              MOVE 'VALIDATE-OPER-UNT-ID'                         06721699
067217                              TO DP013-PARAGRAPH                  06721799
067218              STRING 'SELECT STORE NUMBER - '                             
067219                      XL071-LOCATION-NUMBER                               
067220                     ' - BAD RETURN CODE FROM XLKUT071 - '                
067221                      XL071-RETURN-CODE                                   
067222                      DELIMITED BY SIZE                                   
067223                      INTO DP013-MESSAGE-TEXT (1)                         
067224              STRING 'SQLCODE - '                                         
067225                      XL071-SQLCODE                                       
067226                     ' - '                                                
067227                      XL071-DB2-TABLE                                     
067228                      DELIMITED BY SIZE                                   
067229                      INTO DP013-MESSAGE-TEXT (2)                         
067230              MOVE XL071-SQLCA     TO DP013-SQLCA                         
067231              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)            
067242              MOVE XL071-SQLCODE TO SQLCODE                       06722899
067245              SET DP013-DB2-ABEND                                 06723199
067246                  DP013-XCTL-DISPLAY-RESTART TO TRUE              06723299
067247              PERFORM DP013-0000-PROCESS-ABEND                    06723399
067248                                                                  06723499
067249     END-EVALUATE.                                                06723599
067250                                                                  06723699
067300*                                                                 06730099
070610                                                                  06711099
070620****************************************************************  06712099
070630*    VERIFY FACILITY ID                                        *  06713099
070640*                                                              *  06714099
070650****************************************************************  06715099
070660                                                                  06716099
070670 3020-VALIDATE-FCLTY-ID.                                                99
070680                                                                  06718099
070690     INITIALIZE XL071-COMMAREA.                                   06719099
070691     MOVE DK-OPER-UNT-ID TO XL071-LOCATION-NUMBER.                06719199
070692                                                                  06719299
070693     CALL XL071-LOCATION-MODULE USING                             06719399
070694                                DFHEIBLK                          06719499
070695                                XL071-COMMAREA                    06719599
070696                                XL071-COMMAREA-REC.               06719699
070697                                                                  06719799
070698     EVALUATE TRUE                                                06719899
070699         WHEN XL071-NO-ERRORS                                     06719999
070700         WHEN XL071-DC-ASGMT-NOT-FND                              06720099
070701              MOVE XL071-LOC-NM   TO ASC-FCLTY-NME                      99
070702                                     AFDESCO                            99
070704                                                                  06720299
070705         WHEN XL071-LOC-NOT-FOUND                                 06720399
070706              SET PS-ERROR                                                
070707                  DP020-MSG-FATAL     TO TRUE                             
070708              MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER                 
070709              MOVE DP015-UNP-ALP-BRT-OFF                                  
070710                                      TO AFCLTYA                          
070711              MOVE DP015-RED          TO AFCLTYC                          
070712              MOVE DP015-REVERSE      TO AFCLTYH                          
070713              MOVE -1                 TO AFCLTYL                          
070714              SET DP030-SET-CURSOR-APPL-1                                 
070715                                      TO TRUE                             
070724                                                                  06721499
070725         WHEN OTHER                                               06721599
070726              MOVE '3020-VALIDATE-FCLTY-ID'                       06721699
070727                              TO DP013-PARAGRAPH                  06721799
070728              STRING 'SELECT STORE NUMBER - '                             
070729                      XL071-LOCATION-NUMBER                               
070730                     ' - BAD RETURN CODE FROM XLKUT071 - '                
070731                      XL071-RETURN-CODE                                   
070732                      DELIMITED BY SIZE                                   
070733                      INTO DP013-MESSAGE-TEXT (1)                         
070734              STRING 'SQLCODE - '                                         
070735                      XL071-SQLCODE                                       
070736                     ' - '                                                
070737                      XL071-DB2-TABLE                                     
070738                      DELIMITED BY SIZE                                   
070739                      INTO DP013-MESSAGE-TEXT (2)                         
070740              MOVE XL071-SQLCA     TO DP013-SQLCA                         
070741              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)            
070742              MOVE XL071-SQLCODE TO SQLCODE                       06722899
070743              SET DP013-DB2-ABEND                                 06723199
070744                  DP013-XCTL-DISPLAY-RESTART TO TRUE              06723299
070745              PERFORM DP013-0000-PROCESS-ABEND                    06723399
070746                                                                  06723499
070747     END-EVALUATE.                                                06723599
070750                                                                  07070099
070800*                                                                 07080099
070900******************************************************************07090099
071000* VALIDATE THE PRINTER ID                                         07100099
071100******************************************************************07110099
071200 3030-VALIDATE-PRINTER-ID.                                        07120099
071300        EXEC SQL                                                  07130099
071400        SELECT  PRTR_ID                                           07140099
071500               ,PRTR_OPER_UNT_ID                                  07150099
071600               ,PRTR_FCLTY_ID                                     07160099
071700               ,PRTR_CLUSTR_NBR                                   07170099
071800               ,PRTR_TYP_CDE                                      07180099
071900               ,PRTR_LOC_DESC                                     07190099
072000               ,PRTR_PHY_STAT_CDE                                 07200099
072100          INTO :PRTRID-PRTR-ID                                    07210099
072200              ,:PRTRID-PRTR-OPER-UNT-ID                           07220099
072300              ,:PRTRID-PRTR-FCLTY-ID                              07230099
072400              ,:PRTRID-PRTR-CLUSTR-NBR :DN-CLUSTER-NBR            07240099
072500              ,:PRTRID-PRTR-TYP-CDE                               07250099
072600              ,:PRTRID-PRTR-LOC-DESC                              07260099
072700              ,:PRTRID-PRTR-PHY-STAT-CDE                          07270099
072800          FROM  TPRTRID                                           07280099
072900         WHERE  PRTR_ID          = :DK-PRINTER-ID                 07290099
073000           AND  PRTR_OPER_UNT_ID = :DK-OPER-UNT-ID                07300099
073100           AND  PRTR_FCLTY_ID    = :DK-FCLTY-ID                   07310099
073200        END-EXEC                                                  07320099
073300                                                                  07330099
073400        EVALUATE TRUE                                             07340099
073500            WHEN SQLCODE = +0                                     07350099
073600                 IF DN-CLUSTER-NBR = -1                           07360099
073700                    MOVE 0 TO ASC-PRTR-CLUSTR-NBR                 07370099
073800                 END-IF                                           07380099
073900                  SET PS-ERROR                                    07390099
074000                      DP020-MSG-FATAL         TO TRUE             07400099
074100                  MOVE PC-TSYMSG-02542        TO DP020-MSG-NUMBER 07410099
074200                  MOVE DP015-UNP-ALP-BRT-OFF  TO APRTIDA          07420099
074300                  MOVE DP015-RED              TO APRTIDC          07430099
074400                  MOVE DP015-REVERSE          TO APRTIDH          07440099
074500                  MOVE -1                     TO APRTIDL          07450099
074600                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             07460099
074700            WHEN SQLCODE = +100                                   07470099
074800                CONTINUE                                          07480099
074900            WHEN SQLWARN0 NOT = SPACES                            07490099
075000            WHEN SQLCODE < +0                                     07500099
075100            WHEN SQLCODE > +0                                     07510099
075200                MOVE 'VALIDATE-PRINTER-ID'                        07520099
075300                                TO DP013-PARAGRAPH                07530099
075400                MOVE 'SELECT PRINTER ID'                          07540099
075500                                TO DP013-MESSAGE-TEXT (1)         07550099
075600                MOVE SQLCA      TO DP013-SQLCA                    07560099
075700                MOVE 'TPRTRID'  TO DP013-DB2-TABLE-NAME (1)       07570099
075800                SET DP013-DB2-ABEND                               07580099
075900                                TO TRUE                           07590099
076000                SET DP013-XCTL-DISPLAY-RESTART                    07600099
076100                                TO TRUE                           07610099
076200                PERFORM DP013-0000-PROCESS-ABEND                  07620099
076300        END-EVALUATE.                                             07630099
076400*                                                                 07640099
076500*                                                                 07650099
076600*                                                                 07660099
076700*                                                                 07670099
076800******************************************************************07680099
076900** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **07690099
077000** MAP.                                                         **07700099
077100******************************************************************07710099
077200 3200-RESET-ATTRIBUTES.                                           07720099
077300     MOVE DP015-UNP-ALP-NOR-OFF    TO AOPERA                      07730099
077400                                      AFCLTYA                     07740099
077500                                      AFDESCA                     07750099
077600                                      APRTIDA                     07760099
077700                                      APRTTYPA.                   07770099
077800     MOVE DP015-GREEN              TO AOPERC                      07780099
077900                                      AFCLTYC                     07790099
078000                                      APRTIDC                     07800099
078100                                      APRTTYPC.                   07810099
078200     MOVE DP015-UNDERLINE          TO AOPERH                      07820099
078300                                      AFCLTYH                     07830099
078400                                      APRTIDH                     07840099
078500                                      APRTTYPH.                   07850099
078600     MOVE SPACES                   TO AMSGLNO.                    07860099
078700*                                                                 07870099
078800*                                                                 07880099
078900*----------------------------------------------------------------*07890099
079000*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *07900099
079100*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *07910099
079200*  IT HERE.                                                      *07920099
079300*----------------------------------------------------------------*07930099
079400 4000-BUILD-INITIAL-PANEL.                                        07940099
079500     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        07950099
079600     MOVE -1                       TO APRTIDL.                    07960099
079700                                                                  07970099
079800     MOVE SPACES                   TO APRTTYPO.                   07980099
079900     MOVE SPACES                   TO APRTIDO.                    07990099
080000                                                                  08000099
080100     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     08010099
080200     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    08020099
080300     MOVE ASC-FCLTY-NME            TO AFDESCO.                    08030099
080400     MOVE ASC-PRTR-SELECT-TYPE     TO APRTTYPO.                   08040099
080500*                                                                 08050099
080600*                                                                 08060099
080700*----------------------------------------------------------------*08070099
080800*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *08080099
080900*----------------------------------------------------------------*08090099
081000 4400-MOVE-COMMAREA-TO-SCREEN.                                    08100099
081100     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     08110099
081200     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    08120099
081300     MOVE ASC-FCLTY-NME            TO AFDESCO.                    08130099
081400     MOVE ASC-PRINTER-ID           TO APRTIDO.                    08140099
081500     MOVE ASC-PRTR-SELECT-TYPE     TO APRTTYPO.                   08150099
081600 EJECT                                                            08160099
081700*                                                                 08170099
081800*                                                                 08180099
081900*----------------------------------------------------------------*08190099
082000*  PRINT FUNCTION.                                               *08200099
082100*----------------------------------------------------------------*08210099
082200 4700-PROCESS-PRINT-TYPE.                                         08220099
082300                                                                  08230099
082400     EVALUATE TRUE                                                08240099
082500         WHEN  ASC-SELECT-SRC-ALL                                 08250099
082600                   SET  PV-TYPE-1-LABEL                           08260099
082700                        PV-TYPE-2-LINE         TO  TRUE           08270099
082800                   SET  CN161-SELECT-ALL       TO  TRUE           08280099
082900         WHEN  ASC-SELECT-SRC-LABEL                               08290099
083000                   SET  PV-TYPE-1-LABEL                           08300099
083100                        PV-TYPE-2-LABEL        TO  TRUE           08310099
083200                   SET  CN161-SELECT-LABEL     TO  TRUE           08320099
083300         WHEN  ASC-SELECT-SRC-LINE                                08330099
083400                   SET  PV-TYPE-1-LINE                            08340099
083500                        PV-TYPE-2-LINE         TO  TRUE           08350099
083600                   SET  CN161-SELECT-LINE      TO  TRUE           08360099
083700     END-EVALUATE.                                                08370099
083800*                                                                 08380099
083900*                                                                 08390099
084000*----------------------------------------------------------------*08400099
084100*    ABEND PROCESSOR MODULE                                      *08410099
084200*----------------------------------------------------------------*08420099
084300                                                                  08430099
084400     COPY DPPD013.                                                08440099
