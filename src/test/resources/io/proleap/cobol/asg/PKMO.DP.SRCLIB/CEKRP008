000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             CEKRP008.                                00050099
000600 AUTHOR.                 LYNN MCADAMS.                            00060002
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            JANUARY, 2000                            00080099
000900 DATE-COMPILED.                                                   00090000
001000***************************************************************** 00100000
001100*                                                                 00110003
001200***************************************************************** 00120000
001300*                                                               * 00130099
001400*  THIS PROGRAM WILL FORMAT THE "RECAP OF CENTRAL STOCK         * 00140099
001500*  BATCHES FOR MONTH-END" REPORT.                               * 00150099
001600*                                                               * 00160099
001700*  INPUT FOR THIS PROGRAM IS CREATED OUT OF CEKUT007.           * 00170099
001800***************************************************************** 00180000
001900*                                                                 00190002
002000***************************************************************** 00200000
002100 ENVIRONMENT DIVISION.                                            00210000
002200***************************************************************** 00220000
002300                                                                  00230000
002400 CONFIGURATION SECTION.                                           00240000
002500                                                                  00250000
002600 SOURCE-COMPUTER.        IBM-3090.                                00260000
002700 OBJECT-COMPUTER.        IBM-3090.                                00270000
002800                                                                  00280000
002900 INPUT-OUTPUT SECTION.                                            00290000
003000                                                                  00300000
003100 FILE-CONTROL.                                                    00310000
003200*                                                                 00320000
003300     SELECT CE-FILE                                               00330099
003400         ASSIGN TO INP01.                                         00340000
003500                                                                  00350099
003600     SELECT CE-REPORT-FILE                                        00360099
003700         ASSIGN TO RPT01.                                         00370000
003800                                                                  00380041
003900*                                                                 00390041
004000***************************************************************** 00400000
004100 DATA DIVISION.                                                   00410000
004200***************************************************************** 00420000
004300*                                                                 00430000
004400 FILE SECTION.                                                    00440000
004500*                                                                 00450000
004600 FD  CE-FILE                                                      00460099
004700     RECORDING MODE IS F                                          00470000
004800     BLOCK CONTAINS 0 RECORDS                                     00480000
004900     RECORD CONTAINS 130 CHARACTERS                               00490099
005000     LABEL RECORDS ARE STANDARD                                   00500041
005100     DATA RECORD IS CE-RECORD.                                    00510099
005200 01  CE-RECORD                       PIC X(130).                  00520099
005300*                                                                 00530099
005400 FD  CE-REPORT-FILE                                               00540099
005500     RECORDING MODE IS F                                          00550000
005600     BLOCK CONTAINS 0  RECORDS                                    00560041
005700     RECORD CONTAINS 132 CHARACTERS                               00570041
005800     LABEL RECORDS ARE OMITTED                                    00580041
005900     DATA RECORD IS CE-REPORT-RECORD.                             00590099
006000 01  CE-REPORT-RECORD                PIC X(132).                  00600099
006100*                                                                 00610041
006200*                                                                 00620006
006300 WORKING-STORAGE SECTION.                                         00630000
006400*                                                                 00640000
006500 01 WS-CALC-FIELDS.                                               00650099
006600    05  WS-RECORDS-READ-QTY          PIC S9(07)    COMP-3         00660099
006700                                                   VALUE ZEROS.   00670099
006800    05  WS-RECORDS-WRITE-QTY         PIC S9(07)    COMP-3         00680099
006900                                                   VALUE ZEROS.   00690099
007000*                                                                 00700099
007100 01  PROGRAM-SWITCHES.                                            00710000
007200     05  PS-END-OF-FILE-SW           PIC X(03)     VALUE 'N'.     00720099
007300         88  PS-END-OF-FILE                        VALUE 'Y'.     00730099
007400     05  PS-FIRST-TIME-SW                PIC X(01) VALUE 'N'.     00740099
007500         88  PS-FIRST-TIME-YES                     VALUE 'Y'.     00750099
007600         88  PS-FIRST-TIME-NO                      VALUE 'N'.     00760099
007700     05  PS-RUN-TYPE-SW              PIC X(01)     VALUE SPACES.  00770099
007800         88 PS-SPECIAL-RUN           VALUE 'S'.                   00780099
007900         88 PS-NORMAL-RUN            VALUE 'N'.                   00790099
008000*                                                                 00800026
008100 01  PC-CONSTANTS.                                                00810000
008200     05  PC-1                        PIC S9(03)    VALUE +1       00820000
008300                                                   COMP-3.        00830000
008400     05  PC-2                        PIC S9(03)    VALUE +2       00840000
008500                                                   COMP-3.        00850000
008600     05  PC-9                        PIC S9(03)    VALUE +9       00860006
008700                                                   COMP-3.        00870000
008800     05  PC-10                       PIC S9(03)    VALUE +10      00880006
008900                                                   COMP-3.        00890006
009000     05  PC-28                       PIC S9(02)    VALUE +28.     00900099
009100     05  PC-55                       PIC S9(03)    VALUE +55      00910000
009200                                                   COMP-3.        00920000
009300     05  PC-60                       PIC S9(03)    VALUE +60      00930079
009400                                                   COMP-3.        00940000
009500     05  PC-PROGRAM-NAME             PIC  X(08)    VALUE          00950099
009600                                                   'CEKRP008'.    00960099
009700     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       00970000
009800     05  PC-DEFAULT-CC-DATE          PIC  X(10)                   00980099
009900                  VALUE '9999-09-09'.                             00990099
010000*                                                                 01000099
010100 01 PC-PROGRAM-VARIABLES.                                         01010000
010200     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     01020000
010300                                                   COMP-3.        01030000
010400     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01040000
010500                                                   COMP-3.        01050000
010600     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01060003
010700                                                   COMP SYNC.     01070011
010800     05  PV-ABEND-PARA-NAME          PIC X(30)     VALUE SPACES.  01080099
010900     05  PV-DB2-OPERATION-MSG-1      PIC X(40)     VALUE SPACES.  01090099
011000     05  PV-DB2-OPERATION-MSG-2      PIC X(40)     VALUE SPACES.  01100099
011100     05  PV-DB2-TABLE-NAME           PIC X(12)     VALUE SPACES.  01110099
011200     05  PV-SQLCODE                  PIC Z(8)9-.                  01120099
011300     05  PV-BATCH-PROC-DATE          PIC X(10)  VALUE SPACES.     01130099
011400     05  PV-CURRENT-DB2-DATE         PIC  X(10).                  01140099
011500     05  PV-CURR-DATE.                                            01150099
011600         10 PV-CURRENT-DB2-CCYY.                                  01160099
011700            15 PV-CURRENT-DB2-CC       PIC  9(02)    VALUE 0.     01170099
011800            15 PV-CURRENT-DB2-YY       PIC  9(02)    VALUE 0.     01180099
011900         10 FILLER                     PIC  X(01)    VALUE '-'.   01190099
012000         10 PV-CURRENT-DB2-MM          PIC  9(02)    VALUE 0.     01200099
012100         10 FILLER                     PIC  X(01)    VALUE '-'.   01210099
012200         10 PV-CURRENT-DB2-DD          PIC  9(02)    VALUE 0.     01220099
012300     05  PV-CURRENT-DATE.                                         01230099
012400         10 PV-CURRENT-CCYY.                                      01240099
012500            15 PV-CURRENT-CC           PIC  9(02)    VALUE 0.     01250099
012600            15 PV-CURRENT-YY           PIC  9(02)    VALUE 0.     01260099
012700         10 PV-CURRENT-MM              PIC  9(02)    VALUE 0.     01270099
012800         10 PV-CURRENT-DD              PIC  9(02)    VALUE 0.     01280099
012900     05  PV-PARA-NAME                  PIC  X(30)    VALUE SPACES.01290099
013000     05  PV-BEG-DATE.                                             01300099
013100         10 PV-BEG-YYYY.                                          01310099
013200            15 PV-BEG-CC               PIC  9(02)    VALUE 0.     01320099
013300            15 PV-BEG-YY               PIC  9(02)    VALUE 0.     01330099
013400         10 PV-BEG-MM                  PIC  9(02)    VALUE 0.     01340099
013500         10 PV-BEG-DD                  PIC  9(02)    VALUE 0.     01350099
013600     05  PV-END-DATE.                                             01360099
013700         10 PV-END-YYYY.                                          01370099
013800            15 PV-END-CC               PIC  9(02)    VALUE 0.     01380099
013900            15 PV-END-YY               PIC  9(02)    VALUE 0.     01390099
014000         10 PV-END-MM                  PIC  9(02)    VALUE 0.     01400099
014100         10 PV-END-DD                  PIC  9(02)    VALUE 0.     01410099
014200     05  PV-DATE-AREA.                                            01420099
014300         10 PV-DATE-AREA-MM            PIC  9(02)    VALUE 0.     01430099
014400         10 PV-DATE-AREA-DD            PIC  9(02)    VALUE 0.     01440099
014500         10 PV-DATE-AREA-CC            PIC  9(02)    VALUE 0.     01450099
014600         10 PV-DATE-AREA-YY            PIC  9(02)    VALUE 0.     01460099
014700     05  PV-START-EXTRACT              PIC X(10)     VALUE SPACES.01470099
014800     05  FILLER  REDEFINES PV-START-EXTRACT.                      01480099
014900         10 PV-START-EXTRACT-YYYY      PIC 9999.                  01490099
015000         10 PV-START-EXTRACT-1ST       PIC X.                     01500099
015100         10 PV-START-EXTRACT-MM        PIC 99.                    01510099
015200         10 PV-START-EXTRACT-2ND       PIC X.                     01520099
015300         10 PV-START-EXTRACT-DD        PIC 99.                    01530099
015400     05  PV-END-EXTRACT                PIC X(10)     VALUE SPACES.01540099
015500     05  FILLER  REDEFINES PV-END-EXTRACT.                        01550099
015600         10 PV-END-EXTRACT-YYYY        PIC 9999.                  01560099
015700         10 PV-END-EXTRACT-1ST         PIC X.                     01570099
015800         10 PV-END-EXTRACT-MM          PIC 99.                    01580099
015900         10 PV-END-EXTRACT-2ND         PIC X.                     01590099
016000         10 PV-END-EXTRACT-DD          PIC 99.                    01600099
016100     05  PV-REPORT-FIELDS.                                        01610099
016200         10  PV-TOTAL-DIST-UNITS     PIC 9(09)     VALUE ZEROS.   01620099
016300         10  PV-TOTAL-DIST-RETAIL    PIC 9(09)V99  VALUE ZEROS.   01630099
016400     05  PV-TODAYS-DATE.                                          01640000
016500         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZEROS.   01650099
016600         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZEROS.   01660099
016700         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZEROS.   01670099
016800     05  PV-TODAYS-TIME.                                          01680000
016900         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZEROS.   01690099
017000         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZEROS.   01700099
017100         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZEROS.   01710099
017200         10  FILLER                  PIC  9(02)    VALUE ZEROS.   01720099
017300*                                                                 01730099
017400 01 CC-CONTROL-CARD-PARAMETERS.                                   01740099
017500    05 CC-BEG-DATE.                                               01750099
017600       10 CC-BEG-YYYY                 PIC 9(04) VALUE 0.          01760099
017700       10 FILLER                      PIC X(01) VALUE SPACES.     01770099
017800       10 CC-BEG-MM                   PIC 9(02) VALUE 0.          01780099
017900       10 FILLER                      PIC X(01) VALUE SPACES.     01790099
018000       10 CC-BEG-DD                   PIC 9(02) VALUE 0.          01800099
018100    05 FILLER                         PIC X(01) VALUE SPACES.     01810099
018200    05 CC-END-DATE.                                               01820099
018300       10 CC-END-YYYY                 PIC 9(04) VALUE 0.          01830099
018400       10 FILLER                      PIC X(01) VALUE SPACES.     01840099
018500       10 CC-END-MM                   PIC 9(02) VALUE 0.          01850099
018600       10 FILLER                      PIC X(01) VALUE SPACES.     01860099
018700       10 CC-END-DD                   PIC 9(02) VALUE 0.          01870099
018800    05 FILLER                       PIC X(01) VALUE SPACES.       01880099
018900    05 CC-MODE-IND                  PIC X(01) VALUE SPACES.       01890099
019000       88 CC-VALID-MODE-IND         VALUE 'D', 'W', 'M',          01900099
019100                                          'F', 'C', 'S'.          01910099
019200       88 CC-DAILY-EXTRACT          VALUE 'D'.                    01920099
019300       88 CC-WEEKLY-EXTRACT         VALUE 'W'.                    01930099
019400       88 CC-MONTHLY-EXTRACT        VALUE 'M'.                    01940099
019500       88 CC-FISCAL-EXTRACT         VALUE 'F'.                    01950099
019600       88 CC-CALENDAR-EXTRACT       VALUE 'C'.                    01960099
019700       88 CC-SEASONAL-EXTRACT       VALUE 'S'.                    01970099
019800    05 FILLER                       PIC X(01) VALUE SPACES.       01980099
019900    05 CC-TIMEFRAME-IND             PIC X(01) VALUE SPACES.       01990099
020000       88 CC-VALID-TIMEFRAME-IND    VALUE ' ', 'A'.               02000099
020100       88 CC-ACTUAL-TIMEFRAME       VALUE 'A'.                    02010099
020200    05 FILLER                       PIC X(59) VALUE SPACES.       02020099
020300                                                                  02030099
020400*RECORD LAYOUT FOR INPUT FILE                                     02040002
020500     COPY CERD013.                                                02050002
020600*                                                                 02060099
020700 EJECT                                                            02070000
020800*                                                                 02080000
020900*                                                                 02090099
021000******************************************************************02100099
021100*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02110099
021200******************************************************************02120099
021300     COPY DPWS132O.                                               02130099
021400*                                                                 02140099
021500 01  WS-BATCH-PROC-DATE.                                          02150099
021600     05  WS-BATCH-PROC-CC            PIC X(02)     VALUE SPACES.  02160099
021700     05  WS-BATCH-PROC-YY            PIC X(02)     VALUE SPACES.  02170099
021800     05  FILLER                      PIC X(01)     VALUE SPACES.  02180099
021900     05  WS-BATCH-PROC-MM            PIC X(02)     VALUE SPACES.  02190099
022000     05  FILLER                      PIC X(01)     VALUE SPACES.  02200099
022100     05  WS-BATCH-PROC-DD            PIC X(02)     VALUE SPACES.  02210099
022200*                                                                 02220099
022300 01  WS-MONTH-END-DATE.                                           02230099
022400     05  WS-MONTH-END-CC             PIC X(02)     VALUE SPACES.  02240099
022500     05  WS-MONTH-END-YY             PIC X(02)     VALUE SPACES.  02250099
022600     05  FILLER                      PIC X(01)     VALUE SPACES.  02260099
022700     05  WS-MONTH-END-MM             PIC X(02)     VALUE SPACES.  02270099
022800     05  FILLER                      PIC X(01)     VALUE SPACES.  02280099
022900     05  WS-MONTH-END-DD             PIC X(02)     VALUE SPACES.  02290099
023000*                                                                 02300099
023100 01  HEADING-LINE1.                                               02310099
023200     05  FILLER                  PIC  X(40)    VALUE SPACES.      02320099
023300     05  FILLER                  PIC  X(46)    VALUE              02330099
023400         'RECAP OF CENTRAL STOCK BATCHES FOR MONTH-END  '.        02340099
023500     05  HL1-FISCAL-MONTH-END.                                    02350099
023600         10  HL1-MONTH-END-MM    PIC  X(02)    VALUE SPACES.      02360099
023700         10  FILLER              PIC  X(01)    VALUE '/'.         02370099
023800         10  HL1-MONTH-END-DD    PIC  X(02)    VALUE SPACES.      02380099
023900         10  FILLER              PIC  X(01)    VALUE '/'.         02390099
024000*        10  HL1-MONTH-END-CC    PIC  X(02)    VALUE SPACES.      02400099
024100         10  HL1-MONTH-END-YR    PIC  X(04)    VALUE SPACES.      02410099
024200     05  FILLER                  PIC  X(36)    VALUE SPACES.      02420099
024300*                                                                 02430099
024400 01  HEADING-LINE2.                                               02440099
024500     05  FILLER                  PIC  X(04)    VALUE SPACES.      02450099
024600     05  FILLER                  PIC  X(04)    VALUE              02460099
024700         'DATE'.                                                  02470099
024800     05  FILLER                  PIC  X(08)    VALUE SPACES.      02480099
024900     05  FILLER                  PIC  X(05)    VALUE              02490099
025000         'BATCH'.                                                 02500099
025100     05  FILLER                  PIC  X(08)    VALUE SPACES.      02510099
025200     05  FILLER                  PIC  X(11)    VALUE              02520099
025300         'DISTRIBUTED'.                                           02530099
025400     05  FILLER                  PIC  X(05)    VALUE SPACES.      02540099
025500     05  FILLER                  PIC  X(11)    VALUE              02550099
025600         'DISTRIBUTED'.                                           02560099
025700     05  FILLER                  PIC  X(76)    VALUE SPACES.      02570099
025800*                                                                 02580099
025900 01  HEADING-LINE3.                                               02590099
026000     05  FILLER                  PIC  X(03)    VALUE SPACES.      02600099
026100     05  FILLER                  PIC  X(06)    VALUE              02610099
026200         'POSTED'.                                                02620099
026300     05  FILLER                  PIC  X(07)    VALUE SPACES.      02630099
026400     05  FILLER                  PIC  X(06)    VALUE              02640099
026500         'NUMBER'.                                                02650099
026600     05  FILLER                  PIC  X(10)    VALUE SPACES.      02660099
026700     05  FILLER                  PIC  X(05)    VALUE              02670099
026800         'UNITS'.                                                 02680099
026900     05  FILLER                  PIC  X(11)    VALUE SPACES.      02690099
027000     05  FILLER                  PIC  X(06)    VALUE              02700099
027100         'RETAIL'.                                                02710099
027200     05  FILLER                  PIC  X(78)    VALUE SPACES.      02720099
027300*                                                                 02730099
027400 01  HEADING-LINE4.                                               02740099
027500     05  FILLER                  PIC  X(01)    VALUE SPACES.      02750099
027600     05  FILLER                  PIC  X(10)    VALUE              02760099
027700         '----------'.                                            02770099
027800     05  FILLER                  PIC  X(04)    VALUE SPACES.      02780099
027900     05  FILLER                  PIC  X(08)    VALUE              02790099
028000         '-------'.                                               02800099
028100     05  FILLER                  PIC  X(06)    VALUE SPACES.      02810099
028200     05  FILLER                  PIC  X(11)    VALUE              02820099
028300         '-----------'.                                           02830099
028400     05  FILLER                  PIC  X(05)    VALUE SPACES.      02840099
028500     05  FILLER                  PIC  X(12)    VALUE              02850099
028600         '------------'.                                          02860099
028700     05  FILLER                  PIC  X(75)    VALUE SPACES.      02870099
028800*                                                                 02880099
028900*                                                                 02890099
029000 01  REPORT-DETAIL-LINE.                                          02900099
029100     05  FILLER                  PIC  X(01)    VALUE SPACES.      02910099
029200     05  DL1-BTCH-PROC-DTE.                                       02920099
029300         10  DL1-BATCH-PROC-MM   PIC  X(02)    VALUE SPACES.      02930099
029400         10  FILLER              PIC  X(01)    VALUE '/'.         02940099
029500         10  DL1-BATCH-PROC-DD   PIC  X(02)    VALUE SPACES.      02950099
029600         10  FILLER              PIC  X(01)    VALUE '/'.         02960099
029700         10  DL1-BATCH-PROC-CC   PIC  X(02)    VALUE SPACES.      02970099
029800         10  DL1-BATCH-PROC-YY   PIC  X(02)    VALUE SPACES.      02980099
029900     05  FILLER                  PIC  X(06)    VALUE SPACES.      02990099
030000     05  DL1-BATCH-NMBR          PIC  X(04)    VALUE SPACES.      03000099
030100     05  FILLER                  PIC  X(08)    VALUE SPACES.      03010099
030200     05  DL1-DIST-UNITS          PIC  ZZZ,ZZZ,ZZ9                 03020099
030300         VALUE ZEROS.                                             03030099
030400     05  FILLER                  PIC  X(05)    VALUE SPACES.      03040099
030500     05  DL1-DIST-RETAIL         PIC  Z,ZZZ,ZZZ.99                03050099
030600         VALUE ZEROS.                                             03060099
030700     05  FILLER                  PIC  X(80)    VALUE SPACES.      03070099
030800*                                                                 03080099
030900 01  REPORT-TOTALS-LINE.                                          03090099
031000     05  FILLER                  PIC  X(01)    VALUE SPACES.      03100099
031100     05  FILLER                  PIC  X(28)    VALUE              03110099
031200         'CS CORPORATE TOTALS:        '.                          03120099
031300     05  TL1-TOTAL-DIST-UNITS    PIC  ZZZ,ZZZ,ZZ9                 03130099
031400         VALUE ZEROS.                                             03140099
031500     05  FILLER                  PIC  X(03)    VALUE SPACES.      03150099
031600     05  TL1-TOTAL-DIST-RETAIL   PIC  ZZZ,ZZZ,ZZZ.99              03160099
031700         VALUE ZEROS.                                             03170099
031800     05  FILLER                  PIC  X(80)    VALUE SPACES.      03180099
031900*                                                                 03190099
032000 01  BL-BLANK-LINE               PIC X(132)    VALUE SPACES.      03200099
032100                                                                  03210099
032200 01  MISCELLANEOUS-LINES.                                         03220099
032300     05  END-OF-REPORT-LINE.                                      03230099
032400         10  FILLER                  PIC  X(44)    VALUE SPACES.  03240099
032500         10  FILLER                  PIC  X(45)    VALUE          03250099
032600             '*******   E N D   O F   R E P O R T   *******'.     03260099
032700         10  FILLER                  PIC  X(43)    VALUE SPACES.  03270099
032800     05  NO-DATA-TO-REPORT-LINE.                                  03280099
032900         10  FILLER                  PIC  X(40)    VALUE SPACES.  03290099
033000         10  FILLER                  PIC  X(52)    VALUE          03300099
033100         '*******  N O   D A T A   T O   R E P O R T   *******'.  03310099
033200         10  FILLER                  PIC  X(40)    VALUE SPACES.  03320099
033300*                                                                 03330099
033400*                                                                 03340099
033500***********************************************************       03350099
033600*  COPYBOOK USED BY CALENDAR ROUTINE                      *       03360099
033700***********************************************************       03370099
033800     COPY DPWS500.                                                03380099
033900*                                                                 03390099
034000*** DB2 MESSAGE AREAS ****                                        03400099
034100     COPY DPWS004.                                                03410099
034200*                                                                 03420099
034300*                                                                 03430099
034400     EXEC SQL                                                     03440099
034500          INCLUDE SQLCA                                           03450099
034600     END-EXEC.                                                    03460099
034700                                                                  03470099
034800     EXEC SQL                                                     03480099
034900          INCLUDE TCOCNTL                                         03490099
035000     END-EXEC.                                                    03500099
035100*                                                                 03510099
035200*                                                                 03520099
035300******************************************************************03530099
035400 PROCEDURE DIVISION.                                              03540099
035500******************************************************************03550099
035600*                                                                 03560099
035700******************************************************************03570099
035800**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                    **03580099
035900******************************************************************03590099
036000 0000-MAINLINE-PROCESSING.                                        03600099
036100     PERFORM 1000-INITIALIZE.                                     03610099
036200*                                                                 03620099
036300     IF  PS-END-OF-FILE                                           03630099
036400         NEXT SENTENCE                                            03640099
036500     ELSE                                                         03650099
036600         SET PS-FIRST-TIME-NO TO TRUE                             03660099
036700         PERFORM 2000-MAIN-PROCESS                                03670099
036800           UNTIL  PS-END-OF-FILE                                  03680099
036900     END-IF.                                                      03690099
037000*                                                                 03700099
037100     PERFORM 9000-END-PROCESS.                                    03710099
037200*                                                                 03720099
037300     DISPLAY 'NUMBER OF RECORDS READ IS:     '                    03730099
037400         WS-RECORDS-READ-QTY.                                     03740099
037500     DISPLAY 'NUMBER OF RECORDS WRITTEN IS:  '                    03750099
037600         WS-RECORDS-WRITE-QTY.                                    03760099
037700*                                                                 03770099
037800     STOP RUN.                                                    03780099
037900*                                                                 03790099
038000*                                                                 03800099
038100******************************************************************03810099
038200**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM. **            03820099
038300******************************************************************03830099
038400 1000-INITIALIZE.                                                 03840099
038500                                                                  03850099
038600     ACCEPT PV-TODAYS-DATE FROM DATE.                             03860099
038700     ACCEPT PV-TODAYS-TIME FROM TIME.                             03870099
038800                                                                  03880099
038900*GET CURRENT DATE                                                 03890099
039000     EXEC SQL                                                     03900099
039100         SELECT  CURRENT DATE                                     03910099
039200           INTO  :PV-CURRENT-DB2-DATE                             03920099
039300           FROM  TCOCNTL                                          03930099
039400          WHERE  OPER_UNT_ID = 90                                 03940099
039500     END-EXEC.                                                    03950099
039600                                                                  03960099
039700     EVALUATE TRUE                                                03970099
039800         WHEN SQLCODE = ZERO                                      03980099
039900             MOVE PV-CURRENT-DB2-DATE    TO PV-CURR-DATE          03990099
040000             MOVE PV-CURRENT-DB2-CC      TO PV-CURRENT-CC         04000099
040100             MOVE PV-CURRENT-DB2-YY      TO PV-CURRENT-YY         04010099
040200             MOVE PV-CURRENT-DB2-MM      TO PV-CURRENT-MM         04020099
040300             MOVE PV-CURRENT-DB2-DD      TO PV-CURRENT-DD         04030099
040400         WHEN OTHER                                               04040099
040500              MOVE '1000-INITIALIZE'      TO                      04050099
040600                                          PV-ABEND-PARA-NAME      04060099
040700              MOVE 'SET DATE   '       TO PV-DB2-OPERATION-MSG-1  04070099
040800              MOVE 'NONE   '           TO PV-DB2-TABLE-NAME       04080099
040900              PERFORM 9998-SQL-ABEND                              04090099
041000      END-EVALUATE.                                               04100099
041100                                                                  04110099
041200     ACCEPT CC-CONTROL-CARD-PARAMETERS FROM SYSIN.                04120099
041300                                                                  04130099
041400     DISPLAY 'CONTROL CARD SET-UP FOR THIS RUN IS:  '             04140099
041500             CC-CONTROL-CARD-PARAMETERS.                          04150099
041600                                                                  04160099
041700     PERFORM 1100-CHECK-CC-PARAMETERS THRU 1100-EXIT.             04170099
041800     PERFORM 1200-SET-DATABASE-KEYS.                              04180099
041900*                                                                 04190099
042000     OPEN INPUT  CE-FILE                                          04200099
042100          OUTPUT CE-REPORT-FILE.                                  04210099
042200*                                                                 04220099
042300     PERFORM 1150-INITIALIZE-HEADINGS.                            04230099
042400*                                                                 04240099
042500*READ FIRST INPUT RECORD.                                         04250099
042600     PERFORM 7000-READ-EXTRACT.                                   04260099
042700     SET PS-FIRST-TIME-YES TO TRUE.                               04270099
042800     PERFORM 6999-PRINT-REPORT-HEADINGS.                          04280099
042900*                                                                 04290099
043000*                                                                 04300099
043100 1100-CHECK-CC-PARAMETERS.                                        04310099
043200     MOVE '1100-CHECK-CC-PARAMETERS'   TO PV-PARA-NAME            04320099
043300                                                                  04330099
043400     IF NOT CC-VALID-MODE-IND                                     04340099
043500        DISPLAY '***************************'                     04350099
043600        DISPLAY 'CONTROL PARAMETERS: '                            04360099
043700                 CC-CONTROL-CARD-PARAMETERS                       04370099
043800        DISPLAY 'MODE INDICATOR "' CC-MODE-IND '"'                04380099
043900                ' IS INVALID.'                                    04390099
044000        DISPLAY 'RUN ENDED'                                       04400099
044100        DISPLAY '***************************'                     04410099
044200        MOVE 4003  TO PV-ABEND-CODE                               04420099
044300        PERFORM 9999-END                                          04430099
044400     END-IF                                                       04440099
044500                                                                  04450099
044600     IF NOT CC-VALID-TIMEFRAME-IND                                04460099
044700        DISPLAY '***************************'                     04470099
044800        DISPLAY 'CONTROL PARAMETERS: '                            04480099
044900                 CC-CONTROL-CARD-PARAMETERS                       04490099
045000        DISPLAY 'TIME INDICATOR "' CC-TIMEFRAME-IND '"'           04500099
045100                ' IS INVALID.'                                    04510099
045200        DISPLAY 'RUN ENDED'                                       04520099
045300        DISPLAY '***************************'                     04530099
045400        MOVE 4003  TO PV-ABEND-CODE                               04540099
045500        PERFORM 9999-END                                          04550099
045600     END-IF                                                       04560099
045700                                                                  04570099
045800     IF CC-BEG-DATE IS  = PC-DEFAULT-CC-DATE AND                  04580099
045900        CC-END-DATE IS  = PC-DEFAULT-CC-DATE                      04590099
046000        SET PS-NORMAL-RUN           TO TRUE                       04600099
046100        GO TO 1100-EXIT                                           04610099
046200     END-IF.                                                      04620099
046300                                                                  04630099
046400     SET PS-SPECIAL-RUN    TO TRUE                                04640099
046500                                                                  04650099
046600     MOVE CC-BEG-YYYY      TO PV-BEG-YYYY                         04660099
046700     MOVE CC-BEG-MM        TO PV-BEG-MM                           04670099
046800     MOVE CC-BEG-DD        TO PV-BEG-DD                           04680099
046900     MOVE CC-END-YYYY      TO PV-END-YYYY                         04690099
047000     MOVE CC-END-MM        TO PV-END-MM                           04700099
047100     MOVE CC-END-DD        TO PV-END-DD                           04710099
047200                                                                  04720099
047300     IF  PV-BEG-DATE IS NOT < PV-END-DATE  AND                    04730099
047400         PV-BEG-DATE IS NOT = PV-END-DATE                         04740099
047500         DISPLAY '***************************'                    04750099
047600         DISPLAY 'CONTROL PARAMETERS: '                           04760099
047700                  CC-CONTROL-CARD-PARAMETERS                      04770099
047800         DISPLAY                                                  04780099
047900           'THE BEGINNING DATE MUST BE LESS THAN OR EQUAL TO THE E04790099
048000-          'NDING DATE'                                           04800099
048100         DISPLAY 'RUN ENDED'                                      04810099
048200         DISPLAY '***************************'                    04820099
048300         MOVE 4003  TO PV-ABEND-CODE                              04830099
048400         PERFORM 9999-END                                         04840099
048500     END-IF                                                       04850099
048600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              04860099
048700     SET DPG51-FISCAL-454-CALENDAR TO TRUE                        04870099
048800     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                      04880099
048900     SET DPG52-LK-DTE-GREG-CC        TO TRUE                      04890099
049000                                                                  04900099
049100     MOVE PV-BEG-CC                  TO PV-DATE-AREA-CC           04910099
049200     MOVE PV-BEG-YY                  TO PV-DATE-AREA-YY           04920099
049300     MOVE PV-BEG-MM                  TO PV-DATE-AREA-MM           04930099
049400     MOVE PV-BEG-DD                  TO PV-DATE-AREA-DD           04940099
049500     MOVE PV-DATE-AREA               TO DPG52-LK-DATE-INPUT       04950099
049600     DISPLAY 'JUST BEFORE CALL TO 9100 IN PARA 1100'              04960099
049700     PERFORM 9100-CALL-DATE-MODULE THRU 9100-EXIT                 04970099
049800     DISPLAY 'JUST AFTER  CALL TO 9100 IN PARA 1100'              04980099
049900                                                                  04990099
050000     IF DPG54-DATE-INVALID                                        05000099
050100        DISPLAY '***************************'                     05010099
050200        DISPLAY 'CONTROL PARAMETERS: '                            05020099
050300                 CC-CONTROL-CARD-PARAMETERS                       05030099
050400        DISPLAY 'BEGINNING DATE  '                                05040099
050500                CC-BEG-DATE                                       05050099
050600                ' IS INVALID.'                                    05060099
050700        DISPLAY 'RUN ENDED'                                       05070099
050800        DISPLAY '***************************'                     05080099
050900        MOVE 4003  TO PV-ABEND-CODE                               05090099
051000        PERFORM 9999-END                                          05100099
051100     END-IF.                                                      05110099
051200                                                                  05120099
051300     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              05130099
051400     SET DPG51-FISCAL-454-CALENDAR   TO TRUE                      05140099
051500     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                      05150099
051600     SET DPG52-LK-DTE-GREG-CC        TO TRUE                      05160099
051700                                                                  05170099
051800     MOVE PV-END-CC                  TO PV-DATE-AREA-CC           05180099
051900     MOVE PV-END-YY                  TO PV-DATE-AREA-YY           05190099
052000     MOVE PV-END-MM                  TO PV-DATE-AREA-MM           05200099
052100     MOVE PV-END-DD                  TO PV-DATE-AREA-DD           05210099
052200     MOVE PV-DATE-AREA               TO DPG52-LK-DATE-INPUT       05220099
052300                                                                  05230099
052400     PERFORM 9100-CALL-DATE-MODULE THRU 9100-EXIT                 05240099
052500                                                                  05250099
052600     IF DPG54-DATE-INVALID                                        05260099
052700        DISPLAY '***************************'                     05270099
052800        DISPLAY 'CONTROL PARAMETERS: '                            05280099
052900                 CC-CONTROL-CARD-PARAMETERS                       05290099
053000        DISPLAY 'ENDING DATE '                                    05300099
053100                CC-END-DATE                                       05310099
053200                ' IS INVALID.'                                    05320099
053300        DISPLAY 'RUN ENDED'                                       05330099
053400        DISPLAY '***************************'                     05340099
053500        MOVE 4003  TO PV-ABEND-CODE                               05350099
053600        PERFORM 9999-END                                          05360099
053700     END-IF.                                                      05370099
053800 1100-EXIT.  EXIT.                                                05380099
053900*                                                                 05390099
054000*                                                                 05400099
054100******************************************************************05410099
054200*   INITIALIZE REPORT HEADINGS.                                  *05420099
054300******************************************************************05430099
054400 1150-INITIALIZE-HEADINGS.                                        05440099
054500     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              05450099
054600     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             05460099
054700     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               05470099
054800     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              05480099
054900     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            05490099
055000     MOVE PC-PROGRAM-NAME        TO DP132O-PROGRAM-NAME.          05500099
055100     MOVE PC-1                   TO DP132O-REPORT-NUMBER.         05510099
055200*                                                                 05520099
055300*                                                                 05530099
055400 1200-SET-DATABASE-KEYS.                                          05540099
055500     IF PS-NORMAL-RUN                                             05550099
055600        PERFORM 1210-DETERMINE-DATE-RANGE                         05560099
055700     ELSE                                                         05570099
055800        MOVE CC-BEG-DATE         TO PV-START-EXTRACT              05580099
055900        MOVE CC-END-DATE         TO PV-END-EXTRACT                05590099
056000     END-IF.                                                      05600099
056100************************************************************      05610099
056200     DISPLAY 'EXTRACT START:  ' PV-START-EXTRACT                  05620099
056300      '       EXTRACT END  :  ' PV-END-EXTRACT                    05630099
056400      '       FISCAL DATE  :  ' DPG56-LAST-FP-DB2-ISO-FMT.        05640099
056500************************************************************      05650099
056600*                                                                 05660099
056700*                                                                 05670099
056800 1210-DETERMINE-DATE-RANGE.                                       05680099
056900     EVALUATE TRUE                                                05690099
057000       WHEN CC-MONTHLY-EXTRACT                                    05700099
057100                PERFORM 1213-MONTHLY-RPT-DTE-RANGE                05710099
057200     END-EVALUATE.                                                05720099
057300*                                                                 05730099
057400*                                                                 05740099
057500 1213-MONTHLY-RPT-DTE-RANGE.                                      05750099
057600     MOVE '1213-MONTHLY-RPT-DTE-RANGE'  TO PV-PARA-NAME           05760099
057700*** GET START/END DATES OF THE PREVIOUS MONTH.                    05770099
057800     MOVE   PV-CURRENT-CC      TO  PV-DATE-AREA-CC                05780099
057900     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY                05790099
058000     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM                05800099
058100     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD                05810099
058200     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56               05820099
058300     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT            05830099
058400                                                                  05840099
058500     DISPLAY 'PV-DATE-AREA '    PV-DATE-AREA.                     05850099
058600     DISPLAY 'PV-CURRENT-DATE ' PV-CURRENT-DATE.                  05860099
058700                                                                  05870099
058800     MOVE PC-28                TO DPG51-INCR-DECR-DAYS-9          05880099
058900                                                                  05890099
059000     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      05900099
059100     SET DPG51-DECREMENT-DATE       TO TRUE.                      05910099
059200     SET DPG52-LK-DTE-GREG-CC       TO TRUE.                      05920099
059300                                                                  05930099
059400     PERFORM 9100-CALL-DATE-MODULE THRU 9100-EXIT.                05940099
059500     MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO                           05950099
059600                                  PV-START-EXTRACT                05960099
059700     MOVE DPG56-LAST-FP-DB2-ISO-FMT  TO                           05970099
059800                                  PV-END-EXTRACT.                 05980099
059900     DISPLAY 'FIRST FISC PERIOD DAY ' DPG56-FIRST-FP-DB2-ISO-FMT. 05990099
060000     DISPLAY 'LAST FISC PERIOD DAY '  DPG56-LAST-FP-DB2-ISO-FMT.  06000099
060100*                                                                 06010099
060200******************************************************************06020099
060300*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *06030099
060400*  RECAP OF CENTRAL STOCK BATCHES FOR MONTH-END REPORT.          *06040099
060500******************************************************************06050099
060600 2000-MAIN-PROCESS.                                               06060099
060700                                                                  06070099
060800     PERFORM 3000-PROCESS-DETAIL-RECORD.                          06080099
060900                                                                  06090099
061000*READ NEXT INPUT RECORD.                                          06100099
061100     ADD  +1                    TO WS-RECORDS-WRITE-QTY.          06110099
061200     PERFORM 7000-READ-EXTRACT.                                   06120099
061300     ADD  +1                    TO WS-RECORDS-READ-QTY.           06130099
061400*                                                                 06140099
061500*                                                                 06150099
061600 3000-PROCESS-DETAIL-RECORD.                                      06160099
061700     MOVE CE013-BATCH-NMBR       TO DL1-BATCH-NMBR.               06170099
061800     MOVE CE013-TOTAL-QTY        TO DL1-DIST-UNITS.               06180099
061900     MOVE CE013-DISTR-RETAIL     TO DL1-DIST-RETAIL.              06190099
062000                                                                  06200099
062100     ADD CE013-TOTAL-QTY         TO PV-TOTAL-DIST-UNITS.          06210099
062200     ADD CE013-DISTR-RETAIL      TO PV-TOTAL-DIST-RETAIL.         06220099
062300                                                                  06230099
062400     PERFORM 6000-PRINT-REPORT-DETAIL.                            06240099
062500*                                                                 06250099
062600*                                                                 06260099
062700******************************************************************06270099
062800*     WRITES THE DETAIL LINE INFO FOR THE MAIN REPORT.           *06280099
062900******************************************************************06290099
063000 6000-PRINT-REPORT-DETAIL.                                        06300099
063100         IF  PV-LINE-CNT > PC-55                                  06310099
063200             PERFORM 6999-PRINT-REPORT-HEADINGS                   06320099
063300         END-IF.                                                  06330099
063400*                                                                 06340099
063500         MOVE CE013-BTCH-PRC-DTE      TO WS-BATCH-PROC-DATE.      06350099
063600         MOVE WS-BATCH-PROC-MM        TO DL1-BATCH-PROC-MM.       06360099
063700         MOVE WS-BATCH-PROC-DD        TO DL1-BATCH-PROC-DD.       06370099
063800         MOVE WS-BATCH-PROC-CC        TO DL1-BATCH-PROC-CC.       06380099
063900         MOVE WS-BATCH-PROC-YY        TO DL1-BATCH-PROC-YY.       06390099
064000*                                                                 06400099
064100         WRITE CE-REPORT-RECORD                                   06410099
064200           FROM REPORT-DETAIL-LINE                                06420099
064300             AFTER ADVANCING 1 LINE                               06430099
064400         ADD PC-2            TO PV-LINE-CNT.                      06440099
064500         INITIALIZE REPORT-DETAIL-LINE.                           06450099
064600*                                                                 06460099
064700*                                                                 06470099
064800******************************************************************06480099
064900*     PRINTS THE TOTALS LINES FOR THE MAIN REPORT.               *06490099
065000******************************************************************06500099
065100 6850-PRINT-REPORT-TOTALS.                                        06510099
065200                                                                  06520099
065300     MOVE PV-TOTAL-DIST-UNITS    TO TL1-TOTAL-DIST-UNITS.         06530099
065400     MOVE PV-TOTAL-DIST-RETAIL   TO TL1-TOTAL-DIST-RETAIL.        06540099
065500                                                                  06550099
065600     WRITE CE-REPORT-RECORD                                       06560099
065700       FROM BL-BLANK-LINE                                         06570099
065800         AFTER ADVANCING 2 LINES.                                 06580099
065900*                                                                 06590099
066000     WRITE CE-REPORT-RECORD                                       06600099
066100       FROM REPORT-TOTALS-LINE                                    06610099
066200         AFTER ADVANCING 2 LINES.                                 06620099
066300*                                                                 06630099
066400     WRITE CE-REPORT-RECORD                                       06640099
066500       FROM BL-BLANK-LINE                                         06650099
066600         AFTER ADVANCING 2 LINES.                                 06660099
066700*                                                                 06670099
066800*                                                                 06680099
066900     MOVE ZEROS TO PV-TOTAL-DIST-UNITS.                           06690099
067000     MOVE ZEROS TO PV-TOTAL-DIST-RETAIL.                          06700099
067100*                                                                 06710099
067200*                                                                 06720099
067300******************************************************************06730099
067400*  PRINTS NO DETAIL LINE AND END OF REPORT LINES.                *06740099
067500******************************************************************06750099
067600 6900-NO-DETAIL.                                                  06760099
067700     WRITE CE-REPORT-RECORD                                       06770099
067800       FROM NO-DATA-TO-REPORT-LINE                                06780099
067900         AFTER ADVANCING 3 LINES.                                 06790099
068000*                                                                 06800099
068100*                                                                 06810099
068200******************************************************************06820099
068300*  PRINTS REPORT HEADINGS FOR THE MAIN REPORT.                   *06830099
068400******************************************************************06840099
068500 6999-PRINT-REPORT-HEADINGS.                                      06850099
068600                                                                  06860099
068700     ADD 1                        TO PV-PAGE-CNT.                 06870099
068800     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          06880099
068900*                                                                 06890099
069000     WRITE CE-REPORT-RECORD                                       06900099
069100       FROM DP132O-STANDRD-HEADER-132-COLS                        06910099
069200         AFTER ADVANCING PAGE.                                    06920099
069300*                                                                 06930099
069400     WRITE CE-REPORT-RECORD                                       06940099
069500       FROM BL-BLANK-LINE                                         06950099
069600         AFTER ADVANCING 1 LINE.                                  06960099
069700*                                                                 06970099
069800     MOVE DPG56-LAST-FP-DB2-ISO-FMT-MO TO HL1-MONTH-END-MM.       06980099
069900     MOVE DPG56-LAST-FP-DB2-ISO-FMT-DY TO HL1-MONTH-END-DD.       06990099
070000     MOVE DPG56-LAST-FP-DB2-ISO-FMT-YR TO HL1-MONTH-END-YR.       07000099
070100                                                                  07010099
070200     WRITE CE-REPORT-RECORD                                       07020099
070300       FROM HEADING-LINE1                                         07030099
070400         AFTER ADVANCING 2 LINES.                                 07040099
070500*                                                                 07050099
070600     WRITE CE-REPORT-RECORD                                       07060099
070700       FROM BL-BLANK-LINE                                         07070099
070800         AFTER ADVANCING 1 LINE.                                  07080099
070900*                                                                 07090099
071000     WRITE CE-REPORT-RECORD                                       07100099
071100       FROM BL-BLANK-LINE                                         07110099
071200         AFTER ADVANCING 2 LINES.                                 07120099
071300*                                                                 07130099
071400     WRITE CE-REPORT-RECORD                                       07140099
071500       FROM HEADING-LINE2                                         07150099
071600         AFTER ADVANCING 1 LINE.                                  07160099
071700*                                                                 07170099
071800     WRITE CE-REPORT-RECORD                                       07180099
071900       FROM HEADING-LINE3.                                        07190099
072000*                                                                 07200099
072100     WRITE CE-REPORT-RECORD                                       07210099
072200       FROM HEADING-LINE4.                                        07220099
072300*                                                                 07230099
072400     MOVE SPACES TO CE-REPORT-RECORD.                             07240099
072500     WRITE CE-REPORT-RECORD                                       07250099
072600         AFTER ADVANCING 1 LINE.                                  07260099
072700*                                                                 07270099
072800     MOVE PC-10           TO PV-LINE-CNT.                         07280099
072900*                                                                 07290099
073000*                                                                 07300099
073100 7000-READ-EXTRACT.                                               07310099
073200     READ CE-FILE INTO CE013-CENTRAL-STK-RPT-RECORD               07320099
073300        AT END                                                    07330099
073400           SET PS-END-OF-FILE TO TRUE                             07340099
073500     END-READ.                                                    07350099
073600*                                                                 07360099
073700*                                                                 07370099
073800******************************************************************07380099
073900*     CLOSE FILES.                                              **07390099
074000******************************************************************07400099
074100 9000-END-PROCESS.                                                07410099
074200     PERFORM 6850-PRINT-REPORT-TOTALS.                            07420099
074300*                                                                 07430099
074400     IF PS-END-OF-FILE AND                                        07440099
074500        PS-FIRST-TIME-YES                                         07450099
074600           PERFORM 6900-NO-DETAIL                                 07460099
074700     END-IF.                                                      07470099
074800                                                                  07480099
074900     WRITE CE-REPORT-RECORD                                       07490099
075000       FROM END-OF-REPORT-LINE                                    07500099
075100         AFTER ADVANCING 3 LINES.                                 07510099
075200                                                                  07520099
075300     CLOSE CE-FILE                                                07530099
075400           CE-REPORT-FILE.                                        07540099
075500*                                                                 07550099
075600*                                                                 07560099
075700 9100-CALL-DATE-MODULE.                                           07570099
075800     CALL DP500-KOHLS-CALENDAR-ROUTINE                            07580099
075900                           USING DPG51 DPG52 DPG53                07590099
076000                                 DPG54 DPG55 DPG56.               07600099
076100     IF  PV-PARA-NAME = '1100-CHECK-CC-PARAMETERS'                07610099
076200         IF DPG54-DATE-INVALID                                    07620099
076300            GO TO 9100-EXIT                                       07630099
076400         END-IF                                                   07640099
076500     END-IF                                                       07650099
076600                                                                  07660099
076700     EVALUATE TRUE                                                07670099
076800         WHEN DPG54-SEVERE-ERROR                                  07680099
076900             DISPLAY '** ABEND **'                                07690099
077000             DISPLAY '** PGM = CEKRP008'                          07700099
077100             DISPLAY PV-PARA-NAME                                 07710099
077200             DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE. '  07720099
077300             DISPLAY '** ERROR MESSAGE = '                        07730099
077400                     DPG54-ERROR-MESSAGE                          07740099
077500             DISPLAY '** DPG51 = ' DPG51                          07750099
077600             DISPLAY '** DPG52 = ' DPG52                          07760099
077700             DISPLAY '** DPG53 = ' DPG53                          07770099
077800             DISPLAY '** DPG54 = ' DPG54                          07780099
077900             MOVE +4003 TO PV-ABEND-CODE                          07790099
078000             CALL 'ILBOABN0' USING PV-ABEND-CODE                  07800099
078100         WHEN OTHER                                               07810099
078200             CONTINUE                                             07820099
078300     END-EVALUATE.                                                07830099
078400 9100-EXIT.  EXIT.                                                07840099
078500*                                                                 07850099
078600*                                                                 07860099
078700 9998-SQL-ABEND.                                                  07870099
078800     MOVE SQLCODE     TO PV-SQLCODE.                              07880099
078900     DISPLAY '** ABEND           ** = SQLABEND'.                  07890099
079000     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          07900099
079100     DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARA-NAME        07910099
079200     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME.        07920099
079300     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MSG-1.   07930099
079400     DISPLAY '**                 ** = ' PV-DB2-OPERATION-MSG-2.   07940099
079500     DISPLAY '** SQLCODE         ** = ' PV-SQLCODE.               07950099
079600     COPY DPPD004.                                                07960099
079700                                                                  07970099
079800     MOVE +4013                  TO PV-ABEND-CODE.                07980099
079900     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       07990099
080000*                                                                 08000099
080100*                                                                 08010099
080200 9999-END.                                                        08020099
080300      DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE                    08030099
080400      CALL 'ILBOABN0'   USING PV-ABEND-CODE.                      08040099
