000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             PCKUT112.                                00050000
000600 AUTHOR.                 DENISE HAHN.                             00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            NOVEMBER 2014                            00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200* THIS MODULE WILL CREATE A FLAT FILE OF CLOSED STORES THAT WILL  00120000
001300* BE USED TO UNLOAD DATA FROM THE PCT_TRN_CLSN_DTL TABLE.         00130000
001400******************************************************************00140000
001500                                                                  00150000
001600******************************************************************00160000
001700 ENVIRONMENT DIVISION.                                            00170000
001800                                                                  00180000
001900 CONFIGURATION SECTION.                                           00190000
001910                                                                  00191000
001920 SOURCE-COMPUTER.  IBM-3090.                                      00192000
001930 OBJECT-COMPUTER.  IBM-3090.                                      00193000
001940                                                                  00194000
001950 INPUT-OUTPUT SECTION.                                            00195000
001960                                                                  00196000
001970 FILE-CONTROL.                                                    00197000
001980                                                                  00198000
001990     SELECT PCRD077-STORE-NBR-FILE                                00199000
001991         ASSIGN TO INP01.                                         00199100
001992                                                                  00199200
001993     SELECT STORE-NBR-OUTPUT-FILE                                 00199300
001994         ASSIGN TO OUT01.                                         00199400
001995                                                                  00199500
001996 EJECT                                                            00199600
001997******************************************************************00199700
001998                                                                  00199800
001999******************************************************************00199900
002000 DATA DIVISION.                                                   00200000
002100                                                                  00210000
002200 FILE SECTION.                                                    00220000
002300                                                                  00230000
002310 FD  PCRD077-STORE-NBR-FILE                                       00231000
002320     RECORDING MODE IS F                                          00232000
002330     LABEL RECORDS ARE STANDARD                                   00233000
002340     BLOCK CONTAINS 0 RECORDS.                                    00234000
002350                                                                  00235000
002360 01  PCRD077-STORE-NBR-RECORD       PIC X(80).                    00236000
002370                                                                  00237000
002380 FD  STORE-NBR-OUTPUT-FILE                                        00238000
002390     RECORDING MODE IS F                                          00239000
002391     LABEL RECORDS ARE STANDARD                                   00239100
002392     BLOCK CONTAINS 0 RECORDS.                                    00239200
002393                                                                  00239300
002394 01  STORE-NBR-OUTPUT-RECORD        PIC X(80).                    00239400
002395                                                                  00239500
002396                                                                  00239600
002397******************************************************************00239700
002398                                                                  00239800
002399******************************************************************00239900
002400 WORKING-STORAGE SECTION.                                         00240000
002500******************************************************************00250000
002600                                                                  00260000
002700 01  PC-PROGRAM-CONSTANTS.                                        00270000
002800     05  PC-CURRENT-PROGRAM-NAME         PIC X(08)                00280000
002900                                                 VALUE 'PCKUT112'.00290000
003000                                                                  00300000
003100 01  PS-PROGRAM-SWITCHES.                                         00310000
003200     05  PS-END-OF-STORE-FILE-SW         PIC X(01)  VALUE 'N'.    00320000
003300         88  PS-END-OF-STORE-FILE                   VALUE 'Y'.    00330000
003400         88  PS-NOT-END-OF-STORE-FILE               VALUE 'N'.    00340000
003500     05  PS-FIRST-RECORD-SW              PIC X(01)  VALUE 'N'.    00350000
003600         88  PS-FIRST-RECORD                        VALUE 'Y'.    00360000
003700         88  PS-NOT-FIRST-RECORD                    VALUE 'N'.    00370000
003800                                                                  00380000
003900 01  PV-PROGRAM-VARIABLES.                                        00390000
004000     05  PV-STORE-RECS-READ              PIC 9(03) VALUE ZERO.    00400000
004100     05  PV-STORE-RECS-WRITTEN           PIC 9(03) VALUE ZERO.    00410000
004200     05  PV-STORE-NBR-N                  PIC 9(04) VALUE ZERO.    00420000
004300     05  PV-STORE-NBR-ZZZ9               PIC ZZZ9.                00430000
004400                                                                  00440000
004500***************************************************************** 00450000
004600*    OUTPUT FILE RECORD                                           00460000
004700***************************************************************** 00470000
004800 01  OUT-OUTPUT-FILE-RECORD.                                      00480000
004900     05  FILLER                          PIC  X(17) VALUE SPACES. 00490000
005000     05  OUT-STORE-NBR                   PIC  X(05) VALUE SPACES. 00500000
005100     05  FILLER                          PIC  X(58) VALUE SPACES. 00510000
005200                                                                  00520000
005300*----------------------------------------------------------------*00530000
005400*  INTRANSIT UNLOAD FILE (CONTAINS STORE NUMBERS)                 00540000
005500*----------------------------------------------------------------*00550000
005600     COPY PCRD077.                                                00560000
005700                                                                  00570000
005800******************************************************************00580000
005900 PROCEDURE DIVISION.                                              00590000
006000******************************************************************00600000
006100 0000-PROGRAM-MAINLINE.                                           00610000
006200                                                                  00620000
006300     INITIALIZE PV-PROGRAM-VARIABLES.                             00630000
006400                                                                  00640000
006500     OPEN INPUT  PCRD077-STORE-NBR-FILE                           00650000
006600          OUTPUT STORE-NBR-OUTPUT-FILE.                           00660000
006700                                                                  00670000
006800     SET PS-NOT-END-OF-STORE-FILE                                 00680000
006900         PS-FIRST-RECORD          TO TRUE.                        00690000
007000                                                                  00700000
007100     PERFORM 7000-READ-STORE-INPUT.                               00710000
007200                                                                  00720000
007300     PERFORM 2000-PROCESS-STORE-RECS                              00730000
007400         UNTIL PS-END-OF-STORE-FILE .                             00740000
007500                                                                  00750000
007600     PERFORM 3000-TERMINATE.                                      00760000
007700                                                                  00770000
007800     STOP RUN.                                                    00780000
007900                                                                  00790000
008000******************************************************************00800000
008100*  PROCESS THE STORE RECORDS FROM THE INPUT FILE                 *00810000
008200******************************************************************00820000
008300 2000-PROCESS-STORE-RECS.                                         00830000
008400                                                                  00840000
008500     INITIALIZE OUT-OUTPUT-FILE-RECORD.                           00850000
008600     MOVE PC077-LOC-NBR TO PV-STORE-NBR-N.                        00860000
008700                                                                  00870000
008800     IF  PS-FIRST-RECORD                                          00880000
008900         SET PS-NOT-FIRST-RECORD TO TRUE                          00890000
009000         MOVE PV-STORE-NBR-N     TO PV-STORE-NBR-ZZZ9             00900000
009100         STRING ' '               DELIMITED BY SIZE               00910000
009200                PV-STORE-NBR-ZZZ9 DELIMITED BY SIZE               00920000
009300                               INTO OUT-STORE-NBR                 00930000
009400     ELSE                                                         00940000
009500         MOVE PV-STORE-NBR-N     TO PV-STORE-NBR-ZZZ9             00950000
009600         STRING ','               DELIMITED BY SIZE               00960000
009700                PV-STORE-NBR-ZZZ9 DELIMITED BY SIZE               00970000
009800                               INTO OUT-STORE-NBR                 00980000
009900     END-IF.                                                      00990000
010000                                                                  01000000
010100     PERFORM 8000-WRITE-STORE-OUTPUT.                             01010000
010200                                                                  01020000
010300     PERFORM 7000-READ-STORE-INPUT.                               01030000
010400                                                                  01040000
010500 EJECT                                                            01050000
010600******************************************************************01060000
010700*  CLOSE FILES AND DISPLAY TOTALS OF RECORDS PROCESSED           *01070000
010800******************************************************************01080000
010900 3000-TERMINATE.                                                  01090000
011000                                                                  01100000
011100     CLOSE PCRD077-STORE-NBR-FILE                                 01110000
011200           STORE-NBR-OUTPUT-FILE.                                 01120000
011300                                                                  01130000
011400     DISPLAY '** PCKUT112 TOTALS **'.                             01140000
011500     DISPLAY '** STORE RECORDS READ...: ' PV-STORE-RECS-READ.     01150000
011600     DISPLAY '** STORE RECORDS WRITTEN: ' PV-STORE-RECS-WRITTEN.  01160000
011700                                                                  01170000
011800                                                                  01180000
011900******************************************************************01190000
012000*  READ A RECORD FROM THE STORE INPUT FILE                       *01200000
012100******************************************************************01210000
012200 7000-READ-STORE-INPUT.                                           01220000
012300                                                                  01230000
012400     READ PCRD077-STORE-NBR-FILE                                  01240000
012500         INTO PC077-CLO-STORE-REC                                 01250000
012600            AT END SET PS-END-OF-STORE-FILE TO TRUE.              01260000
012700                                                                  01270000
012800     IF  PS-NOT-END-OF-STORE-FILE                                 01280000
012900           ADD 1 TO PV-STORE-RECS-READ                            01290000
013000     END-IF.                                                      01300000
013100                                                                  01310000
013200 EJECT                                                            01320000
013300***************************************************************** 01330000
013400*  WRITE A RECORD TO THE STORE NUMBER OUTPUT FILE                 01340000
013500***************************************************************** 01350000
013600 8000-WRITE-STORE-OUTPUT.                                         01360000
013700                                                                  01370000
013800     WRITE STORE-NBR-OUTPUT-RECORD                                01380000
013900         FROM OUT-OUTPUT-FILE-RECORD.                             01390000
014000                                                                  01400000
014100     ADD 1                TO PV-STORE-RECS-WRITTEN.               01410000
014200                                                                  01420000
