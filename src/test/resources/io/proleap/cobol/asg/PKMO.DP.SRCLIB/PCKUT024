000510******************************************************************00051002
000520 IDENTIFICATION DIVISION.                                         00052002
000530******************************************************************00053002
000540                                                                  00054002
000550 PROGRAM-ID.    PCKUT024.                                         00055002
000560 AUTHOR.        TOM BOYD                                          00056002
000570 INSTALLATION.  KOHLS.                                            00057002
000580 DATE-WRITTEN   JULY 2002.                                        00058002
000590 DATE-COMPILED.                                                   00059002
000591                                                                  00059102
000592******************************************************************00059202
000593* THIS PROGRAM READS THE FILE CREATED IN THE STEP BEFORE, WHICH   00059306
000594* WILL BE USED AS AN INPUT FILE FOR THE YARD MANAGEMENT SYSTEM    00059406
000595* CREATED BY THE DC'S.  THIS PROGRAM CHECKS FOR A DATE OF         00059506
000596* 09/09/9999 AND MOVES A CONSTANT 'ENROUTE' TO THE DATE FIELD,    00059606
000597* OTHERWISE THE DATE IS LEFT ALONE, AND THE RECORD IS WRITTEN.    00059706
000599******************************************************************00059902
000600                                                                  00060002
000601******************************************************************00060102
000602 ENVIRONMENT DIVISION.                                            00060202
000603******************************************************************00060302
000604                                                                  00060402
000605 CONFIGURATION SECTION.                                           00060502
000606                                                                  00060602
000607 SOURCE-COMPUTER.        IBM-3090.                                00060702
000608 OBJECT-COMPUTER.        IBM-3090.                                00060802
000609                                                                  00060902
000610 INPUT-OUTPUT SECTION.                                            00061002
000611                                                                  00061102
000612 FILE-CONTROL.                                                    00061202
000613                                                                  00061302
000614     SELECT INPUT-FILE                                            00061402
000615         ASSIGN TO INP5.                                          00061506
000616                                                                  00061602
000617     SELECT OUTPUT-FILE                                           00061702
000618         ASSIGN TO OUT5.                                          00061806
000619                                                                  00061902
000620******************************************************************00062002
000621 DATA DIVISION.                                                   00062102
000622******************************************************************00062202
000623                                                                  00062302
000624 FILE SECTION.                                                    00062402
000625                                                                  00062502
000626 FD  INPUT-FILE                                                   00062602
000627     RECORDING MODE IS F                                          00062702
000628     LABEL RECORDS ARE STANDARD                                   00062802
000629     RECORD CONTAINS 254                                          00062909
000630     BLOCK CONTAINS 0 RECORDS                                     00063002
000631     DATA RECORD IS INPUT-RECORD.                                 00063102
000632                                                                  00063202
000633 01  INPUT-RECORD              PIC  X(254).                       00063308
000634                                                                  00063402
000635 FD  OUTPUT-FILE                                                  00063502
000636     RECORDING MODE IS F                                          00063602
000637     LABEL RECORDS ARE STANDARD                                   00063702
000638     RECORD CONTAINS 254                                          00063809
000639     BLOCK CONTAINS 0 RECORDS                                     00063902
000640     DATA RECORD IS OUTPUT-RECORD.                                00064002
000641                                                                  00064102
000642 01  OUTPUT-RECORD             PIC  X(254).                       00064208
000643                                                                  00064302
000644******************************************************************00064402
000645 WORKING-STORAGE SECTION.                                         00064502
000646******************************************************************00064602
000647 01  PS-PROGRAM-SWITCHES.                                         00064702
000648     05  PS-EOF-INPUT-SW              PIC X(01)  VALUE 'N'.       00064802
000649         88  PS-EOF-INPUT                        VALUE 'Y'.       00064902
000650         88  PS-NOT-EOF-INPUT                    VALUE 'N'.       00065002
000660                                                                  00066002
000661 01  PC-PROGRAM-CONSTANTS.                                        00066102
000662     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'PCKUT024'. 00066203
000663     05  PC-ENROUTE-DTE               PIC X(10) VALUE             00066303
000687                                                    '09/09/9999'. 00068703
000688     05  PC-ENROUTE                   PIC X(07) VALUE 'ENROUTE'.  00068803
000689     05  PC-SPACE                     PIC X(01) VALUE SPACES.     00068911
000690                                                                  00069011
000691 01  PV-PROGRAM-VARIABLES.                                        00069111
000692     05  PV-RECORDS-READ              PIC 9(09)     VALUE ZERO.   00069211
000700     05  PV-RECORDS-WRITTEN           PIC 9(09)     VALUE ZERO.   00070002
000751                                                                  00075102
000784******************************************************************00078402
000785*  COPYBOOK PCRD022.                                              00078502
000786******************************************************************00078602
000787     COPY PCRD022.                                                00078702
000888/                                                                 00088802
000889******************************************************************00088902
000890 PROCEDURE DIVISION.                                              00089002
000891******************************************************************00089102
000892                                                                  00089202
000893 0000-PROGRAM-MAINLINE.                                           00089302
000900*                                                                 00090002
001000     OPEN INPUT  INPUT-FILE                                       00100004
001100          OUTPUT OUTPUT-FILE                                      00110004
001110                                                                  00111003
001120     PERFORM 1000-READ-RECORD.                                    00112003
001121                                                                  00112103
001122     PERFORM 2000-PROCESS-RECORDS                                 00112203
001123        UNTIL PS-EOF-INPUT.                                       00112303
001130                                                                  00113003
001140     CLOSE INPUT-FILE                                             00114003
001150           OUTPUT-FILE                                            00115005
001151                                                                  00115103
001152     STOP RUN.                                                    00115203
001153                                                                  00115303
001154/                                                                 00115403
001160******************************************************************00116003
001170 1000-READ-RECORD.                                                00117003
001180******************************************************************00118003
001192                                                                  00119203
001193     READ INPUT-FILE                                              00119305
001194          INTO PC022-RECEIVER-EXT-RECORD                          00119405
001195         AT END                                                   00119503
001196            SET PS-EOF-INPUT           TO TRUE                    00119603
001197                                                                  00119705
001200         NOT AT END                                               00120003
001300            SET PS-NOT-EOF-INPUT       TO TRUE                    00130003
001400            ADD +1                     TO PV-RECORDS-READ         00140003
001410                                                                  00141005
001500     END-READ.                                                    00150003
001600                                                                  00160003
001700/                                                                 00170003
001800******************************************************************00180003
001900 2000-PROCESS-RECORDS.                                            00190003
002000******************************************************************00200003
002300                                                                  00230003
002400     IF PC022-RCVD-DTE EQUAL PC-ENROUTE-DTE                       00240003
002500        MOVE PC-ENROUTE                TO PC022-RCVD-DTE          00250004
002600     END-IF.                                                      00260003
002700                                                                  00270003
002701     MOVE SPACE TO  PC-SPACE.                                     00270110
002702     INSPECT PC022-ENT-NME       REPLACING ALL                    00270211
002703         ',' BY PC-SPACE.                                         00270311
002710                                                                  00271010
002730                                                                  00273010
002800     PERFORM 3000-WRITE-RECORD.                                   00280003
002900     PERFORM 1000-READ-RECORD.                                    00290003
003000                                                                  00300003
003100/                                                                 00310003
003200******************************************************************00320003
003300 3000-WRITE-RECORD.                                               00330003
003400******************************************************************00340003
003700                                                                  00370003
003800     WRITE OUTPUT-RECORD                                          00380003
003900        FROM PC022-RECEIVER-EXT-RECORD.                           00390003
004000        ADD +1   TO PV-RECORDS-WRITTEN.                           00400003
004100     PERFORM 4000-INITIALIZE-PC022.                               00410003
004200                                                                  00420003
004300/                                                                 00430003
004400******************************************************************00440003
004500 4000-INITIALIZE-PC022.                                           00450003
004600******************************************************************00460003
004900                                                                  00490003
004910     INITIALIZE PC022-RECEIVER-EXT-RECORD.                        00491003
004920     MOVE ','       TO   PC022-COMMA-1                            00492003
004930                         PC022-COMMA-2                            00493003
004940                         PC022-COMMA-3                            00494003
004950                         PC022-COMMA-4                            00495003
004960                         PC022-COMMA-5                            00496003
004970                         PC022-COMMA-6                            00497003
004980                         PC022-COMMA-7                            00498003
004990                         PC022-COMMA-8                            00499003
004991                         PC022-COMMA-9                            00499103
004992                         PC022-COMMA-10                           00499203
004993                         PC022-COMMA-11                           00499303
004994                         PC022-COMMA-12                           00499403
004995                         PC022-COMMA-13                           00499503
004996                         PC022-COMMA-14                           00499603
004997                         PC022-COMMA-15                           00499703
004998                         PC022-COMMA-16                           00499803
004999                         PC022-COMMA-17                           00499903
005000                         PC022-COMMA-18                           00500003
005001                         PC022-COMMA-19                           00500103
005002                         PC022-COMMA-20                           00500203
005003                         PC022-COMMA-21                           00500303
005004                         PC022-COMMA-22                           00500403
005005                         PC022-COMMA-23                           00500503
005006                         PC022-COMMA-24                           00500603
005007                         PC022-COMMA-25                           00500703
005008                         PC022-COMMA-26                           00500803
005009                         PC022-COMMA-27                           00500903
005010                         PC022-COMMA-28                           00501003
005011                         PC022-COMMA-29                           00501103
005012                         PC022-COMMA-30                           00501203
005013                         PC022-COMMA-31                           00501308
005014                         PC022-COMMA-32                           00501408
005015                         PC022-COMMA-33.                          00501508
005100                                                                  00510003
005200/                                                                 00520003
