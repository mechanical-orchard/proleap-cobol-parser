       IDENTIFICATION DIVISION.                                         00080000
       PROGRAM-ID.    EIKUP001.                                         00090000
       AUTHOR.        SIVA SRINIVASAN.                                  00100000
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00110000
       DATE-WRITTEN.  06/24/11.                                         00120000
       DATE-COMPILED.                                                   00130000
      ******************************************************************00140000
      *  MERCHANDISE LEDGER EDIT MODULE                                 00150000
      ******************************************************************00160000
      *  THIS PROGRAM IS COPY OF MLKUP021 . THE INPUT AND OUTPUT FILE   00170000
      *  LAYOUT IS MODIFIED TO HANDLE THE COPYBOOK MLRD044 USED BY      00170000
      *  TERADATA.                                                      00170000
      *  THE PROGRAM IS EXECUTED IN JOB  EIK053                         00170000
      ******************************************************************00180000
205464* 08/16/2018  JIM ARENDT          CHG0205464                      00180000
205464*             ADDED NEW 88 LEVEL IN WORKING STORAGE FOR '710'     00180000
205464              ERROR-BN-NON-RECEIPT-RTRN.                                  
205464******************************************************************00180000
                                                                        00990000
       ENVIRONMENT DIVISION.                                            01000000
       CONFIGURATION SECTION.                                           01010000
       INPUT-OUTPUT SECTION.                                            01020000
       FILE-CONTROL.                                                    01030000
                                                                        01040000
           SELECT COMPOSITE-FILE                                        01050000
               ASSIGN TO INP01.                                         01060000
                                                                        01070000
W40007*    SELECT CONTROL-CARD-FILE                                     01080000
W40007*        ASSIGN TO INP02.                                         01090000
                                                                        01100000
           SELECT PURCH-FILE                                            01110000
               ASSIGN TO OUT01.                                         01120000
                                                                        01130000
           SELECT SALE-FILE                                             01140000
               ASSIGN TO OUT02.                                         01150000
                                                                        01160000
           SELECT PRC-CHG-FILE                                          01170000
               ASSIGN TO OUT03.                                         01180000
                                                                        01190000
           SELECT ADJUSTMENT-FILE                                       01200000
               ASSIGN TO OUT04.                                         01210000
                                                                        01220000
           SELECT REPORT-FILE                                           01230000
               ASSIGN TO OUT05.                                         01240000
                                                                        01250000
           SELECT ERROR-FILE                                            01260000
               ASSIGN TO OUT06.                                         01270000
                                                                        01280000
W29145     SELECT DW-PRC-CHG-FILE                                       01170000
W29145         ASSIGN TO OUT07.                                         01180000
W28582                                                                  01190000
W28582     SELECT BV-PURCH-FILE                                         01170000
W28582         ASSIGN TO OUT08.                                         01180000
W28582                                                                  01190000
W28582     SELECT BV-PRC-CHG-FILE                                       01170000
W28582         ASSIGN TO OUT09.                                         01180000
                                                                        01190000
           SELECT AUDIT-REPORT-FILE                                     01290000
               ASSIGN TO RPT01.                                         01300000
                                                                        01310000
           SELECT EXCEPTIONS-REPORT-FILE                                01320000
               ASSIGN TO RPT02.                                         01330000
                                                                        01340000
       DATA DIVISION.                                                   01350000
       FILE SECTION.                                                    01360000
                                                                        01370000
       FD  COMPOSITE-FILE                                               01380000
           RECORDING  MODE IS F.                                        01390000
W26603 01  COMPOSITE-REC                    PIC X(200).                 01400000
                                                                        01410000
W40007*FD  CONTROL-CARD-FILE                                            01420000
W40007*    RECORDING  MODE IS F.                                        01430000
W40007*01  CONTROL-CARD-REC                 PIC X(80).                  01440000
                                                                        01450000
       FD  PURCH-FILE                                                   01460000
           RECORDING  MODE IS F                                         01470000
           BLOCK CONTAINS 0 RECORDS.                                    01480000
       01  PURCH-REC                        PIC X(150).                 01490000
                                                                        01500000
       FD  SALE-FILE                                                    01510000
           RECORDING  MODE IS F                                         01520000
           BLOCK CONTAINS 0 RECORDS.                                    01530000
       01  SALE-REC                         PIC X(80).                  01540000
                                                                        01550000
       FD  PRC-CHG-FILE                                                 01560000
           RECORDING  MODE IS F                                         01570000
           BLOCK CONTAINS 0 RECORDS.                                    01580000
W26606 01  PRC-CHG-REC                      PIC X(130).                 01590000
                                                                        01600000
       FD  ADJUSTMENT-FILE                                              01610000
           RECORDING  MODE IS F                                         01620000
           BLOCK CONTAINS 0 RECORDS.                                    01630000
       01  ADJUSTMENT-REC                   PIC X(90).                  01640000
                                                                        01650000
       FD  ERROR-FILE                                                   01660000
           RECORDING  MODE IS F                                         01670000
           BLOCK CONTAINS 0 RECORDS.                                    01680000
R26603 01  ERROR-REC                        PIC X(203).                 01691000
                                                                        01550000
       FD  DW-PRC-CHG-FILE                                              01560000
           RECORDING  MODE IS F                                         01570000
           BLOCK CONTAINS 0 RECORDS.                                    01580000
       01  DW-PRC-CHG-REC                   PIC X(200).                 01590000
                                                                        01700000
       FD  REPORT-FILE                                                  01710000
           RECORDING  MODE IS F                                         01720000
           BLOCK CONTAINS 0 RECORDS.                                    01730000
       01  REPORT-REC                       PIC X(80).                  01740000
                                                                        01750000
W28582 FD  BV-PRC-CHG-FILE                                              01710000
W28582     RECORDING  MODE IS F                                         01720000
W28582     BLOCK CONTAINS 0 RECORDS.                                    01730000
W28582 01  BV-PRC-CHG-REC                   PIC X(200).                 01740000
W28582                                                                  01750000
W28582 FD  BV-PURCH-FILE                                                01710000
W28582     RECORDING  MODE IS F                                         01720000
W28582     BLOCK CONTAINS 0 RECORDS.                                    01730000
W28582 01  BV-PURCH-REC                     PIC X(200).                 01740000
W28582                                                                  01750000
       FD  AUDIT-REPORT-FILE                                            01760000
           LABEL RECORDS ARE OMITTED                                    01770000
           RECORD CONTAINS 133 CHARACTERS                               01780000
           RECORDING  MODE IS F                                         01790000
           DATA RECORD IS AUDIT-LINE.                                   01800000
       01  AUDIT-LINE.                                                  01810000
           05  AUDIT-LINE-CC     PIC X(001).                            01820000
           05  AUDIT-LINE-DATA   PIC X(132).                            01830000
           05  FILLER REDEFINES  AUDIT-LINE-DATA.                       01840000
               10  FILLER        PIC X(131).                            01850000
               10  AUDIT-HEADER-FONT-INDICATOR                          01860000
                                 PIC X(001).                            01870000
                                                                        01880000
       FD  EXCEPTIONS-REPORT-FILE                                       01890000
           LABEL RECORDS ARE OMITTED                                    01900000
           RECORD CONTAINS 133 CHARACTERS                               01910000
           RECORDING  MODE IS F                                         01920000
           DATA RECORD IS EXCEPTIONS-LINE.                              01930000
       01  EXCEPTIONS-LINE.                                             01940000
           05  EXCEPTIONS-LINE-CC   PIC X(001).                         01950000
           05  EXCEPTIONS-LINE-DATA PIC X(132).                         01960000
           05  FILLER REDEFINES  EXCEPTIONS-LINE-DATA.                  01970000
               10  FILLER        PIC X(131).                            01980000
               10  EX-HEADER-FONT-INDICATOR                             01990000
                                 PIC X(001).                            02000000
       EJECT                                                            02010000
       WORKING-STORAGE SECTION.                                         02020000
                                                                        02030000
       01  CC-CONTROL-CARD.                                             02040000
W27261     05  CC-CALENDAR-TYPE                PIC X(02).               02050000
W27261     05  FILLER                          PIC X(01).               02050000
W27261*================================================================*        
W27261* FOR THE DAILY GROSS MARGIN RUNS CC-DGM-DATE-BEING-PROCESSED IS          
W27261* THE ACTUAL DATE OF THE DATA BEING PROCESSED. DAILY GROSS MARGIN         
W27261* RUNS USING JOBS MLK040 AND MKL041.                                      
W27261*================================================================*        
W27261     05  CC-DGM-DATE-BEING-PROCESSED     PIC X(10).               02050000
W27261     05  FILLER                          PIC X(01).               02050000
W27261     05  CC-PROCESSING-MODE              PIC X(04).               02060000
               88  CC-PROCESSING-MODE-VALID    VALUE 'ML'  'INV' 'BOTH'.02070000
               88  CC-PROCESSING-MODE-ML       VALUE 'ML'  'BOTH'.      02080000
               88  CC-PROCESSING-MODE-ML-ONLY  VALUE 'ML'.              02090000
               88  CC-PROCESSING-MODE-INV      VALUE 'INV' 'BOTH'.      02100000
               88  CC-PROCESSING-MODE-INV-ONLY VALUE 'INV'.             02110000
           05  FILLER                          PIC X.                   02120000
           05  CC-CHECK-INV-DATES-SW           PIC X.                   02130000
               88  CC-CHECK-INV-DATES-SW-VALID VALUE 'Y' 'N'.           02140000
               88  CC-CHECK-INV-DATES          VALUE 'Y'.               02150000
               88  CC-DONT-CHECK-INV-DATES     VALUE 'N'.               02160000
W27261     05  FILLER                          PIC X(01).               02161000
W27261*================================================================*02162000
W27261* CC-DAILY-CUTOFF-IND IS USED ONLY FOR THE DAILY GROSS MARGIN RUNS02163000
W27261* DURING CUTOFF WEEK.                                                     
W27261*================================================================*02164000
W27261     05  CC-DAILY-CUTOFF-IND             PIC X(01).               02165000
W27261         88  CC-DAILY-CUTOFF-IND-IS-VALID VALUE 'Y' 'N'.          02166000
W27261     05  FILLER                          PIC X(01).               02161000
W27261*================================================================*02162000
W27261* CC-DGM-RUN-IND IS USED TO REQUEST A DAILY GROSS MARGIN RUN. WHEN02163000
W27261* SET TO 'Y' CC-DGM-PROCESSING-DATE MUST BE PROVIDED.                     
W27261*================================================================*02164000
W27261     05  CC-DGM-RUN-IND                  PIC X(01).               02165000
W27261     05  FILLER                          PIC X(01).               02161000
W27261     05  FILLER                          PIC X(56).               02167000
                                                                        02180000
      ***************************************************************** 02190000
      *  INPUT COMPOSITE RECORD                                         02200000
      ***************************************************************** 02210000
W40007*    COPY MLRD020.                                                02220000
W40007     COPY MLRD044.                                                02230000
                                                                                
      ***************************************************************** 02240000
      *  PURCHASES                                                      02250000
      ***************************************************************** 02260000
           COPY MLRD021.                                                02270000
                                                                        02280000
      ***************************************************************** 02290000
      *  SALES                                                          02300000
      ***************************************************************** 02310000
           COPY MLRD022.                                                02320000
                                                                        02330000
      ***************************************************************** 02340000
      *  PRICE CHANGES                                                  02350000
      ***************************************************************** 02360000
           COPY MLRD023.                                                02370000
                                                                        02380000
W28582***************************************************************** 02340000
W28582*  BV PRICE CHANGES                                               02350000
W28582***************************************************************** 02360000
W28582     COPY MLRD029.                                                02370000
W28582                                                                  02380000
W28582***************************************************************** 02240000
W28582*  BV PURCHASES                                                   02250000
W28582***************************************************************** 02260000
W28582     COPY MLRD030.                                                02270000
W28582                                                                  02280000
      ***************************************************************** 02340000
      *  PRICE CHANGES FOR DATA WAREHOUSE (ORIG-CLR-DTE / MKDN-CDE)     02350000
      ***************************************************************** 02360000
           COPY MLRD033.                                                02370000
                                                                        02380000
      ***************************************************************** 02390000
      *  ADJUSTMENTS                                                    02400000
      ***************************************************************** 02410000
           COPY MLRD024.                                                02420000
                                                                        02430000
      ***************************************************************** 02440000
      *  EDIT/SPLIT REPORT                                              02450000
      ***************************************************************** 02460000
           COPY MLRD025.                                                02470000
                                                                        02480000
      ***************************************************************** 02490000
      *  ERROR FILE                                                     02500000
      ***************************************************************** 02510000
           COPY MLRD026.                                                02520000
                                                                        02530000
      ***************************************************************** 02540000
      *  ERROR CODES                                                    02550000
      ***************************************************************** 02560000
           COPY MLRD027.                                                02570000
                                                                        02580000
      ***************************************************************** 02590000
      *  STANDARD 133 BYTE REPORT HEADINGS                             *02600000
      ***************************************************************** 02610000
           COPY DPWS133O.                                               02620000
                                                                        02630000
                                                                        02640000
W40007***************************************************************** 02590000
W40007*  ERROR FILE LAYOUT-MLRD040 FIELDS + ERROR CODE.  LENGTH = 203  *02600000
W40007***************************************************************** 02610000
W40007 01  ERROR-PRICE-CHANGE-RECORD.                                   11/12/93
W40007     05  ERROR-PC-CDE                  PIC  X(1).                 MLRD044 
W40007         88  ERROR-VALID-PC-CDE        VALUE '4' '5'.                LV002
W40007         88  ERROR-MKDOWN              VALUE '4'.                 MLRD044 
W40007         88  ERROR-MKUP                VALUE '5'.                 MLRD044 
W40007     05  ERROR-PC-TYP-CDE              PIC  X(1).                 MLRD044 
W40007         88  ERROR-MARKDOWN            VALUE '1'.                 MLRD044 
W40007         88  ERROR-MARKDOWN-CANCEL     VALUE '2'.                 MLRD044 
W40007         88  ERROR-MARKUP              VALUE '3'.                 MLRD044 
W40007         88  ERROR-MARKUP-CANCEL       VALUE '4'.                 MLRD044 
W40007     05  ERROR-SLS-CORR-CDE            PIC  X(1).                 MLRD044 
W40007         88  ERROR-NORMAL-TRANS        VALUE ' '.                         
W40007         88  ERROR-SALES-AUDIT-CORR    VALUE 'S'.                         
W40007         88  ERROR-SYSTEM-LATE-CORR    VALUE 'L'.                         
W40007     05  ERROR-PC-DOC-5-NBR            PIC  X(5).                 MLRD044 
W40007     05  FILLER REDEFINES ERROR-PC-DOC-5-NBR.                     MLRD044 
W40007         10  ERROR-PC-DOC-5-DEPT       PIC  9(3).                 MLRD044 
W40007         10  ERROR-PC-DOC-5-DAY        PIC  9(2).                 MLRD044 
W40007     05  ERROR-PC-DTE.                                            MLRD044 
W40007         10  ERROR-PC-DTE-MM           PIC  9(2).                 MLRD044 
W40007         10  ERROR-PC-DTE-DD           PIC  9(2).                 MLRD044 
W40007     05  ERROR-PC-KOHLS-MM             PIC  X(2).                 MLRD044 
W40007     05  ERROR-PC-SKU                  PIC  X(8).                 MLRD044 
W40007     05  FILLER REDEFINES ERROR-PC-SKU.                           MLRD044 
W40007         10  FILLER                    PIC  9(5).                 MLRD044 
W40007         10  ERROR-PC-SEQ-NBR          PIC  9(3).                 MLRD044 
W40007     05  ERROR-PC-RSN-CDE              PIC  X(1).                 MLRD044 
W40007         88  ERROR-RC-VALID-MKDN-RSN   VALUE '1', '2', '3',               
W40007                                             '4', '5', '6'.               
W40007         88  ERROR-RC-VALID-MKUP-RSN   VALUE '1', '2', '3',               
W40007                                             '4', '5'.                    
W40007         88  ERROR-RC-PROMOTIONAL      VALUE '1'.                         
W40007         88  ERROR-RC-FREE-WITH-PURCH  VALUE '4'.                         
W40007         88  ERROR-RC-MISCELLANEOUS    VALUE '5'.                         
W40007                                                                          
DMTG #*    05  ERROR-PC-OLD-PR-AMT           PIC  9(4)V99.              MLRD044 
DMTG #     05  ERROR-PC-OLD-PR-AMT           PIC  9(5)V99.              MLRD044 
DMTG #*    05  ERROR-PC-NEW-PR-AMT           PIC  9(4)V99.              MLRD044 
DMTG #     05  ERROR-PC-NEW-PR-AMT           PIC  9(5)V99.              MLRD044 
W40007     05  ERROR-PC-QTY                  PIC  9(4).                 MLRD044 
W40007     05  FILLER                        PIC  X(1) VALUE SPACE.     MLRD044 
W40007     05  ERROR-PC-BATCH-NBR            PIC  X(3).                 MLRD044 
W40007         88  ERROR-BN-MANUAL-LID-CRCT  VALUE '799'.                       
W40007         88  ERROR-BN-OWN-ADJ-CRCT     VALUE '797'.                       
W40007         88  ERROR-BN-FWP-VOID-CRCT    VALUE '771'.                       
W40007         88  ERROR-BN-MANUAL-LID       VALUE '798'.                       
W40007         88  ERROR-BN-KOHLS-COUPON     VALUE '733'.                       
W40007         88  ERROR-BN-SENIOR-CITZ-DISC VALUE '728'.                       
W40007         88  ERROR-BN-OWN-ADJ          VALUE '796'.                       
W40007         88  ERROR-BN-GOLDSTAR         VALUE '753'.                       
W40007         88  ERROR-BN-OFFER-COUPON     VALUE '760'.                       
W40007         88  ERROR-BN-OFFER-TLD-TIERED VALUE '761'.                       
W40007         88  ERROR-BN-OFFER-LID-TIERED VALUE '762'.                       
W40007         88  ERROR-BN-OFFER-GWP-PWP    VALUE '763'.                       
W40007         88  ERROR-BN-PROMOTIONAL      VALUE '746'.                       
W40007         88  ERROR-BN-BOGO             VALUE '775'.                       
W40007         88  ERROR-BN-BOGO-II          VALUE '777'.                       
W40007         88  ERROR-BN-UNEARNED-RWDS    VALUE '780'.                       
W40007         88  ERROR-BN-OWN-RTN-ADJ      VALUE '792'.                       
W40007         88  ERROR-BN-EMPLY-DISCOUNT   VALUE '790'.                       
W39372         88  ERROR-BN-UNERNDGFTRCPTRTN VALUE '765'.                       
205464         88  ERROR-BN-NON-RECEIPT-RTRN VALUE '710'.                       
W40007     05  ERROR-PC-MKDN-MKUP-RSN-CDE    PIC  X(3).                    CL**2
DMTG #*    05  FILLER                        PIC  X(3) VALUE SPACE.        CL**2
DMTG #*    05  ERROR-PC-DIFFER-AMT           PIC +9(4)V99.                 CL**2
DMTG #     05  ERROR-PC-DIFFER-AMT           PIC +9(5)V99.                 CL**2
W40007     05  ERROR-PC-TOT-DOC-QTY          PIC  9(5).                 MLRD044 
W40007     05  ERROR-PC-STORE-NBR            PIC  X(5).                 MLRD044 
W40007     05  FILLER                        PIC  X(1) VALUE SPACE.     MLRD044 
W40007     05  ERROR-PC-CATEG-CDE            PIC  X(1).                 MLRD044 
W40007         88  ERROR-PLU-MKDN-MKON       VALUE '1'.                         
W40007         88  ERROR-REGISTER-MKDN-MKON  VALUE '2'.                         
W40007         88  ERROR-UNMATCHED-MKDN-MKON VALUE '3'.                         
W40007         88  ERROR-BUYER-MKDN-MKON     VALUE '4'.                         
W40007         88  ERROR-STORE-MKDN-MKON     VALUE '5'.                         
W40007     05  ERROR-PC-DOC-7-NBR            PIC  X(7).                 MLRD044 
W40007     05  ERROR-PC-DOC-7-NBR-PIC9       REDEFINES                          
W40007         ERROR-PC-DOC-7-NBR            PIC  9(7).                         
W40007     05  FILLER REDEFINES ERROR-PC-DOC-7-NBR.                     MLRD044 
W40007         10  ERROR-PC-CATEGORY-IND     PIC  9(2).                 MLRD044 
W40007         10  ERROR-PC-DOC-NBR.                                    MLRD044 
W40007             15  ERROR-PC-DOC-DEPT     PIC  9(3).                 MLRD044 
W40007             15  ERROR-PC-DOC-DAY      PIC  9(2).                 MLRD044 
W40007     05  FILLER                        PIC  X(01) VALUE SPACE.    MLRD044 
W40007     05  ERROR-PC-VENDOR-INHSE-NMBR    PIC  X(03).                MLRD044 
W40007     05  FILLER                        PIC  X(02).                MLRD012I
W40007     05  ERROR-PC-LINE-NBR         PIC +9(04) VALUE ZEROS.        MLRD044 
W40007     05  ERROR-PC-SKU-DTA-ATTRIB.                                 MLRD044 
W40007         10  ERROR-PC-DEPT-CLASS       PIC  X(05).                MLRD044 
W40007         10  ERROR-PC-DEPT-CLASS-NUM  REDEFINES                   MLRD044 
W40007             ERROR-PC-DEPT-CLASS.                                 MLRD044 
W40007             15  ERROR-PC-DEPT-NBR     PIC  9(03).                MLRD044 
W40007             15  ERROR-PC-CLASS-NBR    PIC  9(02).                MLRD044 
W40007         10  ERROR-PC-MAJ-CLASS        PIC  X(04).                MLRD044 
W40007     05  ERROR-POS-NBR.                                                   
W40007         10  ERROR-RGST-ID             PIC  +9(04).                       
W40007         10  ERROR-TRN-NBR             PIC  +9(04).               MLRD044 
W40007         10  ERROR-STRT-TM             PIC   X(08).                       
W40007         10  ERROR-SLS-CORR-SEQ-NBR    PIC  +9(04).                       
W40007         10  ERROR-LNE-ITM-SEQ-NBR     PIC  +9(04).                       
W40007         10  ERROR-LID-SEQ-NBR         PIC  +9(04).                       
W40007     05  ERROR-GMM                     PIC X(02).                 MLRD044 
W40007     05  FILLER REDEFINES ERROR-GMM.                              MLRD044 
W40007         10  ERROR-FILLER              PIC X(01).                 MLRD044 
W40007         10  ERROR-DIVISION-NUMBER     PIC 9(01).                 MLRD044 
W40007     05  ERROR-DMM                     PIC X(02).                 MLRD044 
W40007     05  ERROR-MANAGER-NBR REDEFINES ERROR-DMM PIC 9(02).                 
W40007     05  ERROR-BUYER                   PIC X(03).                 MLRD044 
W40007     05  FILLER REDEFINES ERROR-BUYER.                            MLRD044 
W40007         10  FILLER                    PIC X(01).                 MLRD044 
W40007         10  ERROR-BUYER-NUMBER        PIC 9(02).                 MLRD044 
W40007     05  ERROR-PC-ENT-ID               PIC +9(9).                 MLRD044 
W40007     05  ERROR-ORIG-CLR-DTE            PIC X(10).                 MLRD044 
W40007     05  ERROR-MKDN-CDE                PIC X(01).                 MLRD044 
DMTG #*    05  ERROR-ORIG-CLR-NONGRP-RTL     PIC 9(4)V99 VALUE ZERO.    MLRD044 
DMTG #     05  ERROR-ORIG-CLR-NONGRP-RTL     PIC 9(5)V99 VALUE ZERO.    MLRD044 
W40007     05  ERROR-PC-DA.                                             MLRD044 
W40007         10  ERROR-PC-DOC-16-NBR       PIC X(16)  VALUE SPACES.   MLRD044 
W40007         10  ERROR-PC-AP-TRANS-CDE     PIC X(02)  VALUE SPACES.   MLRD044 
W40007     05  ERROR-PC-DTE-YEAR             PIC 9(04)  VALUE ZEROES.   MLRD044 
DMTG #*    05  FILLER                        PIC X(16)  VALUE SPACES.   MLRD044 
DMTG #     05  FILLER                        PIC X(15)  VALUE SPACES.   MLRD044 
W40007     05  ERROR-CDE                     PIC X(03)  VALUE SPACES.   MLRD044 
                                                                                
       01  PS-PROGRAM-SWITCHES.                                         02650000
           05  COMPOSITE-FILE-SW             PIC X       VALUE 'N'.     02660000
               88  END-OF-COMPOSITE-FILE                 VALUE 'Y'.     02670000
W26603     05  END-OF-XMTLOC-CURSOR-SW       PIC X       VALUE 'N'.     02680000
W26603         88  END-OF-XMTLOC-CURSOR                  VALUE 'Y'.     02690000
           05  PS-DATE-ERROR-SW            PIC X(01) VALUE 'N'.         02700000
               88  PS-NO-DATE-ERROR                  VALUE 'N'.         02710000
               88  PS-DATE-ERROR                     VALUE 'Y'.         02720000
                                                                        02730000
       01  PC-PROGRAM-CONSTANTS.                                        02740000
W26603     05  PC-MAX-STORES       PIC  S9(4)  COMP VALUE 9999.         02750000
W04252     05  PC-MAX-DEPT-CLASS   PIC  S9(5)  COMP-3 VALUE 25000.      02760000
           05  PC-END-OF-REPORT    PIC  X(133) VALUE                    02770000
              '-***  END OF REPORT ***'.                                02780000
           05  PC-AP-TRANS-CDE-XFER-TO                                  02790000
                                   PIC  X(2)   VALUE '55'.              02800000
           05  PC-INVENTORY-ONLY-MODE                                   02810000
                                   PIC  X(20)  VALUE '(INVENTORY ONLY)'.02820000
           05  PC-PIVOT-YEAR       PIC  9(02)  VALUE 80.                02830000
           05  PC-LEAP-MMDD        PIC  X(04)  VALUE '0229'.            02840000
                                                                        02850000
       01  CPU-DATE.                                                    02860000
           05  CPU-YEAR                    PIC X(02)     VALUE SPACES.  02870000
           05  CPU-MONTH                   PIC X(02)     VALUE SPACES.  02880000
           05  CPU-DAY                     PIC X(02)     VALUE SPACES.  02890000
                                                                        02900000
       01  CPU-TIME.                                                    02910000
           05  CPU-HOUR                    PIC X(02)     VALUE SPACES.  02920000
           05  CPU-MINUTE                  PIC X(02)     VALUE SPACES.  02930000
           05  FILLER                      PIC X(02)     VALUE SPACES.  02940000
                                                                        02950000
       01  PV-PROGRAM-VARIBLES.                                         02960000
W26603     05  PV-LOC-NBR                  PIC 9(05)  VALUE ZEROS.      02961000
W26603     05  PV-LOC-NBR-ALPHA REDEFINES                               02961100
W26603         PV-LOC-NBR                  PIC X(05).                   02961200
W26603     05  PV-EDIT-ENT-ID              PIC 9(05)  VALUE ZEROS.      02962000
W26603     05  PV-EDIT-ENT-ID-ALPHA REDEFINES                           02963000
W26603         PV-EDIT-ENT-ID              PIC X(05).                   02964000
           05  PV-NULL-IND                 PIC S9(04) COMP VALUE ZERO.  02970000
           05  PV-AVG-COST-WHOLE           PIC S9(7).                   02980000
           05  PV-AVG-FRGT-WHOLE           PIC S9(7).                   02990000
           05  PV-NET-COST-AMT             PIC S9(9)V99  COMP-3.        03000000
           05  PV-EX-TOT-TRAN-COUNT        PIC S9(9)     COMP-3         03010000
                                                     VALUE +0.          03020000
           05  PV-EX-TOT-RETAIL            PIC S9(11)V99 COMP-3         03030000
                                                     VALUE +0.          03040000
           05  PV-DB2-OPER-ATTEMPTED       PIC X(30).                   03050000
           05  PV-DEPT-CLASS.                                           03060000
               10  DEPT-CLASS-DEPT         PIC X(3).                    03070000
               10  DEPT-CLASS-CLASS        PIC X(2).                    03080000
           05  PV-DEPT-CLASS-COUNT         PIC S9(4) COMP.              03090000
           05  PV-SAVE-ST-IDX              PIC S9(4) COMP.              03100000
           05  PV-DETAIL-ERR-SW            PIC X VALUE 'N'.             03110000
               88  PV-NO-DTL-ERROR         VALUE 'N'.                   03120000
               88  PV-DTL-ERROR            VALUE 'Y'.                   03130000
           05  PV-HIGH-LEVEL-ERR-IND       PIC X.                       03140000
               88  PV-NO-HIGH-LEVEL-ERROR  VALUE 'N'.                   03150000
               88  PV-STORE-LEVEL-ERROR    VALUE 'S'.                   03160000
23711          88  PV-DEPT-LEVEL-ERROR     VALUE 'D'.                   03170000
23711          88  PV-SKU-LEVEL-ERROR      VALUE 'K'.                   03171000
               88  PV-HIGH-LEVEL-ERROR     VALUE 'D' 'S' 'K'.           03180000
           05  PV-INV-IND                  PIC X.                       03190000
               88  PV-INV-IND-NO           VALUE 'N'.                   03200000
               88  PV-INV-IND-YES          VALUE 'Y'.                   03210000
           05  PV-ML-IND                   PIC X.                       03220000
               88  PV-ML-IND-NO            VALUE 'N'.                   03230000
               88  PV-ML-IND-YES           VALUE 'Y'.                   03240000
           05  PV-LINE-COUNT               PIC 9(2).                    03250000
           05  PV-NBR-OF-CLASSES-IN-DEPT   PIC 9(03).                   03260000
           05  PV-NET-CHANGE-IN-COST       PIC S9(13)V99 COMP-3.        03270000
           05  PV-NET-CHANGE-IN-RETAIL     PIC S9(13)V99 COMP-3.        03280000
           05  PV-PAGE-COUNT               PIC 9(5).                    03290000
           05  PV-PARA                     PIC X(30).                   03300000
           05  PV-PRICE-CHANGE             PIC S9(9)V99 COMP-3.         03310000
           05  PV-SPLIT-FREIGHT-SW         PIC X.                       03320000
               88  PV-NOT-SPLIT-FREIGHT    VALUE 'N'.                   03330000
               88  PV-SPLIT-FREIGHT        VALUE 'Y'.                   03340000
W26603     05  PV-STORE-NBR                PIC X(5).                    03350000
W27261     05  PV-DGM-DATE-BEING-PROCESSED PIC X(10) VALUE SPACES.      03350000
W27261         88  DATE-BEING-PROCESSED-IS-BLANK VALUE SPACES.                  
W27261     05  FILLER REDEFINES PV-DGM-DATE-BEING-PROCESSED.                    
W27261         10  PV-DG-FWED-CCYY         PIC 9(04).                           
W27261         10  FILLER                  PIC X(01).                           
W27261         10  PV-DG-FWED-MM           PIC 9(02).                           
W27261         10  FILLER                  PIC X(01).                           
W27261         10  PV-DG-FWED-DD           PIC 9(02).                           
W27261     05  PV-DAILY-CUTOFF-IND         PIC X(01) VALUE SPACES.      03351000
W27261         88  ITS-A-DAILY-CUTOFF-RUN  VALUE 'Y'.                   03352000
W27261         88  NOT-A-DAILY-CUTOFF-RUN  VALUE 'N'.                   03353000
W27261     05  PV-DAILY-GROSS-MARGIN-RUN-IND   PIC X(01) VALUE 'N'.             
W27261         88  DAILY-GROSS-MARGIN-RUN      VALUE 'Y'.                       
      ******************************************************************03360000
      * THE FOLLOWING FIELDS CONTAIN THE DATE-RELATED INFORMATION       03370000
      * THAT WAS RETRIEVED FROM TDTATTR FOR THE MLCNTL DATES.           03380000
      ******************************************************************03390000
           05  PV-OPN-FSCL-YR-NBR          PIC X(04).                   03400000
           05  PV-NEXT-FSCL-YR-NBR         PIC X(04).                   03410000
           05  PV-NEXT-FSCL-MN-NBR         PIC X(02).                   03420000
           05  PV-FSCL-MN-BEG-DTE          PIC X(10).                   03430000
W27261     05  PV-FSCL-MN-END-DTE          PIC X(10).                   03431000
           05  PV-PSTG-FSCL-YR-NBR         PIC X(04).                   03440000
0300RM     05  PV-ADJ-DTE                  PIC X(06).                   03450000
0300RM     05  PV-ISO-ADJ-DTE              PIC X(10).                   03460000
      ******************************************************************03470000
                                                                        03480000
           05  PV-ISO-DTE.                                              03490000
               10 PV-ISO-CCYY              PIC X(04).                   03500000
               10  FILLER                  REDEFINES                    03510000
                   PV-ISO-CCYY.                                         03520000
                   15  PV-ISO-CC           PIC X(02).                   03530000
                   15  PV-ISO-YY           PIC X(02).                   03540000
               10  FILLER                  PIC X(01) VALUE '-'.         03550000
               10  PV-ISO-MM               PIC X(02).                   03560000
               10  FILLER                  PIC X(01) VALUE '-'.         03570000
               10  PV-ISO-DD               PIC X(02).                   03580000
                                                                        03590000
           05  PV-EDIT-DTE.                                             03600000
               10  PV-EDIT-MM              PIC X(02).                   03610000
               10  PV-EDIT-DD              PIC X(02).                   03620000
               10  PV-EDIT-YY              PIC X(02).                   03630000
                                                                        03640000
           05  PV-LAST-EDIT-DTE            PIC X(06) VALUE SPACE.       03650000
                                                                        03660000
           05  PV-FIN-LIAB-DTE             PIC X(10).                   03670000
           05  PV-DB2-DTE                  PIC X(10).                   03680000
           05  PV-DB2-CCYY                 PIC S9(09) COMP.             03690000
           05  PV-DB2-MM                   PIC S9(09) COMP.             03700000
           05  PV-DB2-DD                   PIC S9(09) COMP.             03710000
           05  PV-PROC-GREG-FMT-DTE        PIC X(08).                   03720000
W31475     05  PV-DEPT-CLASS-HLD-GROUP.                                         
W31475         10  PV-DEPT-HLD             PIC X(3) VALUE SPACES.               
W31475         10  PV-DEPT-CLASS-HLD       PIC X(2) VALUE SPACES.               
W40007     05  PV-PROGRAM-COUNTERS.                                             
W40007         10  PV-INPUT-REC-CNT        PIC 9(9)  VALUE ZEROS.               
W40007         10  PV-OUTPUT-REC-CNT       PIC 9(9)  VALUE ZEROS.               
W40007         10  PV-ERROR-REC-CNT        PIC 9(9)  VALUE ZEROS.               
W27261*                                                                         
W27261 01  PV-RUN-MESSAGES.                                             08345000
W27261     05  PV-DGM-CUTOFF-MSG       PIC X(50) VALUE                  08345000
W27261         '>> THIS IS A DAILY GROSS MARGIN CUTOFF WEEK RUN <<'.    08345000
W27261     05  PV-DGM-RUN-MSG          PIC X(45) VALUE                  08345000
W27261         '>> THIS IS A NORMAL DAILY GROSS MARGIN RUN <<'.         08345000
W27261     05  PV-NORMAL-WEEKLY-ML-MSG PIC X(52) VALUE                          
W27261         '>> THIS IS A NORMAL WEEKLY MERCHANDISE LEDGER RUN <<'.  08345000
                                                                        03730000
      *    THE FOLLOWING TABLE CONTAINS ALL TRANSACTION DATES THAT      03740000
      *    HAVE BEEN EDITED.                                            03750000
                                                                        03760000
       01  EDT-MAX                          PIC S9(4) COMP VALUE +1000. 03770000
       01  EDT-EDIT-DTE-TBL.                                            03780000
           05  EDT-ENTRY                    OCCURS 1000 TIMES           03790000
                                            INDEXED BY EDT-IDX.         03800000
               10  EDT-EDIT-DTE             PIC X(06).                  03810000
               10  EDT-ISO-DTE              PIC X(10).                  03820000
               10  EDT-FSCL-YR-NBR          PIC X(04).                  03830000
               10  EDT-FSCL-MN-NBR          PIC X(02).                  03840000
               10  EDT-FSCL-WK-NBR          PIC X(02).                  03850000
               10  EDT-WK-IN-MN-NBR         PIC X.                      03860000
               10  EDT-DAY-OF-WK-NBR        PIC X.                      03870000
               10  EDT-VALID-DTE-IND        PIC X.                      03880000
                                                                        03890000
       01  STORE-TABLE.                                                 03900000
W26603     05  STORE-ENTRIES OCCURS 9999 TIMES                          03910000
W31475         ASCENDING KEY IS ST-STORE-NMBR                                   
               INDEXED BY ST-IDX.                                       03920000
W26603         10  ST-STORE-NMBR               PIC X(05).               03930000
W28545         10  ST-INV-ID                   PIC S9(9) COMP.                  
               10  ST-PLND-INV-DTE             PIC X(10).               03940000
               10  ST-ACTL-DC-CTOFF-DTE        PIC X(10).               03950000
W33304         10  ST-SCHD-INV-CDE             PIC X(02).               03960000
0600RB         10  ST-SCAN-INV-CDE             PIC X(01).               03970000
RB0401         10  ST-MFSTNG-IND               PIC X(01).               03980000
W33304         10  ST-FINCL-BK-STAT            PIC X(02).               03980000
                                                                        03990000
       01  DEPARTMENT-CLASS-TABLE.                                      04000000
W04252     05  DEPT-CLASS-ENTRIES OCCURS 25000 TIMES                    04010000
W31475         ASCENDING KEY IS DC-DEPT-CLASS                                   
               INDEXED BY DC-IDX                                        04020000
                          DC-IDX2.                                      04030000
               10  DC-DEPT-CLASS.                                       04040000
                   15  DC-DEPT-NBR               PIC X(03).             04050000
                   15  DC-CLASS-NBR              PIC X(02).             04060000
               10  DC-NBR-OF-CLASSES-IN-DEPT     PIC 9(03).             04070000
                                                                        04080000
       01  TR-MAX                              PIC S9(4) COMP VALUE +8. 04090000
       01  TRANS-ACCUMS-TABLE.                                          04100000
           05  TRAN-COUNTS OCCURS 8  TIMES                              04110000
               INDEXED BY TR-IDX.                                       04120000
               10  TR-TRANS-CDE                PIC X(02).               04130000
               10  TR-TRANS-CDE-DESC           PIC X(06).               04140000
               10  TR-TRANS-IN                 PIC S9(11)    COMP-3.    04150000
               10  TR-TRANS-RTL-IN             PIC S9(11)V99 COMP-3.    04160000
               10  TR-TRANS-COST-IN            PIC S9(11)V99 COMP-3.    04170000
               10  TR-TRANS-ERR                PIC S9(11)    COMP-3.    04180000
               10  TR-TRANS-RTL-ERR            PIC S9(11)V99 COMP-3.    04190000
               10  TR-TRANS-COST-ERR           PIC S9(11)V99 COMP-3.    04200000
               10  TR-TRANS-OK                 PIC S9(11)    COMP-3.    04210000
               10  TR-TRANS-RTL-OK             PIC S9(11)V99 COMP-3.    04220000
               10  TR-TRANS-COST-OK            PIC S9(11)V99 COMP-3.    04230000
                                                                        04240000
                                                                        04250000
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 04260000
      *                 A U D I T    R E P O R T   L I N E S          * 04270000
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 04280000
       01  AD-HDG1.                                                     04290000
           05  FILLER                  PIC  X(50)    VALUE SPACES.      04300000
           05  FILLER                  PIC  X(26)    VALUE              04310000
                               'INVENTORY EDIT TOTALS FOR '.            04320000
           05  AD-HDG1-DTE             PIC  X(08).                      04330000
           05  FILLER                  PIC  X        VALUE SPACE.       04340000
           05  AD-HDG1-PROCESSING-MODE PIC  X(20)    VALUE SPACE.       04350000
                                                                        04360000
       01  AD-HDG2.                                                     04370000
           05  FILLER                  PIC  X(01)    VALUE '0'.         04380000
           05  FILLER                  PIC  X(25)    VALUE SPACES.      04390000
           05  FILLER                  PIC  X(09)    VALUE 'I N P U T'. 04400000
           05  FILLER                  PIC  X(32)    VALUE SPACES.      04410000
           05  FILLER                  PIC  X(09)    VALUE 'E R R O R'. 04420000
           05  FILLER                  PIC  X(30)    VALUE SPACES.      04430000
           05  FILLER                  PIC  X(11)    VALUE              04440000
                                                          'O U T P U T'.04450000
                                                                        04460000
       01  AD-HDG3.                                                     04470000
           05  FILLER                  PIC  X(01)    VALUE SPACES.      04480000
           05  FILLER                  PIC  X(08)    VALUE              04490000
                                                     'CDE DESC'.        04500000
           05  FILLER                  PIC  X(05)    VALUE SPACES.      04510000
           05  FILLER                  PIC  X(05)    VALUE 'TRANS'.     04520000
           05  FILLER                  PIC  X(09)    VALUE SPACES.      04530000
           05  FILLER                  PIC  X(06)    VALUE 'RETAIL'.    04540000
           05  FILLER                  PIC  X(12)    VALUE SPACES.      04550000
           05  FILLER                  PIC  X(04)    VALUE 'COST'.      04560000
           05  FILLER                  PIC  X(07)    VALUE SPACES.      04570000
           05  FILLER                  PIC  X(05)    VALUE 'TRANS'.     04580000
           05  FILLER                  PIC  X(06)    VALUE SPACES.      04590000
           05  FILLER                  PIC  X(06)    VALUE 'RETAIL'.    04600000
           05  FILLER                  PIC  X(09)    VALUE SPACES.      04610000
           05  FILLER                  PIC  X(04)    VALUE 'COST'.      04620000
           05  FILLER                  PIC  X(07)    VALUE SPACES.      04630000
           05  FILLER                  PIC  X(05)    VALUE 'TRANS'.     04640000
           05  FILLER                  PIC  X(09)    VALUE SPACES.      04650000
           05  FILLER                  PIC  X(06)    VALUE 'RETAIL'.    04660000
           05  FILLER                  PIC  X(12)    VALUE SPACES.      04670000
           05  FILLER                  PIC  X(04)    VALUE 'COST'.      04680000
                                                                        04690000
                                                                        04700000
       01  AUDIT-DETAIL-LINE.                                           04710000
           05  FILLER                  PIC  X(01) VALUE '0'.            04720000
           05  AD-TRANS-CDE            PIC  X(02).                      04730000
           05  FILLER                  PIC  X(01) VALUE SPACES.         04740000
           05  AD-TRANS-CDE-DESC       PIC  X(06).                      04750000
           05  FILLER                  PIC  X(01) VALUE SPACES.         04760000
           05  AD-TRANS-IN             PIC  ZZ,ZZZ,ZZZ.                 04770000
           05  FILLER                  PIC  X(01) VALUE SPACES.         04780000
           05  AD-TRANS-RTL-IN         PIC  ZZZ,ZZZ,ZZZ.99-.            04790000
           05  FILLER                  PIC  X(01) VALUE SPACES.         04800000
           05  AD-TRANS-COST-IN        PIC  ZZZ,ZZZ,ZZZ.99-.            04810000
           05  FILLER                  PIC  X(01) VALUE SPACES.         04820000
           05  AD-TRANS-ERR            PIC  Z,ZZZ,ZZZ.                  04830000
           05  FILLER                  PIC  X(01) VALUE SPACES.         04840000
           05  AD-TRANS-RTL-ERR        PIC  ZZZZZ,ZZZ.99-.              04850000
           05  AD-TRANS-COST-ERR       PIC  ZZZZZ,ZZZ.99-.              04860000
           05  FILLER                  PIC  X(01) VALUE SPACES.         04870000
           05  AD-TRANS-OK             PIC  ZZ,ZZZ,ZZZ.                 04880000
           05  FILLER                  PIC  X(01) VALUE SPACES.         04890000
           05  AD-TRANS-RTL-OK         PIC  ZZZ,ZZZ,ZZZ.99-.            04900000
           05  FILLER                  PIC  X(01) VALUE SPACES.         04910000
           05  AD-TRANS-COST-OK        PIC  ZZZ,ZZZ,ZZZ.99-.            04920000
                                                                        04930000
                                                                        04940000
       01  NET-CHANGE-IN-INVENTORY-LINE.                                04950000
           05  FILLER                  PIC  X(01)  VALUE '0'.           04960000
           05  FILLER                  PIC  X(101) VALUE                04970000
               'NET CHANGE IN INVENTORY AS A RESULT OF THIS JOB: '.     04980000
           05  NC-RETAIL-AMT           PIC  ZZZ,ZZZ,ZZZ.99-.            04990000
           05  FILLER                  PIC  X(01) VALUE SPACES.         05000000
           05  NC-COST-AMT             PIC  ZZZ,ZZZ,ZZZ.99-.            05010000
                                                                        05020000
                                                                        05030000
       01  EX-HDG1.                                                     05040000
           05  FILLER                  PIC  X(45)    VALUE SPACES.      05050000
           05  FILLER                  PIC  X(19)    VALUE              05060000
                                                  'INVENTORY TRANSFER '.05070000
           05  FILLER                  PIC  X(15)    VALUE              05080000
                                                      'EXCEPTIONS FOR '.05090000
           05  EX-HDG1-DTE             PIC  X(08).                      05100000
           05  FILLER                  PIC  X        VALUE SPACE.       05110000
           05  EX-HDG1-PROCESSING-MODE PIC  X(20)    VALUE SPACE.       05120000
                                                                        05130000
       01  EX-HDG2.                                                     05140000
           05  FILLER                  PIC  X(10)    VALUE SPACES.      05150000
           05  FILLER                  PIC  X(04)    VALUE 'FROM'.      05160000
           05  FILLER                  PIC  X(06)    VALUE SPACES.      05170000
           05  FILLER                  PIC  X(02)    VALUE 'TO'.        05180000
           05  FILLER                  PIC  X(13)    VALUE SPACES.      05190000
                                                                        05200000
       01  EX-HDG3.                                                     05210000
           05  FILLER                  PIC  X(03)    VALUE SPACES.      05220000
           05  FILLER                  PIC  X(04)    VALUE 'CODE'.      05230000
           05  FILLER                  PIC  X(03)    VALUE SPACES.      05240000
           05  FILLER                  PIC  X(05)    VALUE 'STORE'.     05250000
           05  FILLER                  PIC  X(04)    VALUE SPACES.      05260000
           05  FILLER                  PIC  X(05)    VALUE 'STORE'.     05270000
           05  FILLER                  PIC  X(03)    VALUE SPACES.      05280000
           05  FILLER                  PIC  X(05)    VALUE 'BATCH'.     05290000
           05  FILLER                  PIC  X(03)    VALUE SPACES.      05300000
           05  FILLER                  PIC  X(06)    VALUE 'SOURCE'.    05310000
      ***  05  FILLER                  PIC  X(05)    VALUE 'DOCNO'.     05320000
           05  FILLER                  PIC  X(03)    VALUE SPACES.      05330000
           05  FILLER                  PIC  X(05)    VALUE 'DOCNO'.     05340000
           05  FILLER                  PIC  X(04)    VALUE SPACES.      05350000
           05  FILLER                  PIC  X(05)    VALUE SPACES.      05360000
           05  FILLER                  PIC  X(04)    VALUE 'DATE'.      05370000
           05  FILLER                  PIC  X(01)    VALUE SPACES.      05380000
           05  FILLER                  PIC  X(03)    VALUE SPACES.      05390000
           05  FILLER                  PIC  X(02)    VALUE 'KM'.        05400000
           05  FILLER                  PIC  X(02)    VALUE SPACES.      05410000
           05  FILLER                  PIC  X(05)    VALUE 'CLASS'.     05420000
W26006     05  FILLER                  PIC  X(06)    VALUE SPACES.      05430000
           05  FILLER                  PIC  X(05)    VALUE 'UNITS'.     05440000
W26006     05  FILLER                  PIC  X(09)    VALUE SPACES.      05450000
           05  FILLER                  PIC  X(05)    VALUE 'PRICE'.     05460000
W26006     05  FILLER                  PIC  X(07)    VALUE SPACES.      05470000
           05  FILLER                  PIC  X(10)    VALUE 'RETAIL AMT'.05480000
W26006***  05  FILLER                  PIC  X(28)    VALUE SPACES.      05490000
           EJECT                                                        05500000
       01  EX-DETAIL-LINE.                                              05510000
           05  FILLER                  PIC  X(01)    VALUE SPACE.       05520000
           05  FILLER                  PIC  X(04).                      05530000
           05  EX-TRANS-CDE            PIC  X(02).                      05540000
W26603     05  FILLER                  PIC  X(03).                      05550000
W26603     05  EX-STORE-NBR            PIC  X(05).                      05560000
W26603     05  FILLER                  PIC  X(04).                      05570000
W26603     05  EX-REL-STORE-NBR        PIC  X(05).                      05580000
           05  FILLER                  PIC  X(04).                      05590000
           05  EX-BATCH-NBR            PIC  X(04).                      05600000
           05  FILLER                  PIC  X(04).                      05610000
           05  EX-SOURCE-NBR           PIC  X(05).                      05620000
      ***  05  FILLER                  PIC  X(05).                      05630000
      ***  05  EX-SCAN-DOC-NBR         PIC  X(05).                      05640000
           05  FILLER                  PIC  X(03).                      05650000
           05  EX-DOC-NBR-11           PIC  X(11).                      05660000
      ***  05  EX-DOC-NBR-5            PIC  X(05).                      05670000
           05  FILLER                  PIC  X(03).                      05680000
           05  EX-LIAB-MMDD            PIC  X(05).                      05690000
           05  FILLER                  PIC  X(03).                      05700000
           05  EX-KOHLS-MM             PIC  X(02).                      05710000
           05  FILLER                  PIC  X(02).                      05720000
           05  EX-DEPT-CLASS           PIC  X(05).                      05730000
           05  FILLER                  PIC  X(04).                      05740000
W26006     05  EX-QTY                  PIC  ZZZ,ZZ9.                    05750000
           05  FILLER                  PIC  X(02).                      05760000
W26006     05  EX-PRICE                PIC  Z,ZZZ,ZZZ.99.               05770000
           05  FILLER                  PIC  X(03).                      05780000
W26006     05  EX-RETAIL               PIC  ZZZ,ZZZ,ZZZ.99.             05790000
W26006***  05  FILLER                  PIC  X(28).                      05800000
                                                                        05810000
       01  EX-TOTAL-LINE.                                               05820000
           05  FILLER                  PIC X(28) VALUE                  05830000
                                         'TOTAL NUMBER OF EXCEPTIONS: '.05840000
           05  EX-TOT-TRAN-COUNT       PIC ZZZ,ZZZ,ZZ9.                 05850000
           05  FILLER                  PIC X(23) VALUE SPACE.           05860000
           05  FILLER                  PIC X(18) VALUE                  05870000
                                                   'TOTAL RETAIL AMT: '.05880000
           05  EX-TOT-RETAIL           PIC ZZ,ZZZ,ZZZ,ZZZ.99.           05890000
      ***************************************************************** 05900000
      *  ABEND ROUTINE WORKING STORAGE                                  05910000
      ***************************************************************** 05920000
                                                                        05930000
           COPY DPWS004.                                                05940000
                                                                        05950000
       01  ABEND-CODE                          PIC S9(04)  VALUE +0     05960000
                                                           COMP SYNC.   05970000
           88  ABEND-4003                                  VALUE +4003. 05980000
                                                                        05990000
W40007*EJECT                                                            06000000
W40007*    EXEC SQL                                                     06010000
W40007*        INCLUDE SQLCA                                            06020000
W40007*    END-EXEC                                                     06030000
W40007*                                                                 06040000
W40007*    EXEC SQL                                                     06050000
W40007*        INCLUDE XMT00001                                         06060000
W40007*    END-EXEC                                                     06070000
W40007*                                                                 06080000
W40007*    EXEC SQL                                                     06090000
W40007*        INCLUDE TINVPAR                                          06100000
W40007*    END-EXEC                                                     06110000
W40007*                                                                 06120000
W40007*    EXEC SQL                                                             
W40007*        INCLUDE TINCNTL                                                  
W40007*    END-EXEC                                                             
W40007*                                                                         
W40007*    EXEC SQL                                                     06130000
W40007*        INCLUDE TMDSEAR                                          06140000
W40007*    END-EXEC                                                     06150000
W40007*                                                                 06160000
W40007*    EXEC SQL                                                     06170000
W40007*        INCLUDE TAPLAVL                                          06180000
W40007*    END-EXEC                                                     06190000
W40007*                                                                 06200000
W40007*    EXEC SQL                                                     06210000
W40007*        INCLUDE TDTATTR                                          06220000
W40007*    END-EXEC                                                     06230000
W40007*                                                                 06240000
W40007*    EXEC SQL                                                     06250000
W40007*        INCLUDE TMLCNTL                                          06260000
W40007*    END-EXEC                                                     06270000
W40007*                                                                 06280000
W40007*    EXEC SQL                                                     06290000
W40007*        DECLARE XMTLOC_CURSOR   CURSOR FOR                       06300000
W40007*         SELECT DISTINCT(LOC_NBR)                                06310000
W40007*         FROM XMT_LOC                                            06320000
W40007*         WHERE LOC_TYP_CDE IN ('DC','DS','RV','CS','DA')         06340000
W40007*           AND (FINCL_CLO_DTE > :MLCNTL-PSTG-FSCL-WK-DTE OR              
W40007*                FINCL_CLO_DTE IS NULL)                                   
W40007*         ORDER BY LOC_NBR                                        06350000
W40007*         WITH UR                                                 06351000
W40007*    END-EXEC.                                                    06360000
W40007*                                                                 06370000
W40007*    EJECT                                                        06380000
                                                                        06390000
      **   THIS UNIONIZED CURSOR RETURNS THE FOLLOWING:                 06400000
      **                                                                06410000
      **   1.  ALL DEPT/SUB_CL COMBO'S FOR ACTIVE 'ML' DEPARTMENTS      06420000
      **   2.  A COUNT, BY DEPARTMENT, OF THE TOTAL NUMBER OF CLASSES   06430000
      **       IN EACH DEPARTMENT.                                      06440000
      **                                                                06450000
      **                                                                06460000
      **    ---------+---------+---------+---------+---------+---------+06470000
      **    DEPT_NBR  SUB_CL_NBR              ** COMMENTS BELOW: **     06480000
      **    ---------+---------+---------+---------+---------+---------+06490000
      **    011       TOT                  45 ** DPT 11 HAS 45 SUB_CL'S 06500000
      **    011       010                   0                           06510000
      **    011       011                   0                           06520000
      **    .         .                     .                           06530000
      **    .         .                     .                           06540000
      **    012       TOT                  78 ** DPT 12 HAS 78 SUB_CL'S 06550000
      **    012       010                   0                           06560000
      **    .         .                     .                           06570000
      **    .         .                     .                           06580000
W40007*    EXEC SQL DECLARE TMDSEAR_CURSOR CURSOR FOR                   06590000
W40007*      SELECT  A.DEPT_NBR                                         06600000
W40007*             ,'TOT'                                              06610000
W40007*             ,COUNT(*)                                           06620000
W40007*        FROM  TMDSEAR A                                          06630000
W40007*             ,TAPLAVL B                                          06640000
W40007*       WHERE  A.OPERCO_NBR      = '03'                           06650000
W40007*         AND  A.MDSELV_CDE      = 'SCL'                          06660000
W40007*         AND  :MLCNTL-PSTG-FSCL-WK-DTE                           06670000
W40007*                                 BETWEEN A.STRT_DTE              06680000
W40007*                                     AND A.END_DTE               06690000
W40007*         AND  A.MDSEAR_DKEY     = B.MDSEAR_DKEY                  06700000
W40007*         AND  :MLCNTL-PSTG-FSCL-WK-DTE                           06710000
W40007*                                 BETWEEN B.MDSEAR_STRT_DTE       06720000
W40007*                                     AND B.MDSEAR_END_DTE        06730000
W40007*         AND  B.APLSYS_CDE      = 'ML'                           06740000
W40007*       GROUP BY A.DEPT_NBR                                       06750000
W40007*                                                                 06760000
W40007*       UNION ALL                                                 06770000
W40007*                                                                 06780000
W40007*      SELECT  A.DEPT_NBR                                         06790000
W40007*             ,A.SUB_CL_NBR                                       06800000
W40007*             ,+0                                                 06810000
W40007*        FROM  TMDSEAR A                                          06820000
W40007*             ,TAPLAVL B                                          06830000
W40007*       WHERE  A.OPERCO_NBR      = '03'                           06840000
W40007*         AND  A.MDSELV_CDE      = 'SCL'                          06850000
W40007*         AND  :MLCNTL-PSTG-FSCL-WK-DTE                           06860000
W40007*                                 BETWEEN A.STRT_DTE              06870000
W40007*                                     AND A.END_DTE               06880000
W40007*         AND  A.MDSEAR_DKEY     = B.MDSEAR_DKEY                  06890000
W40007*         AND  :MLCNTL-PSTG-FSCL-WK-DTE                           06900000
W40007*                                 BETWEEN B.MDSEAR_STRT_DTE       06910000
W40007*                                     AND B.MDSEAR_END_DTE        06920000
W40007*         AND  B.APLSYS_CDE      = 'ML'                           06930000
W40007*                                                                 06940000
W40007*       ORDER BY 1,2                                              06950000
W40007*       WITH UR                                                   06951000
W40007*    END-EXEC.                                                    06960000
W40007*                                                                 06970000
W40007*EJECT                                                            06980000
       LINKAGE SECTION.                                                 06990000
                                                                        07000000
                                                                        07010000
       PROCEDURE DIVISION.                                              07020000
                                                                        07030000
                                                                        07040000
      ******************************************************************07050000
      *                                                                 07060000
      *    THE BASIC FLOW OF THE PROGRAM IS AS FOLLOWS:                 07070000
      *                                                                 07080000
      *    B1XX - HOUSEKEEPING LOGIC, INITIAL READ OF INPUT COMPOSITE   07090000
      *           FILE.  BUILD WORKING STORAGE TABLES FOR THE FOLLOWING:07100000
      *           -  FISCAL PERIOD DATE INFO                            07110000
W26603*           -  XMTLOC/TINVPAR DATES                               07120000
      *           -  VALID "ML" DEPT/CLASSES                            07130000
      *                                                                 07140000
      *    C100 - PROCESS ALL STORES                                    07150000
      *                                                                 07160000
W26603*         - DOES THE STORE EXISTS IN THE XMTLOC/TINVPAR JOIN?     07170000
      *           EVEN IF IT DOESN'T, CONTINUE W/ EDITS.                07180000
      *                                                                 07190000
      *           C110  PROCESS ALL DEPARTMENTS IN THE STORE            07200000
      *                 - IS THE DEPT/CLASS VALID FOR "ML" ?  EVEN IF   07210000
      *                   IT'S NOT, CONTINUE WITH THE EDITS.            07220000
      *                                                                 07230000
      *                 C150  BASED ON TRAN TYPE, COMPLETE THE EDITS.   07240000
      *                       **  NOTE - FOR EACH RECORD TYPE:          07250000
      *                            IF NO ERRORS FOUND,                  07260000
      *                                -  WRITE OUT THE CORRESPONDING   07270000
      *                                   OUTPUT RECORD                 07280000
      *                                -  WRITE A RPT1 EDIT/SPLIT       07290000
      *                                   REPORT RECORD                 07300000
      *                            ELSE                                 07310000
      *                                -  WRITE A RPT2 ERROR RECORD     07320000
      *                                                                 07330000
      *                       EVALUATE ML020-TRANS-CDE:                 07340000
      *                           WHEN ML020-PURCHASE                   07350000
      *                               PERFORM D100-PROCESS-PURCHASE     07360000
      *                           WHEN ML020-SALE                       07370000
      *                               PERFORM E100-PROCESS-SALE         07380000
      *                           WHEN ML020-STORE-TRANSFER             07390000
      *                               PERFORM F100-PROCESS-TRANSFER     07400000
      *                           WHEN ML020-PRICE-CHANGE               07410000
      *                               PERFORM G100-PROCESS-PRICE-CHANGE 07420000
      *                           WHEN ML020-ADJUSTMENT                 07430000
      *                               PERFORM H100-PROCESS-ADJUSTMENTS  07440000
      *                           WHEN OTHER                            07450000
      *                               ABEND                             07460000
      *                                                                 07470000
      *                      READ THE NEXT COMPOSITE RECORD             07480000
      ******************************************************************07490000
           PERFORM B100-HOUSEKEEPING.                                   07500000
                                                                        07510000
           PERFORM C100-PROCESS-STORES                                  07520000
               UNTIL END-OF-COMPOSITE-FILE                              07530000
                                                                        07540000
           PERFORM B300-EOJ.                                            07550000
                                                                        07560000
           STOP RUN.                                                    07570000
                                                                        07580000
                                                                        07590000
       B100-HOUSEKEEPING.                                               07600000
                                                                        07610000
           PERFORM B110-OPEN-FILES.                                     07620000
W40007*    PERFORM B120-PROCESS-CONTROL-CARD.                           07630000
W40007*    IF PV-DAILY-GROSS-MARGIN-RUN-IND = 'Y'                               
W40007*        PERFORM Z710-ESTABLISH-DATES-FOR-DGM THRU Z710-EXIT              
W40007*    ELSE                                                                 
W40007*        PERFORM B125-ESTABLISH-DATES.                            07640000
W40007*    PERFORM B130-TABLE-STORE-INFO.                               07650000
W40007*    PERFORM B140-TABLE-DEPT-CLASS-INFO.                          07660000
           PERFORM B150-INIT-TRANS-ACCUM-TABLE.                         07670000
W40007*    PERFORM B160-WRITE-RPT-FILE-HEADERS.                         07680000
W40007*    PERFORM B170-GET-SYSTEM-DATE-TIME.                           07690000
                                                                        07700000
      **   PUT OUT THE HEADINGS FOR THE TRANSFER EXCEPTIONS REPORT      07710000
                                                                        07720000
W40007*    PERFORM F200-HEADINGS.                                       07730000
W40007*                                                                 07740000
W40007*    INITIALIZE EDT-EDIT-DTE-TBL.                                 07750000
W40007*                                                                 07760000
           PERFORM Z100-READ-COMPOSITE-FILE.                            07770000
                                                                        07780000
                                                                        07790000
       B110-OPEN-FILES.                                                 07800000
                                                                        07810000
           OPEN  INPUT COMPOSITE-FILE                                   07820000
W40007*                CONTROL-CARD-FILE                                07830000
                OUTPUT PURCH-FILE                                       07840000
                       SALE-FILE                                        07850000
                       PRC-CHG-FILE                                     07860000
                       ADJUSTMENT-FILE                                  07870000
                       REPORT-FILE                                      07880000
                       ERROR-FILE                                       07890000
W29145                 DW-PRC-CHG-FILE                                  07890000
W28582                 BV-PRC-CHG-FILE                                  07890000
W28582                 BV-PURCH-FILE                                    07890000
                       AUDIT-REPORT-FILE                                07900000
                       EXCEPTIONS-REPORT-FILE.                          07910000
                                                                        07920000
                                                                        07930000
W40007*B120-PROCESS-CONTROL-CARD.                                       07940000
W40007*                                                                 07950000
W40007*    MOVE 'B120-PROCESS-CONTROL-CARD' TO PV-PARA.                 07960000
W40007*                                                                 07970000
W40007*    MOVE 'N'   TO   COMPOSITE-FILE-SW.                           07980000
W40007*                                                                 07990000
W40007*    READ CONTROL-CARD-FILE INTO CC-CONTROL-CARD                  08000000
W40007*        AT END                                                   08010000
W40007*            DISPLAY '** PROGRAM ABEND **'                        08020000
W40007*            DISPLAY 'EIKUP001  - CONTROL CARD EMPTY'             08030000
W40007*            MOVE +4003              TO ABEND-CODE                08040000
W40007*            PERFORM Z999-ABEND.                                  08050000
W40007*                                                                 08060000
W40007*    DISPLAY '** EIKUP001 CONTROL CARD:' CC-CONTROL-CARD.         08070000
W40007*                                                                 08080000
W40007*    IF NOT CC-PROCESSING-MODE-VALID                              08090000
W40007*        DISPLAY '** ABEND **'                                    08100000
W40007*        DISPLAY '** PROGRAM EIKUP001 **'                         08110000
W40007*        DISPLAY '** PARAGRAPH ' PV-PARA                          08120000
W40007*        IF CC-PROCESSING-MODE = SPACE                            08130000
W40007*            DISPLAY '** PROCESSING MODE ON CONTROL CARD IS BLANK'08140000
W40007*        ELSE                                                     08150000
W40007*            DISPLAY '** INVALID PROCESSING MODE ON CONTROL CARD:'08160000
W40007*                     CC-PROCESSING-MODE                          08170000
W40007*        END-IF                                                   08180000
W40007*        MOVE +4003 TO ABEND-CODE                                 08190000
W40007*        PERFORM Z999-ABEND.                                      08200000
W40007*                                                                 08210000
W40007*    IF NOT CC-CHECK-INV-DATES-SW-VALID                           08220000
W40007*        DISPLAY '** ABEND **'                                    08230000
W40007*        DISPLAY '** PROGRAM EIKUP001 **'                         08240000
W40007*        DISPLAY '** PARAGRAPH ' PV-PARA                          08250000
W40007*        IF CC-CHECK-INV-DATES-SW = SPACE                         08260000
W40007*            DISPLAY '** CHECK-INV-DATES-SWITCH ON CONTROL CARD IS08270000
W40007*                    ' BLANK'                                     08280000
W40007*        ELSE                                                     08290000
W40007*            DISPLAY '** INVALID CHECK-INV-DATES-SWITCH ON CONTROL08300000
W40007*                    ' CARD:' CC-CHECK-INV-DATES-SW               08310000
W40007*        END-IF                                                   08320000
W40007*        MOVE +4003 TO ABEND-CODE                                 08330000
W40007*        PERFORM Z999-ABEND.                                      08340000
W40007*                                                                         
W40007*                                                                         
W40007*    EVALUATE TRUE                                                        
W40007*                                                                         
W40007*       WHEN (CC-DAILY-CUTOFF-IND   = SPACE    AND                        
W40007*             CC-DGM-RUN-IND        = SPACE)                              
W40007*          DISPLAY PV-NORMAL-WEEKLY-ML-MSG                                
W40007*                                                                         
W40007*       WHEN (CC-DAILY-CUTOFF-IND NOT = SPACE    AND                      
W40007*             CC-DGM-RUN-IND          = SPACE)                            
W40007*                                                                         
W40007*          DISPLAY '** ABEND **'                                  08344000
W40007*          DISPLAY '** PROGRAM EIKUP001 **'                       08345000
W40007*          DISPLAY '** PARAGRAPH ' PV-PARA                        08346000
W40007*          DISPLAY '** DAILY-CUTOFF-IND ON CONTROL CARD IS '              
W40007*                   CC-DAILY-CUTOFF-IND                           08349000
W40007*          DISPLAY '** DAILY-DGM-RUN-IND IS BLANK'                        
W40007*          DISPLAY '** BOTH MUST EITHER BE BLANK OR FILLED IN'            
W40007*          MOVE +4003 TO ABEND-CODE                               08349500
W40007*          PERFORM Z999-ABEND                                     08349600
W40007*                                                                         
W40007*       WHEN (CC-DAILY-CUTOFF-IND     = SPACE    AND                      
W40007*             CC-DGM-RUN-IND      NOT = SPACE)                            
W40007*                                                                         
W40007*          DISPLAY '** ABEND **'                                  08344000
W40007*          DISPLAY '** PROGRAM EIKUP001 **'                       08345000
W40007*          DISPLAY '** PARAGRAPH ' PV-PARA                        08346000
W40007*          DISPLAY '** DAILY-CUTOFF-IND ON CONTROL CARD IS BLANK'         
W40007*          DISPLAY '** DAILY-DGM-RUN-IND IS ' CC-DGM-RUN-IND              
W40007*          DISPLAY '** BOTH MUST EITHER BE BLANK OR FILLED IN'            
W40007*          MOVE +4003 TO ABEND-CODE                               08349500
W40007*          PERFORM Z999-ABEND                                     08349600
W40007*                                                                         
W40007*       WHEN OTHER                                                        
W40007*                                                                         
W40007*          MOVE CC-DGM-DATE-BEING-PROCESSED TO                    08342000
W40007*              PV-DGM-DATE-BEING-PROCESSED                        08342000
W40007*          PERFORM Z700-VALIDATE-DGM-DATE THRU Z700-EXIT                  
W40007*                                                                 08340100
W40007*          IF CC-DAILY-CUTOFF-IND-IS-VALID                        08341000
W40007*              MOVE CC-DAILY-CUTOFF-IND TO PV-DAILY-CUTOFF-IND    08342000
W40007*          ELSE                                                   08343000
W40007*              DISPLAY '** ABEND **'                              08344000
W40007*              DISPLAY '** PROGRAM EIKUP001 **'                   08345000
W40007*              DISPLAY '** PARAGRAPH ' PV-PARA                    08346000
W40007*              DISPLAY '** DAILY-CUTOFF-IND ON CONTROL CARD IN COL08349200
W40007*                      'UMN 2 IS INVALID = ' CC-DAILY-CUTOFF-IND  08349300
W40007*              MOVE +4003 TO ABEND-CODE                           08349500
W40007*              PERFORM Z999-ABEND                                 08349600
W40007*          END-IF                                                 08349700
W40007*                                                                 08340100
W40007*          IF PV-DAILY-GROSS-MARGIN-RUN-IND = 'Y'                         
W40007*              IF PV-DAILY-CUTOFF-IND = 'Y'                               
W40007*                  DISPLAY PV-DGM-CUTOFF-MSG                      08345000
W40007*              ELSE                                               08345000
W40007*                  DISPLAY PV-DGM-RUN-MSG                         08345000
W40007*              END-IF                                                     
W40007*          END-IF                                                         
W40007*                                                                         
W40007*    END-EVALUATE.                                                        
W40007*                                                                         
W40007*                                                                 08350000
W40007*B125-ESTABLISH-DATES.                                            08360000
W40007*                                                                 08370000
W40007*    PERFORM Z600-GET-MLCNTL-DTES.                                08380000
W40007*                                                                 08390000
W40007*    DISPLAY ' MLCNTL-OPN-FSCL-MN-DTE:  '                         08400000
W40007*              MLCNTL-OPN-FSCL-MN-DTE                             08410000
W40007*            ' MLCNTL-OPN-FSCL-MN-NBR:  '                         08420000
W40007*              MLCNTL-OPN-FSCL-MN-NBR                             08430000
W40007*    DISPLAY ' MLCNTL-PSTG-FSCL-WK-DTE: '                         08440000
W40007*              MLCNTL-PSTG-FSCL-WK-DTE                            08450000
W40007*            ' MLCNTL-PSTG-FSCL-WK-NBR: '                         08460000
W40007*              MLCNTL-PSTG-FSCL-WK-NBR.                           08470000
W40007*    DISPLAY ' MLCNTL-PSTG-FSCL-MN-DTE: '                         08480000
W40007*              MLCNTL-PSTG-FSCL-MN-DTE                            08490000
W40007*            ' MLCNTL-PSTG-FSCL-MN-NBR: '                         08500000
W40007*              MLCNTL-PSTG-FSCL-MN-NBR.                           08510000
W40007*    DISPLAY ' '.                                                 08520000
W40007*                                                                 08530000
W40007*    MOVE MLCNTL-PSTG-FSCL-WK-DTE TO DTATTR-KY-DTE.               08540000
W40007*    PERFORM Z610-GET-DTE-ATTRIBUTES.                             08550000
W40007*    MOVE DTATTR-FSCL-YR-NBR      TO PV-PSTG-FSCL-YR-NBR.         08560000
W40007*    MOVE DTATTR-FSCL-MN-BEG-DTE  TO PV-FSCL-MN-BEG-DTE.          08570000
W40007*    MOVE DTATTR-FSCL-MN-END-DTE  TO PV-FSCL-MN-END-DTE.          08571000
W40007*    DISPLAY '--> PV-FSCL-MN-BEG-DTE = '                          08572000
W40007*        PV-FSCL-MN-BEG-DTE.                                      08573000
W40007*    DISPLAY '--> ALTERNATE END DATE FOR CUTOFF WEEK = '          08572000
W40007*        PV-FSCL-MN-END-DTE.                                      08573000
W40007*    MOVE MLCNTL-PSTG-FSCL-WK-DTE TO PV-ISO-DTE.                  08580000
W40007*    STRING PV-ISO-MM        DELIMITED BY SIZE                    08590000
W40007*          '/'               DELIMITED BY SIZE                    08600000
W40007*           PV-ISO-DD        DELIMITED BY SIZE                    08610000
W40007*          '/'               DELIMITED BY SIZE                    08620000
W40007*           PV-ISO-YY        DELIMITED BY SIZE                    08630000
W40007*                                INTO PV-PROC-GREG-FMT-DTE.       08640000
W40007*                                                                 08650000
W40007*                                                                 08660000
W40007*    MOVE MLCNTL-OPN-FSCL-MN-DTE  TO DTATTR-KY-DTE.               08670000
W40007*    PERFORM Z610-GET-DTE-ATTRIBUTES.                             08680000
W40007*    MOVE DTATTR-FSCL-YR-NBR      TO PV-OPN-FSCL-YR-NBR.          08690000
W40007*                                                                 08700000
W40007*    MOVE DTATTR-NFM-END-DTE      TO DTATTR-KY-DTE.               08710000
W40007*    PERFORM Z610-GET-DTE-ATTRIBUTES.                             08720000
W40007*    MOVE DTATTR-FSCL-YR-NBR      TO PV-NEXT-FSCL-YR-NBR.         08730000
W40007*    MOVE DTATTR-FSCL-MN-NBR      TO PV-NEXT-FSCL-MN-NBR.         08740000
W40007*                                                                 08750000
W40007*                                                                 08760000
W40007*B130-TABLE-STORE-INFO.                                           08770000
W40007*                                                                 08780000
W40007*    MOVE 'B130-TABLE-STORE-INFO' TO PV-PARA.                     08790000
W40007*                                                                 08800000
W40007*    EXEC SQL                                                     08810000
W40007*        OPEN XMTLOC_CURSOR                                       08820000
W40007*    END-EXEC                                                     08830000
W40007*                                                                 08840000
W40007*    IF SQLCODE NOT = +0                                          08850000
W40007*        MOVE 'OPEN XMTLOC CURSOR'    TO PV-DB2-OPER-ATTEMPTED    08860000
W40007*        PERFORM Z900-SQL-ABEND                                   08870000
W40007*    END-IF                                                       08880000
W40007*                                                                 08890000
W40007*    INITIALIZE STORE-TABLE                                       08900000
W40007*    MOVE HIGH-VALUES TO STORE-TABLE                              08900000
W40007*                                                                 08910000
W40007*    PERFORM VARYING ST-IDX FROM 1 BY 1                           08920000
W40007*      UNTIL END-OF-XMTLOC-CURSOR                                 08930000
W40007*         OR ST-IDX > PC-MAX-STORES                               08940000
W40007*        EXEC SQL                                                 08950000
W40007*            FETCH XMTLOC_CURSOR                                  08960000
W40007*             INTO :XMT00001-LOC-NBR                              08970000
W40007*        END-EXEC                                                 08980000
W40007*        EVALUATE TRUE                                            08990000
W40007*            WHEN SQLCODE = +0                                    09000000
W40007*                MOVE XMT00001-LOC-NBR TO PV-LOC-NBR              09001000
W40007*                MOVE PV-LOC-NBR-ALPHA TO ST-STORE-NMBR(ST-IDX)   09010000
W40007*                MOVE XMT00001-LOC-NBR TO INVPAR-LOC-NBR          09021000
W40007*                EXEC SQL                                         09030000
W40007*                    SELECT  A.INV_ID                             09040000
W40007*                          , PLND_INV_DTE                         09040000
W40007*                          , ACTL_DC_CTOFF_DTE                    09050000
W40007*                          , SCHD_PHY_CNT_CDE                     09060000
W40007*                          , MFSTNG_IND                           09070000
W40007*                          , FINCL_INV_STAT_CDE                           
W40007*                    INTO    :INVPAR-INV-ID                       09080000
W40007*                          , :INVPAR-PLND-INV-DTE                 09080000
W40007*                          , :INVPAR-ACTL-DC-CTOFF-DTE            09090000
W40007*                          , :INVPAR-SCHD-PHY-CNT-CDE             09100000
W40007*                          , :INVPAR-MFSTNG-IND                   09110000
W40007*                          , :INVPAR-FINCL-INV-STAT-CDE                   
W40007*                    FROM    TINVPAR A                            09120000
W40007*                          , TINCNTL B                            09120000
W40007*                    WHERE   LOC_NBR = :INVPAR-LOC-NBR            09130000
W40007*                      AND   ACTL_FIN_BK_DTE = '9999-09-09'       09140000
W40007*                      AND   LOC_INV_STAT_CDE = 'IN'                      
W40007*                      AND   A.ACTL_LDG_CTOF_TMST                         
W40007*                              <> '9999-12-31-23.59.59.999999'            
W40007*                      AND   A.INV_ID = B.INV_ID                          
W40007*                      AND   B.ACTV_IND = 'Y'                             
W40007*                    WITH UR                                      09150000
W40007*                END-EXEC                                         09160000
W40007*                EVALUATE TRUE                                    09170000
W40007*                    WHEN SQLCODE = +0                            09180000
W40007*                        MOVE INVPAR-INV-ID TO                            
W40007*                             ST-INV-ID(ST-IDX)                           
W40007*                        MOVE INVPAR-PLND-INV-DTE TO              09190000
W40007*                             ST-PLND-INV-DTE(ST-IDX)             09200000
W40007*                        MOVE INVPAR-ACTL-DC-CTOFF-DTE TO         09210000
W40007*                             ST-ACTL-DC-CTOFF-DTE(ST-IDX)        09220000
W40007*                        MOVE INVPAR-SCHD-PHY-CNT-CDE TO          09230000
W40007*                             ST-SCHD-INV-CDE(ST-IDX)             09240000
W40007*                        MOVE INVPAR-MFSTNG-IND TO                09250000
W40007*                             ST-MFSTNG-IND(ST-IDX)               09260000
W40007*                        MOVE INVPAR-FINCL-INV-STAT-CDE TO                
W40007*                             ST-FINCL-BK-STAT(ST-IDX)                    
W40007*                    WHEN SQLCODE = +100                          09270000
W40007*                    INITIALIZE ST-INV-ID(ST-IDX)                         
W40007*                    INITIALIZE ST-PLND-INV-DTE(ST-IDX)                   
W40007*                    INITIALIZE ST-ACTL-DC-CTOFF-DTE(ST-IDX)              
W40007*                    INITIALIZE ST-SCHD-INV-CDE(ST-IDX)                   
W40007*                    INITIALIZE ST-MFSTNG-IND(ST-IDX)                     
W40007*                        CONTINUE                                 09280000
W40007*                    WHEN OTHER                                   09290000
W40007*                        DISPLAY ' LOCATION: ' INVPAR-LOC-NBR             
W40007*                        MOVE 'TINVPAR SELECT'                    09300000
W40007*                                      TO  PV-DB2-OPER-ATTEMPTED  09310000
W40007*                        PERFORM Z900-SQL-ABEND                   09320000
W40007*                END-EVALUATE                                     09330000
W40007*            WHEN SQLCODE = +100                                  09340000
W40007*                SET END-OF-XMTLOC-CURSOR TO TRUE                 09350000
W40007*            WHEN OTHER                                           09360000
W40007*                MOVE 'XMTLOC FETCH'                              09370000
W40007*                              TO  PV-DB2-OPER-ATTEMPTED          09380000
W40007*                PERFORM Z900-SQL-ABEND                           09390000
W40007*        END-EVALUATE                                             09400000
W40007*    END-PERFORM                                                  09410000
W40007*                                                                 09420000
W40007*    EXEC SQL                                                     09430000
W40007*       CLOSE XMTLOC_CURSOR                                       09440000
W40007*    END-EXEC                                                     09450000
W40007*                                                                 09460000
W40007*    IF ST-IDX > PC-MAX-STORES                                    09470000
W40007*        DISPLAY '** PROGRAM ABEND **'                            09480000
W40007*        DISPLAY 'EIKUP001  - MORE THAN 9999 STORES'              09490000
W40007*        MOVE +4003              TO ABEND-CODE                    09500000
W40007*        PERFORM Z999-ABEND                                       09510000
W40007*    END-IF.                                                      09520000
W40007*                                                                 09530000
W40007*B140-TABLE-DEPT-CLASS-INFO.                                      09540000
W40007*                                                                 09550000
W40007*    MOVE 'B140-TABLE-DEPT-CLASS-INFO' TO PV-PARA.                09560000
W40007*                                                                 09570000
W40007*    EXEC SQL                                                     09580000
W40007*        OPEN TMDSEAR_CURSOR                                      09590000
W40007*    END-EXEC                                                     09600000
W40007*                                                                 09610000
W40007*    IF SQLCODE NOT = +0                                          09620000
W40007*        MOVE 'OPEN TMDSEAR/TAPLAVL CURSOR' TO                    09630000
W40007*              PV-DB2-OPER-ATTEMPTED                              09640000
W40007*        PERFORM Z900-SQL-ABEND                                   09650000
W40007*    END-IF                                                       09660000
W40007*                                                                 09670000
      **    ---------+---------+---------+---------+---------+---------+09680000
      **    DEPT_NBR  SUB_CL_NBR              ** COMMENTS BELOW: **     09690000
      **    ---------+---------+---------+---------+---------+---------+09700000
      **    011       TOT                  45 ** DPT 11 HAS 45 SUB_CL'S 09710000
      **    011       010                   0                           09720000
      **    011       011                   0                           09730000
      **    .         .                     .                           09740000
      **    .         .                     .                           09750000
      **    012       TOT                  78 ** DPT 12 HAS 78 SUB_CL'S 09760000
      **    012       010                   0                           09770000
      **    .         .                     .                           09780000
      **    .         .                     .                           09790000
W31475*    INITIALIZE DEPARTMENT-CLASS-TABLE                            09800000
W40007*    MOVE HIGH-VALUES TO DEPARTMENT-CLASS-TABLE                   09800000
W40007*                                                                 09810000
W40007*    SET DC-IDX TO +1                                             09820000
      *--> ** DON'T DO A "PERFORM VARYING" HERE.  RATHER, INCREMENT     09830000
      *--> ** DC-IDX WHEN YOU KNOW YOU'RE DEALING WITH "REAL" CLASSES   09840000
      *--> ** (AS OPPOSED TO THE 'TOT' CLASS)                           09850000
W40007*                                                                 09860000
W40007*    PERFORM                                                      09870000
W40007*      UNTIL SQLCODE NOT = +0                                     09880000
W40007*         OR DC-IDX > PC-MAX-DEPT-CLASS                           09890000
W40007*        EXEC SQL                                                 09900000
W40007*            FETCH TMDSEAR_CURSOR                                 09910000
W40007*             INTO :MDSEAR-DEPT-NBR                               09920000
W40007*                 ,:MDSEAR-SUB-CL-NBR                             09930000
W40007*                 ,:PV-DEPT-CLASS-COUNT                           09940000
W40007*        END-EXEC                                                 09950000
W40007*        EVALUATE TRUE                                            09960000
W40007*            WHEN SQLCODE = +0                                    09970000
      *-->             ** WHEN FETCHING A DEPT FOR THE 1ST TIME,        09980000
      *-->             ** (THE "'TOT'" ROW) KEEP IT'S CLASS COUNT AND   09990000
      *-->             ** APPLY THIS VALUE TO ALL DEPT/CLASS COMBO'S    10000000
      *-->             ** FOR THE CURRENT DEPT.                         10010000
W40007*                IF MDSEAR-SUB-CL-NBR = 'TOT'                     10020000
W40007*                    MOVE PV-DEPT-CLASS-COUNT       TO            10030000
W40007*                         PV-NBR-OF-CLASSES-IN-DEPT               10040000
W40007*                ELSE                                             10050000
W40007*                 IF PV-DEPT-HLD NOT =  MDSEAR-DEPT-NBR                   
W40007*                   OR   PV-DEPT-CLASS-HLD NOT =                          
W40007*                         MDSEAR-SUB-CL-NBR(2:2)                          
W40007*                    MOVE MDSEAR-DEPT-NBR           TO            10060000
W40007*                         DC-DEPT-NBR(DC-IDX)                     10070000
W40007*                         PV-DEPT-HLD                                     
      *-->                 ** ONLY STORE THE RIGHTMOST 2 CHARS OF CLASS 10080000
W40007*                    MOVE MDSEAR-SUB-CL-NBR(2:2)    TO            10090000
W40007*                         DC-CLASS-NBR(DC-IDX)                    10100000
W40007*                         PV-DEPT-CLASS-HLD                               
W40007*                    MOVE PV-NBR-OF-CLASSES-IN-DEPT TO            10110000
W40007*                         DC-NBR-OF-CLASSES-IN-DEPT(DC-IDX)       10120000
W40007*                    SET DC-IDX UP BY 1                           10140000
W40007*                 END-IF                                          10150000
W40007*                END-IF                                           10150000
W40007*            WHEN SQLCODE = +100                                  10160000
W40007*                CONTINUE                                         10170000
W40007*            WHEN OTHER                                           10180000
W40007*                MOVE 'TMDSEAR/TMAPAVL FETCH'                     10190000
W40007*                              TO  PV-DB2-OPER-ATTEMPTED          10200000
W40007*                PERFORM Z900-SQL-ABEND                           10210000
W40007*        END-EVALUATE                                             10220000
W40007*    END-PERFORM.                                                 10230000
W40007*                                                                 10240000
W40007*    EXEC SQL                                                     10250000
W40007*       CLOSE TMDSEAR_CURSOR                                      10260000
W40007*    END-EXEC.                                                    10270000
W40007*                                                                 10280000
W40007*    IF DC-IDX > PC-MAX-DEPT-CLASS                                10290000
W40007*        DISPLAY '** PROGRAM ABEND **'                            10300000
W40007*        DISPLAY 'EIKUP001  - MAX # OF DEPT/CLASSES EXCEEDED'     10310000
W40007*        MOVE +4004              TO ABEND-CODE                    10320000
W40007*        PERFORM Z999-ABEND                                       10330000
W40007*    END-IF.                                                      10340000
                                                                        10350000
                                                                        10360000
       B150-INIT-TRANS-ACCUM-TABLE.                                     10370000
                                                                        10380000
           INITIALIZE TRANS-ACCUMS-TABLE.                               10390000
                                                                        10400000
           MOVE '10'                    TO TR-TRANS-CDE      (1)        10410000
           MOVE 'PURCH'                 TO TR-TRANS-CDE-DESC (1)        10420000
                                                                        10430000
           MOVE '20'                    TO TR-TRANS-CDE      (2)        10440000
           MOVE 'SALES'                 TO TR-TRANS-CDE-DESC (2)        10450000
                                                                        10460000
           MOVE '30'                    TO TR-TRANS-CDE      (3)        10470000
           MOVE 'XFR FM'                TO TR-TRANS-CDE-DESC (3)        10480000
                                                                        10490000
           MOVE '31'                    TO TR-TRANS-CDE      (4)        10500000
           MOVE 'XFR TO'                TO TR-TRANS-CDE-DESC (4)        10510000
                                                                        10520000
           MOVE '40'                    TO TR-TRANS-CDE      (5)        10530000
           MOVE 'MKDWN'                 TO TR-TRANS-CDE-DESC (5)        10540000
                                                                        10550000
           MOVE '50'                    TO TR-TRANS-CDE      (6)        10560000
           MOVE 'MARKUP'                TO TR-TRANS-CDE-DESC (6)        10570000
                                                                        10580000
           MOVE '80'                    TO TR-TRANS-CDE      (7)        10590000
           MOVE 'ADJST'                 TO TR-TRANS-CDE-DESC (7).       10600000
                                                                        10610000
           MOVE '  '                    TO TR-TRANS-CDE      (8)        10620000
           MOVE 'TOTAL'                 TO TR-TRANS-CDE-DESC (8).       10630000
                                                                        10640000
                                                                        10650000
W40007*B160-WRITE-RPT-FILE-HEADERS.                                     10660000
W40007*                                                                 10670000
W40007*    SET ML025-RPT1-CNTL-CARD-HDR-REC                             10680000
W40007*        ML026-RPT2-CNTL-CARD-HDR-REC TO TRUE.                    10690000
W40007*                                                                 10700000
W40007*    MOVE MLCNTL-PSTG-FSCL-WK-DTE                                 10710000
W40007*                                TO ML025-RPT1-EDIT-DTE           10720000
W40007*                                   ML026-RPT2-EDIT-DTE.          10730000
W40007*                                                                 10740000
W40007*    MOVE PV-OPN-FSCL-YR-NBR     TO ML025-RPT1-CURR-FSCL-YR-CDE.  10750000
W40007*    MOVE MLCNTL-OPN-FSCL-MN-NBR TO ML025-RPT1-CURR-FSCL-PER-CDE. 10760000
W40007*    MOVE PV-NEXT-FSCL-YR-NBR    TO ML025-RPT1-NEXT-FSCL-YR-CDE.  10770000
W40007*    MOVE PV-NEXT-FSCL-MN-NBR    TO ML025-RPT1-NEXT-FSCL-PER-CDE. 10780000
W40007*                                                                 10790000
W40007*    MOVE CC-PROCESSING-MODE     TO ML025-RPT1-PROCESSING-MODE    10800000
W40007*                                   ML026-RPT2-PROCESSING-MODE.   10810000
W40007*                                                                 10820000
W40007*    PERFORM Z998-WRITE-ERROR-FILE.                               10830000
W40007*    PERFORM Z400-WRITE-RPT1-REC.                                 10840000
W40007*                                                                 10850000
      **   SUBSEQUENT RPTX RECS WILL BE DETAILS...                      10860000
W40007*    SET ML025-RPT1-DETAIL-REC                                    10870000
W40007*        ML026-RPT2-DETAIL-ERR-REC    TO TRUE.                    10880000
                                                                        10890000
                                                                        10900000
W40007*B170-GET-SYSTEM-DATE-TIME.                                       10910000
W40007*                                                                 10920000
W40007*    ACCEPT CPU-DATE FROM DATE.                                   10930000
W40007*    MOVE CPU-YEAR   TO DP133O-RUN-YEAR                           10940000
W40007*    MOVE CPU-MONTH  TO DP133O-RUN-MONTH                          10950000
W40007*    MOVE CPU-DAY    TO DP133O-RUN-DAY                            10960000
W40007*                                                                 10970000
W40007*    ACCEPT CPU-TIME FROM TIME.                                   10980000
W40007*    MOVE CPU-HOUR   TO DP133O-RUN-HOUR.                          10990000
W40007*    MOVE CPU-MINUTE TO DP133O-RUN-MINUTE.                        11000000
W40007*    MOVE 'EIKUP001' TO DP133O-PROGRAM-NAME.                      11010000
W40007*                                                                 11020000
                                                                        11030000
       B300-EOJ.                                                        11040000
                                                                        11050000
W40007*    IF PV-LINE-COUNT > +57                                       11060000
W40007*        PERFORM F200-HEADINGS                                    11070000
W40007*    END-IF.                                                      11080000
W40007*                                                                 11090000
W40007*    MOVE SPACE                TO EXCEPTIONS-LINE.                11100000
W40007*    MOVE PV-EX-TOT-TRAN-COUNT TO EX-TOT-TRAN-COUNT.              11110000
W40007*    MOVE PV-EX-TOT-RETAIL     TO EX-TOT-RETAIL.                  11120000
W40007*    MOVE EX-TOTAL-LINE        TO EXCEPTIONS-LINE-DATA.           11130000
W40007*    MOVE '0'                  TO EXCEPTIONS-LINE-CC.             11140000
W40007*    PERFORM F900-WRITE-EXCEPTION-REPORT.                         11150000
W40007*                                                                 11160000
W40007*    IF PV-LINE-COUNT > +57                                       11170000
W40007*        PERFORM F200-HEADINGS                                    11180000
W40007*    END-IF.                                                      11190000
W40007*                                                                 11200000
W40007*    MOVE PC-END-OF-REPORT TO EXCEPTIONS-LINE.                    11210000
W40007*    MOVE '-'              TO EXCEPTIONS-LINE-CC.                 11220000
W40007*    PERFORM F900-WRITE-EXCEPTION-REPORT.                         11230000
W40007*                                                                 11240000
W40007*    PERFORM B310-WRITE-AUDIT-REPORT.                             11250000
W40007     DISPLAY '*----------------------------------------------*'.          
W40007     DISPLAY 'PROGRAM EIKUP001 RECORD COUNTS '                            
W40007     DISPLAY 'TOTAL INPUT RECORDS READ     = '                            
W40007              PV-INPUT-REC-CNT.                                           
W40007     DISPLAY 'TOTAL OUTPUT RECORDS WRITTEN = '                            
W40007              PV-OUTPUT-REC-CNT.                                          
W40007     DISPLAY 'TOTAL ERROR RECORDS WRITTEN  = '                            
W40007              PV-ERROR-REC-CNT.                                           
W40007     DISPLAY '*----------------------------------------------*'.          
W40007     DISPLAY ' PROGRAM EIKUP001 ENDS NORMALLY '.                          
                                                                                
           PERFORM B399-CLOSE-FILES.                                    11260000
                                                                                
W40007*B310-WRITE-AUDIT-REPORT.                                         11290000
W40007*                                                                 11300000
W40007*    MOVE 1             TO DP133O-PAGE-NUMBER.                    11310000
W40007*    MOVE 2             TO DP133O-REPORT-NUMBER.                  11320000
W40007*    MOVE DP133O-STANDRD-HEADER-133-COLS TO AUDIT-LINE.           11330000
W40007*    MOVE '1'           TO AUDIT-LINE-CC                          11340000
W40007*    MOVE ' '           TO AUDIT-HEADER-FONT-INDICATOR            11350000
W40007*                                                                 11360000
W40007*    PERFORM B390-WRITE-AUDIT-LINE.                               11370000
W40007*                                                                 11380000
W40007*    MOVE PV-PROC-GREG-FMT-DTE   TO AD-HDG1-DTE                   11390000
W40007*    IF CC-PROCESSING-MODE-INV-ONLY                               11400000
W40007*        MOVE PC-INVENTORY-ONLY-MODE TO AD-HDG1-PROCESSING-MODE   11410000
W40007*    END-IF.                                                      11420000
W40007*                                                                 11430000
W40007*    MOVE AD-HDG1    TO AUDIT-LINE.                               11440000
W40007*    PERFORM B390-WRITE-AUDIT-LINE.                               11450000
W40007*    MOVE AD-HDG2    TO AUDIT-LINE.                               11460000
W40007*    PERFORM B390-WRITE-AUDIT-LINE.                               11470000
W40007*    MOVE AD-HDG3    TO AUDIT-LINE.                               11480000
W40007*    PERFORM B390-WRITE-AUDIT-LINE.                               11490000
W40007*                                                                 11500000
W40007*    PERFORM VARYING TR-IDX FROM 1 BY 1                           11510000
W40007*        UNTIL TR-IDX > TR-MAX                                    11520000
W40007*                                                                 11530000
W40007*        INITIALIZE AUDIT-DETAIL-LINE                             11540000
W40007*                                                                 11550000
W40007*        MOVE TR-TRANS-CDE      (TR-IDX) TO                       11560000
W40007*             AD-TRANS-CDE                                        11570000
W40007*        MOVE TR-TRANS-CDE-DESC (TR-IDX) TO                       11580000
W40007*             AD-TRANS-CDE-DESC                                   11590000
W40007*        MOVE TR-TRANS-IN       (TR-IDX) TO                       11600000
W40007*             AD-TRANS-IN                                         11610000
W40007*        MOVE TR-TRANS-RTL-IN   (TR-IDX) TO                       11620000
W40007*             AD-TRANS-RTL-IN                                     11630000
W40007*        MOVE TR-TRANS-COST-IN  (TR-IDX) TO                       11640000
W40007*             AD-TRANS-COST-IN                                    11650000
W40007*        MOVE TR-TRANS-ERR      (TR-IDX) TO                       11660000
W40007*             AD-TRANS-ERR                                        11670000
W40007*        MOVE TR-TRANS-RTL-ERR  (TR-IDX) TO                       11680000
W40007*             AD-TRANS-RTL-ERR                                    11690000
W40007*        MOVE TR-TRANS-COST-ERR (TR-IDX) TO                       11700000
W40007*             AD-TRANS-COST-ERR                                   11710000
W40007*        MOVE TR-TRANS-OK       (TR-IDX) TO                       11720000
W40007*             AD-TRANS-OK                                         11730000
W40007*        MOVE TR-TRANS-RTL-OK   (TR-IDX) TO                       11740000
W40007*             AD-TRANS-RTL-OK                                     11750000
W40007*        MOVE TR-TRANS-COST-OK  (TR-IDX) TO                       11760000
W40007*             AD-TRANS-COST-OK                                    11770000
W40007*        MOVE AUDIT-DETAIL-LINE          TO AUDIT-LINE            11780000
W40007*        PERFORM B390-WRITE-AUDIT-LINE                            11790000
      **       ACCUM GRAND TOTALS                                       11800000
W40007*        IF TR-IDX < TR-MAX                                       11810000
W40007*            ADD  TR-TRANS-IN       (TR-IDX) TO                   11820000
W40007*                 TR-TRANS-IN       (TR-MAX)                      11830000
W40007*            ADD  TR-TRANS-RTL-IN   (TR-IDX) TO                   11840000
W40007*                 TR-TRANS-RTL-IN   (TR-MAX)                      11850000
W40007*            ADD  TR-TRANS-COST-IN  (TR-IDX) TO                   11860000
W40007*                 TR-TRANS-COST-IN  (TR-MAX)                      11870000
W40007*            ADD  TR-TRANS-ERR      (TR-IDX) TO                   11880000
W40007*                 TR-TRANS-ERR      (TR-MAX)                      11890000
W40007*            ADD  TR-TRANS-RTL-ERR  (TR-IDX) TO                   11900000
W40007*                 TR-TRANS-RTL-ERR  (TR-MAX)                      11910000
W40007*            ADD  TR-TRANS-COST-ERR (TR-IDX) TO                   11920000
W40007*                 TR-TRANS-COST-ERR (TR-MAX)                      11930000
W40007*            ADD  TR-TRANS-OK       (TR-IDX) TO                   11940000
W40007*                 TR-TRANS-OK       (TR-MAX)                      11950000
W40007*            ADD  TR-TRANS-RTL-OK   (TR-IDX) TO                   11960000
W40007*                 TR-TRANS-RTL-OK   (TR-MAX)                      11970000
W40007*            ADD  TR-TRANS-COST-OK  (TR-IDX) TO                   11980000
W40007*                 TR-TRANS-COST-OK  (TR-MAX)                      11990000
W40007*        END-IF                                                   12000000
W40007*    END-PERFORM.                                                 12010000
W40007*                                                                 12020000
      **   THE NET CHANGE IN INVENTORY AS A RESULT OF THIS RUN IS:      12030000
                                                                        12040000
      **      INCREASES INVENTORY:         REDUCES INVENTORY:           12050000
                                                                        12060000
      **          PURCHASES                     SALES                   12070000
      **          MARKUPS                       MARKDOWNS               12080000
      **          TRANSFER TO'S                 TRANSFER FROM'S         12090000
      **                                        ADJUSTMENTS             12100000
                                                                        12110000
W40007*    COMPUTE  PV-NET-CHANGE-IN-RETAIL    =                        12120000
W40007*        TR-TRANS-RTL-OK (1) - TR-TRANS-RTL-OK (2)                12130000
W40007*      - TR-TRANS-RTL-OK (3) + TR-TRANS-RTL-OK (4)                12140000
W40007*      - TR-TRANS-RTL-OK (5) + TR-TRANS-RTL-OK (6)                12150000
W40007*      - TR-TRANS-RTL-OK (7)                                      12160000
W40007*                                                                 12170000
W40007*    COMPUTE  PV-NET-CHANGE-IN-COST      =                        12180000
W40007*        TR-TRANS-COST-OK (1) - TR-TRANS-COST-OK (2)              12190000
W40007*      - TR-TRANS-COST-OK (3) + TR-TRANS-COST-OK (4)              12200000
W40007*      - TR-TRANS-COST-OK (5) + TR-TRANS-COST-OK (6)              12210000
W40007*      - TR-TRANS-COST-OK (7)                                     12220000
W40007*                                                                 12230000
W40007*    MOVE PV-NET-CHANGE-IN-RETAIL    TO                           12240000
W40007*         NC-RETAIL-AMT                                           12250000
W40007*    MOVE PV-NET-CHANGE-IN-COST      TO                           12260000
W40007*         NC-COST-AMT                                             12270000
W40007*                                                                 12280000
W40007*    MOVE NET-CHANGE-IN-INVENTORY-LINE TO AUDIT-LINE.             12290000
W40007*    PERFORM B390-WRITE-AUDIT-LINE.                               12300000
W40007*                                                                 12310000
W40007*    MOVE PC-END-OF-REPORT TO AUDIT-LINE                          12320000
W40007*    PERFORM B390-WRITE-AUDIT-LINE.                               12330000
W40007*                                                                 12340000
W40007*                                                                 12350000
W40007*B390-WRITE-AUDIT-LINE.                                           12360000
W40007*                                                                 12370000
W40007*    WRITE  AUDIT-LINE.                                           12380000
                                                                        12390000
                                                                        12400000
       B399-CLOSE-FILES.                                                12410000
                                                                        12420000
           CLOSE       COMPOSITE-FILE                                   12430000
W40007*                CONTROL-CARD-FILE                                12440000
                       PURCH-FILE                                       12450000
                       SALE-FILE                                        12460000
                       PRC-CHG-FILE                                     12470000
                       ADJUSTMENT-FILE                                  12480000
                       REPORT-FILE                                      12490000
                       ERROR-FILE                                       12500000
W29145                 DW-PRC-CHG-FILE                                  12500000
W28582                 BV-PRC-CHG-FILE                                  12500000
W28582                 BV-PURCH-FILE                                    12500000
                       AUDIT-REPORT-FILE                                12510000
                       EXCEPTIONS-REPORT-FILE.                          12520000
                                                                        12530000
                                                                        12540000
       C100-PROCESS-STORES.                                             12550000
                                                                        12560000
           INITIALIZE ML026-RPT2-ERR-RECORD                             12570000
W40007     INITIALIZE ERROR-PRICE-CHANGE-RECORD                         12570000
                                                                        12580000
           SET PV-NO-HIGH-LEVEL-ERROR TO TRUE                           12590000
                                                                        12600000
W40007*    MOVE ML020-STORE-NBR TO PV-STORE-NBR                         12610000
W40007     MOVE ML044-PC-STORE-NBR TO PV-STORE-NBR                      12610000
                                                                        12620000
      **   EVEN IF THE STORE NUMBER IS INVALID, SPIN THRU THE ENTIRE    12630000
      **   RECORD TO FIND ALL OTHER ERRORS                              12640000
                                                                        12650000
W40007*    SET ST-IDX TO 1                                              12660000
W40007*    SEARCH ALL STORE-ENTRIES                                     12670000
W40007*        AT END                                                   12680000
W40007*            SET ML027-ERR-NOT-FOUND   TO TRUE                    12690000
W40007*            MOVE ML027-ERR-CDE        TO ML026-RPT2-STORE-NBR-ERR12700000
W40007*                                         ERROR-CDE               12700000
W40007*            SET PV-STORE-LEVEL-ERROR  TO TRUE                    12710000
W40007*        WHEN                                                     12720000
W40007*            ST-STORE-NMBR (ST-IDX) = ML020-STORE-NBR             12730000
W40007*                NEXT SENTENCE                                    12740000
                                                                        12750000
W40007*    END-SEARCH.                                                  12760000
                                                                        12770000
           PERFORM C110-PROCESS-DEPTS-IN-STORE                          12780000
W40007*        UNTIL ML020-STORE-NBR NOT = PV-STORE-NBR OR              12790000
W40007         UNTIL ML044-PC-STORE-NBR NOT = PV-STORE-NBR OR           12790000
                     END-OF-COMPOSITE-FILE.                             12800000
                                                                        12810000
                                                                        12820000
       C110-PROCESS-DEPTS-IN-STORE.                                     12830000
                                                                        12840000
           MOVE SPACES              TO ML026-RPT2-DEPT-CLASS-ERR        12850000
W40007*    MOVE ML020-DEPT-CLASS    TO PV-DEPT-CLASS                    12860000
W40007     MOVE ML044-PC-DEPT-CLASS TO PV-DEPT-CLASS                    12860000
           SET PV-NOT-SPLIT-FREIGHT TO TRUE                             12870000
                                                                        12880000
      **   IF THE STORE IS BAD, EVERYTHING W/IN THIS STORE MUST BE      12890000
      **   REJECTED.  OTHERWISE, RESET THE HIGH LEVEL ERROR INDICATOR.  12900000
                                                                        12910000
           IF PV-STORE-LEVEL-ERROR                                      12920000
               CONTINUE                                                 12930000
           ELSE                                                         12940000
               SET PV-NO-HIGH-LEVEL-ERROR TO TRUE                       12950000
               INITIALIZE ML026-RPT2-ERR-RECORD                         12960000
W40007         INITIALIZE ERROR-PRICE-CHANGE-RECORD                     12960000
           END-IF                                                       12970000
                                                                        12980000
W40007*    IF ML020-DEPT-CLASS NUMERIC                                  12990000
W40007*      IF ML020-DEPT-CLASS NOT EQUAL '00000'                      12991000
W40007*        IF ML020-CLASS-NBR = '00'                                13000000
W40007*            IF ML020-PURCHASE                                    13010000
W40007*                IF ML020-PURCH-DR-CR-CDE = '07' OR '08'          13020000
W40007*-->                 ** SPLIT FREIGHT DR/CR IS OK **              13030000
W40007*                    SET PV-SPLIT-FREIGHT TO TRUE                 13040000
W40007*                ELSE                                             13050000
W40007*                    SET ML027-ERR-INVALID-VALUE    TO TRUE       13060000
W40007*                    MOVE ML027-ERR-CDE             TO            13070000
W40007*                         ML026-RPT2-DEPT-CLASS-ERR               13080000
W40007*                    SET PV-DEPT-LEVEL-ERROR   TO TRUE            13090000
W40007*                END-IF                                           13100000
W40007*            ELSE                                                 13110000
W40007*                SET ML027-ERR-INVALID-VALUE    TO TRUE           13120000
W40007*                MOVE ML027-ERR-CDE             TO                13130000
W40007*                     ML026-RPT2-DEPT-CLASS-ERR                   13140000
W40007*                SET PV-DEPT-LEVEL-ERROR   TO TRUE                13150000
W40007*            END-IF                                               13160000
W40007     IF ML044-PC-DEPT-CLASS NUMERIC                               12990000
W40007       IF ML044-PC-DEPT-CLASS NOT EQUAL '00000'                   12991000
W40007         IF ML044-PC-CLASS-NBR = '00'                             13000000
W40007            CONTINUE                                                      
               END-IF                                                   13170000
W21731       ELSE                                                       13180000
W21731          SET ML027-ERR-SKU-NOT-FOUND TO TRUE                     13180100
W21731          MOVE ML027-ERR-CDE          TO ML026-RPT2-SKU-ERR       13180200
W40007                                         ERROR-CDE                13180200
W21731          SET PV-SKU-LEVEL-ERROR     TO TRUE                      13180300
           ELSE                                                         13181000
               SET ML027-ERR-NON-NUMERIC   TO TRUE                      13182000
               MOVE ML027-ERR-CDE          TO ML026-RPT2-DEPT-CLASS-ERR 13183000
W40007                                        ERROR-CDE                 13180200
               SET PV-DEPT-LEVEL-ERROR     TO TRUE                      13184000
           END-IF                                                       13220000
                                                                        13230000
      **   EVEN IF THE DEPT/CLASS IS INVALID, SPIN THRU THE ENTIRE      13240000
      **   RECORD TO FIND ALL OTHER ERRORS                              13250000
                                                                        13260000
W40007*    IF ML020-CLASS-NBR = '00'                                    13270000
W40007*        MOVE ML020-DEPT-CLASS TO PV-DEPT-CLASS                   13280000
W40007*    ELSE                                                         13290000
W40007*        SET DC-IDX TO 1                                          13300000
W40007*                                                                 13310000
W40007*        SEARCH ALL DEPT-CLASS-ENTRIES                            13320000
W40007*            AT END                                               13330000
W40007*                SET ML027-ERR-NOT-FOUND        TO TRUE           13340000
W40007*                MOVE ML027-ERR-CDE             TO                13350000
W40007*                     ML026-RPT2-DEPT-CLASS-ERR                   13360000
W40007*                SET PV-DEPT-LEVEL-ERROR        TO TRUE           13370000
W40007*                                                                 13380000
W40007*            WHEN DC-DEPT-CLASS (DC-IDX) = ML020-DEPT-CLASS       13390000
W40007*             OR  DC-DEPT-CLASS (DC-IDX) = (SPACES OR LOW-VALUES) 13400000
W40007*                NEXT SENTENCE                                    13410000
W40007*                                                                 13420000
W40007*        END-SEARCH                                               13430000
W40007*    END-IF.                                                      13440000
W40007*                                                                 13450000
W40007*    IF DC-DEPT-CLASS (DC-IDX) = (SPACES OR LOW-VALUES)           13460000
W40007*        SET ML027-ERR-NOT-FOUND        TO TRUE                   13470000
W40007*        MOVE ML027-ERR-CDE             TO                        13480000
W40007*             ML026-RPT2-DEPT-CLASS-ERR                           13490000
W40007*        SET PV-DEPT-LEVEL-ERROR        TO TRUE                   13500000
W40007*    END-IF.                                                      13510000
                                                                        13520000
           PERFORM C150-PROCESS-DEPT-CLASS-ACTVTY                       13530000
W40007*        UNTIL ML020-DEPT-CLASS NOT = PV-DEPT-CLASS OR            13540000
W40007*              ML020-STORE-NBR  NOT = PV-STORE-NBR  OR            13550000
W40007         UNTIL ML044-PC-DEPT-CLASS NOT = PV-DEPT-CLASS OR         13540000
W40007               ML044-PC-STORE-NBR  NOT = PV-STORE-NBR  OR         13550000
                     END-OF-COMPOSITE-FILE.                             13560000
                                                                        13570000
                                                                        13580000
       C150-PROCESS-DEPT-CLASS-ACTVTY.                                  13590000
                                                                        13600000
      **   IF THERE'S A HIGH LEVEL ERROR, (BAD STORE OR DEPT/CLASS),    13610000
      **   PROCESS THIS DETAIL, BUT DON'T WRITE OUT A "GOOD" RECORD.    13620000
      **   ALL THE DETAILS FOR THIS CONTROL-BREAK MUST BE REJECTED.     13630000
                                                                        13640000
      **   IF THERE ISN'T A HIGH LEVEL ERROR, RESET THE DETAIL ERROR SW 13650000
                                                                        13660000
           IF PV-HIGH-LEVEL-ERROR                                       13670000
      **-->    ** A STORE NBR OR DEPT/CLASS ERROR EXISTS FOR THIS REC,  13680000
      **-->    ** BUT INITIALIZE ANY OTHER ERROR FIELDS.                13690000
               SET PV-DTL-ERROR    TO TRUE                              13700000
               INITIALIZE ML026-RPT2-DETAIL-DATA-AREA                   13710000
           ELSE                                                         13720000
               SET PV-NO-DTL-ERROR TO TRUE                              13730000
               INITIALIZE ML026-RPT2-ERR-RECORD                         13740000
W40007         INITIALIZE ERROR-PRICE-CHANGE-RECORD                     13740000
           END-IF                                                       13750000
                                                                        13760000
           EVALUATE TRUE                                                13770000
W40007*        WHEN ML020-PURCHASE                                      13780000
W40007*            PERFORM D100-PROCESS-PURCHASE                        13790000
W40007*        WHEN ML020-SALE                                          13800000
W40007*            PERFORM E100-PROCESS-SALE                            13810000
W40007*        WHEN ML020-STORE-TRANSFER                                13820000
W40007*            PERFORM F100-PROCESS-TRANSFER                        13830000
W40007*        WHEN ML020-PRICE-CHANGE                                  13840000
W40007         WHEN ML044-VALID-PC-CDE                                  13840000
                   PERFORM G100-PROCESS-PRICE-CHANGE                    13850000
W40007*        WHEN ML020-ADJUSTMENT                                    13860000
W40007*            PERFORM H100-PROCESS-ADJUSTMENTS                     13870000
               WHEN OTHER                                               13880000
                   DISPLAY 'INVALID TRANSACTION CODE: '                 13890000
W40007*                ML020-TRANS-CDE                                  13900000
W40007                 ML044-PC-CDE                                     13900000
                   PERFORM Z999-INVALID-PRESET-VALUE-ABND               13910000
           END-EVALUATE.                                                13920000
                                                                        13930000
           PERFORM Z100-READ-COMPOSITE-FILE.                            13940000
                                                                        13950000
                                                                        13960000
W40007*D100-PROCESS-PURCHASE.                                           13970000
                                                                        13980000
W40007*    ADD 1                                  TO TR-TRANS-IN (1)    13990000
W40007*                                                                 14000000
W40007*    IF ML020-PURCH-EXTD-RTL-AMT  NUMERIC                         14010000
W40007*        IF ML020-PURCH-CR                                        14020000
W40007*           ADD ML020-PURCH-EXTD-RTL-AMT      TO                  14030000
W40007*               TR-TRANS-RTL-IN (1)                               14040000
W40007*        ELSE                                                     14050000
W40007*           SUBTRACT ML020-PURCH-EXTD-RTL-AMT FROM                14060000
W40007*               TR-TRANS-RTL-IN (1)                               14070000
W40007*        END-IF                                                   14080000
W40007*    END-IF                                                       14090000
                                                                        14100000
W40007*    IF ML020-PURCH-EXTD-NET-COST-AMT  NUMERIC                    14110000
W40007*        IF ML020-PURCH-CR                                        14120000
W40007*            ADD ML020-PURCH-EXTD-NET-COST-AMT       TO           14130000
W40007*                TR-TRANS-COST-IN (1)                             14140000
W40007*        ELSE                                                     14150000
W40007*            SUBTRACT ML020-PURCH-EXTD-NET-COST-AMT  FROM         14160000
W40007*                TR-TRANS-COST-IN (1)                             14170000
W40007*        END-IF                                                   14180000
W40007*    END-IF.                                                      14190000
W40007*                                                                 14200000
W40007*    PERFORM D110-EDIT-ML020.                                     14210000
W40007*                                                                 14220000
W40007*    IF PV-NO-DTL-ERROR                                           14230000
W40007*        PERFORM D130-WRITE-OUTPUT-FILES                          14240000
W40007*    ELSE                                                         14250000
W40007*        PERFORM D180-FORMAT-ERROR-REC                            14260000
W40007*        PERFORM Z998-WRITE-ERROR-FILE                            14270000
W40007*    END-IF.                                                      14280000
W40007*                                                                 14290000
W40007*                                                                 14300000
W40007*D110-EDIT-ML020.                                                 14310000
W40007*                                                                 14320000
W40007*    INITIALIZE ML021-PURCH-RECORD                                14330000
W40007*               ML030-PURCH-RECORD                                14340000
W40007*               ML025-RPT1-DETAIL-RECORD                          14340000
W40007*                                                                 14350000
W40007*    IF ML020-DEPT-CLASS = '09910'                                14360000
W40007*        SET ML027-ERR-INVALID-VALUE   TO TRUE                    14370000
W40007*        MOVE ML027-ERR-CDE            TO                         14380000
W40007*             ML026-RPT2-DEPT-CLASS-ERR                           14390000
W40007*        SET PV-DTL-ERROR TO TRUE                                 14400000
W40007*    END-IF                                                       14410000
W40007*                                                                 14420000
W40007*    IF NOT ML020-PURCH-VALID-DR-CR                               14430000
W40007*        SET ML027-ERR-INVALID-VALUE   TO TRUE                    14440000
W40007*        MOVE ML027-ERR-CDE            TO                         14450000
W40007*             ML026-RPT2-DR-CR-CDE-ERR                            14460000
W40007*        SET PV-DTL-ERROR TO TRUE                                 14470000
W40007*    END-IF                                                       14480000
W40007*                                                                 14490000
W40007*    IF NOT ML020-PURCH-VALID-TYP-CDE                             14500000
W40007*        DISPLAY 'INVALID PURCH TYP CDE ' ML020-PURCH-TYP-CDE     14510000
W40007*        PERFORM Z999-INVALID-PRESET-VALUE-ABND                   14520000
W40007*    END-IF                                                       14530000
W40007*                                                                 14540000
W40007*    IF NOT ML020-PURCH-VALID-JRNL-IND                            14550000
W40007*        DISPLAY 'INVALID PURCH JRNL IND ' ML020-PURCH-JRNL-IND   14560000
W40007*        PERFORM Z999-INVALID-PRESET-VALUE-ABND                   14570000
W40007*    END-IF                                                       14580000
W40007*                                                                 14590000
W40007*    IF ML020-PURCH-DOC-5-NBR NOT NUMERIC                         14600000
W40007*        SET ML027-ERR-NON-NUMERIC     TO TRUE                    14610000
W40007*        MOVE ML027-ERR-CDE            TO                         14620000
W40007*             ML026-RPT2-DOC-5-NBR-ERR                            14630000
W40007*        SET PV-DTL-ERROR TO TRUE                                 14640000
W40007*    END-IF                                                       14650000
W40007*                                                                 14660000
W40007*    IF ML020-PURCH-PO-NBR    NOT NUMERIC                         14670000
W40007*        SET ML027-ERR-NON-NUMERIC     TO TRUE                    14680000
W40007*        MOVE ML027-ERR-CDE            TO                         14690000
W40007*             ML026-RPT2-PO-NBR-ERR                               14700000
W40007*        SET PV-DTL-ERROR TO TRUE                                 14710000
W40007*    END-IF                                                       14720000
W40007*                                                                 14730000
W40007*    IF ML020-PURCH-VEND-NBR  NOT NUMERIC                         14740000
W40007*        SET ML027-ERR-NON-NUMERIC     TO TRUE                    14750000
W40007*        MOVE ML027-ERR-CDE            TO                         14760000
W40007*             ML026-RPT2-VEND-NBR-ERR                             14770000
W40007*        SET PV-DTL-ERROR TO TRUE                                 14780000
W40007*    END-IF                                                       14790000
W40007*                                                                 14800000
W40007*    IF ML020-ACCOUNTS-PAYABLE OR                                 14810000
W40007*       ML020-RECEIPT          OR                                 14820000
W40007*       ML020-PHYSICAL-INVENTORY OR                               14830000
W40007*       ML020-DATA-ENTRY                                          14840000
W40007*        CONTINUE                                                 14850000
W40007*    ELSE                                                         14860000
W40007*        DISPLAY 'INVALID SYST-ORIG-CDE ON A PURCHASE TRAN: '     14870000
W40007*                 ML020-SYST-ORIG-CDE                             14880000
W40007*        PERFORM Z999-INVALID-PRESET-VALUE-ABND                   14890000
W40007*    END-IF                                                       14900000
W40007*                                                                 14910000
W40007*    IF ML020-PURCH-EXTD-GRO-COST-AMT NOT NUMERIC                 14920000
W40007*        SET ML027-ERR-NON-NUMERIC TO TRUE                        14930000
W40007*        MOVE ML027-ERR-CDE TO                                    14940000
W40007*             ML026-RPT2-AMT-ERR                                  14950000
W40007*        SET PV-DTL-ERROR TO TRUE                                 14960000
W40007*    END-IF.                                                      14970000
W40007*                                                                 14980000
W40007*    IF ML020-PURCH-FRGT-AMT NOT NUMERIC                          14990000
W40007*        SET ML027-ERR-NON-NUMERIC TO TRUE                        15000000
W40007*        MOVE ML027-ERR-CDE TO                                    15010000
W40007*             ML026-RPT2-FRGT-AMT-ERR                             15020000
W40007*        SET PV-DTL-ERROR TO TRUE                                 15030000
W40007*    END-IF.                                                      15040000
W40007*                                                                 15050000
W40007*    IF ML020-PURCH-DISC-AMT NOT NUMERIC                          15060000
W40007*        SET ML027-ERR-NON-NUMERIC TO TRUE                        15070000
W40007*        MOVE ML027-ERR-CDE TO                                    15080000
W40007*             ML026-RPT2-DISC-AMT-ERR                             15090000
W40007*        SET PV-DTL-ERROR TO TRUE                                 15100000
W40007*    END-IF.                                                      15110000
W40007*                                                                 15120000
W40007*    IF ML020-PURCH-EXTD-NET-COST-AMT NOT NUMERIC                 15130000
W40007*        SET ML027-ERR-NON-NUMERIC TO TRUE                        15140000
W40007*        MOVE ML027-ERR-CDE TO                                    15150000
W40007*             ML026-RPT2-NET-COST-AMT-ERR                         15160000
W40007*        SET PV-DTL-ERROR TO TRUE                                 15170000
W40007*    END-IF.                                                      15180000
W40007*                                                                 15190000
W40007*    IF ML020-PURCH-EXTD-RTL-AMT NOT NUMERIC                      15200000
W40007*        SET ML027-ERR-NON-NUMERIC TO TRUE                        15210000
W40007*        MOVE ML027-ERR-CDE TO                                    15220000
W40007*             ML026-RPT2-RETAIL-AMT-ERR                           15230000
W40007*        SET PV-DTL-ERROR TO TRUE                                 15240000
W40007*    END-IF.                                                      15250000
W40007*                                                                 15260000
W40007*    IF  ML020-PURCH-EXTD-GRO-COST-AMT NUMERIC                    15270000
W40007*    AND ML020-PURCH-FRGT-AMT          NUMERIC                    15280000
W40007*    AND ML020-PURCH-DISC-AMT          NUMERIC                    15290000
W40007*    AND ML020-PURCH-EXTD-NET-COST-AMT NUMERIC                    15300000
W40007*        COMPUTE PV-NET-COST-AMT                                  15310000
W40007*              = ML020-PURCH-EXTD-GRO-COST-AMT                    15320000
W40007*              + ML020-PURCH-FRGT-AMT                             15330000
W40007*              - ML020-PURCH-DISC-AMT                             15340000
W40007*        IF PV-NET-COST-AMT NOT = ML020-PURCH-EXTD-NET-COST-AMT   15350000
W40007*            SET ML027-ERR-INVALID-VALUE TO TRUE                  15360000
W40007*            MOVE ML027-ERR-CDE TO                                15370000
W40007*                 ML026-RPT2-NET-COST-AMT-ERR                     15380000
W40007*            SET PV-DTL-ERROR TO TRUE                             15390000
W40007*        END-IF                                                   15400000
W40007*    END-IF.                                                      15410000
W40007*                                                                 15420000
W40007*    PERFORM D120-DATE-EDITS.                                     15430000
W40007*                                                                 15440000
W40007*                                                                 15450000
W40007*D120-DATE-EDITS.                                                 15460000
W40007*                                                                 15470000
      ****************************************************************  15480000
      * SET THE FINANCIAL LIABILITY DATE AND DOC DATE ON THE OUTPUT     15490000
      * RECORD AS FOLLOWS:                                              15500000
      *                                                                 15510000
      * FINANCIAL LIABILITY DATE:                                       15520000
      *   IF THERE IS A PURCH-DATE, EDIT IT.  IF IT IS VALID, USE IT    15530000
      *   FOR THE FINANCIAL LIABILITY DATE. IF NOT, ERROR THE RECORD    15540000
      *   OUT.                                                          15550000
      *   IF THERE IS NO PURCH-DATE, EDIT THE DOC-DATE.  IF IT IS VALID,15560000
      *   USE IF FOR THE FINANCIAL LIABILITY DATE.  IF NOT, ERROR THE   15570000
      *   RECORD OUT.                                                   15580000
      *                                                                 15590000
      * DOC DATE:                                                       15600000
      *  IF THE DOC-DATE ON THE INPUT RECORD IS VALID, USE IT.          15610000
      *  IF NOT, LEAVE THE DOC-DATE BLANK.                              15620000
      ****************************************************************  15630000
                                                                        15640000
W40007*    SET PS-NO-DATE-ERROR TO TRUE.                                15650000
W40007*                                                                 15660000
W40007*    IF  ML020-PURCH-DTE NUMERIC                                  15670000
W40007*    AND ML020-PURCH-DTE > ZEROS                                  15680000
W40007*                                                                 15690000
      *        THERE IS A PURCH-DATE, SO EDIT IT. IF IT IS VALID, USE IT15700000
      *        FOR THE FINANCIAL LIABILITY DATE ON THE OUTPUT RECORD.   15710000
W40007*                                                                 15720000
W40007*        MOVE ML020-PURCH-DTE TO PV-EDIT-DTE                      15730000
W40007*        PERFORM Z200-EDIT-DTE                                    15740000
W40007*        IF PS-DATE-ERROR                                         15750000
W40007*            SET ML027-ERR-INVALID-DATE                           15760000
W40007*                PV-DTL-ERROR   TO TRUE                           15770000
W40007*            MOVE ML027-ERR-CDE TO ML026-RPT2-FIN-LIAB-DTE-ERR    15780000
W40007*        ELSE                                                     15790000
W40007*            MOVE EDT-ISO-DTE       (EDT-IDX)                     15800000
W40007*                             TO ML021-PURCH-FIN-LIAB-DTE         15810000
W40007*                                ML030-PURCH-FIN-LIAB-DTE         15810000
W40007*                                ML025-RPT1-FIN-LIAB-DTE          15820000
W40007*            MOVE EDT-FSCL-YR-NBR     (EDT-IDX)                   15830000
W40007*                             TO ML021-PURCH-FSCL-YR              15840000
W40007*                                ML030-PURCH-FSCL-YR              15840000
W40007*            MOVE EDT-FSCL-MN-NBR   (EDT-IDX)                     15850000
W40007*                             TO ML021-PURCH-FSCL-PER             15860000
W40007*                                ML030-PURCH-FSCL-PER             15860000
W40007*            MOVE EDT-WK-IN-MN-NBR  (EDT-IDX)                     15870000
W40007*                             TO ML021-PURCH-FSCL-WK              15880000
W40007*                                ML030-PURCH-FSCL-WK              15880000
W40007*            MOVE EDT-DAY-OF-WK-NBR (EDT-IDX)                     15890000
W40007*                             TO ML021-PURCH-FSCL-DAY             15900000
W40007*                                ML030-PURCH-FSCL-DAY             15900000
W40007*                                                                 15910000
W40007*            MOVE ML021-PURCH-FIN-LIAB-DTE TO PV-FIN-LIAB-DTE     15920000
W40007*            PERFORM Z300-SET-ML-AND-INV-INDS                     15930000
W40007*                                                                 15940000
      *            EDIT THE DOC DATE. IF IT IS VALID, USE IT FOR THE    15950000
      *            DOC DATE ON THE OUTPUT RECORD.                       15960000
                                                                        15970000
W40007*            IF  ML020-PURCH-DOC-DTE NUMERIC                      15980000
W40007*            AND ML020-PURCH-DOC-DTE > ZEROS                      15990000
W40007*                MOVE ML020-PURCH-DOC-MM TO PV-EDIT-MM            16000000
W40007*                MOVE ML020-PURCH-DOC-DD TO PV-EDIT-DD            16010000
W40007*                MOVE SPACE              TO PV-EDIT-YY            16020000
W40007*                PERFORM Z200-EDIT-DTE                            16030000
W40007*                IF PS-NO-DATE-ERROR                              16040000
W40007*                    MOVE EDT-ISO-DTE (EDT-IDX)                   16050000
W40007*                                           TO ML021-PURCH-DOC-DTE16060000
W40007*                                              ML030-PURCH-DOC-DTE16060000
W40007*                END-IF                                           16070000
W40007*            END-IF                                               16080000
W40007*        END-IF                                                   16090000
W40007*    ELSE                                                         16100000
      *        THERE IS NO PURCH-DATE, SO EDIT THE DOC-DATE. IF IT IS   16110000
      *        VALID, USE IT FOR BOTH THE FINANCIAL LIABILITY DATE AND  16120000
      *        THE DOC DATE ON THE OUTPUT RECORD.                       16130000
                                                                        16140000
W40007*        IF  ML020-PURCH-DOC-DTE NUMERIC                          16150000
W40007*        AND ML020-PURCH-DOC-DTE > ZEROS                          16160000
W40007*            MOVE ML020-PURCH-DOC-MM TO PV-EDIT-MM                16170000
W40007*            MOVE ML020-PURCH-DOC-DD TO PV-EDIT-DD                16180000
W40007*            MOVE SPACE              TO PV-EDIT-YY                16190000
W40007*            PERFORM Z200-EDIT-DTE                                16200000
W40007*            IF PS-DATE-ERROR                                     16210000
W40007*                SET ML027-ERR-INVALID-DATE                       16220000
W40007*                    PV-DTL-ERROR   TO TRUE                       16230000
W40007*                MOVE ML027-ERR-CDE TO ML026-RPT2-FIN-LIAB-DTE-ERR16240000
W40007*            ELSE                                                 16250000
W40007*                MOVE EDT-ISO-DTE       (EDT-IDX)                 16260000
W40007*                                 TO ML021-PURCH-FIN-LIAB-DTE     16270000
W40007*                                    ML030-PURCH-FIN-LIAB-DTE     16270000
W40007*                                    ML025-RPT1-FIN-LIAB-DTE      16280000
W40007*                MOVE EDT-FSCL-YR-NBR   (EDT-IDX)                 16290000
W40007*                                 TO ML021-PURCH-FSCL-YR          16300000
W40007*                                    ML030-PURCH-FSCL-YR          16300000
W40007*                MOVE EDT-FSCL-MN-NBR   (EDT-IDX)                 16310000
W40007*                                 TO ML021-PURCH-FSCL-PER         16320000
W40007*                                    ML030-PURCH-FSCL-PER         16320000
W40007*                MOVE EDT-WK-IN-MN-NBR  (EDT-IDX)                 16330000
W40007*                                 TO ML021-PURCH-FSCL-WK          16340000
W40007*                                    ML030-PURCH-FSCL-WK          16340000
W40007*                MOVE EDT-DAY-OF-WK-NBR (EDT-IDX)                 16350000
W40007*                                 TO ML021-PURCH-FSCL-DAY         16360000
W40007*                                    ML030-PURCH-FSCL-DAY         16360000
W40007*                                                                 16370000
W40007*                MOVE ML021-PURCH-FIN-LIAB-DTE TO PV-FIN-LIAB-DTE 16380000
W40007*                PERFORM Z300-SET-ML-AND-INV-INDS                 16390000
W40007*                MOVE EDT-ISO-DTE (EDT-IDX) TO ML021-PURCH-DOC-DTE16400000
W40007*                                              ML030-PURCH-DOC-DTE16400000
W40007*            END-IF                                               16410000
W40007*        ELSE                                                     16420000
W40007*            SET ML027-ERR-INVALID-DATE                           16430000
W40007*                PV-DTL-ERROR   TO TRUE                           16440000
W40007*            MOVE ML027-ERR-CDE TO ML026-RPT2-FIN-LIAB-DTE-ERR    16450000
W40007*        END-IF                                                   16460000
W40007*    END-IF.                                                      16470000
W40007*                                                                 16480000
W40007*                                                                 16490000
W40007*D130-WRITE-OUTPUT-FILES.                                         16500000
W40007*                                                                 16510000
W40007*    ADD 1  TO TR-TRANS-OK (1)                                    16520000
W40007*                                                                 16530000
W40007*    IF ML020-PURCH-EXTD-RTL-AMT  NUMERIC                         16540000
W40007*        IF ML020-PURCH-CR                                        16550000
W40007*           ADD ML020-PURCH-EXTD-RTL-AMT      TO                  16560000
W40007*               TR-TRANS-RTL-OK (1)                               16570000
W40007*        ELSE                                                     16580000
W40007*           SUBTRACT ML020-PURCH-EXTD-RTL-AMT FROM                16590000
W40007*               TR-TRANS-RTL-OK (1)                               16600000
W40007*        END-IF                                                   16610000
W40007*    END-IF                                                       16620000
W40007*                                                                 16630000
W40007*    IF ML020-PURCH-EXTD-NET-COST-AMT  NUMERIC                    16640000
W40007*        IF ML020-PURCH-CR                                        16650000
W40007*            ADD ML020-PURCH-EXTD-NET-COST-AMT       TO           16660000
W40007*                TR-TRANS-COST-OK (1)                             16670000
W40007*        ELSE                                                     16680000
W40007*            SUBTRACT ML020-PURCH-EXTD-NET-COST-AMT  FROM         16690000
W40007*                TR-TRANS-COST-OK (1)                             16700000
W40007*        END-IF                                                   16710000
W40007*    END-IF                                                       16720000
W40007*                                                                 16730000
W40007*    MOVE PV-PSTG-FSCL-YR-NBR     TO ML025-RPT1-FSCL-YR-CDE.      16740000
W40007*    MOVE MLCNTL-PSTG-FSCL-MN-NBR TO ML025-RPT1-FSCL-PER-CDE.     16750000
W40007*                                                                 16760000
W40007*    MOVE ML020-STORE-NBR         TO ML021-PURCH-STORE-NBR        16770000
W40007*                                    ML030-PURCH-STORE-NBR        16780000
W40007*                                    ML025-RPT1-STORE-NBR         16780000
W40007*    MOVE ML020-SKU               TO ML021-PURCH-SKU              16790000
W40007*                                    ML030-PURCH-SKU              16800000
W40007*                                    ML025-RPT1-SKU               16800000
W40007*                                                                 16810000
W40007*    MOVE ML020-DEPT-CLASS        TO ML021-PURCH-DEPT-CLASS       16820000
W40007*                                    ML030-PURCH-DEPT-CLASS       16830000
W40007*                                    ML025-RPT1-DEPT-CLASS        16830000
W40007*                                                                 16840000
W40007*    MOVE ML020-SYST-ORIG-CDE     TO ML021-PURCH-SYST-ORIG-CDE    16850000
W40007*                                    ML030-PURCH-SYST-ORIG-CDE    16850000
W40007*    IF ML021-PURCH-RECEIPT                                       16860000
W40007*        MOVE ML020-SYST-ORIG-CDE TO ML025-RPT1-SYST-ORIG-CDE     16870000
W40007*    ELSE                                                         16880000
W40007*        MOVE SPACES              TO ML025-RPT1-SYST-ORIG-CDE     16890000
W40007*    END-IF.                                                      16900000
W40007*                                                                 16910000
W40007*    MOVE ML020-TRANS-CDE         TO ML021-PURCH-TRANS-CDE        16920000
W40007*                                    ML030-PURCH-TRANS-CDE        16930000
W40007*                                    ML025-RPT1-TRANS-CDE         16930000
W40007*                                                                 16940000
W40007*    MOVE ML020-PURCH-EXTD-GRO-COST-AMT TO                        16950000
W40007*         ML021-PURCH-EXTD-GRO-COST-AMT                           16960000
W40007*         ML030-PURCH-EXTD-GRO-COST-AMT                           16960000
W40007*                                                                 16940000
W40007*    MOVE ML020-PURCH-FRGT-AMT          TO                        16970000
W40007*         ML021-PURCH-FRGT-AMT                                    16980000
W40007*         ML030-PURCH-FRGT-AMT                                    16980000
W40007*    MOVE ML020-PURCH-DISC-AMT          TO                        16990000
W40007*         ML021-PURCH-DISC-AMT                                    17000000
W40007*         ML030-PURCH-DISC-AMT                                    17000000
W40007*                                                                 17010000
      **   THE SIGN ON THE AMOUNT FIELD FOR CREDITS IS REVERSED ON THE  17020000
      **   EDIT SPLIT FILE SO THAT THE EDIT SPLIT PROGRAM (MLKRP054)    17030000
      **   DOES NOT HAVE TO DIFFERENTIATE BETWEEN DEBITS AND CREDITS.   17040000
      **   IF THE SIGN WAS NOT REVERSED, MLKRP054 WOULD HAVE TO ADD     17050000
      **   DEBITS AND SUBTRACT CREDITS WHEN ACCUMULATING TOTALS.        17060000
                                                                        17070000
W40007*    MOVE ML020-PURCH-EXTD-NET-COST-AMT  TO                       17080000
W40007*         ML021-PURCH-EXTD-NET-COST-AMT                           17090000
W40007*         ML030-PURCH-EXTD-NET-COST-AMT                           17090000
W40007*         ML025-RPT1-EXTD-COST-AMT                                17100000
W40007*    IF ML020-PURCH-DR                                            17110000
W40007*         MULTIPLY -1 BY ML025-RPT1-EXTD-COST-AMT                 17120000
W40007*    END-IF                                                       17130000
W40007*                                                                 17140000
W40007*    MOVE ML020-PURCH-EXTD-RTL-AMT       TO                       17150000
W40007*         ML021-PURCH-EXTD-RTL-AMT                                17160000
W40007*         ML030-PURCH-EXTD-RTL-AMT                                17160000
W40007*         ML025-RPT1-EXTD-RTL-AMT                                 17170000
W40007*    IF ML020-PURCH-DR                                            17180000
W40007*        MULTIPLY -1 BY ML025-RPT1-EXTD-RTL-AMT                   17190000
W40007*    END-IF                                                       17200000
W40007*                                                                 17210000
W40007*    MOVE ML020-PURCH-DR-CR-CDE          TO                       17220000
W40007*         ML021-PURCH-DR-CR-CDE                                   17230000
W40007*         ML030-PURCH-DR-CR-CDE                                   17230000
W40007*    MOVE ML020-PURCH-AP-TRANS-CDE       TO                       17240000
W40007*         ML021-PURCH-AP-TRANS-CDE                                17250000
W40007*         ML030-PURCH-AP-TRANS-CDE                                17250000
W40007*    MOVE ML020-PURCH-TYP-CDE            TO                       17260000
W40007*         ML021-PURCH-TYP-CDE                                     17270000
W40007*         ML030-PURCH-TYP-CDE                                     17270000
                                                                        17280000
1299RM* WR 20698                                                        17290000
W40007*    MOVE ML020-PURCH-PO-TYP-CDE         TO                       17300000
W40007*         ML021-PURCH-PO-TYP-CDE                                  17310000
W40007*         ML030-PURCH-PO-TYP-CDE.                                 17310000
W40007*                                                                 17320000
W40007*    MOVE ML020-PURCH-JRNL-IND    TO ML021-PURCH-JRNL-IND         17330000
W40007*                                    ML030-PURCH-JRNL-IND         17330000
W40007*                                                                 17340000
W40007*    MOVE MLCNTL-PSTG-FSCL-WK-DTE TO ML021-PURCH-EDIT-DTE         17350000
W40007*                                    ML030-PURCH-EDIT-DTE         17350000
W40007*                                                                 17360000
W40007*    MOVE ML020-PURCH-DOC-5-NBRX  TO ML021-PURCH-DOC-5-NBR        17370000
W40007*                                    ML030-PURCH-DOC-5-NBR                
W40007*                                    ML025-RPT1-DOC-5-NBR         17380000
W40007*    MOVE ML020-PURCH-BATCH-NBR   TO ML021-PURCH-BATCH-NBR        17390000
W40007*                                    ML030-PURCH-BATCH-NBR                
W40007*                                    ML025-RPT1-BATCH-NBR         17400000
W40007*    MOVE ML020-PURCH-PO-NBR      TO ML021-PURCH-PO-NBR           17410000
W40007*                                    ML030-PURCH-PO-NBR                   
W40007*    MOVE ML020-PURCH-VEND-NBR    TO ML021-PURCH-VEND-NBR         17422100
W40007*                                    ML030-PURCH-VEND-NBR                 
W40007*    MOVE ML020-PURCH-ENT-ID      TO ML021-PURCH-ENT-ID           17422200
W40007*                                    ML030-PURCH-ENT-ID                   
W40007*    MOVE ML020-PURCH-KOHLS-MM    TO ML021-PURCH-KOHLS-MM         17430000
W40007*                                    ML030-PURCH-KOHLS-MM                 
W40007*                                                                 17440000
W40007*    MOVE PV-ML-IND               TO ML021-PURCH-ML-IND           17450000
W40007*                                    ML030-PURCH-ML-IND                   
W40007*                                    ML025-RPT1-ML-IND            17460000
W40007*    MOVE PV-INV-IND              TO ML021-PURCH-INV-IND          17470000
W40007*                                    ML030-PURCH-INV-IND          17480000
W40007*                                    ML025-RPT1-INV-IND           17480000
W40007*                                                                 17490000
W40007*    MOVE ML020-PURCH-DOC-16-NBR  TO ML030-PURCH-DOC-16-NBR.      17490000
W40007*    MOVE ML020-PURCH-PO-9-NBR    TO ML030-PURCH-PO-9-NBR.        17490000
W40007*    MOVE ML020-PURCH-LBL-SEQ-NBR TO ML030-PURCH-LBL-SEQ-NBR.     17490000
W40007*    MOVE ML020-PURCH-ML-LWST-ID  TO ML030-PURCH-ML-LWST-ID.      17490000
W40007*                                                                 17490000
      **   SPLIT FREIGHT PURCHASES MUST HAVE THEIR NET COST AND FREIGHT 17500000
      **   COSTS SPREAD OUT EVENLY THROUGH EACH CLASS IN THE DEPARTMENT.17510000
      **   THE FIRST CLASS GETS THE PENNIES APPLIED TO IT'S ML021       17520000
      **   FIELDS.  ALL OTHER CLASS ML021 RECORDS WILL CONTAIN WHOLE    17530000
      **   NUMBERS.                                                     17540000
                                                                        17550000
W40007*    IF PV-NOT-SPLIT-FREIGHT                                      17560000
W40007*        WRITE PURCH-REC            FROM ML021-PURCH-RECORD       17570000
W40007*        WRITE BV-PURCH-REC         FROM ML030-PURCH-RECORD       17570000
W40007*        PERFORM Z400-WRITE-RPT1-REC                              17580000
W40007*                                                                 17590000
W40007*    ELSE                                                         17600000
W40007*                                                                 17610000
W40007*        COMPUTE ML021-PURCH-EXTD-NET-COST-AMT ROUNDED =          17620000
W40007*            ML020-PURCH-EXTD-NET-COST-AMT /                      17630000
W40007*            DC-NBR-OF-CLASSES-IN-DEPT(DC-IDX)                    17640000
W40007*                                                                 17650000
W40007*        COMPUTE ML030-PURCH-EXTD-NET-COST-AMT ROUNDED =          17620000
W40007*            ML020-PURCH-EXTD-NET-COST-AMT /                      17630000
W40007*            DC-NBR-OF-CLASSES-IN-DEPT(DC-IDX)                    17640000
W40007*                                                                 17650000
W40007*        COMPUTE ML021-PURCH-FRGT-AMT ROUNDED =                   17660000
W40007*            ML020-PURCH-FRGT-AMT  /                              17670000
W40007*            DC-NBR-OF-CLASSES-IN-DEPT(DC-IDX)                    17680000
W40007*                                                                 17690000
W40007*        COMPUTE ML030-PURCH-FRGT-AMT ROUNDED =                   17660000
W40007*            ML020-PURCH-FRGT-AMT  /                              17670000
W40007*            DC-NBR-OF-CLASSES-IN-DEPT(DC-IDX)                    17680000
W40007*                                                                 17690000
W40007*        MOVE ML021-PURCH-EXTD-NET-COST-AMT TO                    17700000
W40007*             PV-AVG-COST-WHOLE                                   17710000
W40007*        MOVE ML021-PURCH-FRGT-AMT          TO                    17720000
W40007*             PV-AVG-FRGT-WHOLE                                   17730000
                                                                        17740000
      **-->    ** POSITION BACK TO THE FIRST CLASS IN THIS DEPARTMENT   17750000
W40007*        PERFORM VARYING DC-IDX2 FROM 1 BY 1                      17760000
W40007*            UNTIL ML020-DEPT-NBR =                               17770000
W40007*                  DC-DEPT-NBR (DC-IDX2)                          17780000
W40007*        END-PERFORM                                              17790000
                                                                        17800000
      **-->    ** WRITE THE 1ST CLASS W/ THE DECIMAL VALUES             17810000
                                                                        17820000
W40007*        PERFORM D160-WRITE-SPLIT-FREIGHT-RECS                    17830000
                                                                        17840000
      **-->    ** NOW APPLY WHOLE NUMBER VALUES TO THE REMAINING CLASSES17850000
      **-->    ** IN THE DEPARTMENT UNTIL THE TABLED DEPT-NBR CHANGES.  17860000
                                                                        17870000
W40007*        SET DC-IDX2 UP BY +1                                     17880000
W40007*                                                                 17890000
W40007*        PERFORM D150-APPLY-WHOLE-NBRS                            17900000
W40007*            VARYING DC-IDX2 FROM DC-IDX2 BY 1                    17910000
W40007*                UNTIL DC-DEPT-NBR (DC-IDX2) NOT = ML020-DEPT-NBR 17920000
W40007*    END-IF.                                                      17930000
W40007*                                                                 17940000
W40007*D150-APPLY-WHOLE-NBRS.                                           17950000
W40007*                                                                 17960000
W40007*    MOVE PV-AVG-COST-WHOLE     TO                                17970000
W40007*         ML021-PURCH-EXTD-NET-COST-AMT                           17980000
W40007*         ML030-PURCH-EXTD-NET-COST-AMT                           17980000
W40007*                                                                 17990000
W40007*    MOVE PV-AVG-FRGT-WHOLE     TO                                18000000
W40007*         ML021-PURCH-FRGT-AMT                                    18010000
W40007*         ML030-PURCH-FRGT-AMT                                    18010000
W40007*                                                                 18020000
W40007*    PERFORM D160-WRITE-SPLIT-FREIGHT-RECS.                       18030000
W40007*                                                                 18040000
W40007*D160-WRITE-SPLIT-FREIGHT-RECS.                                   18050000
W40007*                                                                 18060000
W40007*    MOVE ML021-PURCH-EXTD-NET-COST-AMT  TO                       18070000
W40007*         ML025-RPT1-EXTD-COST-AMT                                18080000
W40007*    IF ML020-PURCH-DR                                            18090000
W40007*         MULTIPLY -1 BY ML025-RPT1-EXTD-COST-AMT                 18100000
W40007*    END-IF                                                       18110000
W40007*                                                                 18120000
W40007*    MOVE DC-CLASS-NBR(DC-IDX2) TO   ML021-PURCH-CLASS-NBR        18130000
W40007*                                    ML030-PURCH-CLASS-NBR        18130000
W40007*    WRITE PURCH-REC            FROM ML021-PURCH-RECORD           18140000
W40007*    WRITE BV-PURCH-REC         FROM ML030-PURCH-RECORD           17570000
W40007*    PERFORM Z400-WRITE-RPT1-REC.                                 18150000
W40007*                                                                 18160000
W40007*                                                                 18170000
W40007*D180-FORMAT-ERROR-REC.                                           18180000
W40007*                                                                 18190000
W40007*    MOVE ML020-STORE-NBR         TO ML026-RPT2-STORE-NBR         18200000
W40007*    MOVE ML020-SKU               TO ML026-RPT2-SKU               18210000
W40007*    MOVE ML020-DEPT-CLASS        TO ML026-RPT2-DEPT-CLASS        18220000
W40007*    MOVE ML020-TRANS-CDE         TO ML026-RPT2-TRANS-CDE         18230000
W40007*                                                                 18240000
W40007*    MOVE SPACES                  TO ML026-RPT2-REL-STORE-NBR     18250000
W40007*                                                                 18260000
W40007*    IF ML020-PURCH-DTE NUMERIC                                   18270000
W40007*    AND ML020-PURCH-DTE > ZERO                                   18280000
W40007*        MOVE ML020-PURCH-DTE-MM      TO ML026-RPT2-FIN-LIAB-MM   18290000
W40007*        MOVE '/'                     TO ML026-RPT2-FIN-SLASH1    18300000
W40007*        MOVE ML020-PURCH-DTE-DD      TO ML026-RPT2-FIN-LIAB-DD   18310000
W40007*        MOVE '/'                     TO ML026-RPT2-FIN-SLASH2    18320000
W40007*        MOVE ML020-PURCH-DTE-YY      TO ML026-RPT2-FIN-LIAB-YY   18330000
W40007*    ELSE                                                         18340000
W40007*        IF ML020-PURCH-DOC-DTE NUMERIC                           18350000
W40007*        AND ML020-PURCH-DOC-DTE > ZERO                           18360000
W40007*            MOVE ML020-PURCH-DOC-MM  TO ML026-RPT2-FIN-LIAB-MM   18370000
W40007*            MOVE '/'                 TO ML026-RPT2-FIN-SLASH1    18380000
W40007*            MOVE ML020-PURCH-DOC-DD  TO ML026-RPT2-FIN-LIAB-DD   18390000
W40007*        ELSE                                                     18400000
W40007*            MOVE ML020-PURCH-DTE-MM  TO ML026-RPT2-FIN-LIAB-MM   18410000
W40007*            MOVE '/'                 TO ML026-RPT2-FIN-SLASH1    18420000
W40007*            MOVE ML020-PURCH-DTE-DD  TO ML026-RPT2-FIN-LIAB-DD   18430000
W40007*            MOVE '/'                 TO ML026-RPT2-FIN-SLASH2    18440000
W40007*            MOVE ML020-PURCH-DTE-YY  TO ML026-RPT2-FIN-LIAB-YY   18450000
W40007*        END-IF                                                   18460000
W40007*    END-IF.                                                      18470000
W40007*                                                                 18480000
W40007*    MOVE SPACES                  TO ML026-RPT2-KOHLS-MM          18490000
W40007*                                                                 18500000
W40007*    MOVE ZEROS                   TO ML026-RPT2-QTYX              18510000
W40007*    MOVE ML020-PURCH-DOC-5-NBRX  TO ML026-RPT2-DOC-5-NBR         18520000
W40007*                                                                 18530000
W40007*    IF ML020-PURCH-EXTD-GRO-COST-AMT NOT NUMERIC                 14920000
W40007*        MOVE ML020-PURCH-EXTD-GRO-COST-AMTX                      18540000
W40007*                                 TO ML026-RPT2-AMTX              18550000
W40007*    ELSE                                                                 
W40007*        MOVE ML020-PURCH-EXTD-GRO-COST-AMT                       18540000
W40007*                                 TO ML026-RPT2-AMT               18550000
W40007*    END-IF.                                                              
W40007*                                                                 18560000
W40007*    MOVE ZEROS                   TO ML026-RPT2-OLD-PR-AMTX.      18570000
W40007*    MOVE ZEROS                   TO ML026-RPT2-NEW-PR-AMTX.      18580000
W40007*                                                                 18590000
W40007*    MOVE ML020-PURCH-PO-NBRX     TO ML026-RPT2-PO-NBRX.          18600000
W40007*    MOVE ML020-PURCH-RSN-CDE     TO ML026-RPT2-RSN-CDE           18610000
W40007*    MOVE ML020-PURCH-BATCH-NBR   TO ML026-RPT2-BATCH-NBR         18620000
W40007*    MOVE ML020-PURCH-VEND-NBR    TO ML026-RPT2-VEND-NBR          18630000
W40007*    MOVE ML020-PURCH-ENT-ID      TO ML026-RPT2-ENT-ID            18631000
W40007*                                                                         
W40007*    IF ML020-PURCH-DISC-AMT NOT NUMERIC                          14920000
W40007*        MOVE ML020-PURCH-DISC-AMTX  TO ML026-RPT2-DISC-AMTX      18640000
W40007*    ELSE                                                                 
W40007*        MOVE ML020-PURCH-DISC-AMT   TO ML026-RPT2-DISC-AMT       18640000
W40007*    END-IF.                                                              
W40007*                                                                         
W40007*    IF ML020-PURCH-FRGT-AMT NOT NUMERIC                          14920000
W40007*        MOVE ML020-PURCH-FRGT-AMTX   TO ML026-RPT2-FRGT-AMTX     18650000
W40007*    ELSE                                                                 
W40007*        MOVE ML020-PURCH-FRGT-AMT    TO ML026-RPT2-FRGT-AMT      18650000
W40007*    END-IF.                                                              
W40007*                                                                         
W40007*    IF ML020-PURCH-EXTD-NET-COST-AMT NOT NUMERIC                 14920000
W40007*        MOVE ML020-PURCH-EXTD-NET-COST-AMTX                      18660000
W40007*                                 TO ML026-RPT2-NET-COST-AMT      18670000
W40007*    ELSE                                                                 
W40007*        MOVE ML020-PURCH-EXTD-NET-COST-AMT                       18660000
W40007*                                 TO ML026-RPT2-NET-COST-AMT      18670000
W40007*    END-IF.                                                              
W40007*                                                                         
W40007*    IF ML020-PURCH-EXTD-RTL-AMT NOT NUMERIC                      14920000
W40007*        MOVE ML020-PURCH-EXTD-RTL-AMTX                           18680000
W40007*                                 TO ML026-RPT2-RETAIL-AMTX       18690000
W40007*    ELSE                                                                 
W40007*        MOVE ML020-PURCH-EXTD-RTL-AMT                            18680000
W40007*                                 TO ML026-RPT2-RETAIL-AMT        18690000
W40007*    END-IF.                                                              
W40007*                                                                         
W40007*    MOVE ML020-PURCH-DR-CR-CDE   TO ML026-RPT2-DR-CR-CDE.        18700000
W40007*                                                                 18710000
W40007*    ADD 1                                  TO TR-TRANS-ERR (1)   18720000
W40007*                                                                 18730000
W40007*    IF ML020-PURCH-EXTD-RTL-AMT  NUMERIC                         18740000
W40007*        IF ML020-PURCH-CR                                        18750000
W40007*           ADD ML020-PURCH-EXTD-RTL-AMT      TO                  18760000
W40007*               TR-TRANS-RTL-ERR (1)                              18770000
W40007*        ELSE                                                     18780000
W40007*           SUBTRACT ML020-PURCH-EXTD-RTL-AMT FROM                18790000
W40007*               TR-TRANS-RTL-ERR (1)                              18800000
W40007*        END-IF                                                   18810000
W40007*    END-IF.                                                      18820000
W40007*                                                                 18830000
W40007*    IF ML020-PURCH-EXTD-NET-COST-AMT  NUMERIC                    18840000
W40007*        IF ML020-PURCH-CR                                        18850000
W40007*            ADD ML020-PURCH-EXTD-NET-COST-AMT       TO           18860000
W40007*                TR-TRANS-COST-ERR (1)                            18870000
W40007*        ELSE                                                     18880000
W40007*            SUBTRACT ML020-PURCH-EXTD-NET-COST-AMT  FROM         18890000
W40007*                TR-TRANS-COST-ERR (1)                            18900000
W40007*        END-IF                                                   18910000
W40007*    END-IF.                                                      18920000
W40007*                                                                 18930000
W40007*    EJECT                                                        18940000
W40007*E100-PROCESS-SALE.                                               18950000
W40007*                                                                 18960000
W40007*    ADD 1                                  TO TR-TRANS-IN (2)    18970000
W40007*                                                                 18980000
W40007*    IF ML020-SALE-EXTD-RTL-AMT  NUMERIC                          18990000
W40007*       ADD ML020-SALE-EXTD-RTL-AMT         TO                    19000000
W40007*       TR-TRANS-RTL-IN (2)                                       19010000
W40007*    END-IF                                                       19020000
W40007*                                                                 19030000
W40007*    PERFORM E110-EDIT-ML020.                                     19040000
W40007*                                                                 19050000
W40007*    IF PV-NO-DTL-ERROR                                           19060000
W40007*        PERFORM E130-WRITE-OUTPUT-FILES                          19070000
W40007*    ELSE                                                         19080000
W40007*        PERFORM E140-FORMAT-ERROR-REC                            19090000
W40007*        PERFORM Z998-WRITE-ERROR-FILE                            19100000
W40007*    END-IF.                                                      19110000
W40007*                                                                 19120000
W40007*                                                                 19130000
W40007*E110-EDIT-ML020.                                                 19140000
W40007*                                                                 19150000
W40007*    INITIALIZE ML022-SALE-RECORD                                 19160000
W40007*               ML025-RPT1-DETAIL-RECORD                          19170000
W40007*                                                                 19180000
W40007*    IF ML020-POS              OR                                 19190000
W40007*       ML020-DATA-ENTRY                                          19200000
W40007*        CONTINUE                                                 19210000
W40007*    ELSE                                                         19220000
W40007*        DISPLAY 'INVALID SYST-ORIG-CDE ON A SALE TRAN: '         19230000
W40007*                 ML020-SYST-ORIG-CDE                             19240000
W40007*        PERFORM Z999-INVALID-PRESET-VALUE-ABND                   19250000
W40007*    END-IF                                                       19260000
W40007*                                                                 19270000
W40007*    PERFORM E120-DATE-EDITS.                                     19280000
W40007*                                                                 19290000
W40007*                                                                 19300000
W40007*E120-DATE-EDITS.                                                 19310000
W40007*                                                                 19320000
W40007*    SET PS-NO-DATE-ERROR TO TRUE.                                19330000
W40007*                                                                 19340000
W40007*    IF  ML020-SALE-DTE NUMERIC                                   19350000
W40007*    AND ML020-SALE-DTE > ZERO                                    19360000
W40007*        MOVE ML020-SALE-DTE TO PV-EDIT-DTE                       19370000
W40007*        PERFORM Z200-EDIT-DTE                                    19380000
W40007*        IF PS-DATE-ERROR                                         19390000
W40007*            SET ML027-ERR-INVALID-VALUE TO TRUE                  19400000
W40007*            MOVE ML027-ERR-CDE TO                                19410000
W40007*                 ML026-RPT2-FIN-LIAB-DTE-ERR                     19420000
W40007*            SET PV-DTL-ERROR TO TRUE                             19430000
W40007*        ELSE                                                     19440000
W40007*            MOVE EDT-ISO-DTE (EDT-IDX) TO ML022-SALE-FIN-LIAB-DTE19450000
W40007*                                          ML025-RPT1-FIN-LIAB-DTE19460000
      **-->            ** FOR SALES, THE LIAB DTE MUST BE W/IN THE      19490000
      **-->            ** PROCESSING DATE'S FISCAL RANGE.               19500000
W40007*            PERFORM E125-DATE-RANGE-CHECK THRU E125-EXIT         19501000
W40007*            EVALUATE ML027-ERR-OUT-OF-RANGE                      19502100
W40007*              WHEN TRUE                                          19502200
W40007*                MOVE ML027-ERR-CDE TO ML026-RPT2-FIN-LIAB-DTE-ERR19650600
W40007*                SET PV-DTL-ERROR   TO TRUE                       19650700
W40007*                MOVE SPACES TO ML027-ERR-CDE                     19650700
W40007*              WHEN OTHER                                                 
W40007*                MOVE ML022-SALE-FIN-LIAB-DTE TO PV-FIN-LIAB-DTE  19502300
W40007*                PERFORM Z300-SET-ML-AND-INV-INDS                 19502400
W40007*            END-EVALUATE                                         19570000
W40007*        END-IF                                                   19580000
W40007*    ELSE                                                         19590000
W40007*        SET ML027-ERR-NON-NUMERIC                                19600000
W40007*            PV-DTL-ERROR   TO TRUE                               19610000
W40007*        MOVE ML027-ERR-CDE TO ML026-RPT2-FIN-LIAB-DTE-ERR        19620000
W40007*    END-IF.                                                      19630000
W40007*                                                                 19640000
W40007*E125-DATE-RANGE-CHECK.                                           19641000
W27261******************************************************************19642000
W27261* DURING THE NEW DAILY PROCESSING CYCLE FOR SALES & MARKDOWNS WE  19643000
W27261* MUST KNOW IF WE ARE RUNNING DURING A CUTOFF WEEK. IF IT IS, THE 19644000
W27261* DATE RANGE BEING COMPARED AGAINST MUST TAKE THAT INTO ACCOUNT   19645000
W27261* THEREFORE WE USE PV-FSCL-MN-END-DTE INSTEAD OF                  19646000
W27261*                                     MLCNTL-PSTG-FSCL-MN-DTE.    19647000
W27261* N O T E:                                                        19648000
W27261* IN THIS ROUTINE ML027-ERR-OUT-OF-RANGE = TRUE SETS              19649000
W27261* ML027-ERR-CDE TO THE VALUE '008'.                               19649100
W27261******************************************************************19649200
W40007*    IF ITS-A-DAILY-CUTOFF-RUN                                    19649300
W40007*      IF (ML022-SALE-FIN-LIAB-DTE < PV-FSCL-MN-BEG-DTE           19649500
W40007*        OR                                                       19649600
W40007*         ML022-SALE-FIN-LIAB-DTE > PV-FSCL-MN-END-DTE)           19649700
W40007*           SET ML027-ERR-OUT-OF-RANGE  TO TRUE                   19649800
W40007*      END-IF                                                     19650000
W40007*    ELSE                                                         19650100
W40007*      IF (ML022-SALE-FIN-LIAB-DTE < PV-FSCL-MN-BEG-DTE           19650200
W40007*        OR                                                       19650300
W40007*         ML022-SALE-FIN-LIAB-DTE > MLCNTL-PSTG-FSCL-MN-DTE)      19650400
W40007*           SET ML027-ERR-OUT-OF-RANGE  TO TRUE                   19650500
W40007*      END-IF                                                     19650000
W40007*    END-IF.                                                      19650800
W40007*E125-EXIT.                                                       19650900
W40007*     EXIT.                                                       19651000
W40007*                                                                 19652000
W40007*E130-WRITE-OUTPUT-FILES.                                         19660000
W40007*                                                                 19670000
W40007*    MOVE ML020-STORE-NBR         TO ML022-SALE-STORE-NBR         19680000
W40007*                                    ML025-RPT1-STORE-NBR         19690000
W40007*    MOVE ML020-SKU               TO ML022-SALE-SKU               19700000
W40007*                                    ML025-RPT1-SKU               19710000
W40007*    MOVE ML020-DEPT-CLASS        TO ML022-SALE-DEPT-CLASS        19720000
W40007*                                    ML025-RPT1-DEPT-CLASS        19730000
W40007*    MOVE ML020-SYST-ORIG-CDE     TO ML022-SALE-SYST-ORIG-CDE     19740000
W40007*    MOVE ML020-TRANS-CDE         TO ML022-SALE-TRANS-CDE         19750000
W40007*                                    ML025-RPT1-TRANS-CDE         19760000
W40007*                                                                 19770000
W40007*    MOVE EDT-FSCL-YR-NBR   (EDT-IDX) TO ML022-SALE-FSCL-YR       19780000
W40007*                                        ML025-RPT1-FSCL-YR-CDE   19790000
W40007*    MOVE EDT-FSCL-MN-NBR   (EDT-IDX) TO ML022-SALE-FSCL-PER      19800000
W40007*                                        ML025-RPT1-FSCL-PER-CDE  19810000
W40007*    MOVE EDT-WK-IN-MN-NBR  (EDT-IDX) TO ML022-SALE-FSCL-WK.      19820000
W40007*    MOVE EDT-DAY-OF-WK-NBR (EDT-IDX) TO ML022-SALE-FSCL-DAY.     19830000
W40007*    MOVE EDT-FSCL-WK-NBR   (EDT-IDX) TO ML022-SALE-FSCL-WK-NBR.  19840000
W40007*                                                                 19850000
W40007*    MOVE ML020-SALE-EXTD-RTL-AMT TO                              19860000
W40007*         ML022-SALE-EXTD-RTL-AMT                                 19870000
W40007*         ML025-RPT1-EXTD-RTL-AMT.                                19880000
W40007*                                                                 19890000
W40007*    MOVE MLCNTL-PSTG-FSCL-MN-NBR TO ML022-SALE-KOHLS-MM.         19900000
W40007*    MOVE MLCNTL-PSTG-FSCL-WK-DTE TO ML022-SALE-EDIT-DTE.         19910000
W40007*                                                                 19920000
W40007*    MOVE PV-ML-IND               TO ML022-SALE-ML-IND            19930000
W40007*                                    ML025-RPT1-ML-IND.           19940000
W40007*    MOVE PV-INV-IND              TO ML022-SALE-INV-IND           19950000
W40007*                                    ML025-RPT1-INV-IND.          19960000
W40007*    MOVE ML020-SALE-TYPE-2       TO ML022-SALE-TYPE-2.           19970000
W40007*    MOVE ML020-SALE-CORR-CDE     TO ML022-SALE-CORR-CDE.         19980000
W40007*                                                                 19990000
W40007*    WRITE SALE-REC             FROM ML022-SALE-RECORD.           20000000
W40007*                                                                 20010000
W40007*    ADD 1                                  TO TR-TRANS-OK (2).   20020000
W40007*                                                                 20030000
W40007*    ADD ML020-SALE-EXTD-RTL-AMT            TO                    20040000
W40007*        TR-TRANS-RTL-OK (2).                                     20050000
W40007*                                                                 20060000
W40007*    PERFORM Z400-WRITE-RPT1-REC.                                 20070000
W40007*                                                                 20080000
W40007*                                                                 20090000
W40007*E140-FORMAT-ERROR-REC.                                           20100000
W40007*                                                                 20110000
W40007*    MOVE ML020-STORE-NBR         TO ML026-RPT2-STORE-NBR         20120000
W40007*    MOVE ML020-SKU               TO ML026-RPT2-SKU               20130000
W40007*    MOVE ML020-DEPT-CLASS        TO ML026-RPT2-DEPT-CLASS        20141000
W40007*    MOVE ML020-TRANS-CDE         TO ML026-RPT2-TRANS-CDE         20150000
W40007*                                                                 20160000
W40007*    MOVE SPACES                  TO ML026-RPT2-REL-STORE-NBR     20170000
W40007*                                                                 20180000
W40007*    MOVE ML020-SALE-DTE-MM       TO ML026-RPT2-FIN-LIAB-MM       20190000
W40007*    MOVE '/'                     TO ML026-RPT2-FIN-SLASH1        20200000
W40007*    MOVE ML020-SALE-DTE-DD       TO ML026-RPT2-FIN-LIAB-DD       20210000
W40007*    MOVE '/'                     TO ML026-RPT2-FIN-SLASH2        20220000
W40007*    MOVE ML020-SALE-DTE-YY       TO ML026-RPT2-FIN-LIAB-YY       20230000
W40007*                                                                 20240000
W40007*    MOVE SPACES                  TO ML026-RPT2-KOHLS-MM          20250000
W40007*                                                                 20260000
W40007*    IF ML020-SALE-EXTD-RTL-AMT NOT NUMERIC                       14920000
W40007*        MOVE ML020-SALE-EXTD-RTL-AMTX                            20270000
W40007*                                 TO ML026-RPT2-AMTX              20280000
W40007*    ELSE                                                                 
W40007*        MOVE ML020-SALE-EXTD-RTL-AMT                             20270000
W40007*                                 TO ML026-RPT2-AMT               20280000
W40007*    END-IF.                                                              
W40007*                                                                 20260000
W40007*    MOVE ZEROS                   TO ML026-RPT2-OLD-PR-AMTX.      20290000
W40007*    MOVE ZEROS                   TO ML026-RPT2-NEW-PR-AMTX.      20300000
W40007*    MOVE ZEROS                   TO ML026-RPT2-PO-NBRX.          20310000
W40007*    MOVE ML020-SALE-RSN-CDE      TO ML026-RPT2-RSN-CDE           20320000
W40007*    MOVE SPACES                  TO ML026-RPT2-BATCH-NBR         20330000
W40007*    MOVE SPACES                  TO ML026-RPT2-VEND-NBR          20340000
W40007*    MOVE ZEROS                   TO ML026-RPT2-ENT-ID            20341000
W40007*    MOVE ZEROS                   TO ML026-RPT2-DISC-AMTX.        20350000
W40007*    MOVE ZEROS                   TO ML026-RPT2-FRGT-AMTX.        20360000
W40007*    MOVE ZEROS                   TO ML026-RPT2-NET-COST-AMTX     20370000
W40007*    MOVE SPACES                  TO ML026-RPT2-DR-CR-CDE.        20380000
W40007*                                                                 20390000
W40007*    ADD 1                                  TO TR-TRANS-ERR(2)    20400000
W40007*                                                                 20410000
W40007*    IF ML020-SALE-EXTD-RTL-AMT  NUMERIC                          20420000
W40007*       ADD ML020-SALE-EXTD-RTL-AMT         TO                    20430000
W40007*       TR-TRANS-RTL-ERR (2)                                      20440000
W40007*    END-IF.                                                      20450000
W40007*                                                                 20460000
W40007*                                                                 20470000
W40007*F100-PROCESS-TRANSFER.                                           20480000
W40007*                                                                 20490000
W40007*    ADD 1                                  TO TR-TRANS-IN (3)    20500000
W40007*                                              TR-TRANS-IN (4)    20510000
                                                                        20520000
      **   THE ST-IDX VALUE FOR THE "FROM" STORE IS SAVED HERE          20530000
      **   BECAUSE IT WILL BE ALTERED IN F110-EDIT-ML020 WHEN THE "TO"  20540000
      **   STORE IS LOOKED UP IN THE STORE TABLE. THE "FROM" STORE'S    20550000
      **   ST-IDX VALUE IS RESTORED AT THE END OF THIS PARAGRAPH.       20560000
                                                                        20570000
W40007*    SET PV-SAVE-ST-IDX TO ST-IDX.                                20580000
                                                                        20590000
W40007*    PERFORM F110-EDIT-ML020.                                     20600000
                                                                        20610000
      **   TWO RECORDS ARE WRITTEN FOR TRANSFERS. ONE FOR THE "FROM"    20620000
      **   STORE, AND THE OTHER FOR THE "TO".                           20630000
                                                                        20640000
W40007*    IF PV-NO-DTL-ERROR                                           20650000
W40007*        PERFORM F130-WRITE-OUTPUT-FILES                          20660000
W40007*        PERFORM F140-WRITE-ML021-TO-STORE                        20670000
W40007*    ELSE                                                         20680000
W40007*        PERFORM F150-FORMAT-ERROR-REC                            20690000
W40007*        PERFORM Z998-WRITE-ERROR-FILE                            20700000
W40007*    END-IF.                                                      20710000
W40007*                                                                 20720000
W40007*    SET ST-IDX TO PV-SAVE-ST-IDX.                                20730000
                                                                        20740000
                                                                        20750000
W40007*F110-EDIT-ML020.                                                 20760000
                                                                        20770000
W40007*    INITIALIZE ML021-PURCH-RECORD                                20780000
W40007*               ML030-PURCH-RECORD                                20790000
W40007*               ML025-RPT1-DETAIL-RECORD                          20790000
W40007*                                                                 20800000
W40007*    IF ML020-DEPT-CLASS = '09910'                                20810000
W40007*        SET ML027-ERR-INVALID-VALUE   TO TRUE                    20820000
W40007*        MOVE ML027-ERR-CDE            TO                         20830000
W40007*             ML026-RPT2-DEPT-CLASS-ERR                           20840000
W40007*        SET PV-DTL-ERROR TO TRUE                                 20850000
W40007*    END-IF                                                       20860000
W40007*                                                                 20870000
W40007*    IF ML020-DATA-ENTRY                                          20880000
W40007*        CONTINUE                                                 20890000
W40007*    ELSE                                                         20900000
W40007*        DISPLAY 'INVALID SYST-ORIG-CDE ON A TRANSFER TRAN: '     20910000
W40007*                 ML020-SYST-ORIG-CDE                             20920000
W40007*        PERFORM Z999-INVALID-PRESET-VALUE-ABND                   20930000
W40007*    END-IF                                                       20940000
W40007*                                                                 20950000
W40007*    IF NOT ML020-XFER-VALID-TYP-CDE                              20960000
W40007*        DISPLAY 'INVALID XFER TYP CDE '                          20970000
W40007*                 ML020-XFER-TYP-CDE                              20980000
W40007*        PERFORM Z999-INVALID-PRESET-VALUE-ABND                   20990000
W40007*    END-IF                                                       21000000
W40007*                                                                 21010000
W40007*    IF ML020-XFER-BATCH-NBR NUMERIC                              21020000
W40007*        CONTINUE                                                 21030000
W40007*    ELSE                                                         21040000
W40007*        MOVE ZEROS TO ML020-XFER-BATCH-NBR                       21050000
W40007*    END-IF                                                       21060000
W40007*                                                                 21070000
W40007*    IF  ML020-XFER-NBR NUMERIC                                   21080000
W40007*        CONTINUE                                                 21090000
W40007*    ELSE                                                         21100000
W40007*        IF  ML020-XFER-NBR = 'FAST '                             21110000
W40007*            MOVE ML020-XFER-NBR           TO                     21120000
W40007*                 EX-SOURCE-NBR                                   21130000
W40007*        ELSE                                                     21140000
W40007*            SET ML027-ERR-NON-NUMERIC     TO TRUE                21150000
W40007*            MOVE ML027-ERR-CDE            TO                     21160000
W40007*                 ML026-RPT2-DOC-5-NBR-ERR                        21170000
W40007*            SET PV-DTL-ERROR TO TRUE                             21180000
W40007*        END-IF                                                   21190000
W40007*    END-IF                                                       21200000
W40007*                                                                 21210000
W40007*    IF ML020-XFER-QTY  NUMERIC                                   21220000
W40007*        IF ML020-XFER-QTY > +0                                   21230000
W40007*            CONTINUE                                             21240000
W40007*        ELSE                                                     21250000
W40007*            SET ML027-ERR-LESS-THAN-OR-EQ-ZERO TO TRUE           21260000
W40007*            MOVE ML027-ERR-CDE                 TO                21270000
W40007*                 ML026-RPT2-QTY-ERR                              21280000
W40007*            SET PV-DTL-ERROR TO TRUE                             21290000
W40007*        END-IF                                                   21300000
W40007*    ELSE                                                         21310000
W40007*        SET ML027-ERR-NON-NUMERIC      TO TRUE                   21320000
W40007*        MOVE ML027-ERR-CDE             TO ML026-RPT2-QTY-ERR     21330000
W40007*        SET PV-DTL-ERROR TO TRUE                                 21340000
W40007*    END-IF                                                       21350000
W40007*                                                                 21360000
W40007*    IF ML020-XFER-PER-UNT-RTL-AMT  NUMERIC                       21370000
W40007*        IF ML020-XFER-PER-UNT-RTL-AMT > +0                       21380000
W40007*            CONTINUE                                             21390000
W40007*        ELSE                                                     21400000
W40007*            SET ML027-ERR-LESS-THAN-OR-EQ-ZERO TO TRUE           21410000
W40007*            MOVE ML027-ERR-CDE                 TO                21420000
W40007*                 ML026-RPT2-OLD-PR-AMT-ERR                       21430000
W40007*            SET PV-DTL-ERROR TO TRUE                             21440000
W40007*        END-IF                                                   21450000
W40007*    ELSE                                                         21460000
W40007*        SET ML027-ERR-NON-NUMERIC      TO TRUE                   21470000
W40007*        MOVE ML027-ERR-CDE             TO                        21480000
W40007*             ML026-RPT2-OLD-PR-AMT-ERR                           21490000
W40007*        SET PV-DTL-ERROR TO TRUE                                 21500000
W40007*    END-IF                                                       21510000
W40007*                                                                 21520000
W40007*    MOVE ZERO TO ML020-XFER-EXTD-RTL-AMT.                        21530000
W40007*                                                                 21540000
W40007*    IF ML020-XFER-QTY              NUMERIC   AND                 21550000
W40007*       ML020-XFER-PER-UNT-RTL-AMT  NUMERIC                       21560000
W40007*                                                                 21570000
W40007*        COMPUTE ML020-XFER-EXTD-RTL-AMT =                        21580000
W40007*                ML020-XFER-QTY * ML020-XFER-PER-UNT-RTL-AMT      21590000
W40007*        ADD ML020-XFER-EXTD-RTL-AMT TO TR-TRANS-RTL-IN (3)       21600000
W40007*                                       TR-TRANS-RTL-IN (4)       21610000
W40007*                                                                 21620000
W40007*    END-IF.                                                      21630000
                                                                        21640000
W40007*    PERFORM F120-DATE-EDITS                                      21650000
                                                                        21660000
      **   NOTE:  KEEP THIS "TO" STORE TEST <<AFTER>> THE F120-DATE     21670000
      **          PERFORM.  F120-DATE-EDITS SETS PV-INV-IND WHICH MUST  21680000
      **          APPLY TO THE "FROM" STORE.  THE SEARCH (BELOW) CHANGES21690000
      **          THE ST-IDX VALUE.  F140-WRITE-ML021-TO-STORE TAKES THE21700000
      **          "TO" STORE'S PLND_INV_DTE INTO ACCOUNT SEPARATELY.    21710000
      **          THE ST-IDX VALUE FOR THE "FROM" STORE WAS SAVED       21720000
      **          EARLIER, AND WILL BE RESTORED AFTER THE "TO" STORE    21730000
      **          RECORD HAS BEEN WRITTEN.                              21740000
                                                                        21750000
W40007*    IF ML020-XFER-TO-STORE-NBR = ML020-STORE-NBR                 21760000
W40007*        SET ML027-ERR-OLD-EQUAL-NEW        TO TRUE               21770000
W40007*        MOVE ML027-ERR-CDE                 TO                    21780000
W40007*             ML026-RPT2-STORE-NBR-ERR                            21790000
W40007*             ML026-RPT2-REL-STORE-NBR-ERR                        21800000
W40007*             SET PV-DTL-ERROR TO TRUE                            21810000
W40007*    ELSE                                                         21820000
W40007*        SET ST-IDX TO 1                                          21830000
W40007*                                                                 21840000
W40007*        SEARCH ALL STORE-ENTRIES                                 21850000
W40007*            AT END                                               21860000
W40007*                SET ML027-ERR-NOT-FOUND            TO TRUE       21870000
W40007*                MOVE ML027-ERR-CDE                 TO            21880000
W40007*                     ML026-RPT2-REL-STORE-NBR-ERR                21890000
W40007*                SET PV-DTL-ERROR TO TRUE                         21900000
W40007*            WHEN                                                 21910000
W40007*                ST-STORE-NMBR (ST-IDX) =                         21920000
W40007*                ML020-XFER-TO-STORE-NBR                          21930000
W40007*                    NEXT SENTENCE                                21940000
W40007*        END-SEARCH                                               21950000
W40007*    END-IF.                                                      21960000
W40007*                                                                 21970000
W40007*                                                                 21980000
W40007*F120-DATE-EDITS.                                                 21990000
W40007*                                                                 22000000
W40007*    SET PS-NO-DATE-ERROR TO TRUE.                                22010000
W40007*                                                                 22020000
W40007*    IF  ML020-XFER-DTE NUMERIC                                   22030000
W40007*    AND ML020-XFER-DTE > ZERO                                    22040000
W40007*        MOVE ML020-XFER-MM TO PV-EDIT-MM                         22050000
W40007*        MOVE ML020-XFER-DD TO PV-EDIT-DD                         22060000
W40007*        MOVE SPACE         TO PV-EDIT-YY                         22070000
W40007*                                                                 22080000
W40007*        PERFORM Z200-EDIT-DTE                                    22090000
W40007*                                                                 22100000
W40007*        IF PS-DATE-ERROR                                         22110000
W40007*            SET ML027-ERR-INVALID-VALUE                          22120000
W40007*                PV-DTL-ERROR       TO TRUE                       22130000
W40007*            MOVE ML027-ERR-CDE     TO ML026-RPT2-FIN-LIAB-DTE-ERR22140000
W40007*        ELSE                                                     22150000
W40007*            MOVE EDT-ISO-DTE (EDT-IDX)                           22160000
W40007*                                   TO ML021-PURCH-FIN-LIAB-DTE   22170000
W40007*                                      ML030-PURCH-FIN-LIAB-DTE   22170000
W40007*                                      ML021-PURCH-DOC-DTE        22180000
W40007*                                      ML030-PURCH-DOC-DTE        22180000
W40007*                                      ML025-RPT1-FIN-LIAB-DTE    22190000
W40007*            MOVE ML021-PURCH-FIN-LIAB-DTE                        22200000
W40007*                                   TO PV-FIN-LIAB-DTE            22210000
W40007*            PERFORM Z300-SET-ML-AND-INV-INDS                     22220000
W40007*        END-IF                                                   22230000
W40007*    ELSE                                                         22240000
W40007*        SET ML027-ERR-INVALID-VALUE                              22250000
W40007*            PV-DTL-ERROR           TO TRUE                       22260000
W40007*        MOVE ML027-ERR-CDE         TO ML026-RPT2-FIN-LIAB-DTE-ERR22270000
W40007*    END-IF.                                                      22280000
W40007*                                                                 22290000
W40007*    IF ML020-XFER-KOHLS-MM NOT NUMERIC                           22300000
W40007*        SET ML027-ERR-INVALID-DATE TO TRUE                       22310000
W40007*        MOVE ML027-ERR-CDE    TO ML026-RPT2-KOHLS-MM-ERR         22320000
W40007*        SET PV-DTL-ERROR      TO TRUE                            22330000
W40007*    END-IF.                                                      22340000
W40007*                                                                 22350000
W40007*                                                                 22360000
W40007*F130-WRITE-OUTPUT-FILES.                                         22370000
W40007*                                                                 22380000
W40007*    MOVE ML020-STORE-NBR             TO ML021-PURCH-STORE-NBR    22390000
W40007*                                        ML030-PURCH-STORE-NBR            
W40007*                                        ML025-RPT1-STORE-NBR     22400000
W40007*    MOVE ML020-SKU                   TO ML021-PURCH-SKU          22410000
W40007*                                        ML030-PURCH-SKU                  
W40007*                                        ML025-RPT1-SKU           22420000
W40007*    MOVE ML020-DEPT-CLASS            TO ML021-PURCH-DEPT-CLASS   22430000
W40007*                                        ML030-PURCH-DEPT-CLASS           
W40007*                                        ML025-RPT1-DEPT-CLASS    22440000
W40007*                                                                 22450000
W40007*    MOVE ML020-SYST-ORIG-CDE         TO ML021-PURCH-SYST-ORIG-CDE22460000
W40007*                                        ML030-PURCH-SYST-ORIG-CDE22460000
W40007*    IF ML021-PURCH-RECEIPT                                       22470000
W40007*        MOVE ML020-SYST-ORIG-CDE  TO ML025-RPT1-SYST-ORIG-CDE    22480000
W40007*    ELSE                                                         22490000
W40007*        MOVE SPACES               TO ML025-RPT1-SYST-ORIG-CDE    22500000
W40007*    END-IF.                                                      22510000
W40007*                                                                 22520000
W40007*    MOVE ML020-TRANS-CDE             TO ML021-PURCH-TRANS-CDE    22530000
W40007*                                        ML030-PURCH-TRANS-CDE            
W40007*                                        ML025-RPT1-TRANS-CDE     22540000
W40007*                                                                 22550000
W40007*    MOVE PV-PSTG-FSCL-YR-NBR         TO ML025-RPT1-FSCL-YR-CDE.  22560000
W40007*    MOVE MLCNTL-PSTG-FSCL-MN-NBR     TO ML025-RPT1-FSCL-PER-CDE. 22570000
W40007*                                                                 22580000
W40007*    MOVE EDT-FSCL-YR-NBR   (EDT-IDX) TO ML021-PURCH-FSCL-YR      22590000
W40007*                                        ML030-PURCH-FSCL-YR.     22590000
W40007*    MOVE EDT-FSCL-MN-NBR   (EDT-IDX) TO ML021-PURCH-FSCL-PER     22600000
W40007*                                        ML030-PURCH-FSCL-PER.    22600000
W40007*    MOVE EDT-WK-IN-MN-NBR  (EDT-IDX) TO ML021-PURCH-FSCL-WK      22610000
W40007*                                        ML030-PURCH-FSCL-WK.     22610000
W40007*    MOVE EDT-DAY-OF-WK-NBR (EDT-IDX) TO ML021-PURCH-FSCL-DAY     22620000
W40007*                                        ML030-PURCH-FSCL-DAY.    22620000
W40007*                                                                 22630000
W40007*    MOVE MLCNTL-PSTG-FSCL-WK-DTE     TO ML021-PURCH-EDIT-DTE     22640000
W40007*                                        ML030-PURCH-EDIT-DTE     22640000
W40007*                                                                 22650000
W40007*    MOVE PV-ML-IND               TO ML021-PURCH-ML-IND           22660000
W40007*                                    ML030-PURCH-ML-IND                   
W40007*                                    ML025-RPT1-ML-IND            22670000
W40007*    MOVE PV-INV-IND              TO ML021-PURCH-INV-IND          22680000
W40007*                                    ML030-PURCH-INV-IND                  
W40007*                                    ML025-RPT1-INV-IND           22690000
W40007*                                                                 22700000
W40007*    MOVE ML020-XFER-AP-TRANS-CDE TO ML021-PURCH-AP-TRANS-CDE     22710000
W40007*                                    ML030-PURCH-AP-TRANS-CDE     22710000
W40007*    MOVE ML020-XFER-TYP-CDE      TO ML021-PURCH-TYP-CDE          22720000
W40007*                                    ML030-PURCH-TYP-CDE          22720000
W40007*                                                                 22730000
W40007*    MOVE ML020-XFER-NBR          TO ML021-PURCH-DOC-5-NBR        22740000
W40007*                                    ML030-PURCH-DOC-5-NBR                
W40007*                                    ML025-RPT1-DOC-5-NBRX        22750000
W40007*                                                                 22760000
W40007*    MOVE ML020-XFER-BATCH-NBR    TO ML021-PURCH-BATCH-NBR        22770000
W40007*                                    ML030-PURCH-BATCH-NBR                
W40007*                                    ML025-RPT1-BATCH-NBR         22780000
W40007*    MOVE ML020-XFER-TO-STORE-NBR TO ML021-PURCH-REL-STORE-NBR    22790000
W40007*                                    ML030-PURCH-REL-STORE-NBR    22790000
W40007*                                                                 22800000
W40007*    MOVE ML020-XFER-QTY          TO ML021-PURCH-QTY              22810000
W40007*                                    ML030-PURCH-QTY              22810000
W40007*    MOVE ML020-XFER-PER-UNT-RTL-AMT                              22820000
W40007*                                 TO ML021-PURCH-PER-UNT-RTL-AMT  22830000
W40007*                                    ML030-PURCH-PER-UNT-RTL-AMT  22830000
W40007*    MOVE MLCNTL-PSTG-FSCL-MN-NBR TO ML021-PURCH-KOHLS-MM         22840000
W40007*                                    ML030-PURCH-KOHLS-MM         22840000
W40007*                                                                 22850000
W40007*    MOVE ML020-XFER-EXTD-RTL-AMT TO ML021-PURCH-EXTD-RTL-AMT     22860000
W40007*                                    ML030-PURCH-EXTD-RTL-AMT     22860000
W40007*                                    ML025-RPT1-EXTD-RTL-AMT      22870000
W40007*                                                                 22880000
W40007*    ADD 1                        TO TR-TRANS-OK (3)              22890000
W40007*    ADD ML020-XFER-EXTD-RTL-AMT  TO TR-TRANS-RTL-OK (3)          22900000
W40007*    MOVE ML020-XFER-ENT-ID       TO ML021-PURCH-ENT-ID           17422200
W40007*                                    ML030-PURCH-ENT-ID           17422200
W40007*                                                                 22910000
W40007*    MOVE ZERO                   TO ML021-PURCH-EXTD-NET-COST-AMT 22920000
W40007*                                   ML030-PURCH-EXTD-NET-COST-AMT 22920000
W40007*                                   ML025-RPT1-EXTD-COST-AMT      22930000
W40007*                                                                 22940000
W40007*    IF  ML020-XFER-NBR = 'FAST '                                 22950000
W40007*        MOVE SPACES TO ML025-RPT1-XFER-DOC-NBR                   22960000
W40007*        IF  ML020-XFER-DOC-STORE NUMERIC AND                     22970000
W40007*            ML020-XFER-DOC-SEQ   NUMERIC                         22980000
W40007*            MOVE ML020-XFER-DOC-STORE     TO                     22990000
W40007*                 ML025-RPT1-XFER-DOC-STORE                       23000000
W40007*            MOVE ML020-XFER-DOC-SEQ       TO                     23010000
W40007*                 ML025-RPT1-XFER-DOC-SEQ                         23020000
W40007*        ELSE                                                     23030000
W40007*            MOVE ML020-XFER-DOC-NBR (1:4) TO                     23040000
W40007*                 ML025-RPT1-XFER-DOC-NBR (1:4)                   23050000
W40007*            MOVE ML020-XFER-DOC-NBR (5:6) TO                     23060000
W40007*                 ML025-RPT1-XFER-DOC-NBR (5:6)                   23070000
W40007*        END-IF                                                   23080000
W40007*    ELSE                                                         23090000
W40007*        MOVE SPACES                       TO                     23100000
W40007*             ML025-RPT1-XFER-DOC-NBR                             23110000
W40007*    END-IF                                                       23120000
W40007*                                                                 23130000
W40007*    WRITE PURCH-REC           FROM ML021-PURCH-RECORD.           23140000
W40007*    WRITE BV-PURCH-REC        FROM ML030-PURCH-RECORD            17570000
W40007*                                                                 23150000
W40007*    PERFORM Z400-WRITE-RPT1-REC.                                 23160000
W40007*                                                                 23170000
W40007*    IF ML021-PURCH-EXTD-RTL-AMT > 999.99                         23180000
W40007*        PERFORM F160-WRITE-EXCEPTION-REPORT                      23190000
W40007*    END-IF.                                                      23200000
W40007*                                                                 23210000
W40007*                                                                 23220000
W40007*F140-WRITE-ML021-TO-STORE.                                       23230000
W40007*                                                                 23240000
      **   FOR THE MOST PART, USE THE "FROM" STORE'S ML021 VALUES.      23250000
      **   THIS RECORD IS THE "TO" STORE COUNTERPART.                   23260000
W40007*                                                                 23270000
W40007*    MOVE ML020-XFER-TO-STORE-NBR                                 23280000
W40007*                                 TO ML021-PURCH-STORE-NBR        23290000
W40007*                                    ML030-PURCH-STORE-NBR        23290000
W40007*                                    ML025-RPT1-STORE-NBR         23300000
W40007*                                                                 23310000
W40007*    MOVE '31'                    TO ML021-PURCH-TRANS-CDE        23320000
W40007*                                    ML030-PURCH-TRANS-CDE        23320000
W40007*                                    ML025-RPT1-TRANS-CDE         23330000
W40007*                                                                 23340000
W40007*    MOVE PC-AP-TRANS-CDE-XFER-TO TO ML021-PURCH-AP-TRANS-CDE     23350000
W40007*                                    ML030-PURCH-AP-TRANS-CDE.    23350000
W40007*                                                                 23360000
W40007*                                                                 23370000
W40007*    MOVE ML021-PURCH-FIN-LIAB-DTE TO PV-FIN-LIAB-DTE.            23380000
W40007*    PERFORM Z300-SET-ML-AND-INV-INDS.                            23390000
W40007*    MOVE PV-ML-IND               TO ML021-PURCH-ML-IND           23400000
W40007*                                    ML030-PURCH-ML-IND           23400000
W40007*                                    ML025-RPT1-ML-IND            23410000
W40007*    MOVE PV-INV-IND              TO ML021-PURCH-INV-IND          23420000
W40007*                                    ML030-PURCH-INV-IND          23420000
W40007*                                    ML025-RPT1-INV-IND           23430000
W40007*                                                                 23440000
      **   THIS IS THE "FROM" STORE.                                    23450000
W40007*    MOVE ML020-STORE-NBR         TO ML021-PURCH-REL-STORE-NBR    23460000
W40007*                                    ML030-PURCH-REL-STORE-NBR    23460000
W40007*                                                                 23470000
W40007*    ADD 1                                  TO TR-TRANS-OK (4)    23480000
W40007*    ADD ML020-XFER-EXTD-RTL-AMT            TO                    23490000
W40007*        TR-TRANS-RTL-OK (4)                                      23500000
W40007*                                                                 23510000
W40007*    WRITE PURCH-REC            FROM ML021-PURCH-RECORD.          23520000
W40007*    WRITE BV-PURCH-REC         FROM ML030-PURCH-RECORD.          23520000
W40007*                                                                 23530000
W40007*    PERFORM Z400-WRITE-RPT1-REC.                                 23540000
W40007*                                                                 23550000
                                                                        23560000
W40007*F150-FORMAT-ERROR-REC.                                           23570000
W40007*                                                                 23580000
      **   A SINGLE ERROR (RPT2) RECORD IS WRITTEN FOR 30/31'S.         23590000
W40007*                                                                 23600000
W40007*    MOVE ML020-STORE-NBR         TO ML026-RPT2-STORE-NBR         23610000
W40007*                                                                 23620000
W40007*    MOVE ML020-SKU               TO ML026-RPT2-SKU               23630000
W40007*    MOVE ML020-DEPT-CLASS        TO ML026-RPT2-DEPT-CLASS        23640000
W40007*    MOVE ML020-TRANS-CDE         TO ML026-RPT2-TRANS-CDE         23650000
W40007*                                                                 23660000
W40007*    MOVE ML020-XFER-TO-STORE-NBR                                 23670000
W40007*                                 TO ML026-RPT2-REL-STORE-NBR     23680000
W40007*                                                                 23690000
W40007*    MOVE ML020-XFER-MM           TO ML026-RPT2-FIN-LIAB-MM.      23700000
W40007*    MOVE '/'                     TO ML026-RPT2-FIN-SLASH1.       23710000
W40007*    MOVE ML020-XFER-DD           TO ML026-RPT2-FIN-LIAB-DD.      23720000
                                                                        23730000
W40007*    MOVE ML020-XFER-KOHLS-MM     TO ML026-RPT2-KOHLS-MM          23740000
W40007*    MOVE ML020-XFER-QTYX         TO ML026-RPT2-QTYX.             23750000
W40007*                                                                         
W40007*    IF ML020-XFER-EXTD-RTL-AMT NOT NUMERIC                       23780000
W40007*        MOVE ML020-XFER-EXTD-RTL-AMTX                            23760000
W40007*                                 TO ML026-RPT2-AMTX              23770000
W40007*    ELSE                                                                 
W40007*        MOVE ML020-XFER-EXTD-RTL-AMT                             23760000
W40007*                                 TO ML026-RPT2-AMT               23770000
W40007*    END-IF.                                                              
W40007*                                                                         
W40007*    IF ML020-XFER-PER-UNT-RTL-AMT NUMERIC                        23780000
W40007*        MOVE ML020-XFER-PER-UNT-RTL-AMT                          23790000
W40007*                                 TO ML026-RPT2-OLD-PR-AMT        23800000
W40007*    ELSE                                                         23810000
W40007*        MOVE ML020-XFER-PER-UNT-RTL-AMTX                         23820000
W40007*                                 TO ML026-RPT2-OLD-PR-AMTX       23830000
W40007*    END-IF.                                                      23840000
W40007*                                                                         
W40007*    MOVE ZEROS                   TO ML026-RPT2-NEW-PR-AMTX.      23850000
W40007*    MOVE ZEROS                   TO ML026-RPT2-PO-NBRX.          23860000
W40007*    MOVE ML020-XFER-RSN-CDE      TO ML026-RPT2-RSN-CDE           23870000
W40007*    MOVE ML020-XFER-NBR          TO ML026-RPT2-DOC-5-NBR         23880000
W40007*    MOVE ML020-XFER-BATCH-NBR    TO ML026-RPT2-BATCH-NBR         23890000
W40007*    MOVE SPACES                  TO ML026-RPT2-VEND-NBR          23900000
W40007*    MOVE ML020-XFER-ENT-ID       TO ML026-RPT2-ENT-ID            23901000
W40007*    MOVE ZEROS                   TO ML026-RPT2-DISC-AMTX.        23910000
W40007*    MOVE ZEROS                   TO ML026-RPT2-FRGT-AMTX.        23920000
W40007*    MOVE ZEROS                   TO ML026-RPT2-NET-COST-AMTX     23930000
W40007*    MOVE ZEROS                   TO ML026-RPT2-RETAIL-AMTX.      23940000
W40007*    MOVE ZEROS                   TO ML026-RPT2-DR-CR-CDE.        23950000
W40007*                                                                 23960000
W40007*    IF  ML020-XFER-NBR = 'FAST '                                 23970000
W40007*        IF  ML020-XFER-DOC-STORE NUMERIC AND                     23980000
W40007*            ML020-XFER-DOC-SEQ   NUMERIC                         23990000
W40007*            MOVE ML020-XFER-DOC-STORE     TO                     24000000
W40007*                 ML026-RPT2-XFER-DOC-STORE                       24010000
W40007*            MOVE ML020-XFER-DOC-SEQ       TO                     24020000
W40007*                 ML026-RPT2-XFER-DOC-SEQ                         24030000
W40007*        ELSE                                                     24040000
W40007*            MOVE ML020-XFER-DOC-NBR (1:4) TO                     24050000
W40007*                 ML026-RPT2-XFER-DOC-NBR (1:4)                   24060000
W40007*            MOVE ML020-XFER-DOC-NBR (5:6) TO                     24070000
W40007*                 ML026-RPT2-XFER-DOC-NBR (5:6)                   24080000
W40007*        END-IF                                                   24090000
W40007*    ELSE                                                         24100000
W40007*        MOVE ML020-XFER-NBR               TO                     24110000
W40007*             ML026-RPT2-XFER-DOC-NBR                             24120000
W40007*    END-IF                                                       24130000
W40007*                                                                 24140000
W40007*    ADD 1                                  TO TR-TRANS-ERR(3)    24150000
W40007*                                              TR-TRANS-ERR(4)    24160000
W40007*                                                                 24170000
W40007*    IF ML020-XFER-EXTD-RTL-AMT  NUMERIC                          24180000
W40007*        ADD ML020-XFER-EXTD-RTL-AMT        TO                    24190000
W40007*            TR-TRANS-RTL-ERR (3)                                 24200000
W40007*            TR-TRANS-RTL-ERR (4)                                 24210000
W40007*    END-IF.                                                      24220000
W40007*                                                                 24230000
W40007*                                                                 24240000
W40007*F160-WRITE-EXCEPTION-REPORT.                                     24250000
W40007*                                                                 24260000
W40007*    MOVE SPACES                  TO EX-DETAIL-LINE               24270000
W40007*                                                                 24280000
W40007*    MOVE ML020-STORE-NBR         TO EX-STORE-NBR                 24290000
W40007*                                                                 24300000
W40007*    MOVE ML020-DEPT-CLASS        TO EX-DEPT-CLASS                24310000
W40007*    MOVE ML020-TRANS-CDE         TO EX-TRANS-CDE                 24320000
W40007*                                                                 24330000
W40007*    MOVE ML020-XFER-TO-STORE-NBR TO EX-REL-STORE-NBR             24340000
W40007*                                                                 24350000
W40007*    MOVE ML020-XFER-BATCH-NBR    TO EX-BATCH-NBR                 24360000
W40007*    MOVE ML020-XFER-KOHLS-MM     TO EX-KOHLS-MM                  24370000
W40007*                                                                 24380000
W40007*    IF  ML020-XFER-NBR NUMERIC                                   24390000
W40007*        CONTINUE                                                 24400000
W40007*    ELSE                                                         24410000
W40007*        IF  ML020-XFER-NBR = 'FAST '                             24420000
W40007*            MOVE ML020-XFER-NBR           TO                     24430000
W40007*                 EX-SOURCE-NBR                                   24440000
W40007*        ELSE                                                     24450000
W40007*            SET ML027-ERR-NON-NUMERIC     TO TRUE                24460000
W40007*            MOVE ML027-ERR-CDE            TO                     24470000
W40007*                 ML026-RPT2-DOC-5-NBR-ERR                        24480000
W40007*            SET PV-DTL-ERROR TO TRUE                             24490000
W40007*        END-IF                                                   24500000
W40007*    END-IF                                                       24510000
W40007*                                                                 24520000
W40007*    IF  ML020-XFER-NBR = 'FAST '                                 24530000
W40007*        IF  ML020-XFER-DOC-STORE NUMERIC AND                     24540000
W40007*            ML020-XFER-DOC-SEQ    NUMERIC                        24550000
W40007*            MOVE ML020-XFER-DOC-STORE     TO                     24560000
W40007*                 EX-DOC-NBR-11 (1:4)                             24570000
W40007*            MOVE '-'                      TO                     24580000
W40007*                 EX-DOC-NBR-11 (5:1)                             24590000
W40007*            MOVE ML020-XFER-DOC-SEQ       TO                     24600000
W40007*                 EX-DOC-NBR-11 (6:6)                             24610000
W40007*        ELSE                                                     24620000
W40007*            MOVE ML020-XFER-DOC-NBR (1:4) TO                     24630000
W40007*                 EX-DOC-NBR-11 (1:4)                             24640000
W40007*            MOVE '-'                      TO                     24650000
W40007*                 EX-DOC-NBR-11 (5:1)                             24660000
W40007*            MOVE ML020-XFER-DOC-NBR (5:6) TO                     24670000
W40007*                 EX-DOC-NBR-11 (6:6)                             24680000
W40007*        END-IF                                                   24690000
W40007*    ELSE                                                         24700000
W40007*        MOVE ML020-XFER-NBR          TO EX-DOC-NBR-11            24710000
W40007*    END-IF                                                       24720000
W40007*                                                                 24730000
W40007*    STRING ML020-XFER-MM         DELIMITED BY SIZE               24740000
W40007*           '/'                   DELIMITED BY SIZE               24750000
W40007*           ML020-XFER-DD         DELIMITED BY SIZE               24760000
W40007*                                 INTO EX-LIAB-MMDD.              24770000
W40007*                                                                 24780000
W40007*    MOVE ML020-XFER-QTY          TO EX-QTY.                      24790000
W40007*    MOVE ML020-XFER-PER-UNT-RTL-AMT                              24800000
W40007*                                 TO EX-PRICE                     24810000
W40007*    MOVE ML020-XFER-EXTD-RTL-AMT                                 24820000
W40007*                                 TO EX-RETAIL.                   24830000
W40007*                                                                 24840000
W40007*    IF PV-LINE-COUNT > +59                                       24850000
W40007*        PERFORM F200-HEADINGS                                    24860000
W40007*    END-IF.                                                      24870000
W40007*    MOVE EX-DETAIL-LINE          TO EXCEPTIONS-LINE.             24880000
W40007*    PERFORM F900-WRITE-EXCEPTION-REPORT.                         24890000
W40007*                                                                 24900000
W40007*    ADD +1                      TO PV-EX-TOT-TRAN-COUNT.         24910000
W40007*    ADD ML020-XFER-EXTD-RTL-AMT TO PV-EX-TOT-RETAIL.             24920000
W40007*                                                                 24930000
W40007*                                                                 24940000
W40007*F200-HEADINGS.                                                   24950000
W40007*                                                                 24960000
W40007*    ADD 1              TO PV-PAGE-COUNT                          24970000
W40007*                                                                 24980000
W40007*    MOVE PV-PAGE-COUNT TO DP133O-PAGE-NUMBER.                    24990000
W40007*    MOVE 1             TO DP133O-REPORT-NUMBER.                  25000000
W40007*    MOVE DP133O-STANDRD-HEADER-133-COLS TO EXCEPTIONS-LINE.      25010000
W40007*    MOVE '1'           TO EXCEPTIONS-LINE-CC                     25020000
W40007*    MOVE ' '           TO EX-HEADER-FONT-INDICATOR               25030000
W40007*                                                                 25040000
W40007*    PERFORM F900-WRITE-EXCEPTION-REPORT.                         25050000
W40007*                                                                 25060000
W40007*    MOVE SPACES     TO EXCEPTIONS-LINE.                          25070000
W40007*    PERFORM F900-WRITE-EXCEPTION-REPORT.                         25080000
W40007*                                                                 25090000
W40007*    MOVE PV-PROC-GREG-FMT-DTE   TO EX-HDG1-DTE                   25100000
W40007*    IF CC-PROCESSING-MODE-INV-ONLY                               25110000
W40007*        MOVE PC-INVENTORY-ONLY-MODE TO EX-HDG1-PROCESSING-MODE   25120000
W40007*    END-IF.                                                      25130000
W40007*                                                                 25140000
W40007*    MOVE EX-HDG1    TO EXCEPTIONS-LINE.                          25150000
W40007*    PERFORM F900-WRITE-EXCEPTION-REPORT.                         25160000
W40007*    MOVE EX-HDG2    TO EXCEPTIONS-LINE.                          25170000
W40007*    PERFORM F900-WRITE-EXCEPTION-REPORT.                         25180000
W40007*    MOVE EX-HDG3    TO EXCEPTIONS-LINE.                          25190000
W40007*    PERFORM F900-WRITE-EXCEPTION-REPORT.                         25200000
W40007*                                                                 25210000
W40007*    MOVE SPACES     TO EXCEPTIONS-LINE.                          25220000
W40007*    PERFORM F900-WRITE-EXCEPTION-REPORT.                         25230000
W40007*                                                                 25240000
W40007*    MOVE 6 TO PV-LINE-COUNT.                                     25250000
W40007*                                                                 25260000
W40007*                                                                 25270000
W40007*F900-WRITE-EXCEPTION-REPORT.                                     25280000
W40007*                                                                 25290000
W40007*    WRITE EXCEPTIONS-LINE.                                       25300000
W40007*                                                                 25310000
W40007*    EVALUATE TRUE                                                25320000
W40007*        WHEN EXCEPTIONS-LINE-CC = ' '                            25330000
W40007*            ADD  1 TO  PV-LINE-COUNT                             25340000
W40007*        WHEN EXCEPTIONS-LINE-CC = '0'                            25350000
W40007*            ADD  2 TO  PV-LINE-COUNT                             25360000
W40007*        WHEN EXCEPTIONS-LINE-CC = '-'                            25370000
W40007*            ADD  3 TO  PV-LINE-COUNT                             25380000
W40007*    END-EVALUATE.                                                25390000
                                                                        25400000
                                                                        25410000
       G100-PROCESS-PRICE-CHANGE.                                       25420000
                                                                        25430000
           PERFORM G110-EDIT-ML020.                                     25440000
                                                                        25450000
           IF PV-NO-DTL-ERROR                                           25460000
               PERFORM G130-WRITE-OUTPUT-FILES                          25470000
           ELSE                                                         25480000
               PERFORM G160-FORMAT-ERROR-REC                            25490000
               PERFORM Z998-WRITE-ERROR-FILE                            25500000
           END-IF.                                                      25510000
                                                                        25520000
                                                                        25530000
       G110-EDIT-ML020.                                                 25540000
                                                                        25550000
W40007*    INITIALIZE ML023-PC-RECORD                                   25560000
W40007*               ML029-PC-RECORD                                   25560000
W40007*               ML033-DW-PC-RECORD                                25560000
W40007*               ML025-RPT1-DETAIL-RECORD                          25570000
                                                                        25580000
W40007*    IF ML020-PERM             OR                                 25590000
W40007*       ML020-PROMO            OR                                 25600000
W40007*       ML020-DATA-ENTRY                                          25610000
W40007*        CONTINUE                                                 25620000
W40007*    ELSE                                                         25630000
W40007*        DISPLAY 'INVALID SYST-ORIG-CDE ON A PRICE CHANGE TRAN: ' 25640000
W40007*                 ML020-SYST-ORIG-CDE                             25650000
W40007*        PERFORM Z999-INVALID-PRESET-VALUE-ABND                   25660000
W40007*    END-IF                                                       25670000
                                                                        25680000
W40007*    IF ML020-PC-DOC-5-NBR NOT NUMERIC                            25690000
W40007     IF ML044-PC-DOC-5-NBR NOT NUMERIC                            25690000
               SET PV-DTL-ERROR TO TRUE                                 25700000
               SET ML027-ERR-NON-NUMERIC     TO TRUE                    25710000
               MOVE ML027-ERR-CDE            TO                         25720000
                    ML026-RPT2-DOC-5-NBR-ERR                            25730000
W40007              ERROR-CDE                                                   
           END-IF                                                       25740000
                                                                        25750000
W40007*    IF ML020-PC-QTY NUMERIC                                      25760000
W40007     IF ML044-PC-QTY NUMERIC                                      25760000
               CONTINUE                                                 25770000
           ELSE                                                         25780000
               SET PV-DTL-ERROR TO TRUE                                 25790000
               SET ML027-ERR-NON-NUMERIC     TO TRUE                    25800000
               MOVE ML027-ERR-CDE            TO                         25810000
                    ML026-RPT2-QTY-ERR                                  25820000
W40007              ERROR-CDE                                                   
           END-IF                                                       25830000
                                                                        25840000
W40007*    IF ML020-PC-OLD-PR-AMT NOT NUMERIC                           25850000
W40007     IF ML044-PC-OLD-PR-AMT NOT NUMERIC                           25850000
               SET ML027-ERR-NON-NUMERIC     TO TRUE                    25860000
               MOVE ML027-ERR-CDE            TO                         25870000
                    ML026-RPT2-AMT-ERR                                  25880000
                    ML026-RPT2-OLD-PR-AMT-ERR                           25890000
W40007              ERROR-CDE                                                   
               SET PV-DTL-ERROR TO TRUE                                 25900000
           END-IF                                                       25910000
                                                                        25920000
W40007*    IF ML020-PC-NEW-PR-AMT NOT NUMERIC                           25930000
W40007     IF ML044-PC-NEW-PR-AMT NOT NUMERIC                           25930000
               SET ML027-ERR-NON-NUMERIC     TO TRUE                    25940000
               MOVE ML027-ERR-CDE            TO                         25950000
                    ML026-RPT2-AMT-ERR                                  25960000
                    ML026-RPT2-NEW-PR-AMT-ERR                           25970000
W40007              ERROR-CDE                                                   
               SET PV-DTL-ERROR TO TRUE                                 25980000
           END-IF                                                       25990000
                                                                        26000000
           MOVE ZERO TO PV-PRICE-CHANGE                                 26010000
                        ML026-RPT2-AMT                                  26020000
W40007                  ML044-PC-DIFFER-AMT                                     
                                                                        26030000
W40007*    IF ML020-PC-NEW-PR-AMT NUMERIC AND                           26040000
W40007*       ML020-PC-OLD-PR-AMT NUMERIC                               26050000
W40007*        IF ML020-PC-NEW-PR-AMT = ML020-PC-OLD-PR-AMT             26060000
W40007     IF ML044-PC-NEW-PR-AMT NUMERIC AND                           26040000
W40007        ML044-PC-OLD-PR-AMT NUMERIC                               26050000
W40007         IF ML044-PC-NEW-PR-AMT = ML044-PC-OLD-PR-AMT             26060000
                   SET ML027-ERR-OLD-EQUAL-NEW        TO TRUE           26070000
                   MOVE ML027-ERR-CDE                 TO                26080000
                        ML026-RPT2-OLD-PR-AMT-ERR                       26090000
                        ML026-RPT2-NEW-PR-AMT-ERR                       26100000
W40007                  ERROR-CDE                                               
                   SET PV-DTL-ERROR TO TRUE                             26110000
               ELSE                                                     26120000
W40007*            IF ML020-MKDOWN                                      26130000
W40007             IF ML044-MKDOWN                                      26130000
                       PERFORM G140-MKDOWN-EDITS                        26140000
                   ELSE                                                 26150000
                       PERFORM G150-MKUP-EDITS                          26160000
                   END-IF                                               26170000
               END-IF                                                   26180000
           END-IF                                                       26190000
                                                                        26200000
W40007*    IF ML020-PC-QTY    NUMERIC AND                               26210000
W40007     IF ML044-PC-QTY    NUMERIC AND                               26210000
              PV-PRICE-CHANGE NUMERIC                                   26220000
               COMPUTE ML023-PC-EXTD-RTL-AMT =                          26230000
W40007*                ML020-PC-QTY * PV-PRICE-CHANGE                   26240000
W40007                 ML044-PC-QTY * PV-PRICE-CHANGE                   26240000
               MOVE ML023-PC-EXTD-RTL-AMT TO                            26250000
W28582              ML029-PC-EXTD-RTL-AMT                               26250000
                    ML025-RPT1-EXTD-RTL-AMT                             26260000
                    ML026-RPT2-AMT                                      26270000
                                                                        26280000
W40007*        IF ML020-MKUP                                            26290000
W40007         IF ML044-MKUP                                            26290000
                   IF ML023-PC-EXTD-RTL-AMT > +1000000                  26300000
                       SET ML027-ERR-OUT-OF-RANGE   TO TRUE             26310000
                       MOVE ML027-ERR-CDE           TO                  26320000
                            ML026-RPT2-AMT-ERR                          26330000
W40007                      ERROR-CDE                                           
                       SET PV-DTL-ERROR TO TRUE                         26340000
                   END-IF                                               26350000
               END-IF                                                   26360000
           END-IF                                                       26370000
                                                                        26380000
W40007*    MOVE ML023-PC-EXTD-RTL-AMT TO ML033-PC-EXTD-RTL-AMT          26300000
                                                                        26380000
      *AML     ELSE                                                     26390000
      *AML         IF ML023-PC-EXTD-RTL-AMT > +100000                   26400000
      *AML             SET ML027-ERR-OUT-OF-RANGE   TO TRUE             26410000
      *AML             MOVE ML027-ERR-CDE           TO                  26420000
      *AML                  ML026-RPT2-AMT-ERR                          26430000
      *AML             SET PV-DTL-ERROR TO TRUE                         26440000
      *AML         END-IF                                               26450000
      *AML     END-IF                                                   26460000
      *AML END-IF                                                       26470000
                                                                        26480000
W40007*    PERFORM G120-DATE-EDITS                                      26490000
                                                                        26500000
W40007*    IF ML020-MKDOWN                                              26510000
W40007     IF ML044-MKDOWN                                              26510000
               ADD 1 TO TR-TRANS-IN(5)                                  26520000
               IF ML023-PC-EXTD-RTL-AMT NUMERIC                         26530000
                   ADD ML023-PC-EXTD-RTL-AMT TO                         26540000
                       TR-TRANS-RTL-IN (5)                              26550000
               END-IF                                                   26560000
               IF PV-NO-DTL-ERROR                                       26570000
                   ADD 1 TO TR-TRANS-OK (5)                             26580000
                   ADD ML023-PC-EXTD-RTL-AMT TO                         26590000
                       TR-TRANS-RTL-OK (5)                              26600000
               ELSE                                                     26610000
                   ADD 1 TO TR-TRANS-ERR(5)                             26620000
                   ADD ML023-PC-EXTD-RTL-AMT TO                         26630000
                       TR-TRANS-RTL-ERR (5)                             26640000
               END-IF                                                   26650000
           ELSE                                                         26660000
               ADD 1 TO TR-TRANS-IN(6)                                  26670000
               IF ML023-PC-EXTD-RTL-AMT NUMERIC                         26680000
                   ADD ML023-PC-EXTD-RTL-AMT TO                         26690000
                       TR-TRANS-RTL-IN (6)                              26700000
               END-IF                                                   26710000
               IF PV-NO-DTL-ERROR                                       26720000
                   ADD 1 TO TR-TRANS-OK(6)                              26730000
                   ADD ML023-PC-EXTD-RTL-AMT TO                         26740000
                       TR-TRANS-RTL-OK (6)                              26750000
               ELSE                                                     26760000
                   ADD 1 TO TR-TRANS-ERR(6)                             26770000
                   IF ML023-PC-EXTD-RTL-AMT NUMERIC                     26780000
                       ADD ML023-PC-EXTD-RTL-AMT TO                     26790000
                           TR-TRANS-RTL-ERR (6)                         26800000
                   END-IF                                               26810000
               END-IF                                                   26820000
           END-IF.                                                      26830000
                                                                        26840000
                                                                        26850000
W40007*G120-DATE-EDITS.                                                 26860000
W40007*                                                                 26870000
W40007*    SET PS-NO-DATE-ERROR TO TRUE.                                26880000
                                                                        26890000
W40007*    IF  ML020-PC-DTE NUMERIC                                     26900000
W40007*    AND ML020-PC-DTE > ZERO                                      26910000
W40007*        MOVE ML020-PC-DTE-MM TO PV-EDIT-MM                       26920000
W40007*        MOVE ML020-PC-DTE-DD TO PV-EDIT-DD                       26930000
W40007*        MOVE SPACE           TO PV-EDIT-YY                       26940000
W40007*    ELSE                                                         26950000
W40007*        MOVE MLCNTL-PSTG-FSCL-WK-DTE (6:2) TO PV-EDIT-MM         26960000
W40007*        MOVE MLCNTL-PSTG-FSCL-WK-DTE (9:2) TO PV-EDIT-DD         26970000
W40007*        MOVE MLCNTL-PSTG-FSCL-WK-DTE (3:2) TO PV-EDIT-YY         26980000
W40007*    END-IF.                                                      26990000
W40007*                                                                 27000000
W40007*    PERFORM Z200-EDIT-DTE.                                       27010000
W40007*                                                                 27020000
W40007*    IF PS-DATE-ERROR                                             27030000
W40007*        SET ML027-ERR-INVALID-VALUE                              27040000
W40007*            PV-DTL-ERROR           TO TRUE                       27050000
W40007*        MOVE ML027-ERR-CDE         TO ML026-RPT2-FIN-LIAB-DTE-ERR27060000
W40007*    ELSE                                                         27070000
W40007*        MOVE EDT-ISO-DTE (EDT-IDX) TO ML023-PC-FIN-LIAB-DTE      27080000
W40007*                                      ML029-PC-FIN-LIAB-DTE      27080000
W40007*                                      ML033-PC-FIN-LIAB-DTE      27080000
W40007*                                      ML025-RPT1-FIN-LIAB-DTE    27090000
W40007*        MOVE ML023-PC-FIN-LIAB-DTE TO PV-FIN-LIAB-DTE            27100000
W40007*        PERFORM Z300-SET-ML-AND-INV-INDS                         27110000
W40007*    END-IF.                                                      27120000
W40007*                                                                 27130000
W40007*    IF ML020-PC-KOHLS-MM NOT NUMERIC                             27140000
W40007*        SET ML027-ERR-INVALID-DATE TO TRUE                       27150000
W40007*        MOVE ML027-ERR-CDE    TO ML026-RPT2-KOHLS-MM-ERR         27160000
W40007*        SET PV-DTL-ERROR      TO TRUE                            27170000
W40007*    END-IF.                                                      27180000
                                                                        27190000
                                                                        27200000
       G130-WRITE-OUTPUT-FILES.                                         27210000
                                                                        27220000
W40007*    MOVE ML020-STORE-NBR         TO ML023-PC-STORE-NBR           27230000
W40007*                                    ML029-PC-STORE-NBR           27230000
W40007*                                    ML033-PC-STORE-NBR           27230000
W40007*                                    ML025-RPT1-STORE-NBR         27240000
W40007*    MOVE ML020-SKU               TO ML023-PC-SKU                 27250000
W40007*                                    ML029-PC-SKU                 27250000
W40007*                                    ML033-PC-SKU                 27250000
W40007*                                    ML025-RPT1-SKU               27260000
W40007*    MOVE ML020-DEPT-CLASS        TO ML023-PC-DEPT-CLASS          27270000
W40007*                                    ML029-PC-DEPT-CLASS          27270000
W40007*                                    ML033-PC-DEPT-CLASS          27270000
W40007*                                    ML025-RPT1-DEPT-CLASS        27280000
W40007*    MOVE ML020-SYST-ORIG-CDE     TO ML023-PC-SYST-ORIG-CDE       27290000
W40007*                                    ML029-PC-SYST-ORIG-CDE       27290000
W40007*                                    ML033-PC-SYST-ORIG-CDE       27290000
W40007*    MOVE ML020-TRANS-CDE         TO ML023-PC-TRANS-CDE           27300000
W40007*                                    ML029-PC-TRANS-CDE           27300000
W40007*                                    ML033-PC-TRANS-CDE           27300000
W40007*                                    ML025-RPT1-TRANS-CDE         27310000
W40007*                                                                 27320000
W40007*    MOVE PV-PSTG-FSCL-YR-NBR         TO ML025-RPT1-FSCL-YR-CDE.  27330000
W40007*    MOVE MLCNTL-PSTG-FSCL-MN-NBR     TO ML025-RPT1-FSCL-PER-CDE. 27340000
W40007*                                                                 27350000
W40007*    MOVE EDT-FSCL-YR-NBR   (EDT-IDX) TO ML023-PC-FSCL-YR         27360000
W40007*                                        ML029-PC-FSCL-YR         27360000
W40007*                                        ML033-PC-FSCL-YR.        27360000
W40007*    MOVE EDT-FSCL-MN-NBR   (EDT-IDX) TO ML023-PC-FSCL-PER        27370000
W40007*                                        ML029-PC-FSCL-PER        27370000
W40007*                                        ML033-PC-FSCL-PER.       27370000
W40007*    MOVE EDT-WK-IN-MN-NBR  (EDT-IDX) TO ML023-PC-FSCL-WK         27380000
W40007*                                        ML029-PC-FSCL-WK         27380000
W40007*                                        ML033-PC-FSCL-WK.        27380000
W40007*    MOVE EDT-DAY-OF-WK-NBR (EDT-IDX) TO ML023-PC-FSCL-DAY        27390000
W40007*                                        ML029-PC-FSCL-DAY        27390000
W40007*                                        ML033-PC-FSCL-DAY.       27390000
W40007*                                                                 27400000
W40007*    MOVE MLCNTL-PSTG-FSCL-WK-DTE TO ML023-PC-EDIT-DTE            27410000
W40007*                                    ML029-PC-EDIT-DTE            27410000
W40007*                                    ML033-PC-EDIT-DTE            27410000
W40007*    MOVE ML020-PC-OLD-PR-AMT     TO ML023-PC-OLD-PR-AMT          27420000
W40007*                                    ML029-PC-OLD-PR-AMT          27420000
W40007*                                    ML033-PC-OLD-PR-AMT          27420000
W40007*    MOVE ML020-PC-NEW-PR-AMT     TO ML023-PC-NEW-PR-AMT          27430000
W40007*                                    ML029-PC-NEW-PR-AMT          27430000
W40007*                                    ML033-PC-NEW-PR-AMT          27430000
W40007*    MOVE ML020-PC-QTY            TO ML023-PC-QTY                 27440000
W40007*                                    ML029-PC-QTY                 27440000
W40007*                                    ML033-PC-QTY                 27440000
W40007*    MOVE ML020-PC-OLD-RSN-CDE    TO ML023-PC-OLD-RSN-CDE         27450000
W40007*                                    ML029-PC-OLD-RSN-CDE         27450000
W40007*                                    ML033-PC-OLD-RSN-CDE         27450000
W40007*    MOVE ML020-PC-DOC-5-NBR      TO ML023-PC-DOC-5-NBR           27460000
W40007*                                    ML029-PC-DOC-5-NBR           27460000
W40007*                                    ML033-PC-DOC-5-NBR           27460000
W40007*                                    ML025-RPT1-DOC-5-NBR         27470000
W40007*    MOVE ML020-PC-DOC-7-NBR      TO ML023-PC-DOC-7-NBR           27480000
W40007*                                    ML029-PC-DOC-7-NBR           27480000
W40007*                                    ML033-PC-DOC-7-NBR           27480000
W40007*    MOVE ML020-PC-BATCH-NBR      TO ML023-PC-BATCH-NBR           27490000
W40007*                                    ML029-PC-BATCH-NBR           27490000
W40007*                                    ML033-PC-BATCH-NBR           27490000
W40007*                                    ML025-RPT1-BATCH-NBR         27500000
W40007*    MOVE ML020-PC-CATEG-CDE      TO ML023-PC-CATEGORY            27510000
W40007*                                    ML029-PC-CATEGORY            27510000
W40007*                                    ML033-PC-CATEGORY            27510000
W40007*    MOVE MLCNTL-PSTG-FSCL-MN-NBR TO ML023-PC-KOHLS-MM            27520000
W40007*                                    ML029-PC-KOHLS-MM            27520000
W40007*                                    ML033-PC-KOHLS-MM.           27520000
W40007*                                                                 27530000
W40007*    MOVE PV-ML-IND               TO ML023-PC-ML-IND              27540000
W40007*                                    ML029-PC-ML-IND              27540000
W40007*                                    ML033-PC-ML-IND              27540000
W40007*                                    ML025-RPT1-ML-IND            27550000
W40007*    MOVE PV-INV-IND              TO ML023-PC-INV-IND             27560000
W40007*                                    ML029-PC-INV-IND             27560000
W40007*                                    ML033-PC-INV-IND             27560000
W40007*                                    ML025-RPT1-INV-IND           27570000
W40007*                                                                 27580000
W40007*    MOVE ML020-PC-MKDN-MKUP-RSN-CDE                              27590000
W40007*                                 TO ML023-PC-MKDN-MKUP-RSN-CDE   27600000
W40007*                                    ML029-PC-MKDN-MKUP-RSN-CDE   27600000
W40007*                                    ML033-PC-MKDN-MKUP-RSN-CDE   27600000
W40007*                                                                 27610000
W40007*    MOVE ML020-PC-VENDOR-INHSE-NMBR                              27620000
W40007*                                 TO ML023-PC-VENDOR-INHSE-NMBR   27630000
W40007*                                    ML029-PC-VENDOR-INHSE-NMBR   27630000
W40007*                                    ML033-PC-VENDOR-INHSE-NMBR.  27630000
W40007*    MOVE ML020-PC-ENT-ID         TO ML023-PC-ENT-ID              27631000
W40007*                                    ML029-PC-ENT-ID              27631000
W40007*                                    ML033-PC-ENT-ID.             27631000
W40007*    IF ML020-PC-ORIG-CLR-DTE = LOW-VALUES                                
W40007*       MOVE SPACES                TO ML033-PC-ORIG-CLR-DTE               
W40007*    ELSE                                                                 
W40007*       MOVE ML020-PC-ORIG-CLR-DTE TO ML033-PC-ORIG-CLR-DTE.      27631000
W40007*                                                                         
W40007*    IF ML020-PC-MKDN-CDE     = LOW-VALUES                                
W40007*       MOVE SPACES                TO ML033-PC-MKDN-CDE                   
W40007*    ELSE                                                                 
W40007*       MOVE ML020-PC-MKDN-CDE     TO ML033-PC-MKDN-CDE           27631000
W40007*    END-IF.                                                      27631000
W40007*                                                                 27631000
W40007*    IF ML020-PC-ORIG-RTL-NONGRP NUMERIC                          27631000
W40007*        IF ML020-PC-ORIG-RTL-NONGRP = ZEROES                     27631000
W40007*            MOVE ZEROES TO ML033-PC-ORIG-RTL-NONGRP              27631000
W40007*        ELSE                                                     27631000
W40007*            MOVE ML020-PC-ORIG-RTL-NONGRP TO                     27631000
W40007*                                         ML033-PC-ORIG-RTL-NONGRP27631000
W40007*        END-IF                                                   27631000
W40007*    ELSE                                                         27631000
W40007*        MOVE ZEROES TO ML033-PC-ORIG-RTL-NONGRP                  27631000
W40007*    END-IF.                                                      27631000
W40007*                                                                 27640000
W40007*    MOVE ML020-PC-DOC-16-NBR      TO ML029-PC-DOC-16-NBR.        27640000
W40007*    MOVE ML020-PC-AP-TRANS-CDE    TO ML029-PC-AP-TRANS-CDE.      27640000
W40007*                                                                 27640000
W40007*    WRITE PRC-CHG-REC          FROM ML023-PC-RECORD.             27650000
W40007*    WRITE BV-PRC-CHG-REC       FROM ML029-PC-RECORD.             27650000
W40007*    WRITE DW-PRC-CHG-REC       FROM ML033-DW-PC-RECORD.          27650000
W40007     WRITE DW-PRC-CHG-REC       FROM ML044-PRICE-CHANGE-RECORD.   27650000
W40007     ADD 1 TO PV-OUTPUT-REC-CNT.                                  27650000
                                                                        27660000
W40007*    PERFORM Z400-WRITE-RPT1-REC.                                 27670000
                                                                        27680000
                                                                        27690000
       G140-MKDOWN-EDITS.                                               27700000
                                                                        27710000
W40007*    IF ML020-PC-OLD-RSN-CDE =                                    27720000
W40007     IF ML044-PC-RSN-CDE =                                        27720000
               '1' OR '2' OR '3' OR '4' OR '5'                          27730000
               CONTINUE                                                 27740000
           ELSE                                                         27750000
               SET ML027-ERR-INVALID-VALUE    TO TRUE                   27760000
               MOVE ML027-ERR-CDE             TO                        27770000
                    ML026-RPT2-RSN-CDE-ERR                              27780000
W40007              ERROR-CDE                                                   
               SET PV-DTL-ERROR TO TRUE                                 27790000
           END-IF                                                       27800000
                                                                        27810000
           COMPUTE PV-PRICE-CHANGE = ML044-PC-OLD-PR-AMT -              27820000
                                     ML044-PC-NEW-PR-AMT                27830000
W40007     MOVE PV-PRICE-CHANGE  TO ML044-PC-DIFFER-AMT                 27840000
                                                                                
W40007*    IF ML020-PC-OLD-PR-AMT < +0                                  27850000
W40007     IF ML044-PC-OLD-PR-AMT < +0                                  27850000
               SET ML027-ERR-LESS-THAN-ZERO   TO TRUE                   27860000
               MOVE ML027-ERR-CDE             TO                        27870000
                    ML026-RPT2-OLD-PR-AMT-ERR                           27880000
W40007              ERROR-CDE                                                   
                    SET PV-DTL-ERROR TO TRUE                            27890000
           ELSE                                                         27900000
               IF PV-PRICE-CHANGE > +0                                  27910000
                   SET ML023-PC-MKDOWN        TO TRUE                   27920000
W28582             SET ML029-PC-MKDOWN        TO TRUE                   27920000
W40007*            SET ML033-PC-MKDOWN        TO TRUE                   27920000
W40007             SET ML044-MARKDOWN         TO TRUE                   27920000
               ELSE                                                     27930000
                   SET ML023-PC-MKDOWN-CANCEL TO TRUE                   27940000
W28582             SET ML029-PC-MKDOWN-CANCEL TO TRUE                   27940000
W40007*            SET ML033-PC-MKDOWN-CANCEL TO TRUE                   27940000
W40007             SET ML044-MARKDOWN-CANCEL  TO TRUE                   27940000
               END-IF                                                   27950000
           END-IF.                                                      27960000
                                                                        27970000
                                                                        27980000
       G150-MKUP-EDITS.                                                 27990000
                                                                        28000000
W40007*    IF ML020-PC-OLD-RSN-CDE =                                    28010000
W40007     IF ML044-PC-RSN-CDE =                                        28010000
               '1' OR '2' OR '3' OR '4' OR '5' OR '6'                   28020000
               CONTINUE                                                 28030000
           ELSE                                                         28040000
               SET PV-DTL-ERROR TO TRUE                                 28050000
               SET ML027-ERR-INVALID-VALUE    TO TRUE                   28060000
               MOVE ML027-ERR-CDE TO ML026-RPT2-RSN-CDE-ERR             28070000
W40007                               ERROR-CDE                          28070000
           END-IF                                                       28080000
                                                                        28090000
           COMPUTE PV-PRICE-CHANGE = ML044-PC-NEW-PR-AMT -              28100000
                                     ML044-PC-OLD-PR-AMT                28110000
W40007     MOVE PV-PRICE-CHANGE  TO ML044-PC-DIFFER-AMT                 27840000
                                                                        28120000
W40007*    IF ML020-PC-NEW-PR-AMT > +0                                  28130000
W40007     IF ML044-PC-NEW-PR-AMT > +0                                  28130000
               IF PV-PRICE-CHANGE > +0                                  28140000
                   SET ML023-PC-MKUP          TO TRUE                   28150000
W28582             SET ML029-PC-MKUP          TO TRUE                   28150000
W40007*            SET ML033-PC-MKUP          TO TRUE                   28150000
W40007             SET ML044-MARKUP           TO TRUE                   28150000
               ELSE                                                     28160000
                   SET ML023-PC-MKUP-CANCEL   TO TRUE                   28170000
W28582             SET ML029-PC-MKUP-CANCEL   TO TRUE                   28170000
W40007*            SET ML033-PC-MKUP-CANCEL   TO TRUE                   28170000
W40007             SET ML044-MARKUP-CANCEL    TO TRUE                   28170000
               END-IF                                                   28180000
           ELSE                                                         28190000
               SET ML027-ERR-INVALID-VALUE    TO TRUE                   28200000
               MOVE ML027-ERR-CDE TO ML026-RPT2-NEW-PR-AMT-ERR          28210000
W40007                               ERROR-CDE                                  
               SET PV-DTL-ERROR TO TRUE                                 28220000
           END-IF.                                                      28230000
                                                                        28240000
                                                                        28250000
       G160-FORMAT-ERROR-REC.                                           28260000
                                                                        28270000
W40007     MOVE ML044-PRICE-CHANGE-RECORD (1:200) TO                            
W40007              ERROR-PRICE-CHANGE-RECORD (1:200).                          
W40007*    MOVE ML020-STORE-NBR         TO ML026-RPT2-STORE-NBR         28280000
W40007*    MOVE ML020-SKU               TO ML026-RPT2-SKU               28290000
W40007*    MOVE ML020-DEPT-CLASS        TO ML026-RPT2-DEPT-CLASS        28300000
W40007*    MOVE ML020-TRANS-CDE         TO ML026-RPT2-TRANS-CDE         28310000
W40007*    MOVE SPACES                  TO ML026-RPT2-REL-STORE-NBR     28320000
W40007*                                                                 28330000
W40007*    MOVE ML020-PC-DTE-MM         TO ML026-RPT2-FIN-LIAB-MM.      28340000
W40007*    MOVE '/'                     TO ML026-RPT2-FIN-SLASH1.       28350000
W40007*    MOVE ML020-PC-DTE-DD         TO ML026-RPT2-FIN-LIAB-DD.      28360000
W40007*                                                                 28370000
W40007*    MOVE ML020-PC-KOHLS-MM       TO ML026-RPT2-KOHLS-MM          28380000
W40007*    MOVE ML020-PC-QTYX           TO ML026-RPT2-QTYX.             28390000
W40007*                                                                         
W40007*    IF ML020-PC-OLD-PR-AMT NOT NUMERIC                                   
W40007*      MOVE ML020-PC-OLD-PR-AMTX    TO ML026-RPT2-OLD-PR-AMTX     28400000
W40007*    ELSE                                                                 
W40007*      MOVE ML020-PC-OLD-PR-AMT     TO ML026-RPT2-OLD-PR-AMT      28400000
W40007*    END-IF.                                                              
W40007*                                                                         
W40007*    IF ML020-PC-NEW-PR-AMT NOT NUMERIC                                   
W40007*      MOVE ML020-PC-NEW-PR-AMTX  TO ML026-RPT2-NEW-PR-AMTX       28410000
W40007*    ELSE                                                                 
W40007*      MOVE ML020-PC-NEW-PR-AMT   TO ML026-RPT2-NEW-PR-AMT        28410000
W40007*    END-IF.                                                              
W40007*                                                                         
W40007*    MOVE ZEROS                   TO ML026-RPT2-PO-NBRX.          28420000
W40007*    MOVE ML020-PC-OLD-RSN-CDE    TO ML026-RPT2-RSN-CDE           28430000
W40007*    MOVE ML020-PC-BATCH-NBR      TO ML026-RPT2-BATCH-NBR         28440000
W40007*                                                                 28450000
W40007*    IF ML020-PC-DOC-7-NBR NUMERIC                                28460000
W40007*        MOVE ML020-PC-DOC-7-NBR  TO ML026-RPT2-DOC-7-NBR         28470000
W40007*    ELSE                                                         28480000
W40007*        MOVE ML020-PC-DOC-5-NBR  TO ML026-RPT2-DOC-5-NBR         28490000
W40007*    END-IF                                                       28500000
W40007*    MOVE SPACES                  TO ML026-RPT2-VEND-NBR          28510000
W40007*    MOVE ZEROS                   TO ML026-RPT2-ENT-ID            28511000
W40007*    MOVE ZEROS                   TO ML026-RPT2-DISC-AMTX.        28520000
W40007*    MOVE ZEROS                   TO ML026-RPT2-FRGT-AMTX.        28530000
W40007*    MOVE ZEROS                   TO ML026-RPT2-NET-COST-AMTX     28540000
W40007*    MOVE ZEROS                   TO ML026-RPT2-RETAIL-AMTX.      28550000
W40007*    MOVE SPACES                  TO ML026-RPT2-DR-CR-CDE.        28560000
W40007*                                                                 28570000
W40007*                                                                 28580000
W40007*H100-PROCESS-ADJUSTMENTS.                                        28590000
W40007*                                                                 28600000
W40007*    MOVE ML020-STORE-NBR TO PV-STORE-NBR.                        12610000
W40007*    SET ST-IDX TO 1                                              12660000
W40007*    SEARCH ALL STORE-ENTRIES                                     12670000
W40007*        AT END                                                   12680000
W40007*            SET ML027-ERR-NOT-FOUND TO TRUE                      12690000
W40007*            MOVE ML027-ERR-CDE      TO ML026-RPT2-STORE-NBR-ERR  12700000
W40007*            SET PV-STORE-LEVEL-ERROR TO TRUE                     12710000
W40007*        WHEN                                                     12720000
W40007*            ST-STORE-NMBR (ST-IDX) = ML020-STORE-NBR             12730000
W40007*                NEXT SENTENCE                                    12740000
W40007*    END-SEARCH.                                                  12760000
W40007*                                                                         
W40007*    IF ST-FINCL-BK-STAT (ST-IDX) = 'TC'                                  
W40007*        ADD 1 TO TR-TRANS-IN (7)                                 28610000
W40007*        IF ML020-ADJ-AT-RTL-AMT  NUMERIC                         28630000
W40007*            ADD ML020-ADJ-AT-RTL-AMT                             28640000
W40007*                TO TR-TRANS-RTL-IN (7)                           28650000
W40007*        END-IF                                                   28660000
W40007*        IF ML020-ADJ-AT-COST-AMT  NUMERIC                        28680000
W40007*            ADD ML020-ADJ-AT-COST-AMT                            28690000
W40007*                TO TR-TRANS-COST-IN (7)                          28700000
W40007*        END-IF                                                   28710000
W40007*    END-IF.                                                      28710000
W40007*                                                                 28720000
W40007*    PERFORM H110-EDIT-ML020.                                     28730000
W40007*                                                                 28740000
W40007*    IF PV-NO-DTL-ERROR                                           28750000
W40007*        PERFORM H130-WRITE-OUTPUT-FILES                          28760000
W40007*    ELSE                                                         28770000
W40007*        PERFORM H140-FORMAT-ERROR-REC                            28780000
W40007*        PERFORM Z998-WRITE-ERROR-FILE                            28790000
W40007*    END-IF.                                                      28800000
W40007*                                                                 28810000
W40007*H110-EDIT-ML020.                                                 28820000
W40007*                                                                 28830000
W40007*    INITIALIZE ML024-ADJ-RECORD                                  28840000
W40007*               ML025-RPT1-DETAIL-RECORD                          28850000
W40007*                                                                 28860000
W40007*    IF ML020-PHYSICAL-INVENTORY OR                               28870000
W40007*       ML020-MERCHANDISE-LEDGER                                  28880000
W40007*        CONTINUE                                                 28890000
W40007*    ELSE                                                         28900000
W40007*        DISPLAY 'INVALID SYST-ORIG-CDE ON AN ADJUSTMENT TRAN: '  28910000
W40007*                 ML020-SYST-ORIG-CDE                             28920000
W40007*        PERFORM Z999-INVALID-PRESET-VALUE-ABND                   28930000
W40007*    END-IF                                                       28940000
W40007*                                                                 28950000
W40007*    IF ML020-ADJ-AT-RTL-AMT NUMERIC                              28960000
W40007*        IF ML020-ADJ-AT-RTL-AMT = +0                             28970000
W40007*            SET ML027-ERR-EQUAL-ZERO      TO TRUE                28980000
W40007*            MOVE ML027-ERR-CDE            TO                     28990000
W40007*                 ML026-RPT2-RETAIL-AMT-ERR                       29000000
W40007*            SET PV-DTL-ERROR TO TRUE                             29010000
W40007*        END-IF                                                   29020000
W40007*    ELSE                                                         29030000
W40007*        SET ML027-ERR-NON-NUMERIC     TO TRUE                    29040000
W40007*        MOVE ML027-ERR-CDE            TO                         29050000
W40007*             ML026-RPT2-RETAIL-AMT-ERR                           29060000
W40007*        SET PV-DTL-ERROR TO TRUE                                 29070000
W40007*    END-IF                                                       29080000
W40007*                                                                 29090000
W40007*    IF ML020-ADJ-DOC-5-NBR NOT NUMERIC                           29100000
W40007*        SET ML027-ERR-NON-NUMERIC     TO TRUE                    29110000
W40007*        MOVE ML027-ERR-CDE            TO                         29120000
W40007*             ML026-RPT2-DOC-5-NBR-ERR                            29130000
W40007*        SET PV-DTL-ERROR TO TRUE                                 29140000
W40007*    END-IF                                                       29150000
W40007*                                                                 29160000
W40007*    IF ML020-ADJ-AT-COST-AMT NOT NUMERIC                         29170000
W40007*        MOVE +0                       TO ML020-ADJ-AT-COST-AMT   29180000
W40007*    END-IF                                                       29190000
W40007*                                                                 29200000
W40007*    PERFORM H120-DATE-EDITS.                                     29210000
W40007*                                                                 29220000
W40007*H120-DATE-EDITS.                                                 29240000
W40007*                                                                 29250000
W40007*    SET PS-NO-DATE-ERROR TO TRUE.                                29260000
W40007*                                                                 29270000
W40007*    IF  ML020-ADJ-DTE NUMERIC                                    29280000
W40007*    AND ML020-ADJ-DTE > ZERO                                     29290000
W40007*        MOVE ML020-ADJ-DTE TO PV-EDIT-DTE                        29300000
W40007*        PERFORM Z200-EDIT-DTE                                    29310000
W40007*        IF PS-DATE-ERROR                                         29320000
W40007*            SET ML027-ERR-INVALID-VALUE                          29330000
W40007*                PV-DTL-ERROR   TO TRUE                           29340000
W40007*            MOVE ML027-ERR-CDE TO ML026-RPT2-FIN-LIAB-DTE-ERR    29350000
W40007*        ELSE                                                     29360000
W40007*            MOVE EDT-ISO-DTE (EDT-IDX) TO ML024-ADJ-FIN-LIAB-DTE 29370000
W40007*                                          ML025-RPT1-FIN-LIAB-DTE29380000
W40007*            MOVE ML024-ADJ-FIN-LIAB-DTE                          29390000
W40007*                                       TO PV-FIN-LIAB-DTE        29400000
W40007*            PERFORM Z300-SET-ML-AND-INV-INDS                     29410000
W40007*        END-IF                                                   29420000
W40007*    ELSE                                                         29430000
W40007*        SET ML027-ERR-INVALID-VALUE                              29440000
W40007*            PV-DTL-ERROR   TO TRUE                               29450000
W40007*        MOVE ML027-ERR-CDE TO ML026-RPT2-FIN-LIAB-DTE-ERR        29460000
W40007*    END-IF.                                                      29470000
W40007*                                                                 29480000
W40007*    IF ML020-ADJ-KOHLS-MM NOT NUMERIC                            29490000
W40007*        SET ML027-ERR-INVALID-DATE TO TRUE                       29500000
W40007*        MOVE ML027-ERR-CDE    TO ML026-RPT2-KOHLS-MM-ERR         29510000
W40007*        SET PV-DTL-ERROR      TO TRUE                            29520000
W40007*    END-IF.                                                      29530000
W40007*                                                                 29540000
      ***-- PREVENT INVENTORY TRANSACTIONS FROM BEING LOADED INTO       29550000
      ***-- THE INCORRECT MONTH                                         29560000
W40007*    IF EDT-ISO-DTE (EDT-IDX) = MLCNTL-OPN-FSCL-MN-DTE            29570000
W40007*        CONTINUE                                                 29580000
W40007*    ELSE                                                         29590000
W40007*        SET ML027-ERR-INVALID-VALUE TO TRUE                      29600000
W40007*        MOVE ML027-ERR-CDE TO ML026-RPT2-FIN-LIAB-DTE-ERR        29610000
W40007*        SET PV-DTL-ERROR           TO TRUE                       29620000
W40007*    END-IF.                                                      29630000
W40007*                                                                 29640000
W40007*H130-WRITE-OUTPUT-FILES.                                         29650000
W40007*                                                                 29660000
W40007*    MOVE ML020-STORE-NBR         TO ML024-ADJ-STORE-NBR          29670000
W40007*                                    ML025-RPT1-STORE-NBR         29680000
W40007*    MOVE ML020-SKU               TO ML024-ADJ-SKU                29690000
W40007*                                    ML025-RPT1-SKU               29700000
W40007*    MOVE ML020-DEPT-CLASS        TO ML024-ADJ-DEPT-CLASS         29710000
W40007*                                    ML025-RPT1-DEPT-CLASS        29720000
W40007*    MOVE ML020-SYST-ORIG-CDE     TO ML024-ADJ-SYST-ORIG-CDE      29730000
W40007*    MOVE ML020-TRANS-CDE         TO ML024-ADJ-TRANS-CDE          29740000
W40007*                                    ML025-RPT1-TRANS-CDE         29750000
W40007*                                                                 29760000
W40007*    MOVE PV-PSTG-FSCL-YR-NBR         TO ML025-RPT1-FSCL-YR-CDE.  29770000
W40007*    MOVE MLCNTL-PSTG-FSCL-MN-NBR     TO ML025-RPT1-FSCL-PER-CDE. 29780000
W40007*                                                                 29790000
W40007*    MOVE EDT-FSCL-YR-NBR   (EDT-IDX) TO ML024-ADJ-FSCL-YR.       29800000
W40007*    MOVE EDT-FSCL-MN-NBR   (EDT-IDX) TO ML024-ADJ-FSCL-PER.      29810000
W40007*    MOVE EDT-WK-IN-MN-NBR  (EDT-IDX) TO ML024-ADJ-FSCL-WK.       29820000
W40007*    MOVE EDT-DAY-OF-WK-NBR (EDT-IDX) TO ML024-ADJ-FSCL-DAY.      29830000
W40007*                                                                 29840000
W40007*    MOVE MLCNTL-PSTG-FSCL-WK-DTE TO ML024-ADJ-EDIT-DTE           29850000
W40007*                                                                 29860000
W40007*    MOVE ML020-ADJ-AT-RTL-AMT    TO ML024-ADJ-AT-RTL-AMT         29870000
W40007*                                    ML025-RPT1-EXTD-RTL-AMT      29880000
W40007*    MOVE ML020-ADJ-AT-COST-AMT   TO ML024-ADJ-AT-COST-AMT        29890000
W40007*                                    ML025-RPT1-EXTD-COST-AMT     29900000
W40007*    MOVE ML020-ADJ-DOC-5-NBR     TO ML024-ADJ-DOC-5-NBR          29910000
W40007*    MOVE ML020-ADJ-DOC-5-NBRX    TO ML025-RPT1-DOC-5-NBR         29920000
W40007*    MOVE MLCNTL-PSTG-FSCL-MN-NBR TO ML024-ADJ-KOHLS-MM           29930000
W40007*                                                                 29940000
W40007*    MOVE PV-ML-IND               TO ML024-ADJ-ML-IND             29950000
W40007*                                    ML025-RPT1-ML-IND            29960000
W40007*    MOVE PV-INV-IND              TO ML024-ADJ-INV-IND            29970000
W40007*                                    ML025-RPT1-INV-IND           29980000
W40007*                                                                 29990000
W40007*    MOVE ML020-ADJ-ENT-ID        TO ML024-ADJ-ENT-ID                     
W40007*                                                                 29990000
W40007*    MOVE ML020-ADJ-ML-LWST-ID    TO ML024-ADJ-ML-LWST-ID                 
W40007*                                                                 29990000
W40007*    ADD 1                        TO TR-TRANS-OK (7)              30000000
W40007*                                                                 30010000
W40007*    IF ML020-ADJ-AT-RTL-AMT  NUMERIC                             30020000
W40007*       ADD ML020-ADJ-AT-RTL-AMT            TO                    30030000
W40007*       TR-TRANS-RTL-OK (7)                                       30040000
W40007*    END-IF                                                       30050000
W40007*                                                                 30060000
W40007*    IF ML020-ADJ-AT-COST-AMT  NUMERIC                            30070000
W40007*       ADD ML020-ADJ-AT-COST-AMT           TO                    30080000
W40007*       TR-TRANS-COST-OK (7)                                      30090000
W40007*    END-IF.                                                      30100000
W40007*                                                                 30110000
W40007*    WRITE ADJUSTMENT-REC       FROM ML024-ADJ-RECORD.            30120000
W40007*                                                                 30130000
W40007*    PERFORM Z400-WRITE-RPT1-REC.                                 30140000
W40007*                                                                 30150000
W40007*H140-FORMAT-ERROR-REC.                                           30170000
W40007*                                                                 30180000
W40007*    MOVE ML020-STORE-NBR         TO ML026-RPT2-STORE-NBR         30190000
W40007*                                                                 30200000
W40007*    MOVE ML020-SKU               TO ML026-RPT2-SKU               30210000
W40007*    MOVE ML020-DEPT-CLASS        TO ML026-RPT2-DEPT-CLASS        30220000
W40007*    MOVE ML020-TRANS-CDE         TO ML026-RPT2-TRANS-CDE         30230000
W40007*                                                                 30240000
W40007*    MOVE SPACES                  TO ML026-RPT2-REL-STORE-NBR     30250000
W40007*                                                                 30260000
W40007*    MOVE ML020-ADJ-DTE-MM        TO ML026-RPT2-FIN-LIAB-MM       30270000
W40007*    MOVE '/'                     TO ML026-RPT2-FIN-SLASH1        30280000
W40007*    MOVE ML020-ADJ-DTE-DD        TO ML026-RPT2-FIN-LIAB-DD       30290000
W40007*    MOVE '/'                     TO ML026-RPT2-FIN-SLASH2        30300000
W40007*    MOVE ML020-ADJ-DTE-YY        TO ML026-RPT2-FIN-LIAB-YY       30310000
W40007*                                                                 30320000
W40007*    MOVE ML020-ADJ-KOHLS-MM      TO ML026-RPT2-KOHLS-MM          30330000
W40007*                                                                 30340000
W40007*    MOVE ZEROS                   TO ML026-RPT2-QTY.              30350000
W40007*                                                                 30360000
W40007*    MOVE ZEROS                   TO ML026-RPT2-AMT.              30370000
W40007*                                                                 30380000
W40007*    MOVE ZEROS                   TO ML026-RPT2-OLD-PR-AMT.       30390000
W40007*    MOVE ZEROS                   TO ML026-RPT2-NEW-PR-AMT.       30400000
W40007*    MOVE ZEROS                   TO ML026-RPT2-PO-NBRX.          30410000
W40007*    MOVE ML020-ADJ-RSN-CDE       TO ML026-RPT2-RSN-CDE           30420000
W40007*    MOVE SPACES                  TO ML026-RPT2-BATCH-NBR         30430000
W40007*                                                                 30440000
W40007*    MOVE ML020-ADJ-DOC-5-NBRX    TO ML026-RPT2-DOC-5-NBR         30450000
W40007*    MOVE SPACES                  TO ML026-RPT2-VEND-NBR          30460000
W40007*    MOVE ML020-ADJ-ENT-ID        TO ML026-RPT2-ENT-ID            30461000
W40007*    MOVE ZEROS                   TO ML026-RPT2-DISC-AMT.         30470000
W40007*    MOVE ZEROS                   TO ML026-RPT2-FRGT-AMT.         30480000
W40007*                                                                         
W40007*    IF ML020-ADJ-AT-COST-AMT NOT NUMERIC                         14920000
W40007*      MOVE ML020-ADJ-AT-COST-AMTX  TO ML026-RPT2-NET-COST-AMTX   30490000
W40007*    ELSE                                                                 
W40007*      MOVE ML020-ADJ-AT-COST-AMT   TO ML026-RPT2-NET-COST-AMT    30490000
W40007*    END-IF.                                                              
W40007*                                                                         
W40007*    IF ML020-ADJ-AT-RTL-AMT NOT NUMERIC                          14920000
W40007*      MOVE ML020-ADJ-AT-RTL-AMTX   TO ML026-RPT2-RETAIL-AMTX     30500000
W40007*    ELSE                                                                 
W40007*      MOVE ML020-ADJ-AT-RTL-AMT    TO ML026-RPT2-RETAIL-AMT      30500000
W40007*    END-IF.                                                              
W40007*                                                                         
W40007*    MOVE SPACES                  TO ML026-RPT2-DR-CR-CDE.        30510000
W40007*                                                                 30520000
W40007*    ADD 1                                  TO TR-TRANS-ERR(7)    30530000
W40007*                                                                 30540000
W40007*    IF ML020-ADJ-AT-RTL-AMT  NUMERIC                             30550000
W40007*       ADD ML020-ADJ-AT-RTL-AMT            TO                    30560000
W40007*       TR-TRANS-RTL-ERR (7)                                      30570000
W40007*    END-IF                                                       30580000
W40007*                                                                 30590000
W40007*    IF ML020-ADJ-AT-COST-AMT  NUMERIC                            30600000
W40007*       ADD ML020-ADJ-AT-COST-AMT           TO                    30610000
W40007*       TR-TRANS-COST-ERR(7)                                      30620000
W40007*    END-IF.                                                      30630000
                                                                        30640000
                                                                        30650000
       Z100-READ-COMPOSITE-FILE.                                        30660000
                                                                        30670000
W40007*    READ COMPOSITE-FILE             INTO ML020-COMPOSITE-RECORD  30680000
W40007     READ COMPOSITE-FILE        INTO ML044-PRICE-CHANGE-RECORD    30680000
              AT END                                                    30690000
                   SET END-OF-COMPOSITE-FILE          TO TRUE.          30700000
                                                                        30710000
W40007     IF NOT END-OF-COMPOSITE-FILE                                         
W40007        ADD 1 TO PV-INPUT-REC-CNT                                         
W40007     END-IF.                                                              
                                                                                
W40007*Z200-EDIT-DTE.                                                   30730000
W40007*                                                                 30740000
W40007*    IF PV-EDIT-DTE = PV-LAST-EDIT-DTE                            30750000
W40007*        THE DATE BEING EDITED IS THE SAME AS THE LAST ONE THAT   30760000
W40007*        WAS EDITED.  WE ARE STILL POINTING TO THE DATE TABLE     30770000
W40007*        ENTRY FOR THAT DATE, SO THERE IS NO NEED TO LOOK IT UP.  30780000
W40007*        JUST SET THE DATE ERROR SWITCH IF NECESSARY.             30790000
W40007*        IF EDT-VALID-DTE-IND (EDT-IDX) = 'N'                     30800000
W40007*            SET PS-DATE-ERROR TO TRUE                            30810000
W40007*        END-IF                                                   30820000
W40007*    ELSE                                                         30830000
W40007*        MOVE PV-EDIT-DTE     TO PV-LAST-EDIT-DTE                 30840000
W40007*        PERFORM Z210-LOOKUP-EDIT-DTE                             30850000
W40007*    END-IF.                                                      30860000
W40007*                                                                 30870000
W40007*                                                                 30880000
W40007*Z210-LOOKUP-EDIT-DTE.                                            30890000
W40007*                                                                 30900000
      ***************************************************************** 30910000
      * EACH UNIQUE DATE IS TABLED IN WORKING STORAGE AS IT IS EDITED.  30920000
      * THIS MINIMIZES THE NUMBER OF CALLS TO TDTATTR. A CALL TO        30930000
      * TDTATTR IS ONLY DONE THE FIRST TIME A UNIQUE DATE IS            30940000
      * ENCOUNTERED. EACH TIME AFTER THAT, IT IS RETRIEVED FROM THE     30950000
      * WORKING STORAGE TABLE.                                          30960000
      ***************************************************************** 30970000
                                                                        30980000
W40007*    PERFORM VARYING EDT-IDX FROM +1 BY +1                        30990000
W40007*        UNTIL EDT-IDX > EDT-MAX                                  31000000
W40007*           OR EDT-EDIT-DTE (EDT-IDX) = PV-EDIT-DTE               31010000
W40007*           OR EDT-EDIT-DTE (EDT-IDX) = SPACES                    31020000
W40007*    END-PERFORM.                                                 31030000
W40007*                                                                 31040000
W40007*    IF EDT-IDX > EDT-MAX                                         31050000
W40007*        DISPLAY '**  ABEND     **'                               31060000
W40007*        DISPLAY '**  PROGRAM   **  =  EIKUP001'                  31070000
W40007*        DISPLAY '**  PARAGRAPH **  =  Z210-LOOKUP-EDIT-DTE'      31080000
W40007*        DISPLAY 'TABLE OVERFLOW OCCURRED ON EDT-EDIT-DTE-TBL.'   31090000
W40007*        MOVE +4004         TO ABEND-CODE                         31100000
W40007*        CALL 'ILBOABN0' USING ABEND-CODE                         31110000
W40007*    END-IF.                                                      31120000
W40007*                                                                 31130000
W40007*    IF EDT-EDIT-DTE (EDT-IDX) = PV-EDIT-DTE                      31140000
W40007*        IF EDT-VALID-DTE-IND (EDT-IDX) = 'N'                     31150000
W40007*            SET PS-DATE-ERROR TO TRUE                            31160000
W40007*        END-IF                                                   31170000
W40007*    ELSE                                                         31180000
W40007*        MOVE PV-EDIT-DTE   TO EDT-EDIT-DTE (EDT-IDX)             31190000
W40007*                                                                 31200000
W40007*        PERFORM Z220-DETERMINE-ISO-DTE                           31210000
W40007*                                                                 31220000
W40007*        IF PS-NO-DATE-ERROR                                      31230000
W40007*            MOVE PV-ISO-CCYY   TO PV-DB2-CCYY                    31240000
W40007*            MOVE PV-ISO-MM     TO PV-DB2-MM                      31250000
W40007*            MOVE PV-ISO-DD     TO PV-DB2-DD                      31260000
W40007*            PERFORM Z630-GET-EDIT-DTE-ATTRS                      31270000
W40007*            IF PS-NO-DATE-ERROR                                  31280000
W40007*                MOVE PV-ISO-DTE    TO EDT-ISO-DTE       (EDT-IDX)31290000
W40007*                MOVE DTATTR-FSCL-YR-NBR                          31300000
W40007*                                   TO EDT-FSCL-YR-NBR   (EDT-IDX)31310000
W40007*                MOVE DTATTR-FSCL-MN-NBR                          31320000
W40007*                                   TO EDT-FSCL-MN-NBR   (EDT-IDX)31330000
W40007*                MOVE DTATTR-FSCL-WK-NBR                          31340000
W40007*                                   TO EDT-FSCL-WK-NBR   (EDT-IDX)31350000
W40007*                MOVE DTATTR-WK-IN-MN-NBR                         31360000
W40007*                                   TO EDT-WK-IN-MN-NBR  (EDT-IDX)31370000
W40007*                MOVE DTATTR-DAY-OF-WK-NBR                        31380000
W40007*                                   TO EDT-DAY-OF-WK-NBR (EDT-IDX)31390000
W40007*                MOVE 'Y'           TO EDT-VALID-DTE-IND (EDT-IDX)31400000
W40007*            ELSE                                                 31410000
W40007*                MOVE 'N'           TO EDT-VALID-DTE-IND (EDT-IDX)31420000
W40007*            END-IF                                               31430000
W40007*        ELSE                                                     31440000
W40007*            MOVE 'N'               TO EDT-VALID-DTE-IND (EDT-IDX)31450000
W40007*        END-IF                                                   31460000
W40007*    END-IF.                                                      31470000
W40007*                                                                 31480000
W40007*Z220-DETERMINE-ISO-DTE.                                          31500000
W40007*                                                                 31510000
      ***************************************************************** 31520000
      * THE DATE BEING EDITED IS EITHER IN MMDD OR MMDDYY FORMAT.       31530000
      * ASSIGN A CENTURY AND, IF NECESSARY, A YEAR TO THE DATE TO COME  31540000
      * UP WITH THE ISO VERSION OF THE DATE.                            31550000
      ***************************************************************** 31560000
                                                                        31570000
W40007*    IF PV-EDIT-YY = SPACE                                        31580000
      *        THE DATE BEING EDITED IS AN MMDD DATE. DETERMINE THE     31590000
      *        CCYY THAT SHOULD BE ASSIGNED TO IT.                      31600000
                                                                        31610000
W40007*        IF PV-EDIT-MM = MLCNTL-PSTG-FSCL-WK-DTE (6:2)            31620000
                                                                        31630000
      *            THE MONTH OF THE DATE BEING EDITED IS THE SAME AS    31640000
      *            THE MONTH OF THE POSTING DATE. ASSUME THAT THE CCYY  31650000
      *            SHOULD ALSO BE THE SAME AS THE CCYY OF THE POSTING   31660000
      *            DATE.                                                31670000
W40007*                                                                 31680000
W40007*            MOVE MLCNTL-PSTG-FSCL-WK-DTE (1:4) TO PV-ISO-CCYY    31690000
W40007*            MOVE PV-EDIT-MM                    TO PV-ISO-MM      31700000
W40007*            MOVE PV-EDIT-DD                    TO PV-ISO-DD      31710000
W40007*        ELSE                                                     31720000
      *            THE MONTH OF THE DATE BEING EDITED IS NOT THE SAME   31730000
      *            AS THE MONTH OF THE POSTING DATE. FIND THE MOST      31740000
      *            RECENT DATE, PRIOR TO THE POSTING DATE, THAT IS      31750000
      *            VALID FOR THE MONTH AND DAY BEING EDITED. ASSIGN     31760000
      *            THE CCYY FROM THAT DATE TO THE MMDD DATE.            31770000
W40007*                                                                 31780000
W40007*            MOVE PV-EDIT-MM     TO PV-DB2-MM                     31790000
W40007*            MOVE PV-EDIT-DD     TO PV-DB2-DD                     31800000
W40007*            PERFORM Z620-GET-ISO-DTE-FOR-MMDD                    31810000
W40007*            IF PS-NO-DATE-ERROR                                  31820000
W40007*                MOVE PV-DB2-DTE TO PV-ISO-DTE                    31830000
W40007*            END-IF                                               31840000
W40007*        END-IF                                                   31850000
W40007*    ELSE                                                         31860000
      *        THE DATE BEING EDITED IS AN MMDDYY DATE.                 31870000
W40007*        IF   PV-EDIT-YY > PC-PIVOT-YEAR                          31880000
W40007*            MOVE '19'   TO PV-ISO-CC                             31890000
W40007*        ELSE                                                     31900000
W40007*            MOVE '20'   TO PV-ISO-CC                             31910000
W40007*        END-IF                                                   31920000
W40007*        MOVE PV-EDIT-YY TO PV-ISO-YY                             31930000
W40007*        MOVE PV-EDIT-MM TO PV-ISO-MM                             31940000
W40007*        MOVE PV-EDIT-DD TO PV-ISO-DD                             31950000
W40007*    END-IF.                                                      31960000
W40007*                                                                 31970000
W40007*                                                                 31980000
W40007*Z300-SET-ML-AND-INV-INDS.                                        31990000
W40007*                                                                 32000000
W40007*    IF CC-PROCESSING-MODE-ML                                     32010000
W40007*        SET PV-ML-IND-YES TO TRUE                                32020000
W40007*    ELSE                                                         32030000
W40007*        SET PV-ML-IND-NO  TO TRUE                                32040000
W40007*    END-IF.                                                      32050000
                                                                        32060000
W40007*    IF CC-PROCESSING-MODE-INV                                    32070000
W40007*        IF CC-CHECK-INV-DATES                                    32080000
W40007*            IF ST-SCHD-INV-CDE(ST-IDX) = 'EI'                    32090000
W40007*                SET PV-INV-IND-NO TO TRUE                        32100000
W40007*            ELSE                                                 32110000
W40007*                IF ML020-PURCHASE                                32120000
W40007*                    IF ML020-PURCH-TYP-RECEIPT                   32130000
W40007*                        IF (ST-MFSTNG-IND (ST-IDX) = 'N' OR      32140000
W40007*                            ST-MFSTNG-IND (ST-IDX) = ' ') AND    32150000
W40007*                            PV-FIN-LIAB-DTE >                    32160000
W40007*                                   ST-ACTL-DC-CTOFF-DTE (ST-IDX) 32170000
W40007*                            SET PV-INV-IND-NO  TO TRUE           32180000
W40007*                        ELSE                                     32190000
W40007*                            IF ST-MFSTNG-IND (ST-IDX) = 'Y' AND  32200000
W40007*                               PV-FIN-LIAB-DTE >                 32210000
W40007*                                       ST-PLND-INV-DTE (ST-IDX)  32220000
W40007*                                SET PV-INV-IND-NO  TO TRUE       32230000
W40007*                            ELSE                                 32240000
W40007*                                SET PV-INV-IND-YES TO TRUE       32250000
W40007*                            END-IF                               32260000
W40007*                        END-IF                                   32270000
W40007*                    ELSE                                         32280000
W40007*                        IF PV-FIN-LIAB-DTE >                     32290000
W40007*                           ST-PLND-INV-DTE (ST-IDX)              32300000
W40007*                            SET PV-INV-IND-NO  TO TRUE           32310000
W40007*                        ELSE                                     32320000
W40007*                            SET PV-INV-IND-YES TO TRUE           32330000
W40007*                        END-IF                                   32340000
W40007*                    END-IF                                       32350000
W40007*                ELSE                                             32360000
W40007*                    IF PV-FIN-LIAB-DTE >                         32370000
W40007*                       ST-PLND-INV-DTE (ST-IDX)                  32380000
W40007*                        SET PV-INV-IND-NO  TO TRUE               32390000
W40007*                    ELSE                                         32400000
W40007*                        SET PV-INV-IND-YES TO TRUE               32410000
W40007*                    END-IF                                       32420000
W40007*                END-IF                                           32430000
W40007*            END-IF                                               32440000
W40007*        ELSE                                                     32450000
      *        IF DATE CHECKING NOT USED, EST INV STRS MUST BE BYPASSED 32460000
W40007*            IF CC-DONT-CHECK-INV-DATES                           32470000
W40007*                IF ST-SCHD-INV-CDE(ST-IDX) = 'EI'                32480000
W40007*                   SET PV-INV-IND-NO TO TRUE                     32490000
W40007*                ELSE                                             32500000
W40007*                   SET PV-INV-IND-YES TO TRUE                    32510000
W40007*                END-IF                                           32520000
W40007*            END-IF                                               32530000
W40007*        END-IF                                                   32540000
W40007*    ELSE                                                         32550000
W40007*        SET PV-INV-IND-NO TO TRUE                                32560000
W40007*    END-IF.                                                      32570000
W40007*                                                                 32580000
W40007*                                                                 32590000
W40007*Z400-WRITE-RPT1-REC.                                             32600000
W40007*                                                                 32610000
W40007*    MOVE '*Z400-WRITE-RPT1-REC.            *' TO PV-PARA         32620000
W40007*                                                                 32630000
W40007*    WRITE REPORT-REC           FROM ML025-RPT1-RECORD.           32640000
W40007*                                                                 32650000
W40007*                                                                 32660000
       Z998-WRITE-ERROR-FILE.                                           32670000
                                                                        32680000
           MOVE '*Z998-WRITE-ERROR-FILE.          *' TO PV-PARA         32690000
                                                                        32700000
W40007*    WRITE ERROR-REC            FROM ML026-RPT2-RECORD.           32710000
W40007     WRITE ERROR-REC            FROM ERROR-PRICE-CHANGE-RECORD.   32710000
W40007     ADD 1 TO PV-ERROR-REC-CNT.                                   32710000
W27261     MOVE 'N' TO PV-DETAIL-ERR-SW.                                        
                                                                        32720000
                                                                        32730000
W40007*Z600-GET-MLCNTL-DTES.                                            32740000
W40007*                                                                 32750000
W40007*    EXEC SQL                                                     32760000
W40007*         SELECT                                                  32770000
W40007*             OPN_FSCL_MN_DTE                                     32780000
W40007*            ,OPN_FSCL_MN_NBR                                     32790000
W40007*            ,PSTG_FSCL_WK_DTE                                    32800000
W40007*            ,PSTG_FSCL_WK_NBR                                    32810000
W40007*            ,PSTG_FSCL_MN_DTE                                    32820000
W40007*            ,PSTG_FSCL_MN_NBR                                    32830000
W40007*         INTO                                                    32840000
W40007*             :MLCNTL-OPN-FSCL-MN-DTE                             32850000
W40007*            ,:MLCNTL-OPN-FSCL-MN-NBR                             32860000
W40007*            ,:MLCNTL-PSTG-FSCL-WK-DTE                            32870000
W40007*            ,:MLCNTL-PSTG-FSCL-WK-NBR                            32880000
W40007*            ,:MLCNTL-PSTG-FSCL-MN-DTE                            32890000
W40007*            ,:MLCNTL-PSTG-FSCL-MN-NBR                            32900000
W40007*         FROM TMLCNTL                                            32910000
W40007*         WITH UR                                                 32920000
W40007*    END-EXEC.                                                    32930000
                                                                        32940000
W40007*    EVALUATE TRUE                                                32950000
W40007*        WHEN SQLCODE = ZERO                                      32960000
W40007*            CONTINUE                                             32970000
W40007*        WHEN OTHER                                               32980000
W40007*            MOVE 'Z600-GET-MLCNTL-DTE'   TO PV-PARA              32990000
W40007*            MOVE 'SELECT ROW FROM TMLCNTL'                       33000000
W40007*                                         TO PV-DB2-OPER-ATTEMPTED33010000
W40007*            PERFORM Z900-SQL-ABEND                               33020000
W40007*    END-EVALUATE.                                                33030000
W40007*                                                                 33040000
W40007*                                                                 33050000
W40007*Z610-GET-DTE-ATTRIBUTES.                                         33060000
W40007*                                                                 33070000
W40007*    EXEC SQL                                                     33080000
W40007*         SELECT                                                  33090000
W40007*             FSCL_YR_NBR                                         33100000
W40007*            ,FSCL_MN_NBR                                         33110000
W40007*            ,FSCL_WK_NBR                                         33110000
W40007*            ,FSCL_MN_BEG_DTE                                     33120000
W40007*            ,FSCL_MN_END_DTE                                     33120000
W40007*            ,NFM_END_DTE                                         33130000
W40007*         INTO                                                    33140000
W40007*             :DTATTR-FSCL-YR-NBR                                 33150000
W40007*            ,:DTATTR-FSCL-MN-NBR                                 33160000
W40007*            ,:DTATTR-FSCL-WK-NBR                                 33160000
W40007*            ,:DTATTR-FSCL-MN-BEG-DTE                             33170000
W40007*            ,:DTATTR-FSCL-MN-END-DTE                             33170000
W40007*            ,:DTATTR-NFM-END-DTE                                 33180000
W40007*         FROM                                                    33190000
W40007*             TDTATTR                                             33200000
W40007*         WHERE                                                   33210000
W40007*             KY_DTE = :DTATTR-KY-DTE                             33220000
W40007*         WITH UR                                                 33221000
W40007*    END-EXEC.                                                    33230000
W40007*                                                                 33240000
W40007*    EVALUATE TRUE                                                33250000
W40007*        WHEN SQLCODE = ZERO                                      33260000
W40007*            CONTINUE                                             33270000
W40007*        WHEN OTHER                                               33280000
W40007*            DISPLAY 'DTATTR-KY-DTE: ' DTATTR-KY-DTE              33290000
W40007*            MOVE    'Z610-GET-DTE-ATTRIBUTES'                    33300000
W40007*                                         TO PV-PARA              33310000
W40007*            MOVE    'SELECT ROW FROM TDTATTR'                    33320000
W40007*                                         TO PV-DB2-OPER-ATTEMPTED33330000
W40007*            PERFORM Z900-SQL-ABEND                               33340000
W40007*    END-EVALUATE.                                                33350000
W40007*                                                                 33360000
W40007*                                                                 33370000
W40007*Z620-GET-ISO-DTE-FOR-MMDD.                                       33380000
W40007*                                                                 33390000
W40007*    EXEC SQL                                                     33400000
W40007*         SELECT                                                  33410000
W40007*             MAX (KY_DTE)                                        33420000
W40007*         INTO                                                    33430000
W40007*             :PV-DB2-DTE :PV-NULL-IND                            33440000
W40007*        W40007*                                                  33450000
W40007*             TDTATTR                                             33460000
W40007*         WHERE DAY   (KY_DTE)  = :PV-DB2-DD                      33470000
W40007*           AND MONTH (KY_DTE)  = :PV-DB2-MM                      33480000
W40007*           AND KY_DTE         <= :MLCNTL-PSTG-FSCL-WK-DTE        33490000
W40007*         WITH UR                                                 33491000
W40007*    END-EXEC.                                                    33500000
W40007*                                                                 33510000
W40007*    EVALUATE TRUE                                                33520000
W40007*        WHEN SQLCODE = ZERO                                      33530000
W40007*            IF PV-NULL-IND < 0                                   33540000
W40007*                SET PS-DATE-ERROR TO TRUE                        33550000
W40007*            END-IF                                               33560000
W40007*        WHEN OTHER                                               33570000
W40007*            MOVE 'Z620-GET-ISO-DTE-FOR-MMDD'                     33580000
W40007*                                         TO PV-PARA              33590000
W40007*            MOVE 'SELECT ROW FROM TDTATTR'                       33600000
W40007*                                         TO PV-DB2-OPER-ATTEMPTED33610000
W40007*            PERFORM Z900-SQL-ABEND                               33620000
W40007*    END-EVALUATE.                                                33630000
W40007*                                                                 33640000
W40007*                                                                 33650000
W40007*Z630-GET-EDIT-DTE-ATTRS.                                         33660000
W40007*                                                                 33670000
      *    LOOK FOR THE DATE BEING EDITED ON THE DATE ATTRIBUTE TABLE.  33680000
      *    THE DATE BEING EDITED MAY NOT BE A VALID DATE, SO THE WHERE  33690000
      *    CLAUSE CANNOT COMPARE IT TO A DATE COLUMN.  INSTEAD, IT      33700000
      *    MUST COMPARE THE INDIVIDUAL PIECES OF THE DATE.              33710000
                                                                        33720000
W40007*    EXEC SQL                                                     33730000
W40007*         SELECT                                                  33740000
W40007*             KY_DTE                                              33750000
W40007*            ,FSCL_YR_NBR                                         33760000
W40007*            ,FSCL_MN_NBR                                         33770000
W40007*            ,FSCL_WK_NBR                                         33780000
W40007*            ,WK_IN_MN_NBR                                        33790000
W40007*            ,DAY_OF_WK_NBR                                       33800000
W40007*         INTO                                                    33810000
W40007*             :DTATTR-KY-DTE                                      33820000
W40007*            ,:DTATTR-FSCL-YR-NBR                                 33830000
W40007*            ,:DTATTR-FSCL-MN-NBR                                 33840000
W40007*            ,:DTATTR-FSCL-WK-NBR                                 33850000
W40007*            ,:DTATTR-WK-IN-MN-NBR                                33860000
W40007*            ,:DTATTR-DAY-OF-WK-NBR                               33870000
W40007*         FROM                                                    33880000
W40007*             TDTATTR                                             33890000
W40007*         WHERE DAY   (KY_DTE) = :PV-DB2-DD                       33900000
W40007*           AND MONTH (KY_DTE) = :PV-DB2-MM                       33910000
W40007*           AND YEAR  (KY_DTE) = :PV-DB2-CCYY                     33920000
W40007*           AND KY_DTE        <= :MLCNTL-PSTG-FSCL-WK-DTE         33930000
W40007*         WITH UR                                                 33931000
W40007*    END-EXEC.                                                    33940000
W40007*                                                                 33950000
W40007*    EVALUATE TRUE                                                33960000
W40007*        WHEN SQLCODE = ZERO                                      33970000
W40007*            CONTINUE                                             33980000
W40007*        WHEN SQLCODE = +100                                      33990000
W40007*            SET PS-DATE-ERROR TO TRUE                            34000000
W40007*        WHEN OTHER                                               34010000
W40007*            MOVE 'Z630-GET-EDIT-DTE-ATTRS'                       34020000
W40007*                                         TO PV-PARA              34030000
W40007*            MOVE 'SELECT ROW FROM TDTATTR'                       34040000
W40007*                                         TO PV-DB2-OPER-ATTEMPTED34050000
W40007*            PERFORM Z900-SQL-ABEND                               34060000
W40007*    END-EVALUATE.                                                34070000
W40007*                                                                 34080000
W40007*Z700-VALIDATE-DGM-DATE.                                                  
W40007*    MOVE 'Z700-VALIDATE-DGM-DATE' TO PV-PARA.                            
W40007*    IF DATE-BEING-PROCESSED-IS-BLANK                                     
W40007*        AND CC-DGM-RUN-IND = 'Y'                                         
W40007*        DISPLAY '** ABEND **'                                    08100000
W40007*        DISPLAY '** PROGRAM EIKUP001 **'                         08110000
W40007*        DISPLAY '** PARAGRAPH ' PV-PARA                          08120000
W40007*        DISPLAY '** DGM RUN REQUESTED BUT DGM-DATE IS BLANK **'  08140000
W40007*        MOVE +4003 TO ABEND-CODE                                 08190000
W40007*        PERFORM Z999-ABEND                                       08200000
W40007*    END-IF.                                                      08200000
W40007*                                                                 08200000
W40007*    IF DATE-BEING-PROCESSED-IS-BLANK                                     
W40007*        AND CC-DGM-RUN-IND = 'N'                                         
W40007*        AND (CC-DGM-RUN-IND = 'N'                                        
W40007*        OR   CC-DGM-RUN-IND = ' ')                                       
W40007*        GO TO Z700-EXIT                                                  
W40007*    END-IF.                                                              
W40007*                                                                         
W40007*    IF PV-DG-FWED-MM < 01 OR PV-DG-FWED-MM > 12                  08150000
W40007*        DISPLAY '** ABEND **'                                    08100000
W40007*        DISPLAY '** PROGRAM EIKUP001 **'                         08110000
W40007*        DISPLAY '** PARAGRAPH ' PV-PARA                          08120000
W40007*        DISPLAY '** INVALID MONTH IN DGM-DATE DETECTED **'       08140000
W40007*        MOVE +4003 TO ABEND-CODE                                 08190000
W40007*        PERFORM Z999-ABEND                                       08200000
W40007*    END-IF.                                                              
W40007*                                                                         
W40007*    IF PV-DG-FWED-DD < 01 OR PV-DG-FWED-DD > 31                  08150000
W40007*        DISPLAY '** ABEND **'                                    08100000
W40007*        DISPLAY '** PROGRAM EIKUP001 **'                         08110000
W40007*        DISPLAY '** PARAGRAPH ' PV-PARA                          08120000
W40007*        DISPLAY '** INVALID DAY IN DGM-DATE DETECTED **'         08140000
W40007*        MOVE +4003 TO ABEND-CODE                                 08190000
W40007*        PERFORM Z999-ABEND                                       08200000
W40007*    END-IF.                                                              
W40007*    MOVE 'Y' TO PV-DAILY-GROSS-MARGIN-RUN-IND.                           
W40007*                                                                 08160000
W40007*Z700-EXIT.                                                               
W40007*    EXIT.                                                                
W40007*                                                                 34090000
W27261*=================================================================        
W27261* WHEN MKLUP021 RUNS FOR DAILY GROSS MARGINS IT MUST RETRIEVE THE         
W27261* DATES FROM THE TDTATTR FOR THE DATE SUPPLIED ON THE CONTROL CARD        
W27261* RATHER THAN THE CURRENT TLCNTL DATE. THIS IS NECESSARY BECAUSE          
W27261* THE TLCNTL DATES ARE NOT ROLLED FORWARD UNTIL AFTER THE WEEKLY          
W27261* EIKUP001 RUN ON SATURDAY.                                               
W27261*=================================================================        
W40007*Z710-ESTABLISH-DATES-FOR-DGM.                                            
W40007*    MOVE PV-DGM-DATE-BEING-PROCESSED TO DTATTR-KY-DTE.                   
W40007*    PERFORM Z610-GET-DTE-ATTRIBUTES.                             08550000
W40007*    MOVE DTATTR-FSCL-MN-NBR      TO MLCNTL-OPN-FSCL-MN-NBR       32860000
W40007*                                    MLCNTL-PSTG-FSCL-MN-NBR.     32900000
W40007*    MOVE DTATTR-FSCL-MN-END-DTE  TO MLCNTL-OPN-FSCL-MN-DTE       32850000
W40007*                                    MLCNTL-PSTG-FSCL-MN-DTE.     32890000
W40007*    MOVE DTATTR-KY-DTE           TO MLCNTL-PSTG-FSCL-WK-DTE.     32870000
W40007*    MOVE DTATTR-FSCL-WK-NBR      TO MLCNTL-PSTG-FSCL-WK-NBR      32880000
W40007*    MOVE DTATTR-FSCL-YR-NBR      TO PV-PSTG-FSCL-YR-NBR.         08560000
W40007*    MOVE DTATTR-FSCL-MN-BEG-DTE  TO PV-FSCL-MN-BEG-DTE.          08570000
W40007*    MOVE DTATTR-FSCL-MN-END-DTE  TO PV-FSCL-MN-END-DTE.          08571000
W40007*                                                                         
W40007*    MOVE MLCNTL-PSTG-FSCL-WK-DTE TO PV-ISO-DTE.                  08580000
W40007*    STRING PV-ISO-MM        DELIMITED BY SIZE                    08590000
W40007*          '/'               DELIMITED BY SIZE                    08600000
W40007*           PV-ISO-DD        DELIMITED BY SIZE                    08610000
W40007*          '/'               DELIMITED BY SIZE                    08620000
W40007*           PV-ISO-YY        DELIMITED BY SIZE                    08630000
W40007*                                INTO PV-PROC-GREG-FMT-DTE.       08640000
W40007*    MOVE MLCNTL-OPN-FSCL-MN-DTE TO DTATTR-KY-DTE.                33180000
W40007*    PERFORM Z610-GET-DTE-ATTRIBUTES.                                     
W40007*    MOVE DTATTR-FSCL-YR-NBR      TO PV-OPN-FSCL-YR-NBR.          08560000
W40007*    MOVE DTATTR-NFM-END-DTE      TO DTATTR-KY-DTE.               32880000
W40007*    PERFORM Z610-GET-DTE-ATTRIBUTES.                                     
W40007*    MOVE DTATTR-FSCL-YR-NBR      TO PV-NEXT-FSCL-YR-NBR.         08560000
W40007*    MOVE DTATTR-FSCL-MN-NBR      TO PV-NEXT-FSCL-MN-NBR.         32880000
W40007*    DISPLAY '--> PV-FSCL-MN-BEG-DTE = '                          08572000
W40007*        PV-FSCL-MN-BEG-DTE.                                      08573000
W40007*    DISPLAY '--> ALTERNATE END DATE FOR CUTOFF WEEK = '          08572000
W40007*        PV-FSCL-MN-END-DTE.                                      08573000
W40007*    DISPLAY ' MLCNTL-OPN-FSCL-MN-DTE:  '                         08400000
W40007*              MLCNTL-OPN-FSCL-MN-DTE                             08410000
W40007*            ' MLCNTL-OPN-FSCL-MN-NBR:  '                         08420000
W40007*              MLCNTL-OPN-FSCL-MN-NBR                             08430000
W40007*    DISPLAY ' MLCNTL-PSTG-FSCL-WK-DTE: '                         08440000
W40007*              MLCNTL-PSTG-FSCL-WK-DTE                            08450000
W40007*            ' MLCNTL-PSTG-FSCL-WK-NBR: '                         08460000
W40007*              MLCNTL-PSTG-FSCL-WK-NBR.                           08470000
W40007*    DISPLAY ' MLCNTL-PSTG-FSCL-MN-DTE: '                         08480000
W40007*              MLCNTL-PSTG-FSCL-MN-DTE                            08490000
W40007*            ' MLCNTL-PSTG-FSCL-MN-NBR: '                         08500000
W40007*              MLCNTL-PSTG-FSCL-MN-NBR.                           08510000
W40007*    DISPLAY ' '.                                                 08520000
W40007*                                                                 08530000
W40007*    MOVE MLCNTL-PSTG-FSCL-WK-DTE TO DTATTR-KY-DTE.               08540000
W40007*Z710-EXIT.                                                               
W40007*     EXIT.                                                               
W40007*                                                                         
W40007*Z900-SQL-ABEND.                                                  34100000
W40007*                                                                 34110000
W40007*    MOVE +4013                 TO ABEND-CODE.                    34120000
W40007*    DISPLAY '**  ABEND     **'.                                  34130000
W40007*    DISPLAY '**  PROGRAM   **  =  EIKUP001'.                     34140000
W40007*    DISPLAY '**  PARAGRAPH **  = ' PV-PARA.                      34150000
W40007*    DISPLAY '**  OPERATION **  = ' PV-DB2-OPER-ATTEMPTED.        34160000
W40007*                                                                 34170000
W40007*    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         34180000
W40007*    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        34190000
W40007*                                                                 34200000
W40007*    COPY DPPD004.                                                34210000
W40007*                                                                 34220000
W40007*    PERFORM Z999-ABEND.                                          34230000
                                                                        34240000
                                                                        34250000
       Z999-INVALID-PRESET-VALUE-ABND.                                  34260000
                                                                        34270000
      **   THIS VALUE IS PRESET BY MLKUP020 (THE PRE-EDIT).  AN INVALID 34280000
      **   CONDITION SHOULD RESULT IN AN ABEND.  IN THE FUTURE, INTER-  34290000
      **   FACING SYSTEMS WILL SUPPLY A VALUE RATHER THAN HAVING THE    34300000
      **   PRE-EDIT SET ONE.  AT THAT TIME, THE ERROR S/B REPORTED      34310000
      **   (VIA ML026-RPT2 RECORDS) RATHER THAN ABENDING.               34320000
                                                                        34330000
           MOVE +4008 TO ABEND-CODE.                                    34340000
           DISPLAY '**  ABEND     **'.                                  34350000
           DISPLAY '**  PROGRAM   **  =  EIKUP001'.                     34360000
           DISPLAY '**  PARAGRAPH **  = ' PV-PARA.                      34370000
                                                                        34380000
           PERFORM Z999-ABEND.                                          34390000
                                                                        34400000
                                                                        34410000
       Z999-ABEND.                                                      34420000
                                                                        34430000
           CALL 'ILBOABN0'             USING ABEND-CODE.                34440000
                                                                        08750000
