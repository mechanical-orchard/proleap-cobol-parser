000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKUT170.                                00050001
000600 AUTHOR.                 AYAN (COGNIZANT).                        00060001
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            MAY 2014.                                00080001
000900 DATE-COMPILED.                                                   00090000
001000***************************************************************** 00100000
001100*                                                               * 00110000
001200*  THIS PROGRAM CREATES AN EXTRACT FILE CONTAINING OLD DATA THAT* 00120010
001300*  ARE CREATED MORE THAN X(PARM VALUE) NUMBER OF MONTHS OLD.    * 00130010
001400*  PROGRAM CREATES AN EXTRACT TAKING RECORDS FROM               * 00140010
001500*  SUT_FINCL_ADJ DATABASE.                                      * 00150010
001600*                                                               * 00160001
001900***************************************************************** 00190000
002000 ENVIRONMENT DIVISION.                                            00200000
002100***************************************************************** 00210000
002200                                                                  00220000
002300 CONFIGURATION SECTION.                                           00230000
002400                                                                  00240000
002500 SOURCE-COMPUTER.        IBM-3090.                                00250000
002600 OBJECT-COMPUTER.        IBM-3090.                                00260000
002700                                                                  00270000
002800 INPUT-OUTPUT SECTION.                                            00280000
002900                                                                  00290000
003000 FILE-CONTROL.                                                    00300000
003100*                                                                 00310000
003200     SELECT SU-FINCL-ADJ-EXTRACT-FILE                             00320001
003300         ASSIGN TO OUT01.                                         00330000
003400*                                                                 00340000
003500***************************************************************** 00350000
003600 DATA DIVISION.                                                   00360000
003700***************************************************************** 00370000
003800*                                                                 00380000
003900 FILE SECTION.                                                    00390000
004000*                                                                 00400000
004100 FD  SU-FINCL-ADJ-EXTRACT-FILE                                    00410001
004200     RECORDING MODE IS F                                          00420000
004300     BLOCK CONTAINS 0  RECORDS.                                   00430000
004400 01  SU-FINCL-ADJ-EXTRACT-RECORD     PIC  X(393).                 00440002
004500*                                                                 00450000
004700 WORKING-STORAGE SECTION.                                         00470000
004800*                                                                 00480000
004900 01  ABEND-CODE                      PIC S9(04)    VALUE +0.      00490010
005100*                                                                 00510000
005200 01  PROGRAM-SWITCHES.                                            00520000
005300     05  PS-EOF-FINCL-ADJ-CURSOR-SW  PIC  X(01)    VALUE 'N'.     00530001
005400         88  PS-EOF-FINCL-ADJ-CSR                  VALUE 'Y'.     00540001
005500         88  PS-NOT-EOF-FINCL-ADJ-CSR              VALUE 'N'.     00550001
005600                                                                  00560000
005700 01  PC-PROGRAM-CONSTANTS.                                        00570000
005800     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00580005
006000                                                 'SUKUT170'.      00600005
006100 01  PV-PROGRAM-VARIABLES.                                        00610000
006700     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  00670009
006800     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  00680000
006900                                                                  00690000
007000     05  PV-FETCH-CNT                PIC  9(09)    VALUE ZERO.    00700003
007100     05  PV-WRITE-CNT                PIC  9(09)    VALUE ZERO.    00710006
007200     05  PV-TOTAL-CNT                PIC  9(09)    VALUE ZERO.    00720000
007201     05  PV-DISPLAY-COUNT            PIC  Z(8)9    VALUE ZERO.    00720108
007300                                                                  00730000
007301* TO STORE RECORDS FOR MULTIFETCH                                 00730104
007310 01  PT-FINCL-ADJ-TABLE.                                          00731003
007322     05 PT-FINCL-ADJ-ID              PIC  S9(9) COMP              00732206
007323                                     OCCURS 100 TIMES.            00732305
007324     05 PT-ADJ-ERR-CDE               PIC  S9(4) COMP              00732406
007325                                     OCCURS 100 TIMES.            00732505
007326     05 PT-ADJ-ERR-CDE-NULLIND       PIC  S9(4) COMP              00732606
007327                                     OCCURS 100 TIMES.            00732706
007328     05 PT-PO-NBR                    PIC  S9(9) COMP              00732806
007329                                     OCCURS 100 TIMES.            00732906
007330     05 PT-RCVR-LNE-NBR              PIC  S9(9) COMP              00733006
007331                                     OCCURS 100 TIMES.            00733106
007332     05 PT-RCVR-SEQ-NBR              PIC  S9(9) COMP              00733206
007333                                     OCCURS 100 TIMES.            00733306
007334     05 PT-DEST-LOC-NBR              PIC  S9(4) COMP              00733406
007335                                     OCCURS 100 TIMES.            00733506
007336     05 PT-CRE-TMST                  PIC   X(26)                  00733606
007337                                     OCCURS 100 TIMES.            00733706
007338     05 PT-UPC-NBR                   PIC  S9(15)V COMP-3          00733806
007339                                     OCCURS 100 TIMES.            00733906
007340     05 PT-UPC-NBR-NULLIND           PIC  S9(4) COMP              00734006
007341                                     OCCURS 100 TIMES.            00734106
007342     05 PT-SHIPT-UNT-ID              PIC  S9(18)V COMP-3          00734206
007343                                     OCCURS 100 TIMES.            00734306
007344     05 PT-SHIPT-UNT-ID-NULLIND      PIC  S9(4) COMP              00734406
007345                                     OCCURS 100 TIMES.            00734506
007346     05 PT-PRC-RSN-CDE               PIC   X(8)                   00734606
007347                                     OCCURS 100 TIMES.            00734706
007348     05 PT-AUD-CNTL-NBR              PIC  S9(9) COMP              00734806
007349                                     OCCURS 100 TIMES.            00734906
007350     05 PT-AUD-CNTL-NBR-NULLIND      PIC  S9(4) COMP              00735006
007351                                     OCCURS 100 TIMES.            00735106
007352     05 PT-ORGN-LOC-NBR              PIC  S9(4) COMP              00735206
007353                                     OCCURS 100 TIMES.            00735306
007354     05 PT-AUD-ADJ-STAT-CDE          PIC   X(1)                   00735406
007355                                     OCCURS 100 TIMES.            00735506
007356     05 PT-AUTO-APL-IND              PIC   X(1)                   00735606
007357                                     OCCURS 100 TIMES.            00735706
007358     05 PT-CRE-BY-USR-ID             PIC   X(8)                   00735806
007359                                     OCCURS 100 TIMES.            00735906
007360     05 PT-CRE-PGM-NM                PIC   X(8)                   00736006
007361                                     OCCURS 100 TIMES.            00736106
007362     05 PT-FINCL-BEF-QTY             PIC  S9(4) COMP              00736206
007363                                     OCCURS 100 TIMES.            00736306
007364     05 PT-FINCL-AFT-QTY             PIC  S9(4) COMP              00736406
007365                                     OCCURS 100 TIMES.            00736506
007366     05 PT-RSLV-BY-USR-ID            PIC   X(8)                   00736606
007367                                     OCCURS 100 TIMES.            00736706
007368     05 PT-RSLV-TMST                 PIC   X(26)                  00736806
007369                                     OCCURS 100 TIMES.            00736906
007370     05 PT-PROB-RSN-CDE              PIC  S9(4) COMP              00737006
007371                                     OCCURS 100 TIMES.            00737106
007372     05 PT-PROB-RSN-CDE-NULLIND      PIC  S9(4) COMP              00737206
007373                                     OCCURS 100 TIMES.            00737306
007374     05 PT-ADJ-QTY                   PIC  S9(4) COMP              00737406
007375                                     OCCURS 100 TIMES.            00737506
007376     05 PT-RSLV-CMNT-TXT             PIC   X(255)                 00737606
007377                                     OCCURS 100 TIMES.            00737706
007378     05 PT-RSLV-CMNT-TXT-NULLIND     PIC  S9(4) COMP              00737806
007379                                     OCCURS 100 TIMES.            00737906
007380                                                                  00738006
007381 01  PT-IDX                          PIC S9(04)  COMP.            00738106
007390                                                                  00739005
007400 01  DK-DB-KEYS.                                                  00740000
007500     05  DK-RETENTION-TMST-12        PIC  X(26).                  00750005
007510     05  DK-RETENTION-TMST-18        PIC  X(26).                  00751005
007600                                                                  00760000
008300******************************************************************00830000
008400*  DB2 FORMATTED MESSAGE AREA                                     00840000
008500******************************************************************00850000
008600     COPY DPWS004.                                                00860000
008700                                                                  00870000
008800******************************************************************00880000
008900*  COPY BOOK FOR THE PARAMETER TABLE                              00890000
009000******************************************************************00900000
009100     EXEC SQL                                                     00910000
009200          INCLUDE TKRPRPM                                         00920000
009300     END-EXEC.                                                    00930000
009400                                                                  00940000
009500******************************************************************00950000
009600*   FINANCIAL ADJUSTMENT TABLE - SUT_FINCL_ADJ                    00960007
009700******************************************************************00970000
009800     EXEC SQL                                                     00980000
009900          INCLUDE SUT00030                                        00990003
010000     END-EXEC.                                                    01000000
010100                                                                  01010000
010200******************************************************************01020000
010300*  DB2 COMMUNICATION AREA                                         01030000
010400******************************************************************01040000
010500     EXEC SQL                                                     01050000
010600         INCLUDE SQLCA                                            01060000
010700     END-EXEC.                                                    01070000
010800                                                                  01080000
011400******************************************************************01140000
011410*  MAIN CURSOR TO FETCH RECORDS BEYOND RETENTION LIMIT           *01141003
011420******************************************************************01142003
011500     EXEC SQL                                                     01150000
011600       DECLARE FINCL-ADJ-CSR CURSOR WITH ROWSET POSITIONING FOR   01160003
011710         SELECT  FINCL_ADJ_ID                                     01171003
011720                ,ADJ_ERR_CDE                                      01172006
011730                ,PO_NBR                                           01173003
011740                ,RCVR_LNE_NBR                                     01174003
011750                ,RCVR_SEQ_NBR                                     01175003
011760                ,DEST_LOC_NBR                                     01176003
011770                ,CRE_TMST                                         01177003
011780                ,UPC_NBR                                          01178003
011790                ,SHIPT_UNT_ID                                     01179003
011800                ,PRC_RSN_CDE                                      01180003
011900                ,AUD_CNTL_NBR                                     01190003
012000                ,ORGN_LOC_NBR                                     01200003
012100                ,AUD_ADJ_STAT_CDE                                 01210003
012200                ,AUTO_APL_IND                                     01220003
012210                ,CRE_BY_USR_ID                                    01221003
012220                ,CRE_PGM_NM                                       01222003
012230                ,FINCL_BEF_QTY                                    01223003
012240                ,FINCL_AFT_QTY                                    01224003
012250                ,RSLV_BY_USR_ID                                   01225003
012300                ,RSLV_TMST                                        01230003
012400                ,PROB_RSN_CDE                                     01240003
012410                ,ADJ_QTY                                          01241003
012420                ,RSLV_CMNT_TXT                                    01242003
012430           FROM SUT_FINCL_ADJ                                     01243003
012440          WHERE (ADJ_ERR_CDE IS NULL                              01244003
012441                     AND CRE_TMST < :DK-RETENTION-TMST-12)        01244103
012450            OR  (ADJ_ERR_CDE IS NOT NULL                          01245003
012451                     AND CRE_TMST < :DK-RETENTION-TMST-18)        01245103
012460          ORDER BY FINCL_ADJ_ID                                   01246005
012470          WITH UR                                                 01247003
012480     END-EXEC.                                                    01248003
012500*                                                                 01250000
012600 PROCEDURE DIVISION.                                              01260000
012700*                                                                 01270000
012710************************************************************      01271004
012800 0000-MAINLINE-PROCESSING.                                        01280003
012900************************************************************      01290004
013200                                                                  01320003
013300     PERFORM 1000-INITIALIZATION.                                 01330003
013500     PERFORM 2000-PROCESS-FINCL-ADJ.                              01350010
013700     PERFORM 9000-EOJ.                                            01370010
014100     STOP RUN.                                                    01410004
014101                                                                  01410110
014110************************************************************      01411004
014200 1000-INITIALIZATION.                                             01420003
014300************************************************************      01430004
014600                                                                  01460003
014700     OPEN OUTPUT SU-FINCL-ADJ-EXTRACT-FILE.                       01470003
014800                                                                  01480003
014900     PERFORM 7000-MAKE-RETENTION-TMST.                            01490003
015000                                                                  01500003
015500     SET  PS-NOT-EOF-FINCL-ADJ-CSR   TO  TRUE.                    01550009
015600                                                                  01560003
016010************************************************************      01601004
016100 2000-PROCESS-FINCL-ADJ.                                          01610003
016110************************************************************      01611004
016310                                                                  01631003
015700     PERFORM 2100-OPEN-FINCL-ADJ-CSR.                             01632013
015900                                                                  01633013
016400     PERFORM 2200-FETCH-FINCL-ADJ-CSR                             01640010
016410       UNTIL PS-EOF-FINCL-ADJ-CSR.                                01641010
016420                                                                  01642010
016500     PERFORM 2300-CLOSE-FINCL-ADJ-CSR.                            01650010
016900                                                                  01690003
017110************************************************************      01711004
017200 2100-OPEN-FINCL-ADJ-CSR.                                         01720003
017201************************************************************      01720104
017210                                                                  01721003
017500     EXEC SQL                                                     01750003
017600          OPEN FINCL-ADJ-CSR                                      01760003
017700     END-EXEC.                                                    01770003
017800                                                                  01780003
017900     EVALUATE TRUE                                                01790003
018000         WHEN SQLCODE = 0                                         01800003
018100             CONTINUE                                             01810003
018200         WHEN SQLWARN0 NOT = SPACES                               01820003
018300         WHEN SQLCODE < ZERO                                      01830003
018400         WHEN SQLCODE > ZERO                                      01840003
018500             MOVE '2100-OPEN-FINCL-ADJ-CSR'                       01850003
018600                                     TO PV-ABEND-PARAGRAPH        01860009
018700             MOVE 'OPEN FINCL-ADJ-CSR'                            01870003
018800                                     TO PV-DB2-OPERATION-ATTEMPTED01880009
018900             PERFORM 9100-SQL-ABEND                               01890003
019000     END-EVALUATE.                                                01900003
019100                                                                  01910003
019210************************************************************      01921004
019300 2200-FETCH-FINCL-ADJ-CSR.                                        01930003
019310************************************************************      01931004
019311                                                                  01931110
019312     INITIALIZE   PT-FINCL-ADJ-TABLE.                             01931210
019320                                                                  01932004
019600     EXEC SQL                                                     01960003
019700          FETCH NEXT ROWSET                                       01970003
019710           FROM FINCL-ADJ-CSR                                     01971003
019720            FOR 100 ROWS                                          01972003
019810           INTO :PT-FINCL-ADJ-ID                                  01981003
019820               ,:PT-ADJ-ERR-CDE :PT-ADJ-ERR-CDE-NULLIND           01982006
019830               ,:PT-PO-NBR                                        01983003
019840               ,:PT-RCVR-LNE-NBR                                  01984003
019850               ,:PT-RCVR-SEQ-NBR                                  01985003
019860               ,:PT-DEST-LOC-NBR                                  01986003
019870               ,:PT-CRE-TMST                                      01987003
019880               ,:PT-UPC-NBR :PT-UPC-NBR-NULLIND                   01988006
019890               ,:PT-SHIPT-UNT-ID :PT-SHIPT-UNT-ID-NULLIND         01989006
019891               ,:PT-PRC-RSN-CDE                                   01989103
019892               ,:PT-AUD-CNTL-NBR :PT-AUD-CNTL-NBR-NULLIND         01989206
019893               ,:PT-ORGN-LOC-NBR                                  01989303
019894               ,:PT-AUD-ADJ-STAT-CDE                              01989403
019895               ,:PT-AUTO-APL-IND                                  01989503
019896               ,:PT-CRE-BY-USR-ID                                 01989603
019897               ,:PT-CRE-PGM-NM                                    01989703
019898               ,:PT-FINCL-BEF-QTY                                 01989803
019899               ,:PT-FINCL-AFT-QTY                                 01989903
019900               ,:PT-RSLV-BY-USR-ID                                01990003
019901               ,:PT-RSLV-TMST                                     01990103
019902               ,:PT-PROB-RSN-CDE :PT-PROB-RSN-CDE-NULLIND         01990206
019903               ,:PT-ADJ-QTY                                       01990303
019904               ,:PT-RSLV-CMNT-TXT :PT-RSLV-CMNT-TXT-NULLIND       01990406
020100     END-EXEC.                                                    02010003
020200                                                                  02020003
020300     EVALUATE TRUE                                                02030003
020400       WHEN SQLCODE = ZEROS                                       02040006
020500            MOVE SQLERRD(3)          TO  PV-FETCH-CNT             02050009
020510            ADD PV-FETCH-CNT         TO PV-TOTAL-CNT              02051009
020520            PERFORM 8000-WRITE-EXTRACT-RECORD                     02052003
020600       WHEN SQLCODE = +100                                        02060003
020610            IF SQLERRD(3) > 0 THEN                                02061006
020620               MOVE SQLERRD(3)       TO  PV-FETCH-CNT             02062009
020630               ADD PV-FETCH-CNT      TO PV-TOTAL-CNT              02063009
020640               PERFORM 8000-WRITE-EXTRACT-RECORD                  02064006
020650            END-IF                                                02065006
020700            SET PS-EOF-FINCL-ADJ-CSR TO TRUE                      02070003
020800       WHEN SQLWARN0 NOT = SPACES                                 02080003
020900       WHEN SQLCODE < ZERO                                        02090003
021000       WHEN SQLCODE > ZERO                                        02100003
021100           MOVE '2200-FETCH-FINCL-ADJ-CSR'                        02110004
021200                                     TO PV-ABEND-PARAGRAPH        02120009
021300           MOVE 'FETCH FINCAL ADJ CURSOR '                        02130003
021400                                     TO PV-DB2-OPERATION-ATTEMPTED02140003
021500           PERFORM 9100-SQL-ABEND                                 02150003
021600     END-EVALUATE.                                                02160003
021700                                                                  02170003
021710************************************************************      02171004
021800 2300-CLOSE-FINCL-ADJ-CSR.                                        02180004
021810************************************************************      02181004
021900                                                                  02190003
022200     EXEC SQL                                                     02220003
022300          CLOSE FINCL-ADJ-CSR                                     02230003
022400     END-EXEC.                                                    02240003
022500                                                                  02250003
022600     EVALUATE TRUE                                                02260003
022700         WHEN SQLCODE = 0                                         02270003
022800             CONTINUE                                             02280003
022900         WHEN SQLWARN0 NOT = SPACES                               02290003
023000         WHEN SQLCODE < ZERO                                      02300003
023100         WHEN SQLCODE > ZERO                                      02310003
023200             MOVE '2300-CLOSE-FINCL-ADJ-CSR'                      02320003
023300                                     TO PV-ABEND-PARAGRAPH        02330009
023400             MOVE 'CLOSE FINCL-ADJ-CSR'                           02340003
023500                                     TO PV-DB2-OPERATION-ATTEMPTED02350009
023600             PERFORM 9100-SQL-ABEND                               02360003
023700     END-EVALUATE.                                                02370003
023710                                                                  02371003
023720************************************************************      02372004
023800 7000-MAKE-RETENTION-TMST.                                        02380003
023810************************************************************      02381004
023900                                                                  02390003
024100*   GET RETAINTION TIMESTAMP FOR RECORDS WITH NO ERROR            02410003
024200     PERFORM 7100-GET-TMST-FOR-NO-ERR                             02420003
024300                                                                  02430003
024400*   GET RETAINTION TIMESTAMP FOR RECORDS WITH ERROR               02440003
024500     PERFORM 7200-GET-TMST-FOR-ERR.                               02450003
024700                                                                  02470010
024710************************************************************      02471004
024800 7100-GET-TMST-FOR-NO-ERR.                                        02480003
024810************************************************************      02481004
024820                                                                  02482004
024910     EXEC SQL                                                     02491003
024911        SELECT (CURRENT TIMESTAMP - FUNC_QTY MONTHS)              02491103
024912          INTO :DK-RETENTION-TMST-12                              02491203
024913          FROM TKRPRPM                                            02491303
024914         WHERE LOC_ID            =  90                            02491403
024915           AND INTFC_SYS_CDE     = 'KHL'                          02491503
024916           AND SYS_PRC_FUNC_CDE  = 'SUFA12'                       02491603
024917           AND FUNC_PRC_STAT_CDE = 'AC'                           02491703
024918        WITH UR                                                   02491803
024930     END-EXEC.                                                    02493003
025000                                                                  02500003
025010     EVALUATE TRUE                                                02501003
025020         WHEN SQLCODE = 0                                         02502003
025030             CONTINUE                                             02503003
025040         WHEN SQLWARN0 NOT = SPACES                               02504003
025050         WHEN SQLCODE < ZERO                                      02505003
025060         WHEN SQLCODE > ZERO                                      02506003
025070             MOVE '7100-GET-TMST-FOR-NO-ERR'                      02507003
025080                                     TO PV-ABEND-PARAGRAPH        02508009
025090             MOVE 'GER TMST FOR REC WITH NO ERR'                  02509003
025091                                     TO PV-DB2-OPERATION-ATTEMPTED02509109
025092             PERFORM 9100-SQL-ABEND                               02509203
025093     END-EVALUATE.                                                02509303
025094                                                                  02509403
025095************************************************************      02509504
025100 7200-GET-TMST-FOR-ERR.                                           02510003
025110************************************************************      02511004
025120                                                                  02512004
025400     EXEC SQL                                                     02540003
025500        SELECT (CURRENT TIMESTAMP - FUNC_QTY MONTHS)              02550003
025600          INTO :DK-RETENTION-TMST-18                              02560003
025700          FROM TKRPRPM                                            02570003
025800         WHERE LOC_ID            =  90                            02580003
025900           AND INTFC_SYS_CDE     = 'KHL'                          02590003
026000           AND SYS_PRC_FUNC_CDE  = 'SUFA18'                       02600003
026100           AND FUNC_PRC_STAT_CDE = 'AC'                           02610003
026200        WITH UR                                                   02620003
026300     END-EXEC.                                                    02630003
026400                                                                  02640003
026500     EVALUATE TRUE                                                02650003
026600         WHEN SQLCODE = 0                                         02660003
026700             CONTINUE                                             02670003
026800         WHEN SQLWARN0 NOT = SPACES                               02680003
026900         WHEN SQLCODE < ZERO                                      02690003
027000         WHEN SQLCODE > ZERO                                      02700003
027100             MOVE '7200-GET-TMST-FOR-ERR'                         02710003
027200                                     TO PV-ABEND-PARAGRAPH        02720009
027300             MOVE 'GER TMST FOR REC WITH ERR'                     02730003
027400                                     TO PV-DB2-OPERATION-ATTEMPTED02740008
027500             PERFORM 9100-SQL-ABEND                               02750003
027600     END-EVALUATE.                                                02760003
027700                                                                  02770003
027701************************************************************      02770104
027710 8000-WRITE-EXTRACT-RECORD.                                       02771004
027711************************************************************      02771104
027712                                                                  02771204
027715     PERFORM VARYING PT-IDX FROM 1 BY 1                           02771504
027716             UNTIL PT-IDX > PV-FETCH-CNT                          02771604
027717                                                                  02771704
027718        INITIALIZE DCLSUT00030                                    02771804
027719                                                                  02771904
027720       MOVE PT-FINCL-ADJ-ID(PT-IDX)  TO SUT00030-FINCL-ADJ-ID     02772008
027721       MOVE PT-ADJ-ERR-CDE(PT-IDX)   TO SUT00030-ADJ-ERR-CDE      02772108
027722       MOVE PT-PO-NBR(PT-IDX)        TO SUT00030-PO-NBR           02772208
027723       MOVE PT-RCVR-LNE-NBR(PT-IDX)  TO SUT00030-RCVR-LNE-NBR     02772308
027724       MOVE PT-RCVR-SEQ-NBR(PT-IDX)  TO SUT00030-RCVR-SEQ-NBR     02772408
027725       MOVE PT-DEST-LOC-NBR(PT-IDX)  TO SUT00030-DEST-LOC-NBR     02772508
027726       MOVE PT-CRE-TMST(PT-IDX)      TO SUT00030-CRE-TMST         02772608
027727       MOVE PT-UPC-NBR(PT-IDX)       TO SUT00030-UPC-NBR          02772708
027728       MOVE PT-SHIPT-UNT-ID(PT-IDX)  TO SUT00030-SHIPT-UNT-ID     02772808
027729       MOVE PT-PRC-RSN-CDE(PT-IDX)   TO SUT00030-PRC-RSN-CDE      02772908
027730       MOVE PT-AUD-CNTL-NBR(PT-IDX)  TO SUT00030-AUD-CNTL-NBR     02773008
027731       MOVE PT-ORGN-LOC-NBR(PT-IDX)  TO SUT00030-ORGN-LOC-NBR     02773108
027732       MOVE PT-AUD-ADJ-STAT-CDE(PT-IDX)                           02773205
027733                                     TO SUT00030-AUD-ADJ-STAT-CDE 02773308
027734       MOVE PT-AUTO-APL-IND(PT-IDX)  TO SUT00030-AUTO-APL-IND     02773408
027735       MOVE PT-CRE-BY-USR-ID(PT-IDX)                              02773505
027736                                     TO SUT00030-CRE-BY-USR-ID    02773608
027737       MOVE PT-CRE-PGM-NM(PT-IDX)    TO SUT00030-CRE-PGM-NM       02773708
027738       MOVE PT-FINCL-BEF-QTY(PT-IDX)                              02773805
027739                                     TO SUT00030-FINCL-BEF-QTY    02773908
027740       MOVE PT-FINCL-AFT-QTY(PT-IDX)                              02774005
027741                                     TO SUT00030-FINCL-AFT-QTY    02774108
027742       MOVE PT-RSLV-BY-USR-ID(PT-IDX)                             02774205
027743                                     TO SUT00030-RSLV-BY-USR-ID   02774308
027744       MOVE PT-RSLV-TMST(PT-IDX)     TO SUT00030-RSLV-TMST        02774408
027745       MOVE PT-PROB-RSN-CDE(PT-IDX)  TO SUT00030-PROB-RSN-CDE     02774508
027746       MOVE PT-ADJ-QTY(PT-IDX)       TO SUT00030-ADJ-QTY          02774608
027747       MOVE PT-RSLV-CMNT-TXT(PT-IDX)                              02774705
027748                                     TO SUT00030-RSLV-CMNT-TXT    02774808
027749                                                                  02774904
027752       WRITE SU-FINCL-ADJ-EXTRACT-RECORD                          02775204
027753           FROM DCLSUT00030                                       02775304
027754           ADD +1                    TO  PV-WRITE-CNT             02775408
027755                                                                  02775504
027756     END-PERFORM.                                                 02775604
027757                                                                  02775708
027758************************************************************      02775808
027759 9000-EOJ.                                                        02775908
027760************************************************************      02776008
027761                                                                  02776108
027762     CLOSE SU-FINCL-ADJ-EXTRACT-FILE.                             02776208
027763                                                                  02776308
027764     DISPLAY '** ' PC-CURRENT-PROGRAM-NAME ' **'.                 02776408
027765     DISPLAY '** RETENTION TIMESTAMP FOR RECORDS WITH NO ERROR : '02776512
027766                                     DK-RETENTION-TMST-12         02776612
027767     DISPLAY '** RETENTION TIMESTAMP FOR RECORDS WITH ERROR    : '02776708
027768                                     DK-RETENTION-TMST-18         02776811
027770                                                                  02777008
027771     MOVE PV-TOTAL-CNT               TO   PV-DISPLAY-COUNT.       02777108
027772     MOVE PV-WRITE-CNT               TO   PV-DISPLAY-COUNT.       02777208
027773     DISPLAY '** NUMBER OF RECORD FETCHED : ' PV-DISPLAY-COUNT.   02777308
027774     DISPLAY '** NUMBER OF RECORD WRITTEN : ' PV-DISPLAY-COUNT.   02777408
027775                                                                  02777508
027780************************************************************      02778004
027800 9100-SQL-ABEND.                                                  02780004
027900************************************************************      02790004
028000*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN S      02800004
028100*  ERROR OR WARNING CODE OCCURS.                                  02810004
028200************************************************************      02820004
028300     DISPLAY '9100-SQL-ABEND'.                                    02830004
028400     DISPLAY '** ABEND     **'.                                   02840004
028500     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        02850004
028600     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             02860009
028700     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     02870010
028800                                                                  02880004
028900************************************************************      02890004
029000* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STAT      02900004
029100* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         02910004
029200* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABL      02920004
029300* FORMAT.                                                         02930004
029400************************************************************      02940004
029500     COPY DPPD004.                                                02950004
029600                                                                  02960004
029700     MOVE +4013                      TO ABEND-CODE.               02970009
029800     CALL 'ILBOABN0' USING ABEND-CODE.                            02980004
029900                                                                  02990004
