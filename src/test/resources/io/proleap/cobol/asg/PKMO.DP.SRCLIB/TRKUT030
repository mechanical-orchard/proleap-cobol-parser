000100*************************                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*************************                                         00030000
000400                                                                  00040000
000500 PROGRAM-ID.      TRKUT030.                                       00050000
000600 AUTHOR.          SUE BARTELT.                                    00060000
000700 DATE-WRITTEN.    05/19/04.                                       00070000
000800                                                                  00080000
000900******************************************************************00090000
001000* THIS PROGRAM WILL CREATE SEVERAL FILES OF LEGACY IMPORT DATA.   00100000
001110*                                                                 00110002
001120*                                                                 00120002
001130* CHANGED   NAME/TK           WR/PRB    DESCRIPTION               00130010
001131* ----------------------------------------------------------------00140010
001132* 01/23/14  M FRIESS/TKMA508  PRB44512  ADD CONTAINER UPC FILE    00150010
001133*                             AND CHANGE SO THAT PROGRAM CAN BE   00160010
001140*                             EXECUTED IN BOTH TRK050 (DAILY) AND 00170012
001180*                             TRK051 (FISCAL YEAR END) JOBS.      00180012
BARB  * 01/15/18  B SCHULTZ/TKMA555 CHG00000000   ADDED PO TYPE         00181096
BARB  *                             'LE' - ECOMM LANDED                 00183092
001190******************************************************************00190002
001200                                                                  00200000
001300 ENVIRONMENT DIVISION.                                            00210000
001400 CONFIGURATION SECTION.                                           00220000
001500                                                                  00230000
001600 SOURCE-COMPUTER. IBM-3090.                                       00240000
001700 OBJECT-COMPUTER. IBM-3090.                                       00250000
001800                                                                  00260000
001900 INPUT-OUTPUT SECTION.                                            00270000
002000 FILE-CONTROL.                                                    00280000
002100                                                                  00290000
002200     SELECT PO-TABLE                                              00300000
002300         ASSIGN                  TO OUT01.                        00310000
002400     SELECT PO-UPC-TABLE                                          00320000
002500         ASSIGN                  TO OUT02.                        00330000
002600     SELECT PO-UPC-DC-TABLE                                       00340000
002700         ASSIGN                  TO OUT03.                        00350000
002800     SELECT CONTAINER-PO-TABLE                                    00360000
002900         ASSIGN                  TO OUT04.                        00370000
003000     SELECT CONTAINER-TABLE                                       00380000
003100         ASSIGN                  TO OUT05.                        00390000
003200     SELECT SEAL-TABLE                                            00400000
003300         ASSIGN                  TO OUT06.                        00410000
003400     SELECT SHIPMENT-PO-TABLE                                     00420000
003500         ASSIGN                  TO OUT07.                        00430000
003600     SELECT SHIPMENT-STATUS-TABLE                                 00440000
003700         ASSIGN                  TO OUT08.                        00450000
003800     SELECT SHIPMENT-TABLE                                        00460000
003900         ASSIGN                  TO OUT09.                        00470000
004000     SELECT TRIP-TABLE                                            00480000
004100         ASSIGN                  TO OUT10.                        00490000
004200     SELECT CUSTOMS-ENTRY-PO-TABLE                                00500000
004300         ASSIGN                  TO OUT11.                        00510000
004400     SELECT CUSTOMS-ENTRY-TABLE                                   00520000
004500         ASSIGN                  TO OUT12.                        00530000
004600     SELECT BOOKING-TABLE                                         00540000
004700         ASSIGN                  TO OUT13.                        00550000
004800     SELECT RECEIVING-TABLE                                       00560000
004900         ASSIGN                  TO OUT14.                        00570000
005000     SELECT CUSTOMS-CONTAINER-TABLE                               00580000
005100         ASSIGN                  TO OUT15.                        00590000
005101*   PRB44512 - START                                              00600006
005110     SELECT CONTAINER-UPC-TABLE                                   00610006
005120         ASSIGN                  TO OUT16.                        00620006
005130*   PRB44512 - END                                                00630006
      *   PRB51351 - START                                              00630165
005110     SELECT INVALID-PO-FILE                                       00631065
005120         ASSIGN                  TO OUT17.                        00632065
      *   PRB51351 - END                                                00633091
005200                                                                  00640000
005300***************                                                   00650000
005400 DATA DIVISION.                                                   00660000
005500***************                                                   00670000
005600 FILE SECTION.                                                    00680000
005700                                                                  00690000
005800 FD  PO-TABLE                                                     00700000
005900     RECORDING MODE F                                             00710000
006000     BLOCK CONTAINS 0 RECORDS                                     00720000
P47386     RECORD CONTAINS 290 CHARACTERS                               00730050
006200     LABEL RECORDS ARE STANDARD                                   00740000
006300     DATA RECORD IS PO-TABLE-RECORD.                              00750000
P47386 01  PO-TABLE-RECORD                     PIC X(290).              00760049
006500                                                                  00770000
006600 FD  PO-UPC-TABLE                                                 00780000
006700     RECORDING MODE F                                             00790000
006800     BLOCK CONTAINS 0 RECORDS                                     00800000
006900     RECORD CONTAINS 176 CHARACTERS                               00810000
007000     LABEL RECORDS ARE STANDARD                                   00820000
007100     DATA RECORD IS PO-UPC-TABLE-RECORD.                          00830000
007200 01  PO-UPC-TABLE-RECORD                 PIC X(176).              00840000
007300                                                                  00850000
007400 FD  PO-UPC-DC-TABLE                                              00860000
007500     RECORDING MODE F                                             00870000
007600     BLOCK CONTAINS 0 RECORDS                                     00880000
007700     RECORD CONTAINS 96 CHARACTERS                                00890000
007800     LABEL RECORDS ARE STANDARD                                   00900000
007900     DATA RECORD IS PO-UPC-DC-TABLE-RECORD.                       00910000
008000 01  PO-UPC-DC-TABLE-RECORD              PIC X(96).               00920000
008100                                                                  00930000
008200 FD  CONTAINER-PO-TABLE                                           00940000
008300     RECORDING MODE F                                             00950000
008400     BLOCK CONTAINS 0 RECORDS                                     00960000
P47386     RECORD CONTAINS 403 CHARACTERS                               00970050
008600     LABEL RECORDS ARE STANDARD                                   00980000
008700     DATA RECORD IS CONTAINER-PO-TABLE-RECORD.                    00990000
P47386 01  CONTAINER-PO-TABLE-RECORD           PIC X(403).              01000049
008900                                                                  01010000
009000 FD  CONTAINER-TABLE                                              01020000
009100     RECORDING MODE F                                             01030000
009200     BLOCK CONTAINS 0 RECORDS                                     01040000
009300     RECORD CONTAINS 732 CHARACTERS                               01050036
009400     LABEL RECORDS ARE STANDARD                                   01060000
009500     DATA RECORD IS CONTAINER-TABLE-RECORD.                       01070000
009600 01  CONTAINER-TABLE-RECORD              PIC X(732).              01080036
009700                                                                  01090000
009800 FD  SEAL-TABLE                                                   01100000
009900     RECORDING MODE F                                             01110000
010000     BLOCK CONTAINS 0 RECORDS                                     01120000
010100     RECORD CONTAINS 146 CHARACTERS                               01130000
010200     LABEL RECORDS ARE STANDARD                                   01140000
010300     DATA RECORD IS SEAL-TABLE-RECORD.                            01150000
010400 01  SEAL-TABLE-RECORD                   PIC X(146).              01160000
010500                                                                  01170000
010600 FD  SHIPMENT-PO-TABLE                                            01180000
010700     RECORDING MODE F                                             01190000
010800     BLOCK CONTAINS 0 RECORDS                                     01200000
010900     RECORD CONTAINS 179 CHARACTERS                               01210000
011000     LABEL RECORDS ARE STANDARD                                   01220000
011100     DATA RECORD IS SHIPMENT-PO-TABLE-RECORD.                     01230000
011200 01  SHIPMENT-PO-TABLE-RECORD            PIC X(179).              01240000
011300                                                                  01250000
011400 FD  SHIPMENT-STATUS-TABLE                                        01260000
011500     RECORDING MODE F                                             01270000
011600     BLOCK CONTAINS 0 RECORDS                                     01280000
011700     RECORD CONTAINS 111 CHARACTERS                               01290000
011800     LABEL RECORDS ARE STANDARD                                   01300000
011900     DATA RECORD IS SHIPMENT-STATUS-TABLE-RECORD.                 01310000
012000 01  SHIPMENT-STATUS-TABLE-RECORD        PIC X(111).              01320000
012100                                                                  01330000
012200 FD  SHIPMENT-TABLE                                               01340000
012300     RECORDING MODE F                                             01350000
012400     BLOCK CONTAINS 0 RECORDS                                     01360000
012500     RECORD CONTAINS 130 CHARACTERS                               01370000
012600     LABEL RECORDS ARE STANDARD                                   01380000
012700     DATA RECORD IS SHIPMENT-TABLE-RECORD.                        01390000
012800 01  SHIPMENT-TABLE-RECORD               PIC X(130).              01400000
012900                                                                  01410000
013000 FD  TRIP-TABLE                                                   01420000
013100     RECORDING MODE F                                             01430000
013200     BLOCK CONTAINS 0 RECORDS                                     01440000
013300     RECORD CONTAINS 109 CHARACTERS                               01450000
013400     LABEL RECORDS ARE STANDARD                                   01460000
013500     DATA RECORD IS TRIP-TABLE-RECORD.                            01470000
013600 01  TRIP-TABLE-RECORD                   PIC X(109).              01480000
013700                                                                  01490000
013800 FD  CUSTOMS-ENTRY-PO-TABLE                                       01500000
013900     RECORDING MODE F                                             01510000
014000     BLOCK CONTAINS 0 RECORDS                                     01520000
014100     RECORD CONTAINS 149 CHARACTERS                               01530000
014200     LABEL RECORDS ARE STANDARD                                   01540000
014300     DATA RECORD IS CUSTOMS-ENTRY-PO-TABLE-RECORD.                01550000
014400 01  CUSTOMS-ENTRY-PO-TABLE-RECORD       PIC X(149).              01560000
014500                                                                  01570000
014600 FD  CUSTOMS-ENTRY-TABLE                                          01580000
014700     RECORDING MODE F                                             01590000
014800     BLOCK CONTAINS 0 RECORDS                                     01600000
014900     RECORD CONTAINS 358 CHARACTERS                               01610000
015000     LABEL RECORDS ARE STANDARD                                   01620000
015100     DATA RECORD IS CUSTOMS-ENTRY-TABLE-RECORD.                   01630000
015200 01  CUSTOMS-ENTRY-TABLE-RECORD          PIC X(358).              01640000
015300                                                                  01650000
015400 FD  BOOKING-TABLE                                                01660000
015500     RECORDING MODE F                                             01670000
015600     BLOCK CONTAINS 0 RECORDS                                     01680000
015700     RECORD CONTAINS 358 CHARACTERS                               01690000
015800     LABEL RECORDS ARE STANDARD                                   01700000
015900     DATA RECORD IS BOOKING-TABLE-RECORD.                         01710000
016000 01  BOOKING-TABLE-RECORD                PIC X(358).              01720000
016100                                                                  01730000
016200 FD  RECEIVING-TABLE                                              01740000
016300     RECORDING MODE F                                             01750000
016400     BLOCK CONTAINS 0 RECORDS                                     01760000
016500     RECORD CONTAINS 335 CHARACTERS                               01770000
016600     LABEL RECORDS ARE STANDARD                                   01780000
016700     DATA RECORD IS RECEIVING-TABLE-RECORD.                       01790000
016800 01  RECEIVING-TABLE-RECORD              PIC X(335).              01800000
016900                                                                  01810000
017000 FD  CUSTOMS-CONTAINER-TABLE                                      01820000
017100     RECORDING MODE F                                             01830000
017200     BLOCK CONTAINS 0 RECORDS                                     01840000
017300     RECORD CONTAINS 181 CHARACTERS                               01850000
017400     LABEL RECORDS ARE STANDARD                                   01860000
017500     DATA RECORD IS CUSTOMS-ENTRY-CN-TABLE-RECORD.                01870000
017600 01  CUSTOMS-CONTAINER-TABLE-RECORD      PIC X(181).              01880000
017700                                                                  01890000
017701* PRB44512 - START                                                01900006
017710 FD  CONTAINER-UPC-TABLE                                          01910006
017720     RECORDING MODE F                                             01920006
017730     BLOCK CONTAINS 0 RECORDS                                     01930006
017740     RECORD CONTAINS 200 CHARACTERS                               01940009
017750     LABEL RECORDS ARE STANDARD                                   01950006
017760     DATA RECORD IS CONTAINER-UPC-TABLE-RECORD.                   01960006
017770 01  CONTAINER-UPC-TABLE-RECORD         PIC X(200).               01970009
017771* PRB44512 - END                                                  01980006
      * PRB51351 - START                                                01981065
       FD  INVALID-PO-FILE                                              01982065
017720     RECORDING MODE F                                             01983065
017730     BLOCK CONTAINS 0 RECORDS                                     01984065
017750     LABEL RECORDS ARE STANDARD                                   01986081
017760     DATA RECORD IS INVALID-PO-FILE-RECORD.                       01987070
       01  INVALID-PO-FILE-RECORD              PIC 9(09).               01988088
      * PRB51351 -END                                                   01989065
017780                                                                  01990006
017800************************                                          02000000
017900 WORKING-STORAGE SECTION.                                         02010000
018000************************                                          02020000
018110*   PRB44512 - START                                              02030011
018120 01  CC-CONTROL-CARD.                                             02040011
018130     05  CC-MONTH-RANGE                  PIC 9(3).                02050011
018140     05  FILLER                          PIC X(77).               02060011
018150*   PRB44512 - END                                                02070011
018160                                                                  02080011
018200 01  PS-PROGRAM-SWITCHES.                                         02090000
018300     05  PS-END-OF-PO-CURSOR-SW         PIC  X(01)    VALUE 'N'.  02100000
018400         88  PS-NOT-END-OF-PO-CURSOR                  VALUE 'N'.  02110000
018500         88  PS-END-OF-PO-CURSOR                      VALUE 'Y'.  02120000
018600     05  PS-END-OF-PO-UPC-PKG-CSR-SW    PIC  X(01)    VALUE 'N'.  02130000
018700         88  PS-NOT-END-OF-PO-UPC-PKG-CSR             VALUE 'N'.  02140000
018800         88  PS-END-OF-PO-UPC-PKG-CSR                 VALUE 'Y'.  02150000
018900     05  PS-END-OF-PO-UPC-CURSOR-SW     PIC  X(01)    VALUE 'N'.  02160000
019000         88  PS-NOT-END-OF-PO-UPC-CURSOR              VALUE 'N'.  02170000
019100         88  PS-END-OF-PO-UPC-CURSOR                  VALUE 'Y'.  02180000
019200     05  PS-END-OF-PO-DC-CURSOR-SW      PIC  X(01)    VALUE 'N'.  02190000
019300         88  PS-NOT-END-OF-PO-DC-CURSOR               VALUE 'N'.  02200000
019400         88  PS-END-OF-PO-DC-CURSOR                   VALUE 'Y'.  02210000
019500     05  PS-END-OF-CNT-PO-CURSOR-SW     PIC  X(01)    VALUE 'N'.  02220000
019600         88  PS-NOT-END-OF-CNT-PO-CURSOR              VALUE 'N'.  02230000
019700         88  PS-END-OF-CNT-PO-CURSOR                  VALUE 'Y'.  02240000
019800     05  PS-END-OF-SEAL-CURSOR-SW       PIC  X(01)    VALUE 'N'.  02250000
019900         88  PS-NOT-END-OF-SEAL-CURSOR                VALUE 'N'.  02260000
020000         88  PS-END-OF-SEAL-CURSOR                    VALUE 'Y'.  02270000
020001*    PRB44512 - START                                             02280002
020010     05  PS-END-OF-TIMCNUP-CURSOR-SW PIC  X(01)       VALUE 'N'.  02290003
020020         88  PS-NOT-END-OF-TIMCNUP-CURSOR             VALUE 'N'.  02300003
020030         88  PS-END-OF-TIMCNUP-CURSOR                 VALUE 'Y'.  02310003
020040*    PRB44512 - END                                               02320002
020100     05  PS-END-OF-SHIP-PO-CURSOR-SW    PIC  X(01)    VALUE 'N'.  02330000
020200         88  PS-NOT-END-OF-SHIP-PO-CURSOR             VALUE 'N'.  02340000
020300         88  PS-END-OF-SHIP-PO-CURSOR                 VALUE 'Y'.  02350000
020400     05  PS-END-OF-SHP-ST-CURSOR-SW     PIC  X(01)    VALUE 'N'.  02360000
020500         88  PS-NOT-END-OF-SHP-ST-CURSOR              VALUE 'N'.  02370000
020600         88  PS-END-OF-SHP-ST-CURSOR                  VALUE 'Y'.  02380000
020700     05  PS-END-OF-SHIP-CURSOR-SW       PIC  X(01)    VALUE 'N'.  02390000
020800         88  PS-NOT-END-OF-SHIP-CURSOR                VALUE 'N'.  02400000
020900         88  PS-END-OF-SHIP-CURSOR                    VALUE 'Y'.  02410000
021000     05  PS-END-OF-TRIP-CURSOR-SW       PIC  X(01)    VALUE 'N'.  02420000
021100         88  PS-NOT-END-OF-TRIP-CURSOR                VALUE 'N'.  02430000
021200         88  PS-END-OF-TRIP-CURSOR                    VALUE 'Y'.  02440000
021300     05  PS-END-OF-BOOKING-CURSOR-SW    PIC  X(01)    VALUE 'N'.  02450000
021400         88  PS-NOT-END-OF-BOOKING-CURSOR             VALUE 'N'.  02460000
021500         88  PS-END-OF-BOOKING-CURSOR                 VALUE 'Y'.  02470000
021600     05  PS-END-OF-REC-CURSOR-SW        PIC  X(01)    VALUE 'N'.  02480000
021700         88  PS-NOT-END-OF-REC-CURSOR                 VALUE 'N'.  02490000
021800         88  PS-END-OF-REC-CURSOR                     VALUE 'Y'.  02500000
021900     05  PS-END-OF-CE-PO-CURSOR-SW      PIC  X(01)    VALUE 'N'.  02510000
022000         88  PS-NOT-END-OF-CE-PO-CURSOR               VALUE 'N'.  02520000
022100         88  PS-END-OF-CE-PO-CURSOR                   VALUE 'Y'.  02530000
022200     05  PS-END-OF-CE-CURSOR-SW         PIC  X(01)    VALUE 'N'.  02540000
022300         88  PS-NOT-END-OF-CE-CURSOR                  VALUE 'N'.  02550000
022400         88  PS-END-OF-CE-CURSOR                      VALUE 'Y'.  02560000
022500     05  PS-END-OF-CSCN-CURSOR-SW       PIC  X(01)    VALUE 'N'.  02570000
022600         88  PS-NOT-END-OF-CSCN-CURSOR                VALUE 'N'.  02580000
022700         88  PS-END-OF-CSCN-CURSOR                    VALUE 'Y'.  02590000
022800                                                                  02600000
022900 01  PC-PROGRAM-CONSTANTS.                                        02610000
023000     05  PC-PGM-NAME                   PIC X(08)  VALUE           02620017
023100                                                 'TRKUT030'.      02630000
023200     05  PC-NEG-1                      PIC S9(03) VALUE -1        02640017
023300                                                  COMP-3.         02650000
P47386     05  PC-AR                         PIC X(02)  VALUE 'AR'.     02660017
P47386     05  PC-NULL-TMST                  PIC X(26)  VALUE           02670017
P47386                                 '9999-09-09-09.09.09.999999'.    02680017
023400 01  PV-PROGRAM-VARIABLES.                                        02690000
023401     05  PV-PO-NBR                     PIC S9(09) VALUE +0        02700004
                                                        COMP.           02700165
      *    PRB51351 - START                                             02700290
           05  PV-INVALID-PO                 PIC 9(09).                 02700387
      *    PRB51351 - END                                               02700490
023410*    PRB44512 - START                                             02720003
023420     05  PV-CONTNR-ID                  PIC X(12).                 02730011
023500     05  PV-PO-NBR-DISP                PIC ZZZZZZZZ9.             02740003
023611     05  PV-CONTNR-SEQ-NBR-DISP        PIC ZZZ9.                  02750003
023613     05  PV-ACTUAL-CART-CNT            PIC S9(04) VALUE +0        02760014
023614                                                  COMP SYNC.      02770014
023615     05  PV-MONTHS                     PIC S9(3)  COMP VALUE 0.   02780014
023616*    PRB44512 - END                                               02790014
023700     05  PV-CURRENT-TMST               PIC X(26)  VALUE SPACES.   02800000
023800     05  PV-CURRENT-DATE               PIC X(10)  VALUE SPACES.   02810000
023900     05  PV-OTB-DATE-FMT               PIC X(10)  VALUE SPACES.   02820000
024000     05  PV-OTB-DATE                   PIC X(06)  VALUE SPACES.   02830000
024100     05  PV-OTB-NBR                    PIC X(06).                 02840000
024200     05  FILLER REDEFINES PV-OTB-NBR.                             02850000
024300         10  PV-OTB-NBR-YEAR          PIC X(04).                  02860000
024400         10  PV-OTB-NBR-MONTH         PIC X(02).                  02870000
024500     05  PV-PARAGRAPH-NAME             PIC X(30)  VALUE SPACES.   02880000
024600     05  PV-DB2-OPERATION-MESSAGE      PIC X(79)  VALUE SPACES.   02890000
024700     05  PV-DB2-TABLE-NAME-1           PIC X(18)  VALUE SPACES.   02900000
024800     05  PV-DB2-TABLE-NAME-2           PIC X(18)  VALUE SPACES.   02910000
024900     05  PV-DB2-TABLE-NAME-3           PIC X(18)  VALUE SPACES.   02920000
025000     05  PV-SUM-AP-VERIFY-ITM-QTY      PIC S9(9)  VALUE +0 COMP.  02930000
025100     05  PV-NULL-IND                   PIC S9(04) VALUE +0 COMP.  02940000
025200     05  PV-VHTRIP-VEH-NBR-NULL        PIC S9(04) VALUE +0        02950000
025300                                                  COMP SYNC.      02960000
P47386     05  PV-STATUS-DTE-NULL            PIC S9(04) VALUE +0        02970017
P47386                                                  COMP SYNC.      02980017
P47386     05  PV-DATE                       PIC X(5).                  02990017
P47386     05  FILLER REDEFINES PV-DATE.                                03000017
P47386         10  PV-DATE-MONTH             PIC XX.                    03010017
P47386         10  PV-DATE-SLASH             PIC X.                     03020017
P47386         10  PV-DATE-DAY               PIC XX.                    03030017
P47386     05  PV-MIN-VERFYD-TMST            PIC X(26).                 03040017
P47386     05  PV-DB2-DATE                  PIC  X(10).                 03050019
P47386     05  FILLER  REDEFINES PV-DB2-DATE.                           03060019
P47386         10  PV-DB2-DATE-CC           PIC  X(02).                 03070019
P47386         10  PV-DB2-DATE-YY           PIC  X(02).                 03080019
P47386         10  FILLER                   PIC  X(01).                 03090019
P47386         10  PV-DB2-DATE-MM           PIC  X(02).                 03100019
P47386         10  FILLER                   PIC  X(01).                 03110019
P47386         10  PV-DB2-DATE-DD           PIC  X(02).                 03120019
P47386     05  PV-DISPLAY-DATE.                                         03130019
P47386         10  PV-DISPLAY-DATE-MM       PIC  X(02).                 03140019
P47386         10  FILLER                   PIC  X(01) VALUE '/'.       03150019
P47386         10  PV-DISPLAY-DATE-DD       PIC  X(02).                 03160019
P47386         10  FILLER                   PIC  X(01) VALUE '/'.       03170019
P47386         10  PV-DISPLAY-DATE-YY       PIC  X(02).                 03180019
P47386     05  PV-OTB-PER-NBR               PIC  X(06).                 03190020
P47386     05  FILLER REDEFINES PV-OTB-PER-NBR.                         03200020
P47386         10  PV-OTBP-CC               PIC  X(02).                 03210020
P47386         10  PV-OTBP-YY               PIC  X(02).                 03220020
P47386         10  PV-OTBP-MM               PIC  X(02).                 03230020
P47386         10  PV-OTBP-MM-N REDEFINES PV-OTBP-MM                    03240020
P47386                                      PIC  9(02).                 03250020
025400                                                                  03260000
025500 01  PV-REFORMATED-DATE.                                          03270000
025600     05  PV-REFORMAT-MONTH             PIC X(02)  VALUE SPACES.   03280000
025700     05  FILLER                        PIC X(01)  VALUE '/'.      03290000
025800     05  PV-REFORMAT-DAY               PIC X(02)  VALUE SPACES.   03300000
025900     05  FILLER                        PIC X(01)  VALUE '/'.      03310000
026000     05  PV-REFORMAT-YEAR              PIC X(04)  VALUE SPACES.   03320000
026100                                                                  03330000
026200 01  ABEND-CODE                        PIC S9(04) VALUE ZEROS     03340000
026300                                                  COMP SYNC.      03350000
026400     88  PC-CONTROL-CARD-ERROR                    VALUE +4001.    03360000
026500     88  PC-DB2-ERROR                             VALUE +4013.    03370000
026600                                                                  03380000
026700*---------------------------------------------------------------* 03390000
026800*    DB2 AREA FOR TPURCHS                                         03400000
026900*---------------------------------------------------------------* 03410000
027000     EXEC SQL                                                     03420000
027100          INCLUDE TPURCHS                                         03430000
027200     END-EXEC.                                                    03440000
027300*---------------------------------------------------------------* 03450000
027400*    DB2 AREA FOR TPLNSHP                                       * 03460000
027500*---------------------------------------------------------------* 03470000
027600     EXEC SQL                                                     03480000
027700          INCLUDE TPLNSHP                                         03490000
027800     END-EXEC.                                                    03500000
027900*---------------------------------------------------------------* 03510000
028000*    DB2 AREA FOR TMDSEAR                                       * 03520000
028100*---------------------------------------------------------------* 03530000
028200     EXEC SQL                                                     03540000
028300          INCLUDE TMDSEAR                                         03550000
028400     END-EXEC.                                                    03560000
028500*---------------------------------------------------------------* 03570000
028600*    DB2 AREA FOR TENTNME                                       * 03580000
028700*---------------------------------------------------------------* 03590000
028800     EXEC SQL                                                     03600000
028900          INCLUDE TENTNME                                         03610000
029000     END-EXEC.                                                    03620000
029100*---------------------------------------------------------------* 03630000
029200*    DB2 AREA FOR TPURITM                                       * 03640000
029300*---------------------------------------------------------------* 03650000
029400     EXEC SQL                                                     03660000
029500          INCLUDE TPURITM                                         03670000
029600     END-EXEC.                                                    03680000
029700*---------------------------------------------------------------* 03690000
029800*    DB2 AREA FOR TPOPRPK                                         03700000
029900*---------------------------------------------------------------* 03710000
030000     EXEC SQL                                                     03720000
030100          INCLUDE TPOPRPK                                         03730000
030200     END-EXEC.                                                    03740000
030300*---------------------------------------------------------------* 03750000
030400*    DB2 AREA FOR TSKXREF                                       * 03760000
030500*---------------------------------------------------------------* 03770000
030600     EXEC SQL                                                     03780000
030700          INCLUDE TSKXREF                                         03790000
030800     END-EXEC.                                                    03800000
030900*---------------------------------------------------------------* 03810000
031000*    DB2 AREA FOR XLT_SKU                                       * 03820000
031100*---------------------------------------------------------------* 03830000
031200     EXEC SQL                                                     03840000
031300          INCLUDE XLT00003                                        03850000
031400     END-EXEC.                                                    03860000
031500*---------------------------------------------------------------* 03870000
031600*    DB2 AREA FOR XLT_VND_STYL                                  * 03880000
031700*---------------------------------------------------------------* 03890000
031800     EXEC SQL                                                     03900000
031900          INCLUDE XLT00004                                        03910000
032000     END-EXEC.                                                    03920000
032100*---------------------------------------------------------------* 03930000
032200*    DB2 AREA FOR TUPCSKU                                         03940000
032300*---------------------------------------------------------------* 03950000
032400     EXEC SQL                                                     03960000
032500          INCLUDE TUPCSKU                                         03970000
032600     END-EXEC.                                                    03980000
032700*---------------------------------------------------------------* 03990000
032800*    DB2 AREA FOR TALLPLN                                       * 04000000
032900*---------------------------------------------------------------* 04010000
033000     EXEC SQL                                                     04020000
033100          INCLUDE TALLPLN                                         04030000
033200     END-EXEC.                                                    04040000
033300*---------------------------------------------------------------* 04050000
033400*    DB2 AREA FOR TIMCNPO                                       * 04060000
033500*---------------------------------------------------------------* 04070000
033600     EXEC SQL                                                     04080000
033700          INCLUDE TIMCNPO                                         04090000
033800     END-EXEC.                                                    04100000
033900*---------------------------------------------------------------* 04110000
034000*    DB2 AREA FOR TIMCNRL                                       * 04120000
034100*---------------------------------------------------------------* 04130000
034200     EXEC SQL                                                     04140000
034300          INCLUDE TIMCNRL                                         04150000
034400     END-EXEC.                                                    04160000
034500*---------------------------------------------------------------* 04170000
034600*    DB2 AREA FOR TIMCNTK                                         04180000
034700*---------------------------------------------------------------* 04190000
034800     EXEC SQL                                                     04200000
034900          INCLUDE TIMCNTK                                         04210000
035000     END-EXEC.                                                    04220000
035001* PRB44512 - START                                                04230002
035010*---------------------------------------------------------------* 04240002
035020*    DB2 AREA FOR TIMCNUP                                         04250002
035030*---------------------------------------------------------------* 04260002
035040     EXEC SQL                                                     04270002
035050          INCLUDE TIMCNUP                                         04280002
035060     END-EXEC.                                                    04290002
035070* PRB44512 - END                                                  04300002
035100*---------------------------------------------------------------* 04310000
035200*    DB2 AREA FOR TRT_IMPRT_ORGN                                * 04320000
035300*---------------------------------------------------------------* 04330000
035400     EXEC SQL                                                     04340000
035500          INCLUDE TRT00010                                        04350000
035600     END-EXEC.                                                    04360000
035700*---------------------------------------------------------------* 04370000
035800*    DB2 AREA FOR TIMFOB                                        * 04380000
035900*---------------------------------------------------------------* 04390000
036000     EXEC SQL                                                     04400000
036100          INCLUDE TIMFOB                                          04410000
036200     END-EXEC.                                                    04420000
036300*---------------------------------------------------------------* 04430000
036400*    DB2 AREA FOR TIMPOE                                        * 04440000
036500*---------------------------------------------------------------* 04450000
036600     EXEC SQL                                                     04460000
036700          INCLUDE TIMPOE                                          04470000
036800     END-EXEC.                                                    04480000
036900*---------------------------------------------------------------* 04490000
037000*    DB2 AREA FOR TRT_IMPRT_SEAL                                  04500000
037100*---------------------------------------------------------------* 04510000
037200     EXEC SQL                                                     04520000
037300          INCLUDE TRT00006                                        04530000
037400     END-EXEC.                                                    04540000
037500*---------------------------------------------------------------* 04550000
037600*    DB2 AREA FOR TSHPTPO                                       * 04560000
037700*---------------------------------------------------------------* 04570000
037800     EXEC SQL                                                     04580000
037900          INCLUDE TSHPTPO                                         04590000
038000     END-EXEC.                                                    04600000
038100*---------------------------------------------------------------* 04610000
038200*    DB2 AREA FOR TRECEIV                                       * 04620000
038300*---------------------------------------------------------------* 04630000
038400     EXEC SQL                                                     04640000
038500          INCLUDE TRECEIV                                         04650000
038600     END-EXEC.                                                    04660000
038700*---------------------------------------------------------------* 04670000
038800*    DB2 AREA FOR TRECDIS                                       * 04680000
038900*---------------------------------------------------------------* 04690000
039000     EXEC SQL                                                     04700000
039100          INCLUDE TRECDIS                                         04710000
039200     END-EXEC.                                                    04720000
039300*---------------------------------------------------------------* 04730000
039400*    DB2 AREA FOR TPKSLIP                                         04740000
039500*---------------------------------------------------------------* 04750000
039600     EXEC SQL                                                     04760000
039700          INCLUDE TPKSLIP                                         04770000
039800     END-EXEC.                                                    04780000
039900*---------------------------------------------------------------* 04790000
040000*    DB2 AREA FOR TSHIPST                                       * 04800000
040100*---------------------------------------------------------------* 04810000
040200     EXEC SQL                                                     04820000
040300          INCLUDE TSHIPST                                         04830000
040400     END-EXEC.                                                    04840000
040500*---------------------------------------------------------------* 04850000
040600*    DB2 AREA FOR TSHSTYP                                       * 04860000
040700*---------------------------------------------------------------* 04870000
040800     EXEC SQL                                                     04880000
040900          INCLUDE TSHSTYP                                         04890000
041000     END-EXEC.                                                    04900000
041100*---------------------------------------------------------------* 04910000
041200*    DB2 AREA FOR TSHIPMT                                       * 04920000
041300*---------------------------------------------------------------* 04930000
041400     EXEC SQL                                                     04940000
041500          INCLUDE TSHIPMT                                         04950000
041600     END-EXEC.                                                    04960000
041700*---------------------------------------------------------------* 04970000
041800*    DB2 AREA FOR TVHTRIP                                         04980000
041900*---------------------------------------------------------------* 04990000
042000     EXEC SQL                                                     05000000
042100          INCLUDE TVHTRIP                                         05010000
042200     END-EXEC.                                                    05020000
042300*---------------------------------------------------------------* 05030000
042400*    DB2 AREA FOR TIMBKPO                                       * 05040000
042500*---------------------------------------------------------------* 05050000
042600     EXEC SQL                                                     05060000
042700          INCLUDE TIMBKPO                                         05070000
042800     END-EXEC.                                                    05080000
042900*---------------------------------------------------------------* 05090000
043000*    DB2 AREA FOR TIMRCPO                                       * 05100000
043100*---------------------------------------------------------------* 05110000
043200     EXEC SQL                                                     05120000
043300          INCLUDE TIMRCPO                                         05130000
043400     END-EXEC.                                                    05140000
043500*---------------------------------------------------------------* 05150000
043600*    DB2 AREA FOR TIMCSPO                                       * 05160000
043700*---------------------------------------------------------------* 05170000
043800     EXEC SQL                                                     05180000
043900          INCLUDE TIMCSPO                                         05190000
044000     END-EXEC.                                                    05200000
044100*---------------------------------------------------------------* 05210000
044200*    DB2 AREA FOR TIMCSEN                                         05220000
044300*---------------------------------------------------------------* 05230000
044400     EXEC SQL                                                     05240000
044500          INCLUDE TIMCSEN                                         05250000
044600     END-EXEC.                                                    05260000
044700*---------------------------------------------------------------* 05270000
044800*    DB2 AREA FOR TIMCSCN                                         05280000
044900*---------------------------------------------------------------* 05290000
045000     EXEC SQL                                                     05300000
045100          INCLUDE TIMCSCN                                         05310000
045200     END-EXEC.                                                    05320000
045201*PRB445M2 - START                                                 05330013
045202*---------------------------------------------------------------* 05340013
045220*  DB2 TABLE DECLARATION - IMPORT CONTAINER CARTON TABLE.         05350013
045230*      (TRT_IMPRT_CART)                                           05360013
045231*---------------------------------------------------------------* 05370013
045250     EXEC SQL                                                     05380013
045260          INCLUDE TRT00008                                        05390013
045270     END-EXEC.                                                    05400013
045280*PRB44512 - END                                                   05410013
045290                                                                  05420013
P47386*---------------------------------------------------------------* 05430016
P47386*    DB2 AREA FOR TRECITM                                       * 05440016
P47386*---------------------------------------------------------------* 05450016
P47386     EXEC SQL                                                     05460016
P47386          INCLUDE TRECITM                                         05470016
P47386     END-EXEC.                                                    05480016
045300*---------------------------------------------------------------* 05490000
045400*  COPYBOOK FOR PO TABLE.                                        *05500000
045500*---------------------------------------------------------------* 05510000
045600     COPY TRRD040.                                                05520000
045700*---------------------------------------------------------------* 05530000
045800*  COPYBOOK FOR PO UPC TABLE.                                    *05540000
045900*---------------------------------------------------------------* 05550000
046000     COPY TRRD041.                                                05560000
046100*---------------------------------------------------------------* 05570000
046200*  COPYBOOK FOR PO UPC DC TABLE                                  *05580000
046300*---------------------------------------------------------------* 05590000
046400     COPY TRRD042.                                                05600000
046500*---------------------------------------------------------------* 05610000
046600*  COPYBOOK FOR CONTAINER PO TABLE                               *05620000
046700*---------------------------------------------------------------* 05630000
046800     COPY TRRD043.                                                05640000
046900*---------------------------------------------------------------* 05650000
047000*  COPYBOOK FOR CONTAINER TABLE.                                 *05660000
047100*---------------------------------------------------------------* 05670000
047200     COPY TRRD044.                                                05680000
047300*---------------------------------------------------------------* 05690000
047400*  COPYBOOK FOR SEAL TABLE.                                      *05700000
047500*---------------------------------------------------------------* 05710000
047600     COPY TRRD045.                                                05720000
047700*---------------------------------------------------------------* 05730000
047800*  COPYBOOK FOR SHIPMENT PO TABLE.                               *05740000
047900*---------------------------------------------------------------* 05750000
048000     COPY TRRD046.                                                05760000
048100*---------------------------------------------------------------* 05770000
048200*  COPYBOOK FOR SHIPMENT STATUS TABLE.                           *05780000
048300*---------------------------------------------------------------* 05790000
048400     COPY TRRD047.                                                05800000
048500*---------------------------------------------------------------* 05810000
048600*  COPYBOOK FOR SHIPMENT TABLE.                                  *05820000
048700*---------------------------------------------------------------* 05830000
048800     COPY TRRD048.                                                05840000
048900*---------------------------------------------------------------* 05850000
049000*  COPYBOOK FOR TRIP TABLE.                                      *05860000
049100*---------------------------------------------------------------* 05870000
049200     COPY TRRD049.                                                05880000
049300*---------------------------------------------------------------* 05890000
049400*  COPYBOOK FOR CUSTOMS ENTRY PO TABLE.                          *05900000
049500*---------------------------------------------------------------* 05910000
049600     COPY TRRD050.                                                05920000
049700*---------------------------------------------------------------* 05930000
049800*  COPYBOOK FOR CUSTOMS ENTRY TABLE.                             *05940000
049900*---------------------------------------------------------------* 05950000
050000     COPY TRRD051.                                                05960000
050100*---------------------------------------------------------------* 05970000
050200*  COPYBOOK FOR BOOKING TABLE.                                   *05980007
050300*---------------------------------------------------------------* 05990000
050400     COPY TRRD052.                                                06000000
050500*---------------------------------------------------------------* 06010000
050600*  COPYBOOK FOR RECEIVING TABLE.                                 *06020000
050700*---------------------------------------------------------------* 06030000
050800     COPY TRRD053.                                                06040000
050900*---------------------------------------------------------------* 06050000
051000*  COPYBOOK FOR CUSTOMS ENTRY CONTAINER TABLE                    *06060000
051100*---------------------------------------------------------------* 06070000
051200     COPY TRRD054.                                                06080000
051201*PRB44512 - START                                                 06090007
051210*---------------------------------------------------------------* 06100007
051220*  COPYBOOK FOR TIMCNUP CONTAINER UPC TABLE                     * 06110007
051230*---------------------------------------------------------------* 06120007
051240     COPY TRRD062.                                                06130009
P47386*----------------------------------------------------------------*06131052
P47386* COPYBOOK FOR OPEN TO BUY CALCULATIONS                          *06132052
P47386*----------------------------------------------------------------*06133052
P47386     COPY POWS055.                                                06135052
P47386*----------------------------------------------------------------*06139353
051250*PRB44512 - END                                                   06140007
051300*---------------------------------------------------------------* 06150000
051400*  ABEND PROCESSING COPYBOOK.                                    *06160000
051500*---------------------------------------------------------------* 06170000
051600     COPY DPWS004.                                                06180000
051700*---------------------------------------------------------------* 06190000
051800*  DB2 COMMUNICATION AREA.                                        06200000
051900*---------------------------------------------------------------* 06210000
052000     EXEC SQL                                                     06220000
052100         INCLUDE SQLCA                                            06230000
052200     END-EXEC.                                                    06240000
052300                                                                  06250000
052400*---------------------------------------------------------------* 06260000
052500* THE PURPOSE OF THIS CURSOR IS TO GET DATA PO TABLE              06270000
052600*---------------------------------------------------------------* 06280000
052700     EXEC SQL                                                     06290000
052800          DECLARE PO-TABLE-CSR CURSOR WITH HOLD FOR               06300000
052900           SELECT DISTINCT                                        06310000
053000                  PU.PO_NBR                                       06320000
053100                 ,PU.OTB_PER_NBR                                  06330000
053200                 ,PU.DEPT_NBR                                     06340000
053300                 ,PU.EDI_IND                                      06350000
053400                 ,PU.PKGNG_CDE                                    06360000
053500                 ,PU.PO_TYP_CDE                                   06370000
053600                 ,PU.PROD_CNTRY_CDE                               06380000
053700                 ,PU.QTA_CTG_CDE                                  06390000
053800                 ,PU.SEASET_SHRT_NM                               06400000
053900                 ,PU.STATUS_CDE                                   06410000
P47386                 ,PU.TOT_UNT_QTY                                  06420041
P47386                 ,PU.TOT_VAL_COST_AMT                             06430041
P47386                 ,PU.TOT_VAL_RTL_AMT                              06440041
054000                 ,EN.ENT_NAME_DESC                                06450000
054100                 ,MD.DMA_NBR                                      06460000
054200                 ,PL.DONT_SHIP_BEF_DTE                            06470000
054300                 ,PL.EXT_CAN_DTE                                  06480000
054400                 ,PL.CAN_IFNOT_SHIP_DTE                           06490000
054500                 ,PL.FOB_CDE                                      06500000
054600                 ,PL.LAST_FCTRY_DTE                               06510000
054700                 ,PL.POE_CDE                                      06520000
054800                 ,PL.STRT_FCTRY_DTE                               06530000
054900           FROM   TPURCHS PU                                      06540000
055000                 ,TENTNME EN                                      06550000
055100                 ,TMDSEAR MD                                      06560000
055200                 ,TPLNSHP PL                                      06570000
055300           WHERE  PU.OTB_PER_NBR > :PV-OTB-NBR                    06580000
055400             AND  PU.VER_STATUS_CDE = 'A'                         06590000
BARB               AND  PU.PO_TYP_CDE IN ('IM','IE','IF','LD','LE')     06600193
055600             AND  PU.PO_NBR = PL.PO_NBR                           06610000
055700             AND  PL.VER_STATUS_CDE = 'A'                         06620000
055800             AND  PU.ENT_ID = EN.ENT_ID                           06630000
055900             AND  EN.SEQ_NBR = 01                                 06640000
056000             AND  PU.DEPT_NBR = MD.DEPT_NBR                       06650000
056100             WITH UR                                              06660000
056200     END-EXEC.                                                    06670000
056300                                                                  06680000
056400*---------------------------------------------------------------* 06690000
056500* THE PURPOSE OF THIS CURSOR IS TO GET DATA FOR PO UPC TABLE      06700000
056600*   (PACKS)                                                       06710000
056700*---------------------------------------------------------------* 06720000
056800     EXEC SQL                                                     06730000
056900          DECLARE PO-UPC-PKG-TBL-CSR CURSOR WITH HOLD FOR         06740000
057000           SELECT DISTINCT                                        06750000
057100                  PI.AD_EVNT_DTE                                  06760000
057200                 ,PI.PO_NBR                                       06770000
057300                 ,PI.PRD_1ST_COST_AMT                             06780000
057400                 ,PI.UNT_COST_AMT                                 06790000
057500                 ,PI.UNT_QTY                                      06800000
057600                 ,PI.UNT_RTL_PR_AMT                               06810000
057700                 ,PI.APP_PO_LNE_NBR                               06820000
057800                 ,XLV.VS_NBR                                      06830000
057900                 ,SK.SKU                                          06840000
058000                 ,SK.CLASS                                        06850000
058100                 ,SK.SUBCLASS                                     06860000
058200                 ,PK.PREPK_UPC_NBR                                06870000
058300           FROM   TPURITM PI                                      06880000
058400                 ,XLT_VND_STYL XLV                                06890000
058500                 ,XLT_SKU XLS                                     06900000
058600                 ,TSKXREF SK                                      06910000
058700                 ,TPOPRPK PK                                      06920000
058800           WHERE  PI.PO_NBR = :PV-PO-NBR                          06930000
058900             AND  PI.VER_STATUS_CDE = 'A'                         06940000
059000             AND  PK.PO_NBR = PI.PO_NBR                           06950000
059100             AND  PK.PO_PREPK_ID = PI.PO_PREPK_ID                 06960000
059200             AND  SK.ITM_NBR = PI.ITM_NBR                         06970000
059300             AND  XLS.ITM_NBR = PI.ITM_NBR                        06980000
059400             AND  XLV.STYL_ID = XLS.STYL_ID                       06990000
059500             WITH UR                                              07000000
059600     END-EXEC.                                                    07010000
059700*---------------------------------------------------------------* 07020000
059800* THE PURPOSE OF THIS CURSOR IS TO GET DATA FOR PO UPC TABLE      07030000
059900*    (NON PACKS)                                                  07040000
060000*---------------------------------------------------------------* 07050000
060010* PRB44512 - START                                                07060010
060020*  SUBSTITUTE UP.UPC_NBR BETWEEN.....                             07070010
060030* PRB44512 - END                                                  07080010
060100     EXEC SQL                                                     07090000
060200          DECLARE PO-UPC-TABLE-CSR CURSOR WITH HOLD FOR           07100000
060300           SELECT DISTINCT                                        07110000
060400                  PI.AD_EVNT_DTE                                  07120000
060500                 ,PI.PO_NBR                                       07130000
060600                 ,PI.PRD_1ST_COST_AMT                             07140000
060700                 ,PI.UNT_COST_AMT                                 07150000
060800                 ,PI.UNT_QTY                                      07160000
060900                 ,PI.UNT_RTL_PR_AMT                               07170000
061000                 ,PI.APP_PO_LNE_NBR                               07180000
061100                 ,XLV.VS_NBR                                      07190000
061200                 ,SK.SKU                                          07200000
061300                 ,SK.CLASS                                        07210000
061400                 ,SK.SUBCLASS                                     07220000
061500                 ,UP.UPC_NBR                                      07230000
061600           FROM   TPURITM PI                                      07240000
061700                 ,XLT_VND_STYL XLV                                07250000
061800                 ,XLT_SKU XLS                                     07260000
061900                 ,TSKXREF SK                                      07270000
062000                 ,TUPCSKU UP                                      07280000
062100           WHERE  PI.PO_NBR = :PV-PO-NBR                          07290000
062200             AND  PI.VER_STATUS_CDE = 'A'                         07300000
062300             AND  UP.ITEM_NBR = PI.ITM_NBR                        07310000
062310             AND UP.UPC_NBR BETWEEN 000400000000000               07320010
062320                                AND 000499999999999               07330010
062600             AND  SK.ITM_NBR = PI.ITM_NBR                         07340000
062700             AND  XLS.ITM_NBR = PI.ITM_NBR                        07350000
062800             AND  XLV.STYL_ID = XLS.STYL_ID                       07360000
062900             WITH UR                                              07370000
063000     END-EXEC.                                                    07380000
063100*---------------------------------------------------------------* 07390000
063200* THE PURPOSE OF THIS CURSOR IS TO GET DATA FOR CONTAINER PO      07400000
063300*  TABLE                                                          07410000
063400*---------------------------------------------------------------* 07420000
063410* PRB44512 - START                                                07430010
063420*  REMOVE UNNEEDED TABLE TIMCNTK FROM THIS CURSOR                 07440010
063430* PRB44512 - END                                                  07450010
063500     EXEC SQL                                                     07460000
063600          DECLARE CNT-PO-TABLE-CSR CURSOR WITH HOLD FOR           07470000
063700           SELECT DISTINCT                                        07480000
063800                  PO.ACTL_POE_DELY_CDE                            07490000
063900                 ,PO.BKR_FRGT_RLSE_CDE                            07500000
064000                 ,PO.CONTNR_ID                                    07510010
064100                 ,PO.CONTNR_PU_CDE                                07520000
064200                 ,PO.CONTNR_SEQ_NBR                               07530000
064300                 ,PO.CRE_TMST                                     07540000
064400                 ,PO.CSTM_ENTR_ID                                 07550000
064500                 ,PO.DCONSLR_RET_CDE                              07560000
064600                 ,PO.DO_RCVD_CDE                                  07570000
064700                 ,PO.DOC_RCVD_ORGN_TMST                           07580000
064800                 ,PO.DVN_CDE                                      07590000
064900                 ,PO.EXTL_REF_NBR                                 07600000
065000                 ,PO.HSE_BOL_NBR                                  07610000
065100                 ,PO.LAST_UPD_TMST                                07620000
065200                 ,PO.MSTR_BOL_NBR                                 07630000
065300                 ,PO.PO_C_O_PROD_CDE                              07640000
065400                 ,PO.PO_CART_CNT                                  07650000
065500                 ,PO.PO_CBMT_QTY                                  07660000
065600                 ,PO.PO_NBR                                       07670000
065700                 ,PO.PO_RCVD_DELY_TMST                            07680000
065800                 ,PO.PO_UNT_QTY                                   07690000
065900                 ,PO.PO_WT_KGRM_QTY                               07700000
066000                 ,PO.SPLT_XMIT_CDE                                07710000
066100                 ,RL.DCONSLR_ACTL_DTE                             07720000
066200           FROM   TIMCNPO PO                                      07730000
066300                 ,TIMCNRL RL                                      07740000
066500           WHERE  PO.PO_NBR = :PV-PO-NBR                          07750000
066600             AND  RL.PO_NBR = PO.PO_NBR                           07760000
066700             AND  RL.CONTNR_ID = PO.CONTNR_ID                     07770000
TEST               AND  PO.CONTNR_ID <> 'TGHU8883402'                   07771099
066800             AND  RL.CONTNR_SEQ_NBR = PO.CONTNR_SEQ_NBR           07780000
067100             AND  PO.CONTNR_SEQ_NBR =                             07790000
067200                     (SELECT MAX(POI.CONTNR_SEQ_NBR)              07800000
067300                     FROM TIMCNPO POI                             07810000
067400                     WHERE POI.PO_NBR = PO.PO_NBR                 07820000
067500                     AND POI.CONTNR_ID = PO.CONTNR_ID             07830000
067600                     AND POI.CONTNR_SEQ_NBR = PO.CONTNR_SEQ_NBR)  07840000
067700             WITH UR                                              07850000
067800     END-EXEC.                                                    07860000
067801* PRB44512 - START                                                07870002
067810*---------------------------------------------------------------* 07880002
067820* THE PURPOSE OF THIS CURSOR IS TO GET DATA FOR CONTAINER UPC     07890002
067830*  TABLE                                                          07900002
067840*---------------------------------------------------------------* 07910002
067850     EXEC SQL                                                     07920002
067860          DECLARE TIMCNUP-TABLE-CSR CURSOR WITH HOLD FOR          07930003
067861          SELECT DISTINCT                                         07940003
067862             CONTNR_ID                                            07950002
067863            ,CONTNR_SEQ_NBR                                       07960002
067864            ,PO_NBR                                               07970002
067865            ,VS_NBR                                               07980002
067866            ,UPC_NBR                                              07990002
067867            ,PO_LNE_NBR                                           08000002
067868            ,UPC_CART_CNT                                         08010002
067869            ,UPC_CBMT_QTY                                         08020002
067870            ,UPC_WT_KGRM_QTY                                      08030002
067871            ,UPC_UNT_QTY                                          08040002
067872            ,SKU_NBR                                              08050002
067873            ,ASN_PKGNG_CDE                                        08060002
067874           FROM TIMCNUP                                           08070002
067875          WHERE CONTNR_ID      = :IMCNPO-CONTNR-ID                08080003
                  AND CONTNR_ID      <> 'TGHU8883402'                   08081099
067876            AND CONTNR_SEQ_NBR = :IMCNPO-CONTNR-SEQ-NBR           08090003
067877            AND PO_NBR         = :PV-PO-NBR                       08100003
067928          WITH UR                                                 08110003
067929     END-EXEC.                                                    08120002
067930* PRB44512 - END                                                  08130002
067940*---------------------------------------------------------------* 08140002
068000* THE PURPOSE OF THIS CURSOR IS TO GET DATA FOR PO DC TABLE       08150000
068100*---------------------------------------------------------------* 08160000
068200     EXEC SQL                                                     08170000
068300          DECLARE PO-DC-TABLE-CSR CURSOR WITH HOLD FOR            08180000
068400           SELECT DISTINCT                                        08190000
068500                  TP.CURR_SPLIT_QTY                               08200000
068600                 ,TP.DEST_NBR                                     08210000
068700                 ,PI.PO_NBR                                       08220000
068800           FROM   TALLPLN TP                                      08230000
068900                 ,TPURITM PI                                      08240000
069000           WHERE  TP.PO_NBR = :PV-PO-NBR                          08250000
069100             AND  PI.PO_NBR = TP.PO_NBR                           08260000
069200             AND  TP.PO_LNE_NBR = :PURITM-APP-PO-LNE-NBR          08270000
069300             WITH UR                                              08280000
069400     END-EXEC.                                                    08290000
069500*---------------------------------------------------------------* 08300000
069600* THE PURPOSE OF THIS CURSOR IS TO GET DATA FOR SEAL TABLE        08310000
069700*---------------------------------------------------------------* 08320000
069800     EXEC SQL                                                     08330000
069900          DECLARE SEAL-TABLE-CSR CURSOR WITH HOLD FOR             08340000
070000           SELECT DISTINCT                                        08350000
070100                  CONTNR_ID                                       08360000
070200                 ,CONTNR_SEQ_NBR                                  08370000
070300                 ,CRE_TMST                                        08380000
070400                 ,LAST_UPD_TMST                                   08390000
070500                 ,SEAL_NBR                                        08400000
070600           FROM   TRT_IMPRT_SEAL                                  08410000
070700           WHERE  CONTNR_ID = :IMCNPO-CONTNR-ID                   08420000
                   AND  CONTNR_ID  <> 'TGHU8883402'                     08421099
070800             AND  CONTNR_SEQ_NBR = :IMCNPO-CONTNR-SEQ-NBR         08430000
070900             WITH UR                                              08440000
071000     END-EXEC.                                                    08450000
071100*---------------------------------------------------------------* 08460000
071200* THE PURPOSE OF THIS CURSOR IS TO GET DATA FOR SHIPMENT PO TABLE 08470000
071300*---------------------------------------------------------------* 08480000
071400     EXEC SQL                                                     08490000
071500          DECLARE SHIP-PO-TABLE-CSR CURSOR WITH HOLD FOR          08500000
071600           SELECT TPK.CONTNR_ID                                   08510000
071700                 ,TPK.OPER_UNT_ID                                 08520000
071800                 ,TPK.CRE_TMST                                    08530000
071900                 ,TPK.CRE_UID                                     08540000
072000                 ,SUM(TRS.AP_VERIFY_ITM_QTY)                      08550000
072100                 ,TRV.VERFYD_TMST                                 08560000
072200                 ,TSH.PO_NBR                                      08570000
072300                 ,TSH.SHIPT_ID                                    08580000
072400                 ,TSH.REC_SEQ_NBR                                 08590000
072500           FROM   TPKSLIP TPK                                     08600000
072600                 ,TRECDIS TRS                                     08610000
072700                 ,TRECEIV TRV                                     08620000
072800                 ,TSHPTPO TSH                                     08630000
072900           WHERE TSH.PO_NBR = :PV-PO-NBR                          08640000
073000             AND TRV.ORD_NBR = TSH.PO_NBR                         08650000
073100             AND TRV.REC_SEQ_NBR = TSH.REC_SEQ_NBR                08660000
073200             AND TRV.VER_STATUS_CDE = 'A'                         08670000
073300             AND TRS.ORD_NBR = TSH.PO_NBR                         08680000
073400             AND TRS.REC_SEQ_NBR = TSH.REC_SEQ_NBR                08690000
073500             AND TRS.VER_STATUS_CDE = 'A'                         08700000
073600             AND TPK.PO_NBR = TSH.PO_NBR                          08710000
073700             AND TPK.REC_SEQ_NBR = TSH.REC_SEQ_NBR                08720000
073800             AND TPK.VER_STAT_CDE = 'A'                           08730000
073810             AND    TRS.FCLTY_ID = TPK.FCLTY_ID                   08740001
073820             AND    TRS.OPER_UNT_ID = TPK.OPER_UNT_ID             08750001
073830             AND    TPK.REC_SEQ_NBR + 0 = TSH.REC_SEQ_NBR         08760001
073900             GROUP BY                                             08770000
074000                  TPK.CONTNR_ID                                   08780000
074100                 ,TPK.OPER_UNT_ID                                 08790000
074200                 ,TPK.CRE_TMST                                    08800000
074300                 ,TPK.CRE_UID                                     08810000
074400                 ,TRV.VERFYD_TMST                                 08820000
074500                 ,TSH.PO_NBR                                      08830000
074600                 ,TSH.SHIPT_ID                                    08840000
074700                 ,TSH.REC_SEQ_NBR                                 08850000
074800             WITH UR                                              08860000
074900     END-EXEC.                                                    08870000
075000*---------------------------------------------------------------* 08880000
075100* THE PURPOSE OF THIS CURSOR IS TO GET DATA FOR SHIPMENT STATUS   08890000
075200*  TABLE                                                          08900000
075300*---------------------------------------------------------------* 08910000
075400     EXEC SQL                                                     08920000
075500          DECLARE SHP-ST-TABLE-CSR CURSOR WITH HOLD FOR           08930000
075600           SELECT DISTINCT                                        08940000
075700                  SHP.SHIPT_ID                                    08950000
075800                 ,SHP.STATUS_DTE                                  08960000
075900                 ,SHP.SHIPT_STATUS_CDE                            08970000
076000                 ,SHS.DESC                                        08980000
076100           FROM   TSHIPST SHP                                     08990000
076200                 ,TSHSTYP SHS                                     09000000
076300           WHERE  SHP.SHIPT_ID = :SHPTPO-SHIPT-ID                 09010000
076400             AND  SHP.SHIPT_STATUS_CDE = SHS.SHIPT_STATUS_CDE     09020000
076500             WITH UR                                              09030000
076600     END-EXEC.                                                    09040000
076700*---------------------------------------------------------------* 09050000
076800* THE PURPOSE OF THIS CURSOR IS TO GET DATA FOR SHIPMENT TABLE    09060000
076900*---------------------------------------------------------------* 09070000
077000     EXEC SQL                                                     09080000
077100          DECLARE SHIP-TABLE-CSR CURSOR WITH HOLD FOR             09090000
077200           SELECT DISTINCT                                        09100000
077300                  SHP.BOL_NBR                                     09110000
077400                 ,SHP.PRO_NBR                                     09120000
077500                 ,SHP.SHIPT_ID                                    09130000
077600                 ,SHP.TRIP_ID                                     09140000
077700           FROM   TSHIPMT SHP                                     09150000
077800           WHERE  SHP.SHIPT_ID = :SHPTPO-SHIPT-ID                 09160000
077900             WITH UR                                              09170000
078000     END-EXEC.                                                    09180000
078100*---------------------------------------------------------------* 09190000
078200* THE PURPOSE OF THIS CURSOR IS TO GET DATA FOR TRIP TABLE        09200000
078300*---------------------------------------------------------------* 09210000
078400     EXEC SQL                                                     09220000
078500          DECLARE TRIP-TABLE-CSR CURSOR WITH HOLD FOR             09230000
078600           SELECT DISTINCT                                        09240000
078700                  VH.EST_AR_TMST                                  09250000
078800                 ,VH.OWNER_SCAC_ID                                09260000
078900                 ,VH.TRIP_ID                                      09270000
079000                 ,VH.VEH_NBR                                      09280000
079100           FROM   TVHTRIP VH                                      09290000
079200           WHERE  VH.TRIP_ID = :SHIPMT-TRIP-ID                    09300000
079300             WITH UR                                              09310000
079400     END-EXEC.                                                    09320000
079500*---------------------------------------------------------------* 09330000
079600* THE PURPOSE OF THIS CURSOR IS TO GET DATA FOR BOOKING TABLE     09340000
079700*---------------------------------------------------------------* 09350000
079800     EXEC SQL                                                     09360000
079900          DECLARE BOOKING-TABLE-CSR CURSOR WITH HOLD FOR          09370000
080000           SELECT DISTINCT                                        09380000
080100                  BK.C_O_PROD_CDE                                 09390000
080200                 ,BK.CONSLR_SCAC_ID                               09400000
080300                 ,BK.CRE_TMST                                     09410000
080400                 ,BK.DAT_SRC_ENT_ID                               09420000
080500                 ,BK.DEST_POE_CDE                                 09430000
080600                 ,BK.DPRTR_TMST                                   09440000
080700                 ,BK.EST_LBD_NM                                   09450000
080800                 ,BK.EST_LBD_TMST                                 09460000
080900                 ,BK.EXTL_REF_NBR                                 09470000
081000                 ,BK.FOB_CDE                                      09480000
081100                 ,BK.IMPRT_VEH_NM                                 09490000
081200                 ,BK.LAST_UPD_TMST                                09500000
081300                 ,BK.ORGN_SHPD_FR_CDE                             09510000
081400                 ,BK.PO_BKG_DELY_TMST                             09520000
081500                 ,BK.PO_CART_CNT                                  09530000
081600                 ,BK.PO_CBMT_QTY                                  09540000
081700                 ,BK.PO_NBR                                       09550000
081800                 ,BK.PO_UNT_QTY                                   09560000
081900                 ,BK.PO_WT_KGRM_QTY                               09570000
082000                 ,BK.PROD_FCTRY_NM                                09580000
082100                 ,BK.TRIP_TYP_CDE                                 09590000
082200           FROM   TIMBKPO BK                                      09600000
082300           WHERE  BK.PO_NBR  = :PV-PO-NBR                         09610000
082400             WITH UR                                              09620000
082500     END-EXEC.                                                    09630000
082600*---------------------------------------------------------------* 09640000
082700* THE PURPOSE OF THIS CURSOR IS TO GET DATA FOR RECEIVING TABLE   09650000
082800*---------------------------------------------------------------* 09660000
082900     EXEC SQL                                                     09670000
083000          DECLARE REC-TABLE-CSR CURSOR WITH HOLD FOR              09680000
083100           SELECT DISTINCT                                        09690000
083200                  RC.C_O_PROD_CDE                                 09700000
083300                 ,RC.CONSLR_SCAC_ID                               09710000
083400                 ,RC.CRE_TMST                                     09720000
083500                 ,RC.DAT_SRC_ENT_ID                               09730000
083600                 ,RC.DEST_POE_CDE                                 09740000
083700                 ,RC.DPRTR_TMST                                   09750000
083800                 ,RC.EST_LBD_NM                                   09760000
083900                 ,RC.EST_LBD_TMST                                 09770000
084000                 ,RC.EXTL_REF_NBR                                 09780000
084100                 ,RC.FOB_CDE                                      09790000
084200                 ,RC.IMPRT_VEH_NM                                 09800000
084300                 ,RC.LAST_UPD_TMST                                09810000
084400                 ,RC.ORGN_SHPD_FR_CDE                             09820000
084500                 ,RC.PO_CART_CNT                                  09830000
084600                 ,RC.PO_CBMT_QTY                                  09840000
084700                 ,RC.PO_NBR                                       09850000
084800                 ,RC.PO_RCVD_DELY_TMST                            09860000
084900                 ,RC.PO_UNT_QTY                                   09870000
085000                 ,RC.PO_WT_KGRM_QTY                               09880000
085100                 ,RC.PROD_FCTRY_NM                                09890000
085200                 ,RC.TRIP_TYP_CDE                                 09900000
085300           FROM   TIMRCPO RC                                      09910000
085400           WHERE  RC.PO_NBR = :PV-PO-NBR                          09920000
085500             WITH UR                                              09930000
085600     END-EXEC.                                                    09940000
085700*---------------------------------------------------------------* 09950000
085800* THE PURPOSE OF THIS CURSOR IS TO GET DATA FOR CUSTOMS ENTRY     09960000
085900*  PO TABLE                                                       09970000
086000*---------------------------------------------------------------* 09980000
086100     EXEC SQL                                                     09990000
086200          DECLARE CE-PO-TABLE-CSR CURSOR WITH HOLD FOR            10000000
086300           SELECT DISTINCT                                        10010000
086400                  CS.CSTM_ENTR_ID                                 10020000
086500                 ,CS.PO_NBR                                       10030000
086600                 ,CS.CRE_TMST                                     10040000
086700                 ,CS.LAST_UPD_TMST                                10050000
086800                 ,CS.EXTL_REF_NBR                                 10060000
086900           FROM   TIMCSPO CS                                      10070000
087000           WHERE  CS.PO_NBR = :PV-PO-NBR                          10080000
087100             WITH UR                                              10090000
087200     END-EXEC.                                                    10100000
087300*---------------------------------------------------------------* 10110000
087400* THE PURPOSE OF THIS CURSOR IS TO GET DATA FOR CUSTOMS ENTRY     10120000
087500*  TABLE                                                          10130000
087600*---------------------------------------------------------------* 10140000
087700     EXEC SQL                                                     10150000
087800          DECLARE CE-TABLE-CSR CURSOR WITH HOLD FOR               10160000
087900           SELECT DISTINCT                                        10170000
088000                  CS.ACTL_CLR_TMST                                10180000
088100                 ,CS.BKR_REF_NBR                                  10190000
088200                 ,CS.CRE_TMST                                     10200000
088300                 ,CS.CSTM_ENTR_ID                                 10210000
088400                 ,CS.DAT_SRC_ENT_ID                               10220000
088500                 ,CS.ENT_ID                                       10230000
088600                 ,CS.ENTR_TYP_CDE                                 10240000
088700                 ,CS.EST_CLR_TMST                                 10250000
088800                 ,CS.EXM_TMST                                     10260000
088900                 ,CS.FILD_TMST                                    10270000
089000                 ,CS.LAST_UPD_TMST                                10280000
089100                 ,CS.LQDN_SSPNN_TMST                              10290000
089200                 ,CS.LQDN_TMST                                    10300000
089300                 ,CS.MOM_DEST_POE_CDE                             10310000
089400                 ,CS.MOM_TRIP_TYP_CDE                             10320000
089500                 ,CS.REJ_TMST                                     10330000
089600           FROM   TIMCSEN CS                                      10340000
089700           WHERE  CS.CSTM_ENTR_ID = :IMCSPO-CSTM-ENTR-ID          10350000
089800             WITH UR                                              10360000
089900     END-EXEC.                                                    10370000
090000*---------------------------------------------------------------* 10380000
090100* THE PURPOSE OF THIS CURSOR IS TO GET DATA FOR CUSTOMS ENTRY     10390000
090200*  CONTAINER TABLE                                                10400000
090300*---------------------------------------------------------------* 10410000
090400     EXEC SQL                                                     10420000
090500          DECLARE CSCN-TABLE-CSR CURSOR WITH HOLD FOR             10430000
090600           SELECT DISTINCT                                        10440000
090700                  CSTM_ENTR_ID                                    10450000
090800                 ,CONTNR_ID                                       10460000
090900                 ,CRE_BY_USR_ID                                   10470000
091000                 ,CRE_TMST                                        10480000
091100                 ,LAST_UPD_BY_USR_ID                              10490000
091200                 ,LAST_UPD_TMST                                   10500000
091300                 ,DO_TO_DCONSLR_TMST                              10510000
091400           FROM   TIMCSCN                                         10520000
091500           WHERE  CSTM_ENTR_ID = :IMCSPO-CSTM-ENTR-ID             10530000
091600             WITH UR                                              10540000
091700     END-EXEC.                                                    10550000
091800***************************************************************** 10560000
091900 PROCEDURE DIVISION.                                              10570000
092000***************************************************************** 10580000
092100                                                                  10590000
092200*--------------------------------------------------------------*  10600000
092300* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE  *  10610000
092400* PROGRAM.                                                     *  10620000
092500*--------------------------------------------------------------*  10630000
092600 0000-PROGRAM-MAINLINE.                                           10640000
092700                                                                  10650000
092800     PERFORM 1000-INITIALIZE.                                     10660000
092900                                                                  10670000
093000     PERFORM 2000-PERFORM-TABLE-EXTRACTS.                         10680000
093100                                                                  10690000
093200     CLOSE PO-TABLE                                               10700000
093300           PO-UPC-TABLE                                           10710000
093400           PO-UPC-DC-TABLE                                        10720000
093500           CONTAINER-PO-TABLE                                     10730000
093600           CONTAINER-TABLE                                        10740000
093700           SEAL-TABLE                                             10750000
093800           SHIPMENT-PO-TABLE                                      10760000
093900           SHIPMENT-STATUS-TABLE                                  10770000
094000           SHIPMENT-TABLE                                         10780000
094100           TRIP-TABLE                                             10790000
094200           CUSTOMS-ENTRY-PO-TABLE                                 10800000
094300           CUSTOMS-ENTRY-TABLE                                    10810000
094400           BOOKING-TABLE                                          10820000
094500           RECEIVING-TABLE                                        10830000
094510*       PRB44512 - START                                          10840006
094610           CONTAINER-UPC-TABLE                                    10850006
094620*       PRB44512 - END                                            10860006
094630           CUSTOMS-CONTAINER-TABLE                                10870066
      *PRB51351 - START                                                 10871066
                 INVALID-PO-FILE.                                       10872066
094700*PRB51351 - END                                                   10880091
094800     GOBACK.                                                      10890000
094900*--------------------------------------------------------------*  10900000
095000 1000-INITIALIZE.                                                 10910000
095100                                                                  10920000
095200     OPEN OUTPUT PO-TABLE                                         10930000
095300                 PO-UPC-TABLE                                     10940000
095400                 PO-UPC-DC-TABLE                                  10950000
095500                 CONTAINER-PO-TABLE                               10960000
095600                 CONTAINER-TABLE                                  10970000
095700                 SEAL-TABLE                                       10980000
095800                 SHIPMENT-PO-TABLE                                10990000
095900                 SHIPMENT-STATUS-TABLE                            11000000
096000                 SHIPMENT-TABLE                                   11010000
096100                 TRIP-TABLE                                       11020000
096200                 CUSTOMS-ENTRY-PO-TABLE                           11030000
096300                 CUSTOMS-ENTRY-TABLE                              11040000
096400                 BOOKING-TABLE                                    11050000
096500                 RECEIVING-TABLE                                  11060000
096510*              PRB44512 - START                                   11070006
096520                 CONTAINER-UPC-TABLE                              11080006
096530*              PRB44512 - END                                     11090006
096600                 CUSTOMS-CONTAINER-TABLE                          11100066
      *              PRB51351 - START                                   11101066
                       INVALID-PO-FILE.                                 11102066
      *              PRB51351 - END                                     11103066
096700                                                                  11110000
096800* GET CURRENT TIMESTAMP AND DATE                                  11120000
096900     EXEC SQL                                                     11130000
097000       SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                   11140000
097100     END-EXEC.                                                    11150000
097200                                                                  11160000
097300     EXEC SQL                                                     11170000
097400       SET :PV-CURRENT-DATE = CURRENT DATE                        11180000
097500     END-EXEC.                                                    11190000
097600                                                                  11200000
097610*    PRB44512 - START - USE CONTROL CARD FOR MONTHS               11210011
097620     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           11220011
097630     IF CC-MONTH-RANGE NUMERIC                                    11230011
097640        MOVE CC-MONTH-RANGE  TO PV-MONTHS                         11240011
097650     ELSE                                                         11250011
097660        DISPLAY 'INVALID DATA IN SYSIN CONTROL MEMBER'            11260011
097670        SET PC-CONTROL-CARD-ERROR TO TRUE                         11270011
097680        PERFORM 9200-NON-DB2-ABEND                                11280011
097690     END-IF.                                                      11290011
097691                                                                  11300011
097700     EXEC SQL                                                     11310000
097800       SET :PV-OTB-DATE-FMT =                                     11320011
097810                    CURRENT DATE - :PV-MONTHS MONTHS              11330011
097900     END-EXEC.                                                    11340000
097910*    PRB44512 - END                                               11350011
098000     MOVE PV-OTB-DATE-FMT(1:4) TO PV-OTB-NBR-YEAR.                11360000
098100     MOVE PV-OTB-DATE-FMT(6:2) TO PV-OTB-NBR-MONTH.               11370000
098200*----------------------------------------------------------------*11380000
098300* CREATE EXTRACT FILES                                            11390000
098400*----------------------------------------------------------------*11400000
098500 2000-PERFORM-TABLE-EXTRACTS.                                     11410000
098600                                                                  11420000
098700     PERFORM 2110-OPEN-PO-TABLE-CSR.                              11430000
098800     PERFORM 2120-PROCESS-PO-TABLE-CSR                            11440000
098900       UNTIL PS-END-OF-PO-CURSOR.                                 11450000
099000     PERFORM 2130-CLOSE-PO-TABLE-CSR.                             11460000
099100                                                                  11470000
099200*--------------------------------------------------------------*  11480000
099300* OPEN PO TABLE CURSOR                                            11490000
099400*--------------------------------------------------------------*  11500000
099500 2110-OPEN-PO-TABLE-CSR.                                          11510000
099600                                                                  11520000
099700     EXEC SQL                                                     11530000
099800          OPEN PO-TABLE-CSR                                       11540000
099900     END-EXEC.                                                    11550000
100000                                                                  11560000
100100     EVALUATE TRUE                                                11570000
100200         WHEN SQLCODE = ZERO                                      11580000
100300             CONTINUE                                             11590000
100400         WHEN SQLWARN0 NOT = SPACES                               11600000
100500         WHEN SQLCODE < ZERO                                      11610000
100600         WHEN SQLCODE > ZERO                                      11620000
100700             MOVE '2110-OPEN-PO-TABLE-CSR'                        11630000
100800                             TO PV-PARAGRAPH-NAME                 11640000
100900             MOVE 'ATTEMPTING TO OPEN THE PO-TABLE-CSR'           11650000
101000                             TO PV-DB2-OPERATION-MESSAGE          11660000
101100             MOVE 'TPURCHS'  TO PV-DB2-TABLE-NAME-1               11670000
101200             PERFORM 9100-DB2-ABEND                               11680000
101300     END-EVALUATE.                                                11690000
101400*--------------------------------------------------------------*  11700000
101500* PROCESS PO TABLE CURSOR                                         11710000
101600*--------------------------------------------------------------*  11720000
101700 2120-PROCESS-PO-TABLE-CSR.                                       11730000
101800                                                                  11740000
101900     PERFORM 2121-FETCH-PO-TABLE-CSR.                             11750000
102000     MOVE PURCHS-PO-NBR      TO PV-PO-NBR.                        11760000
102100                                                                  11770063
      *PRB51351 - START                                                 11770191
           IF PLNSHP-DONT-SHIP-BEF-DTE = '0001-01-01'                   11771059
              PERFORM 8250-WRITE-INVALID-PO-RECORD                      11772483
           ELSE                                                         11776062
      *PRB51351 - END                                                   11777091
                                                                        11778063
102200      IF NOT PS-END-OF-PO-CURSOR                                  11780085
P47386        PERFORM 5000-SELECT-RECEIPT-DATE-INFO                     11790043
P47386        PERFORM 5100-GET-WEEK-NBR                                 11791051
102300        PERFORM 8000-WRITE-PO-TABLE-RECORD                        11800016
102400        IF (PURCHS-PKGNG-CDE = 'M') OR                            11810000
102500           (PURCHS-PKGNG-CDE = 'I')                               11820000
102600           PERFORM 2210-OPEN-PO-UPC-PKG-TBL-CSR                   11830000
102700           PERFORM 2220-PROCES-PO-UPC-PKG-TBL-CSR                 11840000
102800             UNTIL PS-END-OF-PO-UPC-PKG-CSR                       11850000
102900           PERFORM 2230-CLOSE-PO-UPC-PKG-TBL-CSR                  11860000
103000        ELSE                                                      11870000
103100           PERFORM 2310-OPEN-PO-UPC-TABLE-CSR                     11880000
103200           PERFORM 2320-PROCESS-PO-UPC-TABLE-CSR                  11890000
103300             UNTIL PS-END-OF-PO-UPC-CURSOR                        11900000
103400           PERFORM 2330-CLOSE-PO-UPC-TABLE-CSR                    11910000
103500        END-IF                                                    11920000
103600        PERFORM 2510-OPEN-CNT-PO-TABLE-CSR                        11930000
103700        PERFORM 2520-PROCESS-CNT-PO-TABLE-CSR                     11940000
103800          UNTIL PS-END-OF-CNT-PO-CURSOR                           11950000
103900        PERFORM 2530-CLOSE-CNT-PO-TABLE-CSR                       11960000
104000        PERFORM 2710-OPEN-SHIP-PO-TABLE-CSR                       11970000
104100        PERFORM 2720-PROCESS-SHIP-PO-TABLE-CSR                    11980000
104200          UNTIL PS-END-OF-SHIP-PO-CURSOR                          11990000
104300        PERFORM 2730-CLOSE-SHIP-PO-TABLE-CSR                      12000000
104400        PERFORM 3110-OPEN-BOOKING-TABLE-CSR                       12010000
104500        PERFORM 3120-PROCESS-BOOKING-TABLE-CSR                    12020000
104600          UNTIL PS-END-OF-BOOKING-CURSOR                          12030000
104700        PERFORM 3130-CLOSE-BOOKING-TABLE-CSR                      12040000
104800        PERFORM 3210-OPEN-REC-TABLE-CSR                           12050000
104900        PERFORM 3220-PROCESS-REC-TABLE-CSR                        12060000
105000          UNTIL PS-END-OF-REC-CURSOR                              12070000
105100        PERFORM 3230-CLOSE-REC-TABLE-CSR                          12080000
105200        PERFORM 3310-OPEN-CE-PO-TABLE-CSR                         12090000
105300        PERFORM 3320-PROCESS-CE-PO-TABLE-CSR                      12100000
105400          UNTIL PS-END-OF-CE-PO-CURSOR                            12110000
105500        PERFORM 3330-CLOSE-CE-PO-TABLE-CSR                        12120000
105600      END-IF                                                      12130063
      *PRB51351 - START                                                 12130191
           END-IF.                                                      12131061
      *PRB51351 - END                                                   12132091
105700                                                                  12140000
105800*--------------------------------------------------------------*  12150000
105900* FETCH PO TABLE CURSOR                                           12160000
106000*--------------------------------------------------------------*  12170000
106100 2121-FETCH-PO-TABLE-CSR.                                         12180000
106200                                                                  12190000
106300     EXEC SQL                                                     12200000
106400         FETCH PO-TABLE-CSR                                       12210000
106500          INTO :PURCHS-PO-NBR                                     12220000
106600              ,:PURCHS-OTB-PER-NBR                                12230000
106700              ,:PURCHS-DEPT-NBR                                   12240000
106800              ,:PURCHS-EDI-IND                                    12250000
106900              ,:PURCHS-PKGNG-CDE                                  12260000
107000              ,:PURCHS-PO-TYP-CDE                                 12270000
107100              ,:PURCHS-PROD-CNTRY-CDE                             12280000
107200              ,:PURCHS-QTA-CTG-CDE                                12290000
107300              ,:PURCHS-SEASET-SHRT-NM                             12300000
107400              ,:PURCHS-STATUS-CDE                                 12310000
P47386              ,:PURCHS-TOT-UNT-QTY                                12320041
P47386              ,:PURCHS-TOT-VAL-COST-AMT                           12330041
P47386              ,:PURCHS-TOT-VAL-RTL-AMT                            12340041
107500              ,:ENTNME-ENT-NAME-DESC                              12350000
107600              ,:MDSEAR-DMA-NBR                                    12360000
107700              ,:PLNSHP-DONT-SHIP-BEF-DTE                          12370000
107800              ,:PLNSHP-EXT-CAN-DTE                                12380000
107900              ,:PLNSHP-CAN-IFNOT-SHIP-DTE                         12390000
108000              ,:PLNSHP-FOB-CDE                                    12400000
108100              ,:PLNSHP-LAST-FCTRY-DTE                             12410000
108200              ,:PLNSHP-POE-CDE                                    12420000
108300              ,:PLNSHP-STRT-FCTRY-DTE                             12430000
108400     END-EXEC.                                                    12440000
108500                                                                  12450000
108600     EVALUATE TRUE                                                12460000
108700         WHEN SQLCODE = ZERO                                      12470000
108800               CONTINUE                                           12480000
108900         WHEN SQLCODE = +100                                      12490000
109000              SET PS-END-OF-PO-CURSOR TO TRUE                     12500000
109100         WHEN SQLWARN0 NOT = SPACES                               12510000
109200         WHEN SQLCODE < ZERO                                      12520000
109300         WHEN SQLCODE > ZERO                                      12530000
109400             MOVE '2121-FETCH-PO-TABLE-CSR'                       12540000
109500                                 TO PV-PARAGRAPH-NAME             12550000
109600             MOVE 'ERROR FETCHING WITH THE PO-TABLE-CSR'          12560000
109700                                 TO PV-DB2-OPERATION-MESSAGE      12570000
109800             MOVE 'TPURCHS'      TO PV-DB2-TABLE-NAME-1           12580000
109900             PERFORM 9100-DB2-ABEND                               12590000
110000     END-EVALUATE.                                                12600000
110100 EJECT                                                            12610000
110200                                                                  12620000
110300*--------------------------------------------------------------*  12630000
110400* CLOSE PO TABLE CURSOR                                           12640000
110500*--------------------------------------------------------------*  12650000
110600 2130-CLOSE-PO-TABLE-CSR.                                         12660000
110700                                                                  12670000
110800         EXEC SQL                                                 12680000
110900              CLOSE PO-TABLE-CSR                                  12690000
111000         END-EXEC.                                                12700000
111100                                                                  12710000
111200     EVALUATE TRUE                                                12720000
111300         WHEN SQLCODE = ZERO                                      12730000
111400             CONTINUE                                             12740000
111500         WHEN SQLWARN0 NOT = SPACES                               12750000
111600         WHEN SQLCODE < ZERO                                      12760000
111700         WHEN SQLCODE > ZERO                                      12770000
111800             MOVE '2130-CLOSE-PO-TABLE-CSR'                       12780000
111900                             TO PV-PARAGRAPH-NAME                 12790000
112000             MOVE 'ATTEMPTING TO CLOSE THE PO-TABLE-CSR'          12800000
112100                             TO PV-DB2-OPERATION-MESSAGE          12810000
112200             MOVE 'TPURCHS'  TO PV-DB2-TABLE-NAME-1               12820000
112300             PERFORM 9100-DB2-ABEND                               12830000
112400     END-EVALUATE.                                                12840000
112500                                                                  12850000
112600*--------------------------------------------------------------*  12860000
112700* OPEN PO UPC PKG TABLE CURSOR                                    12870000
112800*--------------------------------------------------------------*  12880000
112900 2210-OPEN-PO-UPC-PKG-TBL-CSR.                                    12890000
113000                                                                  12900000
113100     EXEC SQL                                                     12910000
113200          OPEN PO-UPC-PKG-TBL-CSR                                 12920000
113300     END-EXEC.                                                    12930000
113400                                                                  12940000
113500     EVALUATE TRUE                                                12950000
113600         WHEN SQLCODE = ZERO                                      12960000
113700             CONTINUE                                             12970000
113800         WHEN SQLWARN0 NOT = SPACES                               12980000
113900         WHEN SQLCODE < ZERO                                      12990000
114000         WHEN SQLCODE > ZERO                                      13000000
114100             MOVE '2210-OPEN-PO-UPC-PKG-TABLE-CURSOR'             13010000
114200                             TO PV-PARAGRAPH-NAME                 13020000
114300             MOVE 'ATTEMPTING TO OPEN THE PO-UPC-PKG-CURSOR'      13030000
114400                             TO PV-DB2-OPERATION-MESSAGE          13040000
114500             MOVE 'TPURITM'  TO PV-DB2-TABLE-NAME-1               13050000
114600             PERFORM 9100-DB2-ABEND                               13060000
114700     END-EVALUATE.                                                13070000
114800*--------------------------------------------------------------*  13080000
114900* PROCESS PO UPC TABLE CURSOR                                     13090000
115000*--------------------------------------------------------------*  13100000
115100 2220-PROCES-PO-UPC-PKG-TBL-CSR.                                  13110000
115200                                                                  13120000
115300     PERFORM 2221-FETCH-PO-UPC-PKG-TBL-CSR.                       13130000
115400     IF NOT PS-END-OF-PO-UPC-PKG-CSR                              13140000
115500        PERFORM 8010-WRITE-PO-UPC-TABLE-REC                       13150000
115600        PERFORM 2410-OPEN-PO-DC-TABLE-CSR                         13160000
115700        PERFORM 2420-PROCESS-PO-DC-TABLE-CSR                      13170000
115800          UNTIL PS-END-OF-PO-DC-CURSOR                            13180000
115900        PERFORM 2430-CLOSE-PO-DC-TABLE-CSR                        13190000
116000     END-IF.                                                      13200000
116100                                                                  13210000
116200*--------------------------------------------------------------*  13220000
116300* FETCH PO TABLE CURSOR                                           13230000
116400*--------------------------------------------------------------*  13240000
116500 2221-FETCH-PO-UPC-PKG-TBL-CSR.                                   13250000
116600                                                                  13260000
116700     EXEC SQL                                                     13270000
116800         FETCH PO-UPC-PKG-TBL-CSR                                 13280000
116900          INTO :PURITM-AD-EVNT-DTE                                13290000
117000              ,:PURITM-PO-NBR                                     13300000
117100              ,:PURITM-PRD-1ST-COST-AMT                           13310000
117200              ,:PURITM-UNT-COST-AMT                               13320000
117300              ,:PURITM-UNT-QTY                                    13330000
117400              ,:PURITM-UNT-RTL-PR-AMT                             13340000
117500              ,:PURITM-APP-PO-LNE-NBR                             13350000
117600              ,:XLT00004-VS-NBR                                   13360000
117700              ,:SKXREF-SKU                                        13370000
117800              ,:SKXREF-CLASS                                      13380000
117900              ,:SKXREF-SUBCLASS                                   13390000
118000              ,:POPRPK-PREPK-UPC-NBR                              13400000
118100     END-EXEC.                                                    13410000
118200                                                                  13420000
118300     EVALUATE TRUE                                                13430000
118400         WHEN SQLCODE = ZERO                                      13440000
118500               CONTINUE                                           13450000
118600         WHEN SQLCODE = +100                                      13460000
118700              SET PS-END-OF-PO-UPC-PKG-CSR TO TRUE                13470000
118800         WHEN SQLWARN0 NOT = SPACES                               13480000
118900         WHEN SQLCODE < ZERO                                      13490000
119000         WHEN SQLCODE > ZERO                                      13500000
119100             MOVE '2221-FETCH-PO-UPC-PKG-TBL-CSR'                 13510000
119200                                 TO PV-PARAGRAPH-NAME             13520000
119300             MOVE 'ERROR FETCHING WITH THE PO-UPC-PKG-TBL-CSR'    13530000
119400                                 TO PV-DB2-OPERATION-MESSAGE      13540000
119500             MOVE 'TPURITM'      TO PV-DB2-TABLE-NAME-1           13550000
119600             PERFORM 9100-DB2-ABEND                               13560000
119700     END-EVALUATE.                                                13570000
119800 EJECT                                                            13580000
119900                                                                  13590000
120000*--------------------------------------------------------------*  13600000
120100* CLOSE PO UPC PKG TABLE CURSOR                                   13610000
120200*--------------------------------------------------------------*  13620000
120300 2230-CLOSE-PO-UPC-PKG-TBL-CSR.                                   13630000
120400                                                                  13640000
120500         EXEC SQL                                                 13650000
120600              CLOSE PO-UPC-PKG-TBL-CSR                            13660000
120700         END-EXEC.                                                13670000
120800                                                                  13680000
120900     SET PS-NOT-END-OF-PO-UPC-PKG-CSR TO TRUE                     13690000
121000                                                                  13700000
121100     EVALUATE TRUE                                                13710000
121200         WHEN SQLCODE = ZERO                                      13720000
121300             CONTINUE                                             13730000
121400         WHEN SQLWARN0 NOT = SPACES                               13740000
121500         WHEN SQLCODE < ZERO                                      13750000
121600         WHEN SQLCODE > ZERO                                      13760000
121700             MOVE '2230-CLOSE-PO-UPC-PKG-TABLE-CSR'               13770000
121800                             TO PV-PARAGRAPH-NAME                 13780000
121900             MOVE 'ATTEMPTING TO CLOSE THE PO-UPC-PKG-TABLE-CSR'  13790000
122000                             TO PV-DB2-OPERATION-MESSAGE          13800000
122100             MOVE 'TPURITM'  TO PV-DB2-TABLE-NAME-1               13810000
122200             PERFORM 9100-DB2-ABEND                               13820000
122300     END-EVALUATE.                                                13830000
122400                                                                  13840000
122500*--------------------------------------------------------------*  13850000
122600* OPEN PO UPC PKG TABLE CURSOR                                    13860000
122700*--------------------------------------------------------------*  13870000
122800 2310-OPEN-PO-UPC-TABLE-CSR.                                      13880000
122900                                                                  13890000
123000     EXEC SQL                                                     13900000
123100          OPEN PO-UPC-TABLE-CSR                                   13910000
123200     END-EXEC.                                                    13920000
123300                                                                  13930000
123400     EVALUATE TRUE                                                13940000
123500         WHEN SQLCODE = ZERO                                      13950000
123600             CONTINUE                                             13960000
123700         WHEN SQLWARN0 NOT = SPACES                               13970000
123800         WHEN SQLCODE < ZERO                                      13980000
123900         WHEN SQLCODE > ZERO                                      13990000
124000             MOVE '2310-OPEN-PO-UPC-TABLE-CURSOR'                 14000000
124100                             TO PV-PARAGRAPH-NAME                 14010000
124200             MOVE 'ATTEMPTING TO OPEN THE PO-UPC-CURSOR'          14020000
124300                             TO PV-DB2-OPERATION-MESSAGE          14030000
124400             MOVE 'TPURITM'  TO PV-DB2-TABLE-NAME-1               14040000
124500             PERFORM 9100-DB2-ABEND                               14050000
124600     END-EVALUATE.                                                14060000
124700*--------------------------------------------------------------*  14070000
124800* PROCESS PO UPC TABLE CURSOR                                     14080000
124900*--------------------------------------------------------------*  14090000
125000 2320-PROCESS-PO-UPC-TABLE-CSR.                                   14100000
125100                                                                  14110000
125200     PERFORM 2321-FETCH-PO-UPC-TABLE-CSR.                         14120000
125300                                                                  14130000
125400     IF NOT PS-END-OF-PO-UPC-CURSOR                               14140000
125500        PERFORM 8010-WRITE-PO-UPC-TABLE-REC                       14150000
125600        PERFORM 2410-OPEN-PO-DC-TABLE-CSR                         14160000
125700        PERFORM 2420-PROCESS-PO-DC-TABLE-CSR                      14170000
125800          UNTIL PS-END-OF-PO-DC-CURSOR                            14180000
125900        PERFORM 2430-CLOSE-PO-DC-TABLE-CSR                        14190000
126000     END-IF.                                                      14200000
126100                                                                  14210000
126200*--------------------------------------------------------------*  14220000
126300* FETCH PO UPC TABLE CURSOR                                       14230000
126400*--------------------------------------------------------------*  14240000
126500 2321-FETCH-PO-UPC-TABLE-CSR.                                     14250000
126600                                                                  14260000
126700     EXEC SQL                                                     14270000
126800         FETCH PO-UPC-TABLE-CSR                                   14280000
126900          INTO :PURITM-AD-EVNT-DTE                                14290000
127000              ,:PURITM-PO-NBR                                     14300000
127100              ,:PURITM-PRD-1ST-COST-AMT                           14310000
127200              ,:PURITM-UNT-COST-AMT                               14320000
127300              ,:PURITM-UNT-QTY                                    14330000
127400              ,:PURITM-UNT-RTL-PR-AMT                             14340000
127500              ,:PURITM-APP-PO-LNE-NBR                             14350000
127600              ,:XLT00004-VS-NBR                                   14360000
127700              ,:SKXREF-SKU                                        14370000
127800              ,:SKXREF-CLASS                                      14380000
127900              ,:SKXREF-SUBCLASS                                   14390000
128000              ,:TUPCSKU-UPC-NBR                                   14400000
128100     END-EXEC.                                                    14410000
128200                                                                  14420000
128300     EVALUATE TRUE                                                14430000
128400         WHEN SQLCODE = ZERO                                      14440000
128500               CONTINUE                                           14450000
128600         WHEN SQLCODE = +100                                      14460000
128700              SET PS-END-OF-PO-UPC-CURSOR TO TRUE                 14470000
128800         WHEN SQLWARN0 NOT = SPACES                               14480000
128900         WHEN SQLCODE < ZERO                                      14490000
129000         WHEN SQLCODE > ZERO                                      14500000
129100             MOVE '2321-FETCH-PO-UPC-TABLE-CSR'                   14510000
129200                                 TO PV-PARAGRAPH-NAME             14520000
129300             MOVE 'ERROR FETCHING WITH THE PO-UPC-TABLE-CSR'      14530000
129400                                 TO PV-DB2-OPERATION-MESSAGE      14540000
129500             MOVE 'TPURITM'      TO PV-DB2-TABLE-NAME-1           14550000
129600             PERFORM 9100-DB2-ABEND                               14560000
129700     END-EVALUATE.                                                14570000
129800 EJECT                                                            14580000
129900                                                                  14590000
130000*--------------------------------------------------------------*  14600000
130100* CLOSE PO UPC PKG TABLE CURSOR                                   14610000
130200*--------------------------------------------------------------*  14620000
130300 2330-CLOSE-PO-UPC-TABLE-CSR.                                     14630000
130400                                                                  14640000
130500         EXEC SQL                                                 14650000
130600              CLOSE PO-UPC-TABLE-CSR                              14660000
130700         END-EXEC.                                                14670000
130800                                                                  14680000
130900     SET PS-NOT-END-OF-PO-UPC-CURSOR TO TRUE                      14690000
131000                                                                  14700000
131100                                                                  14710000
131200     EVALUATE TRUE                                                14720000
131300         WHEN SQLCODE = ZERO                                      14730000
131400             CONTINUE                                             14740000
131500         WHEN SQLWARN0 NOT = SPACES                               14750000
131600         WHEN SQLCODE < ZERO                                      14760000
131700         WHEN SQLCODE > ZERO                                      14770000
131800             MOVE '2330-CLOSE-PO-UPC-TABLE-CSR'                   14780000
131900                             TO PV-PARAGRAPH-NAME                 14790000
132000             MOVE 'ATTEMPTING TO CLOSE THE PO-UPC-TABLE-CSR'      14800000
132100                             TO PV-DB2-OPERATION-MESSAGE          14810000
132200             MOVE 'TPURITM'  TO PV-DB2-TABLE-NAME-1               14820000
132300             PERFORM 9100-DB2-ABEND                               14830000
132400     END-EVALUATE.                                                14840000
132500                                                                  14850000
132600*--------------------------------------------------------------*  14860000
132700* OPEN PO DC TABLE CURSOR                                         14870000
132800*--------------------------------------------------------------*  14880000
132900 2410-OPEN-PO-DC-TABLE-CSR.                                       14890000
133000                                                                  14900000
133100     EXEC SQL                                                     14910000
133200          OPEN PO-DC-TABLE-CSR                                    14920000
133300     END-EXEC.                                                    14930000
133400                                                                  14940000
133500     EVALUATE TRUE                                                14950000
133600         WHEN SQLCODE = ZERO                                      14960000
133700             CONTINUE                                             14970000
133800         WHEN SQLWARN0 NOT = SPACES                               14980000
133900         WHEN SQLCODE < ZERO                                      14990000
134000         WHEN SQLCODE > ZERO                                      15000000
134100             MOVE '2410-OPEN-PO-DC-TABLE-CURSOR'                  15010000
134200                             TO PV-PARAGRAPH-NAME                 15020000
134300             MOVE 'ATTEMPTING TO OPEN THE PO-DC-CURSOR'           15030000
134400                             TO PV-DB2-OPERATION-MESSAGE          15040000
134500             MOVE 'TALLPLN'  TO PV-DB2-TABLE-NAME-1               15050000
134600             PERFORM 9100-DB2-ABEND                               15060000
134700     END-EVALUATE.                                                15070000
134800*--------------------------------------------------------------*  15080000
134900* PROCESS PO DC TABLE CURSOR                                      15090000
135000*--------------------------------------------------------------*  15100000
135100 2420-PROCESS-PO-DC-TABLE-CSR.                                    15110000
135200                                                                  15120000
135300     PERFORM 2421-FETCH-PO-DC-TABLE-CSR.                          15130000
135400                                                                  15140000
135500     IF NOT PS-END-OF-PO-DC-CURSOR                                15150000
135600        PERFORM 8020-WRITE-PO-DC-TABLE-REC                        15160000
135700     END-IF.                                                      15170000
135800                                                                  15180000
135900*--------------------------------------------------------------*  15190000
136000* FETCH PO DC TABLE CURSOR                                        15200000
136100*--------------------------------------------------------------*  15210000
136200 2421-FETCH-PO-DC-TABLE-CSR.                                      15220000
136300                                                                  15230000
136400     EXEC SQL                                                     15240000
136500         FETCH PO-DC-TABLE-CSR                                    15250000
136600          INTO :ALLPLN-CURR-SPLIT-QTY                             15260000
136700              ,:ALLPLN-DEST-NBR                                   15270000
136800              ,:PURITM-PO-NBR                                     15280000
136900     END-EXEC.                                                    15290000
137000                                                                  15300000
137100     EVALUATE TRUE                                                15310000
137200         WHEN SQLCODE = ZERO                                      15320000
137300               CONTINUE                                           15330000
137400         WHEN SQLCODE = +100                                      15340000
137500              SET PS-END-OF-PO-DC-CURSOR TO TRUE                  15350000
137600         WHEN SQLWARN0 NOT = SPACES                               15360000
137700         WHEN SQLCODE < ZERO                                      15370000
137800         WHEN SQLCODE > ZERO                                      15380000
137900             MOVE '2421-FETCH-PO-DC-TABLE-CSR'                    15390000
138000                                 TO PV-PARAGRAPH-NAME             15400000
138100             MOVE 'ERROR FETCHING WITH THE PO-DC-TABLE-CSR'       15410000
138200                                 TO PV-DB2-OPERATION-MESSAGE      15420000
138300             MOVE 'TALLPLN'      TO PV-DB2-TABLE-NAME-1           15430000
138400             PERFORM 9100-DB2-ABEND                               15440000
138500     END-EVALUATE.                                                15450000
138600 EJECT                                                            15460000
138700                                                                  15470000
138800*--------------------------------------------------------------*  15480000
138900* CLOSE PO DC TABLE CURSOR                                        15490000
139000*--------------------------------------------------------------*  15500000
139100 2430-CLOSE-PO-DC-TABLE-CSR.                                      15510000
139200                                                                  15520000
139300         EXEC SQL                                                 15530000
139400              CLOSE PO-DC-TABLE-CSR                               15540000
139500         END-EXEC.                                                15550000
139600                                                                  15560000
139700     SET PS-NOT-END-OF-PO-DC-CURSOR TO TRUE                       15570000
139800                                                                  15580000
139900                                                                  15590000
140000     EVALUATE TRUE                                                15600000
140100         WHEN SQLCODE = ZERO                                      15610000
140200             CONTINUE                                             15620000
140300         WHEN SQLWARN0 NOT = SPACES                               15630000
140400         WHEN SQLCODE < ZERO                                      15640000
140500         WHEN SQLCODE > ZERO                                      15650000
140600             MOVE '2430-CLOSE-PO-DC-TABLE-CSR'                    15660000
140700                             TO PV-PARAGRAPH-NAME                 15670000
140800             MOVE 'ATTEMPTING TO CLOSE THE PO-DC-TABLE-CSR'       15680000
140900                             TO PV-DB2-OPERATION-MESSAGE          15690000
141000             MOVE 'TALLPLN'  TO PV-DB2-TABLE-NAME-1               15700000
141100             PERFORM 9100-DB2-ABEND                               15710000
141200     END-EVALUATE.                                                15720000
141300                                                                  15730000
141400*--------------------------------------------------------------*  15740000
141500* OPEN CONTAINER PO TABLE CURSOR                                  15750000
141600*--------------------------------------------------------------*  15760000
141700 2510-OPEN-CNT-PO-TABLE-CSR.                                      15770000
141800                                                                  15780000
141900     EXEC SQL                                                     15790000
142000          OPEN CNT-PO-TABLE-CSR                                   15800000
142100     END-EXEC.                                                    15810000
142200                                                                  15820000
142300     EVALUATE TRUE                                                15830000
142400         WHEN SQLCODE = ZERO                                      15840000
142500             CONTINUE                                             15850000
142600         WHEN SQLWARN0 NOT = SPACES                               15860000
142700         WHEN SQLCODE < ZERO                                      15870000
142800         WHEN SQLCODE > ZERO                                      15880000
142900             MOVE '2510-OPEN-CNT-PO-TABLE-CURSOR'                 15890000
143000                             TO PV-PARAGRAPH-NAME                 15900000
143100             MOVE 'ATTEMPTING TO OPEN THE CNT-PO-CURSOR'          15910000
143200                             TO PV-DB2-OPERATION-MESSAGE          15920000
143300             MOVE 'TIMCNPO'  TO PV-DB2-TABLE-NAME-1               15930000
143400             PERFORM 9100-DB2-ABEND                               15940000
143500     END-EVALUATE.                                                15950000
143600*--------------------------------------------------------------*  15960000
143700* PROCESS PO DC TABLE CURSOR                                      15970000
143800*--------------------------------------------------------------*  15980000
143900 2520-PROCESS-CNT-PO-TABLE-CSR.                                   15990000
144000                                                                  16000000
144100     PERFORM 2521-FETCH-CNT-PO-TABLE-CSR.                         16010000
144200                                                                  16020000
144300     IF NOT PS-END-OF-CNT-PO-CURSOR                               16030000
144400        PERFORM 8030-WRITE-CNT-PO-TABLE-REC                       16040000
144500        PERFORM 2540-SELECT-CONTAINER-TABLE                       16050000
144600        PERFORM 2550-SELECT-FDR-POL-CDE                           16060000
144700        PERFORM 2551-SELECT-FDR-POR-CDE                           16070000
144800        PERFORM 2552-SELECT-MOM-POL-CDE                           16080000
144900        PERFORM 2553-SELECT-MOM-POR-CDE                           16090000
145000        PERFORM 2560-SELECT-FOB-CDE                               16100000
145100        PERFORM 2570-SELECT-POE-CDE                               16110000
145200        PERFORM 8040-WRITE-CONTAINER-TABLE-REC                    16120000
145300        PERFORM 2610-OPEN-SEAL-TABLE-CSR                          16130000
145400        PERFORM 2620-PROCESS-SEAL-TABLE-CSR                       16140000
145500          UNTIL PS-END-OF-SEAL-CURSOR                             16150000
145600        PERFORM 2630-CLOSE-SEAL-TABLE-CSR                         16160000
145601* PRB44512 - START                                                16170003
145610        PERFORM 3600-OPEN-TIMCNUP-TABLE-CSR                       16180003
145620        PERFORM 3610-PROCESS-TIMCNUP-TABLE-CSR                    16190003
145630          UNTIL PS-END-OF-TIMCNUP-CURSOR                          16200003
145640        PERFORM 3690-CLOSE-TIMCNUP-TABLE-CSR                      16210003
145650* PRB44512 - END                                                  16220003
145700     END-IF.                                                      16230000
145800                                                                  16240000
145900*--------------------------------------------------------------*  16250000
146000* FETCH CONTAINER PO TABLE CURSOR                                 16260000
146100*--------------------------------------------------------------*  16270000
146200 2521-FETCH-CNT-PO-TABLE-CSR.                                     16280000
146300                                                                  16290000
146400     EXEC SQL                                                     16300000
146500         FETCH CNT-PO-TABLE-CSR                                   16310000
146600          INTO :IMCNPO-ACTL-POE-DELY-CDE                          16320000
146700              ,:IMCNPO-BKR-FRGT-RLSE-CDE                          16330000
146800              ,:IMCNPO-CONTNR-ID                                  16340000
146900              ,:IMCNPO-CONTNR-PU-CDE                              16350000
147000              ,:IMCNPO-CONTNR-SEQ-NBR                             16360000
147100              ,:IMCNPO-CRE-TMST                                   16370000
147200              ,:IMCNPO-CSTM-ENTR-ID                               16380000
147300              ,:IMCNPO-DCONSLR-RET-CDE                            16390000
147400              ,:IMCNPO-DO-RCVD-CDE                                16400000
147500              ,:IMCNPO-DOC-RCVD-ORGN-TMST                         16410000
147600              ,:IMCNPO-DVN-CDE                                    16420000
147700              ,:IMCNPO-EXTL-REF-NBR                               16430000
147800              ,:IMCNPO-HSE-BOL-NBR                                16440000
147900              ,:IMCNPO-LAST-UPD-TMST                              16450000
148000              ,:IMCNPO-MSTR-BOL-NBR                               16460000
148100              ,:IMCNPO-PO-C-O-PROD-CDE                            16470000
148200              ,:IMCNPO-PO-CART-CNT                                16480000
148300              ,:IMCNPO-PO-CBMT-QTY                                16490000
148400              ,:IMCNPO-PO-NBR                                     16500000
148500              ,:IMCNPO-PO-RCVD-DELY-TMST                          16510000
148600              ,:IMCNPO-PO-UNT-QTY                                 16520000
148700              ,:IMCNPO-PO-WT-KGRM-QTY                             16530000
148800              ,:IMCNPO-SPLT-XMIT-CDE                              16540000
148900              ,:IMCNRL-DCONSLR-ACTL-DTE                           16550000
149000     END-EXEC.                                                    16560000
149100                                                                  16570000
149200     EVALUATE TRUE                                                16580000
149300         WHEN SQLCODE = ZERO                                      16590000
149400               CONTINUE                                           16600000
149500         WHEN SQLCODE = +100                                      16610000
149600              SET PS-END-OF-CNT-PO-CURSOR TO TRUE                 16620000
149700         WHEN SQLWARN0 NOT = SPACES                               16630000
149800         WHEN SQLCODE < ZERO                                      16640000
149900         WHEN SQLCODE > ZERO                                      16650000
150000             MOVE '2521-FETCH-CNT-PO-TABLE-CSR'                   16660000
150100                                 TO PV-PARAGRAPH-NAME             16670000
150200             MOVE 'ERROR FETCHING WITH THE CNT-PO-TABLE-CSR'      16680000
150300                                 TO PV-DB2-OPERATION-MESSAGE      16690000
150400             MOVE 'TIMCNPO'      TO PV-DB2-TABLE-NAME-1           16700000
150500             PERFORM 9100-DB2-ABEND                               16710000
150600     END-EVALUATE.                                                16720000
150700 EJECT                                                            16730000
150800                                                                  16740000
150900*--------------------------------------------------------------*  16750000
151000* CLOSE CONTAINER PO TABLE CURSOR                                 16760000
151100*--------------------------------------------------------------*  16770000
151200 2530-CLOSE-CNT-PO-TABLE-CSR.                                     16780000
151300                                                                  16790000
151400         EXEC SQL                                                 16800000
151500              CLOSE CNT-PO-TABLE-CSR                              16810000
151600         END-EXEC.                                                16820000
151700                                                                  16830000
151800     SET PS-NOT-END-OF-CNT-PO-CURSOR TO TRUE                      16840000
151900                                                                  16850000
152000     EVALUATE TRUE                                                16860000
152100         WHEN SQLCODE = ZERO                                      16870000
152200             CONTINUE                                             16880000
152300         WHEN SQLWARN0 NOT = SPACES                               16890000
152400         WHEN SQLCODE < ZERO                                      16900000
152500         WHEN SQLCODE > ZERO                                      16910000
152600             MOVE '2530-CLOSE-CNT-PO-TABLE-CSR'                   16920000
152700                             TO PV-PARAGRAPH-NAME                 16930000
152800             MOVE 'ATTEMPTING TO CLOSE THE CNT-PO-TABLE-CSR'      16940000
152900                             TO PV-DB2-OPERATION-MESSAGE          16950000
153000             MOVE 'TIMCNPO'  TO PV-DB2-TABLE-NAME-1               16960000
153100             PERFORM 9100-DB2-ABEND                               16970000
153200     END-EVALUATE.                                                16980000
153300                                                                  16990000
153400*--------------------------------------------------------------*  17000000
153500* SELECT  CONTAINER TABLE   (TIMCNTK)                             17010000
153600*--------------------------------------------------------------*  17020000
153700 2540-SELECT-CONTAINER-TABLE.                                     17030000
153800                                                                  17040000
153900     EXEC SQL                                                     17050000
154000         SELECT ACTL_DEST_POE_CDE                                 17060000
154100               ,ACTL_LBD_NM                                       17070000
154200               ,ACTL_LBD_TMST                                     17080000
154300               ,ACTL_POE_DELY_TMST                                17090000
154400               ,BKR_FRGT_RLSE_TMST                                17100000
154500               ,CART_CNT                                          17110000
154600               ,CBMT_QTY                                          17120000
154700               ,CONSLR_SCAC_ID                                    17130000
154800               ,CONTNR_ID                                         17140000
154900               ,CONTNR_PU_TMST                                    17150000
155000               ,CONTNR_SEQ_NBR                                    17160000
155100               ,CRE_TMST                                          17170000
155200               ,DCONSLR_RET_TMST                                  17180000
155300               ,DCONSLR_SCAC_ID                                   17190000
155400               ,DO_RCVD_TMST                                      17200000
155500               ,DVN_TMST                                          17210000
155600               ,EST_LBD_NM                                        17220000
155700               ,EST_LBD_TMST                                      17230000
155800               ,FDR_CARR_SCAC_ID                                  17240000
155900               ,FDR_DPRTR_TMST                                    17250000
156000               ,FDR_FOB_CDE                                       17260000
156100               ,FDR_IMPRT_TRIP_ID                                 17270000
156200               ,FDR_IMPRT_VEH_NM                                  17280000
156300               ,FDR_TRIP_TYP_CDE                                  17290000
156400               ,LAST_UPD_TMST                                     17300000
156500               ,MOM_CARR_SCAC_ID                                  17310000
156600               ,MOM_DPRTR_TMST                                    17320000
156700               ,MOM_FOB_CDE                                       17330000
156800               ,MOM_IMPRT_VEH_NM                                  17340000
156900               ,MOM_POE_DELY_TMST                                 17350000
157000               ,MOM_TRIP_TYP_CDE                                  17360000
157100               ,ORGN_SHPD_FR_CDE                                  17370000
157200               ,ORGN_SHPD_TO_CDE                                  17380000
157300               ,SIZE_CDE                                          17390000
157400               ,UNT_QTY                                           17400000
157500               ,WT_KGRM_QTY                                       17410000
157600               ,MOM_DEST_POE_CDE                                  17420000
157700               ,MOM_IMPRT_TRIP_ID                                 17430000
157800               ,FDR_POL_CDE                                       17440000
157900               ,FDR_POR_CDE                                       17450000
158000               ,MOM_POL_CDE                                       17460000
158100               ,MOM_POR_CDE                                       17470000
158200           INTO :IMCNTK-ACTL-DEST-POE-CDE                         17480000
158300               ,:IMCNTK-ACTL-LBD-NM                               17490000
158400               ,:IMCNTK-ACTL-LBD-TMST                             17500000
158500               ,:IMCNTK-ACTL-POE-DELY-TMST                        17510000
158600               ,:IMCNTK-BKR-FRGT-RLSE-TMST                        17520000
158700               ,:IMCNTK-CART-CNT                                  17530000
158800               ,:IMCNTK-CBMT-QTY                                  17540000
158900               ,:IMCNTK-CONSLR-SCAC-ID                            17550000
159000               ,:IMCNTK-CONTNR-ID                                 17560000
159100               ,:IMCNTK-CONTNR-PU-TMST                            17570000
159200               ,:IMCNTK-CONTNR-SEQ-NBR                            17580000
159300               ,:IMCNTK-CRE-TMST                                  17590000
159400               ,:IMCNTK-DCONSLR-RET-TMST                          17600000
159500               ,:IMCNTK-DCONSLR-SCAC-ID                           17610000
159600               ,:IMCNTK-DO-RCVD-TMST                              17620000
159700               ,:IMCNTK-DVN-TMST                                  17630000
159800               ,:IMCNTK-EST-LBD-NM                                17640000
159900               ,:IMCNTK-EST-LBD-TMST                              17650000
160000               ,:IMCNTK-FDR-CARR-SCAC-ID                          17660000
160100               ,:IMCNTK-FDR-DPRTR-TMST                            17670000
160200               ,:IMCNTK-FDR-FOB-CDE                               17680000
160300               ,:IMCNTK-FDR-IMPRT-TRIP-ID                         17690000
160400               ,:IMCNTK-FDR-IMPRT-VEH-NM                          17700000
160500               ,:IMCNTK-FDR-TRIP-TYP-CDE                          17710000
160600               ,:IMCNTK-LAST-UPD-TMST                             17720000
160700               ,:IMCNTK-MOM-CARR-SCAC-ID                          17730000
160800               ,:IMCNTK-MOM-DPRTR-TMST                            17740000
160900               ,:IMCNTK-MOM-FOB-CDE                               17750000
161000               ,:IMCNTK-MOM-IMPRT-VEH-NM                          17760000
161100               ,:IMCNTK-MOM-POE-DELY-TMST                         17770000
161200               ,:IMCNTK-MOM-TRIP-TYP-CDE                          17780000
161300               ,:IMCNTK-ORGN-SHPD-FR-CDE                          17790000
161400               ,:IMCNTK-ORGN-SHPD-TO-CDE                          17800000
161500               ,:IMCNTK-SIZE-CDE                                  17810000
161600               ,:IMCNTK-UNT-QTY                                   17820000
161700               ,:IMCNTK-WT-KGRM-QTY                               17830000
161800               ,:IMCNTK-MOM-DEST-POE-CDE                          17840000
161900               ,:IMCNTK-MOM-IMPRT-TRIP-ID                         17850000
162000               ,:IMCNTK-FDR-POL-CDE                               17860000
162100               ,:IMCNTK-FDR-POR-CDE                               17870000
162200               ,:IMCNTK-MOM-POL-CDE                               17880000
162300               ,:IMCNTK-MOM-POR-CDE                               17890000
162400           FROM TIMCNTK                                           17900000
162500          WHERE CONTNR_ID  = :IMCNPO-CONTNR-ID                    17910000
                  AND CONTNR_ID      <> 'TGHU8883402'                   17911099
162600            AND CONTNR_SEQ_NBR = :IMCNPO-CONTNR-SEQ-NBR           17920000
162700     END-EXEC.                                                    17930000
162800                                                                  17940000
162900     EVALUATE TRUE                                                17950000
163000         WHEN SQLCODE = ZERO                                      17960000
163100             CONTINUE                                             17970000
163200         WHEN SQLWARN0 NOT = SPACES                               17980000
163300         WHEN SQLCODE < ZERO                                      17990000
163400         WHEN SQLCODE > ZERO                                      18000000
163500             MOVE '2540-SELECT-CONTAINER-TABLE'                   18010000
163600                             TO PV-PARAGRAPH-NAME                 18020000
163700             MOVE 'SELECT ON TIMCNTK TABLE'                       18030000
163800                             TO PV-DB2-OPERATION-MESSAGE          18040000
163900             MOVE 'TIMCNTK'  TO PV-DB2-TABLE-NAME-1               18050000
164000             PERFORM 9100-DB2-ABEND                               18060000
164100     END-EVALUATE.                                                18070000
164200*--------------------------------------------------------------*  18080000
164300* SELECT  FDR POL CDE                                             18090000
164400*--------------------------------------------------------------*  18100000
164500 2550-SELECT-FDR-POL-CDE.                                         18110000
164600                                                                  18120000
164700     EXEC SQL                                                     18130000
164800         SELECT IMPRT_ORGN_CDE                                    18140000
164900           INTO :TRT00010-IMPRT-ORGN-CDE                          18150000
165000           FROM TRT_IMPRT_ORGN                                    18160000
165100          WHERE STD_EDI_CDE =  :IMCNTK-FDR-POL-CDE                18170000
165200            AND IMPRT_ORGN_TYP_CDE = 'POL'                        18180000
165300            AND STAT_CDE = 'A'                                    18190000
165400     END-EXEC.                                                    18200000
165500                                                                  18210000
165600     EVALUATE TRUE                                                18220000
165700         WHEN SQLCODE = ZERO                                      18230000
165800             MOVE TRT00010-IMPRT-ORGN-CDE TO                      18240000
165900                               TR044-FDR-POL-IMPRT-ORGN-CDE       18250000
166000             CONTINUE                                             18260000
166100         WHEN SQLCODE = 100                                       18270000
166200             MOVE SPACES TO TR044-FDR-POL-IMPRT-ORGN-CDE          18280000
166300             CONTINUE                                             18290000
166400         WHEN SQLWARN0 NOT = SPACES                               18300000
166500         WHEN SQLCODE < ZERO                                      18310000
166600         WHEN SQLCODE > ZERO                                      18320000
166700             MOVE '2550-SELECT-FDR-POL-CDE'                       18330000
166800                             TO PV-PARAGRAPH-NAME                 18340000
166900             MOVE 'SELECT ON TRT-IMPRT-ORGN TABLE'                18350000
167000                             TO PV-DB2-OPERATION-MESSAGE          18360000
167100             MOVE 'TRT-IMPRT-ORGN' TO PV-DB2-TABLE-NAME-1         18370000
167200             PERFORM 9100-DB2-ABEND                               18380000
167300     END-EVALUATE.                                                18390000
167400*--------------------------------------------------------------*  18400000
167500* SELECT  FDR POR CDE                                             18410000
167600*--------------------------------------------------------------*  18420000
167700 2551-SELECT-FDR-POR-CDE.                                         18430000
167800                                                                  18440000
167900     EXEC SQL                                                     18450000
168000         SELECT IMPRT_ORGN_CDE                                    18460000
168100           INTO :TRT00010-IMPRT-ORGN-CDE                          18470000
168200           FROM TRT_IMPRT_ORGN                                    18480000
168300          WHERE STD_EDI_CDE =  :IMCNTK-FDR-POR-CDE                18490000
168400            AND IMPRT_ORGN_TYP_CDE = 'POR'                        18500000
168500            AND STAT_CDE = 'A'                                    18510000
168600     END-EXEC.                                                    18520000
168700                                                                  18530000
168800     EVALUATE TRUE                                                18540000
168900         WHEN SQLCODE = ZERO                                      18550000
169000             MOVE TRT00010-IMPRT-ORGN-CDE TO                      18560000
169100                               TR044-FDR-POR-IMPRT-ORGN-CDE       18570000
169200             CONTINUE                                             18580000
169300         WHEN SQLCODE = 100                                       18590000
169400             MOVE SPACES TO TR044-FDR-POR-IMPRT-ORGN-CDE          18600000
169500             CONTINUE                                             18610000
169600         WHEN SQLWARN0 NOT = SPACES                               18620000
169700         WHEN SQLCODE < ZERO                                      18630000
169800         WHEN SQLCODE > ZERO                                      18640000
169900             MOVE '2551-SELECT-FDR-POR-CDE'                       18650000
170000                             TO PV-PARAGRAPH-NAME                 18660000
170100             MOVE 'SELECT ON TRT-IMPRT-ORGN TABLE'                18670000
170200                             TO PV-DB2-OPERATION-MESSAGE          18680000
170300             MOVE 'TRT-IMPRT-ORGN' TO PV-DB2-TABLE-NAME-1         18690000
170400             PERFORM 9100-DB2-ABEND                               18700000
170500     END-EVALUATE.                                                18710000
170600*--------------------------------------------------------------*  18720000
170700* SELECT  MOM POL CDE                                             18730000
170800*--------------------------------------------------------------*  18740000
170900 2552-SELECT-MOM-POL-CDE.                                         18750000
171000                                                                  18760000
171100     EXEC SQL                                                     18770000
171200         SELECT IMPRT_ORGN_CDE                                    18780000
171300           INTO :TRT00010-IMPRT-ORGN-CDE                          18790000
171400           FROM TRT_IMPRT_ORGN                                    18800000
171500          WHERE STD_EDI_CDE =  :IMCNTK-MOM-POL-CDE                18810000
171600            AND IMPRT_ORGN_TYP_CDE = 'POL'                        18820000
171700            AND STAT_CDE = 'A'                                    18830000
171800     END-EXEC.                                                    18840000
171900                                                                  18850000
172000     EVALUATE TRUE                                                18860000
172100         WHEN SQLCODE = ZERO                                      18870000
172200             MOVE TRT00010-IMPRT-ORGN-CDE TO                      18880000
172300                               TR044-MOM-POL-IMPRT-ORGN-CDE       18890000
172400             CONTINUE                                             18900000
172500         WHEN SQLCODE = 100                                       18910000
172600             MOVE SPACES TO TR044-MOM-POL-IMPRT-ORGN-CDE          18920000
172700             CONTINUE                                             18930000
172800         WHEN SQLWARN0 NOT = SPACES                               18940000
172900         WHEN SQLCODE < ZERO                                      18950000
173000         WHEN SQLCODE > ZERO                                      18960000
173100             MOVE '2552-SELECT-MOM-POL-CDE'                       18970000
173200                             TO PV-PARAGRAPH-NAME                 18980000
173300             MOVE 'SELECT ON TRT-IMPRT-ORGN TABLE'                18990000
173400                             TO PV-DB2-OPERATION-MESSAGE          19000000
173500             MOVE 'TRT-IMPRT-ORGN' TO PV-DB2-TABLE-NAME-1         19010000
173600             PERFORM 9100-DB2-ABEND                               19020000
173700     END-EVALUATE.                                                19030000
173800*--------------------------------------------------------------*  19040000
173900* SELECT  MOM POR CDE                                             19050000
174000*--------------------------------------------------------------*  19060000
174100 2553-SELECT-MOM-POR-CDE.                                         19070000
174200                                                                  19080000
174300     EXEC SQL                                                     19090000
174400         SELECT IMPRT_ORGN_CDE                                    19100000
174500           INTO :TRT00010-IMPRT-ORGN-CDE                          19110000
174600           FROM TRT_IMPRT_ORGN                                    19120000
174700          WHERE STD_EDI_CDE =  :IMCNTK-MOM-POR-CDE                19130000
174800            AND IMPRT_ORGN_TYP_CDE = 'POR'                        19140000
174900            AND STAT_CDE = 'A'                                    19150000
175000     END-EXEC.                                                    19160000
175100                                                                  19170000
175200     EVALUATE TRUE                                                19180000
175300         WHEN SQLCODE = ZERO                                      19190000
175400             MOVE TRT00010-IMPRT-ORGN-CDE TO                      19200000
175500                               TR044-MOM-POR-IMPRT-ORGN-CDE       19210000
175600             CONTINUE                                             19220000
175700         WHEN SQLCODE = 100                                       19230000
175800             MOVE SPACES TO TR044-MOM-POR-IMPRT-ORGN-CDE          19240000
175900             CONTINUE                                             19250000
176000         WHEN SQLWARN0 NOT = SPACES                               19260000
176100         WHEN SQLCODE < ZERO                                      19270000
176200         WHEN SQLCODE > ZERO                                      19280000
176300             MOVE '2553-SELECT-MOM-POR-CDE'                       19290000
176400                             TO PV-PARAGRAPH-NAME                 19300000
176500             MOVE 'SELECT ON TRT-IMPRT-ORGN TABLE'                19310000
176600                             TO PV-DB2-OPERATION-MESSAGE          19320000
176700             MOVE 'TRT-IMPRT-ORGN' TO PV-DB2-TABLE-NAME-1         19330000
176800             PERFORM 9100-DB2-ABEND                               19340000
176900     END-EVALUATE.                                                19350000
177000*--------------------------------------------------------------*  19360000
177100* SELECT  FOB CDE                                                 19370000
177200*--------------------------------------------------------------*  19380000
177300 2560-SELECT-FOB-CDE.                                             19390000
177400                                                                  19400000
177410*    ***  PRB44512 - START                                        19410005
177411*    ***  ADDED -811 RC TO THIS SELECT                            19420005
177412*    ***  PRB44512 - END                                          19430005
177420                                                                  19440005
177500     EXEC SQL                                                     19450000
177600         SELECT FOB_CDE                                           19460000
177700           INTO :IMFOB-FOB-CDE                                    19470000
177800           FROM TIMFOB                                            19480000
177900          WHERE FOB_STD_EDI_CDE = :IMCNTK-MOM-FOB-CDE             19490000
178000            AND STAT_CDE = 'A'                                    19500000
178100     END-EXEC.                                                    19510000
178200                                                                  19520000
178300     EVALUATE TRUE                                                19530000
178400         WHEN SQLCODE = ZERO                                      19540000
178410         WHEN SQLCODE = -811                                      19550005
178500             MOVE IMFOB-FOB-CDE TO TR044-FOB-CDE                  19560000
178600             CONTINUE                                             19570000
178700         WHEN SQLCODE = 100                                       19580000
178800             MOVE SPACES TO TR044-FOB-CDE                         19590000
178900             CONTINUE                                             19600000
179000         WHEN SQLWARN0 NOT = SPACES                               19610000
179100         WHEN SQLCODE < ZERO                                      19620000
179200         WHEN SQLCODE > ZERO                                      19630000
179300             MOVE '2560-SELECT-FOB-CDE'                           19640000
179400                             TO PV-PARAGRAPH-NAME                 19650000
179500             MOVE 'SELECT ON TIMFOB TABLE'                        19660000
179600                             TO PV-DB2-OPERATION-MESSAGE          19670000
179700             MOVE 'TIMFOB' TO PV-DB2-TABLE-NAME-1                 19680000
179800             PERFORM 9100-DB2-ABEND                               19690000
179900     END-EVALUATE.                                                19700000
180000*--------------------------------------------------------------*  19710000
180100* SELECT  POE CDE                                                 19720000
180200*--------------------------------------------------------------*  19730000
180300 2570-SELECT-POE-CDE.                                             19740000
180400                                                                  19750000
180500     EXEC SQL                                                     19760000
180600         SELECT POE_CDE                                           19770000
180700           INTO :IMPOE-POE-CDE                                    19780000
180800           FROM TIMPOE                                            19790000
180900          WHERE POE_STD_EDI_CDE = :IMCNTK-MOM-DEST-POE-CDE        19800000
181000            AND STAT_CDE = 'A'                                    19810000
181100     END-EXEC.                                                    19820000
181200                                                                  19830000
181300     EVALUATE TRUE                                                19840000
181400         WHEN SQLCODE = ZERO                                      19850000
181500             MOVE IMPOE-POE-CDE TO TR044-POE-CDE                  19860000
181600             CONTINUE                                             19870000
181700         WHEN SQLCODE = 100                                       19880000
181800             MOVE SPACES TO TR044-POE-CDE                         19890000
181900             CONTINUE                                             19900000
182000         WHEN SQLWARN0 NOT = SPACES                               19910000
182100         WHEN SQLCODE < ZERO                                      19920000
182200         WHEN SQLCODE > ZERO                                      19930000
182300             MOVE '2570-SELECT-POE-CDE'                           19940000
182400                             TO PV-PARAGRAPH-NAME                 19950000
182500             MOVE 'SELECT ON TIMPOE TABLE'                        19960000
182600                             TO PV-DB2-OPERATION-MESSAGE          19970000
182700             MOVE 'TIMPOE' TO PV-DB2-TABLE-NAME-1                 19980000
182800             PERFORM 9100-DB2-ABEND                               19990000
182900     END-EVALUATE.                                                20000000
183000*--------------------------------------------------------------*  20010000
183100* OPEN SEAL TABLE CURSOR                                          20020000
183200*--------------------------------------------------------------*  20030000
183300 2610-OPEN-SEAL-TABLE-CSR.                                        20040000
183400                                                                  20050000
183500     EXEC SQL                                                     20060000
183600          OPEN SEAL-TABLE-CSR                                     20070000
183700     END-EXEC.                                                    20080000
183800                                                                  20090000
183900     EVALUATE TRUE                                                20100000
184000         WHEN SQLCODE = ZERO                                      20110000
184100             CONTINUE                                             20120000
184200         WHEN SQLWARN0 NOT = SPACES                               20130000
184300         WHEN SQLCODE < ZERO                                      20140000
184400         WHEN SQLCODE > ZERO                                      20150000
184500             MOVE '2610-OPEN-SEAL-TABLE-CSR'                      20160000
184600                             TO PV-PARAGRAPH-NAME                 20170000
184700             MOVE 'ATTEMPTING TO OPEN THE SEAL-TABLE-CSR'         20180000
184800                             TO PV-DB2-OPERATION-MESSAGE          20190000
184900             MOVE 'TRT_IMPRT_SEAL'  TO PV-DB2-TABLE-NAME-1        20200000
185000             PERFORM 9100-DB2-ABEND                               20210000
185100     END-EVALUATE.                                                20220000
185200*--------------------------------------------------------------*  20230000
185300* PROCESS SEAL TABLE CURSOR                                       20240000
185400*--------------------------------------------------------------*  20250000
185500 2620-PROCESS-SEAL-TABLE-CSR.                                     20260000
185600                                                                  20270000
185700     PERFORM 2621-FETCH-SEAL-TABLE-CSR.                           20280000
185800                                                                  20290000
185900     IF NOT PS-END-OF-SEAL-CURSOR                                 20300000
186000        PERFORM 8050-WRITE-SEAL-TABLE-RECORD                      20310000
186100     END-IF.                                                      20320000
186200                                                                  20330000
186300*--------------------------------------------------------------*  20340000
186400* FETCH PO TABLE CURSOR                                           20350000
186500*--------------------------------------------------------------*  20360000
186600 2621-FETCH-SEAL-TABLE-CSR.                                       20370000
186700                                                                  20380000
186800     EXEC SQL                                                     20390000
186900         FETCH SEAL-TABLE-CSR                                     20400000
187000          INTO :TRT00006-CONTNR-ID                                20410000
187100              ,:TRT00006-CONTNR-SEQ-NBR                           20420000
187200              ,:TRT00006-CRE-TMST                                 20430000
187300              ,:TRT00006-LAST-UPD-TMST                            20440000
187400              ,:TRT00006-SEAL-NBR                                 20450000
187500     END-EXEC.                                                    20460000
187600                                                                  20470000
187700     EVALUATE TRUE                                                20480000
187800         WHEN SQLCODE = ZERO                                      20490000
187900               CONTINUE                                           20500000
188000         WHEN SQLCODE = +100                                      20510000
188100              SET PS-END-OF-SEAL-CURSOR TO TRUE                   20520000
188200         WHEN SQLWARN0 NOT = SPACES                               20530000
188300         WHEN SQLCODE < ZERO                                      20540000
188400         WHEN SQLCODE > ZERO                                      20550000
188500             MOVE '2621-FETCH-SEAL-TABLE-CSR'                     20560000
188600                                 TO PV-PARAGRAPH-NAME             20570000
188700             MOVE 'ERROR FETCHING WITH THE SEAL-TABLE-CSR'        20580000
188800                                 TO PV-DB2-OPERATION-MESSAGE      20590000
188900             MOVE 'TRT_IMPRT_SEAL'      TO PV-DB2-TABLE-NAME-1    20600000
189000             PERFORM 9100-DB2-ABEND                               20610000
189100     END-EVALUATE.                                                20620000
189200 EJECT                                                            20630000
189300                                                                  20640000
189400*--------------------------------------------------------------*  20650000
189500* CLOSE SEAL TABLE CURSOR                                         20660000
189600*--------------------------------------------------------------*  20670000
189700 2630-CLOSE-SEAL-TABLE-CSR.                                       20680000
189800                                                                  20690000
189900         EXEC SQL                                                 20700000
190000              CLOSE SEAL-TABLE-CSR                                20710000
190100         END-EXEC.                                                20720000
190200                                                                  20730000
190300     SET PS-NOT-END-OF-SEAL-CURSOR TO TRUE                        20740000
190400                                                                  20750000
190500     EVALUATE TRUE                                                20760000
190600         WHEN SQLCODE = ZERO                                      20770000
190700             CONTINUE                                             20780000
190800         WHEN SQLWARN0 NOT = SPACES                               20790000
190900         WHEN SQLCODE < ZERO                                      20800000
191000         WHEN SQLCODE > ZERO                                      20810000
191100             MOVE '2630-CLOSE-SEAL-TABLE-CSR'                     20820000
191200                             TO PV-PARAGRAPH-NAME                 20830000
191300             MOVE 'ATTEMPTING TO CLOSE THE SEAL-TABLE-CSR'        20840000
191400                             TO PV-DB2-OPERATION-MESSAGE          20850000
191500             MOVE 'TRT_IMPRT_SEAL'  TO PV-DB2-TABLE-NAME-1        20860000
191600             PERFORM 9100-DB2-ABEND                               20870000
191700     END-EVALUATE.                                                20880000
191800*--------------------------------------------------------------*  20890000
191900* OPEN SHIP PO TABLE CURSOR.                                      20900000
192000*--------------------------------------------------------------*  20910000
192100 2710-OPEN-SHIP-PO-TABLE-CSR.                                     20920000
192200                                                                  20930000
192300     EXEC SQL                                                     20940000
192400          OPEN SHIP-PO-TABLE-CSR                                  20950000
192500     END-EXEC.                                                    20960000
192600                                                                  20970000
192700     EVALUATE TRUE                                                20980000
192800         WHEN SQLCODE = ZERO                                      20990000
192900             CONTINUE                                             21000000
193000         WHEN SQLWARN0 NOT = SPACES                               21010000
193100         WHEN SQLCODE < ZERO                                      21020000
193200         WHEN SQLCODE > ZERO                                      21030000
193300             MOVE '2710-OPEN-SHIP-PO-TABLE-CSR'                   21040000
193400                             TO PV-PARAGRAPH-NAME                 21050000
193500             MOVE 'ATTEMPTING TO OPEN THE SHIP-PO-TABLE-CSR'      21060000
193600                             TO PV-DB2-OPERATION-MESSAGE          21070000
193700             MOVE 'TSHPTPO'  TO PV-DB2-TABLE-NAME-1               21080000
193800             PERFORM 9100-DB2-ABEND                               21090000
193900     END-EVALUATE.                                                21100000
194000*--------------------------------------------------------------*  21110000
194100* PROCESS SHIP PO TABLE CURSOR                                    21120000
194200*--------------------------------------------------------------*  21130000
194300 2720-PROCESS-SHIP-PO-TABLE-CSR.                                  21140000
194400                                                                  21150000
194500     PERFORM 2721-FETCH-SHIP-PO-TABLE-CSR.                        21160000
194600                                                                  21170000
194700     IF NOT PS-END-OF-SHIP-PO-CURSOR                              21180000
194800        PERFORM 8060-WRITE-SHIP-PO-TABLE-REC                      21190000
194900        PERFORM 2810-OPEN-SHP-ST-TABLE-CSR                        21200000
195000        PERFORM 2820-PROCESS-SHP-ST-TABLE-CSR                     21210000
195100          UNTIL PS-END-OF-SHP-ST-CURSOR                           21220000
195200        PERFORM 2830-CLOSE-SHP-ST-TABLE-CSR                       21230000
195300        PERFORM 2910-OPEN-SHIP-TABLE-CSR                          21240000
195400        PERFORM 2920-PROCESS-SHIP-TABLE-CSR                       21250000
195500          UNTIL PS-END-OF-SHIP-CURSOR                             21260000
195600        PERFORM 2930-CLOSE-SHIP-TABLE-CSR                         21270000
195700     END-IF.                                                      21280000
195800                                                                  21290000
195900*--------------------------------------------------------------*  21300000
196000* FETCH SHIP PO TABLE CURSOR                                      21310000
196100*--------------------------------------------------------------*  21320000
196200 2721-FETCH-SHIP-PO-TABLE-CSR.                                    21330000
196300                                                                  21340000
196400     EXEC SQL                                                     21350000
196500         FETCH SHIP-PO-TABLE-CSR                                  21360000
196600          INTO :PKSLIP-CONTNR-ID                                  21370000
196700              ,:PKSLIP-OPER-UNT-ID                                21380000
196800              ,:PKSLIP-CRE-TMST                                   21390000
196900              ,:PKSLIP-CRE-UID                                    21400000
197000              ,:PV-SUM-AP-VERIFY-ITM-QTY:PV-NULL-IND              21410000
197100              ,:RECEIV-VERFYD-TMST                                21420000
197200              ,:SHPTPO-PO-NBR                                     21430000
197300              ,:SHPTPO-SHIPT-ID                                   21440000
197400              ,:SHPTPO-REC-SEQ-NBR                                21450000
197500     END-EXEC.                                                    21460000
197600                                                                  21470000
197700     EVALUATE TRUE                                                21480000
197800         WHEN SQLCODE = ZERO                                      21490000
197900               CONTINUE                                           21500000
198000         WHEN SQLCODE = +100                                      21510000
198100              SET PS-END-OF-SHIP-PO-CURSOR TO TRUE                21520000
198200         WHEN SQLWARN0 NOT = SPACES                               21530000
198300         WHEN SQLCODE < ZERO                                      21540000
198400         WHEN SQLCODE > ZERO                                      21550000
198500             MOVE '2721-FETCH-SHIP-PO-TABLE-CSR'                  21560000
198600                                 TO PV-PARAGRAPH-NAME             21570000
198700             MOVE 'ERROR FETCHING WITH THE SHIP-PO-TABLE-CSR'     21580000
198800                                 TO PV-DB2-OPERATION-MESSAGE      21590000
198900             MOVE 'TSHPTPO'      TO PV-DB2-TABLE-NAME-1           21600000
199000             PERFORM 9100-DB2-ABEND                               21610000
199100     END-EVALUATE.                                                21620000
199200 EJECT                                                            21630000
199300                                                                  21640000
199400*--------------------------------------------------------------*  21650000
199500* CLOSE SHIP PO TABLE CURSOR                                      21660000
199600*--------------------------------------------------------------*  21670000
199700 2730-CLOSE-SHIP-PO-TABLE-CSR.                                    21680000
199800                                                                  21690000
199900         EXEC SQL                                                 21700000
200000              CLOSE SHIP-PO-TABLE-CSR                             21710000
200100         END-EXEC.                                                21720000
200200                                                                  21730000
200300     SET PS-NOT-END-OF-SHIP-PO-CURSOR TO TRUE                     21740000
200400                                                                  21750000
200500     EVALUATE TRUE                                                21760000
200600         WHEN SQLCODE = ZERO                                      21770000
200700             CONTINUE                                             21780000
200800         WHEN SQLWARN0 NOT = SPACES                               21790000
200900         WHEN SQLCODE < ZERO                                      21800000
201000         WHEN SQLCODE > ZERO                                      21810000
201100             MOVE '2730-CLOSE-SHIP-PO-TABLE-CSR'                  21820000
201200                             TO PV-PARAGRAPH-NAME                 21830000
201300             MOVE 'ATTEMPTING TO CLOSE THE SHIP-PO-TABLE-CSR'     21840000
201400                             TO PV-DB2-OPERATION-MESSAGE          21850000
201500             MOVE 'TSHPTPO'  TO PV-DB2-TABLE-NAME-1               21860000
201600             PERFORM 9100-DB2-ABEND                               21870000
201700     END-EVALUATE.                                                21880000
201800*--------------------------------------------------------------*  21890000
201900* OPEN SHIP STATUS TABLE CURSOR.                                  21900000
202000*--------------------------------------------------------------*  21910000
202100 2810-OPEN-SHP-ST-TABLE-CSR.                                      21920000
202200                                                                  21930000
202300     EXEC SQL                                                     21940000
202400          OPEN SHP-ST-TABLE-CSR                                   21950000
202500     END-EXEC.                                                    21960000
202600                                                                  21970000
202700     EVALUATE TRUE                                                21980000
202800         WHEN SQLCODE = ZERO                                      21990000
202900             CONTINUE                                             22000000
203000         WHEN SQLWARN0 NOT = SPACES                               22010000
203100         WHEN SQLCODE < ZERO                                      22020000
203200         WHEN SQLCODE > ZERO                                      22030000
203300             MOVE '2810-OPEN-SHP-ST-TABLE-CSR'                    22040000
203400                             TO PV-PARAGRAPH-NAME                 22050000
203500             MOVE 'ATTEMPTING TO OPEN THE SHP-ST-TABLE-CSR'       22060000
203600                             TO PV-DB2-OPERATION-MESSAGE          22070000
203700             MOVE 'TSHIPST'  TO PV-DB2-TABLE-NAME-1               22080000
203800             PERFORM 9100-DB2-ABEND                               22090000
203900     END-EVALUATE.                                                22100000
204000*--------------------------------------------------------------*  22110000
204100* PROCESS SHIP STATUS TABLE CURSOR                                22120000
204200*--------------------------------------------------------------*  22130000
204300 2820-PROCESS-SHP-ST-TABLE-CSR.                                   22140000
204400                                                                  22150000
204500     PERFORM 2821-FETCH-SHP-ST-TABLE-CSR.                         22160000
204600                                                                  22170000
204700     IF NOT PS-END-OF-SHP-ST-CURSOR                               22180000
204800        PERFORM 8070-WRITE-SHP-ST-TABLE-RECORD                    22190000
204900     END-IF.                                                      22200000
205000                                                                  22210000
205100*--------------------------------------------------------------*  22220000
205200* FETCH SHIP STATUS TABLE CURSOR                                  22230000
205300*--------------------------------------------------------------*  22240000
205400 2821-FETCH-SHP-ST-TABLE-CSR.                                     22250000
205500                                                                  22260000
205600     EXEC SQL                                                     22270000
205700         FETCH SHP-ST-TABLE-CSR                                   22280000
205800          INTO :SHIPST-SHIPT-ID                                   22290000
205900              ,:SHIPST-STATUS-DTE                                 22300000
206000              ,:SHIPST-SHIPT-STATUS-CDE                           22310000
206100              ,:SHSTYP-DESC                                       22320000
206200     END-EXEC.                                                    22330000
206300                                                                  22340000
206400     EVALUATE TRUE                                                22350000
206500         WHEN SQLCODE = ZERO                                      22360000
P47386              IF SHIPST-SHIPT-STATUS-CDE = PC-AR                  22370046
P47386                MOVE SHIPST-STATUS-DTE(9:2) TO PV-DATE-DAY        22380043
P47386                MOVE SHIPST-STATUS-DTE(6:2) TO PV-DATE-MONTH      22390043
P47386                MOVE '/'                    TO PV-DATE-SLASH      22400043
P47386                MOVE PV-DATE                TO TR040-ATA          22410043
P47386              END-IF                                              22420043
206600              CONTINUE                                            22430043
206700         WHEN SQLCODE = +100                                      22440000
206800              SET PS-END-OF-SHP-ST-CURSOR TO TRUE                 22450000
206900         WHEN SQLWARN0 NOT = SPACES                               22460000
207000         WHEN SQLCODE < ZERO                                      22470000
207100         WHEN SQLCODE > ZERO                                      22480000
207200             MOVE '2821-FETCH-SHP-ST-TABLE-CSR'                   22490000
207300                                 TO PV-PARAGRAPH-NAME             22500000
207400             MOVE 'ERROR FETCHING WITH THE SHP-ST-TABLE-CSR'      22510000
207500                                 TO PV-DB2-OPERATION-MESSAGE      22520000
207600             MOVE 'TSHIPST'      TO PV-DB2-TABLE-NAME-1           22530000
207700             PERFORM 9100-DB2-ABEND                               22540000
207800     END-EVALUATE.                                                22550000
207900 EJECT                                                            22560000
208000                                                                  22570000
208100*--------------------------------------------------------------*  22580000
208200* CLOSE SHIP STATUS TABLE CURSOR                                  22590000
208300*--------------------------------------------------------------*  22600000
208400 2830-CLOSE-SHP-ST-TABLE-CSR.                                     22610000
208500                                                                  22620000
208600         EXEC SQL                                                 22630000
208700              CLOSE SHP-ST-TABLE-CSR                              22640000
208800         END-EXEC.                                                22650000
208900                                                                  22660000
209000     SET PS-NOT-END-OF-SHP-ST-CURSOR TO TRUE                      22670000
209100                                                                  22680000
209200     EVALUATE TRUE                                                22690000
209300         WHEN SQLCODE = ZERO                                      22700000
209400             CONTINUE                                             22710000
209500         WHEN SQLWARN0 NOT = SPACES                               22720000
209600         WHEN SQLCODE < ZERO                                      22730000
209700         WHEN SQLCODE > ZERO                                      22740000
209800             MOVE '2830-CLOSE-SHP-ST-TABLE-CSR'                   22750000
209900                             TO PV-PARAGRAPH-NAME                 22760000
210000             MOVE 'ATTEMPTING TO CLOSE THE SHP-ST-TABLE-CSR'      22770000
210100                             TO PV-DB2-OPERATION-MESSAGE          22780000
210200             MOVE 'TSHIPST'  TO PV-DB2-TABLE-NAME-1               22790000
210300             PERFORM 9100-DB2-ABEND                               22800000
210400     END-EVALUATE.                                                22810000
210500*--------------------------------------------------------------*  22820000
210600* OPEN SHIPMENT TABLE CURSOR.                                     22830000
210700*--------------------------------------------------------------*  22840000
210800 2910-OPEN-SHIP-TABLE-CSR.                                        22850000
210900                                                                  22860000
211000     EXEC SQL                                                     22870000
211100          OPEN SHIP-TABLE-CSR                                     22880000
211200     END-EXEC.                                                    22890000
211300                                                                  22900000
211400     EVALUATE TRUE                                                22910000
211500         WHEN SQLCODE = ZERO                                      22920000
211600             CONTINUE                                             22930000
211700         WHEN SQLWARN0 NOT = SPACES                               22940000
211800         WHEN SQLCODE < ZERO                                      22950000
211900         WHEN SQLCODE > ZERO                                      22960000
212000             MOVE '2910-OPEN-SHIP-TABLE-CSR'                      22970000
212100                             TO PV-PARAGRAPH-NAME                 22980000
212200             MOVE 'ATTEMPTING TO OPEN THE SHIP-TABLE-CSR'         22990000
212300                             TO PV-DB2-OPERATION-MESSAGE          23000000
212400             MOVE 'TSHIPMT'  TO PV-DB2-TABLE-NAME-1               23010000
212500             PERFORM 9100-DB2-ABEND                               23020000
212600     END-EVALUATE.                                                23030000
212700*--------------------------------------------------------------*  23040000
212800* PROCESS SHIPMENT TABLE CURSOR                                   23050000
212900*--------------------------------------------------------------*  23060000
213000 2920-PROCESS-SHIP-TABLE-CSR.                                     23070000
213100                                                                  23080000
213200     PERFORM 2921-FETCH-SHIP-TABLE-CSR.                           23090000
213300                                                                  23100000
213400     IF NOT PS-END-OF-SHIP-CURSOR                                 23110000
213500        PERFORM 8080-WRITE-SHIP-TABLE-RECORD                      23120000
213600        PERFORM 3010-OPEN-TRIP-TABLE-CSR                          23130000
213700        PERFORM 3020-PROCESS-TRIP-TABLE-CSR                       23140000
213800          UNTIL PS-END-OF-TRIP-CURSOR                             23150000
213900        PERFORM 3030-CLOSE-TRIP-TABLE-CSR                         23160000
214000     END-IF.                                                      23170000
214100                                                                  23180000
214200*--------------------------------------------------------------*  23190000
214300* FETCH SHIPMENT TABLE CURSOR                                     23200000
214400*--------------------------------------------------------------*  23210000
214500 2921-FETCH-SHIP-TABLE-CSR.                                       23220000
214600                                                                  23230000
214700     EXEC SQL                                                     23240000
214800         FETCH SHIP-TABLE-CSR                                     23250000
214900          INTO :SHIPMT-BOL-NBR                                    23260000
215000              ,:SHIPMT-PRO-NBR                                    23270000
215100              ,:SHIPMT-SHIPT-ID                                   23280000
215200              ,:SHIPMT-TRIP-ID                                    23290000
215300     END-EXEC.                                                    23300000
215400                                                                  23310000
215500     EVALUATE TRUE                                                23320000
215600         WHEN SQLCODE = ZERO                                      23330000
215700               CONTINUE                                           23340000
215800         WHEN SQLCODE = +100                                      23350000
215900              SET PS-END-OF-SHIP-CURSOR TO TRUE                   23360000
216000         WHEN SQLWARN0 NOT = SPACES                               23370000
216100         WHEN SQLCODE < ZERO                                      23380000
216200         WHEN SQLCODE > ZERO                                      23390000
216300             MOVE '2921-FETCH-SHIP-TABLE-CSR'                     23400000
216400                                 TO PV-PARAGRAPH-NAME             23410000
216500             MOVE 'ERROR FETCHING WITH THE SHIP-TABLE-CSR'        23420000
216600                                 TO PV-DB2-OPERATION-MESSAGE      23430000
216700             MOVE 'TSHIPMT'      TO PV-DB2-TABLE-NAME-1           23440000
216800             PERFORM 9100-DB2-ABEND                               23450000
216900     END-EVALUATE.                                                23460000
217000 EJECT                                                            23470000
217100                                                                  23480000
217200*--------------------------------------------------------------*  23490000
217300* CLOSE SHIPMENT TABLE CURSOR                                     23500000
217400*--------------------------------------------------------------*  23510000
217500 2930-CLOSE-SHIP-TABLE-CSR.                                       23520000
217600                                                                  23530000
217700         EXEC SQL                                                 23540000
217800              CLOSE SHIP-TABLE-CSR                                23550000
217900         END-EXEC.                                                23560000
218000                                                                  23570000
218100     SET PS-NOT-END-OF-SHIP-CURSOR TO TRUE                        23580000
218200                                                                  23590000
218300     EVALUATE TRUE                                                23600000
218400         WHEN SQLCODE = ZERO                                      23610000
218500             CONTINUE                                             23620000
218600         WHEN SQLWARN0 NOT = SPACES                               23630000
218700         WHEN SQLCODE < ZERO                                      23640000
218800         WHEN SQLCODE > ZERO                                      23650000
218900             MOVE '2930-CLOSE-SHIP-TABLE-CSR'                     23660000
219000                             TO PV-PARAGRAPH-NAME                 23670000
219100             MOVE 'ATTEMPTING TO CLOSE THE SHIP-TABLE-CSR'        23680000
219200                             TO PV-DB2-OPERATION-MESSAGE          23690000
219300             MOVE 'TSHIPMT'  TO PV-DB2-TABLE-NAME-1               23700000
219400             PERFORM 9100-DB2-ABEND                               23710000
219500     END-EVALUATE.                                                23720000
219600*--------------------------------------------------------------*  23730000
219700* OPEN TRIP TABLE CURSOR.                                         23740000
219800*--------------------------------------------------------------*  23750000
219900 3010-OPEN-TRIP-TABLE-CSR.                                        23760000
220000                                                                  23770000
220100     EXEC SQL                                                     23780000
220200          OPEN TRIP-TABLE-CSR                                     23790000
220300     END-EXEC.                                                    23800000
220400                                                                  23810000
220500     EVALUATE TRUE                                                23820000
220600         WHEN SQLCODE = ZERO                                      23830000
220700             CONTINUE                                             23840000
220800         WHEN SQLWARN0 NOT = SPACES                               23850000
220900         WHEN SQLCODE < ZERO                                      23860000
221000         WHEN SQLCODE > ZERO                                      23870000
221100             MOVE '3010-OPEN-TRIP-TABLE-CSR'                      23880000
221200                             TO PV-PARAGRAPH-NAME                 23890000
221300             MOVE 'ATTEMPTING TO OPEN THE TRIP-TABLE-CSR'         23900000
221400                             TO PV-DB2-OPERATION-MESSAGE          23910000
221500             MOVE 'TVHTRIP'  TO PV-DB2-TABLE-NAME-1               23920000
221600             PERFORM 9100-DB2-ABEND                               23930000
221700     END-EVALUATE.                                                23940000
221800*--------------------------------------------------------------*  23950000
221900* PROCESS TRIP TABLE CURSOR                                       23960000
222000*--------------------------------------------------------------*  23970000
222100 3020-PROCESS-TRIP-TABLE-CSR.                                     23980000
222200                                                                  23990000
222300     PERFORM 3021-FETCH-TRIP-TABLE-CSR.                           24000000
222400                                                                  24010000
222500     IF NOT PS-END-OF-TRIP-CURSOR                                 24020000
222600        PERFORM 8090-WRITE-TRIP-TABLE-RECORD                      24030000
222700     END-IF.                                                      24040000
222800                                                                  24050000
222900*--------------------------------------------------------------*  24060000
223000* FETCH TRIP TABLE CURSOR                                         24070000
223100*--------------------------------------------------------------*  24080000
223200 3021-FETCH-TRIP-TABLE-CSR.                                       24090000
223300                                                                  24100000
223400     EXEC SQL                                                     24110000
223500         FETCH TRIP-TABLE-CSR                                     24120000
223600          INTO :VHTRIP-EST-AR-TMST:PV-NULL-IND                    24130000
223700              ,:VHTRIP-OWNER-SCAC-ID                              24140000
223800              ,:VHTRIP-TRIP-ID                                    24150000
223900              ,:VHTRIP-VEH-NBR:PV-VHTRIP-VEH-NBR-NULL             24160000
224000     END-EXEC.                                                    24170000
224100                                                                  24180000
224200     EVALUATE TRUE                                                24190000
224300         WHEN SQLCODE = ZERO                                      24200000
224400              IF PV-VHTRIP-VEH-NBR-NULL = PC-NEG-1                24210000
224500                  MOVE SPACES    TO VHTRIP-VEH-NBR                24220000
224600              END-IF                                              24230000
224700               CONTINUE                                           24240000
224800         WHEN SQLCODE = +100                                      24250000
224900              SET PS-END-OF-TRIP-CURSOR TO TRUE                   24260000
225000         WHEN SQLWARN0 NOT = SPACES                               24270000
225100         WHEN SQLCODE < ZERO                                      24280000
225200         WHEN SQLCODE > ZERO                                      24290000
225300             MOVE '3021-FETCH-TRIP-TABLE-CSR'                     24300000
225400                                 TO PV-PARAGRAPH-NAME             24310000
225500             MOVE 'ERROR FETCHING WITH THE TRIP-TABLE-CSR'        24320000
225600                                 TO PV-DB2-OPERATION-MESSAGE      24330000
225700             MOVE 'TVHTRIP'      TO PV-DB2-TABLE-NAME-1           24340000
225800             PERFORM 9100-DB2-ABEND                               24350000
225900     END-EVALUATE.                                                24360000
226000 EJECT                                                            24370000
226100                                                                  24380000
226200*--------------------------------------------------------------*  24390000
226300* CLOSE TRIP TABLE CURSOR                                         24400000
226400*--------------------------------------------------------------*  24410000
226500 3030-CLOSE-TRIP-TABLE-CSR.                                       24420000
226600                                                                  24430000
226700         EXEC SQL                                                 24440000
226800              CLOSE TRIP-TABLE-CSR                                24450000
226900         END-EXEC.                                                24460000
227000                                                                  24470000
227100     SET PS-NOT-END-OF-TRIP-CURSOR TO TRUE                        24480000
227200                                                                  24490000
227300     EVALUATE TRUE                                                24500000
227400         WHEN SQLCODE = ZERO                                      24510000
227500             CONTINUE                                             24520000
227600         WHEN SQLWARN0 NOT = SPACES                               24530000
227700         WHEN SQLCODE < ZERO                                      24540000
227800         WHEN SQLCODE > ZERO                                      24550000
227900             MOVE '3030-CLOSE-TRIP-TABLE-CSR'                     24560000
228000                             TO PV-PARAGRAPH-NAME                 24570000
228100             MOVE 'ATTEMPTING TO CLOSE THE TRIP-TABLE-CSR'        24580000
228200                             TO PV-DB2-OPERATION-MESSAGE          24590000
228300             MOVE 'TVHTRIP'  TO PV-DB2-TABLE-NAME-1               24600000
228400             PERFORM 9100-DB2-ABEND                               24610000
228500     END-EVALUATE.                                                24620000
228600*--------------------------------------------------------------*  24630000
228700* OPEN BOOKING TABLE CURSOR.                                      24640000
228800*--------------------------------------------------------------*  24650000
228900 3110-OPEN-BOOKING-TABLE-CSR.                                     24660000
229000                                                                  24670000
229100     EXEC SQL                                                     24680000
229200          OPEN BOOKING-TABLE-CSR                                  24690000
229300     END-EXEC.                                                    24700000
229400                                                                  24710000
229500     EVALUATE TRUE                                                24720000
229600         WHEN SQLCODE = ZERO                                      24730000
229700             CONTINUE                                             24740000
229800         WHEN SQLWARN0 NOT = SPACES                               24750000
229900         WHEN SQLCODE < ZERO                                      24760000
230000         WHEN SQLCODE > ZERO                                      24770000
230100             MOVE '3110-OPEN-BOOKING-TABLE-CSR'                   24780000
230200                             TO PV-PARAGRAPH-NAME                 24790000
230300             MOVE 'ATTEMPTING TO OPEN THE BOOKING-TABLE-CSR'      24800000
230400                             TO PV-DB2-OPERATION-MESSAGE          24810000
230500             MOVE 'TIMBKPO'  TO PV-DB2-TABLE-NAME-1               24820000
230600             PERFORM 9100-DB2-ABEND                               24830000
230700     END-EVALUATE.                                                24840000
230800*--------------------------------------------------------------*  24850000
230900* PROCESS BOOKING TABLE CURSOR                                    24860000
231000*--------------------------------------------------------------*  24870000
231100 3120-PROCESS-BOOKING-TABLE-CSR.                                  24880000
231200                                                                  24890000
231300     PERFORM 3121-FETCH-BOOKING-TABLE-CSR.                        24900000
231400                                                                  24910000
231500     IF NOT PS-END-OF-BOOKING-CURSOR                              24920000
231600        PERFORM 8100-WRITE-BOOKING-TABLE-REC                      24930000
231700     END-IF.                                                      24940000
231800                                                                  24950000
231900*--------------------------------------------------------------*  24960000
232000* FETCH BOOKING TABLE CURSOR                                      24970000
232100*--------------------------------------------------------------*  24980000
232200 3121-FETCH-BOOKING-TABLE-CSR.                                    24990000
232300                                                                  25000000
232400     EXEC SQL                                                     25010000
232500         FETCH BOOKING-TABLE-CSR                                  25020000
232600          INTO :IMBKPO-C-O-PROD-CDE                               25030000
232700              ,:IMBKPO-CONSLR-SCAC-ID                             25040000
232800              ,:IMBKPO-CRE-TMST                                   25050000
232900              ,:IMBKPO-DAT-SRC-ENT-ID                             25060000
233000              ,:IMBKPO-DEST-POE-CDE                               25070000
233100              ,:IMBKPO-DPRTR-TMST                                 25080000
233200              ,:IMBKPO-EST-LBD-NM                                 25090000
233300              ,:IMBKPO-EST-LBD-TMST                               25100000
233400              ,:IMBKPO-EXTL-REF-NBR                               25110000
233500              ,:IMBKPO-FOB-CDE                                    25120000
233600              ,:IMBKPO-IMPRT-VEH-NM                               25130000
233700              ,:IMBKPO-LAST-UPD-TMST                              25140000
233800              ,:IMBKPO-ORGN-SHPD-FR-CDE                           25150000
233900              ,:IMBKPO-PO-BKG-DELY-TMST                           25160000
234000              ,:IMBKPO-PO-CART-CNT                                25170000
234100              ,:IMBKPO-PO-CBMT-QTY                                25180000
234200              ,:IMBKPO-PO-NBR                                     25190000
234300              ,:IMBKPO-PO-UNT-QTY                                 25200000
234400              ,:IMBKPO-PO-WT-KGRM-QTY                             25210000
234500              ,:IMBKPO-PROD-FCTRY-NM                              25220000
234600              ,:IMBKPO-TRIP-TYP-CDE                               25230000
234700     END-EXEC.                                                    25240000
234800                                                                  25250000
234900     EVALUATE TRUE                                                25260000
235000         WHEN SQLCODE = ZERO                                      25270000
235100               CONTINUE                                           25280000
235200         WHEN SQLCODE = +100                                      25290000
235300              SET PS-END-OF-BOOKING-CURSOR TO TRUE                25300000
235400         WHEN SQLWARN0 NOT = SPACES                               25310000
235500         WHEN SQLCODE < ZERO                                      25320000
235600         WHEN SQLCODE > ZERO                                      25330000
235700             MOVE '3121-FETCH-BOOKING-TABLE-CSR'                  25340000
235800                                 TO PV-PARAGRAPH-NAME             25350000
235900             MOVE 'ERROR FETCHING WITH THE BOOKING-TABLE-CSR'     25360000
236000                                 TO PV-DB2-OPERATION-MESSAGE      25370000
236100             MOVE 'TIMBKPO'      TO PV-DB2-TABLE-NAME-1           25380000
236200             PERFORM 9100-DB2-ABEND                               25390000
236300     END-EVALUATE.                                                25400000
236400 EJECT                                                            25410000
236500                                                                  25420000
236600*--------------------------------------------------------------*  25430000
236700* CLOSE BOOKING TABLE CURSOR                                      25440000
236800*--------------------------------------------------------------*  25450000
236900 3130-CLOSE-BOOKING-TABLE-CSR.                                    25460000
237000                                                                  25470000
237100         EXEC SQL                                                 25480000
237200              CLOSE BOOKING-TABLE-CSR                             25490000
237300         END-EXEC.                                                25500000
237400                                                                  25510000
237500     SET PS-NOT-END-OF-BOOKING-CURSOR TO TRUE                     25520000
237600                                                                  25530000
237700     EVALUATE TRUE                                                25540000
237800         WHEN SQLCODE = ZERO                                      25550000
237900             CONTINUE                                             25560000
238000         WHEN SQLWARN0 NOT = SPACES                               25570000
238100         WHEN SQLCODE < ZERO                                      25580000
238200         WHEN SQLCODE > ZERO                                      25590000
238300             MOVE '310-CLOSE-BOOKING-TABLE-CSR'                   25600000
238400                             TO PV-PARAGRAPH-NAME                 25610000
238500             MOVE 'ATTEMPTING TO CLOSE THE BOOKING TABLE CSR'     25620000
238600                             TO PV-DB2-OPERATION-MESSAGE          25630000
238700             MOVE 'TIMBKPO'  TO PV-DB2-TABLE-NAME-1               25640000
238800             PERFORM 9100-DB2-ABEND                               25650000
238900     END-EVALUATE.                                                25660000
239000*--------------------------------------------------------------*  25670000
239100* OPEN RECEIVING TABLE CURSOR.                                    25680000
239200*--------------------------------------------------------------*  25690000
239300 3210-OPEN-REC-TABLE-CSR.                                         25700000
239400                                                                  25710000
239500     EXEC SQL                                                     25720000
239600          OPEN REC-TABLE-CSR                                      25730000
239700     END-EXEC.                                                    25740000
239800                                                                  25750000
239900     EVALUATE TRUE                                                25760000
240000         WHEN SQLCODE = ZERO                                      25770000
240100             CONTINUE                                             25780000
240200         WHEN SQLWARN0 NOT = SPACES                               25790000
240300         WHEN SQLCODE < ZERO                                      25800000
240400         WHEN SQLCODE > ZERO                                      25810000
240500             MOVE '3210-OPEN-REC-TABLE-CSR'                       25820000
240600                             TO PV-PARAGRAPH-NAME                 25830000
240700             MOVE 'ATTEMPTING TO OPEN THE REC-TABLE-CSR'          25840000
240800                             TO PV-DB2-OPERATION-MESSAGE          25850000
240900             MOVE 'TIMRCPO'  TO PV-DB2-TABLE-NAME-1               25860000
241000             PERFORM 9100-DB2-ABEND                               25870000
241100     END-EVALUATE.                                                25880000
241200*--------------------------------------------------------------*  25890000
241300* PROCESS RECEIVING TABLE CURSOR                                  25900000
241400*--------------------------------------------------------------*  25910000
241500 3220-PROCESS-REC-TABLE-CSR.                                      25920000
241600                                                                  25930000
241700     PERFORM 3221-FETCH-REC-TABLE-CSR.                            25940000
241800                                                                  25950000
241900     IF NOT PS-END-OF-REC-CURSOR                                  25960000
242000        PERFORM 8110-WRITE-REC-TABLE-REC                          25970000
242100     END-IF.                                                      25980000
242200                                                                  25990000
242300*--------------------------------------------------------------*  26000000
242400* FETCH RECEIVING TABLE CURSOR                                    26010000
242500*--------------------------------------------------------------*  26020000
242600 3221-FETCH-REC-TABLE-CSR.                                        26030000
242700                                                                  26040000
242800     EXEC SQL                                                     26050000
242900         FETCH REC-TABLE-CSR                                      26060000
243000          INTO :IMRCPO-C-O-PROD-CDE                               26070000
243100              ,:IMRCPO-CONSLR-SCAC-ID                             26080000
243200              ,:IMRCPO-CRE-TMST                                   26090000
243300              ,:IMRCPO-DAT-SRC-ENT-ID                             26100000
243400              ,:IMRCPO-DEST-POE-CDE                               26110000
243500              ,:IMRCPO-DPRTR-TMST                                 26120000
243600              ,:IMRCPO-EST-LBD-NM                                 26130000
243700              ,:IMRCPO-EST-LBD-TMST                               26140000
243800              ,:IMRCPO-EXTL-REF-NBR                               26150000
243900              ,:IMRCPO-FOB-CDE                                    26160000
244000              ,:IMRCPO-IMPRT-VEH-NM                               26170000
244100              ,:IMRCPO-LAST-UPD-TMST                              26180000
244200              ,:IMRCPO-ORGN-SHPD-FR-CDE                           26190000
244300              ,:IMRCPO-PO-CART-CNT                                26200000
244400              ,:IMRCPO-PO-CBMT-QTY                                26210000
244500              ,:IMRCPO-PO-NBR                                     26220000
244600              ,:IMRCPO-PO-RCVD-DELY-TMST                          26230000
244700              ,:IMRCPO-PO-UNT-QTY                                 26240000
244800              ,:IMRCPO-PO-WT-KGRM-QTY                             26250000
244900              ,:IMRCPO-PROD-FCTRY-NM                              26260000
245000              ,:IMRCPO-TRIP-TYP-CDE                               26270000
245100     END-EXEC.                                                    26280000
245200                                                                  26290000
245300     EVALUATE TRUE                                                26300000
245400         WHEN SQLCODE = ZERO                                      26310000
245500               CONTINUE                                           26320000
245600         WHEN SQLCODE = +100                                      26330000
245700              SET PS-END-OF-REC-CURSOR TO TRUE                    26340000
245800         WHEN SQLWARN0 NOT = SPACES                               26350000
245900         WHEN SQLCODE < ZERO                                      26360000
246000         WHEN SQLCODE > ZERO                                      26370000
246100             MOVE '3221-FETCH-REC-TABLE-CSR'                      26380000
246200                                 TO PV-PARAGRAPH-NAME             26390000
246300             MOVE 'ERROR FETCHING WITH THE REC-TABLE-CSR'         26400000
246400                                 TO PV-DB2-OPERATION-MESSAGE      26410000
246500             MOVE 'TIMRCPO'      TO PV-DB2-TABLE-NAME-1           26420000
246600             PERFORM 9100-DB2-ABEND                               26430000
246700     END-EVALUATE.                                                26440000
246800 EJECT                                                            26450000
246900                                                                  26460000
247000*--------------------------------------------------------------*  26470000
247100* CLOSE RECEIVING TABLE CURSOR                                    26480000
247200*--------------------------------------------------------------*  26490000
247300 3230-CLOSE-REC-TABLE-CSR.                                        26500000
247400                                                                  26510000
247500         EXEC SQL                                                 26520000
247600              CLOSE REC-TABLE-CSR                                 26530000
247700         END-EXEC.                                                26540000
247800                                                                  26550000
247900     SET PS-NOT-END-OF-REC-CURSOR TO TRUE                         26560000
248000                                                                  26570000
248100     EVALUATE TRUE                                                26580000
248200         WHEN SQLCODE = ZERO                                      26590000
248300             CONTINUE                                             26600000
248400         WHEN SQLWARN0 NOT = SPACES                               26610000
248500         WHEN SQLCODE < ZERO                                      26620000
248600         WHEN SQLCODE > ZERO                                      26630000
248700             MOVE '3230-CLOSE-REC-TABLE-CSR'                      26640000
248800                             TO PV-PARAGRAPH-NAME                 26650000
248900             MOVE 'ATTEMPTING TO CLOSE THE REC TABLE CSR'         26660000
249000                             TO PV-DB2-OPERATION-MESSAGE          26670000
249100             MOVE 'TIMRCPO'  TO PV-DB2-TABLE-NAME-1               26680000
249200             PERFORM 9100-DB2-ABEND                               26690000
249300     END-EVALUATE.                                                26700000
249400*--------------------------------------------------------------*  26710000
249500* OPEN CUSTOMS ENTRY PO TABLE CURSOR.                             26720000
249600*--------------------------------------------------------------*  26730000
249700 3310-OPEN-CE-PO-TABLE-CSR.                                       26740000
249800                                                                  26750000
249900     EXEC SQL                                                     26760000
250000          OPEN CE-PO-TABLE-CSR                                    26770000
250100     END-EXEC.                                                    26780000
250200                                                                  26790000
250300     EVALUATE TRUE                                                26800000
250400         WHEN SQLCODE = ZERO                                      26810000
250500             CONTINUE                                             26820000
250600         WHEN SQLWARN0 NOT = SPACES                               26830000
250700         WHEN SQLCODE < ZERO                                      26840000
250800         WHEN SQLCODE > ZERO                                      26850000
250900             MOVE '3310-OPEN-CE-PO-TABLE-CSR'                     26860000
251000                             TO PV-PARAGRAPH-NAME                 26870000
251100             MOVE 'ATTEMPTING TO OPEN THE CE-PO-TABLE-CSR'        26880000
251200                             TO PV-DB2-OPERATION-MESSAGE          26890000
251300             MOVE 'TIMCSPO'  TO PV-DB2-TABLE-NAME-1               26900000
251400             PERFORM 9100-DB2-ABEND                               26910000
251500     END-EVALUATE.                                                26920000
251600                                                                  26930000
251700*--------------------------------------------------------------*  26940000
251800* PROCESS CUSTOMS ENTRY PO TABLE CURSOR                           26950000
251900*--------------------------------------------------------------*  26960000
252000 3320-PROCESS-CE-PO-TABLE-CSR.                                    26970000
252100                                                                  26980000
252200     PERFORM 3321-FETCH-CE-PO-TABLE-CSR.                          26990000
252300                                                                  27000000
252400     IF NOT PS-END-OF-CE-PO-CURSOR                                27010000
252500        PERFORM 8120-WRITE-CE-PO-TABLE-REC                        27020000
252600                                                                  27030000
252700        PERFORM 3410-OPEN-CE-TABLE-CSR                            27040000
252800        PERFORM 3420-PROCESS-CE-TABLE-CSR                         27050000
252900          UNTIL PS-END-OF-CE-CURSOR                               27060000
253000        PERFORM 3430-CLOSE-CE-TABLE-CSR                           27070000
253100                                                                  27080000
253200        PERFORM 3510-OPEN-CSCN-TABLE-CSR                          27090000
253300        PERFORM 3520-PROCESS-CSCN-TABLE-CSR                       27100000
253400          UNTIL PS-END-OF-CSCN-CURSOR                             27110000
253500        PERFORM 3530-CLOSE-CSCN-TABLE-CSR                         27120000
253600     END-IF.                                                      27130000
253700                                                                  27140000
253800*--------------------------------------------------------------*  27150000
253900* FETCH CUSTOMS ENTRY PO TABLE CURSOR                             27160000
254000*--------------------------------------------------------------*  27170000
254100 3321-FETCH-CE-PO-TABLE-CSR.                                      27180000
254200                                                                  27190000
254300     EXEC SQL                                                     27200000
254400         FETCH CE-PO-TABLE-CSR                                    27210000
254500          INTO :IMCSPO-CSTM-ENTR-ID                               27220000
254600              ,:IMCSPO-PO-NBR                                     27230000
254700              ,:IMCSPO-CRE-TMST                                   27240000
254800              ,:IMCSPO-LAST-UPD-TMST                              27250000
254900              ,:IMCSPO-EXTL-REF-NBR                               27260000
255000     END-EXEC.                                                    27270000
255100                                                                  27280000
255200     EVALUATE TRUE                                                27290000
255300         WHEN SQLCODE = ZERO                                      27300000
255400               CONTINUE                                           27310000
255500         WHEN SQLCODE = +100                                      27320000
255600              SET PS-END-OF-CE-PO-CURSOR TO TRUE                  27330000
255700         WHEN SQLWARN0 NOT = SPACES                               27340000
255800         WHEN SQLCODE < ZERO                                      27350000
255900         WHEN SQLCODE > ZERO                                      27360000
256000             MOVE '3321-FETCH-CE-PO-TABLE-CSR'                    27370000
256100                                 TO PV-PARAGRAPH-NAME             27380000
256200             MOVE 'ERROR FETCHING WITH THE CE-PO-TABLE-CSR'       27390000
256300                                 TO PV-DB2-OPERATION-MESSAGE      27400000
256400             MOVE 'TIMCSPO'      TO PV-DB2-TABLE-NAME-1           27410000
256500             PERFORM 9100-DB2-ABEND                               27420000
256600     END-EVALUATE.                                                27430000
256700 EJECT                                                            27440000
256800                                                                  27450000
256900*--------------------------------------------------------------*  27460000
257000* CLOSE CUSTOMS ENTRY PO TABLE CURSOR                             27470000
257100*--------------------------------------------------------------*  27480000
257200 3330-CLOSE-CE-PO-TABLE-CSR.                                      27490000
257300                                                                  27500000
257400         EXEC SQL                                                 27510000
257500              CLOSE CE-PO-TABLE-CSR                               27520000
257600         END-EXEC.                                                27530000
257700                                                                  27540000
257800     SET PS-NOT-END-OF-CE-PO-CURSOR TO TRUE                       27550000
257900                                                                  27560000
258000     EVALUATE TRUE                                                27570000
258100         WHEN SQLCODE = ZERO                                      27580000
258200             CONTINUE                                             27590000
258300         WHEN SQLWARN0 NOT = SPACES                               27600000
258400         WHEN SQLCODE < ZERO                                      27610000
258500         WHEN SQLCODE > ZERO                                      27620000
258600             MOVE '3330-CLOSE-CE-PO-TABLE-CSR'                    27630000
258700                             TO PV-PARAGRAPH-NAME                 27640000
258800             MOVE 'ATTEMPTING TO CLOSE THE CE PO TABLE CSR'       27650000
258900                             TO PV-DB2-OPERATION-MESSAGE          27660000
259000             MOVE 'TIMCSPO'  TO PV-DB2-TABLE-NAME-1               27670000
259100             PERFORM 9100-DB2-ABEND                               27680000
259200     END-EVALUATE.                                                27690000
259300*--------------------------------------------------------------*  27700000
259400* OPEN CUSTOMS ENTRY TABLE CURSOR.                                27710000
259500*--------------------------------------------------------------*  27720000
259600 3410-OPEN-CE-TABLE-CSR.                                          27730000
259700                                                                  27740000
259800     EXEC SQL                                                     27750000
259900          OPEN CE-TABLE-CSR                                       27760000
260000     END-EXEC.                                                    27770000
260100                                                                  27780000
260200     EVALUATE TRUE                                                27790000
260300         WHEN SQLCODE = ZERO                                      27800000
260400             CONTINUE                                             27810000
260500         WHEN SQLWARN0 NOT = SPACES                               27820000
260600         WHEN SQLCODE < ZERO                                      27830000
260700         WHEN SQLCODE > ZERO                                      27840000
260800             MOVE '3410-OPEN-CE-TABLE-CSR'                        27850000
260900                             TO PV-PARAGRAPH-NAME                 27860000
261000             MOVE 'ATTEMPTING TO OPEN THE CE-TABLE-CSR'           27870000
261100                             TO PV-DB2-OPERATION-MESSAGE          27880000
261200             MOVE 'TIMCSEN'  TO PV-DB2-TABLE-NAME-1               27890000
261300             PERFORM 9100-DB2-ABEND                               27900000
261400     END-EVALUATE.                                                27910000
261500*--------------------------------------------------------------*  27920000
261600* PROCESS CUSTOMS ENTRY TABLE CURSOR                              27930000
261700*--------------------------------------------------------------*  27940000
261800 3420-PROCESS-CE-TABLE-CSR.                                       27950000
261900                                                                  27960000
262000     PERFORM 3421-FETCH-CE-TABLE-CSR.                             27970000
262100                                                                  27980000
262200     IF NOT PS-END-OF-CE-CURSOR                                   27990000
262300        PERFORM 8220-WRITE-CE-TABLE-REC                           28000000
262400     END-IF.                                                      28010000
262500                                                                  28020000
262600*--------------------------------------------------------------*  28030000
262700* FETCH CUSTOMS ENTRY TABLE CURSOR                                28040000
262800*--------------------------------------------------------------*  28050000
262900 3421-FETCH-CE-TABLE-CSR.                                         28060000
263000                                                                  28070000
263100     EXEC SQL                                                     28080000
263200         FETCH CE-TABLE-CSR                                       28090000
263300          INTO :IMCSEN-ACTL-CLR-TMST                              28100000
263400              ,:IMCSEN-BKR-REF-NBR                                28110000
263500              ,:IMCSEN-CRE-TMST                                   28120000
263600              ,:IMCSEN-CSTM-ENTR-ID                               28130000
263700              ,:IMCSEN-DAT-SRC-ENT-ID                             28140000
263800              ,:IMCSEN-ENT-ID                                     28150000
263900              ,:IMCSEN-ENTR-TYP-CDE                               28160000
264000              ,:IMCSEN-EST-CLR-TMST                               28170000
264100              ,:IMCSEN-EXM-TMST                                   28180000
264200              ,:IMCSEN-FILD-TMST                                  28190000
264300              ,:IMCSEN-LAST-UPD-TMST                              28200000
264400              ,:IMCSEN-LQDN-SSPNN-TMST                            28210000
264500              ,:IMCSEN-LQDN-TMST                                  28220000
264600              ,:IMCSEN-MOM-DEST-POE-CDE                           28230000
264700              ,:IMCSEN-MOM-TRIP-TYP-CDE                           28240000
264800              ,:IMCSEN-REJ-TMST                                   28250000
264900     END-EXEC.                                                    28260000
265000                                                                  28270000
265100     EVALUATE TRUE                                                28280000
265200         WHEN SQLCODE = ZERO                                      28290000
265300               CONTINUE                                           28300000
265400         WHEN SQLCODE = +100                                      28310000
265500              SET PS-END-OF-CE-CURSOR TO TRUE                     28320000
265600         WHEN SQLWARN0 NOT = SPACES                               28330000
265700         WHEN SQLCODE < ZERO                                      28340000
265800         WHEN SQLCODE > ZERO                                      28350000
265900             MOVE '3421-FETCH-CE-TABLE-CSR'                       28360000
266000                                 TO PV-PARAGRAPH-NAME             28370000
266100             MOVE 'ERROR FETCHING WITH THE CE-TABLE-CSR'          28380000
266200                                 TO PV-DB2-OPERATION-MESSAGE      28390000
266300             MOVE 'TIMCSEN'      TO PV-DB2-TABLE-NAME-1           28400000
266400             PERFORM 9100-DB2-ABEND                               28410000
266500     END-EVALUATE.                                                28420000
266600 EJECT                                                            28430000
266700                                                                  28440000
266800*--------------------------------------------------------------*  28450000
266900* CLOSE CUSTOMS ENTRY TABLE CURSOR                                28460000
267000*--------------------------------------------------------------*  28470000
267100 3430-CLOSE-CE-TABLE-CSR.                                         28480000
267200                                                                  28490000
267300         EXEC SQL                                                 28500000
267400              CLOSE CE-TABLE-CSR                                  28510000
267500         END-EXEC.                                                28520000
267600                                                                  28530000
267700     SET PS-NOT-END-OF-CE-CURSOR TO TRUE                          28540000
267800                                                                  28550000
267900     EVALUATE TRUE                                                28560000
268000         WHEN SQLCODE = ZERO                                      28570000
268100             CONTINUE                                             28580000
268200         WHEN SQLWARN0 NOT = SPACES                               28590000
268300         WHEN SQLCODE < ZERO                                      28600000
268400         WHEN SQLCODE > ZERO                                      28610000
268500             MOVE '3430-CLOSE-CE-TABLE-CSR'                       28620000
268600                             TO PV-PARAGRAPH-NAME                 28630000
268700             MOVE 'ATTEMPTING TO CLOSE THE CE TABLE CSR'          28640000
268800                             TO PV-DB2-OPERATION-MESSAGE          28650000
268900             MOVE 'TIMCSEN'  TO PV-DB2-TABLE-NAME-1               28660000
269000             PERFORM 9100-DB2-ABEND                               28670000
269100     END-EVALUATE.                                                28680000
269200*--------------------------------------------------------------*  28690000
269300* OPEN CUSTOMS CONTAINER TABLE CURSOR.                            28700000
269400*--------------------------------------------------------------*  28710000
269500 3510-OPEN-CSCN-TABLE-CSR.                                        28720000
269600                                                                  28730000
269700     EXEC SQL                                                     28740000
269800          OPEN CSCN-TABLE-CSR                                     28750000
269900     END-EXEC.                                                    28760000
270000                                                                  28770000
270100     EVALUATE TRUE                                                28780000
270200         WHEN SQLCODE = ZERO                                      28790000
270300             CONTINUE                                             28800000
270400         WHEN SQLWARN0 NOT = SPACES                               28810000
270500         WHEN SQLCODE < ZERO                                      28820000
270600         WHEN SQLCODE > ZERO                                      28830000
270700             MOVE '3510-OPEN-CSCN-TABLE-CSR'                      28840000
270800                             TO PV-PARAGRAPH-NAME                 28850000
270900             MOVE 'ATTEMPTING TO OPEN THE CSCN-TABLE-CSR'         28860000
271000                             TO PV-DB2-OPERATION-MESSAGE          28870000
271100             MOVE 'TIMCSCN'  TO PV-DB2-TABLE-NAME-1               28880000
271200             PERFORM 9100-DB2-ABEND                               28890000
271300     END-EVALUATE.                                                28900000
271400                                                                  28910000
271500*--------------------------------------------------------------*  28920000
271600* PROCESS CUSTOMS CONTAINER TABLE CURSOR                          28930000
271700*--------------------------------------------------------------*  28940000
271800 3520-PROCESS-CSCN-TABLE-CSR.                                     28950000
271900                                                                  28960000
272000     PERFORM 3521-FETCH-CSCN-TABLE-CSR.                           28970000
272100                                                                  28980000
272200     IF NOT PS-END-OF-CSCN-CURSOR                                 28990000
272300        PERFORM 8230-WRITE-CSCN-TABLE-REC                         29000000
272400     END-IF.                                                      29010000
272500                                                                  29020000
272600*--------------------------------------------------------------*  29030000
272700* FETCH CUSTOMS CONTAINER TABLE CURSOR                            29040000
272800*--------------------------------------------------------------*  29050000
272900 3521-FETCH-CSCN-TABLE-CSR.                                       29060000
273000                                                                  29070000
273100     EXEC SQL                                                     29080000
273200         FETCH CSCN-TABLE-CSR                                     29090000
273300          INTO :IMCSCN-CSTM-ENTR-ID                               29100000
273400              ,:IMCSCN-CONTNR-ID                                  29110000
273500              ,:IMCSCN-CRE-BY-USR-ID                              29120000
273600              ,:IMCSCN-CRE-TMST                                   29130000
273700              ,:IMCSCN-LAST-UPD-BY-USR-ID                         29140000
273800              ,:IMCSCN-LAST-UPD-TMST                              29150000
273900              ,:IMCSCN-DO-TO-DCONSLR-TMST                         29160000
274000     END-EXEC.                                                    29170000
274100                                                                  29180000
274200     EVALUATE TRUE                                                29190000
274300         WHEN SQLCODE = ZERO                                      29200000
274400               CONTINUE                                           29210000
274500         WHEN SQLCODE = +100                                      29220000
274600              SET PS-END-OF-CSCN-CURSOR TO TRUE                   29230000
274700         WHEN SQLWARN0 NOT = SPACES                               29240000
274800         WHEN SQLCODE < ZERO                                      29250000
274900         WHEN SQLCODE > ZERO                                      29260000
275000             MOVE '3521-FETCH-CSCN-TABLE-CSR'                     29270000
275100                                 TO PV-PARAGRAPH-NAME             29280000
275200             MOVE 'ERROR FETCHING WITH THE CSCN-TABLE-CSR'        29290000
275300                                 TO PV-DB2-OPERATION-MESSAGE      29300000
275400             MOVE 'TIMCSCN'      TO PV-DB2-TABLE-NAME-1           29310000
275500             PERFORM 9100-DB2-ABEND                               29320000
275600     END-EVALUATE.                                                29330000
275700 EJECT                                                            29340000
275800                                                                  29350000
275900*--------------------------------------------------------------*  29360000
276000* CLOSE CUSTOMS CONTAINER TABLE CURSOR                            29370000
276100*--------------------------------------------------------------*  29380000
276200 3530-CLOSE-CSCN-TABLE-CSR.                                       29390000
276300                                                                  29400000
276400         EXEC SQL                                                 29410000
276500              CLOSE CSCN-TABLE-CSR                                29420000
276600         END-EXEC.                                                29430000
276700                                                                  29440000
276800     SET PS-NOT-END-OF-CSCN-CURSOR TO TRUE                        29450000
276900                                                                  29460000
277000     EVALUATE TRUE                                                29470000
277100         WHEN SQLCODE = ZERO                                      29480000
277200             CONTINUE                                             29490000
277300         WHEN SQLWARN0 NOT = SPACES                               29500000
277400         WHEN SQLCODE < ZERO                                      29510000
277500         WHEN SQLCODE > ZERO                                      29520000
277600             MOVE '3530-CLOSE-CSCN-TABLE-CSR'                     29530000
277700                             TO PV-PARAGRAPH-NAME                 29540000
277800             MOVE 'ATTEMPTING TO CLOSE THE CE TABLE CSR'          29550000
277900                             TO PV-DB2-OPERATION-MESSAGE          29560000
278000             MOVE 'TIMCSCN'  TO PV-DB2-TABLE-NAME-1               29570000
278100             PERFORM 9100-DB2-ABEND                               29580000
278200     END-EVALUATE.                                                29590000
278300                                                                  29600000
278301* PRB44512 - START                                                29610003
278302*----------------------------------------------------------------*29620003
278303* OPEN IMPORTS CONTAINER UPC CURSOR                               29630003
278304*----------------------------------------------------------------*29640003
278320 3600-OPEN-TIMCNUP-TABLE-CSR.                                     29650003
278321                                                                  29660003
278322     EXEC SQL                                                     29670003
278323          OPEN TIMCNUP-TABLE-CSR                                  29680003
278324     END-EXEC.                                                    29690003
278325                                                                  29700003
278326     EVALUATE TRUE                                                29710003
278327         WHEN SQLCODE = ZERO                                      29720003
278328             CONTINUE                                             29730003
278329         WHEN SQLWARN0 NOT = SPACES                               29740003
278330         WHEN SQLCODE < ZERO                                      29750003
278331         WHEN SQLCODE > ZERO                                      29760003
278332             MOVE '3600-OPEN-TIMCNUP-TABLE-CSR'                   29770003
278333                             TO PV-PARAGRAPH-NAME                 29780003
278334             MOVE 'ATTEMPTING TO OPEN THE TIMCNUP-TABLE-CSR'      29790003
278335                             TO PV-DB2-OPERATION-MESSAGE          29800003
278336             MOVE 'TIMCNUP'  TO PV-DB2-TABLE-NAME-1               29810003
278337             MOVE PV-PO-NBR      TO PV-PO-NBR-DISP                29820004
278338             MOVE IMCNPO-CONTNR-ID                                29830004
278339                                 TO PV-CONTNR-ID                  29840004
278340             MOVE IMCNPO-CONTNR-SEQ-NBR                           29850004
278341                                 TO PV-CONTNR-SEQ-NBR-DISP        29860004
278342             PERFORM 9100-DB2-ABEND                               29870003
278343     END-EVALUATE.                                                29880003
278344                                                                  29890003
278345*----------------------------------------------------------------*29900003
278346* FETCH IMPORTS CONTAINER CURSOR ROW AND WRITE IT TO EXTRACT FILE 29910003
278347*----------------------------------------------------------------*29920003
278348 3610-PROCESS-TIMCNUP-TABLE-CSR.                                  29930003
278349                                                                  29940003
278350     PERFORM 3620-FETCH-TIMCNUP-TABLE-CSR.                        29950003
278351                                                                  29960003
278352     IF PS-END-OF-TIMCNUP-CURSOR                                  29970003
278353        CONTINUE                                                  29980003
278354     ELSE                                                         29990003
278355        PERFORM 4000-SELECT-CARTON-COUNT-SENT                     30000014
278356        PERFORM 8240-WRITE-TIMCNUP-TABLE-REC                      30010007
278357     END-IF.                                                      30020003
278358                                                                  30030003
278359*--------------------------------------------------------------*  30040003
278360* FETCH ROW FROM TIMCNUP TABLE CURSOR                             30050003
278361*--------------------------------------------------------------*  30060003
278362 3620-FETCH-TIMCNUP-TABLE-CSR.                                    30070003
278363                                                                  30080003
278364     EXEC SQL                                                     30090003
278365        FETCH TIMCNUP-TABLE-CSR                                   30100003
278366         INTO  :IMCNUP-CONTNR-ID                                  30110003
278367              ,:IMCNUP-CONTNR-SEQ-NBR                             30120003
278368              ,:IMCNUP-PO-NBR                                     30130003
278369              ,:IMCNUP-VS-NBR                                     30140003
278370              ,:IMCNUP-UPC-NBR                                    30150003
278371              ,:IMCNUP-PO-LNE-NBR                                 30160003
278372              ,:IMCNUP-UPC-CART-CNT                               30170003
278373              ,:IMCNUP-UPC-CBMT-QTY                               30180003
278374              ,:IMCNUP-UPC-WT-KGRM-QTY                            30190003
278375              ,:IMCNUP-UPC-UNT-QTY                                30200003
278376              ,:IMCNUP-SKU-NBR                                    30210003
278377              ,:IMCNUP-ASN-PKGNG-CDE                              30220003
278388     END-EXEC.                                                    30230003
278389                                                                  30240003
278390     EVALUATE TRUE                                                30250003
278391         WHEN SQLCODE = ZERO                                      30260003
278392               CONTINUE                                           30270003
278393         WHEN SQLCODE = +100                                      30280003
278394              SET PS-END-OF-TIMCNUP-CURSOR TO TRUE                30290003
278395         WHEN SQLWARN0 NOT = SPACES                               30300003
278396         WHEN SQLCODE < ZERO                                      30310003
278397         WHEN SQLCODE > ZERO                                      30320003
278398             MOVE '3620-FETCH-TIMCNUP-TABLE-CSR'                  30330003
278399                                 TO PV-PARAGRAPH-NAME             30340003
278400             MOVE 'TIMCNUP-TABLE-CSR'                             30350003
278401                                 TO PV-DB2-OPERATION-MESSAGE      30360003
278402             MOVE 'TIMCNUP'      TO PV-DB2-TABLE-NAME-1           30370003
278404             MOVE PV-PO-NBR      TO PV-PO-NBR-DISP                30380003
278405             MOVE IMCNPO-CONTNR-ID                                30390003
278406                                 TO PV-CONTNR-ID                  30400004
278407             MOVE IMCNPO-CONTNR-SEQ-NBR                           30410003
278408                                 TO PV-CONTNR-SEQ-NBR-DISP        30420004
278409             PERFORM 9100-DB2-ABEND                               30430003
278410     END-EVALUATE.                                                30440003
278411                                                                  30450003
278412*----------------------------------------------------------------*30460003
278413* CLOSE IMPORTS CONTAINER UPC CURSOR                              30470003
278414*----------------------------------------------------------------*30480003
278415 3690-CLOSE-TIMCNUP-TABLE-CSR.                                    30490003
278416                                                                  30500004
278417         EXEC SQL                                                 30510004
278418              CLOSE TIMCNUP-TABLE-CSR                             30520004
278419         END-EXEC.                                                30530004
278420                                                                  30540004
278421     SET PS-NOT-END-OF-TIMCNUP-CURSOR TO TRUE                     30550004
278422                                                                  30560004
278423     EVALUATE TRUE                                                30570004
278424         WHEN SQLCODE = ZERO                                      30580004
278425             CONTINUE                                             30590004
278426         WHEN SQLWARN0 NOT = SPACES                               30600004
278427         WHEN SQLCODE < ZERO                                      30610004
278428         WHEN SQLCODE > ZERO                                      30620004
278429             MOVE '3690-CLOSE-TIMCNUP-TABLE-CSR'                  30630004
278430                             TO PV-PARAGRAPH-NAME                 30640004
278431             MOVE 'ATTEMPTING TO CLOSE TIMCNUP CURSOR'            30650004
278432                             TO PV-DB2-OPERATION-MESSAGE          30660004
278433             MOVE 'TIMCNUP'  TO PV-DB2-TABLE-NAME-1               30670004
278434             MOVE PV-PO-NBR      TO PV-PO-NBR-DISP                30680004
278435             MOVE IMCNPO-CONTNR-ID                                30690004
278436                                 TO PV-CONTNR-ID                  30700004
278437             MOVE IMCNPO-CONTNR-SEQ-NBR                           30710004
278438                                 TO PV-CONTNR-SEQ-NBR-DISP        30720004
278439             PERFORM 9100-DB2-ABEND                               30730004
278440     END-EVALUATE.                                                30740004
278441                                                                  30750004
278442*                                                                 30760003
278443* PRB44512 - START                                                30770014
278450*----------------------------------------------------------------*30780003
278451* SELECT ACTUAL CARTON COUNT FOR THIS UPC                         30790013
278452*----------------------------------------------------------------*30800013
278453 4000-SELECT-CARTON-COUNT-SENT.                                   30810013
278454                                                                  30820013
278455         MOVE ZERO   TO PV-ACTUAL-CART-CNT.                       30830014
278456         EXEC SQL                                                 30840013
278457              SELECT COUNT(*)                                     30850014
278458                INTO :PV-ACTUAL-CART-CNT                          30860014
278459                FROM TRT_IMPRT_CART                               30870014
278460               WHERE CONTNR_ID      = :IMCNUP-CONTNR-ID           30880014
                       AND CONTNR_ID      <> 'TGHU8883402'              30881099
278461                 AND CONTNR_SEQ_NBR = :IMCNUP-CONTNR-SEQ-NBR      30890014
278462                 AND PO_NBR         = :IMCNUP-PO-NBR              30900014
278463                 AND UPC_NBR        = :IMCNUP-UPC-NBR             30910014
278469         END-EXEC.                                                30920013
278470                                                                  30930013
278471                                                                  30940013
278472     EVALUATE TRUE                                                30950013
278473         WHEN SQLCODE = ZERO                                      30960013
278474         WHEN SQLCODE = +100                                      30970013
278475             CONTINUE                                             30980013
278476         WHEN SQLWARN0 NOT = SPACES                               30990013
278477         WHEN SQLCODE < ZERO                                      31000013
278478         WHEN SQLCODE > ZERO                                      31010013
278479             MOVE '4000-SELECT-CARTON-COUNT-SENT'                 31020013
278480                             TO PV-PARAGRAPH-NAME                 31030013
278481             MOVE 'ATTEMPTING TO SELECT FROM TRT_IMPRT_CART'      31040013
278482                             TO PV-DB2-OPERATION-MESSAGE          31050013
278483             MOVE 'TIMCNUP'  TO PV-DB2-TABLE-NAME-1               31060013
278484             MOVE PV-PO-NBR      TO PV-PO-NBR-DISP                31070013
278485             MOVE IMCNPO-CONTNR-ID                                31080013
278486                                 TO PV-CONTNR-ID                  31090013
278487             MOVE IMCNPO-CONTNR-SEQ-NBR                           31100013
278488                                 TO PV-CONTNR-SEQ-NBR-DISP        31110013
278489             DISPLAY '*** IMCNUP-UPC-NBR = ' IMCNUP-UPC-NBR       31120014
278490             PERFORM 9100-DB2-ABEND                               31130013
278491     END-EVALUATE.                                                31140013
278492                                                                  31150013
278493* PRB44512 - END                                                  31160013
P47386*----------------------------------------------------------------*31170017
P47386* GET FIRST RECEIPT DATE AT DC                                    31180017
P47386*----------------------------------------------------------------*31190017
P47386 5000-SELECT-RECEIPT-DATE-INFO.                                   31200043
P47386                                                                  31210017
P47386     EXEC SQL                                                     31220017
P47386          SELECT MIN(VERFYD_TMST)                                 31230017
P47386            INTO :PV-MIN-VERFYD-TMST                              31240017
P47386          FROM TRECITM                                            31250017
P47386               WHERE ORD_NBR        = :PV-PO-NBR                  31260017
P47386               AND VER_STATUS_CDE   = 'A'                         31270017
P47386               AND VERFYD_TMST     ^= :PC-NULL-TMST               31280017
P47386     END-EXEC.                                                    31290017
P47386                                                                  31300047
P47386     EVALUATE TRUE                                                31310047
P47386         WHEN SQLCODE = +0                                        31320017
P47386             MOVE PV-MIN-VERFYD-TMST  TO PV-DB2-DATE              31330017
P47386             MOVE PV-DB2-DATE-MM      TO PV-DISPLAY-DATE-MM       31340017
P47386             MOVE PV-DB2-DATE-DD      TO PV-DISPLAY-DATE-DD       31350017
P47386             MOVE PV-DB2-DATE-YY      TO PV-DISPLAY-DATE-YY       31360017
P47386             MOVE PV-DISPLAY-DATE     TO TR040-FIRST-RCPT-DTE     31370017
P47386                                                                  31380017
P47386         WHEN SQLCODE = +100                                      31390017
P47386         WHEN SQLCODE = -305                                      31400017
P47386             MOVE SPACES              TO TR040-FIRST-RCPT-DTE     31410018
P47386                                                                  31420017
P47386         WHEN OTHER                                               31430023
P47386             MOVE '5000-SELECT-RECEIPT-DATE-INFO'                 31440043
P47386                                      TO PV-PARAGRAPH-NAME        31450018
P47386             MOVE 'ATTEMPTING TO SELECT RECEIPT DATE'             31460017
P47386                                      TO PV-DB2-OPERATION-MESSAGE 31470018
P47386             MOVE 'TRECITM'           TO PV-DB2-TABLE-NAME-1      31480018
P47386             MOVE PV-PO-NBR           TO PV-PO-NBR-DISP           31490018
P47386             DISPLAY '*** PURCHS PO-NBR = ' PV-PO-NBR-DISP        31500017
P47386             PERFORM 9100-DB2-ABEND                               31510017
P47386     END-EVALUATE.                                                31520017
P47386                                                                  31530017
P47386*----------------------------------------------------------------*31530151
P47386* GET OTB WEEK FOR THE PURCHASE ORDER                             31530251
P47386*----------------------------------------------------------------*31530351
P47386 5100-GET-WEEK-NBR.                                               31531051
P47386                                                                  31531151
P47386     MOVE PLNSHP-DONT-SHIP-BEF-DTE    TO POWS055-INPUT-DATE.      31532052
P47386     PERFORM POPD055-CALC-WEEKLY-OTB.                             31533051
P47386     IF POWS055-NO-ERROR                                          31534051
P47386           MOVE POWS055-OTB-FSCL-WEEK-NBR                         31535051
P47386                                      TO TR040-OTB-WEEK           31536052
P47386     ELSE                                                         31537051
P47386         MOVE '5100-GET-WEEK-NBR'     TO PV-PARAGRAPH-NAME        31538052
P47386         MOVE 'ATTEMPTING TO RETRIEVE OTB WEEK VALUE'             31539152
P47386                                      TO PV-DB2-OPERATION-MESSAGE 31539252
P47386         MOVE PV-PO-NBR               TO PV-PO-NBR-DISP           31539352
P47386         DISPLAY '*** PURCHS PO-NBR = ' PV-PO-NBR-DISP            31539452
P47386         PERFORM 9100-DB2-ABEND                                   31539552
P47386     END-IF.                                                      31540151
P47386                                                                  31540251
278494*----------------------------------------------------------------*31541018
278500* WRITE RECORD TO FILE                                            31550018
278600*----------------------------------------------------------------*31560000
278700 8000-WRITE-PO-TABLE-RECORD.                                      31570083
278800                                                                  31580000
278900     INITIALIZE PO-TABLE-RECORD.                                  31590000
279000                                                                  31600000
279100     MOVE ENTNME-ENT-NAME-DESC TO TR040-ENT-NAME-DESC             31610000
279200     MOVE MDSEAR-DMA-NBR TO TR040-DMA-NBR                         31620000
279300     MOVE PLNSHP-DONT-SHIP-BEF-DTE TO TR040-DONT-SHIP-BEF-DTE     31630000
279400     IF PLNSHP-EXT-CAN-DTE = '0001-01-01'                         31640000
279500        MOVE PLNSHP-CAN-IFNOT-SHIP-DTE TO TR040-EXT-CAN-DTE       31650000
279600     ELSE                                                         31660000
279700        MOVE PLNSHP-EXT-CAN-DTE TO TR040-EXT-CAN-DTE              31670000
279800     END-IF                                                       31680000
279900     MOVE PLNSHP-FOB-CDE TO TR040-FOB-CDE                         31690000
280000     MOVE PLNSHP-LAST-FCTRY-DTE TO TR040-LAST-FCTRY-DTE           31700000
280100     MOVE PLNSHP-POE-CDE TO TR040-POE-CDE                         31710000
280200     MOVE PLNSHP-STRT-FCTRY-DTE TO TR040-STRT-FCTRY-DTE           31720000
280300     MOVE PURCHS-DEPT-NBR TO TR040-DEPT-NBR                       31730000
280400     MOVE PURCHS-EDI-IND TO TR040-EDI-IND                         31740000
280500     MOVE PURCHS-OTB-PER-NBR TO TR040-OTB-PER-NBR                 31750000
280600     MOVE PURCHS-PKGNG-CDE TO TR040-PKGNG-CDE                     31760000
280700     MOVE PURCHS-PO-NBR TO TR040-PO-NBR                           31770000
280800     MOVE PURCHS-PO-TYP-CDE TO TR040-PO-TYP-CDE                   31780000
280900     MOVE PURCHS-PROD-CNTRY-CDE TO TR040-PROD-CNTRY-CDE           31790000
281000     MOVE PURCHS-QTA-CTG-CDE TO TR040-QTA-CTG-CDE                 31800044
281100     MOVE PURCHS-SEASET-SHRT-NM TO TR040-SEASET-SHRT-NM           31810000
281200     MOVE PURCHS-STATUS-CDE TO TR040-STATUS-CDE                   31820000
281300     MOVE PV-CURRENT-TMST TO TR040-TIMESTAMP                      31830000
P47386     MOVE IMCSEN-ACTL-CLR-TMST TO TR040-ACTL-CLR-TMST             31840041
P47386     MOVE IMCSEN-EST-CLR-TMST TO TR040-EST-CLR-TMST               31850041
P47386     MOVE PURCHS-TOT-VAL-COST-AMT                                 31860041
P47386                              TO TR040-COST-AMT                   31870041
P47386     MOVE PURCHS-TOT-VAL-RTL-AMT                                  31880041
P47386                              TO TR040-RTL-AMT                    31890041
P47386     MOVE PURCHS-TOT-UNT-QTY  TO TR040-UNT-QTY                    31900041
281400                                                                  31910000
281500     WRITE PO-TABLE-RECORD                                        31920000
281600      FROM TR040-PO-TABLE.                                        31930000
281700                                                                  31940000
281800*----------------------------------------------------------------*31950000
281900* WRITE RECORD TO FILE                                            31960000
282000*----------------------------------------------------------------*31970000
282100 8010-WRITE-PO-UPC-TABLE-REC.                                     31980000
282200                                                                  31990000
282300     INITIALIZE PO-UPC-TABLE-RECORD.                              32000000
282400                                                                  32010000
282500     MOVE PURITM-AD-EVNT-DTE TO TR041-AD-EVNT-DTE                 32020000
282600     MOVE PURITM-PO-NBR TO TR041-PO-NBR                           32030000
282700     MOVE PURITM-PRD-1ST-COST-AMT TO TR041-PRD-1ST-COST-AMT       32040000
282800     MOVE PURITM-UNT-COST-AMT TO TR041-UNT-COST-AMT               32050000
282900     MOVE PURITM-UNT-QTY TO TR041-UNT-QTY                         32060000
283000     MOVE PURITM-UNT-RTL-PR-AMT TO TR041-UNT-RTL-PR-AMT           32070000
283100     MOVE XLT00004-VS-NBR TO TR041-VS-NBR                         32080000
283200     MOVE SKXREF-SKU TO TR041-SKU                                 32090000
283300     MOVE SKXREF-CLASS TO TR041-CLASS                             32100000
283400     MOVE SKXREF-SUBCLASS TO TR041-SUBCLASS                       32110000
283500     IF (PURCHS-PKGNG-CDE = 'M') OR                               32120000
283600        (PURCHS-PKGNG-CDE = 'I')                                  32130000
283700        MOVE POPRPK-PREPK-UPC-NBR TO TR041-UPC-NBR                32140000
283800      ELSE                                                        32150000
283900        MOVE TUPCSKU-UPC-NBR TO TR041-UPC-NBR                     32160000
284000     END-IF                                                       32170000
284100     MOVE PV-CURRENT-TMST TO TR041-TIMESTAMP                      32180000
284200                                                                  32190000
284300     WRITE PO-UPC-TABLE-RECORD                                    32200000
284400      FROM TR041-PO-UPC-TABLE.                                    32210000
284500*----------------------------------------------------------------*32220000
284600* WRITE RECORD TO FILE                                            32230000
284700*----------------------------------------------------------------*32240000
284800 8020-WRITE-PO-DC-TABLE-REC.                                      32250000
284900                                                                  32260000
285000     INITIALIZE PO-UPC-DC-TABLE-RECORD.                           32270000
285100                                                                  32280000
285200     MOVE ALLPLN-CURR-SPLIT-QTY TO TR042-CURR-SPLIT-QTY           32290000
285300     MOVE ALLPLN-DEST-NBR TO TR042-DEST-NBR                       32300000
285400     MOVE PURITM-PO-NBR TO TR042-PO-NBR                           32310000
285500     IF (PURCHS-PKGNG-CDE = 'M') OR                               32320000
285600        (PURCHS-PKGNG-CDE = 'I')                                  32330000
285700        MOVE POPRPK-PREPK-UPC-NBR TO TR042-UPC-NBR                32340000
285800      ELSE                                                        32350000
285900        MOVE TUPCSKU-UPC-NBR TO TR042-UPC-NBR                     32360000
286000     END-IF                                                       32370000
286100     MOVE PV-CURRENT-TMST TO TR042-TIMESTAMP                      32380000
286200                                                                  32390000
286300     WRITE PO-UPC-DC-TABLE-RECORD                                 32400000
286400      FROM TR042-PO-UPC-DC-TABLE.                                 32410000
286500*----------------------------------------------------------------*32420000
286600* WRITE RECORD TO FILE                                            32430000
286700*----------------------------------------------------------------*32440000
286800 8030-WRITE-CNT-PO-TABLE-REC.                                     32450000
286900                                                                  32460000
287000     INITIALIZE CONTAINER-PO-TABLE-RECORD.                        32470000
287100                                                                  32480000
287200     MOVE IMCNPO-ACTL-POE-DELY-CDE TO TR043-ACTL-POE-DELY-CDE     32490000
287300     MOVE IMCNPO-BKR-FRGT-RLSE-CDE TO TR043-BKR-FRGT-RLSE-CDE     32500000
287400     MOVE IMCNPO-CONTNR-ID TO TR043-CONTNR-ID                     32510000
287500     MOVE IMCNPO-CONTNR-PU-CDE TO TR043-CONTNR-PU-CDE             32520000
287600     MOVE IMCNPO-CONTNR-SEQ-NBR TO TR043-CONTNR-SEQ-NBR           32530000
287700     MOVE IMCNPO-CRE-TMST TO TR043-CRE-TMST                       32540000
287800     MOVE IMCNPO-CSTM-ENTR-ID TO TR043-CSTM-ENTR-ID               32550000
287900     MOVE IMCNPO-DCONSLR-RET-CDE TO TR043-DCONSLR-RET-CDE         32560000
288000     MOVE IMCNPO-DO-RCVD-CDE TO TR043-DO-RCVD-CDE                 32570000
288100     MOVE IMCNPO-DVN-CDE TO TR043-DVN-CDE                         32580000
288200     MOVE IMCNPO-EXTL-REF-NBR TO TR043-EXTL-REF-NBR               32590000
288300     MOVE IMCNPO-HSE-BOL-NBR TO TR043-HSE-BOL-NBR                 32600000
288400     MOVE IMCNPO-LAST-UPD-TMST TO TR043-LAST-UPD-TMST             32610000
288500     MOVE IMCNPO-MSTR-BOL-NBR TO TR043-MSTR-BOL-NBR               32620000
288600     MOVE IMCNPO-PO-C-O-PROD-CDE TO TR043-PO-C-O-PROD-CDE         32630000
288700     MOVE IMCNPO-PO-CART-CNT TO TR043-PO-CART-CNT                 32640000
288800     MOVE IMCNPO-PO-CBMT-QTY TO TR043-PO-CBMT-QTY                 32650000
288900     MOVE IMCNPO-PO-NBR TO TR043-PO-NBR                           32660000
289000     MOVE IMCNPO-PO-RCVD-DELY-TMST TO TR043-PO-RCVD-DELY-TMST     32670000
289100     MOVE IMCNPO-PO-UNT-QTY TO TR043-PO-UNT-QTY                   32680000
289200     MOVE IMCNPO-PO-WT-KGRM-QTY TO TR043-PO-WT-KGRM-QTY           32690000
289300     MOVE IMCNPO-SPLT-XMIT-CDE TO TR043-SPLT-XMIT-CDE             32700000
289400     MOVE IMCNRL-DCONSLR-ACTL-DTE TO TR043-DCONSLR-ACTL-DTE       32710000
289500     MOVE PV-CURRENT-TMST TO TR043-TIMESTAMP                      32720000
P47386     MOVE IMCNTK-BKR-FRGT-RLSE-TMST  TO TR043-BKR-FRGT-RLSE-TMST  32730041
P47386     MOVE IMCNTK-CONTNR-PU-TMST      TO TR043-CONTNR-PU-TMST      32740041
289600                                                                  32750000
289700     WRITE CONTAINER-PO-TABLE-RECORD                              32760000
289800      FROM TR043-CONTAINER-PO-TABLE.                              32770000
289900*----------------------------------------------------------------*32780000
290000* WRITE RECORD TO FILE                                            32790000
290100*----------------------------------------------------------------*32800000
290200 8040-WRITE-CONTAINER-TABLE-REC.                                  32810000
290300                                                                  32820000
290400     INITIALIZE CONTAINER-TABLE-RECORD.                           32830000
290500                                                                  32840000
290600     MOVE IMCNTK-ACTL-DEST-POE-CDE TO TR044-ACTL-DEST-POE-CDE     32850000
290700     MOVE IMCNTK-ACTL-LBD-NM TO TR044-ACTL-LBD-NM                 32860000
290800     MOVE IMCNTK-ACTL-LBD-TMST TO TR044-ACTL-LBD-TMST             32870000
290900     MOVE IMCNTK-ACTL-POE-DELY-TMST TO TR044-ACTL-POE-DELY-TMST   32880000
291000     MOVE IMCNTK-BKR-FRGT-RLSE-TMST TO TR044-BKR-FRGT-RLSE-TMST   32890000
291100     MOVE IMCNTK-CART-CNT TO TR044-CART-CNT                       32900000
291200     MOVE IMCNTK-CBMT-QTY TO TR044-CBMT-QTY                       32910000
291300     MOVE IMCNTK-CONSLR-SCAC-ID TO TR044-CONSLR-SCAC-ID           32920000
291400     MOVE IMCNTK-CONTNR-ID TO TR044-CONTNR-ID                     32930000
291500     MOVE IMCNTK-CONTNR-PU-TMST TO TR044-CONTNR-PU-TMST           32940000
291600     MOVE IMCNTK-CONTNR-SEQ-NBR TO TR044-CONTNR-SEQ-NBR           32950000
291700     MOVE IMCNTK-CRE-TMST TO TR044-CRE-TMST                       32960000
291800     MOVE IMCNTK-DCONSLR-RET-TMST TO TR044-DCONSLR-RET-TMST       32970000
291900     MOVE IMCNTK-DCONSLR-SCAC-ID TO TR044-DCONSLR-SCAC-ID         32980000
292000     MOVE IMCNTK-DO-RCVD-TMST TO TR044-DO-RCVD-TMST               32990000
292100     MOVE IMCNTK-DVN-TMST TO TR044-DVN-TMST                       33000000
292200     MOVE IMCNTK-EST-LBD-NM TO TR044-EST-LBD-NM                   33010000
292300     MOVE IMCNTK-EST-LBD-TMST TO TR044-EST-LBD-TMST               33020000
292400     MOVE IMCNTK-FDR-CARR-SCAC-ID TO TR044-FDR-CARR-SCAC-ID       33030000
292500     MOVE IMCNTK-FDR-DPRTR-TMST TO TR044-FDR-DPRTR-TMST           33040000
292600     MOVE IMCNTK-FDR-FOB-CDE TO TR044-FDR-FOB-CDE                 33050000
292700     MOVE IMCNTK-FDR-IMPRT-TRIP-ID TO TR044-FDR-IMPRT-TRIP-ID     33060000
292800     MOVE IMCNTK-FDR-IMPRT-VEH-NM TO TR044-FDR-IMPRT-VEH-NM       33070000
292900     MOVE IMCNTK-FDR-TRIP-TYP-CDE TO TR044-FDR-TRIP-TYP-CDE       33080000
293000     MOVE IMCNTK-LAST-UPD-TMST TO TR044-LAST-UPD-TMST             33090000
293100     MOVE IMCNTK-MOM-CARR-SCAC-ID TO TR044-MOM-CARR-SCAC-ID       33100000
293200     MOVE IMCNTK-MOM-DPRTR-TMST TO TR044-MOM-DPRTR-TMST           33110000
293300     MOVE IMCNTK-MOM-FOB-CDE TO TR044-MOM-FOB-CDE                 33120000
293400     MOVE IMCNTK-MOM-IMPRT-VEH-NM TO TR044-MOM-IMPRT-VEH-NM       33130000
293500     MOVE IMCNTK-MOM-POE-DELY-TMST TO TR044-MOM-POE-DELY-TMST     33140000
293600     MOVE IMCNTK-MOM-TRIP-TYP-CDE TO TR044-MOM-TRIP-TYP-CDE       33150000
293700     MOVE IMCNTK-ORGN-SHPD-FR-CDE TO TR044-ORGN-SHPD-FR-CDE       33160000
293800     MOVE IMCNTK-ORGN-SHPD-TO-CDE TO TR044-ORGN-SHPD-TO-CDE       33170000
293900     MOVE IMCNTK-SIZE-CDE TO TR044-SIZE-CDE                       33180000
294000     MOVE IMCNTK-UNT-QTY TO TR044-UNT-QTY                         33190000
294100     MOVE IMCNTK-WT-KGRM-QTY TO TR044-WT-KGRM-QTY                 33200000
294200     MOVE IMCNTK-MOM-DEST-POE-CDE TO TR044-MOM-DEST-POE-CDE       33210000
294300     MOVE IMCNTK-MOM-IMPRT-TRIP-ID TO TR044-MOM-IMPRT-TRIP-ID     33220000
294400     MOVE IMCNTK-FDR-POL-CDE TO TR044-FDR-POL-CDE                 33230000
294500     MOVE IMCNTK-FDR-POR-CDE TO TR044-FDR-POR-CDE                 33240000
294600     MOVE IMCNTK-MOM-POL-CDE TO TR044-MOM-POL-CDE                 33250000
294700     MOVE IMCNTK-MOM-POR-CDE TO TR044-MOM-POR-CDE                 33260000
294800     MOVE PV-CURRENT-TMST TO TR044-TIMESTAMP                      33270000
294900                                                                  33280000
295000     WRITE CONTAINER-TABLE-RECORD                                 33290000
295100      FROM TR044-CONTAINER-TABLE.                                 33300000
295200*----------------------------------------------------------------*33310000
295300* WRITE RECORD TO FILE                                            33320000
295400*----------------------------------------------------------------*33330000
295500 8050-WRITE-SEAL-TABLE-RECORD.                                    33340000
295600                                                                  33350000
295700     INITIALIZE SEAL-TABLE-RECORD.                                33360000
295800                                                                  33370000
295900     MOVE TRT00006-CONTNR-ID TO TR045-CONTNR-ID                   33380000
296000     MOVE TRT00006-CONTNR-SEQ-NBR TO TR045-CONTNR-SEQ-NBR         33390000
296100     MOVE TRT00006-CRE-TMST TO TR045-CRE-TMST                     33400000
296200     MOVE TRT00006-LAST-UPD-TMST TO TR045-LAST-UPD-TMST           33410000
296300     MOVE TRT00006-SEAL-NBR TO TR045-SEAL-NBR                     33420000
296400     MOVE PV-CURRENT-TMST TO TR045-TIMESTAMP                      33430000
296500                                                                  33440000
296600     WRITE SEAL-TABLE-RECORD                                      33450000
296700      FROM TR045-SEAL-TABLE.                                      33460000
296800*----------------------------------------------------------------*33470000
296900* WRITE RECORD TO FILE                                            33480000
297000*----------------------------------------------------------------*33490000
297100 8060-WRITE-SHIP-PO-TABLE-REC.                                    33500000
297200                                                                  33510000
297300     INITIALIZE SHIPMENT-PO-TABLE-RECORD.                         33520000
297400                                                                  33530000
297500     MOVE PKSLIP-CONTNR-ID         TO TR046-CONTNR-ID             33540000
297600     MOVE PKSLIP-OPER-UNT-ID       TO TR046-OPER-UNT-ID           33550000
297700     MOVE PKSLIP-CRE-TMST          TO TR046-CRE-TMST              33560000
297800     MOVE PKSLIP-CRE-UID           TO TR046-CRE-UID               33570000
297900     MOVE PV-SUM-AP-VERIFY-ITM-QTY TO TR046-AP-VERIFY-ITM-QTY     33580000
298000     MOVE RECEIV-VERFYD-TMST       TO TR046-VERFYD-TMST           33590000
298100     MOVE SHPTPO-PO-NBR            TO TR046-PO-NBR                33600000
298200     MOVE SHPTPO-SHIPT-ID          TO TR046-SHIPT-ID              33610000
298300     MOVE SHPTPO-REC-SEQ-NBR       TO TR046-REC-SEQ-NBR           33620000
298400     MOVE PV-CURRENT-TMST          TO TR046-TIMESTAMP             33630000
298500                                                                  33640000
298600     WRITE SHIPMENT-PO-TABLE-RECORD                               33650000
298700      FROM TR046-SHIPMENT-PO-TABLE.                               33660000
298800*----------------------------------------------------------------*33670000
298900* WRITE RECORD TO FILE                                            33680000
299000*----------------------------------------------------------------*33690000
299100 8070-WRITE-SHP-ST-TABLE-RECORD.                                  33700000
299200                                                                  33710000
299300     INITIALIZE SHIPMENT-STATUS-TABLE-RECORD.                     33720000
299400                                                                  33730000
299500     MOVE SHIPST-SHIPT-ID TO TR047-SHIPT-ID                       33740000
299600     MOVE SHIPST-STATUS-DTE TO TR047-STATUS-DTE                   33750000
299700     MOVE SHIPST-SHIPT-STATUS-CDE TO TR047-SHIPT-STATUS-CDE       33760000
299800     MOVE SHSTYP-DESC TO TR047-DESC                               33770000
299900     MOVE PV-CURRENT-TMST TO TR047-TIMESTAMP                      33780000
300000                                                                  33790000
300100     WRITE SHIPMENT-STATUS-TABLE-RECORD                           33800000
300200      FROM TR047-SHIPMENT-STATUS-TABLE.                           33810000
300300*----------------------------------------------------------------*33820000
300400* WRITE RECORD TO FILE                                            33830000
300500*----------------------------------------------------------------*33840000
300600 8080-WRITE-SHIP-TABLE-RECORD.                                    33850000
300700                                                                  33860000
300800     INITIALIZE SHIPMENT-TABLE-RECORD.                            33870000
300900                                                                  33880000
301000     MOVE SHIPMT-BOL-NBR TO TR048-BOL-NBR                         33890000
301100     MOVE SHIPMT-PRO-NBR TO TR048-PRO-NBR                         33900000
301200     MOVE SHIPMT-SHIPT-ID TO TR048-SHIPT-ID                       33910000
301300     MOVE SHIPMT-TRIP-ID TO TR048-TRIP-ID                         33920000
301400     MOVE PV-CURRENT-TMST TO TR048-TIMESTAMP                      33930000
301500                                                                  33940000
301600     WRITE SHIPMENT-TABLE-RECORD                                  33950000
301700      FROM TR048-SHIPMENT-TABLE.                                  33960000
301800*----------------------------------------------------------------*33970000
301900* WRITE RECORD TO FILE                                            33980000
302000*----------------------------------------------------------------*33990000
302100 8090-WRITE-TRIP-TABLE-RECORD.                                    34000000
302200                                                                  34010000
302300     INITIALIZE TRIP-TABLE-RECORD.                                34020000
302400                                                                  34030000
302500     MOVE VHTRIP-EST-AR-TMST TO TR049-EST-AR-TMST                 34040000
302600     MOVE VHTRIP-OWNER-SCAC-ID TO TR049-OWNER-SCAC-ID             34050000
302700     MOVE VHTRIP-TRIP-ID TO TR049-TRIP-ID                         34060000
302800     MOVE VHTRIP-VEH-NBR TO TR049-VEH-NBR                         34070000
302900     MOVE PV-CURRENT-TMST TO TR049-TIMESTAMP                      34080000
303000                                                                  34090000
303100     WRITE TRIP-TABLE-RECORD                                      34100000
303200      FROM TR049-TRIP-TABLE.                                      34110000
303300*----------------------------------------------------------------*34120000
303400* WRITE RECORD TO FILE                                            34130000
303500*----------------------------------------------------------------*34140000
303600 8100-WRITE-BOOKING-TABLE-REC.                                    34150000
303700                                                                  34160000
303800     INITIALIZE BOOKING-TABLE-RECORD.                             34170000
303900                                                                  34180000
304000     MOVE IMBKPO-C-O-PROD-CDE TO TR052-C-O-PROD-CDE               34190000
304100     MOVE IMBKPO-CONSLR-SCAC-ID TO TR052-CONSLR-SCAC-ID           34200000
304200     MOVE IMBKPO-CRE-TMST TO TR052-CRE-TMST                       34210000
304300     MOVE IMBKPO-DAT-SRC-ENT-ID TO TR052-DAT-SRC-ENT-ID           34220000
304400     MOVE IMBKPO-DEST-POE-CDE TO TR052-DEST-POE-CDE               34230000
304500     MOVE IMBKPO-DPRTR-TMST TO TR052-DPRTR-TMST                   34240000
304600     MOVE IMBKPO-EST-LBD-NM TO TR052-EST-LBD-NM                   34250000
304700     MOVE IMBKPO-EST-LBD-TMST TO TR052-EST-LBD-TMST               34260000
304800     MOVE IMBKPO-EXTL-REF-NBR TO TR052-EXTL-REF-NBR               34270000
304900     MOVE IMBKPO-FOB-CDE TO TR052-FOB-CDE                         34280000
305000     MOVE IMBKPO-IMPRT-VEH-NM TO TR052-IMPRT-VEH-NM               34290000
305100     MOVE IMBKPO-LAST-UPD-TMST TO TR052-LAST-UPD-TMST             34300000
305200     MOVE IMBKPO-ORGN-SHPD-FR-CDE TO TR052-ORGN-SHPD-FR-CDE       34310000
305300     MOVE IMBKPO-PO-BKG-DELY-TMST TO TR052-PO-BKG-DELY-TMST       34320000
305400     MOVE IMBKPO-PO-CART-CNT TO TR052-PO-CART-CNT                 34330000
305500     MOVE IMBKPO-PO-CBMT-QTY TO TR052-PO-CBMT-QTY                 34340000
305600     MOVE IMBKPO-PO-NBR TO TR052-PO-NBR                           34350000
305700     MOVE IMBKPO-PO-UNT-QTY TO TR052-PO-UNT-QTY                   34360000
305800     MOVE IMBKPO-PO-WT-KGRM-QTY TO TR052-PO-WT-KGRM-QTY           34370000
305900     MOVE IMBKPO-PROD-FCTRY-NM TO TR052-PROD-FCTRY-NM             34380000
306000     MOVE IMBKPO-TRIP-TYP-CDE TO TR052-TRIP-TYP-CDE               34390000
306100     MOVE PV-CURRENT-TMST TO TR052-TIMESTAMP                      34400000
306200                                                                  34410000
306300     WRITE BOOKING-TABLE-RECORD                                   34420000
306400      FROM TR052-BOOKING-TABLE.                                   34430000
306500*----------------------------------------------------------------*34440000
306600* WRITE RECORD TO FILE                                            34450000
306700*----------------------------------------------------------------*34460000
306800 8110-WRITE-REC-TABLE-REC.                                        34470000
306900                                                                  34480000
307000     INITIALIZE RECEIVING-TABLE-RECORD.                           34490000
307100                                                                  34500000
307200     MOVE IMRCPO-C-O-PROD-CDE TO TR053-C-O-PROD-CDE               34510000
307300     MOVE IMRCPO-CONSLR-SCAC-ID TO TR053-CONSLR-SCAC-ID           34520000
307400     MOVE IMRCPO-CRE-TMST TO TR053-CRE-TMST                       34530000
307500     MOVE IMRCPO-DAT-SRC-ENT-ID TO TR053-DAT-SRC-ENT-ID           34540000
307600     MOVE IMRCPO-DEST-POE-CDE TO TR053-DEST-POE-CDE               34550000
307700     MOVE IMRCPO-DPRTR-TMST   TO TR053-DPRTR-TMST                 34560000
307800     MOVE IMRCPO-EST-LBD-NM TO TR053-EST-LBD-NM                   34570000
307900     MOVE IMRCPO-EST-LBD-TMST TO TR053-EST-LBD-TMST               34580000
308000     MOVE IMRCPO-EXTL-REF-NBR TO TR053-EXTL-REF-NBR               34590000
308100     MOVE IMRCPO-FOB-CDE TO TR053-FOB-CDE                         34600000
308200     MOVE IMRCPO-IMPRT-VEH-NM TO TR053-IMPRT-VEH-NM               34610000
308300     MOVE IMRCPO-LAST-UPD-TMST TO TR053-LAST-UPD-TMST             34620000
308400     MOVE IMRCPO-ORGN-SHPD-FR-CDE TO TR053-ORGN-SHPD-FR-CDE       34630000
308500     MOVE IMRCPO-PO-CART-CNT TO TR053-PO-CART-CNT                 34640000
308600     MOVE IMRCPO-PO-CBMT-QTY TO TR053-PO-CBMT-QTY                 34650000
308700     MOVE IMRCPO-PO-NBR TO TR053-PO-NBR                           34660000
308800     MOVE IMRCPO-PO-RCVD-DELY-TMST TO TR053-PO-RCVD-DELY-TMST     34670000
308900     MOVE IMRCPO-PO-UNT-QTY TO TR053-PO-UNT-QTY                   34680000
309000     MOVE IMRCPO-PO-WT-KGRM-QTY TO TR053-PO-WT-KGRM-QTY           34690000
309100     MOVE IMRCPO-PROD-FCTRY-NM TO TR053-PROD-FCTRY-NM             34700000
309200     MOVE IMRCPO-TRIP-TYP-CDE TO TR053-TRIP-TYP-CDE               34710000
309300     MOVE PV-CURRENT-TMST TO TR053-TIMESTAMP                      34720000
309400                                                                  34730000
309500     WRITE RECEIVING-TABLE-RECORD                                 34740000
309600      FROM TR053-RECEIVING-TABLE.                                 34750000
309700*----------------------------------------------------------------*34760000
309800* WRITE RECORD TO FILE                                            34770000
309900*----------------------------------------------------------------*34780000
310000 8120-WRITE-CE-PO-TABLE-REC.                                      34790000
310100                                                                  34800000
310200     INITIALIZE CUSTOMS-ENTRY-PO-TABLE-RECORD.                    34810000
310300                                                                  34820000
310400     MOVE IMCSPO-CSTM-ENTR-ID TO TR050-CSTM-ENTR-ID               34830000
310500     MOVE IMCSPO-PO-NBR TO TR050-PO-NBR                           34840000
310600     MOVE IMCSPO-CRE-TMST TO TR050-CRE-TMST                       34850000
310700     MOVE IMCSPO-LAST-UPD-TMST TO TR050-LAST-UPD-TMST             34860000
310800     MOVE IMCSPO-EXTL-REF-NBR TO TR050-EXTL-REF-NBR               34870000
310900     MOVE PV-CURRENT-TMST TO TR050-TIMESTAMP                      34880000
311000                                                                  34890000
311100     WRITE CUSTOMS-ENTRY-PO-TABLE-RECORD                          34900000
311200      FROM TR050-CUSTOMS-ENTRY-PO-TABLE.                          34910000
311300                                                                  34920000
311400*----------------------------------------------------------------*34930000
311500* WRITE RECORD TO FILE                                            34940000
311600*----------------------------------------------------------------*34950000
311700 8220-WRITE-CE-TABLE-REC.                                         34960000
311800                                                                  34970000
311900     INITIALIZE CUSTOMS-ENTRY-TABLE-RECORD.                       34980000
312000                                                                  34990000
312100     MOVE IMCSEN-ACTL-CLR-TMST TO TR051-ACTL-CLR-TMST             35000000
312200     MOVE IMCSEN-BKR-REF-NBR TO TR051-BKR-REF-NBR                 35010000
312300     MOVE IMCSEN-CRE-TMST TO TR051-CRE-TMST                       35020000
312400     MOVE IMCSEN-CSTM-ENTR-ID TO TR051-CSTM-ENTR-ID               35030000
312500     MOVE IMCSEN-DAT-SRC-ENT-ID TO TR051-DAT-SRC-ENT-ID           35040000
312600     MOVE IMCSEN-ENT-ID TO TR051-ENT-ID                           35050000
312700     MOVE IMCSEN-ENTR-TYP-CDE TO TR051-ENTR-TYP-CDE               35060000
312800     MOVE IMCSEN-EST-CLR-TMST TO TR051-EST-CLR-TMST               35070000
312900     MOVE IMCSEN-EXM-TMST TO TR051-EXM-TMST                       35080000
313000     MOVE IMCSEN-FILD-TMST TO TR051-FILD-TMST                     35090000
313100     MOVE IMCSEN-LAST-UPD-TMST TO TR051-LAST-UPD-TMST             35100000
313200     MOVE IMCSEN-LQDN-SSPNN-TMST TO TR051-LQDN-SSPNN-TMST         35110000
313300     MOVE IMCSEN-LQDN-TMST TO TR051-LQDN-TMST                     35120000
313400     MOVE IMCSEN-MOM-DEST-POE-CDE TO TR051-MOM-DEST-POE-CDE       35130000
313500     MOVE IMCSEN-MOM-TRIP-TYP-CDE TO TR051-MOM-TRIP-TYP-CDE       35140000
313600     MOVE IMCSEN-REJ-TMST TO TR051-REJ-TMST                       35150000
313700     MOVE PV-CURRENT-TMST TO TR051-TIMESTAMP                      35160000
313800                                                                  35170000
313900     WRITE CUSTOMS-ENTRY-TABLE-RECORD                             35180000
314000      FROM TR051-CUSTOMS-ENTRY-TABLE.                             35190000
314100*----------------------------------------------------------------*35200000
314200* WRITE RECORD TO FILE                                            35210000
314300*----------------------------------------------------------------*35220000
314400 8230-WRITE-CSCN-TABLE-REC.                                       35230000
314500                                                                  35240000
314600     INITIALIZE CUSTOMS-CONTAINER-TABLE-RECORD.                   35250000
314700                                                                  35260000
314800     MOVE IMCSCN-CSTM-ENTR-ID       TO TR054-CSTM-ENTR-ID         35270000
314900     MOVE IMCSCN-CONTNR-ID          TO TR054-CONTNR-ID            35280000
315000     MOVE IMCSCN-CRE-BY-USR-ID      TO TR054-CRE-BY-USR-ID        35290000
315100     MOVE IMCSCN-CRE-TMST           TO TR054-CRE-TMST             35300000
315200     MOVE IMCSCN-LAST-UPD-BY-USR-ID TO TR054-LAST-UPD-BY-USR-ID   35310000
315300     MOVE IMCSCN-LAST-UPD-TMST      TO TR054-LAST-UPD-TMST        35320000
315400     MOVE IMCSCN-DO-TO-DCONSLR-TMST TO TR054-DO-TO-DCONSLR-TMST   35330000
315500     MOVE PV-CURRENT-TMST           TO TR054-TIMESTAMP            35340000
315600                                                                  35350000
315700     WRITE CUSTOMS-CONTAINER-TABLE-RECORD                         35360000
315800      FROM TR054-CUSTOMS-CONTAINER-TABLE.                         35370000
315900                                                                  35380000
315901* PRB44512 - START                                                35390007
315910*----------------------------------------------------------------*35400006
315920* WRITE TIMCNUP RECORD TO FILE                                    35410006
315930*----------------------------------------------------------------*35420006
315940 8240-WRITE-TIMCNUP-TABLE-REC.                                    35430006
315950                                                                  35440006
315961     INITIALIZE CONTAINER-UPC-TABLE-RECORD.                       35450006
315970                                                                  35460006
315980     MOVE IMCNUP-CONTNR-ID          TO TR062-CONTNR-ID.           35470008
315981     MOVE IMCNUP-CONTNR-SEQ-NBR     TO TR062-CONTNR-SEQ-NBR.      35480008
315982     MOVE IMCNUP-PO-NBR             TO TR062-PO-NBR.              35490008
315983     MOVE IMCNUP-VS-NBR             TO TR062-VS-NBR.              35500008
315984     MOVE IMCNUP-UPC-NBR            TO TR062-UPC-NBR.             35510008
315985     MOVE IMCNUP-PO-LNE-NBR         TO TR062-PO-LNE-NBR.          35520008
315986     MOVE IMCNUP-UPC-CART-CNT       TO TR062-UPC-CART-CNT.        35530008
315987     MOVE PV-ACTUAL-CART-CNT        TO TR062-ACTUAL-CART-CNT.     35540014
315988     MOVE IMCNUP-UPC-CBMT-QTY       TO TR062-UPC-CBMT-QTY.        35550014
315989     MOVE IMCNUP-UPC-WT-KGRM-QTY    TO TR062-UPC-WT-KGRM-QTY.     35560014
315990     MOVE IMCNUP-UPC-UNT-QTY        TO TR062-UPC-UNT-QTY.         35570014
315991     MOVE IMCNUP-SKU-NBR            TO TR062-SKU-NBR.             35580014
315992     MOVE IMCNUP-ASN-PKGNG-CDE      TO TR062-ASN-PKGNG-CDE.       35590014
315993     MOVE PV-CURRENT-TMST           TO TR062-EXTRACTED-TMST.      35600014
316020                                                                  35610008
316021     WRITE  CONTAINER-UPC-TABLE-RECORD                            35620008
316023      FROM TR062-CONTAINER-UPC-TABLE.                             35630008
316024                                                                  35640008
316025* PRB44512 - END                                                  35650008
      * PRB51351 - START                                                35650189
278494*----------------------------------------------------------------*35650283
278500* WRITE RECORD TO FILE                                            35650383
278600*----------------------------------------------------------------*35650483
278700 8250-WRITE-INVALID-PO-RECORD.                                    35651082
278800                                                                  35652082
278900     INITIALIZE INVALID-PO-FILE-RECORD.                           35653083
279000                                                                  35654082
280700     MOVE PURCHS-PO-NBR TO PV-INVALID-PO                          35660286
281400                                                                  35661682
281500     WRITE INVALID-PO-FILE-RECORD                                 35661783
281600      FROM PV-INVALID-PO.                                         35661886
281700                                                                  35661982
      * PRB51351 - END                                                  35662089
316030*----------------------------------------------------------------*35663008
316100*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    35670000
316200*  ERROR OR WARNING CODE OCCURS.                                  35680000
316300*----------------------------------------------------------------*35690000
316400 9100-DB2-ABEND.                                                  35700000
316500                                                                  35710000
316600     DISPLAY '9100-DB2-ABEND'.                                    35720000
316700     DISPLAY '** ABEND           **'.                             35730000
316800     DISPLAY '** PROGRAM         ** = ' PC-PGM-NAME.              35740000
316900     DISPLAY '** PO NUMBER       ** = ' PV-PO-NBR.                35750000
316930     DISPLAY '** CONTAINER ID    ** = ' PV-CONTNR-ID.             35760003
316940     DISPLAY '** CONTAINER SEQ   ** = ' PV-CONTNR-SEQ-NBR-DISP.   35770003
317000     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        35780000
317100     DISPLAY '** TABLES AFFECTED ** = ' PV-DB2-TABLE-NAME-1.      35790000
317200     DISPLAY '**                 ** = ' PV-DB2-TABLE-NAME-2.      35800000
317300     DISPLAY '**                 ** = ' PV-DB2-TABLE-NAME-3.      35810000
317400     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MESSAGE. 35820000
317500                                                                  35830000
317600*----------------------------------------------------------------*35840000
317700* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    35850000
317800* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         35860000
317900* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     35870000
318000* FORMAT.                                                         35880000
318100*----------------------------------------------------------------*35890000
318200     COPY DPPD004.                                                35900000
318300                                                                  35910000
318400     SET PC-DB2-ERROR TO TRUE.                                    35920000
318500     CALL 'ILBOABN0' USING ABEND-CODE.                            35930000
318600*                                                                 35940000
318601* PRB44512 - START                                                35950011
318610*-------------------------------------------------------          35960011
318700 9200-NON-DB2-ABEND.                                              35970011
318710                                                                  35980011
318900     CALL 'ILBOABN0' USING ABEND-CODE.                            35990011
319000                                                                  36000011
319100* PRB44512 - END                                                  36000158
P47386*---------------------------------------------------------------* 36001057
P47386*    OPEN TO BUY MODULE                                          *36002057
P47386*----------------------------------------------------------------*36003057
P47386     COPY POPD055.                                                36005057
P47386                                                                  36006057
