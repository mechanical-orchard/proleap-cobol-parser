00001 *                                                                 08/16/90
00002 *      THIS PROCEDURE DIVISION COPY BOOK IS USED TO LOAD THE      DPPD009 
00003 *  FUNCTION KEY LINES, FOR PROGRAMS UNDER THE NEW CICS               LV006
00004 *  ARCHITECTURE.                                                  DPPD009 
00005 *                                                                 DPPD009 
00006 *      COPY MEMBER DPWS009 CONTAINS ALL VARIABLES REQUIRED FOR    DPPD009 
00007 *  THIS ROUTINE.  COPY MEMBERS DPWS016 AND DPWS020 ARE ALSO USED, DPPD009 
00008 *  BUT THEY SHOULD ALREADY BE A PART OF ALL PROGRAMS USING THE    DPPD009 
00009 *  NEW ARCHITECTURE.                                              DPPD009 
00010 *                                                                 DPPD009 
00011                                                                   DPPD009 
00012  DP009-0000-LOAD-FK-LINES.                                        DPPD009 
00013      INITIALIZE DP009-FUNCTION-KEY-AREA.                          DPPD009 
00014                                                                   DPPD009 
00015      IF DP020-SRC-AID = DP016-PA2                                 DPPD009 
00016          IF DP020-FK-DISPLAY-13-24                                   CL**4
00017              SET DP020-FK-DISPLAY-1-12 TO TRUE                       CL**4
00018          ELSE                                                     DPPD009 
00019              SET DP020-FK-DISPLAY-13-24 TO TRUE                      CL**4
00020          END-IF                                                   DPPD009 
00021      END-IF.                                                      DPPD009 
00022                                                                   DPPD009 
00023      IF DP020-FK-DISPLAY-13-24                                       CL**5
00024          SET DP009-FK-TAG-INDEX                                   DPPD009 
00025              DP020-FK-INDEX TO DP009-START-FK-DISPLAY-13-24          CL**3
00026      ELSE                                                         DPPD009 
00027          SET DP009-FK-TAG-INDEX                                   DPPD009 
00028              DP020-FK-INDEX TO DP009-START-FK-DISPLAY-1-12           CL**3
00029      END-IF.                                                      DPPD009 
00030                                                                   DPPD009 
00031      PERFORM                                                      DPPD009 
00032              VARYING DP009-FK-INDEX                               DPPD009 
00033              FROM 1 BY 1                                          DPPD009 
00034              UNTIL DP009-FK-INDEX > DP009-MAXIMUM-FKS-PER-LINE    DPPD009 
00035          MOVE DP009-FUNCTION-KEY-TAG (DP009-FK-TAG-INDEX) TO      DPPD009 
00036                   DP009-FUNCTION-KEY-TAG-LITERAL (DP009-FK-INDEX) DPPD009 
00037          SET DP009-FUNCTION-KEY-EQUAL-SIGN (DP009-FK-INDEX) TO    DPPD009 
00038                   TRUE                                            DPPD009 
00039          MOVE DP020-FK-MNEMONIC (DP020-FK-INDEX) TO               DPPD009 
00040                   DP009-FUNCTION-KEY-MNEMONIC (DP009-FK-INDEX)    DPPD009 
00041          SET DP009-FK-TAG-INDEX                                   DPPD009 
00042              DP020-FK-INDEX UP BY 1                               DPPD009 
00043      END-PERFORM.                                                 DPPD009 
00044                                                                   DPPD009 
00045      MOVE DP009-FUNCTION-KEY-LINE-1 TO AFKLIN1O.                     CL**6
00046      MOVE DP009-FUNCTION-KEY-LINE-2 TO AFKLIN2O.                     CL**6
00047 *DP009-0000-EXIT.                                                    CL**2
