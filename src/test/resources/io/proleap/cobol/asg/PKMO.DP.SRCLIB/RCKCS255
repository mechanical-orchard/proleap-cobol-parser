000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    RCKCS255.                                         00020000
000300 AUTHOR.        LARRY SCHLEICHER.                                 00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  02-12-96.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800*---------------------------------------------------------------* 00080000
000900*    E255 - RECEIVER ITEM LIST PROGRAM                          * 00090000
001000*                                                               * 00100000
001100*    THIS PROGRAM GENERATES A LIST OF RECEIPT ITEMS FOR A       * 00110000
001200*    RECEIVER.                                                  * 00120000
001300*                                                               * 00130000
001400*---------------------------------------------------------------* 00140000
001500* MAINTENANCE:                                                  * 00150000
001600*---------------------------------------------------------------* 00160000
001610* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00161007
001620* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00162008
001630* MAKING THE CALL DYNAMIC VS STATIC.                              00163008
001640*---------------------------------------------------------------* 00164008
001700/                                                                 00170000
001800 ENVIRONMENT DIVISION.                                            00180000
001900                                                                  00190000
002000 DATA DIVISION.                                                   00200000
002100                                                                  00210000
002200 WORKING-STORAGE SECTION.                                         00220000
002300                                                                  00230000
002400 01  DK-DB2-KEYS.                                                 00240000
002500*    REQUIRED FIELDS                                              00250000
002600     05  DK-ORD-NBR                     PIC S9(09)  COMP.         00260000
002700     05  DK-RCVR-SEQ-NBR                PIC S9(09)  COMP.         00270000
002800     05  DK-LINE-NBR                    PIC S9(04)  COMP.         00280000
002900     05  DK-OPR-ID                      PIC S9(04)  COMP.         00290000
003000     05  DK-FACT                        PIC S9(04)  COMP.         00300000
003100     05  DK-SEQ-NBR                     PIC S9(04) COMP-3.        00310000
003200                                                                  00320000
003300 01  PC-PROGRAM-CONSTANTS.                                        00330000
003400     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00340000
003500                                                    'RC255A  '.   00350000
003600     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00360000
003700                                                    'RCKM255 '.   00370000
003800     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00380000
003900                                                    'RCKCS255'.   00390000
004000     05  PC-TROUBLE-RTN               PIC X(08)  VALUE 'TMKCS520'.00400000
004100     05  PC-TROUBLE-RTN-LENGTH        PIC S9(04) VALUE +600       00410000
004200                                                 COMP.            00420000
004300     05  PC-WMS-CONTROL-MOD           PIC X(8)  VALUE  'WSKCS305'.00430005
004400     05  PC-APPL-MAP                    PIC S9(04)  VALUE  +1     00440000
004500                                                    COMP.         00450000
004600     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00460000
004700     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00470000
004800     05  PC-INTER-APPL-CODES.                                     00480000
004900         10 PC-INTER-APPL-CRIT-SPEC     PIC  X(01)  VALUE '1'.    00490000
005000         10 PC-INTER-APPL-PKSL-LIST     PIC  X(01)  VALUE '2'.    00500000
005100     05  PC-WORK-ORDER-DIST-SHEET       PIC  9(03)  VALUE 001.    00510000
005200     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +9      00520000
005300                                                    COMP SYNC.    00530000
005400     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00540000
005500                                                    COMP SYNC.    00550000
005600     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00560000
005700                                                    +1000000      00570000
005800                                                    COMP-3.       00580000
005900     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +7      00590000
006000                                                    COMP SYNC.    00600000
006100     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE +3      00610000
006200                                                    COMP-3.       00620000
006300     05  PC-DEFAULT-TMST                PIC  X(26)  VALUE         00630000
006400                                   '9999-09-09-09.09.09.999999'.  00640000
006500     05  PC-B                           PIC  X(01)  VALUE 'B'.    00650000
006600     05  PC-C                           PIC  X(01)  VALUE 'C'.    00660000
006700     05  PC-M                           PIC  X(01)  VALUE 'M'.    00670000
006800     05  PC-N                           PIC  X(01)  VALUE 'N'.    00680000
006900     05  PC-I                           PIC  X(01)  VALUE 'I'.    00690000
007000     05  PC-R                           PIC  X(01)  VALUE 'R'.    00700000
007100     05  PC-S                           PIC  X(01)  VALUE 'S'.    00710000
007200     05  PC-T                           PIC  X(01)  VALUE 'T'.    00720000
007300     05  PC-X                           PIC  X(01)  VALUE 'X'.    00730000
007400     05  PC-Y                           PIC  X(01)  VALUE 'Y'.    00740000
007500     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00750000
007600     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00760000
007700     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00770000
007800     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00780000
007900     05  PC-VE                          PIC  X(02)  VALUE 'VE'.   00790000
008000     05  PC-RV                          PIC  X(02)  VALUE 'RV'.   00800000
008100     05  PC-MULTIPLE-SKU-PPK            PIC  X(21)  VALUE         00810000
008200         'M - MULTI SKU PREPACK'.                                 00820000
008300     05  PC-SINGLE-SKU-PPK              PIC  X(22)  VALUE         00830000
008400         'S - SINGLE SKU PREPACK'.                                00840000
008500     05  PC-INNER-PPK                   PIC  X(17)  VALUE         00850000
008600         'I - INNER PREPACK'.                                     00860000
008700     05  PC-BULK-PPK                    PIC  X(13)  VALUE         00870000
008800         'B - BULK PACK'.                                         00880000
008900     05  PC-CASEPACK                    PIC  X(12)  VALUE         00890000
009000         'C - CASEPACK'.                                          00900000
009100     05  PC-PKG-NOT-FOUND               PIC  X(19)  VALUE         00910000
009200         'PACK TYPE NOT FOUND'.                                   00920000
009300*                                                                 00930000
009400*----------------------------------------------------------------*00940000
009500*                                                **   WR # 230ZZ *00950000
009600* ADDED THE VARIABLES PC-000 AND PC-999 TO CHECK FOR DUMMY SKU'S *00960000
009700*----------------------------------------------------------------*00970000
009800*                                                                 00980000
009900     05  PC-000                       PIC X(03) VALUE '000'.      00990000
010000     05  PC-999                       PIC X(03) VALUE '999'.      01000000
010100*                                                                 01010000
010200*----------------------------------------------------------------*01020000
010300*   CHANGES MADE FOR WR # 230ZZ ENDS HERE.                        01030000
010400*----------------------------------------------------------------*01040000
010500*                                                                 01050000
010600     05  PC-TSYMSG-NUMBERS.                                       01060000
010700         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  01070000
010800         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01080000
010900         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01090000
011000         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01100000
011100         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01110000
011200         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01120000
011300         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01130000
011400         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01140000
011500         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01150000
011600         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01160000
011700         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01170000
011800         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01180000
011900         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01190000
012000         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01200000
012100         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01210000
012200         10  PC-TSYMSG-00815            PIC  9(05)  VALUE 00815.  01220000
012300         10  PC-TSYMSG-00883            PIC  9(05)  VALUE 00883.  01230000
012400         10  PC-TSYMSG-00928            PIC  9(05)  VALUE 00928.  01240000
012500         10  PC-TSYMSG-00929            PIC  9(05)  VALUE 00929.  01250000
012600         10  PC-TSYMSG-00954            PIC  9(05)  VALUE 00954.  01260000
012700         10  PC-TSYMSG-00966            PIC  9(05)  VALUE 00966.  01270000
012800*  P.O. NUMBER REQUIRED                                           01280000
012900         10  PC-TSYMSG-00736            PIC  9(05)  VALUE 00736.  01290000
013000*  RECEIVER SEQUENCE NBR REQUIRED                                 01300000
013100         10  PC-TSYMSG-00737            PIC  9(05)  VALUE 00737.  01310000
013200*  LINE NUMBER REQUIRED                                           01320000
013300         10  PC-TSYMSG-00738            PIC  9(05)  VALUE 00738.  01330000
013400*  WORK ORDER NUMBER REQUIRED                                     01340000
013500         10  PC-TSYMSG-00739            PIC  9(05)  VALUE 00739.  01350000
013600*  RECEIVER STATUS CODE REQUIRED                                  01360000
013700         10  PC-TSYMSG-00740            PIC  9(05)  VALUE 00740.  01370000
013800         10  PC-TSYMSG-00941          PIC 9(05)  VALUE 00941.     01380000
013900*            REDISTRO SUCCESSFUL BUT TROUBLE CREATED              01390000
014000         10  PC-TSYMSG-00059          PIC 9(05)  VALUE 00059.     01400000
014100*            UPDATE(S) SUCCESSFUL                                 01410000
014200         10  PC-TSYMSG-00937          PIC 9(05)  VALUE 00937.     01420000
014300*            UNABLE TO REDISTRO DUE TO TROUBLE                    01430000
014400         10  PC-TSYMSG-01196          PIC 9(05)  VALUE 01196.     01440000
014500*            RECEIVER HAS ALREADY BEEN VERIFIED                   01450000
014600         10  PC-TSYMSG-01793          PIC 9(05)  VALUE 01793.     01460000
014700* 01793 - UNABLE TO RE-DISTRO - CASEPACK SPLIT PROCESS HAS BEEN   01470000
014800         10  PC-TSYMSG-02194          PIC 9(05)  VALUE 02194.     01480000
014900*            WARNING: LINE-LEVEL SCREEN / PACK-LEVEL RECEIVER     01490000
015000         10  PC-TSYMSG-02463          PIC 9(05)  VALUE 02463.     01500000
015100*            INVALID FUNCTION FOR PACKAGING CODE OF "M" OR "I"    01510000
015200         10  PC-TSYMSG-02762          PIC 9(5)  VALUE 02762.      01520000
015300*            PACK IS NOT CONFIRMED                                01530000
015400         10  PC-TSYMSG-02972          PIC 9(5)  VALUE 02972.      01540000
015500* CARTONS HAVE BEEN CHECKED IN FOR PO/RCVR/LNE - MUST BE RECLAIMED01550000
015600         10  PC-TSYMSG-03138          PIC 9(5)  VALUE 03138.      01560000
015700         10  PC-TSYMSG-02991          PIC 9(5)  VALUE 02991.      01570000
015800*     CAN NOT DELETE RCVR LINE - CASEPACK SPLIT HAS BEEN PERFORMED01580000
015900         10  PC-TSYMSG-03394          PIC 9(05)  VALUE 03394.     01590000
016000*UNABLE TO REDISTRO - MANIFESTED CARTONS EXIST FOR PO/RCVR/LNE    01600000
016100         10  PC-TSYMSG-03395          PIC 9(05)  VALUE 03395.     01610000
016200*UNABLE TO DELETE - MANIFESTED CARTONS EXIST FOR PO/RCVR/LNE      01620000
016300         10  PC-TSYMSG-03546            PIC  9(05)  VALUE 03546.  01630000
016400*ERROR IN WMS DOWNLOAD MODULE - CONTACT HELP DESK                 01640000
016500* JAK 05/2007 - ADD NEW MESSAGES FOR WMS                          01650000
016600         10  PC-TSYMSG-03568            PIC  9(05)  VALUE 03568.  01660000
016700*  REDISTRO SUCCESSFUL AND ASN WILL BE DOWNLOADED TO WMS          01670000
016800         10  PC-TSYMSG-03569            PIC  9(05)  VALUE 03569.  01680000
016900*  REDISTRO SUCCESSFUL, ASN WILL BE DWNLD TO WMS, BUT TROUBLE     01690000
017000* JAK 05/2007 - END                                               01700000
017100                                                                  01710000
017200 01  PS-PROGRAM-SWITCHES.                                         01720000
017300     05  PS-SEQ-EOC-SW                PIC X(01)  VALUE 'N'.       01730000
017400         88  PS-EOC-SEQ                          VALUE 'Y'.       01740000
017500         88  PS-START-SEQ                        VALUE 'N'.       01750000
017600     05  PS-CHECKED-IN-FOUND-SW       PIC X(01)  VALUE 'N'.       01760000
017700         88  PS-CHECKED-IN-FOUND                 VALUE 'Y'.       01770000
017800         88  PS-NO-CHECKED-IN-FOUND              VALUE 'N'.       01780000
017900     05  PS-CASEPACK-SPLIT-EXISTS-SW    PIC  X(01)  VALUE 'N'.    01790000
018000         88  PS-CASEPACK-SPLIT-EXISTS               VALUE 'Y'.    01800000
018100         88  PS-NO-CASEPACK-SPLIT-EXISTS            VALUE 'N'.    01810000
018200     05  PS-CHECKED-IN-SW               PIC  X(01)  VALUE 'N'.    01820000
018300         88  PS-CHECKED-IN                          VALUE 'Y'.    01830000
018400         88  PS-NOT-CHECKED-IN                      VALUE 'N'.    01840000
018500     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01850000
018600         88  PS-NO-ERROR                            VALUE 'Y'.    01860000
018700         88  PS-ERROR                               VALUE 'N'.    01870000
018800     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01880000
018900         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01890000
019000         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01900000
019100     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01910000
019200         88  PS-DONE                                VALUE 'Y'.    01920000
019300         88  PS-NOT-DONE                            VALUE 'N'.    01930000
019400     05  PS-VERIFIED-RECEIVER-SW        PIC  X(01)  VALUE 'N'.    01940000
019500         88  PS-VERIFIED-RECEIVER                   VALUE 'Y'.    01950000
019600     05  PS-REDISTRO-SW               PIC X(01)  VALUE 'N'.       01960000
019700         88  PS-REDISTRO-OK                      VALUE 'Y'.       01970000
019800         88  PS-REDISTRO-NOT-OK                  VALUE 'N'.       01980000
019900     05  PS-LINE-VERIFIED-SW          PIC X(01)  VALUE 'N'.       01990000
020000         88  PS-LINE-VERIFIED                    VALUE 'Y'.       02000000
020100     05  PS-DISTHD-EXISTS-SW          PIC X(01)  VALUE 'N'.       02010000
020200         88  PS-DISTHD-EXISTS                    VALUE 'Y'.       02020000
020300         88  PS-NOT-DISTHD-EXISTS                VALUE 'N'.       02030000
020400     05  PS-OUTBOUND-EXISTS-SW        PIC X(01)  VALUE 'N'.       02040000
020500         88  PS-OUTBOUND-EXISTS                  VALUE 'Y'.       02050000
020600         88  PS-NO-OUTBOUND-EXISTS               VALUE 'N'.       02060000
020700     05  PS-ASNS-TO-WMS-SW            PIC X(01)  VALUE 'N'.       02070000
020800         88  PS-ASNS-TO-WMS-YES                  VALUE 'Y'.       02080000
020900         88  PS-ASNS-TO-WMS-NO                   VALUE 'N'.       02090000
021000     05  PS-RECEIVER-SW               PIC X(01)  VALUE 'N'.       02100000
021100         88  PS-VALID-RCVR                       VALUE 'Y'.       02110000
021200         88  PS-INVALID-RCVR                     VALUE 'N'.       02120000
021300                                                                  02130000
021400*----------------------------------------------------------------*02140000
021500*                                               **   WR # 230ZZ  *02150000
021600* INCLUDED PROGRAM SWITCH FOR XLKUT001 (L D I A M)               *02160000
021700*----------------------------------------------------------------*02170000
021800                                                                  02180000
021900     05  PS-CALL-API-SW               PIC  X    VALUE 'N'.        02190000
022000         88  PS-CALL-API-NO                     VALUE 'N'.        02200000
022100         88  PS-CALL-API-YES                    VALUE 'Y'.        02210000
022200                                                                  02220000
022300*----------------------------------------------------------------*02230000
022400* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *02240000
022500*----------------------------------------------------------------*02250000
022600                                                                  02260000
022700                                                                  02270000
022800 01  PV-PROGRAM-VARIABLES.                                        02280000
022900     05  PV-CARTON-COUNT                PIC S9(09)  VALUE +0      02290000
023000                                                    COMP-3.       02300000
023100     05  PV-SUB                         PIC S9(04)  VALUE +0      02310000
023200                                                    COMP SYNC.    02320000
023300     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02330000
023400                                                    COMP SYNC.    02340000
023500     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02350000
023600                                                    COMP-3.       02360000
023700     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02370000
023800                                                    COMP-3.       02380000
023900     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02390000
024000                                                    COMP-3.       02400000
024100     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02410000
024200                                                    COMP-3.       02420000
024300     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02430000
024400                                                    COMP-3.       02440000
024500     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02450000
024600                                                    COMP-3.       02460000
024700     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02470000
024800                                                    COMP-3.       02480000
024900     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02490000
025000                                                    COMP SYNC.    02500000
025100     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02510000
025200                                                    COMP SYNC.    02520000
025300     05  PV-ITEM                        PIC S9(04)  VALUE +0      02530000
025400                                                    COMP SYNC.    02540000
025500     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02550000
025600                                                    COMP SYNC.    02560000
025700     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02570000
025800                                                    COMP SYNC.    02580000
025900     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02590000
026000                                                    COMP SYNC.    02600000
026100     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02610000
026200                                                    COMP SYNC.    02620000
026300     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02630000
026400                                                    COMP SYNC.    02640000
026500     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02650000
026600                                                    COMP SYNC.    02660000
026700     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02670000
026800                                                    COMP SYNC.    02680000
026900     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02690000
027000                                                    COMP SYNC.    02700000
027100     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02710000
027200                                                    COMP SYNC.    02720000
027300     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02730000
027400                                                    COMP SYNC.    02740000
027500     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02750000
027600                                                    COMP SYNC.    02760000
027700     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0      02770000
027800                                                    COMP-3.       02780000
027900     05  PV-UNRSLVD-TRBL-COUNT          PIC S9(09)  VALUE ZERO    02790000
028000                                                    COMP-3.       02800000
028100     05  PV-RSLVD-TRBL-COUNT            PIC S9(09)  VALUE ZERO    02810000
028200                                                    COMP-3.       02820000
028300     05  PV-AP-VERIFY-ITM-QTY           PIC S9(05)  VALUE +0      02830000
028400                                                    COMP.         02840000
028500     05  PV-ACTL-CART-CNT               PIC S9(09)  VALUE +0      02850000
028600                                                    COMP.         02860000
028700     05  PV-PACK-BY-ST-IND            PIC X(01)    VALUE SPACE.   02870000
028800         88  PV-PACK-BY-ST-IND-YES                 VALUE 'Y'.     02880000
028900                                                                  02890000
029000     05  PV-PO-NBR                    PIC S9(09)   COMP           02900000
029100                                                   VALUE ZERO.    02910000
029200     05  PV-REC-SEQ-NBR               PIC S9(09)   COMP           02920000
029300                                                   VALUE ZERO.    02930000
029400     05  PV-DISTRO-QTY                PIC S9(07)   VALUE +0.      02940000
029500     05  PV-BASE-DISTRO-QTY           PIC S9(07)   VALUE +0.      02950000
029600     05  PV-PO-LNE-NBR                PIC S9(9) COMP VALUE +0.    02960000
029700     05  PV-TROUBLE-COUNT             PIC 9(03)    VALUE ZEROS.   02970000
029800     05  PV-NOT-IN-TROUBLE-COUNT      PIC 9(03)    VALUE ZEROS.   02980000
029900     05  PV-OPER-UNT-ID               PIC S9(4) COMP.             02990000
030000     05  PV-FCLTY-ID                  PIC S9(4) COMP.             03000000
030100                                                                  03010000
030200     05  PV-PO-NBR-PIC9               PIC S9(11) VALUE +0.        03020000
030300     05  PV-REC-SEQ-NBR-PIC9          PIC S9(11) VALUE +0.        03030000
030400     05  PV-PO-LNE-NBR-PIC9           PIC S9(11) VALUE +0.        03040000
030500     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     03050000
030600                                                     COMP.        03060000
030700                                                                  03070000
030800*----------------------------------------------------------------*03080000
030900*                                                    WR # 230ZZ  *03090000
031000* CHANGED THE STRUCTURE OF PV-SKU AND ADDES NEW VARIABLES        *03100000
031100*----------------------------------------------------------------*03110000
031200*                                                                 03120000
031300                                                                  03130000
031400     05  PV-SKU-DEPT                   PIC X(03).                 03140000
031500     05  PV-SKU-SEQ                    PIC X(08).                 03150000
031600     05  PV-SKU-SEQ-TEMP               PIC S9(8)V COMP-3.         03160000
031700     05  PV-DISP-CL-SKU.                                          03170000
031800         10 PV-DISP-CL                 PIC X(02).                 03180000
031900         10 FILLER                     PIC X(01) VALUE ' '.       03190000
032000         10 PV-DISP-SKU                PIC 9(08).                 03200000
032100*                                                                 03210000
032200*----------------------------------------------------------------*03220000
032300* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *03230000
032400*----------------------------------------------------------------*03240000
032500*                                                                 03250000
032600     05  PV-CRE-TMST.                                             03260000
032700         10  FILLER                     PIC X(02).                03270000
032800         10  PV-CRE-YY                  PIC X(02).                03280000
032900         10  FILLER                     PIC X(01).                03290000
033000         10  PV-CRE-MM                  PIC X(02).                03300000
033100         10  FILLER                     PIC X(01).                03310000
033200         10  PV-CRE-DD                  PIC X(02).                03320000
033300         10  FILLER                     PIC X(01).                03330000
033400         10  PV-CRE-HRS                 PIC X(02).                03340000
033500         10  FILLER                     PIC X(01).                03350000
033600         10  PV-CRE-MIN                 PIC X(02).                03360000
033700         10  FILLER                     PIC X(10).                03370000
033800     05  PV-CREATE-DTE.                                           03380000
033900         10  PV-CREATE-MM               PIC X(02).                03390000
034000         10  FILLER                     PIC X(01) VALUE '/'.      03400000
034100         10  PV-CREATE-DD               PIC X(02).                03410000
034200         10  FILLER                     PIC X(01) VALUE '/'.      03420000
034300         10  PV-CREATE-YY               PIC X(02).                03430000
034400     05  PV-CREATE-TME.                                           03440000
034500         10  PV-CREATE-HRS              PIC X(02).                03450000
034600         10  FILLER                     PIC X(01) VALUE ':'.      03460000
034700         10  PV-CREATE-MIN              PIC X(02).                03470000
034800                                                                  03480000
034900** CHG0094517  CHANGED PO-NBR LENGTH FROM 7 TO 8                  03490000
035000     05  PV-DISP-PO-NBR                 PIC 9(8).                 03500000
035100     05  PV-DISP-REC-SEQ-NBR            PIC 9(4).                 03510000
035200     05  PV-DISP-PO-LNE-NBR             PIC 9(3).                 03520000
035300     05  PV-DISP-OPER-UNT-ID            PIC 9(4).                 03530000
035400     05  PV-DISP-FCLTY-ID               PIC 9(4).                 03540000
035500                                                                  03550000
035600     05  PV-DISP-OPER                   PIC ZZZ9.                 03560000
035700     05  PV-DISP-PO                     PIC 9(08).                03570000
035800     05  PV-DISP-RCVR                   PIC 9(04).                03580000
035900     05  PV-DISP-COUNT                  PIC 9(04).                03590000
036000     05  PV-CICS-MSG-AREA               PIC  X(100) VALUE SPACES. 03600000
036100                                                                  03610000
036200******    WR # 27201 - START                                      03620000
036300     05  PV-VRFD-LWST-RTL-AMT           PIC S9(7)V9(2) VALUE +0   03630000
036400                                            COMP-3.               03640000
036500******    WR # 27201 - END                                        03650000
036600                                                                  03660000
036700*---------------------------------------------------------------* 03670000
036800*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 03680000
036900*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           * 03690000
037000*   APPLICATION-SPECIFIC COMMAREA.                              * 03700000
037100*---------------------------------------------------------------* 03710000
037200*                                                                 03720000
037300*----------------------------------------------------------------*03730000
037400*                                                **   WR # 230ZZ *03740000
037500* CHANGE THE STRUCTURE OF LQW TO MATCH WITH ASC STRUCTURE        *03750000
037600*----------------------------------------------------------------*03760000
037700*                                                                 03770000
037800 01  LQW-LIST-QUEUE-WORK-AREA.                                    03780000
037900     05  LQW-BLOCK-MODIFIED             PIC X(01)   VALUE SPACE.  03790000
038000     05  LQW-ITEM-ENTRIES               OCCURS 9 TIMES            03800000
038100                                        INDEXED BY LQW-IDX.       03810000
038200         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03820000
038300         10  LQW-TEMP-SELECTED-SW       PIC X(01).                03830000
038400         10  LQW-SELECTED-SW            PIC X(01).                03840000
038500             88  LQW-SELECT                         VALUE 'S'.    03850000
038600             88  LQW-DESELECT                       VALUE ' '.    03860000
038700         10  LQW-ACTION                 PIC X(3).                 03870000
038800         10  LQW-LINE-NUMBER            PIC 9(4).                 03880000
038900         10  LQW-SKU.                                             03890000
039000             15  LQW-DEPT               PIC X(03).                03900000
039100             15  LQW-CL                 PIC X(02).                03910000
039200             15  LQW-SEQ                PIC S9(8)V COMP-3.        03920000
039300         10  LQW-SKU-DESC               PIC X(25).                03930000
039400         10  LQW-ITM-NBR                PIC S9(15)V               03940000
039500                                            COMP-3.               03950000
039600         10  LQW-VER-NBR                PIC S9(09)                03960000
039700                                            COMP.                 03970000
039800         10  LQW-STATUS                 PIC X(2).                 03980000
039900         10  LQW-OTR                    PIC 9(5).                 03990000
040000         10  LQW-PS-ITEM                PIC 9(5).                 04000000
040100         10  LQW-DETAIL-ITEM            PIC 9(5).                 04010000
040200         10  LQW-VERIFY-ITEM            PIC 9(5).                 04020000
040300******    WR # 27201 - START                                      04030000
040400*        10  LQW-APRON-DTE              PIC X(8).                 04040000
040500         10  LQW-VRFD-LWST-RTL-AMT      PIC S9(7)V9(2)            04050000
040600                                            COMP-3.               04060000
040700******    WR # 27201 - END                                        04070000
040800         10  LQW-TROUBLE                PIC X(13).                04080000
040900         10  LQW-PKITEM-CREAT-UID       PIC X(8).                 04090000
041000         10  LQW-PURITM-UNT-QTY         PIC S9(09)                04100000
041100                                            COMP.                 04110000
041200         10  LQW-PURITM-UNT-RTL-PR-AMT  PIC S9(06)V99             04120000
041300                                            COMP-3.               04130000
041400         10  LQW-PURITM-GP-RTL-AMT      PIC S9(05)V99             04140000
041500                                            COMP-3.               04150000
041600         10  LQW-PURITM-GP-QTY          PIC S9(04)                04160000
041700                                            COMP.                 04170000
041800         10  LQW-ITEM-VND-STYL-NAME     PIC X(08).                04180000
041900         10  LQW-LINE-TRBL-SW           PIC X(01).                04190000
042000         10  LQW-CASEPACK-SPLIT-SW      PIC X(01).                04200000
042100             88  LQW-CASEPACK-SPLIT-YES              VALUE 'Y'.   04210000
042200             88  LQW-CASEPACK-SPLIT-NO               VALUE 'N'.   04220000
042300         10  LQW-CHECKED-IN-SW          PIC X(01).                04230000
042400             88  LQW-CHECKED-IN-YES                  VALUE 'Y'.   04240000
042500             88  LQW-CHECKED-IN-NO                   VALUE 'N'.   04250000
042600         10  LQW-MNFST-CARTON-SW        PIC X(01).                04260000
042700             88  LQW-MANIFEST-YES                    VALUE 'Y'.   04270000
042800             88  LQW-MANIFEST-NO                     VALUE 'N'.   04280000
042900                                                                  04290000
043000*----------------------------------------------------------------*04300000
043100*   CHANGES MADE FOR WR # 230ZZ ENDS HERE.                        04310000
043200*----------------------------------------------------------------*04320000
043300                                                                  04330000
043400/                                                                 04340000
043500*---------------------------------------------------------------* 04350000
043600*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 04360000
043700*---------------------------------------------------------------* 04370000
043800                                                                  04380000
043900     COPY PCWS016.                                                04390000
044000                                                                  04400000
044100***************************************************************** 04410000
044200* COPYBOOK FOR WMS VENDOR SHIPMENT CONTROL MODULE               * 04420000
044300***************************************************************** 04430000
044400     COPY WSWS001.                                                04440000
044500/                                                                 04450000
044600*---------------------------------------------------------------* 04460000
044700*  RECORD LAYOUT FOR THE PACKSLIP SELECTION TEMP STORAGE QUEUE. * 04470000
044800*---------------------------------------------------------------* 04480000
044900                                                                  04490000
045000     COPY RCWS013.                                                04500000
045100                                                                  04510000
045200*---------------------------------------------------------------* 04520000
045300*  RECORD LAYOUT FOR THE TROUBLE ROUTINE                          04530000
045400*---------------------------------------------------------------* 04540000
045500                                                                  04550000
045600     COPY TMWS500.                                                04560000
045700                                                                  04570000
045800*---------------------------------------------------------------* 04580000
045900*                                                **   WR # 230ZZ* 04590000
046000*  RECORD LAYOUT FOR LOGISTICS DOMAIN ITEM ACCESS MODULE        * 04600000
046100*---------------------------------------------------------------* 04610000
046200                                                                  04620000
046300     COPY XLWS001.                                                04630000
046400                                                                  04640000
046500*----------------------------------------------------------------*04650000
046600*   CHANGES MADE FOR WR # 230ZZ ENDS HERE.                        04660000
046700*----------------------------------------------------------------*04670000
046800/                                                                 04680000
046900*---------------------------------------------------------------* 04690000
047000*    MAP LAYOUT                                                 * 04700000
047100*---------------------------------------------------------------* 04710000
047200                                                                  04720000
047300     COPY RCKM255.                                                04730000
047400/                                                                 04740000
047500*                                                                 04750000
047600*----------------------------------------------------------------*04760000
047700*                                                    WR # 230ZZ  *04770000
047800* CHANGED THE FILLER OF MR-OCCURS-LAYOUT FROM X(133) TO X(141)   *04780000
047900* AS THE FIELD SIZE FOR SKU WAS INCREASED IN THE MAP RCKM255     *04790000
048000*----------------------------------------------------------------*04800000
048100*                                                                 04810000
048200 01  MR-OCCURS-LAYOUT                   REDEFINES  RC255AO.       04820000
048300     05  FILLER                         PIC X(156).               04830004
048400     05  MR-SCROLL-AREA                 OCCURS 09 TIMES.          04840000
048500         10  MR-SELECTL                 PIC S9(04) COMP.          04850000
048600         10  MR-SELECTA                 PIC  X(01).               04860000
048700         10  MR-SELECTC                 PIC  X(01).               04870000
048800         10  MR-SELECTH                 PIC  X(01).               04880000
048900         10  MR-SELECT                  PIC  X(01).               04890000
049000                                                                  04900000
049100         10  MR-LINEL                   PIC S9(04) COMP.          04910000
049200         10  MR-LINEA                   PIC  X(01).               04920000
049300         10  MR-LINEC                   PIC  X(01).               04930000
049400         10  MR-LINEH                   PIC  X(01).               04940000
049500         10  MR-LINE.                                             04950000
049600             15  MR-LINE-N              PIC  ZZZ9.                04960000
049700                                                                  04970000
049800         10  MR-SKUL                    PIC S9(04) COMP.          04980000
049900         10  MR-SKUA                    PIC  X(01).               04990000
050000         10  MR-SKUC                    PIC  X(01).               05000000
050100         10  MR-SKUH                    PIC  X(01).               05010000
050200         10  MR-SKU                     PIC  X(11).               05020000
050300                                                                  05030000
050400         10  MR-DETAIL-ITEML            PIC S9(04) COMP.          05040000
050500         10  MR-DETAIL-ITEMA            PIC  X(01).               05050000
050600         10  MR-DETAIL-ITEMC            PIC  X(01).               05060000
050700         10  MR-DETAIL-ITEMH            PIC  X(01).               05070000
050800         10  MR-DETAIL-ITEM.                                      05080000
050900             15  MR-DETAIL-ITEM-N       PIC  ZZZZ9.               05090000
051000                                                                  05100000
051100                                                                  05110000
051200         10  MR-STATUSL                 PIC S9(04) COMP.          05120000
051300         10  MR-STATUSA                 PIC  X(01).               05130000
051400         10  MR-STATUSC                 PIC  X(01).               05140000
051500         10  MR-STATUSH                 PIC  X(01).               05150000
051600         10  MR-STATUS                  PIC  X(02).               05160000
051700                                                                  05170000
051800         10  MR-OTRL                    PIC S9(04) COMP.          05180000
051900         10  MR-OTRA                    PIC  X(01).               05190000
052000         10  MR-OTRC                    PIC  X(01).               05200000
052100         10  MR-OTRH                    PIC  X(01).               05210000
052200         10  MR-OTR                     PIC  X(05).               05220000
052300                                                                  05230000
052400         10  MR-PSL                     PIC S9(04) COMP.          05240000
052500         10  MR-PSA                     PIC  X(01).               05250000
052600         10  MR-PSC                     PIC  X(01).               05260000
052700         10  MR-PSH                     PIC  X(01).               05270000
052800         10  MR-PS.                                               05280000
052900             15  MR-PS-N                PIC  ZZZZ9.               05290000
053000                                                                  05300000
053100         10  MR-VERIFY-ITEML            PIC S9(04) COMP.          05310000
053200         10  MR-VERIFY-ITEMA            PIC  X(01).               05320000
053300         10  MR-VERIFY-ITEMC            PIC  X(01).               05330000
053400         10  MR-VERIFY-ITEMH            PIC  X(01).               05340000
053500         10  MR-VERIFY-ITEM.                                      05350000
053600             15  MR-VERIFY-ITEM-N       PIC  ZZZZ9.               05360000
053700                                                                  05370000
053800******    WR # 27201 - START                                      05380000
053900*        10  MR-APRON-DATEL             PIC S9(04) COMP.          05390000
054000*        10  MR-APRON-DATEA             PIC  X(01).               05400000
054100*        10  MR-APRON-DATEC             PIC  X(01).               05410000
054200*        10  MR-APRON-DATE-H            PIC  X(01).               05420000
054300*        10  MR-APRON-DATE              PIC  X(05).               05430000
054400         10  MR-VRFD-LWST-RTLL          PIC S9(04) COMP.          05440000
054500         10  MR-VRFD-LWST-RTLA          PIC  X(01).               05450000
054600         10  MR-VRFD-LWST-RTLC          PIC  X(01).               05460000
054700         10  MR-VRFD-LWST-RTLH          PIC  X(01).               05470000
054800         10  MR-VRFD-LWST-RTL.                                    05480000
054900             15 MR-VRFD-LWST-RTL-N      PIC  ZZZZZZ.ZZ.           05490000
055000******    WR # 27201 - END                                        05500000
055100                                                                  05510000
055200         10  MR-TROUBLEL                PIC S9(04) COMP.          05520000
055300         10  MR-TROUBLEA                PIC  X(01).               05530000
055400         10  MR-TROUBLEC                PIC  X(01).               05540000
055500         10  MR-TROUBLE-H               PIC  X(01).               05550000
055600         10  MR-TROUBLE                 PIC  X(13).               05560000
055700                                                                  05570000
055800         10  MR-PKITEM-CRE-UIDL         PIC S9(04) COMP.          05580000
055900         10  MR-PKITEM-CRE-UIDA         PIC  X(01).               05590000
056000         10  MR-PKITEM-CRE-UIDC         PIC  X(01).               05600000
056100         10  MR-PKITEM-CRE-UIDH         PIC  X(01).               05610000
056200         10  MR-PKITEM-CRE-UID          PIC  X(08).               05620000
056300*                                                                 05630000
056400*----------------------------------------------------------------*05640000
056500* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *05650000
056600*----------------------------------------------------------------*05660000
056700*                                                                 05670000
056800     EJECT                                                        05680000
056900*---------------------------------------------------------------* 05690000
057000*    ATTRIBUTE SETTINGS COPYBOOK.                               * 05700000
057100*---------------------------------------------------------------* 05710000
057200                                                                  05720000
057300     COPY DPWS015.                                                05730000
057400                                                                  05740000
057500*---------------------------------------------------------------* 05750000
057600*    FUNCTION KEYS COPYBOOK.                                    * 05760000
057700*---------------------------------------------------------------* 05770000
057800                                                                  05780000
057900     COPY DPWS016.                                                05790000
058000                                                                  05800000
058100*---------------------------------------------------------------* 05810000
058200*    NUMERIC EDIT LAYOUT.                                       * 05820000
058300*---------------------------------------------------------------* 05830000
058400                                                                  05840000
058500     COPY DPWS010I.                                               05850000
058600                                                                  05860000
058700/                                                                 05870000
058800******************************************************************05880008
058900** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **05890008
058910** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **05891008
059000******************************************************************05900008
059100                                                                  05910000
059200     COPY DPWS030.                                                05920000
059210     COPY DPWS930.                                                05921008
059300                                                                  05930000
059400/                                                                 05940000
059500*---------------------------------------------------------------* 05950000
059600*    STANDARD COMMAREA.                                         * 05960000
059700*---------------------------------------------------------------* 05970000
059800                                                                  05980000
059900     COPY DPWS020.                                                05990000
060000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                06000000
060100                                                                  06010000
060200*---------------------------------------------------------------* 06020000
060300* INTER-APPLICATION COMMAREA.                                   * 06030000
060400* RCWS012 - INTER-APPLICATION COMMAREA FROM THE PACK SLIP UPDT  * 06040000
060500* RCWS015 - INTER-APPLICATION COMMAREA FROM THE PACK SLIP LIST  * 06050000
060600*---------------------------------------------------------------* 06060000
060700                                                                  06070000
060800         10  INTER-APPL-COMM-AREA       PIC X(200).               06080000
060900     COPY PCWS000.                                                06090000
061000     COPY POWS017.                                                06100000
061100                                                                  06110000
061200     COPY RCWS012.                                                06120000
061300     COPY RCWS015.                                                06130000
061400*---------------------------------------------------------------* 06140000
061500*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 06150000
061600*---------------------------------------------------------------* 06160000
061700         10  ASC-SPECIFIC-COMMAREA.                               06170000
061800             15  ASC-LIST-KEYS.                                   06180000
061900                 20  ASC-PO-NBR             PIC 9(08).            06190000
062000                 20  ASC-REC-SEQ-NBR        PIC 9(04).            06200001
062100                 20  ASC-STAT               PIC X(02).            06210000
062200                 20  ASC-OPR-ID             PIC ZZZ9.             06220000
062300                 20  ASC-FACT               PIC ZZZ9.             06230000
062400             15  ASC-OTHER-TOP-OF-SCREEN-DATA.                    06240000
062500                 20  ASC-PACKAGE-TYPE-CDE             PIC X(1).   06250000
062600                 20  ASC-TRECEIV-DATA.                            06260000
062700                     25  ASC-TRECEIV-EXPTED-CART-CNT  PIC 9(5).   06270000
062800                     25  ASC-TRECEIV-ACTL-CART-CNT    PIC 9(5).   06280000
062900                     25  ASC-TPURITM-SKU.                         06290000
063000                         30  ASC-TPURCHS-DEPT-NBR     PIC X(3).   06300000
063100                         30  ASC-TPURITM-CL-NBR       PIC X(2).   06310000
063200                         30  ASC-TPURITM-SKU-SEQ-NBR  PIC X(8).   06320000
063300                     25  ASC-ITEM-SKU-DESC            PIC X(25).  06330000
063400                     25  ASC-TITEM-VND-STYL-NAME      PIC X(20).  06340000
063410                     25  ASC-CRE-OPER                 PIC 9(04).  06341005
063420                     25  ASC-CURR-OPER                PIC 9(04).  06342005
063500             15  ASC-BLOCK-ENTRIES      OCCURS 2 TIMES.           06350000
063600                 20  ASC-BLOCK-MODIFIED-SW                        06360000
063700                                        PIC X(01).                06370000
063800                     88  ASC-BLOCK-NOT-MODIFIED    VALUE 'N'.     06380000
063900                     88  ASC-BLOCK-MODIFIED        VALUE 'Y'.     06390000
064000                                                                  06400000
064100                 20  ASC-ITEM-ARRAY.                              06410000
064200                     25  ASC-ITEM-ENTRIES OCCURS 9 TIMES.         06420000
064300                         30  ASC-LIST-ITEM-NUMBER                 06430000
064400                                        PIC S9(09) COMP-3.        06440000
064500                         30  ASC-TEMP-SELECTED-SW                 06450000
064600                                        PIC X(01).                06460000
064700                             88  ASC-VALID-SELECT  VALUE ' '      06470000
064800                                                         'S'      06480000
064900                                                         'B'      06490000
065000                                                         'E'.     06500000
065100                             88  ASC-TEMP-NO-SELECT               06510000
065200                                                   VALUE ' '.     06520000
065300                             88  ASC-TEMP-SELECT   VALUE 'S'.     06530000
065400                             88  ASC-TEMP-BEGIN    VALUE 'B'.     06540000
065500                             88  ASC-TEMP-END      VALUE 'E'.     06550000
065600                         30  ASC-SELECTED-SW                      06560000
065700                                        PIC X(01).                06570000
065800                             88  ASC-NO-SELECT     VALUE ' '.     06580000
065900                             88  ASC-SELECT        VALUE 'S'.     06590000
066000                             88  ASC-BEGIN         VALUE 'B'.     06600000
066100                             88  ASC-END           VALUE 'E'.     06610000
066200                         30  ASC-ACTION            PIC X(03).     06620000
066300                         30  ASC-LINE-NUMBER       PIC 9(04).     06630000
066400*                                                                 06640000
066500*----------------------------------------------------------------*06650000
066600*                                                **   WR # 230ZZ *06660000
066700* CHANGED THE STRUCTURE OF ASC TO MATCH THE APPL COMMAREA        *06670000
066800*----------------------------------------------------------------*06680000
066900*                                                                 06690000
067000                         30  ASC-SKU.                             06700000
067100                             35  ASC-DEPT          PIC X(03).     06710000
067200                             35  ASC-CL            PIC X(02).     06720000
067300                             35  ASC-SEQ           PIC S9(8)V     06730000
067400                                                       COMP-3.    06740000
067500*----------------------------------------------------------------*06750000
067600*   CHANGES MADE FOR WR # 230ZZ ENDS HERE.                        06760000
067700*----------------------------------------------------------------*06770000
067800                                                                  06780000
067900                         30  ASC-SKU-DESC          PIC X(25).     06790000
068000                         30  ASC-ITM-NBR           PIC S9(15)V    06800000
068100                                                       COMP-3.    06810000
068200                         30  ASC-VER-NBR           PIC S9(09)     06820000
068300                                                       COMP.      06830000
068400                         30  ASC-STATUS            PIC X(2).      06840000
068500                         30  ASC-OTR               PIC X(5).      06850000
068600                         30  ASC-PS-ITEM           PIC ZZZZ9.     06860000
068700                         30  ASC-DETAIL-ITEM       PIC ZZZZ9.     06870000
068800                         30  ASC-VERIFY-ITEM       PIC ZZZZ9.     06880000
068900******    WR # 27201 - START                                      06890000
069000*                        30  ASC-APRON-DTE         PIC X(8).      06900000
069100                         30  ASC-VRFD-LWST-RTL-AMT PIC S9(7)V9(2) 06910000
069200                                                   COMP-3.        06920000
069300******    WR # 27201 - END                                        06930000
069400                         30  ASC-TROUBLE           PIC X(13).     06940000
069500                         30  ASC-PKITEM-CRE-UID    PIC X(8).      06950000
069600                         30  ASC-FIELDS-TO-BE-PASSED.             06960000
069700                             35  ASC-PURITM-UNT-QTY               06970000
069800                                                   PIC S9(09)     06980000
069900                                                       COMP.      06990000
070000                             35  ASC-PURITM-UNT-RTL-PR-AMT        07000000
070100                                                   PIC S9(06)V99  07010000
070200                                                       COMP-3.    07020000
070300                             35  ASC-PURITM-GP-RTL-AMT            07030000
070400                                                   PIC S9(05)V99  07040000
070500                                                       COMP-3.    07050000
070600                             35  ASC-PURITM-GP-QTY PIC S9(04)     07060000
070700                                                       COMP.      07070000
070800                             35  ASC-ITEM-VND-STYL-NAME           07080000
070900                                                   PIC X(08).     07090000
071000                         30  ASC-LINE-TRBL-SW                     07100000
071100                                        PIC X(01).                07110000
071200                             88  ASC-LINE-IN-TROUBLE  VALUE 'Y'.  07120000
071300                             88  ASC-LINE-DISTRO-TRBL VALUE 'D'.  07130000
071400                         30  ASC-CASEPACK-SPLIT-SW                07140000
071500                                        PIC X(01).                07150000
071600                             88  ASC-CASEPACK-SPLIT-YES           07160000
071700                                                      VALUE 'Y'.  07170000
071800                             88  ASC-CASEPACK-SPLIT-NO            07180000
071900                                                      VALUE 'N'.  07190000
072000                         30  ASC-CHECKED-IN-SW                    07200000
072100                                        PIC X(01).                07210000
072200                             88  ASC-CHECKED-IN-YES               07220000
072300                                                      VALUE 'Y'.  07230000
072400                             88  ASC-CHECKED-IN-NO                07240000
072500                                                      VALUE 'N'.  07250000
072600                                                                  07260000
072700                         30  ASC-MNFST-CTN-SW                     07270000
072800                                        PIC X(01).                07280000
072900                             88  ASC-MANIFEST-YES                 07290000
073000                                                      VALUE 'Y'.  07300000
073100                             88  ASC-MANIFEST-NO                  07310000
073200                                                      VALUE 'N'.  07320000
073300                                                                  07330000
073400             15  ASC-BLK-SUB            PIC S9(04) COMP SYNC.     07340000
073500             15  ASC-ITEM-SUB           PIC S9(04) COMP SYNC.     07350000
073600             15  ASC-SEL-SUB            PIC S9(04) COMP.          07360000
073700             15  ASC-SEL-ITEM           PIC S9(04) COMP.          07370000
073800             15  ASC-NUMBER-OF-ITEMS-READ                         07380000
073900                                        PIC S9(09) COMP-3.        07390000
074000             15  ASC-NUMBER-OF-SELECTED-ITEMS                     07400000
074100                                        PIC S9(09) COMP-3.        07410000
074200             15  ASC-NUMBER-OF-TS-ITEMS PIC S9(05) COMP-3.        07420000
074300             15  ASC-ITEMS-DISPLAYED    PIC S9(03) COMP-3.        07430000
074400             15  ASC-ITEM-AT-TOP-OF-PANEL                         07440000
074500                                        PIC S9(09) COMP-3.        07450000
074600             15  ASC-ITEM-AT-BOT-OF-PANEL                         07460000
074700                                        PIC S9(09) COMP-3.        07470000
074800             15  ASC-HIGHEST-BLOCK-WRITTEN                        07480000
074900                                        PIC S9(04) COMP SYNC.     07490000
075000             15  ASC-START-OF-SELECTED-RANGE                      07500000
075100                                        PIC S9(09) COMP-3.        07510000
075200             15  ASC-END-OF-SELECTED-RANGE                        07520000
075300                                        PIC S9(09) COMP-3.        07530000
075400             15  ASC-ITEMS-LEFT-INDICATOR                         07540000
075500                                        PIC X(01).                07550000
075600                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     07560000
075700                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     07570000
075800             15  ASC-TEMP-QUEUE-UPDATE-SW                         07580000
075900                                        PIC X(01).                07590000
076000                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     07600000
076100                 88  ASC-UPDATE-TSQ2               VALUE '2'.     07610000
076200                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     07620000
076300             15  ASC-LIST-QUEUE-NAME.                             07630000
076400                 20  ASC-LIST-TERM-ID   PIC X(04).                07640000
076500                 20  ASC-LIST-TASK-NUMBER                         07650000
076600                                        PIC S9(05) COMP-3.        07660000
076700                 20  ASC-LIST-SEQ       PIC 9(01).                07670000
076800             15  ASC-SEL-QUEUE-NAME-IN   PIC X(08).               07680000
076900             15  ASC-SEL-QUEUE-NAME-OUT.                          07690000
077000                 20  ASC-SEL-TERM-ID-OUT PIC X(04).               07700000
077100                 20  ASC-SEL-TASK-NUMBER-OUT                      07710000
077200                                         PIC S9(05) COMP-3.       07720000
077300                 20  ASC-SEL-SEQ-OUT     PIC 9(01).               07730000
077400                                                                  07740000
077500             15  ASC-START-ITEM-REQUEST.                          07750000
077600                 20  ASC-START-ITEM-REQUEST-N  PIC 9(07).         07760000
077700             15  ASC-USE-SELECTION-QUEUE-IND   PIC X(01).         07770000
077800                 88  ASC-USE-SELECTION-QUEUE   VALUE 'Y'.         07780000
077900             15  ASC-HOLD-INTER-APPL           PIC X(200).        07790000
078000             15  ASC-INTER-APPL-CODE-IND       PIC X(01).         07800000
078100                 88 ASC-INTER-APPL-PKSL-LIST   VALUE 'P'.         07810000
078200             15  ASC-TROUB-STATUS              PIC X(11).         07820000
078300/                                                                 07830000
078400*---------------------------------------------------------------* 07840000
078500*    ABEND PROCESSING COPYBOOK.                                 * 07850000
078600*---------------------------------------------------------------* 07860000
078700                                                                  07870000
078800     COPY DPWS013.                                                07880000
078900                                                                  07890000
079000/                                                                 07900000
079100*---------------------------------------------------------------* 07910000
079200*    OPEN TO RECEIVE COPYBOOK.                                  * 07920000
079300*---------------------------------------------------------------* 07930000
079400                                                                  07940000
079500     COPY PCWS020.                                                07950000
079600/                                                                 07960000
079700*---------------------------------------------------------------* 07970000
079800*    DB2 AREA FOR THE WORK ORDER TABLE                          * 07980000
079900*---------------------------------------------------------------* 07990000
080000     EXEC SQL                                                     08000000
080100          INCLUDE TWRKORD                                         08010000
080200     END-EXEC.                                                    08020000
080300                                                                  08030000
080400/                                                                 08040000
080500*---------------------------------------------------------------* 08050000
080600*    DB2 AREA FOR THE RECEIVER                                  * 08060000
080700*---------------------------------------------------------------* 08070000
080800     EXEC SQL                                                     08080000
080900          INCLUDE TRECEIV                                         08090000
081000     END-EXEC.                                                    08100000
081100                                                                  08110000
081200/                                                                 08120000
081300*---------------------------------------------------------------* 08130000
081400*    DB2 AREA FOR THE PURCHASE ORDER TABLE                      * 08140000
081500*---------------------------------------------------------------* 08150000
081600     EXEC SQL                                                     08160000
081700          INCLUDE TPURCHS                                         08170000
081800     END-EXEC.                                                    08180000
081900                                                                  08190000
082000/                                                                 08200000
082100*----------------------------------------------------------------*08210000
082200*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                08220000
082300*----------------------------------------------------------------*08230000
082400     EXEC SQL                                                     08240000
082500          INCLUDE TTRBNTF                                         08250000
082600     END-EXEC.                                                    08260000
082700                                                                  08270000
082800/                                                                 08280000
082900*----------------------------------------------------------------*08290000
083000*    DB2 DCLGEN FOR THE TROUBLE REASON TABLE                      08300000
083100*----------------------------------------------------------------*08310000
083200     EXEC SQL                                                     08320000
083300          INCLUDE TTRBRSN                                         08330000
083400     END-EXEC.                                                    08340000
083500                                                                  08350000
083600/                                                                 08360000
083700*---------------------------------------------------------------* 08370000
083800*    DB2 AREA FOR THE PACKSLIP TABLE                            * 08380000
083900*---------------------------------------------------------------* 08390000
084000     EXEC SQL                                                     08400000
084100          INCLUDE TPKSLIP                                         08410000
084200     END-EXEC.                                                    08420000
084300                                                                  08430000
084400     EXEC SQL                                                     08440000
084500          INCLUDE TINPKSU                                         08450000
084600     END-EXEC.                                                    08460000
084700                                                                  08470000
084800     EXEC SQL                                                     08480000
084900          INCLUDE TSHUUPC                                         08490000
085000     END-EXEC.                                                    08500000
085100                                                                  08510000
085200     EXEC SQL                                                     08520000
085300          INCLUDE TSHUNLO                                         08530000
085400     END-EXEC.                                                    08540000
085500                                                                  08550000
085600     EXEC SQL                                                     08560000
085700          INCLUDE TSULBXF                                         08570000
085800     END-EXEC.                                                    08580000
085900                                                                  08590000
086000/                                                                 08600000
086100*---------------------------------------------------------------* 08610000
086200*    DB2 AREA FOR THE PACKITEM TABLE                            * 08620000
086300*---------------------------------------------------------------* 08630000
086400     EXEC SQL                                                     08640000
086500          INCLUDE TPKITEM                                         08650000
086600     END-EXEC.                                                    08660000
086700                                                                  08670000
086800                                                                  08680000
086900*---------------------------------------------------------------* 08690000
087000*    DC-DISTRIBUTION TRANSACTION HEADER                         * 08700000
087100*---------------------------------------------------------------* 08710000
087200     EXEC SQL                                                     08720000
087300          INCLUDE TDISTHD                                         08730000
087400     END-EXEC.                                                    08740000
087500                                                                  08750000
087600*---------------------------------------------------------------* 08760000
087700*    ODD UNIT TABLE                                             * 08770000
087800*---------------------------------------------------------------* 08780000
087900     EXEC SQL                                                     08790000
088000          INCLUDE RCT00009                                        08800000
088100     END-EXEC.                                                    08810000
088200                                                                  08820000
088300******    WR # 27201 - END                                        08830000
088400*---------------------------------------------------------------* 08840000
088500*    RCT_PRC_RCPT TABLE                                         * 08850000
088600*---------------------------------------------------------------* 08860000
088700     EXEC SQL                                                     08870000
088800          INCLUDE RCT00019                                        08880000
088900     END-EXEC.                                                    08890000
089000                                                                  08900000
089100*---------------------------------------------------------------* 08910000
089200*    TKRPRPM TABLE                                              * 08920000
089300*---------------------------------------------------------------* 08930000
089400     EXEC SQL                                                     08940000
089500          INCLUDE TKRPRPM                                         08950000
089600     END-EXEC.                                                    08960000
089700******    WR # 27201 - START                                      08970000
089800                                                                  08980000
089900******************************************************************08990000
090000*    CARTON MASTER                                                09000000
090100******************************************************************09010000
090200     EXEC SQL                                                     09020000
090300         INCLUDE SUT00024                                         09030000
090400     END-EXEC.                                                    09040000
090500/                                                                 09050000
090600******************************************************************09060000
090700*    CARTON UPC                                                   09070000
090800******************************************************************09080000
090900     EXEC SQL                                                     09090000
091000         INCLUDE SUT00028                                         09100000
091100     END-EXEC.                                                    09110000
091200/                                                                 09120000
091300*---------------------------------------------------------------* 09130000
091400*    DB2 AREA FOR COMMUNICATIONS                                * 09140000
091500*---------------------------------------------------------------* 09150000
091600     EXEC SQL                                                     09160000
091700          INCLUDE SQLCA                                           09170000
091800     END-EXEC.                                                    09180000
091900                                                                  09190000
092000/                                                                 09200000
092100*---------------------------------------------------------------* 09210000
092200*  CURSOR TO LIST TPURITM                                       * 09220000
092300*---------------------------------------------------------------* 09230000
092400                                                                  09240000
092500     EXEC SQL                                                     09250000
092600          DECLARE TPURITM-CSR CURSOR FOR                          09260000
092700           SELECT A.PO_NBR                                        09270000
092800                , A.VER_NBR                                       09280000
092900                , A.SKU_SEQ_NBR                                   09290000
093000*               , A.CL_NBR                                        09300000
093100                , A.ITM_NBR                                       09310000
093200*               , A.SKU_DESC                                      09320000
093300                , A.APP_PO_LNE_NBR                                09330000
093400*               , A.VEND_STYL_NAME                                09340000
093500                , A.UNT_QTY                                       09350000
093600                , A.UNT_RTL_PR_AMT                                09360000
093700                , A.STATUS_CDE                                    09370000
093800                , A.GP_RTL_AMT                                    09380000
093900                , A.GP_QTY                                        09390000
094000                , A.PO_LNE_NBR                                    09400000
094100                , B.ORD_LNE_NBR                                   09410000
094200                , B.STATUS_CDE                                    09420000
094300                , B.DTL_CK_ITM_QTY                                09430000
094400                , B.PKSL_ITM_QTY                                  09440000
094500                , B.MKING_APRON_TMST                              09450000
094510                , C.CRE_OPER_UNT_ID                               09451005
094520                , C.CURR_OPER_UNT_ID                              09452005
094600           FROM   TPURITM A                                       09460000
094700                , TRECITM B                                       09470000
094800                , TRECEIV C                                       09480000
094900           WHERE  A.PO_NBR         = :DK-ORD-NBR                  09490000
095000             AND  A.PO_NBR         = B.ORD_NBR                    09500000
095100             AND  A.PO_NBR         = C.ORD_NBR                    09510000
095200             AND  A.APP_PO_LNE_NBR = B.ORD_LNE_NBR                09520000
095300             AND  B.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR             09530000
095400             AND  B.REC_SEQ_NBR    = C.REC_SEQ_NBR                09540000
095500             AND  A.VER_STATUS_CDE = 'A'                          09550000
095600             AND  B.VER_STATUS_CDE = 'A'                          09560000
095700             AND  C.VER_STATUS_CDE = 'A'                          09570000
095800         ORDER BY APP_PO_LNE_NBR                                  09580000
095900          WITH UR                                                 09590000
096000     END-EXEC.                                                    09600000
096100                                                                  09610000
096200     COPY DPWS276.                                                09620000
096300/                                                                 09630000
096400/                                                                 09640000
096500 LINKAGE SECTION.                                                 09650000
096600                                                                  09660000
096700 01  DFHCOMMAREA.                                                 09670000
096800     05  FILLER                         OCCURS  1 TO 4072 TIMES   09680000
096900                                        DEPENDING ON EIBCALEN.    09690000
097000         10  FILLER                     PIC X.                    09700000
097100                                                                  09710000
097200/                                                                 09720000
097300 PROCEDURE DIVISION.                                              09730000
097400*---------------------------------------------------------------* 09740000
097500*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 09750000
097600*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 09760000
097700*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 09770000
097800*---------------------------------------------------------------* 09780000
097900 0000-MAIN-MODULE.                                                09790000
098000                                                                  09800000
098100     INITIALIZE DP030-CICS-API-FIELDS.                            09810000
098200                                                                  09820000
098300     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09830000
098400     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          09840000
098500     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         09850000
098600                                                                  09860000
098700     SET DP030-RECEIVE-APPL-MAP                                   09870000
098800         DP030-OVERRIDE-APPL-ERROR TO TRUE.                       09880000
098900                                                                  09890000
099000     MOVE LENGTH OF RC255AI        TO DP030-MAP-LENGTH (1).       09900000
099100     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     09910000
099200                                                                  09920000
099300     PERFORM 0001-CALL-CICS-ARCH-API.                             09930000
099400     PERFORM 1000-CONTROL-PROCESSING                              09940000
099500                                                                  09950000
099600     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     09960000
099700     PERFORM 0001-CALL-CICS-ARCH-API.                             09970000
099800                                                                  09980000
099900*---------------------------------------------------------------* 09990000
100000*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 10000000
100100*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 10010000
100200*---------------------------------------------------------------* 10020000
100300 0001-CALL-CICS-ARCH-API.                                         10030000
100410     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      10041008
100500                                    DFHCOMMAREA                   10050008
100600                                    DP030-CICS-API-FIELDS         10060008
100700                                    DP020-STANDARD-COMMAREA       10070008
100800                                    RC255AI.                      10080008
100900                                                                  10090000
101000     IF  DP030-RC-CALL-SUCCESSFUL OR                              10100000
101100         DP030-RC-APPL-ERROR                                      10110000
101200         CONTINUE                                                 10120000
101300     ELSE                                                         10130000
101400         SET DP013-NO-ROLLBACK                                    10140000
101500             DP013-XCTL-DISPLAY-RESTART                           10150000
101600             DP013-CICS-ABEND      TO TRUE                        10160000
101700         MOVE '0001-CALL-CICS-ARCH-API'                           10170000
101800                                   TO DP013-PARAGRAPH             10180000
101820         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O10182008
101830-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10183008
102100         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      10210000
102200         PERFORM DP013-0000-PROCESS-ABEND                         10220000
102300     END-IF.                                                      10230000
102400                                                                  10240000
102500*----------------------------------------------------------------*10250000
102600* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *10260000
102700* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *10270000
102800*                                                                *10280000
102900* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *10290000
103000*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *10300000
103100*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *10310000
103200*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *10320000
103300*----------------------------------------------------------------*10330000
103400                                                                  10340000
103500 1000-CONTROL-PROCESSING.                                         10350000
103600                                                                  10360000
103700     EVALUATE TRUE                                                10370000
103800         WHEN DP020-NEXT-ACT-INITIAL                              10380000
103900             INITIALIZE ASC-SPECIFIC-COMMAREA                     10390000
104000             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            10400000
104100                                      ASC-SEL-TERM-ID-OUT         10410000
104200             MOVE DP020-SRC-TASK-NUMBER                           10420000
104300                                   TO ASC-LIST-TASK-NUMBER        10430000
104400                                      ASC-SEL-TASK-NUMBER-OUT     10440000
104500             MOVE PC-LIST-QUEUE-SEQ                               10450000
104600                                   TO ASC-LIST-SEQ                10460000
104700             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT             10470000
104800             PERFORM 1100-PROCESS-INTER-APPL-COMM                 10480000
104900             IF  PS-COMMAREA-NOT-VALID                            10490000
105000                 SET DP020-MSG-FATAL                              10500000
105100                     DP020-NEXT-ACT-APPL-ERROR TO TRUE            10510000
105200             ELSE                                                 10520000
105300                 MOVE INTER-APPL-COMM-AREA                        10530000
105400                                   TO ASC-HOLD-INTER-APPL         10540000
105500                 PERFORM 4000-BUILD-INITIAL-PANEL                 10550000
105600             END-IF                                               10560000
105700                                                                  10570000
105800         WHEN DP020-NEXT-ACT-READ-MAP                             10580000
105900             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10590000
106000                                   TO PV-TOP-ITEM                 10600000
106100             PERFORM 2000-PROCESS-PANEL                           10610000
106200                                                                  10620000
106300         WHEN DP020-NEXT-ACT-RETURN                               10630000
106400              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       10640000
106500                                   TO PV-TOP-ITEM                 10650000
106600              MOVE ZERO            TO ASC-ITEM-AT-TOP-OF-PANEL    10660000
106700              MOVE ASC-HOLD-INTER-APPL                            10670000
106800                                TO INTER-APPL-COMM-AREA           10680000
106900              PERFORM 2050-DELETE-LIST-QUEUE                      10690000
107000              PERFORM 4000-BUILD-INITIAL-PANEL                    10700000
107100                                                                  10710000
107200         WHEN OTHER                                               10720000
107300             SET DP013-LOGIC-ABEND TO TRUE                        10730000
107400             SET DP013-NO-ROLLBACK TO TRUE                        10740000
107500             MOVE '1000-CONTROL-PROCESSING'                       10750000
107600                                   TO DP013-PARAGRAPH             10760000
107700             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    10770000
107800                                   TO DP013-MESSAGE-TEXT(1)       10780000
107900             PERFORM DP013-0000-PROCESS-ABEND                     10790000
108000     END-EVALUATE.                                                10800000
108100                                                                  10810000
108200/                                                                 10820000
108300*----------------------------------------------------------------*10830000
108400* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA               *10840000
108500*----------------------------------------------------------------*10850000
108600                                                                  10860000
108700 1100-PROCESS-INTER-APPL-COMM.                                    10870000
108800                                                                  10880000
108900     SET PS-COMMAREA-VALID          TO TRUE.                      10890000
109000     MOVE SPACE                     TO ASC-START-ITEM-REQUEST.    10900000
109100     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INTER-APPL-CODE-IND.   10910000
109200                                                                  10920000
109300     EVALUATE DP020-INT-APPL-FORMAT-IND                           10930000
109400                                                                  10940000
109500         WHEN PC-INTER-APPL-CRIT-SPEC                             10950000
109600                                                                  10960000
109700             IF RC012-PO-NBR = ZEROES                             10970000
109800                 MOVE PC-TSYMSG-00736  TO DP020-MSG-NUMBER        10980000
109900                 SET PS-ERROR                                     10990000
110000                     PS-COMMAREA-NOT-VALID                        11000000
110100                     DP020-MSG-FATAL   TO TRUE                    11010000
110200             END-IF                                               11020000
110300             IF RC012-REC-SEQ-NBR = ZEROES                        11030000
110400                 MOVE PC-TSYMSG-00737  TO DP020-MSG-NUMBER        11040000
110500                 SET PS-ERROR                                     11050000
110600                     PS-COMMAREA-NOT-VALID                        11060000
110700                     DP020-MSG-FATAL   TO TRUE                    11070000
110800             END-IF                                               11080000
110900             IF PS-NO-ERROR                                       11090000
111000               AND RC012-OPER-UNT-ID = ZEROES                     11100000
111100               AND RC012-FCLTY-ID    = ZEROES                     11110000
111200                 MOVE PC-TSYMSG-00815 TO DP020-MSG-NUMBER         11120000
111300                 SET PS-ERROR                                     11130000
111400                     DP020-MSG-FATAL                              11140000
111500                     PS-COMMAREA-NOT-VALID                        11150000
111600                     DP020-NEXT-ACT-APPL-ERROR TO TRUE            11160000
111700             ELSE                                                 11170000
111800                 MOVE RC012-PO-NBR      TO ASC-PO-NBR             11180000
111900                                           DK-ORD-NBR             11190000
112000                 MOVE RC012-REC-SEQ-NBR TO ASC-REC-SEQ-NBR        11200000
112100                                           DK-RCVR-SEQ-NBR        11210000
112200                 MOVE RC012-OPER-UNT-ID TO ASC-OPR-ID             11220000
112300                                           DK-OPR-ID              11230000
112400                 MOVE RC012-FCLTY-ID    TO ASC-FACT               11240000
112500                                           DK-FACT                11250000
112600                 PERFORM 1110-CHECK-RECEIV-TYPE                   11260000
112700                 IF PS-INVALID-RCVR                               11270000
112800                    MOVE PC-TSYMSG-00954 TO DP020-MSG-NUMBER      11280000
112900                    SET  PS-ERROR                                 11290000
113000                         DP020-MSG-FATAL                          11300000
113100                         PS-COMMAREA-NOT-VALID                    11310000
113200                         DP020-NEXT-ACT-APPL-ERROR TO TRUE        11320000
113300                 END-IF                                           11330000
113400                 IF RECEIV-PKGNG-CDE = 'M' OR 'I'                 11340000
113500                     MOVE PC-TSYMSG-02194 TO DP020-MSG-NUMBER     11350000
113600                     SET DP020-MSG-WARNING TO TRUE                11360000
113700                 END-IF                                           11370000
113800             END-IF                                               11380000
113900                                                                  11390000
114000                                                                  11400000
114100         WHEN PC-INTER-APPL-PKSL-LIST                             11410000
114200             SET ASC-USE-SELECTION-QUEUE TO TRUE                  11420000
114300             MOVE RC015-NUMBER-OF-SELECTED-ITEMS                  11430000
114400                  TO ASC-NUMBER-OF-SELECTED-ITEMS                 11440000
114500             MOVE RC015-NUMBER-OF-TS-ITEMS                        11450000
114600                  TO ASC-NUMBER-OF-TS-ITEMS                       11460000
114700             MOVE RC015-SEL-QUEUE-NAME TO ASC-SEL-QUEUE-NAME-IN   11470000
114800             PERFORM 1130-PREPARE-PKSL-LIST-ENTRY                 11480000
114900     END-EVALUATE.                                                11490000
115000                                                                  11500000
115100 1110-CHECK-RECEIV-TYPE.                                          11510000
115200                                                                  11520000
115300     IF ASC-PO-NBR > ZEROES                                       11530000
115400       AND ASC-REC-SEQ-NBR > ZEROES                               11540000
115500         MOVE ASC-PO-NBR      TO PV-PO-NBR                        11550000
115600         MOVE ASC-REC-SEQ-NBR TO PV-REC-SEQ-NBR                   11560000
115700                                                                  11570000
115800         EXEC SQL                                                 11580000
115900             SELECT PKGNG_CDE                                     11590000
116000                   ,VER_STATUS_CDE                                11600000
116100               INTO :RECEIV-PKGNG-CDE                             11610000
116200                   ,:RECEIV-VER-STATUS-CDE                        11620000
116300               FROM TRECEIV                                       11630000
116400              WHERE ORD_NBR         =  :PV-PO-NBR                 11640000
116500                AND REC_SEQ_NBR     =  :PV-REC-SEQ-NBR            11650000
116600               WITH UR                                            11660000
116700         END-EXEC                                                 11670000
116800                                                                  11680000
116900         EVALUATE TRUE                                            11690000
117000           WHEN SQLCODE = ZERO                                    11700000
117100               IF RECEIV-VER-STATUS-CDE = 'I'                     11710000
117200                  SET PS-INVALID-RCVR TO TRUE                     11720000
117300               ELSE                                               11730000
117400                  SET PS-VALID-RCVR   TO TRUE                     11740000
117500               END-IF                                             11750000
117600           WHEN SQLWARN0 NOT = SPACE                              11760000
117700           WHEN SQLCODE  NOT = ZERO                               11770000
117800               MOVE '1110-CHECK-RECEIV-TYPE' TO DP013-PARAGRAPH   11780000
117900               MOVE 'SELECT TRECEIV' TO DP013-MESSAGE-TEXT (1)    11790000
118000               MOVE SQLCA            TO DP013-SQLCA               11800000
118100               MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (1)  11810000
118200               SET DP013-DB2-ABEND   TO TRUE                      11820000
118300                                                                  11830000
118400               MOVE PV-PO-NBR        TO PV-DISP-PO-NBR            11840000
118500               MOVE PV-PO-LNE-NBR    TO PV-DISP-PO-LNE-NBR        11850000
118600               MOVE PV-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR       11860000
118700               MOVE ASC-OPR-ID       TO PV-DISP-OPER-UNT-ID       11870000
118800               MOVE ASC-FACT         TO PV-DISP-FCLTY-ID          11880000
118900                                                                  11890000
119000               MOVE '  PO    REC  LNE OPER FCLTYR'                11900000
119100                                   TO DP013-MESSAGE-TEXT (3)      11910000
119200                                                                  11920000
119300               STRING                                             11930000
119400                  PV-DISP-PO-NBR '-'                              11940000
119500                  PV-DISP-REC-SEQ-NBR '-'                         11950000
119600                  PV-DISP-PO-LNE-NBR '-'                          11960000
119700                  PV-DISP-OPER-UNT-ID '-'                         11970000
119800                  PV-DISP-FCLTY-ID                                11980000
119900                  DELIMITED BY SIZE INTO DP013-MESSAGE-TEXT (4)   11990000
120000               PERFORM DP013-0000-PROCESS-ABEND                   12000000
120100         END-EVALUATE                                             12010000
120200     END-IF.                                                      12020000
120300                                                                  12030000
120400*----------------------------------------------------------------*12040000
120500*  ENTRY IS FROM A LIST. GET THE KEYS FROM THE TEMP STORAGE      *12050000
120600*  QUEUE PASSED FROM THE LIST.                                   *12060000
120700*----------------------------------------------------------------*12070000
120800                                                                  12080000
120900 1120-PREPARE-LIST-ENTRY.                                         12090000
121000      MOVE PC016-MAX-ITEMS         TO ASC-SEL-SUB.                12100000
121100      MOVE ZERO                    TO ASC-SEL-ITEM.               12110000
121200      PERFORM 2300-GET-NEXT-RECORD.                               12120000
121300                                                                  12130000
121400*----------------------------------------------------------------*12140000
121500*  ENTRY IS FROM PACK SLIP LIST. GET THE KEYS FROM THE TEMP      *12150000
121600*  STORAGE QUEUE PASSED FROM THE LIST.                           *12160000
121700*----------------------------------------------------------------*12170000
121800 1130-PREPARE-PKSL-LIST-ENTRY.                                    12180000
121900                                                                  12190000
122000      MOVE RC013-MAX-ITEMS         TO ASC-SEL-SUB.                12200000
122100      MOVE ZERO                    TO ASC-SEL-ITEM.               12210000
122200      PERFORM 2400-GET-NEXT-PKSL-RECORD.                          12220000
122300      PERFORM 1110-CHECK-RECEIV-TYPE.                             12230000
122400      IF PS-INVALID-RCVR                                          12240000
122500         MOVE PC-TSYMSG-00954 TO DP020-MSG-NUMBER                 12250000
122600         SET  PS-ERROR                                            12260000
122700              DP020-MSG-FATAL                                     12270000
122800              PS-COMMAREA-NOT-VALID                               12280000
122900              DP020-NEXT-ACT-APPL-ERROR TO TRUE                   12290000
123000      END-IF                                                      12300000
123100      IF RECEIV-PKGNG-CDE = 'M' OR 'I'                            12310000
123200          MOVE PC-TSYMSG-02194 TO DP020-MSG-NUMBER                12320000
123300          SET DP020-MSG-WARNING TO TRUE                           12330000
123400      END-IF.                                                     12340000
123500                                                                  12350000
123600*----------------------------------------------------------------*12360000
123700* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *12370000
123800* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *12380000
123900* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *12390000
124000* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *12400000
124100* FUNCTION KEYS CAN GET THIS FAR.                                *12410000
124200*----------------------------------------------------------------*12420000
124300                                                                  12430000
124400 2000-PROCESS-PANEL.                                              12440000
124500     EVALUATE TRUE                                                12450000
124600         WHEN DP020-SRC-AID = DP016-CLEAR                         12460000
124700             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    12470000
124800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12480000
124900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12490000
125000                                                                  12500000
125100         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    12510000
125200             PERFORM 2050-DELETE-LIST-QUEUE                       12520000
125300             PERFORM 4000-BUILD-INITIAL-PANEL                     12530000
125400                                                                  12540000
125500         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   12550000
125600             PERFORM 2140-DESELECT-ALL-ITEMS                      12560000
125700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12570000
125800                                                                  12580000
125900         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 12590000
126000              PERFORM 2150-SELECT-ALL-ITEMS                       12600000
126100              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                12610000
126200                                                                  12620000
126300         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             12630000
126400             IF ASC-USE-SELECTION-QUEUE                           12640000
126500                 PERFORM 6200-DEL-LIST-QUEUE                      12650000
126600                 IF ASC-INTER-APPL-PKSL-LIST                      12660000
126700                     PERFORM 2400-GET-NEXT-PKSL-RECORD            12670000
126800                 ELSE                                             12680000
126900                     PERFORM 2300-GET-NEXT-RECORD                 12690000
127000                 END-IF                                           12700000
127100                 PERFORM 4000-BUILD-INITIAL-PANEL                 12710000
127200                 PERFORM 3200-RESET-ATTRIBUTES                    12720000
127300             ELSE                                                 12730000
127400*                --- BOTTOM OF LIST ---                           12740000
127500                 MOVE PC-TSYMSG-00070                             12750000
127600                                   TO DP020-MSG-NUMBER            12760000
127700                 SET DP020-MSG-INFORMATIONAL                      12770000
127800                                   TO TRUE                        12780000
127900             END-IF                                               12790000
128000                                                                  12800000
128100         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             12810000
128200             IF ASC-USE-SELECTION-QUEUE                           12820000
128300                 PERFORM 6200-DEL-LIST-QUEUE                      12830000
128400                 IF ASC-INTER-APPL-PKSL-LIST                      12840000
128500                     PERFORM 2410-GET-PREV-PKSL-RECORD            12850000
128600                 ELSE                                             12860000
128700                     PERFORM 2310-GET-PREV-RECORD                 12870000
128800                 END-IF                                           12880000
128900                 PERFORM 4000-BUILD-INITIAL-PANEL                 12890000
129000                 PERFORM 3200-RESET-ATTRIBUTES                    12900000
129100             ELSE                                                 12910000
129200*                --- TOP OF LIST ---                              12920000
129300                 MOVE PC-TSYMSG-00069                             12930000
129400                                   TO DP020-MSG-NUMBER            12940000
129500                 SET DP020-MSG-INFORMATIONAL                      12950000
129600                                   TO TRUE                        12960000
129700             END-IF                                               12970000
129800         WHEN OTHER                                               12980000
129900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 12990000
130000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13000000
130100             IF  PS-NO-ERROR                                      13010000
130200                 SET DP030-CONTINUE-GO TO TRUE                    13020000
130300                 PERFORM 2100-CHECK-FUNCTION-KEY                  13030000
130400             ELSE                                                 13040000
130500                 SET DP030-OVERRIDE-GO TO TRUE                    13050000
130600             END-IF                                               13060000
130700     END-EVALUATE.                                                13070000
130800                                                                  13080000
130900/                                                                 13090000
131000*----------------------------------------------------------------*13100000
131100*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *13110000
131200*----------------------------------------------------------------*13120000
131300 2050-DELETE-LIST-QUEUE.                                          13130000
131400                                                                  13140000
131500     EXEC CICS                                                    13150000
131600         DELETEQ TS                                               13160000
131700           QUEUE (ASC-LIST-QUEUE-NAME)                            13170000
131800            RESP (PV-CICS-RESP)                                   13180000
131900     END-EXEC.                                                    13190000
132000                                                                  13200000
132100     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       13210000
132200        (PV-CICS-RESP = DFHRESP(QIDERR))                          13220000
132300         CONTINUE                                                 13230000
132400     ELSE                                                         13240000
132500         SET DP013-CICS-ABEND      TO TRUE                        13250000
132600         SET DP013-NO-ROLLBACK     TO TRUE                        13260000
132700                                                                  13270000
132800         MOVE '2050-DELETE-LIST-QUEUE'                            13280000
132900                                   TO DP013-PARAGRAPH             13290000
133000         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    13300000
133100                                   TO DP013-MESSAGE-TEXT (1)      13310000
133200         PERFORM DP013-0000-PROCESS-ABEND                         13320000
133300     END-IF.                                                      13330000
133400                                                                  13340000
133500     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  13350000
133600                                                                  13360000
133700/                                                                 13370000
133800*----------------------------------------------------------------*13380000
133900* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*13390000
134000* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *13400000
134100* CICS ARCHITECTURE API.                                         *13410000
134200*----------------------------------------------------------------*13420000
134300 2100-CHECK-FUNCTION-KEY.                                         13430000
134400                                                                  13440000
134500     EVALUATE TRUE                                                13450000
134600         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              13460000
134700             IF ASC-PACKAGE-TYPE-CDE = 'M' OR 'I'                 13470000
134800                MOVE PC-TSYMSG-02463                              13480000
134900                                   TO DP020-MSG-NUMBER            13490000
135000                SET PS-ERROR                                      13500000
135100                    DP030-OVERRIDE-GO                             13510000
135200                    DP020-MSG-FATAL                               13520000
135300                                   TO TRUE                        13530000
135400             ELSE                                                 13540000
135500              IF ASC-STAT = 'VE'                                  13550000
135600                 SET DP030-OVERRIDE-GO TO TRUE                    13560000
135700                 MOVE PC-TSYMSG-00966                             13570000
135800                                  TO DP020-MSG-NUMBER             13580000
135900                 SET PS-ERROR                                     13590000
136000                     DP020-MSG-FATAL                              13600000
136100                                  TO TRUE                         13610000
136200              ELSE                                                13620000
136300                 PERFORM 5000-PREPARE-SEL-QUEUE                   13630000
136400                 PERFORM 7000-FORMAT-COMMAREA                     13640000
136500              END-IF                                              13650000
136600             END-IF                                               13660000
136700                                                                  13670000
136800         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              13680000
136900             IF ASC-PACKAGE-TYPE-CDE = 'M' OR 'I'                 13690000
137000                MOVE PC-TSYMSG-02463                              13700000
137100                                   TO DP020-MSG-NUMBER            13710000
137200                SET PS-ERROR                                      13720000
137300                    DP030-OVERRIDE-GO                             13730000
137400                    DP020-MSG-FATAL                               13740000
137500                                   TO TRUE                        13750000
137600             ELSE                                                 13760000
137700             IF ASC-STAT = 'VE'                                   13770000
137800                 SET DP030-OVERRIDE-GO TO TRUE                    13780000
137900                 MOVE PC-TSYMSG-01196                             13790000
138000                                   TO DP020-MSG-NUMBER            13800000
138100                 SET PS-ERROR                                     13810000
138200                     DP020-MSG-FATAL                              13820000
138300                                   TO TRUE                        13830000
138400             ELSE                                                 13840000
138500                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          13850000
138600                     PERFORM 2160-CHECK-PACK-BY-STORE             13860000
138700                     IF  PV-PACK-BY-ST-IND-YES                    13870000
138800                         MOVE PC-TSYMSG-00928                     13880000
138900                                       TO DP020-MSG-NUMBER        13890000
139000                         SET DP020-MSG-FATAL                      13900000
139100                                       TO TRUE                    13910000
139200                     ELSE                                         13920000
139300                         SET DP030-CONTINUE-GO                    13930000
139400                                       TO TRUE                    13940000
139500                         PERFORM 5050-PREPARE-SEL-QUEUE2          13950000
139600                         IF PS-LINE-VERIFIED                      13960000
139700                            MOVE PC-TSYMSG-00929                  13970000
139800                                              TO DP020-MSG-NUMBER 13980000
139900                            SET PS-ERROR                          13990000
140000                                DP020-MSG-FATAL                   14000000
140100                                              TO TRUE             14010000
140200                         ELSE                                     14020000
140300                         IF PS-DISTHD-EXISTS                      14030000
140400                            MOVE PC-TSYMSG-01793                  14040000
140500                                              TO DP020-MSG-NUMBER 14050000
140600                            SET PS-ERROR                          14060000
140700                                DP020-MSG-FATAL                   14070000
140800                                              TO TRUE             14080000
140900                         ELSE                                     14090000
141000                            IF PS-OUTBOUND-EXISTS                 14100000
141100                               MOVE PC-TSYMSG-03394               14110000
141200                                              TO DP020-MSG-NUMBER 14120000
141300                               SET PS-ERROR                       14130000
141400                                   DP020-MSG-FATAL                14140000
141500                                                 TO TRUE          14150000
141600                            ELSE                                  14160000
141700*** DMH 11/12/12 - BEGIN                                          14170000
141800                               MOVE ASC-OPR-ID TO PV-DISP-OPER    14180000
141900                               MOVE ASC-PO-NBR TO PV-DISP-PO      14190000
142000                               MOVE ASC-REC-SEQ-NBR               14200000
142100                                               TO PV-DISP-RCVR    14210000
142200                                                                  14220000
142300                               MOVE ASC-NUMBER-OF-SELECTED-ITEMS  14230000
142400                                               TO PV-DISP-COUNT   14240000
142500                                                                  14250000
142600                               INITIALIZE PV-CICS-MSG-AREA        14260000
142700                               STRING ' RCKCS255-REDISTRO '       14270000
142800                               DP020-USERID '  '                  14280000
142900                               PV-DISP-OPER '-'                   14290000
143000                               PV-DISP-PO   '-'                   14300000
143100                               PV-DISP-RCVR '   '                 14310000
143200                               ' SELECTION COUNT:'                14320000
143300                                           PV-DISP-COUNT          14330000
143400                                              DELIMITED BY SIZE   14340000
143500                                         INTO PV-CICS-MSG-AREA    14350000
143600                                                                  14360000
143700                              MOVE LENGTH OF PV-CICS-MSG-AREA     14370000
143800                                TO PV-COMMAREA-LENGTH             14380000
143900                                                                  14390000
144000                              EXEC CICS                           14400000
144100                                   WRITEQ TD                      14410000
144200                                    QUEUE ('CSSL')                14420000
144300                                     FROM (PV-CICS-MSG-AREA)      14430000
144400                                   LENGTH (PV-COMMAREA-LENGTH)    14440000
144500                                     RESP (PV-CICS-RESP)          14450000
144600                             END-EXEC                             14460000
144700                                                                  14470000
144800                             MOVE SPACES TO PV-CICS-MSG-AREA      14480000
144900                                                                  14490000
145000*** DMH 11/26/12 - END                                            14500000
145100                               PERFORM 5000-PREPARE-SEL-QUEUE     14510000
145200                               PERFORM 2050-DELETE-LIST-QUEUE     14520000
145300                               PERFORM 4000-BUILD-INITIAL-PANEL   14530000
145400                            END-IF                                14540000
145500                         END-IF                                   14550000
145600                         END-IF                                   14560000
145700                     END-IF                                       14570000
145800                 ELSE                                             14580000
145900                     SET DP030-OVERRIDE-GO                        14590000
146000                                       TO TRUE                    14600000
146100                     MOVE PC-TSYMSG-00057                         14610000
146200                                       TO DP020-MSG-NUMBER        14620000
146300                     SET DP020-MSG-WARNING                        14630000
146400                                       TO TRUE                    14640000
146500                 END-IF                                           14650000
146600              END-IF                                              14660000
146700             END-IF                                               14670000
146800                                                                  14680000
146900*** CREATE TROUBLE (TRBLCRE)                                      14690000
147000         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              14700000
147100              PERFORM 5000-PREPARE-SEL-QUEUE                      14710000
147200              MOVE ASC-PO-NBR  TO PC000-PO-NBR-N                  14720000
147300              MOVE ASC-REC-SEQ-NBR TO PC000-REC-SEQ-NBR-N         14730000
147400              MOVE ASC-OPR-ID  TO PC000-OPERATING-UNIT-ID         14740000
147500              MOVE ASC-FACT    TO PC000-FACILITY-ID               14750000
147600                                                                  14760000
147700*** GOTO PO INSTRUCTION SCREEN                                    14770000
147800          WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)             14780000
147900              PERFORM 5000-PREPARE-SEL-QUEUE                      14790000
148000              MOVE ASC-PO-NBR     TO PO017-PO-NBR                 14800000
148100                                                                  14810000
148200*** UPDATE                                                        14820000
148300         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              14830000
148400              PERFORM 5000-PREPARE-SEL-QUEUE                      14840000
148500             IF ASC-PACKAGE-TYPE-CDE = 'M' OR 'I'                 14850000
148600                MOVE PC-TSYMSG-02463                              14860000
148700                                   TO DP020-MSG-NUMBER            14870000
148800                SET PS-ERROR                                      14880000
148900                    DP030-OVERRIDE-GO                             14890000
149000                    DP020-MSG-FATAL                               14900000
149100                                   TO TRUE                        14910000
149200             ELSE                                                 14920000
149300                 IF  PC000-NUMBER-OF-SELECTED-ITEMS = 0           14930000
149400                     MOVE PC-TSYMSG-00057                         14940000
149500                                    TO DP020-MSG-NUMBER           14950000
149600                     SET PS-ERROR                                 14960000
149700                         DP030-OVERRIDE-GO                        14970000
149800                         DP020-MSG-FATAL                          14980000
149900                                    TO TRUE                       14990000
150000                 ELSE                                             15000000
150100                     PERFORM 7000-FORMAT-COMMAREA                 15010000
150200                 END-IF                                           15020000
150300              END-IF                                              15030000
150400                                                                  15040000
150500*** DELETE                                                        15050000
150600         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              15060000
150700             IF ASC-PACKAGE-TYPE-CDE = 'M' OR 'I'                 15070000
150800                MOVE PC-TSYMSG-02463                              15080000
150900                                   TO DP020-MSG-NUMBER            15090000
151000                SET PS-ERROR                                      15100000
151100                    DP030-OVERRIDE-GO                             15110000
151200                    DP020-MSG-FATAL                               15120000
151300                                   TO TRUE                        15130000
151400             ELSE                                                 15140000
151500              SET PS-NO-CASEPACK-SPLIT-EXISTS TO TRUE             15150000
151600              SET PS-NO-OUTBOUND-EXISTS       TO TRUE             15160000
151700              SET PS-NOT-CHECKED-IN           TO TRUE             15170000
151800              PERFORM 5000-PREPARE-SEL-QUEUE                      15180000
151900              IF PS-CASEPACK-SPLIT-EXISTS                         15190000
152000                  SET DP030-OVERRIDE-GO                           15200000
152100                                    TO TRUE                       15210000
152200                  MOVE PC-TSYMSG-02991                            15220000
152300                                    TO DP020-MSG-NUMBER           15230000
152400                  SET  PS-ERROR                                   15240000
152500                       DP020-MSG-FATAL                            15250000
152600                                    TO TRUE                       15260000
152700              ELSE                                                15270000
152800                 IF PS-OUTBOUND-EXISTS                            15280000
152900                  SET DP030-OVERRIDE-GO                           15290000
153000                                    TO TRUE                       15300000
153100                  MOVE PC-TSYMSG-03395                            15310000
153200                                    TO DP020-MSG-NUMBER           15320000
153300                  SET  PS-ERROR                                   15330000
153400                       DP020-MSG-FATAL                            15340000
153500                                    TO TRUE                       15350000
153600                 ELSE                                             15360000
153700                  IF PS-CHECKED-IN                                15370000
153800                     SET DP030-OVERRIDE-GO                        15380000
153900                                       TO TRUE                    15390000
154000                     MOVE PC-TSYMSG-02972                         15400000
154100                                       TO DP020-MSG-NUMBER        15410000
154200                     SET  PS-ERROR                                15420000
154300                          DP020-MSG-FATAL                         15430000
154400                                       TO TRUE                    15440000
154500                  ELSE                                            15450000
154600                   IF  PC000-NUMBER-OF-SELECTED-ITEMS = 0         15460000
154700                       SET DP030-OVERRIDE-GO                      15470000
154800                                         TO TRUE                  15480000
154900                       MOVE PC-TSYMSG-00057                       15490000
155000                                         TO DP020-MSG-NUMBER      15500000
155100                       SET  PS-ERROR                              15510000
155200                            DP020-MSG-FATAL                       15520000
155300                                         TO TRUE                  15530000
155400                   ELSE                                           15540000
155500                       PERFORM 7000-FORMAT-COMMAREA               15550000
155600                   END-IF                                         15560000
155700                  END-IF                                          15570000
155800                 END-IF                                           15580000
155900               END-IF                                             15590000
156000             END-IF                                               15600000
156100                                                                  15610000
156200*** GOTO TROUBLE LIST                                             15620000
156300         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              15630000
156400             IF ASC-PACKAGE-TYPE-CDE = 'M' OR 'I'                 15640000
156500                MOVE PC-TSYMSG-02463                              15650000
156600                                   TO DP020-MSG-NUMBER            15660000
156700                SET PS-ERROR                                      15670000
156800                    DP030-OVERRIDE-GO                             15680000
156900                    DP020-MSG-FATAL                               15690000
157000                                   TO TRUE                        15700000
157100             ELSE                                                 15710000
157200              PERFORM 5000-PREPARE-SEL-QUEUE                      15720000
157300              IF  PC000-NUMBER-OF-SELECTED-ITEMS = 0              15730000
157400                  SET DP030-OVERRIDE-GO                           15740000
157500                                    TO TRUE                       15750000
157600                  MOVE PC-TSYMSG-00057                            15760000
157700                                    TO DP020-MSG-NUMBER           15770000
157800                  SET  PS-ERROR                                   15780000
157900                       DP020-MSG-FATAL                            15790000
158000                                    TO TRUE                       15800000
158100              ELSE                                                15810000
158200                  PERFORM 7000-FORMAT-COMMAREA                    15820000
158300              END-IF                                              15830000
158400             END-IF                                               15840000
158500                                                                  15850000
158600*** GOTO PRINT MARKING APRON                                      15860000
158700         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              15870000
158800             IF ASC-PACKAGE-TYPE-CDE = 'M' OR 'I'                 15880000
158900                MOVE PC-TSYMSG-02463                              15890000
159000                                   TO DP020-MSG-NUMBER            15900000
159100                SET PS-ERROR                                      15910000
159200                    DP030-OVERRIDE-GO                             15920000
159300                    DP020-MSG-FATAL                               15930000
159400                                   TO TRUE                        15940000
159500             ELSE                                                 15950000
159600              PERFORM 5000-PREPARE-SEL-QUEUE                      15960000
159700              IF  PC000-NUMBER-OF-SELECTED-ITEMS = 0              15970000
159800                  SET DP030-OVERRIDE-GO                           15980000
159900                                    TO TRUE                       15990000
160000                  MOVE PC-TSYMSG-00057                            16000000
160100                                    TO DP020-MSG-NUMBER           16010000
160200                  SET  PS-ERROR                                   16020000
160300                       DP020-MSG-FATAL                            16030000
160400                                    TO TRUE                       16040000
160500              ELSE                                                16050000
160600                  PERFORM 7000-FORMAT-COMMAREA                    16060000
160700              END-IF                                              16070000
160800             END-IF                                               16080000
160900                                                                  16090000
161000         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 16100000
161100             PERFORM 5000-PREPARE-SEL-QUEUE                       16110000
161200             IF  PC000-NUMBER-OF-SELECTED-ITEMS = 0               16120000
161300                 SET DP030-OVERRIDE-GO                            16130000
161400                                   TO TRUE                        16140000
161500                 MOVE PC-TSYMSG-00057                             16150000
161600                                   TO DP020-MSG-NUMBER            16160000
161700                 SET  PS-ERROR                                    16170000
161800                      DP020-MSG-FATAL                             16180000
161900                                   TO TRUE                        16190000
162000             ELSE                                                 16200000
162100                 PERFORM 7000-FORMAT-COMMAREA                     16210000
162200             END-IF                                               16220000
162300                                                                  16230000
162400         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  16240000
162500             MOVE +1               TO PV-TOP-ITEM                 16250000
162600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16260000
162700             PERFORM 3200-RESET-ATTRIBUTES                        16270000
162800                                                                  16280000
162900         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   16290000
163000             PERFORM 2110-BROWSE-BACKWARD                         16300000
163100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16310000
163200             PERFORM 3200-RESET-ATTRIBUTES                        16320000
163300                                                                  16330000
163400         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   16340000
163500             PERFORM 2120-BROWSE-FORWARD                          16350000
163600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16360000
163700             PERFORM 3200-RESET-ATTRIBUTES                        16370000
163800                                                                  16380000
163900         WHEN DP020-SRC-AID = DP016-ENTER                         16390000
164000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   16400000
164100             IF  PS-ERROR                                         16410000
164200                 CONTINUE                                         16420000
164300             ELSE                                                 16430000
164400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             16440000
164500             END-IF                                               16450000
164600                                                                  16460000
164700         WHEN OTHER                                               16470000
164800             PERFORM 2050-DELETE-LIST-QUEUE                       16480000
164900             PERFORM 4000-BUILD-INITIAL-PANEL                     16490000
165000             PERFORM 3200-RESET-ATTRIBUTES                        16500000
165100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16510000
165200     END-EVALUATE.                                                16520000
165300                                                                  16530000
165400/                                                                 16540000
165500*----------------------------------------------------------------*16550000
165600*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *16560000
165700*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *16570000
165800*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *16580000
165900*    MESSAGE.                                                    *16590000
166000*----------------------------------------------------------------*16600000
166100                                                                  16610000
166200 2110-BROWSE-BACKWARD.                                            16620000
166300                                                                  16630000
166400     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    16640000
166500         GIVING PV-TOP-ITEM.                                      16650000
166600                                                                  16660000
166700     IF  ((PV-TOP-ITEM < +1)                                      16670000
166800       OR (PV-TOP-ITEM = +1))                                     16680000
166900         MOVE +1                   TO PV-TOP-ITEM                 16690000
167000*        -- TOP OF LIST --                                        16700000
167100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            16710000
167200         SET DP020-MSG-INFORMATIONAL                              16720000
167300                                   TO TRUE                        16730000
167400     END-IF.                                                      16740000
167500                                                                  16750000
167600/                                                                 16760000
167700*----------------------------------------------------------------*16770000
167800*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *16780000
167900*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *16790000
168000*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *16800000
168100*----------------------------------------------------------------*16810000
168200                                                                  16820000
168300 2120-BROWSE-FORWARD.                                             16830000
168400                                                                  16840000
168500     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              16850000
168600         GIVING PV-TOP-ITEM.                                      16860000
168700                                                                  16870000
168800     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   16880000
168900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            16890000
169000                                   TO PV-TOP-ITEM                 16900000
169100*        -- BOTTOM OF LIST --                                     16910000
169200         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            16920000
169300         SET DP020-MSG-INFORMATIONAL                              16930000
169400                                   TO TRUE                        16940000
169500     ELSE                                                         16950000
169600         COMPUTE PV-BOTTOM-ITEM =                                 16960000
169700             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 16970000
169800         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            16980000
169900*            -- BOTTOM OF LIST --                                 16990000
170000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            17000000
170100             SET DP020-MSG-INFORMATIONAL                          17010000
170200                                   TO TRUE                        17020000
170300         END-IF                                                   17030000
170400     END-IF.                                                      17040000
170500                                                                  17050000
170600/                                                                 17060000
170700*----------------------------------------------------------------*17070000
170800*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *17080000
170900*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *17090000
171000*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *17100000
171100*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *17110000
171200*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *17120000
171300*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *17130000
171400*----------------------------------------------------------------*17140000
171500                                                                  17150000
171600 2130-CHECK-FOR-JUMP-BROWSE.                                      17160000
171700                                                                  17170000
171800     SET PS-NO-ERROR               TO TRUE.                       17180000
171900     IF (ASC-START-ITEM-REQUEST = SPACE)                          17190000
172000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            17200000
172100                                   TO PV-TOP-ITEM                 17210000
172200     ELSE                                                         17220000
172300         MOVE ASC-START-ITEM-REQUEST                              17230000
172400                                   TO DP010I-UNEDITED-FIELD       17240000
172500         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       17250000
172600         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     17260000
172700         SET DP010I-NEGATIVE-NOT-ALLOWED                          17270000
172800                                   TO TRUE                        17280000
172900         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17290008
172910              USING DP010I-NUMERIC-EDIT-AREA                      17291008
173000                                                                  17300000
173100         IF  NOT DP010I-ERROR-DETECTED                            17310000
173200             MOVE DP010I-NUMERIC-FIELD                            17320000
173300                                   TO ASC-START-ITEM-REQUEST-N    17330000
173400             IF  ASC-START-ITEM-REQUEST-N > ZERO                  17340000
173500                 IF  ASC-START-ITEM-REQUEST-N >                   17350000
173600                                          ASC-NUMBER-OF-ITEMS-READ17360000
173700                     MOVE SPACE TO ASC-START-ITEM-REQUEST         17370000
173800                     COMPUTE PV-TOP-ITEM =                        17380000
173900                             ASC-NUMBER-OF-ITEMS-READ             17390000
174000                             - PC-ITEMS-PER-PANEL + 1             17400000
174100                     IF  PV-TOP-ITEM < +1                         17410000
174200                         MOVE +1   TO PV-TOP-ITEM                 17420000
174300                         MOVE PC-TSYMSG-00070                     17430000
174400                                   TO DP020-MSG-NUMBER            17440000
174500                         SET DP020-MSG-INFORMATIONAL              17450000
174600                                   TO TRUE                        17460000
174700                     END-IF                                       17470000
174800                 ELSE                                             17480000
174900                     MOVE ASC-START-ITEM-REQUEST-N                17490000
175000                                   TO PV-TOP-ITEM                 17500000
175100                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      17510000
175200                     COMPUTE PV-BOTTOM-ITEM =                     17520000
175300                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     17530000
175400                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ17540000
175500*                        -- BOTTOM OF LIST --                     17550000
175600                         MOVE PC-TSYMSG-00070                     17560000
175700                                   TO DP020-MSG-NUMBER            17570000
175800                         SET DP020-MSG-INFORMATIONAL              17580000
175900                                   TO TRUE                        17590000
176000                     END-IF                                       17600000
176100                 END-IF                                           17610000
176200             ELSE                                                 17620000
176300*                --- VALUE OUT OF RANGE ----                      17630000
176400                 MOVE PC-TSYMSG-00101                             17640000
176500                                   TO DP020-MSG-NUMBER            17650000
176600                 MOVE -1           TO ASTRTITL                    17660000
176700                 SET DP030-SET-CURSOR-APPL-1                      17670000
176800                                   TO TRUE                        17680000
176900                 MOVE DP015-REVERSE                               17690000
177000                                   TO ASTRTITH                    17700000
177100                 MOVE DP015-RED    TO ASTRTITC                    17710000
177200                 MOVE DP015-UNP-NUM-BRT-MDT                       17720000
177300                                   TO ASTRTITA                    17730000
177400                 SET DP020-MSG-FATAL                              17740000
177500                                   TO TRUE                        17750000
177600                 SET PS-ERROR      TO TRUE                        17760000
177700             END-IF                                               17770000
177800                                                                  17780000
177900         ELSE                                                     17790000
178000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            17800000
178100             MOVE -1               TO ASTRTITL                    17810000
178200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17820000
178300             MOVE DP015-REVERSE    TO ASTRTITH                    17830000
178400             MOVE DP015-RED        TO ASTRTITC                    17840000
178500             MOVE DP015-UNP-NUM-BRT-MDT                           17850000
178600                                   TO ASTRTITA                    17860000
178700             SET DP020-MSG-FATAL   TO TRUE                        17870000
178800             SET PS-ERROR          TO TRUE                        17880000
178900         END-IF                                                   17890000
179000     END-IF.                                                      17900000
179100                                                                  17910000
179200/                                                                 17920000
179300*----------------------------------------------------------------*17930000
179400*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *17940000
179500*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *17950000
179600*----------------------------------------------------------------*17960000
179700 2140-DESELECT-ALL-ITEMS.                                         17970000
179800                                                                  17980000
179900     MOVE +1                       TO ASC-BLK-SUB.                17990000
180000                                                                  18000000
180100     PERFORM 2141-CLEAR-SELECTED-INDS                             18010000
180200         VARYING ASC-ITEM-SUB                                     18020000
180300         FROM 1 BY 1                                              18030000
180400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18040000
180500                                                                  18050000
180600     ADD +1                        TO ASC-BLK-SUB.                18060000
180700                                                                  18070000
180800     PERFORM 2141-CLEAR-SELECTED-INDS                             18080000
180900         VARYING ASC-ITEM-SUB                                     18090000
181000         FROM 1 BY 1                                              18100000
181100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18110000
181200                                                                  18120000
181300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               18130000
181400                                   TO PV-LIST-ITEM-NUMBER.        18140000
181500                                                                  18150000
181600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            18160000
181700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    18170000
181800                                                                  18180000
181900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     18190000
182000        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      18200000
182100         MOVE +1                   TO ASC-BLK-SUB                 18210000
182200                                                                  18220000
182300         PERFORM 5100-WRITE-TEMP-STORAGE                          18230000
182400                                                                  18240000
182500         MOVE +1                   TO PV-BLOCK-NUMBER             18250000
182600                                                                  18260000
182700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18270000
182800             PV-FIRST-BLOCK-IN-ARRAY - 1                          18280000
182900                                                                  18290000
183000         PERFORM                                                  18300000
183100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       18310000
183200                                                                  18320000
183300             PERFORM 4410-READ-TEMP-STORAGE                       18330000
183400                                                                  18340000
183500             PERFORM 2141-CLEAR-SELECTED-INDS                     18350000
183600                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 18360000
183700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18370000
183800                                                                  18380000
183900             PERFORM 5100-WRITE-TEMP-STORAGE                      18390000
184000                                                                  18400000
184100             ADD +1                TO PV-BLOCK-NUMBER             18410000
184200                                                                  18420000
184300         END-PERFORM                                              18430000
184400                                                                  18440000
184500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18450000
184600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18460000
184700                                                                  18470000
184800         PERFORM                                                  18480000
184900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18490000
185000                   ASC-HIGHEST-BLOCK-WRITTEN                      18500000
185100                                                                  18510000
185200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          18520000
185300                                   TO PV-BLOCK-NUMBER             18530000
185400                                                                  18540000
185500             PERFORM 4410-READ-TEMP-STORAGE                       18550000
185600                                                                  18560000
185700             PERFORM 2141-CLEAR-SELECTED-INDS                     18570000
185800                 VARYING ASC-ITEM-SUB                             18580000
185900                 FROM 1 BY 1                                      18590000
186000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18600000
186100                                                                  18610000
186200             PERFORM 5100-WRITE-TEMP-STORAGE                      18620000
186300                                                                  18630000
186400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      18640000
186500                                                                  18650000
186600         END-PERFORM                                              18660000
186700                                                                  18670000
186800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18680000
186900                                   TO PV-BLOCK-NUMBER             18690000
187000                                                                  18700000
187100         PERFORM 4410-READ-TEMP-STORAGE                           18710000
187200     END-IF.                                                      18720000
187300                                                                  18730000
187400                                                                  18740000
187500     MOVE +0                       TO ASC-NUMBER-OF-SELECTED-ITEMS18750000
187600     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.18760000
187700     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  18770000
187800                                                                  18780000
187900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        18790000
188000                                                                  18800000
188100/                                                                 18810000
188200*----------------------------------------------------------------*18820000
188300*    MARK EACH ITEM AS BEING NOT SELECTED.                       *18830000
188400*----------------------------------------------------------------*18840000
188500                                                                  18850000
188600 2141-CLEAR-SELECTED-INDS.                                        18860000
188700                                                                  18870000
188800     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          18880000
188900             NOT EQUAL ZERO                                       18890000
189000         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          18900000
189100             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          18910000
189200                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    18920000
189300                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  18930000
189400                                   TO TRUE                        18940000
189500         END-IF                                                   18950000
189600     END-IF.                                                      18960000
189700                                                                  18970000
189800/                                                                 18980000
189900*----------------------------------------------------------------*18990000
190000*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *19000000
190100*  FOR ALL ITEMS.                                                *19010000
190200*----------------------------------------------------------------*19020000
190300                                                                  19030000
190400 2150-SELECT-ALL-ITEMS.                                           19040000
190500                                                                  19050000
190600     MOVE +1                       TO ASC-BLK-SUB.                19060000
190700                                                                  19070000
190800     PERFORM 2151-SET-SELECTED-INDS                               19080000
190900         VARYING ASC-ITEM-SUB                                     19090000
191000         FROM 1 BY 1                                              19100000
191100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19110000
191200                                                                  19120000
191300     ADD +1                        TO ASC-BLK-SUB.                19130000
191400                                                                  19140000
191500     PERFORM 2151-SET-SELECTED-INDS                               19150000
191600         VARYING ASC-ITEM-SUB                                     19160000
191700         FROM 1 BY 1                                              19170000
191800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19180000
191900                                                                  19190000
192000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               19200000
192100                                   TO PV-LIST-ITEM-NUMBER.        19210000
192200                                                                  19220000
192300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            19230000
192400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    19240000
192500                                                                  19250000
192600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     19260000
192700        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    19270000
192800         MOVE +1                   TO ASC-BLK-SUB                 19280000
192900                                                                  19290000
193000         PERFORM 5100-WRITE-TEMP-STORAGE                          19300000
193100                                                                  19310000
193200         MOVE +1                   TO PV-BLOCK-NUMBER             19320000
193300                                                                  19330000
193400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         19340000
193500             PV-FIRST-BLOCK-IN-ARRAY - 1                          19350000
193600                                                                  19360000
193700         PERFORM                                                  19370000
193800             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       19380000
193900                                                                  19390000
194000             PERFORM 4410-READ-TEMP-STORAGE                       19400000
194100                                                                  19410000
194200             PERFORM 2151-SET-SELECTED-INDS                       19420000
194300                 VARYING ASC-ITEM-SUB                             19430000
194400                 FROM 1 BY 1                                      19440000
194500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19450000
194600                                                                  19460000
194700             PERFORM 5100-WRITE-TEMP-STORAGE                      19470000
194800                                                                  19480000
194900             ADD +1                TO PV-BLOCK-NUMBER             19490000
195000         END-PERFORM                                              19500000
195100                                                                  19510000
195200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         19520000
195300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     19530000
195400                                                                  19540000
195500         PERFORM                                                  19550000
195600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       19560000
195700                   ASC-HIGHEST-BLOCK-WRITTEN                      19570000
195800                                                                  19580000
195900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          19590000
196000                                   TO PV-BLOCK-NUMBER             19600000
196100                                                                  19610000
196200             PERFORM 4410-READ-TEMP-STORAGE                       19620000
196300                                                                  19630000
196400             PERFORM 2151-SET-SELECTED-INDS                       19640000
196500                 VARYING ASC-ITEM-SUB                             19650000
196600                 FROM 1 BY 1                                      19660000
196700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19670000
196800                                                                  19680000
196900             PERFORM 5100-WRITE-TEMP-STORAGE                      19690000
197000                                                                  19700000
197100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      19710000
197200         END-PERFORM                                              19720000
197300                                                                  19730000
197400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             19740000
197500                                   TO PV-BLOCK-NUMBER             19750000
197600                                                                  19760000
197700         PERFORM 4410-READ-TEMP-STORAGE                           19770000
197800     END-IF.                                                      19780000
197900                                                                  19790000
198000     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             19800000
198100          ASC-NUMBER-OF-SELECTED-ITEMS.                           19810000
198200                                                                  19820000
198300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        19830000
198400                                                                  19840000
198500/                                                                 19850000
198600*----------------------------------------------------------------*19860000
198700*    MARK EACH ITEM AS BEING SELECTED.                           *19870000
198800*----------------------------------------------------------------*19880000
198900                                                                  19890000
199000 2151-SET-SELECTED-INDS.                                          19900000
199100                                                                  19910000
199200     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           19920000
199300             NOT EQUAL ZERO                                       19930000
199400         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             19940000
199500             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             19950000
199600                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        19960000
199700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  19970000
199800                                   TO TRUE                        19980000
199900         END-IF                                                   19990000
200000     END-IF.                                                      20000000
200100                                                                  20010000
200200 2160-CHECK-PACK-BY-STORE.                                        20020000
200300     MOVE ASC-PO-NBR               TO PV-PO-NBR.                  20030000
200400     MOVE ASC-REC-SEQ-NBR          TO PV-REC-SEQ-NBR.             20040000
200500     MOVE ASC-OPR-ID               TO PV-OPER-UNT-ID.             20050000
200600     MOVE ASC-FACT                 TO PV-FCLTY-ID.                20060000
200700                                                                  20070000
200800     EXEC SQL                                                     20080000
200900          SELECT PACK_BY_ST_IND                                   20090000
201000            INTO :PV-PACK-BY-ST-IND                               20100000
201100            FROM TRECEIV                                          20110000
201200           WHERE ORD_NBR         =  :PV-PO-NBR                    20120000
201300             AND REC_SEQ_NBR     =  :PV-REC-SEQ-NBR               20130000
201400             AND VER_STATUS_CDE  =  'A'                           20140000
201500     END-EXEC.                                                    20150000
201600                                                                  20160000
201700     EVALUATE TRUE                                                20170000
201800         WHEN SQLCODE = ZERO                                      20180000
201900              CONTINUE                                            20190000
202000         WHEN SQLWARN0 NOT = SPACE                                20200000
202100         WHEN SQLCODE NOT = ZERO                                  20210000
202200              MOVE '2160-CHECK-PACK-BY-STORE'                     20220000
202300                               TO DP013-PARAGRAPH                 20230000
202400              MOVE 'SELECT TRECEIV'                               20240000
202500                               TO DP013-MESSAGE-TEXT (1)          20250000
202600              MOVE SQLCA       TO DP013-SQLCA                     20260000
202700              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        20270000
202800              SET DP013-DB2-ABEND                                 20280000
202900                               TO TRUE                            20290000
203000              PERFORM DP013-0000-PROCESS-ABEND                    20300000
203100     END-EVALUATE.                                                20310000
203200/                                                                 20320000
203300*----------------------------------------------------------------*20330000
203400*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *20340000
203500*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *20350000
203600*----------------------------------------------------------------*20360000
203700 2200-MOVE-SCREEN-TO-COMMAREA.                                    20370000
203800                                                                  20380000
203900     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             20390000
204000     MOVE +1                       TO PV-SUB.                     20400000
204100                                                                  20410000
204200     PERFORM 3100-SET-SUBSCRIPTS.                                 20420000
204300                                                                  20430000
204400     IF  ASTRTITL > ZERO                                          20440000
204500         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      20450000
204600     ELSE                                                         20460000
204700         IF  ASTRTITF = DP015-ERASE-EOF                           20470000
204800             INITIALIZE ASC-START-ITEM-REQUEST                    20480000
204900         END-IF                                                   20490000
205000     END-IF.                                                      20500000
205100                                                                  20510000
205200     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          20520000
205300         VARYING PV-SUB                                           20530000
205400         FROM 1 BY 1                                              20540000
205500         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      20550000
205600                                                                  20560000
205700/                                                                 20570000
205800*----------------------------------------------------------------*20580000
205900*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *20590000
206000*----------------------------------------------------------------*20600000
206100 2210-MOVE-LINES-TO-COMMAREA.                                     20610000
206200                                                                  20620000
206300     IF  MR-SELECTL (PV-SUB) > ZERO                               20630000
206400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     20640000
206500                                   TO TRUE                        20650000
206600         MOVE MR-SELECT (PV-SUB)   TO ASC-TEMP-SELECTED-SW        20660000
206700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      20670000
206800     ELSE                                                         20680000
206900         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                20690000
207000             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         20700000
207100             MOVE SPACE            TO ASC-TEMP-SELECTED-SW        20710000
207200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      20720000
207300         END-IF                                                   20730000
207400     END-IF.                                                      20740000
207500                                                                  20750000
207600     ADD +1                        TO ASC-ITEM-SUB.               20760000
207700                                                                  20770000
207800     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        20780000
207900         ADD +1                    TO ASC-BLK-SUB                 20790000
208000         MOVE +1                   TO ASC-ITEM-SUB                20800000
208100     END-IF.                                                      20810000
208200                                                                  20820000
208300/                                                                 20830000
208400******************************************************************20840000
208500* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *20850000
208600* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *20860000
208700******************************************************************20870000
208800 2300-GET-NEXT-RECORD.                                            20880000
208900                                                                  20890000
209000     ADD +1                        TO ASC-SEL-SUB.                20900000
209100     IF ASC-SEL-SUB > PC016-MAX-ITEMS                             20910000
209200         ADD +1                    TO ASC-SEL-ITEM                20920000
209300         MOVE +1                   TO ASC-SEL-SUB                 20930000
209400     END-IF.                                                      20940000
209500     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 20950000
209600         PERFORM 9100-READ-SEL-QUEUE                              20960000
209700         IF PC016-ITEM (ASC-SEL-SUB) > ZERO                       20970000
209800             INITIALIZE ASC-LIST-KEYS                             20980000
209900             MOVE PC016-PO-NBR-N(ASC-SEL-SUB)      TO ASC-PO-NBR  20990000
210000                                                      DK-ORD-NBR  21000000
210100             MOVE PC016-REC-SEQ-NBR-N(ASC-SEL-SUB) TO             21010000
210200                  ASC-REC-SEQ-NBR                                 21020000
210300                  DK-RCVR-SEQ-NBR                                 21030000
210400             MOVE PC016-OPER-UNT-ID  (ASC-SEL-SUB) TO             21040000
210500                  ASC-OPR-ID                                      21050000
210600                  DK-OPR-ID                                       21060000
210700             MOVE PC016-FCLTY-ID     (ASC-SEL-SUB) TO             21070000
210800                  ASC-FACT                                        21080000
210900                  DK-FACT                                         21090000
211000             SET PC016-INQ (ASC-SEL-SUB)           TO TRUE        21100000
211100             PERFORM 9200-REWRITE-LIST-QUEUE                      21110000
211200         ELSE                                                     21120000
211300             SUBTRACT +1 FROM ASC-SEL-SUB                         21130000
211400*            --- BOTTOM OF LIST ---                               21140000
211500             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            21150000
211600             SET DP020-MSG-INFORMATIONAL                          21160000
211700                                   TO TRUE                        21170000
211800         END-IF                                                   21180000
211900     ELSE                                                         21190000
212000         SUBTRACT +1 FROM ASC-SEL-ITEM                            21200000
212100         MOVE PC016-MAX-ITEMS      TO ASC-SEL-SUB                 21210000
212200         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            21220000
212300         SET DP020-MSG-INFORMATIONAL                              21230000
212400                                   TO TRUE                        21240000
212500     END-IF.                                                      21250000
212600                                                                  21260000
212700/                                                                 21270000
212800******************************************************************21280000
212900* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *21290000
213000* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *21300000
213100******************************************************************21310000
213200 2310-GET-PREV-RECORD.                                            21320000
213300                                                                  21330000
213400     SUBTRACT +1 FROM ASC-SEL-SUB.                                21340000
213500     IF ASC-SEL-SUB < +1                                          21350000
213600         SUBTRACT +1 FROM ASC-SEL-ITEM                            21360000
213700         MOVE PC016-MAX-ITEMS      TO ASC-SEL-SUB                 21370000
213800     END-IF.                                                      21380000
213900                                                                  21390000
214000     IF ASC-SEL-ITEM > ZERO                                       21400000
214100         PERFORM 9100-READ-SEL-QUEUE                              21410000
214200         INITIALIZE ASC-LIST-KEYS                                 21420000
214300         MOVE PC016-PO-NBR-N(ASC-SEL-SUB)      TO ASC-PO-NBR      21430000
214400         MOVE PC016-REC-SEQ-NBR-N(ASC-SEL-SUB) TO                 21440000
214500              ASC-REC-SEQ-NBR                                     21450000
214600         MOVE PC016-OPER-UNT-ID  (ASC-SEL-SUB) TO ASC-OPR-ID      21460000
214700                                                  DK-OPR-ID       21470000
214800         MOVE PC016-FCLTY-ID     (ASC-SEL-SUB) TO ASC-FACT        21480000
214900                                                  DK-FACT         21490000
215000     ELSE                                                         21500000
215100         MOVE +1                   TO ASC-SEL-ITEM                21510000
215200                                      ASC-SEL-SUB                 21520000
215300*        --- TOP OF LIST ---                                      21530000
215400         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            21540000
215500         SET DP020-MSG-INFORMATIONAL                              21550000
215600                                   TO TRUE                        21560000
215700     END-IF.                                                      21570000
215800                                                                  21580000
215900/                                                                 21590000
216000******************************************************************21600000
216100* GET THE KEYS OF THE NEXT SELECTED PACKSLIP OBJECT FROM THE     *21610000
216200* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *21620000
216300******************************************************************21630000
216400 2400-GET-NEXT-PKSL-RECORD.                                       21640000
216500                                                                  21650000
216600     ADD +1                        TO ASC-SEL-SUB.                21660000
216700     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             21670000
216800         ADD +1                    TO ASC-SEL-ITEM                21680000
216900         MOVE +1                   TO ASC-SEL-SUB                 21690000
217000     END-IF.                                                      21700000
217100     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 21710000
217200         PERFORM 9300-READ-PKSL-SEL-QUEUE                         21720000
217300         IF RC013-ITEM (ASC-SEL-SUB) > ZERO                       21730000
217400             INITIALIZE ASC-LIST-KEYS                             21740000
217500             MOVE RC015-PO-NBR                     TO ASC-PO-NBR  21750000
217600                                                      DK-ORD-NBR  21760000
217700             MOVE RC013-REC-SEQ-NBR  (ASC-SEL-SUB) TO             21770000
217800                  ASC-REC-SEQ-NBR                                 21780000
217900                  DK-RCVR-SEQ-NBR                                 21790000
218000             MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)  TO             21800000
218100                  ASC-OPR-ID                                      21810000
218200                  DK-OPR-ID                                       21820000
218300             MOVE RC013-FCLTY-ID (ASC-SEL-SUB)     TO             21830000
218400                  ASC-FACT                                        21840000
218500                  DK-FACT                                         21850000
218600             SET RC013-INQ (ASC-SEL-SUB)           TO TRUE        21860000
218700             PERFORM 9400-REWRITE-PKSL-LIST-QUEUE                 21870000
218800         ELSE                                                     21880000
218900             SUBTRACT +1 FROM ASC-SEL-SUB                         21890000
219000*            --- BOTTOM OF LIST ---                               21900000
219100             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            21910000
219200             SET DP020-MSG-INFORMATIONAL                          21920000
219300                                   TO TRUE                        21930000
219400         END-IF                                                   21940000
219500     ELSE                                                         21950000
219600         SUBTRACT +1 FROM ASC-SEL-ITEM                            21960000
219700         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 21970000
219800         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            21980000
219900         SET DP020-MSG-INFORMATIONAL                              21990000
220000                                   TO TRUE                        22000000
220100     END-IF.                                                      22010000
220200                                                                  22020000
220300/                                                                 22030000
220400******************************************************************22040000
220500* GET THE KEYS OF THE PREVIOUS SELECTED PACK SLIP OBJECT FROM THE*22050000
220600* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *22060000
220700******************************************************************22070000
220800 2410-GET-PREV-PKSL-RECORD.                                       22080000
220900                                                                  22090000
221000     SUBTRACT +1 FROM ASC-SEL-SUB.                                22100000
221100     IF ASC-SEL-SUB < +1                                          22110000
221200         SUBTRACT +1 FROM ASC-SEL-ITEM                            22120000
221300         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 22130000
221400     END-IF.                                                      22140000
221500                                                                  22150000
221600     IF ASC-SEL-ITEM > ZERO                                       22160000
221700         PERFORM 9300-READ-PKSL-SEL-QUEUE                         22170000
221800         INITIALIZE ASC-LIST-KEYS                                 22180000
221900         MOVE RC015-PO-NBR                     TO ASC-PO-NBR      22190000
222000         MOVE RC013-REC-SEQ-NBR  (ASC-SEL-SUB) TO                 22200000
222100              ASC-REC-SEQ-NBR                                     22210000
222200         MOVE RC015-OPER-UNT-ID                TO ASC-OPR-ID      22220000
222300                                                  DK-OPR-ID       22230000
222400         MOVE RC015-FCLTY-ID                   TO ASC-FACT        22240000
222500                                                  DK-FACT         22250000
222600     ELSE                                                         22260000
222700         MOVE +1                   TO ASC-SEL-ITEM                22270000
222800                                      ASC-SEL-SUB                 22280000
222900*        --- TOP OF LIST ---                                      22290000
223000         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            22300000
223100         SET DP020-MSG-INFORMATIONAL                              22310000
223200                                   TO TRUE                        22320000
223300     END-IF.                                                      22330000
223400                                                                  22340000
223500/                                                                 22350000
223600******************************************************************22360000
223700*  CHECK PARM TABLE TO SEE IF DC IS TURNED ON TO DOWNLOAD ASN'S   22370000
223800*  TO WMS.                                                        22380000
223900******************************************************************22390000
224000 2450-CHECK-TKRPRPM.                                              22400000
224100                                                                  22410000
224200     EXEC SQL                                                     22420000
224300          SELECT   FUNC_TXT                                       22430000
224400            INTO  :KRPRPM-FUNC-TXT                                22440000
224500            FROM                                                  22450000
224600                  TKRPRPM A                                       22460000
224700            WHERE                                                 22470000
224800                  LOC_ID            = :DK-OPR-ID                  22480000
224900              AND SYS_PRC_FUNC_CDE  = 'ASNDWN'                    22490000
225000              AND FUNC_PRC_STAT_CDE = 'AC'                        22500000
225100              AND INTFC_SYS_CDE     = 'KHL'                       22510000
225200              AND FUNC_TXT          = 'Y'                         22520000
225300              AND FUNC_BEG_TMST    < CURRENT TIMESTAMP            22530000
225400             WITH UR                                              22540000
225500     END-EXEC.                                                    22550000
225600                                                                  22560000
225700     EVALUATE TRUE                                                22570000
225800         WHEN SQLCODE = ZERO                                      22580000
225900              SET PS-ASNS-TO-WMS-YES    TO TRUE                   22590000
226000         WHEN SQLCODE = +100                                      22600000
226100              SET PS-ASNS-TO-WMS-NO  TO TRUE                      22610000
226200         WHEN SQLWARN0 NOT = SPACES                               22620000
226300         WHEN SQLCODE  NOT = ZERO                                 22630000
226400             MOVE 'TKRPRPM     ' TO DP013-DB2-TABLE-NAME (1)      22640000
226500             SET DP013-DB2-ABEND                                  22650000
226600                                 TO TRUE                          22660000
226700             SET DP013-XCTL-DISPLAY-RESTART                       22670000
226800                                 TO TRUE                          22680000
226900             PERFORM DP013-0000-PROCESS-ABEND                     22690000
227000     END-EVALUATE.                                                22700000
227100                                                                  22710000
227200*----------------------------------------------------------------*22720000
227300* CALL TO WMS VENDOR SHIPMENT CONTROL MODULE (WSKCS305) USING     22730000
227400*  COPYBOOK WSWS001.                                              22740000
227500*----------------------------------------------------------------*22750000
227600 2800-CALL-WMS-MODULE.                                            22760000
227700                                                                  22770000
227800     MOVE ZEROS                TO WS001-TRIP-ID.                  22780000
227900     MOVE ZEROS                TO WS001-KOHLS-SHIPT-ID.           22790000
228000     MOVE DK-OPR-ID            TO WS001-OPER-UNT-ID.              22800000
228100     MOVE DP020-USERID         TO WS001-USER-ID.                  22810000
228200     MOVE DP020-SRC-TASK-NUMBER TO WS001-SRC-TASK-NUMBER.         22820000
228300     MOVE PV-PO-NBR            TO WS001-PO-NBR.                   22830000
228400     MOVE PV-REC-SEQ-NBR       TO WS001-RCVR-NBR.                 22840000
228500     MOVE ZEROS                TO WS001-PO-LNE-NBR.               22850000
228600     MOVE ZEROS                TO WS001-PREPK-ID.                 22860000
228700     MOVE ZEROS                TO WS001-SKU-NBR.                  22870000
228800     MOVE ZEROS                TO WS001-DTL-ASN-LEVEL-IND.        22880000
228900     MOVE 'RCKCS255'           TO WS001-CALLING-PROGRAM-NAME.     22890000
229000                                                                  22900000
229100     MOVE LENGTH OF WS001-FIELDS  TO  PV-COMMAREA-LENGTH.         22910000
229200                                                                  22920000
229300     EXEC CICS                                                    22930000
229400         LINK PROGRAM  (PC-WMS-CONTROL-MOD)                       22940000
229500              COMMAREA (WS001-FIELDS)                             22950000
229600              LENGTH   (PV-COMMAREA-LENGTH)                       22960000
229700     END-EXEC.                                                    22970000
229800                                                                  22980000
229900     EVALUATE TRUE                                                22990000
230000         WHEN WS001-SUCCESSFUL                                    23000000
230100              CONTINUE                                            23010000
230200         WHEN WS001-DATABASE-BUSY OR                              23020000
230300              WS001-INVALID-SQL                                   23030000
230400                  MOVE PC-TSYMSG-03546  TO DP020-MSG-NUMBER       23040000
230500                  SET DP020-MSG-WARNING TO TRUE                   23050000
230600                  SET DP030-OVERRIDE-GO TO TRUE                   23060000
230700                  SET PS-ERROR          TO TRUE                   23070000
230800                                                                  23080000
230900         WHEN WS001-ERROR                                         23090000
231000                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       23100000
231100                  SET DP020-MSG-WARNING TO TRUE                   23110000
231200                  SET DP030-OVERRIDE-GO TO TRUE                   23120000
231300                  SET PS-ERROR          TO TRUE                   23130000
231400                                                                  23140000
231500         WHEN OTHER                                               23150000
231600                                                                  23160000
231700             MOVE '2300-CALL-WMS-MODULE' TO DP013-PARAGRAPH       23170000
231800             MOVE 'UNSUCCESSFUL CALL TO WMS  MOD'                 23180000
231900                                         TO DP013-MESSAGE-TEXT (1)23190000
232000             MOVE WS001-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)23200000
232100             SET DP013-DB2-ABEND                                  23210000
232200                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              23220000
232300             SET PS-ERROR                    TO TRUE              23230000
232400             PERFORM DP013-0000-PROCESS-ABEND                     23240000
232500                                                                  23250000
232600     END-EVALUATE.                                                23260000
232700/                                                                 23270000
232800*----------------------------------------------------------------*23280000
232900*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *23290000
233000*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *23300000
233100*----------------------------------------------------------------*23310000
233200 3000-EDIT-DATA-IN-COMMAREA.                                      23320000
233300                                                                  23330000
233400     SET PS-NO-ERROR               TO TRUE.                       23340000
233500                                                                  23350000
233600     PERFORM 3200-RESET-ATTRIBUTES.                               23360000
233700                                                                  23370000
233800     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     23380000
233900**                                                                23390000
234000* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              23400000
234100* EDITTING IS DONE FROM THE BOTTOM UP.                            23410000
234200**                                                                23420000
234300     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       23430000
234400         ASC-ITEMS-DISPLAYED - 1.                                 23440000
234500                                                                  23450000
234600     PERFORM 3100-SET-SUBSCRIPTS.                                 23460000
234700     PERFORM 3300-EDIT-SELECTIONS                                 23470000
234800         VARYING PV-SUB                                           23480000
234900         FROM PV-SUB BY -1                                        23490000
235000         UNTIL PV-SUB < +1.                                       23500000
235100                                                                  23510000
235200/                                                                 23520000
235300*----------------------------------------------------------------*23530000
235400*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *23540000
235500*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*23550000
235600*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *23560000
235700*                                                                *23570000
235800*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *23580000
235900*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *23590000
236000*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *23600000
236100*    US IN THE 2ND BLOCK OF THE ARRAY.                           *23610000
236200*----------------------------------------------------------------*23620000
236300                                                                  23630000
236400 3100-SET-SUBSCRIPTS.                                             23640000
236500                                                                  23650000
236600     COMPUTE ASC-ITEM-SUB =                                       23660000
236700         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        23670000
236800                                                                  23680000
236900     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         23690000
237000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            23700000
237100                                                                  23710000
237200         MOVE PC-MAX-BLOCKS-IN-ARRAY                              23720000
237300                                   TO ASC-BLK-SUB                 23730000
237400     ELSE                                                         23740000
237500         MOVE +1                   TO ASC-BLK-SUB                 23750000
237600     END-IF.                                                      23760000
237700                                                                  23770000
237800*----------------------------------------------------------------*23780000
237900*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *23790000
238000*----------------------------------------------------------------*23800000
238100                                                                  23810000
238200 3200-RESET-ATTRIBUTES.                                           23820000
238300                                                                  23830000
238400     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   23840000
238500     MOVE DP015-GREEN              TO ASTRTITC.                   23850000
238600     MOVE DP015-UNDERLINE          TO ASTRTITH.                   23860000
238700                                                                  23870000
238800     IF DP020-NEXT-ACT-RETURN                                     23880000
238900     OR DP020-NEXT-ACT-READ-MAP                                   23890000
239000        PERFORM                                                   23900000
239100            VARYING PV-SUB                                        23910000
239200            FROM 1 BY 1                                           23920000
239300            UNTIL PV-SUB > ASC-ITEMS-DISPLAYED                    23930000
239400            MOVE DP015-UNP-ALP-NOR-OFF                            23940000
239500                                      TO MR-SELECTA (PV-SUB)      23950000
239600            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      23960000
239700            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      23970000
239800        END-PERFORM                                               23980000
239900     ELSE                                                         23990000
240000        PERFORM                                                   24000000
240100            VARYING PV-SUB                                        24010000
240200            FROM 1 BY 1                                           24020000
240300            UNTIL PV-SUB > PC-ITEMS-PER-PANEL                     24030000
240400            MOVE DP015-UNP-ALP-NOR-OFF                            24040000
240500                                      TO MR-SELECTA (PV-SUB)      24050000
240600            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      24060000
240700            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      24070000
240800        END-PERFORM                                               24080000
240900     END-IF.                                                      24090000
241000                                                                  24100000
241100/                                                                 24110000
241200*----------------------------------------------------------------*24120000
241300*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *24130000
241400*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *24140000
241500*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *24150000
241600*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *24160000
241700*----------------------------------------------------------------*24170000
241800 3300-EDIT-SELECTIONS.                                            24180000
241900                                                                  24190000
242000     EVALUATE TRUE                                                24200000
242100         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     24210000
242200             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         24220000
242300                 CONTINUE                                         24230000
242400                                                                  24240000
242500         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         24250000
242600             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        24260000
242700                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS24270000
242800                 MOVE ASC-TEMP-SELECTED-SW                        24280000
242900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24290000
243000                                   TO ASC-SELECTED-SW             24300000
243100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24310000
243200             END-IF                                               24320000
243300                                                                  24330000
243400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     24340000
243500                 = SPACE                                          24350000
243600             EVALUATE TRUE                                        24360000
243700                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       24370000
243800                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS24380000
243900                     MOVE SPACE    TO ASC-SELECTED-SW             24390000
244000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24400000
244100                                                                  24410000
244200                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        24420000
244300                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE 24430000
244400                     MOVE SPACE    TO ASC-SELECTED-SW             24440000
244500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24450000
244600                                                                  24460000
244700                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          24470000
244800                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   24480000
244900                     MOVE SPACE    TO ASC-SELECTED-SW             24490000
245000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24500000
245100             END-EVALUATE                                         24510000
245200                                                                  24520000
245300         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           24530000
245400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            24540000
245500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    24550000
245600             END-IF                                               24560000
245700             PERFORM 3310-EDIT-RANGE                              24570000
245800                                                                  24580000
245900         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             24590000
246000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            24600000
246100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    24610000
246200             END-IF                                               24620000
246300             PERFORM 3310-EDIT-RANGE                              24630000
246400                                                                  24640000
246500         WHEN OTHER                                               24650000
246600             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            24660000
246700             SET DP020-MSG-FATAL   TO TRUE                        24670000
246800             MOVE -1               TO MR-SELECTL (PV-SUB)         24680000
246900             SET DP030-SET-CURSOR-APPL-1                          24690000
247000                                   TO TRUE                        24700000
247100             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         24710000
247200             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         24720000
247300             SET PS-ERROR          TO TRUE                        24730000
247400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            24740000
247500                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     24750000
247600                 MOVE SPACE        TO ASC-SELECTED-SW             24760000
247700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24770000
247800             END-IF                                               24780000
247900     END-EVALUATE.                                                24790000
248000                                                                  24800000
248100     SUBTRACT +1 FROM PV-ITEM-IN-USE.                             24810000
248200     SUBTRACT +1 FROM ASC-ITEM-SUB.                               24820000
248300                                                                  24830000
248400     IF  ASC-ITEM-SUB < 1                                         24840000
248500         SUBTRACT +1 FROM ASC-BLK-SUB                             24850000
248600         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                24860000
248700     END-IF.                                                      24870000
248800                                                                  24880000
248900*----------------------------------------------------------------*24890000
249000*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *24900000
249100*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *24910000
249200*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *24920000
249300*  THE ENDING.                                                   *24930000
249400*----------------------------------------------------------------*24940000
249500 3310-EDIT-RANGE.                                                 24950000
249600                                                                  24960000
249700     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                24970000
249800         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   24980000
249900             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)24990000
250000                                   TO ASC-SELECTED-SW             25000000
250100                                        (ASC-BLK-SUB ASC-ITEM-SUB)25010000
250200             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 25020000
250300         ELSE                                                     25030000
250400             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     25040000
250500                 CONTINUE                                         25050000
250600             ELSE                                                 25060000
250700*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        25070000
250800                 MOVE PC-TSYMSG-00054                             25080000
250900                                   TO DP020-MSG-NUMBER            25090000
251000                 SET DP020-MSG-FATAL                              25100000
251100                                   TO TRUE                        25110000
251200                 MOVE -1           TO MR-SELECTL (PV-SUB)         25120000
251300                 SET DP030-SET-CURSOR-APPL-1                      25130000
251400                                   TO TRUE                        25140000
251500                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         25150000
251600                 MOVE DP015-UNDERLINE                             25160000
251700                                   TO MR-SELECTH (PV-SUB)         25170000
251800                 SET PS-ERROR      TO TRUE                        25180000
251900             END-IF                                               25190000
252000         END-IF                                                   25200000
252100     ELSE                                                         25210000
252200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     25220000
252300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 25230000
252400                                   TO ASC-SELECTED-SW             25240000
252500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   25250000
252600             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   25260000
252700         ELSE                                                     25270000
252800             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       25280000
252900                 CONTINUE                                         25290000
253000             ELSE                                                 25300000
253100*                -- ONLY ONE END-OF-RANGE ALLOWED --              25310000
253200                 MOVE PC-TSYMSG-00055                             25320000
253300                                   TO DP020-MSG-NUMBER            25330000
253400                 SET DP020-MSG-FATAL                              25340000
253500                                   TO TRUE                        25350000
253600                 MOVE -1           TO MR-SELECTL (PV-SUB)         25360000
253700                 SET DP030-SET-CURSOR-APPL-1                      25370000
253800                                   TO TRUE                        25380000
253900                 SET PS-ERROR      TO TRUE                        25390000
254000             END-IF                                               25400000
254100         END-IF                                                   25410000
254200     END-IF.                                                      25420000
254300                                                                  25430000
254400*----------------------------------------------------------------*25440000
254500*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *25450000
254600*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *25460000
254700*----------------------------------------------------------------*25470000
254800 3400-CHECK-RANGE-SEQUENCE.                                       25480000
254900                                                                  25490000
255000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       25500000
255100       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      25510000
255200       AND  ASC-START-OF-SELECTED-RANGE >                         25520000
255300                                         ASC-END-OF-SELECTED-RANGE25530000
255400*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                25540000
255500         MOVE PC-TSYMSG-00052      TO DP020-MSG-NUMBER            25550000
255600         SET DP020-MSG-FATAL       TO TRUE                        25560000
255700         SET PS-ERROR              TO TRUE                        25570000
255800         PERFORM 3410-POSITION-AT-ERROR                           25580000
255900     END-IF.                                                      25590000
256000                                                                  25600000
256100*----------------------------------------------------------------*25610000
256200*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *25620000
256300*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *25630000
256400*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *25640000
256500*----------------------------------------------------------------*25650000
256600 3410-POSITION-AT-ERROR.                                          25660000
256700                                                                  25670000
256800     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       25680000
256900                                                                  25690000
257000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 25700000
257100                    - PV-TOP-ITEM + 1.                            25710000
257200                                                                  25720000
257300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25730000
257400         CONTINUE                                                 25740000
257500     ELSE                                                         25750000
257600         MOVE -1                   TO MR-SELECTL (PV-SUB)         25760000
257700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         25770000
257800         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         25780000
257900     END-IF.                                                      25790000
258000                                                                  25800000
258100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   25810000
258200                    - PV-TOP-ITEM + 1.                            25820000
258300                                                                  25830000
258400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25840000
258500         CONTINUE                                                 25850000
258600     ELSE                                                         25860000
258700         MOVE -1                   TO MR-SELECTL (PV-SUB)         25870000
258800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         25880000
258900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         25890000
259000     END-IF.                                                      25900000
259100                                                                  25910000
259200/                                                                 25920000
259300*----------------------------------------------------------------*25930000
259400*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *25940000
259500*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *25950000
259600*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *25960000
259700*----------------------------------------------------------------*25970000
259800                                                                  25980000
259900 3500-MARK-RANGE-AS-SELECTED.                                     25990000
260000                                                                  26000000
260100     MOVE +1                       TO ASC-BLK-SUB.                26010000
260200                                                                  26020000
260300     PERFORM 3510-MARK-SELECTED-INDS                              26030000
260400         VARYING ASC-ITEM-SUB                                     26040000
260500         FROM 1 BY 1                                              26050000
260600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 26060000
260700                                                                  26070000
260800     ADD +1                        TO ASC-BLK-SUB.                26080000
260900                                                                  26090000
261000     PERFORM 3510-MARK-SELECTED-INDS                              26100000
261100         VARYING ASC-ITEM-SUB                                     26110000
261200         FROM 1 BY 1                                              26120000
261300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 26130000
261400                                                                  26140000
261500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               26150000
261600                                   TO PV-LIST-ITEM-NUMBER.        26160000
261700                                                                  26170000
261800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            26180000
261900         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         26190000
262000               PC-ITEMS-PER-PANEL).                               26200000
262100                                                                  26210000
262200     MOVE ASC-START-OF-SELECTED-RANGE                             26220000
262300                                   TO PV-START-OF-SELECTED-RANGE. 26230000
262400                                                                  26240000
262500     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            26250000
262600         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  26260000
262700               PC-ITEMS-PER-PANEL).                               26270000
262800                                                                  26280000
262900     MOVE ASC-END-OF-SELECTED-RANGE                               26290000
263000                                   TO PV-END-OF-SELECTED-RANGE.   26300000
263100                                                                  26310000
263200     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             26320000
263300         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    26330000
263400               PC-ITEMS-PER-PANEL).                               26340000
263500                                                                  26350000
263600     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             26360000
263700         PV-FIRST-BLOCK-IN-ARRAY + 1.                             26370000
263800                                                                  26380000
263900     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    26390000
264000        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        26400000
264100         MOVE +1                   TO ASC-BLK-SUB                 26410000
264200         PERFORM 5100-WRITE-TEMP-STORAGE                          26420000
264300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         26430000
264400             PV-FIRST-BLOCK-IN-ARRAY - 1                          26440000
264500                                                                  26450000
264600         PERFORM                                                  26460000
264700             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      26470000
264800                   PV-PREV-BLOCK-IN-ARRAY                         26480000
264900             MOVE PV-FIRST-BLOCK-IN-RANGE                         26490000
265000                                   TO PV-BLOCK-NUMBER             26500000
265100             PERFORM 4410-READ-TEMP-STORAGE                       26510000
265200             PERFORM 3510-MARK-SELECTED-INDS                      26520000
265300                 VARYING ASC-ITEM-SUB                             26530000
265400                 FROM 1 BY 1                                      26540000
265500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          26550000
265600             PERFORM 5100-WRITE-TEMP-STORAGE                      26560000
265700             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     26570000
265800         END-PERFORM                                              26580000
265900                                                                  26590000
266000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         26600000
266100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     26610000
266200         PERFORM                                                  26620000
266300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       26630000
266400                   PV-LAST-BLOCK-IN-RANGE                         26640000
266500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          26650000
266600                                   TO PV-BLOCK-NUMBER             26660000
266700             PERFORM 4410-READ-TEMP-STORAGE                       26670000
266800             PERFORM 3510-MARK-SELECTED-INDS                      26680000
266900                 VARYING ASC-ITEM-SUB                             26690000
267000                 FROM 1 BY 1                                      26700000
267100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          26710000
267200             PERFORM 5100-WRITE-TEMP-STORAGE                      26720000
267300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      26730000
267400         END-PERFORM                                              26740000
267500                                                                  26750000
267600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             26760000
267700                                   TO PV-BLOCK-NUMBER             26770000
267800         PERFORM 4410-READ-TEMP-STORAGE                           26780000
267900     END-IF.                                                      26790000
268000                                                                  26800000
268100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 26810000
268200                                      ASC-END-OF-SELECTED-RANGE.  26820000
268300                                                                  26830000
268400/                                                                 26840000
268500*----------------------------------------------------------------*26850000
268600* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *26860000
268700*----------------------------------------------------------------*26870000
268800                                                                  26880000
268900 3510-MARK-SELECTED-INDS.                                         26890000
269000                                                                  26900000
269100     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         26910000
269200         ASC-START-OF-SELECTED-RANGE)                             26920000
269300     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         26930000
269400         ASC-START-OF-SELECTED-RANGE)                             26940000
269500                                                                  26950000
269600         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     26960000
269700             ASC-END-OF-SELECTED-RANGE)                           26970000
269800         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     26980000
269900             ASC-END-OF-SELECTED-RANGE)                           26990000
270000                                                                  27000000
270100             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          27010000
270200                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   27020000
270300                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   27030000
270400                                   TO TRUE                        27040000
270500                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              27050000
270600                                   TO TRUE                        27060000
270700                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS27070000
270800             END-IF                                               27080000
270900         END-IF                                                   27090000
271000     END-IF.                                                      27100000
271100                                                                  27110000
271200/                                                                 27120000
271300*----------------------------------------------------------------*27130000
271400*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *27140000
271500*    INITIALIZE ALL COUNTERS AND FLAGS.                          *27150000
271600*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *27160000
271700*    DISPLAY THE PANEL TO USER.                                  *27170000
271800*----------------------------------------------------------------*27180000
271900                                                                  27190000
272000 4000-BUILD-INITIAL-PANEL.                                        27200000
272100                                                                  27210000
272200     INITIALIZE ASC-BLOCK-ENTRIES (1)                             27220000
272300                ASC-BLOCK-ENTRIES (2).                            27230000
272400                                                                  27240000
272500     MOVE +1                       TO ASC-BLK-SUB.                27250000
272600                                                                  27260000
272700     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       27270000
272800                                                                  27280000
272900     MOVE +0                       TO ASC-ITEM-SUB                27290000
273000                                      ASC-NUMBER-OF-ITEMS-READ    27300000
273100                                      ASC-NUMBER-OF-SELECTED-ITEMS27310000
273200                                      ASC-HIGHEST-BLOCK-WRITTEN   27320000
273300                                      ASC-START-OF-SELECTED-RANGE 27330000
273400                                      ASC-END-OF-SELECTED-RANGE   27340000
273500                                      ASC-ITEM-AT-TOP-OF-PANEL.   27350000
273600     PERFORM 4100-PREPARE-CURSOR.                                 27360000
273700     PERFORM 2160-CHECK-PACK-BY-STORE.                            27370000
273800                                                                  27380000
273900     PERFORM 4355-GET-TRECEIV-INFO.                               27390000
274000     EVALUATE TRUE                                                27400000
274100         WHEN SQLCODE = +100                                      27410000
274200              MOVE PC-X TO ASC-PACKAGE-TYPE-CDE                   27420000
274300         WHEN SQLCODE = +0                                        27430000
274400              MOVE RECEIV-PKGNG-CDE TO ASC-PACKAGE-TYPE-CDE       27440000
274500                                                                  27450000
274600              PERFORM 4360-GET-TPURCHS-INFO                       27460000
274700              EVALUATE TRUE                                       27470000
274800                  WHEN SQLCODE = +100                             27480000
274900                       IF ASC-PACKAGE-TYPE-CDE NOT > SPACES       27490000
275000                           MOVE PC-X TO ASC-PACKAGE-TYPE-CDE      27500000
275100                       END-IF                                     27510000
275200                  WHEN SQLCODE = +0                               27520000
275300                       IF ASC-PACKAGE-TYPE-CDE NOT > SPACES       27530000
275400                           MOVE PC-X TO ASC-PACKAGE-TYPE-CDE      27540000
275500                       END-IF                                     27550000
275600                       MOVE RECEIV-STATUS-CDE                     27560000
275700                               TO ASC-STAT                        27570000
275800                       MOVE RECEIV-EXPTED-CART-CNT                27580000
275900                               TO ASC-TRECEIV-EXPTED-CART-CNT     27590000
276000                       MOVE RECEIV-ACTL-CART-CNT                  27600000
276100                               TO ASC-TRECEIV-ACTL-CART-CNT       27610000
276200                       PERFORM 4200-TROUBLE-DESC                  27620000
276300                       PERFORM 4100-PREPARE-CURSOR                27630000
276400                       PERFORM 4200-CALC-OPEN-TO-REC              27640000
276500                       PERFORM 4010-OPEN-CURSOR                   27650000
276600                       PERFORM 4300-READ-ITEMS-FROM-DB            27660000
276700                       PERFORM 4020-CLOSE-CURSOR                  27670000
276800              END-EVALUATE                                        27680000
276900     END-EVALUATE.                                                27690000
277000                                                                  27700000
277100     MOVE +1                       TO PV-TOP-ITEM.                27710000
277200                                                                  27720000
277300     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          27730000
277400         SET DP020-NEXT-ACT-APPL-ERROR                            27740000
277500                                   TO TRUE                        27750000
277600         SET DP020-MSG-FATAL       TO TRUE                        27760000
277700         MOVE PC-TSYMSG-00050      TO DP020-MSG-NUMBER            27770000
277800     ELSE                                                         27780000
277900         MOVE -1                   TO MR-SELECTL (1)              27790000
278000         SET DP030-SET-CURSOR-APPL-1                              27800000
278100                                   TO TRUE                        27810000
278200         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     27820000
278300     END-IF.                                                      27830000
278400                                                                  27840000
278500/                                                                 27850000
278600*----------------------------------------------------------------*27860000
278700* OPEN THE SHIPMENT CURSOR                                       *27870000
278800*----------------------------------------------------------------*27880000
278900                                                                  27890000
279000 4010-OPEN-CURSOR.                                                27900000
279100                                                                  27910000
279200                                                                  27920000
279300         EXEC SQL                                                 27930000
279400             OPEN TPURITM-CSR                                     27940000
279500         END-EXEC                                                 27950000
279600                                                                  27960000
279700                                                                  27970000
279800         EVALUATE TRUE                                            27980000
279900             WHEN SQLCODE = +0                                    27990000
280000                  CONTINUE                                        28000000
280100             WHEN SQLCODE = -904                                  28010000
280200             WHEN SQLCODE = -911                                  28020000
280300             WHEN SQLCODE = -913                                  28030000
280400                  PERFORM 9900-SOFT-ABORT                         28040000
280500             WHEN SQLWARN0 NOT = SPACE                            28050000
280600             WHEN SQLCODE  NOT = +0                               28060000
280700                  MOVE '4010-OPEN-CURSOR'                         28070000
280800                                   TO DP013-PARAGRAPH             28080000
280900                  MOVE 'OPEN CURSOR'                              28090000
281000                                   TO DP013-MESSAGE-TEXT (1)      28100000
281100                  MOVE SQLCA       TO DP013-SQLCA                 28110000
281200                  MOVE 'TPURITM'   TO DP013-DB2-TABLE-NAME (1)    28120000
281300                  SET DP013-DB2-ABEND                             28130000
281400                                   TO TRUE                        28140000
281500                  PERFORM DP013-0000-PROCESS-ABEND                28150000
281600         END-EVALUATE.                                            28160000
281700/                                                                 28170000
281800*----------------------------------------------------------------*28180000
281900* CLOSE THE SHIPMENT CURSOR                                      *28190000
282000*----------------------------------------------------------------*28200000
282100                                                                  28210000
282200 4020-CLOSE-CURSOR.                                               28220000
282300                                                                  28230000
282400     EXEC SQL                                                     28240000
282500          CLOSE TPURITM-CSR                                       28250000
282600     END-EXEC.                                                    28260000
282700                                                                  28270000
282800     EVALUATE TRUE                                                28280000
282900         WHEN SQLCODE = +0                                        28290000
283000              CONTINUE                                            28300000
283100         WHEN SQLCODE = -904                                      28310000
283200         WHEN SQLCODE = -911                                      28320000
283300         WHEN SQLCODE = -913                                      28330000
283400              PERFORM 9900-SOFT-ABORT                             28340000
283500         WHEN SQLWARN0 NOT = SPACE                                28350000
283600         WHEN SQLCODE  NOT = +0                                   28360000
283700              MOVE '4020-CLOSE-CURSOR'                            28370000
283800                                   TO DP013-PARAGRAPH             28380000
283900              MOVE 'CLOSE CURSOR'  TO DP013-MESSAGE-TEXT (1)      28390000
284000              MOVE SQLCA           TO DP013-SQLCA                 28400000
284100              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (1)    28410000
284200              SET DP013-DB2-ABEND  TO TRUE                        28420000
284300              PERFORM DP013-0000-PROCESS-ABEND                    28430000
284400     END-EVALUATE.                                                28440000
284500                                                                  28450000
284600/                                                                 28460000
284700*----------------------------------------------------------------*28470000
284800*    DEPENDING ON WHAT WAS PASSED IN THE COMMAREA, SETUP THE     *28480000
284900*    DB2 KEYS IN PREPARATION FOR THE OPEN CURSROR.               *28490000
285000*----------------------------------------------------------------*28500000
285100                                                                  28510000
285200 4100-PREPARE-CURSOR.                                             28520000
285300                                                                  28530000
285400     MOVE ASC-PO-NBR       TO DK-ORD-NBR                          28540000
285500     MOVE ASC-REC-SEQ-NBR  TO DK-RCVR-SEQ-NBR.                    28550000
285600     MOVE ASC-OPR-ID       TO DK-OPR-ID                           28560000
285700     MOVE ASC-FACT         TO DK-FACT.                            28570000
285800                                                                  28580000
285900/                                                                 28590000
286000 4200-TROUBLE-DESC.                                               28600000
286100                                                                  28610000
286200     EXEC SQL                                                     28620000
286300         SELECT B.TRBL_SHT_DESC                                   28630000
286400         INTO :TRBRSN-TRBL-SHT-DESC                               28640000
286500         FROM  TTRBNTF A                                          28650000
286600              ,TTRBRSN B                                          28660000
286700         WHERE A.PO_NBR               = :DK-ORD-NBR               28670000
286800               AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR          28680000
286900               AND A.RESOLVED_IND    IN (:PC-N, :PC-I)            28690000
287000               AND PO_LNE_NBR         = 0                         28700000
287100               AND A.TRBL_RSN_CDE     = B.TRBL_RSN_CDE            28710000
287200          WITH UR                                                 28720000
287300     END-EXEC                                                     28730000
287400                                                                  28740000
287500     EVALUATE TRUE                                                28750000
287600         WHEN SQLCODE = +0                                        28760000
287700             MOVE TRBRSN-TRBL-SHT-DESC TO ASC-TROUB-STATUS        28770000
287800         WHEN SQLCODE = -811                                      28780000
287900             STRING TRBRSN-TRBL-SHT-DESC '*'                      28790000
288000                 DELIMITED BY SIZE                                28800000
288100                 INTO ASC-TROUB-STATUS                            28810000
288200         WHEN SQLCODE = +100                                      28820000
288300             MOVE SPACES                   TO ASC-TROUB-STATUS    28830000
288400         WHEN SQLCODE = -904                                      28840000
288500         WHEN SQLCODE = -911                                      28850000
288600         WHEN SQLCODE = -913                                      28860000
288700             PERFORM 9900-SOFT-ABORT                              28870000
288800                                                                  28880000
288900         WHEN SQLWARN0 NOT = SPACE                                28890000
289000         WHEN SQLCODE < ZERO                                      28900000
289100         WHEN SQLCODE > ZERO                                      28910000
289200             MOVE '4200-TROUBLE-DESC'                             28920000
289300                             TO DP013-PARAGRAPH                   28930000
289400             MOVE 'SELECT ON TTRBNTF/TTRBRSN'                     28940000
289500                             TO DP013-MESSAGE-TEXT (1)            28950000
289600             MOVE SQLCA          TO DP013-SQLCA                   28960000
289700             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      28970000
289800             MOVE 'TTRBRSN'      TO DP013-DB2-TABLE-NAME (2)      28980000
289900             SET DP013-DB2-ABEND                                  28990000
290000                             TO TRUE                              29000000
290100             SET DP013-XCTL-DISPLAY-RESTART                       29010000
290200                             TO TRUE                              29020000
290300             PERFORM DP013-0000-PROCESS-ABEND                     29030000
290400     END-EVALUATE.                                                29040000
290500/                                                                 29050000
290600*----------------------------------------------------------------*29060000
290700*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *29070000
290800*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *29080000
290900*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *29090000
291000*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *29100000
291100*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *29110000
291200*                                                                *29120000
291300*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *29130000
291400*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *29140000
291500*    UPON INITIALIZATION.                                        *29150000
291600*----------------------------------------------------------------*29160000
291700                                                                  29170000
291800 4200-CALC-OPEN-TO-REC.                                           29180000
291900                                                                  29190000
292000     SET DP276-LINE-LEVEL-OTR                                     29200000
292100         DP276-RECEIVER-OTR      TO TRUE                          29210000
292200                                                                  29220000
292300     INITIALIZE DP276-KEYS                                        29230000
292400     MOVE DK-ORD-NBR             TO DP276-PO-NBR                  29240000
292500     MOVE PURITM-PO-LNE-NBR      TO DP276-PO-LNE-NBR              29250000
292600     MOVE DK-RCVR-SEQ-NBR        TO DP276-REC-SEQ-NBR             29260000
292700     MOVE DK-OPR-ID              TO DP276-OPER-UNT-ID             29270000
292800     MOVE DK-FACT                TO DP276-FCLTY-ID                29280000
292900                                                                  29290000
293000     COPY DPPD276.                                                29300000
293100                                                                  29310000
293200/                                                                 29320000
293300 4300-READ-ITEMS-FROM-DB.                                         29330000
293400                                                                  29340000
293500******    WR # 27201 - START                                      29350000
293600     IF ASC-STAT = PC-VE                                          29360000
293700         PERFORM 4390-GET-FUNC-BEG-TMST                           29370000
293800     END-IF.                                                      29380000
293900******    WR # 27201 - END                                        29390000
294000                                                                  29400000
294100     PERFORM                                                      29410000
294200         VARYING PV-READ-COUNT                                    29420000
294300         FROM 1 BY 1                                              29430000
294400         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    29440000
294500            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         29450000
294600                                                                  29460000
294700         INITIALIZE XL001-ITEM-COMMAREA                           29470000
294800                    PV-SKU-SEQ-TEMP                               29480000
294900         PERFORM 4310-FETCH                                       29490000
295000                                                                  29500000
295100         IF  ASC-ITEMS-LEFT-ON-DB                                 29510000
295200             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                29520000
295300                 ADD +1            TO ASC-ITEM-SUB                29530000
295400             ELSE                                                 29540000
295500                 ADD +1            TO ASC-BLK-SUB                 29550000
295600                 MOVE +1           TO ASC-ITEM-SUB                29560000
295700                                                                  29570000
295800                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         29580000
295900                     MOVE +1       TO ASC-BLK-SUB                 29590000
296000                     SET ASC-BLOCK-MODIFIED (1)                   29600000
296100                                   TO TRUE                        29610000
296200                     PERFORM 5100-WRITE-TEMP-STORAGE              29620000
296300                     MOVE ASC-BLOCK-ENTRIES                       29630000
296400                               (PC-MAX-BLOCKS-IN-ARRAY)           29640000
296500                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 29650000
296600                     ADD +1        TO ASC-BLK-SUB                 29660000
296700                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   29670000
296800                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      29680000
296900                                   TO TRUE                        29690000
297000                 END-IF                                           29700000
297100             END-IF                                               29710000
297200             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    29720000
297300             MOVE ASC-NUMBER-OF-ITEMS-READ                        29730000
297400                                   TO ASC-LIST-ITEM-NUMBER        29740000
297500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29750000
297600*   ADDED A NEW MOVE INTO ASC-DEPT              WR/IR 230ZZ   **  29760000
297700             MOVE PURCHS-DEPT-NBR       TO PV-SKU-DEPT            29770000
297800             MOVE PURCHS-DEPT-NBR       TO ASC-DEPT               29780000
297900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29790000
298000             MOVE DK-LINE-NBR           TO ASC-LINE-NUMBER        29800000
298100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29810000
298200*            MOVE PURITM-CL-NBR         TO ASC-CL                 29820000
298300*                                     (ASC-BLK-SUB ASC-ITEM-SUB)  29830000
298400*            MOVE PURITM-SKU-DESC       TO ASC-SKU-DESC           29840000
298500*                                     (ASC-BLK-SUB ASC-ITEM-SUB)  29850000
298600             MOVE PURITM-ITM-NBR        TO ASC-ITM-NBR            29860000
298700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29870000
298800             MOVE PURITM-VER-NBR        TO ASC-VER-NBR            29880000
298900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29890000
299000*            MOVE PURITM-VND-STYL-NAME TO                         29900000
299100*                                      ASC-ITEM-VND-STYL-NAME     29910000
299200*                                     (ASC-BLK-SUB ASC-ITEM-SUB)  29920000
299300             MOVE PURITM-UNT-QTY        TO ASC-PURITM-UNT-QTY     29930000
299400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29940000
299500             MOVE PURITM-UNT-RTL-PR-AMT TO                        29950000
299600                                       ASC-PURITM-UNT-RTL-PR-AMT  29960000
299700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29970000
299800             MOVE PURITM-GP-RTL-AMT     TO ASC-PURITM-GP-RTL-AMT  29980000
299900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29990000
300000             MOVE PURITM-GP-QTY         TO ASC-PURITM-GP-QTY      30000000
300100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30010000
300110             MOVE RECEIV-CRE-OPER-UNT-ID                          30011005
300120                                        TO ASC-CRE-OPER           30012005
300130             MOVE RECEIV-CURR-OPER-UNT-ID                         30013006
300140                                        TO ASC-CURR-OPER          30014005
300200*                                                                 30020000
300300*----------------------------------------------------------------*30030000
300400*                                                **   WR # 230ZZ *30040000
300500* ADDED THE LOGIC TO CHECK FOR THE DUMMY SKU                     *30050000
300600* IF NOT DUMMY SKU CALL LOGISTICS DOMAIN ITEM ACCESS MODULE      *30060000
300700*----------------------------------------------------------------*30070000
300800     IF    PS-CALL-API-YES                AND                     30080000
300900        ((PURITM-SKU-SEQ-NBR NOT = PC-000 AND                     30090000
301000          PURITM-SKU-SEQ-NBR NOT = PC-999))                       30100000
301100                                                                  30110000
301200         PERFORM 4315-CALL-CICS-API-ARCH                          30120000
301300     ELSE                                                         30130000
301400         IF PURITM-SKU-SEQ-NBR = PC-000                           30140000
301500            MOVE 00000000          TO  PV-SKU-SEQ-TEMP            30150000
301600         ELSE                                                     30160000
301700            IF PURITM-SKU-SEQ-NBR = PC-999                        30170000
301800               MOVE 99999999       TO  PV-SKU-SEQ-TEMP            30180000
301900            END-IF                                                30190000
302000         END-IF                                                   30200000
302100     END-IF                                                       30210000
302200                                                                  30220000
302300             MOVE PV-SKU-SEQ-TEMP                                 30230000
302400                           TO  ASC-SEQ(ASC-BLK-SUB ASC-ITEM-SUB)  30240000
302500             MOVE XL001-SUB-CL-NBR-2CH                            30250000
302600                           TO ASC-CL  (ASC-BLK-SUB ASC-ITEM-SUB)  30260000
302700             MOVE XL001-SKU-DESC        TO ASC-SKU-DESC           30270000
302800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30280000
302900             MOVE XL001-VS-NBR          TO                        30290000
303000                                       ASC-ITEM-VND-STYL-NAME     30300000
303100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30310000
303200*                                                                 30320000
303300*----------------------------------------------------------------*30330000
303400*   CHANGES MADE FOR WR # 230ZZ ENDS HERE.                        30340000
303500*----------------------------------------------------------------*30350000
303600*                                                                 30360000
303700*      GET OPEN TO RECEIVE TOTALS                                 30370000
303800             MOVE DK-LINE-NBR           TO DP276-SEARCH-NBR       30380000
303900             PERFORM 4210-SEARCH-OTR                              30390000
304000             MOVE DP276-OTR-OUT-X TO ASC-OTR                      30400000
304100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     30410000
304200                                                                  30420000
304300             MOVE RECITM-STATUS-CDE     TO ASC-STATUS             30430000
304400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     30440000
304500             MOVE RECITM-DTL-CK-ITM-QTY TO ASC-DETAIL-ITEM        30450000
304600                                   (ASC-BLK-SUB ASC-ITEM-SUB)     30460000
304700             MOVE RECITM-PKSL-ITM-QTY   TO ASC-PS-ITEM            30470000
304800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     30480000
304900******    WR # 27201 - START                                      30490000
305000*            IF RECITM-MKING-APRON-TMST = PC-DEFAULT-TMST         30500000
305100*                MOVE '*****'               TO ASC-APRON-DTE      30510000
305200*                                  (ASC-BLK-SUB ASC-ITEM-SUB)     30520000
305300*            ELSE                                                 30530000
305400*                MOVE RECITM-MKING-APRON-TMST                     30540000
305500*                                           TO PV-CRE-TMST        30550000
305600*                MOVE PV-CRE-YY             TO PV-CREATE-YY       30560000
305700*                MOVE PV-CRE-MM             TO PV-CREATE-MM       30570000
305800*                MOVE PV-CRE-DD             TO PV-CREATE-DD       30580000
305900*                MOVE PV-CREATE-DTE         TO ASC-APRON-DTE      30590000
306000*                                  (ASC-BLK-SUB ASC-ITEM-SUB)     30600000
306100*            END-IF                                               30610000
306200             IF ASC-STAT NOT = PC-VE                              30620000
306300               OR RECEIV-ML-POST-TMST = PC-DEFAULT-TMST           30630000
306400               OR RECEIV-FS-POST-TMST = PC-DEFAULT-TMST           30640000
306500               OR RECEIV-ML-POST-TMST < KRPRPM-FUNC-BEG-TMST      30650000
306600               OR RECEIV-FS-POST-TMST < KRPRPM-FUNC-BEG-TMST      30660000
306700                MOVE +0                   TO ASC-VRFD-LWST-RTL-AMT30670000
306800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     30680000
306900             ELSE                                                 30690000
307000                PERFORM 4380-GET-VRFD-RTL                         30700000
307100                MOVE PV-VRFD-LWST-RTL-AMT TO ASC-VRFD-LWST-RTL-AMT30710000
307200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     30720000
307300             END-IF                                               30730000
307400******    WR # 27201 - END                                        30740000
307500             PERFORM 4330-GET-VERIFY-QTY                          30750000
307600             MOVE PV-AP-VERIFY-ITM-QTY  TO                        30760000
307700                 ASC-VERIFY-ITEM   (ASC-BLK-SUB ASC-ITEM-SUB)     30770000
307800             PERFORM 4340-GET-CRE-UID                             30780000
307900             MOVE PKITEM-CRE-UID TO ASC-PKITEM-CRE-UID            30790000
308000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     30800000
308100                                                                  30810000
308200             IF ASC-STAT NOT = PC-VE                              30820000
308300                 PERFORM 4370-FIND-LINE-TROUBLE                   30830000
308400                 MOVE TRBRSN-TRBL-SHT-DESC TO ASC-TROUBLE         30840000
308500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30850000
308600                 EVALUATE TRUE                                    30860000
308700                     WHEN PV-UNRSLVD-TRBL-COUNT > ZERO            30870000
308800                         SET ASC-LINE-IN-TROUBLE                  30880000
308900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30890000
309000                                   TO TRUE                        30900000
309100                     WHEN PV-RSLVD-TRBL-COUNT > ZERO              30910000
309200                         SET ASC-LINE-DISTRO-TRBL                 30920000
309300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30930000
309400                                   TO TRUE                        30940000
309500                 END-EVALUATE                                     30950000
309600             END-IF                                               30960000
309700             IF  DP020-MSG-NUMBER-X = SPACE                       30970000
309800             AND PURITM-STATUS-CDE = PC-RV                        30980000
309900                 MOVE PC-TSYMSG-02762  TO DP020-MSG-NUMBER        30990000
310000                 SET DP020-MSG-WARNING TO TRUE                    31000000
310100             END-IF                                               31010000
310200             PERFORM 4350-CK-CASEPACK-SPLIT-PROCESS               31020000
310300             IF PV-PACK-BY-ST-IND-YES                             31030000
310400                 PERFORM 8100-ARE-CARTONS-CHECKED-IN              31040000
310500             ELSE                                                 31050000
310600                  SET ASC-CHECKED-IN-NO                           31060000
310700                      (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE        31070000
310800             END-IF                                               31080000
310900         END-IF                                                   31090000
311000     END-PERFORM.                                                 31100000
311100                                                                  31110000
311200     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          31120000
311300         MOVE +1                   TO ASC-BLK-SUB                 31130000
311400         PERFORM 5100-WRITE-TEMP-STORAGE                          31140000
311500         ADD +1                    TO ASC-BLK-SUB                 31150000
311600         PERFORM 5100-WRITE-TEMP-STORAGE                          31160000
311700                                                                  31170000
311800         MOVE 1                    TO ASC-BLK-SUB                 31180000
311900                                      PV-BLOCK-NUMBER             31190000
312000         PERFORM 4410-READ-TEMP-STORAGE                           31200000
312100         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             31210000
312200             MOVE 2                TO ASC-BLK-SUB                 31220000
312300                                      PV-BLOCK-NUMBER             31230000
312400             PERFORM 4410-READ-TEMP-STORAGE                       31240000
312500         END-IF                                                   31250000
312600     END-IF.                                                      31260000
312700                                                                  31270000
312800/                                                                 31280000
312900*----------------------------------------------------------------*31290000
313000*    FETCH A TPURITM ROW                                         *31300000
313100*----------------------------------------------------------------*31310000
313200                                                                  31320000
313300 4310-FETCH.                                                      31330000
313400                                                                  31340000
313500     EXEC SQL                                                     31350000
313600         FETCH TPURITM-CSR                                        31360000
313700            INTO :PURITM-PO-NBR                                   31370000
313800                ,:PURITM-VER-NBR                                  31380000
313900                ,:PURITM-SKU-SEQ-NBR                              31390000
314000*               ,:PURITM-CL-NBR                                   31400000
314100                ,:PURITM-ITM-NBR                                  31410000
314200*               ,:PURITM-SKU-DESC                                 31420000
314300                ,:DK-LINE-NBR                                     31430000
314400*               ,:ITEM-VND-STYL-NAME                              31440000
314500                ,:PURITM-UNT-QTY                                  31450000
314600                ,:PURITM-UNT-RTL-PR-AMT                           31460000
314700                ,:PURITM-STATUS-CDE                               31470000
314800                ,:PURITM-GP-RTL-AMT                               31480000
314900                ,:PURITM-GP-QTY                                   31490000
315000                ,:PURITM-PO-LNE-NBR                               31500000
315100                ,:RECITM-ORD-LNE-NBR                              31510000
315200                ,:RECITM-STATUS-CDE                               31520000
315300                ,:RECITM-DTL-CK-ITM-QTY                           31530000
315400                ,:RECITM-PKSL-ITM-QTY                             31540000
315500                ,:RECITM-MKING-APRON-TMST                         31550000
315510                ,:RECEIV-CRE-OPER-UNT-ID                          31551005
315520                ,:RECEIV-CURR-OPER-UNT-ID                         31552005
315600     END-EXEC.                                                    31560000
315700                                                                  31570000
315800     EVALUATE TRUE                                                31580000
315900         WHEN SQLCODE = +0                                        31590000
316000              SET PS-CALL-API-YES TO TRUE                         31600000
316100                                                                  31610000
316200         WHEN SQLCODE = +100                                      31620000
316300              SET ASC-NO-ITEMS-LEFT-ON-DB                         31630000
316400                                   TO TRUE                        31640000
316500         WHEN SQLCODE = -904                                      31650000
316600         WHEN SQLCODE = -911                                      31660000
316700         WHEN SQLCODE = -913                                      31670000
316800              PERFORM 9900-SOFT-ABORT                             31680000
316900                                                                  31690000
317000         WHEN SQLWARN0 NOT = SPACE                                31700000
317100         WHEN SQLCODE < +0                                        31710000
317200         WHEN SQLCODE > +0                                        31720000
317300              MOVE '4310-FETCH'                                   31730000
317400                                   TO DP013-PARAGRAPH             31740000
317500              MOVE 'FETCH TPURITM CURSOR'                         31750000
317600                                   TO DP013-MESSAGE-TEXT (1)      31760000
317700              MOVE SQLCA           TO DP013-SQLCA                 31770000
317800              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (1)    31780000
317900              SET DP013-DB2-ABEND  TO TRUE                        31790000
318000              PERFORM DP013-0000-PROCESS-ABEND                    31800000
318100     END-EVALUATE.                                                31810000
318200                                                                  31820000
318300*----------------------------------------------------------------*31830000
318400*                                               **   WR # 230ZZ  *31840000
318500* CALL TO LOGISTICS DOMAIN ITEM ACCESS MODULE                    *31850000
318600*----------------------------------------------------------------*31860000
318700*                                                                 31870000
318800 4315-CALL-CICS-API-ARCH.                                         31880000
318900******************************************************            31890000
319000******************************************************            31900000
319100                                                                  31910000
319200        MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR.               31920000
319300                                                                  31930000
319400        SET  XL001-BY-ITEM                                        31940000
319500             XL001-SELECT-SKU                                     31950000
319600             XL001-SELECT-VND-STYL                                31960000
319700                              TO TRUE.                            31970000
319800                                                                  31980000
319900        CALL XL001-VSM-PGM USING  DFHEIBLK                        31990000
320000                                  XL001-COMMAREA                  32000000
320100                                  XL001-ITEM-COMMAREA.            32010000
320200                                                                  32020000
320300        EVALUATE TRUE                                             32030000
320400                                                                  32040000
320500          WHEN XL001-SUCCESSFUL                                   32050000
320600              MOVE XL001-SKU-NBR   TO  PV-SKU-SEQ-TEMP            32060000
320700                                                                  32070000
320800          WHEN XL001-SKU-SQLCODE = +100                           32080000
320900              CONTINUE                                            32090000
321000                                                                  32100000
321100          WHEN XL001-SKU-CONTENTION                               32110000
321200              PERFORM 9900-SOFT-ABORT                             32120000
321300                                                                  32130000
321400          WHEN XL001-INVALID-ACCESS                               32140000
321500              MOVE '4315-CALL-CICS-API-ARCH'                      32150000
321600                                   TO DP013-PARAGRAPH             32160000
321700              MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'           32170000
321800                                   TO DP013-MESSAGE-TEXT (1)      32180000
321900              MOVE SQLCA           TO DP013-SQLCA                 32190000
322000              MOVE 'XLV_SKU'       TO DP013-DB2-TABLE-NAME (1)    32200000
322100              SET DP013-DB2-ABEND  TO TRUE                        32210000
322200              PERFORM DP013-0000-PROCESS-ABEND                    32220000
322300                                                                  32230000
322400          WHEN OTHER                                              32240000
322500              MOVE '4315-CALL-CICS-API-ARCH'                      32250000
322600                                   TO DP013-PARAGRAPH             32260000
322700              MOVE 'FETCH SKU SEQ NUMBER'                         32270000
322800                                   TO DP013-MESSAGE-TEXT (1)      32280000
322900              MOVE XL001-SKU-SQLCODE                              32290000
323000                                   TO SQLCODE                     32300000
323100              MOVE SQLCA           TO DP013-SQLCA                 32310000
323200              MOVE 'XLV_SKU'       TO DP013-DB2-TABLE-NAME (1)    32320000
323300              SET DP013-DB2-ABEND  TO TRUE                        32330000
323400              PERFORM DP013-0000-PROCESS-ABEND                    32340000
323500        END-EVALUATE.                                             32350000
323600                                                                  32360000
323700*----------------------------------------------------------------*32370000
323800*  CHANGES MADE FOR WR # 230ZZ ENDS HERE.                        *32380000
323900*----------------------------------------------------------------*32390000
324000*                                                                 32400000
324100*----------------------------------------------------------------*32410000
324200*    GET SKU, SKU DESC, AND VENDOR STYLE FROM TPURCHS/TPURITM    *32420000
324300*----------------------------------------------------------------*32430000
324400 4330-GET-VERIFY-QTY.                                             32440000
324500                                                                  32450000
324600         EXEC SQL                                                 32460000
324700              SELECT SUM(AP_VERIFY_ITM_QTY)                       32470000
324800                INTO :PV-AP-VERIFY-ITM-QTY                        32480000
324900                FROM TRECDIS                                      32490000
325000               WHERE ORD_NBR           = :DK-ORD-NBR              32500000
325100                 AND ORD_LNE_NBR       = :DK-LINE-NBR             32510000
325200                 AND REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR         32520000
325400                WITH UR                                           32540000
325500         END-EXEC                                                 32550000
325600                                                                  32560000
325700         EVALUATE TRUE                                            32570000
325800             WHEN SQLCODE = ZERO                                  32580000
325900                  CONTINUE                                        32590000
326000             WHEN SQLCODE = -904                                  32600000
326100             WHEN SQLCODE = -911                                  32610000
326200             WHEN SQLCODE = -913                                  32620000
326300                  PERFORM 9900-SOFT-ABORT                         32630000
326400             WHEN SQLCODE = +100                                  32640000
326500             WHEN SQLCODE = -305                                  32650000
326600                  MOVE +0  TO PV-AP-VERIFY-ITM-QTY                32660000
326700             WHEN SQLWARN0 NOT EQUAL SPACE                        32670000
326800             WHEN SQLCODE NOT EQUAL ZERO                          32680000
326900                  MOVE '4330-GET-VERIFY-QTY'                      32690000
327000                                   TO DP013-PARAGRAPH             32700000
327100                  MOVE 'SELECT TRECDIS'                           32710000
327200                                   TO DP013-MESSAGE-TEXT (1)      32720000
327300                  MOVE SQLCA       TO DP013-SQLCA                 32730000
327400                  SET DP013-DB2-ABEND                             32740000
327500                                   TO TRUE                        32750000
327600                  PERFORM DP013-0000-PROCESS-ABEND                32760000
327700         END-EVALUATE.                                            32770000
327800                                                                  32780000
327900/                                                                 32790000
328000*----------------------------------------------------------------*32800000
328100*    GET CRE-UID FROM TPKITEM                                    *32810000
328200*----------------------------------------------------------------*32820000
328300 4340-GET-CRE-UID.                                                32830000
328400                                                                  32840000
328500         EXEC SQL                                                 32850000
328600              SELECT DISTINCT                                     32860000
328700                     A.CRE_UID                                    32870000
328800                INTO :PKITEM-CRE-UID                              32880000
328900                FROM TPKITEM A                                    32890000
329000                   , TPKSLIP B                                    32900000
329100               WHERE A.PO_NBR          = B.PO_NBR                 32910000
329200                 AND A.SEQ_NBR         = B.SEQ_NBR                32920000
329300                 AND A.PKSL_LNE_NBR    = :DK-LINE-NBR             32930000
329400                 AND A.VER_STAT_CDE    = 'A'                      32940000
329500                 AND B.PO_NBR          = :DK-ORD-NBR              32950000
329600                 AND B.REC_SEQ_NBR     = :DK-RCVR-SEQ-NBR         32960000
329700                 AND B.VER_STAT_CDE    = 'A'                      32970000
329800                WITH UR                                           32980000
329900         END-EXEC                                                 32990000
330000                                                                  33000000
330100         EVALUATE TRUE                                            33010000
330200             WHEN SQLCODE = ZERO                                  33020000
330300                  CONTINUE                                        33030000
330400             WHEN SQLCODE = -811                                  33040000
330500                  MOVE 'MULTIPLE' TO PKITEM-CRE-UID               33050000
330600             WHEN SQLCODE = -904                                  33060000
330700             WHEN SQLCODE = -911                                  33070000
330800             WHEN SQLCODE = -913                                  33080000
330900                  PERFORM 9900-SOFT-ABORT                         33090000
331000             WHEN SQLCODE = +100                                  33100000
331100             WHEN SQLCODE = -305                                  33110000
331200                  MOVE SPACES TO PKITEM-CRE-UID                   33120000
331300             WHEN SQLWARN0 NOT EQUAL SPACE                        33130000
331400             WHEN SQLCODE NOT EQUAL ZERO                          33140000
331500                  MOVE '4340-GET-CRE-UID'                         33150000
331600                                   TO DP013-PARAGRAPH             33160000
331700                  MOVE 'SELECT TPKITEM'                           33170000
331800                                   TO DP013-MESSAGE-TEXT (1)      33180000
331900                  MOVE SQLCA       TO DP013-SQLCA                 33190000
332000                  SET DP013-DB2-ABEND                             33200000
332100                                   TO TRUE                        33210000
332200                  PERFORM DP013-0000-PROCESS-ABEND                33220000
332300         END-EVALUATE.                                            33230000
332400                                                                  33240000
332500                                                                  33250000
332600*----------------------------------------------------------------*33260000
332700* CHECK TO SEE IF PO/RCVR/LINE HAS BEEN PROCESSED THROUGH        *33270000
332800* CASEPACK SPLIT PROCESS                                         *33280000
332900*----------------------------------------------------------------*33290000
333000 4350-CK-CASEPACK-SPLIT-PROCESS.                                  33300000
333100         EXEC SQL                                                 33310000
333200              SELECT ORD_NBR                                      33320000
333300                    ,RCVR_SEQ_NBR                                 33330000
333400                    ,ORD_LNE_NBR                                  33340000
333500                    ,SYS_CRE_CDE                                  33350000
333600                    ,TOT_CART_CNT                                 33360000
333700              INTO   :DISTHD-ORD-NBR                              33370000
333800                    ,:DISTHD-RCVR-SEQ-NBR                         33380000
333900                    ,:DISTHD-ORD-LNE-NBR                          33390000
334000                    ,:DISTHD-SYS-CRE-CDE                          33400000
334100                    ,:DISTHD-TOT-CART-CNT                         33410000
334200              FROM  TDISTHD                                       33420000
334300              WHERE ORD_NBR        = :DK-ORD-NBR                  33430000
334400                AND RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR             33440000
334500                AND ORD_LNE_NBR    = :DK-LINE-NBR                 33450000
334600                AND ((TOT_CART_CNT > 0)                           33460000
334700                 OR  (TOT_CART_CNT = 0 AND                        33470000
334800                      NOT CRE_USR_ID = ' ' AND                    33480000
334900                      NOT CRE_USR_ID = 'RCKUT129' AND             33490000
335000                      NOT SYS_CRE_CDE = ' '))                     33500000
335100               WITH UR                                            33510000
335200         END-EXEC                                                 33520000
335300                                                                  33530000
335400         EVALUATE TRUE                                            33540000
335500             WHEN SQLCODE = +0                                    33550000
335600                  SET ASC-CASEPACK-SPLIT-YES                      33560000
335700                      (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE        33570000
335800             WHEN SQLCODE = +100                                  33580000
335900                  SET ASC-CASEPACK-SPLIT-NO                       33590000
336000                      (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE        33600000
336100             WHEN SQLCODE = -904                                  33610000
336200             WHEN SQLCODE = -911                                  33620000
336300             WHEN SQLCODE = -913                                  33630000
336400                  PERFORM 9900-SOFT-ABORT                         33640000
336500                                                                  33650000
336600             WHEN SQLWARN0 NOT = SPACES                           33660000
336700             WHEN SQLCODE < +0                                    33670000
336800             WHEN SQLCODE > +0                                    33680000
336900                  MOVE '4350-CK-CASEPACK-SPLIT-PROCESS'           33690000
337000                                  TO DP013-PARAGRAPH              33700000
337100                  MOVE 'UNSUCCESSFUL SELECT ON TDISTHD'           33710000
337200                                  TO DP013-MESSAGE-TEXT (1)       33720000
337300                  MOVE SQLCA      TO DP013-SQLCA                  33730000
337400                  MOVE 'TDISTHD ' TO DP013-DB2-TABLE-NAME (1)     33740000
337500                  SET DP013-DB2-ABEND                             33750000
337600                      DP013-XCTL-DISPLAY-RESTART                  33760000
337700                                  TO TRUE                         33770000
337800                  PERFORM DP013-0000-PROCESS-ABEND                33780000
337900         END-EVALUATE.                                            33790000
338000                                                                  33800000
338100                                                                  33810000
338200*----------------------------------------------------------------*33820000
338300* CHECK TO SEE IF PO/RCVR/LINE EXISTS IN ANY ACTIVE OUTBOUND     *33830000
338400* MANIFESTED CARTON                                              *33840000
338500*----------------------------------------------------------------*33850000
338600 4351-CHECK-OUTBOUND.                                             33860000
338700                                                                  33870000
338800         MOVE ASC-PO-NBR   TO DK-ORD-NBR.                         33880000
338900         MOVE ASC-REC-SEQ-NBR TO DK-RCVR-SEQ-NBR.                 33890000
339000         MOVE LQW-LINE-NUMBER (LQW-IDX) TO DK-LINE-NBR.           33900000
339100                                                                  33910000
339200         EXEC SQL                                                 33920000
339300             SELECT A.SHIPT_UNT_ID                                33930000
339400             INTO   :SUT00028-SHIPT-UNT-ID                        33940000
339500             FROM  SUT_OTBND_UPC A                                33950000
339600                 , SUT_OTBND_CART B                               33960000
339700           WHERE A.TRN_NBR              = :DK-ORD-NBR             33970000
339800            AND  A.RCVR_SEQ_NBR         = :DK-RCVR-SEQ-NBR        33980000
339900            AND  A.TRN_LNE_NBR          = :DK-LINE-NBR            33990000
340000            AND  A.SHIPT_UNT_ID         =  B.SHIPT_UNT_ID         34000000
340100            AND  B.ACTV_IND             =  'Y'                    34010000
340200          FETCH FIRST 1 ROW ONLY                                  34020000
340300            WITH UR                                               34030000
340400         END-EXEC.                                                34040000
340500                                                                  34050000
340600         EVALUATE TRUE                                            34060000
340700             WHEN SQLCODE = +0                                    34070000
340800             WHEN SQLCODE = -811                                  34080000
340900                  SET ASC-MANIFEST-YES                            34090000
341000                      (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE        34100000
341100             WHEN SQLCODE = +100                                  34110000
341200                  SET ASC-MANIFEST-NO                             34120000
341300                      (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE        34130000
341400             WHEN SQLCODE = -904                                  34140000
341500             WHEN SQLCODE = -911                                  34150000
341600             WHEN SQLCODE = -913                                  34160000
341700                  PERFORM 9900-SOFT-ABORT                         34170000
341800                                                                  34180000
341900             WHEN SQLWARN0 NOT = SPACES                           34190000
342000             WHEN SQLCODE < +0                                    34200000
342100             WHEN SQLCODE > +0                                    34210000
342200                  MOVE '4351-CHECK-OUTBOUND'                      34220000
342300                                  TO DP013-PARAGRAPH              34230000
342400                  MOVE 'UNSUCCESSFUL SELECT ON OTBND  '           34240000
342500                                  TO DP013-MESSAGE-TEXT (1)       34250000
342600                  MOVE SQLCA      TO DP013-SQLCA                  34260000
342700                  MOVE 'SUT0028 ' TO DP013-DB2-TABLE-NAME (1)     34270000
342800                  SET DP013-DB2-ABEND                             34280000
342900                      DP013-XCTL-DISPLAY-RESTART                  34290000
343000                                  TO TRUE                         34300000
343100                  PERFORM DP013-0000-PROCESS-ABEND                34310000
343200         END-EVALUATE.                                            34320000
343300                                                                  34330000
343400                                                                  34340000
343500                                                                  34350000
343600                                                                  34360000
343700                                                                  34370000
343800                                                                  34380000
343900                                                                  34390000
344000*----------------------------------------------------------------*34400000
344100*    GET TRECEIV INFO FOR THE TOP OF THE SCREEN                  *34410000
344200*----------------------------------------------------------------*34420000
344300 4355-GET-TRECEIV-INFO.                                           34430000
344400                                                                  34440000
344500******    WR # 27201 - ADDED ML_POST_TMST AND FS_POST_TMST TO SEL 34450000
344600                                                                  34460000
344700         EXEC SQL                                                 34470000
344800              SELECT ORD_NBR                                      34480000
344900                    ,REC_SEQ_NBR                                  34490000
345000                    ,STATUS_CDE                                   34500000
345100                    ,EXPTED_CART_CNT                              34510000
345200                    ,ACTL_CART_CNT                                34520000
345300                    ,PKGNG_CDE                                    34530000
345400                    ,ML_POST_TMST                                 34540000
345500                    ,FS_POST_TMST                                 34550000
345600              INTO   :RECEIV-ORD-NBR                              34560000
345700                    ,:RECEIV-REC-SEQ-NBR                          34570000
345800                    ,:RECEIV-STATUS-CDE                           34580000
345900                    ,:RECEIV-EXPTED-CART-CNT                      34590000
346000                    ,:RECEIV-ACTL-CART-CNT                        34600000
346100                    ,:RECEIV-PKGNG-CDE                            34610000
346200                    ,:RECEIV-ML-POST-TMST                         34620000
346300                    ,:RECEIV-FS-POST-TMST                         34630000
346400                                                                  34640000
346500              FROM  TRECEIV                                       34650000
346600              WHERE ORD_NBR        = :DK-ORD-NBR                  34660000
346700                AND REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR             34670000
346800                AND VER_STATUS_CDE = 'A'                          34680000
346900         END-EXEC                                                 34690000
347000                                                                  34700000
347100         EVALUATE TRUE                                            34710000
347200             WHEN SQLCODE = +0                                    34720000
347300             WHEN SQLCODE = +100                                  34730000
347400                  CONTINUE                                        34740000
347500             WHEN SQLCODE = -904                                  34750000
347600             WHEN SQLCODE = -911                                  34760000
347700             WHEN SQLCODE = -913                                  34770000
347800                  PERFORM 9900-SOFT-ABORT                         34780000
347900                                                                  34790000
348000             WHEN SQLWARN0 NOT = SPACES                           34800000
348100             WHEN SQLCODE < +0                                    34810000
348200             WHEN SQLCODE > +0                                    34820000
348300                  MOVE '4355-GET-TRECIEV-INFO'                    34830000
348400                                  TO DP013-PARAGRAPH              34840000
348500                  MOVE 'UNSUCCESSFUL SELECT ON TRECEIV'           34850000
348600                                  TO DP013-MESSAGE-TEXT (1)       34860000
348700                  MOVE SQLCA      TO DP013-SQLCA                  34870000
348800                  MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)     34880000
348900                  SET DP013-DB2-ABEND                             34890000
349000                      DP013-XCTL-DISPLAY-RESTART                  34900000
349100                                  TO TRUE                         34910000
349200                  PERFORM DP013-0000-PROCESS-ABEND                34920000
349300         END-EVALUATE.                                            34930000
349400/                                                                 34940000
349500*----------------------------------------------------------------*34950000
349600*    GET TPURCHS INFO FOR THE TOP OF THE SCREEN                  *34960000
349700*----------------------------------------------------------------*34970000
349800 4360-GET-TPURCHS-INFO.                                           34980000
349900                                                                  34990000
350000         EXEC SQL                                                 35000000
350100              SELECT PO_NBR                                       35010000
350200                    ,DEPT_NBR                                     35020000
350300              INTO   :PURCHS-PO-NBR                               35030000
350400                    ,:PURCHS-DEPT-NBR                             35040000
350500                                                                  35050000
350600              FROM  TPURCHS                                       35060000
350700              WHERE PO_NBR         = :DK-ORD-NBR                  35070000
350800                AND VER_STATUS_CDE = 'A'                          35080000
350900               WITH UR                                            35090000
351000         END-EXEC                                                 35100000
351100                                                                  35110000
351200         EVALUATE TRUE                                            35120000
351300             WHEN SQLCODE = +0                                    35130000
351400             WHEN SQLCODE = +100                                  35140000
351500                  CONTINUE                                        35150000
351600             WHEN SQLCODE = -904                                  35160000
351700             WHEN SQLCODE = -911                                  35170000
351800             WHEN SQLCODE = -913                                  35180000
351900                  PERFORM 9900-SOFT-ABORT                         35190000
352000                                                                  35200000
352100             WHEN SQLWARN0 NOT = SPACES                           35210000
352200             WHEN SQLCODE < +0                                    35220000
352300             WHEN SQLCODE > +0                                    35230000
352400                  MOVE '4360-GET-TPURCHS-INFO'                    35240000
352500                                  TO DP013-PARAGRAPH              35250000
352600                  MOVE 'UNSUCCESSFUL SELECT ON TPURCHS'           35260000
352700                                  TO DP013-MESSAGE-TEXT (1)       35270000
352800                  MOVE SQLCA      TO DP013-SQLCA                  35280000
352900                  MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)     35290000
353000                  SET DP013-DB2-ABEND                             35300000
353100                      DP013-XCTL-DISPLAY-RESTART                  35310000
353200                                  TO TRUE                         35320000
353300                  PERFORM DP013-0000-PROCESS-ABEND                35330000
353400         END-EVALUATE.                                            35340000
353500/                                                                 35350000
353600 4370-FIND-LINE-TROUBLE.                                          35360000
353700     EXEC SQL                                                     35370000
353800         SELECT B.TRBL_SHT_DESC                                   35380000
353900         INTO :TRBRSN-TRBL-SHT-DESC                               35390000
354000         FROM TTRBNTF A                                           35400000
354100             ,TTRBRSN B                                           35410000
354200         WHERE A.PO_NBR               = :DK-ORD-NBR               35420000
354300               AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR          35430000
354400               AND A.PO_LNE_NBR       = :DK-LINE-NBR              35440000
354500               AND A.RESOLVED_IND IN (:PC-N, :PC-I)               35450000
354600               AND A.TRBL_RSN_CDE     = B.TRBL_RSN_CDE            35460000
354700          WITH UR                                                 35470000
354800     END-EXEC                                                     35480000
354900                                                                  35490000
355000     EVALUATE TRUE                                                35500000
355100         WHEN SQLCODE = ZERO                                      35510000
355200         WHEN SQLCODE = -811                                      35520000
355300             CONTINUE                                             35530000
355400         WHEN SQLCODE = +100                                      35540000
355500             MOVE SPACES TO TRBRSN-TRBL-SHT-DESC                  35550000
355600         WHEN SQLCODE = -904                                      35560000
355700         WHEN SQLCODE = -911                                      35570000
355800         WHEN SQLCODE = -913                                      35580000
355900              PERFORM 9900-SOFT-ABORT                             35590000
356000                                                                  35600000
356100         WHEN SQLWARN0 NOT = SPACE                                35610000
356200         WHEN SQLCODE < ZERO                                      35620000
356300         WHEN SQLCODE > ZERO                                      35630000
356400             MOVE '4370-FIND-LINE-TROUBLE'                        35640000
356500                             TO DP013-PARAGRAPH                   35650000
356600             MOVE 'SELECT ON TTRBNTF'                             35660000
356700                             TO DP013-MESSAGE-TEXT (1)            35670000
356800             MOVE SQLCA          TO DP013-SQLCA                   35680000
356900             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      35690000
357000             SET DP013-DB2-ABEND                                  35700000
357100                             TO TRUE                              35710000
357200             SET DP013-XCTL-DISPLAY-RESTART                       35720000
357300                             TO TRUE                              35730000
357400             PERFORM DP013-0000-PROCESS-ABEND                     35740000
357500     END-EVALUATE.                                                35750000
357600                                                                  35760000
357700                                                                  35770000
357800     MOVE ZERO                    TO PV-UNRSLVD-TRBL-COUNT        35780000
357900                                     PV-RSLVD-TRBL-COUNT.         35790000
358000     EXEC SQL                                                     35800000
358100         SELECT COUNT(*)                                          35810000
358200         INTO :PV-UNRSLVD-TRBL-COUNT                              35820000
358300         FROM TTRBNTF A                                           35830000
358400         WHERE A.PO_NBR               = :DK-ORD-NBR               35840000
358500               AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR          35850000
358600               AND A.PO_LNE_NBR       = :DK-LINE-NBR              35860000
358700               AND A.RESOLVED_IND IN (:PC-N, :PC-I)               35870000
358800          WITH UR                                                 35880000
358900     END-EXEC                                                     35890000
359000     EVALUATE TRUE                                                35900000
359100         WHEN SQLCODE = ZERO                                      35910000
359200         WHEN SQLCODE = +100                                      35920000
359300             CONTINUE                                             35930000
359400         WHEN SQLCODE = -904                                      35940000
359500         WHEN SQLCODE = -911                                      35950000
359600         WHEN SQLCODE = -913                                      35960000
359700              PERFORM 9900-SOFT-ABORT                             35970000
359800                                                                  35980000
359900         WHEN SQLWARN0 NOT = SPACE                                35990000
360000         WHEN SQLCODE < ZERO                                      36000000
360100         WHEN SQLCODE > ZERO                                      36010000
360200             MOVE '4370-FIND-LINE-TROUBLE'                        36020000
360300                             TO DP013-PARAGRAPH                   36030000
360400             MOVE 'SELECT ON TTRBNTF'                             36040000
360500                             TO DP013-MESSAGE-TEXT (1)            36050000
360600             MOVE SQLCA          TO DP013-SQLCA                   36060000
360700             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      36070000
360800             SET DP013-DB2-ABEND                                  36080000
360900                             TO TRUE                              36090000
361000             SET DP013-XCTL-DISPLAY-RESTART                       36100000
361100                             TO TRUE                              36110000
361200             PERFORM DP013-0000-PROCESS-ABEND                     36120000
361300     END-EVALUATE.                                                36130000
361400                                                                  36140000
361500     IF PV-UNRSLVD-TRBL-COUNT = ZERO AND SQLCODE = ZERO OR +100   36150000
361600         EXEC SQL                                                 36160000
361700             SELECT COUNT(*)                                      36170000
361800             INTO :PV-RSLVD-TRBL-COUNT                            36180000
361900             FROM TTRBNTF A                                       36190000
362000                , TTRBRSN B                                       36200000
362100             WHERE A.PO_NBR           = :DK-ORD-NBR               36210000
362200                   AND A.REC_SEQ_NBR  = :DK-RCVR-SEQ-NBR          36220000
362300                   AND A.PO_LNE_NBR   = :DK-LINE-NBR              36230000
362400                   AND A.RESOLVED_IND = :PC-R                     36240000
362500                   AND A.TRBL_RSN_CDE = B.TRBL_RSN_CDE            36250000
362600                   AND B.NOTIF_IND    = :PC-T                     36260000
362700              WITH UR                                             36270000
362800         END-EXEC                                                 36280000
362900                                                                  36290000
363000         EVALUATE TRUE                                            36300000
363100             WHEN SQLCODE = ZERO                                  36310000
363200             WHEN SQLCODE = +100                                  36320000
363300                 CONTINUE                                         36330000
363400             WHEN SQLCODE = -904                                  36340000
363500             WHEN SQLCODE = -911                                  36350000
363600             WHEN SQLCODE = -913                                  36360000
363700                  PERFORM 9900-SOFT-ABORT                         36370000
363800                                                                  36380000
363900             WHEN SQLWARN0 NOT = SPACE                            36390000
364000             WHEN SQLCODE < ZERO                                  36400000
364100             WHEN SQLCODE > ZERO                                  36410000
364200                 MOVE '4370-FIND-LINE-TROUBLE'                    36420000
364300                                 TO DP013-PARAGRAPH               36430000
364400                 MOVE 'SELECT ON TTRBNTF - TTRBRSN'               36440000
364500                                 TO DP013-MESSAGE-TEXT (1)        36450000
364600                 MOVE SQLCA      TO DP013-SQLCA                   36460000
364700                 MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME (1)      36470000
364800                 MOVE 'TTRBRSN'  TO DP013-DB2-TABLE-NAME (2)      36480000
364900                 SET DP013-DB2-ABEND                              36490000
365000                                 TO TRUE                          36500000
365100                 SET DP013-XCTL-DISPLAY-RESTART                   36510000
365200                                 TO TRUE                          36520000
365300                 PERFORM DP013-0000-PROCESS-ABEND                 36530000
365400         END-EVALUATE                                             36540000
365500     END-IF.                                                      36550000
365600******    WR # 27201 - START                                      36560000
365700*----------------------------------------------------------------*36570000
365800*    GET VERIFIED RETAIL FROM RCT_PRC_RCPT                       *36580000
365900*----------------------------------------------------------------*36590000
366000 4380-GET-VRFD-RTL.                                               36600000
366100                                                                  36610000
366200         INITIALIZE DCLRCT00019                                   36620000
366300                    PV-VRFD-LWST-RTL-AMT.                         36630000
366400                                                                  36640000
366500         EXEC SQL                                                 36650000
366600              SELECT UNT_AMT                                      36660000
366700                    ,GP_AMT                                       36670000
366800                    ,GP_QTY                                       36680000
366900              INTO   :RCT00019-UNT-AMT                            36690000
367000                    ,:RCT00019-GP-AMT                             36700000
367100                    ,:RCT00019-GP-QTY                             36710000
367200                                                                  36720000
367300              FROM  RCT_PRC_RCPT                                  36730000
367400              WHERE ORD_NBR          = :DK-ORD-NBR                36740000
367500                AND ORD_LNE_NBR      = :DK-LINE-NBR               36750000
367600                AND REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR           36760000
367700                AND OPER_UNT_ID      = :DK-OPR-ID                 36770000
367800                AND FCLTY_ID         = :DK-FACT                   36780000
367900                AND PRC_RCPT_TYP_CDE = 'VE'                       36790000
368000                AND AMT_TYP_CDE      = 'R'                        36800000
368100               WITH UR                                            36810000
368200         END-EXEC                                                 36820000
368300                                                                  36830000
368400         EVALUATE TRUE                                            36840000
368500             WHEN SQLCODE = +0                                    36850000
368600                  IF RCT00019-GP-QTY > 1                          36860000
368700                     COMPUTE PV-VRFD-LWST-RTL-AMT =               36870000
368800                             RCT00019-GP-AMT / RCT00019-GP-QTY    36880000
368900                  ELSE                                            36890000
369000                     MOVE RCT00019-UNT-AMT TO PV-VRFD-LWST-RTL-AMT36900000
369100                  END-IF                                          36910000
369200             WHEN SQLCODE = +100                                  36920000
369300                  PERFORM 4385-GET-VRFD-RTL-TRECITM               36930000
369400             WHEN SQLCODE = -904                                  36940000
369500             WHEN SQLCODE = -911                                  36950000
369600             WHEN SQLCODE = -913                                  36960000
369700                  PERFORM 9900-SOFT-ABORT                         36970000
369800                                                                  36980000
369900             WHEN SQLWARN0 NOT = SPACES                           36990000
370000             WHEN SQLCODE < +0                                    37000000
370100             WHEN SQLCODE > +0                                    37010000
370200                  MOVE '4380-GET-VRFD-RTL'                        37020000
370300                                      TO DP013-PARAGRAPH          37030000
370400                  MOVE 'UNSUCCESSFUL SELECT ON RCT_PRC_RCPT'      37040000
370500                                      TO DP013-MESSAGE-TEXT (1)   37050000
370600                  MOVE SQLCA          TO DP013-SQLCA              37060000
370700                  MOVE 'RCT_PRC_RCPT' TO DP013-DB2-TABLE-NAME (1) 37070000
370800                  SET DP013-DB2-ABEND                             37080000
370900                      DP013-XCTL-DISPLAY-RESTART                  37090000
371000                                      TO TRUE                     37100000
371100                  PERFORM DP013-0000-PROCESS-ABEND                37110000
371200         END-EVALUATE.                                            37120000
371300/                                                                 37130000
371400*----------------------------------------------------------------*37140000
371500*    GET VERIFIED RETAIL FROM TRECITM                            *37150000
371600*----------------------------------------------------------------*37160000
371700 4385-GET-VRFD-RTL-TRECITM.                                       37170000
371800                                                                  37180000
371900         EXEC SQL                                                 37190000
372000              SELECT UNT_RTL_AMT                                  37200000
372100                    ,GP_RTL_AMT                                   37210000
372200                    ,GP_QTY                                       37220000
372300              INTO   :RECITM-UNT-RTL-AMT                          37230000
372400                    ,:RECITM-GP-RTL-AMT                           37240000
372500                    ,:RECITM-GP-QTY                               37250000
372600                                                                  37260000
372700              FROM  TRECITM                                       37270000
372800              WHERE ORD_NBR        = :DK-ORD-NBR                  37280000
372900                AND ORD_LNE_NBR    = :DK-LINE-NBR                 37290000
373000                AND REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR             37300000
373100                AND STATUS_CDE     = 'VE'                         37310000
373200                AND VER_STATUS_CDE = 'A'                          37320000
373300               WITH UR                                            37330000
373400         END-EXEC                                                 37340000
373500                                                                  37350000
373600         EVALUATE TRUE                                            37360000
373700             WHEN SQLCODE = +0                                    37370000
373800                  IF RECITM-GP-QTY > 1                            37380000
373900                     COMPUTE PV-VRFD-LWST-RTL-AMT =               37390000
374000                             RECITM-GP-RTL-AMT / RECITM-GP-QTY    37400000
374100                  ELSE                                            37410000
374200                     MOVE RECITM-UNT-RTL-AMT                      37420000
374300                                           TO PV-VRFD-LWST-RTL-AMT37430000
374400                  END-IF                                          37440000
374500             WHEN SQLCODE = +100                                  37450000
374600                  CONTINUE                                        37460000
374700             WHEN SQLCODE = -904                                  37470000
374800             WHEN SQLCODE = -911                                  37480000
374900             WHEN SQLCODE = -913                                  37490000
375000                  PERFORM 9900-SOFT-ABORT                         37500000
375100                                                                  37510000
375200             WHEN SQLWARN0 NOT = SPACES                           37520000
375300             WHEN SQLCODE < +0                                    37530000
375400             WHEN SQLCODE > +0                                    37540000
375500                  MOVE '4385-GET-VRFD-RTL-TRECITM'                37550000
375600                                  TO DP013-PARAGRAPH              37560000
375700                  MOVE 'UNSUCCESSFUL SELECT ON TRECITM'           37570000
375800                                  TO DP013-MESSAGE-TEXT (1)       37580000
375900                  MOVE SQLCA      TO DP013-SQLCA                  37590000
376000                  MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)     37600000
376100                  SET DP013-DB2-ABEND                             37610000
376200                      DP013-XCTL-DISPLAY-RESTART                  37620000
376300                                  TO TRUE                         37630000
376400                  PERFORM DP013-0000-PROCESS-ABEND                37640000
376500         END-EVALUATE.                                            37650000
376600/                                                                 37660000
376700*----------------------------------------------------------------*37670000
376800*    GET FUNC BEG TMST FROM TKRPRPM                              *37680000
376900*----------------------------------------------------------------*37690000
377000 4390-GET-FUNC-BEG-TMST.                                          37700000
377100                                                                  37710000
377200         INITIALIZE DCLTKRPRPM.                                   37720000
377300                                                                  37730000
377400         EXEC SQL                                                 37740000
377500              SELECT FUNC_BEG_TMST                                37750000
377600              INTO   :KRPRPM-FUNC-BEG-TMST                        37760000
377700              FROM  TKRPRPM                                       37770000
377800                                                                  37780000
377900              WHERE LOC_ID            = 90                        37790000
378000                AND INTFC_SYS_CDE     = 'KHL'                     37800000
378100                AND SYS_PRC_FUNC_CDE  = 'VRTLDI'                  37810000
378200                AND FUNC_PRC_STAT_CDE = 'AC'                      37820000
378300               WITH UR                                            37830000
378400         END-EXEC                                                 37840000
378500                                                                  37850000
378600         EVALUATE TRUE                                            37860000
378700             WHEN SQLCODE = +0                                    37870000
378800             WHEN SQLCODE = +100                                  37880000
378900                  CONTINUE                                        37890000
379000             WHEN SQLCODE = -904                                  37900000
379100             WHEN SQLCODE = -911                                  37910000
379200             WHEN SQLCODE = -913                                  37920000
379300                  PERFORM 9900-SOFT-ABORT                         37930000
379400                                                                  37940000
379500             WHEN SQLWARN0 NOT = SPACES                           37950000
379600             WHEN SQLCODE < +0                                    37960000
379700             WHEN SQLCODE > +0                                    37970000
379800                  MOVE '4390-GET-FUNC-BEG-TMST'                   37980000
379900                                  TO DP013-PARAGRAPH              37990000
380000                  MOVE 'UNSUCCESSFUL SELECT ON TKRPRPM'           38000000
380100                                  TO DP013-MESSAGE-TEXT (1)       38010000
380200                  MOVE SQLCA      TO DP013-SQLCA                  38020000
380300                  MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)     38030000
380400                  SET DP013-DB2-ABEND                             38040000
380500                      DP013-XCTL-DISPLAY-RESTART                  38050000
380600                                  TO TRUE                         38060000
380700                  PERFORM DP013-0000-PROCESS-ABEND                38070000
380800         END-EVALUATE.                                            38080000
380900/                                                                 38090000
381000******    WR # 27201 - END                                        38100000
381100*----------------------------------------------------------------*38110000
381200* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *38120000
381300*----------------------------------------------------------------*38130000
381400                                                                  38140000
381500 4400-MOVE-COMMAREA-TO-SCREEN.                                    38150000
381600                                                                  38160000
381700     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             38170000
381800         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          38180000
381900         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          38190000
382000             MOVE +1               TO ASC-BLK-SUB                 38200000
382100             PERFORM 5100-WRITE-TEMP-STORAGE                      38210000
382200             ADD +1                TO ASC-BLK-SUB                 38220000
382300             PERFORM 5100-WRITE-TEMP-STORAGE                      38230000
382400             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             38240000
382500                 GIVING PV-BLOCK-NUMBER                           38250000
382600                 REMAINDER PV-REMAINDER                           38260000
382700             IF  PV-REMAINDER > ZERO                              38270000
382800                 ADD +1            TO PV-BLOCK-NUMBER             38280000
382900             END-IF                                               38290000
383000             MOVE +1               TO ASC-BLK-SUB                 38300000
383100             PERFORM 4410-READ-TEMP-STORAGE                       38310000
383200             ADD +1                TO ASC-BLK-SUB                 38320000
383300                                      PV-BLOCK-NUMBER             38330000
383400             PERFORM 4410-READ-TEMP-STORAGE                       38340000
383500     END-IF.                                                      38350000
383600                                                                  38360000
383700     MOVE +1                       TO ASC-BLK-SUB.                38370000
383800                                                                  38380000
383900     COMPUTE ASC-ITEM-SUB =                                       38390000
384000         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              38400000
384100         + PC-ITEMS-PER-PANEL).                                   38410000
384200                                                                  38420000
384300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        38430000
384400         ADD +1                    TO ASC-BLK-SUB                 38440000
384500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            38450000
384600     END-IF.                                                      38460000
384700                                                                  38470000
384800     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           38480000
384900         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                38490000
385000                                                                  38500000
385100     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        38510000
385200     PERFORM 4420-FORMAT-LIST-LINES                               38520000
385300         VARYING PV-SUB                                           38530000
385400         FROM PC-ITEMS-PER-PANEL BY -1                            38540000
385500         UNTIL PV-SUB < +1.                                       38550000
385600                                                                  38560000
385700     COMPUTE ASC-ITEMS-DISPLAYED =                                38570000
385800         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          38580000
385900                                                                  38590000
386000     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    38600000
386100                                      ASTRTITO.                   38610000
386200                                                                  38620000
386300     MOVE ASC-PO-NBR                   TO APONBRO.                38630000
386400     MOVE ASC-REC-SEQ-NBR              TO ASEQNBRO.               38640000
386500     MOVE ASC-STAT                     TO ASTATO.                 38650000
386510     STRING  ASC-CRE-OPER '/'                                     38651005
386520             ASC-CURR-OPER                DELIMITED BY SIZE       38652005
386530                                     INTO ACRECURO.               38653005
386600*                                                                 38660000
386700*----------------------------------------------------------------*38670000
386800*                                                    WR # 230ZZ  *38680000
386900* ADDED MOVE TO MAP OUTPUT VARIABLE                              *38690000
387000*----------------------------------------------------------------*38700000
387100*                                                                 38710000
387200     MOVE PV-SKU-DEPT                  TO ADEPNBRO                38720000
387300*                                                                 38730000
387400*----------------------------------------------------------------*38740000
387500* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *38750000
387600*----------------------------------------------------------------*38760000
387700*                                                                 38770000
387800                                                                  38780000
387900     MOVE SPACES                       TO APKGTYPO                38790000
388000     EVALUATE TRUE                                                38800000
388100         WHEN ASC-PACKAGE-TYPE-CDE = PC-M                         38810000
388200             MOVE PC-MULTIPLE-SKU-PPK TO APKGTYPO                 38820000
388300         WHEN ASC-PACKAGE-TYPE-CDE = PC-S                         38830000
388400             MOVE PC-SINGLE-SKU-PPK TO APKGTYPO                   38840000
388500         WHEN ASC-PACKAGE-TYPE-CDE = PC-I                         38850000
388600             MOVE PC-INNER-PPK         TO APKGTYPO                38860000
388700         WHEN ASC-PACKAGE-TYPE-CDE = PC-B                         38870000
388800             MOVE PC-BULK-PPK          TO APKGTYPO                38880000
388900         WHEN ASC-PACKAGE-TYPE-CDE = PC-C                         38890000
389000             MOVE PC-CASEPACK          TO APKGTYPO                38900000
389100         WHEN ASC-PACKAGE-TYPE-CDE = PC-X                         38910000
389200             MOVE PC-PKG-NOT-FOUND     TO APKGTYPO                38920000
389300      END-EVALUATE.                                               38930000
389400                                                                  38940000
389500     MOVE ASC-TRECEIV-EXPTED-CART-CNT  TO AEXQTYO.                38950000
389600     MOVE ASC-TRECEIV-ACTL-CART-CNT    TO AACQTYO.                38960000
389700     MOVE ASC-TROUB-STATUS             TO ATRBLO.                 38970000
389800                                                                  38980000
389900                                                                  38990000
390000     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    39000000
390100     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    39010000
390200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            39020000
390300                                   TO ASELITO.                    39030000
390400                                                                  39040000
390500     IF  DP020-MSG-NUMBER-X = SPACE                               39050000
390600         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  39060000
390700*            --- MORE ITEMS TO DISPLAY ----                       39070000
390800             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            39080000
390900             SET DP020-MSG-INFORMATIONAL                          39090000
391000                                   TO TRUE                        39100000
391100         END-IF                                                   39110000
391200     END-IF.                                                      39120000
391300                                                                  39130000
391400*----------------------------------------------------------------*39140000
391500*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *39150000
391600*----------------------------------------------------------------*39160000
391700                                                                  39170000
391800 4410-READ-TEMP-STORAGE.                                          39180000
391900                                                                  39190000
392000     EXEC CICS                                                    39200000
392100         READQ TS                                                 39210000
392200             QUEUE (ASC-LIST-QUEUE-NAME)                          39220000
392300             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               39230000
392400             ITEM  (PV-BLOCK-NUMBER)                              39240000
392500             RESP  (PV-CICS-RESP)                                 39250000
392600     END-EXEC.                                                    39260000
392700                                                                  39270000
392800     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       39280000
392900       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     39290000
393000         CONTINUE                                                 39300000
393100     ELSE                                                         39310000
393200         SET DP013-CICS-ABEND      TO TRUE                        39320000
393300         SET DP013-NO-ROLLBACK     TO TRUE                        39330000
393400         MOVE '4410-READ-TEMP-STORAGE'                            39340000
393500                                   TO DP013-PARAGRAPH             39350000
393600         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      39360000
393700                                   TO DP013-MESSAGE-TEXT(1)       39370000
393800         PERFORM DP013-0000-PROCESS-ABEND                         39380000
393900     END-IF.                                                      39390000
394000                                                                  39400000
394100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      39410000
394200                                   TO TRUE.                       39420000
394300                                                                  39430000
394400     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         39440000
394500         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               39450000
394600     END-IF.                                                      39460000
394700                                                                  39470000
394800/                                                                 39480000
394900*----------------------------------------------------------------*39490000
395000*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *39500000
395100*----------------------------------------------------------------*39510000
395200                                                                  39520000
395300 4420-FORMAT-LIST-LINES.                                          39530000
395400                                                                  39540000
395500     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      39550000
395600         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                39560000
395700         MOVE DP015-ASK-DRK-OFF    TO MR-SELECTA (PV-SUB)         39570000
395800         MOVE SPACES               TO MR-SELECT  (PV-SUB)         39580000
395900         MOVE SPACES               TO MR-SKU              (PV-SUB)39590000
396000                                      MR-STATUS           (PV-SUB)39600000
396100******    WR # 27201 - START                                      39610000
396200*                                     MR-APRON-DATE       (PV-SUB)39620000
396300                                      MR-VRFD-LWST-RTL    (PV-SUB)39630000
396400******    WR # 27201 - END                                        39640000
396500                                      MR-LINE             (PV-SUB)39650000
396600                                      MR-OTR              (PV-SUB)39660000
396700                                      MR-PS               (PV-SUB)39670000
396800                                      MR-DETAIL-ITEM      (PV-SUB)39680000
396900                                      MR-VERIFY-ITEM      (PV-SUB)39690000
397000                                      MR-TROUBLE          (PV-SUB)39700000
397100                                      MR-PKITEM-CRE-UID           39710000
397200                                                          (PV-SUB)39720000
397300     ELSE                                                         39730000
397400         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      39740000
397500                                                   > SPACE        39750000
397600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 39760000
397700                                   TO MR-SELECT (PV-SUB)          39770000
397800         ELSE                                                     39780000
397900             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      39790000
398000                                   TO MR-SELECT (PV-SUB)          39800000
398100         END-IF                                                   39810000
398200                                                                  39820000
398300         IF  DP030-SET-CURSOR-TRAILER                             39830000
398400             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)39840000
398500                 > SPACE)                                         39850000
398600               OR (PV-SUB = 1))                                   39860000
398700                SET DP030-SET-CURSOR-APPL-1 TO TRUE               39870000
398800                MOVE -1            TO MR-SELECTL (PV-SUB)         39880000
398900             END-IF                                               39890000
399000         END-IF                                                   39900000
399100                                                                  39910000
399200         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           39920000
399300             MOVE ASC-LINE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)      39930000
399400                                 TO MR-LINE-N (PV-SUB)            39940000
399500*                                                                 39950000
399600*----------------------------------------------------------------*39960000
399700*                                                    WR/IR 230ZZ *39970000
399800*    ADDED NEW MOVES FOR MR-SKU                      WR/IR 230ZZ *39980000
399900*----------------------------------------------------------------*39990000
400000*            MOVE ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB)              40000000
400100*                                TO MR-SKU (PV-SUB)               40010000
400200             MOVE ASC-CL  (ASC-BLK-SUB ASC-ITEM-SUB)              40020000
400300                                 TO PV-DISP-CL                    40030000
400400             MOVE ASC-SEQ (ASC-BLK-SUB ASC-ITEM-SUB)              40040000
400500                                 TO PV-DISP-SKU                   40050000
400600             MOVE PV-DISP-CL-SKU TO MR-SKU (PV-SUB)               40060000
400700*                                                                 40070000
400800*----------------------------------------------------------------*40080000
400900* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *40090000
401000*----------------------------------------------------------------*40100000
401100*                                                                 40110000
401200             MOVE ASC-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)           40120000
401300                                 TO MR-STATUS (PV-SUB)            40130000
401400             IF ASC-STATUS (ASC-BLK-SUB ASC-ITEM-SUB) NOT = PC-VE 40140000
401500             EVALUATE TRUE                                        40150000
401600                 WHEN ASC-LINE-IN-TROUBLE                         40160000
401700                               (ASC-BLK-SUB ASC-ITEM-SUB)         40170000
401800                     MOVE DP015-YELLOW                            40180000
401900                                 TO MR-STATUSC (PV-SUB)           40190000
402000                 WHEN ASC-LINE-DISTRO-TRBL                        40200000
402100                               (ASC-BLK-SUB ASC-ITEM-SUB)         40210000
402200                    MOVE DP015-PINK                               40220000
402300                                 TO MR-STATUSC (PV-SUB)           40230000
402400                 WHEN OTHER                                       40240000
402500                     MOVE DP015-BLUE                              40250000
402600                                 TO MR-STATUSC (PV-SUB)           40260000
402700             END-EVALUATE                                         40270000
402800             END-IF                                               40280000
402900                                                                  40290000
403000             MOVE ASC-OTR (ASC-BLK-SUB ASC-ITEM-SUB)              40300000
403100                                 TO MR-OTR (PV-SUB)               40310000
403200                                                                  40320000
403300             MOVE ASC-PS-ITEM (ASC-BLK-SUB ASC-ITEM-SUB)          40330000
403400                                 TO MR-PS (PV-SUB)                40340000
403500             MOVE ASC-DETAIL-ITEM (ASC-BLK-SUB ASC-ITEM-SUB)      40350000
403600                                 TO MR-DETAIL-ITEM (PV-SUB)       40360000
403700             MOVE ASC-VERIFY-ITEM (ASC-BLK-SUB ASC-ITEM-SUB)      40370000
403800                                 TO MR-VERIFY-ITEM (PV-SUB)       40380000
403900******    WR # 27201 - START                                      40390000
404000*            MOVE ASC-APRON-DTE (ASC-BLK-SUB ASC-ITEM-SUB)        40400000
404100*                                TO MR-APRON-DATE (PV-SUB)        40410000
404200             MOVE ASC-VRFD-LWST-RTL-AMT (ASC-BLK-SUB ASC-ITEM-SUB)40420000
404300                                 TO MR-VRFD-LWST-RTL-N (PV-SUB)   40430000
404400******    WR # 27201 - END                                        40440000
404500             MOVE ASC-TROUBLE (ASC-BLK-SUB ASC-ITEM-SUB)          40450000
404600                                 TO MR-TROUBLE (PV-SUB)           40460000
404700             MOVE ASC-PKITEM-CRE-UID (ASC-BLK-SUB ASC-ITEM-SUB)   40470000
404800                                 TO MR-PKITEM-CRE-UID (PV-SUB)    40480000
404900         END-IF                                                   40490000
405000     END-IF.                                                      40500000
405100                                                                  40510000
405200     SUBTRACT +1 FROM ASC-ITEM-SUB.                               40520000
405300                                                                  40530000
405400     IF  ASC-ITEM-SUB < + 1                                       40540000
405500         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                40550000
405600         MOVE +1                   TO ASC-BLK-SUB                 40560000
405700     END-IF.                                                      40570000
405800                                                                  40580000
405900*----------------------------------------------------------------*40590000
406000*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *40600000
406100*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *40610000
406200*  ISSUE A WARNING.                                              *40620000
406300*----------------------------------------------------------------*40630000
406400 4430-CHECK-FOR-BEGIN-AND-END.                                    40640000
406500                                                                  40650000
406600     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       40660000
406700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     40670000
406800*            -- NO END-OF-RANGE SPECFIED ---                      40680000
406900             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            40690000
407000             SET DP020-MSG-WARNING TO TRUE                        40700000
407100             PERFORM 4431-POSITION-AT-WARNING                     40710000
407200         END-IF                                                   40720000
407300     ELSE                                                         40730000
407400         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     40740000
407500*            -- NO BEGINNING-OF-RANGE SPECFIED ---                40750000
407600             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            40760000
407700             SET DP020-MSG-WARNING TO TRUE                        40770000
407800             PERFORM 4431-POSITION-AT-WARNING                     40780000
407900         END-IF                                                   40790000
408000     END-IF.                                                      40800000
408100                                                                  40810000
408200*----------------------------------------------------------------*40820000
408300*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *40830000
408400*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *40840000
408500*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *40850000
408600*  POSITION THE CURSOR THERE.                                    *40860000
408700*----------------------------------------------------------------*40870000
408800 4431-POSITION-AT-WARNING.                                        40880000
408900                                                                  40890000
409000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 40900000
409100                    - PV-TOP-ITEM + 1.                            40910000
409200                                                                  40920000
409300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      40930000
409400         CONTINUE                                                 40940000
409500     ELSE                                                         40950000
409600         SET DP030-SET-CURSOR-APPL-1                              40960000
409700                                   TO TRUE                        40970000
409800         MOVE -1                   TO MR-SELECTL (PV-SUB)         40980000
409900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         40990000
410000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         41000000
410100     END-IF.                                                      41010000
410200                                                                  41020000
410300     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   41030000
410400                    - PV-TOP-ITEM + 1.                            41040000
410500                                                                  41050000
410600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      41060000
410700         CONTINUE                                                 41070000
410800     ELSE                                                         41080000
410900         SET DP030-SET-CURSOR-APPL-1                              41090000
411000                                   TO TRUE                        41100000
411100         MOVE -1                   TO MR-SELECTL (PV-SUB)         41110000
411200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         41120000
411300         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         41130000
411400     END-IF.                                                      41140000
411500                                                                  41150000
411600/                                                                 41160000
411700*----------------------------------------------------------------*41170000
411800* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *41180000
411900* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *41190000
412000* FOR THE SELECTED ITEMS QUEUE.                                  *41200000
412100*                                                                *41210000
412200* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *41220000
412300* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *41230000
412400* THE ARRAY IS FULL.                                             *41240000
412500*----------------------------------------------------------------*41250000
412600                                                                  41260000
412700 5000-PREPARE-SEL-QUEUE.                                          41270000
412800                                                                  41280000
412900     MOVE +1                       TO ASC-BLK-SUB.                41290000
413000     PERFORM 5100-WRITE-TEMP-STORAGE.                             41300000
413100     ADD +1                        TO ASC-BLK-SUB.                41310000
413200     PERFORM 5100-WRITE-TEMP-STORAGE.                             41320000
413300                                                                  41330000
413400     MOVE ASC-SEL-QUEUE-NAME-OUT   TO PC000-SEL-QUEUE-NAME.       41340000
413500     PERFORM 6010-DELETE-SEL-QUEUE.                               41350000
413600                                                                  41360000
413700     IF DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                    41370000
413800         SET ASC-UPDATE-TSQ      TO TRUE                          41380000
413900         SET RC013-IDX           TO 1                             41390000
414000         MOVE ZERO               TO PC000-NUMBER-OF-TS-ITEMS      41400000
414100                              PC000-NUMBER-OF-SELECTED-ITEMS      41410000
414200         INITIALIZE RC013-SELECTED-ITEM-ARRAY                     41420000
414300                                                                  41430000
414400          PERFORM 5210-FILL-SEL-QUEUE-RECORD                      41440000
414500                 VARYING PV-ITEM                                  41450000
414600             FROM 1 BY 1                                          41460000
414700             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN      41470000
414800         IF  RC013-IDX > 1                                        41480000
414900             PERFORM 5215-WRITE-SEL-QUEUE                         41490000
415000             ADD +1              TO PC000-NUMBER-OF-TS-ITEMS      41500000
415100         END-IF                                                   41510000
415200     ELSE                                                         41520000
415300         SET ASC-UPDATE-TSQ      TO TRUE                          41530000
415400         SET PC016-IDX           TO 1                             41540000
415500         MOVE ZERO               TO PC000-NUMBER-OF-TS-ITEMS      41550000
415600                              PC000-NUMBER-OF-SELECTED-ITEMS      41560000
415700         INITIALIZE PC016-SELECTED-ITEM-ARRAY                     41570000
415800                                                                  41580000
415900          PERFORM 5200-FILL-SEL-QUEUE-RECORD                      41590000
416000                 VARYING PV-ITEM                                  41600000
416100             FROM 1 BY 1                                          41610000
416200             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN      41620000
416300         IF  PC016-IDX > 1                                        41630000
416400             PERFORM 5205-WRITE-SEL-QUEUE                         41640000
416500             ADD +1              TO PC000-NUMBER-OF-TS-ITEMS      41650000
416600         END-IF.                                                  41660000
416700                                                                  41670000
416800/                                                                 41680000
416900 5050-PREPARE-SEL-QUEUE2.                                         41690000
417000                                                                  41700000
417100     MOVE +1                       TO ASC-BLK-SUB.                41710000
417200     PERFORM 5100-WRITE-TEMP-STORAGE.                             41720000
417300     ADD +1                        TO ASC-BLK-SUB.                41730000
417400     PERFORM 5100-WRITE-TEMP-STORAGE.                             41740000
417500                                                                  41750000
417600     MOVE ASC-SEL-QUEUE-NAME-OUT   TO PC000-SEL-QUEUE-NAME.       41760000
417700     PERFORM 6010-DELETE-SEL-QUEUE.                               41770000
417800                                                                  41780000
417900                                                                  41790000
418000     SET ASC-UPDATE-TSQ        TO TRUE.                           41800000
418100     SET PC016-IDX             TO 1.                              41810000
418200     MOVE ZERO                 TO PC000-NUMBER-OF-TS-ITEMS        41820000
418300                         PC000-NUMBER-OF-SELECTED-ITEMS.          41830000
418400     INITIALIZE PC016-SELECTED-ITEM-ARRAY.                        41840000
418500                                                                  41850000
418600     SET PS-NOT-DISTHD-EXISTS TO TRUE.                            41860000
418700     PERFORM 5250-FILL-SEL-QUEUE-RECORD2                          41870000
418800             VARYING PV-ITEM                                      41880000
418900             FROM 1 BY 1                                          41890000
419000             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     41900000
419100                                                                  41910000
419200*----------------------------------------------------------------*41920000
419300*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *41930000
419400*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *41940000
419500*----------------------------------------------------------------*41950000
419600                                                                  41960000
419700 5100-WRITE-TEMP-STORAGE.                                         41970000
419800                                                                  41980000
419900     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     41990000
420000                                   TO PV-LIST-ITEM-NUMBER.        42000000
420100     COMPUTE PV-BLOCK-NUMBER =                                    42010000
420200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    42020000
420300                                                                  42030000
420400     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             42040000
420500     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             42050000
420600         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      42060000
420700             PERFORM 5105-REWRITE-ASC-LISTQ                       42070000
420800         END-IF                                                   42080000
420900     ELSE                                                         42090000
421000         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       42100000
421100         ASC-HIGHEST-BLOCK-WRITTEN + 1                            42110000
421200         PERFORM 5110-WRITE-ASC-LISTQ                             42120000
421300         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   42130000
421400     END-IF.                                                      42140000
421500                                                                  42150000
421600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      42160000
421700                                   TO TRUE.                       42170000
421800                                                                  42180000
421900/                                                                 42190000
422000*----------------------------------------------------------------*42200000
422100*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *42210000
422200*  SPECIFIC COMMAREA.                                            *42220000
422300*----------------------------------------------------------------*42230000
422400 5105-REWRITE-ASC-LISTQ.                                          42240000
422500                                                                  42250000
422600     EXEC CICS                                                    42260000
422700         WRITEQ TS                                                42270000
422800             QUEUE (ASC-LIST-QUEUE-NAME)                          42280000
422900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               42290000
423000             ITEM  (PV-BLOCK-NUMBER)                              42300000
423100             REWRITE                                              42310000
423200             RESP  (PV-CICS-RESP)                                 42320000
423300     END-EXEC.                                                    42330000
423400                                                                  42340000
423500     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           42350000
423600         CONTINUE                                                 42360000
423700     ELSE                                                         42370000
423800         SET DP013-CICS-ABEND      TO TRUE                        42380000
423900         SET DP013-NO-ROLLBACK     TO TRUE                        42390000
424000         MOVE '5105-REWRITE-ASC-LISTQ'                            42400000
424100                                   TO DP013-PARAGRAPH             42410000
424200         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     42420000
424300                                   TO DP013-MESSAGE-TEXT(1)       42430000
424400         PERFORM DP013-0000-PROCESS-ABEND                         42440000
424500     END-IF.                                                      42450000
424600                                                                  42460000
424700/                                                                 42470000
424800*----------------------------------------------------------------*42480000
424900*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *42490000
425000*  SPECIFIC COMMAREA.                                            *42500000
425100*----------------------------------------------------------------*42510000
425200 5110-WRITE-ASC-LISTQ.                                            42520000
425300                                                                  42530000
425400     EXEC CICS                                                    42540000
425500         WRITEQ TS                                                42550000
425600             QUEUE (ASC-LIST-QUEUE-NAME)                          42560000
425700             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               42570000
425800             ITEM  (PV-BLOCK-NUMBER)                              42580000
425900             RESP  (PV-CICS-RESP)                                 42590000
426000     END-EXEC.                                                    42600000
426100                                                                  42610000
426200     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      42620000
426300         SET DP013-CICS-ABEND      TO TRUE                        42630000
426400         SET DP013-NO-ROLLBACK     TO TRUE                        42640000
426500         MOVE '5110-WRITE-ASC-LISTQ'                              42650000
426600                                   TO DP013-PARAGRAPH             42660000
426700         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           42670000
426800                                   TO DP013-MESSAGE-TEXT(1)       42680000
426900         PERFORM DP013-0000-PROCESS-ABEND                         42690000
427000     END-IF.                                                      42700000
427100                                                                  42710000
427200/                                                                 42720000
427300*----------------------------------------------------------------*42730000
427400* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *42740000
427500* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *42750000
427600*----------------------------------------------------------------*42760000
427700                                                                  42770000
427800 5200-FILL-SEL-QUEUE-RECORD.                                      42780000
427900                                                                  42790000
428000     PERFORM 6112-READ-LIST-QUEUE.                                42800000
428100                                                                  42810000
428200     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       42820000
428300         PERFORM                                                  42830000
428400         VARYING LQW-IDX                                          42840000
428500         FROM 1 BY 1                                              42850000
428600         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            42860000
428700           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          42870000
428800                                                                  42880000
428900             IF  (LQW-SELECT (LQW-IDX))                           42890000
429000                 ADD +1 TO PC000-NUMBER-OF-SELECTED-ITEMS         42900000
429100                 IF LQW-CASEPACK-SPLIT-YES (LQW-IDX)              42910000
429200                     SET PS-CASEPACK-SPLIT-EXISTS TO TRUE         42920000
429300                 ELSE                                             42930000
429400                    PERFORM 4351-CHECK-OUTBOUND                   42940000
429500                    IF ASC-MANIFEST-YES (ASC-BLK-SUB ASC-ITEM-SUB)42950000
429600                       SET PS-OUTBOUND-EXISTS TO TRUE             42960000
429700                    END-IF                                        42970000
429800                 END-IF                                           42980000
429900                 IF LQW-CHECKED-IN-YES (LQW-IDX)                  42990000
430000                     SET PS-CHECKED-IN            TO TRUE         43000000
430100                 END-IF                                           43010000
430200                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              43020000
430300                                    TO PC016-ITEM (PC016-IDX)     43030000
430400                 MOVE SPACE         TO PC016-ACTION-SW (PC016-IDX)43040000
430500                 MOVE ASC-OPR-ID    TO PC016-OPER-UNT-ID          43050000
430600                                                       (PC016-IDX)43060000
430700                 MOVE ASC-FACT      TO PC016-FCLTY-ID             43070000
430800                                                       (PC016-IDX)43080000
430900                 MOVE ASC-PO-NBR    TO PC016-PO-NBR-N  (PC016-IDX)43090000
431000                 MOVE ASC-REC-SEQ-NBR                             43100000
431100                                    TO PC016-REC-SEQ-NBR-N        43110000
431200                                                       (PC016-IDX)43120000
431300                 MOVE LQW-LINE-NUMBER (LQW-IDX)                   43130000
431400                                    TO PC016-LINE-NBR-N           43140000
431500                                                       (PC016-IDX)43150000
431600                 MOVE LQW-DEPT        (LQW-IDX)                   43160000
431700                                    TO PC016-DEPT                 43170000
431800                                                       (PC016-IDX)43180000
431900                 MOVE LQW-CL          (LQW-IDX)                   43190000
432000                                    TO PC016-CL                   43200000
432100                                                       (PC016-IDX)43210000
432200                 MOVE LQW-SKU-DESC    (LQW-IDX)                   43220000
432300                                    TO PC016-SKU-DESC             43230000
432400                                                       (PC016-IDX)43240000
432500                 MOVE LQW-ITM-NBR     (LQW-IDX)                   43250000
432600                                    TO PC016-ITM-NBR              43260000
432700                                                       (PC016-IDX)43270000
432800                 MOVE LQW-VER-NBR     (LQW-IDX)                   43280000
432900                                    TO PC016-VER-NBR              43290000
433000                                                       (PC016-IDX)43300000
433100                 MOVE LQW-DETAIL-ITEM (LQW-IDX)                   43310000
433200                                    TO PC016-DTL-CK-ITM-QTY       43320000
433300                                                       (PC016-IDX)43330000
433400                 MOVE LQW-PS-ITEM     (LQW-IDX)                   43340000
433500                                    TO PC016-PKSL-ITM-QTY         43350000
433600                                                       (PC016-IDX)43360000
433700                 MOVE LQW-ITEM-VND-STYL-NAME           (LQW-IDX)  43370000
433800                                    TO PC016-VEND-STYL-NAME       43380000
433900                                                       (PC016-IDX)43390000
434000                 MOVE LQW-PURITM-UNT-QTY               (LQW-IDX)  43400000
434100                                    TO PC016-UNT-QTY   (PC016-IDX)43410000
434200                 MOVE LQW-PURITM-UNT-RTL-PR-AMT        (LQW-IDX)  43420000
434300                                    TO PC016-UNT-RTL-PR-AMT       43430000
434400                                                       (PC016-IDX)43440000
434500                 MOVE LQW-PURITM-GP-RTL-AMT            (LQW-IDX)  43450000
434600                                    TO PC016-GP-RTL-AMT(PC016-IDX)43460000
434700                 MOVE LQW-PURITM-GP-QTY                (LQW-IDX)  43470000
434800                                    TO PC016-GP-QTY    (PC016-IDX)43480000
434900                 MOVE PC-Y          TO PC016-MRKG-APRON-REQ-IND   43490000
435000                                                       (PC016-IDX)43500000
435100                 IF (DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID))      43510000
435200                    PERFORM 6000-PROCESS-REDISTRO                 43520000
435300* JAK 06/2007 - REMOVE CALL TO WSKCS305                           43530000
435400****                PERFORM 2450-CHECK-TKRPRPM                    43540000
435500****                IF PS-ASNS-TO-WMS-YES                         43550000
435600****                    PERFORM 2800-CALL-WMS-MODULE              43560000
435700****                END-IF                                        43570000
435800                 END-IF                                           43580000
435900                 SET PC016-IDX UP BY 1                            43590000
436000                 IF  PC016-IDX > PC016-MAX-ITEMS                  43600000
436100                     PERFORM 5205-WRITE-SEL-QUEUE                 43610000
436200                     ADD +1        TO PC000-NUMBER-OF-TS-ITEMS    43620000
436300                     INITIALIZE PC016-SELECTED-ITEM-ARRAY         43630000
436400                     SET PC016-IDX TO 1                           43640000
436500                 END-IF                                           43650000
436600             END-IF                                               43660000
436700         END-PERFORM                                              43670000
436800     END-IF.                                                      43680000
436900                                                                  43690000
437000     MOVE PV-ITEM TO PV-SAVE-ITEM.                                43700000
437100     PERFORM 6111-WRITE-LIST-QUEUE.                               43710000
437200                                                                  43720000
437300*----------------------------------------------------------------*43730000
437400*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *43740000
437500*----------------------------------------------------------------*43750000
437600                                                                  43760000
437700 5205-WRITE-SEL-QUEUE.                                            43770000
437800                                                                  43780000
437900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            43790000
438000                                   TO PC016-SELECTED-ITEMS.       43800000
438100                                                                  43810000
438200     EXEC CICS                                                    43820000
438300          WRITEQ TS                                               43830000
438400              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      43840000
438500              FROM  (PC016-TS-SEL-REC)                            43850000
438600              ITEM  (PV-SEL-QUEUE-ITEM)                           43860000
438700              RESP  (PV-CICS-RESP)                                43870000
438800     END-EXEC.                                                    43880000
438900                                                                  43890000
439000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          43900000
439100         CONTINUE                                                 43910000
439200     ELSE                                                         43920000
439300         SET DP013-CICS-ABEND      TO TRUE                        43930000
439400         SET DP013-NO-ROLLBACK     TO TRUE                        43940000
439500         MOVE '5205-WRITE-SEL-QUEUE'                              43950000
439600                                   TO DP013-PARAGRAPH             43960000
439700         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          43970000
439800                                   TO DP013-MESSAGE-TEXT(1)       43980000
439900         PERFORM DP013-0000-PROCESS-ABEND                         43990000
440000     END-IF.                                                      44000000
440100*----------------------------------------------------------------*44010000
440200* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *44020000
440300* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD - RC013        *44030000
440400*----------------------------------------------------------------*44040000
440500                                                                  44050000
440600 5210-FILL-SEL-QUEUE-RECORD.                                      44060000
440700                                                                  44070000
440800     PERFORM 6112-READ-LIST-QUEUE.                                44080000
440900                                                                  44090000
441000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       44100000
441100         PERFORM                                                  44110000
441200         VARYING LQW-IDX                                          44120000
441300         FROM 1 BY 1                                              44130000
441400         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            44140000
441500           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          44150000
441600                                                                  44160000
441700             IF  (LQW-SELECT (LQW-IDX))                           44170000
441800                 ADD +1 TO PC000-NUMBER-OF-SELECTED-ITEMS         44180000
441900                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              44190000
442000                                    TO RC013-ITEM (RC013-IDX)     44200000
442100                 MOVE SPACE         TO RC013-ACTION-SW (RC013-IDX)44210000
442200                 MOVE ASC-OPR-ID    TO RC013-OPER-UNT-ID          44220000
442300                                                       (RC013-IDX)44230000
442400                 MOVE ASC-FACT      TO RC013-FCLTY-ID             44240000
442500                                                       (RC013-IDX)44250000
442600                 MOVE ASC-PO-NBR    TO RC013-PO-NBR    (RC013-IDX)44260000
442700                 MOVE ASC-REC-SEQ-NBR                             44270000
442800                                    TO RC013-REC-SEQ-NBR          44280000
442900                                                       (RC013-IDX)44290000
443000                 MOVE LQW-LINE-NUMBER (LQW-IDX)                   44300000
443100                                    TO RC013-PKSL-LNE-NBR-N       44310000
443200                                                       (RC013-IDX)44320000
443300                 SET RC013-IDX UP BY 1                            44330000
443400                 IF  RC013-IDX > RC013-MAX-ITEMS                  44340000
443500                     PERFORM 5215-WRITE-SEL-QUEUE                 44350000
443600                     ADD +1        TO PC000-NUMBER-OF-TS-ITEMS    44360000
443700                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         44370000
443800                     SET RC013-IDX TO 1                           44380000
443900                 END-IF                                           44390000
444000             END-IF                                               44400000
444100         END-PERFORM                                              44410000
444200     END-IF.                                                      44420000
444300                                                                  44430000
444400     MOVE PV-ITEM TO PV-SAVE-ITEM.                                44440000
444500     PERFORM 6111-WRITE-LIST-QUEUE.                               44450000
444600                                                                  44460000
444700*----------------------------------------------------------------*44470000
444800*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE - RC013.        *44480000
444900*----------------------------------------------------------------*44490000
445000                                                                  44500000
445100 5215-WRITE-SEL-QUEUE.                                            44510000
445200                                                                  44520000
445300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            44530000
445400                                   TO RC013-SELECTED-ITEMS.       44540000
445500                                                                  44550000
445600     EXEC CICS                                                    44560000
445700          WRITEQ TS                                               44570000
445800              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      44580000
445900              FROM  (RC013-DC-SELECT-RECORD)                      44590000
446000              ITEM  (PV-SEL-QUEUE-ITEM)                           44600000
446100              RESP  (PV-CICS-RESP)                                44610000
446200     END-EXEC.                                                    44620000
446300                                                                  44630000
446400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          44640000
446500         CONTINUE                                                 44650000
446600     ELSE                                                         44660000
446700         SET DP013-CICS-ABEND      TO TRUE                        44670000
446800         SET DP013-NO-ROLLBACK     TO TRUE                        44680000
446900         MOVE '5215-WRITE-SEL-QUEUE'                              44690000
447000                                   TO DP013-PARAGRAPH             44700000
447100         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          44710000
447200                                   TO DP013-MESSAGE-TEXT(1)       44720000
447300         PERFORM DP013-0000-PROCESS-ABEND                         44730000
447400     END-IF.                                                      44740000
447500/                                                                 44750000
447600 5250-FILL-SEL-QUEUE-RECORD2.                                     44760000
447700                                                                  44770000
447800     PERFORM 6112-READ-LIST-QUEUE.                                44780000
447900                                                                  44790000
448000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       44800000
448100         PERFORM                                                  44810000
448200         VARYING LQW-IDX                                          44820000
448300         FROM 1 BY 1                                              44830000
448400         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            44840000
448500           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          44850000
448600                                                                  44860000
448700             IF  (LQW-SELECT (LQW-IDX))                           44870000
448800                 ADD +1 TO PC000-NUMBER-OF-SELECTED-ITEMS         44880000
448900                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              44890000
449000                                    TO PC016-ITEM (PC016-IDX)     44900000
449100                 MOVE SPACE         TO PC016-ACTION-SW (PC016-IDX)44910000
449200                 IF LQW-STATUS (LQW-IDX) = 'VE'                   44920000
449300                    SET PS-LINE-VERIFIED TO TRUE                  44930000
449400                 END-IF                                           44940000
449500                 IF LQW-CASEPACK-SPLIT-YES (LQW-IDX)              44950000
449600                    SET PS-DISTHD-EXISTS TO TRUE                  44960000
449700                 ELSE                                             44970000
449800                    PERFORM 4351-CHECK-OUTBOUND                   44980000
449900                    IF ASC-MANIFEST-YES                           44990000
450000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     45000000
450100                       SET PS-OUTBOUND-EXISTS TO TRUE             45010000
450200                    END-IF                                        45020000
450300                 END-IF                                           45030000
450400             END-IF                                               45040000
450500         END-PERFORM                                              45050000
450600     END-IF.                                                      45060000
450700                                                                  45070000
450800     MOVE PV-ITEM TO PV-SAVE-ITEM.                                45080000
450900     PERFORM 6111-WRITE-LIST-QUEUE.                               45090000
451000                                                                  45100000
451100*----------------------------------------------------------------*45110000
451200* DETERMINE WHAT QUANITITY NEEDS TO BE REDISTROED AND PASS IT    *45120000
451300* FOR PROCESSING THRU THE TROUBLE AND REDISTRO ROUTINES.         *45130000
451400*----------------------------------------------------------------*45140000
451500 6000-PROCESS-REDISTRO.                                           45150000
451600                                                                  45160000
451700     IF PC016-DTL-CK-ITM-QTY (PC016-IDX) > ZERO                   45170000
451800         MOVE PC016-DTL-CK-ITM-QTY (PC016-IDX)                    45180000
451900                                   TO PV-BASE-DISTRO-QTY          45190000
452000     ELSE                                                         45200000
452100         MOVE PC016-PKSL-ITM-QTY (PC016-IDX)                      45210000
452200                                   TO PV-BASE-DISTRO-QTY          45220000
452300     END-IF.                                                      45230000
452400                                                                  45240000
452500     PERFORM 6200-SELECT-RECITM-DATA.                             45250000
452600     COMPUTE PV-DISTRO-QTY = PV-BASE-DISTRO-QTY -                 45260000
452700                            (RECITM-DMG-ITM-QTY + RECITM-RTV-QTY).45270000
452800                                                                  45280000
452900     PERFORM 6300-CLEANUP-RECDIS.                                 45290000
453000                                                                  45300000
453100     PERFORM 6350-DELETE-ODD-UNIT.                                45310000
453200                                                                  45320000
453300     PERFORM 6100-CHECK-FOR-TROUBLE.                              45330000
453400                                                                  45340000
453500     IF PS-REDISTRO-OK                                            45350000
453600         PERFORM 6400-UPDATE-RECITM                               45360000
453700         IF TM500-IN-TROUBLE                                      45370000
453800* JAK 05/2007 - ADD WMS SPECIFIC MESSAGES                         45380000
453900*            MOVE PC-TSYMSG-00941        TO DP020-MSG-NUMBER      45390000
454000*            SET DP020-MSG-INFORMATIONAL TO TRUE                  45400000
454100             IF TM500-ASN-SENT-TO-WMS-YES                         45410000
454200*                * REDISTRO SUCCESSFUL, ASN WILL BE               45420000
454300*                * DOWNLOADED TO WMS BUT TROUBLE CREATED          45430000
454400                 MOVE PC-TSYMSG-03569  TO DP020-MSG-NUMBER        45440000
454500                 SET DP020-MSG-INFORMATIONAL TO TRUE              45450000
454600             ELSE                                                 45460000
454700*                * REDISTRO SUCCESSFUL BUT TROUBLE CREATED        45470000
454800                 MOVE PC-TSYMSG-00941  TO DP020-MSG-NUMBER        45480000
454900                 SET DP020-MSG-INFORMATIONAL TO TRUE              45490000
455000             END-IF                                               45500000
455100         ELSE                                                     45510000
455200*            MOVE PC-TSYMSG-00059        TO DP020-MSG-NUMBER      45520000
455300*            SET DP020-MSG-INFORMATIONAL TO TRUE                  45530000
455400             IF TM500-ASN-SENT-TO-WMS-YES                         45540000
455500*                * REDISTRO SUCCESSFUL AND ASN WILL BE            45550000
455600*                * DOWNLOADED TO WMS                              45560000
455700                 MOVE PC-TSYMSG-03568  TO DP020-MSG-NUMBER        45570000
455800                 SET DP020-MSG-INFORMATIONAL TO TRUE              45580000
455900             ELSE                                                 45590000
456000*                * UPDATE SUCCESSFUL                              45600000
456100                 MOVE PC-TSYMSG-00059  TO DP020-MSG-NUMBER        45610000
456200                 SET DP020-MSG-INFORMATIONAL TO TRUE              45620000
456300             END-IF                                               45630000
456400         END-IF                                                   45640000
456500     ELSE                                                         45650000
456600         MOVE PC-TSYMSG-00937        TO DP020-MSG-NUMBER          45660000
456700         SET DP020-MSG-INFORMATIONAL TO TRUE                      45670000
456800     END-IF.                                                      45680000
456900                                                                  45690000
457000 6100-CHECK-FOR-TROUBLE.                                          45700000
457100                                                                  45710000
457200     INITIALIZE TM500-FIELDS.                                     45720000
457300                                                                  45730000
457400     SET  TM500-CREATE-AUTO        TO TRUE.                       45740000
457500     SET  TM500-LINE-LEVEL         TO TRUE.                       45750000
457600     SET  TM500-NO-DETAILS         TO TRUE.                       45760000
457700     SET  TM500-REDISTRO-YES       TO TRUE.                       45770000
457800     MOVE ASC-PO-NBR               TO TM500-PO-NBR.               45780000
457900     MOVE LQW-LINE-NUMBER (LQW-IDX)                               45790000
458000                                   TO TM500-PO-LNE-NBR.           45800000
458100     MOVE ASC-OPR-ID               TO TM500-OPER-UNT-ID.          45810000
458200     MOVE ASC-FACT                 TO TM500-FCLTY-ID.             45820000
458300     MOVE PV-DISTRO-QTY            TO TM500-UNITS-TO-ALLOC.       45830000
458400     PERFORM 6150-GET-PURITM.                                     45840000
458500     MOVE PURITM-PIC-ITM-IND       TO TM500-AD-SW.                45850000
458600*  TM500-RTV-SW IS LOADED BY TMKCS505 ONLY                        45860000
458700     MOVE PC-CURRENT-PROGRAM-NAME  TO TM500-NOTIF-UID.            45870000
458800     MOVE ASC-REC-SEQ-NBR          TO TM500-REC-SEQ-NBR           45880000
458900                                                                  45890000
459000     SET PS-REDISTRO-OK            TO TRUE                        45900000
459100                                                                  45910000
459200     EXEC CICS                                                    45920000
459300         LINK PROGRAM  (PC-TROUBLE-RTN)                           45930000
459400              COMMAREA (TM500-FIELDS)                             45940000
459500              LENGTH   (PC-TROUBLE-RTN-LENGTH)                    45950000
459600     END-EXEC.                                                    45960000
459700                                                                  45970000
459800     EVALUATE TRUE                                                45980000
459900         WHEN TM500-CALL-SUCCESSFUL                               45990000
460000         WHEN TM500-DUPLICATE-TROUBLE                             46000000
460100         WHEN TM500-TTRBNTF-UPDATE-NOT-FND                        46010000
460200              IF TM500-IN-TROUBLE                                 46020000
460300                  ADD 1 TO PV-TROUBLE-COUNT                       46030000
460400              ELSE                                                46040000
460500                  ADD 1 TO PV-NOT-IN-TROUBLE-COUNT                46050000
460600              END-IF                                              46060000
460700                                                                  46070000
460800         WHEN TM500-DIDNT-ALLOC-DUE-TO-TRBL                       46080000
460900              SET PS-REDISTRO-NOT-OK TO TRUE                      46090000
461000                                                                  46100000
461100              IF TM500-IN-TROUBLE                                 46110000
461200                  ADD 1 TO PV-TROUBLE-COUNT                       46120000
461300              ELSE                                                46130000
461400                  ADD 1 TO PV-NOT-IN-TROUBLE-COUNT                46140000
461500              END-IF                                              46150000
461600                                                                  46160000
461700         WHEN OTHER                                               46170000
461800              MOVE '6100-CHECK-FOR-TROUBLE'                       46180000
461900                                    TO DP013-PARAGRAPH            46190000
462000              MOVE 'UNSUCCESSFUL CALL TO TROUBLE RTN'             46200000
462100                                    TO DP013-MESSAGE-TEXT (1)     46210000
462200              MOVE TM500-RETURN-MSG TO DP013-MESSAGE-TEXT (2)     46220000
462300              MOVE TM500-SQLCA      TO DP013-SQLCA                46230000
462400              SET DP013-DB2-ABEND                                 46240000
462500                  DP013-XCTL-DISPLAY-RESTART                      46250000
462600                                    TO TRUE                       46260000
462700              PERFORM DP013-0000-PROCESS-ABEND                    46270000
462800                                                                  46280000
462900     END-EVALUATE.                                                46290000
463000 6150-GET-PURITM.                                                 46300000
463100                                                                  46310000
463200     MOVE ASC-PO-NBR               TO    PV-PO-NBR.               46320000
463300     MOVE LQW-LINE-NUMBER (LQW-IDX) TO   PV-PO-LNE-NBR.           46330000
463400                                                                  46340000
463500     EXEC SQL                                                     46350000
463600          SELECT DISTINCT                                         46360000
463700                 A.DEPT_NBR,                                      46370000
463800                 A.ENT_ID,                                        46380000
463900                 B.PIC_ITM_IND                                    46390000
464000            INTO :PURCHS-DEPT-NBR,                                46400000
464100                 :PURCHS-ENT-ID,                                  46410000
464200                 :PURITM-PIC-ITM-IND                              46420000
464300            FROM TPURCHS A,                                       46430000
464400                 TPURITM B,                                       46440000
464500                 TRECITM C                                        46450000
464600           WHERE A.PO_NBR         = :PV-PO-NBR                    46460000
464700             AND A.VER_STATUS_CDE = 'A'                           46470000
464800             AND A.PO_NBR         = B.PO_NBR                      46480000
464900             AND A.PO_NBR         = C.ORD_NBR                     46490000
465000             AND B.APP_PO_LNE_NBR = :PV-PO-LNE-NBR                46500000
465100             AND C.ORD_LNE_NBR    = :PV-PO-LNE-NBR                46510000
465200             AND C.VER_STATUS_CDE = 'A'                           46520000
465300             AND C.REC_SEQ_NBR    = :PV-REC-SEQ-NBR               46530000
465400             AND C.PO_VER_NBR     = B.VER_NBR                     46540000
465500            WITH UR                                               46550000
465600     END-EXEC.                                                    46560000
465700                                                                  46570000
465800     EVALUATE TRUE                                                46580000
465900         WHEN SQLCODE = +0                                        46590000
466000         WHEN SQLCODE = +100                                      46600000
466100              CONTINUE                                            46610000
466200         WHEN SQLWARN0 NOT = SPACES                               46620000
466300         WHEN SQLCODE < +0                                        46630000
466400         WHEN SQLCODE > +0                                        46640000
466500              MOVE '6150-GET-PURITM'                              46650000
466600                               TO DP013-PARAGRAPH                 46660000
466700              MOVE 'UNSUCCESSFUL SELECT ON PO ITEM'               46670000
466800                               TO DP013-MESSAGE-TEXT (1)          46680000
466900              MOVE SQLCA       TO DP013-SQLCA                     46690000
467000              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        46700000
467100              SET DP013-DB2-ABEND                                 46710000
467200                  DP013-XCTL-DISPLAY-RESTART                      46720000
467300                               TO TRUE                            46730000
467400              PERFORM DP013-0000-PROCESS-ABEND                    46740000
467500     END-EVALUATE.                                                46750000
467600                                                                  46760000
467700 6200-SELECT-RECITM-DATA.                                         46770000
467800     MOVE ASC-PO-NBR       TO PV-PO-NBR.                          46780000
467900     MOVE LQW-LINE-NUMBER (LQW-IDX)                               46790000
468000                           TO PV-PO-LNE-NBR.                      46800000
468100     MOVE ASC-REC-SEQ-NBR                                         46810000
468200                           TO PV-REC-SEQ-NBR.                     46820000
468300     MOVE ASC-OPR-ID       TO PV-OPER-UNT-ID.                     46830000
468400     MOVE ASC-FACT         TO PV-FCLTY-ID.                        46840000
468500                                                                  46850000
468600     EXEC SQL                                                     46860000
468700           SELECT RTV_QTY                                         46870000
468800                , DMG_ITM_QTY                                     46880000
468900             INTO :RECITM-RTV-QTY                                 46890000
469000                , :RECITM-DMG-ITM-QTY                             46900000
469100             FROM TRECITM                                         46910000
469200            WHERE ORD_NBR            = :PV-PO-NBR                 46920000
469300              AND ORD_LNE_NBR        = :PV-PO-LNE-NBR             46930000
469400              AND REC_SEQ_NBR        = :PV-REC-SEQ-NBR            46940000
469500              AND VER_STATUS_CDE = 'A'                            46950000
469600     END-EXEC                                                     46960000
469700                                                                  46970000
469800     EVALUATE TRUE                                                46980000
469900         WHEN SQLCODE = ZERO                                      46990000
470000              CONTINUE                                            47000000
470100         WHEN SQLWARN0 NOT = SPACES                               47010000
470200         WHEN SQLCODE      NOT = ZERO                             47020000
470300              MOVE '6200-SELECT-RECITM-DATA'                      47030000
470400                             TO DP013-PARAGRAPH                   47040000
470500              MOVE 'UNSUCCESSFUL SELECT OF RECITM HEADER DATA'    47050000
470600                             TO DP013-MESSAGE-TEXT (1)            47060000
470700              MOVE SQLCA         TO DP013-SQLCA                   47070000
470800              MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)          47080000
470900              SET DP013-DB2-ABEND                                 47090000
471000                  DP013-XCTL-DISPLAY-RESTART                      47100000
471100                             TO TRUE                              47110000
471200                                                                  47120000
471300              PERFORM DP013-0000-PROCESS-ABEND                    47130000
471400     END-EVALUATE.                                                47140000
471500                                                                  47150000
471600 6300-CLEANUP-RECDIS.                                             47160000
471700                                                                  47170000
471800     EXEC SQL                                                     47180000
471900           DELETE                                                 47190000
472000             FROM TRECDIS                                         47200000
472100            WHERE ORD_NBR            = :PV-PO-NBR                 47210000
472200              AND ORD_LNE_NBR        = :PV-PO-LNE-NBR             47220000
472300              AND REC_SEQ_NBR        = :PV-REC-SEQ-NBR            47230000
472400              AND OPER_UNT_ID        = :PV-OPER-UNT-ID            47240000
472500              AND FCLTY_ID           = :PV-FCLTY-ID               47250000
472600     END-EXEC                                                     47260000
472700                                                                  47270000
472800     EVALUATE TRUE                                                47280000
472900         WHEN SQLCODE = ZERO                                      47290000
473000         WHEN SQLCODE = +100                                      47300000
473100              CONTINUE                                            47310000
473200         WHEN SQLWARN0 NOT = SPACES                               47320000
473300         WHEN SQLCODE      NOT = ZERO                             47330000
473400              MOVE '6300-CLEANUP-RECDIS'                          47340000
473500                             TO DP013-PARAGRAPH                   47350000
473600              MOVE 'UNSUCCESSFUL DELETE OF RECDIS DATA'           47360000
473700                             TO DP013-MESSAGE-TEXT (1)            47370000
473800              MOVE SQLCA         TO DP013-SQLCA                   47380000
473900              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          47390000
474000              SET DP013-DB2-ABEND                                 47400000
474100                  DP013-XCTL-DISPLAY-RESTART                      47410000
474200                             TO TRUE                              47420000
474300                                                                  47430000
474400              PERFORM DP013-0000-PROCESS-ABEND                    47440000
474500     END-EVALUATE.                                                47450000
474600                                                                  47460000
474700 6350-DELETE-ODD-UNIT.                                            47470000
474800                                                                  47480000
474900     EXEC SQL                                                     47490000
475000          DELETE                                                  47500000
475100            FROM RCT_VRFD_ODD_UNT                                 47510000
475200            WHERE PO_NBR         = :PV-PO-NBR                     47520000
475300              AND PO_LNE_NBR     = :PV-PO-LNE-NBR                 47530000
475400              AND RCVR_SEQ_NBR   = :PV-REC-SEQ-NBR                47540000
475500     END-EXEC.                                                    47550000
475600                                                                  47560000
475700     EVALUATE TRUE                                                47570000
475800         WHEN SQLCODE = ZERO                                      47580000
475900         WHEN SQLCODE = +100                                      47590000
476000              CONTINUE                                            47600000
476100         WHEN SQLCODE = -904                                      47610000
476200         WHEN SQLCODE = -911                                      47620000
476300         WHEN SQLCODE = -913                                      47630000
476400              PERFORM 9900-SOFT-ABORT                             47640000
476500                                                                  47650000
476600         WHEN SQLWARN0 NOT = SPACES                               47660000
476700         WHEN SQLCODE  NOT = ZERO                                 47670000
476800              MOVE '6350-DELETE-ODD-UNIT'                         47680000
476900                             TO DP013-PARAGRAPH                   47690000
477000              MOVE 'UNSUCCESSFUL DELETE OF RCT_VRFD_ODD_UNT'      47700000
477100                             TO DP013-MESSAGE-TEXT (1)            47710000
477200                                                                  47720000
477300              MOVE PV-PO-NBR      TO PV-PO-NBR-PIC9               47730000
477400              MOVE PV-REC-SEQ-NBR TO PV-REC-SEQ-NBR-PIC9          47740000
477500              MOVE PV-PO-LNE-NBR  TO PV-PO-LNE-NBR-PIC9           47750000
477600              STRING 'PO '                                        47760000
477700                     PV-PO-NBR-PIC9                               47770000
477800                     ' SEQ '                                      47780000
477900                     PV-REC-SEQ-NBR-PIC9                          47790000
478000                     ' LINE '                                     47800000
478100                     PV-PO-LNE-NBR-PIC9                           47810000
478200                     DELIMITED BY SIZE                            47820000
478300                     INTO DP013-MESSAGE-TEXT (2)                  47830000
478400              MOVE SQLCA     TO DP013-SQLCA                       47840000
478500              MOVE 'RCT00009' TO DP013-DB2-TABLE-NAME (1)         47850000
478600              SET DP013-DB2-ABEND                                 47860000
478700                  DP013-XCTL-DISPLAY-RESTART                      47870000
478800                             TO TRUE                              47880000
478900              PERFORM DP013-0000-PROCESS-ABEND                    47890000
479000     END-EVALUATE.                                                47900000
479100                                                                  47910000
479200                                                                  47920000
479300******************************************************************47930000
479400* UPDATE TRECITM WHEN REDISTRO IS SUCCESSFUL.                    *47940000
479500******************************************************************47950000
479600 6400-UPDATE-RECITM.                                              47960000
479700                                                                  47970000
479800     EXEC SQL                                                     47980000
479900           UPDATE TRECITM                                         47990000
480000              SET LAST_TRSCP_TMST   = CURRENT TIMESTAMP           48000000
480100                , LAST_TRSCP_USR_ID = :DP020-USERID               48010000
480200            WHERE ORD_NBR           = :PV-PO-NBR                  48020000
480300              AND ORD_LNE_NBR       = :PV-PO-LNE-NBR              48030000
480400              AND REC_SEQ_NBR       = :PV-REC-SEQ-NBR             48040000
480500              AND VER_STATUS_CDE    = 'A'                         48050000
480600     END-EXEC.                                                    48060000
480700                                                                  48070000
480800     EVALUATE TRUE                                                48080000
480900         WHEN SQLCODE = ZERO                                      48090000
481000              CONTINUE                                            48100000
481100         WHEN SQLWARN0 NOT = SPACE                                48110000
481200         WHEN SQLCODE NOT = ZERO                                  48120000
481300              MOVE '6400-UPDATE-RECITM'                           48130000
481400                               TO DP013-PARAGRAPH                 48140000
481500              MOVE 'UPDATE TRECITM'                               48150000
481600                               TO DP013-MESSAGE-TEXT (1)          48160000
481700              MOVE SQLCA       TO DP013-SQLCA                     48170000
481800              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        48180000
481900              SET DP013-DB2-ABEND                                 48190000
482000                               TO TRUE                            48200000
482100              PERFORM DP013-0000-PROCESS-ABEND                    48210000
482200     END-EVALUATE.                                                48220000
482300                                                                  48230000
482400*----------------------------------------------------------------*48240000
482500*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *48250000
482600*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *48260000
482700*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *48270000
482800*  THE USER.                                                     *48280000
482900*----------------------------------------------------------------*48290000
483000                                                                  48300000
483100 6000-REFRESH-PANEL-FROM-TEMP.                                    48310000
483200                                                                  48320000
483300     IF (ASC-UPDATE-TSQ                                           48330000
483400     OR  ASC-UPDATE-TSQ2)                                         48340000
483500         MOVE ZERO                 TO PV-SAVE-ITEM                48350000
483600                                      PV-SEL-QUEUE-ITEM           48360000
483700         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        48370000
483800                                   TO PV-HOLD-SELECTED-ITEMS      48380000
483900         IF  ASC-UPDATE-TSQ                                       48390000
484000             PERFORM 6100-UPDATE-TSQ                              48400000
484100                 UNTIL PV-ITEMS-PROCESSED >                       48410000
484200                                     ASC-NUMBER-OF-SELECTED-ITEMS 48420000
484300         ELSE                                                     48430000
484400             PERFORM 6101-UPDATE-TSQ2                             48440000
484500                 UNTIL PV-ITEMS-PROCESSED >                       48450000
484600                                     ASC-NUMBER-OF-SELECTED-ITEMS 48460000
484700         END-IF                                                   48470000
484800                                                                  48480000
484900         PERFORM 6010-DELETE-SEL-QUEUE                            48490000
485000         SET ASC-NO-TSQ-UPDATE TO TRUE                            48500000
485100         INITIALIZE ASC-BLOCK-ENTRIES (1)                         48510000
485200                    ASC-BLOCK-ENTRIES (2)                         48520000
485300                                                                  48530000
485400         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 48540000
485500                GIVING PV-BLOCK-NUMBER                            48550000
485600                REMAINDER PV-REMAINDER                            48560000
485700         IF  PV-REMAINDER > ZERO                                  48570000
485800             ADD +1     TO PV-BLOCK-NUMBER                        48580000
485900         END-IF                                                   48590000
486000         MOVE +1        TO ASC-BLK-SUB                            48600000
486100         PERFORM 4410-READ-TEMP-STORAGE                           48610000
486200         ADD +1         TO ASC-BLK-SUB                            48620000
486300                           PV-BLOCK-NUMBER                        48630000
486400         PERFORM 4410-READ-TEMP-STORAGE                           48640000
486500     END-IF.                                                      48650000
486600/                                                                 48660000
486700*----------------------------------------------------------------*48670000
486800*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *48680000
486900*----------------------------------------------------------------*48690000
487000 6010-DELETE-SEL-QUEUE.                                           48700000
487100                                                                  48710000
487200     EXEC CICS                                                    48720000
487300         DELETEQ TS                                               48730000
487400             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       48740000
487500             RESP  (PV-CICS-RESP)                                 48750000
487600     END-EXEC.                                                    48760000
487700                                                                  48770000
487800     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      48780000
487900         (PV-CICS-RESP = DFHRESP(QIDERR)))                        48790000
488000         CONTINUE                                                 48800000
488100     ELSE                                                         48810000
488200         SET DP013-CICS-ABEND      TO TRUE                        48820000
488300         SET DP013-NO-ROLLBACK     TO TRUE                        48830000
488400         MOVE '6010-DELETE-SEL-QUEUE'                             48840000
488500                                   TO DP013-PARAGRAPH             48850000
488600         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         48860000
488700                                   TO DP013-MESSAGE-TEXT (1)      48870000
488800         PERFORM DP013-0000-PROCESS-ABEND                         48880000
488900     END-IF.                                                      48890000
489000/                                                                 48900000
489100*----------------------------------------------------------------*48910000
489200*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *48920000
489300*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *48930000
489400*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *48940000
489500*    THE TEMP QUEUE.                                             *48950000
489600*----------------------------------------------------------------*48960000
489700                                                                  48970000
489800 6100-UPDATE-TSQ.                                                 48980000
489900                                                                  48990000
490000     ADD 1                         TO PV-SEL-QUEUE-ITEM.          49000000
490100     PERFORM 6105-READ-SEL-QUEUE.                                 49010000
490200                                                                  49020000
490300     PERFORM                                                      49030000
490400         VARYING PC016-IDX                                        49040000
490500         FROM 1 BY 1                                              49050000
490600         UNTIL ((PV-ITEMS-PROCESSED >                             49060000
490700                              PV-HOLD-SELECTED-ITEMS)             49070000
490800         OR (PC016-IDX GREATER THAN PC016-MAX-ITEMS))             49080000
490900         IF  PC016-ACTION-SW (PC016-IDX) > SPACE                  49090000
491000             PERFORM 6110-PROCESS-ITEMS                           49100000
491100         END-IF                                                   49110000
491200         ADD +1                    TO PV-ITEMS-PROCESSED          49120000
491300     END-PERFORM.                                                 49130000
491400                                                                  49140000
491500     PERFORM 6111-WRITE-LIST-QUEUE.                               49150000
491600/                                                                 49160000
491700*----------------------------------------------------------------*49170000
491800*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *49180000
491900*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *49190000
492000*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *49200000
492100*    THE TEMP QUEUE.                                             *49210000
492200*----------------------------------------------------------------*49220000
492300                                                                  49230000
492400 6101-UPDATE-TSQ2.                                                49240000
492500                                                                  49250000
492600     ADD 1                         TO PV-SEL-QUEUE-ITEM.          49260000
492700     PERFORM 6106-READ-SEL-QUEUE2.                                49270000
492800                                                                  49280000
492900     PERFORM                                                      49290000
493000         VARYING RC013-IDX                                        49300000
493100         FROM 1 BY 1                                              49310000
493200         UNTIL ((PV-ITEMS-PROCESSED >                             49320000
493300                              PV-HOLD-SELECTED-ITEMS)             49330000
493400         OR (RC013-IDX GREATER THAN RC013-MAX-ITEMS))             49340000
493500             IF  RC013-ACTION-SW (PC016-IDX) > SPACE              49350000
493600                 PERFORM 6109-PROCESS-ITEMS2                      49360000
493700             END-IF                                               49370000
493800         ADD +1                    TO PV-ITEMS-PROCESSED          49380000
493900     END-PERFORM.                                                 49390000
494000                                                                  49400000
494100     PERFORM 6111-WRITE-LIST-QUEUE.                               49410000
494200/                                                                 49420000
494300*----------------------------------------------------------------*49430000
494400*    READ THE LIST QUEUE RECORD.                                 *49440000
494500*----------------------------------------------------------------*49450000
494600                                                                  49460000
494700 6105-READ-SEL-QUEUE.                                             49470000
494800                                                                  49480000
494900     EXEC CICS                                                    49490000
495000          READQ TS                                                49500000
495100              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      49510000
495200              INTO  (PC016-TS-SEL-REC)                            49520000
495300              ITEM  (PV-SEL-QUEUE-ITEM)                           49530000
495400              RESP  (PV-CICS-RESP)                                49540000
495500     END-EXEC.                                                    49550000
495600                                                                  49560000
495700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          49570000
495800         CONTINUE                                                 49580000
495900     ELSE                                                         49590000
496000         SET DP013-CICS-ABEND      TO TRUE                        49600000
496100         SET DP013-NO-ROLLBACK     TO TRUE                        49610000
496200         MOVE '6105-READ-SEL-QUEUE'                               49620000
496300                                   TO DP013-PARAGRAPH             49630000
496400         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           49640000
496500                                   TO DP013-MESSAGE-TEXT(1)       49650000
496600         PERFORM DP013-0000-PROCESS-ABEND                         49660000
496700     END-IF.                                                      49670000
496800                                                                  49680000
496900/                                                                 49690000
497000*----------------------------------------------------------------*49700000
497100*    READ THE LIST QUEUE RECORD.                                 *49710000
497200*----------------------------------------------------------------*49720000
497300                                                                  49730000
497400 6106-READ-SEL-QUEUE2.                                            49740000
497500                                                                  49750000
497600     EXEC CICS                                                    49760000
497700          READQ TS                                                49770000
497800              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      49780000
497900              INTO  (RC013-DC-SELECT-RECORD)                      49790000
498000              ITEM  (PV-SEL-QUEUE-ITEM)                           49800000
498100              RESP  (PV-CICS-RESP)                                49810000
498200     END-EXEC.                                                    49820000
498300                                                                  49830000
498400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          49840000
498500         CONTINUE                                                 49850000
498600     ELSE                                                         49860000
498700         SET DP013-CICS-ABEND      TO TRUE                        49870000
498800         SET DP013-NO-ROLLBACK     TO TRUE                        49880000
498900         MOVE '6106-READ-SEL-QUEUE2'                              49890000
499000                                   TO DP013-PARAGRAPH             49900000
499100         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           49910000
499200                                   TO DP013-MESSAGE-TEXT(1)       49920000
499300         PERFORM DP013-0000-PROCESS-ABEND                         49930000
499400     END-IF.                                                      49940000
499500/                                                                 49950000
499600*----------------------------------------------------------------*49960000
499700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*49970000
499800*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*49980000
499900*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *49990000
500000*----------------------------------------------------------------*50000000
500100                                                                  50010000
500200 6109-PROCESS-ITEMS2.                                             50020000
500300                                                                  50030000
500400     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          50040000
500500                     / PC-ITEMS-PER-PANEL).                       50050000
500600                                                                  50060000
500700     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           50070000
500800         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          50080000
500900             PERFORM 6111-WRITE-LIST-QUEUE                        50090000
501000         END-IF                                                   50100000
501100         MOVE PV-ITEM              TO PV-SAVE-ITEM                50110000
501200                                                                  50120000
501300         PERFORM 6112-READ-LIST-QUEUE                             50130000
501400         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               50140000
501500             CONTINUE                                             50150000
501600         END-IF                                                   50160000
501700     END-IF.                                                      50170000
501800                                                                  50180000
501900     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX)                     50190000
502000                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              50200000
502100                                                                  50210000
502200     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       50220000
502300     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        50230000
502400                                     (PV-SUB).                    50240000
502500     EVALUATE TRUE                                                50250000
502600         WHEN RC013-INQ (RC013-IDX)                               50260000
502700              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             50270000
502800                                                                  50280000
502900         WHEN RC013-UPD (RC013-IDX)                               50290000
503000              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             50300000
503100                                                                  50310000
503200         WHEN RC013-DEL (RC013-IDX)                               50320000
503300              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             50330000
503400                                                                  50340000
503500         WHEN RC013-ERR (RC013-IDX)                               50350000
503600              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             50360000
503700     END-EVALUATE.                                                50370000
503800                                                                  50380000
503900     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                50390000
504000/                                                                 50400000
504100*----------------------------------------------------------------*50410000
504200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*50420000
504300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*50430000
504400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *50440000
504500*----------------------------------------------------------------*50450000
504600                                                                  50460000
504700 6110-PROCESS-ITEMS.                                              50470000
504800                                                                  50480000
504900     COMPUTE PV-ITEM = 1 + ((PC016-ITEM (PC016-IDX) - 1)          50490000
505000                     / PC-ITEMS-PER-PANEL).                       50500000
505100                                                                  50510000
505200     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           50520000
505300         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          50530000
505400             PERFORM 6111-WRITE-LIST-QUEUE                        50540000
505500         END-IF                                                   50550000
505600         MOVE PV-ITEM              TO PV-SAVE-ITEM                50560000
505700                                                                  50570000
505800         PERFORM 6112-READ-LIST-QUEUE                             50580000
505900         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               50590000
506000             CONTINUE                                             50600000
506100         END-IF                                                   50610000
506200     END-IF.                                                      50620000
506300                                                                  50630000
506400     COMPUTE PV-SUB = (PC016-ITEM (PC016-IDX)                     50640000
506500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              50650000
506600                                                                  50660000
506700     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       50670000
506800     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        50680000
506900                                     (PV-SUB).                    50690000
507000     EVALUATE TRUE                                                50700000
507100         WHEN PC016-INQ (PC016-IDX)                               50710000
507200              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             50720000
507300                                                                  50730000
507400         WHEN PC016-UPD (PC016-IDX)                               50740000
507500              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             50750000
507600                                                                  50760000
507700         WHEN PC016-DEL (PC016-IDX)                               50770000
507800              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             50780000
507900                                                                  50790000
508000         WHEN PC016-ERR (PC016-IDX)                               50800000
508100              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             50810000
508200     END-EVALUATE.                                                50820000
508300                                                                  50830000
508400     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                50840000
508500/                                                                 50850000
508600*----------------------------------------------------------------*50860000
508700*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *50870000
508800*----------------------------------------------------------------*50880000
508900                                                                  50890000
509000 6111-WRITE-LIST-QUEUE.                                           50900000
509100                                                                  50910000
509200     EXEC CICS                                                    50920000
509300         WRITEQ TS                                                50930000
509400             QUEUE (ASC-LIST-QUEUE-NAME)                          50940000
509500             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     50950000
509600             ITEM  (PV-SAVE-ITEM)                                 50960000
509700             REWRITE                                              50970000
509800             RESP  (PV-CICS-RESP)                                 50980000
509900     END-EXEC.                                                    50990000
510000                                                                  51000000
510100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          51010000
510200         CONTINUE                                                 51020000
510300     ELSE                                                         51030000
510400         SET DP013-CICS-ABEND      TO TRUE                        51040000
510500         SET DP013-NO-ROLLBACK     TO TRUE                        51050000
510600         MOVE '6111-WRITE-LIST-QUEUE'                             51060000
510700                                   TO DP013-PARAGRAPH             51070000
510800         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  51080000
510900                                   TO DP013-MESSAGE-TEXT(1)       51090000
511000         PERFORM DP013-0000-PROCESS-ABEND                         51100000
511100     END-IF.                                                      51110000
511200                                                                  51120000
511300/                                                                 51130000
511400*----------------------------------------------------------------*51140000
511500*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*51150000
511600*----------------------------------------------------------------*51160000
511700                                                                  51170000
511800 6112-READ-LIST-QUEUE.                                            51180000
511900                                                                  51190000
512000     EXEC CICS                                                    51200000
512100         READQ TS                                                 51210000
512200             QUEUE (ASC-LIST-QUEUE-NAME)                          51220000
512300             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     51230000
512400             ITEM  (PV-ITEM)                                      51240000
512500             RESP  (PV-CICS-RESP)                                 51250000
512600     END-EXEC.                                                    51260000
512700                                                                  51270000
512800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          51280000
512900         CONTINUE                                                 51290000
513000     ELSE                                                         51300000
513100         SET DP013-CICS-ABEND      TO TRUE                        51310000
513200         SET DP013-NO-ROLLBACK     TO TRUE                        51320000
513300         MOVE '6112-READ-LIST-QUEUE'                              51330000
513400                                   TO DP013-PARAGRAPH             51340000
513500         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    51350000
513600                                   TO DP013-MESSAGE-TEXT(1)       51360000
513700         PERFORM DP013-0000-PROCESS-ABEND                         51370000
513800     END-IF.                                                      51380000
513900                                                                  51390000
514000/                                                                 51400000
514100******************************************************************51410000
514200* DELETE THE LIST QUEUE WHEN PREV-SEL OR NEXT-SEL WAS ENTERED.   *51420000
514300******************************************************************51430000
514400 6200-DEL-LIST-QUEUE.                                             51440000
514500                                                                  51450000
514600     EXEC CICS                                                    51460000
514700         DELETEQ TS                                               51470000
514800             QUEUE (ASC-LIST-QUEUE-NAME)                          51480000
514900             RESP  (PV-CICS-RESP)                                 51490000
515000     END-EXEC.                                                    51500000
515100                                                                  51510000
515200     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      51520000
515300        (PV-CICS-RESP = DFHRESP(QIDERR)))                         51530000
515400         CONTINUE                                                 51540000
515500     ELSE                                                         51550000
515600        SET DP013-CICS-ABEND       TO TRUE                        51560000
515700        SET DP013-NO-ROLLBACK      TO TRUE                        51570000
515800        MOVE '6200-DEL-LIST-QUEUE' TO DP013-PARAGRAPH             51580000
515900        MOVE 'ERROR TRYING TO DELETE LIST TS QUEUE'               51590000
516000                                   TO DP013-MESSAGE-TEXT (1)      51600000
516100        PERFORM DP013-0000-PROCESS-ABEND                          51610000
516200     END-IF.                                                      51620000
516300                                                                  51630000
516400/                                                                 51640000
516500 7000-FORMAT-COMMAREA.                                            51650000
516600                                                                  51660000
516700     IF ASC-BLOCK-MODIFIED-SW(1) = 'Y'                            51670000
516800        MOVE 1                   TO PV-BLOCK-NUMBER               51680000
516900     ELSE                                                         51690000
517000        MOVE 2                   TO PV-BLOCK-NUMBER               51700000
517100     END-IF.                                                      51710000
517200                                                                  51720000
517300     MOVE ASC-OPR-ID             TO PC000-OPERATING-UNIT-ID       51730000
517400     MOVE ASC-FACT               TO PC000-FACILITY-ID             51740000
517500     MOVE ASC-PO-NBR             TO PC000-PO-NBR-N                51750000
517600     MOVE ASC-REC-SEQ-NBR        TO PC000-REC-SEQ-NBR-N           51760000
517700*    MOVE ASC-LINE-NUMBER        TO PC000-LINE-NBR-N              51770000
517800     MOVE PC-WORK-ORDER-DIST-SHEET                                51780000
517900                                 TO PC000-REPORT-ID.              51790000
518000                                                                  51800000
518100     PERFORM VARYING PV-SUB FROM 1 BY 1                           51810000
518200             UNTIL PV-SUB > PC-ITEMS-PER-PANEL                    51820000
518300         IF ASC-SELECTED-SW  (PV-BLOCK-NUMBER PV-SUB) = 'S'       51830000
518400            MOVE ASC-LINE-NUMBER       (PV-BLOCK-NUMBER PV-SUB)   51840000
518500                                 TO PC000-LINE-NBR-N              51850000
518600**-->       ** UPON THE 1ST HIT, END THE LOOP BY BUMPING UP PV-SUB51860000
518700            COMPUTE PV-SUB = PC-ITEMS-PER-PANEL + 1               51870000
518800         END-IF                                                   51880000
518900     END-PERFORM.                                                 51890000
519000                                                                  51900000
519100 8100-ARE-CARTONS-CHECKED-IN.                                     51910000
519200                                                                  51920000
519300     PERFORM 8200-ACTIVE-CARTONS-CHECKED-IN.                      51930000
519400     IF PS-CHECKED-IN-FOUND                                       51940000
519500          SET ASC-CHECKED-IN-YES                                  51950000
519600              (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE                51960000
519700     ELSE                                                         51970000
519800          SET ASC-CHECKED-IN-NO                                   51980000
519900              (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE                51990000
520000     END-IF.                                                      52000000
520100                                                                  52010000
520200******************************************************************52020000
520300* CHECK TSHUNLO FOR ACTIVE CARTONS CHECKED-IN                     52030000
520400******************************************************************52040000
520500 8200-ACTIVE-CARTONS-CHECKED-IN.                                  52050000
520600                                                                  52060000
520700     MOVE 0        TO PV-CARTON-COUNT.                            52070000
520800                                                                  52080000
520900     EXEC SQL                                                     52090000
521000          SELECT COUNT (*)                                        52100000
521100            INTO :PV-CARTON-COUNT                                 52110000
521200            FROM TINPKSU A                                        52120000
521300                ,TSHUNLO B                                        52130000
521400                ,TSULBXF C                                        52140000
521500                ,TPKSLIP D                                        52150000
521600                ,TSHUUPC E                                        52160000
521700            WHERE A.PO_NBR        = :DK-ORD-NBR                   52170000
521800              AND A.SEQ_NBR       = D.SEQ_NBR                     52180000
521900              AND A.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                52190000
522000              AND A.SHIPT_UNT_ID  = C.SHIPT_UNT_ID                52200000
522100              AND B.ACTV_CDE      = 'A'                           52210000
522200              AND B.SCN_LOC_ID    = 'RECV'                        52220000
522300              AND D.PO_NBR        = A.PO_NBR                      52230000
522400              AND D.REC_SEQ_NBR   = :DK-RCVR-SEQ-NBR              52240000
522500              AND D.VER_STAT_CDE  = 'A'                           52250000
522600              AND D.PKSL_STAT_CDE = 'AC'                          52260000
522700              AND A.SHIPT_UNT_ID  = E.SHIPT_UNT_ID                52270000
522800              AND A.PO_NBR        = E.TRN_NBR                     52280000
522900              AND E.TRN_LNE_NBR   = :DK-LINE-NBR                  52290000
523000            FETCH FIRST 1 ROW ONLY                                52300000
523100             WITH UR                                              52310000
523200     END-EXEC                                                     52320000
523300                                                                  52330000
523400     EVALUATE TRUE                                                52340000
523500         WHEN SQLCODE = ZERO                                      52350000
523600              IF PV-CARTON-COUNT > 0                              52360000
523700                  SET PS-CHECKED-IN-FOUND TO TRUE                 52370000
523800              END-IF                                              52380000
523900         WHEN SQLCODE = +100                                      52390000
524000              CONTINUE                                            52400000
524100         WHEN SQLWARN0 NOT = SPACES                               52410000
524200         WHEN SQLCODE  NOT = ZERO                                 52420000
524300              MOVE '8200-ACTIVE-CARTONS-CHECKED-IN'               52430000
524400                                 TO DP013-PARAGRAPH               52440000
524500              MOVE 'UNSUCCESSFUL CHECK ACTIVE CARTONS '           52450000
524600                                 TO DP013-MESSAGE-TEXT (1)        52460000
524700              MOVE DK-ORD-NBR    TO PV-DISP-PO-NBR                52470000
524800              MOVE DK-SEQ-NBR    TO PV-DISP-REC-SEQ-NBR           52480000
524900              STRING ' RCKCS255 - PO: '                           52490000
525000                     PV-DISP-PO-NBR                               52500000
525100                     ' SEQ NBR: '                                 52510000
525200                     PV-DISP-REC-SEQ-NBR                          52520000
525300                                      DELIMITED BY SIZE           52530000
525400                               INTO DP013-MESSAGE-TEXT (2)        52540000
525500              MOVE SQLCA TO DP013-SQLCA                           52550000
525600              MOVE 'TINPSKU '    TO DP013-DB2-TABLE-NAME (1)      52560000
525700              MOVE 'TSHUNLO '    TO DP013-DB2-TABLE-NAME (2)      52570000
525800              MOVE 'TSULBXF '    TO DP013-DB2-TABLE-NAME (3)      52580000
525900              SET DP013-DB2-ABEND                                 52590000
526000                  DP013-XCTL-DISPLAY-RESTART                      52600000
526100                                 TO TRUE                          52610000
526200                                                                  52620000
526300              PERFORM DP013-0000-PROCESS-ABEND                    52630000
526400     END-EVALUATE.                                                52640000
526500                                                                  52650000
526600/                                                                 52660000
526700******************************************************************52670000
526800* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *52680000
526900******************************************************************52690000
527000 9100-READ-SEL-QUEUE.                                             52700000
527100     EXEC CICS                                                    52710000
527200         READQ TS                                                 52720000
527300             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        52730000
527400             INTO  (PC016-TS-SEL-REC)                             52740000
527500             ITEM  (ASC-SEL-ITEM)                                 52750000
527600             RESP  (PV-CICS-RESP)                                 52760000
527700     END-EXEC.                                                    52770000
527800                                                                  52780000
527900     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        52790000
528000         CONTINUE                                                 52800000
528100     ELSE                                                         52810000
528200         SET DP013-LOGIC-ABEND                                    52820000
528300             DP013-NO-ROLLBACK     TO TRUE                        52830000
528400         MOVE '9100-READ-SEL-QUEUE'                               52840000
528500                                   TO DP013-PARAGRAPH             52850000
528600         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    52860000
528700                                   TO DP013-MESSAGE-TEXT (1)      52870000
528800         PERFORM DP013-0000-PROCESS-ABEND                         52880000
528900     END-IF.                                                      52890000
529000                                                                  52900000
529100/                                                                 52910000
529200******************************************************************52920000
529300* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *52930000
529400******************************************************************52940000
529500 9200-REWRITE-LIST-QUEUE.                                         52950000
529600     EXEC CICS                                                    52960000
529700          WRITEQ TS                                               52970000
529800              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     52980000
529900              FROM    (PC016-TS-SEL-REC)                          52990000
530000              ITEM    (ASC-SEL-ITEM)                              53000000
530100              RESP    (PV-CICS-RESP)                              53010000
530200              REWRITE                                             53020000
530300     END-EXEC.                                                    53030000
530400                                                                  53040000
530500     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    53050000
530600         SET DP013-CICS-ABEND                                     53060000
530700             DP013-NO-ROLLBACK     TO TRUE                        53070000
530800         MOVE '9200-REWRITE-LIST-QUEUE'                           53080000
530900                                   TO DP013-PARAGRAPH             53090000
531000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   53100000
531100                                   TO DP013-MESSAGE-TEXT (1)      53110000
531200         PERFORM DP013-0000-PROCESS-ABEND                         53120000
531300     END-IF.                                                      53130000
531400                                                                  53140000
531500/                                                                 53150000
531600******************************************************************53160000
531700* READ AN ITEM FROM THE INPUT SELECTED PACK SLIP ITEMS           *53170000
531800* TEMP STORAGE QUEUE.                                            *53180000
531900******************************************************************53190000
532000 9300-READ-PKSL-SEL-QUEUE.                                        53200000
532100                                                                  53210000
532200     EXEC CICS                                                    53220000
532300         READQ TS                                                 53230000
532400             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        53240000
532500             INTO  (RC013-DC-SELECT-RECORD)                       53250000
532600             ITEM  (ASC-SEL-ITEM)                                 53260000
532700             RESP  (PV-CICS-RESP)                                 53270000
532800     END-EXEC.                                                    53280000
532900                                                                  53290000
533000     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        53300000
533100         CONTINUE                                                 53310000
533200     ELSE                                                         53320000
533300         SET DP013-LOGIC-ABEND                                    53330000
533400             DP013-NO-ROLLBACK     TO TRUE                        53340000
533500         MOVE '9300-READ-PKSL-SEL-QUEUE'                          53350000
533600                                   TO DP013-PARAGRAPH             53360000
533700         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    53370000
533800                                   TO DP013-MESSAGE-TEXT (1)      53380000
533900         PERFORM DP013-0000-PROCESS-ABEND                         53390000
534000     END-IF.                                                      53400000
534100                                                                  53410000
534200/                                                                 53420000
534300******************************************************************53430000
534400* UPDATE AN ITEM IN THE INPUT SELECTED PACK SLIP ITEMS           *53440000
534500* TEMP STORAGE QUEUE.                                            *53450000
534600******************************************************************53460000
534700 9400-REWRITE-PKSL-LIST-QUEUE.                                    53470000
534800                                                                  53480000
534900     EXEC CICS                                                    53490000
535000          WRITEQ TS                                               53500000
535100              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     53510000
535200              FROM    (RC013-DC-SELECT-RECORD)                    53520000
535300              ITEM    (ASC-SEL-ITEM)                              53530000
535400              RESP    (PV-CICS-RESP)                              53540000
535500              REWRITE                                             53550000
535600     END-EXEC.                                                    53560000
535700                                                                  53570000
535800     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    53580000
535900         SET DP013-CICS-ABEND                                     53590000
536000             DP013-NO-ROLLBACK     TO TRUE                        53600000
536100         MOVE '9400-REWRITE-PKSL-LIST-QUEUE'                      53610000
536200                                   TO DP013-PARAGRAPH             53620000
536300         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   53630000
536400                                   TO DP013-MESSAGE-TEXT (1)      53640000
536500         PERFORM DP013-0000-PROCESS-ABEND                         53650000
536600     END-IF.                                                      53660000
536700                                                                  53670000
536800/                                                                 53680000
536900*----------------------------------------------------------------*53690000
537000*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *53700000
537100*    AND THE ERROR SWITCHES.                                     *53710000
537200*----------------------------------------------------------------*53720000
537300 9900-SOFT-ABORT.                                                 53730000
537400     SET PS-ERROR         TO TRUE.                                53740000
537500     SET DP020-MSG-FATAL  TO TRUE.                                53750000
537600     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    53760000
537700     SET  DP020-NEXT-ACT-APPL-ERROR TO TRUE.                      53770000
537800     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       53780000
537900     PERFORM 0001-CALL-CICS-ARCH-API.                             53790000
538000                                                                  53800000
538100*----------------------------------------------------------------*53810000
538200*    ABEND PROCESSOR MODULE                                      *53820000
538300*----------------------------------------------------------------*53830000
538400                                                                  53840000
538500     COPY DPPD013.                                                53850000
