000100 IDENTIFICATION DIVISION.                                         00010000
000200 TITLE 'SUMMARIZE THE TRAILER-BATCH'.                             00020000
000300 PROGRAM-ID.    SUKUT576.                                         00030000
000400 AUTHOR.        DENISE HAHN.                                      00040000
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050000
000600 DATE-WRITTEN.  DECEMBER 2019.                                    00060000
000700 DATE-COMPILED.                                                   00070000
000800******************************************************************00080000
000810*  THIS IS A COPY OF ONLINE PROGRAM - SUKCS574                   *00081000
000811*  THIS WILL BE USED TO SUMMARIZE DC OUTBOUND TRAILERS FOR THE   *00081100
000812*  STORES - HOURLY                                               *00081200
000813*                                                                *00081300
000814*  THIS PROGRAM WILL SUMMARIZE ALL OF THE ITEMS FOR A TRAILER    *00081401
000815*  AND INSERT THE INFORMATION INTO THE SUMMARY TABLES            *00081501
000816******************************************************************00081601
000817 ENVIRONMENT DIVISION.                                            00081701
000818 CONFIGURATION SECTION.                                           00081801
000819 SOURCE-COMPUTER. IBM-3090.                                       00081901
000820 OBJECT-COMPUTER. IBM-3090.                                       00082001
000830                                                                  00083001
000840 DATA DIVISION.                                                   00084001
000850                                                                  00085001
000860 WORKING-STORAGE SECTION.                                         00086001
000870                                                                  00087001
000880 01  DK-FIELDS.                                                   00088001
000890     05  DK-TRIP-OCRNC-ID                   PIC S9(09)  COMP.     00089001
000900     05  DK-OTBND-TRIP-ID                   PIC S9(09)  COMP.     00090001
001000                                                                  00100001
001100 01  PROGRAM-VARIABLES.                                           00110001
001200     05  PV-AD-EVNT-DTE                     PIC  X(10).           00120001
001300     05  PV-PREV-TRIP-OCRNC-ID              PIC S9(09)  COMP.     00130001
001400     05  PV-HANG-CDE-COUNT                  PIC S9(09)  COMP.     00140001
001500     05  PV-FOLD-CDE-COUNT                  PIC S9(09)  COMP.     00150001
001600     05  PV-NEW-IND-COUNT                   PIC S9(09)  COMP.     00160001
001700     05  PV-RETAIL                          PIC  9(08).           00170001
001800     05  PV-RETAIL-X REDEFINES PV-RETAIL    PIC X(08).            00180001
001900     05  PV-CICS-MSG-AREA                   PIC  X(80).           00190001
002000     05  PV-UNIT-QTY-SUM                    PIC S9(09) COMP.      00200001
002100     05  PV-COMMAREA-LENGTH                 PIC S9(04) VALUE +0   00210001
002200                                                       COMP SYNC. 00220001
002300     05  PV-RETAIL-SUM                      PIC S9(13)V99 COMP-3. 00230001
002400     05  PV-COST-SUM                        PIC S9(13)V99 COMP-3. 00240001
002500     05  PV-SKU-COUNT                       PIC S9(04) COMP.      00250001
002600     05  PV-UNT-QTY                         PIC S9(09) COMP.      00260001
002700     05  PV-RTL-DOL-AMT                     PIC S9(13)V9(2)       00270001
002800                                                       COMP-3.    00280001
002900     05  PV-COST-DOL-AMT                    PIC S9(13)V9(2)       00290001
003000                                                       COMP-3.    00300001
003100     05  PV-UNT-RTL-AMT                     PIC S9(07)V9(2)       00310001
003200                                                       COMP-3.    00320001
003300     05  PV-UNT-COST-AMT                    PIC S9(07)V9(3)       00330001
003400                                                       COMP-3.    00340001
003500     05  PV-CARTON-COUNT                    PIC S9(04) COMP.      00350001
003600     05  PV-RANDOM-NUMBER                   PIC  9(09)            00360001
003700                                                 VALUE ZEROES.    00370001
003800     05  PV-USERID                          PIC  X(08).           00380001
003900     05  PV-STARTCODE                       PIC  X(02).           00390001
004000     05  PV-CURRENT-TIMESTAMP               PIC  X(26).           00400001
004100     05  PV-PARAGRAPH-NAME                  PIC  X(30)            00410001
004200                                                 VALUE SPACES.    00420001
004300     05  PV-ITEM-NMBR                       PIC S9(09) COMP.      00430001
004400     05  PV-SHIPT-UNT-ID                    PIC  9(18).           00440001
004500     05  PV-SKU-NBR                         PIC  9(08).           00450001
004600     05  PV-FIELD-VALUE                     PIC -9(18).           00460001
004700     05  PV-FIELD-VALUE-1                   PIC -9(09).           00470001
004800     05  PV-FIELD-VALUE-2                   PIC -9(09).           00480001
004900     05  PV-CICS-RESP                       PIC S9(09) COMP       00490001
005000                                                 VALUE ZERO.      00500001
005100     05  PV-SAVE-BUS-AREA-ID                PIC S9(02)V COMP-3.   00510001
005200     05  PV-SAVE-DEPT-NBR                   PIC S9(04)V COMP-3.   00520001
005300     05  PV-SAVE-BRND-ID                    PIC S9(04)  COMP.     00530001
005400     05  PV-SAVE-UPC-NBR                    PIC S9(15)V COMP-3.   00540001
005500     05  PV-SAVE-SKU-NBR                    PIC S9(08)V COMP-3.   00550001
005600     05  PV-SAVE-TRN-NBR                    PIC S9(09) COMP.      00560001
005700     05  PV-SAVE-TRN-LNE-NBR                PIC S9(09) COMP.      00570001
005800                                                                  00580001
005900     05  PV-DISP-SQLCODE                    PIC -9(03).           00590001
006000     05  PV-DISP-DEST                       PIC  Z(04).           00600001
006100     05  PV-DISP-SCAN-CNT                   PIC  Z(09).           00610001
006200     05  PV-DISP-DVRT-CNT                   PIC  Z(09).           00620001
006300     05  PV-DISP-TOTAL-CNT                  PIC  Z(09).           00630001
006400     05  PV-DISP-TOTAL-UNT                  PIC  Z(09).           00640001
006500     05  PV-DISP-MISDIRCT                   PIC  Z(09).           00650001
006600     05  PV-DISP-NO-DATA                    PIC  Z(09).           00660001
006700     05  PV-DISP-SKU                        PIC  9(08).           00670001
006800     05  PV-DISP-UPC                        PIC  9(15).           00680001
006900     05  PV-DISP-OCRNC-ID                   PIC  9(09).           00690001
007000     05  PV-DISP-TRIP                       PIC  9(09).           00700001
007100     05  PV-DISP-UNT-QTY                    PIC  9(09).           00710001
007200     05  PV-DISP-SKU-QTY                    PIC  9(09).           00720001
007300     05  PV-DISP-OPER                       PIC  9(04).           00730001
007400     05  PV-DISP-BRAND                      PIC  9(05).           00740001
007500     05  PV-DISP-BUS-AREA                   PIC  9(02).           00750001
007600     05  PV-DISP-MAJ-CL                     PIC  9(04).           00760001
007700     05  PV-DISP-DEPT                       PIC  9(04).           00770001
007800     05  PV-DISP-SSCC                       PIC  9(18).           00780001
007900     05  PV-DISP-USR-ID                     PIC  X(08).           00790001
008000     05  PV-DISP-INTR-UPC-ID                PIC  9(09).           00800001
008100     05  PV-DISP-TRN-NBR                    PIC  9(09).           00810001
008200     05  PV-DISP-LINE-NBR                   PIC  9(09).           00820001
008300                                                                  00830001
008400 01  PV-ABEND-FIELDS.                                             00840001
008500     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         00850001
008600                                                 COMP SYNC.       00860001
008700     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'SUKUT576'.00870001
008800     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    00880001
008900     05  PV-DB2-OPERATION             PIC  X(30) VALUE SPACES.    00890001
009000     05  PV-DB2-MESSAGE-1             PIC  X(79) VALUE SPACES.    00900001
009100     05  PV-DB2-MESSAGE-2             PIC  X(79) VALUE SPACES.    00910001
009200     05  PV-DB2-MESSAGE-3             PIC  X(79) VALUE SPACES.    00920001
009300     05  PV-DB2-MESSAGE-4             PIC  X(79) VALUE SPACES.    00930001
009400     05  PV-ABEND-TABLE-1             PIC  X(30) VALUE SPACES.    00940001
009500     05  PV-ABEND-TABLE-2             PIC  X(30) VALUE SPACES.    00950001
009600     05  PV-ABEND-TABLE-3             PIC  X(30) VALUE SPACES.    00960001
009700     05  PV-ABEND-TABLE-4             PIC  X(30) VALUE SPACES.    00970001
009800     05  PV-ABEND-TABLE-5             PIC  X(30) VALUE SPACES.    00980001
009900                                                                  00990001
010000                                                                  01000001
010100 01  PC-PROGRAM-CONSTANTS.                                        01010001
010200     05  PC-RANDOM-PGM           PIC  X(08)  VALUE  'DPKUT902'.   01020001
010300     05  PC-MAX-RETRIES          PIC S9(04)  COMP SYNC VALUE +2.  01030001
010400     05  PC-DK-START-TMST        PIC  X(26)  VALUE                01040001
010500                                '0001-01-01-01.01.01.000001'.     01050001
010600     05  PC-HANG                 PIC  X(20)  VALUE                01060001
010700         'HANG                '.                                  01070001
010800     05  PC-FOLD                 PIC  X(20)  VALUE                01080001
010900         'FOLD                '.                                  01090001
011000     05  PC-RF                   PIC  X(02)  VALUE  'RF'.         01100001
011100     05  PC-B                    PIC  X(01)  VALUE  'B'.          01110001
011200     05  PC-F                    PIC  X(01)  VALUE  'F'.          01120001
011300     05  PC-H                    PIC  X(01)  VALUE  'H'.          01130001
011400                                                                  01140001
011500 01  ABEND-CODE                  PIC S9(04)  VALUE +0             01150001
011600                                             COMP SYNC.           01160001
011700 01  PROGRAM-SWITCHES.                                            01170001
011800     05  PS-EXISTS                    PIC S9 COMP-3 VALUE ZERO.   01180001
011900         88  PS-ROW-EXISTS-YES                      VALUE 1.      01190001
012000         88  PS-ROW-EXISTS-NO                       VALUE ZERO.   01200001
012100     05  PS-TRIP-USED-SW                    PIC X(01).            01210001
012200         88  PS-TRIP-ALREADY-USED                     VALUE 'Y'.  01220001
012300         88  PS-TRIP-NOT-USED                         VALUE 'N'.  01230001
012400     05  PS-INSERT-DONE-SW                  PIC X(01).            01240001
012500         88  PS-NO-INSERT-DONE                        VALUE 'N'.  01250001
012600         88  PS-INSERT-DONE                           VALUE 'Y'.  01260001
012700     05  PS-DEPT-FOUND-SW                   PIC X(01).            01270001
012800         88  PS-DEPT-NOT-FOUND                        VALUE 'N'.  01280001
012900         88  PS-DEPT-FOUND                            VALUE 'Y'.  01290001
013000     05  PS-CARTON-INFO-SW                  PIC X(01).            01300001
013100         88  PS-NO-CARTON-INFO                        VALUE 'N'.  01310001
013200         88  PS-CARTON-INFO                           VALUE 'Y'.  01320001
013300     05  PS-EOF-DATE-CSR-SW                 PIC X(01).            01330001
013400         88  PS-NOT-EOF-DATE-CSR                      VALUE 'N'.  01340001
013500         88  PS-EOF-DATE-CSR                          VALUE 'Y'.  01350001
013600     05  PS-EOF-SKU-CURSOR-SW               PIC X(01).            01360001
013700         88  PS-NOT-EOF-SKU-CURSOR                    VALUE 'N'.  01370001
013800         88  PS-EOF-SKU-CURSOR                        VALUE 'Y'.  01380001
013900     05  PS-EOF-UNT-DOL-CLASS-CSR-SW        PIC X(01).            01390001
014000         88  PS-NOT-EOF-UNT-DOL-CLASS-CSR             VALUE 'N'.  01400001
014100         88  PS-EOF-UNT-DOL-CLASS-CSR                 VALUE 'Y'.  01410001
014200     05  PS-EOF-UNT-DOL-MDSE-CSR-SW         PIC X(01).            01420001
014300         88  PS-NOT-EOF-UNT-DOL-MDSE-CSR              VALUE 'N'.  01430001
014400         88  PS-EOF-UNT-DOL-MDSE-CSR                  VALUE 'Y'.  01440001
014500     05  PS-NOT-EOF-ITEM-DET-CSR-SW         PIC X(01).            01450001
014600         88  PS-NOT-EOF-ITEM-DET-CSR                  VALUE 'N'.  01460001
014700         88  PS-EOF-ITEM-DET-CSR                      VALUE 'Y'.  01470001
014800     05  PS-FIRST-TIME-THRU-CSR-SW          PIC X(01).            01480001
014900         88  PS-NOT-FIRST-TIME-THRU-CSR               VALUE 'N'.  01490001
015000         88  PS-FIRST-TIME-THRU-CSR                   VALUE 'Y'.  01500001
015100     05  PS-UPC-FOUND-SW                    PIC X(01).            01510001
015200         88  PS-NOT-UPC-FOUND                         VALUE 'N'.  01520001
015300         88  PS-UPC-FOUND                             VALUE 'Y'.  01530001
015400     05  PS-DISPLAY-PARA-SW                 PIC X(01) VALUE 'N'.  01540001
015500         88  PS-DISPLAY-PARA-NO                       VALUE 'N'.  01550001
015600         88  PS-DISPLAY-PARA-YES                      VALUE 'Y'.  01560001
015700                                                                  01570001
015800******************************************************************01580001
015900* PCWS049 - WORK FIELDS USED TO DETERMINE TRAILER CONTENTS        01590001
016000******************************************************************01600001
016100     COPY PCWS049.                                                01610001
016200                                                                  01620001
016300******************************************************************01630001
016400*  INPUT LAYOUT TO PASS THE TRAILER TRIP ID                       01640001
016500*  AND RETURN THE COUNT OF CARTONS ON THE TRAILER                 01650001
016600******************************************************************01660001
016700     COPY PCWS047.                                                01670001
016800                                                                  01680001
016900*-----------------------------------------------------------------01690001
017000*  DB2 FORMATTED MESSAGE AREA                                     01700001
017100*-----------------------------------------------------------------01710001
017200     COPY DPWS004.                                                01720001
017300                                                                  01730001
017400*----------------------------------------------------------------*01740001
017500*  RANDOM NUMBER AREA                                             01750001
017600*----------------------------------------------------------------*01760001
017700     COPY DPWS902.                                                01770001
017800                                                                  01780001
017900******************************************************************01790001
018000* TKRPRPM            PARM TABLE                                   01800001
018100******************************************************************01810001
018200     EXEC SQL                                                     01820001
018300          INCLUDE TKRPRPM                                         01830001
018400     END-EXEC.                                                    01840001
018500                                                                  01850001
019300******************************************************************01930001
019400* SUT_OTBND_LOC - OUTBOUND SHIPPING UNIT LOCATION TABLE           01940001
019500******************************************************************01950001
019600     EXEC SQL                                                     01960001
019700          INCLUDE SUT00027                                        01970001
019800     END-EXEC.                                                    01980001
019900                                                                  01990001
020000******************************************************************02000001
020100* SUT_OTBND_CARTON - OTBND SHIPPING UNIT CARTON TABLE             02010001
020200******************************************************************02020001
020300     EXEC SQL                                                     02030001
020400          INCLUDE SUT00024                                        02040001
020500     END-EXEC.                                                    02050001
020600                                                                  02060001
020700******************************************************************02070001
020800* SUT_TRIP_DTL_SUM - TRIP DETAIL SUMMARY TABLE                    02080001
020900******************************************************************02090001
021000     EXEC SQL                                                     02100001
021100          INCLUDE SUT00095                                        02110001
021200     END-EXEC.                                                    02120001
021300                                                                  02130001
021400******************************************************************02140001
021500* SUT_BRND_MDSE_SUM - BRND MERCHANDISE SUM TABLE                  02150001
021600******************************************************************02160001
021700     EXEC SQL                                                     02170001
021800          INCLUDE SUT00066                                        02180001
021900     END-EXEC.                                                    02190001
022000                                                                  02200001
022100******************************************************************02210001
022200* SUT_PRC_MSG_CDE  - PRC MESSAGE CODE TABLE                       02220001
022300******************************************************************02230001
022400     EXEC SQL                                                     02240001
022500          INCLUDE SUT00094                                        02250001
022600     END-EXEC.                                                    02260001
022700                                                                  02270001
022800******************************************************************02280001
022900* TSUCDOT - CARTON DIVERT/OUTBOUND TRIP ASSOCIATION TABLE         02290001
023000******************************************************************02300001
023100     EXEC SQL                                                     02310001
023200          INCLUDE TSUCDOT                                         02320001
023300     END-EXEC.                                                    02330001
023400                                                                  02340001
023500******************************************************************02350001
023600* TSUOBTR - OUTBOUND TRAILER TRIP TABLE                           02360001
023700******************************************************************02370001
023800     EXEC SQL                                                     02380001
023900          INCLUDE TSUOBTR                                         02390001
024000     END-EXEC.                                                    02400001
024100                                                                  02410001
024200******************************************************************02420001
024300* TSUOBTR - OUTBOUND TRAILER TRIP STATUS TABLE                    02430001
024400******************************************************************02440001
024500     EXEC SQL                                                     02450001
024600          INCLUDE TSUOBTS                                         02460001
024700     END-EXEC.                                                    02470001
024800                                                                  02480001
024900******************************************************************02490001
025000* TSUOBSC - OUTBOUND TRAILER TRIP STATUS CODE TABLE               02500001
025100******************************************************************02510001
025200     EXEC SQL                                                     02520001
025300          INCLUDE TSUOBSC                                         02530001
025400     END-EXEC.                                                    02540001
025500                                                                  02550001
025600******************************************************************02560001
025700* TSUCRDV - CARTON DIVERTS FROM CONVEYOR SYSTEM TABLE             02570001
025800******************************************************************02580001
025900     EXEC SQL                                                     02590001
026000          INCLUDE TSUCRDV                                         02600001
026100     END-EXEC.                                                    02610001
026200                                                                  02620001
026300******************************************************************02630001
026400* TCNDCDR - DISTRIBUTION CENTER DOOR TABLE                        02640001
026500******************************************************************02650001
026600     EXEC SQL                                                     02660001
026700          INCLUDE TCNDCDR                                         02670001
026800     END-EXEC.                                                    02680001
026900                                                                  02690001
027000******************************************************************02700001
027100* TCNDRST - DISTRIBUTION CENTER DOOR TO STORE ASSOCIATION TABLE   02710001
027200******************************************************************02720001
027300     EXEC SQL                                                     02730001
027400          INCLUDE TCNDRST                                         02740001
027500     END-EXEC.                                                    02750001
027600                                                                  02760001
027700******************************************************************02770001
027800* TPURITM - PURCHASE ORDER ITEM                                   02780001
027900******************************************************************02790001
028000     EXEC SQL                                                     02800001
028100          INCLUDE TPURITM                                         02810001
028101     END-EXEC.                                                    02810101
028102                                                                  02810201
028103******************************************************************02810301
028104* XLT_BUS_GP                                                      02810401
028105******************************************************************02810501
028106     EXEC SQL                                                     02810601
028107          INCLUDE XLT00001                                        02810701
028108     END-EXEC.                                                    02810801
028109                                                                  02810901
028110******************************************************************02811001
028120* XLT_DEPT                                                        02812001
028130******************************************************************02813001
028140     EXEC SQL                                                     02814001
028150          INCLUDE XLT00002                                        02815001
028160     END-EXEC.                                                    02816001
028170                                                                  02817001
028180******************************************************************02818001
028190* XLT_SKU                                                         02819001
028200******************************************************************02820001
028300     EXEC SQL                                                     02830001
028400          INCLUDE XLT00003                                        02840001
028500     END-EXEC.                                                    02850001
028600                                                                  02860001
028700******************************************************************02870001
028800* XLT_VND_STYL                                                    02880001
028900******************************************************************02890001
029000     EXEC SQL                                                     02900001
029100          INCLUDE XLT00004                                        02910001
029200     END-EXEC.                                                    02920001
029300                                                                  02930001
029400******************************************************************02940001
029500* XLT_UPC                                                         02950001
029600******************************************************************02960001
029700     EXEC SQL                                                     02970001
029800          INCLUDE XLT00006                                        02980001
029900     END-EXEC.                                                    02990001
030000                                                                  03000001
030100******************************************************************03010001
030200* XLV_SKU_STR                                                     03020001
030300******************************************************************03030001
030400     EXEC SQL                                                     03040001
030500          INCLUDE XLV00002                                        03050001
030600     END-EXEC.                                                    03060001
030700                                                                  03070001
030800******************************************************************03080001
030900* SUT_OTBND_UPC                                                   03090001
031000******************************************************************03100001
031100     EXEC SQL                                                     03110001
031200          INCLUDE SUT00028                                        03120001
031300     END-EXEC.                                                    03130001
031400                                                                  03140001
031500******************************************************************03150001
031600* SUT_TRIP_WKRK_AUD                                               03160001
031700******************************************************************03170001
031800     EXEC SQL                                                     03180001
031900          INCLUDE SUT00006                                        03190001
032000     END-EXEC.                                                    03200001
032100                                                                  03210001
032200******************************************************************03220001
032300* SUT_TRIP_SUM                                                    03230001
032400******************************************************************03240001
032500     EXEC SQL                                                     03250001
032600          INCLUDE SUT00007                                        03260001
032700     END-EXEC.                                                    03270001
032800                                                                  03280001
032900******************************************************************03290001
033000* SUT_BUS_AREA_SUM                                                03300001
033100******************************************************************03310001
033200     EXEC SQL                                                     03320000
033300          INCLUDE SUT00008                                        03330000
033400     END-EXEC.                                                    03340000
033500                                                                  03350000
033510******************************************************************03351000
033520* SUT_DEPT_SUM                                                    03352001
033530******************************************************************03353001
033540     EXEC SQL                                                     03354001
033550          INCLUDE SUT00009                                        03355001
033560     END-EXEC.                                                    03356001
033570                                                                  03357001
033580******************************************************************03358001
033590* SUT_MAJ_CL_SUM                                                  03359001
033600******************************************************************03360001
033700     EXEC SQL                                                     03370001
033800          INCLUDE SUT00010                                        03380001
033900     END-EXEC.                                                    03390001
034000                                                                  03400001
034100******************************************************************03410001
034200* SUT_MAJ_CL_AD_DTE                                               03420001
034300******************************************************************03430001
034400     EXEC SQL                                                     03440001
034500          INCLUDE SUT00011                                        03450001
034600     END-EXEC.                                                    03460001
034700                                                                  03470001
034800******************************************************************03480001
034900* CENTRAL STOCK - PULL LINE ITEM TABLE                            03490001
035000******************************************************************03500001
035100     EXEC SQL                                                     03510001
035200          INCLUDE TCEPLIT                                         03520001
035300     END-EXEC.                                                    03530001
035400                                                                  03540001
035500******************************************************************03550001
035510*                                                                *03551001
035520******************************************************************03552001
035530     EXEC SQL                                                     03553001
035540          INCLUDE SQLCA                                           03554001
035550     END-EXEC.                                                    03555001
035560                                                                  03556001
035570******************************************************************03557001
035580* PCWS050 - CURSOR USED TO DETERMINE TRAILER CONTENTS             03558001
035590******************************************************************03559001
035600     COPY PCWS050.                                                03560001
035700                                                                  03570001
035800     EXEC SQL                                                     03580001
035900         DECLARE AD-DATE-CSR CURSOR FOR                           03590001
036000          SELECT DISTINCT                                         03600001
036100                 BUS_AREA_ID                                      03610001
036200               , DEPT_NBR                                         03620001
036300               , MAJ_CL_NBR                                       03630001
036400               , AD_DTE                                           03640001
036500           FROM SUT_TRIP_DTL_SUM                                  03650001
036600          WHERE TRIP_OCRNC_ID  = :DK-TRIP-OCRNC-ID                03660001
036700            AND  AD_DTE       <> '0001-01-01'                     03670001
036800        WITH UR                                                   03680001
036900     END-EXEC.                                                    03690001
037000                                                                  03700001
037100     EXEC SQL                                                     03710001
037200         DECLARE UNT-DOL-CLASS-CSR CURSOR FOR                     03720001
037300         SELECT                                                   03730001
037400                BUS_AREA_ID                                       03740001
037500              , DEPT_NBR                                          03750001
037600              , MAJ_CL_NBR                                        03760001
037700              , SUM(UNT_QTY)                                      03770001
037800              , SUM(RTL_DOL_AMT)                                  03780001
037900              , SUM(COST_DOL_AMT)                                 03790001
038000           FROM SUT_TRIP_DTL_SUM                                  03800001
038100          WHERE TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                 03810001
038200          GROUP BY                                                03820001
038300                BUS_AREA_ID                                       03830001
038400              , DEPT_NBR                                          03840001
038500              , MAJ_CL_NBR                                        03850001
038600          ORDER BY                                                03860001
038700                BUS_AREA_ID                                       03870001
038800              , DEPT_NBR                                          03880001
038900              , MAJ_CL_NBR                                        03890001
039000        WITH UR                                                   03900001
039100     END-EXEC.                                                    03910001
039200                                                                  03920001
039300     EXEC SQL                                                     03930001
039400         DECLARE UNT-DOL-BRND-CSR CURSOR FOR                      03940001
039500         SELECT                                                   03950001
039600                BUS_AREA_ID                                       03960001
039700              , BRND_ID                                           03970001
039800              , SUM(UNT_QTY)                                      03980001
039900              , SUM(RTL_DOL_AMT)                                  03990001
040000              , SUM(COST_DOL_AMT)                                 04000001
040100           FROM SUT_TRIP_DTL_SUM                                  04010001
040200          WHERE TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                 04020001
040300          GROUP BY                                                04030001
040400                BUS_AREA_ID                                       04040001
040500              , BRND_ID                                           04050001
040600          ORDER BY                                                04060001
040700                BUS_AREA_ID                                       04070001
040800              , BRND_ID                                           04080001
040900        WITH UR                                                   04090001
041000     END-EXEC.                                                    04100001
041100                                                                  04110001
041200 LINKAGE SECTION.                                                 04120001
041300 01  LINK-COMMAREA         PIC X(456).                            04130001
041400                                                                  04140001
041500 PROCEDURE DIVISION USING LINK-COMMAREA.                          04150001
041600                                                                  04160001
041700 0000-PROGRAM-MAINLINE.                                           04170001
041800                                                                  04180001
041900     SET  PS-ROW-EXISTS-NO                                        04190001
042000          PS-DISPLAY-PARA-NO   TO  TRUE.                          04200001
042100                                                                  04210001
042200     MOVE SPACES               TO  PS-TRIP-USED-SW                04220001
042300                                   PS-INSERT-DONE-SW              04230001
042400                                   PS-DEPT-FOUND-SW               04240001
042500                                   PS-CARTON-INFO-SW              04250001
042600                                   PS-EOF-DATE-CSR-SW             04260001
042700                                   PS-EOF-SKU-CURSOR-SW           04270001
042800                                   PS-EOF-UNT-DOL-CLASS-CSR-SW    04280001
042900                                   PS-EOF-UNT-DOL-MDSE-CSR-SW     04290001
043000                                   PS-NOT-EOF-ITEM-DET-CSR-SW     04300001
043010                                   PS-FIRST-TIME-THRU-CSR-SW      04301001
043020                                   PS-UPC-FOUND-SW.               04302001
043030                                                                  04303001
043040     MOVE ZEROES               TO  DK-TRIP-OCRNC-ID               04304001
043041                                   DK-OTBND-TRIP-ID               04304101
043042                                   PV-PREV-TRIP-OCRNC-ID          04304201
043043                                   PV-HANG-CDE-COUNT              04304301
043044                                   PV-FOLD-CDE-COUNT              04304401
043045                                   PV-NEW-IND-COUNT               04304501
043046                                   PV-RETAIL                      04304601
043047                                   PV-UNIT-QTY-SUM                04304701
043048                                   PV-COMMAREA-LENGTH             04304801
043049                                   PV-RETAIL-SUM                  04304901
043050                                   PV-COST-SUM                    04305001
043051                                   PV-SKU-COUNT                   04305101
043052                                   PV-UNT-QTY                     04305201
043053                                   PV-RTL-DOL-AMT                 04305301
043054                                   PV-COST-DOL-AMT                04305401
043055                                   PV-UNT-RTL-AMT                 04305501
043056                                   PV-UNT-COST-AMT                04305601
043057                                   PV-CARTON-COUNT                04305701
043058                                   PV-RANDOM-NUMBER               04305801
043059                                   PV-ITEM-NMBR                   04305901
043060                                   PV-SHIPT-UNT-ID                04306001
043061                                   PV-SKU-NBR                     04306101
043062                                   PV-FIELD-VALUE                 04306201
043063                                   PV-FIELD-VALUE-1               04306301
043064                                   PV-FIELD-VALUE-2               04306401
043065                                   PV-CICS-RESP                   04306501
043066                                   PV-SAVE-BUS-AREA-ID            04306601
043067                                   PV-SAVE-DEPT-NBR               04306701
043068                                   PV-SAVE-BRND-ID                04306801
043069                                   PV-SAVE-UPC-NBR                04306901
043070                                   PV-SAVE-SKU-NBR                04307001
043071                                   PV-SAVE-TRN-NBR                04307101
043072                                   PV-SAVE-TRN-LNE-NBR            04307201
043073                                   PV-DISP-SQLCODE                04307301
043074                                   PV-DISP-DEST                   04307401
043075                                   PV-DISP-SCAN-CNT               04307501
043076                                   PV-DISP-DVRT-CNT               04307601
043077                                   PV-DISP-TOTAL-CNT              04307701
043078                                   PV-DISP-MISDIRCT               04307801
043079                                   PV-DISP-NO-DATA                04307901
043080                                   PV-DISP-SKU                    04308001
043081                                   PV-DISP-UPC                    04308101
043082                                   PV-DISP-OCRNC-ID               04308201
043083                                   PV-DISP-TRIP                   04308301
043084                                   PV-DISP-UNT-QTY                04308401
043085                                   PV-DISP-SKU-QTY                04308501
043086                                   PV-DISP-OPER                   04308601
043087                                   PV-DISP-BRAND                  04308701
043088                                   PV-DISP-BUS-AREA               04308801
043089                                   PV-DISP-MAJ-CL                 04308901
043090                                   PV-DISP-DEPT                   04309001
043091                                   PV-DISP-SSCC                   04309101
043092                                   PV-DISP-INTR-UPC-ID            04309201
043093                                   PV-DISP-TRN-NBR                04309301
043094                                   PV-DISP-LINE-NBR.              04309401
043095                                                                  04309501
043096     MOVE SPACES               TO  PV-AD-EVNT-DTE                 04309601
043097                                   PV-CICS-MSG-AREA               04309701
043098                                   PV-USERID                      04309801
043099                                   PV-STARTCODE                   04309901
043100                                   PV-CURRENT-TIMESTAMP           04310001
043101                                   PV-PARAGRAPH-NAME              04310101
043102                                   PV-DISP-USR-ID.                04310201
043103                                                                  04310301
043104     MOVE  LINK-COMMAREA        TO  PC047-COMMAREA.               04310401
043105                                                                  04310501
043106     SET  PC047-SUCCESSFUL      TO  TRUE.                         04310601
043107                                                                  04310701
043108     MOVE  PC047-OTBND-TRIP-ID    TO  PV-DISP-TRIP.               04310801
043109     MOVE  PC047-DEST-OPER-UNT-ID TO  PV-DISP-DEST.               04310901
043110     MOVE  PC047-OPER-UNT-ID      TO  PV-DISP-OPER.               04311001
043120                                                                  04312001
043121     DISPLAY ' SUKUT576-TRAILER SUMMARY   '                       04312101
043122             ' CALLED BY: ' PC047-CALLING-PROGRAM                 04312201
043123             '  OPER:'  PV-DISP-OPER                              04312301
043124             '  TRIP:'  PV-DISP-TRIP                              04312401
043125             '  DEST:'  PV-DISP-DEST                              04312501
043126             '  DOOR:'  PC047-DOOR-TYPE-CDE                       04312601
043127             '-'        PC047-DOOR-ID                             04312701
043128             '  FUNC:'  PC047-FUNCTION.                           04312801
043129                                                                  04312901
043130     PERFORM 0050-CHECK-DISPLAY.                                  04313001
043140                                                                  04314001
043150     PERFORM 1000-INITIALIZE.                                     04315000
043160                                                                  04316001
043170     PERFORM 2000-PROCESS-TRIP-CARTONS.                           04317001
043180                                                                  04318001
043190     PERFORM 4000-PROCESS-TEMP-TABLE.                             04319001
043200                                                                  04320001
043300     PERFORM 9000-FINIS.                                          04330001
043400                                                                  04340001
043500                                                                  04350001
043600******************************************************************04360001
043700*                                                                 04370001
043800******************************************************************04380001
043810 0050-CHECK-DISPLAY.                                              04381001
043820                                                                  04382001
043821     EXEC SQL                                                     04382101
043822         SELECT FUNC_TXT                                          04382201
043823           INTO :PS-DISPLAY-PARA-SW                               04382301
043824           FROM TKRPRPM                                           04382401
043825          WHERE LOC_ID              =  90                         04382501
043826            AND INTFC_SYS_CDE       = 'KHL'                       04382601
043827            AND SYS_PRC_FUNC_CDE    = 'TRLDSP'                    04382701
043828            AND FUNC_PRC_STAT_CDE   = 'AC'                        04382801
043829            AND FUNC_BEG_TMST      <=  CURRENT TIMESTAMP          04382901
043830            AND FUNC_END_TMST      >=  CURRENT TIMESTAMP          04383001
043831           WITH UR                                                04383101
043832     END-EXEC.                                                    04383201
043833                                                                  04383301
043834     EVALUATE TRUE                                                04383401
043835         WHEN SQLCODE = ZERO                                      04383501
043836              CONTINUE                                            04383601
043837                                                                  04383701
043838         WHEN SQLCODE = +100                                      04383801
043839              SET  PS-DISPLAY-PARA-NO   TO  TRUE                  04383901
043840                                                                  04384001
043841         WHEN SQLWARN0 NOT = SPACE                                04384101
043842         WHEN SQLCODE  NOT = +0                                   04384201
043843                                                                  04384301
043844              MOVE SQLCODE                TO PV-DISP-SQLCODE      04384401
043845                                                                  04384501
043846              MOVE '0050-CHECK-DISPLAY' TO PV-ABEND-PARAGRAPH     04384601
043847              MOVE 'READ TKRPRPM '     TO PV-DB2-OPERATION        04384701
043848              MOVE 'TRLSUM'            TO PV-DB2-MESSAGE-1        04384801
043849              MOVE ' '                 TO PV-DB2-MESSAGE-2        04384901
043850              MOVE ' '                 TO PV-DB2-MESSAGE-3        04385001
043851              MOVE ' '                 TO PV-DB2-MESSAGE-4        04385101
043852              MOVE 'TKRPRPM         '  TO PV-ABEND-TABLE-1        04385201
043853              MOVE ' '                 TO PV-ABEND-TABLE-2        04385301
043854              MOVE ' '                 TO PV-ABEND-TABLE-3        04385401
043855              MOVE ' '                 TO PV-ABEND-TABLE-4        04385501
043856              MOVE ' '                 TO PV-ABEND-TABLE-5        04385601
043857                                                                  04385701
043858              PERFORM 9900-DB2-ERROR                              04385801
043859     END-EVALUATE.                                                04385901
043860                                                                  04386001
043861     IF  PS-DISPLAY-PARA-YES                                      04386101
043862         DISPLAY ' SUKUT576 - 0050-CHECK-DISPLAY            '     04386201
043863     END-IF.                                                      04386301
043864                                                                  04386401
043865                                                                  04386501
043866******************************************************************04386601
043867*                                                                 04386701
043868******************************************************************04386801
043869 1000-INITIALIZE.                                                 04386901
043870                                                                  04387001
043880     IF  PS-DISPLAY-PARA-YES                                      04388001
043890         DISPLAY ' SUKUT576 - 1000-INITIALIZE      '              04389001
043900     END-IF.                                                      04390001
044000                                                                  04400001
044100     PERFORM 7990-INSERT-WRKR-AUD.                                04410001
044200                                                                  04420001
044300     PERFORM 8900-SELECT-CURRENT-DATE.                            04430001
044400                                                                  04440001
044500     MOVE PC047-OPER-UNT-ID           TO PC049-DK-OPER-UNT-ID.    04450001
044600     MOVE PC047-DOOR-ID               TO PC049-DK-DOOR-ID.        04460001
044700     MOVE PC047-DEST-OPER-UNT-ID      TO PC049-DK-TRLR-DEST.      04470001
044800     MOVE PC047-DOOR-TYPE-CDE         TO PC049-DK-TRLR-TYPE.      04480001
044900                                                                  04490001
045000     PERFORM P3000-DOOR-STR-CSR.                                  04500001
045100                                                                  04510001
045200     MOVE PC047-OTBND-TRIP-ID         TO PC049-DK-OTBND-TRIP-ID   04520001
045300                                         DK-OTBND-TRIP-ID.        04530001
045400     PERFORM P4000-STRT-END-DVRT.                                 04540001
045500                                                                  04550001
045600     IF PC049-DIVERT-CUTOFFS-NO                                   04560001
045700         MOVE PC-DK-START-TMST       TO PC049-DK-START-TMST       04570001
045800         MOVE PC049-PC-DEFAULT-TMST  TO PC049-DK-END-TMST         04580001
045900     END-IF.                                                      04590001
046000                                                                  04600001
046100                                                                  04610001
046200******************************************************************04620001
046300*                                                                 04630001
046400******************************************************************04640001
046500 2000-PROCESS-TRIP-CARTONS.                                       04650001
046600                                                                  04660001
046700     IF  PS-DISPLAY-PARA-YES                                      04670001
046800         DISPLAY ' SUKUT576 - 2000-PROCESS-TRIP-CARTONS'          04680001
046900     END-IF.                                                      04690001
047000                                                                  04700001
047100     MOVE 0    TO  PV-SAVE-UPC-NBR                                04710001
047200                   PV-SAVE-TRN-NBR                                04720001
047300                   PV-SAVE-TRN-LNE-NBR                            04730001
047400                   PV-SAVE-SKU-NBR.                               04740001
047500     PERFORM 5000-CREATE-TRIP-OCCURENCE-ID.                       04750001
047600     MOVE DK-TRIP-OCRNC-ID       TO SUT00007-TRIP-OCRNC-ID.       04760001
047700     MOVE DK-OTBND-TRIP-ID       TO SUT00007-OTBND-TRIP-ID.       04770001
047800     MOVE 0                      TO SUT00007-UNT-QTY              04780001
047900                                    SUT00007-SKU-QTY              04790001
048000                                    SUT00007-CART-QTY             04800001
048100                                    SUT00007-RTL-DOL-AMT          04810001
048200                                    SUT00007-COST-DOL-AMT.        04820001
048300     PERFORM 8860-INSERT-SUT00007                                 04830001
048400             UNTIL PS-INSERT-DONE.                                04840001
048500                                                                  04850001
048600     SET PC049-NOT-EOF-SHP-ACTV-CRT-UPC                           04860001
048700         PC049-NOT-EOF-SHL-ACTV-CRT-UPC                           04870001
048800         PS-DEPT-NOT-FOUND    TO TRUE.                            04880001
048900                                                                  04890001
049000     IF  PC049-DK-SHIPPING-TRLR                                   04900001
049100         PERFORM P7360-OPEN-SHP-ACV-CR-UPC-CSR                    04910001
049200         PERFORM 2100-FETCH-TRIP-CARTONS                          04920001
049300            UNTIL PC049-EOF-SHP-ACTV-CRTN-UPC                     04930001
049400         PERFORM P7380-CLOSE-SHP-ACV-CR-UPC-CSR                   04940001
049500     ELSE                                                         04950001
049600         PERFORM P7390-OPEN-SHL-ACV-CR-UPC-CSR                    04960001
049700         PERFORM 2100-FETCH-TRIP-CARTONS                          04970001
049800            UNTIL PC049-EOF-SHL-ACTV-CRTN-UPC                     04980001
049900         PERFORM P7410-CLOSE-SHL-ACV-CR-UPC-CSR                   04990001
050000     END-IF.                                                      05000001
050100                                                                  05010001
050200                                                                  05020001
050300******************************************************************05030001
050400*                                                                 05040001
050500******************************************************************05050001
050600 2100-FETCH-TRIP-CARTONS.                                         05060001
050700                                                                  05070001
050800     IF  PS-DISPLAY-PARA-YES                                      05080001
050900         DISPLAY ' SUKUT576 - 2100-FETCH-TRIP-CARTONS  '          05090001
051000     END-IF.                                                      05100001
051100                                                                  05110001
051200     IF  PC049-DK-SHIPPING-TRLR                                   05120001
051300         PERFORM P7370-FETCH-SHP-ACV-CR-UPC-CSR                   05130001
051400         IF  PC049-NOT-EOF-SHP-ACTV-CRT-UPC                       05140001
051500             PERFORM 3000-DET-CARTON-CHARACTERISTCS               05150001
051600         END-IF                                                   05160001
051700     ELSE                                                         05170001
051800         PERFORM P7400-FETCH-SHL-ACV-CR-UPC-CSR                   05180001
051900         IF  PC049-NOT-EOF-SHL-ACTV-CRT-UPC                       05190001
052000             PERFORM 3000-DET-CARTON-CHARACTERISTCS               05200001
052100         END-IF                                                   05210001
052200     END-IF.                                                      05220001
052300                                                                  05230001
052400                                                                  05240001
052500******************************************************************05250001
052600*                                                                 05260001
052700******************************************************************05270001
052800 3000-DET-CARTON-CHARACTERISTCS.                                  05280001
052900                                                                  05290001
053000     IF  PS-DISPLAY-PARA-YES                                      05300001
053100         DISPLAY ' SUKUT576 - 3000-DET-CARTON-CHARACTERISTCS'     05310001
053200     END-IF.                                                      05320001
053300                                                                  05330001
053400     SET PS-NO-CARTON-INFO       TO TRUE.                         05340001
053500     PERFORM 7000-SELECT-CARTON-INFO.                             05350001
053600     PERFORM 3100-PROCESS-ITEMS.                                  05360001
053700                                                                  05370001
053800                                                                  05380001
053900******************************************************************05390001
054000*                                                                 05400001
054100******************************************************************05410001
054200 3100-PROCESS-ITEMS.                                              05420001
054300                                                                  05430001
054400     IF  PS-DISPLAY-PARA-YES                                      05440001
054500         DISPLAY ' SUKUT576 - 3100-PROCESS-ITEMS            '     05450001
054600     END-IF.                                                      05460001
054700                                                                  05470001
054800     IF SUT00028-UPC-NBR NOT = PV-SAVE-UPC-NBR                    05480001
054900         PERFORM 7230-SELECT-DEPT                                 05490001
055000     END-IF.                                                      05500001
055100                                                                  05510001
055200     IF  SUT00028-UPC-NBR = ZEROES                                05520001
055300         MOVE ZEROES  TO  XLT00003-SKU-NBR                        05530001
055400                          XLT00004-DEPT-NBR                       05540001
055500                          XLT00004-MAJ-CL-NBR                     05550001
055600                          XLT00001-BUS-AREA-ID                    05560001
055700         MOVE SPACES  TO  XLT00004-HNG-FOLD-DESC                  05570001
055800         MOVE 'H'     TO  XLT00002-MDSE-LNE-CDE                   05580001
055900     END-IF.                                                      05590001
056000                                                                  05600001
056100     IF XLT00003-SKU-NBR NOT = PV-SAVE-SKU-NBR                    05610001
056200         PERFORM 7280-SELECT-BRAND-ID                             05620001
056300     END-IF.                                                      05630001
056400                                                                  05640001
056500     IF PS-DEPT-NOT-FOUND                                         05650001
056600         PERFORM 3200-PROCESS-DUMMY-CARTON                        05660001
056700     ELSE                                                         05670001
056800         IF (SUT00028-TRN-NBR     = 0 AND                         05680001
056900             SUT00028-TRN-LNE-NBR = 0)                            05690001
057000            OR  SUT00024-CART-SRC-CDE = 'FXR'                     05700001
057100            OR  PS-NO-CARTON-INFO                                 05710001
057200                MOVE '0001-01-01' TO PV-AD-EVNT-DTE               05720001
057300                MOVE 0            TO PURITM-UNT-RTL-PR-AMT        05730001
057400                                     PURITM-UNT-COST-AMT          05740001
057500                                     PV-UNT-RTL-AMT               05750001
057600                                     PV-UNT-COST-AMT              05760001
057700         ELSE                                                     05770001
057800             IF  SUT00028-UPC-NBR     NOT = PV-SAVE-UPC-NBR OR    05780001
057900                 SUT00028-TRN-NBR     NOT = PV-SAVE-TRN-NBR OR    05790001
058000                 SUT00028-TRN-LNE-NBR NOT = PV-SAVE-TRN-LNE-NBR   05800001
058100                 MOVE SUT00028-UPC-NBR     TO PV-SAVE-UPC-NBR     05810001
058200                 MOVE SUT00028-TRN-NBR     TO PV-SAVE-TRN-NBR     05820001
058300                 MOVE SUT00028-TRN-LNE-NBR TO PV-SAVE-TRN-LNE-NBR 05830001
058400                 MOVE ZERO                 TO PV-UNT-RTL-AMT      05840001
058500                                              PV-UNT-COST-AMT     05850001
058600                 IF SUT00024-CART-SRC-CDE NOT = 'RDM'             05860001
058700                     PERFORM 7260-SELECT-TPURITM                  05870001
058800                     MOVE PURITM-UNT-RTL-PR-AMT                   05880001
058900                                    TO PV-UNT-RTL-AMT             05890001
059000                     MOVE PURITM-UNT-COST-AMT                     05900001
059100                                    TO PV-UNT-COST-AMT            05910001
059200                 ELSE                                             05920001
059300                     MOVE '0001-01-01' TO PV-AD-EVNT-DTE          05930001
059400                     PERFORM 7250-RDM-COST-AND-RETAIL             05940001
059500                     MOVE CEPLIT-UNT-RTL-AMT                      05950001
059600                                    TO PV-UNT-RTL-AMT             05960001
059700                     MOVE XLV00002-UNT-COST-AMT                   05970001
059800                                    TO PV-UNT-COST-AMT            05980001
059900                 END-IF                                           05990001
060000             END-IF                                               06000001
060100         END-IF                                                   06010001
060200                                                                  06020001
060300         PERFORM 7270-PRC-MSG-CDE                                 06030001
060400         MOVE XLT00004-DEPT-NBR     TO SUT00095-DEPT-NBR          06040001
060500         MOVE XLT00004-MAJ-CL-NBR   TO SUT00095-MAJ-CL-NBR        06050001
060600         MOVE XLT00001-BUS-AREA-ID  TO SUT00095-BUS-AREA-ID       06060001
060700         MOVE SUT00028-SHPD-UNT-QTY TO SUT00095-UNT-QTY           06070001
060800                                                                  06080001
060900         COMPUTE SUT00095-RTL-DOL-AMT =                           06090001
061000              PV-UNT-RTL-AMT  * SUT00028-SHPD-UNT-QTY             06100001
061100                                                                  06110001
061200         COMPUTE SUT00095-COST-DOL-AMT  =                         06120001
061300              PV-UNT-COST-AMT * SUT00028-SHPD-UNT-QTY             06130001
061400                                                                  06140001
061500         MOVE XLT00003-SKU-NBR      TO SUT00095-SKU-NBR           06150001
061600                                       PV-SAVE-SKU-NBR            06160001
061700         MOVE SUCRDV-SHIPT-UNT-ID   TO SUT00095-SHIPT-UNT-ID      06170001
061800         MOVE PV-AD-EVNT-DTE        TO SUT00095-AD-DTE            06180001
061900         MOVE XLT00002-MDSE-LNE-CDE TO SUT00095-MDSE-LNE-CDE      06190001
062000         MOVE DK-TRIP-OCRNC-ID      TO SUT00095-TRIP-OCRNC-ID     06200001
062100                                                                  06210001
062200         EVALUATE XLT00004-HNG-FOLD-DESC                          06220001
062300             WHEN PC-HANG                                         06230001
062400                 MOVE 1            TO SUT00095-HNG-FOLD-SEQ-NBR   06240001
062500             WHEN PC-FOLD                                         06250001
062600                 MOVE 2            TO SUT00095-HNG-FOLD-SEQ-NBR   06260001
062700             WHEN OTHER                                           06270001
062800                 MOVE 0            TO SUT00095-HNG-FOLD-SEQ-NBR   06280001
062900         END-EVALUATE                                             06290001
063000                                                                  06300001
063100         MOVE XLT00004-BRND-ID      TO SUT00095-BRND-ID           06310005
063200         MOVE SUT00024-EAS-TAG-IND  TO SUT00095-EAS-TAG-IND       06320001
063300         MOVE SUT00094-PRC-MSG-CDE  TO SUT00095-PRC-MSG-CDE       06330001
063400         MOVE SUCRDV-DIVERT-TMST    TO SUT00095-DIVERT-TMST       06340001
063500         PERFORM 7900-INSERT-SUT00095                             06350001
063600     END-IF.                                                      06360001
063700                                                                  06370001
063800                                                                  06380001
063900******************************************************************06390001
064000*                                                                 06400001
064100******************************************************************06410001
064200 3111-FIND-NEW-IND.                                               06420001
064300                                                                  06430001
064400     IF  PS-DISPLAY-PARA-YES                                      06440001
064500         DISPLAY ' SUKUT576 - 3111-FIND-NEW-IND             '     06450001
064600     END-IF.                                                      06460001
064700                                                                  06470001
064800     MOVE ZERO TO PS-EXISTS.                                      06480001
064900                                                                  06490001
065000     EXEC SQL                                                     06500001
065100         SELECT 1                                                 06510001
065200           INTO :PS-EXISTS                                        06520001
065300           FROM SUT_TRIP_DTL_SUM                                  06530001
065400          WHERE TRIP_OCRNC_ID       = :SUT00095-TRIP-OCRNC-ID     06540001
065500            AND BUS_AREA_ID         = :PV-SAVE-BUS-AREA-ID        06550001
065600            AND BRND_ID             = :PV-SAVE-BRND-ID            06560001
065700            AND PRC_MSG_CDE         = :PC-RF                      06570001
065800          FETCH FIRST 1 ROWS ONLY                                 06580001
065900        WITH UR                                                   06590001
066000     END-EXEC.                                                    06600001
066100                                                                  06610001
066200     EVALUATE TRUE                                                06620001
066300         WHEN SQLCODE = ZERO                                      06630001
066400              IF PS-ROW-EXISTS-YES                                06640001
066500                 MOVE 'Y'    TO  SUT00066-PRC-MSG-RPLN-NEW-IND    06650001
066600              ELSE                                                06660001
066700                 MOVE 'N'    TO  SUT00066-PRC-MSG-RPLN-NEW-IND    06670001
066800              END-IF                                              06680001
066900                                                                  06690001
067000         WHEN SQLCODE = +100                                      06700001
067100                 MOVE 'N'    TO  SUT00066-PRC-MSG-RPLN-NEW-IND    06710001
067200                                                                  06720001
067300         WHEN SQLWARN0 NOT = SPACE                                06730001
067400         WHEN SQLCODE  NOT = +0                                   06740001
067500                                                                  06750001
067600              MOVE SQLCODE                TO PV-DISP-SQLCODE      06760001
067700              MOVE SUT00095-TRIP-OCRNC-ID TO PV-DISP-OCRNC-ID     06770001
067800              MOVE PV-SAVE-BUS-AREA-ID    TO PV-DISP-BUS-AREA     06780001
067900              MOVE PV-SAVE-BRND-ID        TO PV-DISP-BRAND        06790001
068000                                                                  06800001
068100              MOVE '3111-FIND-NEW-IND' TO PV-ABEND-PARAGRAPH      06810001
068200              MOVE 'READ SUT00095'     TO PV-DB2-OPERATION        06820001
068300              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        06830001
068400              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-2        06840001
068401              MOVE PV-DISP-BRAND       TO PV-DB2-MESSAGE-3        06840101
068402              MOVE ' '                 TO PV-DB2-MESSAGE-4        06840201
068403              MOVE 'SUT_TRIP_DTL_SUM'  TO PV-ABEND-TABLE-1        06840301
068404              MOVE ' '                 TO PV-ABEND-TABLE-2        06840401
068405              MOVE ' '                 TO PV-ABEND-TABLE-3        06840501
068406              MOVE ' '                 TO PV-ABEND-TABLE-4        06840601
068407              MOVE ' '                 TO PV-ABEND-TABLE-5        06840701
068408                                                                  06840801
068409              PERFORM 9900-DB2-ERROR                              06840901
068410     END-EVALUATE.                                                06841001
068420                                                                  06842001
068430                                                                  06843001
068440******************************************************************06844001
068450*                                                                 06845001
068460******************************************************************06846001
068470 3121-FIND-HANG-CDE.                                              06847001
068480                                                                  06848001
068490     IF  PS-DISPLAY-PARA-YES                                      06849001
068500         DISPLAY ' SUKUT576 - 3121-FIND-HANG-CDE            '     06850001
068600     END-IF.                                                      06860001
068700                                                                  06870001
068800     EXEC SQL                                                     06880001
068900         SELECT COUNT(HNG_FOLD_SEQ_NBR)                           06890001
069000           INTO :PV-HANG-CDE-COUNT                                06900001
069100           FROM SUT_TRIP_DTL_SUM                                  06910001
069200          WHERE TRIP_OCRNC_ID       = :SUT00095-TRIP-OCRNC-ID     06920001
069300            AND BUS_AREA_ID         = :PV-SAVE-BUS-AREA-ID        06930001
069400            AND BRND_ID             = :PV-SAVE-BRND-ID            06940001
069500            AND HNG_FOLD_SEQ_NBR    = 1                           06950001
069600           WITH UR                                                06960001
069700     END-EXEC.                                                    06970001
069800                                                                  06980001
069900     EVALUATE TRUE                                                06990001
070000         WHEN SQLCODE = ZERO                                      07000001
070100              CONTINUE                                            07010001
070200                                                                  07020001
070300         WHEN SQLWARN0 NOT = SPACE                                07030001
070400         WHEN SQLCODE  NOT = +0                                   07040001
070500                                                                  07050001
070600              MOVE SQLCODE                TO PV-DISP-SQLCODE      07060001
070700              MOVE SUT00095-TRIP-OCRNC-ID TO PV-DISP-OCRNC-ID     07070001
070800              MOVE PV-SAVE-BUS-AREA-ID    TO PV-DISP-BUS-AREA     07080001
070900              MOVE PV-SAVE-BRND-ID        TO PV-DISP-BRAND        07090001
071000                                                                  07100001
071100              MOVE '3121-FIND-HANG-CDE' TO PV-ABEND-PARAGRAPH     07110001
071200              MOVE 'READ SUT00095'     TO PV-DB2-OPERATION        07120001
071201              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        07120101
071202              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-2        07120201
071203              MOVE PV-DISP-BRAND       TO PV-DB2-MESSAGE-3        07120301
071204              MOVE ' '                 TO PV-DB2-MESSAGE-4        07120401
071205              MOVE 'SUT_TRIP_DTL_SUM'  TO PV-ABEND-TABLE-1        07120501
071206              MOVE ' '                 TO PV-ABEND-TABLE-2        07120601
071207              MOVE ' '                 TO PV-ABEND-TABLE-3        07120701
071208              MOVE ' '                 TO PV-ABEND-TABLE-4        07120801
071209              MOVE ' '                 TO PV-ABEND-TABLE-5        07120901
071210                                                                  07121001
071220              PERFORM 9900-DB2-ERROR                              07122000
071230     END-EVALUATE.                                                07123001
071240                                                                  07124001
071250                                                                  07125001
071260******************************************************************07126001
071270*                                                                 07127001
071280******************************************************************07128001
071290 3131-FIND-FOLD-CDE.                                              07129001
071300                                                                  07130001
071400     IF  PS-DISPLAY-PARA-YES                                      07140001
071500         DISPLAY ' SUKUT576 - 3131-FIND-FOLD-CDE            '     07150001
071600     END-IF.                                                      07160001
071700                                                                  07170001
071800     EXEC SQL                                                     07180000
071900         SELECT COUNT(HNG_FOLD_SEQ_NBR)                           07190000
072000           INTO :PV-FOLD-CDE-COUNT                                07200000
072100           FROM SUT_TRIP_DTL_SUM                                  07210000
072200          WHERE TRIP_OCRNC_ID       = :SUT00095-TRIP-OCRNC-ID     07220000
072300            AND BUS_AREA_ID         = :PV-SAVE-BUS-AREA-ID        07230000
072400            AND BRND_ID             = :PV-SAVE-BRND-ID            07240000
072500            AND HNG_FOLD_SEQ_NBR    = 2                           07250000
072600           WITH UR                                                07260000
072700     END-EXEC.                                                    07270000
072800                                                                  07280000
072900     EVALUATE TRUE                                                07290000
073000         WHEN SQLCODE = ZERO                                      07300000
073100              CONTINUE                                            07310000
073110                                                                  07311000
073120         WHEN SQLWARN0 NOT = SPACE                                07312001
073130         WHEN SQLCODE  NOT = +0                                   07313001
073140                                                                  07314001
073150              MOVE SQLCODE                TO PV-DISP-SQLCODE      07315001
073160              MOVE SUT00095-TRIP-OCRNC-ID TO PV-DISP-OCRNC-ID     07316001
073170              MOVE PV-SAVE-BUS-AREA-ID    TO PV-DISP-BUS-AREA     07317001
073180              MOVE PV-SAVE-BRND-ID        TO PV-DISP-BRAND        07318001
073190                                                                  07319001
073200              MOVE '3131-FIND-FOLD-CDE' TO PV-ABEND-PARAGRAPH     07320001
073300              MOVE 'READ SUT00095'     TO PV-DB2-OPERATION        07330001
073400              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        07340001
073500              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-2        07350001
073600              MOVE PV-DISP-BRAND       TO PV-DB2-MESSAGE-3        07360001
073700              MOVE ' '                 TO PV-DB2-MESSAGE-4        07370001
073800              MOVE 'SUT_TRIP_DTL_SUM'  TO PV-ABEND-TABLE-1        07380001
073900              MOVE ' '                 TO PV-ABEND-TABLE-2        07390001
073910              MOVE ' '                 TO PV-ABEND-TABLE-3        07391001
073920              MOVE ' '                 TO PV-ABEND-TABLE-4        07392001
073930              MOVE ' '                 TO PV-ABEND-TABLE-5        07393001
073940                                                                  07394001
073950              PERFORM 9900-DB2-ERROR                              07395001
073960     END-EVALUATE.                                                07396001
073970                                                                  07397001
073980                                                                  07398001
073990******************************************************************07399001
074000*                                                                 07400001
074100******************************************************************07410001
074200 3200-PROCESS-DUMMY-CARTON.                                       07420001
074300                                                                  07430001
074301     IF  PS-DISPLAY-PARA-YES                                      07430101
074302         DISPLAY ' SUKUT576 - 3200-PROCESS-DUMMY-CARTON     '     07430201
074303     END-IF.                                                      07430301
074304                                                                  07430401
074305     MOVE 9999                  TO SUT00095-DEPT-NBR.             07430501
074306     MOVE 9999                  TO SUT00095-MAJ-CL-NBR.           07430601
074307     MOVE 9999                  TO SUT00095-BUS-AREA-ID.          07430701
074308     MOVE 0                     TO SUT00095-UNT-QTY.              07430801
074309     MOVE 0                     TO SUT00095-RTL-DOL-AMT.          07430901
074310     MOVE 0                     TO SUT00095-COST-DOL-AMT.         07431001
074320     MOVE 0                     TO SUT00095-SKU-NBR.              07432001
074330     MOVE SUCRDV-SHIPT-UNT-ID   TO SUT00095-SHIPT-UNT-ID.         07433001
074340     MOVE '0001-01-01'          TO SUT00095-AD-DTE.               07434001
074350     MOVE SPACES                TO SUT00095-MDSE-LNE-CDE.         07435001
074360     MOVE 0                     TO SUT00095-HNG-FOLD-SEQ-NBR.     07436001
074370     MOVE 9999999999            TO SUT00095-BRND-ID.              07437001
074380     MOVE SUT00024-EAS-TAG-IND  TO SUT00095-EAS-TAG-IND.          07438001
074390                                                                  07439001
074400     PERFORM 7270-PRC-MSG-CDE.                                    07440001
074500                                                                  07450001
074600     MOVE SUT00094-PRC-MSG-CDE  TO SUT00095-PRC-MSG-CDE.          07460001
074700     MOVE SUCRDV-DIVERT-TMST    TO SUT00095-DIVERT-TMST.          07470001
074800                                                                  07480001
074900     MOVE DK-TRIP-OCRNC-ID      TO SUT00095-TRIP-OCRNC-ID.        07490001
075000                                                                  07500001
075100     PERFORM 7900-INSERT-SUT00095.                                07510001
075200                                                                  07520001
075300                                                                  07530001
075400******************************************************************07540001
075500*                                                                 07550001
075600******************************************************************07560001
075700 4000-PROCESS-TEMP-TABLE.                                         07570001
075800                                                                  07580001
075900     IF  PS-DISPLAY-PARA-YES                                      07590001
076000         DISPLAY ' SUKUT576 - 4000-PROCESS-TEMP-TABLE       '     07600001
076100     END-IF.                                                      07610001
076200                                                                  07620001
076300     PERFORM 8600-SUMM-TRIP-QTY-DOL.                              07630001
076400     PERFORM 8700-SELECT-SKU-CNT-TRIP.                            07640001
076500     PERFORM 8750-SELECT-CARTON-CNT-TRIP.                         07650001
076600                                                                  07660001
076700     MOVE DK-TRIP-OCRNC-ID       TO SUT00007-TRIP-OCRNC-ID.       07670001
076800     MOVE DK-OTBND-TRIP-ID       TO SUT00007-OTBND-TRIP-ID.       07680001
076900     MOVE PV-UNIT-QTY-SUM        TO SUT00007-UNT-QTY.             07690001
077000     MOVE PV-SKU-COUNT           TO SUT00007-SKU-QTY.             07700001
077100     MOVE PV-CARTON-COUNT        TO SUT00007-CART-QTY.            07710001
077200     MOVE PV-RETAIL-SUM          TO SUT00007-RTL-DOL-AMT.         07720001
077300     MOVE PV-COST-SUM            TO SUT00007-COST-DOL-AMT.        07730001
077400                                                                  07740001
077500     PERFORM 8870-UPDATE-SUT00007.                                07750001
077600                                                                  07760001
077700     MOVE 0          TO PV-SAVE-BUS-AREA-ID                       07770001
077800                        PV-SAVE-DEPT-NBR                          07780001
077900                        PV-SAVE-BRND-ID.                          07790001
078000                                                                  07800001
078100     SET PS-NOT-EOF-UNT-DOL-CLASS-CSR TO TRUE.                    07810001
078200                                                                  07820001
078300     PERFORM 8000-OPEN-SKU-QTY-CLASS-CURSOR.                      07830001
078400     PERFORM 4100-DETERMINE-CLASS-VALUES                          07840001
078500         UNTIL PS-EOF-UNT-DOL-CLASS-CSR.                          07850001
078600     PERFORM 8060-CLOSE-SKU-QTY-CLASS-CSR.                        07860001
078700                                                                  07870001
078800     MOVE 0          TO PV-SAVE-BUS-AREA-ID                       07880001
078900                        PV-SAVE-BRND-ID.                          07890001
079000                                                                  07900001
079100     SET PS-NOT-EOF-UNT-DOL-MDSE-CSR TO TRUE.                     07910001
079200                                                                  07920001
079300     PERFORM 8101-OPEN-SKU-QTY-BRND-CURSOR.                       07930000
079400     PERFORM 4201-DETERMINE-BRND-MDSE-VALUE                       07940000
079500         UNTIL PS-EOF-UNT-DOL-MDSE-CSR.                           07950000
079600     PERFORM 8161-CLOSE-SKU-QTY-BRND-CSR.                         07960000
079700                                                                  07970001
079800     SET PS-NOT-EOF-DATE-CSR TO TRUE.                             07980001
079900                                                                  07990001
080000     PERFORM 7300-OPEN-AD-DATE-CURSOR.                            08000000
080100     PERFORM 4400-PROCESS-DATE-CURSOR                             08010000
080200         UNTIL PS-EOF-DATE-CSR.                                   08020000
080300     PERFORM 7500-CLOSE-AD-DATE.                                  08030000
080400                                                                  08040000
080500                                                                  08050000
080510******************************************************************08051000
080520*                                                                 08052000
080530******************************************************************08053000
080540 4100-DETERMINE-CLASS-VALUES.                                     08054001
080550                                                                  08055001
080560     IF  PS-DISPLAY-PARA-YES                                      08056001
080570         DISPLAY ' SUKUT576 - 4100-DETERMINE-CLASS-VALUES   '     08057001
080580     END-IF.                                                      08058001
080590                                                                  08059001
080600     PERFORM 8030-FETCH-SKU-QTY-CLASS-CSR.                        08060001
080700                                                                  08070001
080800     IF PS-NOT-EOF-UNT-DOL-CLASS-CSR                              08080000
080810                                                                  08081000
080820         PERFORM 8200-SELECT-SKU-CNT-CLASS                        08082001
080830         PERFORM 8250-SELECT-CARTON-CNT-CLASS                     08083001
080840                                                                  08084001
080850         MOVE DK-TRIP-OCRNC-ID       TO SUT00010-TRIP-OCRNC-ID    08085001
080860         MOVE SUT00095-BUS-AREA-ID   TO SUT00010-BUS-AREA-ID      08086001
080870         MOVE SUT00095-DEPT-NBR      TO SUT00010-DEPT-NBR         08087001
080880         MOVE SUT00095-MAJ-CL-NBR    TO SUT00010-MAJ-CL-NBR       08088001
080890         MOVE PV-UNIT-QTY-SUM        TO SUT00010-UNT-QTY          08089001
080900         MOVE PV-SKU-COUNT           TO SUT00010-SKU-QTY          08090001
081000         MOVE PV-CARTON-COUNT        TO SUT00010-CART-QTY         08100001
081100         MOVE PV-RETAIL-SUM          TO SUT00010-RTL-DOL-AMT      08110001
081200         MOVE PV-COST-SUM            TO SUT00010-COST-DOL-AMT     08120001
081300                                                                  08130001
081400         IF  SUT00095-BUS-AREA-ID NOT = PV-SAVE-BUS-AREA-ID       08140001
081500             IF  PV-SAVE-BUS-AREA-ID  > 0                         08150001
081600                 PERFORM 8550-SELECT-CARTON-CNT-BUS-GP            08160001
081700                 MOVE PV-CARTON-COUNT  TO SUT00008-CART-QTY       08170001
081800                 PERFORM 8845-UPDATE-SUT00008                     08180001
081900             END-IF                                               08190001
082000                                                                  08200001
082100             INITIALIZE DCLSUT00008                               08210001
082200             MOVE DK-TRIP-OCRNC-ID     TO SUT00008-TRIP-OCRNC-ID  08220001
082300             MOVE SUT00095-BUS-AREA-ID TO SUT00008-BUS-AREA-ID    08230001
082400             PERFORM 8840-INSERT-SUT00008                         08240001
082500         END-IF                                                   08250001
082600                                                                  08260001
082700         IF  SUT00095-BUS-AREA-ID NOT = PV-SAVE-BUS-AREA-ID OR    08270001
082800             SUT00095-DEPT-NBR    NOT = PV-SAVE-DEPT-NBR          08280001
082900                                                                  08290001
083000             IF  PV-SAVE-BUS-AREA-ID > 0 AND                      08300001
083100                 PV-SAVE-DEPT-NBR > 0                             08310001
083200                 PERFORM 8350-SELECT-CARTON-CNT-DEPT              08320001
083300                 MOVE PV-CARTON-COUNT  TO SUT00009-CART-QTY       08330001
083400                 PERFORM 8825-UPDATE-SUT00009                     08340001
083500             END-IF                                               08350001
083600                                                                  08360001
083700             INITIALIZE DCLSUT00009                               08370001
083800             MOVE DK-TRIP-OCRNC-ID     TO SUT00009-TRIP-OCRNC-ID  08380001
083900             MOVE SUT00095-BUS-AREA-ID TO SUT00009-BUS-AREA-ID    08390001
084000             MOVE SUT00095-DEPT-NBR    TO SUT00009-DEPT-NBR       08400001
084100             PERFORM 8820-INSERT-SUT00009                         08410001
084200         END-IF                                                   08420001
084300                                                                  08430001
084400         PERFORM 8800-INSERT-SUT00010                             08440001
084500                                                                  08450001
084600         IF  SUT00095-BUS-AREA-ID NOT = PV-SAVE-BUS-AREA-ID OR    08460001
084700             SUT00095-DEPT-NBR    NOT = PV-SAVE-DEPT-NBR          08470001
084800             MOVE DK-TRIP-OCRNC-ID     TO SUT00009-TRIP-OCRNC-ID  08480001
084900             MOVE SUT00095-BUS-AREA-ID TO SUT00009-BUS-AREA-ID    08490001
085000             MOVE SUT00095-DEPT-NBR    TO SUT00009-DEPT-NBR       08500001
085100             MOVE PV-UNIT-QTY-SUM      TO SUT00009-UNT-QTY        08510001
085200             MOVE PV-SKU-COUNT         TO SUT00009-SKU-QTY        08520001
085300             MOVE PV-CARTON-COUNT      TO SUT00009-CART-QTY       08530001
085400             MOVE PV-RETAIL-SUM        TO SUT00009-RTL-DOL-AMT    08540001
085500             MOVE PV-COST-SUM          TO SUT00009-COST-DOL-AMT   08550001
085600                                                                  08560001
085700             IF  SUT00095-BUS-AREA-ID NOT = PV-SAVE-BUS-AREA-ID   08570000
085800                 MOVE DK-TRIP-OCRNC-ID TO SUT00008-TRIP-OCRNC-ID  08580000
085900                 MOVE SUT00095-BUS-AREA-ID                        08590001
086000                                       TO SUT00008-BUS-AREA-ID    08600001
086100                 MOVE PV-UNIT-QTY-SUM  TO SUT00008-UNT-QTY        08610000
086200                 MOVE PV-SKU-COUNT     TO SUT00008-SKU-QTY        08620000
086300                 MOVE PV-RETAIL-SUM    TO SUT00008-RTL-DOL-AMT    08630000
086400                 MOVE PV-COST-SUM      TO SUT00008-COST-DOL-AMT   08640000
086500             ELSE                                                 08650000
086600                 ADD  PV-UNIT-QTY-SUM  TO SUT00008-UNT-QTY        08660000
086700                 ADD  PV-SKU-COUNT     TO SUT00008-SKU-QTY        08670000
086800                 ADD  PV-RETAIL-SUM    TO SUT00008-RTL-DOL-AMT    08680000
086900                 ADD  PV-COST-SUM      TO SUT00008-COST-DOL-AMT   08690000
087000             END-IF                                               08700000
087010                                                                  08701000
087020             MOVE SUT00095-BUS-AREA-ID TO PV-SAVE-BUS-AREA-ID     08702001
087030             MOVE SUT00095-DEPT-NBR    TO PV-SAVE-DEPT-NBR        08703001
087040         ELSE                                                     08704001
087050             ADD  PV-UNIT-QTY-SUM      TO SUT00009-UNT-QTY        08705001
087060             ADD  PV-SKU-COUNT         TO SUT00009-SKU-QTY        08706001
087070             ADD  PV-CARTON-COUNT      TO SUT00009-CART-QTY       08707001
087080             ADD  PV-RETAIL-SUM        TO SUT00009-RTL-DOL-AMT    08708001
087090             ADD  PV-COST-SUM          TO SUT00009-COST-DOL-AMT   08709001
087100             ADD  PV-UNIT-QTY-SUM      TO SUT00008-UNT-QTY        08710001
087200             ADD  PV-SKU-COUNT         TO SUT00008-SKU-QTY        08720001
087300             ADD  PV-RETAIL-SUM        TO SUT00008-RTL-DOL-AMT    08730001
087400             ADD  PV-COST-SUM          TO SUT00008-COST-DOL-AMT   08740001
087500         END-IF                                                   08750001
087600     ELSE                                                         08760001
087700         IF  PV-SAVE-DEPT-NBR > 0                                 08770001
087800             PERFORM 8350-SELECT-CARTON-CNT-DEPT                  08780001
087900             MOVE PV-CARTON-COUNT      TO SUT00009-CART-QTY       08790001
088000             PERFORM 8825-UPDATE-SUT00009                         08800001
088100         END-IF                                                   08810001
088200                                                                  08820001
088300         IF  PV-SAVE-BUS-AREA-ID > 0                              08830001
088400             PERFORM 8550-SELECT-CARTON-CNT-BUS-GP                08840001
088500             MOVE PV-CARTON-COUNT        TO SUT00008-CART-QTY     08850001
088600             PERFORM 8845-UPDATE-SUT00008                         08860001
088700         END-IF                                                   08870001
088800                                                                  08880001
088900     END-IF.                                                      08890001
089000                                                                  08900001
089100                                                                  08910001
089200******************************************************************08920001
089300* NEW SET OF PARA'S FOR BRAND                                     08930001
089400******************************************************************08940001
089500 4201-DETERMINE-BRND-MDSE-VALUE.                                  08950001
089600                                                                  08960001
089700     IF  PS-DISPLAY-PARA-YES                                      08970001
089800         DISPLAY ' SUKUT576 - 4201-DETERMINE-BRND-MDSE-VALUE'     08980001
089900     END-IF.                                                      08990001
089910                                                                  08991000
089920     PERFORM 8131-FETCH-SKU-QTY-BRND-CSR.                         08992001
089930                                                                  08993001
089940     IF PS-NOT-EOF-UNT-DOL-MDSE-CSR                               08994001
089950         INITIALIZE DCLSUT00066                                   08995001
089960         MOVE SUT00095-BUS-AREA-ID   TO PV-SAVE-BUS-AREA-ID       08996001
089970         MOVE SUT00095-BRND-ID       TO PV-SAVE-BRND-ID           08997001
089980                                                                  08998001
089990         PERFORM 8451-SELECT-CARTON-CNT-BRND                      08999001
090000                                                                  09000001
090100         MOVE PV-CARTON-COUNT        TO SUT00066-CART-QTY         09010001
090200                                                                  09020001
090300         PERFORM 8401-SELECT-SKU-CNT-BRND                         09030001
090400                                                                  09040001
090500         MOVE PV-SKU-COUNT           TO SUT00066-SKU-QTY          09050001
090600         MOVE DK-TRIP-OCRNC-ID       TO SUT00066-TRIP-OCRNC-ID    09060001
090700         MOVE SUT00095-BUS-AREA-ID   TO SUT00066-BUS-AREA-ID      09070001
090800         MOVE SUT00095-BRND-ID       TO SUT00066-BRND-ID          09080001
090900         MOVE PV-UNIT-QTY-SUM        TO SUT00066-UNT-QTY          09090001
091000         MOVE PV-RETAIL-SUM          TO SUT00066-RTL-DOL-AMT      09100001
091100         MOVE PV-COST-SUM            TO SUT00066-COST-DOL-AMT     09110001
091200         MOVE ZEROES                 TO PV-NEW-IND-COUNT          09120001
091300                                        PV-HANG-CDE-COUNT         09130001
091400                                        PV-FOLD-CDE-COUNT         09140001
091500         PERFORM 3111-FIND-NEW-IND                                09150001
091600         PERFORM 3121-FIND-HANG-CDE                               09160001
091700         PERFORM 3131-FIND-FOLD-CDE                               09170001
091800                                                                  09180001
091900         EVALUATE TRUE                                            09190001
092000            WHEN (PV-HANG-CDE-COUNT > 0  AND                      09200001
092100                  PV-FOLD-CDE-COUNT > 0)                          09210001
092200                 MOVE PC-B  TO SUT00066-HNG-FOLD-CDE              09220001
092300                                                                  09230001
092400            WHEN (PV-HANG-CDE-COUNT = 0  AND                      09240001
092500                  PV-FOLD-CDE-COUNT = 0)                          09250001
092600                 MOVE SPACE TO SUT00066-HNG-FOLD-CDE              09260001
092700                                                                  09270001
092800            WHEN (PV-HANG-CDE-COUNT > 0  AND                      09280000
092900                  PV-FOLD-CDE-COUNT = 0)                          09290000
093000                 MOVE PC-H  TO SUT00066-HNG-FOLD-CDE              09300000
093010                                                                  09301000
093020            WHEN (PV-HANG-CDE-COUNT = 0  AND                      09302001
093030                  PV-FOLD-CDE-COUNT > 0)                          09303001
093040                 MOVE PC-F  TO SUT00066-HNG-FOLD-CDE              09304001
093050                                                                  09305001
093060            WHEN OTHER                                            09306001
093070                 DISPLAY 'SOMETHING WRONG HERE'                   09307001
093080                                                                  09308001
093090         END-EVALUATE                                             09309001
093100                                                                  09310001
093200         PERFORM 8891-INSERT-SUT00066                             09320001
093300     END-IF.                                                      09330001
093400                                                                  09340001
093500                                                                  09350001
093600******************************************************************09360001
093700*                                                                 09370001
093800******************************************************************09380001
093900 4400-PROCESS-DATE-CURSOR.                                        09390001
094000                                                                  09400001
094100     IF  PS-DISPLAY-PARA-YES                                      09410001
094101         DISPLAY ' SUKUT576 - 4400-PROCESS-DATE-CURSOR      '     09410101
094102     END-IF.                                                      09410201
094103                                                                  09410301
094104     PERFORM 7400-FETCH-AD-DATE.                                  09410401
094105                                                                  09410501
094106     IF PS-NOT-EOF-DATE-CSR                                       09410601
094107         MOVE DK-TRIP-OCRNC-ID       TO SUT00011-TRIP-OCRNC-ID    09410701
094108         MOVE SUT00095-BUS-AREA-ID   TO SUT00011-BUS-AREA-ID      09410801
094109         MOVE SUT00095-DEPT-NBR      TO SUT00011-DEPT-NBR         09410901
094110         MOVE SUT00095-MAJ-CL-NBR    TO SUT00011-MAJ-CL-NBR       09411001
094120         MOVE SUT00095-AD-DTE        TO SUT00011-AD-EVNT-DTE      09412001
094130                                                                  09413001
094140         PERFORM 8880-INSERT-SUT00011                             09414001
094150     END-IF.                                                      09415001
094160                                                                  09416001
094170                                                                  09417001
094180******************************************************************09418001
094190*                                                                 09419001
094200******************************************************************09420001
094300 5000-CREATE-TRIP-OCCURENCE-ID.                                   09430001
094400                                                                  09440001
094500     IF  PS-DISPLAY-PARA-YES                                      09450001
094600         DISPLAY ' SUKUT576 - 5000-CREATE-TRIP-OCCURENCE-ID '     09460001
094700     END-IF.                                                      09470001
094800                                                                  09480001
094900     CALL PC-RANDOM-PGM                                           09490001
095000          USING DP902-RANDNBR-ROUTINE-FIELDS.                     09500001
095100                                                                  09510001
095200     IF  DP902-SUCCESSFUL                                         09520001
095300         MOVE DP902-RANDOM-NUMBER    TO PV-RANDOM-NUMBER          09530001
095400         MOVE PV-RANDOM-NUMBER       TO DK-TRIP-OCRNC-ID          09540001
095500                                                                  09550001
095600         IF DK-TRIP-OCRNC-ID  > 300000000                         09560001
095700            CONTINUE                                              09570001
095800         ELSE                                                     09580001
095900            ADD  300000000           TO  DK-TRIP-OCRNC-ID         09590001
096000         END-IF                                                   09600001
096100                                                                  09610001
096200     ELSE                                                         09620001
096300         DISPLAY ' SUKUT576 - ERROR GENERATING RANDOM NBR'        09630001
096400     END-IF.                                                      09640001
096500                                                                  09650001
096600                                                                  09660001
096700******************************************************************09670001
096800*                                                                 09680001
096900******************************************************************09690001
097000 7000-SELECT-CARTON-INFO.                                         09700001
097100                                                                  09710001
097200     IF  PS-DISPLAY-PARA-YES                                      09720001
097300         DISPLAY ' SUKUT576 - 7000-SELECT-CARTON-INFO       '     09730001
097400     END-IF.                                                      09740001
097410                                                                  09741001
097420     EXEC SQL                                                     09742001
097430         SELECT CART_SRC_CDE                                      09743001
097440              , EAS_TAG_IND                                       09744001
097450              , CRE_DTE                                           09745001
097460           INTO :SUT00024-CART-SRC-CDE                            09746001
097470              , :SUT00024-EAS-TAG-IND                             09747001
097480              , :SUT00024-CRE-DTE                                 09748001
097490           FROM SUT_OTBND_CART                                    09749001
097500          WHERE SHIPT_UNT_ID          = :SUCRDV-SHIPT-UNT-ID      09750001
097600           WITH UR                                                09760001
097700     END-EXEC.                                                    09770001
097800                                                                  09780001
097900     EVALUATE TRUE                                                09790001
098000         WHEN SQLCODE = ZEROS                                     09800001
098100              SET PS-CARTON-INFO   TO TRUE                        09810001
098200                                                                  09820001
098300         WHEN SQLCODE = +100                                      09830001
098400              MOVE SPACES TO SUT00024-CART-SRC-CDE                09840001
098500                                                                  09850001
098600         WHEN OTHER                                               09860001
098700              MOVE '7000-SELECT-CARTON-INFO'                      09870001
098800                                   TO PV-PARAGRAPH-NAME           09880001
098900              MOVE 'SELECT FROM SUT_OTBND_CART'                   09890001
099000                                   TO PV-DB2-OPERATION            09900001
099100              MOVE SUCRDV-SHIPT-UNT-ID                            09910001
099200                                    TO PV-SHIPT-UNT-ID            09920001
099300              MOVE PV-SHIPT-UNT-ID  TO PV-FIELD-VALUE             09930001
099400              MOVE SQLCODE          TO PV-DISP-SQLCODE            09940001
099500              PERFORM 9900-DB2-ERROR                              09950001
099600     END-EVALUATE.                                                09960001
099700                                                                  09970001
099800                                                                  09980001
099900******************************************************************09990001
100000*                                                                 10000001
100100******************************************************************10010001
100200 7230-SELECT-DEPT.                                                10020001
100300                                                                  10030001
100400     IF  PS-DISPLAY-PARA-YES                                      10040001
100500         DISPLAY ' SUKUT576 - 7230-SELECT-DEPT              '     10050001
100600     END-IF.                                                      10060001
100700                                                                  10070001
100800     EXEC SQL                                                     10080001
100900         SELECT  B.SKU_NBR                                        10090001
101000              ,  C.DEPT_NBR                                       10100001
101100              ,  C.MAJ_CL_NBR                                     10110001
101200              ,  C.HNG_FOLD_DESC                                  10120001
101300              ,  D.MDSE_LNE_CDE                                   10130001
101400              ,  E.BUS_AREA_ID                                    10140001
101500           INTO :XLT00003-SKU-NBR                                 10150001
101600              , :XLT00004-DEPT-NBR                                10160001
101700              , :XLT00004-MAJ-CL-NBR                              10170001
101800              , :XLT00004-HNG-FOLD-DESC                           10180001
101900              , :XLT00002-MDSE-LNE-CDE                            10190001
102000              , :XLT00001-BUS-AREA-ID                             10200001
102100           FROM  XLT_UPC  A                                       10210001
102200              ,  XLT_SKU  B                                       10220001
102300              ,  XLT_VND_STYL C                                   10230001
102400              ,  XLT_DEPT D                                       10240001
102500              ,  XLT_BUS_GP E                                     10250001
102600          WHERE  A.UPC_NBR             = :SUT00028-UPC-NBR        10260001
102700            AND  A.INTR_UPC_ID         = B.INTR_UPC_ID            10270001
102800            AND  B.STYL_ID             = C.STYL_ID                10280001
102900            AND  C.DEPT_NBR            = D.DEPT_NBR               10290001
103000            AND  D.BUS_GP_NBR          = E.BUS_GP_NBR             10300001
103100           WITH UR                                                10310001
103200     END-EXEC.                                                    10320001
103300                                                                  10330001
103400     EVALUATE TRUE                                                10340001
103500         WHEN SQLCODE = ZERO                                      10350001
103600              SET PS-DEPT-FOUND    TO TRUE                        10360001
103700                                                                  10370001
103800         WHEN SQLCODE = +100                                      10380001
103900              SET PS-DEPT-NOT-FOUND    TO TRUE                    10390001
104000               MOVE ZEROES  TO  XLT00003-SKU-NBR                  10400001
104100                                XLT00004-DEPT-NBR                 10410001
104200                                XLT00004-MAJ-CL-NBR               10420001
104300                                XLT00001-BUS-AREA-ID              10430001
104400               MOVE SPACES  TO  XLT00004-HNG-FOLD-DESC            10440001
104500               MOVE 'H'     TO  XLT00002-MDSE-LNE-CDE             10450001
104600                                                                  10460001
104700         WHEN SQLWARN0 NOT = SPACE                                10470001
104800         WHEN SQLCODE  NOT = +0                                   10480001
104900                                                                  10490001
105000              MOVE SQLCODE             TO PV-DISP-SQLCODE         10500001
105100              MOVE SUT00028-UPC-NBR    TO PV-DISP-UPC             10510001
105200                                                                  10520001
105300              MOVE '7230-SELECT-DEPT'  TO PV-ABEND-PARAGRAPH      10530001
105400              MOVE 'READ 5 XLT TABL'   TO PV-DB2-OPERATION        10540001
105500              MOVE PV-DISP-UPC         TO PV-DB2-MESSAGE-1        10550001
105600              MOVE ' '                 TO PV-DB2-MESSAGE-2        10560001
105700              MOVE ' '                 TO PV-DB2-MESSAGE-3        10570001
105800              MOVE ' '                 TO PV-DB2-MESSAGE-4        10580001
105900              MOVE 'XLT_UPC'           TO PV-ABEND-TABLE-1        10590001
106000              MOVE 'XLT_SKU'           TO PV-ABEND-TABLE-2        10600001
106100              MOVE 'XLT_VND_STYL'      TO PV-ABEND-TABLE-3        10610001
106200              MOVE 'XLT_DEPT'          TO PV-ABEND-TABLE-4        10620001
106300              MOVE 'XLT_BUS_GP'        TO PV-ABEND-TABLE-5        10630001
106400                                                                  10640001
106500              PERFORM 9900-DB2-ERROR                              10650001
106600     END-EVALUATE.                                                10660001
106700                                                                  10670001
106800                                                                  10680001
106900******************************************************************10690001
106910*                                                                 10691001
106920******************************************************************10692001
106930 7250-RDM-COST-AND-RETAIL.                                        10693001
106940                                                                  10694001
106950     IF  PS-DISPLAY-PARA-YES                                      10695001
106960         DISPLAY ' SUKUT576 - 7250-RDM-COST-AND-RETAIL      '     10696001
106970     END-IF.                                                      10697001
106980                                                                  10698001
106990     EXEC SQL                                                     10699001
107000         SELECT UNT_RTL_AMT                                       10700001
107100           INTO :CEPLIT-UNT-RTL-AMT                               10710001
107200           FROM TCEPLIT                                           10720001
107300          WHERE CNSTK_REQ_PL_NBR = :SUT00028-TRN-NBR              10730001
107400            AND PL_LNE_NBR       = :SUT00028-TRN-LNE-NBR          10740001
107500           WITH UR                                                10750001
107600     END-EXEC                                                     10760001
107700                                                                  10770001
107800     EVALUATE TRUE                                                10780001
107900         WHEN SQLCODE = ZERO                                      10790001
108000             CONTINUE                                             10800001
108100                                                                  10810001
108200         WHEN SQLCODE = +100                                      10820001
108300             MOVE 0                  TO CEPLIT-UNT-RTL-AMT        10830001
108400                                                                  10840001
108500         WHEN SQLWARN0 NOT = SPACE                                10850000
108600         WHEN SQLCODE  NOT = +0                                   10860000
108700                                                                  10870001
108800              MOVE SQLCODE             TO PV-DISP-SQLCODE         10880001
108900              MOVE SUT00028-TRN-NBR    TO PV-DISP-TRN-NBR         10890001
109000              MOVE SUT00028-TRN-LNE-NBR                           10900001
109100                                       TO PV-DISP-LINE-NBR        10910001
109200                                                                  10920001
109300              MOVE '7250-RDM-COST-AND-RETAIL'                     10930001
109400                                       TO PV-ABEND-PARAGRAPH      10940001
109410              MOVE 'SELECT FROM TCEPLIT '                         10941001
109420                                       TO PV-DB2-OPERATION        10942001
109430              MOVE PV-DISP-TRN-NBR     TO PV-DB2-MESSAGE-1        10943001
109440              MOVE PV-DISP-LINE-NBR    TO PV-DB2-MESSAGE-2        10944001
109450              MOVE ' '                 TO PV-DB2-MESSAGE-3        10945001
109460              MOVE ' '                 TO PV-DB2-MESSAGE-4        10946001
109470              MOVE 'TCEPLIT'           TO PV-ABEND-TABLE-1        10947001
109480              MOVE ' '                 TO PV-ABEND-TABLE-2        10948001
109490              MOVE ' '                 TO PV-ABEND-TABLE-3        10949001
109491              MOVE ' '                 TO PV-ABEND-TABLE-4        10949101
109492              MOVE ' '                 TO PV-ABEND-TABLE-5        10949201
109493                                                                  10949301
109494              PERFORM 9900-DB2-ERROR                              10949401
109495     END-EVALUATE.                                                10949501
109496                                                                  10949601
109497     EXEC SQL                                                     10949701
109498         SELECT DISTINCT                                          10949801
109499                INTR_UPC_ID                                       10949901
109500           INTO :XLV00002-INTR-UPC-ID                             10950001
109600           FROM XLT_UPC                                           10960001
109700          WHERE UPC_NBR  = :SUT00028-UPC-NBR                      10970001
109800           WITH UR                                                10980001
109900     END-EXEC                                                     10990001
110000                                                                  11000001
110100     EVALUATE TRUE                                                11010001
110200         WHEN SQLCODE = ZERO                                      11020001
110300             SET PS-UPC-FOUND        TO TRUE                      11030001
110400                                                                  11040001
110500         WHEN SQLCODE = +100                                      11050001
110600             SET PS-NOT-UPC-FOUND    TO TRUE                      11060001
110700             MOVE 0                  TO XLV00002-UNT-COST-AMT     11070001
110800                                                                  11080001
110900         WHEN SQLWARN0 NOT = SPACE                                11090001
111000         WHEN SQLCODE  NOT = +0                                   11100001
111100                                                                  11110001
111200              MOVE SQLCODE             TO PV-DISP-SQLCODE         11120001
111300              MOVE SUT00028-UPC-NBR    TO PV-DISP-UPC             11130001
111400                                                                  11140001
111500              MOVE '7250-RDM-COST-AND-RETAIL'                     11150001
111600                                       TO PV-ABEND-PARAGRAPH      11160001
111700              MOVE 'SELECT FROM XLT_UPC '                         11170001
111800                                       TO PV-DB2-OPERATION        11180001
111810              MOVE PV-DISP-UPC         TO PV-DB2-MESSAGE-1        11181001
111820              MOVE ' '                 TO PV-DB2-MESSAGE-2        11182001
111830              MOVE ' '                 TO PV-DB2-MESSAGE-3        11183001
111840              MOVE ' '                 TO PV-DB2-MESSAGE-4        11184001
111850              MOVE 'XLT_UPC '          TO PV-ABEND-TABLE-1        11185001
111860              MOVE ' '                 TO PV-ABEND-TABLE-2        11186001
111870              MOVE ' '                 TO PV-ABEND-TABLE-3        11187001
111880              MOVE ' '                 TO PV-ABEND-TABLE-4        11188001
111890              MOVE ' '                 TO PV-ABEND-TABLE-5        11189001
111900                                                                  11190001
111901              PERFORM 9900-DB2-ERROR                              11190101
111902     END-EVALUATE.                                                11190201
111903                                                                  11190301
111904     IF PS-UPC-FOUND                                              11190401
111905         PERFORM 7252-RDM-COST-AMT                                11190501
111906     END-IF.                                                      11190601
111907                                                                  11190701
111908                                                                  11190801
111909******************************************************************11190901
111910*                                                                 11191001
111920******************************************************************11192001
111930 7252-RDM-COST-AMT.                                               11193001
111940                                                                  11194001
111950     IF  PS-DISPLAY-PARA-YES                                      11195001
111960         DISPLAY ' SUKUT576 - 7252-RDM-COST-AMT             '     11196001
111970     END-IF.                                                      11197001
111980                                                                  11198001
111990     EXEC SQL                                                     11199001
112000         SELECT  UNT_COST_AMT                                     11200001
112100           INTO :XLV00002-UNT-COST-AMT                            11210001
112200           FROM  XLV_SKU_STR                                      11220001
112300          WHERE  STR_NBR       = 0                                11230001
112400            AND  INTR_UPC_ID   = :XLV00002-INTR-UPC-ID            11240001
112500           WITH UR                                                11250001
112600     END-EXEC.                                                    11260001
112700                                                                  11270001
112800     EVALUATE TRUE                                                11280001
112900         WHEN SQLCODE = ZERO                                      11290001
113000             CONTINUE                                             11300001
113100                                                                  11310001
113200         WHEN SQLCODE = +100                                      11320001
113300             SET PS-NOT-UPC-FOUND TO TRUE                         11330001
113400             MOVE 0                  TO XLV00002-UNT-COST-AMT     11340001
113500                                                                  11350001
113600         WHEN SQLWARN0 NOT = SPACE                                11360001
113700         WHEN SQLCODE  NOT = +0                                   11370001
113800                                                                  11380001
113900              MOVE SQLCODE              TO PV-DISP-SQLCODE        11390001
114000              MOVE XLV00002-INTR-UPC-ID TO PV-DISP-INTR-UPC-ID    11400001
114100                                                                  11410001
114200              MOVE '7252-COST-AND-RETAIL'                         11420001
114300                                       TO PV-ABEND-PARAGRAPH      11430001
114400              MOVE 'SELECT FROM XLV_SKU_STR'                      11440001
114500                                       TO PV-DB2-OPERATION        11450001
114600              MOVE PV-DISP-INTR-UPC-ID TO PV-DB2-MESSAGE-1        11460001
114700              MOVE ' '                 TO PV-DB2-MESSAGE-2        11470001
114800              MOVE ' '                 TO PV-DB2-MESSAGE-3        11480001
114900              MOVE ' '                 TO PV-DB2-MESSAGE-4        11490001
115000              MOVE 'XLV_SKU_STR'       TO PV-ABEND-TABLE-1        11500001
115010              MOVE ' '                 TO PV-ABEND-TABLE-2        11501001
115020              MOVE ' '                 TO PV-ABEND-TABLE-3        11502001
115030              MOVE ' '                 TO PV-ABEND-TABLE-4        11503001
115040              MOVE ' '                 TO PV-ABEND-TABLE-5        11504001
115050                                                                  11505001
115060              PERFORM 9900-DB2-ERROR                              11506001
115070     END-EVALUATE.                                                11507001
115080                                                                  11508001
115090                                                                  11509001
115100******************************************************************11510001
115200*                                                                 11520001
115210******************************************************************11521001
115220 7260-SELECT-TPURITM.                                             11522001
115230                                                                  11523001
115240     IF  PS-DISPLAY-PARA-YES                                      11524001
115250         DISPLAY ' SUKUT576 - 7260-SELECT-TPURITM           '     11525001
115260     END-IF.                                                      11526001
115270                                                                  11527001
115280     EXEC SQL                                                     11528001
115290          SELECT  AD_EVNT_DTE                                     11529001
115300               ,  UNT_RTL_PR_AMT                                  11530001
115400               ,  UNT_COST_AMT                                    11540001
115500            INTO :PV-AD-EVNT-DTE                                  11550001
115600               , :PURITM-UNT-RTL-PR-AMT                           11560001
115700               , :PURITM-UNT-COST-AMT                             11570001
115800            FROM  TPURITM                                         11580001
115900           WHERE  PO_NBR              = :SUT00028-TRN-NBR         11590001
116000             AND  APP_PO_LNE_NBR      = :SUT00028-TRN-LNE-NBR     11600001
116100             AND  VER_STATUS_CDE      = 'A'                       11610001
116200            WITH UR                                               11620001
116300     END-EXEC.                                                    11630001
116400                                                                  11640001
116500     EVALUATE TRUE                                                11650001
116600         WHEN SQLCODE = ZERO                                      11660001
116700              CONTINUE                                            11670001
116800                                                                  11680001
116900         WHEN SQLCODE = +100                                      11690001
117000              MOVE '0001-01-01' TO PV-AD-EVNT-DTE                 11700001
117100              MOVE 0   TO PURITM-UNT-RTL-PR-AMT                   11710001
117200                          PURITM-UNT-COST-AMT                     11720001
117300                                                                  11730001
117400         WHEN SQLWARN0 NOT = SPACE                                11740001
117500         WHEN SQLCODE  NOT = +0                                   11750001
117600                                                                  11760001
117700              MOVE SQLCODE              TO PV-DISP-SQLCODE        11770001
117800              MOVE SUT00028-TRN-NBR     TO PV-DISP-TRN-NBR        11780001
117900              MOVE SUT00028-TRN-LNE-NBR TO PV-DISP-LINE-NBR       11790001
118000                                                                  11800001
118100              MOVE '7260-SELECT-TPURITM'                          11810001
118200                                       TO PV-ABEND-PARAGRAPH      11820001
118210              MOVE 'READ TPURITM '     TO PV-DB2-OPERATION        11821001
118220              MOVE PV-DISP-TRN-NBR     TO PV-DB2-MESSAGE-1        11822001
118230              MOVE PV-DISP-LINE-NBR    TO PV-DB2-MESSAGE-2        11823001
118240              MOVE ' '                 TO PV-DB2-MESSAGE-3        11824001
118250              MOVE ' '                 TO PV-DB2-MESSAGE-4        11825001
118260              MOVE 'TPURITM'           TO PV-ABEND-TABLE-1        11826001
118270              MOVE ' '                 TO PV-ABEND-TABLE-2        11827001
118280              MOVE ' '                 TO PV-ABEND-TABLE-3        11828001
118290              MOVE ' '                 TO PV-ABEND-TABLE-4        11829001
118291              MOVE ' '                 TO PV-ABEND-TABLE-5        11829101
118292                                                                  11829201
118293              PERFORM 9900-DB2-ERROR                              11829301
118294     END-EVALUATE.                                                11829401
118295                                                                  11829501
118296                                                                  11829601
118297******************************************************************11829701
118298*                                                                 11829801
118299******************************************************************11829901
118300 7270-PRC-MSG-CDE.                                                11830001
118400                                                                  11840001
118500     IF  PS-DISPLAY-PARA-YES                                      11850001
118510         DISPLAY ' SUKUT576 - 7270-PRC-MSG-CDE              '     11851001
118520     END-IF.                                                      11852001
118530                                                                  11853001
118540     EXEC SQL                                                     11854001
118551         SELECT  PRC_MSG_CDE                                      11855101
118552           INTO :SUT00094-PRC-MSG-CDE                             11855201
118553           FROM  SUT_PRC_MSG_CNTL A                               11855301
118554          WHERE  SHIPT_UNT_ID        = :SUCRDV-SHIPT-UNT-ID       11855401
118555          FETCH FIRST 1 ROW ONLY                                  11855501
118556           WITH UR                                                11855601
118557     END-EXEC.                                                    11855701
118558                                                                  11855801
118559     EVALUATE TRUE                                                11855901
118560         WHEN SQLCODE = ZERO                                      11856001
118570         WHEN SQLCODE = -811                                      11857001
118580              CONTINUE                                            11858001
118590                                                                  11859001
118600         WHEN SQLCODE = +100                                      11860001
118700              MOVE SPACES       TO SUT00094-PRC-MSG-CDE           11870001
118800                                                                  11880001
118900         WHEN SQLWARN0 NOT = SPACE                                11890001
119000         WHEN SQLCODE  NOT = +0                                   11900001
119100                                                                  11910001
119200              MOVE SQLCODE              TO PV-DISP-SQLCODE        11920001
119300              MOVE SUCRDV-SHIPT-UNT-ID  TO PV-DISP-SSCC           11930001
119400                                                                  11940001
119500              MOVE '7270-PRC-MSG-CDE'  TO PV-ABEND-PARAGRAPH      11950001
119600              MOVE 'READ PROCESS MSG'  TO PV-DB2-OPERATION        11960001
119700              MOVE PV-DISP-SSCC        TO PV-DB2-MESSAGE-1        11970001
119800              MOVE ' '                 TO PV-DB2-MESSAGE-2        11980001
119900              MOVE ' '                 TO PV-DB2-MESSAGE-3        11990001
120000              MOVE ' '                 TO PV-DB2-MESSAGE-4        12000001
120100              MOVE 'SUT_PRC_MSG_CNTL'  TO PV-ABEND-TABLE-1        12010001
120200              MOVE ' '                 TO PV-ABEND-TABLE-2        12020001
120300              MOVE ' '                 TO PV-ABEND-TABLE-3        12030001
120400              MOVE ' '                 TO PV-ABEND-TABLE-4        12040001
120500              MOVE ' '                 TO PV-ABEND-TABLE-5        12050001
120600                                                                  12060001
120700              PERFORM 9900-DB2-ERROR                              12070001
120800     END-EVALUATE.                                                12080001
120900                                                                  12090001
121000                                                                  12100001
121100***************************************************************** 12110001
121110* STYLES WITH '0' BRND_ID ARE ACTUALLY NO BRAND ASSIGNED AND    * 12111001
121120* ARE GIVEN A DESCRIPTION OF 'UNKNOWN'                          * 12112004
121130* THEY WILL BE FOUND IN A SQLCODE OF 0 CONDITION                * 12113001
121140***************************************************************** 12114001
121150 7280-SELECT-BRAND-ID.                                            12115001
121160                                                                  12116001
121170     IF  PS-DISPLAY-PARA-YES                                      12117001
121180         DISPLAY ' SUKUT576 - 7280-SELECT-BRAND-ID          '     12118001
121190     END-IF.                                                      12119001
121200                                                                  12120001
121300     EXEC SQL                                                     12130001
121400          SELECT  B.BRND_ID                                       12140001
121500            INTO :XLT00004-BRND-ID                                12150005
121600            FROM  XLT_SKU      A                                  12160001
121700               ,  XLT_VND_STYL B                                  12170001
121900           WHERE  SKU_NBR           =  :XLT00003-SKU-NBR          12190001
122000             AND  A.STYL_ID         =  B.STYL_ID                  12200001
122200            WITH UR                                               12220001
123100     END-EXEC.                                                    12310000
123200                                                                  12320000
123300     EVALUATE TRUE                                                12330000
123400         WHEN SQLCODE = ZERO                                      12340000
123500         WHEN SQLCODE = -811                                      12350000
123600              CONTINUE                                            12360000
123610                                                                  12361000
123620         WHEN SQLCODE = +100                                      12362001
123630              MOVE 0          TO XLT00004-BRND-ID                 12363005
123640                                                                  12364001
123650         WHEN SQLWARN0 NOT = SPACE                                12365001
123660         WHEN SQLCODE  NOT = +0                                   12366001
123670                                                                  12367001
123680              MOVE SQLCODE              TO PV-DISP-SQLCODE        12368001
123690              MOVE XLT00003-SKU-NBR     TO PV-DISP-SKU            12369001
123700                                                                  12370001
123800              MOVE '7280-SELECT-BRAND-ID'                         12380001
123900                                       TO PV-ABEND-PARAGRAPH      12390001
124000              MOVE 'READ XLT00043'     TO PV-DB2-OPERATION        12400001
124100              MOVE PV-DISP-SKU         TO PV-DB2-MESSAGE-1        12410001
124200              MOVE ' '                 TO PV-DB2-MESSAGE-2        12420001
124300              MOVE ' '                 TO PV-DB2-MESSAGE-3        12430001
124400              MOVE ' '                 TO PV-DB2-MESSAGE-4        12440001
124500              MOVE 'XLT_SKU'           TO PV-ABEND-TABLE-1        12450001
124600              MOVE 'XLT_VND_STYL'      TO PV-ABEND-TABLE-2        12460001
124700              MOVE ' '                 TO PV-ABEND-TABLE-3        12470004
124710              MOVE ' '                 TO PV-ABEND-TABLE-4        12471001
124720              MOVE ' '                 TO PV-ABEND-TABLE-5        12472001
124730                                                                  12473001
124740              PERFORM 9900-DB2-ERROR                              12474001
124750     END-EVALUATE.                                                12475001
124760                                                                  12476001
124770                                                                  12477001
124780******************************************************************12478001
124790*                                                                 12479001
124800******************************************************************12480001
124900 7300-OPEN-AD-DATE-CURSOR.                                        12490001
125000                                                                  12500001
125010     IF  PS-DISPLAY-PARA-YES                                      12501001
125020         DISPLAY ' SUKUT576 - 7300-OPEN-AD-DATE-CURSOR      '     12502000
125030     END-IF.                                                      12503000
125040                                                                  12504001
125050     EXEC SQL                                                     12505001
125060         OPEN AD-DATE-CSR                                         12506001
125070     END-EXEC.                                                    12507001
125080                                                                  12508001
125090     EVALUATE TRUE                                                12509001
125100         WHEN SQLCODE = ZEROS                                     12510001
125200              SET PS-NOT-EOF-DATE-CSR TO TRUE                     12520001
125300                                                                  12530001
125400         WHEN OTHER                                               12540001
125500                                                                  12550001
125600              MOVE SQLCODE              TO PV-DISP-SQLCODE        12560001
125700              MOVE DK-TRIP-OCRNC-ID     TO PV-DISP-OCRNC-ID       12570001
125800                                                                  12580001
125900              MOVE '7300-OPEN-AD-DATE-CURSOR   '                  12590001
126000                                       TO PV-ABEND-PARAGRAPH      12600001
126100              MOVE 'OPEN AD-DATE-CSR'  TO PV-DB2-OPERATION        12610001
126200              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        12620001
126300              MOVE ' '                 TO PV-DB2-MESSAGE-2        12630001
126400              MOVE ' '                 TO PV-DB2-MESSAGE-3        12640001
126500              MOVE ' '                 TO PV-DB2-MESSAGE-4        12650001
126600              MOVE 'SUT_TRIP_DTL_SUM'  TO PV-ABEND-TABLE-1        12660001
126610              MOVE ' '                 TO PV-ABEND-TABLE-2        12661001
126620              MOVE ' '                 TO PV-ABEND-TABLE-3        12662001
126630              MOVE ' '                 TO PV-ABEND-TABLE-4        12663001
126640              MOVE ' '                 TO PV-ABEND-TABLE-5        12664001
126650                                                                  12665001
126660              PERFORM 9900-DB2-ERROR                              12666001
126670     END-EVALUATE.                                                12667001
126680                                                                  12668001
126690                                                                  12669001
126700******************************************************************12670001
126800*                                                                 12680001
126900******************************************************************12690001
127000 7400-FETCH-AD-DATE.                                              12700000
127010                                                                  12701000
127011     IF  PS-DISPLAY-PARA-YES                                      12701100
127012         DISPLAY ' SUKUT576 - 7400-FETCH-AD-DATE            '     12701201
127013     END-IF.                                                      12701301
127014                                                                  12701401
127015     EXEC SQL                                                     12701501
127016          FETCH AD-DATE-CSR                                       12701601
127017           INTO :SUT00095-BUS-AREA-ID                             12701701
127018              , :SUT00095-DEPT-NBR                                12701801
127019              , :SUT00095-MAJ-CL-NBR                              12701901
127020              , :SUT00095-AD-DTE                                  12702001
127030     END-EXEC.                                                    12703001
127040                                                                  12704001
127050     EVALUATE TRUE                                                12705001
127060         WHEN SQLCODE = ZERO                                      12706001
127070              CONTINUE                                            12707001
127080                                                                  12708001
127090         WHEN SQLCODE = +100                                      12709001
127100              SET PS-EOF-DATE-CSR TO TRUE                         12710001
127200                                                                  12720001
127300         WHEN SQLWARN0 NOT = SPACE                                12730001
127400         WHEN SQLCODE  NOT = +0                                   12740001
127500                                                                  12750001
127600              MOVE SQLCODE              TO PV-DISP-SQLCODE        12760001
127700              MOVE DK-TRIP-OCRNC-ID     TO PV-DISP-OCRNC-ID       12770001
127800                                                                  12780001
127900              MOVE '7400-FETCH-AD-DATE'                           12790001
128000                                       TO PV-ABEND-PARAGRAPH      12800001
128100              MOVE 'FETCH AD-DATE-CSR' TO PV-DB2-OPERATION        12810001
128200              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        12820001
128300              MOVE ' '                 TO PV-DB2-MESSAGE-2        12830001
128400              MOVE ' '                 TO PV-DB2-MESSAGE-3        12840001
128500              MOVE ' '                 TO PV-DB2-MESSAGE-4        12850001
128600              MOVE 'SUT_TRIP_DTL_SUM'  TO PV-ABEND-TABLE-1        12860001
128700              MOVE ' '                 TO PV-ABEND-TABLE-2        12870001
128800              MOVE ' '                 TO PV-ABEND-TABLE-3        12880001
128900              MOVE ' '                 TO PV-ABEND-TABLE-4        12890001
129000              MOVE ' '                 TO PV-ABEND-TABLE-5        12900001
129100                                                                  12910001
129200              PERFORM 9900-DB2-ERROR                              12920001
129300     END-EVALUATE.                                                12930001
129400                                                                  12940000
129410                                                                  12941000
129420******************************************************************12942000
129430*                                                                 12943000
129440******************************************************************12944000
129450 7500-CLOSE-AD-DATE.                                              12945001
129460                                                                  12946001
129470     IF  PS-DISPLAY-PARA-YES                                      12947001
129480         DISPLAY ' SUKUT576 - 7500-CLOSE-AD-DATE            '     12948001
129490     END-IF.                                                      12949001
129500                                                                  12950001
129600     EXEC SQL                                                     12960001
129700         CLOSE AD-DATE-CSR                                        12970001
129800     END-EXEC.                                                    12980001
129900                                                                  12990001
130000     EVALUATE TRUE                                                13000001
130100         WHEN SQLCODE = ZEROS                                     13010001
130200              CONTINUE                                            13020001
130300                                                                  13030001
130400         WHEN OTHER                                               13040001
130500                                                                  13050001
130600              MOVE SQLCODE              TO PV-DISP-SQLCODE        13060001
130700              MOVE DK-TRIP-OCRNC-ID     TO PV-DISP-OCRNC-ID       13070001
130800                                                                  13080001
130900              MOVE '7500-CLOSE-AD-DATE'                           13090001
131000                                       TO PV-ABEND-PARAGRAPH      13100001
131100              MOVE 'CLOSE AD-DATE-CSR' TO PV-DB2-OPERATION        13110001
131110              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        13111001
131120              MOVE ' '                 TO PV-DB2-MESSAGE-2        13112001
131130              MOVE ' '                 TO PV-DB2-MESSAGE-3        13113001
131140              MOVE ' '                 TO PV-DB2-MESSAGE-4        13114001
131150              MOVE 'SUT_TRIP_DTL_SUM'  TO PV-ABEND-TABLE-1        13115001
131160              MOVE ' '                 TO PV-ABEND-TABLE-2        13116001
131170              MOVE ' '                 TO PV-ABEND-TABLE-3        13117001
131180              MOVE ' '                 TO PV-ABEND-TABLE-4        13118001
131190              MOVE ' '                 TO PV-ABEND-TABLE-5        13119001
131191                                                                  13119101
131192              PERFORM 9900-DB2-ERROR                              13119201
131193     END-EVALUATE.                                                13119301
131194                                                                  13119401
131195                                                                  13119501
131196******************************************************************13119601
131197*                                                                 13119701
131198******************************************************************13119801
131199 7900-INSERT-SUT00095.                                            13119901
131200                                                                  13120001
131300     IF  PS-DISPLAY-PARA-YES                                      13130001
131400         MOVE  SUT00095-SHIPT-UNT-ID     TO  PV-DISP-SSCC         13140001
131500         MOVE  SUT00095-SKU-NBR          TO  PV-DISP-SKU          13150001
131600         DISPLAY ' SUKUT576 - 7900-INSERT-SUT00095          '     13160001
131610         DISPLAY ' SUKUT576 - '                                   13161001
131620                 PV-DISP-SSCC ' - '                               13162001
131621                 PV-DISP-SKU                                      13162101
131622     END-IF.                                                      13162201
131623                                                                  13162301
131624     EXEC SQL                                                     13162401
131625          INSERT                                                  13162501
131626            INTO SUT_TRIP_DTL_SUM                                 13162601
131627                 (TRIP_OCRNC_ID                                   13162701
131628               ,  SHIPT_UNT_ID                                    13162801
131629               ,  SKU_NBR                                         13162901
131630               ,  BUS_AREA_ID                                     13163001
131640               ,  DEPT_NBR                                        13164001
131650               ,  MAJ_CL_NBR                                      13165001
131660               ,  MDSE_LNE_CDE                                    13166001
131670               ,  HNG_FOLD_SEQ_NBR                                13167001
131680               ,  BRND_ID                                         13168001
131690               ,  EAS_TAG_IND                                     13169001
131700               ,  PRC_MSG_CDE                                     13170001
131800               ,  DIVERT_TMST                                     13180001
131900               ,  UNT_QTY                                         13190001
132000               ,  RTL_DOL_AMT                                     13200001
132100               ,  AD_DTE                                          13210001
132200               ,  COST_DOL_AMT                                    13220001
132300                 )                                                13230001
132400          VALUES (                                                13240001
132500                 :SUT00095-TRIP-OCRNC-ID                          13250001
132600               , :SUT00095-SHIPT-UNT-ID                           13260001
132700               , :SUT00095-SKU-NBR                                13270001
132800               , :SUT00095-BUS-AREA-ID                            13280001
132900               , :SUT00095-DEPT-NBR                               13290001
133000               , :SUT00095-MAJ-CL-NBR                             13300001
133100               , :SUT00095-MDSE-LNE-CDE                           13310001
133200               , :SUT00095-HNG-FOLD-SEQ-NBR                       13320001
133300               , :SUT00095-BRND-ID                                13330001
133400               , :SUT00095-EAS-TAG-IND                            13340001
133500               , :SUT00095-PRC-MSG-CDE                            13350001
133600               , :SUT00095-DIVERT-TMST                            13360001
133700               , :SUT00095-UNT-QTY                                13370001
133800               , :SUT00095-RTL-DOL-AMT                            13380001
133900               , :SUT00095-AD-DTE                                 13390001
134000               , :SUT00095-COST-DOL-AMT                           13400001
134100                 )                                                13410001
134200     END-EXEC.                                                    13420001
134300                                                                  13430001
134400     EVALUATE TRUE                                                13440001
134500         WHEN SQLCODE = +0                                        13450001
134600              CONTINUE                                            13460001
134700                                                                  13470001
134800         WHEN SQLCODE = -803                                      13480001
134900              PERFORM 7930-PROCESS-UPDATE                         13490001
135000                                                                  13500001
135100         WHEN SQLWARN0 NOT = SPACES                               13510001
135200         WHEN SQLCODE < +0                                        13520001
135300         WHEN SQLCODE > +0                                        13530001
135400                                                                  13540001
135500              MOVE SQLCODE               TO PV-DISP-SQLCODE       13550001
135600              MOVE DK-TRIP-OCRNC-ID      TO PV-DISP-OCRNC-ID      13560001
135700              MOVE SUT00095-SHIPT-UNT-ID TO PV-DISP-SSCC          13570001
135800              MOVE SUT00095-SKU-NBR      TO PV-DISP-SKU           13580001
135900              MOVE SUT00095-BUS-AREA-ID  TO PV-DISP-BUS-AREA      13590001
136000                                                                  13600001
136100              MOVE '7900-INSERT-SUT00095'                         13610001
136200                                       TO PV-ABEND-PARAGRAPH      13620001
136300              MOVE 'INSERT SUT_TRIP_DTL_SUM'                      13630001
136400                                       TO PV-DB2-OPERATION        13640001
136500              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        13650001
136600              MOVE PV-DISP-SSCC        TO PV-DB2-MESSAGE-2        13660001
136700              MOVE PV-DISP-SKU         TO PV-DB2-MESSAGE-3        13670001
136800              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-4        13680001
136900              MOVE 'SUT_TRIP_DTL_SUM'  TO PV-ABEND-TABLE-1        13690001
137000              MOVE ' '                 TO PV-ABEND-TABLE-2        13700001
137100              MOVE ' '                 TO PV-ABEND-TABLE-3        13710001
137200              MOVE ' '                 TO PV-ABEND-TABLE-4        13720001
137210              MOVE ' '                 TO PV-ABEND-TABLE-5        13721001
137220                                                                  13722001
137230              PERFORM 9900-DB2-ERROR                              13723001
137240     END-EVALUATE.                                                13724001
137250                                                                  13725001
137260                                                                  13726001
137270******************************************************************13727001
137280*                                                                 13728001
137290******************************************************************13729001
137300 7930-PROCESS-UPDATE.                                             13730001
137400                                                                  13740001
137500     IF  PS-DISPLAY-PARA-YES                                      13750001
137501         DISPLAY ' SUKUT576 - 7930-PROCESS-UPDATE           '     13750101
137502     END-IF.                                                      13750201
137503                                                                  13750301
137504     PERFORM 7950-SELECT-DETAIL-SUM.                              13750401
137505                                                                  13750501
137506     ADD PV-UNT-QTY       TO SUT00095-UNT-QTY.                    13750601
137507     ADD PV-RTL-DOL-AMT   TO SUT00095-RTL-DOL-AMT.                13750701
137508     ADD PV-COST-DOL-AMT  TO SUT00095-COST-DOL-AMT.               13750801
137509                                                                  13750901
137510     PERFORM 7970-UPDATE-DETAIL-SUM.                              13751001
137520                                                                  13752001
137530                                                                  13753001
137540******************************************************************13754001
137550*                                                                 13755001
137560******************************************************************13756001
137570 7950-SELECT-DETAIL-SUM.                                          13757001
137580                                                                  13758001
137590     IF  PS-DISPLAY-PARA-YES                                      13759001
137600         DISPLAY ' SUKUT576 - 7950-SELECT-DETAIL-SUM        '     13760001
137700     END-IF.                                                      13770001
137800                                                                  13780001
137900     EXEC SQL                                                     13790001
138000         SELECT  UNT_QTY                                          13800001
138100              ,  RTL_DOL_AMT                                      13810001
138200              ,  COST_DOL_AMT                                     13820001
138300           INTO :PV-UNT-QTY                                       13830001
138400              , :PV-RTL-DOL-AMT                                   13840001
138500              , :PV-COST-DOL-AMT                                  13850001
138600           FROM SUT_TRIP_DTL_SUM                                  13860001
138700          WHERE  TRIP_OCRNC_ID     = :SUT00095-TRIP-OCRNC-ID      13870001
138800            AND  SHIPT_UNT_ID      = :SUT00095-SHIPT-UNT-ID       13880001
138900            AND  SKU_NBR           = :SUT00095-SKU-NBR            13890001
139000           WITH UR                                                13900001
139100     END-EXEC.                                                    13910001
139200                                                                  13920001
139300     EVALUATE TRUE                                                13930001
139400         WHEN SQLCODE = ZERO                                      13940001
139500              CONTINUE                                            13950001
139600                                                                  13960001
139700         WHEN SQLWARN0 NOT = SPACE                                13970001
139800         WHEN SQLCODE  NOT = +0                                   13980001
139900                                                                  13990001
140000              MOVE SQLCODE                TO PV-DISP-SQLCODE      14000001
140100              MOVE SUT00095-TRIP-OCRNC-ID TO PV-DISP-OCRNC-ID     14010001
140200              MOVE SUT00095-SHIPT-UNT-ID  TO PV-DISP-SSCC         14020001
140300              MOVE SUT00095-SKU-NBR       TO PV-DISP-SKU          14030001
140400                                                                  14040001
140500              MOVE '7950-SELECT-DETAIL-SUM '                      14050001
140600                                       TO PV-ABEND-PARAGRAPH      14060001
140700              MOVE 'SELECT SUT00095'   TO PV-DB2-OPERATION        14070001
140800              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        14080001
140900              MOVE PV-DISP-SSCC        TO PV-DB2-MESSAGE-2        14090001
141000              MOVE PV-DISP-SKU         TO PV-DB2-MESSAGE-3        14100001
141100              MOVE ' '                 TO PV-DB2-MESSAGE-4        14110001
141110              MOVE 'SUT_TRIP_DTL_SUM'  TO PV-ABEND-TABLE-1        14111001
141120              MOVE ' '                 TO PV-ABEND-TABLE-2        14112001
141130              MOVE ' '                 TO PV-ABEND-TABLE-3        14113001
141140              MOVE ' '                 TO PV-ABEND-TABLE-4        14114001
141150              MOVE ' '                 TO PV-ABEND-TABLE-5        14115001
141160                                                                  14116001
141170              PERFORM 9900-DB2-ERROR                              14117001
141180     END-EVALUATE.                                                14118001
141190                                                                  14119001
141200                                                                  14120001
141300******************************************************************14130001
141400*                                                                 14140001
141410******************************************************************14141001
141420 7970-UPDATE-DETAIL-SUM.                                          14142001
141430                                                                  14143001
141440     IF  PS-DISPLAY-PARA-YES                                      14144001
141450         DISPLAY ' SUKUT576 - 7970-UPDATE-DETAIL-SUM        '     14145001
141460     END-IF.                                                      14146001
141470                                                                  14147001
141480     EXEC SQL                                                     14148001
141490          UPDATE SUT_TRIP_DTL_SUM                                 14149001
141500             SET UNT_QTY            = :SUT00095-UNT-QTY           14150001
141600               , RTL_DOL_AMT        = :SUT00095-RTL-DOL-AMT       14160001
141700               , COST_DOL_AMT       = :SUT00095-COST-DOL-AMT      14170001
141800           WHERE TRIP_OCRNC_ID      = :SUT00095-TRIP-OCRNC-ID     14180001
141900             AND SHIPT_UNT_ID       = :SUT00095-SHIPT-UNT-ID      14190001
142000             AND SKU_NBR            = :SUT00095-SKU-NBR           14200001
142100     END-EXEC.                                                    14210001
142200                                                                  14220001
142300     EVALUATE TRUE                                                14230001
142400         WHEN SQLCODE = ZERO                                      14240001
142500              CONTINUE                                            14250001
142600                                                                  14260001
142700         WHEN SQLWARN0 NOT = SPACE                                14270001
142800         WHEN SQLCODE  NOT = +0                                   14280001
142900                                                                  14290001
143000              MOVE SQLCODE                TO PV-DISP-SQLCODE      14300001
143100              MOVE SUT00095-TRIP-OCRNC-ID TO PV-DISP-OCRNC-ID     14310001
143200              MOVE SUT00095-SHIPT-UNT-ID  TO PV-DISP-SSCC         14320001
143300              MOVE SUT00095-SKU-NBR       TO PV-DISP-SKU          14330001
143400                                                                  14340001
143500              MOVE '7970-UPDATE-DETAIL-SUM '                      14350001
143600                                       TO PV-ABEND-PARAGRAPH      14360001
143700              MOVE 'UPDATE SUT00095'   TO PV-DB2-OPERATION        14370001
143800              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        14380001
143900              MOVE PV-DISP-SSCC        TO PV-DB2-MESSAGE-2        14390001
144000              MOVE PV-DISP-SKU         TO PV-DB2-MESSAGE-3        14400001
144100              MOVE ' '                 TO PV-DB2-MESSAGE-4        14410001
144110              MOVE 'SUT_TRIP_DTL_SUM'  TO PV-ABEND-TABLE-1        14411001
144120              MOVE ' '                 TO PV-ABEND-TABLE-2        14412001
144130              MOVE ' '                 TO PV-ABEND-TABLE-3        14413001
144140              MOVE ' '                 TO PV-ABEND-TABLE-4        14414001
144150              MOVE ' '                 TO PV-ABEND-TABLE-5        14415001
144160                                                                  14416001
144170              PERFORM 9900-DB2-ERROR                              14417001
144180     END-EVALUATE.                                                14418001
144190                                                                  14419001
144200                                                                  14420001
144300**************************************************************    14430001
144400* INSERT ROW INTO SUT_TRIP_WRKR_AUD TO SHOW WHO REQUESTED A  *    14440001
144500* TRAILER SUMMARIZATION                                      *    14450001
144600* 7/25/13                                                    *    14460001
144700**************************************************************    14470001
144800 7990-INSERT-WRKR-AUD.                                            14480001
144900                                                                  14490001
144910     IF  PS-DISPLAY-PARA-YES                                      14491001
144920         DISPLAY ' SUKUT576 - 7990-INSERT-WRKR-AUD          '     14492000
144930     END-IF.                                                      14493000
144940                                                                  14494001
144950     MOVE  PC047-OTBND-TRIP-ID  TO  SUT00006-OTBND-TRIP-ID.       14495001
144960     MOVE  PV-USERID            TO  SUT00006-USR-ID.              14496001
144970                                                                  14497001
144980     EXEC SQL                                                     14498001
144990          INSERT                                                  14499001
145000            INTO SUT_TRIP_WRKR_AUD                                14500001
145100                 (                                                14510001
145200                   OTBND_TRIP_ID                                  14520001
145300                  ,USR_ID                                         14530001
145400                  ,CRE_TMST                                       14540001
145500                  ,CRE_BY_PGM_NM                                  14550001
145600                 )                                                14560001
145700          VALUES (                                                14570001
145800                   :SUT00006-OTBND-TRIP-ID                        14580001
145900                  ,:SUT00006-USR-ID                               14590001
146000                  , CURRENT TIMESTAMP                             14600001
146100                  ,'SUKUT576'                                     14610001
146200                 )                                                14620001
146300     END-EXEC.                                                    14630001
146400                                                                  14640001
146500     EVALUATE TRUE                                                14650001
146600         WHEN SQLCODE = +0                                        14660001
146700              CONTINUE                                            14670001
146800                                                                  14680001
146900         WHEN SQLWARN0 NOT = SPACES                               14690001
147000         WHEN SQLCODE < +0                                        14700001
147100         WHEN SQLCODE > +0                                        14710001
147200                                                                  14720001
147300              MOVE SQLCODE                TO PV-DISP-SQLCODE      14730001
147400              MOVE SUT00006-OTBND-TRIP-ID TO PV-DISP-TRIP         14740001
147500              MOVE SUT00006-USR-ID        TO PV-DISP-USR-ID       14750001
147600                                                                  14760001
147700              MOVE '7990-INSERT-WRKR-AUD          '               14770001
147800                                       TO PV-ABEND-PARAGRAPH      14780001
147900             MOVE 'INSERT SUT_TRIP_WRKR_AUD'                      14790001
148000                                       TO PV-DB2-OPERATION        14800001
148100              MOVE PV-DISP-TRIP        TO PV-DB2-MESSAGE-1        14810001
148200              MOVE PV-DISP-USR-ID      TO PV-DB2-MESSAGE-2        14820001
148300              MOVE ' '                 TO PV-DB2-MESSAGE-3        14830001
148310              MOVE ' '                 TO PV-DB2-MESSAGE-4        14831001
148320              MOVE 'SUT_TRIP_WRKR_AUD' TO PV-ABEND-TABLE-1        14832001
148330              MOVE ' '                 TO PV-ABEND-TABLE-2        14833001
148340              MOVE ' '                 TO PV-ABEND-TABLE-3        14834001
148350              MOVE ' '                 TO PV-ABEND-TABLE-4        14835001
148360              MOVE ' '                 TO PV-ABEND-TABLE-5        14836001
148370                                                                  14837001
148380              PERFORM 9900-DB2-ERROR                              14838001
148390     END-EVALUATE.                                                14839001
148400                                                                  14840001
148500                                                                  14850001
148600******************************************************************14860001
148610*                                                                 14861001
148620******************************************************************14862001
148630 8000-OPEN-SKU-QTY-CLASS-CURSOR.                                  14863001
148640                                                                  14864001
148650     IF  PS-DISPLAY-PARA-YES                                      14865001
148660         DISPLAY ' SUKUT576 - 8000-OPEN-SKU-QTY-CLASS-CURSOR'     14866001
148670     END-IF.                                                      14867001
148680                                                                  14868001
148690     EXEC SQL                                                     14869001
148700         OPEN UNT-DOL-CLASS-CSR                                   14870001
148800     END-EXEC.                                                    14880001
148900                                                                  14890001
149000     EVALUATE TRUE                                                14900001
149100         WHEN SQLCODE = ZEROS                                     14910001
149200              SET PS-NOT-EOF-UNT-DOL-CLASS-CSR TO TRUE            14920001
149300                                                                  14930001
149400         WHEN OTHER                                               14940001
149500                                                                  14950001
149600              MOVE SQLCODE             TO PV-DISP-SQLCODE         14960001
149700              MOVE DK-TRIP-OCRNC-ID    TO PV-DISP-OCRNC-ID        14970001
149800                                                                  14980001
149900              MOVE '8000-OPEN-SKU-QTY-CLASS-CURSOR'               14990001
150000                                       TO PV-ABEND-PARAGRAPH      15000001
150100              MOVE 'OPEN UNT-DOL-CLASS-CSR'                       15010001
150200                                       TO PV-DB2-OPERATION        15020001
150300              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        15030001
150310              MOVE ' '                 TO PV-DB2-MESSAGE-2        15031001
150320              MOVE ' '                 TO PV-DB2-MESSAGE-3        15032001
150330              MOVE ' '                 TO PV-DB2-MESSAGE-4        15033001
150340              MOVE 'SUT_TRIP_DTL_SUM ' TO PV-ABEND-TABLE-1        15034001
150350              MOVE ' '                 TO PV-ABEND-TABLE-2        15035001
150360              MOVE ' '                 TO PV-ABEND-TABLE-3        15036001
150370              MOVE ' '                 TO PV-ABEND-TABLE-4        15037001
150380              MOVE ' '                 TO PV-ABEND-TABLE-5        15038001
150390                                                                  15039001
150400              PERFORM 9900-DB2-ERROR                              15040001
150410     END-EVALUATE.                                                15041000
150420                                                                  15042001
150430                                                                  15043001
150440******************************************************************15044001
150450*                                                                 15045001
150460******************************************************************15046001
150470 8030-FETCH-SKU-QTY-CLASS-CSR.                                    15047001
150480                                                                  15048001
150490     IF  PS-DISPLAY-PARA-YES                                      15049001
150500         DISPLAY ' SUKUT576 - 8030-FETCH-SKU-QTY-CLASS-CSR  '     15050001
150600     END-IF.                                                      15060001
150610                                                                  15061001
150620     EXEC SQL                                                     15062001
150630          FETCH  UNT-DOL-CLASS-CSR                                15063001
150640           INTO :SUT00095-BUS-AREA-ID                             15064001
150650              , :SUT00095-DEPT-NBR                                15065001
150660              , :SUT00095-MAJ-CL-NBR                              15066001
150670              , :PV-UNIT-QTY-SUM                                  15067001
150680              , :PV-RETAIL-SUM                                    15068001
150690              , :PV-COST-SUM                                      15069001
150700     END-EXEC.                                                    15070001
150800                                                                  15080001
150900     EVALUATE TRUE                                                15090001
151000         WHEN SQLCODE = ZERO                                      15100001
151100              CONTINUE                                            15110001
151200                                                                  15120001
151300         WHEN SQLCODE = +100                                      15130001
151400              SET PS-EOF-UNT-DOL-CLASS-CSR TO TRUE                15140001
151500                                                                  15150001
151600         WHEN SQLWARN0 NOT = SPACE                                15160001
151700         WHEN SQLCODE  NOT = +0                                   15170001
151800                                                                  15180001
151900              MOVE SQLCODE             TO PV-DISP-SQLCODE         15190001
152000              MOVE DK-TRIP-OCRNC-ID    TO PV-DISP-OCRNC-ID        15200001
152100                                                                  15210001
152200              MOVE '8030-FETCH-SKU-QTY-CLASS-CSR'                 15220001
152300                                       TO PV-ABEND-PARAGRAPH      15230001
152400              MOVE 'FETCH UNT-DOL-CLASS-CSR'                      15240001
152500                                       TO PV-DB2-OPERATION        15250001
152600              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        15260001
152700              MOVE ' '                 TO PV-DB2-MESSAGE-2        15270001
152800              MOVE ' '                 TO PV-DB2-MESSAGE-3        15280001
152900              MOVE ' '                 TO PV-DB2-MESSAGE-4        15290001
152910              MOVE 'SUT_TRIP_DTL_SUM ' TO PV-ABEND-TABLE-1        15291001
152920              MOVE ' '                 TO PV-ABEND-TABLE-2        15292001
152930              MOVE ' '                 TO PV-ABEND-TABLE-3        15293001
152940              MOVE ' '                 TO PV-ABEND-TABLE-4        15294001
152950              MOVE ' '                 TO PV-ABEND-TABLE-5        15295001
152960                                                                  15296001
152970              PERFORM 9900-DB2-ERROR                              15297001
152980     END-EVALUATE.                                                15298001
152990                                                                  15299001
153000                                                                  15300001
153100******************************************************************15310001
153110*                                                                 15311001
153120******************************************************************15312001
153130 8060-CLOSE-SKU-QTY-CLASS-CSR.                                    15313001
153140                                                                  15314001
153150     IF  PS-DISPLAY-PARA-YES                                      15315001
153160         DISPLAY ' SUKUT576 - 8060-CLOSE-SKU-QTY-CLASS-CSR  '     15316001
153170     END-IF.                                                      15317001
153180                                                                  15318001
153190     EXEC SQL                                                     15319001
153200         CLOSE UNT-DOL-CLASS-CSR                                  15320001
153300     END-EXEC.                                                    15330001
153400                                                                  15340001
153500     EVALUATE TRUE                                                15350001
153600         WHEN SQLCODE = ZEROS                                     15360001
153700              CONTINUE                                            15370001
153800                                                                  15380001
153900         WHEN OTHER                                               15390001
154000                                                                  15400001
154100              MOVE SQLCODE             TO PV-DISP-SQLCODE         15410001
154200              MOVE DK-TRIP-OCRNC-ID    TO PV-DISP-OCRNC-ID        15420001
154300                                                                  15430001
154400              MOVE '8060-CLOSE-SKU-QTY-CLASS-CURSOR'              15440001
154500                                       TO PV-ABEND-PARAGRAPH      15450001
154600              MOVE 'CLOSE UNT-DOL-CLASS-CSR'                      15460001
154700                                       TO PV-DB2-OPERATION        15470001
154800              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        15480001
154810              MOVE ' '                 TO PV-DB2-MESSAGE-2        15481001
154820              MOVE ' '                 TO PV-DB2-MESSAGE-3        15482001
154830              MOVE ' '                 TO PV-DB2-MESSAGE-4        15483001
154840              MOVE 'SUT_TRIP_DTL_SUM ' TO PV-ABEND-TABLE-1        15484001
154850              MOVE ' '                 TO PV-ABEND-TABLE-2        15485001
154860              MOVE ' '                 TO PV-ABEND-TABLE-3        15486001
154870              MOVE ' '                 TO PV-ABEND-TABLE-4        15487001
154880              MOVE ' '                 TO PV-ABEND-TABLE-5        15488001
154890                                                                  15489001
154900              PERFORM 9900-DB2-ERROR                              15490001
154910     END-EVALUATE.                                                15491000
154920                                                                  15492001
154930                                                                  15493001
154940******************************************************************15494001
154950*                                                                 15495001
154960******************************************************************15496001
154970 8101-OPEN-SKU-QTY-BRND-CURSOR.                                   15497001
154980                                                                  15498001
154990     IF  PS-DISPLAY-PARA-YES                                      15499001
155000         DISPLAY ' SUKUT576 - 8101-OPEN-SKU-QTY-BRND-CURSOR '     15500001
155100     END-IF.                                                      15510001
155200                                                                  15520000
155300     EXEC SQL                                                     15530000
155400         OPEN UNT-DOL-BRND-CSR                                    15540000
155500     END-EXEC.                                                    15550000
155600                                                                  15560000
155700     EVALUATE TRUE                                                15570000
155800         WHEN SQLCODE = ZEROS                                     15580000
155900              SET PS-NOT-EOF-UNT-DOL-MDSE-CSR TO TRUE             15590000
156000                                                                  15600000
156100         WHEN OTHER                                               15610000
156200                                                                  15620001
156300              MOVE SQLCODE             TO PV-DISP-SQLCODE         15630001
156400              MOVE DK-TRIP-OCRNC-ID    TO PV-DISP-OCRNC-ID        15640001
156500                                                                  15650001
156600              MOVE '8101-OPEN-SKU-QTY-BRND-CURSOR'                15660001
156700                                       TO PV-ABEND-PARAGRAPH      15670001
156710              MOVE 'OPEN UNT-DOL-BRND-CSR'                        15671001
156720                                       TO PV-DB2-OPERATION        15672001
156730              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        15673001
156740              MOVE ' '                 TO PV-DB2-MESSAGE-2        15674001
156750              MOVE ' '                 TO PV-DB2-MESSAGE-3        15675001
156760              MOVE ' '                 TO PV-DB2-MESSAGE-4        15676001
156770              MOVE 'SUT_TRIP_DTL_SUM ' TO PV-ABEND-TABLE-1        15677001
156780              MOVE ' '                 TO PV-ABEND-TABLE-2        15678001
156790              MOVE ' '                 TO PV-ABEND-TABLE-3        15679001
156791              MOVE ' '                 TO PV-ABEND-TABLE-4        15679101
156792              MOVE ' '                 TO PV-ABEND-TABLE-5        15679201
156793                                                                  15679301
156794              PERFORM 9900-DB2-ERROR                              15679401
156795     END-EVALUATE.                                                15679501
156796                                                                  15679601
156797                                                                  15679701
156798******************************************************************15679801
156799*                                                                 15679901
156800******************************************************************15680001
156900 8131-FETCH-SKU-QTY-BRND-CSR.                                     15690001
157000                                                                  15700001
157100     IF  PS-DISPLAY-PARA-YES                                      15710001
157110         DISPLAY ' SUKUT576 - 8131-FETCH-SKU-QTY-BRND-CSR   '     15711001
157120     END-IF.                                                      15712001
157130                                                                  15713001
157140     EXEC SQL                                                     15714001
157150         FETCH  UNT-DOL-BRND-CSR                                  15715001
157160          INTO :SUT00095-BUS-AREA-ID                              15716001
157170             , :SUT00095-BRND-ID                                  15717001
157180             , :PV-UNIT-QTY-SUM                                   15718001
157190             , :PV-RETAIL-SUM                                     15719001
157200             , :PV-COST-SUM                                       15720001
157300     END-EXEC.                                                    15730001
157400                                                                  15740001
157500     EVALUATE TRUE                                                15750001
157600         WHEN SQLCODE = ZERO                                      15760001
157700              CONTINUE                                            15770001
157800                                                                  15780001
157900         WHEN SQLCODE = +100                                      15790001
158000              SET PS-EOF-UNT-DOL-MDSE-CSR TO TRUE                 15800001
158100                                                                  15810001
158200         WHEN SQLWARN0 NOT = SPACE                                15820001
158300         WHEN SQLCODE  NOT = +0                                   15830001
158400                                                                  15840001
158500              MOVE SQLCODE             TO PV-DISP-SQLCODE         15850001
158600              MOVE DK-TRIP-OCRNC-ID    TO PV-DISP-OCRNC-ID        15860001
158700                                                                  15870001
158800              MOVE '8131-FETCH-SKU-QTY-BRND-CSR'                  15880001
158900                                       TO PV-ABEND-PARAGRAPH      15890001
159000              MOVE 'FETCH UNT-DOL-BRND-CSR'                       15900001
159100                                       TO PV-DB2-OPERATION        15910001
159200              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        15920001
159300              MOVE ' '                 TO PV-DB2-MESSAGE-2        15930001
159310              MOVE ' '                 TO PV-DB2-MESSAGE-3        15931001
159320              MOVE ' '                 TO PV-DB2-MESSAGE-4        15932001
159330              MOVE 'SUT_TRIP_DTL_SUM ' TO PV-ABEND-TABLE-1        15933001
159340              MOVE ' '                 TO PV-ABEND-TABLE-2        15934001
159350              MOVE ' '                 TO PV-ABEND-TABLE-3        15935001
159360              MOVE ' '                 TO PV-ABEND-TABLE-4        15936001
159370              MOVE ' '                 TO PV-ABEND-TABLE-5        15937001
159380                                                                  15938001
159390              PERFORM 9900-DB2-ERROR                              15939001
159400     END-EVALUATE.                                                15940001
159500                                                                  15950000
159600                                                                  15960000
159610******************************************************************15961000
159620*                                                                 15962000
159630******************************************************************15963000
159640 8161-CLOSE-SKU-QTY-BRND-CSR.                                     15964001
159650                                                                  15965001
159660     IF  PS-DISPLAY-PARA-YES                                      15966001
159670         DISPLAY ' SUKUT576 - 8161-CLOSE-SKU-QTY-BRND-CSR   '     15967001
159680     END-IF.                                                      15968001
159690                                                                  15969001
159700     EXEC SQL                                                     15970001
159800         CLOSE UNT-DOL-BRND-CSR                                   15980001
159900     END-EXEC.                                                    15990001
160000                                                                  16000001
160100     EVALUATE TRUE                                                16010001
160200         WHEN SQLCODE = ZEROS                                     16020001
160300              CONTINUE                                            16030001
160400                                                                  16040001
160500         WHEN OTHER                                               16050001
160600                                                                  16060001
160700              MOVE SQLCODE             TO PV-DISP-SQLCODE         16070001
160800              MOVE DK-TRIP-OCRNC-ID    TO PV-DISP-OCRNC-ID        16080001
160900                                                                  16090001
161000              MOVE '8161-CLOSE-SKU-QTY-BRND-CURSOR'               16100001
161100                                       TO PV-ABEND-PARAGRAPH      16110001
161200              MOVE 'CLOSE UNT-DOL-BRND-CSR'                       16120001
161300                                       TO PV-DB2-OPERATION        16130001
161400              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        16140001
161410              MOVE ' '                 TO PV-DB2-MESSAGE-2        16141001
161420              MOVE ' '                 TO PV-DB2-MESSAGE-3        16142001
161430              MOVE ' '                 TO PV-DB2-MESSAGE-4        16143001
161440              MOVE 'SUT_TRIP_DTL_SUM ' TO PV-ABEND-TABLE-1        16144001
161450              MOVE ' '                 TO PV-ABEND-TABLE-2        16145001
161460              MOVE ' '                 TO PV-ABEND-TABLE-3        16146001
161470              MOVE ' '                 TO PV-ABEND-TABLE-4        16147001
161480              MOVE ' '                 TO PV-ABEND-TABLE-5        16148001
161490                                                                  16149001
161500              PERFORM 9900-DB2-ERROR                              16150001
161510     END-EVALUATE.                                                16151000
161520                                                                  16152001
161530                                                                  16153001
161540******************************************************************16154001
161550*                                                                 16155001
161560******************************************************************16156001
161570 8200-SELECT-SKU-CNT-CLASS.                                       16157001
161580                                                                  16158001
161590     IF  PS-DISPLAY-PARA-YES                                      16159001
161600         DISPLAY ' SUKUT576 - 8200-SELECT-SKU-CNT-CLASS     '     16160001
161700     END-IF.                                                      16170001
161800                                                                  16180001
161900     EXEC SQL                                                     16190001
162000          SELECT  COUNT(DISTINCT SKU_NBR)                         16200001
162100            INTO :PV-SKU-COUNT                                    16210001
162200            FROM SUT_TRIP_DTL_SUM                                 16220001
162300           WHERE TRIP_OCRNC_ID     = :DK-TRIP-OCRNC-ID            16230001
162400             AND BUS_AREA_ID       = :SUT00095-BUS-AREA-ID        16240001
162500             AND DEPT_NBR          = :SUT00095-DEPT-NBR           16250001
162600             AND MAJ_CL_NBR        = :SUT00095-MAJ-CL-NBR         16260001
162700            WITH UR                                               16270001
162800     END-EXEC.                                                    16280001
162900                                                                  16290001
163000     EVALUATE TRUE                                                16300001
163100         WHEN SQLCODE = ZERO                                      16310001
163200              CONTINUE                                            16320001
163300                                                                  16330001
163400         WHEN SQLWARN0 NOT = SPACE                                16340001
163500         WHEN SQLCODE  NOT = +0                                   16350001
163600                                                                  16360001
163700              MOVE SQLCODE              TO PV-DISP-SQLCODE        16370001
163800              MOVE DK-TRIP-OCRNC-ID     TO PV-DISP-OCRNC-ID       16380001
163900              MOVE SUT00095-BUS-AREA-ID TO PV-DISP-BUS-AREA       16390001
164000              MOVE SUT00095-DEPT-NBR    TO PV-DISP-DEPT           16400001
164100              MOVE SUT00095-MAJ-CL-NBR  TO PV-DISP-MAJ-CL         16410001
164200                                                                  16420001
164210              MOVE '8200-SELECT-SKU-CNT-CLASS'                    16421001
164220                                       TO PV-ABEND-PARAGRAPH      16422001
164230              MOVE 'READ SUT00095'     TO PV-DB2-OPERATION        16423001
164240              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        16424001
164250              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-2        16425001
164260              MOVE PV-DISP-DEPT        TO PV-DB2-MESSAGE-3        16426001
164270              MOVE PV-DISP-MAJ-CL      TO PV-DB2-MESSAGE-4        16427001
164280              MOVE 'SUT_TRIP_DTL_SUM ' TO PV-ABEND-TABLE-1        16428001
164290              MOVE ' '                 TO PV-ABEND-TABLE-2        16429001
164291              MOVE ' '                 TO PV-ABEND-TABLE-3        16429101
164292              MOVE ' '                 TO PV-ABEND-TABLE-4        16429201
164293              MOVE ' '                 TO PV-ABEND-TABLE-5        16429301
164294                                                                  16429401
164295              PERFORM 9900-DB2-ERROR                              16429501
164296     END-EVALUATE.                                                16429601
164297                                                                  16429701
164298                                                                  16429801
164299******************************************************************16429901
164300*                                                                 16430001
164400******************************************************************16440001
164500 8250-SELECT-CARTON-CNT-CLASS.                                    16450000
164510                                                                  16451000
164511     IF  PS-DISPLAY-PARA-YES                                      16451100
164512         DISPLAY ' SUKUT576 - 8250-SELECT-CARTON-CNT-CLASS  '     16451201
164513     END-IF.                                                      16451301
164514                                                                  16451401
164515     EXEC SQL                                                     16451501
164516          SELECT  COUNT(DISTINCT SHIPT_UNT_ID)                    16451601
164517            INTO :PV-CARTON-COUNT                                 16451701
164518            FROM SUT_TRIP_DTL_SUM                                 16451801
164519           WHERE TRIP_OCRNC_ID     = :DK-TRIP-OCRNC-ID            16451901
164520             AND BUS_AREA_ID       = :SUT00095-BUS-AREA-ID        16452001
164530             AND DEPT_NBR          = :SUT00095-DEPT-NBR           16453001
164540             AND MAJ_CL_NBR        = :SUT00095-MAJ-CL-NBR         16454001
164550            WITH UR                                               16455001
164560     END-EXEC.                                                    16456001
164570                                                                  16457001
164580     EVALUATE TRUE                                                16458001
164590         WHEN SQLCODE = ZERO                                      16459001
164600              CONTINUE                                            16460001
164700                                                                  16470001
164800         WHEN SQLWARN0 NOT = SPACE                                16480001
164900         WHEN SQLCODE  NOT = +0                                   16490001
165000                                                                  16500001
165100              MOVE SQLCODE              TO PV-DISP-SQLCODE        16510001
165200              MOVE DK-TRIP-OCRNC-ID     TO PV-DISP-OCRNC-ID       16520001
165300              MOVE SUT00095-BUS-AREA-ID TO PV-DISP-BUS-AREA       16530001
165400              MOVE SUT00095-DEPT-NBR    TO PV-DISP-DEPT           16540001
165500              MOVE SUT00095-MAJ-CL-NBR  TO PV-DISP-MAJ-CL         16550001
165600                                                                  16560001
165700              MOVE '8250-SELECT-CARTON-CNT-CLASS'                 16570001
165800                                       TO PV-ABEND-PARAGRAPH      16580001
165900              MOVE 'READ SUT00095'     TO PV-DB2-OPERATION        16590001
166000              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        16600001
166100              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-2        16610001
166200              MOVE PV-DISP-DEPT        TO PV-DB2-MESSAGE-3        16620001
166300              MOVE PV-DISP-MAJ-CL      TO PV-DB2-MESSAGE-4        16630001
166400              MOVE 'SUT_TRIP_DTL_SUM ' TO PV-ABEND-TABLE-1        16640001
166500              MOVE ' '                 TO PV-ABEND-TABLE-2        16650001
166600              MOVE ' '                 TO PV-ABEND-TABLE-3        16660001
166700              MOVE ' '                 TO PV-ABEND-TABLE-4        16670001
166800              MOVE ' '                 TO PV-ABEND-TABLE-5        16680001
166900                                                                  16690001
166901              PERFORM 9900-DB2-ERROR                              16690101
166902     END-EVALUATE.                                                16690201
166903                                                                  16690301
166904                                                                  16690401
166905******************************************************************16690501
166906*                                                                 16690601
166907******************************************************************16690701
166908 8300-SELECT-SKU-CNT-DEPT.                                        16690801
166909                                                                  16690901
166910     IF  PS-DISPLAY-PARA-YES                                      16691001
166920         DISPLAY ' SUKUT576 - 8300-SELECT-SKU-CNT-DEPT      '     16692001
166930     END-IF.                                                      16693001
166940                                                                  16694001
166950     EXEC SQL                                                     16695001
166960         SELECT  COUNT(DISTINCT SKU_NBR)                          16696001
166970           INTO :PV-SKU-COUNT                                     16697001
166980           FROM  SUT_TRIP_DTL_SUM                                 16698001
166990          WHERE  TRIP_OCRNC_ID     = :DK-TRIP-OCRNC-ID            16699001
167000            AND  BUS_AREA_ID       = :SUT00095-BUS-AREA-ID        16700001
167100            AND  DEPT_NBR          = :SUT00095-DEPT-NBR           16710001
167200           WITH UR                                                16720001
167300     END-EXEC.                                                    16730001
167400                                                                  16740001
167500     EVALUATE TRUE                                                16750001
167600         WHEN SQLCODE = ZERO                                      16760001
167700              CONTINUE                                            16770001
167800                                                                  16780001
167900         WHEN SQLWARN0 NOT = SPACE                                16790001
168000         WHEN SQLCODE  NOT = +0                                   16800001
168100                                                                  16810001
168200              MOVE SQLCODE              TO PV-DISP-SQLCODE        16820001
168300              MOVE DK-TRIP-OCRNC-ID     TO PV-DISP-OCRNC-ID       16830001
168400              MOVE SUT00095-BUS-AREA-ID TO PV-DISP-BUS-AREA       16840001
168500              MOVE SUT00095-DEPT-NBR    TO PV-DISP-DEPT           16850001
168600                                                                  16860001
168700              MOVE '8300-SELECT-SKU-CNT-DEPT'                     16870001
168800                                       TO PV-ABEND-PARAGRAPH      16880001
168900              MOVE 'READ SUT00095'     TO PV-DB2-OPERATION        16890001
169000              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        16900001
169100              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-2        16910001
169200              MOVE PV-DISP-DEPT        TO PV-DB2-MESSAGE-3        16920001
169300              MOVE ' '                 TO PV-DB2-MESSAGE-4        16930001
169400              MOVE 'SUT_TRIP_DTL_SUM ' TO PV-ABEND-TABLE-1        16940001
169500              MOVE ' '                 TO PV-ABEND-TABLE-2        16950001
169510              MOVE ' '                 TO PV-ABEND-TABLE-3        16951001
169520              MOVE ' '                 TO PV-ABEND-TABLE-4        16952001
169530              MOVE ' '                 TO PV-ABEND-TABLE-5        16953001
169540                                                                  16954001
169550              PERFORM 9900-DB2-ERROR                              16955001
169560     END-EVALUATE.                                                16956001
169570                                                                  16957001
169580                                                                  16958001
169590******************************************************************16959001
169600*                                                                 16960001
169700******************************************************************16970001
169800 8350-SELECT-CARTON-CNT-DEPT.                                     16980000
169810                                                                  16981000
169811     IF  PS-DISPLAY-PARA-YES                                      16981100
169812         DISPLAY ' SUKUT576 - 8350-SELECT-CARTON-CNT-DEPT   '     16981201
169813     END-IF.                                                      16981301
169814                                                                  16981401
169815     EXEC SQL                                                     16981501
169816         SELECT  COUNT(DISTINCT SHIPT_UNT_ID)                     16981601
169817           INTO :PV-CARTON-COUNT                                  16981701
169818           FROM  SUT_TRIP_DTL_SUM                                 16981801
169819          WHERE  TRIP_OCRNC_ID     = :DK-TRIP-OCRNC-ID            16981901
169820            AND  BUS_AREA_ID       = :PV-SAVE-BUS-AREA-ID         16982001
169830            AND  DEPT_NBR          = :PV-SAVE-DEPT-NBR            16983001
169840           WITH UR                                                16984001
169850     END-EXEC.                                                    16985001
169860                                                                  16986001
169870     EVALUATE TRUE                                                16987001
169880         WHEN SQLCODE = ZERO                                      16988001
169890              CONTINUE                                            16989001
169900                                                                  16990001
170000         WHEN SQLWARN0 NOT = SPACE                                17000001
170100         WHEN SQLCODE  NOT = +0                                   17010001
170200                                                                  17020001
170300              MOVE SQLCODE              TO PV-DISP-SQLCODE        17030001
170400              MOVE DK-TRIP-OCRNC-ID     TO PV-DISP-OCRNC-ID       17040001
170500              MOVE PV-SAVE-BUS-AREA-ID  TO PV-DISP-BUS-AREA       17050001
170600              MOVE PV-SAVE-DEPT-NBR     TO PV-DISP-DEPT           17060001
170700                                                                  17070001
170800              MOVE '8350-SELECT-CARTON-CNT-DEPT'                  17080001
170900                                       TO PV-ABEND-PARAGRAPH      17090001
171000              MOVE 'READ SUT00095'     TO PV-DB2-OPERATION        17100001
171100              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        17110001
171200              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-2        17120001
171300              MOVE PV-DISP-DEPT        TO PV-DB2-MESSAGE-3        17130001
171400              MOVE ' '                 TO PV-DB2-MESSAGE-4        17140001
171500              MOVE 'SUT_TRIP_DTL_SUM ' TO PV-ABEND-TABLE-1        17150001
171600              MOVE ' '                 TO PV-ABEND-TABLE-2        17160001
171700              MOVE ' '                 TO PV-ABEND-TABLE-3        17170001
171800              MOVE ' '                 TO PV-ABEND-TABLE-4        17180001
171900              MOVE ' '                 TO PV-ABEND-TABLE-5        17190001
172000                                                                  17200001
172100              PERFORM 9900-DB2-ERROR                              17210001
172110     END-EVALUATE.                                                17211000
172120                                                                  17212001
172130                                                                  17213001
172140******************************************************************17214001
172150*                                                                 17215001
172160******************************************************************17216001
172170 8401-SELECT-SKU-CNT-BRND.                                        17217001
172180                                                                  17218001
172190     IF  PS-DISPLAY-PARA-YES                                      17219001
172200         DISPLAY ' SUKUT576 - 8401-SELECT-SKU-CNT-BRND      '     17220001
172300     END-IF.                                                      17230001
172400                                                                  17240001
172500     EXEC SQL                                                     17250001
172600         SELECT  COUNT(DISTINCT SKU_NBR)                          17260001
172700           INTO :PV-SKU-COUNT                                     17270001
172800           FROM  SUT_TRIP_DTL_SUM                                 17280001
172900          WHERE  TRIP_OCRNC_ID     = :DK-TRIP-OCRNC-ID            17290001
173000            AND  BUS_AREA_ID       = :PV-SAVE-BUS-AREA-ID         17300001
173100            AND  BRND_ID           = :PV-SAVE-BRND-ID             17310001
173200           WITH UR                                                17320001
173300     END-EXEC.                                                    17330001
173400                                                                  17340001
173500     EVALUATE TRUE                                                17350001
173600         WHEN SQLCODE = ZERO                                      17360001
173700              CONTINUE                                            17370001
173800                                                                  17380001
173900         WHEN SQLWARN0 NOT = SPACE                                17390000
174000         WHEN SQLCODE  NOT = +0                                   17400000
174100                                                                  17410001
174200              MOVE SQLCODE              TO PV-DISP-SQLCODE        17420001
174300              MOVE DK-TRIP-OCRNC-ID     TO PV-DISP-OCRNC-ID       17430001
174400              MOVE PV-SAVE-BUS-AREA-ID  TO PV-DISP-BUS-AREA       17440001
174500              MOVE PV-SAVE-BRND-ID      TO PV-DISP-BRAND          17450001
174600                                                                  17460001
174700              MOVE '8401-SELECT-SKU-CNT-BRND'                     17470001
174800                                       TO PV-ABEND-PARAGRAPH      17480001
174900              MOVE 'READ SUT00095'     TO PV-DB2-OPERATION        17490001
175000              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        17500001
175010              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-2        17501001
175020              MOVE PV-DISP-BRAND       TO PV-DB2-MESSAGE-3        17502001
175030              MOVE ' '                 TO PV-DB2-MESSAGE-4        17503001
175040              MOVE 'SUT_TRIP_DTL_SUM ' TO PV-ABEND-TABLE-1        17504001
175050              MOVE ' '                 TO PV-ABEND-TABLE-2        17505001
175060              MOVE ' '                 TO PV-ABEND-TABLE-3        17506001
175070              MOVE ' '                 TO PV-ABEND-TABLE-4        17507001
175080              MOVE ' '                 TO PV-ABEND-TABLE-5        17508001
175090                                                                  17509001
175100              PERFORM 9900-DB2-ERROR                              17510001
175110     END-EVALUATE.                                                17511000
175120                                                                  17512001
175130                                                                  17513001
175140******************************************************************17514001
175150*                                                                 17515001
175160******************************************************************17516001
175170 8451-SELECT-CARTON-CNT-BRND.                                     17517001
175180                                                                  17518001
175190     IF  PS-DISPLAY-PARA-YES                                      17519001
175200         DISPLAY ' SUKUT576 - 8451-SELECT-CARTON-CNT-BRND   '     17520001
175300     END-IF.                                                      17530001
175400                                                                  17540001
175500     EXEC SQL                                                     17550001
175600         SELECT  COUNT(DISTINCT SHIPT_UNT_ID)                     17560001
175700           INTO :PV-CARTON-COUNT                                  17570001
175800           FROM  SUT_TRIP_DTL_SUM                                 17580001
175900          WHERE  TRIP_OCRNC_ID     = :DK-TRIP-OCRNC-ID            17590001
176000            AND  BUS_AREA_ID       = :PV-SAVE-BUS-AREA-ID         17600001
176100            AND  BRND_ID           = :PV-SAVE-BRND-ID             17610001
176200           WITH UR                                                17620001
176300     END-EXEC.                                                    17630001
176400                                                                  17640001
176500     EVALUATE TRUE                                                17650001
176600         WHEN SQLCODE = ZERO                                      17660001
176700              CONTINUE                                            17670001
176800                                                                  17680001
176900         WHEN SQLWARN0 NOT = SPACE                                17690001
177000         WHEN SQLCODE  NOT = +0                                   17700001
177100                                                                  17710001
177200              MOVE SQLCODE              TO PV-DISP-SQLCODE        17720001
177300              MOVE DK-TRIP-OCRNC-ID     TO PV-DISP-OCRNC-ID       17730001
177400              MOVE PV-SAVE-BUS-AREA-ID  TO PV-DISP-BUS-AREA       17740001
177500              MOVE PV-SAVE-BRND-ID      TO PV-DISP-BRAND          17750001
177600                                                                  17760001
177700              MOVE '8451-SELECT-CARTON-CNT-BRND'                  17770001
177800                                       TO PV-ABEND-PARAGRAPH      17780001
177900              MOVE 'READ SUT00095'     TO PV-DB2-OPERATION        17790001
178000              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        17800001
178100              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-2        17810001
178110              MOVE PV-DISP-BRAND       TO PV-DB2-MESSAGE-3        17811001
178120              MOVE ' '                 TO PV-DB2-MESSAGE-4        17812001
178130              MOVE 'SUT_TRIP_DTL_SUM ' TO PV-ABEND-TABLE-1        17813001
178140              MOVE ' '                 TO PV-ABEND-TABLE-2        17814001
178150              MOVE ' '                 TO PV-ABEND-TABLE-3        17815001
178160              MOVE ' '                 TO PV-ABEND-TABLE-4        17816001
178170              MOVE ' '                 TO PV-ABEND-TABLE-5        17817001
178180                                                                  17818001
178190              PERFORM 9900-DB2-ERROR                              17819001
178200     END-EVALUATE.                                                17820001
178300                                                                  17830000
178400                                                                  17840000
178410******************************************************************17841000
178420*                                                                 17842000
178430******************************************************************17843000
178440 8500-SELECT-SKU-CNT-BUS-GP.                                      17844001
178450                                                                  17845001
178460     IF  PS-DISPLAY-PARA-YES                                      17846001
178470         DISPLAY ' SUKUT576 - 8500-SELECT-SKU-CNT-BUS-GP    '     17847001
178480     END-IF.                                                      17848001
178490                                                                  17849001
178500     EXEC SQL                                                     17850001
178600         SELECT  COUNT(DISTINCT SKU_NBR)                          17860001
178700           INTO :PV-SKU-COUNT                                     17870001
178800           FROM  SUT_TRIP_DTL_SUM                                 17880001
178900          WHERE  TRIP_OCRNC_ID     = :DK-TRIP-OCRNC-ID            17890001
179000            AND  BUS_AREA_ID       = :SUT00095-BUS-AREA-ID        17900001
179100           WITH UR                                                17910001
179200     END-EXEC.                                                    17920001
179300                                                                  17930001
179400     EVALUATE TRUE                                                17940001
179500         WHEN SQLCODE = ZERO                                      17950001
179600              CONTINUE                                            17960001
179700                                                                  17970001
179800         WHEN SQLWARN0 NOT = SPACE                                17980001
179900         WHEN SQLCODE  NOT = +0                                   17990001
180000                                                                  18000001
180100              MOVE SQLCODE              TO PV-DISP-SQLCODE        18010001
180200              MOVE DK-TRIP-OCRNC-ID     TO PV-DISP-OCRNC-ID       18020001
180300              MOVE SUT00095-BUS-AREA-ID TO PV-DISP-BUS-AREA       18030001
180400                                                                  18040001
180500              MOVE '8500-SELECT-SKU-CNT-BUS-GP'                   18050001
180600                                       TO PV-ABEND-PARAGRAPH      18060001
180610              MOVE 'READ SUT00095'     TO PV-DB2-OPERATION        18061001
180620              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        18062001
180630              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-2        18063001
180640              MOVE ' '                 TO PV-DB2-MESSAGE-3        18064001
180650              MOVE ' '                 TO PV-DB2-MESSAGE-4        18065001
180660              MOVE 'SUT_TRIP_DTL_SUM ' TO PV-ABEND-TABLE-1        18066001
180670              MOVE ' '                 TO PV-ABEND-TABLE-2        18067001
180680              MOVE ' '                 TO PV-ABEND-TABLE-3        18068001
180690              MOVE ' '                 TO PV-ABEND-TABLE-4        18069001
180700              MOVE ' '                 TO PV-ABEND-TABLE-5        18070000
180701                                                                  18070100
180702              PERFORM 9900-DB2-ERROR                              18070200
180703     END-EVALUATE.                                                18070301
180704                                                                  18070401
180705                                                                  18070501
180706******************************************************************18070601
180707*                                                                 18070701
180708******************************************************************18070801
180709 8550-SELECT-CARTON-CNT-BUS-GP.                                   18070901
180710                                                                  18071001
180720     IF  PS-DISPLAY-PARA-YES                                      18072001
180730         DISPLAY ' SUKUT576 - 8550-SELECT-CARTON-CNT-BUS-GP '     18073001
180740     END-IF.                                                      18074001
180750                                                                  18075001
180760     EXEC SQL                                                     18076001
180770         SELECT  COUNT(DISTINCT SHIPT_UNT_ID)                     18077001
180780           INTO :PV-CARTON-COUNT                                  18078001
180790           FROM  SUT_TRIP_DTL_SUM                                 18079001
180800          WHERE  TRIP_OCRNC_ID     = :DK-TRIP-OCRNC-ID            18080001
180900            AND  BUS_AREA_ID       = :PV-SAVE-BUS-AREA-ID         18090001
181000           WITH UR                                                18100001
181100     END-EXEC.                                                    18110001
181200                                                                  18120001
181300     EVALUATE TRUE                                                18130001
181400         WHEN SQLCODE = ZERO                                      18140001
181500              CONTINUE                                            18150001
181600                                                                  18160001
181700         WHEN SQLWARN0 NOT = SPACE                                18170001
181800         WHEN SQLCODE  NOT = +0                                   18180001
181900                                                                  18190001
182000              MOVE SQLCODE              TO PV-DISP-SQLCODE        18200001
182100              MOVE DK-TRIP-OCRNC-ID     TO PV-DISP-OCRNC-ID       18210001
182200              MOVE PV-SAVE-BUS-AREA-ID  TO PV-DISP-BUS-AREA       18220001
182300                                                                  18230001
182400              MOVE '8550-SELECT-CARTON-CNT-BUS-GP'                18240001
182500                                       TO PV-ABEND-PARAGRAPH      18250001
182600              MOVE 'READ SUT00095'     TO PV-DB2-OPERATION        18260001
182700              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        18270001
182800              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-2        18280001
182900              MOVE ' '                 TO PV-DB2-MESSAGE-3        18290001
183000              MOVE ' '                 TO PV-DB2-MESSAGE-4        18300001
183010              MOVE 'SUT_TRIP_DTL_SUM ' TO PV-ABEND-TABLE-1        18301001
183020              MOVE ' '                 TO PV-ABEND-TABLE-2        18302001
183030              MOVE ' '                 TO PV-ABEND-TABLE-3        18303001
183040              MOVE ' '                 TO PV-ABEND-TABLE-4        18304001
183050              MOVE ' '                 TO PV-ABEND-TABLE-5        18305001
183060                                                                  18306001
183070              PERFORM 9900-DB2-ERROR                              18307001
183080     END-EVALUATE.                                                18308001
183090                                                                  18309001
183100                                                                  18310001
183200******************************************************************18320001
183210*                                                                 18321001
183220******************************************************************18322001
183230 8600-SUMM-TRIP-QTY-DOL.                                          18323001
183240                                                                  18324001
183250     IF  PS-DISPLAY-PARA-YES                                      18325001
183260         DISPLAY ' SUKUT576 - 8600-SUMM-TRIP-QTY-DOL        '     18326001
183270     END-IF.                                                      18327001
183280                                                                  18328001
183290     EXEC SQL                                                     18329001
183300         SELECT  SUM(UNT_QTY)                                     18330001
183400              ,  SUM(RTL_DOL_AMT)                                 18340001
183500              ,  SUM(COST_DOL_AMT)                                18350001
183600           INTO :PV-UNIT-QTY-SUM                                  18360001
183700              , :PV-RETAIL-SUM                                    18370001
183800              , :PV-COST-SUM                                      18380001
183900           FROM SUT_TRIP_DTL_SUM                                  18390001
184000          WHERE  TRIP_OCRNC_ID     = :DK-TRIP-OCRNC-ID            18400001
184100           WITH UR                                                18410001
184200     END-EXEC.                                                    18420001
184300                                                                  18430001
184400     EVALUATE TRUE                                                18440001
184500         WHEN SQLCODE = ZERO                                      18450001
184600              CONTINUE                                            18460001
184700                                                                  18470001
184800         WHEN SQLCODE = -305                                      18480001
184900             MOVE ZERO             TO PV-UNIT-QTY-SUM             18490001
185000                                      PV-RETAIL-SUM               18500001
185100                                      PV-COST-SUM                 18510001
185200              CONTINUE                                            18520001
185300                                                                  18530001
185400         WHEN SQLWARN0 NOT = SPACE                                18540001
185500         WHEN SQLCODE  NOT = +0                                   18550001
185600                                                                  18560001
185700              MOVE SQLCODE              TO PV-DISP-SQLCODE        18570001
185800              MOVE DK-TRIP-OCRNC-ID     TO PV-DISP-OCRNC-ID       18580001
185900                                                                  18590001
186000              MOVE '8600-SUMM-TRIP-QTY-DOL'                       18600001
186100                                       TO PV-ABEND-PARAGRAPH      18610001
186200              MOVE 'SUM SUT_WRK_SUM'   TO PV-DB2-OPERATION        18620001
186300              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        18630001
186400              MOVE ' '                 TO PV-DB2-MESSAGE-2        18640001
186500              MOVE ' '                 TO PV-DB2-MESSAGE-3        18650001
186600              MOVE ' '                 TO PV-DB2-MESSAGE-4        18660001
186700              MOVE 'SUT_TRIP_DTL_SUM ' TO PV-ABEND-TABLE-1        18670001
186800              MOVE ' '                 TO PV-ABEND-TABLE-2        18680001
186900              MOVE ' '                 TO PV-ABEND-TABLE-3        18690001
187000              MOVE ' '                 TO PV-ABEND-TABLE-4        18700001
187100              MOVE ' '                 TO PV-ABEND-TABLE-5        18710001
187200                                                                  18720001
187300              PERFORM 9900-DB2-ERROR                              18730001
187400     END-EVALUATE.                                                18740001
187500                                                                  18750001
187600                                                                  18760001
187700******************************************************************18770001
187800*                                                                 18780001
187900******************************************************************18790001
188000 8700-SELECT-SKU-CNT-TRIP.                                        18800001
188100                                                                  18810001
188200     IF  PS-DISPLAY-PARA-YES                                      18820001
188300         DISPLAY ' SUKUT576 - 8700-SELECT-SKU-CNT-TRIP      '     18830001
188400     END-IF.                                                      18840001
188500                                                                  18850001
188600     EXEC SQL                                                     18860001
188700         SELECT  COUNT(DISTINCT SKU_NBR)                          18870001
188800           INTO :PV-SKU-COUNT                                     18880001
188900           FROM  SUT_TRIP_DTL_SUM                                 18890001
189000          WHERE  TRIP_OCRNC_ID     = :DK-TRIP-OCRNC-ID            18900001
189100           WITH UR                                                18910001
189200     END-EXEC.                                                    18920001
189300                                                                  18930001
189400     EVALUATE TRUE                                                18940001
189500         WHEN SQLCODE = ZERO                                      18950001
189600              CONTINUE                                            18960001
189700                                                                  18970001
189800         WHEN SQLCODE = -304                                      18980001
189900              MOVE 9999  TO  PV-SKU-COUNT                         18990001
190000                                                                  19000001
190100         WHEN SQLWARN0 NOT = SPACE                                19010000
190200         WHEN SQLCODE  NOT = +0                                   19020000
190300                                                                  19030001
190400              MOVE SQLCODE              TO PV-DISP-SQLCODE        19040001
190500              MOVE DK-TRIP-OCRNC-ID     TO PV-DISP-OCRNC-ID       19050001
190600                                                                  19060001
190700              MOVE '8700-SELECT-SKU-CNT-TRIP'                     19070001
190800                                       TO PV-ABEND-PARAGRAPH      19080001
190810              MOVE 'READ SUT00095'     TO PV-DB2-OPERATION        19081001
190820              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        19082001
190830              MOVE ' '                 TO PV-DB2-MESSAGE-2        19083001
190840              MOVE ' '                 TO PV-DB2-MESSAGE-3        19084001
190850              MOVE ' '                 TO PV-DB2-MESSAGE-4        19085001
190860              MOVE 'SUT_TRIP_DTL_SUM ' TO PV-ABEND-TABLE-1        19086001
190870              MOVE ' '                 TO PV-ABEND-TABLE-2        19087001
190880              MOVE ' '                 TO PV-ABEND-TABLE-3        19088001
190890              MOVE ' '                 TO PV-ABEND-TABLE-4        19089001
190891              MOVE ' '                 TO PV-ABEND-TABLE-5        19089101
190892                                                                  19089201
190893              PERFORM 9900-DB2-ERROR                              19089301
190894     END-EVALUATE.                                                19089401
190895                                                                  19089501
190896                                                                  19089601
190897******************************************************************19089701
190898*                                                                 19089801
190899******************************************************************19089901
190900 8750-SELECT-CARTON-CNT-TRIP.                                     19090001
191000                                                                  19100001
191100     IF  PS-DISPLAY-PARA-YES                                      19110001
191110         DISPLAY ' SUKUT576 - 8750-SELECT-CARTON-CNT-TRIP   '     19111001
191120     END-IF.                                                      19112001
191130                                                                  19113001
191140     EXEC SQL                                                     19114001
191150         SELECT  COUNT(DISTINCT SHIPT_UNT_ID)                     19115001
191160           INTO :PV-CARTON-COUNT                                  19116001
191170           FROM  SUT_TRIP_DTL_SUM                                 19117001
191180          WHERE  TRIP_OCRNC_ID     = :DK-TRIP-OCRNC-ID            19118001
191190           WITH UR                                                19119001
191200     END-EXEC.                                                    19120001
191300                                                                  19130001
191400     EVALUATE TRUE                                                19140001
191500         WHEN SQLCODE = ZERO                                      19150001
191600              CONTINUE                                            19160001
191700                                                                  19170001
191800         WHEN SQLWARN0 NOT = SPACE                                19180001
191900         WHEN SQLCODE  NOT = +0                                   19190001
192000                                                                  19200001
192100              MOVE SQLCODE              TO PV-DISP-SQLCODE        19210001
192200              MOVE DK-TRIP-OCRNC-ID     TO PV-DISP-OCRNC-ID       19220001
192300                                                                  19230001
192400              MOVE '8750-SELECT-CARTON-CNT-TRIP'                  19240001
192500                                       TO PV-ABEND-PARAGRAPH      19250001
192600              MOVE 'READ SUT00095'     TO PV-DB2-OPERATION        19260001
192700              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        19270001
192800              MOVE ' '                 TO PV-DB2-MESSAGE-2        19280001
192900              MOVE ' '                 TO PV-DB2-MESSAGE-3        19290001
193000              MOVE ' '                 TO PV-DB2-MESSAGE-4        19300001
193100              MOVE 'SUT_TRIP_DTL_SUM ' TO PV-ABEND-TABLE-1        19310001
193110              MOVE ' '                 TO PV-ABEND-TABLE-2        19311001
193120              MOVE ' '                 TO PV-ABEND-TABLE-3        19312001
193130              MOVE ' '                 TO PV-ABEND-TABLE-4        19313001
193140              MOVE ' '                 TO PV-ABEND-TABLE-5        19314001
193150                                                                  19315001
193160              PERFORM 9900-DB2-ERROR                              19316001
193170     END-EVALUATE.                                                19317001
193180                                                                  19318001
193190                                                                  19319001
193200******************************************************************19320001
193300*                                                                 19330001
193310******************************************************************19331001
193320 8800-INSERT-SUT00010.                                            19332001
193330                                                                  19333001
193340     IF  PS-DISPLAY-PARA-YES                                      19334001
193350         DISPLAY ' SUKUT576 - 8800-INSERT-SUT00010          '     19335001
193360     END-IF.                                                      19336001
193370                                                                  19337001
193380     EXEC SQL                                                     19338001
193390          INSERT                                                  19339001
193400            INTO SUT_MAJ_CL_SUM                                   19340001
193500                 (                                                19350001
193600                  TRIP_OCRNC_ID                                   19360001
193700               ,  BUS_AREA_ID                                     19370001
193800               ,  DEPT_NBR                                        19380001
193900               ,  MAJ_CL_NBR                                      19390001
194000               ,  UNT_QTY                                         19400001
194100               ,  SKU_QTY                                         19410001
194200               ,  CART_QTY                                        19420001
194300               ,  RTL_DOL_AMT                                     19430001
194400               ,  COST_DOL_AMT                                    19440001
194500                 )                                                19450001
194600          VALUES (                                                19460001
194700                 :SUT00010-TRIP-OCRNC-ID                          19470001
194800              ,  :SUT00010-BUS-AREA-ID                            19480001
194900              ,  :SUT00010-DEPT-NBR                               19490001
195000              ,  :SUT00010-MAJ-CL-NBR                             19500001
195100              ,  :SUT00010-UNT-QTY                                19510001
195200              ,  :SUT00010-SKU-QTY                                19520001
195300              ,  :SUT00010-CART-QTY                               19530001
195400              ,  :SUT00010-RTL-DOL-AMT                            19540001
195500              ,  :SUT00010-COST-DOL-AMT                           19550001
195600                 )                                                19560001
195700     END-EXEC.                                                    19570000
195800                                                                  19580000
195900     EVALUATE TRUE                                                19590000
196000         WHEN SQLCODE = +0                                        19600000
196100              CONTINUE                                            19610000
196200                                                                  19620000
196300         WHEN SQLWARN0 NOT = SPACES                               19630000
196400         WHEN SQLCODE < +0                                        19640000
196500         WHEN SQLCODE > +0                                        19650000
196600                                                                  19660001
196700              MOVE SQLCODE                TO PV-DISP-SQLCODE      19670001
196800              MOVE SUT00010-TRIP-OCRNC-ID TO PV-DISP-OCRNC-ID     19680001
196900              MOVE SUT00010-BUS-AREA-ID   TO PV-DISP-BUS-AREA     19690001
197000              MOVE SUT00010-DEPT-NBR      TO PV-DISP-DEPT         19700001
197100              MOVE SUT00010-MAJ-CL-NBR    TO PV-DISP-MAJ-CL       19710001
197200                                                                  19720001
197300              MOVE '8800-INSERT-SUT00010'                         19730001
197400                                       TO PV-ABEND-PARAGRAPH      19740001
197410              MOVE 'INSERT SUT_MAJ_CL_SUM'                        19741001
197420                                       TO PV-DB2-OPERATION        19742001
197430              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        19743001
197440              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-2        19744001
197450              MOVE PV-DISP-DEPT        TO PV-DB2-MESSAGE-3        19745001
197460              MOVE PV-DISP-MAJ-CL      TO PV-DB2-MESSAGE-4        19746001
197470              MOVE 'SUT_MAJ_CL_SUM   ' TO PV-ABEND-TABLE-1        19747001
197480              MOVE ' '                 TO PV-ABEND-TABLE-2        19748001
197490              MOVE ' '                 TO PV-ABEND-TABLE-3        19749001
197491              MOVE ' '                 TO PV-ABEND-TABLE-4        19749101
197492              MOVE ' '                 TO PV-ABEND-TABLE-5        19749201
197493                                                                  19749301
197494              PERFORM 9900-DB2-ERROR                              19749401
197495     END-EVALUATE.                                                19749501
197496                                                                  19749601
197497                                                                  19749701
197498******************************************************************19749801
197499*                                                                 19749901
197500******************************************************************19750001
197600 8820-INSERT-SUT00009.                                            19760001
197700                                                                  19770001
197710     IF  PS-DISPLAY-PARA-YES                                      19771001
197720         DISPLAY ' SUKUT576 - 8820-INSERT-SUT00009          '     19772000
197730     END-IF.                                                      19773000
197740                                                                  19774001
197750     EXEC SQL                                                     19775001
197760          INSERT                                                  19776001
197770            INTO SUT_DEPT_SUM                                     19777001
197780                 (                                                19778001
197790                  TRIP_OCRNC_ID                                   19779001
197800               ,  BUS_AREA_ID                                     19780001
197900               ,  DEPT_NBR                                        19790001
198000               ,  UNT_QTY                                         19800001
198100               ,  SKU_QTY                                         19810001
198200               ,  CART_QTY                                        19820001
198300               ,  RTL_DOL_AMT                                     19830001
198400               ,  COST_DOL_AMT                                    19840001
198500                 )                                                19850001
198600          VALUES (                                                19860001
198700                 :SUT00009-TRIP-OCRNC-ID                          19870001
198800              ,  :SUT00009-BUS-AREA-ID                            19880001
198900              ,  :SUT00009-DEPT-NBR                               19890001
199000              ,  :SUT00009-UNT-QTY                                19900001
199100              ,  :SUT00009-SKU-QTY                                19910001
199200              ,  :SUT00009-CART-QTY                               19920001
199300              ,  :SUT00009-RTL-DOL-AMT                            19930001
199400              ,  :SUT00009-COST-DOL-AMT                           19940001
199500                 )                                                19950001
199600     END-EXEC.                                                    19960001
199700                                                                  19970001
199800     EVALUATE TRUE                                                19980001
199900         WHEN SQLCODE = +0                                        19990001
200000              CONTINUE                                            20000001
200100                                                                  20010001
200200         WHEN SQLWARN0 NOT = SPACES                               20020001
200300         WHEN SQLCODE < +0                                        20030001
200400         WHEN SQLCODE > +0                                        20040001
200500                                                                  20050001
200600              MOVE SQLCODE                TO PV-DISP-SQLCODE      20060001
200700              MOVE SUT00009-TRIP-OCRNC-ID TO PV-DISP-OCRNC-ID     20070001
200800              MOVE SUT00009-BUS-AREA-ID   TO PV-DISP-BUS-AREA     20080001
200900              MOVE SUT00009-DEPT-NBR      TO PV-DISP-DEPT         20090001
201000              MOVE SUT00009-UNT-QTY       TO PV-DISP-UNT-QTY      20100001
201100                                                                  20110001
201200              MOVE '8820-INSERT-SUT00009'                         20120001
201210                                       TO PV-ABEND-PARAGRAPH      20121001
201220              MOVE 'INSERT SUT_DEPT_SUM'                          20122001
201230                                       TO PV-DB2-OPERATION        20123001
201240              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        20124001
201250              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-2        20125001
201260              MOVE PV-DISP-DEPT        TO PV-DB2-MESSAGE-3        20126001
201270              MOVE PV-DISP-UNT-QTY     TO PV-DB2-MESSAGE-4        20127001
201280              MOVE 'SUT_DEPT_SUM     ' TO PV-ABEND-TABLE-1        20128001
201290              MOVE ' '                 TO PV-ABEND-TABLE-2        20129001
201300              MOVE ' '                 TO PV-ABEND-TABLE-3        20130001
201301              MOVE ' '                 TO PV-ABEND-TABLE-4        20130101
201302              MOVE ' '                 TO PV-ABEND-TABLE-5        20130201
201303                                                                  20130301
201304              PERFORM 9900-DB2-ERROR                              20130401
201305     END-EVALUATE.                                                20130501
201306                                                                  20130601
201307                                                                  20130701
201308******************************************************************20130801
201309*                                                                 20130901
201310******************************************************************20131001
201320 8825-UPDATE-SUT00009.                                            20132001
201330                                                                  20133001
201340     IF  PS-DISPLAY-PARA-YES                                      20134001
201350         DISPLAY ' SUKUT576 - 8825-UPDATE-SUT00009          '     20135001
201360     END-IF.                                                      20136001
201370                                                                  20137001
201380     EXEC SQL                                                     20138001
201390          UPDATE SUT_DEPT_SUM                                     20139001
201400             SET  UNT_QTY         = :SUT00009-UNT-QTY             20140001
201500               ,  SKU_QTY         = :SUT00009-SKU-QTY             20150001
201600               ,  CART_QTY        = :SUT00009-CART-QTY            20160001
201700               ,  RTL_DOL_AMT     = :SUT00009-RTL-DOL-AMT         20170001
201800               ,  COST_DOL_AMT    = :SUT00009-COST-DOL-AMT        20180001
201900           WHERE  TRIP_OCRNC_ID   = :SUT00009-TRIP-OCRNC-ID       20190001
202000             AND  BUS_AREA_ID     = :SUT00009-BUS-AREA-ID         20200001
202100             AND  DEPT_NBR        = :SUT00009-DEPT-NBR            20210001
202200     END-EXEC.                                                    20220001
202300                                                                  20230001
202400     EVALUATE TRUE                                                20240001
202500         WHEN SQLCODE = +0                                        20250001
202600              CONTINUE                                            20260001
202700                                                                  20270001
202800         WHEN SQLWARN0 NOT = SPACES                               20280001
202900         WHEN SQLCODE < +0                                        20290001
203000         WHEN SQLCODE > +0                                        20300001
203100                                                                  20310001
203200              MOVE SQLCODE                TO PV-DISP-SQLCODE      20320001
203300              MOVE SUT00009-TRIP-OCRNC-ID TO PV-DISP-OCRNC-ID     20330001
203400              MOVE SUT00009-BUS-AREA-ID   TO PV-DISP-BUS-AREA     20340001
203500              MOVE SUT00009-DEPT-NBR      TO PV-DISP-DEPT         20350001
203600              MOVE SUT00009-UNT-QTY       TO PV-DISP-UNT-QTY      20360001
203700                                                                  20370001
203800              MOVE '8825-UPDATE-SUT00009'                         20380001
203900                                       TO PV-ABEND-PARAGRAPH      20390001
204000              MOVE 'UPDATE SUT_DEPT_SUM'                          20400001
204100                                       TO PV-DB2-OPERATION        20410001
204110              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        20411001
204120              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-2        20412001
204130              MOVE PV-DISP-DEPT        TO PV-DB2-MESSAGE-3        20413001
204140              MOVE PV-DISP-UNT-QTY     TO PV-DB2-MESSAGE-4        20414001
204150              MOVE 'SUT_DEPT_SUM     ' TO PV-ABEND-TABLE-1        20415001
204160              MOVE ' '                 TO PV-ABEND-TABLE-2        20416001
204170              MOVE ' '                 TO PV-ABEND-TABLE-3        20417001
204180              MOVE ' '                 TO PV-ABEND-TABLE-4        20418001
204190              MOVE ' '                 TO PV-ABEND-TABLE-5        20419001
204200                                                                  20420001
204201              PERFORM 9900-DB2-ERROR                              20420101
204202     END-EVALUATE.                                                20420201
204203                                                                  20420301
204204                                                                  20420401
204205******************************************************************20420501
204206*                                                                 20420601
204207******************************************************************20420701
204208 8840-INSERT-SUT00008.                                            20420801
204209                                                                  20420901
204210     IF  PS-DISPLAY-PARA-YES                                      20421001
204220         DISPLAY ' SUKUT576 - 8840-INSERT-SUT00008          '     20422001
204230     END-IF.                                                      20423001
204240                                                                  20424001
204250     EXEC SQL                                                     20425001
204260          INSERT                                                  20426001
204270            INTO SUT_BUS_AREA_SUM                                 20427001
204280                 (                                                20428001
204290                  TRIP_OCRNC_ID                                   20429001
204300               ,  BUS_AREA_ID                                     20430001
204400               ,  UNT_QTY                                         20440001
204500               ,  SKU_QTY                                         20450001
204600               ,  CART_QTY                                        20460001
204700               ,  RTL_DOL_AMT                                     20470001
204800               ,  COST_DOL_AMT                                    20480001
204900                 )                                                20490001
205000          VALUES (                                                20500001
205100                 :SUT00008-TRIP-OCRNC-ID                          20510001
205200              ,  :SUT00008-BUS-AREA-ID                            20520001
205300              ,  :SUT00008-UNT-QTY                                20530001
205400              ,  :SUT00008-SKU-QTY                                20540001
205500              ,  :SUT00008-CART-QTY                               20550001
205600              ,  :SUT00008-RTL-DOL-AMT                            20560001
205700              ,  :SUT00008-COST-DOL-AMT                           20570001
205800                 )                                                20580001
205900     END-EXEC.                                                    20590001
206000                                                                  20600001
206100     EVALUATE TRUE                                                20610001
206200         WHEN SQLCODE = +0                                        20620001
206300              CONTINUE                                            20630001
206400                                                                  20640001
206500         WHEN SQLWARN0 NOT = SPACES                               20650001
206600         WHEN SQLCODE < +0                                        20660001
206700         WHEN SQLCODE > +0                                        20670001
206800                                                                  20680001
206900              MOVE SQLCODE                TO PV-DISP-SQLCODE      20690001
207000              MOVE SUT00008-TRIP-OCRNC-ID TO PV-DISP-OCRNC-ID     20700001
207100              MOVE SUT00008-BUS-AREA-ID   TO PV-DISP-BUS-AREA     20710001
207200              MOVE SUT00008-UNT-QTY       TO PV-DISP-UNT-QTY      20720001
207300              MOVE SUT00008-SKU-QTY       TO PV-DISP-SKU-QTY      20730001
207400                                                                  20740001
207500              MOVE '8840-INSERT-SUT00008'                         20750001
207600                                       TO PV-ABEND-PARAGRAPH      20760001
207700              MOVE 'INSERT SUT_BUS_AREA_SUM'                      20770001
207710                                       TO PV-DB2-OPERATION        20771001
207720              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        20772001
207730              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-2        20773001
207740              MOVE PV-DISP-UNT-QTY     TO PV-DB2-MESSAGE-3        20774001
207750              MOVE PV-DISP-SKU-QTY     TO PV-DB2-MESSAGE-4        20775001
207760              MOVE 'SUT_BUS_AREA_SUM ' TO PV-ABEND-TABLE-1        20776001
207770              MOVE ' '                 TO PV-ABEND-TABLE-2        20777001
207780              MOVE ' '                 TO PV-ABEND-TABLE-3        20778001
207790              MOVE ' '                 TO PV-ABEND-TABLE-4        20779001
207800              MOVE ' '                 TO PV-ABEND-TABLE-5        20780001
207801                                                                  20780101
207802              PERFORM 9900-DB2-ERROR                              20780201
207803     END-EVALUATE.                                                20780301
207804                                                                  20780401
207805                                                                  20780501
207806******************************************************************20780601
207807*                                                                 20780701
207808******************************************************************20780801
207809 8845-UPDATE-SUT00008.                                            20780901
207810                                                                  20781001
207820     IF  PS-DISPLAY-PARA-YES                                      20782001
207830         DISPLAY ' SUKUT576 - 8845-UPDATE-SUT00008          '     20783001
207840     END-IF.                                                      20784001
207850                                                                  20785001
207860     EXEC SQL                                                     20786001
207870          UPDATE SUT_BUS_AREA_SUM                                 20787001
207880             SET  UNT_QTY          = :SUT00008-UNT-QTY            20788001
207890               ,  SKU_QTY          = :SUT00008-SKU-QTY            20789001
207900               ,  CART_QTY         = :SUT00008-CART-QTY           20790001
208000               ,  RTL_DOL_AMT      = :SUT00008-RTL-DOL-AMT        20800001
208100               ,  COST_DOL_AMT     = :SUT00008-COST-DOL-AMT       20810001
208200           WHERE  TRIP_OCRNC_ID    = :SUT00008-TRIP-OCRNC-ID      20820001
208300             AND  BUS_AREA_ID      = :SUT00008-BUS-AREA-ID        20830001
208400     END-EXEC.                                                    20840001
208500                                                                  20850001
208600     EVALUATE TRUE                                                20860001
208700         WHEN SQLCODE = +0                                        20870001
208800              CONTINUE                                            20880001
208900                                                                  20890001
209000         WHEN SQLWARN0 NOT = SPACES                               20900001
209100         WHEN SQLCODE < +0                                        20910001
209200         WHEN SQLCODE > +0                                        20920001
209300                                                                  20930001
209400              MOVE SQLCODE                TO PV-DISP-SQLCODE      20940001
209500              MOVE SUT00008-TRIP-OCRNC-ID TO PV-DISP-OCRNC-ID     20950001
209600              MOVE SUT00008-BUS-AREA-ID   TO PV-DISP-BUS-AREA     20960001
209700              MOVE SUT00008-UNT-QTY       TO PV-DISP-UNT-QTY      20970001
209800              MOVE SUT00008-SKU-QTY       TO PV-DISP-SKU-QTY      20980001
209900                                                                  20990001
210000              MOVE '8845-UPDATE-SUT00008'                         21000001
210100                                       TO PV-ABEND-PARAGRAPH      21010001
210200              MOVE 'UPDATE SUT_BUS_AREA_SUM'                      21020001
210300                                       TO PV-DB2-OPERATION        21030001
210400              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        21040001
210500              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-2        21050001
210510              MOVE PV-DISP-UNT-QTY     TO PV-DB2-MESSAGE-3        21051001
210520              MOVE PV-DISP-SKU-QTY     TO PV-DB2-MESSAGE-4        21052001
210530              MOVE 'SUT_BUS_AREA_SUM ' TO PV-ABEND-TABLE-1        21053001
210540              MOVE ' '                 TO PV-ABEND-TABLE-2        21054001
210550              MOVE ' '                 TO PV-ABEND-TABLE-3        21055001
210560              MOVE ' '                 TO PV-ABEND-TABLE-4        21056001
210570              MOVE ' '                 TO PV-ABEND-TABLE-5        21057001
210580                                                                  21058001
210590              PERFORM 9900-DB2-ERROR                              21059001
210600     END-EVALUATE.                                                21060001
210700                                                                  21070000
210710                                                                  21071000
210720******************************************************************21072000
210730*                                                                 21073000
210740******************************************************************21074000
210750 8860-INSERT-SUT00007.                                            21075001
210760                                                                  21076001
210770     IF  PS-DISPLAY-PARA-YES                                      21077001
210780         DISPLAY ' SUKUT576 - 8860-INSERT-SUT00007          '     21078001
210790     END-IF.                                                      21079001
210800                                                                  21080001
210900     EXEC SQL                                                     21090001
211000          INSERT                                                  21100001
211100            INTO SUT_TRIP_SUM                                     21110001
211200                 (                                                21120000
211210                  TRIP_OCRNC_ID                                   21121000
211220               ,  OTBND_TRIP_ID                                   21122001
211230               ,  CRE_TMST                                        21123001
211240               ,  UNT_QTY                                         21124001
211250               ,  SKU_QTY                                         21125001
211260               ,  CART_QTY                                        21126001
211270               ,  RTL_DOL_AMT                                     21127001
211280               ,  COST_DOL_AMT                                    21128001
211290                 )                                                21129001
211300          VALUES (                                                21130001
211400                 :SUT00007-TRIP-OCRNC-ID                          21140001
211500              ,  :SUT00007-OTBND-TRIP-ID                          21150001
211600              ,  :PV-CURRENT-TIMESTAMP                            21160001
211700              ,  :SUT00007-UNT-QTY                                21170001
211800              ,  :SUT00007-SKU-QTY                                21180001
211900              ,  :SUT00007-CART-QTY                               21190001
212000              ,  :SUT00007-RTL-DOL-AMT                            21200001
212100              ,  :SUT00007-COST-DOL-AMT                           21210001
212200                 )                                                21220001
212300     END-EXEC.                                                    21230001
212400                                                                  21240001
212500     EVALUATE TRUE                                                21250001
212600         WHEN SQLCODE = +0                                        21260001
212700              SET PS-INSERT-DONE      TO TRUE                     21270001
212800                                                                  21280001
212900         WHEN SQLCODE = -803                                      21290001
213000              SET PS-NO-INSERT-DONE   TO TRUE                     21300001
213100              PERFORM 5000-CREATE-TRIP-OCCURENCE-ID               21310001
213200              MOVE DK-TRIP-OCRNC-ID TO SUT00007-TRIP-OCRNC-ID     21320001
213300                                                                  21330001
213400         WHEN SQLWARN0 NOT = SPACES                               21340001
213500         WHEN SQLCODE < +0                                        21350001
213600         WHEN SQLCODE > +0                                        21360001
213700                                                                  21370001
213800              MOVE SQLCODE                TO PV-DISP-SQLCODE      21380001
213900              MOVE SUT00007-TRIP-OCRNC-ID TO PV-DISP-OCRNC-ID     21390001
214000              MOVE SUT00007-OTBND-TRIP-ID TO PV-DISP-TRIP         21400001
214100              MOVE SUT00007-UNT-QTY       TO PV-DISP-UNT-QTY      21410001
214200              MOVE SUT00007-SKU-QTY       TO PV-DISP-SKU-QTY      21420001
214300                                                                  21430001
214400              MOVE '8860-INSERT-SUT00007'                         21440001
214500                                       TO PV-ABEND-PARAGRAPH      21450001
214600              MOVE 'INSERT SUT_TRIP_SUM'                          21460001
214700                                       TO PV-DB2-OPERATION        21470001
214800              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        21480001
214810              MOVE PV-DISP-TRIP        TO PV-DB2-MESSAGE-2        21481001
214820              MOVE PV-DISP-UNT-QTY     TO PV-DB2-MESSAGE-3        21482001
214830              MOVE PV-DISP-SKU-QTY     TO PV-DB2-MESSAGE-4        21483001
214840              MOVE 'SUT_TRIP_SUM     ' TO PV-ABEND-TABLE-1        21484001
214850              MOVE ' '                 TO PV-ABEND-TABLE-2        21485001
214860              MOVE ' '                 TO PV-ABEND-TABLE-3        21486001
214870              MOVE ' '                 TO PV-ABEND-TABLE-4        21487001
214880              MOVE ' '                 TO PV-ABEND-TABLE-5        21488001
214890                                                                  21489001
214900              PERFORM 9900-DB2-ERROR                              21490001
214910     END-EVALUATE.                                                21491000
214920                                                                  21492001
214930                                                                  21493001
214940******************************************************************21494001
214950*                                                                 21495001
214960******************************************************************21496001
214970 8870-UPDATE-SUT00007.                                            21497001
214980                                                                  21498001
214990     IF  PS-DISPLAY-PARA-YES                                      21499001
215000         DISPLAY ' SUKUT576 - 8870-UPDATE-SUT00007          '     21500001
215100     END-IF.                                                      21510001
215200                                                                  21520000
215300     EXEC SQL                                                     21530000
215400          UPDATE  SUT_TRIP_SUM                                    21540000
215500             SET  UNT_QTY         = :SUT00007-UNT-QTY             21550000
215600               ,  SKU_QTY         = :SUT00007-SKU-QTY             21560000
215700               ,  CART_QTY        = :SUT00007-CART-QTY            21570000
215800               ,  RTL_DOL_AMT     = :SUT00007-RTL-DOL-AMT         21580000
215900               ,  COST_DOL_AMT    = :SUT00007-COST-DOL-AMT        21590000
216000           WHERE TRIP_OCRNC_ID    = :SUT00007-TRIP-OCRNC-ID       21600000
216100             AND OTBND_TRIP_ID    = :SUT00007-OTBND-TRIP-ID       21610000
216200     END-EXEC.                                                    21620000
216300                                                                  21630000
216400     EVALUATE TRUE                                                21640000
216500         WHEN SQLCODE = +0                                        21650000
216600              CONTINUE                                            21660000
216700                                                                  21670000
216800         WHEN SQLWARN0 NOT = SPACES                               21680000
216900         WHEN SQLCODE < +0                                        21690000
217000         WHEN SQLCODE > +0                                        21700000
217100                                                                  21710001
217200              MOVE SQLCODE                TO PV-DISP-SQLCODE      21720001
217300              MOVE SUT00007-TRIP-OCRNC-ID TO PV-DISP-OCRNC-ID     21730001
217400              MOVE SUT00007-OTBND-TRIP-ID TO PV-DISP-TRIP         21740001
217500              MOVE SUT00007-UNT-QTY       TO PV-DISP-UNT-QTY      21750001
217600              MOVE SUT00007-SKU-QTY       TO PV-DISP-SKU-QTY      21760001
217610                                                                  21761001
217620              MOVE '8870-UPDATE-SUT00007'                         21762001
217630                                       TO PV-ABEND-PARAGRAPH      21763001
217640              MOVE 'UPDATE SUT_TRIP_SUM'                          21764001
217650                                       TO PV-DB2-OPERATION        21765001
217660              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        21766001
217670              MOVE PV-DISP-TRIP        TO PV-DB2-MESSAGE-2        21767001
217680              MOVE PV-DISP-UNT-QTY     TO PV-DB2-MESSAGE-3        21768001
217690              MOVE PV-DISP-SKU-QTY     TO PV-DB2-MESSAGE-4        21769001
217691              MOVE 'SUT_TRIP_SUM     ' TO PV-ABEND-TABLE-1        21769101
217692              MOVE ' '                 TO PV-ABEND-TABLE-2        21769201
217693              MOVE ' '                 TO PV-ABEND-TABLE-3        21769301
217694              MOVE ' '                 TO PV-ABEND-TABLE-4        21769401
217695              MOVE ' '                 TO PV-ABEND-TABLE-5        21769501
217696                                                                  21769601
217697              PERFORM 9900-DB2-ERROR                              21769701
217698     END-EVALUATE.                                                21769801
217699                                                                  21769901
217700                                                                  21770001
217800******************************************************************21780001
217810*                                                                 21781001
217820******************************************************************21782001
217830 8880-INSERT-SUT00011.                                            21783001
217840                                                                  21784001
217850     IF  PS-DISPLAY-PARA-YES                                      21785001
217860         DISPLAY ' SUKUT576 - 8880-INSERT-SUT00011          '     21786001
217870     END-IF.                                                      21787001
217880                                                                  21788001
217890     EXEC SQL                                                     21789001
217900          INSERT                                                  21790001
218000            INTO SUT_MAJ_CL_AD_DTE                                21800001
218100                 (                                                21810001
218200                  TRIP_OCRNC_ID                                   21820001
218300               ,  BUS_AREA_ID                                     21830001
218400               ,  DEPT_NBR                                        21840001
218500               ,  MAJ_CL_NBR                                      21850001
218600               ,  AD_EVNT_DTE                                     21860001
218700                 )                                                21870001
218800          VALUES (                                                21880000
218900                 :SUT00011-TRIP-OCRNC-ID                          21890000
219000              ,  :SUT00011-BUS-AREA-ID                            21900000
219100              ,  :SUT00011-DEPT-NBR                               21910000
219200              ,  :SUT00011-MAJ-CL-NBR                             21920000
219300              ,  :SUT00011-AD-EVNT-DTE                            21930000
219310                 )                                                21931000
219320     END-EXEC.                                                    21932001
219330                                                                  21933001
219340     EVALUATE TRUE                                                21934001
219350         WHEN SQLCODE = +0                                        21935001
219360              CONTINUE                                            21936001
219370                                                                  21937001
219380         WHEN SQLWARN0 NOT = SPACES                               21938001
219390         WHEN SQLCODE < +0                                        21939001
219400         WHEN SQLCODE > +0                                        21940001
219500                                                                  21950001
219600              MOVE SQLCODE                TO PV-DISP-SQLCODE      21960001
219700              MOVE SUT00011-TRIP-OCRNC-ID TO PV-DISP-OCRNC-ID     21970001
219800              MOVE SUT00011-BUS-AREA-ID   TO PV-DISP-BUS-AREA     21980001
219900              MOVE SUT00011-DEPT-NBR      TO PV-DISP-DEPT         21990001
220000              MOVE SUT00011-MAJ-CL-NBR    TO PV-DISP-MAJ-CL       22000001
220100                                                                  22010001
220200              MOVE '8880-INSERT-SUT00011'                         22020001
220300                                       TO PV-ABEND-PARAGRAPH      22030001
220400              MOVE 'INSERT SUT_MAJ_CL_AD_DTE'                     22040001
220500                                       TO PV-DB2-OPERATION        22050001
220600              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        22060001
220700              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-2        22070001
220800              MOVE PV-DISP-DEPT        TO PV-DB2-MESSAGE-3        22080001
220810              MOVE PV-DISP-MAJ-CL      TO PV-DB2-MESSAGE-4        22081001
220820              MOVE 'SUT_MAJ_CL_AD_DTE' TO PV-ABEND-TABLE-1        22082001
220830              MOVE ' '                 TO PV-ABEND-TABLE-2        22083001
220840              MOVE ' '                 TO PV-ABEND-TABLE-3        22084001
220850              MOVE ' '                 TO PV-ABEND-TABLE-4        22085001
220860              MOVE ' '                 TO PV-ABEND-TABLE-5        22086001
220870                                                                  22087001
220880              PERFORM 9900-DB2-ERROR                              22088001
220890     END-EVALUATE.                                                22089001
220900                                                                  22090001
221000                                                                  22100001
221100******************************************************************22110001
221110*                                                                 22111001
221120******************************************************************22112001
221130 8891-INSERT-SUT00066.                                            22113001
221140                                                                  22114001
221150     IF  PS-DISPLAY-PARA-YES                                      22115001
221160         DISPLAY ' SUKUT576 - 8891-INSERT-SUT00066          '     22116001
221170     END-IF.                                                      22117001
221180                                                                  22118001
221190     EXEC SQL                                                     22119001
221200          INSERT                                                  22120001
221300            INTO SUT_BRND_MDSE_SUM                                22130001
221400                 (                                                22140001
221500                  BUS_AREA_ID                                     22150001
221600               ,  TRIP_OCRNC_ID                                   22160001
221700               ,  BRND_ID                                         22170001
221800               ,  UNT_QTY                                         22180001
221900               ,  SKU_QTY                                         22190001
222000               ,  CART_QTY                                        22200001
222100               ,  RTL_DOL_AMT                                     22210001
222200               ,  COST_DOL_AMT                                    22220001
222300               ,  PRC_MSG_RPLN_NEW_IND                            22230001
222400               ,  HNG_FOLD_CDE                                    22240001
222500                 )                                                22250001
222600          VALUES (                                                22260000
222700                 :SUT00066-BUS-AREA-ID                            22270000
222800              ,  :SUT00066-TRIP-OCRNC-ID                          22280000
222900              ,  :SUT00066-BRND-ID                                22290000
223000              ,  :SUT00066-UNT-QTY                                22300000
223100              ,  :SUT00066-SKU-QTY                                22310000
223200              ,  :SUT00066-CART-QTY                               22320000
223300              ,  :SUT00066-RTL-DOL-AMT                            22330000
223400              ,  :SUT00066-COST-DOL-AMT                           22340000
223500              ,  :SUT00066-PRC-MSG-RPLN-NEW-IND                   22350000
223600              ,  :SUT00066-HNG-FOLD-CDE                           22360000
223610                 )                                                22361000
223620     END-EXEC.                                                    22362001
223630                                                                  22363001
223640     EVALUATE TRUE                                                22364001
223650         WHEN SQLCODE = +0                                        22365001
223660              CONTINUE                                            22366001
223670                                                                  22367001
223680         WHEN SQLWARN0 NOT = SPACES                               22368001
223690         WHEN SQLCODE < +0                                        22369001
223700         WHEN SQLCODE > +0                                        22370001
223800                                                                  22380001
223900              MOVE SQLCODE                TO PV-DISP-SQLCODE      22390001
224000              MOVE SUT00066-TRIP-OCRNC-ID TO PV-DISP-OCRNC-ID     22400001
224100              MOVE SUT00066-BUS-AREA-ID   TO PV-DISP-BUS-AREA     22410001
224200              MOVE SUT00066-BRND-ID       TO PV-DISP-BRAND        22420001
224300              MOVE SUT00066-UNT-QTY       TO PV-DISP-UNT-QTY      22430001
224400                                                                  22440001
224500              MOVE '8891-INSERT-SUT00066'                         22450001
224600                                       TO PV-ABEND-PARAGRAPH      22460001
224700              MOVE 'INSERT SUT_BRND_MDSE_SUM'                     22470001
224800                                       TO PV-DB2-OPERATION        22480001
224900              MOVE PV-DISP-OCRNC-ID    TO PV-DB2-MESSAGE-1        22490001
225000              MOVE PV-DISP-BUS-AREA    TO PV-DB2-MESSAGE-2        22500001
225100              MOVE PV-DISP-BRAND       TO PV-DB2-MESSAGE-3        22510001
225200              MOVE PV-DISP-UNT-QTY     TO PV-DB2-MESSAGE-4        22520001
225210              MOVE 'SUT_BRND_MDSE_SUM' TO PV-ABEND-TABLE-1        22521001
225220              MOVE ' '                 TO PV-ABEND-TABLE-2        22522001
225230              MOVE ' '                 TO PV-ABEND-TABLE-3        22523001
225240              MOVE ' '                 TO PV-ABEND-TABLE-4        22524001
225250              MOVE ' '                 TO PV-ABEND-TABLE-5        22525001
225260                                                                  22526001
225270              PERFORM 9900-DB2-ERROR                              22527001
225280     END-EVALUATE.                                                22528001
225290                                                                  22529001
225300                                                                  22530001
225400******************************************************************22540001
225500*                                                                 22550001
225510******************************************************************22551001
225520 8900-SELECT-CURRENT-DATE.                                        22552001
225530                                                                  22553001
225540     IF  PS-DISPLAY-PARA-YES                                      22554001
225550         DISPLAY ' SUKUT576 - 8900-SELECT-CURRENT-DATE      '     22555001
225560     END-IF.                                                      22556001
225570                                                                  22557001
225580     EXEC SQL                                                     22558001
225590         SELECT  DISTINCT CURRENT TIMESTAMP                       22559001
225600           INTO :PV-CURRENT-TIMESTAMP                             22560001
225700           FROM  SYSIBM.SYSDUMMY1                                 22570001
225800     END-EXEC.                                                    22580001
225900                                                                  22590001
226000     EVALUATE TRUE                                                22600001
226100         WHEN SQLCODE = ZEROS                                     22610001
226200              DISPLAY ' CURRENT TMST: '  PV-CURRENT-TIMESTAMP     22620001
226300              CONTINUE                                            22630001
226400                                                                  22640001
226500         WHEN OTHER                                               22650001
226600                                                                  22660001
226700              MOVE SQLCODE                TO PV-DISP-SQLCODE      22670001
226800                                                                  22680001
226900              MOVE '8900-SELECT-CURRENT-DATE'                     22690001
227000                                       TO PV-ABEND-PARAGRAPH      22700001
227100              MOVE 'SELECT CURRENT TIMESTAMP'                     22710001
227200                                       TO PV-DB2-OPERATION        22720001
227300              MOVE ' '                 TO PV-DB2-MESSAGE-1        22730001
227400              MOVE ' '                 TO PV-DB2-MESSAGE-2        22740001
227410              MOVE ' '                 TO PV-DB2-MESSAGE-3        22741001
227420              MOVE ' '                 TO PV-DB2-MESSAGE-4        22742001
227430              MOVE 'SYSIBM.SYSDUMMY1 ' TO PV-ABEND-TABLE-1        22743001
227440              MOVE ' '                 TO PV-ABEND-TABLE-2        22744001
227450              MOVE ' '                 TO PV-ABEND-TABLE-3        22745001
227460              MOVE ' '                 TO PV-ABEND-TABLE-4        22746001
227470              MOVE ' '                 TO PV-ABEND-TABLE-5        22747001
227480                                                                  22748001
227490              PERFORM 9900-DB2-ERROR                              22749001
227500     END-EVALUATE.                                                22750001
227600                                                                  22760000
227700                                                                  22770000
227710******************************************************************22771000
227720*                                                                 22772000
227730******************************************************************22773000
227740 9000-FINIS.                                                      22774001
227750                                                                  22775001
227760     IF  PS-DISPLAY-PARA-YES                                      22776001
227770         DISPLAY ' SUKUT576 - 9000-FINIS                    '     22777001
227780     END-IF.                                                      22778001
227790                                                                  22779001
227800     MOVE  PC047-COMMAREA               TO LINK-COMMAREA.         22780001
227900                                                                  22790001
227910     MOVE  PC047-OPER-UNT-ID            TO PV-DISP-OPER.          22791001
227920     MOVE  PC047-DEST-OPER-UNT-ID       TO PV-DISP-DEST.          22792001
227921     MOVE  SUT00007-CART-QTY            TO PV-DISP-TOTAL-CNT.     22792101
227922     MOVE  SUT00007-UNT-QTY             TO PV-DISP-TOTAL-UNT.     22792201
227923                                                                  22792301
227924     DISPLAY ' OPER: '         PV-DISP-OPER                       22792401
227925             ' DEST: '         PV-DISP-DEST                       22792501
227926             ' DOOR: '         PC047-DOOR-ID                      22792601
227927             ' TYPE: '         PC047-DOOR-TYPE-CDE                22792701
227928             ' TOTAL CNT: '    PV-DISP-TOTAL-CNT                  22792801
227929             ' TOTAL UNT: '    PV-DISP-TOTAL-UNT                  22792901
227930                                                                  22793001
227940     DISPLAY '------------------------------------------'.        22794001
227950                                                                  22795001
227960                                                                  22796001
227970     GOBACK.                                                      22797001
227980                                                                  22798001
227990                                                                  22799001
228000******************************************************************22800001
228100* 9900-DB2-ERROR - PERFORMS THE DISPLAY OF THE FORMATTED DB2      22810001
228200* MESSAGE IN THE EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.  22820001
228300******************************************************************22830001
228400 9900-DB2-ERROR.                                                  22840001
228500                                                                  22850001
228600     IF  PS-DISPLAY-PARA-YES                                      22860001
228700         DISPLAY ' SUKUT576 - 9900-DB2-ERROR                '     22870001
228800     END-IF.                                                      22880001
228900                                                                  22890001
229000     DISPLAY '*** SUKUT576 - 9900-DB2-ERROR                '.     22900001
229100     DISPLAY '***'.                                               22910001
229200     DISPLAY '******* START OF SUKUT576 ERROR DISPLAY *******'    22920001
229300     DISPLAY '*** DB2 ERROR ***'.                                 22930001
229400     DISPLAY '*** SQLCODE   = ' PV-DISP-SQLCODE.                  22940001
229500     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 22950001
229600     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               22960001
229700     DISPLAY '*** OPERATION = ' PV-DB2-OPERATION                  22970001
229800     DISPLAY '***'.                                               22980001
229900     DISPLAY '*** KEY FIELD = ' PV-DB2-MESSAGE-1                  22990001
230000     DISPLAY '***           = ' PV-DB2-MESSAGE-2                  23000001
230100     DISPLAY '***           = ' PV-DB2-MESSAGE-3                  23010001
230200     DISPLAY '***           = ' PV-DB2-MESSAGE-4                  23020001
230300     DISPLAY '***'.                                               23030001
230400     DISPLAY '*** TABLES    = ' PV-ABEND-TABLE-1.                 23040001
230500     DISPLAY '***           = ' PV-ABEND-TABLE-2.                 23050001
230600     DISPLAY '***           = ' PV-ABEND-TABLE-3.                 23060001
230700     DISPLAY '***           = ' PV-ABEND-TABLE-4.                 23070001
230800     DISPLAY '***           = ' PV-ABEND-TABLE-5.                 23080001
230900     DISPLAY '***'.                                               23090001
231000                                                                  23100001
231100     SET  PC047-SQL-ERROR       TO  TRUE.                         23110001
231200     MOVE SQLCODE               TO  PC047-SQLCODE.                23120001
231300     MOVE PV-DB2-OPERATION      TO  PC047-SQLCA.                  23130001
231400     MOVE PV-ABEND-PARAGRAPH    TO  PC047-PARAGRAPH.              23140001
231500     MOVE PV-ABEND-TABLE-1      TO  PC047-DB2-TABLE-NAME(1).      23150001
231600     MOVE PV-ABEND-TABLE-2      TO  PC047-DB2-TABLE-NAME(2).      23160001
231700     MOVE PV-ABEND-TABLE-3      TO  PC047-DB2-TABLE-NAME(3).      23170001
231800     MOVE PV-ABEND-TABLE-4      TO  PC047-DB2-TABLE-NAME(4).      23180001
231900     MOVE PV-ABEND-TABLE-5      TO  PC047-DB2-TABLE-NAME(5).      23190001
232000                                                                  23200001
232100     COPY DPPD004.                                                23210001
232200                                                                  23220001
232300     MOVE +4013                  TO PV-ABEND-CODE.                23230001
232400     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         23240001
232500                                                                  23250001
232600                                                                  23260001
232700***************************************************************** 23270001
232800* PCPD049 - PROCEDURE DIVISION USED TO DETERMINE TRAILER CONTENTS 23280001
232900***************************************************************** 23290001
233000     COPY PCPD049.                                                23300001
