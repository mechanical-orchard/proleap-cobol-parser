000100*                                                                 06/20/94
000200*                                                                 DPKCS031
000300*                                                                    LV001
000400 IDENTIFICATION DIVISION.                                         DPKCS031
000500                                                                  DPKCS031
000600 PROGRAM-ID.    DPKCS031.                                         DPKCS031
000700 AUTHOR.        DAN FRANKLIN.                                     DPKCS031
000800 INSTALLATION.  KOHLS DEPARTMENT STORES.                          DPKCS031
000900 DATE-WRITTEN.  06-11-92.                                         DPKCS031
001000 DATE-COMPILED.                                                   DPKCS031
001100                                                                  DPKCS031
001200***************************************************************** DPKCS031
001300*    FUNCTION KEY LIST (Z031)                                     DPKCS031
001400*                                                                 DPKCS031
001500*    THIS PROGRAM LISTS THE FUNCTION KEYS ASSIGNED TO A           DPKCS031
001600*    MNEMONIC.  IT HAS BEEN COPIED FROM DPKCS017 AND HAD          DPKCS031
001700*    THE UPDATE LOGIC REMOVED.                                    DPKCS031
001800*                                                                 DPKCS031
001900***************************************************************** DPKCS031
002000*    03/22/96 -      - MADE BY CHERI MASTEL, TKMA235              DPKCS017
002100*                                                                       17
002200*    1) ADDED LOGIC FOR CICS24X7 PROCESSING; ARCHITECTURE                 
002300*       CHANGES TO ALLOW CICS TO BE UP 24HRS/DAY, 7DAYS/WEEK.             
002400*       ALSO ADDED LOGIC FOR FUNCTION KEY PROJECT:                        
002500*       * MODIFIED THE MAP (DPKM031) AND PROGRAM TO DISPLAY "DISP"        
002600*         FIELD AFTER "ACTION" FIELD.                                     
002700*         THE VALUE TO DISPLAY IN THE "DISP" FIELD WILL COME FROM         
002800*         THE FUNC_KY_DISPN_IND FIELD ON THE TCICSROUTE DB2 TABLE.        
002900***************************************************************** DPKCS017
003000                                                                  DPKCS031
003100*                                                                 DPKCS031
003200*                                                                 DPKCS031
003300*                                                                 DPKCS031
003400 ENVIRONMENT DIVISION.                                            DPKCS031
003500*                                                                 DPKCS031
003600*                                                                 DPKCS031
003700*                                                                 DPKCS031
003800 DATA DIVISION.                                                   DPKCS031
003900*                                                                 DPKCS031
004000*                                                                 DPKCS031
004100 WORKING-STORAGE SECTION.                                         DPKCS031
004200                                                                  DPKCS031
004300 01  IV-INDICATOR-VARIABLES.                                      DPKCS031
004400     05  IV-PANEL-TITLE-NAME            PIC S9(04)   VALUE +0     DPKCS031
004500                                                     COMP SYNC.   DPKCS031
004600     05  IV-MNEMONIC-CODE               PIC S9(04)   VALUE +0     DPKCS031
004700                                                     COMP SYNC.   DPKCS031
004800                                                                  DPKCS031
004900 01  PC-PROGRAM-CONSTANTS.                                        DPKCS031
005000     05  PC-NAVIGATOR-TRAN-ID           PIC X(04)    VALUE 'Z008'.DPKCS031
005100     05  PC-MAXIMUM-COMMAREA-LENGTH     PIC S9(04)   VALUE +4072  DPKCS031
005200                                                     COMP SYNC.   DPKCS031
005300     05  PC-NULL-INDICATOR              PIC S9(04)   VALUE -1     DPKCS031
005400                                                     COMP SYNC.   DPKCS031
005500     05  PC-CURRENT-MAP-NAME            PIC X(08)    VALUE        DPKCS031
005600     'DP031A  '.                                                  DPKCS031
005700     05  PC-CURRENT-MAPSET-NAME         PIC X(08)    VALUE        DPKCS031
005800     'DPKM031 '.                                                  DPKCS031
005900     05  PC-CURRENT-PROGRAM-NAME        PIC X(08)    VALUE        DPKCS031
006000     'DPKCS031'.                                                  DPKCS031
006100     05  PC-ACKNOWLEDGE-CODE            PIC X(04)    VALUE 'CMIA'.DPKCS031
006200     05  PC-STACK                       PIC X(01)    VALUE 'Y'.   DPKCS031
006300     05  PC-NO-STACK                    PIC X(01)    VALUE 'N'.   DPKCS031
006400     05  PC-SYSWIDE                     PIC X(01)    VALUE 'Y'.   DPKCS031
006500     05  PC-NOT-SYSWIDE                 PIC X(01)    VALUE 'N'.   DPKCS031
006600     05  PC-CONFIRMED                   PIC X(01)    VALUE 'Y'.   DPKCS031
006700     05  PC-NOT-CONFIRMED               PIC X(01)    VALUE 'N'.   DPKCS031
006800     05  PC-MNDTRY                      PIC X(01)    VALUE 'Y'.   DPKCS031
006900     05  PC-NOT-MNDTRY                  PIC X(01)    VALUE 'N'.   DPKCS031
007000     05  PC-SELECT                      PIC X(01)    VALUE 'S'.   DPKCS031
007100     05  PC-GO-TO-MNEMONIC              PIC X(01)    VALUE '1'.   DPKCS031
007200     05  PC-RETURN                      PIC X(01)    VALUE '2'.   DPKCS031
007300     05  PC-CONFIRM                     PIC X(01)    VALUE '3'.   DPKCS031
007400     05  PC-NAV-REFRESH                 PIC X(01)    VALUE '4'.   DPKCS031
007500     05  PC-PREVPAGE                    PIC X(01)    VALUE '5'.   DPKCS031
007600     05  PC-NEXTPAGE                    PIC X(01)    VALUE '6'.   DPKCS031
007700     05  PC-1ST-PAGE                    PIC X(01)    VALUE '7'.   DPKCS031
007800     05  PC-DSEL-ALL                    PIC X(01)    VALUE '9'.   DPKCS031
007900     05  PC-SEL-ALL                     PIC X(01)    VALUE 'A'.   DPKCS031
008000     05  PC-LOCAL-GOTO                  PIC X(01)    VALUE 'B'.   DPKCS031
008100     05  PC-FK-LEFT                     PIC X(01)    VALUE 'C'.   DPKCS031
008200     05  PC-FK-RIGHT                    PIC X(01)    VALUE 'D'.   DPKCS031
008300     05  PC-FK-PREV-SELECTION           PIC X(01)    VALUE 'E'.   DPKCS031
008400     05  PC-FK-NEXT-SELECTION           PIC X(01)    VALUE 'F'.   DPKCS031
008500     05  PC-LOCAL-FUNC-KEY              PIC X(01)    VALUE '8'.   DPKCS031
008600     05  PC-CREATED                     PIC X(01)    VALUE '1'.   DPKCS031
008700     05  PC-UPDATED                     PIC X(01)    VALUE '2'.   DPKCS031
008800     05  PC-DELETED                     PIC X(01)    VALUE '3'.   DPKCS031
008900     05  PC-SELECTED                    PIC X(01)    VALUE '4'.   DPKCS031
009000     05  PC-ERROR                       PIC X(01)    VALUE '5'.   DPKCS031
009100     05  PC-STATUS-ACTIVE               PIC X(08)    VALUE        DPKCS031
009200                                                     'ACTIVE'.    DPKCS031
009300     05  PC-STATUS-INACTIVE             PIC X(08)    VALUE        DPKCS031
009400                                                     'INACTIVE'.  DPKCS031
009500     05  PC-MAX-ITEMS-ON-SCREEN         PIC S9(04)   VALUE +12    DPKCS031
009600                                                     COMP SYNC.   DPKCS031
009700     05  PC-MAX-FKEYS                   PIC S9(04)   VALUE +29    DPKCS031
009800                                                     COMP SYNC.   DPKCS031
009900     05  PC-ERASE-EOF-COMP              PIC S9(04)   VALUE +128   DPKCS031
010000                                                     COMP SYNC.   DPKCS031
010100     05  FILLER REDEFINES PC-ERASE-EOF-COMP.                      DPKCS031
010200         10  FILLER                     PIC X(01).                DPKCS031
010300         10  PC-ERASE-EOF               PIC X(01).                DPKCS031
010400                                                                  DPKCS031
010500 01  PC-SYSTEM-MESSAGES.                                          DPKCS031
010600     05  PC-TSYMSG-00004                PIC 9(5)     VALUE 00004. DPKCS031
010700     05  PC-TSYMSG-00045                PIC 9(5)     VALUE 00045. DPKCS031
010800     05  PC-TSYMSG-00070                PIC 9(5)     VALUE 00070. DPKCS031
010900     05  PC-TSYMSG-00148                PIC 9(5)     VALUE 00148. DPKCS031
011000                                                                  DPKCS031
011100 01  PM-PROGRAM-MESSAGES.                                         DPKCS031
011200     05  PM-PROGRAM-MESSAGE-2           PIC X(78)    VALUE        DPKCS031
011300     'ERROR TRYING TO SELECT A ROW FROM TMNEMONIC TABLE - SQLCODE DPKCS031
011400-    ''.                                                          DPKCS031
011500     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-2.                   DPKCS031
011600         10  FILLER                     PIC X(60).                DPKCS031
011700         10  PM-SQLCODE-2               PIC Z(08)9-.              DPKCS031
011800         10  FILLER                     PIC X(08).                DPKCS031
011900     05  PM-PROGRAM-MESSAGE-3           PIC X(78)    VALUE        DPKCS031
012000     'ERROR TRYING TO OPEN CURSOR FOR TAIDKEY TABLE - SQLCODE '.  DPKCS031
012100     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-3.                   DPKCS031
012200         10  FILLER                     PIC X(56).                DPKCS031
012300         10  PM-SQLCODE-3               PIC Z(08)9-.              DPKCS031
012400         10  FILLER                     PIC X(12).                DPKCS031
012500     05  PM-PROGRAM-MESSAGE-4           PIC X(78)    VALUE        DPKCS031
012600     'ERROR TRYING TO FETCH A ROW FROM TAIDKEY TABLE - SQLCODE '. DPKCS031
012700     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-4.                   DPKCS031
012800         10  FILLER                     PIC X(57).                DPKCS031
012900         10  PM-SQLCODE-4               PIC Z(08)9-.              DPKCS031
013000         10  FILLER                     PIC X(11).                DPKCS031
013100     05  PM-PROGRAM-MESSAGE-5           PIC X(78)    VALUE        DPKCS031
013200     'ERROR TRYING TO CLOSE CURSOR FOR TAIDKEY TABLE - SQLCODE '. DPKCS031
013300     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-5.                   DPKCS031
013400         10  FILLER                     PIC X(57).                DPKCS031
013500         10  PM-SQLCODE-5               PIC Z(08)9-.              DPKCS031
013600         10  FILLER                     PIC X(11).                DPKCS031
013700     05  PM-PROGRAM-MESSAGE-6           PIC X(78)    VALUE        DPKCS031
013800     'ERROR TRYING TO SELECT A ROW FROM TCICSROUTE TABLE - SQLCODEDPKCS031
013900-    ' '.                                                         DPKCS031
014000     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-6.                   DPKCS031
014100         10  FILLER                     PIC X(61).                DPKCS031
014200         10  PM-SQLCODE-6               PIC Z(08)9-.              DPKCS031
014300         10  FILLER                     PIC X(07).                DPKCS031
014400     05  PM-PROGRAM-MESSAGE-8           PIC X(78)    VALUE        DPKCS031
014500     'ERROR TRYING TO SELECT A ROW FROM TAIDKEY TABLE - SQLCODE '.DPKCS031
014600     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-8.                   DPKCS031
014700         10  FILLER                     PIC X(58).                DPKCS031
014800         10  PM-SQLCODE-8               PIC Z(08)9-.              DPKCS031
014900         10  FILLER                     PIC X(10).                DPKCS031
015000     05  PM-PROGRAM-MESSAGE-9           PIC X(78)    VALUE        DPKCS031
015100     'NO DELETES ALLOWED ON SYSTEM WIDE FUNCTION KEYS'.           DPKCS031
015200     05  PM-PROGRAM-MESSAGE-10          PIC X(78)    VALUE        DPKCS031
015300     'ERROR TRYING TO DELETE A ROW FROM TCICSROUTE TABLE - SQLCODEDPKCS031
015400-    ' '.                                                         DPKCS031
015500     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-10.                  DPKCS031
015600         10  FILLER                     PIC X(61).                DPKCS031
015700         10  PM-SQLCODE-10              PIC Z(08)9-.              DPKCS031
015800         10  FILLER                     PIC X(07).                DPKCS031
015900     05  PM-PROGRAM-MESSAGE-11          PIC X(78)    VALUE        DPKCS031
016000     'DATABASE TIMESTAMP INCONSISTENCY FOUND, ALL DELETES BACKED ODPKCS031
016100-    'UT'.                                                        DPKCS031
016200     05  PM-PROGRAM-MESSAGE-28          PIC X(78)    VALUE        DPKCS031
016300     'INVALID NEXT APPLICATION ACTIVITY RECEIVED'.                DPKCS031
016400     05  PM-PROGRAM-MESSAGE-29          PIC X(78)    VALUE        DPKCS031
016500     'NO ADD/UPDATES ALLOWED ON SYSTEM WIDE FUNCTION KEYS'.       DPKCS031
016600     05  PM-PROGRAM-MESSAGE-31          PIC X(78)    VALUE        DPKCS031
016700     'ERROR TRYING TO ACCESS TEMP STORAGE QUEUE "B" - RESP = '.   DPKCS031
016800     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-31.                  DPKCS031
016900         10  FILLER                     PIC X(61).                DPKCS031
017000         10  PM-RESP-31                 PIC Z(08)9-.              DPKCS031
017100         10  FILLER                     PIC X(07).                DPKCS031
017200     05  PM-PROGRAM-MESSAGE-32          PIC X(78)    VALUE        DPKCS031
017300     'NO MNENOMIC OR TSQ "B" SPECIFIED - UNABLE TO PROCESS'.      DPKCS031
017400                                                                  DPKCS031
017500 01  PC-FKEY-ACTION-DESCRIPTIONS.                                 DPKCS031
017600     05  FILLER                     PIC X(9) VALUE '1GO TO   '.   DPKCS031
017700     05  FILLER                     PIC X(9) VALUE '2RETURN  '.   DPKCS031
017800     05  FILLER                     PIC X(9) VALUE '3CONFIRM '.   DPKCS031
017900     05  FILLER                     PIC X(9) VALUE '4REFRESH '.   DPKCS031
018000     05  FILLER                     PIC X(9) VALUE '5PREVPAGE'.   DPKCS031
018100     05  FILLER                     PIC X(9) VALUE '6NEXTPAGE'.   DPKCS031
018200     05  FILLER                     PIC X(9) VALUE '71ST PAGE'.   DPKCS031
018300     05  FILLER                     PIC X(9) VALUE '8LOCALKEY'.   DPKCS031
018400     05  FILLER                     PIC X(9) VALUE '9DESELECT'.   DPKCS031
018500     05  FILLER                     PIC X(9) VALUE 'ASLECTALL'.   DPKCS031
018600     05  FILLER                     PIC X(9) VALUE 'BLOCAL GO'.   DPKCS031
018700     05  FILLER                     PIC X(9) VALUE 'CLEFT    '.   DPKCS031
018800     05  FILLER                     PIC X(9) VALUE 'DRIGHT   '.   DPKCS031
018900     05  FILLER                     PIC X(9) VALUE 'EPREV SEL'.   DPKCS031
019000     05  FILLER                     PIC X(9) VALUE 'FNEXT SEL'.   DPKCS031
019100     05  FILLER                     PIC X(9) VALUE 'GLOCALRET'.   DPKCS031
019200     05  FILLER                     PIC X(9) VALUE 'OLOCAL-01'.   DPKCS031
019300     05  FILLER                     PIC X(9) VALUE 'PLOCAL-02'.   DPKCS031
019400     05  FILLER                     PIC X(9) VALUE 'QLOCAL-03'.   DPKCS031
019500     05  FILLER                     PIC X(9) VALUE 'RLOCAL-04'.   DPKCS031
019600     05  FILLER                     PIC X(9) VALUE 'SLOCAL-05'.   DPKCS031
019700     05  FILLER                     PIC X(9) VALUE 'TLOCAL-06'.   DPKCS031
019800     05  FILLER                     PIC X(9) VALUE 'ULOCAL-07'.   DPKCS031
019900     05  FILLER                     PIC X(9) VALUE 'VLOCAL-08'.   DPKCS031
020000     05  FILLER                     PIC X(9) VALUE 'WLOCAL-09'.   DPKCS031
020100     05  FILLER                     PIC X(9) VALUE 'XLOCAL-10'.   DPKCS031
020200     05  FILLER                     PIC X(9) VALUE 'YLOCAL-11'.   DPKCS031
020300     05  FILLER                     PIC X(9) VALUE 'ZLOCAL-12'.   DPKCS031
020400     05  FILLER                     PIC X(9) VALUE HIGH-VALUES.   DPKCS031
020500 01  FILLER  REDEFINES  PC-FKEY-ACTION-DESCRIPTIONS.              DPKCS031
020600     05  PT-FKEY-TABLE OCCURS 29 INDEXED BY PT-FT-IND.            DPKCS031
020700         10  PT-FT-ACT                  PIC X.                    DPKCS031
020800         10  PT-FT-DESC                 PIC X(8).                 DPKCS031
020900                                                                  DPKCS031
021000 01  PS-PROGRAM-SUBSCRIPTS.                                       DPKCS031
021100     05  PS-SUB                         PIC S9(04)   VALUE +0     DPKCS031
021200                                                     COMP SYNC.   DPKCS031
021300     05  PS-SAVE-SUB                    PIC S9(04)   VALUE +0     DPKCS031
021400                                                     COMP SYNC.   DPKCS031
021500                                                                  DPKCS031
021600 01  PS-PROGRAM-SWITCHES.                                         DPKCS031
021700     05  PS-MAP-SEND-TYPE               PIC X(01)    VALUE '1'.   DPKCS031
021800         88  PS-SEND-MAP-N-DATA-FRSET                VALUE '1'.   DPKCS031
021900         88  PS-SEND-MAP-N-DATA-FRSET-CPOSN          VALUE '2'.   DPKCS031
022000         88  PS-SEND-DATA-ONLY-FRSET                 VALUE '3'.   DPKCS031
022100         88  PS-SEND-DATA-ONLY                       VALUE '4'.   DPKCS031
022200         88  PS-SEND-DATA-ONLY-ERASEAUP              VALUE '5'.   DPKCS031
022300         88  PS-SEND-MAP-ONLY-FRSET                  VALUE '6'.   DPKCS031
022400     05  PS-NEW-MNEMONIC-REQUESTED-SW   PIC X(01)    VALUE 'N'.   DPKCS031
022500         88  PS-NEW-MNEMONIC-REQUESTED               VALUE 'Y'.   DPKCS031
022600         88  PS-NEW-MNEMONIC-NOT-REQUESTED           VALUE 'N'.   DPKCS031
022700     05  PS-LOCAL-FUNCTION-KEY-SW       PIC X(01)    VALUE 'N'.   DPKCS031
022800         88  PS-LOCAL-FUNCTION-KEY                   VALUE 'Y'.   DPKCS031
022900         88  PS-NO-LOCAL-FUNCTION-KEY                VALUE 'N'.   DPKCS031
023000     05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.   DPKCS031
023100         88  PS-ERROR                                VALUE 'Y'.   DPKCS031
023200         88  PS-NO-ERROR                             VALUE 'N'.   DPKCS031
023300     05  PS-INSERT-UPDATE-SW            PIC X(01)    VALUE 'N'.   DPKCS031
023400         88  PS-INSERT                               VALUE 'Y'.   DPKCS031
023500         88  PS-UPDATE                               VALUE 'N'.   DPKCS031
023600     05  PS-ITEM-SELECTED-SW            PIC X(01)    VALUE 'N'.   DPKCS031
023700         88  PS-ITEM-SELECTED                        VALUE 'Y'.   DPKCS031
023800         88  PS-NO-ITEM-SELECTED                     VALUE 'N'.   DPKCS031
023900     05  PS-EDITING-ACT-SW              PIC X(01)    VALUE 'N'.   DPKCS031
024000         88  PS-EDITING-ACT                          VALUE 'Y'.   DPKCS031
024100         88  PS-NO-EDITING-ACT                       VALUE 'N'.   DPKCS031
024200     05  PS-WARNING-SWITCH              PIC X(01)    VALUE 'N'.   DPKCS031
024300         88  PS-WARNING                              VALUE 'Y'.   DPKCS031
024400         88  PS-NO-WARNING                           VALUE 'N'.   DPKCS031
024500                                                                  DPKCS031
024600 01  PV-PROGRAM-VARIABLES.                                        DPKCS031
024700     05  PV-MNEMONIC                    PIC X(08)    VALUE SPACES.DPKCS031
024800     05  PV-MESSAGE                     PIC X(78)    VALUE SPACES.DPKCS031
024900     05  PV-CICS-RESPONSE               PIC S9(04)   VALUE +0     DPKCS031
025000                                                     COMP SYNC.   DPKCS031
025100     05  PV-RESP                        PIC S9(04)   VALUE +0     DPKCS031
025200                                                     COMP SYNC.   DPKCS031
025300     05  PV-HOLD-SCR-SUB                PIC S9(04)   VALUE +0     DPKCS031
025400                                                     COMP SYNC.   DPKCS031
025500     05  PV-TMESTP                      PIC X(26)    VALUE SPACES.DPKCS031
025600     05  PV-TMESTP-REFORMAT-CHAR                                        17
025700         REDEFINES                                                      17
025800         PV-TMESTP.                                                     17
025900         10  PV-TRC-CCYY                PIC 9(04).                      17
026000         10  PV-TRC-DASH1               PIC X(01).                      17
026100         10  PV-TRC-MM                  PIC 9(02).                      17
026200         10  PV-TRC-DASH2               PIC X(01).                      17
026300         10  PV-TRC-DD                  PIC 9(02).                      17
026400         10  PV-TRC-DASH3               PIC X(01).                      17
026500         10  PV-TRC-HR                  PIC 9(02).                      17
026600         10  PV-TRC-DOT1                PIC X(01).                      17
026700         10  PV-TRC-MN                  PIC 9(02).                      17
026800         10  PV-TRC-DOT2                PIC X(01).                      17
026900         10  PV-TRC-SC                  PIC 9(02).                      17
027000         10  PV-TRC-DOT3                PIC X(01).                      17
027100         10  PV-TRC-TK                  PIC 9(06).                      17
027200     05  PV-TMESTP-REFORMAT-SHORT-X20.                                  17
027300         15  PV-TRS-CCYY                PIC 9(04).                      17
027400         15  PV-TRS-MM                  PIC 9(02).                      17
027500         15  PV-TRS-DD                  PIC 9(02).                      17
027600         15  PV-TRS-HR                  PIC 9(02).                      17
027700         15  PV-TRS-MN                  PIC 9(02).                      17
027800         15  PV-TRS-SC                  PIC 9(02).                      17
027900         15  PV-TRS-TK                  PIC 9(06).                      17
028000     05  PV-ACT                         PIC X(01)    VALUE SPACES.DPKCS017
028100     05  PV-ACT                         PIC X(01)    VALUE SPACES.DPKCS031
028200     05  PV-FIND-ACT                    PIC X(01)    VALUE SPACE. DPKCS017
028300     05  PV-STK                         PIC X(01)    VALUE SPACES.DPKCS031
028400     05  PV-LABEL                       PIC X(08)    VALUE SPACES.DPKCS031
028500     05  PV-FORMAT                      PIC X(01)    VALUE SPACES.DPKCS031
028600     05  PV-SEQUENCE-NMBR               PIC 9(02)    VALUE ZEROES.DPKCS031
028700     05  FILLER REDEFINES PV-SEQUENCE-NMBR.                       DPKCS031
028800         10  PV-SEQUENCE-NMBR-CHAR      PIC X(02).                DPKCS031
028900     05  PV-FORMAT-CODE                 PIC X(04)    VALUE 'FKEY'.DPKCS031
029000     05  PV-ACCEPTED-FORMAT-CODE        PIC X(04)    VALUE SPACES.DPKCS031
029100         88  PV-FKEY-FORMAT-CODE                     VALUE 'FKEY'.DPKCS031
029200         88  PV-CMIA-FORMAT-CODE                     VALUE 'CMIA'.DPKCS031
029300         88  PV-MITM-FORMAT-CODE                     VALUE 'MITM'.DPKCS031
029400     05  PV-TOP-ITEM-ON-SCREEN          PIC S9(04)   COMP.        DPKCS031
029500     05  PV-REWRITE-SW                  PIC X        VALUE 'N'.   DPKCS031
029600         88  PV-REWRITE                              VALUE 'Y'.   DPKCS031
029700         88  PV-DONT-REWRITE                         VALUE 'N'.   DPKCS031
029800 EJECT                                                            DPKCS031
029900*----------------------------------------------------------------*DPKCS031
030000*    WORKING STORAGE INCLUDE MEMBER USED WITH INCLUDE DPPD005    *DPKCS031
030100*----------------------------------------------------------------*DPKCS031
030200     COPY DPWS006.                                                DPKCS031
030300 EJECT                                                            DPKCS031
030400***************************************************************** DPKCS031
030500*    STANDARD COMMAREA.                                           DPKCS031
030600***************************************************************** DPKCS031
030700                                                                  DPKCS031
030800     COPY DPWS020.                                                DPKCS031
030900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                DPKCS031
031000                                                                  DPKCS031
031100***************************************************************** DPKCS031
031200*    INTER-APPLICATION COMMAREA.                                  DPKCS031
031300***************************************************************** DPKCS031
031400                                                                  DPKCS031
031500         10  INTER-APPL-COMM-AREA       PIC X(200).               DPKCS031
031600     COPY DPWS050.                                                DPKCS031
031700     COPY DPWS051.                                                DPKCS031
031800     COPY DPWS052.                                                DPKCS031
031900     COPY DPWS055.                                                DPKCS031
032000                                                                  DPKCS031
032100***************************************************************** DPKCS031
032200*    SPECIFIC COMMMAREA FOR DPKCS031.                             DPKCS031
032300***************************************************************** DPKCS031
032400                                                                  DPKCS031
032500     10  DP031-SPECIFIC-COMMAREA.                                 DPKCS031
032600         15  FILLER                      PIC X(02).               DPKCS031
032700         15  DP031-CURRENT-SCREEN-IMAGE.                          DPKCS031
032800             20  DP031-SCREEN-TRAN-ID    PIC X(04).               DPKCS031
032900             20  DP031-SCREEN-MNEMONIC   PIC X(08).               DPKCS031
033000             20  DP031-SCREEN-MNEMONIC-TITLE                      DPKCS031
033100                                         PIC X(25).               DPKCS031
033200             20  DP031-SCR-TYP-CDE       PIC X.                   DPKCS031
033300             20  DP031-SCREEN-FKEYS.                              DPKCS031
033400                 25  DP031-SCREEN-FUNCTION-KEYS OCCURS 29 TIMES.  DPKCS031
033500                                                                  DPKCS031
033600                     30  DP031-SCR-TAG                            DPKCS031
033700                                         PIC X(03).               DPKCS031
033800                     30  DP031-SCR-STATUS                         DPKCS031
033900                                         PIC X(08).               DPKCS031
034000                     30  DP031-SCR-ACTION                         DPKCS031
034100                                         PIC X(01).               DPKCS031
034200                     30  DP031-SCR-ACTIONA                        DPKCS031
034300                                         PIC X(01).               DPKCS031
034400                     30  DP031-SCR-ACTIONH                        DPKCS031
034500                                         PIC X(01).               DPKCS031
034600                     30  DP031-SCR-ACTIONC                        DPKCS031
034700                                         PIC X(01).               DPKCS031
034800                     30  DP031-SCR-ACTIONL                        DPKCS031
034900                                         PIC S9(1).               DPKCS031
035000                                                                  DPKCS031
035100                     30  DP031-SCR-ACTION-DESC                    DPKCS031
035200                                         PIC X(10).               DPKCS031
035300                                                                  DPKCS031
035400                     30  DP031-SCR-DISP  PIC X(01).               DPKCS031
035500                     30  DP031-SCR-DISPA PIC X(01).               DPKCS031
035600                     30  DP031-SCR-DISPH PIC X(01).               DPKCS031
035700                     30  DP031-SCR-DISPC PIC X(01).               DPKCS031
035800                     30  DP031-SCR-DISPL PIC S9(1).               DPKCS031
035900                                                                  DPKCS031
036000                     30  DP031-SCR-LABEL                          DPKCS031
036100                                         PIC X(08).               DPKCS031
036200                     30  DP031-SCR-LABELA                         DPKCS031
036300                                         PIC X(01).               DPKCS031
036400                     30  DP031-SCR-LABELH                         DPKCS031
036500                                         PIC X(01).               DPKCS031
036600                     30  DP031-SCR-LABELC                         DPKCS031
036700                                         PIC X(01).               DPKCS031
036800                     30  DP031-SCR-LABELL                         DPKCS031
036900                                         PIC S9(1).               DPKCS031
037000                                                                  DPKCS031
037100                     30  DP031-SCR-MNEMONIC                       DPKCS031
037200                                         PIC X(08).               DPKCS031
037300                     30  DP031-SCR-MNEMONICA                      DPKCS031
037400                                         PIC X(01).               DPKCS031
037500                     30  DP031-SCR-MNEMONICH                      DPKCS031
037600                                         PIC X(01).               DPKCS031
037700                     30  DP031-SCR-MNEMONICC                      DPKCS031
037800                                         PIC X(01).               DPKCS031
037900                     30  DP031-SCR-MNEMONICL                      DPKCS031
038000                                         PIC S9(1).               DPKCS031
038100                                                                  DPKCS031
038200                     30  DP031-SCR-FORMAT                         DPKCS031
038300                                         PIC X(01).               DPKCS031
038400                     30  DP031-SCR-FORMATA                        DPKCS031
038500                                         PIC X(01).               DPKCS031
038600                     30  DP031-SCR-FORMATH                        DPKCS031
038700                                         PIC X(01).               DPKCS031
038800                     30  DP031-SCR-FORMATC                        DPKCS031
038900                                         PIC X(01).               DPKCS031
039000                     30  DP031-SCR-FORMATL                        DPKCS031
039100                                         PIC S9(1).               DPKCS031
039200                                                                  DPKCS031
039300                     30  DP031-SCR-STK                            DPKCS031
039400                                         PIC X(01).               DPKCS031
039500                     30  DP031-SCR-STKA                           DPKCS031
039600                                         PIC X(01).               DPKCS031
039700                     30  DP031-SCR-STKH                           DPKCS031
039800                                         PIC X(01).               DPKCS031
039900                     30  DP031-SCR-STKC                           DPKCS031
040000                                         PIC X(01).               DPKCS031
040100                     30  DP031-SCR-STKL                           DPKCS031
040200                                         PIC S9(1).               DPKCS031
040300                                                                  DPKCS031
040400                     30  DP031-SCR-TMESTP                         DPKCS031
040500                                         PIC X(20).               DPKCS031
040600                                                                  DPKCS031
040700         15  DP031-FK-SEQUENCE-NUMBER    PIC S9(04)  COMP.        DPKCS031
040800         15  DP031-SELECTED-MAINT-RESULT PIC X(01).               DPKCS031
040900         15  DP031-CONFIRM-REQUESTED-SW  PIC X(01).               DPKCS031
041000         15  DP031-SCR-SUB               PIC S9(04)  COMP.        DPKCS031
041100         15  DP031-MN-ITEM               PIC S9(04)  COMP.        DPKCS031
041200         15  DP031-MN-SUB                PIC S9(04)  COMP.        DPKCS031
041300         15  DP031-USE-TSQB-SW           PIC X.                   DPKCS031
041400             88  DP031-USE-TSQB                      VALUE 'Y'.   DPKCS031
041500             88  DP031-NO-TSQB                       VALUE 'N'.   DPKCS031
041600         15  DP031-HOLD-INTER-APPL-COMMAREA                       DPKCS031
041700                                         PIC X(200).              DPKCS031
041800         15  FILLER  REDEFINES  DP031-HOLD-INTER-APPL-COMMAREA.   DPKCS031
041900             20  DP031-INTER-APPL-FMT-CODE                        DPKCS031
042000                                         PIC X(04).               DPKCS031
042100             20  DP031-INTER-APPL-ACK-CODE                        DPKCS031
042200                                         PIC X(04).               DPKCS031
042300             20  DP031-INITIAL-CMIA.                              DPKCS031
042400                 25  DP031-MNEMONIC      PIC X(08).               DPKCS031
042500                 25  DP031-TRAN-ID       PIC X(04).               DPKCS031
042600                 25  DP031-TITLE         PIC X(30).               DPKCS031
042700                 25  DP031-CMIA-MAINT-RESULT                      DPKCS031
042800                                         PIC X(01).               DPKCS031
042900                 25  FILLER              PIC X(10).               DPKCS031
043000             20  DP031-INITIAL-FKEY REDEFINES DP031-INITIAL-CMIA. DPKCS031
043100                 25  FILLER              PIC X(08).               DPKCS031
043200                 25  DP031-SEQUENCE-NUMBER                        DPKCS031
043300                                         PIC S9(02)  COMP.        DPKCS031
043400                 25  DP031-FKEY-MNEMONIC PIC X(08).               DPKCS031
043500                 25  DP031-FKEY-MAINT-RESULT                      DPKCS031
043600                                         PIC X(01).               DPKCS031
043700                 25  FILLER              PIC X(34).               DPKCS031
043800             20  DP031-INITIAL-MITM REDEFINES DP031-INITIAL-CMIA. DPKCS031
043900                 25  DP031-MENU-NAME     PIC X(08).               DPKCS031
044000                 25  DP031-ITEM-MNEMONIC PIC X(08).               DPKCS031
044100                 25  DP031-ITEM-SEQUENCE-NUMBER                   DPKCS031
044200                                         PIC S9(04)  COMP.        DPKCS031
044300                 25  DP031-ITEM-TRAN-ID  PIC X(04).               DPKCS031
044400                 25  DP031-ITEM-TITLE    PIC X(30).               DPKCS031
044500                 25  DP031-MITM-MAINT-RESULT                      DPKCS031
044600                                         PIC X(01).               DPKCS031
044700     EJECT                                                        DPKCS031
044800***************************************************************** DPKCS031
044900*    SYSTEM MESSAGES                                              DPKCS031
045000***************************************************************** DPKCS031
045100                                                                  DPKCS031
045200     COPY DPRD507I.                                               DPKCS031
045300                                                                  DPKCS031
045400***************************************************************** DPKCS031
045500*    TSQB LAYOUT                                                  DPKCS031
045600***************************************************************** DPKCS031
045700                                                                  DPKCS031
045800     COPY DPWS002.                                                DPKCS031
045900                                                                  DPKCS031
046000***************************************************************** DPKCS031
046100*    ABEND PROCESSING COPYBOOK.                                   DPKCS031
046200***************************************************************** DPKCS031
046300                                                                  DPKCS031
046400     COPY DPWS013.                                                DPKCS031
046500                                                                  DPKCS031
046600***************************************************************** DPKCS031
046700*    ATTRIBUTE SETTINGS COPYBOOK.                                 DPKCS031
046800***************************************************************** DPKCS031
046900                                                                  DPKCS031
047000     COPY DPWS015.                                                DPKCS031
047100                                                                  DPKCS031
047200***************************************************************** DPKCS031
047300*    CURRENT DATE AND TIME COPYBOOK.                              DPKCS031
047400***************************************************************** DPKCS031
047500                                                                  DPKCS031
047600     COPY DPWS017.                                                DPKCS031
047700                                                                  DPKCS031
047800***************************************************************** DPKCS031
047900*    TOGGLE FUNCTION KEY LINES COPYBOOK.                          DPKCS031
048000***************************************************************** DPKCS031
048100                                                                  DPKCS031
048200     COPY DPWS009.                                                DPKCS031
048300                                                                  DPKCS031
048400***************************************************************** DPKCS031
048500*    FUNCTION KEYS COPYBOOK.                                      DPKCS031
048600***************************************************************** DPKCS031
048700                                                                  DPKCS031
048800     COPY DPWS016.                                                DPKCS031
048900                                                                  DPKCS031
049000***************************************************************** DPKCS031
049100*    DPKUT045 COPYBOOK.                                           DPKCS031
049200***************************************************************** DPKCS031
049300                                                                  DPKCS031
049400     COPY DPWS045.                                                DPKCS031
049500                                                                  DPKCS031
049600***************************************************************** DPKCS031
049700*    STANDARD ATTENTION IDENTIFIER LIST                           DPKCS031
049800***************************************************************** DPKCS031
049900                                                                  DPKCS031
050000     COPY DFHAID.                                                 DPKCS031
050100                                                                  DPKCS031
050200***************************************************************** DPKCS031
050300*    STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST        DPKCS031
050400***************************************************************** DPKCS031
050500                                                                  DPKCS031
050600     COPY DFHBMSCA.                                               DPKCS031
050700     EJECT                                                        DPKCS031
050800***************************************************************** DPKCS031
050900*    MAP LAYOUT                                                   DPKCS031
051000***************************************************************** DPKCS031
051100                                                                  DPKCS031
051200     COPY DPKM031.                                                DPKCS031
051300                                                                  DPKCS031
051400 01  MD-MAP-DATA-AREA REDEFINES DP031AO.                          DPKCS031
051500     05  FILLER                 PIC X(12).                        DPKCS031
051600     05  DPKM031-ADATEL         PIC S9(04) COMP.                  DPKCS031
051700     05  DPKM031-ADATEA         PIC X(01).                        DPKCS031
051800     05  FILLER                 PIC X(02).                        DPKCS031
051900     05  DPKM031-ADATEI         PIC X(10).                        DPKCS031
052000     05  DPKM031-ATIMEL         PIC S9(04) COMP.                  DPKCS031
052100     05  DPKM031-ATIMEA         PIC X(01).                        DPKCS031
052200     05  FILLER                 PIC X(02).                        DPKCS031
052300     05  DPKM031-ATIMEI         PIC X(08).                        DPKCS031
052400     05  DPKM031-ATITLEL        PIC S9(04) COMP.                  DPKCS031
052500     05  DPKM031-ATITLEA        PIC X(01).                        DPKCS031
052600     05  FILLER                 PIC X(02).                        DPKCS031
052700     05  DPKM031-ATITLEI        PIC X(30).                        DPKCS031
052800     05  DPKM031-ANETNAML       PIC S9(04) COMP.                  DPKCS031
052900     05  DPKM031-ANATNAMA       PIC X(01).                        DPKCS031
053000     05  FILLER                 PIC X(02).                        DPKCS031
053100     05  DPKM031-ANETNAMI       PIC X(08).                        DPKCS031
053200     05  DPKM031-AMNEMICL       PIC S9(04) COMP.                  DPKCS031
053300     05  DPKM031-AMNEMICA       PIC X(01).                        DPKCS031
053400     05  FILLER                 PIC X(02).                        DPKCS031
053500     05  DPKM031-AMNEMICI       PIC X(08).                        DPKCS031
053600     05  DPKM031-ATRANIDL       PIC S9(04) COMP.                  DPKCS031
053700     05  DPKM031-ATRANIDA       PIC X(01).                        DPKCS031
053800     05  FILLER                 PIC X(02).                        DPKCS031
053900     05  DPKM031-ATRANIDI       PIC X(04).                        DPKCS031
054000     05  DPKM031-AMNOMICL       PIC S9(04) COMP.                  DPKCS031
054100     05  DPKM031-AMNOMICA       PIC X(01).                        DPKCS031
054200     05  FILLER                 PIC X(02).                        DPKCS031
054300     05  DPKM031-AMNOMICI       PIC X(08).                        DPKCS031
054400     05  DPKM031-ANAMEL         PIC S9(04) COMP.                  DPKCS031
054500     05  DPKM031-ANAMEA         PIC X(01).                        DPKCS031
054600     05  FILLER                 PIC X(02).                        DPKCS031
054700     05  DPKM031-ANAMEI         PIC X(30).                        DPKCS031
054800                                                                  DPKCS031
054900     05  DPKM031-ASELCTI.                                         DPKCS031
055000         10  DPKM031-SELECTION-ENTRIES OCCURS 12 TIMES.           DPKCS031
055100             15  DPKM031-AFKEYL PIC S9(04) COMP.                  DPKCS031
055200             15  DPKM031-AFKEYA PIC X(01).                        DPKCS031
055300             15  FILLER         PIC X(02).                        DPKCS031
055400             15  DPKM031-AFKEYI PIC X(03).                        DPKCS031
055500                                                                  DPKCS031
055600             15  DPKM031-ASTATL PIC S9(04) COMP.                  DPKCS031
055700             15  DPKM031-ASTATA PIC X(01).                        DPKCS031
055800             15  FILLER         PIC X(02).                        DPKCS031
055900             15  DPKM031-ASTATI PIC X(08).                        DPKCS031
056000                                                                  DPKCS031
056100             15  DPKM031-AACTL  PIC S9(04) COMP.                  DPKCS031
056200             15  DPKM031-AACTA  PIC X(01).                        DPKCS031
056300             15  DPKM031-AACTC  PIC X(01).                        DPKCS031
056400             15  DPKM031-AACTH  PIC X(01).                        DPKCS031
056500             15  DPKM031-AACTI  PIC X(01).                        DPKCS031
056600                                                                  DPKCS031
056700             15  DPKM031-AACTDL PIC S9(04) COMP.                  DPKCS031
056800             15  DPKM031-AACTDA PIC X(01).                        DPKCS031
056900             15  FILLER         PIC X(02).                        DPKCS031
057000             15  DPKM031-AACTDI PIC X(10).                        DPKCS031
057100                                                                  DPKCS031
057200             15  DPKM031-ADISPL PIC S9(04) COMP.                  DPKCS031
057300             15  DPKM031-ADISPA PIC X(01).                        DPKCS031
057400             15  DPKM031-ADISPC PIC X(01).                        DPKCS031
057500             15  DPKM031-ADISPH PIC X(01).                        DPKCS031
057600             15  DPKM031-ADISPI PIC X(01).                        DPKCS031
057700                                                                  DPKCS031
057800             15  DPKM031-ALABLL PIC S9(04) COMP.                  DPKCS031
057900             15  DPKM031-ALABLA PIC X(01).                        DPKCS031
058000             15  DPKM031-ALABLC PIC X(01).                        DPKCS031
058100             15  DPKM031-ALABLH PIC X(01).                        DPKCS031
058200             15  DPKM031-ALABLI PIC X(08).                        DPKCS031
058300                                                                  DPKCS031
058400             15  DPKM031-AMNEML PIC S9(04) COMP.                  DPKCS031
058500             15  DPKM031-AMNEMA PIC X(01).                        DPKCS031
058600             15  DPKM031-AMNEMC PIC X(01).                        DPKCS031
058700             15  DPKM031-AMNEMH PIC X(01).                        DPKCS031
058800             15  DPKM031-AMNEMI PIC X(08).                        DPKCS031
058900                                                                  DPKCS031
059000             15  DPKM031-AFORML PIC S9(04) COMP.                  DPKCS031
059100             15  DPKM031-AFORMA PIC X(01).                        DPKCS031
059200             15  DPKM031-AFORMC PIC X(01).                        DPKCS031
059300             15  DPKM031-AFORMH PIC X(01).                        DPKCS031
059400             15  DPKM031-AFORMI PIC X(01).                        DPKCS031
059500                                                                  DPKCS031
059600             15  DPKM031-ASTKL  PIC S9(04) COMP.                  DPKCS031
059700             15  DPKM031-ASTKA  PIC X(01).                        DPKCS031
059800             15  DPKM031-ASTKC  PIC X(01).                        DPKCS031
059900             15  DPKM031-ASTKH  PIC X(01).                        DPKCS031
060000             15  DPKM031-ASTKI  PIC X(01).                        DPKCS031
060100                                                                  DPKCS031
060200     05  DPKM031-AMSGL          PIC S9(04) COMP.                  DPKCS031
060300     05  DPKM031-AMSGA          PIC X(01).                        DPKCS031
060400     05  FILLER                 PIC X(02).                        DPKCS031
060500     05  DPKM031-AMSGI          PIC X(78).                        DPKCS031
060600     05  DPKM031-ANAVCMDL       PIC S9(04) COMP.                  DPKCS031
060700     05  DPKM031-ANAVCMDA       PIC X(01).                        DPKCS031
060800     05  FILLER                 PIC X(02).                        DPKCS031
060900     05  DPKM031-ANAVCMDI       PIC X(08).                        DPKCS031
061000     05  DPKM031-ANAVKEYL       PIC S9(04) COMP.                  DPKCS031
061100     05  DPKM031-ANAVKEYA       PIC X(01).                        DPKCS031
061200     05  FILLER                 PIC X(02).                        DPKCS031
061300     05  DPKM031-ANAVKEYI       PIC X(25).                        DPKCS031
061400     05  DPKM031-AFKLIN1L       PIC S9(04) COMP.                  DPKCS031
061500     05  DPKM031-AFKLIN1A       PIC X(01).                        DPKCS031
061600     05  FILLER                 PIC X(02).                        DPKCS031
061700     05  DPKM031-AFKLIN1I       PIC X(78).                        DPKCS031
061800     05  DPKM031-AFKLIN2L       PIC S9(04) COMP.                  DPKCS031
061900     05  DPKM031-AFKLIN2A       PIC X(01).                        DPKCS031
062000     05  FILLER                 PIC X(02).                        DPKCS031
062100     05  DPKM031-AFKLIN2I       PIC X(78).                        DPKCS031
062200                                                                  DPKCS031
062300 EJECT                                                            DPKCS031
062400***************************************************************** DPKCS031
062500*    DB2 COMMUNICATION AREA                                       DPKCS031
062600***************************************************************** DPKCS031
062700                                                                  DPKCS031
062800     EXEC SQL                                                     DPKCS031
062900         INCLUDE SQLCA                                            DPKCS031
063000     END-EXEC.                                                    DPKCS031
063100                                                                  DPKCS031
063200***************************************************************** DPKCS031
063300*    FUNCTION KEY TABLE - TAIDKEY                                 DPKCS031
063400***************************************************************** DPKCS031
063500                                                                  DPKCS031
063600     EXEC SQL                                                     DPKCS031
063700         INCLUDE TAIDKEY                                          DPKCS031
063800     END-EXEC.                                                    DPKCS031
063900                                                                  DPKCS031
064000***************************************************************** DPKCS031
064100*    MNEMONIC FUNCTION KEY TABLE - TCICSROUTE                     DPKCS031
064200***************************************************************** DPKCS031
064300                                                                  DPKCS031
064400     EXEC SQL                                                     DPKCS031
064500         INCLUDE TCICSRTE                                         DPKCS031
064600     END-EXEC.                                                    DPKCS031
064700                                                                  DPKCS031
064800***************************************************************** DPKCS031
064900*    MNEMONIC TRANS ID TABLE - TMNEMONIC                          DPKCS031
065000***************************************************************** DPKCS031
065100                                                                  DPKCS031
065200     EXEC SQL                                                     DPKCS031
065300         INCLUDE TMNMNC                                           DPKCS031
065400     END-EXEC.                                                    DPKCS031
065500                                                                  DPKCS031
065600***************************************************************** DPKCS031
065700*    MENU ITEM TABLE  -  TMENUITEM                                DPKCS031
065800***************************************************************** DPKCS031
065900                                                                  DPKCS031
066000     EXEC SQL                                                     DPKCS031
066100         INCLUDE TMNUITM                                          DPKCS031
066200     END-EXEC.                                                    DPKCS031
066300                                                                  DPKCS031
066400***************************************************************** DPKCS031
066500*    FUNCTION KEY CURSOR - TAIDKEY                                DPKCS031
066600***************************************************************** DPKCS031
066700                                                                  DPKCS031
066800                                                                  DPKCS031
066900     EXEC SQL                                                     DPKCS031
067000         DECLARE TAIDKEY-CURSOR CURSOR FOR                        DPKCS031
067100             SELECT AID_SEQUENCE_NMBR,                            DPKCS031
067200                    AID_KEY_NAME,                                 DPKCS031
067300                    STNRD_ACTION_CODE,                            DPKCS031
067400                    SYSWIDE_USE_INDCT,                            DPKCS031
067500                    MNDTRY_MNMNC_INDCT,                           DPKCS031
067600                    MNEMONIC_CODE                                 DPKCS031
067700             FROM TAIDKEY                                         DPKCS031
067800             WHERE  SCRN_TYP_CDE = :DP031-SCR-TYP-CDE             DPKCS031
067900     END-EXEC.                                                    DPKCS031
068000     EJECT                                                        DPKCS031
068100 LINKAGE SECTION.                                                 DPKCS031
068200                                                                  DPKCS031
068300 01  DFHCOMMAREA.                                                 DPKCS031
068400     05  FILLER                         OCCURS  1 TO 4072 TIMES   DPKCS031
068500                                        DEPENDING ON EIBCALEN.    DPKCS031
068600         10  FILLER                     PIC X.                    DPKCS031
068700*                                                                 DPKCS031
068800*                                                                 DPKCS031
068900                                                                  DPKCS031
069000 PROCEDURE DIVISION.                                              DPKCS031
069100                                                                  DPKCS031
069200                                                                  DPKCS031
069300******************************************************************DPKCS031
069400*    PROCESS THIS TRANSACTION IF  THE COMMAREA IS VALID.          DPKCS031
069500******************************************************************DPKCS031
069600                                                                  DPKCS031
069700     PERFORM DP015-0000-CHECK-COMMAREA.                           DPKCS031
069800                                                                  DPKCS031
069900     IF  DP020-SRC-RETURN-W-TRAN-ID                               DPKCS031
070000         PERFORM B100-CONTROL-PROCESSING                          DPKCS031
070100     END-IF.                                                      DPKCS031
070200                                                                  DPKCS031
070300     PERFORM DP003-0000-RETURN-TO-CICS.                           DPKCS031
070400 EJECT                                                            DPKCS031
070500 B100-CONTROL-PROCESSING.                                         DPKCS031
070600                                                                  DPKCS031
070700******************************************************************DPKCS031
070800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT    DPKCS031
070900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                    DPKCS031
071000*                                                                 DPKCS031
071100******************************************************************DPKCS031
071200                                                                  DPKCS031
071300     EVALUATE TRUE                                                DPKCS031
071400                                                                  DPKCS031
071500         WHEN DP020-NEXT-ACT-INITIAL                              DPKCS031
071600             INITIALIZE DP031-SPECIFIC-COMMAREA                   DPKCS031
071700             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 DPKCS031
071800             SET DP020-MSG-INFORMATIONAL  TO TRUE                 DPKCS031
071900                                                                  DPKCS031
072000             MOVE INTER-APPL-COMM-AREA                            DPKCS031
072100                               TO  DP031-HOLD-INTER-APPL-COMMAREA DPKCS031
072200                                                                  DPKCS031
072300             IF  DP020-NAV-KEY-DATA GREATER THAN SPACES           DPKCS031
072400                 MOVE DP020-NAV-KEY-DATA                          DPKCS031
072500                               TO  DP031-SCREEN-MNEMONIC          DPKCS031
072600                 MOVE 1        TO  DP031-SCR-SUB                  DPKCS031
072700                 PERFORM E100-SEND-INITIAL-SCREEN                 DPKCS031
072800             ELSE                                                 DPKCS031
072900                 PERFORM D500-OBTAIN-FIRST-MNEMONIC               DPKCS031
073000             END-IF                                               DPKCS031
073100                                                                  DPKCS031
073200         WHEN DP020-NEXT-ACT-READ-MAP                             DPKCS031
073300             SET PS-SEND-DATA-ONLY-FRSET TO TRUE                  DPKCS031
073400             PERFORM C100-PROCESS-MAP                             DPKCS031
073500                                                                  DPKCS031
073600         WHEN DP020-NEXT-ACT-RETURN                               DPKCS031
073700             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 DPKCS031
073800                                                                  DPKCS031
073900             MOVE DP031-HOLD-INTER-APPL-COMMAREA                  DPKCS031
074000                               TO  INTER-APPL-COMM-AREA           DPKCS031
074100                                                                  DPKCS031
074200             PERFORM G200-MOVE-COMMAREA-TO-SCREEN                 DPKCS031
074300                     VARYING PS-SUB FROM 1 BY 1                   DPKCS031
074400                 UNTIL PS-SUB > PC-MAX-ITEMS-ON-SCREEN            DPKCS031
074500                                                                  DPKCS031
074600             PERFORM F200-DISPLAY-PANEL                           DPKCS031
074700                                                                  DPKCS031
074800         WHEN DP020-NEXT-ACT-ERROR                                DPKCS031
074900             MOVE DP020-MSG-MESSAGE TO PV-MESSAGE                 DPKCS031
075000                                                                  DPKCS031
075100             IF  DP020-NAV-MNEMONIC = SPACES                      DPKCS031
075200                MOVE SPACES          TO ANAVCMDO                  DPKCS031
075300                MOVE DP015-UNDERLINE TO ANAVCMDH                  DPKCS031
075400                MOVE DP015-GREEN     TO ANAVCMDC                  DPKCS031
075500             ELSE                                                 DPKCS031
075600                MOVE DP015-REVERSE   TO ANAVCMDH                  DPKCS031
075700                MOVE DP015-RED       TO ANAVCMDC                  DPKCS031
075800             END-IF                                               DPKCS031
075900                                                                  DPKCS031
076000             MOVE -1         TO ANAVCMDL                          DPKCS031
076100             MOVE PV-MESSAGE TO DP020-MSG-MESSAGE                 DPKCS031
076200                                                                  DPKCS031
076300             SET PS-ERROR                TO TRUE                  DPKCS031
076400             SET PS-SEND-DATA-ONLY-FRSET TO TRUE                  DPKCS031
076500                                                                  DPKCS031
076600             PERFORM F200-DISPLAY-PANEL                           DPKCS031
076700                                                                  DPKCS031
076800         WHEN OTHER                                               DPKCS031
076900             SET DP013-LOGIC-ABEND TO TRUE                        DPKCS031
077000             SET DP013-NO-ROLLBACK TO TRUE                        DPKCS031
077100                                                                  DPKCS031
077200             MOVE 'B100-CONTROL-PROCESSING' TO                    DPKCS031
077300                  DP013-PARAGRAPH                                 DPKCS031
077400             MOVE PM-PROGRAM-MESSAGE-28     TO                    DPKCS031
077500                  DP013-MESSAGE-TEXT(1)                           DPKCS031
077600                                                                  DPKCS031
077700             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS031
077800                                                                  DPKCS031
077900     END-EVALUATE.                                                DPKCS031
078000 EJECT                                                            DPKCS031
078100 C100-PROCESS-MAP.                                                DPKCS031
078200                                                                  DPKCS031
078300******************************************************************DPKCS031
078400*    RECEIVE THE MAP.                                             DPKCS031
078500*    MOVE THE SCREEN VARIABLES TO THE COMMAREA.                   DPKCS031
078600*    IF THE FUNCTION KEY HIT WAS NOT A LOCAL KEY, START THE       DPKCS031
078700*    NAVIGATOR AND LEAVE THIS TRANSACTION.                        DPKCS031
078800*    IF THE USER HIT ENTER AND ENTERED A MNEMONIC IN THE COMMAND  DPKCS031
078900*    LINE, START THE NAVIGATOR AND LEAVE THIS TRANSACTION,        DPKCS031
079000*    OTHERWISE CONTINUE PROCESSING BASED ON THE FUNCTION KEY THAT DPKCS031
079100*    WAS HIT.                                                     DPKCS031
079200*                                                                 DPKCS031
079300*    PERFORMED BY B100-CONTROL-PROCESSING.                        DPKCS031
079400******************************************************************DPKCS031
079500                                                                  DPKCS031
079600     PERFORM DP007-0000-GET-PANEL.                                DPKCS031
079700     PERFORM D100-MOVE-SCREEN-TO-COMMAREA.                        DPKCS031
079800                                                                  DPKCS031
079900     IF  (DP020-FK-GO-TO-TRAN(DP020-SRC-AID)                      DPKCS031
080000     OR  (DP020-SRC-AID EQUAL DP016-ENTER                         DPKCS031
080100     AND  DP020-NAV-MNEMONIC GREATER THAN SPACES))                DPKCS031
080200          MOVE INTER-APPL-COMM-AREA                               DPKCS031
080300                               TO  DP031-HOLD-INTER-APPL-COMMAREA DPKCS031
080400          MOVE DP031-SCREEN-MNEMONIC                              DPKCS031
080500                               TO  DP055-MNEMONIC                 DPKCS031
080600          PERFORM DP015-1000-START-NAVIGATOR                      DPKCS031
080700     ELSE                                                         DPKCS031
080800          PERFORM D300-LOCAL-FKEY-CONTROL                         DPKCS031
080900     END-IF.                                                      DPKCS031
081000                                                                  DPKCS031
081100 EJECT                                                            DPKCS031
081200 D100-MOVE-SCREEN-TO-COMMAREA.                                    DPKCS031
081300                                                                  DPKCS031
081400******************************************************************DPKCS031
081500*    SET A SWITCH IF  THE USER ENTERED A NEW MNEMONIC IN THE KEY  DPKCS031
081600*    FIELD.  OTHERWISE, IF  THE USER DID NOT ENTER 'CONFIRM' OR   DPKCS031
081700*    'CLEAR' IN THE COMMAND LINE, OR HIT THE CLEAR KEY, MOVE THE  DPKCS031
081800*    FIELDS FROM THE SCREEN TO THE COMMAREA.                      DPKCS031
081900*                                                                 DPKCS031
082000*    PERFORMED BY C100-PROCESS-MAP.                               DPKCS031
082100******************************************************************DPKCS031
082200                                                                  DPKCS031
082300     SET PS-NEW-MNEMONIC-NOT-REQUESTED TO TRUE.                   DPKCS031
082400                                                                  DPKCS031
082500     IF (ANAVKEYL > 0                                             DPKCS031
082600     AND DP020-SRC-AID EQUAL DP016-ENTER)                         DPKCS031
082700         SET PS-NEW-MNEMONIC-REQUESTED TO TRUE                    DPKCS031
082800     END-IF.                                                      DPKCS031
082900                                                                  DPKCS031
083000 EJECT                                                            DPKCS031
083100 D300-LOCAL-FKEY-CONTROL.                                         DPKCS031
083200                                                                  DPKCS031
083300******************************************************************DPKCS031
083400*    TAKE THE APPROPRIATE COURSE OF ACTION BASED ON WHAT THE      DPKCS031
083500*    FUNCTION KEY THAT THE USER HAS HIT.                          DPKCS031
083600*                                                                 DPKCS031
083700*    PERFORMED BY C100-PROCESS-MAP.                               DPKCS031
083800******************************************************************DPKCS031
083900                                                                  DPKCS031
084000     EVALUATE TRUE                                                DPKCS031
084100                                                                  DPKCS031
084200         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     DPKCS031
084300             INITIALIZE DP031-SCREEN-FKEYS                        DPKCS031
084400             MOVE 1            TO  DP031-SCR-SUB                  DPKCS031
084500             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 DPKCS031
084600             PERFORM E100-SEND-INITIAL-SCREEN                     DPKCS031
084700                                                                  DPKCS031
084800         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  DPKCS031
084900             MOVE DP031-SCREEN-MNEMONIC                           DPKCS031
085000                               TO  DP055-MNEMONIC                 DPKCS031
085100             PERFORM DP015-1000-START-NAVIGATOR                   DPKCS031
085200                                                                  DPKCS031
085300         WHEN DP020-FK-NEXT-SELECTION(DP020-SRC-AID)              DPKCS031
085400              IF  DP031-USE-TSQB                                  DPKCS031
085500                  SET PS-SEND-MAP-N-DATA-FRSET TO TRUE            DPKCS031
085600                  PERFORM D600-GET-NEXT-MNEMONIC                  DPKCS031
085700              ELSE                                                DPKCS031
085800                 MOVE PC-TSYMSG-00070                             DPKCS031
085900                               TO  DP020-MSG-NUMBER               DPKCS031
086000                 SET DP020-MSG-INFORMATIONAL                      DPKCS031
086100                               TO  TRUE                           DPKCS031
086200                 PERFORM F200-DISPLAY-PANEL                       DPKCS031
086300              END-IF                                              DPKCS031
086400                                                                  DPKCS031
086500         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  DPKCS031
086600              MOVE 1           TO  DP031-SCR-SUB                  DPKCS031
086700              PERFORM G200-MOVE-COMMAREA-TO-SCREEN                DPKCS031
086800              PERFORM F200-DISPLAY-PANEL                          DPKCS031
086900                                                                  DPKCS031
087000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   DPKCS031
087100              SUBTRACT PC-MAX-ITEMS-ON-SCREEN                     DPKCS031
087200                         FROM  DP031-SCR-SUB                      DPKCS031
087300              IF  DP031-SCR-SUB LESS THAN 1                       DPKCS031
087400                  MOVE 1       TO  DP031-SCR-SUB                  DPKCS031
087500              END-IF                                              DPKCS031
087600                                                                  DPKCS031
087700              PERFORM G200-MOVE-COMMAREA-TO-SCREEN                DPKCS031
087800              PERFORM F200-DISPLAY-PANEL                          DPKCS031
087900                                                                  DPKCS031
088000         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   DPKCS031
088100              ADD PC-MAX-ITEMS-ON-SCREEN                          DPKCS031
088200                           TO  DP031-SCR-SUB                      DPKCS031
088300              IF  DP031-SCR-SUB GREATER THAN PC-MAX-FKEYS         DPKCS031
088400                  SUBTRACT PC-MAX-ITEMS-ON-SCREEN                 DPKCS031
088500                         FROM  DP031-SCR-SUB                      DPKCS031
088600              END-IF                                              DPKCS031
088700                                                                  DPKCS031
088800              PERFORM G200-MOVE-COMMAREA-TO-SCREEN                DPKCS031
088900              PERFORM F200-DISPLAY-PANEL                          DPKCS031
089000                                                                  DPKCS031
089100         WHEN DP020-SRC-AID = DP016-PA2                           DPKCS031
089200             PERFORM DP009-0000-LOAD-FK-LINES                     DPKCS031
089300             PERFORM DP017-0000-GET-CURR-DATE-TIME                DPKCS031
089400                                                                  DPKCS031
089500             SET PS-SEND-DATA-ONLY TO TRUE                        DPKCS031
089600                                                                  DPKCS031
089700             MOVE -1 TO ANAVCMDL                                  DPKCS031
089800                                                                  DPKCS031
089900             PERFORM DP008-0000-WRITE-PANEL                       DPKCS031
090000                                                                  DPKCS031
090100         WHEN DP020-SRC-AID = DP016-CLEAR                         DPKCS031
090200             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 DPKCS031
090300                                                                  DPKCS031
090400             PERFORM G200-MOVE-COMMAREA-TO-SCREEN                 DPKCS031
090500             PERFORM F200-DISPLAY-PANEL                           DPKCS031
090600                                                                  DPKCS031
090700         WHEN DP020-SRC-AID = DP016-ENTER                         DPKCS031
090800             PERFORM G200-MOVE-COMMAREA-TO-SCREEN                 DPKCS031
090900             PERFORM F200-DISPLAY-PANEL                           DPKCS031
091000                                                                  DPKCS031
091100         WHEN DP020-FK-RETURN(DP020-SRC-AID)                      DPKCS031
091200             IF  DP031-USE-TSQB                                   DPKCS031
091300                 COMPUTE DP055-NUMBER-PROCESSED-ITEMS =           DPKCS031
091400                     ((DP031-MN-ITEM - 1) * DP002-MAX-ITEMS) +    DPKCS031
091500                       DP031-MN-SUB                               DPKCS031
091600             ELSE                                                 DPKCS031
091700                 MOVE ZERO TO DP055-NUMBER-PROCESSED-ITEMS        DPKCS031
091800             END-IF                                               DPKCS031
091900             PERFORM DP015-1000-START-NAVIGATOR                   DPKCS031
092000                                                                  DPKCS031
092100         WHEN OTHER                                               DPKCS031
092200             MOVE PC-TSYMSG-00045                                 DPKCS031
092300                               TO  DP020-MSG-NUMBER               DPKCS031
092400             SET DP020-MSG-FATAL                                  DPKCS031
092500                               TO  TRUE                           DPKCS031
092600             PERFORM F200-DISPLAY-PANEL                           DPKCS031
092700                                                                  DPKCS031
092800     END-EVALUATE.                                                DPKCS031
092900                                                                  DPKCS031
093000 EJECT                                                            DPKCS031
093100 D500-OBTAIN-FIRST-MNEMONIC.                                      DPKCS031
093200                                                                  DPKCS031
093300******************************************************************DPKCS031
093400*    READ THE TSQB RECORD FOR THE FIRST TIME, UPDATE THE ACTIVITY DPKCS031
093500*    SWITCH.                                                      DPKCS031
093600*                                                                 DPKCS031
093700*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS031
093800******************************************************************DPKCS031
093900                                                                  DPKCS031
094000     MOVE 1                    TO  DP031-SCR-SUB.                 DPKCS031
094100                                                                  DPKCS031
094200     IF  DP020-INT-APPL-FORMAT-IND EQUAL '1'                      DPKCS031
094300         MOVE DP055-MNEMONIC   TO  DP031-SCREEN-MNEMONIC          DPKCS031
094400         SET DP031-NO-TSQB     TO  TRUE                           DPKCS031
094500     ELSE                                                         DPKCS031
094600         SET DP031-USE-TSQB    TO  TRUE                           DPKCS031
094700         MOVE 1                TO  DP031-MN-ITEM                  DPKCS031
094800                                   DP031-MN-SUB                   DPKCS031
094900         PERFORM D700-READ-TSQB-QUEUE                             DPKCS031
095000         IF  PV-RESP EQUAL DFHRESP(QIDERR)                        DPKCS031
095100             MOVE PM-PROGRAM-MESSAGE-32                           DPKCS031
095200                               TO  DP020-MSG-MESSAGE              DPKCS031
095300             SET DP020-MSG-FATAL                                  DPKCS031
095400                               TO  TRUE                           DPKCS031
095500             MOVE DP016-PF3    TO  DP020-SRC-AID                  DPKCS031
095600             PERFORM DP015-1000-START-NAVIGATOR                   DPKCS031
095700         ELSE                                                     DPKCS031
095800             MOVE DP002-MNEMONIC (1)                              DPKCS031
095900                               TO  DP031-SCREEN-MNEMONIC          DPKCS031
096000             SET DP002-INQ (1) TO  TRUE                           DPKCS031
096100             PERFORM D800-REWRITE-TSQB-QUEUE                      DPKCS031
096200         END-IF                                                   DPKCS031
096300     END-IF.                                                      DPKCS031
096400                                                                  DPKCS031
096500     IF  DP020-MSG-FATAL                                          DPKCS031
096600         CONTINUE                                                 DPKCS031
096700     ELSE                                                         DPKCS031
096800         PERFORM E100-SEND-INITIAL-SCREEN                         DPKCS031
096900     END-IF.                                                      DPKCS031
097000                                                                  DPKCS031
097100 EJECT                                                            DPKCS031
097200 D600-GET-NEXT-MNEMONIC.                                          DPKCS031
097300                                                                  DPKCS031
097400******************************************************************DPKCS031
097500*    READ THE TSQB RECORD, CHECK IF  THERE ARE ANY MORE MNEMONICS DPKCS031
097600*    TO PROCESS.  HANDLE ACCORDINGLY.                             DPKCS031
097700*                                                                 DPKCS031
097800*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS031
097900******************************************************************DPKCS031
098000                                                                  DPKCS031
098100     INITIALIZE DP031-SCREEN-FKEYS.                               DPKCS031
098200     ADD 1                     TO  DP031-MN-SUB.                  DPKCS031
098300     IF  DP031-MN-SUB GREATER THAN DP002-MAX-ITEMS                DPKCS031
098400         ADD 1                 TO  DP031-MN-ITEM                  DPKCS031
098500         MOVE 1                TO  DP031-MN-SUB                   DPKCS031
098600     END-IF.                                                      DPKCS031
098700                                                                  DPKCS031
098800     PERFORM D700-READ-TSQB-QUEUE.                                DPKCS031
098900     IF (PV-RESP EQUAL DFHRESP(NOTFND)                            DPKCS031
099000     OR  DP002-MNEMONIC (DP031-MN-SUB) EQUAL SPACES)              DPKCS031
099100         SUBTRACT 1          FROM  DP031-MN-SUB                   DPKCS031
099200         MOVE PC-TSYMSG-00070  TO  DP020-MSG-NUMBER               DPKCS031
099300         SET DP020-MSG-INFORMATIONAL                              DPKCS031
099400                               TO  TRUE                           DPKCS031
099500     ELSE                                                         DPKCS031
099600         MOVE DP002-MNEMONIC (DP031-MN-SUB)                       DPKCS031
099700                               TO  DP031-SCREEN-MNEMONIC          DPKCS031
099800         SET DP002-INQ (DP031-MN-SUB)                             DPKCS031
099900                               TO  TRUE                           DPKCS031
100000         MOVE 1                TO  DP031-SCR-SUB                  DPKCS031
100100     END-IF.                                                      DPKCS031
100200                                                                  DPKCS031
100300     PERFORM D800-REWRITE-TSQB-QUEUE.                             DPKCS031
100400     PERFORM E100-SEND-INITIAL-SCREEN.                            DPKCS031
100500                                                                  DPKCS031
100600 EJECT                                                            DPKCS031
100700 D700-READ-TSQB-QUEUE.                                            DPKCS031
100800                                                                  DPKCS031
100900******************************************************************DPKCS031
101000*    READ THE TSQB RECORD.                                        DPKCS031
101100*                                                                 DPKCS031
101200*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS031
101300*                 D600                                            DPKCS031
101400******************************************************************DPKCS031
101500                                                                  DPKCS031
101600     EXEC CICS                                                    DPKCS031
101700          READQ TS                                                DPKCS031
101800          QUEUE(DP055-TSQB-QUEUE-NAME)                            DPKCS031
101900          INTO(DP002-ARCH-MAINT-TSQB-REC)                         DPKCS031
102000          LENGTH(DP055-TSQB-QUEUE-LENGTH)                         DPKCS031
102100          ITEM(DP031-MN-ITEM)                                     DPKCS031
102200          RESP(PV-RESP)                                           DPKCS031
102300     END-EXEC.                                                    DPKCS031
102400                                                                  DPKCS031
102500     IF (PV-RESP EQUAL DFHRESP(NORMAL)                            DPKCS031
102600     OR  PV-RESP EQUAL DFHRESP(NOTFND)                            DPKCS031
102700     OR  PV-RESP EQUAL DFHRESP(QIDERR))                           DPKCS031
102800         CONTINUE                                                 DPKCS031
102900     ELSE                                                         DPKCS031
103000         MOVE PV-RESP          TO  PM-RESP-31                     DPKCS031
103100         SET DP013-LOGIC-ABEND TO  TRUE                           DPKCS031
103200         SET DP013-NO-ROLLBACK TO  TRUE                           DPKCS031
103300         MOVE 'D700-READ-TSQB-QUEUE'                              DPKCS031
103400                               TO  DP013-PARAGRAPH                DPKCS031
103500         MOVE PM-PROGRAM-MESSAGE-31                               DPKCS031
103600                               TO  DP013-MESSAGE-TEXT (1)         DPKCS031
103700         PERFORM DP013-0000-PROCESS-ABEND                         DPKCS031
103800     END-IF.                                                      DPKCS031
103900                                                                  DPKCS031
104000 EJECT                                                            DPKCS031
104100 D800-REWRITE-TSQB-QUEUE.                                         DPKCS031
104200                                                                  DPKCS031
104300******************************************************************DPKCS031
104400*    REWRITE THE TSQB RECORD.                                     DPKCS031
104500*                                                                 DPKCS031
104600*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS031
104700*                 D600                                            DPKCS031
104800******************************************************************DPKCS031
104900                                                                  DPKCS031
105000     EXEC CICS                                                    DPKCS031
105100          WRITEQ TS                                               DPKCS031
105200          QUEUE(DP055-TSQB-QUEUE-NAME)                            DPKCS031
105300          FROM(DP002-ARCH-MAINT-TSQB-REC)                         DPKCS031
105400          LENGTH(DP055-TSQB-QUEUE-LENGTH)                         DPKCS031
105500          ITEM(DP031-MN-ITEM)                                     DPKCS031
105600          RESP(PV-RESP)                                           DPKCS031
105700          REWRITE                                                 DPKCS031
105800     END-EXEC.                                                    DPKCS031
105900                                                                  DPKCS031
106000     IF  PV-RESP NOT EQUAL DFHRESP(NORMAL)                        DPKCS031
106100         MOVE PV-RESP          TO  PM-RESP-31                     DPKCS031
106200         SET DP013-LOGIC-ABEND TO  TRUE                           DPKCS031
106300         SET DP013-NO-ROLLBACK TO  TRUE                           DPKCS031
106400         MOVE 'D800-REWRITE-TSQB-QUEUE'                           DPKCS031
106500                               TO  DP013-PARAGRAPH                DPKCS031
106600         MOVE PM-PROGRAM-MESSAGE-31                               DPKCS031
106700                               TO  DP013-MESSAGE-TEXT (1)         DPKCS031
106800         PERFORM DP013-0000-PROCESS-ABEND                         DPKCS031
106900     END-IF.                                                      DPKCS031
107000                                                                  DPKCS031
107100 EJECT                                                            DPKCS031
107200 E100-SEND-INITIAL-SCREEN.                                        DPKCS031
107300                                                                  DPKCS031
107400******************************************************************DPKCS031
107500*    SET UP AND SEND THE MAP FOR THE NEW MNEMONIC.                DPKCS031
107600*                                                                 DPKCS031
107700*    PERFORMED BY B100-CONTROL-PROCESSING.                        DPKCS031
107800*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS031
107900******************************************************************DPKCS031
108000                                                                  DPKCS031
108100     PERFORM F100-RETRIEVE-DATA-FOR-SCREEN.                       DPKCS031
108200     IF  NOT DP020-NEXT-ACT-APPL-ERROR                            DPKCS031
108300         PERFORM F200-DISPLAY-PANEL                               DPKCS031
108400     END-IF.                                                      DPKCS031
108500                                                                  DPKCS031
108600 EJECT                                                            DPKCS031
108700 F100-RETRIEVE-DATA-FOR-SCREEN.                                   DPKCS031
108800                                                                  DPKCS031
108900******************************************************************DPKCS031
109000*    READ THE TMNEMONIC TABLE TO SEE IF THE REQUESTED MNEMONIC    DPKCS031
109100*    IS VALID.  IF IT IS VALID, READ THE TAIDKEY AND TCICSROUTE   DPKCS031
109200*    TABLES AND SAVE ALL THE NECESSARY INFORMATION IN THE         DPKCS031
109300*    COMMAREA.                                                    DPKCS031
109400*                                                                 DPKCS031
109500*    PERFORMED BY E100-SEND-INITIAL-SCREEN.                       DPKCS031
109600******************************************************************DPKCS031
109700                                                                  DPKCS031
109800     MOVE DP031-SCREEN-MNEMONIC TO PV-MNEMONIC.                   DPKCS031
109900                                                                  DPKCS031
110000     PERFORM Z100-SELECT-TMNEMONIC-ROW.                           DPKCS031
110100                                                                  DPKCS031
110200     IF  SQLCODE = +0                                             DPKCS031
110300         MOVE TMNEMONIC-TRANS-ID-CODE                             DPKCS031
110400                               TO  DP031-SCREEN-TRAN-ID           DPKCS031
110500         MOVE TMNEMONIC-SCRN-TYP-CDE                              DPKCS031
110600                               TO  DP031-SCR-TYP-CDE              DPKCS031
110700                                                                  DPKCS031
110800         IF  IV-PANEL-TITLE-NAME = PC-NULL-INDICATOR              DPKCS031
110900             MOVE SPACES                     TO                   DPKCS031
111000                  DP031-SCREEN-MNEMONIC-TITLE                     DPKCS031
111100         ELSE                                                     DPKCS031
111200             MOVE TMNEMONIC-PANEL-TITLE-NAME TO                   DPKCS031
111300                  DP031-SCREEN-MNEMONIC-TITLE                     DPKCS031
111400         END-IF                                                   DPKCS031
111500                                                                  DPKCS031
111600         PERFORM Z200-OPEN-TAIDKEY-CURSOR                         DPKCS031
111700         PERFORM Z300-FETCH-TAIDKEY-CURSOR                        DPKCS031
111800         PERFORM G100-LOOP-TO-POPULATE-SCREEN                     DPKCS031
111900             UNTIL SQLCODE = +100                                 DPKCS031
112000         PERFORM Z400-CLOSE-TAIDKEY-CURSOR                        DPKCS031
112100         MOVE SPACES TO ANAVKEYO                                  DPKCS031
112200     ELSE                                                         DPKCS031
112300         SET PS-ERROR        TO TRUE                              DPKCS031
112400         SET DP020-MSG-FATAL TO TRUE                              DPKCS031
112500                                                                  DPKCS031
112600         SET DP020-NEXT-ACT-APPL-ERROR                            DPKCS031
112700                             TO TRUE                              DPKCS031
112800         MOVE PC-TSYMSG-00148                                     DPKCS031
112900                             TO DP020-MSG-NUMBER                  DPKCS031
113000         IF  DP020-INT-APPL-FORMAT-IND EQUAL '2'                  DPKCS031
113100             SET DP002-ERR (DP031-MN-SUB)                         DPKCS031
113200                               TO  TRUE                           DPKCS031
113300             PERFORM D800-REWRITE-TSQB-QUEUE                      DPKCS031
113400         END-IF                                                   DPKCS031
113500         PERFORM DP015-1000-START-NAVIGATOR                       DPKCS031
113600     END-IF.                                                      DPKCS031
113700                                                                  DPKCS031
113800 EJECT                                                            DPKCS031
113900 F200-DISPLAY-PANEL.                                              DPKCS031
114000                                                                  DPKCS031
114100******************************************************************DPKCS031
114200*    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.       DPKCS031
114300*                                                                 DPKCS031
114400*    PERFORMED BY B100-CONTROL-PROCESSING.                        DPKCS031
114500*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS031
114600*    PERFORMED BY E100-SEND-INITIAL-SCREEN.                       DPKCS031
114700******************************************************************DPKCS031
114800                                                                  DPKCS031
114900     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       DPKCS031
115000                                                                  DPKCS031
115100     IF  PS-SEND-MAP-N-DATA-FRSET                                 DPKCS031
115200         PERFORM DP002-0000-FORMAT-TITLE-LINES                    DPKCS031
115300     END-IF.                                                      DPKCS031
115400                                                                  DPKCS031
115500     IF  PS-ERROR                                                 DPKCS031
115600         CONTINUE                                                 DPKCS031
115700     ELSE                                                         DPKCS031
115800         IF (PS-NEW-MNEMONIC-REQUESTED                            DPKCS031
115900         OR  PS-SEND-MAP-N-DATA-FRSET)                            DPKCS031
116000             PERFORM G200-MOVE-COMMAREA-TO-SCREEN                 DPKCS031
116100         END-IF                                                   DPKCS031
116200     END-IF.                                                      DPKCS031
116300                                                                  DPKCS031
116400     PERFORM DP005-0000-FORMAT-MSG-LINES.                         DPKCS031
116500                                                                  DPKCS031
116600     IF  PS-SEND-MAP-N-DATA-FRSET                                 DPKCS031
116700         PERFORM DP009-0000-LOAD-FK-LINES                         DPKCS031
116800     END-IF.                                                      DPKCS031
116900                                                                  DPKCS031
117000     MOVE -1 TO ANAVCMDL.                                         DPKCS031
117100                                                                  DPKCS031
117200     PERFORM DP008-0000-WRITE-PANEL.                              DPKCS031
117300 EJECT                                                            DPKCS031
117400 G100-LOOP-TO-POPULATE-SCREEN.                                    DPKCS031
117500******************************************************************DPKCS017
117600*    * READ THROUGH THE ENTIRE TAIDKEY TABLE, AND THE APPROPRIATE DPKCS017
117700*      ROWS ON THE TCICSROUTE TABLE.                                    17
117800*    * MOVE THE INFORMATION FROM BOTH TABLES TO THE COMMAREA.           17
117900******************************************************************DPKCS017
118000                                                                  DPKCS017
118100     MOVE TAIDKEY-AID-SEQUENCE-NMBR TO PS-SUB.                    DPKCS017
118200                                                                  DPKCS017
118300     PERFORM H100-POPULATE-SCR-COMMAREA.                          DPKCS017
118400     PERFORM Z300-FETCH-TAIDKEY-CURSOR.                           DPKCS017
118500 EJECT                                                            DPKCS017
118600                                                                        31
118700 G200-MOVE-COMMAREA-TO-SCREEN.                                    DPKCS031
118800                                                                  DPKCS031
118900******************************************************************DPKCS031
119000*    MOVE DATA FROM THE COMMAREA TO THE SCREEN.                   DPKCS031
119100*                                                                 DPKCS031
119200*    PERFORMED BY F200-DISPLAY-PANEL.                             DPKCS031
119300******************************************************************DPKCS031
119400                                                                  DPKCS031
119500     MOVE DP031-SCREEN-TRAN-ID        TO DPKM031-ATRANIDI.        DPKCS031
119600     MOVE DP031-SCREEN-MNEMONIC       TO DPKM031-AMNOMICI.        DPKCS031
119700     MOVE DP031-SCREEN-MNEMONIC-TITLE TO DPKM031-ANAMEI.          DPKCS031
119800                                                                  DPKCS031
119900     IF   DP031-SCR-SUB LESS THAN PC-MAX-FKEYS                    DPKCS031
120000         CONTINUE                                                 DPKCS031
120100     ELSE                                                         DPKCS031
120200         SUBTRACT PC-MAX-ITEMS-ON-SCREEN                          DPKCS031
120300                             FROM  DP031-SCR-SUB                  DPKCS031
120400     END-IF.                                                      DPKCS031
120500     MOVE DP031-SCR-SUB        TO  PV-HOLD-SCR-SUB.               DPKCS031
120600                                                                  DPKCS031
120700     PERFORM                                                      DPKCS031
120800         VARYING PS-SUB FROM 1 BY 1                               DPKCS031
120900         UNTIL PS-SUB > PC-MAX-ITEMS-ON-SCREEN                    DPKCS031
121000                                                                  DPKCS031
121100         IF  DP031-SCR-SUB GREATER PC-MAX-FKEYS                   DPKCS031
121200             MOVE SPACES       TO  DPKM031-AFKEYI (PS-SUB)        DPKCS031
121300                                   DPKM031-ASTATI (PS-SUB)        DPKCS031
121400                                   DPKM031-AACTI  (PS-SUB)        DPKCS031
121500                                   DPKM031-AACTDI (PS-SUB)        DPKCS031
121510                                   DPKM031-ADISPI (PS-SUB)        DPKCS031
121600                                   DPKM031-ALABLI (PS-SUB)        DPKCS031
121700                                   DPKM031-AMNEMI (PS-SUB)        DPKCS031
121800                                   DPKM031-AFORMI (PS-SUB)        DPKCS031
121900                                   DPKM031-ASTKI  (PS-SUB)        DPKCS031
122000             MOVE DP015-ASK-NOR-OFF                               DPKCS031
122100                               TO  DPKM031-AACTA  (PS-SUB)        DPKCS031
122110                                   DPKM031-ADISPA (PS-SUB)        DPKCS031
122200                                   DPKM031-ALABLA (PS-SUB)        DPKCS031
122300                                   DPKM031-AMNEMA (PS-SUB)        DPKCS031
122400                                   DPKM031-AFORMA (PS-SUB)        DPKCS031
122500                                   DPKM031-ASTKA  (PS-SUB)        DPKCS031
122600             MOVE DP015-HL-OFF                                    DPKCS031
122700                               TO  DPKM031-AACTH  (PS-SUB)        DPKCS031
122800                                   DPKM031-ADISPH (PS-SUB)        DPKCS031
122810                                   DPKM031-ALABLH (PS-SUB)        DPKCS031
122900                                   DPKM031-AMNEMH (PS-SUB)        DPKCS031
123000                                   DPKM031-AFORMH (PS-SUB)        DPKCS031
123100                                   DPKM031-ASTKH  (PS-SUB)        DPKCS031
123200         ELSE                                                     DPKCS031
123300                                                                  DPKCS031
123400             MOVE DP031-SCR-TAG(DP031-SCR-SUB)                    DPKCS031
123500                               TO  DPKM031-AFKEYI (PS-SUB)        DPKCS031
123600                                                                  DPKCS031
123700             MOVE DP031-SCR-STATUS(DP031-SCR-SUB)                 DPKCS031
123800                               TO  DPKM031-ASTATI (PS-SUB)        DPKCS031
123900                                                                  DPKCS031
124000             MOVE DP031-SCR-ACTION(DP031-SCR-SUB)                 DPKCS031
124100                               TO  DPKM031-AACTI  (PS-SUB)        DPKCS031
124200                                                                  DPKCS031
124300             MOVE DP031-SCR-ACTION-DESC(DP031-SCR-SUB)            DPKCS031
124400                               TO  DPKM031-AACTDI (PS-SUB)        DPKCS031
124500                                                                  DPKCS031
124600             MOVE DP031-SCR-DISP (DP031-SCR-SUB)                        31
124700                               TO  DPKM031-ADISPI (PS-SUB)        DPKCS031
124800                                                                  DPKCS031
124900             MOVE DP031-SCR-LABEL(DP031-SCR-SUB)                  DPKCS031
125000                               TO  DPKM031-ALABLI (PS-SUB)        DPKCS031
125100                                                                  DPKCS031
125200             MOVE DP031-SCR-MNEMONIC(DP031-SCR-SUB)               DPKCS031
125300                               TO  DPKM031-AMNEMI (PS-SUB)        DPKCS031
125400                                                                  DPKCS031
125500             MOVE DP031-SCR-FORMAT(DP031-SCR-SUB)                 DPKCS031
125600                               TO  DPKM031-AFORMI (PS-SUB)        DPKCS031
125700                                                                  DPKCS031
125800             MOVE DP031-SCR-STK(DP031-SCR-SUB)                    DPKCS031
125900                               TO  DPKM031-ASTKI  (PS-SUB)        DPKCS031
126000                                                                  DPKCS031
126100         END-IF                                                   DPKCS031
126200                                                                  DPKCS031
126300         ADD 1                 TO  DP031-SCR-SUB                  DPKCS031
126400                                                                  DPKCS031
126500     END-PERFORM.                                                 DPKCS031
126600                                                                  DPKCS031
126700     MOVE PV-HOLD-SCR-SUB      TO  DP031-SCR-SUB.                 DPKCS031
126800                                                                  DPKCS031
126900 EJECT                                                            DPKCS031
127000 H100-POPULATE-SCR-COMMAREA.                                      DPKCS017
127100******************************************************************DPKCS017
127200*    * SELECT THE ROW FROM THE TCICSROUTE TABLE THAT MATCHES THE        17
127300*      CURRENT FUNCTION KEY AND THE SCREEN MNEMONIC.                    17
127400*      * IF THE ROW IS FOUND:                                           17
127500*        1) SET THE 'ACTIVE' SWITCH ON.                                 17
127600*        2) POPULATE THIS FKEY ON THE SCREEN WITH DATA FROM             17
127700*           THE TCICSROUTE TABLE.                                       17
127800*      * IF THE ROW IS NOT FOUND:                                       17
127900*        1) SET THE 'ACTIVE' SWITCH OFF.                                17
128000*        2) POPULATE THIS FKEY ON THE SCREEN WITH DATA FROM             17
128100*           THE TAIDKEY TABLE.                                          17
128200******************************************************************DPKCS017
128300                                                                  DPKCS017
128400     MOVE TAIDKEY-AID-KEY-NAME TO  DP031-SCR-TAG(PS-SUB).         DPKCS017
128500                                                                  DPKCS017
128600******************************************************************DPKCS017
128700*    * SELECT THE ROW FROM THE TCICSROUTE TABLE THAT MATCHES THE        17
128800*      CURRENT FUNCTION KEY AND THE SCREEN MNEMONIC.                    17
128900*    * IF THE ROW IS FOUND:                                             17
129000*      1) SET THE 'ACTIVE' SWITCH ON.                                   17
129100*      2) MOVE POPULATE THIS FKEY ON THE SCREEN WITH DATA FROM          17
129200*         THE TCICSROUTE TABLE.                                         17
129300*    * IF THE ROW IS NOT FOUND:                                         17
129400*      1) SET THE 'ACTIVE' SWITCH OFF.                                  17
129500*      2) MOVE POPULATE THIS FKEY ON THE SCREEN WITH DATA FROM          17
129600*         THE TAIDKEY TABLE.                                            17
129700******************************************************************DPKCS017
129800     PERFORM Z500-SELECT-TCICSROUTE-ROW.                          DPKCS017
129900     IF SQLCODE = +0                                                    17
130000         MOVE PC-STATUS-ACTIVE TO  DP031-SCR-STATUS(PS-SUB)             17
130100         PERFORM H120-MOVE-ROUTE-TO-COMMAREA                            17
130200     ELSE                                                               17
130300         MOVE SPACES           TO  DP031-SCR-STATUS(PS-SUB)             17
130400         PERFORM H110-MOVE-AID-TO-COMMAREA                              17
130500     END-IF.                                                            17
130600     EJECT                                                        DPKCS017
130700                                                                  DPKCS017
130800 H110-MOVE-AID-TO-COMMAREA.                                       DPKCS017
130900******************************************************************DPKCS017
131000*    MOVE DATA FROM THE TAIDKEY ROW TO THE COMMAREA.              DPKCS017
131100*    (THIS ROW WAS NOT FOUND ON THE TCICSROUTE TABLE,                   17
131200*     SO POPULATE THE SCREEN WITH INFORMATION FROM TAIDKEY.)            17
131300******************************************************************DPKCS017
131400                                                                  DPKCS017
131500     MOVE TAIDKEY-STNRD-ACTION-CODE                               DPKCS017
131600                               TO  DP031-SCR-ACTION(PS-SUB)             17
131700                                   PV-FIND-ACT.                         17
131800     PERFORM J100-GET-ACTION-DESCRIPTION.                               17
131900                                                                  DPKCS017
132000     IF  IV-MNEMONIC-CODE NOT EQUAL PC-NULL-INDICATOR             DPKCS017
132100         MOVE TAIDKEY-MNEMONIC-CODE                               DPKCS017
132200                               TO  DP031-SCR-LABEL(PS-SUB)        DPKCS017
132300     END-IF.                                                      DPKCS017
132400                                                                  DPKCS017
132500     IF  ((TAIDKEY-STNRD-ACTION-CODE = PC-GO-TO-MNEMONIC)         DPKCS017
132600       OR (TAIDKEY-STNRD-ACTION-CODE = PC-LOCAL-GOTO))            DPKCS017
132700         MOVE PC-STACK         TO DP031-SCR-STK(PS-SUB)                 17
132800         MOVE DP031-SCR-LABEL (PS-SUB)                            DPKCS017
132900                               TO DP031-SCR-MNEMONIC (PS-SUB)     DPKCS017
133000         MOVE SPACE            TO DP031-SCR-LABEL (PS-SUB)        DPKCS017
133100     ELSE                                                         DPKCS017
133200         MOVE SPACES           TO DP031-SCR-STK(PS-SUB)                 17
133300     END-IF.                                                      DPKCS017
133400                                                                  DPKCS017
133500 EJECT                                                            DPKCS017
133600 H120-MOVE-ROUTE-TO-COMMAREA.                                     DPKCS017
133700******************************************************************DPKCS017
133800*    MOVE DATA FROM THE TCICSROUTE ROW TO THE COMMAREA.           DPKCS017
133900******************************************************************DPKCS017
134000     MOVE TCICSROUTE-ACTION-CODE        TO                              17
134100                                       DP031-SCR-ACTION(PS-SUB)         17
134200                                       PV-FIND-ACT                      17
134300     PERFORM J100-GET-ACTION-DESCRIPTION                                17
134400     MOVE TCICSROUTE-FUNC-KY-DISPN-IND  TO                              17
134500                                       DP031-SCR-DISP(PS-SUB).          17
134600     MOVE TCICSROUTE-FUNC-KEY-LBL-NAME  TO                              17
134700                                       DP031-SCR-LABEL(PS-SUB).         17
134800     MOVE TCICSROUTE-DEST-MNEMONIC-CODE TO                              17
134900                                       DP031-SCR-MNEMONIC(PS-SUB).      17
135000     MOVE TCICSROUTE-IN-APLCTN-COMM-CDE TO                              17
135100                                       DP031-SCR-FORMAT(PS-SUB).        17
135200     MOVE TCICSROUTE-ROUTE-STACK-INDCT  TO                              17
135300                                       DP031-SCR-STK(PS-SUB).           17
135400     PERFORM Y100-REFORMAT-TIMESTAMP-SHORT.                             17
135500 EJECT                                                            DPKCS017
135600                                                                  DPKCS017
135700 J100-GET-ACTION-DESCRIPTION.                                           17
135800******************************************************************DPKCS017
135900*    SEARCH THE PROGRAM TABLE IN WORKING STORAGE FOR THE          DPKCS017
136000*    DESCRIPTION WHICH CORRESPONDS TO THE THE CURRENT "ACTION"    DPKCS017
136100*    FROM THE DB2 TAIDKEY TABLE -OR- THE DB2 TCICSROUTE TABLE           17
136200*    (AS STORED IN PV-FIND-ACT BEFORE CALLING THIS PARAGRAPH).          17
136300******************************************************************DPKCS017
136400     SET PT-FT-IND TO  1.                                               17
136500     SEARCH PT-FKEY-TABLE                                               17
136600       VARYING PT-FT-IND                                                17
136700         WHEN PT-FT-ACT(PT-FT-IND) = PV-FIND-ACT                        17
136900              MOVE PT-FT-DESC (PT-FT-IND)                               17
137000                               TO  DP031-SCR-ACTION-DESC(PS-SUB)        17
137200         WHEN PT-FT-ACT(PT-FT-IND) = HIGH-VALUE                         17
137300              MOVE SPACES      TO  DP031-SCR-ACTION-DESC(PS-SUB)        17
137400         END-SEARCH.                                              DPKCS017
137500 EJECT                                                            DPKCS017
137600                                                                  DPKCS017
137700 I100-RETREIVE-ROUTE-ROW.                                         DPKCS031
137800                                                                  DPKCS031
137900******************************************************************DPKCS031
138000*    SELECT THE ROW FROM THE TCICSROUTE TABLE THAT MATCHES THE    DPKCS031
138100*    CURRENT FUNCTION KEY AND THE SCREEN MNEMONIC.                DPKCS031
138200*    IF  THE ROW IS FOUND, MOVE THE DATA TO THE COMMAREA AND SET  DPKCS031
138300*    THE ACTIVE SWITCH ON.                                        DPKCS031
138400*    IF  THE ROW IS NOT FOUND, SET THE ACTIVE SWITCH OFF.         DPKCS031
138500*                                                                 DPKCS031
138600*    PERFORMED BY H100-POPULATE-SCR-COMMAREA.                     DPKCS031
138700******************************************************************DPKCS031
138800                                                                  DPKCS031
138900     PERFORM Z500-SELECT-TCICSROUTE-ROW.                          DPKCS031
139000                                                                  DPKCS031
139100     IF  SQLCODE = +0                                             DPKCS031
139200         MOVE TCICSROUTE-DEST-MNEMONIC-CODE TO                    DPKCS031
139300              DP031-SCR-MNEMONIC(PS-SUB)                          DPKCS031
139400         MOVE TCICSROUTE-ACTION-CODE        TO                    DPKCS031
139500              DP031-SCR-ACTION(PS-SUB)                            DPKCS031
139600         PERFORM Y100-REFORMAT-TIMESTAMP-SHORT                          17
139700         MOVE TCICSROUTE-FUNC-KY-DISPN-IND  TO                    DPKCS031
139800              DP031-SCR-DISP(PS-SUB)                                    31
139810         MOVE TCICSROUTE-FUNC-KEY-LBL-NAME  TO                    DPKCS031
139820              DP031-SCR-LABEL(PS-SUB)                             DPKCS031
139900         MOVE TCICSROUTE-IN-APLCTN-COMM-CDE TO                    DPKCS031
140000              DP031-SCR-FORMAT(PS-SUB)                            DPKCS031
140100         MOVE PC-STATUS-ACTIVE              TO                    DPKCS031
140200              DP031-SCR-STATUS(PS-SUB)                            DPKCS031
140300                                                                  DPKCS031
140400         IF (TCICSROUTE-ACTION-CODE = PC-GO-TO-MNEMONIC) OR       DPKCS031
140500            (TCICSROUTE-ACTION-CODE = PC-LOCAL-GOTO)              DPKCS031
140600             MOVE TCICSROUTE-ROUTE-STACK-INDCT TO                 DPKCS031
140700                  DP031-SCR-STK(PS-SUB)                           DPKCS031
140800         ELSE                                                     DPKCS031
140900             MOVE SPACES                       TO                 DPKCS031
141000                  DP031-SCR-STK(PS-SUB)                           DPKCS031
141100         END-IF                                                   DPKCS031
141200                                                                  DPKCS031
141300         MOVE TCICSROUTE-ACTION-CODE TO PV-FIND-ACT                     31
141400         PERFORM J100-GET-ACTION-DESCRIPTION                            17
141500     ELSE                                                         DPKCS031
141600         MOVE SPACES  TO  DP031-SCR-STATUS(PS-SUB)                      31
141700     END-IF.                                                      DPKCS031
141800 EJECT                                                            DPKCS031
141900                                                                        31
142000 Y100-REFORMAT-TIMESTAMP-SHORT.                                         17
142100******************************************************************DPKCS017
142200*    REFORMAT THE TIMESTAMP.                                      DPKCS017
142300*    * SHORTEN IT FROM 26 CHARACTERS TO 20 CHARACTERS FOR STORAGE DPKCS017
142400*      IN THE COMMAREA.                                                 17
142500*    * SHORTEN IT BY REMOVING THE DASHES AND DOTS.                DPKCS017
142600******************************************************************DPKCS017
142700     MOVE TCICSROUTE-LAST-UPDATE-TMESTP TO PV-TMESTP.                   17
142800     MOVE PV-TRC-CCYY                   TO PV-TRS-CCYY.           DPKCS017
142900     MOVE PV-TRC-MM                     TO PV-TRS-MM.             DPKCS017
143000     MOVE PV-TRC-DD                     TO PV-TRS-DD.             DPKCS017
143100     MOVE PV-TRC-HR                     TO PV-TRS-HR.             DPKCS017
143200     MOVE PV-TRC-MN                     TO PV-TRS-MN.             DPKCS017
143300     MOVE PV-TRC-SC                     TO PV-TRS-SC.             DPKCS017
143400     MOVE PV-TRC-TK                     TO PV-TRS-TK.             DPKCS017
143500     MOVE PV-TMESTP-REFORMAT-SHORT-X20  TO                              17
143600                                        DP031-SCR-TMESTP(PS-SUB).       17
143700 EJECT                                                            DPKCS017
143800                                                                  DPKCS017
143900 Z100-SELECT-TMNEMONIC-ROW.                                       DPKCS031
144000                                                                  DPKCS031
144100******************************************************************DPKCS031
144200*    SELECT A ROW FROM THE TMNEMONIC TABLE.                       DPKCS031
144300*                                                                 DPKCS031
144400*    PERFORMED BY F100-RETRIEVE-DATA-FOR-SCREEN.                  DPKCS031
144500*    PERFORMED BY F400-EDIT-SELECTED-FKEY.                        DPKCS031
144600******************************************************************DPKCS031
144700                                                                  DPKCS031
144800     EXEC SQL                                                     DPKCS031
144900         SELECT TRANS_ID_CODE,                                    DPKCS031
145000                SCRN_TYP_CDE,                                     DPKCS031
145100                PANEL_TITLE_NAME                                  DPKCS031
145200         INTO :TMNEMONIC-TRANS-ID-CODE,                           DPKCS031
145300              :TMNEMONIC-SCRN-TYP-CDE,                            DPKCS031
145400              :TMNEMONIC-PANEL-TITLE-NAME                         DPKCS031
145500              :IV-PANEL-TITLE-NAME                                DPKCS031
145600         FROM TMNEMONIC                                           DPKCS031
145700         WHERE MNEMONIC_CODE = :PV-MNEMONIC                       DPKCS031
145800     END-EXEC.                                                    DPKCS031
145900                                                                  DPKCS031
146000     EVALUATE TRUE                                                DPKCS031
146100                                                                  DPKCS031
146200         WHEN SQLCODE = +0                                        DPKCS031
146300         WHEN SQLCODE = +100                                      DPKCS031
146400             CONTINUE                                             DPKCS031
146500                                                                  DPKCS031
146600         WHEN OTHER                                               DPKCS031
146700             SET DP013-DB2-ABEND TO TRUE                          DPKCS031
146800             SET DP013-ROLLBACK  TO TRUE                          DPKCS031
146900                                                                  DPKCS031
147000             MOVE 'Z100-SELECT-TMNEMONIC-ROW' TO                  DPKCS031
147100                  DP013-PARAGRAPH                                 DPKCS031
147200             MOVE SQLCODE                     TO                  DPKCS031
147300                  PM-SQLCODE-2                                    DPKCS031
147400             MOVE SQLCA                       TO                  DPKCS031
147500                  DP013-SQLCA                                     DPKCS031
147600             MOVE PM-PROGRAM-MESSAGE-2        TO                  DPKCS031
147700                  DP013-MESSAGE-TEXT(1)                           DPKCS031
147800                                                                  DPKCS031
147900             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS031
148000                                                                  DPKCS031
148100     END-EVALUATE.                                                DPKCS031
148200 EJECT                                                            DPKCS031
148300 Z200-OPEN-TAIDKEY-CURSOR.                                        DPKCS031
148400                                                                  DPKCS031
148500******************************************************************DPKCS031
148600*    OPEN THE TAIDKEY-CURSOR CURSOR                               DPKCS031
148700*                                                                 DPKCS031
148800*    PERFORMED BY F100-RETRIEVE-DATA-FOR-SCREEN.                  DPKCS031
148900******************************************************************DPKCS031
149000                                                                  DPKCS031
149100     EXEC SQL                                                     DPKCS031
149200         OPEN TAIDKEY-CURSOR                                      DPKCS031
149300     END-EXEC.                                                    DPKCS031
149400                                                                  DPKCS031
149500     EVALUATE TRUE                                                DPKCS031
149600                                                                  DPKCS031
149700         WHEN SQLCODE = +0                                        DPKCS031
149800         WHEN SQLCODE = +100                                      DPKCS031
149900             CONTINUE                                             DPKCS031
150000                                                                  DPKCS031
150100         WHEN OTHER                                               DPKCS031
150200             SET DP013-DB2-ABEND TO TRUE                          DPKCS031
150300             SET DP013-ROLLBACK  TO TRUE                          DPKCS031
150400                                                                  DPKCS031
150500             MOVE 'Z200-OPEN-TAIDKEY-CURSOR' TO DP013-PARAGRAPH   DPKCS031
150600             MOVE SQLCODE              TO PM-SQLCODE-3            DPKCS031
150700             MOVE SQLCA                TO DP013-SQLCA             DPKCS031
150800             MOVE PM-PROGRAM-MESSAGE-3 TO DP013-MESSAGE-TEXT(1)   DPKCS031
150900                                                                  DPKCS031
151000             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS031
151100                                                                  DPKCS031
151200     END-EVALUATE.                                                DPKCS031
151300 EJECT                                                            DPKCS031
151400 Z300-FETCH-TAIDKEY-CURSOR.                                       DPKCS031
151500                                                                  DPKCS031
151600******************************************************************DPKCS031
151700*    FETCH A ROW FROM THE TAIDKEY TABLE USING THE CURSOR.         DPKCS031
151800*                                                                 DPKCS031
151900*    PERFORMED BY F100-RETRIEVE-DATA-FOR-SCREEN.                  DPKCS031
152000*    PERFORMED BY G100-LOOP-TO-POPULATE-SCREEN.                   DPKCS031
152100******************************************************************DPKCS031
152200                                                                  DPKCS031
152300     EXEC SQL                                                     DPKCS031
152400         FETCH TAIDKEY-CURSOR                                     DPKCS031
152500         INTO :TAIDKEY-AID-SEQUENCE-NMBR,                         DPKCS031
152600              :TAIDKEY-AID-KEY-NAME,                              DPKCS031
152700              :TAIDKEY-STNRD-ACTION-CODE,                         DPKCS031
152800              :TAIDKEY-SYSWIDE-USE-INDCT,                         DPKCS031
152900              :TAIDKEY-MNDTRY-MNMNC-INDCT,                        DPKCS031
153000              :TAIDKEY-MNEMONIC-CODE                              DPKCS031
153100              :IV-MNEMONIC-CODE                                   DPKCS031
153200     END-EXEC.                                                    DPKCS031
153300                                                                  DPKCS031
153400     EVALUATE TRUE                                                DPKCS031
153500                                                                  DPKCS031
153600         WHEN SQLCODE = +0                                        DPKCS031
153700         WHEN SQLCODE = +100                                      DPKCS031
153800             CONTINUE                                             DPKCS031
153900                                                                  DPKCS031
154000         WHEN OTHER                                               DPKCS031
154100             SET DP013-DB2-ABEND TO TRUE                          DPKCS031
154200             SET DP013-ROLLBACK  TO TRUE                          DPKCS031
154300                                                                  DPKCS031
154400             MOVE 'Z300-FETCH-TAIDKEY-CURSOR' TO DP013-PARAGRAPH  DPKCS031
154500             MOVE SQLCODE              TO PM-SQLCODE-4            DPKCS031
154600             MOVE SQLCA                TO DP013-SQLCA             DPKCS031
154700             MOVE PM-PROGRAM-MESSAGE-4 TO DP013-MESSAGE-TEXT(1)   DPKCS031
154800                                                                  DPKCS031
154900             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS031
155000                                                                  DPKCS031
155100     END-EVALUATE.                                                DPKCS031
155200 EJECT                                                            DPKCS031
155300 Z400-CLOSE-TAIDKEY-CURSOR.                                       DPKCS031
155400                                                                  DPKCS031
155500******************************************************************DPKCS031
155600*    CLOSE THE TAIDKEY-CURSOR CURSOR                              DPKCS031
155700*                                                                 DPKCS031
155800*    PERFORMED BY F100-RETRIEVE-DATA-FOR-SCREEN.                  DPKCS031
155900******************************************************************DPKCS031
156000                                                                  DPKCS031
156100     EXEC SQL                                                     DPKCS031
156200         CLOSE TAIDKEY-CURSOR                                     DPKCS031
156300     END-EXEC.                                                    DPKCS031
156400                                                                  DPKCS031
156500     EVALUATE TRUE                                                DPKCS031
156600                                                                  DPKCS031
156700         WHEN SQLCODE = +0                                        DPKCS031
156800         WHEN SQLCODE = +100                                      DPKCS031
156900             CONTINUE                                             DPKCS031
157000                                                                  DPKCS031
157100         WHEN OTHER                                               DPKCS031
157200             SET DP013-DB2-ABEND TO TRUE                          DPKCS031
157300             SET DP013-ROLLBACK  TO TRUE                          DPKCS031
157400                                                                  DPKCS031
157500             MOVE 'Z400-CLOSE-TAIDKEY-CURSOR' TO DP013-PARAGRAPH  DPKCS031
157600             MOVE SQLCODE              TO PM-SQLCODE-5            DPKCS031
157700             MOVE SQLCA                TO DP013-SQLCA             DPKCS031
157800             MOVE PM-PROGRAM-MESSAGE-5 TO DP013-MESSAGE-TEXT(1)   DPKCS031
157900                                                                  DPKCS031
158000             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS031
158100                                                                  DPKCS031
158200     END-EVALUATE.                                                DPKCS031
158300 EJECT                                                            DPKCS031
158400 Z500-SELECT-TCICSROUTE-ROW.                                      DPKCS031
158500                                                                  DPKCS031
158600******************************************************************DPKCS031
158700*    SELECT A ROW FROM THE TCICSROUTE TABLE                       DPKCS031
158800*                                                                 DPKCS031
158900*    PERFORMED BY E600-PROCESS-ADDS-UPDATES.                      DPKCS031
159000*    PERFORMED BY F300-DELETE.                                    DPKCS031
159100*    PERFORMED BY I100-RETREIVE-ROUTE-ROW.                        DPKCS031
159200******************************************************************DPKCS031
159300                                                                  DPKCS031
159400     MOVE PS-SUB TO PV-SEQUENCE-NMBR.                             DPKCS031
159500                                                                  DPKCS031
159600     EXEC SQL                                                     DPKCS031
159700         SELECT DEST_MNEMONIC_CODE,                               DPKCS031
159800                ACTION_CODE,                                      DPKCS031
159900                LAST_UPDATE_TMESTP,                               DPKCS031
160000                ROUTE_STACK_INDCT,                                DPKCS031
160100                IN_APLCTN_COMM_CDE,                               DPKCS031
160200                FUNC_KEY_LBL_NAME,                                DPKCS031
160300                FUNC_KY_DISPN_IND                                 DPKCS031
160400         INTO :TCICSROUTE-DEST-MNEMONIC-CODE,                     DPKCS031
160500              :TCICSROUTE-ACTION-CODE,                            DPKCS031
160600              :TCICSROUTE-LAST-UPDATE-TMESTP,                     DPKCS031
160700              :TCICSROUTE-ROUTE-STACK-INDCT,                      DPKCS031
160800              :TCICSROUTE-IN-APLCTN-COMM-CDE,                     DPKCS031
160900              :TCICSROUTE-FUNC-KEY-LBL-NAME,                      DPKCS031
161000              :TCICSROUTE-FUNC-KY-DISPN-IND                       DPKCS031
161100         FROM TCICSROUTE                                          DPKCS031
161200         WHERE (MNEMONIC_CODE     = :DP031-SCREEN-MNEMONIC) AND   DPKCS031
161300               (AID_SEQUENCE_NMBR = :PV-SEQUENCE-NMBR-CHAR)       DPKCS031
161400     END-EXEC.                                                    DPKCS031
161500                                                                  DPKCS031
161600     EVALUATE TRUE                                                DPKCS031
161700                                                                  DPKCS031
161800         WHEN SQLCODE = +0                                        DPKCS031
161900         WHEN SQLCODE = +100                                      DPKCS031
162000             CONTINUE                                             DPKCS031
162100                                                                  DPKCS031
162200         WHEN OTHER                                               DPKCS031
162300             SET DP013-DB2-ABEND TO TRUE                          DPKCS031
162400             SET DP013-ROLLBACK  TO TRUE                          DPKCS031
162500                                                                  DPKCS031
162600             MOVE 'Z500-SELECT-TCICSROUTE-ROW' TO                 DPKCS031
162700                  DP013-PARAGRAPH                                 DPKCS031
162800             MOVE SQLCODE                      TO                 DPKCS031
162900                  PM-SQLCODE-6                                    DPKCS031
163000             MOVE SQLCA                        TO                 DPKCS031
163100                  DP013-SQLCA                                     DPKCS031
163200             MOVE PM-PROGRAM-MESSAGE-6         TO                 DPKCS031
163300                  DP013-MESSAGE-TEXT(1)                           DPKCS031
163400                                                                  DPKCS031
163500             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS031
163600                                                                  DPKCS031
163700     END-EVALUATE.                                                DPKCS031
163800 EJECT                                                            DPKCS031
163900 Z550-SELECT-TCICSROUTE-ROW.                                      DPKCS031
164000                                                                  DPKCS031
164100******************************************************************DPKCS031
164200*    SELECT A ROW FROM THE TCICSROUTE TABLE                       DPKCS031
164300*                                                                 DPKCS031
164400*    PERFORMED BY F400                                            DPKCS031
164500******************************************************************DPKCS031
164600                                                                  DPKCS031
164700     MOVE DP031-SCR-FORMAT(PS-SUB)   TO  PV-FORMAT.                     31
164800     MOVE DP031-SCR-MNEMONIC(PS-SUB) TO  PV-MNEMONIC.                   31
164900                                                                  DPKCS031
165000     EXEC SQL                                                     DPKCS031
165100         SELECT   IN_APLCTN_COMM_CDE                              DPKCS031
165200         INTO     :TCICSROUTE-IN-APLCTN-COMM-CDE                  DPKCS031
165300         FROM     TCICSROUTE                                      DPKCS031
165400         WHERE    (DEST_MNEMONIC_CODE = :PV-MNEMONIC              DPKCS031
165500          AND      MNEMONIC_CODE     ^= :DP031-SCREEN-MNEMONIC    DPKCS031
165600          AND      IN_APLCTN_COMM_CDE = :PV-FORMAT)               DPKCS031
165700     END-EXEC.                                                    DPKCS031
165800                                                                  DPKCS031
165900     EVALUATE TRUE                                                DPKCS031
166000                                                                  DPKCS031
166100         WHEN SQLCODE = +100                                      DPKCS031
166200              CONTINUE                                            DPKCS031
166300         WHEN SQLCODE = +0                                        DPKCS031
166400         WHEN SQLCODE = -811                                      DPKCS031
166500              SET PS-WARNING     TO TRUE                          DPKCS031
166600                                                                  DPKCS031
166700         WHEN OTHER                                               DPKCS031
166800             SET DP013-DB2-ABEND TO TRUE                          DPKCS031
166900             SET DP013-ROLLBACK  TO TRUE                          DPKCS031
167000                                                                  DPKCS031
167100             MOVE 'Z550-SELECT-TCICSROUTE-ROW' TO                 DPKCS031
167200                  DP013-PARAGRAPH                                 DPKCS031
167300             MOVE SQLCODE                      TO                 DPKCS031
167400                  PM-SQLCODE-6                                    DPKCS031
167500             MOVE SQLCA                        TO                 DPKCS031
167600                  DP013-SQLCA                                     DPKCS031
167700             MOVE PM-PROGRAM-MESSAGE-6         TO                 DPKCS031
167800                  DP013-MESSAGE-TEXT(1)                           DPKCS031
167900                                                                  DPKCS031
168000             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS031
168100                                                                  DPKCS031
168200     END-EVALUATE.                                                DPKCS031
168300 EJECT                                                            DPKCS031
168400 Z560-SELECT-TMENUITEM-ROW.                                       DPKCS031
168500                                                                  DPKCS031
168600******************************************************************DPKCS031
168700*    SELECT FROM THE MENUITEM TABLE.                              DPKCS031
168800*                                                                 DPKCS031
168900*    PERFORMED BY F400                                            DPKCS031
169000******************************************************************DPKCS031
169100                                                                  DPKCS031
169200     MOVE DP031-SCR-FORMAT(PS-SUB)   TO  PV-FORMAT.                     31
169300     MOVE DP031-SCR-MNEMONIC(PS-SUB) TO  PV-MNEMONIC.                   31
169400                                                                  DPKCS031
169500     EXEC SQL                                                     DPKCS031
169600         SELECT   IN_APLCTN_COMM_CDE                              DPKCS031
169700         INTO     :TMENUITEM-IN-APLCTN-COMM-CDE                   DPKCS031
169800         FROM     TMENUITEM                                       DPKCS031
169900         WHERE    (ITEM_MNEMONIC_CODE = :PV-MNEMONIC              DPKCS031
170000          AND      IN_APLCTN_COMM_CDE = :PV-FORMAT)               DPKCS031
170100     END-EXEC.                                                    DPKCS031
170200                                                                  DPKCS031
170300     EVALUATE TRUE                                                DPKCS031
170400                                                                  DPKCS031
170500         WHEN SQLCODE = +100                                      DPKCS031
170600              CONTINUE                                            DPKCS031
170700         WHEN SQLCODE = +0                                        DPKCS031
170800         WHEN SQLCODE = -811                                      DPKCS031
170900              SET PS-WARNING     TO TRUE                          DPKCS031
171000                                                                  DPKCS031
171100         WHEN OTHER                                               DPKCS031
171200             SET DP013-DB2-ABEND TO TRUE                          DPKCS031
171300             SET DP013-ROLLBACK  TO TRUE                          DPKCS031
171400                                                                  DPKCS031
171500             MOVE 'Z560-SELECT-TMENUITEM-ROW ' TO                 DPKCS031
171600                  DP013-PARAGRAPH                                 DPKCS031
171700             MOVE SQLCODE                      TO                 DPKCS031
171800                  PM-SQLCODE-6                                    DPKCS031
171900             MOVE SQLCA                        TO                 DPKCS031
172000                  DP013-SQLCA                                     DPKCS031
172100             MOVE PM-PROGRAM-MESSAGE-6         TO                 DPKCS031
172200                  DP013-MESSAGE-TEXT(1)                           DPKCS031
172300                                                                  DPKCS031
172400             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS031
172500                                                                  DPKCS031
172600     END-EVALUATE.                                                DPKCS031
172700 EJECT                                                            DPKCS031
172800 Z600-SELECT-TAIDKEY-ROW.                                         DPKCS031
172900                                                                  DPKCS031
173000******************************************************************DPKCS031
173100*    SELECT A ROW FROM THE TAIDKEY TABLE                          DPKCS031
173200*                                                                 DPKCS031
173300*    PERFORMED BY E200-CHECK-FIELDS.                              DPKCS031
173400*    PERFORMED BY E300-PROCESS-DELETES.                           DPKCS031
173500*    PERFORMED BY F400-EDIT-SELECTED-FKEY.                        DPKCS031
173600******************************************************************DPKCS031
173700                                                                  DPKCS031
173800     MOVE PS-SUB TO PV-SEQUENCE-NMBR.                             DPKCS031
173900                                                                  DPKCS031
174000     EXEC SQL                                                     DPKCS031
174100         SELECT AID_SEQUENCE_NMBR,                                DPKCS031
174200                AID_KEY_NAME,                                     DPKCS031
174300                STNRD_ACTION_CODE,                                DPKCS031
174400                SYSWIDE_USE_INDCT,                                DPKCS031
174500                MNDTRY_MNMNC_INDCT,                               DPKCS031
174600                MNEMONIC_CODE                                     DPKCS031
174700         INTO :TAIDKEY-AID-SEQUENCE-NMBR,                         DPKCS031
174800              :TAIDKEY-AID-KEY-NAME,                              DPKCS031
174900              :TAIDKEY-STNRD-ACTION-CODE,                         DPKCS031
175000              :TAIDKEY-SYSWIDE-USE-INDCT,                         DPKCS031
175100              :TAIDKEY-MNDTRY-MNMNC-INDCT,                        DPKCS031
175200              :TAIDKEY-MNEMONIC-CODE                              DPKCS031
175300              :IV-MNEMONIC-CODE                                   DPKCS031
175400         FROM TAIDKEY                                             DPKCS031
175500         WHERE AID_SEQUENCE_NMBR = :PV-SEQUENCE-NMBR-CHAR         DPKCS031
175600          AND  SCRN_TYP_CDE      = :DP031-SCR-TYP-CDE             DPKCS031
175700     END-EXEC.                                                    DPKCS031
175800                                                                  DPKCS031
175900     EVALUATE TRUE                                                DPKCS031
176000                                                                  DPKCS031
176100         WHEN SQLCODE = +0                                        DPKCS031
176200             CONTINUE                                             DPKCS031
176300                                                                  DPKCS031
176400         WHEN OTHER                                               DPKCS031
176500             SET DP013-DB2-ABEND TO TRUE                          DPKCS031
176600             SET DP013-ROLLBACK  TO TRUE                          DPKCS031
176700                                                                  DPKCS031
176800             MOVE 'Z600-SELECT-TAIDKEY-ROW' TO                    DPKCS031
176900                  DP013-PARAGRAPH                                 DPKCS031
177000             MOVE SQLCODE                   TO                    DPKCS031
177100                  PM-SQLCODE-8                                    DPKCS031
177200             MOVE SQLCA                     TO                    DPKCS031
177300                  DP013-SQLCA                                     DPKCS031
177400             MOVE PM-PROGRAM-MESSAGE-8      TO                    DPKCS031
177500                  DP013-MESSAGE-TEXT(1)                           DPKCS031
177600                                                                  DPKCS031
177700             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS031
177800                                                                  DPKCS031
177900     END-EVALUATE.                                                DPKCS031
178000 EJECT                                                            DPKCS031
178100******************************************************************DPKCS031
178200*    FILL IN SCREEN HEADER MODULE                                 DPKCS031
178300******************************************************************DPKCS031
178400                                                                  DPKCS031
178500     COPY DPPD022.                                                DPKCS031
178600 EJECT                                                            DPKCS031
178700******************************************************************DPKCS031
178800*    RETURN TO CICS MODULE                                        DPKCS031
178900******************************************************************DPKCS031
179000                                                                  DPKCS031
179100     COPY DPPD003.                                                DPKCS031
179200 EJECT                                                            DPKCS031
179300******************************************************************DPKCS031
179400*    FORMAT MESSAGE LINES MODULE                                  DPKCS031
179500******************************************************************DPKCS031
179600                                                                  DPKCS031
179700     COPY DPPD005.                                                DPKCS031
179800 EJECT                                                            DPKCS031
179900******************************************************************DPKCS031
180000*    GET PANEL MODULE                                             DPKCS031
180100******************************************************************DPKCS031
180200                                                                  DPKCS031
180300     COPY DPPD007.                                                DPKCS031
180400 EJECT                                                            DPKCS031
180500******************************************************************DPKCS031
180600*    WRITE PANEL MODULE                                           DPKCS031
180700******************************************************************DPKCS031
180800                                                                  DPKCS031
180900     COPY DPPD008.                                                DPKCS031
181000 EJECT                                                            DPKCS031
181100******************************************************************DPKCS031
181200*    TOGGLE THE FUNCTION KEY LINE MODULE                          DPKCS031
181300******************************************************************DPKCS031
181400                                                                  DPKCS031
181500     COPY DPPD009.                                                DPKCS031
181600 EJECT                                                            DPKCS031
181700******************************************************************DPKCS031
181800*    ABEND PROCESSOR MODULE                                       DPKCS031
181900******************************************************************DPKCS031
182000                                                                  DPKCS031
182100     COPY DPPD013.                                                DPKCS031
182200 EJECT                                                            DPKCS031
182300******************************************************************DPKCS031
182400*    CHECK COMMUNICATION AREA MODULE                              DPKCS031
182500******************************************************************DPKCS031
182600                                                                  DPKCS031
182700     COPY DPPD015.                                                DPKCS031
182800 EJECT                                                            DPKCS031
182900******************************************************************DPKCS031
183000*    UPDATE TIME AND DATE MODULE                                  DPKCS031
183100******************************************************************DPKCS031
183200                                                                  DPKCS031
183300     COPY DPPD017.                                                DPKCS031
183400 EJECT                                                            DPKCS031
