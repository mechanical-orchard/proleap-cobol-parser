000200 IDENTIFICATION DIVISION.                                         00020001
000300 PROGRAM-ID.     APKUT243.                                        00030001
000400 AUTHOR.         KRYSTEN LEARY.                                   00040001
000500 DATE-WRITTEN.   MARCH 2005.                                      00050002
000600                                                                  00060002
000700******************************************************************00070001
000800*       CREATE AP MEMO DETAILS FOR AUTOMATIC NSD DEDUCTIONS      *00080005
000900******************************************************************00090002
001000*    COBOL II                                                    *00100002
001100******************************************************************00110002
001110*    THIS PROGRAM WILL REFORMAT THE MERCHANDISE ADJUSTMENT       *00111006
001111*    TRANSACTIONS FOR NSD DEDUCTIONS TO CREATE THE AP MEMO DATA  *00111106
001120*    TO BE LOADED INTO THE PSA12 TABLE.                          *00112006
001200******************************************************************00120001
001300*                                                                *00130001
001400* INPUT                                                          *00140001
001500* 1) MERCHDSE-ADJ-NSD-FILE                  (APRD045)            *00150001
001600*                                                                *00160001
001700* OUTPUT                                                         *00170001
001800* 1) AP-MEMO-DETL-FILE                      (APWSA12)            *00180001
002000*                                                                *00200001
002100******************************************************************00210001
002200* CHANGE LOG:                                                    *00220001
002300*                                                                *00230001
002400* DATE 03/03/2005                                                *00240012
002500*     CHANGE MADE: NEW STORE DISCOUNT AUTOMATION                 *00250012
002600*     INITIAL VERSION.                                           *00260012
002700*     MADE BY: KRYSTEN LEARY                   WR/IR: WR26679    *00270013
002800*                                                                *00280013
002900* DATE 04/12/2005                                                *00290013
003000*     CHANGE MADE: NEW STORE DISCOUNT AUTOMATION                 *00300013
003100*     CHANGED LENGTH OF OUTPUT FILE TO BE 200 INSTEAD OF 203.    *00310013
003110*     ALSO DECREASED THE LENGTH OF COPYBOOK APWSA12 TO BE 200    *00311014
003120*     INSTEAD OF 203.                                            *00312014
003200*     MADE BY: KRYSTEN LEARY                   WR/IR: P000753611 *00320016
004500******************************************************************00450001
004600                                                                  00460001
004700 ENVIRONMENT DIVISION.                                            00470001
004800                                                                  00480001
004900 INPUT-OUTPUT SECTION.                                            00490001
005000                                                                  00500001
005100 FILE-CONTROL.                                                    00510001
005200     SELECT MERCHDSE-ADJ-NSD-FILE     ASSIGN    TO UT-S-INP01.    00520001
005300     SELECT AP-MEMO-DETL-FILE         ASSIGN    TO UT-S-OUT01.    00530001
005500 DATA DIVISION.                                                   00550001
005600                                                                  00560001
005700 FILE SECTION.                                                    00570001
005800 FD  MERCHDSE-ADJ-NSD-FILE                                        00580001
005900         LABEL RECORDS  ARE STANDARD                              00590001
006000         RECORDING MODE IS  F                                     00600001
006100         DATA RECORD    IS  MERCHDSE-ADJ-NSD-RECORD.              00610001
006300 01  MERCHDSE-ADJ-NSD-RECORD       PIC X(500).                    00630001
006400                                                                  00640001
006500 FD  AP-MEMO-DETL-FILE                                            00650001
006600         LABEL RECORDS  ARE STANDARD                              00660001
006700         RECORDING MODE IS  F                                     00670001
006800         DATA RECORD    IS  AP-MEMO-DETL-RECORD.                  00680001
007000 01  AP-MEMO-DETL-RECORD           PIC X(200).                    00700013
007100                                                                  00710001
007900/                                                                 00790001
008000 WORKING-STORAGE SECTION.                                         00800001
008100                                                                  00810001
008200 01  FILLER                        PIC X(28) VALUE                00820002
008300                             '** WS FOR APKUT243 BEGINS **'.      00830002
008400 01  ABEND-CODE                    PIC S9(4) COMP SYNC.           00840001
008500*                                                                 00850004
008600 01  PV-WORK-AREA.                                                00860001
008700     05  PV-PROGRAM-NAME           PIC X(08)     VALUE 'APKUT243'.00870001
008800     05  PV-ADJ-NSD-IN-REC-CNT     PIC 9(09)     VALUE 0.         00880001
008900     05  PV-AP-MEMO-OUT-REC-CNT    PIC 9(09)     VALUE 0.         00890001
009000     05  PV-ORIGIN.                                               00900001
009100         10  PV-ORGN-CDE           PIC X(01).                     00910001
009200         10  PV-AP-TRN-CDE         PIC X(02).                     00920001
009300*                                                                 00930001
009400 01  PV-SWITCHES.                                                 00940001
009500     05  END-OF-ADJ-NSD-SW         PIC X(01)     VALUE 'N'.       00950002
009600         88  END-OF-ADJ-NSD                      VALUE 'Y'.       00960002
009700         88  NOT-END-OF-ADJ-NSD                  VALUE 'N'.       00970002
009800                                                                  00980001
010010*--------------------------------------------------------------*  01001002
010020*  INPUT RECORD LAYOUT                                         *  01002002
010030*--------------------------------------------------------------*  01003002
010100     COPY APRD045.                                                01010001
010200                                                                  01020001
010810*--------------------------------------------------------------*  01081002
010820*  OUTPUT RECORD LAYOUT                                        *  01082002
010830*--------------------------------------------------------------*  01083002
010900     COPY APWSA12.                                                01090001
011000                                                                  01100001
011100 01  FILLER                        PIC X(26) VALUE                01110002
011200                             '** WS FOR APKUT243 ENDS **'.        01120002
011600                                                                  01160001
011700 LINKAGE SECTION.                                                 01170004
011800***********************                                           01180002
012000 PROCEDURE DIVISION.                                              01200001
012100***********************                                           01210002
012200 A100-MAINLINE.                                                   01220001
012300                                                                  01230001
012400     PERFORM B100-INITIALIZATION.                                 01240001
012500                                                                  01250001
012600     PERFORM B200-PROCESS-ADJ-NSD-RECS                            01260001
012700        UNTIL END-OF-ADJ-NSD.                                     01270001
012800                                                                  01280001
012900     PERFORM Z900-END-OF-JOB.                                     01290001
013000                                                                  01300001
013100     GOBACK.                                                      01310001
013200        EJECT                                                     01320001
013210*--------------------------------------------------------------*  01321002
013220*  INITIALIZATION PROCESSING.                                  *  01322002
013230*--------------------------------------------------------------*  01323002
013300 B100-INITIALIZATION.                                             01330001
013400                                                                  01340001
013500     MOVE SPACES              TO AP045-TRANSACTION-FILE.          01350001
013600     INITIALIZE                  AP045-TRANSACTION-FILE.          01360001
013700     MOVE SPACES              TO WSA12-MEMO-WORK-RECORD.          01370001
013800     INITIALIZE                  WSA12-MEMO-WORK-RECORD.          01380001
013900                                                                  01390001
014000     SET NOT-END-OF-ADJ-NSD   TO TRUE.                            01400001
014300                                                                  01430001
014400     OPEN INPUT   MERCHDSE-ADJ-NSD-FILE                           01440001
014500          OUTPUT  AP-MEMO-DETL-FILE.                              01450001
014700                                                                  01470001
014800     PERFORM R100-READ-AP045.                                     01480001
014900                                                                  01490001
015000*--------------------------------------------------------------*  01500002
015100*  THIS ROUTINE HOLDS THE MAIN LOGIC FOR RECORD PROCESSING     *  01510002
015200*--------------------------------------------------------------*  01520002
015800 B200-PROCESS-ADJ-NSD-RECS.                                       01580001
015900                                                                  01590001
016000     MOVE PV-PROGRAM-NAME               TO WSA12-CRE-PROGRAM.     01600003
016100     MOVE AP045-VND-NBR                 TO WSA12-VENDOR-ID.       01610001
016200     MOVE AP045-DOC-NBR                 TO WSA12-INVOICE-ID.      01620001
016300     MOVE SPACES                        TO WSA12-KC-SKU-NBR.      01630001
016400     MOVE AP045-STR-NBR                 TO WSA12-DEPTID.          01640001
016500     MOVE AP045-PO-NBR                  TO WSA12-KC-PO-NBR.       01650001
016600     MOVE SPACES                        TO WSA12-KC-VS-NBR.       01660001
016700     MOVE ZERO                          TO WSA12-KC-INVC-QTY      01670001
016800                                           WSA12-KC-RCVD-QTY.     01680001
016900     MOVE AP045-NET-COST-AMT            TO WSA12-KC-INVC-COST-AMT.01690008
017000     MOVE ZERO                          TO WSA12-KC-ORD-COST-AMT. 01700001
017100     MOVE AP045-NET-COST-AMT            TO WSA12-KC-TOT-COST-AMT. 01710008
017200     MOVE AP045-ORGN-CDE                TO PV-ORGN-CDE.           01720001
017300     MOVE AP045-AP-TRN-CDE              TO PV-AP-TRN-CDE.         01730001
017400     MOVE PV-ORIGIN                     TO WSA12-ORIGIN.          01740001
017500     MOVE AP045-ENTR-DTE                TO WSA12-KC-CRE-DTE.      01750001
017600     MOVE AP045-ENTR-TMST               TO WSA12-KC-AP-MEMO-TMST. 01760011
017700     MOVE AP045-DEPT-NBR                TO WSA12-UPC-ID.          01770001
017800                                                                  01780001
017900     PERFORM W100-WRITE-AP-MEMO-REC.                              01790001
021600     PERFORM R100-READ-AP045.                                     02160001
021700                                                                  02170001
021710*--------------------------------------------------------------*  02171002
021720*  THIS ROUTINE READS THE MERCHANDISE ADJUSTMENTS FOR NSD      *  02172002
021721*  DEDUCTIONS                                                  *  02172102
021730*--------------------------------------------------------------*  02173002
021800 R100-READ-AP045.                                                 02180001
021900                                                                  02190001
022000     READ MERCHDSE-ADJ-NSD-FILE  INTO AP045-TRANSACTION-FILE      02200001
022100       AT END                                                     02210001
022110          SET END-OF-ADJ-NSD TO TRUE.                             02211001
022200                                                                  02220001
022300     IF NOT END-OF-ADJ-NSD                                        02230001
022400        ADD 1 TO PV-ADJ-NSD-IN-REC-CNT.                           02240001
022500                                                                  02250001
022510*--------------------------------------------------------------*  02251002
022520*  THIS ROUTINE WRITES THE AP MEMORANDUM DETAIL LINES          *  02252002
022530*--------------------------------------------------------------*  02253002
022600 W100-WRITE-AP-MEMO-REC.                                          02260001
022700                                                                  02270001
022800     WRITE AP-MEMO-DETL-RECORD FROM WSA12-MEMO-WORK-RECORD.       02280001
022900                                                                  02290001
023000     ADD 1 TO PV-AP-MEMO-OUT-REC-CNT.                             02300001
023100                                                                  02310001
023200*--------------------------------------------------------------*  02320002
023300*  END OF PROGRAM PROCESSING                                   *  02330002
023400*--------------------------------------------------------------*  02340002
023800 Z900-END-OF-JOB.                                                 02380001
023900                                                                  02390001
024500     DISPLAY '************************************************'.  02450001
024600     DISPLAY 'TOTAL AP045 RECORDS READ = '                        02460001
024700              PV-ADJ-NSD-IN-REC-CNT.                              02470001
024800     DISPLAY 'TOTAL WSA12 RECORDS WRITTEN = '                     02480001
024900              PV-AP-MEMO-OUT-REC-CNT.                             02490001
025200     DISPLAY '************************************************'.  02520001
025300                                                                  02530001
025400     DISPLAY ' PROGRAM APKUT243 ENDS NORMALLY '.                  02540001
025410                                                                  02541007
025420     CLOSE MERCHDSE-ADJ-NSD-FILE                                  02542007
025430           AP-MEMO-DETL-FILE.                                     02543007
025500                                                                  02550001
