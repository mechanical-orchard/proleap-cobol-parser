000100 IDENTIFICATION DIVISION.                                         00010000
000200 TITLE 'MANIFESTING - CRIT-SPEC FOR CLOSING A TRAILER AT A DOOR'. 00020000
000300                                                                  00030000
000400 PROGRAM-ID.             PCKRF876.                                00040000
000500 AUTHOR.                 DENNIS STEFFEN.                          00050000
000600 INSTALLATION.           KOHLS.                                   00060000
000700 DATE-WRITTEN.           MAY, 2001.                               00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000 ENVIRONMENT DIVISION.                                            00100000
001100 DATA DIVISION.                                                   00110000
001200                                                                  00120000
001300 WORKING-STORAGE SECTION.                                         00130000
001400                                                                  00140000
001500 01  PC-PROGRAM-CONSTANTS.                                        00150000
001600     05  PC-TRANID                    PIC X(04) VALUE 'E876'.     00160000
001700     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'PCKRF876'. 00170000
001800     05  PC-TRAILER-PROGRAM           PIC X(08) VALUE 'PCKCS714'. 00180003
001900     05  PC-DUMMY-TIMESTAMP           PIC X(26) VALUE             00190000
002000            '9999-09-09-09.09.09.999999'.                         00200000
002100     05  PC-LOW-TIMESTAMP             PIC X(26) VALUE             00210000
002200            '0001-01-01-00.00.00.000000'.                         00220000
002300                                                                  00230000
002400                                                                  00240000
002500* ERROR MESSAGES                                                 *00250000
002600     05  PC-UNRECOGNIZED-PF-KEY-MSG   PIC X(19) VALUE             00260000
002700                                           'UNRECOGNIZED PF KEY'. 00270000
002800     05  PC-ENTER-THROUGH-MENU-MSG    PIC X(19) VALUE             00280000
002900                                           'ENTER THROUGH MENU '. 00290000
003000     05  PC-TRANS-UNAVAILABLE-MSG     PIC X(19) VALUE             00300000
003100                                           'TRANS NOT AVAILABLE'. 00310000
003200     05  PC-WRONG-FACILITY            PIC X(19) VALUE             00320000
003300                                           'WRG FCLTY - F2 CONF'. 00330000
003400                                                                  00340000
003500 01  PS-PROGRAM-SWITCHES.                                         00350000
003600     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       00360000
003700         88  PS-ERRORS-YES                        VALUE 'Y'.      00370000
003800         88  PS-ERRORS-NO                         VALUE 'N'.      00380000
003900     05  PS-XCTL-SW                   PIC X(04)   VALUE SPACES.   00390000
004000         88  PS-XCTL-E871                       VALUE 'E871'.     00400000
004100         88  PS-XCTL-E873                       VALUE 'E873'.     00410000
004200         88  PS-XCTL-E877                       VALUE 'E877'.     00420000
004300     05  PS-VALID-INPUT-SW            PIC X(01) VALUE 'N'.        00430000
004400         88  PS-VALID-INPUT                       VALUE 'Y'.      00440000
004500         88  PS-INVALID-INPUT                     VALUE 'N'.      00450000
004600     05  PS-TCNTRID-SW                PIC X(01) VALUE 'N'.        00460000
004700         88  PS-TCNTRID-YES                       VALUE 'Y'.      00470000
004800         88  PS-TCNTRID-NO                        VALUE 'N'.      00480000
004900     05  PS-TCNDCDR-SW                PIC X(01) VALUE 'N'.        00490000
005000         88  PS-TCNDCDR-YES                       VALUE 'Y'.      00500000
005100         88  PS-TCNDCDR-NO                        VALUE 'N'.      00510000
005200     05  PS-TRLR-OPEN-SW              PIC X(04) VALUE SPACES.     00520000
005300         88  PS-TRLR-OPEN-THIS-DOOR             VALUE 'THIS'.     00530000
005400         88  PS-TRLR-OPEN-DIFF-DOOR             VALUE 'DIFF'.     00540000
005500     05  PC-STORE-DOOR-CSR-SW         PIC X(01) VALUE 'N'.        00550000
005600         88  PS-END-STORE-DOOR-CSR              VALUE 'Y'.        00560000
005700         88  PS-NOT-END-STORE-DOOR-CSR          VALUE 'N'.        00570000
005800     05  PS-DOOR-DEST-EDIT-SW         PIC X(01) VALUE 'Y'.        00580000
005900         88  PS-SKIP-DOOR-DEST-EDITS            VALUE 'N'.        00590000
006000         88  PS-DO-DOOR-DEST-EDITS              VALUE 'Y'.        00600000
006100     05  PS-DIVERT-DOOR-SW            PIC X(01) VALUE 'Y'.        00610000
006200         88  PS-DIVERT-DOOR-YES                 VALUE 'Y'.        00620000
006300         88  PS-DIVERT-DOOR-NO                  VALUE 'N'.        00630000
006400     05  PS-SERIAL-SW                 PIC X(01) VALUE 'N'.        00640000
006500         88  PS-SERIAL-NO                       VALUE 'N'.        00650000
006600         88  PS-SERIAL-YES                      VALUE 'Y'.        00660000
006700     05  PS-ACTIVE-TRIP-SW            PIC X(01) VALUE 'N'.        00670000
006800         88  PS-ACTIVE-TRIP-EXISTS              VALUE 'Y'.        00680000
006900         88  PS-NO-ACTIVE-TRIP-EXISTS           VALUE 'N'.        00690000
007000                                                                  00700000
007100 01  PV-PROGRAM-VARIABLES.                                        00710000
007200     05  PV-DOOR-COUNT                PIC S9(03) COMP-3.          00720000
007300     05  PV-DB2-COUNT                 PIC S9(03) COMP-3.          00730000
007400     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        00740000
007500                                                     COMP SYNC.   00750000
007600     05  PV-MESSAGE-AREA              PIC  X(19)  VALUE SPACE.    00760000
007700     05  PV-CICS-RESPONSE             PIC S9(09)  VALUE ZEROS     00770000
007800                                                     COMP SYNC.   00780000
007900     05  PV-TRANSFER-PROGRAM          PIC  X(08)  VALUE SPACE.    00790000
008000                                                                  00800000
008100 01  PV-LOG-MSG.                                                  00810000
008200     05  FILLER                       PIC X(12) VALUE             00820000
008300         ' E876 ERROR '.                                          00830000
008400     05  FILLER                       PIC X(06) VALUE             00840000
008500         'USER= '.                                                00850000
008600     05  PV-USER-ID                   PIC X(08) VALUE SPACES.     00860000
008700     05  FILLER                       PIC X(10) VALUE             00870000
008800         ' SQLCODE= '.                                            00880000
008900     05  PV-SQLCODE                   PIC -9(03).                 00890000
009000     05  FILLER                       PIC X(06) VALUE             00900000
009100         ' ERR= '.                                                00910000
009200     05  PV-ERROR-NBR                 PIC 9(03) VALUE ZERO.       00920000
009300     05  FILLER                       PIC X(07) VALUE             00930000
009400         ' DOOR= '.                                               00940000
009500     05  PV-DISPLAY-DOOR              PIC X(04) VALUE ZEROES.     00950000
009600/                                                                 00960000
009700 01  PV-MSG-48.                                                   00810000
009800     05  FILLER                       PIC X(01) VALUE SPACES.             
009900     05  PV-MSG-TIME-48               PIC X(15) VALUE SPACES.     00820000
010000                                                                          
010100     05  FILLER                       PIC X(19) VALUE             00820000
010200         ' E876 SERIAL ERROR '.                                   00830000
010300                                                                          
010400     05  FILLER                       PIC X(05) VALUE             00840000
010500         'LOC= '.                                                 00850000
010600     05  PV-LOC-48                    PIC 9(04) VALUE ZEROES.     00860000
010700                                                                          
010800     05  FILLER                       PIC X(07) VALUE             00930000
010900         ' DOOR= '.                                               00940000
011000     05  PV-DOOR-48                   PIC X(04) VALUE SPACES.     00950000
011100                                                                          
011200     05  FILLER                       PIC X(07) VALUE             00930000
011300         ' SRL#= '.                                               00940000
011400     05  PV-SERIAL-48                 PIC 9(09) VALUE ZEROES.     00950000
011500                                                                          
011600     05  FILLER                       PIC X(07) VALUE             00840000
011700         ' USER= '.                                               00850000
011800     05  PV-USER-ID-48                PIC X(08) VALUE SPACES.     00860000
011900                                                                          
012000     05  FILLER                       PIC X(07) VALUE             00840000
012100         ' FKEY= '.                                               00850000
012200     05  PV-FKEY-48                   PIC X(1) VALUE SPACES.      00860000
012300                                                                          
012400     05  FILLER                       PIC X(07) VALUE             00840000
012500         ' DEST= '.                                               00850000
012600     05  PV-DEST-48                   PIC 9(04) VALUE ZEROES.     00860000
012700                                                                          
012800     05  FILLER                       PIC X(07) VALUE             00840000
012900         ' SCAC= '.                                               00850000
013000     05  PV-SCAC-48                   PIC X(04) VALUE SPACES.     00860000
013100                                                                          
013200     05  FILLER                       PIC X(01) VALUE             00840000
013300         ' '.                                                     00850000
013400     05  PV-LAST-PGM-48               PIC X(08) VALUE SPACES.     00860000
013500                                                                          
013600/                                                                 00960000
013700 01  PV-EDITING-FIELDS.                                           00970000
013800     05  PV-SCREEN-DOOR               PIC X(04).                  00980000
013900     05  PV-SCREEN-DEST               PIC X(04).                  00990000
014000     05  PV-SCREEN-SERIAL-NBR         PIC X(09).                  01000000
014100                                                                  01010000
014200/                                                                 01020000
014300 01  CA-COMMAREA.                                                 01030000
014400     COPY PCWS233.                                                01040000
014500     05  CA-PRIVATE-COMMAREA          PIC X(100).                 01050000
014600     05  CA-REDEFINED-COMMAREA REDEFINES CA-PRIVATE-COMMAREA.     01060000
014700         10  CA-CURR-DOOR             PIC X(04).                  01070000
014800         10  CA-CURR-DEST             PIC 9(04).                  01080000
014900         10  CA-CURR-SERIAL-NBR       PIC 9(09).                  01090000
015000/                                                                 01100000
015100*  MAP LAYOUT                                                     01110000
015200     COPY PCKM876.                                                01120000
015300/                                                                 01130000
015400     COPY PCWS047.                                                01140003
015500/                                                                 01150003
015600* HELP SCREEN COMMAREA                                            01160000
015700     COPY PCWS192.                                                01170000
015800* HELP SCREEN WORK AREA                                           01180000
015900     COPY PCWS188.                                                01190000
016000/                                                                 01200000
016100* TRAILER AUDIT LAYOUT                                            01201020
016200     COPY PCWS045.                                                01202020
016300/                                                                 01203020
016400     COPY DPWS010I.                                               01210000
016500*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   01220000
016600     COPY DPWS015.                                                01230000
016700                                                                  01240000
016800*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      01250000
016900     COPY DFHAID.                                                 01260000
017000                                                                  01270000
017100*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01280000
017200     COPY DPWS013.                                                01290000
017300/                                                                 01300000
017400*    DC DOOR MASTER                                               01310000
017500     EXEC SQL                                                     01320000
017600         INCLUDE TCNDCDR                                          01330000
017700     END-EXEC.                                                    01340000
017800                                                                  01350000
017900*    DC DOOR TYPES                                                01360000
018000     EXEC SQL                                                     01370000
018100         INCLUDE TCNDRTY                                          01380000
018200     END-EXEC.                                                    01390000
018300                                                                  01400000
018400*    DC DOOR/STORE CONNECTION                                     01410000
018500     EXEC SQL                                                     01420000
018600         INCLUDE TCNDRST                                          01430000
018700     END-EXEC.                                                    01440000
018800                                                                  01450000
018900*    TRAILER ID MASTER                                            01460000
019000     EXEC SQL                                                     01470000
019100         INCLUDE TCNTRID                                          01480000
019200     END-EXEC.                                                    01490000
019300                                                                  01500000
019400*    OUTBOUND TRAILER TRIP                                        01510000
019500     EXEC SQL                                                     01520000
019600         INCLUDE TSUOBTR                                          01530000
019700     END-EXEC.                                                    01540000
019800                                                                  01550000
019900*    OUTBOUND TRAILER TRIP STATUS                                 01560000
020000     EXEC SQL                                                     01570000
020100         INCLUDE TSUOBTS                                          01580000
020200     END-EXEC.                                                    01590000
020300                                                                  01600000
020400*    CARTON DIVERT / OUTBOUND TRAILER TRIP ASSOCIATION            01610000
020500     EXEC SQL                                                     01620000
020600         INCLUDE TSUCDOT                                          01630000
020700     END-EXEC.                                                    01640000
020800                                                                  01650000
020900*    CARTON DIVERTER                                              01660000
021000     EXEC SQL                                                     01670000
021100         INCLUDE TSUCRDV                                          01680000
021200     END-EXEC.                                                    01690000
021300                                                                  01700000
021400*    STATUS ASSOCIATIONS                                          01710000
021500     EXEC SQL                                                     01720000
021600         INCLUDE SUT00005                                         01730000
021700     END-EXEC.                                                    01740000
021800                                                                  01750000
021900*    STATUS ASSOCIATION DESCRIPTIONS                              01760000
022000     EXEC SQL                                                     01770000
022100         INCLUDE TSUOBSC                                          01780000
022200     END-EXEC.                                                    01790000
022300                                                                  01790115
022400     EXEC SQL                                                     01791015
022500         INCLUDE SUT00027                                         01792028
022600     END-EXEC.                                                    01793015
022700/                                                                 01800000
022800                                                                  01810000
022900     EXEC SQL                                                     01820000
023000         INCLUDE SQLCA                                            01830000
023100     END-EXEC.                                                    01840000
023200                                                                  01850000
023300 LINKAGE SECTION.                                                 01860000
023400 01  DFHCOMMAREA.                                                 01870000
023500     05  FILLER                         OCCURS  1 TO 4072 TIMES   01880000
023600                                      DEPENDING ON EIBCALEN.      01890000
023700         10  FILLER                   PIC X.                      01900000
023800/                                                                 01910000
023900 PROCEDURE DIVISION.                                              01920000
024000 0000-PROGRAM-MAINLINE.                                           01930000
024100                                                                  01940000
024200     INITIALIZE CA-COMMAREA                                       01950000
024300     MOVE DFHCOMMAREA                 TO CA-COMMAREA              01960000
024400                                                                  01970000
024500     EVALUATE TRUE                                                01980000
024600         WHEN EIBCALEN = ZERO                                     01990000
024700             MOVE PC-ENTER-THROUGH-MENU-MSG                       02000000
024800                                      TO PV-MESSAGE-AREA          02010000
024900             PERFORM 8110-RETURN                                  02020000
025000                                                                  02030000
025100         WHEN EIBTRNID = 'Z278'                                   02040000
025200*            RETURNING FROM F1 HELP INFO SCREEN                   02050000
025300             MOVE DFHCOMMAREA         TO PC192-COMMAREA           02060000
025400             MOVE PC192-HOST-SAVE-AREA                            02070000
025500                                      TO CA-COMMAREA              02080000
025600             SET PC233-PROCESS-SCREEN TO TRUE                     02090000
025700             MOVE PC192-HOST-SAVE-MAP TO PC876AO                  02100000
025800             MOVE -1                  TO ADOORL                   02110000
025900             PERFORM 8000-SEND-MAP                                02120000
026000             PERFORM 8100-RETURN-TRANID                           02130000
026100                                                                  02270000
026200         WHEN EIBTRNID = 'E893'                                   02271020
026300*            COMING FROM TRAILER AUDIT CLOSE SCREEN               02272020
026400             INITIALIZE PC045-COMMAREA-REC                        02272121
026500             MOVE PC233-HOST-SAVE-AREA  TO PC045-COMMAREA-REC     02272320
026600             SET PC233-PROCESS-SCREEN TO TRUE                     02276020
026700             MOVE PC045-OPER-UNT-ID      TO PC233-OPER-UNT-ID     02277023
026800             MOVE PC045-DOOR-ID          TO CA-CURR-DOOR          02277123
026900                                            ADOORO                02277223
027000             MOVE PC045-DEST-OPER-UNT-ID TO CA-CURR-DEST          02277323
027100                                            ADESTO                02277423
027200             MOVE PC045-TRLR-SRL-NBR     TO CA-CURR-SERIAL-NBR    02277523
027300                                            ASERIALO              02277623
027400             MOVE PC045-OTBND-TRIP-ID    TO ATRIPO                02277725
027500             MOVE -1                  TO ADOORL                   02278020
027600             MOVE DP015-ASK-NOR-MDT TO ADOORA                     02278124
027700                                       ADESTA                     02278224
027800                                       ASERIALA                   02278324
027900                                       ATRIPA                     02278425
028000             PERFORM 8000-SEND-MAP                                02279020
028100             PERFORM 8100-RETURN-TRANID                           02279120
028200                                                                  02279220
028300         WHEN PC233-INITIALIZE-SCREEN                             02280000
028400         WHEN EIBAID = DFHCLEAR                                   02290000
028500             SET PC233-PROCESS-SCREEN TO TRUE                     02300000
028600             PERFORM 1000-INITIALIZE                              02310000
028700             PERFORM 8000-SEND-MAP                                02320000
028800             PERFORM 8100-RETURN-TRANID                           02330000
028900                                                                  02340000
029000*** THIS OCCURS WHEN THERE WAS NO BEGINNING DIVERT TIMESTAMP,     02340114
029100*** AND THE USER HAS CONFIRMED THAT THE PROCESS SHOULD CONTINUE   02340214
029200*** IN THE ERROR MESSAGE PROGRAM (PCKRF871)                       02340314
029300         WHEN PC233-UPDATE-CONFIRMED                              02341013
029400              MOVE 'PCKRF877'  TO PV-TRANSFER-PROGRAM             02347016
029500              PERFORM 8200-XCTL                                   02348016
029600                                                                  02349016
029700         WHEN EIBAID = DFHPF3                                     02350000
029800             MOVE PC233-MENU-PROGRAM  TO PV-TRANSFER-PROGRAM      02360000
029900             PERFORM 8200-XCTL                                    02370000
030000                                                                  02380000
030100         WHEN EIBAID = DFHPF4                                     02390000
030200*            UPDATE DATABASE                                      02400000
030300             PERFORM 8020-RECEIVE-MAP                             02410000
030400             PERFORM 2100-EDIT-INPUT                              02420000
030500                                                                  02430000
030600             IF PS-ERRORS-NO                                      02440000
030700* DMH            PERFORM 8300-START-SUKCS574                      02441011
030800                 EVALUATE TRUE                                    02450000
030900                 WHEN PS-XCTL-E873                                02461000
031000                     MOVE 'PCKRF873'  TO PV-TRANSFER-PROGRAM      02470000
031100                     MOVE 'PCKRF877'  TO PC233-NEXT-PROGRAM       02480000
031200                     PERFORM 8200-XCTL                            02490000
031300                 WHEN PS-XCTL-E877                                02500000
031400                     MOVE 'PCKRF877'  TO PV-TRANSFER-PROGRAM      02510000
031500                     PERFORM 8200-XCTL                            02520000
031600                 END-EVALUATE                                     02530000
031700             ELSE                                                 02540000
031800                 IF PS-XCTL-E871                                  02550000
031900                     PERFORM 8210-XCTL-ERROR-SCREEN               02560000
032000                 ELSE                                             02570000
032100                     PERFORM 8010-SEND-DATA-ONLY                  02580000
032200                     PERFORM 8100-RETURN-TRANID                   02590000
032300                 END-IF                                           02600000
032400             END-IF                                               02610000
032500                                                                  02620000
032600         WHEN EIBAID = DFHPF8                                     02620110
032700             MOVE 'PCKRF880'          TO PV-TRANSFER-PROGRAM      02620210
032800             PERFORM 8200-XCTL                                    02620310
032900                                                                  02620410
033000         WHEN EIBAID = DFHPF9                                     02621000
033100             MOVE 'PCKRF743'          TO PV-TRANSFER-PROGRAM      02622000
033200             PERFORM 8200-XCTL                                    02623000
033300                                                                  02624000
033400         WHEN EIBAID = DFHENTER                                   02630000
033500*            EDIT ONLY                                            02640000
033600             PERFORM 8020-RECEIVE-MAP                             02650000
033700             PERFORM 2100-EDIT-INPUT                              02660000
033800                                                                  02670000
033900             IF PS-ERRORS-YES                                     02680000
034000                 IF PS-XCTL-E871                                  02690000
034100                     PERFORM 8210-XCTL-ERROR-SCREEN               02700000
034200                 ELSE                                             02710000
034300                     PERFORM 8010-SEND-DATA-ONLY                  02720000
034400                     PERFORM 8100-RETURN-TRANID                   02730000
034500                 END-IF                                           02740000
034600             ELSE                                                 02750000
034700                 PERFORM 8010-SEND-DATA-ONLY                      02760000
034800                 PERFORM 8100-RETURN-TRANID                       02770000
034900             END-IF                                               02780000
035000                                                                  02790000
035100         WHEN EIBAID = DFHPF1                                     02800000
035200             PERFORM 8020-RECEIVE-MAP                             02810000
035300             MOVE PC876AO             TO PC192-HOST-SAVE-MAP      02820000
035400             PERFORM 1200-HELP-SCREEN                             02830000
035500                                                                  02840000
035600         WHEN OTHER                                               02850000
035700             PERFORM 8020-RECEIVE-MAP                             02860000
035800             MOVE -1                  TO ADOORL                   02870000
035900             MOVE PC-UNRECOGNIZED-PF-KEY-MSG                      02880000
036000                                      TO AMSGLNO                  02890000
036100             PERFORM 8000-SEND-MAP                                02900000
036200             PERFORM 8100-RETURN-TRANID                           02910000
036300     END-EVALUATE.                                                02920000
036400                                                                  02930000
036500     GOBACK.                                                      02940000
036600                                                                  02950000
036700 1000-INITIALIZE.                                                 02960000
036800                                                                  02970000
036900     MOVE SPACES                      TO AMSGLNO                  02980000
037000     MOVE -1                          TO ADOORL                   02990000
037100                                                                  03000000
037200     INITIALIZE CA-REDEFINED-COMMAREA                             03010000
037300                PC233-DOOR-ID                                     03020000
037400                PC233-TRIP-ID                                     03030000
037500                PC233-SERIAL-NBR                                  03040000
037600                PC233-STR-NBR                                     03050000
037700                PC233-OWNER-SCAC-ID                               03060000
037800                PC233-CARTON                                      03070000
037900                PC233-TRAILER                                     03080000
038000                PC233-ERROR-FIELDS                                03090000
038100                PC233-ERROR-FIELDS                                03091018
038200                PC233-TRLR-SEALED-SW                              03092018
038300                                                                  03100000
038400     SET PC233-CLOSE-TRLR             TO TRUE                     03110000
038500     MOVE PC-TRANID                   TO PC233-TRAN-ID            03120000
038600                                                                  03130000
038700     MOVE PC233-USER-ID               TO PV-USER-ID.              03140000
038800                                                                  03150000
038900 1200-HELP-SCREEN.                                                03160000
039000     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      03170000
039100     MOVE PC-CURRENT-PROGRAM-NAME     TO PC192-PROGRAM-NAME       03180000
039200     COPY PCPD188.                                                03190000
039300     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      03200000
039400     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     03210000
039500     PERFORM 8220-XCTL-TO-HELP.                                   03220000
039600                                                                  03230000
039700/                                                                 03240000
039800 2100-EDIT-INPUT.                                                 03250000
039900                                                                  03260000
040000     SET PS-ERRORS-NO                 TO TRUE                     03270000
040100     MOVE SPACES                      TO AMSGLNO                  03280000
040200                                                                  03290000
040300     IF ADOORA = DP015-ERASE-EOF                                  03300000
040400         MOVE SPACES                  TO PV-SCREEN-DOOR           03310000
040500     ELSE                                                         03320000
040600         MOVE ADOORI                  TO PV-SCREEN-DOOR           03330000
040700     END-IF                                                       03340000
040800                                                                  03350000
040900     IF ADESTA = DP015-ERASE-EOF                                  03360000
041000         MOVE ZEROES                  TO PV-SCREEN-DEST           03370000
041100     ELSE                                                         03380000
041200         MOVE ADESTI                  TO PV-SCREEN-DEST           03390000
041300     END-IF                                                       03400000
041400                                                                  03410000
041500     IF ASERIALA = DP015-ERASE-EOF                                03420000
041600         MOVE ZEROES                  TO PV-SCREEN-SERIAL-NBR     03430000
041700     ELSE                                                         03440000
041800         MOVE ASERIALI                TO PV-SCREEN-SERIAL-NBR     03450000
041900     END-IF                                                       03460000
042000                                                                  03470000
042100     PERFORM 2110-PRE-EDITS                                       03480000
042200*    (VALIDATE NUMERIC FIELDS AND LOAD CA-CURR FIELDS)            03490000
042300                                                                  03500000
042400     IF PS-ERRORS-NO                                              03510000
042500         IF CA-CURR-SERIAL-NBR > ZERO                             03520000
042600             PERFORM 2120-EDIT-SERIAL-NBR                         03530000
042700         ELSE                                                     03540000
042800             SET PS-SERIAL-NO         TO TRUE                     03550000
042900         END-IF                                                   03560000
043000                                                                  03570000
043100         IF CA-CURR-DOOR > SPACES                                 03580000
043200             MOVE CA-CURR-DOOR        TO PC233-DOOR-ID            03590000
043300             PERFORM 2130-EDIT-DOOR                               03600000
043400         END-IF                                                   03610000
043500     END-IF.                                                      03620000
043600                                                                  03630000
043700* POPULATE DOOR AND STORE DEPENDING ON WHAT WAS SCANNED           03640000
043800                                                                  03650000
043900     IF PS-ERRORS-NO                                              03660000
044000                                                                  03670000
044100     EVALUATE TRUE                                                03680000
044200         WHEN CA-CURR-DEST > ZERO AND CA-CURR-DOOR > SPACES       03690000
044300*            (BOTH WERE ENTERED)                                  03700000
044400             CONTINUE                                             03710000
044500                                                                  03720000
044600         WHEN CA-CURR-DOOR > SPACES                               03730000
044700*            (ENTERED DOOR BUT NOT DEST)                          03740000
044800                                                                  03750000
044900             PERFORM 7060-SELECT-TCNDRST                          03760000
045000*              IS THERE ONLY ONE STORE FOR THIS DOOR?             03770000
045100                                                                  03780000
045200             IF SQLCODE = ZERO                                    03790000
045300*              YES THERE IS ONLY ONE STORE FOR THIS DOOR          03800000
045400                 MOVE CNDRST-STR-NBR  TO ADESTO                   03810000
045500                                         PC233-STR-NBR            03820000
045600                 MOVE DP015-ASK-NOR-MDT                           03830000
045700                                      TO ADESTA                   03840000
045800                                                                  03850000
045900                 PERFORM 7070-CHECK-OPEN-TRAILERS                 03860000
046000*              IS THERE AN OPEN TRAILER ASSIGNED TO THIS DOOR?    03870000
046100                                                                  03880000
046200                 IF SQLCODE = ZERO                                03890000
046300*              YES THERE IS AN OPEN TRAILER ASSIGNED TO THIS DOOR 03900000
046400                                                                  03910000
046500                     MOVE SUOBTR-TRLR-SRL-NBR                     03920000
046600                                      TO ASERIALO                 03930000
046700                                         PC233-SERIAL-NBR         03940000
046710                     MOVE SUOBTR-DOOR-TYP-CDE                             
046720                                      TO PC233-DOOR-TYPE-CDE      03940000
046800                     PERFORM 7000-SELECT-TCNTRID                  03950000
046900                     IF PS-TCNTRID-YES                            03960000
047000                         MOVE CNTRID-SCAC-CDE                     03970000
047100                                      TO ASCACO                   03980000
047200                                         PC233-OWNER-SCAC-ID      03990000
047300                         MOVE CNTRID-TRLR-ID                      04000000
047400                                      TO ATRLRO                   04010000
047500                                         PC233-TRAILER            04020000
047600                     END-IF                                       04030000
047700                                                                  04040000
047800*                ELSE                                             04050000
047900*                    SET PS-ERRORS-YES                            04060000
048000*                                     TO TRUE                     04070000
048100*                    MOVE -1          TO ADESTL                   04080000
048200*                    MOVE '   DEST REQUIRED   '                   04090000
048300*                                     TO AMSGLNO                  04100000
048400                 END-IF                                           04110000
048500             END-IF                                               04120000
048600                                                                  04130000
048700         WHEN CA-CURR-DEST > ZERO                                 04140000
048800*            (ENTERED DEST BUT NOT DOOR)                          04150000
048900                                                                  04160000
049000             PERFORM 7080-SELECT-TCNDRST                          04170000
049100*            IS STORE ALSO AT ANOTHER DOOR?                       04180000
049200                                                                  04190000
049300             IF SQLCODE = ZERO                                    04200000
049400                 MOVE CNDRST-DOOR-ID  TO PC233-DOOR-ID            04210000
049500                                         ADOORO                   04220000
049510                 MOVE CNDCDR-DOOR-TYP-CDE                                 
049520                                      TO PC233-DOOR-TYPE-CDE              
049600*            THE STORE IS ASSIGNED TO ONLY ONE DOOR               04230000
049700                                                                  04240000
049800                 PERFORM 7090-SELECT-TCNDRST                      04250000
049900*            IS THERE ONLY ONE TRAILER ASSIGNED TO THIS STORE?    04260000
050000                                                                  04270000
050100                 EVALUATE SQLCODE                                 04280000
050200                                                                  04290000
050300                 WHEN ZERO                                        04300000
050400*                 THERE IS ONLY ONE TRAILER ASSIGNED TO THIS STORE04310000
050500                     MOVE SUOBTR-TRLR-SRL-NBR                     04320000
050600                                      TO ASERIALO                 04330000
050700                                         PC233-SERIAL-NBR         04340000
050800                     MOVE SUOBTR-OTBND-TRIP-ID                    04350000
050900                                      TO ATRIPO                   04360000
051000                                         PC233-TRIP-ID            04370000
051010                     MOVE SUOBTR-DOOR-TYP-CDE                     04350000
051020                                      TO PC233-DOOR-TYPE-CDE      04360000
051100                     PERFORM 7000-SELECT-TCNTRID                  04380000
051200                     IF PS-TCNTRID-YES                            04390000
051300                         MOVE CNTRID-SCAC-CDE                     04400000
051400                                      TO ASCACO                   04410000
051500                                         PC233-OWNER-SCAC-ID      04420000
051600                         MOVE CNTRID-TRLR-ID                      04430000
051700                                      TO ATRLRO                   04440000
051800                                         PC233-TRAILER            04450000
051900                     END-IF                                       04460000
052000                                                                  04470000
052100                 WHEN -811                                        04480000
052200*               THERE ARE MULTIPLE TRAILERS ASSIGNED TO THIS STORE04490000
052300                         MOVE SUOBTS-DOOR-ID                      04500000
052400                                      TO ADOORO                   04510000
052500                                         PC233-DOOR-ID            04520000
052600                 WHEN OTHER                                       04530000
052700*                UNABLE TO PRE-LOAD DOOR.  USER MUST ENTER VALUE  04540000
052800                     SET PS-ERRORS-YES                            04550000
052900                                      TO TRUE                     04560000
053000*                    MOVE -1          TO ADOORL                   04570000
053100*                    MOVE '   DOOR REQUIRED   '                   04580000
053200*                                     TO AMSGLNO                  04590000
053300                 END-EVALUATE                                     04600000
053400             END-IF                                               04610000
053500         WHEN OTHER                                               04620000
053600*            (NEITHER DEST NOR DOOR WAS ENTERED)                  04630000
053700             IF PC233-SERIAL-NBR > ZERO                           04640000
053800                 PERFORM 7100-GET-STR-DOOR-FROM-TRAILER           04650000
053900                 IF SQLCODE = ZERO                                04660000
054000                     MOVE SUOBTS-DOOR-ID                          04670000
054100                                      TO ADOORO                   04680000
054200                                         PC233-DOOR-ID            04690000
054300                     MOVE SUOBTR-DEST-OPER-UNT-ID                 04700000
054400                                      TO ADESTO                   04710000
054500                                         PC233-STR-NBR            04720000
054600                 END-IF                                           04730000
054700             ELSE                                                 04740000
054800                 SET PS-ERRORS-YES                                04750000
054900                                      TO TRUE                     04760000
055000                 MOVE -1              TO ADOORL                   04770000
055100                 MOVE 'DOOR/DEST REQUIRED '                       04780000
055200                                      TO AMSGLNO                  04790000
055300             END-IF                                               04800000
055400         END-EVALUATE                                             04810000
055500                                                                  04820000
055600     END-IF.                                                      04830000
055700                                                                  04840000
055800     IF PS-ERRORS-NO                                              04850000
055900         IF PC233-DOOR-ID > SPACES AND PC233-STR-NBR > ZERO       04860000
056000                  AND PC233-SERIAL-NBR > ZERO                     04870000
056100             CONTINUE                                             04880000
056200         ELSE                                                     04890000
056300             SET PS-ERRORS-YES        TO TRUE                     04900000
056400             IF PC233-SERIAL-NBR = ZERO                           04910000
056500                 MOVE -1              TO ASERIALL                 04920000
056600                 MOVE '  SER NBR REQUIRED '                       04930000
056700                                      TO AMSGLNO                  04940000
056800             END-IF                                               04950000
056900             IF PC233-STR-NBR = ZERO                              04960000
057000                         MOVE -1      TO ADESTL                   04970000
057100                         MOVE '   DEST REQUIRED   '               04980000
057200                                      TO AMSGLNO                  04990000
057300             END-IF                                               05000000
057400             IF PC233-DOOR-ID = SPACES                            05010000
057500                 MOVE -1              TO ADOORL                   05020000
057600                 MOVE '   DOOR REQUIRED   '                       05030000
057700                                      TO AMSGLNO                  05040000
057800             END-IF                                               05050000
057900         END-IF                                                   05060000
058000     END-IF                                                       05070000
058100                                                                  05080000
058200     IF PS-ERRORS-NO                                              05090000
058300         PERFORM 2200-CONSISTENCY-EDITS                           05100000
058400     END-IF.                                                      05110000
058500                                                                          
058600     IF PC233-TRIP-ID = ZERO                                              
058700         PERFORM 8212-MSG-48                                      16710003
058800     END-IF.                                                              
058900                                                                  05120000
059000 2110-PRE-EDITS.                                                  05130000
059100     MOVE PV-SCREEN-SERIAL-NBR        TO DP010I-UNEDITED-FIELD    05140000
059200     MOVE LENGTH OF PV-SCREEN-SERIAL-NBR                          05150000
059300                                      TO DP010I-MAXIMUM-DIGITS    05160000
059400     MOVE ZERO                        TO DP010I-MAXIMUM-DECIMALS  05170000
059500     SET DP010I-NEGATIVE-NOT-ALLOWED  TO TRUE                     05180000
059610     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
059620                         USING DP010I-NUMERIC-EDIT-AREA                   
059700     IF DP010I-ERROR-DETECTED                                     05200000
059800         SET PS-ERRORS-YES            TO TRUE                     05210000
059900         MOVE -1                      TO ASERIALL                 05220000
060000                                                                  05230000
060100         MOVE 'SER NBR NOT NUMERIC '                              05240000
060200                                      TO AMSGLNO                  05250000
060300     ELSE                                                         05260000
060400         MOVE DP010I-NUMERIC-FIELD    TO CA-CURR-SERIAL-NBR       05270000
060500                                         PC233-SERIAL-NBR         05280000
060600     END-IF.                                                      05290000
060700                                                                  05300000
060800     MOVE PV-SCREEN-DEST              TO DP010I-UNEDITED-FIELD    05310000
060900     MOVE LENGTH OF PV-SCREEN-DEST    TO DP010I-MAXIMUM-DIGITS    05320000
061000     MOVE ZERO                        TO DP010I-MAXIMUM-DECIMALS  05330000
061100     SET DP010I-NEGATIVE-NOT-ALLOWED  TO TRUE                     05340000
061210     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
061220                         USING DP010I-NUMERIC-EDIT-AREA                   
061300     IF DP010I-ERROR-DETECTED                                     05360000
061400         SET PS-ERRORS-YES            TO TRUE                     05370000
061500         MOVE -1                      TO ADESTL                   05380000
061600                                                                  05390000
061700         MOVE ' DEST NOT NUMERIC  '   TO AMSGLNO                  05400000
061800     ELSE                                                         05410000
061900         MOVE DP010I-NUMERIC-FIELD    TO CA-CURR-DEST             05420000
062000                                         PC233-STR-NBR            05430000
062100     END-IF.                                                      05440000
062200                                                                  05450000
062300     MOVE PV-SCREEN-DOOR              TO CA-CURR-DOOR.            05460000
062400/                                                                 05470000
062500* THE FOLLOWING EDITS CHECK THE VALIDITY OF ENTITIES IN           05480000
062600* THEMSELVES NOT HOW THEY MIGHT RELATE TO OTHER FIELDS ON         05490000
062700* THE SCREEN.                                                     05500000
062800                                                                  05510000
062900 2120-EDIT-SERIAL-NBR.                                            05520000
063000* IS THIS SERIAL NBR CONNECTED TO A SCAC/TRAILER AT ALL?          05530000
063100     PERFORM 7000-SELECT-TCNTRID                                  05540000
063200     IF PS-TCNTRID-NO                                             05550000
063300         SET PS-SERIAL-NO             TO TRUE                     05560000
063400         MOVE -1                      TO ASERIALL                 05570000
063500                                                                  05580000
063600         MOVE ' TRAILER NOT FOUND '   TO AMSGLNO                  05590000
063700     ELSE                                                         05600000
063800         SET PS-SERIAL-YES            TO TRUE                     05610000
063900         MOVE CNTRID-SCAC-CDE         TO ASCACO                   05620000
064000                                         PC233-OWNER-SCAC-ID      05630000
064100         MOVE CNTRID-TRLR-ID          TO ATRLRO                   05640000
064200                                         PC233-TRAILER            05650000
064300     END-IF.                                                      05660000
064400                                                                  05670000
064500 2130-EDIT-DOOR.                                                  05680000
064600* IS THIS A SHIPPING OR SHUTTLE DOOR IN THE CURRENT LOCATION?     05690000
064700     PERFORM 7010-SELECT-TCNDCDR                                  05700000
064800                                                                  05710000
064810     MOVE  CNDCDR-DOOR-TYP-CDE  TO  PC233-DOOR-TYPE-CDE           05710000
064820                                                                  05710000
064900     IF PS-TCNDCDR-YES                                            05720000
065000         IF CA-CURR-DEST = ZERO                                   05721012
065100             PERFORM 7011-SELECT-TCNDRST                          05722013
065200         END-IF                                                   05723013
065300                                                                  05730000
065400         IF CNDCDR-DIVERT-NBR > ZERO AND                          05740000
065500                 CNDCDR-DIVERT-LOC-ID > SPACES                    05750000
065600             MOVE CNDCDR-DIVERT-NBR   TO PC233-DIVERT-NBR         05760000
065700             MOVE CNDCDR-DIVERT-LOC-ID                            05770000
065800                                      TO PC233-DIVERT-LOC-ID      05780000
065900             SET PS-DIVERT-DOOR-YES                               05790000
066000                 PS-XCTL-E873         TO TRUE                     05800000
066100         ELSE                                                     05810000
066200             SET PS-DIVERT-DOOR-NO                                05820000
066300                 PS-XCTL-E877         TO TRUE                     05830000
066400         END-IF                                                   05840000
066500                                                                  05850000
066600         IF PS-ERRORS-NO                                          05860000
066700             IF CNDCDR-DOOR-TYP-CDE = 'SH' OR 'DS'                05870000
066800                 SET PS-DO-DOOR-DEST-EDITS                        05880000
066900                                      TO TRUE                     05890000
067000             ELSE                                                 05900000
067100                 IF CNDCDR-DIVERT-NBR = ZERO                      05910000
067200                     SET PS-SKIP-DOOR-DEST-EDITS                  05920000
067300                                      TO TRUE                     05930000
067400                 ELSE                                             05940000
067500                     SET PS-DO-DOOR-DEST-EDITS                    05950000
067600                                      TO TRUE                     05960000
067700                 END-IF                                           05970000
067800             END-IF                                               05980000
067900         END-IF                                                   05990000
068000     ELSE                                                         06000000
068100         SET PS-ERRORS-YES            TO TRUE                     06010000
068200         MOVE -1                      TO ADOORL                   06020000
068300         MOVE ' DOOR NOT DEFINED  '   TO AMSGLNO                  06030000
068400     END-IF.                                                      06040000
068500                                                                  06050000
068600 2200-CONSISTENCY-EDITS.                                          06060000
068700*  CHECK THE RELATIONSHIPS BETWEEN THE FIELDS.                    06070000
068800                                                                  06080000
068900     PERFORM 2205-GET-TRAILER-INFO.                               06090000
069000                                                                  06100000
069100     IF PS-ERRORS-NO                                              06110000
069200         PERFORM 2210-TRLR-AT-ANOTHER-DOOR                        06120000
069300     END-IF                                                       06130000
069400                                                                  06140000
069500     IF PS-ERRORS-NO                                              06150000
069600         PERFORM 2220-DIFF-TRLR-AT-THIS-DOOR                      06160000
069700     END-IF                                                       06170000
069800                                                                  06180000
069900     IF PS-ERRORS-NO AND PS-ACTIVE-TRIP-EXISTS                    06190000
070000         PERFORM 2235-VALIDATE-INTENDED-ACTION                    06200000
070100     END-IF                                                       06210000
070200                                                                  06220000
070300*  THIS MIGHT HAVE THE SAME RESULT AS PARA 2235-                  06230000
070400     IF PS-ERRORS-NO AND PS-ACTIVE-TRIP-EXISTS                    06240000
070500         PERFORM 2240-IS-TRAILER-CLOSED                           06250000
070600     END-IF.                                                      06260000
070700                                                                  06270000
070800     IF PS-ERRORS-NO AND PS-ACTIVE-TRIP-EXISTS                    06280013
070900                     AND PS-DIVERT-DOOR-YES                       06290013
071000         PERFORM 2245-FIND-TRIP-DIVERT-STARTPT                    06300013
071100     END-IF.                                                      06310013
071200                                                                  06320000
071300     IF PS-ERRORS-NO AND PS-ACTIVE-TRIP-EXISTS                    06330000
071400                     AND PS-DIVERT-DOOR-YES                       06340000
071500         PERFORM 2250-FIND-TRIP-DIVERT-ENDPT                      06350000
071600     END-IF.                                                      06360000
071700                                                                  06370000
071800 2205-GET-TRAILER-INFO.                                           06380000
071900     PERFORM 7050-SELECT-TRAILER-STATUS.                          06390000
072000     MOVE CNTRID-SCAC-CDE             TO PC233-OWNER-SCAC-ID      06400000
072100                                         PC233-ERROR-SCAC-ID      06410000
072200     MOVE CNTRID-TRLR-ID              TO PC233-ERROR-TRLR-ID.     06420000
072300                                                                  06430000
072400 2210-TRLR-AT-ANOTHER-DOOR.                                       06440000
072500     PERFORM 7020-FIND-OTHER-DOOR.                                06450000
072600                                                                  06460000
072700 2220-DIFF-TRLR-AT-THIS-DOOR.                                     06470000
072800     PERFORM 7030-FIND-OTHER-TRLR.                                06480000
072900                                                                  06490000
073000/                                                                 06500000
073100 2235-VALIDATE-INTENDED-ACTION.                                   06510000
073200     PERFORM 7110-CHECK-STATUS-CODES.                             06520000
073300     IF SQLCODE = +100                                            06530000
073400         SET PS-ERRORS-YES                                        06540000
073500             PS-XCTL-E871             TO TRUE                     06550003
073600         MOVE 37                      TO PC233-PGM-MSG-NBR        06550103
073700         MOVE -1                      TO ADOORL                   06550200
073800         PERFORM 7111-SELECT-TSUOBSC                              06560000
073900         STRING                                                   06570000
074000             'STATUS: '                                           06580000
074100             SUOBSC-STAT-SHRT-DESC                                06590000
074200             DELIMITED BY SIZE      INTO PC233-RETURN-MSG         06600000
074300*        STRING                                                   06600103
074400*            'STATUS: '                                           06600200
074500*            SUOBSC-STAT-SHRT-DESC                                06600300
074600*            DELIMITED BY SIZE      INTO AMSGLNO                  06600400
074700     END-IF.                                                      06610000
074800/                                                                 06620000
074900 2240-IS-TRAILER-CLOSED.                                          06630000
075000                                                                  06640000
075100* SWITCH IS SET IN PARA 2205-GET-TRAILER-INFO                     06650000
075200     IF PS-ACTIVE-TRIP-EXISTS                                     06660000
075300         EVALUATE TRUE                                            06670000
075400         WHEN SUOBTS-TRIP-STAT-CDE = 'DC'                         06680000
075500             SET PS-ERRORS-YES                                    06690000
075600                 PS-XCTL-E871         TO TRUE                     06700003
075700             MOVE 37                  TO PC233-PGM-MSG-NBR        06700103
075800             MOVE -1                  TO ADOORL                   06700200
075900                                                                  06710000
076000             MOVE SUOBTS-OTBND-TRIP-ID                            06720000
076100                                      TO ATRIPO                   06730000
076200                                         PC233-TRIP-ID            06740000
076300                                         PC233-ERROR-TRIP-ID      06750000
076400             MOVE 'TRLR ALREADY CLOSED'                           06760000
076500                                      TO PC233-RETURN-MSG         06770000
076600*                                     TO AMSGLNO                  06771003
076700         WHEN SUOBTS-TRIP-STAT-CDE = 'DO'                         06780000
076800             MOVE SUOBTS-OTBND-TRIP-ID                            06790000
076900                                      TO ATRIPO                   06800000
077000                                         PC233-TRIP-ID            06810000
077100                                         PC233-ERROR-TRIP-ID      06820000
077200         END-EVALUATE                                             06830000
077300     END-IF.                                                      06840000
077400                                                                  06850000
077500 2245-FIND-TRIP-DIVERT-STARTPT.                                   06860013
077600                                                                  06870013
077700     PERFORM 7120-SELECT-TSUCDOT                                  06880013
077800     IF SQLCODE = +100                                            06890013
077900         PERFORM 7130-SELECT-CART-LOC                             06900026
078000         IF SQLCODE = +100                                        06901013
078100             SET PS-ERRORS-YES                                    06940013
078200                 PS-XCTL-E871     TO TRUE                         06950013
078300             MOVE 41              TO PC233-PGM-MSG-NBR            06960013
078400         ELSE                                                     06980013
078500             SET PS-ERRORS-YES                                    06981013
078600                 PS-XCTL-E871     TO TRUE                         06982013
078700             MOVE 40              TO PC233-PGM-MSG-NBR            06983013
078800         END-IF                                                   06990013
078900     END-IF.                                                      07000013
079000                                                                  07010000
079100 2250-FIND-TRIP-DIVERT-ENDPT.                                     07020000
079200                                                                  07030000
079300     PERFORM 7125-SELECT-TSUCDOT.                                 07040000
079400     IF SQLCODE = ZERO                                            07050000
079500*        NEEDS AN ENDING CONVEYOR CUTOFF                          07060000
079600         SET PS-XCTL-E873             TO TRUE                     07070000
079700     ELSE                                                         07080000
079800*        HAS AN ENDING CONVEYOR CUTOFF                            07090000
079900         SET PS-XCTL-E877             TO TRUE                     07100000
080000     END-IF.                                                      07110000
080100/                                                                 07120000
080200 7000-SELECT-TCNTRID.                                             07130000
080300                                                                  07140000
080400     EXEC SQL                                                     07150000
080500         SELECT                                                   07160000
080600             TRID.SCAC_CDE                                        07170000
080700         ,   TRID.TRLR_ID                                         07180000
080800         INTO                                                     07190000
080900           :CNTRID-SCAC-CDE                                       07200000
081000         , :CNTRID-TRLR-ID                                        07210000
081100         FROM                                                     07220000
081200            TCNTRID TRID                                          07230000
081300         WHERE TRID.TRLR_SRL_NBR     = :PC233-SERIAL-NBR          07240000
081400     END-EXEC.                                                    07250000
081500                                                                  07260000
081600     EVALUATE TRUE                                                07270000
081700         WHEN SQLCODE = ZERO                                      07280000
081800         WHEN SQLCODE = -811                                      07290000
081900             SET PS-TCNTRID-YES       TO TRUE                     07300000
082000         WHEN SQLCODE = +100                                      07310000
082100             SET PS-TCNTRID-NO        TO TRUE                     07320000
082200         WHEN SQLCODE = -904                                      07330000
082300         WHEN SQLCODE = -913                                      07340000
082400         WHEN SQLCODE = -911                                      07350000
082500             MOVE 1                   TO PV-ERROR-NBR             07360000
082600             PERFORM 9903-WRITE-CICS-LOG                          07370000
082700             PERFORM 9000-SOFT-ABORT                              07380000
082800         WHEN SQLWARN0 NOT = SPACES                               07390000
082900         WHEN SQLCODE NOT EQUAL ZERO                              07400000
083000             MOVE 2                   TO PV-ERROR-NBR             07410000
083100                                         PC233-ERROR-NBR          07420000
083200             PERFORM 9903-WRITE-CICS-LOG                          07430000
083300             MOVE '7000-SELECT-TCNTRID'                           07440000
083400                                      TO PC233-PARAGRAPH          07450000
083500             MOVE 'PCKRF876 - CHECK TRAILER EXISTENCE'            07460000
083600                                      TO PC233-MESSAGE-TEXT(1)    07470000
083700             MOVE SQLCA               TO PC233-SQLCA              07480000
083800             MOVE 'TCNTRID'           TO PC233-DB2-TABLE-NAME(1)  07490000
083900             SET PC233-ABEND          TO TRUE                     07500000
084000             MOVE 99                  TO PC233-PGM-MSG-NBR        07510000
084100             PERFORM 8210-XCTL-ERROR-SCREEN                       07520000
084200     END-EVALUATE.                                                07530000
084300/                                                                 07540000
084400 7010-SELECT-TCNDCDR.                                             07550000
084500                                                                  07560000
084600     EXEC SQL                                                     07570000
084700         SELECT                                                   07580000
084800             DCDR.DOOR_TYP_CDE                                    07590000
084900         ,   DCDR.DIVERT_NBR                                      07600000
085000         ,   DCDR.DIVERT_LOC_ID                                   07610000
085100         INTO                                                     07620000
085200             :CNDCDR-DOOR-TYP-CDE                                 07630000
085300         ,   :CNDCDR-DIVERT-NBR                                   07640000
085400         ,   :CNDCDR-DIVERT-LOC-ID                                07650000
085500         FROM TCNDCDR DCDR                                        07660000
085600         ,    TCNDRTY DRTY                                        07670000
085700         WHERE                                                    07680000
085800             DCDR.OPER_UNT_ID         = :PC233-OPER-UNT-ID        07690000
085900             AND DCDR.DOOR_ID         = :PC233-DOOR-ID            07700000
086000             AND DCDR.DOOR_TYP_CDE    = DRTY.DOOR_TYP_CDE         07710000
086100             AND DRTY.DIVERT_TYP_CDE  = 'D'                       07720000
086200     END-EXEC.                                                    07730000
086300                                                                  07740000
086400     EVALUATE TRUE                                                07750000
086500         WHEN SQLCODE = ZERO                                      07760000
086600             SET PS-TCNDCDR-YES       TO TRUE                     07770000
086700         WHEN SQLCODE = +100                                      07780000
086800             SET PS-TCNDCDR-NO        TO TRUE                     07790000
086900         WHEN SQLCODE = -904                                      07800000
087000         WHEN SQLCODE = -913                                      07810000
087100         WHEN SQLCODE = -911                                      07820000
087200             MOVE 3                   TO PV-ERROR-NBR             07830000
087300             PERFORM 9903-WRITE-CICS-LOG                          07840000
087400             PERFORM 9000-SOFT-ABORT                              07850000
087500         WHEN SQLWARN0 NOT = SPACES                               07860000
087600         WHEN SQLCODE NOT EQUAL ZERO                              07870000
087700             MOVE 4                   TO PV-ERROR-NBR             07880000
087800                                         PC233-ERROR-NBR          07890000
087900             PERFORM 9903-WRITE-CICS-LOG                          07900000
088000             MOVE '7010-SELECT-TCNDCDR'                           07910000
088100                                      TO PC233-PARAGRAPH          07920000
088200             MOVE 'PCKRF876 - CHECK DOOR ID'                      07930000
088300                                      TO PC233-MESSAGE-TEXT(1)    07940000
088400             MOVE SQLCA               TO PC233-SQLCA              07950000
088500             MOVE 'TCNDCDR'           TO PC233-DB2-TABLE-NAME(1)  07960000
088600             SET PC233-ABEND          TO TRUE                     07970000
088700             MOVE 99                  TO PC233-PGM-MSG-NBR        07980000
088800             PERFORM 8210-XCTL-ERROR-SCREEN                       07990000
088900     END-EVALUATE.                                                08000000
089000                                                                  08010000
089100 7011-SELECT-TCNDRST.                                             08011013
089200                                                                  08012013
089300     EXEC SQL                                                     08013013
089400         SELECT                                                   08014013
089500             DRST.STR_NBR                                         08015013
089600         INTO                                                     08016013
089700             :CNDRST-STR-NBR                                      08017013
089800         FROM TCNDRST DRST                                        08018013
089900         WHERE                                                    08019013
090000             DRST.OPER_UNT_ID         = :PC233-OPER-UNT-ID        08019113
090100             AND DRST.DOOR_ID         = :PC233-DOOR-ID            08019213
090200             AND CURRENT TIMESTAMP BETWEEN                        08019313
090300                  DRST.STRT_TMST AND DRST.END_TMST                08019413
090400     END-EXEC.                                                    08019513
090500                                                                  08019613
090600     EVALUATE TRUE                                                08019713
090700         WHEN SQLCODE = ZERO                                      08019813
090800             MOVE CNDRST-STR-NBR      TO PC233-STR-NBR            08019913
090900                                         ADESTO                   08020013
091000         WHEN SQLCODE = +100                                      08020113
091100         WHEN SQLCODE = -811                                      08020213
091200             MOVE ZEROES              TO PC233-STR-NBR            08020313
091300                                         ADESTO                   08020413
091400         WHEN SQLCODE = -904                                      08020513
091500         WHEN SQLCODE = -913                                      08020613
091600         WHEN SQLCODE = -911                                      08020713
091700             MOVE 5                   TO PV-ERROR-NBR             08020813
091800             PERFORM 9903-WRITE-CICS-LOG                          08020913
091900             PERFORM 9000-SOFT-ABORT                              08021013
092000         WHEN SQLWARN0 NOT = SPACES                               08021113
092100         WHEN SQLCODE NOT EQUAL ZERO                              08021213
092200             MOVE 6                   TO PV-ERROR-NBR             08021313
092300                                         PC233-ERROR-NBR          08021413
092400             PERFORM 9903-WRITE-CICS-LOG                          08021513
092500             MOVE '7011-SELECT-TCNDRST'                           08021613
092600                                      TO PC233-PARAGRAPH          08021713
092700             MOVE 'PCKRF872 - CHECK DOOR ID'                      08021813
092800                                      TO PC233-MESSAGE-TEXT(1)    08021913
092900             MOVE SQLCA               TO PC233-SQLCA              08022013
093000             MOVE 'TCNDRST'           TO PC233-DB2-TABLE-NAME(1)  08022113
093100             SET PC233-ABEND          TO TRUE                     08022213
093200             MOVE 99                  TO PC233-PGM-MSG-NBR        08022313
093300             PERFORM 8210-XCTL-ERROR-SCREEN                       08022413
093400     END-EVALUATE.                                                08022513
093500                                                                  08022613
093600 7020-FIND-OTHER-DOOR.                                            08023000
093700                                                                  08030000
093800     EXEC SQL                                                     08040000
093900         SELECT                                                   08050000
094000             OBTS.DOOR_ID                                         08060000
094100         ,   OBTS.OTBND_TRIP_ID                                   08070000
094200         INTO                                                     08080000
094300             :SUOBTS-DOOR-ID                                      08090000
094400         ,   :SUOBTS-OTBND-TRIP-ID                                08100000
094500         FROM                                                     08110000
094600             TSUOBTR OBTR                                         08120000
094700       ,     TSUOBTS OBTS                                         08130000
094800       WHERE                                                      08140000
094900           OBTR.TRLR_SRL_NBR                = :PC233-SERIAL-NBR   08150000
095000           AND OBTR.TRIP_ACTV_CDE           = 'A'                 08160000
095100           AND OBTR.OTBND_TRIP_ID           = OBTS.OTBND_TRIP_ID  08170000
095200           AND OBTS.TRIP_STAT_CDE           = 'DO'                08180000
095300           AND OBTS.DOOR_ID                <> :PC233-DOOR-ID      08190000
095400           AND OBTS.OTBND_STAT_TMST =                             08200000
095500                                                                  08210000
095600        ( SELECT MAX (OBTS1.OTBND_STAT_TMST )                     08220000
095700            FROM                                                  08230000
095800              TSUOBTS OBTS1                                       08240000
095900            WHERE                                                 08250000
096000              OBTS.OTBND_TRIP_ID        = OBTS1.OTBND_TRIP_ID)    08260000
096100     END-EXEC.                                                    08270000
096200                                                                  08280000
096300     EVALUATE TRUE                                                08290000
096400         WHEN SQLCODE = ZERO                                      08300000
096500*           (THE TRAILER IS OPEN AT ONE OTHER DOOR)               08310000
096600             MOVE SUOBTS-DOOR-ID      TO PC233-ERROR-DOOR-NBR     08320000
096700             MOVE SUOBTS-OTBND-TRIP-ID                            08330000
096800                                      TO PC233-ERROR-TRIP-ID      08340000
096900             MOVE 4                   TO PC233-PGM-MSG-NBR        08350000
097000             SET PS-TRLR-OPEN-DIFF-DOOR                           08360000
097100                 PS-XCTL-E871                                     08370000
097200                 PS-ERRORS-YES        TO TRUE                     08380000
097300         WHEN SQLCODE = -811                                      08390000
097400*           (THE TRAILER IS AT MULTIPLE DOORS                     08400000
097500*                     OTHER THAN THE CURRENT ONE)                 08410000
097600             MOVE 4                   TO PC233-PGM-MSG-NBR        08420000
097700             MOVE 'MULT'              TO PC233-ERROR-DOOR-NBR     08430000
097800             MOVE SUOBTS-OTBND-TRIP-ID                            08440000
097900                                      TO PC233-ERROR-TRIP-ID      08450000
098000             SET PS-TRLR-OPEN-DIFF-DOOR                           08460000
098100                 PS-XCTL-E871                                     08470000
098200                 PS-ERRORS-YES        TO TRUE                     08480000
098300         WHEN SQLCODE = +100                                      08490000
098400*           (THE TRAILER IS ONLY AT THE CURRENT DOOR)             08500000
098500             SET PS-TRLR-OPEN-THIS-DOOR                           08510000
098600                                      TO TRUE                     08520000
098700         WHEN SQLCODE = -904                                      08530000
098800         WHEN SQLCODE = -913                                      08540000
098900         WHEN SQLCODE = -911                                      08550000
099000             MOVE 5                   TO PV-ERROR-NBR             08560000
099100             PERFORM 9903-WRITE-CICS-LOG                          08570000
099200             PERFORM 9000-SOFT-ABORT                              08580000
099300         WHEN SQLWARN0 NOT = SPACES                               08590000
099400         WHEN SQLCODE NOT EQUAL ZERO                              08600000
099500             MOVE 6                   TO PV-ERROR-NBR             08610000
099600                                         PC233-ERROR-NBR          08620000
099700             PERFORM 9903-WRITE-CICS-LOG                          08630000
099800             MOVE '7020-FIND-OTHER-DOOR'                          08640000
099900                                      TO PC233-PARAGRAPH          08650000
100000             MOVE 'PCKRF876 - CHECK DOOR ID'                      08660000
100100                                      TO PC233-MESSAGE-TEXT(1)    08670000
100200             MOVE SQLCA               TO PC233-SQLCA              08680000
100300             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  08690000
100400             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(2)  08700000
100500             SET PC233-ABEND          TO TRUE                     08710000
100600             MOVE 99                  TO PC233-PGM-MSG-NBR        08720000
100700             PERFORM 8210-XCTL-ERROR-SCREEN                       08730000
100800     END-EVALUATE.                                                08740000
100900/                                                                 08750000
101000 7030-FIND-OTHER-TRLR.                                            08760000
101100                                                                  08770000
101200     EXEC SQL                                                     08780000
101300         SELECT                                                   08790000
101400             TRID.SCAC_CDE                                        08800000
101500         ,   TRID.TRLR_ID                                         08810000
101600         ,   TRID.TRLR_SRL_NBR                                    08811008
101700         ,   OBTS.OTBND_TRIP_ID                                   08820000
101800         INTO                                                     08830000
101900             :CNTRID-SCAC-CDE                                     08840000
102000         ,   :CNTRID-TRLR-ID                                      08850000
102100         ,   :CNTRID-TRLR-SRL-NBR                                 08851008
102200         ,   :SUOBTS-OTBND-TRIP-ID                                08860000
102300         FROM TSUOBTS OBTS                                        08870000
102400         ,    TSUOBTR OBTR                                        08880000
102500         ,    TCNTRID TRID                                        08890000
102600         WHERE                                                    08900000
102700             OBTS.OTBND_TRIP_ID       = OBTR.OTBND_TRIP_ID        08910000
102800         AND OBTR.TRLR_SRL_NBR        <> :PC233-SERIAL-NBR        08920000
102900         AND OBTR.TRLR_SRL_NBR        = TRID.TRLR_SRL_NBR         08930000
103000         AND OBTR.TRIP_ACTV_CDE       = 'A'                       08940000
103100         AND OBTS.STAT_OPER_UNT_ID    = :PC233-OPER-UNT-ID        08941003
103200         AND OBTS.DOOR_ID             =  :PC233-DOOR-ID           08950000
103300         AND OBTS.TRIP_STAT_CDE       = 'DO'                      08960000
103400         AND OBTS.OTBND_STAT_TMST =                               08970000
103500            (SELECT MAX(D.OTBND_STAT_TMST)                        08980000
103600             FROM TSUOBTS D                                       08990000
103700          WHERE D.OTBND_TRIP_ID = OBTS.OTBND_TRIP_ID)             09000000
103800                                                                  09010000
103900     END-EXEC.                                                    09020000
104000                                                                  09030000
104100     EVALUATE TRUE                                                09040000
104200         WHEN SQLCODE = ZERO                                      09050000
104300         WHEN SQLCODE = -811                                      09060000
104400             MOVE CNTRID-SCAC-CDE     TO PC233-ERROR-SCAC-ID      09070000
104500             MOVE CNTRID-TRLR-ID      TO PC233-ERROR-TRLR-ID      09080000
104600             MOVE CNTRID-TRLR-SRL-NBR TO PC233-ERROR-SRL-NBR      09081008
104700             MOVE PC233-DOOR-ID       TO PC233-ERROR-DOOR-NBR     09082009
104800             MOVE SUOBTS-OTBND-TRIP-ID                            09090000
104900                                      TO PC233-ERROR-TRIP-ID      09100000
105000             MOVE 4                   TO PC233-PGM-MSG-NBR        09110000
105100             SET PS-TRLR-OPEN-DIFF-DOOR                           09120000
105200                 PS-XCTL-E871                                     09130000
105300                 PS-ERRORS-YES        TO TRUE                     09140000
105400         WHEN SQLCODE = +100                                      09150000
105500             CONTINUE                                             09160000
105600         WHEN SQLCODE = -904                                      09170000
105700         WHEN SQLCODE = -913                                      09180000
105800         WHEN SQLCODE = -911                                      09190000
105900             MOVE 7                   TO PV-ERROR-NBR             09200000
106000             PERFORM 9903-WRITE-CICS-LOG                          09210000
106100             PERFORM 9000-SOFT-ABORT                              09220000
106200         WHEN SQLWARN0 NOT = SPACES                               09230000
106300         WHEN SQLCODE NOT EQUAL ZERO                              09240000
106400             MOVE 8                   TO PV-ERROR-NBR             09250000
106500                                         PC233-ERROR-NBR          09260000
106600             PERFORM 9903-WRITE-CICS-LOG                          09270000
106700             MOVE '7030-FIND-OTHER-TRLR'                          09280000
106800                                      TO PC233-PARAGRAPH          09290000
106900             MOVE 'PCKRF876 - CHECK TRLR AT ANOTHER DOOR'         09300000
107000                                      TO PC233-MESSAGE-TEXT(1)    09310000
107100             MOVE SQLCA               TO PC233-SQLCA              09320000
107200             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  09330000
107300             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(2)  09340000
107400             SET PC233-ABEND          TO TRUE                     09350000
107500             MOVE 99                  TO PC233-PGM-MSG-NBR        09360000
107600             PERFORM 8210-XCTL-ERROR-SCREEN                       09370000
107700     END-EVALUATE.                                                09380000
107800/                                                                 09390000
107900 7050-SELECT-TRAILER-STATUS.                                      09400000
108000                                                                  09410000
108100     INITIALIZE  SUOBTS-OTBND-TRIP-ID                             09420000
108200*                CNTRID-SCAC-CDE                                  09430000
108300                 CNTRID-TRLR-ID                                   09440000
108400                 SUOBTS-TRIP-STAT-CDE                             09450000
108500                                                                  09460000
108600     EXEC SQL                                                     09470000
108700       SELECT                                                     09480000
108800           OBTS.OTBND_TRIP_ID                                     09490000
108900*      ,   TRID.SCAC_CDE                                          09500000
109000       ,   TRID.TRLR_ID                                           09510000
109100       ,   OBTS.TRIP_STAT_CDE                                     09520000
109200       INTO                                                       09530000
109300           :SUOBTS-OTBND-TRIP-ID                                  09540000
109400*      ,   :CNTRID-SCAC-CDE                                       09550000
109500       ,   :CNTRID-TRLR-ID                                        09560000
109600       ,   :SUOBTS-TRIP-STAT-CDE                                  09570000
109700       FROM TSUOBTS OBTS                                          09580000
109800       ,    TSUOBTR OBTR                                          09590000
109900       ,    TCNTRID TRID                                          09600000
110000       WHERE                                                      09610000
110100           OBTR.ORGN_OPER_UNT_ID    = :PC233-OPER-UNT-ID          09620000
110200       AND OBTR.TRLR_SRL_NBR        = :PC233-SERIAL-NBR           09630000
110300       AND OBTR.TRIP_ACTV_CDE       = 'A'                         09640000
110400       AND OBTR.TRLR_SRL_NBR        = TRID.TRLR_SRL_NBR           09650000
110500       AND OBTS.OTBND_TRIP_ID       = OBTR.OTBND_TRIP_ID          09660000
110600       AND OBTS.TRIP_STAT_CDE      IN ('DO','AO','AK')            09670019
110700       AND OBTS.OTBND_STAT_TMST =                                 09680000
110800           (SELECT MAX(OBTS1.OTBND_STAT_TMST)                     09690000
110900               FROM TSUOBTS OBTS1                                 09700000
111000               WHERE                                              09710000
111100               OBTS1.OTBND_TRIP_ID = OBTS.OTBND_TRIP_ID)          09720000
111200                                                                  09730000
111300     END-EXEC.                                                    09740000
111400                                                                  09750000
111500     EVALUATE TRUE                                                09760000
111600         WHEN SQLCODE = ZERO                                      09770000
111700             SET PS-ACTIVE-TRIP-EXISTS                            09780000
111800                                      TO TRUE                     09790000
111900             MOVE SUOBTS-OTBND-TRIP-ID TO PC233-TRIP-ID           09791000
112000                                          ATRIPO                  09792000
112100         WHEN SQLCODE = +100                                      09800000
112200             SET PS-NO-ACTIVE-TRIP-EXISTS                         09810000
112300                                      TO TRUE                     09820000
112400         WHEN SQLCODE = -904                                      09830000
112500         WHEN SQLCODE = -913                                      09840000
112600         WHEN SQLCODE = -911                                      09850000
112700             MOVE 9                   TO PV-ERROR-NBR             09860000
112800             PERFORM 9903-WRITE-CICS-LOG                          09870000
112900             PERFORM 9000-SOFT-ABORT                              09880000
113000         WHEN SQLWARN0 NOT = SPACES                               09890000
113100         WHEN SQLCODE NOT EQUAL ZERO                              09900000
113200             MOVE 10                  TO PV-ERROR-NBR             09910000
113300                                         PC233-ERROR-NBR          09920000
113400             PERFORM 9903-WRITE-CICS-LOG                          09930000
113500             MOVE '7050-SELECT-TRAILER-STATUS'                    09940000
113600                                      TO PC233-PARAGRAPH          09950000
113700             MOVE 'PCKRF876 - CHECK TRLR AT ANOTHER DOOR'         09960000
113800                                      TO PC233-MESSAGE-TEXT(1)    09970000
113900             MOVE SQLCA               TO PC233-SQLCA              09980000
114000             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  09990000
114100             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(2)  10000000
114200             SET PC233-ABEND          TO TRUE                     10010000
114300             MOVE 99                  TO PC233-PGM-MSG-NBR        10020000
114400             PERFORM 8210-XCTL-ERROR-SCREEN                       10030000
114500     END-EVALUATE.                                                10040000
114600/                                                                 10050000
114700 7060-SELECT-TCNDRST.                                             10060000
114800                                                                  10070000
114900     EXEC SQL                                                     10080000
115000         SELECT  ST.STR_NBR                                       10090000
115100         INTO  :CNDRST-STR-NBR                                    10100000
115200         FROM TCNDRST ST                                          10110000
115300         WHERE ST.OPER_UNT_ID = :PC233-OPER-UNT-ID                10120000
115400           AND ST.DOOR_ID     = :PC233-DOOR-ID                    10130000
115500           AND ST.END_TMST    = :PC-DUMMY-TIMESTAMP               10131031
115600     END-EXEC                                                     10140000
115700                                                                  10150000
115800     EVALUATE TRUE                                                10160000
115900         WHEN SQLCODE = ZERO                                      10170000
116000         WHEN SQLCODE = +100                                      10180000
116100         WHEN SQLCODE = -811                                      10190000
116200             CONTINUE                                             10200000
116300         WHEN SQLCODE = -904                                      10210000
116400         WHEN SQLCODE = -913                                      10220000
116500         WHEN SQLCODE = -911                                      10230000
116600             MOVE 11                  TO PV-ERROR-NBR             10240000
116700             PERFORM 9903-WRITE-CICS-LOG                          10250000
116800             PERFORM 9000-SOFT-ABORT                              10260000
116900         WHEN SQLWARN0 NOT = SPACES                               10270000
117000         WHEN SQLCODE NOT EQUAL ZERO                              10280000
117100             MOVE 12                  TO PV-ERROR-NBR             10290000
117200                                         PC233-ERROR-NBR          10300000
117300             PERFORM 9903-WRITE-CICS-LOG                          10310000
117400             MOVE '7060-SELECT-TSUOBTS'                           10320000
117500                                      TO PC233-PARAGRAPH          10330000
117600             MOVE 'PCKRF876 - CHECK TRLR AT ANOTHER DOOR'         10340000
117700                                      TO PC233-MESSAGE-TEXT(1)    10350000
117800             MOVE SQLCA               TO PC233-SQLCA              10360000
117900             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(1)  10370000
118000             SET PC233-ABEND          TO TRUE                     10380000
118100             MOVE 99                  TO PC233-PGM-MSG-NBR        10390000
118200             PERFORM 8210-XCTL-ERROR-SCREEN                       10400000
118300     END-EVALUATE.                                                10410000
118400/                                                                 10420000
118500 7070-CHECK-OPEN-TRAILERS.                                        10430000
118600                                                                  10440000
118700     EXEC SQL                                                     10450000
118800         SELECT OBTS.OTBND_TRIP_ID                                10460000
118900         ,      OBTR.TRLR_SRL_NBR                                 10470000
118910         ,      OBTR.DOOR_TYP_CDE                                 10470000
119000         INTO :SUOBTS-OTBND-TRIP-ID                               10480000
119100         ,    :SUOBTR-TRLR-SRL-NBR                                10490000
119110         ,    :SUOBTR-DOOR-TYP-CDE                                10490000
119200         FROM TSUOBTS OBTS                                        10500000
119300         ,    TSUOBTR OBTR                                        10510000
119400         WHERE OBTS.TRIP_STAT_CDE     = 'DO'                      10520000
119500         AND OBTS.DOOR_ID             = :PC233-DOOR-ID            10530000
119600         AND OBTR.ORGN_OPER_UNT_ID    = :PC233-OPER-UNT-ID        10540000
119700         AND OBTR.OTBND_TRIP_ID       = OBTS.OTBND_TRIP_ID        10550000
119800         AND OBTS.STAT_OPER_UNT_ID    = :PC233-OPER-UNT-ID        10551003
119900         AND OBTS.OTBND_STAT_TMST     =                           10560000
120000         (                                                        10570000
120100          SELECT                                                  10580000
120200            MAX(OBTS1.OTBND_STAT_TMST)                            10590000
120300            FROM TSUOBTS OBTS1                                    10600000
120400            WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID        10610000
120500         )                                                        10620000
120600     END-EXEC.                                                    10630000
120700                                                                  10640000
120800     EVALUATE TRUE                                                10650000
120900         WHEN SQLCODE = ZERO                                      10660000
121000         WHEN SQLCODE = +100                                      10670000
121100         WHEN SQLCODE = -811                                      10680000
121200             CONTINUE                                             10690000
121300         WHEN SQLCODE = -904                                      10700000
121400         WHEN SQLCODE = -913                                      10710000
121500         WHEN SQLCODE = -911                                      10720000
121600             MOVE 13                  TO PV-ERROR-NBR             10730000
121700             PERFORM 9903-WRITE-CICS-LOG                          10740000
121800             PERFORM 9000-SOFT-ABORT                              10750000
121900         WHEN SQLWARN0 NOT = SPACES                               10760000
122000         WHEN SQLCODE NOT EQUAL ZERO                              10770000
122100             MOVE 14                  TO PV-ERROR-NBR             10780000
122200                                         PC233-ERROR-NBR          10790000
122300             PERFORM 9903-WRITE-CICS-LOG                          10800000
122400             MOVE '7070-CHECK-OPEN-TRAILERS'                      10810000
122500                                      TO PC233-PARAGRAPH          10820000
122600             MOVE 'PCKRF876 - CHECK OPEN TRAILERS AT DOOR'        10830000
122700                                      TO PC233-MESSAGE-TEXT(1)    10840000
122800             MOVE SQLCA               TO PC233-SQLCA              10850000
122900             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  10860000
123000             SET PC233-ABEND          TO TRUE                     10870000
123100             MOVE 99                  TO PC233-PGM-MSG-NBR        10880000
123200             PERFORM 8210-XCTL-ERROR-SCREEN                       10890000
123300     END-EVALUATE.                                                10900000
123400/                                                                 10910000
123500 7080-SELECT-TCNDRST.                                             10920000
123600     EXEC SQL                                                     10930000
123700         SELECT                                                   10940000
123800             DRST.DOOR_ID                                         10950000
123810           , DCDR.DOOR_TYP_CDE                                    07590000
123900         INTO                                                     10960000
124000             :CNDRST-DOOR-ID                                      10970000
124010            ,:CNDCDR-DOOR-TYP-CDE                                 10970000
124100         FROM TCNDRST DRST                                        10980000
124110            , TCNDCDR DCDR                                        10980000
124200         WHERE                                                    10990000
124300             DRST.OPER_UNT_ID         = :PC233-OPER-UNT-ID        11000000
124400         AND DRST.STR_NBR             = :PC233-STR-NBR            11010000
124500         AND CURRENT TIMESTAMP BETWEEN                            11020000
124600              DRST.STRT_TMST AND DRST.END_TMST                    11030000
124610         AND DCDR.OPER_UNT_ID         =  DRST.OPER_UNT_ID                 
124620         AND DCDR.DOOR_ID             =  DRST.DOOR_ID                     
124700     END-EXEC.                                                    11040000
124800                                                                  11050000
124900     EVALUATE TRUE                                                11060000
125000         WHEN SQLCODE = ZERO                                      11070000
125100         WHEN SQLCODE = +100                                      11080000
125200         WHEN SQLCODE = -811                                      11090000
125300             CONTINUE                                             11100000
125400         WHEN SQLCODE = -904                                      11110000
125500         WHEN SQLCODE = -913                                      11120000
125600         WHEN SQLCODE = -911                                      11130000
125700             MOVE 15                  TO PV-ERROR-NBR             11140000
125800             PERFORM 9903-WRITE-CICS-LOG                          11150000
125900             PERFORM 9000-SOFT-ABORT                              11160000
126000         WHEN SQLWARN0 NOT = SPACES                               11170000
126100         WHEN SQLCODE NOT EQUAL ZERO                              11180000
126200             MOVE 16                  TO PV-ERROR-NBR             11190000
126300                                         PC233-ERROR-NBR          11200000
126400             PERFORM 9903-WRITE-CICS-LOG                          11210000
126500             MOVE '7080-SELECT-TCNDRST'                           11220000
126600                                      TO PC233-PARAGRAPH          11230000
126700             MOVE 'PCKRF876 - CHECK OPEN TRAILERS AT DOOR'        11240000
126800                                      TO PC233-MESSAGE-TEXT(1)    11250000
126900             MOVE SQLCA               TO PC233-SQLCA              11260000
127000             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  11270000
127100             SET PC233-ABEND          TO TRUE                     11280000
127200             MOVE 99                  TO PC233-PGM-MSG-NBR        11290000
127300             PERFORM 8210-XCTL-ERROR-SCREEN                       11300000
127400     END-EVALUATE.                                                11310000
127500/                                                                 11320000
127600 7090-SELECT-TCNDRST.                                             11330000
127700     EXEC SQL                                                     11340000
127800         SELECT OBTS.DOOR_ID                                      11350000
127900            ,   OBTR.TRLR_SRL_NBR                                 11360000
128000            ,   OBTR.OTBND_TRIP_ID                                11370000
128010            ,   OBTR.DOOR_TYP_CDE                                 11370000
128100         INTO :SUOBTS-DOOR-ID                                     11380000
128200            , :SUOBTR-TRLR-SRL-NBR                                11390000
128300            , :SUOBTR-OTBND-TRIP-ID                               11400000
128310            , :SUOBTR-DOOR-TYP-CDE                                11400000
128400         FROM TSUOBTR OBTR                                        11410000
128500         ,    TSUOBTS OBTS                                        11420000
128600         WHERE                                                    11430000
128700             OBTR.DEST_OPER_UNT_ID  = :PC233-STR-NBR              11440000
128800             AND OBTR.TRIP_ACTV_CDE = 'A'                         11450000
128900             AND OBTS.OTBND_TRIP_ID = OBTR.OTBND_TRIP_ID          11460000
129000             AND OBTS.TRIP_STAT_CDE = 'DO'                        11461030
129100         AND OBTS.OTBND_STAT_TMST   =                             11470000
129200         (                                                        11480000
129300          SELECT                                                  11490000
129400            MAX(OBTS1.OTBND_STAT_TMST)                            11500000
129500            FROM TSUOBTS OBTS1                                    11510000
129600            WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID        11520000
129700         )                                                        11530000
129800     END-EXEC                                                     11540000
129900                                                                  11550000
130000     EVALUATE TRUE                                                11560000
130100         WHEN SQLCODE = ZERO                                      11570000
130200         WHEN SQLCODE = +100                                      11580000
130300         WHEN SQLCODE = -811                                      11590000
130400             CONTINUE                                             11600000
130500         WHEN SQLCODE = -904                                      11610000
130600         WHEN SQLCODE = -913                                      11620000
130700         WHEN SQLCODE = -911                                      11630000
130800             MOVE 17                  TO PV-ERROR-NBR             11640000
130900             PERFORM 9903-WRITE-CICS-LOG                          11650000
131000             PERFORM 9000-SOFT-ABORT                              11660000
131100         WHEN SQLWARN0 NOT = SPACES                               11670000
131200         WHEN SQLCODE NOT EQUAL ZERO                              11680000
131300             MOVE 18                  TO PV-ERROR-NBR             11690000
131400                                         PC233-ERROR-NBR          11700000
131500             PERFORM 9903-WRITE-CICS-LOG                          11710000
131600             MOVE '7090-SELECT-TCNDRST'                           11720000
131700                                      TO PC233-PARAGRAPH          11730000
131800             MOVE 'PCKRF876 - CHECK OPEN TRAILERS AT DOOR'        11740000
131900                                      TO PC233-MESSAGE-TEXT(1)    11750000
132000             MOVE SQLCA               TO PC233-SQLCA              11760000
132100             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  11770000
132200             SET PC233-ABEND          TO TRUE                     11780000
132300             MOVE 99                  TO PC233-PGM-MSG-NBR        11790000
132400             PERFORM 8210-XCTL-ERROR-SCREEN                       11800000
132500     END-EVALUATE.                                                11810000
132600/                                                                 11820000
132700 7100-GET-STR-DOOR-FROM-TRAILER.                                  11830000
132800                                                                  11840000
132900     EXEC SQL                                                     11850000
133000         SELECT OBTS.DOOR_ID                                      11860000
133100         ,      OBTR.DEST_OPER_UNT_ID                             11870000
133200         INTO :SUOBTS-DOOR-ID                                     11880000
133300         ,    :SUOBTR-DEST-OPER-UNT-ID                            11890000
133400         FROM TSUOBTR OBTR                                        11900000
133500         ,    TSUOBTS OBTS                                        11910000
133600         WHERE                                                    11920000
133700             OBTR.TRLR_SRL_NBR      = :PC233-SERIAL-NBR           11930000
133800             AND OBTR.TRIP_ACTV_CDE = 'A'                         11940000
133900             AND OBTS.TRIP_STAT_CDE IN ('DO', 'DC')               11950000
134000             AND OBTS.OTBND_TRIP_ID = OBTR.OTBND_TRIP_ID          11960000
134100         AND OBTS.OTBND_STAT_TMST =                               11970000
134200         (                                                        11980000
134300          SELECT                                                  11990000
134400            MAX(OBTS1.OTBND_STAT_TMST)                            12000000
134500            FROM TSUOBTS OBTS1                                    12010000
134600            WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID        12020000
134700         )                                                        12030000
134800     END-EXEC                                                     12040000
134900                                                                  12050000
135000     EVALUATE TRUE                                                12060000
135100         WHEN SQLCODE = ZERO                                      12070000
135200         WHEN SQLCODE = +100                                      12080000
135300         WHEN SQLCODE = -811                                      12090000
135400             CONTINUE                                             12100000
135500         WHEN SQLCODE = -904                                      12110000
135600         WHEN SQLCODE = -913                                      12120000
135700         WHEN SQLCODE = -911                                      12130000
135800             MOVE 19                  TO PV-ERROR-NBR             12140000
135900             PERFORM 9903-WRITE-CICS-LOG                          12150000
136000             PERFORM 9000-SOFT-ABORT                              12160000
136100         WHEN SQLWARN0 NOT = SPACES                               12170000
136200         WHEN SQLCODE NOT EQUAL ZERO                              12180000
136300             MOVE 20                  TO PV-ERROR-NBR             12190000
136400                                         PC233-ERROR-NBR          12200000
136500             PERFORM 9903-WRITE-CICS-LOG                          12210000
136600             MOVE '7100-GET-STR-DOOR-FROM-TRAILER'                12220000
136700                                      TO PC233-PARAGRAPH          12230000
136800             MOVE 'PCKRF876 - GET STORE/DOOR INFO FROM TRLR'      12240000
136900                                      TO PC233-MESSAGE-TEXT(1)    12250000
137000             MOVE SQLCA               TO PC233-SQLCA              12260000
137100             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  12270000
137200             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(2)  12280000
137300             SET PC233-ABEND          TO TRUE                     12290000
137400             MOVE 99                  TO PC233-PGM-MSG-NBR        12300000
137500             PERFORM 8210-XCTL-ERROR-SCREEN                       12310000
137600     END-EVALUATE.                                                12320000
137700                                                                  12330000
137800 7110-CHECK-STATUS-CODES.                                         12340000
137900                                                                  12350000
138000     EXEC SQL                                                     12360000
138100          SELECT CURR_TRIP_STAT_CDE                               12370000
138200          INTO :SUT00005-CURR-TRIP-STAT-CDE                       12380000
138300          FROM SUT_STAT_ASSN SUT                                  12390000
138400          WHERE                                                   12400000
138500             SUT.CURR_TRIP_STAT_CDE = :SUOBTS-TRIP-STAT-CDE       12410000
138600         AND SUT.NEXT_TRIP_STAT_CDE = 'DC'                        12420000
138700     END-EXEC                                                     12430000
138800                                                                  12440000
138900                                                                  12450000
139000     EVALUATE TRUE                                                12460000
139100         WHEN SQLCODE = ZERO                                      12470000
139200         WHEN SQLCODE = +100                                      12480000
139300         WHEN SQLCODE = -811                                      12490000
139400             CONTINUE                                             12500000
139500         WHEN SQLCODE = -904                                      12510000
139600         WHEN SQLCODE = -913                                      12520000
139700         WHEN SQLCODE = -911                                      12530000
139800             MOVE 21                  TO PV-ERROR-NBR             12540000
139900             PERFORM 9903-WRITE-CICS-LOG                          12550000
140000             PERFORM 9000-SOFT-ABORT                              12560000
140100         WHEN SQLWARN0 NOT = SPACES                               12570000
140200         WHEN SQLCODE NOT EQUAL ZERO                              12580000
140300             MOVE 22                  TO PV-ERROR-NBR             12590000
140400                                         PC233-ERROR-NBR          12600000
140500             PERFORM 9903-WRITE-CICS-LOG                          12610000
140600             MOVE '7110-CHECK-STATUS-CODES'                       12620000
140700                                      TO PC233-PARAGRAPH          12630000
140800             MOVE 'PCKRF876 - IS ACTION ALLOWABLE'                12640000
140900                                      TO PC233-MESSAGE-TEXT(1)    12650000
141000             MOVE SQLCA               TO PC233-SQLCA              12660000
141100             MOVE 'SUT_STAT_ASSN'     TO PC233-DB2-TABLE-NAME(1)  12670000
141200             SET PC233-ABEND          TO TRUE                     12680000
141300             MOVE 99                  TO PC233-PGM-MSG-NBR        12690000
141400             PERFORM 8210-XCTL-ERROR-SCREEN                       12700000
141500     END-EVALUATE.                                                12710000
141600                                                                  12720000
141700 7111-SELECT-TSUOBSC.                                             12730000
141800                                                                  12740000
141900     EXEC SQL                                                     12750000
142000          SELECT STAT_SHRT_DESC                                   12760000
142100          INTO :SUOBSC-STAT-SHRT-DESC                             12770000
142200          FROM TSUOBSC                                            12780000
142300          WHERE                                                   12790000
142400             TRIP_STAT_CDE = :SUOBTS-TRIP-STAT-CDE                12800000
142500     END-EXEC                                                     12810000
142600                                                                  12820000
142700     EVALUATE TRUE                                                12830000
142800         WHEN SQLCODE = ZERO                                      12840000
142900         WHEN SQLCODE = +100                                      12850000
143000         WHEN SQLCODE = -811                                      12860000
143100             CONTINUE                                             12870000
143200         WHEN SQLCODE = -904                                      12880000
143300         WHEN SQLCODE = -913                                      12890000
143400         WHEN SQLCODE = -911                                      12900000
143500             MOVE 22                  TO PV-ERROR-NBR             12910012
143600             PERFORM 9903-WRITE-CICS-LOG                          12920000
143700             PERFORM 9000-SOFT-ABORT                              12930000
143800         WHEN SQLWARN0 NOT = SPACES                               12940000
143900         WHEN SQLCODE NOT EQUAL ZERO                              12950000
144000             MOVE 23                  TO PV-ERROR-NBR             12960012
144100                                         PC233-ERROR-NBR          12970000
144200             PERFORM 9903-WRITE-CICS-LOG                          12980000
144300             MOVE '7111-SELECT-TSUOBSC'                           12990000
144400                                      TO PC233-PARAGRAPH          13000000
144500             MOVE 'PCKRF876 - GET SATUS DESCRIPTION'              13010000
144600                                      TO PC233-MESSAGE-TEXT(1)    13020000
144700             MOVE SQLCA               TO PC233-SQLCA              13030000
144800             MOVE 'TSUOBSC'           TO PC233-DB2-TABLE-NAME(1)  13040000
144900             SET PC233-ABEND          TO TRUE                     13050000
145000             MOVE 99                  TO PC233-PGM-MSG-NBR        13060000
145100             PERFORM 8210-XCTL-ERROR-SCREEN                       13070000
145200     END-EVALUATE.                                                13080000
145300                                                                  13090000
145400 7120-SELECT-TSUCDOT.                                             13100013
145500                                                                  13110013
145600     EXEC SQL                                                     13120013
145700         SELECT STRT_SCN_TMST                                     13130015
145800         INTO :SUCDOT-STRT-SCN-TMST                               13140015
145900       FROM TSUCDOT CDOT                                          13150013
146000       WHERE CDOT.OTBND_TRIP_ID = :PC233-TRIP-ID                  13160013
146100         AND CDOT.OPER_UNT_ID   = :PC233-OPER-UNT-ID              13170013
146200     END-EXEC.                                                    13190013
146300                                                                  13200013
146400     EVALUATE TRUE                                                13210013
146500         WHEN SQLCODE = ZERO                                      13220013
146600         WHEN SQLCODE = -811                                      13230013
146700             CONTINUE                                             13240013
146800         WHEN SQLCODE = +100                                      13250013
146900             MOVE PC-LOW-TIMESTAMP    TO SUCDOT-STRT-SCN-TMST     13260015
147000         WHEN SQLCODE = -904                                      13270013
147100         WHEN SQLCODE = -913                                      13280013
147200         WHEN SQLCODE = -911                                      13290013
147300             MOVE 24                  TO PV-ERROR-NBR             13300013
147400             PERFORM 9903-WRITE-CICS-LOG                          13310013
147500             PERFORM 9000-SOFT-ABORT                              13320013
147600         WHEN SQLWARN0 NOT = SPACES                               13330013
147700         WHEN SQLCODE NOT EQUAL ZERO                              13340013
147800             MOVE 25                  TO PV-ERROR-NBR             13350013
147900                                         PC233-ERROR-NBR          13360013
148000             PERFORM 9903-WRITE-CICS-LOG                          13370013
148100             MOVE '7120-SELECT-TSUCDOT'                           13380013
148200                                      TO PC233-PARAGRAPH          13390013
148300             MOVE 'PCKRF876 - GET STORE/DOOR INFO FROM TRLR'      13400013
148400                                      TO PC233-MESSAGE-TEXT(1)    13410013
148500             MOVE SQLCA               TO PC233-SQLCA              13420013
148600             MOVE 'TSUCDOT'           TO PC233-DB2-TABLE-NAME(1)  13430013
148700             SET PC233-ABEND          TO TRUE                     13440013
148800             MOVE 99                  TO PC233-PGM-MSG-NBR        13450013
148900             PERFORM 8210-XCTL-ERROR-SCREEN                       13460013
149000     END-EVALUATE.                                                13470013
149100                                                                  13480000
149200 7125-SELECT-TSUCDOT.                                             13490000
149300                                                                  13500000
149400* IS THERE A ROW WITHOUT AN END CUTOFF POINT?                     13510000
149500     EXEC SQL                                                     13520000
149600         SELECT                                                   13530000
149700             CDOT.STRT_DIVERT_TMST                                13540000
149800         INTO                                                     13550000
149900            :SUCDOT-STRT-DIVERT-TMST                              13560000
150000       FROM TSUCDOT CDOT                                          13570000
150100       WHERE CDOT.OTBND_TRIP_ID   = :PC233-TRIP-ID                13580000
150200         AND CDOT.OPER_UNT_ID     = :PC233-OPER-UNT-ID            13590000
150300         AND CDOT.DOOR_ID         = :PC233-DOOR-ID                13600000
150400         AND CDOT.END_DIVERT_TMST = :PC-DUMMY-TIMESTAMP           13610000
150500     END-EXEC.                                                    13620000
150600                                                                  13630000
150700     EVALUATE TRUE                                                13640000
150800         WHEN SQLCODE = ZERO                                      13650000
150900         WHEN SQLCODE = +100                                      13660000
151000         WHEN SQLCODE = -811                                      13670000
151100             CONTINUE                                             13680000
151200         WHEN SQLCODE = -904                                      13690000
151300         WHEN SQLCODE = -913                                      13700000
151400         WHEN SQLCODE = -911                                      13710000
151500             MOVE 26                  TO PV-ERROR-NBR             13720012
151600             PERFORM 9903-WRITE-CICS-LOG                          13730000
151700             PERFORM 9000-SOFT-ABORT                              13740000
151800         WHEN SQLWARN0 NOT = SPACES                               13750000
151900         WHEN SQLCODE NOT EQUAL ZERO                              13760000
152000             MOVE 27                  TO PV-ERROR-NBR             13770012
152100                                         PC233-ERROR-NBR          13780000
152200             PERFORM 9903-WRITE-CICS-LOG                          13790000
152300             MOVE '7125-SELECT-TSUCDOT'                           13800000
152400                                      TO PC233-PARAGRAPH          13810000
152500             MOVE 'PCKRF876 - GET TRIP END CUTOFF'                13820000
152600                                      TO PC233-MESSAGE-TEXT(1)    13830000
152700             MOVE SQLCA               TO PC233-SQLCA              13840000
152800             MOVE 'TSUCDOT'           TO PC233-DB2-TABLE-NAME(1)  13850000
152900             SET PC233-ABEND          TO TRUE                     13860000
153000             MOVE 99                  TO PC233-PGM-MSG-NBR        13870000
153100             PERFORM 8210-XCTL-ERROR-SCREEN                       13880000
153200     END-EVALUATE.                                                13890000
153300                                                                  13900000
153400 7130-SELECT-CART-LOC.                                            13910026
153500                                                                  13922013
153600     EXEC SQL                                                     13923013
153700         SELECT SHIPT_UNT_ID                                      13924013
153800         INTO  :SUT00027-SHIPT-UNT-ID                             13927028
153900         FROM   SUT_OTBND_LOC                                     13929027
154000         WHERE  OTBND_TRIP_ID      = :PC233-TRIP-ID               13929229
154100           AND  LOC_NBR      = :PC233-OPER-UNT-ID                 13929329
154200           AND  ACTV_CDE     = 'A'                                13929414
154300     END-EXEC.                                                    13930314
154400                                                                  13930413
154500                                                                  14200013
154600     EVALUATE TRUE                                                14210013
154700         WHEN SQLCODE = ZERO                                      14220013
154800         WHEN SQLCODE = -811                                      14230013
154900         WHEN SQLCODE = +100                                      14240013
155000             CONTINUE                                             14250013
155100         WHEN SQLCODE = -904                                      14260013
155200         WHEN SQLCODE = -913                                      14270013
155300         WHEN SQLCODE = -911                                      14280013
155400             MOVE 28                  TO PV-ERROR-NBR             14290013
155500             PERFORM 9903-WRITE-CICS-LOG                          14300013
155600             PERFORM 9000-SOFT-ABORT                              14310013
155700         WHEN SQLWARN0 NOT = SPACES                               14320013
155800         WHEN SQLCODE NOT EQUAL ZERO                              14330013
155900             MOVE 29                  TO PV-ERROR-NBR             14340013
156000                                         PC233-ERROR-NBR          14350013
156100             PERFORM 9903-WRITE-CICS-LOG                          14360013
156200             MOVE '7130-SELECT-CART-LOC' TO PC233-PARAGRAPH       14370026
156300             MOVE 'PCKRF876 - GET CUTOFF TIMESTAMP'               14380013
156400                                      TO PC233-MESSAGE-TEXT(1)    14390013
156500             MOVE SQLCA               TO PC233-SQLCA              14400013
156600             MOVE 'SUT00027'          TO PC233-DB2-TABLE-NAME(1)  14410028
156700             SET PC233-ABEND          TO TRUE                     14430013
156800             MOVE 99                  TO PC233-PGM-MSG-NBR        14440013
156900             PERFORM 8210-XCTL-ERROR-SCREEN                       14450013
157000     END-EVALUATE.                                                14460013
157100                                                                  14470000
157200/                                                                 14890000
157300 8000-SEND-MAP.                                                   14900000
157400                                                                  14910000
157500     EXEC CICS                                                    14920000
157600         SEND MAP       ('PC876A')                                14930000
157700              MAPSET    ('PCKM876')                               14940000
157800              ERASE                                               14950000
157900              CURSOR                                              14960000
158000              RESP      (PV-CICS-RESPONSE)                        14970000
158100     END-EXEC.                                                    14980000
158200                                                                  14990000
158300     EVALUATE TRUE                                                15000000
158400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15010000
158500             CONTINUE                                             15020000
158600         WHEN OTHER                                               15030000
158700             MOVE '8000-SEND-MAP'     TO DP013-PARAGRAPH          15040000
158800             MOVE 'PCKRF876 - UNABLE TO SEND MAP'                 15050000
158900                                      TO DP013-MESSAGE-TEXT (1)   15060000
159000             SET DP013-CICS-ABEND                                 15070000
159100                 DP013-ROLLBACK       TO TRUE                     15080000
159200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               15090000
159300     END-EVALUATE.                                                15100000
159400                                                                  15110000
159500 8010-SEND-DATA-ONLY.                                             15120000
159600                                                                  15130000
159700     IF ADOORL = -1 OR ADESTL = -1 OR ASERIALL = -1               15140000
159800         OR ASCACL = -1                                           15150000
159900         CONTINUE                                                 15160000
160000     ELSE                                                         15170000
160100         MOVE -1                      TO ADOORL                   15180000
160200     END-IF                                                       15190000
160300                                                                  15200000
160400     EXEC CICS                                                    15210000
160500         SEND MAP       ('PC876A')                                15220000
160600              MAPSET    ('PCKM876')                               15230000
160700              CURSOR                                              15240000
160800              DATAONLY                                            15250000
160900              RESP      (PV-CICS-RESPONSE)                        15260000
161000     END-EXEC.                                                    15270000
161100                                                                  15280000
161200     EVALUATE TRUE                                                15290000
161300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15300000
161400             CONTINUE                                             15310000
161500         WHEN OTHER                                               15320000
161600             MOVE '8010-SEND-DATA-ONLY'                           15330000
161700                                      TO DP013-PARAGRAPH          15340000
161800             MOVE 'PCKRF876 - UNABLE TO SEND DATA'                15350000
161900                                      TO DP013-MESSAGE-TEXT (1)   15360000
162000             SET DP013-CICS-ABEND                                 15370000
162100                 DP013-ROLLBACK       TO TRUE                     15380000
162200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               15390000
162300     END-EVALUATE.                                                15400000
162400                                                                  15410000
162500 8020-RECEIVE-MAP.                                                15420000
162600                                                                  15430000
162700     EXEC CICS                                                    15440000
162800         RECEIVE MAP    ('PC876A')                                15450000
162900                 MAPSET ('PCKM876')                               15460000
163000                 RESP   (PV-CICS-RESPONSE)                        15470000
163100     END-EXEC.                                                    15480000
163200                                                                  15490000
163300     EVALUATE TRUE                                                15500000
163400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15510000
163500             CONTINUE                                             15520000
163600         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                15530000
163700             CONTINUE                                             15540000
163800         WHEN OTHER                                               15550000
163900            MOVE '8020-RECEIVE-MAP'   TO DP013-PARAGRAPH          15560000
164000            MOVE 'PCKRF876 - UNABLE TO RECEIVE MAP'               15570000
164100                                      TO DP013-MESSAGE-TEXT (1)   15580000
164200            SET DP013-LOGIC-ABEND     TO TRUE                     15590000
164300            SET DP013-ROLLBACK        TO TRUE                     15600000
164400            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                15610000
164500     END-EVALUATE.                                                15620000
164600                                                                  15630000
164700 8050-LINK.                                                       15640003
164800     MOVE 'PCKRF876'                  TO PC047-CALLING-PROGRAM    15650003
164900     MOVE LENGTH OF PC047-COMMAREA    TO PV-COMMAREA-LENGTH       15660003
165000     EXEC CICS                                                    15670003
165100         LINK                                                     15680003
165200             PROGRAM   (PC-TRAILER-PROGRAM)                       15690003
165300             COMMAREA  (PC047-COMMAREA)                           15700003
165400             LENGTH    (PV-COMMAREA-LENGTH)                       15710003
165500     END-EXEC.                                                    15720003
165600                                                                  15720103
165700 8100-RETURN-TRANID.                                              15720200
165800                                                                  15720300
165900     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       15720400
166000     EXEC CICS                                                    15720500
166100         RETURN TRANSID  (PC-TRANID)                              15720600
166200                COMMAREA (CA-COMMAREA)                            15720700
166300                LENGTH   (PV-COMMAREA-LENGTH)                     15720800
166400                RESP     (PV-CICS-RESPONSE)                       15720900
166500     END-EXEC.                                                    15721000
166600                                                                  15730000
166700     EVALUATE TRUE                                                15740000
166800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15750000
166900             CONTINUE                                             15760000
167000         WHEN OTHER                                               15770000
167100             MOVE '8100-RETURN-TRANIND'                           15780000
167200                                      TO DP013-PARAGRAPH          15790000
167300             MOVE 'PCKRF876 - UNABLE TO RETURN TO TRANID'         15800000
167400                 TO DP013-MESSAGE-TEXT (1)                        15810000
167500             SET DP013-CICS-ABEND     TO TRUE                     15820000
167600             SET DP013-ROLLBACK       TO TRUE                     15830000
167700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               15840000
167800     END-EVALUATE.                                                15850000
167900                                                                  15860000
168000 8110-RETURN.                                                     15870000
168100                                                                  15880000
168200     EXEC CICS                                                    15890000
168300         SEND FROM (PV-MESSAGE-AREA)                              15900000
168400              LENGTH (19)                                         15910000
168500              ERASE                                               15920000
168600     END-EXEC.                                                    15930000
168700                                                                  15940000
168800     EXEC CICS                                                    15950000
168900         RETURN                                                   15960000
169000     END-EXEC.                                                    15970000
169100                                                                  15980000
169200 8200-XCTL.                                                       15990000
169300     SET PC233-INITIALIZE-SCREEN      TO TRUE.                    16000000
169400     MOVE PC-CURRENT-PROGRAM-NAME     TO PC233-LAST-PROGRAM.      16010000
169500     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       16020000
169600                                                                  16030000
169700     EXEC CICS                                                    16040000
169800         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    16050000
169900               COMMAREA  (CA-COMMAREA)                            16060000
170000               LENGTH    (PV-COMMAREA-LENGTH)                     16070000
170100               RESP      (PV-CICS-RESPONSE)                       16080000
170200     END-EXEC.                                                    16090000
170300                                                                  16100000
170400     EVALUATE TRUE                                                16110000
170500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16120000
170600             CONTINUE                                             16130000
170700         WHEN OTHER                                               16140000
170800             MOVE '8200-XCTL'                                     16150000
170900                                      TO DP013-PARAGRAPH          16160000
171000             MOVE 'PCKRF876 - UNABLE TO XCTL TO PROGRAM: '        16170000
171100                                      TO DP013-MESSAGE-TEXT (1)   16180000
171200             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   16190000
171300             SET DP013-CICS-ABEND                                 16200000
171400                 DP013-ROLLBACK       TO TRUE                     16210000
171500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               16220000
171600             MOVE PC-TRANS-UNAVAILABLE-MSG                        16230000
171700                                      TO AMSGLNO                  16240000
171800             SET PC233-PROCESS-SCREEN TO TRUE                     16250000
171900             MOVE -1                  TO ADOORL                   16260000
172000             PERFORM 8000-SEND-MAP                                16270000
172100             PERFORM 8100-RETURN-TRANID                           16280000
172200     END-EVALUATE.                                                16290000
172300                                                                  16300000
172400 8210-XCTL-ERROR-SCREEN.                                          16310000
172500     IF PC233-PGM-MSG-NBR = 37                                    16350000
172600         PERFORM 8211-SETUP-MSG-37                                16360003
172700     END-IF.                                                      16370003
172800                                                                  16370103
172900     IF NOT PC233-ABEND                                           16370200
173000         SET PC233-INITIALIZE-SCREEN  TO TRUE                     16370300
173100     END-IF                                                       16370400
173200     IF PC233-PGM-MSG-NBR = ZERO                                  16370500
173300         MOVE 2                       TO PC233-PGM-MSG-NBR        16370600
173400     END-IF                                                       16370700
173500                                                                  16380000
173600     MOVE DFHEIBLK                    TO PC233-DFHEIBLK.          16390000
173700     MOVE PC-CURRENT-PROGRAM-NAME     TO PC233-LAST-PROGRAM.      16400000
173800     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       16410000
173900     MOVE 'PCKRF871'                  TO PV-TRANSFER-PROGRAM      16420000
174000                                                                  16430000
174100     EXEC CICS                                                    16440000
174200         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    16450000
174300               COMMAREA  (CA-COMMAREA)                            16460000
174400               LENGTH    (PV-COMMAREA-LENGTH)                     16470000
174500               RESP      (PV-CICS-RESPONSE)                       16480000
174600     END-EXEC.                                                    16490000
174700                                                                  16500000
174800     EVALUATE TRUE                                                16510000
174900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16520000
175000             CONTINUE                                             16530000
175100         WHEN OTHER                                               16540000
175200             MOVE '8200-XCTL'                                     16550000
175300                                      TO DP013-PARAGRAPH          16560000
175400             MOVE 'PCKRF876 - UNABLE TO XCTL TO PROGRAM: '        16570000
175500                                      TO DP013-MESSAGE-TEXT (1)   16580000
175600             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   16590000
175700             SET DP013-CICS-ABEND                                 16600000
175800                 DP013-ROLLBACK       TO TRUE                     16610000
175900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               16620000
176000             MOVE PC-TRANS-UNAVAILABLE-MSG                        16630000
176100                                      TO AMSGLNO                  16640000
176200             SET PC233-PROCESS-SCREEN TO TRUE                     16650000
176300             MOVE -1                  TO ADOORL                   16660000
176400             PERFORM 8000-SEND-MAP                                16670000
176500             PERFORM 8100-RETURN-TRANID                           16680000
176600     END-EVALUATE.                                                16690000
176700                                                                  16700003
176800 8211-SETUP-MSG-37.                                               16710003
176900     MOVE PC233-DOOR-ID               TO PC233-ERROR-DOOR-NBR     16720003
177000     MOVE PC233-SERIAL-NBR            TO PC233-ERROR-SRL-NBR      16730003
177100     MOVE PC233-TRIP-ID               TO PC233-ERROR-TRIP-ID      16740003
177200     MOVE PC233-STR-NBR               TO PC233-ERROR-STR-NBR      16750003
177300                                                                  16760003
177400     INITIALIZE PC047-COMMAREA                                    16770003
177500     SET PC047-BOTH-TOTAL             TO TRUE                     16780003
177600     MOVE PC233-TRIP-ID               TO PC047-OTBND-TRIP-ID      16790003
177700     MOVE PC233-DOOR-TYPE-CDE         TO PC047-DOOR-TYPE-CDE      16800003
177800     MOVE PC233-STR-NBR               TO PC047-DEST-OPER-UNT-ID   16810003
177900                                                                  16820003
178000     PERFORM 8050-LINK                                            16830003
178100     IF PC047-SUCCESSFUL                                          16840003
178200         MOVE PC233-STR-NBR           TO PC233-ERROR-STR-NBR      16850003
178300         MOVE PC047-TOTAL-CTN-COUNT   TO PC233-TOT-CARTONS        16860003
178400         ADD PC047-MISDIRECT-COUNT PC047-NO-DATA-COUNT            16870003
178500                    GIVING PC233-TOT-ERROR-CARTONS                16880003
178600     ELSE                                                         16890003
178700         MOVE 1                       TO PV-ERROR-NBR             16900003
178800                                         PC233-ERROR-NBR          16910003
178900         PERFORM 9903-WRITE-CICS-LOG                              16920003
179000         MOVE '2000-PROCESS-SCREEN-FIELDS'                        16930003
179100                                      TO PC233-PARAGRAPH          16940003
179200         MOVE 'PCKRF743 - CALL TRAILER SUBPROGRAM'                16950003
179300                                      TO PC233-MESSAGE-TEXT(1)    16960003
179400         MOVE SQLCA                   TO PC233-SQLCA              16970003
179500         SET PC233-ABEND              TO TRUE                     16980003
179600         MOVE 99                      TO PC233-PGM-MSG-NBR        16990003
179700         PERFORM 8210-XCTL-ERROR-SCREEN                           17000003
179800     END-IF.                                                      17000103
179900                                                                  17000200
180000 8212-MSG-48.                                                     16710003
180100     EXEC SQL                                                             
180200         SELECT                                                           
180300             SUBSTR(CHAR(CURRENT TIMESTAMP),12,15)                        
180400         INTO                                                             
180500             :PV-MSG-TIME-48                                      00820000
180600         FROM SYSIBM.SYSDUMMY1                                            
180700     END-EXEC                                                             
180800                                                                          
180900     MOVE PC233-OPER-UNT-ID           TO PV-LOC-48                00860000
181000     MOVE PC233-DOOR-ID               TO PV-DOOR-48               00950000
181100                                         PC233-ERROR-DOOR-NBR             
181200     MOVE PC233-SERIAL-NBR            TO PV-SERIAL-48             00950000
181300                                         PC233-ERROR-SRL-NBR              
181400                                                                          
181500     MOVE PC233-USER-ID               TO PV-USER-ID-48            00860000
181600                                                                          
181700     EVALUATE TRUE                                                        
181800     WHEN EIBAID = DFHENTER                                               
181900         MOVE 'E'                     TO PV-FKEY-48                       
182000     WHEN EIBAID = DFHCLEAR                                               
182100         MOVE 'C'                     TO PV-FKEY-48                       
182200     WHEN OTHER                                                           
182300        MOVE EIBAID                   TO PV-FKEY-48               00860000
182400     END-EVALUATE                                                         
182500                                                                          
182600     MOVE PC233-STR-NBR               TO PV-DEST-48               00860000
182700                                                                          
182800     MOVE PC233-OWNER-SCAC-ID         TO PV-SCAC-48               00860000
182900                                                                          
183000     MOVE PC233-LAST-PROGRAM          TO PV-LAST-PGM-48           00860000
183100                                                                  16820003
183200     MOVE 48                          TO PV-ERROR-NBR             16900003
183300                                         PC233-ERROR-NBR          16910003
183400                                         PC233-PGM-MSG-NBR        16910003
183500                                                                  16920003
183600     PERFORM 9948-WRITE-CICS-LOG                                  17140000
183700     PERFORM 8210-XCTL-ERROR-SCREEN.                              17000003
183800                                                                  17000103
183900                                                                  17000200
184000*                                                                 17000300
184100 8220-XCTL-TO-HELP.                                               17000400
184200                                                                  17000500
184300     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       17000600
184400                                                                  17000700
184500     EXEC CICS                                                    17000800
184600         XCTL                                                     17000900
184700             PROGRAM   (PV-TRANSFER-PROGRAM)                      17001000
184800             COMMAREA  (PC192-COMMAREA)                           17001100
184900             LENGTH    (PV-COMMAREA-LENGTH)                       17001200
185000             RESP      (PV-CICS-RESPONSE)                         17001300
185100     END-EXEC.                                                    17001400
185200                                                                  17001500
185300     EVALUATE TRUE                                                17001600
185400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 17001700
185500              CONTINUE                                            17001800
185600         WHEN OTHER                                               17001900
185700             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          17002000
185800             MOVE 'PCKRF876 - UNABLE TO XCTL TO PROGRAM: '        17002100
185900                                      TO DP013-MESSAGE-TEXT (1)   17002200
186000             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   17002300
186100             SET DP013-CICS-ABEND                                 17002400
186200                 DP013-ROLLBACK       TO TRUE                     17002500
186300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               17002600
186400             MOVE PC-TRANS-UNAVAILABLE-MSG                        17002700
186500                                      TO AMSGLNO                  17002800
186600             SET PC233-PROCESS-SCREEN TO TRUE                     17002900
186700             MOVE -1                  TO ADOORL                   17003000
186800             PERFORM 8000-SEND-MAP                                17003100
186900             PERFORM 8100-RETURN-TRANID                           17003200
187000     END-EVALUATE.                                                17010000
187100*                                                                 17010104
187200*8300-START-SUKCS574.                                             17010211
187300*DMH                                                              17010311
187400*DMH INITIALIZE PC047-COMMAREA.                                   17010911
187500*DMH MOVE PC233-OPER-UNT-ID           TO PC047-OPER-UNT-ID.       17011011
187600*DMH MOVE PC233-DOOR-ID               TO PC047-DOOR-ID.           17011111
187700*DMH MOVE PC233-STR-NBR               TO PC047-DEST-OPER-UNT-ID.  17011211
187800*DMH MOVE PC233-TRIP-ID               TO PC047-OTBND-TRIP-ID.     17011311
187900*DMH MOVE PC233-DOOR-TYPE-CDE         TO PC047-DOOR-TYPE-CDE.     17011411
188000*DMH                                                              17011911
188100*DMH MOVE LENGTH OF PC047-COMMAREA    TO PV-COMMAREA-LENGTH.      17012011
188200*DMH                                                              17012511
188300*DMH                                                              17012811
188400*DMH EXEC CICS                                                    17012911
188500*DMH     START                                                    17013011
188600*DMH         TRANSID   ('S574')                                   17013111
188700*DMH         FROM      (PC047-COMMAREA)                           17013211
188800*DMH         LENGTH    (PV-COMMAREA-LENGTH)                       17014011
188900*DMH END-EXEC.                                                    17016011
189000                                                                  17017004
189100/                                                                 17021000
189200 9000-SOFT-ABORT.                                                 17030000
189300                                                                  17040000
189400     EXEC CICS                                                    17050000
189500         SYNCPOINT ROLLBACK                                       17060000
189600     END-EXEC                                                     17070000
189700                                                                  17080000
189800     MOVE 1                           TO PC233-PGM-MSG-NBR        17090000
189900     MOVE SQLCODE                     TO PC233-SQLCODE            17100000
190000     PERFORM 8210-XCTL-ERROR-SCREEN.                              17110000
190100                                                                  17120000
190200                                                                  17130000
190300 9903-WRITE-CICS-LOG.                                             17140000
190400                                                                  17150000
190500     MOVE SQLCODE                     TO PV-SQLCODE               17160000
190600     MOVE PC233-DOOR-ID               TO PV-DISPLAY-DOOR          17170000
190700     MOVE PC233-USER-ID               TO PV-USER-ID               17180000
190800                                                                  17190000
190900     EXEC CICS                                                    17200000
191000         WRITEQ TD                                                17210000
191100             QUEUE  ('CSSL')                                      17220000
191200             FROM   (PV-LOG-MSG)                                  17230000
191300             RESP   (PV-CICS-RESPONSE)                            17240000
191400     END-EXEC.                                                    17250000
191500                                                                  17260000
191600 9948-WRITE-CICS-LOG.                                             17140000
191700                                                                  17150000
191800     EXEC CICS                                                    17200000
191900         WRITEQ TD                                                17210000
192000             QUEUE  ('CSSL')                                      17220000
192100             FROM   (PV-MSG-48)                                   17230000
192200             RESP   (PV-CICS-RESPONSE)                            17240000
192300     END-EXEC.                                                    17250000
192400                                                                  17260000
192500 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  17270000
192600                                                                  17280000
192700     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           17290000
192800     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          17300000
192900     INITIALIZE DP013-SRC-TASK-NUMBER                             17310000
193000                DP013-STACK.                                      17320000
193100     SET DP013-LINK-RETURN            TO TRUE.                    17330000
193200                                                                  17340000
193300     EXEC CICS                                                    17350000
193400         LINK                                                     17360000
193500             PROGRAM   (DP013-NAME)                               17370000
193600             COMMAREA  (DP013-PARAMETERS)                         17380000
193700             LENGTH    (DP013-LENGTH)                             17390000
193800     END-EXEC.                                                    17400000
