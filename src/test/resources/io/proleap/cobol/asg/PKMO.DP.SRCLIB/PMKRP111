000100*----------------------------------------------------------       00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300*----------------------------------------------------------       00030002
000400 PROGRAM-ID.             PMKRP111.                                00040002
000500 AUTHOR.                 ALEXIS KEIKER.                           00050002
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060002
000700 DATE-WRITTEN.           APRIL 2003.                              00070002
000800 DATE-COMPILED.                                                   00080002
000900*----------------------------------------------------------       00090002
001000*   PMKRP111 - PROMOTION SUMMARY - DMM TOTALS BY PAGE             00100002
001010*----------------------------------------------------------       00101002
001020* THIS PROGRAM WILL PRODUCE AN ACTUAL/FORECAST REPORT.            00102022
001021* THIS PROGRAM USES TWO INPUT FILES THAT WERE GENERATED           00102122
001022* IN PMKUT100 AND THEN SORTED AND SUMMED DIFFERENTLY TO           00102222
001023* CREATE TWO DIFFERENT FILES FOR THIS PROGRAM.  THE FIRST         00102322
001024* FILE HAS PROMOTION SUMS BY DMMS UNDER THEIR CORRESPONDING       00102422
001025* GMMS.  EACH DMM HAS A RECORD WITH TOTALS BY PAGE NUMBERS.       00102522
001026* THE SECOND INPUT FILE IS SORTED AND SUMMED BY GMM NUMBER        00102622
001027* AND THEN ADVERTISED INDICATOR FOR EACH PROMOTION.  THIS         00102722
001028* FILE IS USED FOR THE TOTALS PART AT THE END OF EACH             00102822
001029* REPORTING SECTION PER PROMOTION.  THE REPORT IS BROKEN          00102922
001030* BY AD EVENT, PROMOTION, AND GMM NUMBER.                         00103022
001031*----------------------------------------------------------       00103102
001032* HISTORY LOG:                                                    00103202
001033*----------------------------------------------------------       00103302
PGNBR * DATE: 07/25/2014                                                00103434
PGNBR * WR/IR#: PRB 47935                                               00103534
PGNBR * PROGRAMMER: COGNIZANT                                           00103634
PGNBR * DESCRIPTION:MODIFIED THE CODE TO HANDLE ADVERTISED PROMO ITEMS  00103734
PGNBR *             WITH NO PAGE NUMBER.                                00103834
001038*                                                                 00103902
001039*----------------------------------------------------------       00104002
001040 ENVIRONMENT DIVISION.                                            00104102
001050*----------------------------------------------------------       00105002
001060 CONFIGURATION SECTION.                                           00106002
001070 SOURCE-COMPUTER. IBM-3090.                                       00107002
001080 OBJECT-COMPUTER. IBM-3090.                                       00108002
001090                                                                  00109002
001100 INPUT-OUTPUT SECTION.                                            00110002
001200                                                                  00120002
001300 FILE-CONTROL.                                                    00130002
001400                                                                  00140002
001500     SELECT PROMO-SUMM-DMM-FILE                                   00150003
001600            ASSIGN TO INP01.                                      00160002
001700                                                                  00170002
001710     SELECT PROMO-SUMM-GMM-FILE                                   00171003
001720            ASSIGN TO INP02.                                      00172003
001730                                                                  00173003
001830     SELECT PROMO-SUMM-REPORT                                     00183002
001840            ASSIGN TO RPT01.                                      00184002
001850                                                                  00185002
001860*----------------------------------------------------------       00186002
001870 DATA DIVISION.                                                   00187002
001880*----------------------------------------------------------       00188002
001890 FILE SECTION.                                                    00189002
001900                                                                  00190002
002000 FD  PROMO-SUMM-DMM-FILE                                          00200003
002100     RECORDING MODE F                                             00210002
002200     BLOCK CONTAINS 0 RECORDS                                     00220002
002300     LABEL RECORDS ARE OMITTED.                                   00230002
002400 01  PROMO-SUMM-DMM-RECORD            PIC X(750).                 00240003
002500                                                                  00250002
002510 FD  PROMO-SUMM-GMM-FILE                                          00251003
002520     RECORDING MODE F                                             00252003
002530     BLOCK CONTAINS 0 RECORDS                                     00253003
002540     LABEL RECORDS ARE OMITTED.                                   00254003
002550 01  PROMO-SUMM-GMM-RECORD            PIC X(750).                 00255003
002560                                                                  00256003
003200 FD  PROMO-SUMM-REPORT                                            00320002
003300     RECORDING MODE F                                             00330002
003400     BLOCK CONTAINS 0 RECORDS                                     00340002
003500     LABEL RECORDS ARE OMITTED.                                   00350002
003600 01  PROMO-SUMM-RPT-LINE              PIC X(200).                 00360002
003700                                                                  00370002
003800 WORKING-STORAGE SECTION.                                         00380002
003900*----------------------------------------------------------       00390002
004000* CD- CONTROL DATES (DATES ACCEPTED INTO THE PROGRAM)             00400002
004100*----------------------------------------------------------       00410002
004200 01  CD-CONTROL-DATES.                                            00420002
004300     05  CD-CPU-DATE.                                             00430002
004400         10  CD-CPU-YR                PIC 9(02)  VALUE ZEROES.    00440002
004500         10  CD-CPU-MO                PIC 9(02)  VALUE ZEROES.    00450002
004510         10  CD-CPU-DY                PIC 9(02)  VALUE ZEROES.    00451002
004520                                                                  00452002
004530     05  CD-CPU-DATE-GREG.                                        00453002
004540         10  CD-CPU-MM                PIC 9(02)  VALUE ZEROES.    00454002
004550         10  CD-CPU-DD                PIC 9(02)  VALUE ZEROES.    00455002
004560         10  CD-CPU-YY                PIC 9(02)  VALUE ZEROES.    00456002
004570                                                                  00457002
004580     05  CD-CPU-DATE-ISO              PIC X(10)  VALUE SPACES.    00458002
004590                                                                  00459002
004591*----------------------------------------------------------       00459102
004592* CT- CONTROL TIMES (TIMES ACCEPTED INTO THE PROGRAM)             00459202
004593*----------------------------------------------------------       00459302
004594 01  CT-CONTROL-TIMES.                                            00459402
004595     05  CT-CPU-TIME.                                             00459502
004596         10  CT-CPU-HR                PIC 9(02)  VALUE ZEROES.    00459602
004597         10  CT-CPU-MIN               PIC 9(02)  VALUE ZEROES.    00459702
004598         10  CT-CPU-SEC               PIC 9(02)  VALUE ZEROES.    00459802
004599         10  CT-CPU-HSEC              PIC 9(02)  VALUE ZEROES.    00459902
004600                                                                  00460002
004601*----------------------------------------------------------       00460102
004602* PC- PROGRAM CONSTANTS                                           00460202
004603*----------------------------------------------------------       00460302
004604 01  PC-PROGRAM-CONSTANTS.                                        00460402
004605     05  PC-MAX-LINE-CNT              PIC S9(04) VALUE +78 COMP.  00460502
004606     05  PC-SUB-1                     PIC 9(01)  VALUE 1.         00460602
004607     05  PC-SUB-2                     PIC 9(01)  VALUE 2.         00460702
004608     05  PC-DEFAULT-BEG-HR            PIC 9(02)  VALUE 0.         00460802
004609     05  PC-DEFAULT-BEG-MIN           PIC 9(02)  VALUE 0.         00460902
004610     05  PC-DEFAULT-END-HR            PIC 9(02)  VALUE 23.        00461002
004620     05  PC-DEFAULT-END-MIN           PIC 9(02)  VALUE 59.        00462002
004630     05  PC-CHAR-BUY                  PIC X(03)  VALUE 'BUY'.     00463002
004640     05  PC-CHAR-GET                  PIC X(03)  VALUE 'GET'.     00464002
004650     05  PC-CHAR-OFF                  PIC X(03)  VALUE 'OFF'.     00465002
004660     05  PC-CHAR-EFFECTIVE            PIC X(09)  VALUE            00466002
004670                                          'EFFECTIVE'.            00467002
004680     05  PC-FORECAST-RSLT             PIC X(36)  VALUE            00468002
004690         'FORECAST ONLY RESULTS (IN THOUSANDS)'.                  00469002
004700     05  PC-ACTUAL-RSLT               PIC X(36)  VALUE            00470002
004800         'ACTUAL RESULTS (IN THOUSANDS)       '.                  00480002
004900     05  PC-PERCENT-SIGN              PIC X(01)  VALUE '%'.       00490002
004910     05  PC-DOLLAR-SIGN               PIC X(01)  VALUE '$'.       00491002
004920     05  PC-FRONT-PAR                 PIC X(01)  VALUE '('.       00492002
004930     05  PC-BACK-PAR                  PIC X(01)  VALUE ')'.       00493002
004940     05  PC-ONE-LINE                  PIC S9(04) VALUE +1 COMP.   00494002
004950     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE            00495002
004960                                                 'PMKRP111'.      00496004
004970     05  PC-COLON                     PIC X(01)  VALUE ':'.       00497002
004980     05  PC-DASH                      PIC X(01)  VALUE '-'.       00498002
004990     05  PC-ALL-DAY                   PIC X(07)  VALUE            00499002
005000                                                 'ALL DAY'.       00500002
005100     05  PC-TOTAL                     PIC X(05)  VALUE            00510002
005200          'TOTAL'.                                                00520002
005300     05  PC-UNADVERTISED              PIC X(04)  VALUE            00530002
005400          'UNAD'.                                                 00540002
005410     05  PC-ADVERTISED                PIC X(03)  VALUE            00541002
005420          'ADV'.                                                  00542002
PGNBR      05  PC-ADVNOPAGE                 PIC X(04)  VALUE            00542134
PGNBR           'NOPG'.                                                 00542234
005430     05  PC-PROMO-TOTAL               PIC X(18)  VALUE            00543002
005440          'PROMOTION TOTAL   '.                                   00544002
005441     05  PC-PROMOTION                 PIC X(10)  VALUE            00544104
005442          'PROMOTION '.                                           00544204
005450     05  PC-ADV-TOTAL                 PIC X(18)  VALUE            00545003
005460          'TOTAL ADV         '.                                   00546003
005461     05  PC-UNAD-TOTAL                PIC X(18)  VALUE            00546103
005462          'TOTAL UNAD        '.                                   00546203
005470                                                                  00547002
005480*----------------------------------------------------------       00548002
005490* PS- PROGRAM SWITCHES                                            00549002
005500*----------------------------------------------------------       00550002
005600 01  PS-PROGRAM-SWITCHES.                                         00560002
005910     05  PS-EOF-SLS-DMA-RSLTS-SW      PIC X(01)  VALUE 'Y'.       00591006
005920         88  PS-EOF-SLS-DMA-RSLTS                VALUE 'N'.       00592006
005930         88  PS-NOT-EOF-SLS-DMA-RSLT             VALUE 'Y'.       00593006
005940     05  PS-EOF-SLS-GMA-RSLTS-SW      PIC X(01)  VALUE 'Y'.       00594006
005950         88  PS-EOF-SLS-GMA-RSLTS                VALUE 'N'.       00595006
005960         88  PS-NOT-EOF-SLS-GMA-RSLTS            VALUE 'Y'.       00596006
006000     05  PS-FIRST-TIME-SW             PIC X(01)  VALUE 'Y'.       00600002
006100         88  PS-NOT-FIRST-TIME                   VALUE 'N'.       00610002
006200         88  PS-FIRST-TIME                       VALUE 'Y'.       00620002
006300     05  PS-FIRST-TIME-GMM-SW         PIC X(01)  VALUE 'Y'.       00630005
006400         88  PS-NOT-FIRST-TIME-GMM               VALUE 'N'.       00640006
006500         88  PS-FIRST-TIME-GMM                   VALUE 'Y'.       00650005
006600     05  PS-DMA-RESULTS-SW            PIC X(01)  VALUE 'Y'.       00660005
006700         88  PS-GMA-RESULTS                      VALUE 'N'.       00670005
006800         88  PS-DMA-RESULTS                      VALUE 'Y'.       00680005
006900     05  PS-GMA-NBR-FOUND-SW          PIC X(01)  VALUE 'Y'.       00690002
007000         88  PS-GMA-NBR-FOUND                    VALUE 'N'.       00700002
007100         88  PS-GMA-NBR-NOT-FOUND                VALUE 'Y'.       00710002
007200     05  PS-FIRST-LINE-SW             PIC X(01)  VALUE 'Y'.       00720002
007300         88  PS-FIRST-LINE                       VALUE 'N'.       00730002
007400         88  PS-NO-FIRST-LINE                    VALUE 'Y'.       00740002
007410     05  PS-FIRST-LINE-GMM-SW         PIC X(01)  VALUE 'Y'.       00741005
007420         88  PS-FIRST-LINE-GMM                   VALUE 'N'.       00742005
007430         88  PS-NO-FIRST-LINE-GMM                VALUE 'Y'.       00743005
007500     05  PS-WROTE-ADV-TTL-SW          PIC X(01)  VALUE 'Y'.       00750002
007600         88  PS-WROTE-ADV-TTL                    VALUE 'N'.       00760002
007700         88  PS-NO-WROTE-ADV-TTL                 VALUE 'Y'.       00770002
007710     05  PS-FIRST-GMA-READ-SW         PIC X(01)  VALUE 'Y'.       00771006
007720         88  PS-NOT-FIRST-GMA-READ               VALUE 'N'.       00772006
007730         88  PS-FIRST-GMA-READ                   VALUE 'Y'.       00773006
007740     05  PS-TOTALS-SW                 PIC X(01)  VALUE 'Y'.       00774006
007750         88  PS-TOTALS                           VALUE 'N'.       00775006
007760         88  PS-NO-TOTALS                        VALUE 'Y'.       00776006
007800                                                                  00780002
007900*----------------------------------------------------------       00790002
008000* PV- PROGRAM VARIABLES                                           00800002
008100*----------------------------------------------------------       00810002
008200 01  PV-PROGRAM-VARIABLES.                                        00820002
008300     05  PV-ADVANCE-LINES             PIC S9(04) VALUE +1 COMP.   00830002
008400     05  PV-LINE-CNT                  PIC S9(04) VALUE +0 COMP.   00840002
008500     05  PV-PAGE-CNT                  PIC 9(05)  VALUE 0.         00850002
008600     05  PV-PARAGRAPH-NAME            PIC X(30)  VALUE SPACE.     00860002
008700     05  PV-OPERATION-MSG-1           PIC X(40)  VALUE SPACES.    00870002
008800     05  PV-OPERATION-MSG-2           PIC X(40)  VALUE SPACES.    00880002
008900     05  PV-SAVE-VAR                  PIC X(40)  VALUE SPACES.    00890002
009000     05  PV-SAVE-NUM                  PIC 9(02)  VALUE 0.         00900002
009100     05  PV-SAVE-LENGTH               PIC 9(02)  VALUE 0.         00910002
009200     05  PV-SUBSCRIPT                 PIC 9(02)  VALUE 0.         00920002
009300     05  PV-PROMO-NM-LENGTH           PIC 9(02)  VALUE 0.         00930002
009400     05  PV-AD-EVNT-NM-LENGTH         PIC 9(02)  VALUE 0.         00940002
009500     05  PV-AD-EVNT-NBR-LENGTH        PIC 9(02)  VALUE 0.         00950002
009600     05  PV-GMM-LAST-NM-LENGTH        PIC 9(02)  VALUE 0.         00960002
009700     05  PV-SAVE-GMA-NAME             PIC X(40)  VALUE SPACES.    00970002
009710     05  PV-SAVE-GMA-LAST-NM          PIC X(40)  VALUE SPACES.    00971020
009800     05  PV-LAST-DMA-LAST-NM          PIC X(40)  VALUE SPACES.    00980002
009900     05  PV-SAVE-AD-EVNT-ID           PIC 9(10)  VALUE 0.         00990002
010000     05  PV-SAVE-PROMO-ID             PIC 9(10)  VALUE 0.         01000002
010100     05  PV-LAST-GMA-NBR              PIC 9(04)  VALUE 0.         01010002
010200     05  PV-LAST-DMA-NBR              PIC 9(04)  VALUE 0.         01020002
010210     05  PV-SAVE-LAST-NAME            PIC X(40)  VALUE SPACES.    01021012
010300     05  PV-PREV-GMA-NBR              PIC 9(04)  VALUE 0.         01030005
010400     05  PV-DMM-TITLE.                                            01040002
010500         10  PV-DMM-TOTAL-TITLE       PIC X(14)  VALUE SPACES.    01050002
010600         10  PV-DMM-LAST-NAME         PIC X(40)  VALUE SPACES.    01060002
010700                                                                  01070002
010800     05  PV-TIER-ITM-DESC.                                        01080002
010900         10  FILLER                   PIC X(01)  VALUE SPACES.    01090002
011000         10  PV-TIER-ITM-DESC-1       PIC X(39)  VALUE SPACES.    01100002
011100     05  PV-THRS-AMT-NUM              PIC 9(08)V9(02) VALUE 0.    01110002
011200     05  PV-THRS-AMT-NUM-X REDEFINES                              01120002
011300         PV-THRS-AMT-NUM              PIC 9(10).                  01130002
011400     05  PV-DISC-PCT-NUM              PIC 9(03)V9(03) VALUE 0.    01140002
011500     05  PV-DISC-PCT-NUM-X REDEFINES                              01150002
011600         PV-DISC-PCT-NUM              PIC 9(06).                  01160002
011700     05  PV-DISC-AMT-NUM              PIC 9(08)V9(02) VALUE 0.    01170002
011800     05  PV-DISC-AMT-NUM-X REDEFINES                              01180002
011900         PV-DISC-AMT-NUM              PIC 9(10).                  01190002
012000     05  PV-SAVE-THRS-AMT.                                        01200002
012100         10  PV-SAVE-THRS-AMT-1       PIC 9(08)  VALUE 0.         01210002
012200         10  PV-SAVE-THRS-AMT-2       PIC 9(02)  VALUE 0.         01220002
012300     05  PV-SAVE-DISC-PCT.                                        01230002
012400         10  PV-SAVE-DISC-PCT-1       PIC 9(03)  VALUE 0.         01240002
012500         10  PV-SAVE-DISC-PCT-2       PIC 9(03)  VALUE 0.         01250002
012600     05  PV-SAVE-DISC-AMT.                                        01260002
012700         10  PV-SAVE-DISC-AMT-1       PIC 9(08)  VALUE 0.         01270002
012800         10  PV-SAVE-DISC-AMT-2       PIC 9(02)  VALUE 0.         01280002
012900     05  PV-THRS-AMT-CHAR             PIC X(08)  VALUE SPACES.    01290002
013000     05  PV-DISC-PCT-CHAR             PIC X(03)  VALUE SPACES.    01300002
013100     05  PV-DISC-AMT-CHAR             PIC X(08)  VALUE SPACES.    01310002
013200     05  PV-THRS-QTY-CHAR             PIC X(05)  VALUE SPACES.    01320002
013300     05  PV-POINTER-FIELD             PIC S9(03) VALUE +0.        01330002
013400     05  PV-LAST-ADEVNT-ID            PIC 9(10)  VALUE 0.         01340002
013500     05  PV-LAST-PROMO-ID             PIC 9(10)  VALUE 0.         01350002
013600     05  PV-TIER-PRICG-ID             PIC 9(10)  VALUE 0.         01360002
013700     05  PV-AD-PG-NBR                 PIC 9(03)  VALUE 0.         01370002
013800     05  PV-ROUND-TO-WHOLE-DOLLARS    PIC S9(09) VALUE +0.        01380002
013900     05  PV-ROUND-TO-TENTHS           PIC S9(09)V9 VALUE +0.      01390002
014000     05  PV-ROUND-TO-HDRTHS           PIC S9(09)V99 VALUE +0.     01400002
014100     05  PV-ROUND-VOL-PCT             PIC 9(09)V9 VALUE 0.        01410002
014200     05  PV-TRUNCAT-VOL-PCT           PIC 9(04)V9 VALUE 0.        01420002
014300     05  PV-TRUNCAT-VOL-PCT-X REDEFINES                           01430002
014400         PV-TRUNCAT-VOL-PCT           PIC 9(05).                  01440002
014500     05  PV-NUM-VOL-PCT.                                          01450002
014600         10  PV-NUM-VOL-PCT-1         PIC 9(04)  VALUE 0.         01460002
014700         10  PV-NUM-VOL-PCT-2         PIC 9(01)  VALUE 0.         01470002
014800     05  PV-CHAR-VOL-PCT REDEFINES                                01480002
014900         PV-NUM-VOL-PCT.                                          01490002
015000         10  PV-CHAR-VOL-PCT-1        PIC X(04).                  01500002
015100         10  PV-CHAR-VOL-PCT-2        PIC X(01).                  01510002
015200     05  PV-FINAL-VOL-PCT.                                        01520002
015300         10  PV-FINAL-VOL-PCT-1       PIC X(01)  VALUE SPACES.    01530002
015400         10  PV-FINAL-VOL-PCT-2       PIC X(01)  VALUE SPACES.    01540002
015500         10  PV-FINAL-VOL-PCT-3       PIC X(01)  VALUE SPACES.    01550002
015600         10  PV-FINAL-VOL-PCT-4       PIC X(01)  VALUE SPACES.    01560002
015700         10  PV-FINAL-VOL-PCT-5       PIC X(01)  VALUE SPACES.    01570002
015800         10  FILLER                   PIC X(01)  VALUE '.'.       01580002
015900         10  PV-FINAL-VOL-PCT-6       PIC X(01)  VALUE SPACES.    01590002
016000         10  PV-FINAL-VOL-PCT-7       PIC X(01)  VALUE SPACES.    01600002
016100     05  PV-SEP-VOL-PCT.                                          01610002
016200         10  PV-SEP-VOL-PCT-1         PIC 9(01)  VALUE 0.         01620002
016300         10  PV-SEP-VOL-PCT-2         PIC 9(01)  VALUE 0.         01630002
016400         10  PV-SEP-VOL-PCT-3         PIC 9(01)  VALUE 0.         01640002
016500         10  PV-SEP-VOL-PCT-4         PIC 9(01)  VALUE 0.         01650002
016600         10  PV-SEP-VOL-PCT-5         PIC 9(01)  VALUE 0.         01660002
016700     05  PV-VOL-PCT-CHG               PIC S9(09)V9999 VALUE +0    01670002
016800                                                     COMP-3.      01680002
016900     05  PV-MU-PCT                    PIC S9(09)V9999 VALUE +0    01690002
017000                                                     COMP-3.      01700002
017100     05  PV-SELL-THRU-PCT             PIC S9(09)V9999 VALUE +0    01710002
017200                                                     COMP-3.      01720002
017300     05  PV-RPT-LINE                  PIC X(200) VALUE SPACES.    01730002
017400     05  PV-SAVE-RECORD               PIC X(750) VALUE SPACES.    01740002
017410     05  PV-SAVE-RECORD-2             PIC X(750) VALUE SPACES.    01741006
017500     05  PV-PROMO-STRT-TMST.                                      01750002
017600         10  PV-PROMO-STRT-DTE.                                   01760002
017700             15  PV-PM-STRT-DTE-CC    PIC X(02)  VALUE SPACES.    01770002
017800             15  PV-PM-STRT-DTE-YY    PIC X(02)  VALUE SPACES.    01780002
017900             15  FILLER               PIC X(01)  VALUE SPACES.    01790002
018000             15  PV-PM-STRT-DTE-MM    PIC X(02)  VALUE SPACES.    01800002
018100             15  FILLER               PIC X(01)  VALUE SPACES.    01810002
018110             15  PV-PM-STRT-DTE-DD    PIC X(02)  VALUE SPACES.    01811002
018120         10  FILLER                   PIC X(01)  VALUE SPACES.    01812002
018130         10  PV-PROMO-STRT-TM.                                    01813002
018140             15  PV-PM-STRT-TM-HH     PIC X(02)  VALUE SPACES.    01814002
018150             15  FILLER               PIC X(01)  VALUE SPACES.    01815002
018160             15  PV-PM-STRT-TM-MM     PIC X(02)  VALUE SPACES.    01816002
018170             15  FILLER               PIC X(01)  VALUE SPACES.    01817002
018180             15  PV-PM-STRT-TM-SS     PIC X(02)  VALUE SPACES.    01818002
018190                                                                  01819002
018200     05  PV-PROMO-END-TMST.                                       01820002
018210         10  PV-PROMO-END-DTE.                                    01821002
018220             15  PV-PM-END-DTE-CC     PIC X(02)  VALUE SPACES.    01822002
018230             15  PV-PM-END-DTE-YY     PIC X(02)  VALUE SPACES.    01823002
018240             15  FILLER               PIC X(01)  VALUE SPACES.    01824002
018250             15  PV-PM-END-DTE-MM     PIC X(02)  VALUE SPACES.    01825002
018260             15  FILLER               PIC X(01)  VALUE SPACES.    01826002
018270             15  PV-PM-END-DTE-DD     PIC X(02)  VALUE SPACES.    01827002
018280         10  FILLER                   PIC X(01)  VALUE SPACES.    01828002
018290         10  PV-PROMO-END-TM.                                     01829002
018300             15  PV-PM-END-TM-HH      PIC X(02)  VALUE SPACES.    01830002
018400             15  FILLER               PIC X(01)  VALUE SPACES.    01840002
018500             15  PV-PM-END-TM-MM      PIC X(02)  VALUE SPACES.    01850002
018600             15  FILLER               PIC X(01)  VALUE SPACES.    01860002
018700             15  PV-PM-END-TM-SS      PIC X(02)  VALUE SPACES.    01870002
018800                                                                  01880002
018900     05  PV-PROMO-ITM-STRT-TMST.                                  01890002
019000         10  PV-PROMO-ITM-STRT-DTE.                               01900002
019100             15  PV-PI-STRT-DTE-CC    PIC X(02)  VALUE SPACES.    01910002
019200             15  PV-PI-STRT-DTE-YY    PIC X(02)  VALUE SPACES.    01920002
019300             15  FILLER               PIC X(01)  VALUE SPACES.    01930002
019400             15  PV-PI-STRT-DTE-MM    PIC X(02)  VALUE SPACES.    01940002
019500             15  FILLER               PIC X(01)  VALUE SPACES.    01950002
019600             15  PV-PI-STRT-DTE-DD    PIC X(02)  VALUE SPACES.    01960002
019700         10  FILLER                   PIC X(01)  VALUE SPACES.    01970002
019800         10  PV-PROMO-ITM-STRT-TM.                                01980002
019900             15  PV-PI-STRT-TM-HH     PIC X(02)  VALUE SPACES.    01990002
020000             15  FILLER               PIC X(01)  VALUE SPACES.    02000002
020100             15  PV-PI-STRT-TM-MM     PIC X(02)  VALUE SPACES.    02010002
020200             15  FILLER               PIC X(01)  VALUE SPACES.    02020002
020300             15  PV-PI-STRT-TM-SS     PIC X(02)  VALUE SPACES.    02030002
020400                                                                  02040002
020500     05  PV-PROMO-ITM-END-TMST.                                   02050002
020600         10  PV-PROMO-ITM-END-DTE.                                02060002
020700             15  PV-PI-END-DTE-CC     PIC X(02)  VALUE SPACES.    02070002
020800             15  PV-PI-END-DTE-YY     PIC X(02)  VALUE SPACES.    02080002
020900             15  FILLER               PIC X(01)  VALUE SPACES.    02090002
021000             15  PV-PI-END-DTE-MM     PIC X(02)  VALUE SPACES.    02100002
021100             15  FILLER               PIC X(01)  VALUE SPACES.    02110002
021200             15  PV-PI-END-DTE-DD     PIC X(02)  VALUE SPACES.    02120002
021300         10  FILLER                   PIC X(01)  VALUE SPACES.    02130002
021400         10  PV-PROMO-ITM-END-TM.                                 02140002
021500             15  PV-PI-END-TM-HH      PIC X(02)  VALUE SPACES.    02150002
021600             15  FILLER               PIC X(01)  VALUE SPACES.    02160002
021700             15  PV-PI-END-TM-MM      PIC X(02)  VALUE SPACES.    02170002
021800             15  FILLER               PIC X(01)  VALUE SPACES.    02180002
021900             15  PV-PI-END-TM-SS      PIC X(02)  VALUE SPACES.    02190002
022000                                                                  02200002
022010     05  PV-PM-ITM-EFF-STRT-DTE.                                  02201002
022020         10  PV-EFF-STRT-DTE-MM       PIC X(02)  VALUE SPACES.    02202002
022030         10  FILLER                   PIC X(01)  VALUE '/'.       02203002
022040         10  PV-EFF-STRT-DTE-DD       PIC X(02)  VALUE SPACES.    02204002
022050         10  FILLER                   PIC X(01)  VALUE '/'.       02205002
022060         10  PV-EFF-STRT-DTE-YY       PIC X(02)  VALUE SPACES.    02206002
022070                                                                  02207002
022080     05  PV-PM-ITM-EFF-END-DTE.                                   02208002
022090         10  PV-EFF-END-DTE-MM        PIC X(02)  VALUE SPACES.    02209002
022091         10  FILLER                   PIC X(01)  VALUE '/'.       02209102
022092         10  PV-EFF-END-DTE-DD        PIC X(02)  VALUE SPACES.    02209202
022093         10  FILLER                   PIC X(01)  VALUE '/'.       02209302
022094         10  PV-EFF-END-DTE-YY        PIC X(02)  VALUE SPACES.    02209402
022095                                                                  02209502
022096     05  PV-EFF-DTE-LAYOUT.                                       02209602
022097         10  FILLER                   PIC X(02)  VALUE SPACES.    02209702
022098         10  PV-OPEN-PARENTH          PIC X(01)  VALUE SPACES.    02209802
022099         10  PV-EFF-STRT-DTE          PIC X(08)  VALUE SPACES.    02209902
022100         10  PV-DTE-DASH              PIC X(01)  VALUE SPACES.    02210002
022101         10  PV-EFF-END-DTE           PIC X(08)  VALUE SPACES.    02210102
022102         10  PV-CLOSE-PARENTH         PIC X(01)  VALUE SPACES.    02210202
022103                                                                  02210302
022104     05  PV-VARIABLE-OUTPUT-FIELD.                                02210402
022105         10  PV-BIT-VARIABLE          PIC X(01)  VALUE SPACES     02210502
022106                                       OCCURS 41 TIMES            02210602
022107                                       INDEXED BY                 02210702
022108                                       PV-BIT-IDX.                02210802
022109                                                                  02210902
022110     05  PV-HEADER-DTE-TM.                                        02211002
022120         10  PV-BEG-DAY-ALPHA         PIC X(10).                  02212002
022121         10  PV-BEG-DATE              PIC X(08).                  02212102
022122         10  FILLER                   PIC X(02)  VALUE SPACES.    02212202
022123         10  PV-BEG-TIME.                                         02212302
022124             15  PV-BEG-HR-TIME       PIC 9(02).                  02212402
022125             15  PV-BEG-TIME-COLON    PIC X(01).                  02212502
022126             15  PV-BEG-MIN-TIME      PIC 9(02).                  02212602
022127             15  FILLER               PIC X(02)  VALUE SPACES.    02212702
022128         10  FILLER                   PIC X(11)  VALUE            02212802
022129                                      '   THROUGH '.              02212902
022130         10  PV-END-DAY-ALPHA         PIC X(10).                  02213002
022131         10  PV-END-DATE              PIC X(08).                  02213102
022132         10  FILLER                   PIC X(02)  VALUE SPACES.    02213202
022133         10  PV-END-TIME.                                         02213302
022134             15  PV-END-HR-TIME       PIC 9(02).                  02213402
022135             15  PV-END-TIME-COLON    PIC X(01).                  02213502
022136             15  PV-END-MIN-TIME      PIC 9(02).                  02213602
022137             15  FILLER               PIC X(02).                  02213702
022138         10  FILLER                   PIC X(22)  VALUE SPACES.    02213802
022139                                                                  02213902
022140*----------------------------------------------------------       02214002
022141* PA- PROGRAM ACCUMULATORS                                        02214102
022142*----------------------------------------------------------       02214202
022143 01  PA-PROGRAM-ACCUMULATORS.                                     02214302
022144     05  PA-CNT-ADV-TOT               PIC 9(09)  VALUE ZEROES.    02214402
022145     05  PA-CNT-UNADV-TOT             PIC 9(09)  VALUE ZEROES.    02214502
022146     05  PA-CNT-SPACES-1              PIC 9(09)  VALUE ZEROES.    02214602
022147     05  PA-CNT-POS-1                 PIC 9(09)  VALUE ZEROES.    02214702
022148     05  PA-CNT-SPACES-2              PIC 9(09)  VALUE ZEROES.    02214802
022149     05  PA-CNT-SPACES                PIC 9(09)  VALUE ZEROES.    02214902
022150     05  PA-CNT-POS-2                 PIC 9(09)  VALUE ZEROES.    02215002
022151     05  PA-CNT-GMA                   PIC S9(04) VALUE +0.        02215102
022152     05  PA-HOLD-INDEX                PIC S9(04) VALUE +0.        02215202
022153     05  PA-CNT-NEW-INDX              PIC S9(04) VALUE +0.        02215302
022154                                                                  02215402
022155*----------------------------------------------------------       02215502
022156* TBL- TABLE VARIABLES                                            02215602
022157*----------------------------------------------------------       02215702
022158* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  02215802
022159*    OCCURRENCE CONTAINS FORECAST FIGURES                         02215902
022160 01  TBL-SECT-TOTAL-TABLE.                                        02216002
022170     05  TBL-STOT-LINE-01 OCCURS 02 TIMES                         02217002
022180                           INDEXED BY TBL-STOT-INDX.              02218002
022190         10  TBL-STOT-TOT-SALE-AMT    PIC S9(09)V9(02) COMP-3.    02219002
022200         10  TBL-STOT-TOT-MD-AMT      PIC S9(09)V9(02) COMP-3.    02220002
022300         10  TBL-STOT-TOT-SLS-UNT-QTY                             02230002
022400                                      PIC S9(09)V9(02) COMP-3.    02240002
022500         10  TBL-STOT-TOT-EOH-INV-QTY                             02250002
022600                                      PIC S9(09)V9(02) COMP-3.    02260002
022700         10  TBL-STOT-PREP-UNT-QTY    PIC S9(09)V9(02) COMP-3.    02270002
022800         10  TBL-STOT-TOT-SLS-COST-AMT                            02280002
022900                                      PIC S9(09)V9(02) COMP-3.    02290002
023000                                                                  02300002
023100* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  02310002
023200*    OCCURRENCE CONTAINS FORECAST FIGURES                         02320002
023300 01  TBL-ADV-TOTAL-TABLE.                                         02330002
023400     05  TBL-ATOT-LINE-01 OCCURS 02 TIMES                         02340002
023500                           INDEXED BY TBL-STOT-INDX.              02350002
023600         10  TBL-ATOT-TOT-SALE-AMT    PIC S9(09)V9(02) COMP-3.    02360002
023700         10  TBL-ATOT-TOT-MD-AMT      PIC S9(09)V9(02) COMP-3.    02370002
023710         10  TBL-ATOT-TOT-SLS-UNT-QTY                             02371002
023720                                      PIC S9(09)V9(02) COMP-3.    02372002
023730         10  TBL-ATOT-TOT-EOH-INV-QTY                             02373002
023740                                      PIC S9(09)V9(02) COMP-3.    02374002
023750         10  TBL-ATOT-PREP-UNT-QTY    PIC S9(09)V9(02) COMP-3.    02375002
023760         10  TBL-ATOT-TOT-SLS-COST-AMT                            02376002
023770                                      PIC S9(09)V9(02) COMP-3.    02377002
023780                                                                  02378002
023790* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  02379002
023791*    OCCURRENCE CONTAINS FORECAST FIGURES                         02379102
023792 01  TBL-UNAD-TOTAL-TABLE.                                        02379202
023793     05  TBL-UATOT-LINE-01 OCCURS 02 TIMES                        02379302
023794                           INDEXED BY TBL-STOT-INDX.              02379402
023795         10  TBL-UATOT-TOT-SALE-AMT   PIC S9(09)V9(02) COMP-3.    02379502
023796         10  TBL-UATOT-TOT-MD-AMT     PIC S9(09)V9(02) COMP-3.    02379602
023797         10  TBL-UATOT-TOT-SLS-UNT-QTY                            02379702
023798                                      PIC S9(09)V9(02) COMP-3.    02379802
023799         10  TBL-UATOT-TOT-EOH-INV-QTY                            02379902
023800                                      PIC S9(09)V9(02) COMP-3.    02380002
023801         10  TBL-UATOT-PREP-UNT-QTY   PIC S9(09)V9(02) COMP-3.    02380102
023802         10  TBL-UATOT-TOT-SLS-COST-AMT                           02380202
023803                                      PIC S9(09)V9(02) COMP-3.    02380302
023804                                                                  02380402
023805* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  02380502
023806*    OCCURRENCE CONTAINS FORECAST FIGURES                         02380602
023807 01  TBL-PROMO-TOTAL-TABLE.                                       02380702
023808     05  TBL-PMTOT-LINE-01 OCCURS 02 TIMES                        02380802
023809                          INDEXED BY TBL-PMTOT-INDX.              02380902
023810         10  TBL-PMTOT-TOT-SALE-AMT   PIC S9(09)V9(02) COMP-3.    02381002
023820         10  TBL-PMTOT-TOT-MD-AMT     PIC S9(09)V9(02) COMP-3.    02382002
023830         10  TBL-PMTOT-TOT-SLS-UNT-QTY                            02383002
023840                                      PIC S9(09)V9(02) COMP-3.    02384002
023850         10  TBL-PMTOT-TOT-EOH-INV-QTY                            02385002
023860                                      PIC S9(09)V9(02) COMP-3.    02386002
023870         10  TBL-PMTOT-PREP-UNT-QTY   PIC S9(09)V9(02) COMP-3.    02387002
023880         10  TBL-PMTOT-TOT-SLS-COST-AMT                           02388002
023890                                      PIC S9(09)V9(02) COMP-3.    02389002
023900                                                                  02390002
024000*----------------------------------------------------------       02400002
024100* ABEND- ABEND VARIABLES                                          02410002
024200*----------------------------------------------------------       02420002
024300 01  ABEND-CODE                       PIC S9(04) VALUE +0 COMP.   02430002
024400     88  ABEND-4001-WRITE-ERROR                  VALUE +4001.     02440002
024500     88  ABEND-4002-READ-ERROR                   VALUE +4002.     02450002
024600     88  ABEND-4003-CTRL-CARD-ERROR              VALUE +4003.     02460002
024700     88  ABEND-4004-TABLE-ERROR                  VALUE +4004.     02470002
024800     88  ABEND-4005-OPEN-ERROR                   VALUE +4005.     02480002
024900     88  ABEND-4006-CLOSE-ERROR                  VALUE +4006.     02490002
025000     88  ABEND-4007-SEQUENCE-ERROR               VALUE +4007.     02500002
025100     88  ABEND-4008-DATA-ERROR                   VALUE +4008.     02510002
025200     88  ABEND-4009-KEY-DATA-ERROR               VALUE +4009.     02520002
025500     88  ABEND-4013-DB2-ERROR                    VALUE +4013.     02550002
025600     88  ABEND-4019-DATE-ROUTINE-ERROR           VALUE +4019.     02560002
025700     88  ABEND-4444-FORCED-ABEND                 VALUE +4444.     02570002
025800                                                                  02580002
025900 01  END-OF-REPORT-LINE.                                          02590002
026000     05  FILLER                       PIC X(25)  VALUE            02600002
026100         ' ** END OF REPORT **     '.                             02610002
026200                                                                  02620002
026300*----------------------------------------------------------       02630002
026400* HD- HEADER INFO                                                 02640002
026500*----------------------------------------------------------       02650002
027330 01  HEADER-01.                                                   02733003
027340     05  FILLER                       PIC X(01)  VALUE SPACES.    02734002
027341     05  FILLER                       PIC X(10)  VALUE            02734132
027342                                      'GMM      :'.               02734232
027343     05  FILLER                       PIC X(01)  VALUE SPACES.    02734302
027344     05  HDR-01-GMM-NBR               PIC 9(04)  VALUE 0.         02734403
027345     05  FILLER                       PIC X(01)  VALUE SPACES.    02734502
027346     05  HDR-01-GMM-LAST-NM           PIC X(40)  VALUE SPACES.    02734603
027347     05  FILLER                       PIC X(143) VALUE SPACES.    02734732
027348                                                                  02734802
027349 01  HEADER-02.                                                   02734903
027350     05  FILLER                       PIC X(67) VALUE SPACES.     02735024
027360     05  FILLER                       PIC X(41) VALUE             02736024
027370         'PROMOTION SUMMARY - BY DMM, BY AD PAGE - '.             02737023
027380     05  HDR-02-TITLE                 PIC X(36)  VALUE SPACES.    02738003
027390     05  FILLER                       PIC X(54) VALUE SPACES.     02739024
027400                                                                  02740002
027500 01  HEADER-03.                                                   02750003
027600     05  FILLER                       PIC X(12)  VALUE            02760030
027700                                      ' AD EVENT : '.             02770030
027800     05  HDR-03-ADEVNT-STRING         PIC X(188) VALUE SPACES.    02780030
027900                                                                  02790002
028000 01  HEADER-04.                                                   02800003
028100     05  FILLER                       PIC X(12)  VALUE            02810002
028200                                      ' PROMOTION: '.             02820002
028300     05  HDR-04-PROMO-STRING          PIC X(188) VALUE SPACES.    02830003
028400                                                                  02840002
028500 01  HEADER-05.                                                   02850003
028600     05  FILLER                       PIC X(45)  VALUE            02860002
028700         '  AD                                         '.         02870002
028800     05  FILLER                       PIC X(45)  VALUE            02880002
028900         '                    SALES VOLUME         VOL '.         02890002
029000     05  FILLER                       PIC X(45)  VALUE            02900002
029100         '%             MARKDOWN $                UNITS'.         02910002
029200     05  FILLER                       PIC X(45)  VALUE            02920002
029300         ' SOLD        SELL              PREP UNITS    '.         02930002
029400     05  FILLER                       PIC X(20)  VALUE            02940002
029500         '        MARKUP %    '.                                  02950002
029600                                                                  02960002
029700 01  HEADER-06.                                                   02970003
029800     05  FILLER                       PIC X(45)  VALUE            02980002
029900         ' PAGE    DMM LAST NAME                       '.         02990003
030000     05  FILLER                       PIC X(45)  VALUE            03000002
030100         '                  ACT         FCST       CHG '.         03010002
030200     05  FILLER                       PIC X(45)  VALUE            03020002
030300         '           ACT         FCST          ACT     '.         03030002
030400     05  FILLER                       PIC X(45)  VALUE            03040002
030500         '    FCST    THRU %          ACT         FCST '.         03050002
030600     05  FILLER                       PIC X(20)  VALUE            03060002
030700         '     ACT      FCST  '.                                  03070002
030800                                                                  03080002
030900                                                                  03090002
031000*----------------------------------------------------------       03100002
031100* DTL- DETAIL INFO                                                03110002
031200*----------------------------------------------------------       03120002
031210 01  DETAIL-HEADER-01.                                            03121002
031220     05  FILLER                       PIC X(01)  VALUE SPACES.    03122002
031230     05  FILLER                       PIC X(06)  VALUE 'GMM - '.  03123002
031240     05  DTL-HDR-01-GMM-NAME          PIC X(40)  VALUE SPACES.    03124002
031250     05  FILLER                       PIC X(153) VALUE SPACES.    03125002
031260                                                                  03126002
031270 01  DETAIL-HEADER-02.                                            03127002
031280     05  FILLER                       PIC  X(50)     VALUE        03128002
031290         '--------------------------------------------------'.    03129002
031300     05  FILLER                       PIC  X(50)     VALUE        03130002
031400         '--------------------------------------------------'.    03140002
031500     05  FILLER                       PIC  X(50)     VALUE        03150002
031600         '--------------------------------------------------'.    03160002
031700     05  FILLER                       PIC  X(50)     VALUE        03170002
031800         '--------------------------------------------------'.    03180002
031900                                                                  03190002
032000 01  DETAIL-VARIABLE.                                             03200002
032100     05  FILLER                       PIC X(01)  VALUE SPACES.    03210002
032200     05  DTL-VAR-VOL-PCT-CHG          PIC ZZZ9.9.                 03220030
032210     05  DTL-VAR-VOL-PCT-CHG1 REDEFINES                           03221030
032220         DTL-VAR-VOL-PCT-CHG          PIC ZZZZ.Z.                 03222030
032300     05  FILLER                       PIC X(01)  VALUE SPACES.    03230002
032400                                                                  03240002
032500 01  DETAIL-01.                                                   03250002
032600     05  FILLER                       PIC X(01)  VALUE SPACES.    03260002
032700     05  DTL-01-AD-PG-NBR.                                        03270002
032800         10  DTL-01-PM-AD-PG-NBR      PIC ZZZ.                    03280002
032900         10  FILLER                   PIC X(05).                  03290002
033000         10  DTL-01-DMA-LAST-NM       PIC X(43).                  03300003
PGNBR      05  DTL-01-ADV-NOPG  REDEFINES                               03300134
PGNBR          DTL-01-AD-PG-NBR.                                        03300234
PGNBR          10  DTL-01-NOPG-TITLE        PIC X(04).                  03300334
PGNBR          10  FILLER                   PIC X(04).                  03300434
PGNBR          10  DTL-01-ADV-DMA-LAST-NM   PIC X(43).                  03300534
033010     05  DTL-01-NEW-TITLE REDEFINES                               03301003
033020         DTL-01-AD-PG-NBR.                                        03302003
033030         10  DTL-01-UNAD-TITLE        PIC X(04).                  03303003
033040         10  FILLER                   PIC X(04).                  03304003
033050         10  DTL-01-TTL-DMA-LAST-NM   PIC X(43).                  03305003
033600     05  FILLER                       PIC X(04)  VALUE SPACES.    03360002
033700     05  DTL-01-ACTL-SLS-RTL-AMT      PIC ZZZ,ZZ9.99.             03370030
033710     05  DTL-01-ACTL-SLS-RTL-AMT1 REDEFINES                       03371030
033720         DTL-01-ACTL-SLS-RTL-AMT      PIC ZZZ,ZZZ.ZZ.             03372030
033800     05  FILLER                       PIC X(03)  VALUE SPACES.    03380002
033900     05  DTL-01-FCST-SLS-RTL-AMT      PIC ZZZ,ZZZ.ZZ.             03390002
034000     05  FILLER                       PIC X(03)  VALUE SPACES.    03400002
034100     05  DTL-01-VOL-PCT-CHG           PIC X(08)  VALUE SPACES.    03410002
034200     05  DTL-01-VOL-PCT-SIGN          PIC X(01)  VALUE SPACES.    03420002
034300     05  FILLER                       PIC X(03)  VALUE SPACES.    03430002
034400     05  DTL-01-ACTL-MD-AMT           PIC ZZZ,ZZ9.99.             03440030
034410     05  DTL-01-ACTL-MD-AMT1 REDEFINES                            03441030
034420         DTL-01-ACTL-MD-AMT           PIC ZZZ,ZZZ.ZZ.             03442030
034500     05  FILLER                       PIC X(03)  VALUE SPACES.    03450002
034600     05  DTL-01-FCST-MD-AMT           PIC ZZZ,ZZZ.ZZ.             03460002
034700     05  FILLER                       PIC X(03)  VALUE SPACES.    03470002
034800     05  DTL-01-ACTL-UNT-SLD-QTY      PIC ZZZ,ZZ9.99.             03480030
034810     05  DTL-01-ACTL-UNT-SLD-QTY1 REDEFINES                       03481030
034820         DTL-01-ACTL-UNT-SLD-QTY      PIC ZZZ,ZZZ.ZZ.             03482030
034900     05  FILLER                       PIC X(03)  VALUE SPACES.    03490002
034910     05  DTL-01-FCST-UNT-SLD-QTY      PIC ZZZ,ZZZ.ZZ.             03491002
034920     05  FILLER                       PIC X(04)  VALUE SPACES.    03492002
034930     05  DTL-01-SELL-THRU-PCT         PIC ZZ9.9.                  03493030
034931     05  DTL-01-SELL-THRU-PCT1 REDEFINES                          03493130
034932         DTL-01-SELL-THRU-PCT         PIC ZZZ.Z.                  03493230
034940     05  DTL-01-SELL-PCT-SIGN         PIC X(01)  VALUE SPACES.    03494025
034950     05  FILLER                       PIC X(03)  VALUE SPACES.    03495002
034960     05  DTL-01-ACTL-PREP-UNT-QTY     PIC ZZZ,ZZ9.99.             03496030
034961     05  DTL-01-ACTL-PREP-UNT-QTY1 REDEFINES                      03496130
034962         DTL-01-ACTL-PREP-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             03496230
034970     05  FILLER                       PIC X(03)  VALUE SPACES.    03497002
034980     05  DTL-01-FCST-PREP-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             03498002
034990     05  FILLER                       PIC X(04)  VALUE SPACES.    03499002
035000     05  DTL-01-ACTL-MU-PCT           PIC ZZ9.9.                  03500030
035010     05  DTL-01-ACTL-MU-PCT1 REDEFINES                            03501030
035020         DTL-01-ACTL-MU-PCT           PIC ZZZ.Z.                  03502030
035100     05  DTL-01-ACTL-PCT-SIGN         PIC X(01)  VALUE SPACES.    03510002
035200     05  FILLER                       PIC X(04)  VALUE SPACES.    03520002
035300     05  DTL-01-FCST-MU-PCT           PIC ZZ9.9.                  03530030
035310     05  DTL-01-FCST-MU-PCT1 REDEFINES                            03531030
035320         DTL-01-FCST-MU-PCT           PIC ZZZ.Z.                  03532030
035400     05  DTL-01-FCST-PCT-SIGN         PIC X(01)  VALUE SPACES.    03540002
035500     05  FILLER                       PIC X(01)  VALUE SPACES.    03550002
035600                                                                  03560002
036200*----------------------------------------------------------       03620002
036300* COPYBOOK FOR THE PROMO ITEM SUMMARY EXTRACT - INPUT             03630002
036400*----------------------------------------------------------       03640002
036500     COPY PMRD100.                                                03650002
036600                                                                  03660002
036700*----------------------------------------------------------       03670002
036800*  DATE VALIDATION CALLING PARAMETER LIST                         03680002
036900*----------------------------------------------------------       03690002
037000     COPY DPWS500.                                                03700002
037100                                                                  03710002
037200*----------------------------------------------------------       03720002
037300*  STANDARD HEADER LINE - KOHLS 200 COL                           03730002
037400*----------------------------------------------------------       03740002
037500     COPY DPWS200O.                                               03750002
037600     EJECT                                                        03760002
037700                                                                  03770002
037800*----------------------------------------------------------       03780002
037900 PROCEDURE DIVISION.                                              03790002
038000*----------------------------------------------------------       03800002
038100 0000-MAINLINE.                                                   03810002
038110                                                                  03811002
038120     PERFORM 1000-INITIALIZATION.                                 03812002
038130                                                                  03813002
038131     PERFORM 2000-PROCESS-SALES-RESULTS                           03813102
038132             UNTIL PS-EOF-SLS-DMA-RSLTS.                          03813207
038133                                                                  03813302
038134     PERFORM 3000-END-OF-JOB-ROUTINE.                             03813402
038135                                                                  03813502
038136     GOBACK.                                                      03813602
038137                                                                  03813702
038138*0000-EXIT.                                                       03813802
038139 EJECT.                                                           03813902
038140                                                                  03814002
038141*----------------------------------------------------------       03814102
038142* 1000-INITIALIZATION.                                            03814202
038143*     INITIALIZATION AREA - INITIALIZES ALL VARIABLES, OPENS      03814302
038144*     FILES, READS INPUT FILES, AND PROCESSES ANY INPUT FILE      03814402
038145*     PARAMETERS IT MAY NEED TO USE TO READ AND PROCESS           03814502
038146*     ANY OF THE RECORDS FROM THE INPUT FILE.                     03814602
038147*----------------------------------------------------------       03814702
038148 1000-INITIALIZATION.                                             03814802
038149                                                                  03814902
038150     INITIALIZE PM100-PROMO-ITM-SUMM                              03815002
038170                TBL-SECT-TOTAL-TABLE                              03817002
038180                TBL-ADV-TOTAL-TABLE                               03818002
038190                TBL-UNAD-TOTAL-TABLE                              03819002
038200                TBL-PROMO-TOTAL-TABLE.                            03820002
038300                                                                  03830002
038400     SET PS-FIRST-TIME TO TRUE.                                   03840002
038500     SET PS-NO-WROTE-ADV-TTL TO TRUE.                             03850002
038520     SET PS-FIRST-TIME-GMM TO TRUE.                               03852005
038530     SET PS-FIRST-GMA-READ TO TRUE.                               03853005
038540     SET PS-NO-TOTALS      TO TRUE.                               03854006
038600                                                                  03860002
038700     OPEN INPUT PROMO-SUMM-DMM-FILE                               03870003
038710                PROMO-SUMM-GMM-FILE                               03871005
038900         OUTPUT PROMO-SUMM-REPORT.                                03890002
039000                                                                  03900002
039100     ACCEPT CD-CPU-DATE FROM DATE.                                03910002
039200     MOVE CD-CPU-YR                  TO CD-CPU-YY.                03920002
039300     MOVE CD-CPU-MO                  TO CD-CPU-MM.                03930002
039400     MOVE CD-CPU-DY                  TO CD-CPU-DD.                03940002
039500                                                                  03950002
039600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03960002
039700     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     03970002
039800     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     03980002
039900     SET DPG52-LK-DTE-GREG           TO TRUE.                     03990002
040000     MOVE CD-CPU-DATE-GREG           TO DPG52-LK-DATE-INPUT.      04000002
040100     MOVE 'INVALID CONVERT OF CURRENT DATE FROM CPU'              04010002
040200                                     TO PV-OPERATION-MSG-1.       04020002
040300                                                                  04030002
040400     PERFORM 9100-CALENDAR-ROUTINE.                               04040002
040500                                                                  04050002
040600     MOVE DPG55-DB2-ISO-DATE-FMT     TO CD-CPU-DATE-ISO.          04060002
040700                                                                  04070002
040710     ACCEPT CT-CPU-TIME FROM TIME.                                04071002
040720     MOVE CT-CPU-HR                  TO DP200O-RUN-HOUR.          04072002
040721     MOVE CT-CPU-MIN                 TO DP200O-RUN-MINUTE.        04072102
040722     MOVE CD-CPU-MO                  TO DP200O-RUN-MONTH.         04072202
040723     MOVE CD-CPU-DY                  TO DP200O-RUN-DAY.           04072302
040724     MOVE CD-CPU-YR                  TO DP200O-RUN-YEAR.          04072402
040725     MOVE PC-CURRENT-PROGRAM-NAME    TO DP200O-PROGRAM-NAME.      04072502
040726                                                                  04072602
040729     PERFORM 8000-READ-SLS-DMA-RESULTS.                           04072903
040730                                                                  04073002
040740     IF PS-EOF-SLS-DMA-RSLTS                                      04074007
040750        DISPLAY 'NO PROMOTIONS TO REPORT ON'                      04075002
040760     ELSE                                                         04076002
040770        EVALUATE TRUE                                             04077002
040780          WHEN PM100-ACTUAL                                       04078002
040790               MOVE PC-ACTUAL-RSLT    TO HDR-02-TITLE             04079003
040800          WHEN PM100-FORECAST                                     04080002
040900               MOVE PC-FORECAST-RSLT  TO HDR-02-TITLE             04090003
041000          WHEN OTHER                                              04100002
041100               DISPLAY 'PM100-FCST-ACTUAL-IND: '                  04110002
041200                              PM100-FCST-ACTUAL-IND               04120002
041300               SET ABEND-4444-FORCED-ABEND TO TRUE                04130002
041400               MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME    04140002
041500               MOVE 'NOT A VALID FORECAST/ACTUAL IND'             04150002
041600                                       TO PV-OPERATION-MSG-1      04160002
041700               PERFORM 9800-ABEND                                 04170002
041800        END-EVALUATE                                              04180002
041900     END-IF.                                                      04190002
042000                                                                  04200002
042100*1000-EXIT.                                                       04210002
042200 EJECT.                                                           04220002
042300                                                                  04230002
042400*----------------------------------------------------------       04240002
042500* 2000-PROCESS-SALES-RESULTS.                                     04250002
042600*     PROCESSES THE SALES RESULTS FILE AND CREATES A              04260002
042700*     A REPORT. THIS REPORT BREAKS BY AD EVENT/PROMOTION.         04270002
042800*----------------------------------------------------------       04280002
042900 2000-PROCESS-SALES-RESULTS.                                      04290002
043000                                                                  04300002
043100     EVALUATE TRUE                                                04310002
043200       WHEN (PM100-AD-EVNT-ID IS NOT = PV-LAST-ADEVNT-ID)         04320002
043300         OR (PM100-PROMO-ID IS NOT = PV-LAST-PROMO-ID)            04330002
043400         OR (PM100-GMA-NBR IS NOT = PV-LAST-GMA-NBR)              04340002
043600            IF PS-NOT-FIRST-TIME                                  04360002
043700               IF PS-NO-WROTE-ADV-TTL                             04370002
043800                  PERFORM 3300-PROCESS-ADVPG-TOTAL                04380004
043900               END-IF                                             04390002
044000               PERFORM 3310-PROCESS-DMM-GMM-TOTAL                 04400006
044001               PERFORM 3320-PROCESS-ADV-TOTAL                     04400104
044002               PERFORM 3330-PROCESS-UNAD-TOTAL                    04400204
044003               PERFORM 3340-PROCESS-PROMO-TOTAL                   04400304
044004               MOVE PM100-PROMO-ITM-SUMM TO PV-SAVE-RECORD        04400403
044011               IF PS-FIRST-GMA-READ                               04401105
044012                  PERFORM 8100-READ-SLS-GMA-RESULTS               04401205
044013                  SET PS-NOT-FIRST-GMA-READ TO TRUE               04401305
044014               ELSE                                               04401405
044015                  MOVE PV-SAVE-RECORD-2 TO PM100-PROMO-ITM-SUMM   04401505
044016               END-IF                                             04401605
044017               SET PS-GMA-RESULTS TO TRUE                         04401705
044018               IF PM100-AD-EVNT-ID = PV-SAVE-AD-EVNT-ID           04401805
044019                  AND PM100-PROMO-ID = PV-SAVE-PROMO-ID           04401905
044020                  AND PS-NOT-EOF-SLS-GMA-RSLTS                    04402005
044021                  INITIALIZE TBL-SECT-TOTAL-TABLE                 04402105
044022                  PERFORM 3100-PROCESS-ALL-GMMS-TOTALS            04402205
044023                          UNTIL PM100-AD-EVNT-ID NOT =            04402305
044024                                       PV-SAVE-AD-EVNT-ID         04402405
044025                             OR PM100-PROMO-ID NOT =              04402505
044026                                       PV-SAVE-PROMO-ID           04402605
044027                             OR PS-EOF-SLS-GMA-RSLTS              04402705
044028                  PERFORM 3310-PROCESS-DMM-GMM-TOTAL              04402805
044029                  MOVE ZEROES TO PV-PREV-GMA-NBR                  04402914
044030                  IF PS-EOF-SLS-GMA-RSLTS                         04403015
044031                     CLOSE PROMO-SUMM-GMM-FILE                    04403115
044032                     OPEN INPUT PROMO-SUMM-GMM-FILE               04403215
044033                     SET PS-FIRST-GMA-READ TO TRUE                04403315
044034                     SET PS-NOT-EOF-SLS-GMA-RSLTS TO TRUE         04403416
044035                  END-IF                                          04403515
044036               END-IF                                             04403605
044037               SET PS-TOTALS TO TRUE                              04403705
044038               PERFORM 3320-PROCESS-ADV-TOTAL                     04403804
044039               PERFORM 3330-PROCESS-UNAD-TOTAL                    04403904
044040               PERFORM 3340-PROCESS-PROMO-TOTAL                   04404004
044050               SET PS-NO-TOTALS TO TRUE                           04405005
044400               INITIALIZE TBL-SECT-TOTAL-TABLE                    04440002
044500                          TBL-ADV-TOTAL-TABLE                     04450002
044600                          TBL-UNAD-TOTAL-TABLE                    04460002
044700                          TBL-PROMO-TOTAL-TABLE                   04470002
044710               MOVE PV-SAVE-RECORD TO PM100-PROMO-ITM-SUMM        04471006
044720               SET PS-FIRST-TIME-GMM TO TRUE                      04472005
044800            END-IF                                                04480002
044900            MOVE PM100-AD-EVNT-ID TO PV-LAST-ADEVNT-ID            04490002
044910                                     PV-SAVE-AD-EVNT-ID           04491005
045000            MOVE PM100-PROMO-ID   TO PV-LAST-PROMO-ID             04500002
045010                                     PV-SAVE-PROMO-ID             04501005
045100            MOVE PM100-GMA-NBR    TO PV-LAST-GMA-NBR              04510002
045200                                     HDR-01-GMM-NBR               04520003
045500            MOVE PM100-AD-PG-NBR  TO PV-AD-PG-NBR                 04550002
045600            MOVE PM100-DMA-NBR    TO PV-LAST-DMA-NBR              04560017
045700            MOVE PM100-GMA-LAST-NM TO HDR-01-GMM-LAST-NM          04570003
045710                                      PV-SAVE-GMA-LAST-NM         04571020
045800            SET PS-DMA-RESULTS TO TRUE                            04580005
045900            PERFORM 2200-FORMAT-HEADING-FIELDS                    04590004
046000            PERFORM 2100-ADEVNT-PROMO-HDR-BREAK                   04600002
046100            PERFORM 2300-CREATE-HEADING-FIELDS                    04610004
046200            PERFORM 3500-PROCESS-PAGE-HEADER                      04620004
046300            SET PS-NOT-FIRST-TIME TO TRUE                         04630002
046400            SET PS-FIRST-LINE     TO TRUE                         04640002
PGNBR        WHEN (PM100-DMA-NBR IS NOT = PV-LAST-DMA-NBR)              04641034
PGNBR             IF PS-NO-WROTE-ADV-TTL                                04642034
PGNBR                PERFORM 3300-PROCESS-ADVPG-TOTAL                   04643034
PGNBR             END-IF                                                04644034
PGNBR             PERFORM 3310-PROCESS-DMM-GMM-TOTAL                    04645034
PGNBR             MOVE PM100-DMA-NBR    TO PV-LAST-DMA-NBR              04646034
PGNBR             MOVE PM100-AD-PG-NBR  TO PV-AD-PG-NBR                 04647034
PGNBR             INITIALIZE TBL-SECT-TOTAL-TABLE                       04648034
PGNBR             SET PS-FIRST-LINE     TO TRUE                         04649034
PGNBR             SET PS-NO-WROTE-ADV-TTL TO TRUE                       04649134
PGNBR *      WHEN (PM100-AD-PG-NBR IS NOT = PV-AD-PG-NBR)               04650034
PGNBR        WHEN (PM100-PROMO-ITM-ADV-IND = 'N')                       04660034
PGNBR             PERFORM 3300-PROCESS-ADVPG-TOTAL                      04670034
PGNBR             MOVE PM100-AD-PG-NBR  TO PV-AD-PG-NBR                 04671034
PGNBR             SET PS-WROTE-ADV-TTL  TO TRUE                         04672034
046740     END-EVALUATE.                                                04674002
046750     PERFORM 3200-PROCESS-DETAIL.                                 04675004
046760                                                                  04676002
046770     PERFORM 8000-READ-SLS-DMA-RESULTS.                           04677003
046780                                                                  04678002
046790*2000-EXIT.                                                       04679002
046800 EJECT.                                                           04680002
046900                                                                  04690002
047000*----------------------------------------------------------       04700002
047100* 2100-ADEVNT-PROMO-HDR-BREAK.                                    04710002
047200*     WHEN AN ADEVENT ID/PROMO ID CHANGE, GIVE THE NEW            04720002
047300*     START/END DATES.                                            04730002
047400*----------------------------------------------------------       04740002
047500 2100-ADEVNT-PROMO-HDR-BREAK.                                     04750002
047600                                                                  04760002
047700     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              04770002
047800     SET DPG51-ACTUAL-CALENDAR-ONLY      TO TRUE.                 04780002
047900     SET DPG51-DO-NOT-INCR-DECR-DATE     TO TRUE.                 04790002
048000     SET DPG52-LK-DTE-ISO-FMT            TO TRUE.                 04800002
048100     MOVE PM100-PROMO-STRT-TMST          TO PV-PROMO-STRT-TMST.   04810002
048200     MOVE PM100-PROMO-END-TMST           TO PV-PROMO-END-TMST.    04820002
048300     MOVE PV-PROMO-STRT-DTE              TO DPG52-LK-DATE-INPUT.  04830002
048400     MOVE 'INVALID PROMO BEGINNING DATE' TO PV-OPERATION-MSG-1.   04840002
048500                                                                  04850002
048600     PERFORM 9100-CALENDAR-ROUTINE.                               04860002
048700                                                                  04870002
048800     MOVE DPG55-ALPHA-WEEK-DAY  TO PV-BEG-DAY-ALPHA.              04880002
048900     MOVE DPG55-GREG-DATE-FMT   TO PV-BEG-DATE.                   04890002
049000                                                                  04900002
049100     IF (PV-PM-STRT-TM-HH =                                       04910002
049200         PC-DEFAULT-BEG-HR AND                                    04920002
049300         PV-PM-STRT-TM-MM =                                       04930002
049400         PC-DEFAULT-BEG-MIN)                                      04940002
049500         IF PV-PROMO-STRT-DTE = PV-PROMO-END-DTE                  04950002
049600* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 04960002
049700            MOVE SPACES         TO PV-BEG-TIME                    04970002
049800            MOVE PV-PM-STRT-TM-HH                                 04980002
049900                                TO PV-BEG-HR-TIME                 04990002
050000            MOVE PC-COLON       TO PV-BEG-TIME-COLON              05000002
050100            MOVE PV-PM-STRT-TM-MM                                 05010002
050200                                TO PV-BEG-MIN-TIME                05020002
050300         ELSE                                                     05030002
050400            MOVE PC-ALL-DAY     TO PV-BEG-TIME                    05040002
050500         END-IF                                                   05050002
050600     ELSE                                                         05060002
050700* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 05070002
050800        MOVE SPACES             TO PV-BEG-TIME                    05080002
050900        MOVE PV-PM-STRT-TM-HH                                     05090002
051000                                TO PV-BEG-HR-TIME                 05100002
051100        MOVE PC-COLON           TO PV-BEG-TIME-COLON              05110002
051200        MOVE PV-PM-STRT-TM-MM                                     05120002
051300                                TO PV-BEG-MIN-TIME                05130002
051400     END-IF.                                                      05140002
051500                                                                  05150002
051600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              05160002
051700     SET DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                    05170002
051800     SET DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                    05180002
051900     SET DPG52-LK-DTE-ISO-FMT         TO TRUE.                    05190002
052000     MOVE PV-PROMO-END-DTE            TO DPG52-LK-DATE-INPUT.     05200002
052100     MOVE 'INVALID PROMO ENDING DATE' TO PV-OPERATION-MSG-1.      05210002
052200                                                                  05220002
052300     PERFORM 9100-CALENDAR-ROUTINE.                               05230002
052400                                                                  05240002
052500     MOVE DPG55-ALPHA-WEEK-DAY  TO PV-END-DAY-ALPHA.              05250002
052600     MOVE DPG55-GREG-DATE-FMT   TO PV-END-DATE.                   05260002
052700                                                                  05270002
052800     IF (PV-PM-END-TM-HH =                                        05280002
052900         PC-DEFAULT-END-HR AND                                    05290002
053000         PV-PM-END-TM-MM =                                        05300002
053100         PC-DEFAULT-END-MIN)                                      05310002
053200         IF PV-PROMO-STRT-DTE = PV-PROMO-END-DTE                  05320002
053300* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 05330002
053400            MOVE SPACES         TO PV-END-TIME                    05340002
053500            MOVE PV-PM-END-TM-HH                                  05350002
053600                                TO PV-END-HR-TIME                 05360002
053700            MOVE PC-COLON       TO PV-END-TIME-COLON              05370002
053800            MOVE PV-PM-END-TM-MM                                  05380002
053900                                TO PV-END-MIN-TIME                05390002
054000         ELSE                                                     05400002
054100            MOVE PC-ALL-DAY     TO PV-END-TIME                    05410002
054200         END-IF                                                   05420002
054300      ELSE                                                        05430002
054400* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 05440002
054500         MOVE SPACES            TO PV-END-TIME                    05450002
054600         MOVE PV-PM-END-TM-HH                                     05460002
054700                                TO PV-END-HR-TIME                 05470002
054800         MOVE PC-COLON          TO PV-END-TIME-COLON              05480002
054900         MOVE PV-PM-END-TM-MM                                     05490002
055000                                TO PV-END-MIN-TIME                05500002
055100     END-IF.                                                      05510002
055200                                                                  05520002
055300*2100-EXIT.                                                       05530002
055400 EJECT.                                                           05540002
055500                                                                  05550002
055840*----------------------------------------------------------       05584002
055841* 2200-FORMAT-HEADING-FIELDS.                                     05584104
055842*     FORMAT THE AD EVENT TITLES AND THE PROMOTION TITLES.        05584202
055843*----------------------------------------------------------       05584302
055844 2200-FORMAT-HEADING-FIELDS.                                      05584404
055845                                                                  05584502
055846     MOVE PM100-AD-EVNT-NBR-TXT TO PV-SAVE-VAR.                   05584602
055847     MOVE 16                    TO PV-SAVE-NUM.                   05584702
055848     PERFORM 7000-COUNT-FIELD-LENGTH.                             05584802
055849     MOVE PV-SAVE-LENGTH        TO PV-AD-EVNT-NBR-LENGTH.         05584902
055850                                                                  05585002
055860     MOVE PM100-AD-EVNT-NM      TO PV-SAVE-VAR.                   05586002
055870     MOVE 41                    TO PV-SAVE-NUM.                   05587002
055880     PERFORM 7000-COUNT-FIELD-LENGTH.                             05588002
055890     MOVE PV-SAVE-LENGTH        TO PV-AD-EVNT-NM-LENGTH.          05589002
055900                                                                  05590002
056000     MOVE PM100-PROMO-NM        TO PV-SAVE-VAR.                   05600002
056100     MOVE 41                    TO PV-SAVE-NUM.                   05610002
056200     PERFORM 7000-COUNT-FIELD-LENGTH.                             05620002
056300     MOVE PV-SAVE-LENGTH        TO PV-PROMO-NM-LENGTH.            05630002
056400                                                                  05640002
056500*2200-EXIT.                                                       05650004
056600 EJECT.                                                           05660002
056700                                                                  05670002
056800*----------------------------------------------------------       05680002
056900* 2300-CREATE-HEADING-FIELDS.                                     05690004
057000*     CREATE THE AD EVENT AND THE PROMO HEADINGS.                 05700002
057100*----------------------------------------------------------       05710002
057200 2300-CREATE-HEADING-FIELDS.                                      05720004
057300                                                                  05730002
057400     MOVE SPACES          TO HDR-03-ADEVNT-STRING                 05740003
057500                             HDR-04-PROMO-STRING.                 05750003
057600                                                                  05760002
057700     MOVE +1 TO PV-POINTER-FIELD.                                 05770002
057800     STRING PM100-AD-EVNT-NBR-TXT(1:PV-AD-EVNT-NBR-LENGTH)        05780002
057900            " " DELIMITED BY SIZE                                 05790002
058000            PM100-AD-EVNT-NM(1:PV-AD-EVNT-NM-LENGTH)              05800002
058100            " " DELIMITED BY SIZE                                 05810002
058200       INTO HDR-03-ADEVNT-STRING                                  05820003
058300       WITH POINTER PV-POINTER-FIELD.                             05830002
058400                                                                  05840002
058500     MOVE +1 TO PV-POINTER-FIELD.                                 05850002
058600     STRING PM100-PROMO-NM(1:PV-PROMO-NM-LENGTH)                  05860002
058700            " " DELIMITED BY SIZE                                 05870002
058800            " " DELIMITED BY SIZE                                 05880002
058900            " " DELIMITED BY SIZE                                 05890002
059000            PC-CHAR-EFFECTIVE DELIMITED BY " "                    05900002
059100            ":" DELIMITED BY SIZE                                 05910002
059200            " " DELIMITED BY SIZE                                 05920002
059300            PV-HEADER-DTE-TM(1:87)                                05930002
059400            " " DELIMITED BY SIZE                                 05940002
059500       INTO HDR-04-PROMO-STRING                                   05950006
059600       WITH POINTER PV-POINTER-FIELD.                             05960002
059700                                                                  05970002
059800*2300-EXIT.                                                       05980004
059900 EJECT.                                                           05990002
060000                                                                  06000002
060100*----------------------------------------------------------       06010002
060200* 3000-END-OF-JOB-ROUTINE.                                        06020002
060300*     PERFORMS THE FINAL PROCESSING OF THE PROGRAM.               06030002
060400*     WRITES OUT THE CLOSING LINES OF THE REPORT, CLOSES          06040002
060500*     ANY FILES, AND DISPLAYS ANY NECESSARY STATISTICS.           06050002
060600*----------------------------------------------------------       06060002
060700 3000-END-OF-JOB-ROUTINE.                                         06070002
060800                                                                  06080002
060810     IF PS-NOT-FIRST-TIME                                         06081005
060820        IF PS-NO-WROTE-ADV-TTL                                    06082005
060830           PERFORM 3300-PROCESS-ADVPG-TOTAL                       06083005
060840        END-IF                                                    06084005
060850        PERFORM 3310-PROCESS-DMM-GMM-TOTAL                        06085006
060860        PERFORM 3320-PROCESS-ADV-TOTAL                            06086005
060870        PERFORM 3330-PROCESS-UNAD-TOTAL                           06087005
060880        PERFORM 3340-PROCESS-PROMO-TOTAL                          06088005
060890        MOVE PM100-PROMO-ITM-SUMM TO PV-SAVE-RECORD               06089005
060891        IF PS-FIRST-GMA-READ                                      06089105
060892           PERFORM 8100-READ-SLS-GMA-RESULTS                      06089205
060893           SET PS-NOT-FIRST-GMA-READ TO TRUE                      06089305
060894        ELSE                                                      06089405
060895            MOVE PV-SAVE-RECORD-2 TO PM100-PROMO-ITM-SUMM         06089505
060896        END-IF                                                    06089605
060897        SET PS-GMA-RESULTS TO TRUE                                06089705
060898        IF PM100-AD-EVNT-ID = PV-SAVE-AD-EVNT-ID                  06089805
060899           AND PM100-PROMO-ID = PV-SAVE-PROMO-ID                  06089905
060900           AND PS-NOT-EOF-SLS-GMA-RSLTS                           06090005
060901           INITIALIZE TBL-SECT-TOTAL-TABLE                        06090105
060902           PERFORM 3100-PROCESS-ALL-GMMS-TOTALS                   06090205
060903                   UNTIL PM100-AD-EVNT-ID NOT =                   06090305
060904                                   PV-SAVE-AD-EVNT-ID             06090405
060905                      OR PM100-PROMO-ID NOT =                     06090505
060906                                    PV-SAVE-PROMO-ID              06090605
060907                      OR PS-EOF-SLS-GMA-RSLTS                     06090705
060908           PERFORM 3310-PROCESS-DMM-GMM-TOTAL                     06090805
060909        END-IF                                                    06090905
060910        SET PS-TOTALS TO TRUE                                     06091005
060911        PERFORM 3320-PROCESS-ADV-TOTAL                            06091105
060912        PERFORM 3330-PROCESS-UNAD-TOTAL                           06091205
060913        PERFORM 3340-PROCESS-PROMO-TOTAL                          06091305
060914        SET PS-NO-TOTALS TO TRUE                                  06091405
061800        MOVE 2                     TO PV-ADVANCE-LINES            06180002
061900        ADD PV-ADVANCE-LINES       TO PV-LINE-CNT                 06190002
062000        PERFORM 3400-CHECK-MAX-LINE-CNT                           06200004
062100        MOVE END-OF-REPORT-LINE    TO PV-RPT-LINE                 06210002
062200        PERFORM 8300-WRITE-RPT-LINE                               06220033
062300     END-IF.                                                      06230002
062400                                                                  06240002
062500     CLOSE PROMO-SUMM-DMM-FILE                                    06250003
062510           PROMO-SUMM-GMM-FILE                                    06251005
062700           PROMO-SUMM-REPORT.                                     06270002
062800                                                                  06280002
062900*3000-EXIT.                                                       06290002
063000 EJECT.                                                           06300002
063100                                                                  06310002
118248*----------------------------------------------------------       11824804
118249* 3100-PROCESS-ALL-GMMS-TOTALS.                                   11824904
118250*     PROCESSES THE GMM TOTAL FILE TO WRITE OUT ALL THE           11825021
118251*     GMMS TOTALS FOR A CERTAIN PROMOTION.                        11825121
118252*----------------------------------------------------------       11825204
118253 3100-PROCESS-ALL-GMMS-TOTALS.                                    11825304
118254                                                                  11825404
118255     IF PV-LAST-GMA-NBR NOT = PM100-GMA-NBR                       11825505
118256        EVALUATE TRUE                                             11825605
118257            WHEN (PM100-GMA-NBR IS NOT = PV-PREV-GMA-NBR)         11825705
118258                 IF PS-NOT-FIRST-TIME-GMM                         11825805
118259                    PERFORM 3310-PROCESS-DMM-GMM-TOTAL            11825905
118260                 END-IF                                           11826005
118261                 INITIALIZE TBL-SECT-TOTAL-TABLE                  11826105
118262                 MOVE PM100-GMA-NBR    TO PV-PREV-GMA-NBR         11826205
118263                 SET PS-NOT-FIRST-TIME-GMM TO TRUE                11826305
118264                 SET PS-FIRST-LINE-GMM  TO TRUE                   11826405
118265        END-EVALUATE                                              11826511
118266        PERFORM 3200-PROCESS-DETAIL                               11826611
118267        MOVE PM100-GMA-LAST-NM    TO PV-SAVE-LAST-NAME            11826713
118268     END-IF.                                                      11826811
118269                                                                  11826905
118270     PERFORM 8100-READ-SLS-GMA-RESULTS.                           11827005
118271                                                                  11827105
118272                                                                  11827204
118273*3100-EXIT.                                                       11827304
118274 EJECT.                                                           11827404
118275                                                                  11827504
118340*----------------------------------------------------------       11834004
118341* 3200-PROCESS-DETAIL.                                            11834104
118342*     PROCESS REPORT DETAIL LINES.                                11834204
118343*----------------------------------------------------------       11834304
118344 3200-PROCESS-DETAIL.                                             11834404
118345                                                                  11834504
118346     MOVE SPACES                    TO DETAIL-01                  11834604
118347                                       DETAIL-VARIABLE.           11834704
118348                                                                  11834804
118349     IF PS-GMA-RESULTS                                            11834905
118352        IF PM100-PROMO-ITM-ADV-IND = 'N'                          11835205
118353           IF PS-FIRST-LINE-GMM                                   11835305
118356              SET PS-NO-FIRST-LINE-GMM    TO TRUE                 11835605
118357              SET PS-WROTE-ADV-TTL     TO TRUE                    11835705
118358              MOVE +1 TO PV-POINTER-FIELD                         11835818
118359              STRING PC-ADVERTISED DELIMITED BY " "               11835918
118360                     " " DELIMITED BY SIZE                        11836018
118361                     PM100-GMA-LAST-NM DELIMITED BY " "           11836118
118362                     " " DELIMITED BY SIZE                        11836218
118363                INTO DTL-01-NEW-TITLE                             11836318
118364                WITH POINTER PV-POINTER-FIELD                     11836418
118365              MOVE 2                   TO PV-ADVANCE-LINES        11836518
118366              ADD PV-ADVANCE-LINES     TO PV-LINE-CNT             11836618
118367              PERFORM 3400-CHECK-MAX-LINE-CNT                     11836718
118368              MOVE DETAIL-01           TO PV-RPT-LINE             11836818
118369              PERFORM 8300-WRITE-RPT-LINE                         11836933
118370              MOVE SPACES              TO DETAIL-01               11837018
118371              MOVE 1                   TO PV-ADVANCE-LINES        11837119
118372           ELSE                                                   11837205
118373              MOVE 1                   TO PV-ADVANCE-LINES        11837305
118374           END-IF                                                 11837405
118375           MOVE +1 TO PV-POINTER-FIELD                            11837505
118376           STRING PC-UNADVERTISED DELIMITED BY " "                11837605
118377                  " " DELIMITED BY SIZE                           11837705
118378                  PM100-GMA-LAST-NM DELIMITED BY " "              11837805
118379                  " " DELIMITED BY SIZE                           11837905
118380             INTO DTL-01-NEW-TITLE                                11838005
118381             WITH POINTER PV-POINTER-FIELD                        11838105
118382        ELSE                                                      11838205
118383           IF PM100-PROMO-ITM-ADV-IND = 'Y'                       11838305
118384              IF PS-FIRST-LINE-GMM                                11838405
118385                 MOVE 2                TO PV-ADVANCE-LINES        11838505
118386                 SET PS-NO-FIRST-LINE-GMM TO TRUE                 11838605
118387              ELSE                                                11838705
118388                 MOVE 1                TO PV-ADVANCE-LINES        11838805
118389              END-IF                                              11838905
118390              MOVE +1 TO PV-POINTER-FIELD                         11839009
118391              STRING PC-ADVERTISED DELIMITED BY " "               11839105
118392                     " " DELIMITED BY SIZE                        11839205
118393                     PM100-GMA-LAST-NM DELIMITED BY " "           11839305
118394                     " " DELIMITED BY SIZE                        11839405
118395                INTO DTL-01-NEW-TITLE                             11839505
118396                WITH POINTER PV-POINTER-FIELD                     11839605
118397           END-IF                                                 11839705
118398        END-IF                                                    11839805
118399     ELSE                                                         11839904
118400        IF PM100-PROMO-ITM-ADV-IND = 'N'                          11840004
118401           IF PS-FIRST-LINE                                       11840104
118402              MOVE 2                   TO PV-ADVANCE-LINES        11840204
118403              MOVE PM100-DMA-LAST-NM   TO DTL-01-TTL-DMA-LAST-NM  11840304
118404              SET PS-NO-FIRST-LINE     TO TRUE                    11840404
118405              SET PS-WROTE-ADV-TTL     TO TRUE                    11840504
118406           ELSE                                                   11840604
118407              MOVE 1                   TO PV-ADVANCE-LINES        11840704
118408              MOVE SPACES              TO DTL-01-TTL-DMA-LAST-NM  11840806
118409           END-IF                                                 11840904
118410           MOVE PC-UNADVERTISED        TO DTL-01-UNAD-TITLE       11841004
118411        ELSE                                                      11841104
PGNBR            IF PM100-PROMO-ITM-ADV-IND = 'Y' AND                   11841234
PGNBR               PM100-AD-PG-NBR NOT = 0                             11841334
118413              MOVE PM100-AD-PG-NBR     TO DTL-01-PM-AD-PG-NBR     11841404
118414              IF PS-FIRST-LINE                                    11841504
118415                 MOVE 2                TO PV-ADVANCE-LINES        11841604
118416                 SET PS-NO-FIRST-LINE  TO TRUE                    11841704
118417                 MOVE PM100-DMA-LAST-NM                           11841804
118418                                       TO DTL-01-DMA-LAST-NM      11841904
118419              ELSE                                                11842004
118420                 MOVE 1                TO PV-ADVANCE-LINES        11842104
118421                 MOVE SPACES           TO DTL-01-DMA-LAST-NM      11842204
118422              END-IF                                              11842304
PGNBR            ELSE                                                   11842434
PGNBR               IF PM100-PROMO-ITM-ADV-IND = 'Y' AND                11842534
PGNBR                  PM100-AD-PG-NBR = 0                              11842634
PGNBR                  IF PS-FIRST-LINE                                 11842734
PGNBR                     MOVE 2                   TO PV-ADVANCE-LINES  11842834
PGNBR                     MOVE PM100-DMA-LAST-NM   TO                   11842934
PGNBR                                          DTL-01-ADV-DMA-LAST-NM   11843034
PGNBR                     SET PS-NO-FIRST-LINE     TO TRUE              11843234
PGNBR                     SET PS-WROTE-ADV-TTL     TO TRUE              11843334
PGNBR                  ELSE                                             11843434
PGNBR                     MOVE 1                   TO PV-ADVANCE-LINES  11843534
PGNBR                     MOVE SPACES              TO                   11843634
PGNBR                                          DTL-01-ADV-DMA-LAST-NM   11843734
PGNBR                  END-IF                                           11843834
PGNBR                  MOVE PC-ADVNOPAGE           TO DTL-01-NOPG-TITLE 11843934
PGNBR               END-IF                                              11844034
118423           END-IF                                                 11844104
118424        END-IF                                                    11844204
118425     END-IF.                                                      11844304
118426                                                                  11844404
118427*** THIS IS PROCESSED FOR ACTUAL REPORTS ONLY.                    11844504
118428     IF PM100-ACTUAL                                              11844604
118430        MOVE PM100-ACTL-SLS-RTL-AMT  TO DTL-01-ACTL-SLS-RTL-AMT   11844730
118432                                                                  11844804
118434        MOVE PM100-ACTL-MKDN-RTL-AMT TO DTL-01-ACTL-MD-AMT        11844930
118436                                                                  11845004
118438        MOVE PM100-ACTL-SLS-UNT-QTY  TO DTL-01-ACTL-UNT-SLD-QTY   11845130
118439                                                                  11845230
118440        ADD PM100-ACTL-SLS-RTL-AMT  TO                            11845304
118441                             TBL-STOT-TOT-SALE-AMT(PC-SUB-1)      11845404
118442                             TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)     11845504
118443        ADD PM100-ACTL-MKDN-RTL-AMT TO                            11845604
118444                             TBL-STOT-TOT-MD-AMT(PC-SUB-1)        11845704
118445                             TBL-PMTOT-TOT-MD-AMT(PC-SUB-1)       11845804
118446        ADD PM100-ACTL-SLS-UNT-QTY  TO                            11845904
118447                             TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)   11846004
118448                             TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1)  11846104
118449        ADD PM100-ACTL-SLS-COST-AMT TO                            11846204
118450                             TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1)  11846304
118451                             TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1) 11846404
118452        ADD PM100-ACTL-EOH-INV-QTY  TO                            11846504
118453                             TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1)   11846604
118454                             TBL-PMTOT-TOT-EOH-INV-QTY(PC-SUB-1)  11846704
118455        IF PM100-PROMO-ITM-ADV-IND = 'N'                          11846804
118456           ADD PM100-ACTL-SLS-RTL-AMT  TO                         11846904
118457                           TBL-UATOT-TOT-SALE-AMT(PC-SUB-1)       11847004
118458           ADD PM100-ACTL-MKDN-RTL-AMT TO                         11847104
118459                           TBL-UATOT-TOT-MD-AMT(PC-SUB-1)         11847204
118460           ADD PM100-ACTL-SLS-UNT-QTY  TO                         11847304
118461                           TBL-UATOT-TOT-SLS-UNT-QTY(PC-SUB-1)    11847404
118462           ADD PM100-ACTL-SLS-COST-AMT TO                         11847504
118463                           TBL-UATOT-TOT-SLS-COST-AMT(PC-SUB-1)   11847604
118464           ADD PM100-ACTL-EOH-INV-QTY  TO                         11847730
118465                           TBL-UATOT-TOT-EOH-INV-QTY(PC-SUB-1)    11847804
118466           ADD PM100-ACTL-PREP-UNT-QTY TO                         11847904
118467                           TBL-UATOT-PREP-UNT-QTY(PC-SUB-1)       11848004
118468        ELSE                                                      11848104
118469           IF PM100-PROMO-ITM-ADV-IND = 'Y'                       11848204
118470              ADD PM100-ACTL-SLS-RTL-AMT  TO                      11848304
118471                           TBL-ATOT-TOT-SALE-AMT(PC-SUB-1)        11848404
118472              ADD PM100-ACTL-MKDN-RTL-AMT TO                      11848504
118473                           TBL-ATOT-TOT-MD-AMT(PC-SUB-1)          11848604
118474              ADD PM100-ACTL-SLS-UNT-QTY  TO                      11848704
118475                           TBL-ATOT-TOT-SLS-UNT-QTY(PC-SUB-1)     11848804
118476              ADD PM100-ACTL-SLS-COST-AMT TO                      11848904
118477                           TBL-ATOT-TOT-SLS-COST-AMT(PC-SUB-1)    11849004
118478              ADD PM100-ACTL-EOH-INV-QTY  TO                      11849130
118479                           TBL-ATOT-TOT-EOH-INV-QTY(PC-SUB-1)     11849204
118480              ADD PM100-ACTL-PREP-UNT-QTY TO                      11849304
118481                           TBL-ATOT-PREP-UNT-QTY(PC-SUB-1)        11849404
118482           END-IF                                                 11849504
118483        END-IF                                                    11849604
118485        MOVE PM100-ACTL-PREP-UNT-QTY TO DTL-01-ACTL-PREP-UNT-QTY  11849730
118487        ADD PM100-ACTL-PREP-UNT-QTY  TO                           11849830
118488                                TBL-STOT-PREP-UNT-QTY(PC-SUB-1)   11849904
118489                                TBL-PMTOT-PREP-UNT-QTY(PC-SUB-1)  11850004
118490        IF PM100-ACTL-SLS-RTL-AMT = ZEROES                        11850104
118492           MOVE ZEROES              TO PV-MU-PCT                  11850230
118493           MOVE PV-MU-PCT           TO DTL-01-ACTL-MU-PCT         11850330
118494           MOVE PC-PERCENT-SIGN     TO DTL-01-ACTL-PCT-SIGN       11850430
118495        ELSE                                                      11850504
118496           COMPUTE PV-MU-PCT ROUNDED =                            11850604
118497                   ((PM100-ACTL-SLS-RTL-AMT -                     11850704
118498                    PM100-ACTL-SLS-COST-AMT) /                    11850804
118499                    PM100-ACTL-SLS-RTL-AMT) * 100                 11850904
118500                    ON SIZE ERROR                                 11851004
118501                    MOVE 0 TO PV-MU-PCT                           11851104
118502           END-COMPUTE                                            11851204
118503           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11851304
118504           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  11851404
118505           MOVE PV-ROUND-TO-TENTHS TO DTL-01-ACTL-MU-PCT          11851504
118506           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        11851630
118508        END-IF                                                    11851704
118509                                                                  11851804
118513        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        11851925
118514                (PM100-ACTL-SLS-UNT-QTY /                         11852025
118515                (PM100-ACTL-EOH-INV-QTY +                         11852125
118516                 PM100-ACTL-SLS-UNT-QTY)) * 100                   11852225
118517                 ON SIZE ERROR                                    11852325
118518                 MOVE 0 TO PV-SELL-THRU-PCT                       11852425
118519        END-COMPUTE                                               11852525
118521        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          11852604
118522        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  11852704
118523        MOVE PV-ROUND-TO-TENTHS    TO DTL-01-SELL-THRU-PCT        11852804
118527        MOVE PC-PERCENT-SIGN       TO DTL-01-SELL-PCT-SIGN        11852930
118529                                                                  11853004
118530        IF PM100-FCST-SLS-RTL-AMT = ZEROES                        11853104
118531           CONTINUE                                               11853204
118532        ELSE                                                      11853304
118533           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       11853428
118534                 ((PM100-FCST-SLS-RTL-AMT -                       11853528
118535                   PM100-ACTL-SLS-RTL-AMT) /                      11853628
118536                   PM100-FCST-SLS-RTL-AMT) * -100                 11853728
118537                   ON SIZE ERROR                                  11853804
118538                   MOVE 0 TO PV-VOL-PCT-CHG                       11853904
118539           END-COMPUTE                                            11854004
118540           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11854104
118541           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  11854204
118542           IF PV-VOL-PCT-CHG < 0                                  11854304
118543              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 11854404
118544              MOVE PV-FINAL-VOL-PCT                               11854504
118545                                   TO DTL-01-VOL-PCT-CHG          11854604
118546           ELSE                                                   11854704
118547              MOVE PV-ROUND-TO-TENTHS                             11854804
118548                                   TO DTL-VAR-VOL-PCT-CHG         11854904
118549              MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG          11855004
118550           END-IF                                                 11855104
118554           MOVE PC-PERCENT-SIGN    TO DTL-01-VOL-PCT-SIGN         11855430
118556        END-IF                                                    11855604
118557     END-IF.                                                      11855704
118558                                                                  11855804
118560     MOVE PM100-FCST-SLS-RTL-AMT    TO DTL-01-FCST-SLS-RTL-AMT.   11856030
118562     ADD PM100-FCST-SLS-RTL-AMT     TO                            11856204
118563                              TBL-STOT-TOT-SALE-AMT(PC-SUB-2)     11856304
118564                              TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2).   11856404
118566     MOVE PM100-FCST-MKDN-RTL-AMT    TO DTL-01-FCST-MD-AMT.       11856631
118568     ADD PM100-FCST-MKDN-RTL-AMT    TO                            11856804
118569                             TBL-STOT-TOT-MD-AMT(PC-SUB-2)        11856904
118570                             TBL-PMTOT-TOT-MD-AMT(PC-SUB-2).      11857004
118572     MOVE PM100-FCST-SLS-UNT-QTY    TO DTL-01-FCST-UNT-SLD-QTY.   11857230
118574     ADD PM100-FCST-SLS-UNT-QTY     TO                            11857404
118575                            TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)    11857504
118576                            TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-2).  11857604
118578     MOVE PM100-FCST-PROJD-UNT-QTY  TO DTL-01-FCST-PREP-UNT-QTY.  11857830
118580     ADD PM100-FCST-PROJD-UNT-QTY   TO                            11858004
118581                             TBL-STOT-PREP-UNT-QTY(PC-SUB-2)      11858104
118582                             TBL-PMTOT-PREP-UNT-QTY(PC-SUB-2).    11858204
118583     ADD PM100-FCST-SLS-COST-AMT    TO                            11858304
118584                             TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2)  11858404
118585                             TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2).11858504
118586                                                                  11858604
118587     IF PM100-FCST-SLS-RTL-AMT = ZEROES                           11858704
118588         CONTINUE                                                 11858804
118589     ELSE                                                         11858904
118590         COMPUTE PV-MU-PCT ROUNDED =                              11859004
118591                 ((PM100-FCST-SLS-RTL-AMT -                       11859104
118592                 PM100-FCST-SLS-COST-AMT) /                       11859204
118593                 PM100-FCST-SLS-RTL-AMT) * 100                    11859304
118594                 ON SIZE ERROR                                    11859404
118595                 MOVE 0 TO PV-MU-PCT                              11859504
118596         END-COMPUTE                                              11859604
118597         MOVE ZEROES               TO PV-ROUND-TO-TENTHS          11859704
118598         ADD PV-MU-PCT             TO PV-ROUND-TO-TENTHS ROUNDED  11859804
118599         MOVE PV-ROUND-TO-TENTHS   TO DTL-01-FCST-MU-PCT          11859904
118603         MOVE PC-PERCENT-SIGN      TO DTL-01-FCST-PCT-SIGN        11860330
118605     END-IF.                                                      11860504
118606     IF PM100-PROMO-ITM-ADV-IND = 'N'                             11860604
118607        ADD PM100-FCST-SLS-RTL-AMT   TO                           11860704
118608                      TBL-UATOT-TOT-SALE-AMT(PC-SUB-2)            11860804
118609        ADD PM100-FCST-MKDN-RTL-AMT  TO                           11860904
118610                      TBL-UATOT-TOT-MD-AMT(PC-SUB-2)              11861004
118611        ADD PM100-FCST-SLS-UNT-QTY   TO                           11861104
118612                      TBL-UATOT-TOT-SLS-UNT-QTY(PC-SUB-2)         11861204
118613        ADD PM100-FCST-SLS-COST-AMT  TO                           11861304
118614                      TBL-UATOT-TOT-SLS-COST-AMT(PC-SUB-2)        11861404
118615        ADD PM100-FCST-PROJD-UNT-QTY TO                           11861504
118616                      TBL-UATOT-PREP-UNT-QTY(PC-SUB-2)            11861604
118617     ELSE                                                         11861704
118618        IF PM100-PROMO-ITM-ADV-IND = 'Y'                          11861804
118619           ADD PM100-FCST-SLS-RTL-AMT   TO                        11861904
118620                      TBL-ATOT-TOT-SALE-AMT(PC-SUB-2)             11862004
118621           ADD PM100-FCST-MKDN-RTL-AMT  TO                        11862104
118622                      TBL-ATOT-TOT-MD-AMT(PC-SUB-2)               11862204
118623           ADD PM100-FCST-SLS-UNT-QTY   TO                        11862304
118624                      TBL-ATOT-TOT-SLS-UNT-QTY(PC-SUB-2)          11862404
118625           ADD PM100-FCST-SLS-COST-AMT  TO                        11862504
118626                      TBL-ATOT-TOT-SLS-COST-AMT(PC-SUB-2)         11862604
118627           ADD PM100-FCST-PROJD-UNT-QTY TO                        11862704
118628                      TBL-ATOT-PREP-UNT-QTY(PC-SUB-2)             11862804
118629        END-IF                                                    11862904
118630     END-IF.                                                      11863004
118631                                                                  11863104
118632     ADD PV-ADVANCE-LINES           TO PV-LINE-CNT.               11863204
118633     PERFORM 3400-CHECK-MAX-LINE-CNT.                             11863304
118634     MOVE DETAIL-01                 TO PV-RPT-LINE.               11863404
118635     PERFORM 8300-WRITE-RPT-LINE.                                 11863533
118636                                                                  11863604
118637*3200-EXIT.                                                       11863704
118638 EJECT.                                                           11863804
118639                                                                  11863904
118640*----------------------------------------------------------       11864004
118641* 3300-PROCESS-ADVPG-TOTAL.                                       11864104
118642*     PROCESS THE ADVERTISED/DMM TOTAL OF THE REPORT.             11864204
118643*----------------------------------------------------------       11864304
118644 3300-PROCESS-ADVPG-TOTAL.                                        11864404
118645                                                                  11864504
118646     MOVE SPACES               TO DETAIL-01                       11864604
118647                                  DETAIL-VARIABLE.                11864704
118648                                                                  11864804
118649     MOVE PC-ADVERTISED         TO DTL-01-UNAD-TITLE.             11864904
118650                                                                  11865004
118651*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                11865104
118652     IF PM100-ACTUAL                                              11865204
118654        MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-1)                      11865430
118655                                   TO DTL-01-ACTL-SLS-RTL-AMT     11865530
118657                                                                  11865704
118658        IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES               11865804
118659           CONTINUE                                               11865904
118660        ELSE                                                      11866004
118661           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       11866128
118662                 ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -              11866228
118663                   TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) /             11866328
118664                   TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * -100        11866428
118665                   ON SIZE ERROR                                  11866504
118666                   MOVE 0 TO PV-VOL-PCT-CHG                       11866604
118667           END-COMPUTE                                            11866704
118668           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11866804
118669           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  11866904
118670           IF PV-VOL-PCT-CHG < 0                                  11867004
118671              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 11867104
118672              MOVE PV-FINAL-VOL-PCT                               11867204
118673                                   TO DTL-01-VOL-PCT-CHG          11867304
118674           ELSE                                                   11867404
118675              MOVE PV-ROUND-TO-TENTHS                             11867504
118676                                   TO DTL-VAR-VOL-PCT-CHG         11867604
118677              MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG          11867704
118678           END-IF                                                 11867804
118682           MOVE PC-PERCENT-SIGN    TO DTL-01-VOL-PCT-SIGN         11868230
118684        END-IF                                                    11868404
118685                                                                  11868504
118687        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        11868725
118688                (TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1) /             11868825
118689                (TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1) +             11868925
118690                 TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100       11869025
118691                 ON SIZE ERROR                                    11869125
118692                 MOVE 0 TO PV-SELL-THRU-PCT                       11869225
118693        END-COMPUTE                                               11869325
118695        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          11869504
118696        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  11869604
118697        MOVE PV-ROUND-TO-TENTHS    TO DTL-01-SELL-THRU-PCT        11869704
118701        MOVE PC-PERCENT-SIGN       TO DTL-01-SELL-PCT-SIGN        11870130
118703                                                                  11870304
118705        MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-1)                        11870530
118706                                   TO DTL-01-ACTL-MD-AMT          11870630
118709        MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)                   11870930
118710                                   TO DTL-01-ACTL-UNT-SLD-QTY     11871030
118713        MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-1)                      11871330
118714                                   TO DTL-01-ACTL-PREP-UNT-QTY    11871430
118716                                                                  11871604
118717        IF TBL-STOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES               11871704
118719           MOVE ZEROES              TO PV-MU-PCT                  11871930
118720           MOVE PV-MU-PCT           TO DTL-01-ACTL-MU-PCT         11872030
118721           MOVE PC-PERCENT-SIGN     TO DTL-01-ACTL-PCT-SIGN       11872130
118722        ELSE                                                      11872204
118723           COMPUTE PV-MU-PCT ROUNDED =                            11872304
118724                   ((TBL-STOT-TOT-SALE-AMT(PC-SUB-1) -            11872404
118725                    TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1))/         11872504
118726                    TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) * 100        11872604
118727                    ON SIZE ERROR                                 11872704
118728                    MOVE 0 TO PV-MU-PCT                           11872804
118729           END-COMPUTE                                            11872904
118730           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11873004
118731           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  11873104
118732           MOVE PV-ROUND-TO-TENTHS TO DTL-01-ACTL-MU-PCT          11873204
118736           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        11873630
118738        END-IF                                                    11873804
118739     END-IF.                                                      11873904
118740                                                                  11874004
118741*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            11874104
118743     MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-2)                         11874330
118744                                   TO DTL-01-FCST-SLS-RTL-AMT.    11874430
118747     MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-2)                           11874730
118748                                   TO DTL-01-FCST-MD-AMT.         11874830
118751     MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)                      11875130
118752                                   TO DTL-01-FCST-UNT-SLD-QTY.    11875230
118755     MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-2)                         11875530
118756                                   TO DTL-01-FCST-PREP-UNT-QTY.   11875630
118758                                                                  11875804
118759     IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                  11875904
118760         CONTINUE                                                 11876004
118761     ELSE                                                         11876104
118762         COMPUTE PV-MU-PCT ROUNDED =                              11876204
118763                 ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -              11876304
118764                 TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2))/            11876404
118765                 TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * 100           11876504
118766                 ON SIZE ERROR                                    11876604
118767                 MOVE 0 TO PV-MU-PCT                              11876704
118768         END-COMPUTE                                              11876804
118769         MOVE ZEROES               TO PV-ROUND-TO-TENTHS          11876904
118770         ADD PV-MU-PCT             TO PV-ROUND-TO-TENTHS ROUNDED  11877004
118771         MOVE PV-ROUND-TO-TENTHS   TO DTL-01-FCST-MU-PCT          11877104
118775         MOVE PC-PERCENT-SIGN      TO DTL-01-FCST-PCT-SIGN        11877530
118777     END-IF.                                                      11877704
118778                                                                  11877804
118779     MOVE 2                    TO PV-ADVANCE-LINES.               11877904
118780     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    11878004
118781     PERFORM 3400-CHECK-MAX-LINE-CNT.                             11878104
118782     MOVE DETAIL-01            TO PV-RPT-LINE.                    11878204
118783     PERFORM 8300-WRITE-RPT-LINE.                                 11878333
118784                                                                  11878404
118785*3300-EXIT.                                                       11878504
118786 EJECT.                                                           11878604
118787                                                                  11878704
118788*----------------------------------------------------------       11878804
118789* 3310-PROCESS-DMM-GMM-TOTAL.                                     11878904
118790*     PROCESS THE DMM OR GMM TOTAL OF THE REPORT.                 11879004
118791*----------------------------------------------------------       11879104
118792 3310-PROCESS-DMM-GMM-TOTAL.                                      11879205
118793                                                                  11879304
118794     MOVE SPACES               TO DETAIL-01                       11879404
118795                                  DETAIL-VARIABLE.                11879504
118796                                                                  11879604
118797     IF PS-GMA-RESULTS                                            11879705
118798        MOVE +1 TO PV-POINTER-FIELD                               11879809
118799        STRING PC-TOTAL DELIMITED BY " "                          11879904
118800               " " DELIMITED BY SIZE                              11880004
118801               PV-SAVE-LAST-NAME DELIMITED BY " "                 11880112
118802               " " DELIMITED BY SIZE                              11880204
118803          INTO DTL-01-NEW-TITLE                                   11880304
118804          WITH POINTER PV-POINTER-FIELD                           11880404
118805     ELSE                                                         11880504
118806        MOVE PC-TOTAL          TO DTL-01-NEW-TITLE                11880604
118807     END-IF.                                                      11880704
118808                                                                  11880804
118809*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                11880904
118810     IF PM100-ACTUAL                                              11881004
118812        MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-1)                      11881230
118813                                   TO DTL-01-ACTL-SLS-RTL-AMT     11881330
118815                                                                  11881504
118816        IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES               11881604
118817           CONTINUE                                               11881704
118818        ELSE                                                      11881804
118819           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       11881928
118820                 ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -              11882028
118821                   TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) /             11882128
118822                   TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * -100        11882228
118823                   ON SIZE ERROR                                  11882304
118824                   MOVE 0 TO PV-VOL-PCT-CHG                       11882404
118825           END-COMPUTE                                            11882504
118826           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11882604
118827           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  11882704
118828           IF PV-VOL-PCT-CHG < 0                                  11882804
118829              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 11882904
118830              MOVE PV-FINAL-VOL-PCT                               11883004
118831                                   TO DTL-01-VOL-PCT-CHG          11883104
118832           ELSE                                                   11883204
118833              MOVE PV-ROUND-TO-TENTHS                             11883304
118834                                   TO DTL-VAR-VOL-PCT-CHG         11883404
118835              MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG          11883504
118836           END-IF                                                 11883604
118840           MOVE PC-PERCENT-SIGN    TO DTL-01-VOL-PCT-SIGN         11884030
118842        END-IF                                                    11884204
118843                                                                  11884304
118844        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        11884425
118845                (TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1) /             11884525
118846                (TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1) +             11884625
118847                 TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100       11884725
118848                 ON SIZE ERROR                                    11884825
118849                 MOVE 0 TO PV-SELL-THRU-PCT                       11884925
118850        END-COMPUTE                                               11885025
118851        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          11885104
118852        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  11885204
118853        MOVE PV-ROUND-TO-TENTHS    TO DTL-01-SELL-THRU-PCT        11885304
118857        MOVE PC-PERCENT-SIGN       TO DTL-01-SELL-PCT-SIGN        11885730
118859                                                                  11885904
118861        MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-1)                        11886130
118862                                   TO DTL-01-ACTL-MD-AMT          11886230
118865        MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)                   11886530
118866                                   TO DTL-01-ACTL-UNT-SLD-QTY     11886630
118869        MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-1)                      11886930
118870                                   TO DTL-01-ACTL-PREP-UNT-QTY    11887030
118872                                                                  11887204
118873        IF TBL-STOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES               11887304
118875           MOVE ZEROES              TO PV-MU-PCT                  11887530
118876           MOVE PV-MU-PCT           TO DTL-01-ACTL-MU-PCT         11887630
118877           MOVE PC-PERCENT-SIGN     TO DTL-01-ACTL-PCT-SIGN       11887730
118878        ELSE                                                      11887804
118879           COMPUTE PV-MU-PCT ROUNDED =                            11887904
118880                   ((TBL-STOT-TOT-SALE-AMT(PC-SUB-1) -            11888004
118881                    TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1))/         11888104
118882                    TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) * 100        11888204
118883                    ON SIZE ERROR                                 11888304
118884                    MOVE 0 TO PV-MU-PCT                           11888404
118885           END-COMPUTE                                            11888504
118886           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11888604
118887           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  11888704
118888           MOVE PV-ROUND-TO-TENTHS TO DTL-01-ACTL-MU-PCT          11888804
118892           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        11889230
118894        END-IF                                                    11889404
118895     END-IF.                                                      11889504
118896                                                                  11889604
118897*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            11889704
118899     MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-2)                         11889930
118900                                   TO DTL-01-FCST-SLS-RTL-AMT.    11890030
118903     MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-2)                           11890330
118904                                   TO DTL-01-FCST-MD-AMT.         11890430
118907     MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)                      11890730
118908                                   TO DTL-01-FCST-UNT-SLD-QTY.    11890830
118911     MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-2)                         11891130
118912                                   TO DTL-01-FCST-PREP-UNT-QTY.   11891230
118914                                                                  11891404
118915     IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                  11891504
118916         CONTINUE                                                 11891604
118917     ELSE                                                         11891704
118918         COMPUTE PV-MU-PCT ROUNDED =                              11891804
118919                 ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -              11891904
118920                 TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2))/            11892004
118921                 TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * 100           11892104
118922                 ON SIZE ERROR                                    11892204
118923                 MOVE 0 TO PV-MU-PCT                              11892304
118924         END-COMPUTE                                              11892404
118925         MOVE ZEROES               TO PV-ROUND-TO-TENTHS          11892504
118926         ADD PV-MU-PCT             TO PV-ROUND-TO-TENTHS ROUNDED  11892604
118927         MOVE PV-ROUND-TO-TENTHS   TO DTL-01-FCST-MU-PCT          11892704
118931         MOVE PC-PERCENT-SIGN      TO DTL-01-FCST-PCT-SIGN        11893130
118933     END-IF.                                                      11893304
118934                                                                  11893404
118935     MOVE 1                    TO PV-ADVANCE-LINES.               11893510
118936     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    11893604
118937     PERFORM 3400-CHECK-MAX-LINE-CNT.                             11893704
118938     MOVE DETAIL-01            TO PV-RPT-LINE.                    11893804
118939     PERFORM 8300-WRITE-RPT-LINE.                                 11893933
118940                                                                  11894004
118941     IF PS-DMA-RESULTS                                            11894105
118942        MOVE 1                    TO PV-ADVANCE-LINES             11894205
118943        ADD PV-ADVANCE-LINES      TO PV-LINE-CNT                  11894305
118944        PERFORM 3400-CHECK-MAX-LINE-CNT                           11894405
118945        MOVE DETAIL-HEADER-02     TO PV-RPT-LINE                  11894505
118946        PERFORM 8300-WRITE-RPT-LINE                               11894633
118947     END-IF.                                                      11894705
118948                                                                  11894804
118949*3310-EXIT.                                                       11894904
118950 EJECT.                                                           11895004
118951                                                                  11895104
118952*----------------------------------------------------------       11895204
118953* 3320-PROCESS-ADV-TOTAL.                                         11895304
118954*     PROCESS THE GMM ADVERTISED TOTAL OF THE REPORT.             11895404
118955*----------------------------------------------------------       11895504
118956 3320-PROCESS-ADV-TOTAL.                                          11895604
118957                                                                  11895704
118958     MOVE SPACES               TO DETAIL-01                       11895804
118959                                  DETAIL-VARIABLE.                11895904
118960                                                                  11896004
118961     MOVE +1                    TO PV-POINTER-FIELD.              11896104
118962     IF PS-TOTALS                                                 11896204
118963        STRING PC-TOTAL DELIMITED BY " "                          11896304
118964               " " DELIMITED BY SIZE                              11896404
118965               PC-ADVERTISED DELIMITED BY " "                     11896504
118966               " " DELIMITED BY SIZE                              11896604
118967          INTO DTL-01-NEW-TITLE                                   11896704
118968          WITH POINTER PV-POINTER-FIELD                           11896804
118969     ELSE                                                         11896904
118970        STRING PC-ADVERTISED DELIMITED BY " "                     11897004
118971               " " DELIMITED BY SIZE                              11897104
118972               PV-SAVE-GMA-LAST-NM DELIMITED BY " "               11897220
118973               " " DELIMITED BY SIZE                              11897304
118974          INTO DTL-01-NEW-TITLE                                   11897404
118975          WITH POINTER PV-POINTER-FIELD                           11897504
118976     END-IF.                                                      11897604
118977                                                                  11897704
118978*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                11897804
118979     IF PM100-ACTUAL                                              11897904
118981        MOVE TBL-ATOT-TOT-SALE-AMT(PC-SUB-1)                      11898130
118982                                   TO DTL-01-ACTL-SLS-RTL-AMT     11898230
118984                                                                  11898404
118985        IF TBL-ATOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES               11898504
118986           CONTINUE                                               11898604
118987        ELSE                                                      11898704
118988           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       11898828
118989                 ((TBL-ATOT-TOT-SALE-AMT(PC-SUB-2) -              11898928
118990                   TBL-ATOT-TOT-SALE-AMT(PC-SUB-1)) /             11899028
118991                   TBL-ATOT-TOT-SALE-AMT(PC-SUB-2)) * -100        11899128
118992                   ON SIZE ERROR                                  11899204
118993                   MOVE 0 TO PV-VOL-PCT-CHG                       11899304
118994           END-COMPUTE                                            11899404
118995           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11899504
118996           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  11899604
118997           IF PV-VOL-PCT-CHG < 0                                  11899704
118998              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 11899804
118999              MOVE PV-FINAL-VOL-PCT                               11899904
119000                                   TO DTL-01-VOL-PCT-CHG          11900004
119001           ELSE                                                   11900104
119002              MOVE PV-ROUND-TO-TENTHS                             11900204
119003                                   TO DTL-VAR-VOL-PCT-CHG         11900304
119004              MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG          11900404
119005           END-IF                                                 11900504
119009           MOVE PC-PERCENT-SIGN    TO DTL-01-VOL-PCT-SIGN         11900930
119011        END-IF                                                    11901104
119012                                                                  11901204
119013        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        11901325
119014                (TBL-ATOT-TOT-SLS-UNT-QTY(PC-SUB-1) /             11901425
119015                (TBL-ATOT-TOT-EOH-INV-QTY(PC-SUB-1) +             11901525
119016                 TBL-ATOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100       11901625
119017                 ON SIZE ERROR                                    11901725
119018                 MOVE 0 TO PV-SELL-THRU-PCT                       11901825
119019        END-COMPUTE                                               11901925
119020        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          11902004
119021        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  11902104
119022        MOVE PV-ROUND-TO-TENTHS    TO DTL-01-SELL-THRU-PCT        11902204
119026        MOVE PC-PERCENT-SIGN       TO DTL-01-SELL-PCT-SIGN        11902630
119028                                                                  11902804
119030        MOVE TBL-ATOT-TOT-MD-AMT(PC-SUB-1)                        11903030
119031                                   TO DTL-01-ACTL-MD-AMT          11903130
119034        MOVE TBL-ATOT-TOT-SLS-UNT-QTY(PC-SUB-1)                   11903430
119035                                   TO DTL-01-ACTL-UNT-SLD-QTY     11903530
119038        MOVE TBL-ATOT-PREP-UNT-QTY(PC-SUB-1)                      11903830
119039                                   TO DTL-01-ACTL-PREP-UNT-QTY    11903930
119041                                                                  11904104
119042        IF TBL-ATOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES               11904204
119044           MOVE ZEROES              TO PV-MU-PCT                  11904430
119045           MOVE PV-MU-PCT           TO DTL-01-ACTL-MU-PCT         11904530
119046           MOVE PC-PERCENT-SIGN     TO DTL-01-ACTL-PCT-SIGN       11904630
119047        ELSE                                                      11904704
119048           COMPUTE PV-MU-PCT ROUNDED =                            11904804
119049                   ((TBL-ATOT-TOT-SALE-AMT(PC-SUB-1) -            11904904
119050                    TBL-ATOT-TOT-SLS-COST-AMT(PC-SUB-1))/         11905004
119051                    TBL-ATOT-TOT-SALE-AMT(PC-SUB-1)) * 100        11905104
119052                    ON SIZE ERROR                                 11905204
119053                    MOVE 0 TO PV-MU-PCT                           11905304
119054           END-COMPUTE                                            11905404
119055           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11905504
119056           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  11905604
119057           MOVE PV-ROUND-TO-TENTHS TO DTL-01-ACTL-MU-PCT          11905704
119061           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        11906130
119063        END-IF                                                    11906304
119064     END-IF.                                                      11906404
119065                                                                  11906504
119066*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            11906604
119068     MOVE TBL-ATOT-TOT-SALE-AMT(PC-SUB-2)                         11906830
119069                                   TO DTL-01-FCST-SLS-RTL-AMT.    11906930
119072     MOVE TBL-ATOT-TOT-MD-AMT(PC-SUB-2)                           11907230
119073                                   TO DTL-01-FCST-MD-AMT.         11907330
119076     MOVE TBL-ATOT-TOT-SLS-UNT-QTY(PC-SUB-2)                      11907630
119077                                   TO DTL-01-FCST-UNT-SLD-QTY.    11907730
119080     MOVE TBL-ATOT-PREP-UNT-QTY(PC-SUB-2)                         11908030
119081                                   TO DTL-01-FCST-PREP-UNT-QTY.   11908130
119083                                                                  11908304
119084     IF TBL-ATOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                  11908404
119085         CONTINUE                                                 11908504
119086     ELSE                                                         11908604
119087         COMPUTE PV-MU-PCT ROUNDED =                              11908704
119088                 ((TBL-ATOT-TOT-SALE-AMT(PC-SUB-2) -              11908804
119089                 TBL-ATOT-TOT-SLS-COST-AMT(PC-SUB-2))/            11908904
119090                 TBL-ATOT-TOT-SALE-AMT(PC-SUB-2)) * 100           11909004
119091                 ON SIZE ERROR                                    11909104
119092                 MOVE 0 TO PV-MU-PCT                              11909204
119093         END-COMPUTE                                              11909304
119094         MOVE ZEROES               TO PV-ROUND-TO-TENTHS          11909404
119095         ADD PV-MU-PCT             TO PV-ROUND-TO-TENTHS ROUNDED  11909504
119096         MOVE PV-ROUND-TO-TENTHS   TO DTL-01-FCST-MU-PCT          11909604
119100         MOVE PC-PERCENT-SIGN      TO DTL-01-FCST-PCT-SIGN        11910030
119102     END-IF.                                                      11910204
119103                                                                  11910304
119104     MOVE 2                    TO PV-ADVANCE-LINES.               11910404
119105     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    11910504
119106     PERFORM 3400-CHECK-MAX-LINE-CNT.                             11910604
119107     MOVE DETAIL-01            TO PV-RPT-LINE.                    11910704
119108     PERFORM 8300-WRITE-RPT-LINE.                                 11910833
119109                                                                  11910904
119110*3320-EXIT.                                                       11911004
119111 EJECT.                                                           11911104
119112                                                                  11911204
119113*----------------------------------------------------------       11911304
119114* 3330-PROCESS-UNAD-TOTAL.                                        11911404
119115*     PROCESS THE GMM UNADVERTISED TOTAL OF THE REPORT.           11911504
119116*----------------------------------------------------------       11911604
119117 3330-PROCESS-UNAD-TOTAL.                                         11911704
119118                                                                  11911804
119119     MOVE SPACES               TO DETAIL-01                       11911904
119120                                  DETAIL-VARIABLE.                11912004
119121                                                                  11912104
119122     MOVE +1                    TO PV-POINTER-FIELD.              11912204
119123     IF PS-TOTALS                                                 11912304
119124        STRING PC-TOTAL DELIMITED BY " "                          11912404
119125               " " DELIMITED BY SIZE                              11912504
119126               PC-UNADVERTISED DELIMITED BY " "                   11912604
119127               " " DELIMITED BY SIZE                              11912704
119128          INTO DTL-01-NEW-TITLE                                   11912804
119129          WITH POINTER PV-POINTER-FIELD                           11912904
119130     ELSE                                                         11913004
119131        STRING PC-UNADVERTISED DELIMITED BY " "                   11913104
119132               " " DELIMITED BY SIZE                              11913204
119133               PV-SAVE-GMA-LAST-NM DELIMITED BY " "               11913320
119134               " " DELIMITED BY SIZE                              11913404
119135          INTO DTL-01-NEW-TITLE                                   11913504
119136          WITH POINTER PV-POINTER-FIELD                           11913604
119137     END-IF.                                                      11913704
119138                                                                  11913804
119139*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                11913904
119140     IF PM100-ACTUAL                                              11914004
119142        MOVE TBL-UATOT-TOT-SALE-AMT(PC-SUB-1)                     11914230
119143                                   TO DTL-01-ACTL-SLS-RTL-AMT     11914330
119145                                                                  11914504
119146        IF TBL-UATOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES              11914604
119147           CONTINUE                                               11914704
119148        ELSE                                                      11914804
119149           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       11914928
119150                 ((TBL-UATOT-TOT-SALE-AMT(PC-SUB-2) -             11915028
119151                   TBL-UATOT-TOT-SALE-AMT(PC-SUB-1)) /            11915128
119152                   TBL-UATOT-TOT-SALE-AMT(PC-SUB-2)) * -100       11915228
119153                   ON SIZE ERROR                                  11915304
119154                   MOVE 0 TO PV-VOL-PCT-CHG                       11915404
119155           END-COMPUTE                                            11915504
119156           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11915604
119157           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  11915704
119158           IF PV-VOL-PCT-CHG < 0                                  11915804
119159              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 11915904
119160              MOVE PV-FINAL-VOL-PCT                               11916004
119161                                   TO DTL-01-VOL-PCT-CHG          11916104
119162           ELSE                                                   11916204
119163              MOVE PV-ROUND-TO-TENTHS                             11916304
119164                                   TO DTL-VAR-VOL-PCT-CHG         11916404
119165              MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG          11916504
119166           END-IF                                                 11916604
119170           MOVE PC-PERCENT-SIGN    TO DTL-01-VOL-PCT-SIGN         11917030
119172        END-IF                                                    11917204
119173                                                                  11917304
119174        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        11917425
119175                (TBL-UATOT-TOT-SLS-UNT-QTY(PC-SUB-1) /            11917525
119176                (TBL-UATOT-TOT-EOH-INV-QTY(PC-SUB-1) +            11917625
119177                 TBL-UATOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100      11917725
119178                 ON SIZE ERROR                                    11917825
119179                 MOVE 0 TO PV-SELL-THRU-PCT                       11917925
119180        END-COMPUTE                                               11918025
119181        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          11918104
119182        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  11918204
119183        MOVE PV-ROUND-TO-TENTHS    TO DTL-01-SELL-THRU-PCT        11918304
119187        MOVE PC-PERCENT-SIGN       TO DTL-01-SELL-PCT-SIGN        11918730
119189                                                                  11918904
119191        MOVE TBL-UATOT-TOT-MD-AMT(PC-SUB-1)                       11919130
119192                                   TO DTL-01-ACTL-MD-AMT          11919230
119195        MOVE TBL-UATOT-TOT-SLS-UNT-QTY(PC-SUB-1)                  11919530
119196                                   TO DTL-01-ACTL-UNT-SLD-QTY     11919630
119199        MOVE TBL-UATOT-PREP-UNT-QTY(PC-SUB-1)                     11919930
119200                                   TO DTL-01-ACTL-PREP-UNT-QTY    11920030
119202                                                                  11920204
119203        IF TBL-UATOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES              11920304
119205           MOVE ZEROES              TO PV-MU-PCT                  11920530
119206           MOVE PV-MU-PCT           TO DTL-01-ACTL-MU-PCT         11920630
119207           MOVE PC-PERCENT-SIGN     TO DTL-01-ACTL-PCT-SIGN       11920730
119208        ELSE                                                      11920804
119209           COMPUTE PV-MU-PCT ROUNDED =                            11920904
119210                   ((TBL-UATOT-TOT-SALE-AMT(PC-SUB-1) -           11921004
119211                    TBL-UATOT-TOT-SLS-COST-AMT(PC-SUB-1))/        11921104
119212                    TBL-UATOT-TOT-SALE-AMT(PC-SUB-1)) * 100       11921204
119213                    ON SIZE ERROR                                 11921304
119214                    MOVE 0 TO PV-MU-PCT                           11921404
119215           END-COMPUTE                                            11921504
119216           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11921604
119217           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  11921704
119218           MOVE PV-ROUND-TO-TENTHS TO DTL-01-ACTL-MU-PCT          11921804
119222           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        11922230
119224        END-IF                                                    11922404
119225     END-IF.                                                      11922504
119226                                                                  11922604
119227*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            11922704
119229     MOVE TBL-UATOT-TOT-SALE-AMT(PC-SUB-2)                        11922930
119230                                   TO DTL-01-FCST-SLS-RTL-AMT.    11923030
119233     MOVE TBL-UATOT-TOT-MD-AMT(PC-SUB-2)                          11923330
119234                                   TO DTL-01-FCST-MD-AMT.         11923430
119237     MOVE TBL-UATOT-TOT-SLS-UNT-QTY(PC-SUB-2)                     11923730
119238                                   TO DTL-01-FCST-UNT-SLD-QTY.    11923830
119241     MOVE TBL-UATOT-PREP-UNT-QTY(PC-SUB-2)                        11924130
119242                                   TO DTL-01-FCST-PREP-UNT-QTY.   11924230
119244                                                                  11924404
119245     IF TBL-UATOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                 11924504
119246         CONTINUE                                                 11924604
119247     ELSE                                                         11924704
119248         COMPUTE PV-MU-PCT ROUNDED =                              11924804
119249                 ((TBL-UATOT-TOT-SALE-AMT(PC-SUB-2) -             11924904
119250                 TBL-UATOT-TOT-SLS-COST-AMT(PC-SUB-2))/           11925004
119251                 TBL-UATOT-TOT-SALE-AMT(PC-SUB-2)) * 100          11925104
119252                 ON SIZE ERROR                                    11925204
119253                 MOVE 0 TO PV-MU-PCT                              11925304
119254         END-COMPUTE                                              11925404
119255         MOVE ZEROES               TO PV-ROUND-TO-TENTHS          11925504
119256         ADD PV-MU-PCT             TO PV-ROUND-TO-TENTHS ROUNDED  11925604
119257         MOVE PV-ROUND-TO-TENTHS   TO DTL-01-FCST-MU-PCT          11925704
119261         MOVE PC-PERCENT-SIGN      TO DTL-01-FCST-PCT-SIGN        11926130
119263     END-IF.                                                      11926304
119264                                                                  11926404
119265     MOVE 1                    TO PV-ADVANCE-LINES.               11926504
119266     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    11926604
119267     PERFORM 3400-CHECK-MAX-LINE-CNT.                             11926704
119268     MOVE DETAIL-01            TO PV-RPT-LINE.                    11926804
119269     PERFORM 8300-WRITE-RPT-LINE.                                 11926933
119270                                                                  11927004
119271*3330-EXIT.                                                       11927104
119272 EJECT.                                                           11927204
119273                                                                  11927304
119274*----------------------------------------------------------       11927404
119275* 3340-PROCESS-PROMO-TOTAL.                                       11927504
119276*     PROCESS THE GMM PROMOTION TOTAL OF THE REPORT.              11927604
119277*----------------------------------------------------------       11927704
119278 3340-PROCESS-PROMO-TOTAL.                                        11927804
119279                                                                  11927904
119280     MOVE SPACES               TO DETAIL-01                       11928004
119281                                  DETAIL-VARIABLE.                11928104
119282                                                                  11928204
119283     MOVE +1                    TO PV-POINTER-FIELD.              11928304
119284     IF PS-TOTALS                                                 11928404
119285        STRING PC-TOTAL DELIMITED BY " "                          11928504
119286               " " DELIMITED BY SIZE                              11928604
119287               PC-PROMOTION DELIMITED BY " "                      11928704
119288               " " DELIMITED BY SIZE                              11928804
119289          INTO DTL-01-NEW-TITLE                                   11928904
119290          WITH POINTER PV-POINTER-FIELD                           11929004
119291     ELSE                                                         11929104
119292        STRING PC-TOTAL DELIMITED BY " "                          11929204
119293               " " DELIMITED BY SIZE                              11929304
119294               PV-SAVE-GMA-LAST-NM DELIMITED BY " "               11929420
119295               " " DELIMITED BY SIZE                              11929504
119296          INTO DTL-01-NEW-TITLE                                   11929604
119297          WITH POINTER PV-POINTER-FIELD                           11929704
119298     END-IF.                                                      11929804
119299                                                                  11929904
119300*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                11930004
119301     IF PM100-ACTUAL                                              11930104
119303        MOVE TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)                     11930330
119304                                   TO DTL-01-ACTL-SLS-RTL-AMT     11930430
119306                                                                  11930604
119307        IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES              11930704
119308           CONTINUE                                               11930804
119309        ELSE                                                      11930904
119310           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       11931028
119311                 ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) -             11931128
119312                   TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)) /            11931228
119313                   TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)) * -100       11931328
119314                   ON SIZE ERROR                                  11931404
119315                   MOVE 0 TO PV-VOL-PCT-CHG                       11931504
119316           END-COMPUTE                                            11931604
119317           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11931704
119318           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  11931804
119319           IF PV-VOL-PCT-CHG < 0                                  11931904
119320              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 11932004
119321              MOVE PV-FINAL-VOL-PCT                               11932104
119322                                   TO DTL-01-VOL-PCT-CHG          11932204
119323           ELSE                                                   11932304
119324              MOVE PV-ROUND-TO-TENTHS                             11932404
119325                                   TO DTL-VAR-VOL-PCT-CHG         11932504
119326              MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG          11932604
119327           END-IF                                                 11932704
119331              MOVE PC-PERCENT-SIGN TO DTL-01-VOL-PCT-SIGN         11933104
119333        END-IF                                                    11933304
119334                                                                  11933404
119335        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        11933526
119336                (TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1) /            11933626
119337                (TBL-PMTOT-TOT-EOH-INV-QTY(PC-SUB-1) +            11933726
119338                 TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100      11933826
119339                 ON SIZE ERROR                                    11933926
119340                 MOVE 0 TO PV-SELL-THRU-PCT                       11934026
119341        END-COMPUTE                                               11934126
119342        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          11934204
119343        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  11934304
119344        MOVE PV-ROUND-TO-TENTHS    TO DTL-01-SELL-THRU-PCT        11934404
119348        MOVE PC-PERCENT-SIGN       TO DTL-01-SELL-PCT-SIGN        11934830
119350                                                                  11935004
119352        MOVE TBL-PMTOT-TOT-MD-AMT(PC-SUB-1)                       11935230
119353                                   TO DTL-01-ACTL-MD-AMT          11935330
119356        MOVE TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1)                  11935630
119357                                   TO DTL-01-ACTL-UNT-SLD-QTY     11935730
119360        MOVE TBL-PMTOT-PREP-UNT-QTY(PC-SUB-1)                     11936030
119361                                   TO DTL-01-ACTL-PREP-UNT-QTY    11936130
119363                                                                  11936304
119364        IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES              11936404
119365           MOVE ZEROES              TO PV-MU-PCT                  11936530
119366           MOVE PV-MU-PCT           TO DTL-01-ACTL-MU-PCT         11936630
119367           MOVE PC-PERCENT-SIGN     TO DTL-01-ACTL-PCT-SIGN       11936730
119369        ELSE                                                      11936904
119370           COMPUTE PV-MU-PCT ROUNDED =                            11937004
119371                   ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1) -           11937104
119372                    TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1))/        11937204
119373                    TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)) * 100       11937304
119374                    ON SIZE ERROR                                 11937404
119375                    MOVE 0 TO PV-MU-PCT                           11937504
119376           END-COMPUTE                                            11937604
119377           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11937704
119378           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  11937804
119379           MOVE PV-ROUND-TO-TENTHS TO DTL-01-ACTL-MU-PCT          11937904
119383           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        11938330
119385        END-IF                                                    11938504
119386     END-IF.                                                      11938604
119387                                                                  11938704
119388*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            11938804
119390     MOVE TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)                        11939030
119391                                   TO DTL-01-FCST-SLS-RTL-AMT.    11939130
119394     MOVE TBL-PMTOT-TOT-MD-AMT(PC-SUB-2)                          11939430
119395                                   TO DTL-01-FCST-MD-AMT.         11939530
119398     MOVE TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-2)                     11939830
119399                                   TO DTL-01-FCST-UNT-SLD-QTY.    11939930
119402     MOVE TBL-PMTOT-PREP-UNT-QTY(PC-SUB-2)                        11940230
119403                                   TO DTL-01-FCST-PREP-UNT-QTY.   11940330
119405                                                                  11940504
119406     IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                 11940604
119407         CONTINUE                                                 11940704
119408     ELSE                                                         11940804
119409         COMPUTE PV-MU-PCT ROUNDED =                              11940904
119410                 ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) -             11941004
119411                 TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2))/           11941104
119412                 TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)) * 100          11941204
119413                 ON SIZE ERROR                                    11941304
119414                 MOVE 0 TO PV-MU-PCT                              11941404
119415         END-COMPUTE                                              11941504
119416         MOVE ZEROES               TO PV-ROUND-TO-TENTHS          11941604
119417         ADD PV-MU-PCT             TO PV-ROUND-TO-TENTHS ROUNDED  11941704
119418         MOVE PV-ROUND-TO-TENTHS   TO DTL-01-FCST-MU-PCT          11941804
119422         MOVE PC-PERCENT-SIGN      TO DTL-01-FCST-PCT-SIGN        11942230
119424     END-IF.                                                      11942404
119425                                                                  11942504
119426     MOVE 1                     TO PV-ADVANCE-LINES.              11942604
119427     ADD PV-ADVANCE-LINES       TO PV-LINE-CNT.                   11942730
119428     PERFORM 3400-CHECK-MAX-LINE-CNT.                             11942804
119429     MOVE DETAIL-01            TO PV-RPT-LINE.                    11942904
119430     PERFORM 8300-WRITE-RPT-LINE.                                 11943033
119431                                                                  11943104
119432     IF PS-TOTALS                                                 11943208
119433        MOVE 1                    TO PV-ADVANCE-LINES             11943308
119434        ADD PV-ADVANCE-LINES      TO PV-LINE-CNT                  11943408
119435        PERFORM 3400-CHECK-MAX-LINE-CNT                           11943508
119436        MOVE DETAIL-HEADER-02     TO PV-RPT-LINE                  11943608
119437        PERFORM 8300-WRITE-RPT-LINE                               11943733
119438     END-IF.                                                      11943808
119439                                                                  11943904
119440*3340-EXIT.                                                       11944004
119441 EJECT.                                                           11944104
119442                                                                  11944204
119443*----------------------------------------------------------       11944302
119444* 3400-CHECK-MAX-LINE-CNT.                                        11944404
119445*     CHECKS TO SEE IF IT HAS REACHED THE MAXIMUM AMOUNT          11944502
119446*     OF LINES FOR THE PAGE. WRITES OUT ALL HEADERS.              11944602
119447*----------------------------------------------------------       11944702
119448 3400-CHECK-MAX-LINE-CNT.                                         11944804
119449                                                                  11944902
119450     IF PV-LINE-CNT > PC-MAX-LINE-CNT                             11945002
119451         PERFORM 3500-PROCESS-PAGE-HEADER                         11945104
119452         MOVE 2                  TO PV-ADVANCE-LINES              11945202
119453         ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                   11945302
119454     END-IF.                                                      11945402
119455                                                                  11945502
119456*3400-EXIT.                                                       11945604
119457 EJECT.                                                           11945702
119458                                                                  11945802
119459*----------------------------------------------------------       11945902
119460* 3500-PROCESS-PAGE-HEADER.                                       11946004
119461*     PROCESS REPORT PAGE HEADERS.                                11946102
119462*----------------------------------------------------------       11946202
119463 3500-PROCESS-PAGE-HEADER.                                        11946304
119464                                                                  11946402
119465     MOVE ZEROES                 TO PV-LINE-CNT.                  11946502
119466     ADD 1                       TO PV-PAGE-CNT.                  11946602
119467     MOVE PV-PAGE-CNT            TO DP200O-PAGE-NUMBER.           11946702
119468     MOVE 1                      TO DP200O-REPORT-NUMBER.         11946802
119469                                                                  11946902
119470     MOVE DP200O-STANDRD-HEADER-200-COLS                          11947002
119471                                 TO PV-RPT-LINE.                  11947102
119472     PERFORM 8200-WRITE-SLS-RPT-NEW-PAGE.                         11947233
119473                                                                  11947302
119474     MOVE HEADER-01              TO PV-RPT-LINE.                  11947403
119475     MOVE 1                      TO PV-ADVANCE-LINES.             11947502
119476     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11947602
119477     PERFORM 8300-WRITE-RPT-LINE.                                 11947733
119478                                                                  11947802
119479     MOVE HEADER-02              TO PV-RPT-LINE.                  11947903
119480     MOVE 1                      TO PV-ADVANCE-LINES.             11948002
119481     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11948102
119482     PERFORM 8300-WRITE-RPT-LINE.                                 11948233
119483                                                                  11948302
119484     MOVE HEADER-03              TO PV-RPT-LINE.                  11948403
119485     MOVE 1                      TO PV-ADVANCE-LINES.             11948502
119486     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11948602
119487     PERFORM 8300-WRITE-RPT-LINE.                                 11948733
119488                                                                  11948802
119489     MOVE HEADER-04              TO PV-RPT-LINE.                  11948903
119490     MOVE 1                      TO PV-ADVANCE-LINES.             11949002
119491     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11949102
119492     PERFORM 8300-WRITE-RPT-LINE.                                 11949233
119493                                                                  11949302
119499     MOVE HEADER-05              TO PV-RPT-LINE.                  11949903
119500     MOVE 2                      TO PV-ADVANCE-LINES.             11950002
119501     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11950102
119502     PERFORM 8300-WRITE-RPT-LINE                                  11950233
119503                                                                  11950302
119504     MOVE HEADER-06              TO PV-RPT-LINE.                  11950403
119505     MOVE 1                      TO PV-ADVANCE-LINES.             11950502
119506     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11950602
119507     PERFORM 8300-WRITE-RPT-LINE.                                 11950733
119508                                                                  11950802
119509*3500-EXIT.                                                       11950904
119510 EJECT.                                                           11951002
119511                                                                  11951102
119512*----------------------------------------------------------       11951202
119513* 7000-COUNT-FIELD-LENGTH.                                        11951302
119514*     COUNTS THE ACTUAL FIELD'S LENGTH.                           11951402
119515*----------------------------------------------------------       11951502
119516 7000-COUNT-FIELD-LENGTH.                                         11951602
119517                                                                  11951702
119518     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         11951802
119519     MOVE PV-SAVE-VAR    TO PV-VARIABLE-OUTPUT-FIELD.             11951902
119520                                                                  11952002
119521     MOVE PV-SAVE-NUM TO PV-SUBSCRIPT.                            11952102
119522                                                                  11952202
119523     PERFORM                                                      11952302
119524        VARYING PV-BIT-IDX FROM PV-SAVE-NUM BY -1                 11952402
119525        UNTIL PV-BIT-VARIABLE(PV-BIT-IDX) NOT = SPACES            11952502
119526               OR PV-BIT-IDX = 1                                  11952602
119527        SUBTRACT 1 FROM PV-SUBSCRIPT                              11952702
119528     END-PERFORM.                                                 11952802
119529                                                                  11952902
119530     MOVE PV-SUBSCRIPT TO PV-SAVE-LENGTH.                         11953002
119531                                                                  11953102
119532*7000-EXIT.                                                       11953202
119533 EJECT.                                                           11953302
119534                                                                  11953402
119535*----------------------------------------------------------       11953502
119536* 8000-READ-SLS-DMA-RESULTS.                                      11953603
119537*     READ DMA SALES RESULTS INPUT RECORDS.                       11953703
119538*----------------------------------------------------------       11953802
119539 8000-READ-SLS-DMA-RESULTS.                                       11953903
119540                                                                  11954002
119541     READ PROMO-SUMM-DMM-FILE INTO PM100-PROMO-ITM-SUMM           11954106
119542          AT END                                                  11954202
119543             SET PS-EOF-SLS-DMA-RSLTS TO TRUE                     11954307
119544     END-READ.                                                    11954402
119545                                                                  11954502
119546*8000-EXIT.                                                       11954602
119547 EJECT.                                                           11954702
119548                                                                  11954802
119549*----------------------------------------------------------       11954903
119550* 8100-READ-SLS-GMA-RESULTS.                                      11955003
119551*     READ GMA SALES RESULTS INPUT RECORDS.                       11955103
119552*----------------------------------------------------------       11955203
119553 8100-READ-SLS-GMA-RESULTS.                                       11955303
119554                                                                  11955403
119555     READ PROMO-SUMM-GMM-FILE INTO PM100-PROMO-ITM-SUMM           11955506
119556          AT END                                                  11955603
119557             SET PS-EOF-SLS-GMA-RSLTS TO TRUE                     11955707
119558     END-READ.                                                    11955803
119559                                                                  11955903
119560     MOVE PM100-PROMO-ITM-SUMM TO PV-SAVE-RECORD-2.               11956005
119561                                                                  11956105
119562*8100-EXIT.                                                       11956203
119563 EJECT.                                                           11956303
119564                                                                  11956403
119577*----------------------------------------------------------       11957702
119578* 8200-WRITE-SLS-RPT-NEW-PAGE.                                    11957833
119579*     WRITES NEW PAGE.                                            11957902
119580*----------------------------------------------------------       11958002
119581 8200-WRITE-SLS-RPT-NEW-PAGE.                                     11958133
119582                                                                  11958202
119583     WRITE PROMO-SUMM-RPT-LINE                                    11958302
119584           FROM PV-RPT-LINE                                       11958402
119585           AFTER ADVANCING PAGE.                                  11958502
119586                                                                  11958602
119587     ADD 2            TO PV-LINE-CNT.                             11958702
119588                                                                  11958802
119589*8200-EXIT.                                                       11958933
119590 EJECT.                                                           11959002
119591                                                                  11959102
119592*----------------------------------------------------------       11959202
119593* 8300-WRITE-RPT-LINE.                                            11959333
119594*     WRITES OUT A LINE ON THE REPORT.                            11959402
119595*----------------------------------------------------------       11959502
119596 8300-WRITE-RPT-LINE.                                             11959633
119597                                                                  11959702
119598     WRITE PROMO-SUMM-RPT-LINE                                    11959802
119599           FROM PV-RPT-LINE                                       11959902
119600           AFTER ADVANCING PV-ADVANCE-LINES.                      11960002
119601                                                                  11960102
119602*8300-EXIT.                                                       11960233
119603 EJECT.                                                           11960302
119604                                                                  11960402
119605*----------------------------------------------------------       11960502
119606* 9000-ADD-PARENTH-TO-NEG-PCT.                                    11960602
119607*     PUTS PARENTHESES AROUND A NEGATIVE PERCENT FOR THE          11960702
119608*     VOLUME PERCENT CHANGE FIELD.                                11960821
119609*----------------------------------------------------------       11960902
119610 9000-ADD-PARENTH-TO-NEG-PCT.                                     11961002
119611                                                                  11961102
119612     INITIALIZE PV-ROUND-VOL-PCT                                  11961202
119613                PV-TRUNCAT-VOL-PCT                                11961302
119614                PV-NUM-VOL-PCT                                    11961402
119615                PV-FINAL-VOL-PCT                                  11961502
119616                PV-SEP-VOL-PCT                                    11961602
119617                PA-CNT-SPACES.                                    11961702
119618                                                                  11961802
119619     MOVE PV-ROUND-TO-TENTHS      TO PV-ROUND-VOL-PCT.            11961902
119620     MOVE PV-ROUND-VOL-PCT        TO PV-TRUNCAT-VOL-PCT.          11962002
119621     MOVE PV-TRUNCAT-VOL-PCT-X    TO PV-NUM-VOL-PCT.              11962102
119622     MOVE PV-TRUNCAT-VOL-PCT-X    TO PV-SEP-VOL-PCT.              11962202
119623     INSPECT PV-CHAR-VOL-PCT-1 REPLACING                          11962302
119624             LEADING ZERO BY " ".                                 11962402
119625     INSPECT PV-CHAR-VOL-PCT-1                                    11962502
119626            TALLYING PA-CNT-SPACES FOR ALL " ".                   11962602
119627     EVALUATE TRUE                                                11962702
119628         WHEN PA-CNT-SPACES = 0                                   11962802
119629              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-1         11962902
119630              MOVE PV-SEP-VOL-PCT-1 TO PV-FINAL-VOL-PCT-2         11963002
119631              MOVE PV-SEP-VOL-PCT-2 TO PV-FINAL-VOL-PCT-3         11963102
119632              MOVE PV-SEP-VOL-PCT-3 TO PV-FINAL-VOL-PCT-4         11963202
119633              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         11963302
119634              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         11963402
119635         WHEN PA-CNT-SPACES = 1                                   11963502
119636              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-2         11963602
119637              MOVE PV-SEP-VOL-PCT-2 TO PV-FINAL-VOL-PCT-3         11963702
119638              MOVE PV-SEP-VOL-PCT-3 TO PV-FINAL-VOL-PCT-4         11963802
119639              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         11963902
119640              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         11964002
119641         WHEN PA-CNT-SPACES = 2                                   11964102
119642              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-3         11964202
119643              MOVE PV-SEP-VOL-PCT-3 TO PV-FINAL-VOL-PCT-4         11964302
119644              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         11964402
119645              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         11964502
119646         WHEN PA-CNT-SPACES = 3                                   11964602
119647              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-4         11964702
119648              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         11964802
119649              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         11964902
119650         WHEN PA-CNT-SPACES = 4                                   11965002
119651              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-5         11965102
119652              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         11965202
119653     END-EVALUATE.                                                11965302
119654     MOVE PC-BACK-PAR               TO PV-FINAL-VOL-PCT-7.        11965402
119655                                                                  11965502
119656                                                                  11965602
119657*9000-EXIT.                                                       11965702
119658 EJECT.                                                           11965802
119659                                                                  11965902
119660*----------------------------------------------------------       11966002
119661* 9100-CALENDAR-ROUTINE.                                          11966102
119662*     CALLS THE DATE ROUTINE WITH SPECIFIED PARAMETERS.           11966202
119663*----------------------------------------------------------       11966302
119664 9100-CALENDAR-ROUTINE.                                           11966402
119665                                                                  11966502
119666     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          11966602
119667                                             DPG53 DPG54          11966702
119668                                             DPG55 DPG56.         11966802
119669     EVALUATE TRUE                                                11966902
119670         WHEN DPG54-NO-ERROR                                      11967002
119671             CONTINUE                                             11967102
119672         WHEN DPG54-WARNING-ERROR                                 11967202
119673             DISPLAY '** WARNING - PROGRAM '                      11967302
119674                      PC-CURRENT-PROGRAM-NAME ' **'               11967402
119675             DISPLAY '** 9100-CALENDAR-ROUTINE'                   11967502
119676             DISPLAY '** CALL TO DPKUT500 RETURNED WARNING ERROR' 11967602
119677             DISPLAY '** DPG54-ERROR-MESSAGE: '                   11967702
119678             DISPLAY '** ' DPG54-ERROR-MESSAGE                    11967802
119679             DISPLAY '** DPG51: ' DPG51                           11967902
119680             DISPLAY '** DPG52: ' DPG52                           11968002
119681             DISPLAY '** PLEASE INVESTIGATE FURTHER **'           11968102
119682         WHEN DPG54-SEVERE-ERROR                                  11968202
119683             DISPLAY '** ABEND - PROGRAM '                        11968302
119684                      PC-CURRENT-PROGRAM-NAME ' **'               11968402
119685             DISPLAY '** 9100-CALENDAR-ROUTINE'                   11968502
119686             DISPLAY '** CALL TO DPKUT500 RETURNED SEVERE ERROR'  11968602
119687             IF DPG54-CALENDAR-TYPE-INVALID                       11968702
119688                DISPLAY '** DPG54-CALENDAR-TYPE-INVALID'          11968802
119689                DISPLAY '** DPG51-CALENDAR-TYPE: '                11968902
119690                         DPG51-CALENDAR-TYPE                      11969002
119691             END-IF                                               11969102
119692             IF DPG54-DATE-INVALID                                11969202
119693                DISPLAY '** DPG54-DATE-INVALID'                   11969302
119694                DISPLAY '** DPG52-LK-DATE-INPUT: '                11969402
119695                         DPG52-LK-DATE-INPUT                      11969502
119696             END-IF                                               11969602
119697             IF DPG54-INCR-DECR-INVALID                           11969702
119698                DISPLAY '** DPG54-INCR-DECR-INVALID'              11969802
119699                DISPLAY '** DPG51-INCREMENT-DECREMENT-FLAG: '     11969902
119700                         DPG51-INCREMENT-DECREMENT-FLAG           11970002
119701             END-IF                                               11970102
119702             MOVE DPG54-ERROR-MESSAGE                             11970202
119703                                 TO PV-OPERATION-MSG-2            11970302
119704             SET ABEND-4019-DATE-ROUTINE-ERROR TO TRUE            11970402
119705             PERFORM 9800-ABEND                                   11970502
119706     END-EVALUATE.                                                11970602
119707                                                                  11970702
119708*9100-EXIT.                                                       11970802
119710 EJECT.                                                           11971002
119800                                                                  11980002
119900*----------------------------------------------------------       11990002
120000* 9800-ABEND.                                                     12000002
120100*     PERFORMS A NON-SQL-ABEND.                                   12010002
120200*----------------------------------------------------------       12020002
120300 9800-ABEND.                                                      12030002
120400                                                                  12040002
120500     DISPLAY '** ABEND           **'.                             12050002
120600     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  12060002
120700     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        12070002
120800     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       12080002
120900     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       12090002
121000                                                                  12100002
121100     CALL 'ILBOABN0' USING ABEND-CODE.                            12110002
